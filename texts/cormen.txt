£« ¢«¥­¨¥

1 ¢¥¤¥­¨¥
1.1. «£®°¨²¬» . . . . . . . . . . . . . . . . . . . . . . . . .
1.2. ­ «¨§  «£®°¨²¬®¢ . . . . . . . . . . . . . . . . . . . .
1.3. ®±²°®¥­¨¥  «£®°¨²¬®¢ . . . . . . . . . . . . . . . . .
1.3.1. °¨­¶¨¯ À° §¤¥«¿© ¨ ¢« ±²¢³©Á . . . . . . . . .
1.3.2. ­ «¨§  «£®°¨²¬®¢ ²¨¯  À° §¤¥«¿© ¨ ¢« ±²¢³©Á

7
7
11
15
16
17

I  ²¥¬ ²¨·¥±ª¨¥ ®±­®¢»  ­ «¨§   «£®°¨²¬®¢

24

¢¥¤¥­¨¥25
2 ª®°®±²¼ °®±²  ´³­ª¶¨©
26
2.1. ±¨¬¯²®²¨·¥±ª¨¥ ®¡®§­ ·¥­¨¿ . . . . . . . . . . . . . 26
2.2. ² ­¤ °²­»¥ ´³­ª¶¨¨ ¨ ®¡®§­ ·¥­¨¿ . . . . . . . . . 30
3 ³¬¬¨°®¢ ­¨¥
39
3.1. ³¬¬» ¨ ¨µ ±¢®©±²¢  . . . . . . . . . . . . . . . . . . . 39
3.2. ¶¥­ª¨ ±³¬¬ . . . . . . . . . . . . . . . . . . . . . . . . 43
4 ¥ª³°°¥­²­»¥ ±®®²­®¸¥­¨¿
4.1. ¥²®¤ ¯®¤±² ­®¢ª¨ . . . . . . . . . . . . . .
4.2. °¥®¡° §®¢ ­¨¥ ¢ ±³¬¬³ . . . . . . . . . . .
4.3. ¡¹¨© °¥¶¥¯² . . . . . . . . . . . . . . . . .
? 4.4 ®ª § ²¥«¼±²¢® ¥®°¥¬» 4.1 . . . . . . . . .
4.4.1. «³· © ­ ²³° «¼­»µ ±²¥¯¥­¥© . . .
4.4.2. ¥«»¥ ¯°¨¡«¨¦¥­¨¿ ±¢¥°µ³ ¨ ±­¨§³ .
5 ­®¦¥±²¢ 
5.1. ­®¦¥±²¢ 
5.2. ²­®¸¥­¨¿
5.3. ³­ª¶¨¨ .
5.4. ° ´» . . .
5.5. ¥°¥¢¼¿ . .

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.
.

.
.
.
.
.
.

.
.
.
.
.
.

.
.
.
.
.
.

.
.
.
.
.
.

.
.
.
.
.
.

49
50
53
56
59
59
63

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

71
71
76
79
82
87

2

5.5.1. ¥°¥¢¼¿ ¡¥§ ¢»¤¥«¥­­®£® ª®°­¿ . . . . . . . . . 87
5.5.2. ¥°¥¢¼¿ ± ª®°­¥¬. °¨¥­²¨°®¢ ­­»¥ ¤¥°¥¢¼¿ . 89
5.5.3. ¢®¨·­»¥ ¤¥°¥¢¼¿. ®§¨¶¨®­­»¥ ¤¥°¥¢¼¿ . . . 91
6 ®¬¡¨­ ²®°¨ª  ¨ ¢¥°®¿²­®±²¼
6.1. ®¤±·¥² ª®«¨·¥±²¢ . . . . . . . . . . . . . . . . .
6.2. ¥°®¿²­®±²¼ . . . . . . . . . . . . . . . . . . . . .
6.2.1. ¨±ª°¥²­®¥ ° ±¯°¥¤¥«¥­¨¥ ¢¥°®¿²­®±²¥©
6.3. ¨±ª°¥²­»¥ ±«³· ©­»¥ ¢¥«¨·¨­» . . . . . . . . .
6.4. ¥®¬¥²°¨·¥±ª®¥ ¨ ¡¨­®¬¨ «¼­®¥ ° ±¯°¥¤¥«¥­¨¿ .
6.5. ¢®±²» ¡¨­®¬¨ «¼­®£® ° ±¯°¥¤¥«¥­¨¿ . . . . . .
6.6. ¥°®¿²­®±²­»©  ­ «¨§ . . . . . . . . . . . . . . .
6.6.1.  ° ¤®ª± ¤­¿ °®¦¤¥­¨¿ . . . . . . . . . .
6.6.2.  °» ¨ ³°­» . . . . . . . . . . . . . . . .
6.6.3. · ±²ª¨ ¯®¢²®°¿¾¹¨µ±¿ ¨±µ®¤®¢ . . . . .

.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.
.
.

II ®°²¨°®¢ª  ¨ ¯®°¿¤ª®¢»¥ ±² ²¨±²¨ª¨

96
96
102
103
108
113
118
123
123
125
126

132

¢¥¤¥­¨¥133
7 ®°²¨°®¢ª  ± ¯®¬®¹¼¾ ª³·¨
7.1. ³·¨ . . . . . . . . . . . . . . . . . . . . .
7.2. ®µ° ­¥­¨¥ ®±­®¢­®£® ±¢®©±²¢  ª³·¨ . .
7.3. ®±²°®¥­¨¥ ª³·¨ . . . . . . . . . . . . .
7.4. «£®°¨²¬ ±®°²¨°®¢ª¨ ± ¯®¬®¹¼¾ ª³·¨
7.5. ·¥°¥¤¨ ± ¯°¨®°¨²¥² ¬¨ . . . . . . . . .

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

136
136
138
140
143
143

8 »±²° ¿ ±®°²¨°®¢ª 
8.1. ¯¨± ­¨¥ ¡»±²°®© ±®°²¨°®¢ª¨ . . . . . . . . . .
8.2.  ¡®²  ¡»±²°®© ±®°²¨°®¢ª¨ . . . . . . . . . . . .
8.3. ¥°®¿²­®±²­»¥  «£®°¨²¬» ¡»±²°®© ±®°²¨°®¢ª¨
8.4. ­ «¨§ ¡»±²°®© ±®°²¨°®¢ª¨ . . . . . . . . . . . .
8.4.1. ­ «¨§ ­ ¨µ³¤¸¥£® ±«³· ¿ . . . . . . . . .
8.4.2. ­ «¨§ ±°¥¤­¥£® ¢°¥¬¥­¨ ° ¡®²» . . . . .

.
.
.
.
.
.

.
.
.
.
.
.

.
.
.
.
.
.

148
148
151
155
157
157
158

.
.
.
.

166
166
169
171
174

10 ¥¤¨ ­» ¨ ¯®°¿¤ª®¢»¥ ±² ²¨±²¨ª¨
10.1. ¨­¨¬³¬ ¨ ¬ ª±¨¬³¬ . . . . . . . . . . . . . . . . . .
10.2. »¡®° §  «¨­¥©­®¥ ¢ ±°¥¤­¥¬ ¢°¥¬¿ . . . . . . . . . .
10.3. »¡®° §  «¨­¥©­®¥ ¢ µ³¤¸¥¬ ±«³· ¥ ¢°¥¬¿ . . . . . .

180
181
182
185

9 ®°²¨°®¢ª  §  «¨­¥©­®¥ ¢°¥¬¿
9.1. ¨¦­¨¥ ®¶¥­ª¨ ¤«¿ ±®°²¨°®¢ª¨
9.2. ®°²¨°®¢ª  ¯®¤±·¥²®¬ . . . . .
9.3. ¨´°®¢ ¿ ±®°²¨°®¢ª  . . . . . .
9.4. ®°²¨°®¢ª  ¢»·¥°¯»¢ ­¨¥¬ . .

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.
.

.
.
.
.

.
.
.
.
.

.
.
.
.

.
.
.
.
.

.
.
.
.

.
.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

3

III ²°³ª²³°» ¤ ­­»µ

192

¢¥¤¥­¨¥193
11 «¥¬¥­² °­»¥ ±²°³ª²³°» ¤ ­­»µ
197
11.1. ²¥ª¨ ¨ ®·¥°¥¤¨ . . . . . . . . . . . . . . . . . . . . . . 197
11.2. ¢¿§ ­­»¥ ±¯¨±ª¨ . . . . . . . . . . . . . . . . . . . . . 201
11.3. ¥ «¨§ ¶¨¿ ³ª § ²¥«¥© ¨ § ¯¨±¥© ± ­¥±ª®«¼ª¨¬¨ ¯®«¿¬¨206
11.4. °¥¤±² ¢«¥­¨¥ ª®°­¥¢»µ ¤¥°¥¢¼¥¢ . . . . . . . . . . . 210
12 ¥¸-² ¡«¨¶»
12.1. °¿¬ ¿  ¤°¥± ¶¨¿ . . . . . . . . . .
12.2. ¥¸-² ¡«¨¶» . . . . . . . . . . . . .
12.3. ¥¸-´³­ª¶¨¨ . . . . . . . . . . . .
12.3.1. ¥«¥­¨¥ ± ®±² ²ª®¬ . . . . .
12.3.2. ¬­®¦¥­¨¥ . . . . . . . . . .
12.3.3. ­¨¢¥°± «¼­®¥ µ¥¸¨°®¢ ­¨¥
12.4. ²ª°»² ¿  ¤°¥± ¶¨¿ . . . . . . . .

.
.
.
.
.
.
.

.
.
.
.
.
.
.

13 ¢®¨·­»¥ ¤¥°¥¢¼¿ ¯®¨±ª 
13.1. ²® ² ª®¥ ¤¢®¨·­®¥ ¤¥°¥¢® ¯®¨±ª ? .
13.2. ®¨±ª ¢ ¤¢®¨·­®¬ ¤¥°¥¢¥ . . . . . . . .
13.3. ®¡ ¢«¥­¨¥ ¨ ³¤ «¥­¨¥ ½«¥¬¥­²  . . .
? 13.4 «³· ©­»¥ ¤¢®¨·­»¥ ¤¥°¥¢¼¿ ¯®¨±ª  .

.
.
.
.
.
.
.

.
.
.
.
.
.
.

.
.
.
.
.
.
.

.
.
.
.
.
.
.

.
.
.
.
.
.
.

.
.
.
.
.
.
.

.
.
.
.
.
.
.

.
.
.
.
.
.
.

.
.
.
.
.
.
.

217
217
219
225
226
227
228
231

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

242
243
245
248
252

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

.
.
.
.

262
262
264
267
271

15 ®¯®«­¥­¨¥ ±²°³ª²³° ¤ ­­»µ
15.1. ¨­ ¬¨·¥±ª¨¥ ¯®°¿¤ª®¢»¥ ±² ²¨±²¨ª¨ . . . . . . . . .
15.2. ¡¹ ¿ ±µ¥¬  ° ¡®²» ± ¤®¯®«­¨²¥«¼­®© ¨­´®°¬ ¶¨¥©
15.3. ¥°¥¢¼¿ ¯°®¬¥¦³²ª®¢ . . . . . . . . . . . . . . . . . . .

280
280
285
288

IV ¥²®¤» ¯®±²°®¥­¨¿ ¨  ­ «¨§   «£®°¨²¬®¢

296

14 ° ±­®-·¥°­»¥ ¤¥°¥¢¼¿
14.1. ¢®©±²¢  ª° ±­®-·¥°­»µ ¤¥°¥¢¼¥¢
14.2. ° ¹¥­¨¿ . . . . . . . . . . . . . . .
14.3. ®¡ ¢«¥­¨¥ ¢¥°¸¨­» . . . . . . . .
14.4. ¤ «¥­¨¥ . . . . . . . . . . . . . . .

.
.
.
.

.
.
.
.

¢¥¤¥­¨¥297
16 ¨­ ¬¨·¥±ª®¥ ¯°®£° ¬¬¨°®¢ ­¨¥
16.1. ¥°¥¬­®¦¥­¨¥ ­¥±ª®«¼ª¨µ ¬ ²°¨¶ . . . . . . . . . .
16.2. ®£¤  ¯°¨¬¥­¨¬® ¤¨­ ¬¨·¥±ª®¥ ¯°®£° ¬¬¨°®¢ ­¨¥
16.3.  ¨¡®«¼¸ ¿ ®¡¹ ¿ ¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¼ . . . . .
16.4. ¯²¨¬ «¼­ ¿ ²°¨ ­£³«¿¶¨¿ ¬­®£®³£®«¼­¨ª  . . . .

.
.
.
.

299
300
307
312
317

4

17  ¤­»¥  «£®°¨²¬»
326
17.1.  ¤ ·  ® ¢»¡®°¥ § ¿¢®ª . . . . . . . . . . . . . . . . . . 326
17.2. ®£¤  ¯°¨¬¥­¨¬ ¦ ¤­»©  «£®°¨²¬? . . . . . . . . . . 330
17.3. ®¤»  ´´¬¥­  . . . . . . . . . . . . . . . . . . . . . . 333
? 17.4 ¥®°¥²¨·¥±ª¨¥ ®±­®¢» ¦ ¤­»µ  «£®°¨²¬®¢ . . . . . . 341
17.4.1.  ²°®¨¤» . . . . . . . . . . . . . . . . . . . . . 341
17.4.2.  ¤­»¥  «£®°¨²¬» ¤«¿ ¢§¢¥¸¥­­®£® ¬ ²°®¨¤ 343
? 17.5  ¤ ·  ® ° ±¯¨± ­¨¨ . . . . . . . . . . . . . . . . . . . 346
18 ¬®°²¨§ ¶¨®­­»©  ­ «¨§
18.1. ¥²®¤ £°³¯¯¨°®¢ª¨ . . . . . . . . . . . . . .
18.2. ¥²®¤ ¯°¥¤®¯« ²» . . . . . . . . . . . . . .
18.3. ¥²®¤ ¯®²¥­¶¨ «®¢ . . . . . . . . . . . . . .
18.4. ¨­ ¬¨·¥±ª¨¥ ² ¡«¨¶» . . . . . . . . . . . .
18.4.1.  ±¸¨°¥­¨¥ ² ¡«¨¶» . . . . . . . . .
18.4.2.  ±¸¨°¥­¨¥ ¨ ±®ª° ¹¥­¨¥ ² ¡«¨¶»

.
.
.
.
.
.

.
.
.
.
.
.

.
.
.
.
.
.

.
.
.
.
.
.

.
.
.
.
.
.

.
.
.
.
.
.

V ®«¥¥ ±«®¦­»¥ ±²°³ª²³°» ¤ ­­»µ

352
353
356
359
362
362
365

372

¢¥¤¥­¨¥373
19 -¤¥°¥¢¼¿
376
19.1. ¯°¥¤¥«¥­¨¥ -¤¥°¥¢  . . . . . . . . . . . . . . . . . . 379
19.2. ±­®¢­»¥ ®¯¥° ¶¨¨ ± -¤¥°¥¢¼¿¬¨ . . . . . . . . . . . 381
19.3. ¤ «¥­¨¥ ½«¥¬¥­²  ¨§ -¤¥°¥¢  . . . . . . . . . . . . . 388
20 ¨­®¬¨ «¼­»¥ ª³·¨
20.1. ¨­®¬¨ «¼­»¥ ¤¥°¥¢¼¿ ¨ ¡¨­®¬¨ «¼­»¥ ª³·¨
20.1.1. ¨­®¬¨ «¼­»¥ ¤¥°¥¢¼¿ . . . . . . . . .
20.1.2. ¨­®¬¨ «¼­»¥ ª³·¨ . . . . . . . . . . .
20.2. ¯¥° ¶¨¨ ± ¡¨­®¬¨ «¼­»¬¨ ª³· ¬¨ . . . . .
20.2.1. ¡º¥¤¨­¥­¨¥ ¤¢³µ ª³· . . . . . . . . .

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

394
395
395
397
399
400

21 ¨¡®­ ··¨¥¢» ª³·¨
21.1. ²°®¥­¨¥ ´¨¡®­ ··¨¥¢®© ª³·¨ . . . . . . . . . .
21.2. ¯¥° ¶¨¨, ¯°¥¤³±¬®²°¥­­»¥ ¤«¿ ±«¨¢ ¥¬»µ ª³·
21.3. ¬¥­¼¸¥­¨¥ ª«¾·  ¨ ³¤ «¥­¨¥ ¢¥°¸¨­» . . . . .
21.4. ¶¥­ª  ¬ ª±¨¬ «¼­®© ±²¥¯¥­¨ . . . . . . . . . .

.
.
.
.

.
.
.
.

.
.
.
.

413
414
416
425
429

.
.
.
.
.

22 ¨±²¥¬» ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ¬­®¦¥±²¢
434
22.1. ¯¥° ¶¨¨ ± ­¥¯¥°¥±¥ª ¾¹¨¬¨±¿ ¬­®¦¥±²¢ ¬¨ . . . . 434
22.2. ¥ «¨§ ¶¨¿ ± ¯®¬®¹¼¾ ±¯¨±ª®¢ . . . . . . . . . . . . . 437
22.2.1. °®£° ¬¬» . . . . . . . . . . . . . . . . . . . . 441
23 «£®°¨²¬» ­  £° ´ µ
452
23.1. ±­®¢­»¥  «£®°¨²¬» ­  £° ´ µ . . . . . . . . . . . . 453

5

23.1.1. °¥¤±² ¢«¥­¨¥ £° ´®¢ . . . .
23.1.2. ®¨±ª ¢ ¸¨°¨­³ . . . . . . . .
23.1.3. ®¨±ª ¢ £«³¡¨­³ . . . . . . . .
23.1.4. ®¯®«®£¨·¥±ª ¿ ±®°²¨°®¢ª  .
23.1.5. ¨«¼­® ±¢¿§­»¥ ª®¬¯®­¥­²» .

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

453
456
464
471
473

24 ¨­¨¬ «¼­»¥ ¯®ª°»¢ ¾¹¨¥ ¤¥°¥¢¼¿
481
24.1. ®±²°®¥­¨¥ ¬¨­¨¬ «¼­®£® ®±²®¢  . . . . . . . . . . . 482
24.2. «£®°¨²¬» °³±ª «  ¨ °¨¬  . . . . . . . . . . . . . 486
25 ° ²· ©¸¨¥ ¯³²¨ ¨§ ®¤­®© ¢¥°¸¨­»
25.1. ° ²· ©¸¨¥ ¯³²¨ ¨ °¥« ª± ¶¨¿ . . . . . . . . . . . . .
25.2. «£®°¨²¬ ¥««¬ ­ -®°¤  . . . . . . . . . . . . . . .
25.3. ° ²· ©¸¨¥ ¯³²¨ ¢  ¶¨ª«¨·¥±ª®¬ ®°¨¥­²¨°®¢ ­­®¬
£° ´¥ . . . . . . . . . . . . . . . . . . . . . . . . . . . .
25.4. £° ­¨·¥­¨¿ ­  ° §­®±²¨ ¨ ª° ²· ©¸¨¥ ¯³²¨ . . . .

493
497
507
510
512

26 ° ²· ©¸¨¥ ¯³²¨ ¤«¿ ¢±¥µ ¯ ° ¢¥°¸¨­
522
26.1. «£®°¨²¬ «®©¤ -®°¸®««  . . . . . . . . . . . . . . . 529
27  ª±¨¬ «¼­»© ¯®²®ª
27.1. ®²®ª¨ ¢ ±¥²¿µ . . . . . . . . . . . . . . . . . . . . .
27.2. ¥²®¤ ®°¤ { «ª¥°±®­  . . . . . . . . . . . . . . .
27.3.  ª±¨¬ «¼­®¥ ¯ °®±®·¥² ­¨¥ ¢ ¤¢³¤®«¼­®¬ £° ´¥ .
27.4. «£®°¨²¬ ¯°®² «ª¨¢ ­¨¿ ¯°¥¤¯®²®ª  . . . . . . . .
27.5. «£®°¨²¬ ¯®¤­¿²¼-¨-¢-­ · «® . . . . . . . . . . . . .

.
.
.
.
.

546
547
552
562
565
574

28 ®°²¨°³¾¹¨¥ ±¥²¨
28.1. ¥²¨ ª®¬¯ ° ²®°®¢ . . . . .
28.2. ° ¢¨«® ­³«¿ ¨ ¥¤¨­¨¶» . .
28.3. ¨²®­¨·¥±ª¨© ±®°²¨°®¢¹¨ª
28.4. «¨¢ ¾¹ ¿ ±¥²¼ . . . . . . .
28.5. ®°²¨°³¾¹ ¿ ±¥²¼ . . . . .

.
.
.
.
.

586
587
590
592
594
596

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

29 °¨´¬¥²¨·¥±ª¨¥ ±µ¥¬»
29.1. µ¥¬» ¨§ ´³­ª¶¨®­ «¼­»µ ½«¥¬¥­²®¢ . . . . . . . . .
29.1.1. ³­ª¶¨®­ «¼­»¥ ½«¥¬¥­²» . . . . . . . . . . .
29.1.2. µ¥¬» ¨§ ´³­ª¶¨®­ «¼­»µ ½«¥¬¥­²®¢ . . . . .
29.1.3. ³¬¬ ²®° . . . . . . . . . . . . . . . . . . . . .
29.1.4. «³¡¨­  ±µ¥¬» . . . . . . . . . . . . . . . . . . .
29.1.5.  §¬¥° ±µ¥¬» . . . . . . . . . . . . . . . . . . .
29.1.6. ¯° ¦­¥­¨¿ . . . . . . . . . . . . . . . . . . . .
29.2. Cµ¥¬» ¤«¿ ±«®¦¥­¨¿ . . . . . . . . . . . . . . . . . . .
29.2.1.  ±ª ¤­®¥ ±«®¦¥­¨¥ . . . . . . . . . . . . . . .
29.2.2. «®¦¥­¨¥ ± ¯°¥¤¢»·¨±«¥­¨¥¬ ¯¥°¥­®±®¢ . . . .
29.2.3. »·¨±«¥­¨¥ ²¨¯®¢ ¯¥°¥­®±  ± ¯®¬®¹¼¾ ¯ ° ««¥«¼­®© ¯°¥´¨ª±­®© ±µ¥¬» . . . . . . . . . . . .

601
602
602
603
603
604
605
605
605
606
607
608

6

29.2.4. ³¬¬ ²®° ± ¯°¥¤¢»·¨±«¥­¨¥¬ ¯¥°¥­®±®¢:
®ª®­· ­¨¥ . . . . . . . . . . . . . . . . . . . . .
29.2.5. «®¦¥­¨¥ ± § ¯®¬¨­ ­¨¥¬ ¯¥°¥­®±®¢ . . . . . .
29.3. µ¥¬» ¤«¿ ³¬­®¦¥­¨¿ . . . . . . . . . . . . . . . . . .
29.3.1.  ²°¨·­»© ³¬­®¦¨²¥«¼ . . . . . . . . . . . . .
29.3.2.  ° ª²¥°¨±²¨ª¨ ±µ¥¬» . . . . . . . . . . . . . .
29.3.3. ¬­®¦¥­¨¥ ± ¯®¬®¹¼¾ ¤¥°¥¢  ®««¥±  . . . . .
29.3.4.  ° ª²¥°¨±²¨ª¨ ±µ¥¬» . . . . . . . . . . . . . .
29.3.5. ¯° ¦­¥­¨¿ . . . . . . . . . . . . . . . . . . . .
29.4.  ª²¨°®¢ ­­»¥ ±µ¥¬» . . . . . . . . . . . . . . . . . .
29.4.1. ±²°®©±²¢® ¯®¡¨²®¢®£® ±«®¦¥­¨¿ . . . . . . . .
29.4.2.  ° ª²¥°¨±²¨ª¨ ±µ¥¬» . . . . . . . . . . . . . .
29.4.3.  ±ª ¤­®¥ ±«®¦¥­¨¥ ¨ ¯®¡¨²®¢®¥ ±«®¦¥­¨¥ . .
29.4.4. ¤­®¬¥°­»© ³¬­®¦¨²¥«¼ . . . . . . . . . . . .
29.4.5. °®±² ¿ °¥ «¨§ ¶¨¿ . . . . . . . . . . . . . . . .
29.4.6. »±²° ¿ °¥ «¨§ ¶¨¿ . . . . . . . . . . . . . . .
29.5.  ¤ ·¨ . . . . . . . . . . . . . . . . . . . . . . . . . . .
29.6. ®¬¬¥­² °¨¨ . . . . . . . . . . . . . . . . . . . . . . .

609
610
612
612
614
614
615
616
617
617
618
618
619
619
620
622
623

30 «£®°¨²¬» ¯ ° ««¥«¼­»µ ¢»·¨±«¥­¨©
625
30.0.1.  ° ««¥«¼­ ¿ ¬ ¸¨­  ± ¯°®¨§¢®«¼­»¬ ¤®±²³¯®¬ (PRAM) . . . . . . . . . . . . . . . . . . . . 625
30.0.2.  ° ««¥«¼­»© ¨ ¨±ª«¾·¨²¥«¼­»© ¤®±²³¯ ª ¯ ¬¿²¨ . . . . . . . . . . . . . . . . . . . . . . . . . 626
30.0.3. ¨­µ°®­¨§ ¶¨¿ . . . . . . . . . . . . . . . . . . 627
30.0.4. « ­ £« ¢» . . . . . . . . . . . . . . . . . . . . . 627
30.1. ¥°¥µ®¤» ¯® ³ª § ²¥«¿¬ . . . . . . . . . . . . . . . . . 628
30.1.1. ®¬¥° ¢ ±¯¨±ª¥ . . . . . . . . . . . . . . . . . . 628
30.1.2. ®°°¥ª²­®±²¼ . . . . . . . . . . . . . . . . . . . 630
30.1.3. ­ «¨§ . . . . . . . . . . . . . . . . . . . . . . . 630
30.1.4.  ° ««¥«¼­ ¿ ®¡° ¡®²ª  ¯°¥´¨ª±®¢ ±¯¨±ª  . . 631
30.1.5. ¥²®¤ ½©«¥°®¢  ¶¨ª«  . . . . . . . . . . . . . . 633
30.2. CRCW- ¨ EREW- «£®°¨²¬» . . . . . . . . . . . . . . . 636
30.2.1. ®«¼§  ¯ ° ««¥«¼­®£® ·²¥­¨¿ . . . . . . . . . . 636
30.2.2. ®«¼§  ¯ ° ««¥«¼­®© § ¯¨±¨ . . . . . . . . . . . 637
30.2.3. ®¤¥«¨°®¢ ­¨¥ CRCW-¬ ¸¨­» ± ¯®¬®¹¼¾
EREW-¬ ¸¨­» . . . . . . . . . . . . . . . . . . 639
30.3. ¥®°¥¬  °¥­²  ¨ ½´´¥ª²¨¢­®±²¼ ¯® § ²° ² ¬ . . . . 642
30.3.1. ¯° ¦­¥­¨¿ . . . . . . . . . . . . . . . . . . . . 645
30.4. ´´¥ª²¨¢­ ¿ ¯ ° ««¥«¼­ ¿ ®¡° ¡®²ª  ¯°¥´¨ª±®¢ . . 645
30.4.1. ¥ª³°±¨¢­ ¿ ¯ ° ««¥«¼­ ¿ ®¡° ¡®²ª  ¯°¥´¨ª±®¢646
30.4.2. »¡®° ³¤ «¿¥¬»µ ®¡º¥ª²®¢ . . . . . . . . . . . 647
30.4.3. ­ «¨§ . . . . . . . . . . . . . . . . . . . . . . . 647
30.4.4. ¯° ¦­¥­¨¿ . . . . . . . . . . . . . . . . . . . . 649
30.5.  °³¸¥­¨¥ ±¨¬¬¥²°¨¨ (¤¥²¥°¬¨­¨°®¢ ­­»©  «£®°¨²¬) . . . . . . . . . . . . . . . . . . . . . . . . . . . . 649

7

30.5.1.  ±ª° ±ª¨ ¨ ¬ ª±¨¬ «¼­»¥ ­¥§ ¢¨±¨¬»¥ ¬­®¦¥±²¢  . . . . . . . . . . . . . . . . . . . . . . .
30.5.2. »·¨±«¥­¨¥ 6-° ±ª° ±ª¨ . . . . . . . . . . . . .
30.5.3. ®«³·¥­¨¥ ¬ ª±¨¬ «¼­®£® ­¥§ ¢¨±¨¬®£® ¬­®¦¥±²¢  ¨§ 6-° ±ª° ±ª¨ . . . . . . . . . . . . . .
30.5.4. ¯° ¦­¥­¨¿ . . . . . . . . . . . . . . . . . . . .
30.6.  ¤ ·¨ . . . . . . . . . . . . . . . . . . . . . . . . . . .
30.7. ®¬¬¥­² °¨¨ . . . . . . . . . . . . . . . . . . . . . . .

650
651
653
654
654
657

31  ²°¨¶» ¨ ¤¥©±²¢¨¿ ± ­¨¬¨
31.1.  ²°¨¶» ¨ ¨µ ±¢®©±²¢  . . . . . . . . . . . . . . . . .
31.2. «£®°¨²¬ ²° ±±¥­  ³¬­®¦¥­¨¿ ¬ ²°¨¶ . . . . . . .
31.3. ¡° ¹¥­¨¥ ¬ ²°¨¶ . . . . . . . . . . . . . . . . . . . .
31.4. ®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­»¥ ±¨¬¬¥²°¨·¥±ª¨¥ ¬ ²°¨¶» ¨ ¬¥²®¤ ­ ¨¬¥­¼¸¨µ ª¢ ¤° ²®¢ . . . . . . . . . . .

679

33 ¥®p¥²¨ª®-·¨±«®¢»¥  «£®p¨²¬»
33.1.  · «¼­»¥ ±¢¥¤¥­¨¿ ¨§ ²¥®°¨¨ ·¨±¥« . . . . .
33.2.  ¨¡®«¼¸¨© ®¡¹¨© ¤¥«¨²¥«¼ . . . . . . . . .
33.3. ®¤³«¿°­ ¿  °¨´¬¥²¨ª  . . . . . . . . . . . .
33.4. ¥¸¥­¨¥ «¨­¥©­»µ ¤¨®´ ­²®¢»µ ³° ¢­¥­¨© .
33.5. ¨² ©±ª ¿ ²¥®°¥¬  ®¡ ®±² ²ª µ . . . . . . . .
33.6. ²¥¯¥­¼ ½«¥¬¥­²  . . . . . . . . . . . . . . . .
33.7. °¨¯²®±¨±²¥¬  RSA ± ®²ª°»²»¬ ª«¾·®¬ . .
33.8. °®¢¥°ª  ·¨±¥« ­  ¯°®±²®²³ . . . . . . . . . .

712
713
718
722
726
729
732
735
741

.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.

659
659
668
675

34 ®¨±ª ¯®¤±²°®ª
757
34.0.1. ¡®§­ ·¥­¨¿ ¨ ²¥°¬¨­®«®£¨¿ . . . . . . . . . . 758
34.1. °®±²¥©¸¨©  «£®°¨²¬ . . . . . . . . . . . . . . . . . . 759
34.2. «£®°¨²¬  ¡¨­  |  °¯  . . . . . . . . . . . . . . . 761
34.2.1. ¯° ¦­¥­¨¿ . . . . . . . . . . . . . . . . . . . . 764
34.3. ®¨±ª ¯®¤±²°®ª ± ¯®¬®¹¼¾ ª®­¥·­»µ  ¢²®¬ ²®¢ . . . 765
34.3.1. ®­¥·­»¥  ¢²®¬ ²» . . . . . . . . . . . . . . . 765
34.3.2. ¢²®¬ ²» ¤«¿ ¯®¨±ª  ¯®¤±²°®ª . . . . . . . . . 766
34.3.3. »·¨±«¥­¨¥ ´³­ª¶¨¨ ¯¥°¥µ®¤  . . . . . . . . . 770
34.4. «£®°¨²¬ ­³²  | ®°°¨±  | ° ²²  . . . . . . . . 771
34.4.1. °¥´¨ª±-´³­ª¶¨¿,  ±±®¶¨¨°®¢ ­­ ¿ ± ®¡° §¶®¬771
34.4.2. °¥¬¿ ° ¡®²» . . . . . . . . . . . . . . . . . . . 773
34.4.3. °¥´¨ª±-´³­ª¶¨¿ ¢»·¨±«¿¥²±¿ ¯° ¢¨«¼­® . . 774
34.4.4. «£®°¨²¬ KMP ¯° ¢¨«¥­ . . . . . . . . . . . . 776
34.5. «£®°¨²¬ ®©¥°  | ³°  . . . . . . . . . . . . . . . . 777
34.5.1. ¢°¨±²¨ª  ±²®¯-±¨¬¢®«  . . . . . . . . . . . . . 778
34.5.2. ¢°¨±²¨ª  ¡¥§®¯ ±­®£® ±³´´¨ª±  . . . . . . . . 780
34.5.3. ¯° ¦­¥­¨¿ . . . . . . . . . . . . . . . . . . . . 784
34.6.  ¬¥· ­¨¿ . . . . . . . . . . . . . . . . . . . . . . . . . 785

8

35 »·¨±«¨²¥«¼­ ¿ £¥®¬¥²°¨¿
35.1. ¢®©±²¢  ®²°¥§ª®¢ . . . . . . . . . .
35.2. ±²¼ «¨ ¯¥°¥±¥ª ¾¹¨¥±¿ ®²°¥§ª¨? .
35.3. ®±²°®¥­¨¥ ¢»¯³ª«®© ®¡®«®·ª¨ . . .
35.4. ²»±ª ­¨¥ ¯ °» ¡«¨¦ ©¸¨µ ²®·¥ª .
35.5.  ¤ ·¨ . . . . . . . . . . . . . . . . .

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

787
788
793
798
804
807

36 NP-¯®«­®² 
36.1. ®«¨­®¬¨ «¼­®¥ ¢°¥¬¿ . . . . . . . . . . . . .
36.2. °®¢¥°ª  ¯°¨­ ¤«¥¦­®±²¨ ¿§»ª³ ¨ ª« ±± NP
36.3. NP-¯®«­®²  ¨ ±¢®¤¨¬®±²¼ . . . . . . . . . . .
36.4. NP-¯®«­»¥ § ¤ ·¨ . . . . . . . . . . . . . . . .
36.4.1.  ¤ ·  ® ª«¨ª¥ . . . . . . . . . . . . . .
36.4.2.  ¤ ·  ® ¢¥°¸¨­­®¬ ¯®ª°»²¨¨ . . . .
36.4.3.  ¤ ·  ® £ ¬¨«¼²®­®¢®¬ ¶¨ª«¥ . . . .
36.4.4.  ¤ ·  ª®¬¬¨¢®¿¦¥°  . . . . . . . . .

.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.

.
.
.
.
.
.
.
.

811
812
819
824
837
837
839
842
846

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

37 °¨¡«¨¦¥­­»¥  «£®°¨²¬»
37.1.  ¤ ·  ® ¢¥°¸¨­­®¬ ¯®ª°»²¨¨ . . . . . . . . . . . . .
37.2.  ¤ ·  ª®¬¬¨¢®¿¦¥°  . . . . . . . . . . . . . . . . . .
37.2.1.  ¤ ·  ª®¬¬¨¢®¿¦¥°  (± ­¥° ¢¥­±²¢®¬ ²°¥³£®«¼­¨ª ) . . . . . . . . . . . . . . . . . . . . .
37.2.2. ¡¹ ¿ § ¤ ·  ª®¬¬¨¢®¿¦¥°  . . . . . . . . . .
37.3.  ¤ ·  ® ±³¬¬¥ ¯®¤¬­®¦¥±²¢  . . . . . . . . . . . . . .

850
852
854
854
856
863

°¥¤¨±«®¢¨¥

²  ª­¨£  ¯®¤°®¡­® ° ±±ª §»¢ ¥² ® ±®¢°¥¬¥­­»µ ¬¥²®¤ µ ¯®±²°®¥­¨¿ ¨  ­ «¨§   «£®°¨²¬®¢.  ­¥© ¯®¤°®¡­® ° §®¡° ­® ¬­®£® ª®­ª°¥²­»µ  «£®°¨²¬®¢; ¬» ±² ° «¨±¼ ° ±±ª § ²¼ ® ­¨µ ¯®­¿²­®, ­®
­¥ ®¯³±ª ¿ ¤¥² «¥© ¨ ­¥ ¦¥°²¢³¿ ±²°®£®±²¼¾ ¨§«®¦¥­¨¿.
«£®°¨²¬» § ¯¨± ­» ± ¢¨¤¥ À¯±¥¢¤®ª®¤ Á ¨ ¯°®ª®¬¬¥­²¨°®¢ ­»
¢ ²¥ª±²¥; ¬» ±² ° «¨±¼ ±¤¥« ²¼ ®¯¨± ­¨¥  «£®°¨²¬  ¯®­¿²­»¬ «¾¤¿¬ ± ¬¨­¨¬ «¼­»¬ ¯°®£° ¬¬¨±²±ª¨¬ ®¯»²®¬. ­¨£  ±®¤¥°¦¨²
¡®«¥¥ 260 °¨±³­ª®¢, ¯®¿±­¿¾¹¨µ ° ¡®²³ ° §«¨·­»µ  «£®°¨²¬®¢.
» ®¡° ¹ ¥¬ ®±®¡®¥ ¢­¨¬ ­¨¥ ­  ½´´¥ª²¨¢­®±²¼ ° ±±¬ ²°¨¢ ¥¬»µ  «£®°¨²¬®¢ ¨ ¯°¨¢®¤¨¬ ®¶¥­ª¨ ¢°¥¬¥­¨ ¨µ ° ¡®²».
» ±² ° «¨±¼ ­ ¯¨± ²¼ ³·¥¡­¨ª ¯® ¯®±²°®¥­¨¾  «£®°¨²¬®¢ ¨
±²°³ª²³° ¤ ­­»µ, ª®²®°»© ¬®£«¨ ¡» ¨±¯®«¼§®¢ ²¼ ¯°¥¯®¤ ¢ ²¥«¨ ¨ ±²³¤¥­²» | ®² ¯¥°¢®ª³°±­¨ª®¢ ¤®  ±¯¨° ­²®¢. ­¨£  ¬®¦¥²
¡»²¼ ¨±¯®«¼§®¢ ­  ¨ ¤«¿ ± ¬®®¡° §®¢ ­¨¿ ¯°®´¥±±¨®­ «¼­»µ ¯°®£° ¬¬¨±²®¢.
°¥¯®¤ ¢ ²¥«¿¬:
» ±² ° «¨±¼ ±¤¥« ²¼ ¢®§¬®¦­»¬ ¨±¯®«¼§®¢ ­¨¥ ª­¨£¨ ­  ° §­»µ ³°®¢­¿µ | ®² ­ · «¼­®£® ª³°±  ¯® ¯°®£° ¬¬¨°®¢ ­¨¾ ¨
±²°³ª²³° ¬ ¤ ­­»µ ¤®  ±¯¨° ­²±ª®£® ª³°±  ¯® ½´´¥ª²¨¢­»¬  «£®°¨²¬ ¬.  ­¥© £®° §¤® ¡®«¼¸¥ ¬ ²¥°¨ « , ·¥¬ ¬®¦­® ¢ª«¾·¨²¼
¢ ±¥¬¥±²°®¢»© ª³°±, ² ª ·²® ¢» ¬®¦¥²¥ ¢»¡° ²¼ £« ¢» ¯® ¢ª³±³.
» ±² ° «¨±¼ ±¤¥« ²¼ £« ¢» ¤®±² ²®·­® ­¥§ ¢¨±¨¬»¬¨.  ¦¤ ¿
£« ¢  ­ ·¨­ ¥²±¿ ± ¡®«¥¥ ¯°®±²®£® ¬ ²¥°¨ « ; ¡®«¥¥ ²°³¤­»¥ ²¥¬»
®²­¥±¥­» ¢ ° §¤¥«», ¯®¬¥·¥­­»¥ §¢¥§¤®·ª®© ¨ ¯®¬¥¹¥­­»¥ ¢ ª®­¥¶
£« ¢».  «¥ª¶¨¿µ ¤«¿ ­ ·¨­ ¾¹¨µ ¬®¦­® ®£° ­¨·¨²¼±¿ ­¥±ª®«¼ª¨¬¨ ¯¥°¢»¬¨ ° §¤¥« ¬¨ ¢»¡° ­­»µ ¢ ¬¨ £« ¢, ®±² ¢¨¢ ¯®¤°®¡­®¥
¨§³·¥­¨¥ ®±² «¼­»µ ¤«¿ ¡®«¥¥ ¯°®¤¢¨­³²®£® ª³°± .
 ¦¤»© ° §¤¥« ±­ ¡¦¥­ ³¯° ¦­¥­¨¿¬¨ (¢±¥£® ¨µ ¡®«¥¥ 900): ª ¦¤ ¿ £« ¢  § ª ­·¨¢ ¥²±¿ § ¤ · ¬¨ (¢±¥£® ¡®«¥¥ 120).  ª ¯° ¢¨«®,
³¯° ¦­¥­¨¿ ¯°®¢¥°¿¾² ¯®­¨¬ ­¨¥ ¨§«®¦¥­­®£® ¬ ²¥°¨ «  (· ±²¼
¨§ ­¨µ | ³±²­»¥ ¢®¯°®±», · ±²¼ ¯®¤µ®¤¿² ¤«¿ ¯¨±¼¬¥­­®£® ¤®¬ ¸-

10

­¥£® § ¤ ­¨¿).  ¤ ·¨ ¡®«¥¥ ° §¢¥°­³²»; ¬­®£¨¥ ¨§ ­¨µ ¤®¯®«­¿¾²
²¥®°¥²¨·¥±ª¨© ¬ ²¥°¨ « ±®®²¢¥²±²¢³¾¹¥© £« ¢» ¨ ° §¡¨²» ­  · ±²¨, ±®®²¢¥²±²¢³¾¹¨¥ ½² ¯ ¬ ¤®ª § ²¥«¼±²¢  ¨«¨ ¯®±²°®¥­¨¿.
¢¥§¤®·ª®© ®²¬¥·¥­» ¡®«¥¥ ²°³¤­»¥ ³¯° ¦­¥­¨¿ ¨ ° §¤¥«»; ®­¨
¯°¥¤­ §­ ·¥­» ±ª®°¥¥ ¤«¿ ±² °¸¥ª³°±­¨ª®¢ ¨  ±¯¨° ­²®¢.  §¤¥«» ±® §¢¥§¤®·ª®© · ±²® ²°¥¡³¾² «³·¸¥© ¬ ²¥¬ ²¨·¥±ª®© ¯®¤£®²®¢ª¨; ³¯° ¦­¥­¨¥ ±® §¢¥§¤®·ª®© ¬®¦¥² ² ª¦¥ ²°¥¡®¢ ²¼ ¤®¯®«­¨²¥«¼­»µ §­ ­¨© ¨«¨ ¯°®±²® ¡»²¼ ¡®«¥¥ ²°³¤­»¬.
²³¤¥­² ¬:
» ­ ¤¥¥¬±¿, ·²® ª­¨£  ¤®±² ¢¨² ¢ ¬ ³¤®¢®«¼±²¢¨¥ ¨ ¯®§­ ª®¬¨² ± ¬¥²®¤ ¬¨ ¯®±²°®¥­¨¿  «£®°¨²¬®¢. » ±² ° «¨±¼ ¯¨± ²¼
¯®¤°®¡­®, ¯®­¿²­® ¨ ¨­²¥°¥±­®, ­ ¯®¬¨­ ¿ ¯® µ®¤³ ¤¥«  ­¥®¡µ®¤¨¬»¥ ±¢¥¤¥­¨¿ ¨§ ¬ ²¥¬ ²¨ª¨. ®¤£®²®¢¨²¥«¼­»¥ ±¢¥¤¥­¨¿ ®¡»·­®
±®¡° ­» ¢ ­ · «¼­»µ ° §¤¥« µ £« ¢», ª®²®°»¥ ¬®¦­® ¡¥£«® ¯°®±¬®²°¥²¼, ¥±«¨ ¢» ³¦¥ §­ ª®¬» ± ²¥¬®©.
­¨£  ½²  ¢¥«¨ª , ¨ ­  «¥ª¶¨¿µ, ±ª®°¥¥ ¢±¥£®, ¡³¤¥² ° §®¡° ­ 
«¨¸¼ · ±²¼ ¬ ²¥°¨ « . » ­ ¤¥¥¬±¿, ·²® ®±² ¢¸ ¿±¿ · ±²¼ ¡³¤¥²
¢ ¬ ¯®«¥§­  ¥±«¨ ­¥ ±¥©· ±, ² ª ¢ ¡³¤³¹¥¬, ² ª ·²® ¢» ±®µ° ­¨²¥
ª­¨£³ ¢ ª ·¥±²¢¥ ±¯° ¢®·­¨ª .
²® ­³¦­® §­ ²¼, ¯°¨±²³¯ ¿ ª ·²¥­¨¾? » ° ±±·¨²»¢ ¥¬, ·²®
¢»
 ¨¬¥¥²¥ ­¥ª®²®°»© ¯°®£° ¬¬¨±²±ª¨© ®¯»², ¨ °¥ª³°±¨¢­»¥ ¯°®¶¥¤³°», ¬ ±±¨¢» ¨ ±¯¨±ª¨ ¢ ± ­¥ ¯³£ ¾²;
 ¯°®±²»¥ ¬ ²¥¬ ²¨·¥±ª¨¥ ° ±±³¦¤¥­¨¿ (±ª ¦¥¬, ¤®ª § ²¥«¼±²¢ 
¯® ¨­¤³ª¶¨¨) ¢ ¬ ² ª¦¥ §­ ª®¬» (ª®¥-£¤¥ ¯®­ ¤®¡¿²±¿ ®²¤¥«¼­»¥ ´ ª²» ¨§ ª³°±  ¬ ²¥¬ ²¨·¥±ª®£®  ­ «¨§ ; ¢ ¯¥°¢®© · ±²¨
¡®«¼¸¥ ­¨·¥£® ¨§ ¬ ²¥¬ ²¨ª¨ ­¥ ¯®²°¥¡³¥²±¿).
°®£° ¬¬¨±² ¬:
 ª­¨£³ ¢ª«¾·¥­»  «£®°¨²¬» ¤«¿ ± ¬»µ ° §­»µ § ¤ · ¨ ¥¥ ¬®¦­® ¨±¯®«¼§®¢ ²¼ ª ª ±¯° ¢®·­¨ª. « ¢» ¯®·²¨ ­¥§ ¢¨±¨¬», ² ª ·²®
¬®¦­® ±° §³ ¢»¡° ²¼ ¨­²¥°¥±³¾¹¨© ¢ ± ¬ ²¥°¨ «.
®«¼¸¨­±²¢® ®¡±³¦¤ ¥¬»µ  «£®°¨²¬®¢ ¢¯®«­¥ ¬®£³² ¡»²¼ ¨±¯®«¼§®¢ ­» ­  ¯° ª²¨ª¥, ¨ ¬» ³¤¥«¿¥¬ ¤®«¦­®¥ ¢­¨¬ ­¨¥ ¤¥² «¿¬ °¥ «¨§ ¶¨¨. ±«¨  «£®°¨²¬ ¯°¥¤±² ¢«¿¥² ±ª®°¥¥ ²¥®°¥²¨·¥±ª¨© ¨­²¥°¥±, ¬» ®²¬¥· ¥¬ ½²® ¨ ®¡±³¦¤ ¥¬  «¼²¥°­ ²¨¢­»¥ ¯®¤µ®¤».
 ¸ ¯±¥¢¤®ª®¤ «¥£ª® ¯¥°¥¢¥±²¨ ­  «¾¡®© ¿§»ª ¯°®£° ¬¬¨°®¢ ­¨¿, ¥±«¨ ½²® ¯®­ ¤®¡¨²±¿.  ¤® ²®«¼ª® ¨¬¥²¼ ¢ ¢¨¤³, ·²® ¬» ­¥
¢ª«¾· ¥¬ ¢  «£®°¨²¬» ±¨±²¥¬­®-§ ¢¨±¨¬»¥ ´° £¬¥­²» (®¡° ¡®²ª³ ®¸¨¡®ª ¨ ². ¯.), ·²®¡» ­¥ § ²¥¬­¿²¼ ±³²¨ ¤¥« .

11

¸¨¡ª¨
­¨£  ² ª®£® ®¡º¥¬  ­¥ ¬®¦¥² ­¥ ±®¤¥°¦ ²¼ ®¸¨¡®ª. ±«¨ ¢»
®¡­ °³¦¨«¨ ®¸¨¡ª³ ¢  ­£«¨©±ª®¬ ®°¨£¨­ «¥ ª­¨£¨, ¨«¨ ³ ¢ ± ¥±²¼
¯°¥¤«®¦¥­¨¿ ¯® ¥¥ ¨±¯° ¢«¥­¨¾, ¬» ¡³¤¥¬ ° ¤» ³§­ ²¼ ®¡ ½²®¬.
» ¡³¤¥¬ ®±®¡¥­­® ° ¤» ­®¢»¬ ³¯° ¦­¥­¨¿¬ ¨ § ¤ · ¬ (­®, ¯®¦ «³©±² , ¯°¨±»« ©²¥ ¨µ ± °¥¸¥­¨¿¬¨). ®·²®¢»©  ¤°¥±:
Introduction to Algorithms
MIT Labratory for Computer Science
545 Technology Square
Cambridge, Massachusetts 02139
®¦­® ² ª¦¥ ¯®«³·¨²¼ ±¯¨±®ª ¨§¢¥±²­»µ ®¯¥· ²®ª ¨ ±®®¡¹¨²¼ ® ­ ©¤¥­­»µ ®¸¨¡ª µ ± ¯®¬®¹¼¾ ½«¥ª²°®­­®©
¯®·²»; ·²®¡» ¯®«³·¨²¼ ¨­±²°³ª¶¨¨, ¯®¸«¨²¥ ¯®  ¤°¥±³
algorithms@theory.lcs.mit.edu ¯¨±¼¬®, ±®¤¥°¦ ¹¥¥ Subject:
help ¢ § £®«®¢ª¥. §¢¨­¨²¥, ·²® ¬» ­¥ ¬®¦¥¬ «¨·­® ®²¢¥²¨²¼ ­ 
¢±¥ ¯¨±¼¬ .
[°¨ ¯¥°¥¢®¤¥ ¡»«¨ ³·²¥­» ¢±¥ ¨±¯° ¢«¥­¨¿, ¨¬¥¢¸¨¥±¿ ­  ¬®¬¥­² ¨§¤ ­¨¿ ¯¥°¥¢®¤  (¤¥ª ¡°¼ 1997), ª°®¬¥ ²®£®, ¨±¯° ¢«¥­® ­¥±ª®«¼ª® ®¡­ °³¦¥­­»µ ¯°¨ ¯¥°¥¢®¤¥ ®¯¥· ²®ª, ­®, ¢®§¬®¦­®, ¢®§­¨ª«¨ ­®¢»¥ (¢ ·¥¬ ¢¨­®¢ ² ­ ³·­»© °¥¤ ª²®° ª­¨£¨, . ¥­¼).
®½²®¬³, ®¡­ °³¦¨¢ ®¸¨¡ª³ ¢ °³±±ª®¬ ²¥ª±²¥, ­¥ ¯®±»« ©²¥ ¥¥ ±° §³  ¢²®° ¬: ¬®¦¥² ¡»²¼, ®­  ¢®§­¨ª«  ¯°¨ ¯¥°¥¢®¤¥! ®®¡¹¨²¥ ®
­¥© ±­ · «  ¯¥°¥¢®¤·¨ª ¬, ¯®  ¤°¥±³ algor@mccme.ru ¨«¨ ¯® ¯®·²¥
(®±ª¢ , 121002, ®«¼¸®© « ±¼¥¢±ª¨© ¯¥°., 11, ®±ª®¢±ª¨© ¶¥­²°
­¥¯°¥°»¢­®£® ¬ ²¥¬ ²¨·¥±ª®£® ®¡° §®¢ ­¨¿, ¨§¤ ²¥«¼±²¢®).]
« £®¤ °­®±²¨
­®£¨¥ ¤°³§¼¿ ¨ ª®««¥£¨ ­¥¬ «® ±¤¥« «¨ ¤«¿ ³«³·¸¥­¨¿ ½²®©
ª­¨£¨. » ¡« £®¤ °¨¬ ¢±¥µ ¨µ §  ¯®¬®¹¼ ¨ ª®­±²°³ª²¨¢­³¾ ª°¨²¨ª³.
 ¡®° ²®°¨¿ ¨­´®°¬ ²¨ª¨  ±± ·³±¥²±ª®£® ²¥µ­®«®£¨·¥±ª®£®
¨­±²¨²³²  (Massachusetts Institute of Technology, Laboratory for
Computer Science) ¡»«  ¨¤¥ «¼­»¬ ¬¥±²®¬ ¤«¿ ° ¡®²» ­ ¤ ª­¨£®©.  ¸¨ ª®««¥£¨ ¯® ²¥®°¥²¨·¥±ª®© £°³¯¯¥ ½²®© « ¡®° ²®°¨¨ ¡»«¨ ®±®¡¥­­® ²¥°¯¨¬» ¨ «¾¡¥§­® ±®£« ¸ «¨±¼ ¯°®±¬ ²°¨¢ ²¼ £« ¢»
ª­¨£¨. » µ®²¥«¨ ¡» ®±®¡¥­­® ¯®¡« £®¤ °¨²¼ ±«¥¤³¾¹¨µ ¨§ ­¨µ:
Baruch Awerbuch, Sha Goldwasser, Leo Guibas, Tom Leighton, Albert Meyer, David Shmoys, Eva Tardos. ®¬¯¼¾²¥°», ­  ª®²®°»µ £®²®¢¨« ±¼ ª­¨£  (²°¥µ ²¨¯®¢: Microvax, Apple Macintosh, Sun Sparcstation) ¯®¤¤¥°¦¨¢ «¨ William Ang, Sally Bemus, Ray Hirschfeld ¨
Mark Reinhold; ®­¨ ¦¥ ¯¥°¥ª®¬¯¨«¨°®¢ «¨ TEX, ª®£¤  ­ ¸¨ ´ ©«» ¯¥°¥±² «¨ ¯®¬¥¹ ²¼±¿ ¢ ¥£® ±² ­¤ °²­³¾ ¢¥°±¨¾. ®¬¯ ­¨¿
Thinking Machines ¯®¤¤¥°¦¨¢ «   °«¼§  ¥©§¥°±®­  ¢ ¯¥°¨®¤ ¥£®

12

° ¡®²» ¢ ½²®© ª®¬¯ ­¨¨.
­®£¨¥ ­ ¸¨ ª®««¥£¨ ¨±¯®«¼§®¢ «¨ ¯°¥¤¢ °¨²¥«¼­»¥ ¢ °¨ ­²»
½²®© ª­¨£¨ ¢ ±¢®¨µ «¥ª¶¨®­­»µ ª³°± µ, ¨ ¯°¥¤«®¦¨«¨ ° §«¨·­»¥
³«³·¸¥­¨¿. » µ®²¥«¨ ¡» ®±®¡¥­­® ¯®¡« £®¤ °¨²¼ ±«¥¤³¾¹¨µ ­ ¸¨µ ª®««¥£: Richard Beigel (Yale), Andrew Goldberg (Stanford), Joan
Lucas (Rutgers), Mark Overmars (Utrecht), Alan Sherman (Tufts,
Maryland), Diane Souvaine (Rutgers).
°¨ ·²¥­¨¨ «¥ª¶¨© ¯® ¬ ²¥°¨ « ¬ ½²®© ª­¨£¨ ­ ¬ ¯®¬®£ «¨ ­ ¸¨ ª®««¥£¨, ª®²®°»¥ ¢­¥±«¨ ¬­®£® ³«³·¸¥­¨©. » ®±®¡¥­­® ¯°¨§­ ²¥«¼­»: Alan Baratz, Bonnie Berger, Aditi Dhagat, Burt Kaliski,
Arthur Lent, Andrew Moulton, Marios Papaefthymiou, Cindy Phillips,
Mark Reinhold, Phil Rogaway, Flavio Rose, Arie Rudich, Alan Sherman, Cli Stein, Susmita Sur, Gregory Troxel, Margaret Tuttle.
­®£¨¥ «¾¤¨ ¯®¬®£«¨ ­ ¬ ¢ ° ¡®²¥ ­ ¤ ª­¨£®© ¢ ° §­»µ ®²­®¸¥­¨¿µ: ° ¡®²  ¢ ¡¨¡«¨®²¥ª¥ (Denise Sergent), £®±²¥¯°¨¨¬±²¢® ¢
·¨² «¼­®¬ § «¥ (Maria Sensale), ¤®±²³¯ ª «¨·­®© ¡¨¡«¨®²¥ª¥ (Albert Meyer), ¯°®¢¥°ª  ³¯° ¦­¥­¨© ¨ ¯°¨¤³¬»¢ ­¨¥ ­®¢»µ (Shlomo Kipnis, Bill Niehaus, David Wilson), ±®±² ¢«¥­¨¥ ¨­¤¥ª±  (Marios
Papaefthymiou, Gregory Troxel), ²¥µ­¨·¥±ª ¿ ¯®¬®¹¼ (Inna Radzihovsky, Denise Sergent, Gayle Sherman, ¨ ®±®¡¥­­® Be Hubbard).
­®£¨¥ ®¸¨¡ª¨ ®¡­ °³¦¨«¨ ­ ¸¨ ±²³¤¥­²», ®±®¡¥­­® Bobby
Blumofe, Bonnie Eisenberg, Raymond Johnson, John Keen, Richard
Lethin, Mark Lillibridge, John Pesaris, Steve Ponzio, Margaret Tuttle.
­®£¨¥ ­ ¸¨ ª®««¥£¨ ±®®¡¹¨«¨ ­ ¬ ¯®«¥§­³¾ ¨­´®°¬ ¶¨¾ ®
ª®­ª°¥²­»µ  «£®°¨²¬ µ,   ² ª¦¥ ª°¨²¨·¥±ª¨ ¯°®·¨² «¨ ®²¤¥«¼­»¥ £« ¢» ª­¨£¨; ¢ ¨µ ·¨±«¥ Bill Aiello, Alok Aggrawal, Eric Bach,
Vasek Chvatal, Richard Cole, Johan Hastad, Alex Ishii, David Johnson,
Joe Kilian, Dina Kravets, Bruce Maggs, Jim Orlin, James Park, Thane
Plambeck, Herschel Safer, Je Shallit, Cli Stein, Gil Strang, Bob Tarjan, Paul Wang. ­®£¨¥ ¨§ ­¨µ ¯°¥¤«®¦¨«¨ ­ ¬ § ¤ ·¨ ¤«¿ ­ ¸¥©
ª­¨£¨, ±°¥¤¨ ­¨µ Andrew Goldberg, Danny Sleator, Umesh Vazirani.
­£«¨©±ª¨© ®°¨£¨­ « ª­¨£¨ ¡»« ¯®¤£®²®¢«¥­ ± ¯®¬®¹¼¾ LATEX
(¬ ª°®¯ ª¥² ¤«¿ ±¨±²¥¬» TEX). ¨±³­ª¨ ¤¥« «¨±¼ ­  ª®¬¯¼¾²¥°¥ Apple Macintosh ± ¯®¬®¹¼¾ ¯°®£° ¬¬» Mac Draw II; ¬» ¡« £®¤ °­» §  ®¯¥° ²¨¢­³¾ ²¥µ­¨·¥±ª³¾ ¯®¤¤¥°¦ª³ ¢ ½²®© ®¡« ±²¨
(Joanna Terry, Claris Corporation; Michael Mahoney, Advanced Computer Graphics). ­¤¥ª± ¡»« ¯®¤£®²®¢«¥­ ± ¯®¬®¹¼¾ ¯°®£° ¬¬»
Windex, ­ ¯¨± ­­®©  ¢²®° ¬¨. ¯¨±®ª «¨²¥° ²³°» £®²®¢¨«±¿ ± ¯®¬®¹¼¾ ¯°®£° ¬¬» BibTEX. °¨£¨­ «-¬ ª¥²  ­£«¨©±ª®£® ¨§¤ ­¨¿
¡»« ¯®¤£®²®¢«¥­ ¢ ¬¥°¨ª ­±ª®¬ ¬ ²¥¬ ²¨·¥±ª®¬ ®¡¹¥±²¢¥ ± ¯®¬®¹¼¾ ´®²®­ ¡®°­®© ¬ ¸¨­» ´¨°¬» Autologic; ¬» ¯°¨§­ ²¥«¼­»
§  ¯®¬®¹¼ ¢ ½²®¬ (Ralph Youngen, ¬¥°¨ª ­±ª®¥ ¬ ²¥¬ ²¨·¥±ª®¥
®¡¹¥±²¢®).  ª¥² ° §° ¡®² «¨: Rebecca Daw, Amy Henderson (°¥ «¨§ ¶¨¿ ¬ ª¥²  ¤«¿ ±¨±²¥¬» LATEX), Jeannet Leendertse (®¡«®¦ª ).
¢²®°» ¯®«³·¨«¨ ¡®«¼¸®¥ ³¤®¢®«¼±²¢¨¥ ®² ±®²°³¤­¨·¥±²¢  ± ¨§¤ ²¥«¼±²¢ ¬¨ MIT Press (Frank Sallow, Terry Ehling, Larry Cohen,

13

Lorrie Lejeune) ¨ McGraw-Hill (David Shapiro) ¨ ¡« £®¤ °­» ¨¬
§  ¯®¤¤¥°¦ª³ ¨ ²¥°¯¥­¨¥,   ² ª¦¥ § ¬¥· ²¥«¼­®¥ °¥¤ ª²¨°®¢ ­¨¥
(Larry Cohen).
 ª®­¥¶,  ¢²®°» ¡« £®¤ °¿² ±¢®¨µ ¦¥­ (Nicole Cormen, Lina Lue
Leicerson, Gail Rivest) ¨ ¤¥²¥© (Ricky, William ¨ Debby Leicerson;
Alex ¨ Christopher Rivest) §  «¾¡®¢¼ ¨ ¯®¤¤¥°¦ª³ ¯°¨ ° ¡®²¥ ­ ¤
ª­¨£®© (Alex Rivest ² ª¦¥ ¯®¬®£ ­ ¬ ± À¯ ° ¤®ª±®¬ ¤­¥© °®¦¤¥­¨¿
­   °±¥Á (° §¤¥« 6.6.1). ¾¡®¢¼, ²¥°¯¥­¨¥ ¨ ¯®¤¤¥°¦ª  ­ ¸¨µ
±¥¬¥© ±¤¥« «¨ ½²³ ª­¨£³ ¢®§¬®¦­®©; ¨¬ ®­  ¨ ¯®±¢¿¹ ¥²±¿.
¥¬¡°¨¤¦,
 ±± ·³±¥²±
¬ °² 1990 £®¤ 

®¬ ± ®°¬¥­ (Thomas H. Cormen)
 °«¼§ ¥©§¥°±®­ (Charles E. Leiserson)
®­ «¼¤ ¨¢¥±² (Ronald L. Rivest)

² ¯¥°¥¢®¤·¨ª®¢:
» ¯°¨§­ ²¥«¼­» ¨§¤ ²¥«¼±²¢³ MIT ¨  ¢²®° ¬ §  ° §°¥¸¥­¨¥
¯¥°¥¢¥±²¨ ª­¨£³, ¨ §  ¯®¬®¹¼ ¯°¨ ¯®¤£®²®¢ª¥ ¯¥°¥¢®¤  (¢ ²®¬ ·¨±«¥ §  ¯°¥¤®±² ¢«¥­¨¥  ­£«¨©±ª®£® ²¥ª±²  ª­¨£¨ ¨ ¨««¾±²° ¶¨© ¢
½«¥ª²°®­­®© ´®°¬¥). §¤ ­¨¥ ¯¥°¥¢®¤  ±² «® ¢®§¬®¦­® ¡« £®¤ °¿
´¨­ ­±®¢®© ¯®¤¤¥°¦ª¥ ®±±¨©±ª®£® ´®­¤  ´³­¤ ¬¥­² «¼­»µ ¨±±«¥¤®¢ ­¨© (°³ª®¢®¤¨²¥«¼ ¯°®¥ª²  .. ±¯¥­±ª¨©).
 ° ¡®²¥ ­ ¤ ¯¥°¥¢®¤®¬ ª­¨£¨ ³· ±²¢®¢ «  ¡®«¼¸ ¿ £°³¯¯  ±²³¤¥­²®¢,  ±¯¨° ­²®¢ ¨ ±®²°³¤­¨ª®¢ ®±ª®¢±ª®£® ¶¥­²°  ­¥¯°¥°»¢­®£® ¬ ²¥¬ ²¨·¥±ª®£® ®¡° §®¢ ­¨¿, ¥§ ¢¨±¨¬®£® ®±ª®¢±ª®£®
³­¨¢¥°±¨²¥²  ¨ :
K. ¥«®¢, . ®° ¢«¥¢, . ®²¨­, . ®°¥«¨ª, . ¥°¿£¨­
.  «­¨¸ª ­, .  ² ­®¢ , . ¼¢®¢±ª¨©, . ®¬ ¹¥­ª®, . ®­¨­, . °³¸ª¨­, . ¸ ª®¢, . ¥­¼, . ³¢ «®¢, . ¤ ¸ª¨­
(¯¥°¥¢®¤)
. ª¨¬®¢, . ¼¾£¨­, . ¥°¿£¨­, . ¢´¨¬¼¥¢±ª¨©, .  «­¨¸ª ­, . ®¬ ¹¥­ª®, . ¥°­®¢ . ¸ ª®¢, A. ¥­¼ (°¥¤ ª²¨°®¢ ­¨¥)
.  ¤¨®­®¢ (¢¥°±²ª )
.. ¹¥­ª® (°¥¤ ª²®°)

1

¢¥¤¥­¨¥

 ½²®© £« ¢¥ ¬» ° §¡¨° ¥¬ ®±­®¢­»¥ ¯®­¿²¨¿ ¨ ¬¥²®¤», ±¢¿§ ­­»¥
± ¯®±²°®¥­¨¥¬ ¨  ­ «¨§®¬  «£®°¨²¬®¢, ­  ¯°¨¬¥°¥ ¤¢³µ  «£®°¨²¬®¢ ±®°²¨°®¢ª¨ | ¯°®±²¥©¸¥£®  «£®°¨²¬  ±®°²¨°®¢ª¨ ¢±² ¢ª ¬¨
¨ ¡®«¥¥ ½´´¥ª²¨¢­®£®  «£®°¨²¬  ±®°²¨°®¢ª¨ ±«¨¿­¨¥¬.
  ½²¨µ ¯°¨¬¥° µ ¬» ¯®§­ ª®¬¨¬±¿ ± ¯±¥¢¤®ª®¤®¬, ­  ª®²®°®¬
¬» ¡³¤¥¬ § ¯¨±»¢ ²¼  «£®°¨²¬», ®¡®§­ ·¥­¨¿¬¨ ¤«¿ ±ª®°®±²¨ °®±²  ´³­ª¶¨©, ¬¥²®¤®¬ À° §¤¥«¿© ¨ ¢« ±²¢³©Á ¯®±²°®¥­¨¿  «£®°¨²¬®¢,   ² ª¦¥ ± ¤°³£¨¬¨ ¯®­¿²¨¿¬¨, ª®²®°»¥ ¡³¤³² ¢±²°¥· ²¼±¿
­ ¬ ­  ¯°®²¿¦¥­¨¨ ¢±¥© ª­¨£¨.

1.1. «£®°¨²¬»
«£®°¨²¬ (algorithm) | ½²® ´®°¬ «¼­® ®¯¨± ­­ ¿ ¢»·¨±«¨²¥«¼­ ¿ ¯°®¶¥¤³° , ¯®«³· ¾¹ ¿ ¨±µ®¤­»¥ ¤ ­­»¥ (input), ­ §»¢ ¥¬»¥
² ª¦¥ ¢µ®¤®¬  «£®°¨²¬  ¨«¨ ¥£®  °£³¬¥­²®¬, ¨ ¢»¤ ¾¹ ¿ °¥§³«¼² ² ¢»·¨±«¥­¨© ­  ¢»µ®¤ (output).
«£®°¨²¬» ±²°®¿²±¿ ¤«¿ °¥¸¥­¨¿ ²¥µ ¨«¨ ¨­»µ ¢»·¨±«¨²¥«¼­»µ
§ ¤ · (computational problems). ®°¬³«¨°®¢ª  § ¤ ·¨ ®¯¨±»¢ ¥²,
ª ª¨¬ ²°¥¡®¢ ­¨¿¬ ¤®«¦­® ³¤®¢«¥²¢®°¿²¼ °¥¸¥­¨¥ § ¤ ·¨,    «£®°¨²¬, °¥¸ ¾¹¨© ½²³ § ¤ ·³, ­ µ®¤¨² ®¡º¥ª², ½²¨¬ ²°¥¡®¢ ­¨¿¬
³¤®¢«¥²¢®°¿¾¹¨©.
 ½²®© £« ¢¥ ¬» ° ±±¬ ²°¨¢ ¥¬ § ¤ ·³ ±®°²¨°®¢ª¨ (sorting problem); ¯®¬¨¬® ±¢®¥© ¯° ª²¨·¥±ª®© ¢ ¦­®±²¨ ½²  § ¤ ·  ±«³¦¨²
³¤®¡­»¬ ¯°¨¬¥°®¬ ¤«¿ ¨««¾±²° ¶¨¨ ° §«¨·­»µ ¯®­¿²¨© ¨ ¬¥²®¤®¢. ­  ®¯¨±»¢ ¥²±¿ ² ª:
µ®¤: ®±«¥¤®¢ ²¥«¼­®±²¼ n ·¨±¥« (a1 ; a2; : : :; an).
»µ®¤: ¥°¥±² ­®¢ª  (a01 ; a02; : : :; a0n ) ¨±µ®¤­®© ¯®±«¥¤®¢ ²¥«¼­®±²¨, ¤«¿ ª®²®°®© a01 6 a02 6 : : : 6 a0n .
 ¯°¨¬¥°, ¯®«³·¨¢ ­  ¢µ®¤ h31; 41; 59; 26; 41; 58i,  «£®°¨²¬ ±®°²¨°®¢ª¨ ¤®«¦¥­ ¢»¤ ²¼ ­  ¢»µ®¤ h26; 31; 41; 41; 58; 59i.
®¤«¥¦ ¹ ¿ ±®°²¨°®¢ª¥ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ­ §»¢ ¥²±¿ ¢µ®¤®¬
(instance) § ¤ ·¨ ±®°²¨°®¢ª¨.

«£®°¨²¬»

15

­®£¨¥  «£®°¨²¬» ¨±¯®«¼§³¾² ±®°²¨°®¢ª³ ¢ ª ·¥±²¢¥ ¯°®¬¥¦³²®·­®£® ¸ £ . ¬¥¥²±¿ ¬­®£® ° §­»µ  «£®°¨²¬®¢ ±®°²¨°®¢ª¨;
¢»¡®° ¢ ª®­ª°¥²­®© ±¨²³ ¶¨¨ § ¢¨±¨² ®² ¤«¨­» ±®°²¨°³¥¬®© ¯®±«¥¤®¢ ²¥«¼­®±²¨, ®² ²®£®, ¢ ª ª®© ±²¥¯¥­¨ ®­  ³¦¥ ®²±®°²¨°®¢ ­ ,
  ² ª¦¥ ®² ²¨¯  ¨¬¥¾¹¥©±¿ ¯ ¬¿²¨ (®¯¥° ²¨¢­ ¿ ¯ ¬¿²¼, ¤¨±ª¨,
¬ £­¨²­»¥ «¥­²»).
«£®°¨²¬ ±·¨² ¾² ¯° ¢¨«¼­»¬ (correct), ¥±«¨ ­  «¾¡®¬ ¤®¯³±²¨¬®¬ (¤«¿ ¤ ­­®© § ¤ ·¨) ¢µ®¤¥ ®­ ®­ § ª ­·¨¢ ¥² ° ¡®²³ ¨
¢»¤ ¥² °¥§³«¼² ², ³¤®¢«¥²¢®°¿¾¹¨© ²°¥¡®¢ ­¨¿¬ § ¤ ·¨.  ½²®¬
±«³· ¥ £®¢®°¿², ·²®  «£®°¨²¬ °¥¸ ¥² (solves) ¤ ­­³¾ ¢»·¨±«¨²¥«¼­³¾ § ¤ ·³. ¥¯° ¢¨«¼­»©  «£®°¨²¬ ¬®¦¥² (¤«¿ ­¥ª®²®°®£®
¢µ®¤ ) ¢®¢±¥ ­¥ ®±² ­®¢¨²¼±¿ ¨«¨ ¤ ²¼ ­¥¯° ¢¨«¼­»© °¥§³«¼² ².
(¯°®·¥¬, ½²® ­¥ ¤¥« ¥²  «£®°¨²¬ § ¢¥¤®¬® ¡¥±¯®«¥§­»¬ | ¥±«¨
®¸¨¡ª¨ ¤®±² ²®·­® °¥¤ª¨. ®¤®¡­ ¿ ±¨²³ ¶¨¿ ¢±²°¥²¨²±¿ ­ ¬ ¢
£« ¢¥ 33 ¯°¨ ¯®¨±ª¥ ¡®«¼¸¨µ ¯°®±²»µ ·¨±¥«. ® ½²® ¢±¥ ¦¥ ±ª®°¥¥
¨±ª«¾·¥­¨¥, ·¥¬ ¯° ¢¨«®.)
«£®°¨²¬ ¬®¦¥² ¡»²¼ § ¯¨± ­ ­  °³±±ª®¬ ¨«¨  ­£«¨©±ª®¬ ¿§»ª¥,
¢ ¢¨¤¥ ª®¬¯¼¾²¥°­®© ¯°®£° ¬¬» ¨«¨ ¤ ¦¥ ¢ ¬ ¸¨­­»µ ª®¤ µ |
¢ ¦­® ²®«¼ª®, ·²®¡» ¯°®¶¥¤³°  ¢»·¨±«¥­¨© ¡»«  ·¥²ª® ®¯¨± ­ .
» ¡³¤¥¬ § ¯¨±»¢ ²¼  «£®°¨²¬» ± ¯®¬®¹¼¾ ¯±¥¢¤®ª®¤  (pseudocode), ª®²®°»© ­ ¯®¬­¨² ¢ ¬ §­ ª®¬»¥ ¿§»ª¨ ¯°®£° ¬¬¨°®¢ ­¨¿ (¨,  ±ª «¼, «£®«).  §­¨¶  ¢ ²®¬, ·²® ¨­®£¤  ¬» ¯®§¢®«¿¥¬
±¥¡¥ ®¯¨± ²¼ ¤¥©±²¢¨¿  «£®°¨²¬  À±¢®¨¬¨ ±«®¢ ¬¨Á, ¥±«¨ ² ª ¯®«³· ¥²±¿ ¿±­¥¥. °®¬¥ ²®£®, ¬» ®¯³±ª ¥¬ ²¥µ­®«®£¨·¥±ª¨¥ ¯®¤°®¡­®±²¨ (®¡° ¡®²ª³ ®¸¨¡®ª, ±ª ¦¥¬), ª®²®°»¥ ­¥®¡µ®¤¨¬» ¢ °¥ «¼­®©
¯°®£° ¬¬¥, ­® ¬®£³² § ±«®­¨²¼ ±³¹¥±²¢® ¤¥« .
®°²¨°®¢ª  ¢±² ¢ª ¬¨
®°²¨°®¢ª  ¢±² ¢ª ¬¨ (insertion sort) ³¤®¡­  ¤«¿ ±®°²¨°®¢ª¨ ª®°®²ª¨µ ¯®±«¥¤®¢ ²¥«¼­®±²¥©. ¬¥­­® ² ª¨¬ ±¯®±®¡®¬ ®¡»·­® ±®°²¨°³¾² ª °²»: ¤¥°¦  ¢ «¥¢®© °³ª¥ ³¦¥ ³¯®°¿¤®·¥­­»¥ ª °²» ¨
¢§¿¢ ¯° ¢®© °³ª®© ®·¥°¥¤­³¾ ª °²³, ¬» ¢±² ¢«¿¥¬ ¥¥ ¢ ­³¦­®¥
¬¥±²®, ±° ¢­¨¢ ¿ ± ¨¬¥¾¹¨¬¨±¿ ¨ ¨¤¿ ±¯° ¢  ­ «¥¢® (±¬. °¨±. 1.1)
 ¯¨¸¥¬ ½²®²  «£®°¨²¬ ¢ ¢¨¤¥ ¯°®¶¥¤³°» Insertion-Sort, ¯ ° ¬¥²°®¬ ª®²®°®© ¿¢«¿¥²±¿ ¬ ±±¨¢ A[1 : :n] (¯®±«¥¤®¢ ²¥«¼­®±²¼
¤«¨­» n, ¯®¤«¥¦ ¹ ¿ ±®°²¨°®¢ª¥). » ®¡®§­ · ¥¬ ·¨±«® ½«¥¬¥­²®¢ ¢ ¬ ±±¨¢¥ A ·¥°¥§ length[A]. ®±«¥¤®¢ ²¥«¼­®±²¼ ±®°²¨°³¥²±¿
À­  ¬¥±²¥Á (in place), ¡¥§ ¤®¯®«­¨²¥«¼­®© ¯ ¬¿²¨ (¯®¬¨¬® ¬ ±±¨¢ 
¬» ¨±¯®«¼§³¥¬ «¨¸¼ ´¨ª±¨°®¢ ­­®¥ ·¨±«® ¿·¥¥ª ¯ ¬¿²¨). ®±«¥
¢»¯®«­¥­¨¿ ¯°®¶¥¤³°» Insertion-Sort ¬ ±±¨¢ A ³¯®°¿¤®·¥­ ¯®
¢®§° ±² ­¨¾.

16

« ¢  1 ¢¥¤¥­¨¥

¨±. 1.1

®°²¨°®¢ª  ª °² ¢±² ¢ª ¬¨

Insertion-Sort(A)

1 for j 2 to length[A]
2
do key A[j ]
3
. ¤®¡ ¢¨²¼ A[j ] ª ®²±®°²¨°®¢ ­­®© · ±²¨ A[1 : :j ; 1].
4
i j ;1
5
while i > 0 and A[i] > key
6
do A[i + 1] A[i]
7
i i;1
8
A[i + 1] key

 ¡®²  ¯°®¶¥¤³°» Insertion-Sort ¤«¿ ¢µ®¤  A = h5; 2; 4; 6; 1; 3i. ®§¨¶¨¿ j ¯®ª § ­  ª°³¦ª®¬.
¨±. 1.2

  °¨±. 1.2 ¯®ª § ­  ° ¡®²   «£®°¨²¬  ¯°¨ A = h5; 2; 4; 6; 1; 3i.
­¤¥ª± j ³ª §»¢ ¥² À®·¥°¥¤­³¾ ª °²³Á (²®«¼ª® ·²® ¢§¿²³¾ ±® ±²®« ). · ±²®ª A[1 : :j ; 1] ±®±² ¢«¿¾² ³¦¥ ®²±®°²¨°®¢ ­­»¥ ª °²»
(«¥¢ ¿ °³ª ),   A[j + 1 : :n] | ¥¹¥ ­¥ ¯°®±¬®²°¥­­»¥.  ¶¨ª«¥ for
¨­¤¥ª± j ¯°®¡¥£ ¥² ¬ ±±¨¢ ±«¥¢  ­ ¯° ¢®. » ¡¥°¥¬ ½«¥¬¥­² A[j ]

«£®°¨²¬»

17

(±²°®ª  2  «£®°¨²¬ ) ¨ ±¤¢¨£ ¥¬ ¨¤³¹¨¥ ¯¥°¥¤ ­¨¬ ¨ ¡®«¼¸¨¥ ¥£®
¯® ¢¥«¨·¨­¥ ½«¥¬¥­²» (­ ·¨­ ¿ ± j ; 1-£®) ¢¯° ¢®, ®±¢®¡®¦¤ ¿ ¬¥±²® ¤«¿ ¢§¿²®£® ½«¥¬¥­² . (±²°®ª¨ 4{7).  ±²°®ª¥ 8 ½«¥¬¥­² A[j ]
¯®¬¥¹ ¥²±¿ ¢ ®±¢®¡®¦¤¥­­®¥ ¬¥±²®.
±¥¢¤®ª®¤
®² ®±­®¢­»¥ ±®£« ¸¥­¨¿, ª®²®°»¥ ¬» ¡³¤¥¬ ¨±¯®«¼§®¢ ²¼:
1. ²±²³¯ ®² «¥¢®£® ¯®«¿ ³ª §»¢ ¥² ­  ³°®¢¥­¼ ¢«®¦¥­­®±²¨.
 ¯°¨¬¥°, ²¥«® ¶¨ª«  for (±²°®ª  1) ±®±²®¨² ¨§ ±²°®ª 2{8,   ²¥«® ¶¨ª«  while (±²°®ª  5) ±®¤¥°¦¨² ±²°®ª¨ 6{7, ­® ­¥ 8. ²® ¦¥
¯° ¢¨«® ¯°¨¬¥­¿¥²±¿ ¨ ¤«¿ if-then-else. ²® ¤¥« ¥² ¨§«¨¸­¨¬ ±¯¥¶¨ «¼­»¥ ª®¬ ­¤» ²¨¯  begin ¨ end ¤«¿ ­ · «  ¨ ª®­¶  ¡«®ª . (
°¥ «¼­»µ ¿§»ª µ ¯°®£° ¬¬¨°®¢ ­¨¿ ² ª®¥ ±®£« ¸¥­¨¥ ¯°¨¬¥­¿¥²±¿ °¥¤ª®, ¯®±ª®«¼ª³ § ²°³¤­¿¥² ·²¥­¨¥ ¯°®£° ¬¬, ¯¥°¥µ®¤¿¹¨µ ±®
±²° ­¨¶» ­  ±²° ­¨¶³.)
2. ¨ª«» while, for, repeat ¨ ³±«®¢­»¥ ª®­±²°³ª¶¨¨ if, then, else
¨¬¥¾² ²®² ¦¥ ±¬»±«, ·²® ¢  ±ª «¥.
3. ¨¬¢®« . ­ ·¨­ ¥² ª®¬¬¥­² °¨© (¨¤³¹¨© ¤® ª®­¶  ±²°®ª¨).
4. ¤­®¢°¥¬¥­­®¥ ¯°¨±¢ ¨¢ ­¨¥ i j e (¯¥°¥¬¥­­»¥ i ¨ j
¯®«³· ¾² §­ ·¥­¨¥ e) § ¬¥­¿¥² ¤¢  ¯°¨±¢ ¨¢ ­¨¿ j e ¨ i j (¢
½²®¬ ¯®°¿¤ª¥).
5. ¥°¥¬¥­­»¥ (¢ ¤ ­­®¬ ±«³· ¥ i; j; key ) «®ª «¼­» ¢­³²°¨ ¯°®¶¥¤³°» (¥±«¨ ­¥ ®£®¢®°¥­® ¯°®²¨¢­®¥).
6. ­¤¥ª± ¬ ±±¨¢  ¯¨¸¥²±¿ ¢ ª¢ ¤° ²­»µ ±ª®¡ª µ: A[i] ¥±²¼ i-©
½«¥¬¥­² ¢ ¬ ±±¨¢¥ A. ­ ª À: :Á ¢»¤¥«¿¥² · ±²¼ ¬ ±±¨¢ : A[1 : :j ]
®¡®§­ · ¥² ³· ±²®ª ¬ ±±¨¢  A, ¢ª«¾· ¾¹¨© A[1]; A[2]; : : :; A[j ].
7.  ±²® ¨±¯®«¼§³¾²±¿ ®¡º¥ª²» (objects), ±®±²®¿¹¨¥ ¨§ ­¥±ª®«¼ª¨µ ¯®«¥© (elds), ¨«¨, ª ª £®¢®°¿², ¨¬¥¾¹¨¥ ­¥±ª®«¼ª®  ²°¨¡³²®¢ (attributes). ­ ·¥­¨¥ ¯®«¿ § ¯¨±»¢ ¥²±¿ ª ª
¨¬¿ ¯®«¿[¨¬¿ ®¡º¥ª² ].  ¯°¨¬¥°, ¤«¨­  ¬ ±±¨¢  ±·¨² ¥²±¿
¥£®  ²°¨¡³²®¬ ¨ ®¡®§­ · ¥²±¿ length, ² ª ·²® ¤«¨­  ¬ ±±¨¢  A
§ ¯¨¸¥²±¿ ª ª length[A]. ²® ®¡®§­ · ¾² ª¢ ¤° ²­»¥ ±ª®¡ª¨
(½«¥¬¥­² ¬ ±±¨¢  ¨«¨ ¯®«¥ ®¡º¥ª² ), ¡³¤¥² ¿±­® ¨§ ª®­²¥ª±² .
¥°¥¬¥­­ ¿, ®¡®§­ · ¾¹ ¿ ¬ ±±¨¢ ¨«¨ ®¡º¥ª², ±·¨² ¥²±¿ ³ª § ²¥«¥¬ ­  ±®±² ¢«¿¾¹¨¥ ¥£® ¤ ­­»¥. ®±«¥ ¯°¨±¢ ¨¢ ­¨¿ y x ¤«¿
«¾¡®£® ¯®«¿ f ¢»¯®«­¥­® f [y ] = f [x]. ®«¥¥ ²®£®, ¥±«¨ ¬» ²¥¯¥°¼
¢»¯®«­¨¬ ®¯¥° ²®° f [x] 3, ²® ¡³¤¥² ­¥ ²®«¼ª® f [x] = 3, ­® ¨
f [y] = 3, ¯®±ª®«¼ª³ ¯®±«¥ y x ¯¥°¥¬¥­­»¥ x ¨ y ³ª §»¢ ¾² ­ 
®¤¨­ ¨ ²®² ¦¥ ®¡º¥ª².
ª § ²¥«¼ ¬®¦¥² ¨¬¥²¼ ±¯¥¶¨ «¼­®¥ §­ ·¥­¨¥ nil, ­¥ ³ª §»¢ ¾¹¥¥ ­¨ ­  ®¤¨­ ®¡º¥ª².
8.  ° ¬¥²°» ¯¥°¥¤ ¾²±¿ ¯® §­ ·¥­¨¾ (by value): ¢»§¢ ­­ ¿ ¯°®¶¥¤³°  ¯®«³· ¥² ±®¡±²¢¥­­³¾ ª®¯¨¾ ¯ ° ¬¥²°®¢; ¨§¬¥­¥­¨¥ ¯ ° ¬¥²°  ¢­³²°¨ ¯°®¶¥¤³°» ±­ °³¦¨ ­¥¢¨¤¨¬®. °¨ ¯¥°¥¤ ·¥ ®¡º¥ª-

18

« ¢  1 ¢¥¤¥­¨¥

²®¢ ª®¯¨°³¥²±¿ ³ª § ²¥«¼ ­  ¤ ­­»¥, ±®±² ¢«¿¾¹¨¥ ½²®² ®¡º¥ª²,
  ± ¬¨ ¯®«¿ ®¡º¥ª²  | ­¥².  ¯°¨¬¥°, ¥±«¨ x | ¯ ° ¬¥²° ¯°®¶¥¤³°», ²® ¯°¨±¢ ¨¢ ­¨¥ x y , ¢»¯®«­¥­­®¥ ¢­³²°¨ ¯°®¶¥¤³°»,
±­ °³¦¨ § ¬¥²¨²¼ ­¥«¼§¿,   ¯°¨±¢ ¨¢ ­¨¥ f [x] 3 | ¬®¦­®.
¯° ¦­¥­¨¿
1.1-1

«¥¤³¿ ®¡° §¶³ °¨±. 1.2, ¯®ª ¦¨²¥, ª ª ° ¡®² ¥²

Insertion-Sort ­  ¢µ®¤¥ A = h31; 41; 59; 26; 41; 58i.

1.1-2 §¬¥­¨²¥ ¯°®¶¥¤³°³ Insertion-Sort ² ª, ·²®¡» ®­  ±®°²¨°®¢ «  ·¨±«  ¢ ­¥¢®§° ±² ¾¹¥¬ ¯®°¿¤ª¥ (¢¬¥±²® ­¥³¡»¢ ¾¹¥£®).
1.1-3  ±±¬®²°¨¬ ±«¥¤³¾¹³¾ § ¤ ·³ ¯®¨±ª :
µ®¤: ®±«¥¤®¢ ²¥«¼­®±²¼ n ·¨±¥« A = ha1 ; a2; : : :; an i ¨ ·¨±«® v .
»µ®¤: ­¤¥ª± i, ¤«¿ ª®²®°®£® v = A[i], ¨«¨ ±¯¥¶¨ «¼­®¥ §­ ·¥­¨¥
nil, ¥±«¨ v ­¥ ¢±²°¥· ¥²±¿ ¢ A.
 ¯¨¸¨²¥ ¯°®£° ¬¬³ «¨­¥©­®£® ¯®¨±ª  (linear search), ª®²®°»©
¯®±«¥¤®¢ ²¥«¼­® ¯°®±¬ ²°¨¢ ¥² A ¢ ¯®¨±ª µ v .
1.1-4  ­» ¤¢  n-§­ ·­»µ ¤¢®¨·­»µ ·¨±« , § ¯¨± ­­»µ ¢ ¢¨¤¥
n-½«¥¬¥­²­»µ ¬ ±±¨¢®¢ A ¨ B . °¥¡³¥²±¿ ¯®¬¥±²¨²¼ ¨µ ±³¬¬³ (¢
¤¢®¨·­®© § ¯¨±¨) ¢ (n + 1)-½«¥¬¥­²­»© ¬ ±±¨¢ C . ²®·­¨²¥ ¯®±² ­®¢ª³ § ¤ ·¨ ¨ § ¯¨¸¨²¥ ±®®²¢¥²±²¢³¾¹³¾ ¯°®£° ¬¬³ ­  ¯±¥¢¤®ª®¤¥.

1.2. ­ «¨§  «£®°¨²¬®¢
 ±±¬ ²°¨¢ ¿ ° §«¨·­»¥  «£®°¨²¬» °¥¸¥­¨¿ ®¤­®© ¨ ²®© ¦¥ § ¤ ·¨, ¯®«¥§­® ¯°® ­ «¨§¨°®¢ ²¼, ±ª®«¼ª® ¢»·¨±«¨²¥«¼­»µ °¥±³°±®¢ ®­¨ ²°¥¡³¾² (¢°¥¬¿ ¢»¯®«­¥­¨¿, ¯ ¬¿²¼), ¨ ¢»¡° ²¼ ­ ¨¡®«¥¥ ½´´¥ª²¨¢­»©. ®­¥·­®, ­ ¤® ¤®£®¢®°¨²¼±¿ ® ²®¬, ª ª ¿ ¬®¤¥«¼ ¢»·¨±«¥­¨© ¨±¯®«¼§³¥²±¿.  ½²®© ª­¨£¥ ¢ ª ·¥±²¢¥ ¬®¤¥«¨ ¯®
¡®«¼¸¥© · ±²¨ ¨±¯®«¼§³¥²±¿ ®¡»·­ ¿ ®¤­®¯°®¶¥±±®°­ ¿ ¬ ¸¨­  ±
¯°®¨§¢®«¼­»¬ ¤®±²³¯®¬ (random-access machine, RAM), ­¥ ¯°¥¤³±¬ ²°¨¢ ¾¹ ¿ ¯ ° ««¥«¼­®£® ¢»¯®«­¥­¨¿ ®¯¥° ¶¨©. (» ° ±±¬®²°¨¬ ­¥ª®²®°»¥ ¬®¤¥«¨ ¯ ° ««¥«¼­»µ ¢»·¨±«¥­¨© ¢ ¯®±«¥¤­¥© · ±²¨ ª­¨£¨.)
®°²¨°®¢ª  ¢±² ¢ª ¬¨:  ­ «¨§
°¥¬¿ ±®°²¨°®¢ª¨ ¢±² ¢ª ¬¨ § ¢¨±¨² ®² ° §¬¥°  ±®°²¨°³¥¬®£® ¬ ±±¨¢ : ·¥¬ ¡®«¼¸¥ ¬ ±±¨¢, ²¥¬ ¡®«¼¸¥ ¬®¦¥² ¯®²°¥¡®¢ ²¼±¿

­ «¨§  «£®°¨²¬®¢

19

¢°¥¬¥­¨. ¡»·­® ¨§³· ¾² § ¢¨±¨¬®±²¨ ¢°¥¬¥­¨ ° ¡®²» ®² ° §¬¥°  ¢µ®¤ . (¯°®·¥¬, ¤«¿  «£®°¨²¬  ±®°²¨°®¢ª¨ ¢±² ¢ª ¬¨ ¢ ¦¥­
­¥ ²®«¼ª® ° §¬¥° ¬ ±±¨¢ , ­® ¨ ¯®°¿¤®ª ¥£® ½«¥¬¥­²®¢: ¥±«¨ ¬ ±±¨¢
¯®·²¨ ³¯®°¿¤®·¥­, ²® ¢°¥¬¥­¨ ²°¥¡³¥²±¿ ¬¥­¼¸¥.)
 ª ¨§¬¥°¿²¼ ° §¬¥° ¢µ®¤  (input size)? ²® § ¢¨±¨² ®² ª®­ª°¥²­®© § ¤ ·¨.  ®¤­¨µ ±«³· ¿µ ° §³¬­® ±·¨² ²¼ ·¨±«® ½«¥¬¥­²®¢ ­ 
¢µ®¤¥ (±®°²¨°®¢ª , ¯°¥®¡° §®¢ ­¨¥ ³°¼¥).  ¤°³£¨µ ¡®«¥¥ ¥±²¥±²¢¥­­® ±·¨² ²¼ ®¡¹¥¥ ·¨±«® ¡¨²®¢, ­¥®¡µ®¤¨¬®¥ ¤«¿ ¯°¥¤±² ¢«¥­¨¿ ¢±¥µ ¢µ®¤­»µ ¤ ­­»µ. ­®£¤  ° §¬¥° ¢µ®¤  ¨§¬¥°¿¥²±¿ ­¥ ®¤­¨¬ ·¨±«®¬,   ­¥±ª®«¼ª¨¬¨ (­ ¯°¨¬¥°, ·¨±«® ¢¥°¸¨­ ¨ ·¨±«® °¥¡¥°
£° ´ ).
°¥¬¥­¥¬ ° ¡®²» (running time)  «£®°¨²¬  ¬» ­ §»¢ ¥¬ ·¨±«®
½«¥¬¥­² °­»µ ¸ £®¢, ª®²®°»¥ ®­ ¢»¯®«­¿¥² | ¢®¯°®± ²®«¼ª® ¢
²®¬, ·²® ±·¨² ²¼ ½«¥¬¥­² °­»¬ ¸ £®¬. » ¡³¤¥¬ ¯®« £ ²¼, ·²®
®¤­  ±²°®ª  ¯±¥¢¤®ª®¤  ²°¥¡³¥² ­¥ ¡®«¥¥ ·¥¬ ´¨ª±¨°®¢ ­­®£® ·¨±«  ®¯¥° ¶¨© (¥±«¨ ²®«¼ª® ½²® ­¥ ±«®¢¥±­®¥ ®¯¨± ­¨¥ ª ª®©-²® ±«®¦­®© ®¯¥° ¶¨¨ | ²¨¯  À®²±®°²¨°®¢ ²¼ ¢±¥ ²®·ª¨ ¯® x-ª®®°¤¨­ ²¥Á).
» ¡³¤¥¬ ° §«¨· ²¼ ² ª¦¥ ¢»§®¢ (call) ¯°®¶¥¤³°» (­  ª®²®°»©
³µ®¤¨² ´¨ª±¨°®¢ ­­®¥ ·¨±«® ®¯¥° ¶¨©) ¨ ¥¥ ¨±¯®«­¥­¨¥ (execution),
ª®²®°®¥ ¬®¦¥² ¡»²¼ ¤®«£¨¬.
² ª, ¢¥°­¥¬±¿ ª ¯°®¶¥¤³°¥ Insertion-Sort ¨ ®²¬¥²¨¬ ®ª®«®
ª ¦¤®© ±²°®ª¨ ¥¥ ±²®¨¬®±²¼ (·¨±«® ®¯¥° ¶¨©) ¨ ·¨±«® ° §, ª®²®°®¥ ½²  ±²°®ª  ¨±¯®«­¿¥²±¿. «¿ ª ¦¤®£® j ®² 2 ¤® n (§¤¥±¼
n = length[A] | ° §¬¥° ¬ ±±¨¢ ) ¯®¤±·¨² ¥¬, ±ª®«¼ª® ° § ¡³¤¥²
¨±¯®«­¥­  ±²°®ª  5, ¨ ®¡®§­ ·¨¬ ½²® ·¨±«® ·¥°¥§ tj . ( ¬¥²¨¬, ·²®
±²°®ª¨ ¢­³²°¨ ¶¨ª«  ¢»¯®«­¿¾²±¿ ­  ®¤¨­ ° § ¬¥­¼¸¥, ·¥¬ ¯°®¢¥°ª , ¯®±ª®«¼ª³ ¯®±«¥¤­¿¿ ¯°®¢¥°ª  ¢»¢®¤¨² ¨§ ¶¨ª« .)
Insertion-Sort(A)
±²®¨¬®±²¼ ·¨±«® ° §
1 for j 2 to length[A]
c1
n
2
do key A[j ]
c2
n;1
3
. ¤®¡ ¢¨²¼ A[j ] ª ®²±®°²¨°®. ¢ ­­®© · ±²¨ A[1 : :j ; 1]. 0
n;1
4
i j ;1
c4
nP; 1
n t
5
while i > 0 and A[i] > key
c5
j
Pjn=2
6
do A[i + 1] A[i]
c6
(
t
j ; 1)
Pjn=2
7
i i;1
c7
j =2 (tj ; 1)
8
A[i + 1] key
c8
n;1
²°®ª  ±²®¨¬®±²¨ c, ¯®¢²®°¥­­ ¿ m ° §, ¤ ¥² ¢ª« ¤ cm ¢ ®¡¹¥¥ ·¨±«® ®¯¥° ¶¨©. («¿ ª®«¨·¥±²¢  ¨±¯®«¼§®¢ ­­®© ¯ ¬¿²¨ ½²®£®

20

« ¢  1 ¢¥¤¥­¨¥

±ª § ²¼ ­¥«¼§¿!) «®¦¨¢ ¢ª« ¤» ¢±¥µ ±²°®ª, ¯®«³·¨¬

T (n) = c1n + c2(n ; 1) + c4(n ; 1) + c5
+ c6

n
X
j =2

n
X
j =2

(tj ; 1) + c7

tj +

n
X
j =2

(tj ; 1) + c8 (n ; 1):

 ª ¬» ³¦¥ £®¢®°¨«¨, ¢°¥¬¿ ° ¡®²» ¯°®¶¥¤³°» § ¢¨±¨² ­¥ ²®«¼ª®
®² n, ­® ¨ ®² ²®£®, ª ª®© ¨¬¥­­® ¬ ±±¨¢ ° §¬¥°  n ¯®¤ ­ ¥© ­  ¢µ®¤.
«¿ ¯°®¶¥¤³°» Insertion-Sort ­ ¨¡®«¥¥ ¡« £®¯°¨¿²¥­ ±«³· ©, ª®£¤  ¬ ±±¨¢ ³¦¥ ®²±®°²¨°®¢ ­. ®£¤  ¶¨ª« ¢ ±²°®ª¥ 5 § ¢¥°¸ ¥²±¿
¯®±«¥ ¯¥°¢®© ¦¥ ¯°®¢¥°ª¨ (¯®±ª®«¼ª³ A[i] 6 key ¯°¨ i = j ; 1), ² ª
·²® ¢±¥ tj ° ¢­» 1, ¨ ®¡¹¥¥ ¢°¥¬¿ ¥±²¼

T (n) = c1n + c2(n ; 1) + c4(n ; 1) + c5(n ; 1) + c8 (n ; 1) =
= (c1 + c2 + c4 + c5 + c8 )n ; (c2 + c4 + c5 + c8):
 ª¨¬ ®¡° §®¬, ¢ ­ ¨¡®«¥¥ ¡« £®¯°¨¿²­®¬ ±«³· ¥ ¢°¥¬¿ T (n), ­¥®¡µ®¤¨¬®¥ ¤«¿ ®¡° ¡®²ª¨ ¬ ±±¨¢  ° §¬¥°  n, ¿¢«¿¥²±¿ «¨­¥©­®©
´³­ª¶¨¥© (linear function) ®² n, ². ¥. ¨¬¥¥² ¢¨¤ T (n) = an + b ¤«¿
­¥ª®²®°»µ ª®­±² ­² a ¨ b. (²¨ ª®­±² ­²» ®¯°¥¤¥«¿¾²±¿ ¢»¡° ­­»¬¨ §­ ·¥­¨¿¬¨ c1; : : :; c8.)

±«¨ ¦¥ ¬ ±±¨¢ ° ±¯®«®¦¥­ ¢ ®¡° ²­®¬ (³¡»¢ ¾¹¥¬) ¯®°¿¤ª¥,
¢°¥¬¿ ° ¡®²» ¯°®¶¥¤³°» ¡³¤¥² ¬ ª±¨¬ «¼­»¬: ª ¦¤»© ½«¥¬¥­²
A[j ] ¯°¨¤¥²±¿ ±° ¢­¨²¼ ±® ¢±¥¬¨ ½«¥¬¥­² ¬¨ A[1] : : :A[j ; 1]. °¨
½²®¬ tj = j . ±¯®¬¨­ ¿, ·²®
n
X
j =2

j = n(n + 1) ; 1;
2

n
X
j =2

(j ; 1) = n(n2; 1)

(±¬. £«. 3), ¯®«³· ¥¬, ·²® ¢ µ³¤¸¥¬ ±«³· ¥ ¢°¥¬¿ ° ¡®²» ¯°®¶¥¤³°»
° ¢­®


n
(
n
+
1)
T (n) = c1n + c2(n ; 1) + c4(n ; 1) + c5
;1 +
2




n
(
n
;
1)
n
(
n
;
1)
+ c7
+ c8(n ; 1) =
+ c6
2
2




= c25 + c26 + c27 n2 + c1 + c2 + c4 + c25 ; c26 ; c27 + c8 n ;
; (c2 + c4 + c5 + c8):

¥¯¥°¼ ´³­ª¶¨¿ T (n) | ª¢ ¤° ²¨·­ ¿ (quadratic function), ². ¥.
¨¬¥¥² ¢¨¤ T (n) = an2 + bn + c. (®­±² ­²» a, b ¨ c ±­®¢  ®¯°¥¤¥«¿¾²±¿ §­ ·¥­¨¿¬¨ c1{c8.)

­ «¨§  «£®°¨²¬®¢

21

°¥¬¿ ° ¡®²» ¢ µ³¤¸¥¬ ±«³· ¥ ¨ ¢ ±°¥¤­¥¬
² ª, ¬» ¢¨¤¨¬, ·²® ¢°¥¬¿ ° ¡®²» ¢ µ³¤¸¥¬ ±«³· ¥ ¨ ¢ «³·¸¥¬
±«³· ¥ ¬®£³² ±¨«¼­® ° §«¨· ²¼±¿. ®«¼¸¥© · ±²¼¾ ­ ± ¡³¤¥² ¨­²¥°¥±®¢ ²¼ ¢°¥¬¿ ° ¡®²» ¢ µ³¤¸¥¬ ±«³· ¥ (worst-case running time),
ª®²®°®¥ ®¯°¥¤¥«¿¥²±¿ ª ª ¬ ª±¨¬ «¼­®¥ ¢°¥¬¿ ° ¡®²» ¤«¿ ¢µ®¤®¢
¤ ­­®£® ° §¬¥° . ®·¥¬³? ®² ­¥±ª®«¼ª® ¯°¨·¨­.
 ­ ¿ ¢°¥¬¿ ° ¡®²» ¢ µ³¤¸¥¬ ±«³· ¥, ¬» ¬®¦¥¬ £ ° ­²¨°®¢ ²¼,
·²® ¢»¯®«­¥­¨¥  «£®°¨²¬  § ª®­·¨²±¿ §  ­¥ª®²®°®¥ ¢°¥¬¿, ¤ ¦¥ ­¥ §­ ¿, ª ª®© ¨¬¥­­® ¢µ®¤ (¤ ­­®£® ° §¬¥° ) ¯®¯ ¤¥²±¿.
   ¯° ª²¨ª¥ À¯«®µ¨¥Á ¢µ®¤» (¤«¿ ª®²®°»µ ¢°¥¬¿ ° ¡®²» ¡«¨§ª® ª ¬ ª±¨¬³¬³) ¬®£³² · ±²® ¯®¯ ¤ ²¼±¿.  ¯°¨¬¥°, ¤«¿ ¡ §»
¤ ­­»µ ¯«®µ¨¬ § ¯°®±®¬ ¬®¦¥² ¡»²¼ ¯®¨±ª ®²±³²±²¢³¾¹¥£®
½«¥¬¥­²  (¤®¢®«¼­® · ±² ¿ ±¨²³ ¶¨¿).
 °¥¬¿ ° ¡®²» ¢ ±°¥¤­¥¬ ¬®¦¥² ¡»²¼ ¤®¢®«¼­® ¡«¨§ª® ª ¢°¥¬¥­¨
° ¡®²» ¢ µ³¤¸¥¬ ±«³· ¥. ³±²¼, ­ ¯°¨¬¥°, ¬» ±®°²¨°³¥¬ ±«³· ©­® ° ±¯®«®¦¥­­»¥ n ·¨±¥« ¢ ¯®¬®¹¼¾ ¯°®¶¥¤³°» InsertionSort. ª®«¼ª® ° § ¯°¨¤¥²±¿ ¢»¯®«­¨²¼ ¶¨ª« ¢ ±²°®ª µ 5{8? 
±°¥¤­¥¬ ®ª®«® ¯®«®¢¨­» ½«¥¬¥­²®¢ ¬ ±±¨¢  A[1 : :j ; 1] ¡®«¼¥
A[j ], ² ª ·²® tj ¢ ±°¥¤­¥¬ ¬®¦­® ±·¨² ²¼ ° ¢­»¬ j=2, ¨ ¢°¥¬¿ T (n) ª¢ ¤° ²¨·­® § ¢¨±¨² ®² n.
 ­¥ª®²®°»µ ±«³· ¿µ ­ ± ¡³¤¥² ¨­²¥°¥±®¢ ²¼ ² ª¦¥ ±°¥¤­¥¥ ¢°¥¬¿ ° ¡®²» (average-case running time, expexted running time)  «£®°¨²¬  ­  ¢µ®¤ µ ¤ ­­®© ¤«¨­». ®­¥·­®, ½²  ¢¥«¨·¨­  § ¢¨±¨² ®²
¢»¡° ­­®£® ° ±¯°¥¤¥«¥­¨¿ ¢¥°®¿²­®±²¥© (®¡»·­® ° ±±¬ ²°¨¢ ¥²±¿ ° ¢­®¬¥°­®¥ ° ±¯°¥¤¥«¥­¨¥), ¨ ­  ¯° ª²¨ª¥ °¥ «¼­®¥ ° ±¯°¥¤¥«¥­¨¥ ¢µ®¤®¢ ¬®¦¥² ®ª § ²¼±¿ ±®¢±¥¬ ¤°³£¨¬. (­®£¤  ¥£® ¬®¦­®
¯°¥®¡° §®¢ ²¼ ¢ ° ¢­®¬¥°­®¥, ¨±¯®«¼§³¿ ¤ ²·¨ª ±«³· ©­»µ ·¨±¥«.)
®°¿¤®ª °®±² 
 ¸  ­ «¨§ ¢°¥¬¥­¨ ° ¡®²» ¯°®¶¥¤³°» Insertion-Sort ¡»«
®±­®¢ ­ ­  ­¥±ª®«¼ª¨µ ³¯°®¹ ¾¹¨µ ¯°¥¤¯®«®¦¥­¨¿µ. ­ · «  ¬»
¯°¥¤¯®«®¦¨«¨, ·²® ¢°¥¬¿ ¢»¯®«­¥­¨¿ i-© ±²°®ª¨ ¯®±²®¿­­® ¨ ° ¢­® ci .  ²¥¬ ¬» ®£°³¡¨«¨ ®¶¥­ª³ ¤® an2 + bn + c. ¥©· ± ¬» ¯®©¤¥¬
¥¹¥ ¤ «¼¸¥ ¨ ±ª ¦¥¬, ·²® ¢°¥¬¿ ° ¡®²» ¢ µ³¤¸¥¬ ±«³· ¥ ¨¬¥¥²
¯®°¿¤®ª °®±²  (rate of growth, order of growth) n2 , ®²¡° ±»¢ ¿ ·«¥­» ¬¥­¼¸¨µ ¯®°¿¤ª®¢ («¨­¥©­»¥) ¨ ­¥ ¨­²¥°¥±³¿±¼ ª®½´´¨¶¨¥­²®¬
¯°¨ n2 . ²® § ¯¨±»¢ ¾² ² ª: T (n) = (n2 ) (¯®¤°®¡­®¥ ®¡º¿±­¥­¨¥
®¡®§­ ·¥­¨© ¬» ®²«®¦¨¬ ¤® ±«¥¤³¾¹¥© £« ¢»).
«£®°¨²¬ ± ¬¥­¼¸¨¬ ¯®°¿¤ª®¬ °®±²  ¢°¥¬¥­¨ ° ¡®²» ®¡»·­®
¯°¥¤¯®·²¨²¥«¥­: ¥±«¨, ±ª ¦¥¬, ®¤¨­  «£®°¨²¬ ¨¬¥¥² ¢°¥¬¿ ° ¡®²»
(n2 ),   ¤°³£®© | (n3 ), ²® ¯¥°¢»© ¡®«¥¥ ½´´¥ª²¨¢¥­ (¯® ª° ©­¥©
¬¥°¥ ¤«¿ ¤®±² ²®·­® ¤«¨­­»µ ¢µ®¤®¢; ¡³¤³² «¨ °¥ «¼­»¥ ¢µ®¤»
² ª®¢»¬¨ | ¤°³£®© ¢®¯°®±).

22

« ¢  1 ¢¥¤¥­¨¥

¯° ¦­¥­¨¿
1.2-1 ³¤¥¬ ±®°²¨°®¢ ²¼ ¬ ±±¨¢ ¨§ n ½«¥¬¥­²®¢ ² ª: ¯°®±¬®²°¨¬
¥£® ¨ ­ ©¤¥¬ ¬¨­¨¬ «¼­»© ½«¥¬¥­², ª®²®°»© ±ª®¯¨°³¥¬ ¢ ¯¥°¢³¾
¿·¥©ª³ ¤°³£®£® ¬ ±±¨¢ .  ²¥¬ ¯°®±¬®²°¨¬ ¥£® ±­®¢  ¨ ­ ©¤¥¬
±«¥¤³¾¹¨© ½«¥¬¥­², ¨ ² ª ¤ «¥¥.  ª®© ±¯®±®¡ ±®°²¨°®¢ª¨ ¬®¦­®
­ §¢ ²¼ ±®°²¨°®¢ª®© ¢»¡®°®¬ (selection sort).  ¯¨¸¨²¥ ½²®²  «£®°¨²¬ ± ¯®¬®¹¼¾ ¯±¥¢¤®ª®¤ . ª ¦¨²¥ ¢°¥¬¿ ¥£® ° ¡®²» ¢ «³·¸¥¬
¨ µ³¤¸¥¬ ±«³· ¿µ, ¨±¯®«¼§³¿ -®¡®§­ ·¥­¨¿.
1.2-2 ¥°­¥¬±¿ ª  «£®°¨²¬³ «¨­¥©­®£® ¯®¨±ª  (³¯°. 1.1-3).
ª®«¼ª® ±° ¢­¥­¨© ¯®²°¥¡³¥²±¿ ¢ ±°¥¤­¥¬ ½²®¬³  «£®°¨²¬³, ¥±«¨
¨±ª®¬»¬ ½«¥¬¥­²®¬ ¬®¦¥² ¡»²¼ «¾¡®© ½«¥¬¥­² ¬ ±±¨¢  (± ®¤¨­ ª®¢®© ¢¥°®¿²­®±²¼¾)?  ª®¢® ¢°¥¬¿ ° ¡®²» ¢ µ³¤¸¥¬ ±«³· ¥ ¨ ¢
±°¥¤­¥¬?  ª § ¯¨± ²¼ ½²¨ ¢°¥¬¥­  ± ¯®¬®¹¼¾ -®¡®§­ ·¥­¨©?
1.2-3  ­  ¯®±«¥¤®¢ ²¥«¼­®±²¼ ·¨±¥« x1; x2; : : :; xn . ®ª ¦¨²¥,
·²® §  ¢°¥¬¿ (n log n) ¬®¦­® ®¯°¥¤¥«¨²¼, ¥±²¼ «¨ ¢ ½²®© ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¤¢  ®¤¨­ ª®¢»µ ·¨±« .
1.2-4  ­» ª®½´´¨¶¨¥­²» a0 ; a1; : : :; an;1 ¬­®£®·«¥­ ; ²°¥¡³¥²±¿
­ ©²¨ ¥£® §­ ·¥­¨¥ ¢ § ¤ ­­®© ²®·ª¥ x. ¯¨¸¨²¥ ¥±²¥±²¢¥­­»©  «£®°¨²¬, ²°¥¡³¾¹¨© ¢°¥¬¥­¨ (n2 ).  ª ¢»¯®«­¨²¼ ¢»·¨±«¥­¨¿ § 
¢°¥¬¿ (n), ­¥ ¨±¯®«¼§³¿ ¤®¯®«­¨²¥«¼­®£® ¬ ±±¨¢ ? ±¯®«¼§³©²¥
À±µ¥¬³ ®°­¥° Á:
nX
;1
i=0

ai xi = (: : : (an;1x + an;2 )x + : : : + a1 )x + a0 :

1.2-5  ª § ¯¨± ²¼ ¢»° ¦¥­¨¥ n3 =1000 ; 100n2 ; 100n + 3 ± ¯®¬®¹¼¾ -®¡®§­ ·¥­¨©?
1.2-6 ®·²¨ «¾¡®©  «£®°¨²¬ ¬®¦­® ­¥¬­®£® ¨§¬¥­¨²¼, ° ¤¨ª «¼­® ³¬¥­¼¸¨¢ ¢°¥¬¿ ¥£® ° ¡®²» ¢ «³·¸¥¬ ±«³· ¥.  ª?

1.3. ®±²°®¥­¨¥  «£®°¨²¬®¢
±²¼ ¬­®£® ±² ­¤ °²­»µ ¯°¨¥¬®¢, ¨±¯®«¼§³¥¬»µ ¯°¨ ¯®±²°®¥­¨¨  «£®°¨²¬®¢. ®°²¨°®¢ª  ¢±² ¢ª ¬¨ ¿¢«¿¥²±¿ ¯°¨¬¥°®¬  «£®°¨²¬ , ¤¥©±²¢³¾¹¥£® ¯® ¸ £ ¬ (incremental approach): ¬» ¤®¡ ¢«¿¥¬ ½«¥¬¥­²» ®¤¨­ §  ¤°³£¨¬ ª ®²±®°²¨°®¢ ­­®© · ±²¨ ¬ ±±¨¢ .
 ½²®¬ ° §¤¥«¥ ¬» ¯®ª ¦¥¬ ¢ ¤¥©±²¢¨¨ ¤°³£®© ¯®¤µ®¤, ª®²®°»© ­ §»¢ ¾² À° §¤¥«¿© ¨ ¢« ±²¢³©Á (divide-and-conquer approach),
¨ ¯®±²°®¨¬ ± ¥£® ¯®¬®¹¼¾ §­ ·¨²¥«¼­® ¡®«¥¥ ¡»±²°»©  «£®°¨²¬
±®°²¨°®¢ª¨.

®±²°®¥­¨¥  «£®°¨²¬®¢

23

1.3.1. °¨­¶¨¯ À° §¤¥«¿© ¨ ¢« ±²¢³©Á
­®£¨¥  «£®°¨²¬» ¯® ¯°¨°®¤¥ °¥ª³°±¨¢­» (recursive algorithms):
°¥¸ ¿ ­¥ª®²®°³¾ § ¤ ·³, ®­¨ ¢»§»¢ ¾² ± ¬¨µ ±¥¡¿ ¤«¿ °¥¸¥­¨¿
¥¥ ¯®¤§ ¤ ·. ¤¥¿ ¬¥²®¤  À° §¤¥«¿© ¨ ¢« ±²¢³©Á ±®±²®¨² ª ª ° § ¢
½²®¬. ­ · «  § ¤ ·  ° §¡¨¢ ¥²±¿ ­  ­¥±ª®«¼ª® ¯®¤§ ¤ · ¬¥­¼¸¥£® ° §¬¥° .  ²¥¬ ½²¨ § ¤ ·¨ °¥¸ ¾²±¿ (± ¯®¬®¹¼¾ °¥ª³°±¨¢­®£®
¢»§®¢  | ¨«¨ ­¥¯®±°¥¤±²¢¥­­®, ¥±«¨ ° §¬¥° ¤®±² ²®·­® ¬ «).  ª®­¥¶, ¨µ °¥¸¥­¨¿ ª®¬¡¨­¨°³¾²±¿ ¨ ¯®«³· ¥²±¿ °¥¸¥­¨¥ ¨±µ®¤­®©
§ ¤ ·¨.
«¿ § ¤ ·¨ ±®°²¨°®¢ª¨ ½²¨ ²°¨ ½² ¯  ¢»£«¿¤¿² ² ª. ­ · «  ¬» ° §¡¨¢ ¥¬ ¬ ±±¨¢ ­  ¤¢¥ ¯®«®¢¨­» ¬¥­¼¸¥£® ° §¬¥° .  ²¥¬ ¬» ±®°²¨°³¥¬ ª ¦¤³¾ ¨§ ¯®«®¢¨­ ®²¤¥«¼­®. ®±«¥ ½²®£® ­ ¬
®±² ¥²±¿ ±®¥¤¨­¨²¼ ¤¢  ³¯®°¿¤®·¥­­»µ ¬ ±±¨¢  ¯®«®¢¨­­®£® ° §¬¥°  ¢ ®¤¨­. ¥ª³°±¨¢­®¥ ° §¡¨¥­¨¥ § ¤ ·¨ ­  ¬¥­¼¸¨¥ ¯°®¨±µ®¤¨² ¤® ²¥µ ¯®°, ¯®ª  ° §¬¥° ¬ ±±¨¢  ­¥ ¤®©¤¥² ¤® ¥¤¨­¨¶» («¾¡®©
¬ ±±¨¢ ¤«¨­» 1 ¬®¦­® ±·¨² ²¼ ³¯®°¿¤®·¥­­»¬).
¥²°¨¢¨ «¼­®© · ±²¼¾ ¿¢«¿¥²±¿ ±®¥¤¨­¥­¨¥ ¤¢³µ ³¯®°¿¤®·¥­­»µ
¬ ±±¨¢®¢ ¢ ®¤¨­. ­® ¢»¯®«­¿¥²±¿ ± ¯®¬®¹¼¾ ¢±¯®¬®£ ²¥«¼­®©
¯°®¶¥¤³°» Merge(A; p; q; r).  ° ¬¥²° ¬¨ ½²®© ¯°®¶¥¤³°» ¿¢«¿¾²±¿ ¬ ±±¨¢ A ¨ ·¨±«  p; q; r, ³ª §»¢ ¾¹¨¥ £° ­¨¶» ±«¨¢ ¥¬»µ
³· ±²ª®¢. °®¶¥¤³°  ¯°¥¤¯®« £ ¥², ·²® p 6 q < r ¨ ·²® ³· ±²ª¨
A[p : :q ] ¨ A[q + 1 : :r] ³¦¥ ®²±®°²¨°®¢ ­», ¨ ±«¨¢ ¥² (merges) ¨µ ¢
®¤¨­ ³· ±²®ª A[p : :r].
» ®±² ¢«¿¥¬ ¯®¤°®¡­³¾ ° §° ¡®²ª³ ½²®© ¯°®¶¥¤³°» ·¨² ²¥«¾
(³¯°. 1.3-2), ­® ¤®¢®«¼­® ¿±­®, ·²® ¢°¥¬¿ ° ¡®²» ¯°®¶¥¤³°» Merge
¥±²¼ (n), £¤¥ n | ®¡¹ ¿ ¤«¨­  ±«¨¢ ¥¬»µ ³· ±²ª®¢ (n = r ; p +1).
²® «¥£ª® ®¡º¿±­¨²¼ ­  ª °² µ. ³±²¼ ¬» ¨¬¥¥¬ ¤¢¥ ±²®¯ª¨ ª °²,
¨ ¢ ª ¦¤®© ª °²» ¨¤³² ±¢¥°µ³ ¢­¨§ ¢ ¢®§° ±² ¾¹¥¬ ¯®°¿¤ª¥.  ª
±¤¥« ²¼ ¨§ ­¨µ ®¤­³?   ª ¦¤®¬ ¸ £¥ ¬» ¡¥°¥¬ ¬¥­¼¸³¾ ¨§ ¤¢³µ
¢¥°µ­¨µ ª °² ¨ ª« ¤¥¬ ¥¥ (°³¡ ¸ª®© ¢¢¥°µ) ¢ °¥§³«¼²¨°³¾¹³¾
±²®¯ª³. ®£¤  ®¤­  ¨§ ¨±µ®¤­»µ ±²®¯®ª ±² ­®¢¨²±¿ ¯³±²®©, ¬» ¤®¡ ¢«¿¥¬ ¢±¥ ®±² ¢¸¨¥±¿ ª °²» ¢²®°®© ±²®¯ª¨ ª °¥§³«¼²¨°³¾¹¥©
±²®¯ª¥. ±­®, ·²® ª ¦¤»© ¸ £ ²°¥¡³¥² ®£° ­¨·¥­­®£® ·¨±«  ¤¥©±²¢¨©, ¨ ®¡¹¥¥ ·¨±«® ¤¥©±²¢¨© ¥±²¼ (n).
¥¯¥°¼ ­ ¯¨¸¥¬ ¯°®¶¥¤³°³ ±®°²¨°®¢ª¨ ±«¨¿­¨¥¬ Merge-Sort(A; p; r),
ª®²®° ¿ ±®°²¨°³¥² ³· ±²®ª A[p : :r] ¬ ±±¨¢  A, ­¥ ¬¥­¿¿ ®±² «¼­³¾ · ±²¼ ¬ ±±¨¢ . °¨ p > r ³· ±²®ª ±®¤¥°¦¨² ¬ ª±¨¬³¬ ®¤¨­
½«¥¬¥­², ¨ ²¥¬ ± ¬»¬ ³¦¥ ®²±®°²¨°®¢ ­.  ¯°®²¨¢­®¬ ±«³· ¥
¬» ®²»±ª¨¢ ¥¬ ·¨±«® q , ª®²®°®¥ ¤¥«¨² ³· ±²®ª ­  ¤¢¥ ¯°¨¬¥°­®
° ¢­»¥ · ±²¨ A[p : :q ] (±®¤¥°¦¨² dn=2e ½«¥¬¥­²®¢) ¨ A[q + 1 : :r]
(±®¤¥°¦¨² bn=2c ½«¥¬¥­²®¢). ¤¥±¼ ·¥°¥§ bxc ¬» ®¡®§­ · ¥¬ ¶¥«³¾
· ±²¼ x (­ ¨¡®«¼¸¥¥ ¶¥«®¥ ·¨±«®, ¬¥­¼¸¥¥ ¨«¨ ° ¢­®¥ x),   ·¥°¥§
dxe | ­ ¨¬¥­¼¸¥¥ ¶¥«®¥ ·¨±«®, ¡®«¼¸¥¥ ¨«¨ ° ¢­®¥ x.

24

« ¢  1 ¢¥¤¥­¨¥

sorted sequence | ®²±®°²¨°®¢ ­­ ¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼
merge | ±«¨¿­¨¥
initial sequence | ­ · «¼­ ¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼

¨±. 1.3

®°²¨°®¢ª  ±«¨¿­¨¥¬ ¤«¿ ¬ ±±¨¢  A = h5; 2; 4; 6; 1; 3; 2; 6i.

Merge-Sort (A; p; r)

1 if p < r
2 then q b(p + r)=2c
3
Merge-Sort(A; p; q )
4
Merge-Sort(A; q + 1; r)
5
Merge(A; p; q; r)
¥±¼ ¬ ±±¨¢ ²¥¯¥°¼ ¬®¦­® ®²±®°²¨°®¢ ²¼ ± ¯®¬®¹¼¾ ¢»§®¢ 
Merge-Sort(A; 1; length[A]). ±«¨ ¤«¨­  ¬ ±±¨¢  n = length[A] ¥±²¼
±²¥¯¥­¼ ¤¢®©ª¨, ²® ¢ ¯°®¶¥±±¥ ±®°²¨°®¢ª¨ ¯°®¨§®©¤¥² ±«¨¿­¨¥ ¯ °
½«¥¬¥­²®¢ ¢ ®²±®°²¨°®¢ ­­»¥ ³· ±²ª¨ ¤«¨­» 2, § ²¥¬ ±«¨¿­¨¥ ¯ °
² ª¨µ ³· ±²ª®¢ ¢ ®²±®°²¨°®¢ ­­»¥ ³· ±²ª¨ ¤«¨­» 4 ¨ ² ª ¤ «¥¥ ¤®
n (­  ¯®±«¥¤­¥¬ ¸ £¥ ±®¥¤¨­¿¾²±¿ ¤¢  ®²±®°²¨°®¢ ­­»µ ³· ±²ª 
¤«¨­» n=2). ²®² ¯°®¶¥±± ¯®ª § ­ ­  °¨±. 1.3.
1.3.2. ­ «¨§  «£®°¨²¬®¢ ²¨¯  À° §¤¥«¿© ¨ ¢« ±²¢³©Á
 ª ®¶¥­¨²¼ ¢°¥¬¿ ° ¡®²» °¥ª³°±¨¢­®£®  «£®°¨²¬ ? °¨ ¯®¤±·¥²¥ ¬» ¤®«¦­» ³·¥±²¼ ¢°¥¬¿, § ²° ·¨¢ ¥¬®¥ ­  °¥ª³°±¨¢­»¥ ¢»§®¢», ² ª ·²® ¯®«³· ¥²±¿ ­¥ª®²®°®¥ °¥ª³°°¥­²­®¥ ±®®²­®¸¥­¨¥
(recurrence equation).  «¥¥ ±«¥¤³¥² ®¶¥­¨²¼ ¢°¥¬¿ ° ¡®²», ¨±µ®¤¿
¨§ ½²®£® ±®®²­®¸¥­¨¿.
®² ¯°¨¬¥°­® ª ª ½²® ¤¥« ¥²±¿. °¥¤¯®«®¦¨¬, ·²®  «£®°¨²¬
° §¡¨¢ ¥² § ¤ ·³ ° §¬¥°  n ­  a ¯®¤§ ¤ ·, ª ¦¤ ¿ ¨§ ª®²®°»µ ¨¬¥¥² ¢ b ° § ¬¥­¼¸¨© ° §¬¥°. ³¤¥¬ ±·¨² ²¼, ·²® ° §¡¨¥­¨¥ ²°¥¡³¥²
¢°¥¬¥­¨ D(n),   ±®¥¤¨­¥­¨¥ ¯®«³·¥­­»µ °¥¸¥­¨© | ¢°¥¬¥­¨ C (n).

®±²°®¥­¨¥  «£®°¨²¬®¢

25

®£¤  ¯®«³· ¥¬ ±®®²­®¸¥­¨¥ ¤«¿ ¢°¥¬¥­¨ ° ¡®²» T (n) ­  § ¤ · µ
° §¬¥°  n (¢ µ³¤¸¥¬ ±«³· ¥): T (n) = aT (n=b) + D(n) + C (n). ²®
±®®²­®¸¥­¨¥ ¢»¯®«­¥­® ¤«¿ ¤®±² ²®·­® ¡®«¼¸¨µ n, ª®£¤  § ¤ ·³
¨¬¥¥² ±¬»±« ° §¡¨¢ ²¼ ­  ¯®¤§ ¤ ·¨. «¿ ¬ «»µ n, ª®£¤  ² ª®¥
° §¡¨¥­¨¥ ­¥¢®§¬®¦­® ¨«¨ ­¥ ­³¦­®, ¯°¨¬¥­¿¥²±¿ ª ª®©-²® ¯°¿¬®© ¬¥²®¤ °¥¸¥­¨¿ § ¤ ·¨. ®±ª®«¼ª³ n ®£° ­¨·¥­®, ¢°¥¬¿ ° ¡®²»
²®¦¥ ­¥ ¯°¥¢®±µ®¤¨² ­¥ª®²®°®© ª®­±² ­²».
­ «¨§ ±®°²¨°®¢ª¨ ±«¨¿­¨¥¬
«¿ ¯°®±²®²» ¡³¤¥¬ ¯°¥¤¯®« £ ²¼, ·²® ° §¬¥° ¬ ±±¨¢  (n) ¥±²¼
±²¥¯¥­¼ ¤¢®©ª¨. ( ª ¬» ³¢¨¤¨¬ ¢ £« ¢¥ 4, ½²® ­¥ ®·¥­¼ ±³¹¥±²¢¥­­®.) ®£¤  ­  ª ¦¤®¬ ¸ £¥ ±®°²¨°³¥¬»© ³· ±²®ª ¤¥«¨²±¿ ­ 
¤¢¥ ° ¢­»¥ ¯®«®¢¨­».  §¡¨¥­¨¥ ­  · ±²¨ (¢»·¨±«¥­¨¥ £° ­¨¶»)
²°¥¡³¥² ¢°¥¬¥­¨ (1),   ±«¨¿­¨¥ | ¢°¥¬¥­¨ (n). ®«³· ¥¬ ±®®²­®¸¥­¨¥

T (n) =

(

(1);
¥±«¨ n = 1,
2T (n=2) + (n=2); ¥±«¨ n > 1.

 ª ¬» ³¢¨¤¨¬ ¢ £« ¢¥ 4, ½²® ±®®²­®¸¥­¨¥ ¢«¥·¥² T (n) =
(n log n), £¤¥ ·¥°¥§ log ¬» ®¡®§­ · ¥¬ ¤¢®¨·­»© «®£ °¨´¬ (®±­®¢ ­¨¥ «®£ °¨´¬®¢, ¢¯°®·¥¬, ­¥ ¨£° ¥² °®«¨, ² ª ª ª ¯°¨¢®¤¨²
«¨¸¼ ª ¨§¬¥­¥­¨¾ ª®­±² ­²»). ®½²®¬³ ¤«¿ ¡®«¼¸¨µ n ±®°²¨°®¢ª  ±«¨¿­¨¥¬ ½´´¥ª²¨¢­¥¥ ±®°²¨°®¢ª¨ ¢±² ¢ª ¬¨, ²°¥¡³¾¹¥©
¢°¥¬¥­¨ (n2 ).
¯° ¦­¥­¨¿
1.3-1 «¥¤³¿ ®¡° §¶³ °¨±. 1.3, ¯®ª § ²¼ ° ¡®²³ ±®°²¨°®¢ª¨ ±«¨¿­¨¥¬ ¤«¿ ¬ ±±¨¢  A = h3; 41; 52; 26; 38; 57; 9; 49i.
1.3-2
1.3-3

 ¯¨± ²¼ ²¥ª±² ¯°®¶¥¤³°» Merge (A; p; q; r).
®ª ¦¨²¥ ¯® ¨­¤³ª¶¨¨, ·²® ¥±«¨

T (n) =

(

2;
¥±«¨ n = 2,
2T (n=2) + n; ¥±«¨ n = 2k ¨ k > 1,

²® T (n) = n log n (¯°¨ ¢±¥µ n, ¿¢«¿¾¹¨µ±¿ ±²¥¯¥­¿¬¨ ¤¢®©ª¨).
1.3-4 ®°²¨°®¢ª³ ¢±² ¢ª ¬¨ ¬®¦­® ®´®°¬¨²¼ ª ª °¥ª³°±¨¢­³¾
¯°®¶¥¤³°³: ¦¥« ¿ ®²±®°²¨°®¢ ²¼ A[1 : :n], ¬» (°¥ª³°±¨¢­®) ±®°²¨°³¥¬ A[1 : :n ; 1],   § ²¥¬ ±² ¢¨¬ A[n] ­  ¯° ¢¨«¼­®¥ ¬¥±²® ¢ ®²±®°²¨°®¢ ­­®¬ ¬ ±±¨¢¥ A[1 : :n ; 1].  ¯¨¸¨²¥ °¥ª³°°¥­²­®¥ ±®®²­®¸¥­¨¥ ¤«¿ ¢°¥¬¥­¨ ° ¡®²» ² ª®© ¯°®¶¥¤³°».

26

« ¢  1 ¢¥¤¥­¨¥

1.3-5 ®§¢° ¹ ¿±¼ ª § ¤ ·¥ ¯®¨±ª  (³¯°. 1.1-3), § ¬¥²¨¬, ·²® ¯°¨
¯®¨±ª¥ ¢ ®²±®°²¨°®¢ ­­®¬ ¬ ±±¨¢¥ ¬» ¬®¦¥¬ ±­ · «  ±° ¢­¨²¼
¨±ª®¬»© ½«¥¬¥­² ±® ±°¥¤­¨¬ ½«¥¬¥­²®¬ ¬ ±±¨¢ , ³§­ ²¼, ¢ ª ª®©
¯®«®¢¨­¥ ¥£® ±«¥¤³¥² ¨±ª ²¼,   § ²¥¬ ¯°¨¬¥­¨²¼ ²³ ¦¥ ¨¤¥¾ °¥ª³°±¨¢­®.  ª®© ±¯®±®¡ ­ §»¢ ¥²±¿ ¤¢®¨·­»¬ ¯®¨±ª®¬ (binary search).
 ¯¨¸¨²¥ ±®®²¢¥²±²¢³¾¹³¾ ¯°®£° ¬¬³, ¨±¯®«¼§³¿ ¶¨ª« ¨«¨ °¥ª³°±¨¾. ¡º¿±­¨²¥, ¯®·¥¬³ ¢°¥¬¿ ¥¥ ° ¡®²» ¥±²¼ (log n).
1.3-6  ¬¥²¨¬, ·²® ¶¨ª« while ¢ ±²°®ª µ 5{7 ¯°®¶¥¤³°»
Insertion-Sort (° §¤. 1.1) ¯°®±¬ ²°¨¢ ¥² ½«¥¬¥­²» ®²±®°²¨°®¢ ­­®£® ³· ±²ª  A[1 : :j ; 1] ¯®¤°¿¤. ¬¥±²® ½²®£® ¬®¦­® ¡»«®
¡» ¨±¯®«¼§®¢ ²¼ ¤¢®¨·­»© ¯®¨±ª (³¯°. 1.3-5), ·²®¡» ­ ©²¨ ¬¥±²®
¢±² ¢ª¨ §  ¢°¥¬¿ (log n). ¤ ±²±¿ «¨ ² ª¨¬ ®¡° §®¬ ±¤¥« ²¼
®¡¹¥¥ ¢°¥¬¿ ° ¡®²» ° ¢­»¬ (n log n)?
1.3-7?  ­ ¬ ±±¨¢ S ¨§ n ¤¥©±²¢¨²¥«¼­»µ ·¨±¥«,   ² ª¦¥ ·¨±«®
x.  ª §  ¢°¥¬¿ (n log n) ®¯°¥¤¥«¨²¼, ¬®¦­® «¨ ¯°¥¤±² ¢¨²¼ x ¢
¢¨¤¥ ±³¬¬» ¤¢³µ ½«¥¬¥­²®¢ ¬ ±±¨¢  S ?
 ¬¥· ­¨¿
 ª ¬®£ ¡» ±ª § ²¼ ®§¼¬  °³²ª®¢, µ®°®¸¨©  «£®°¨²¬ ¯®¤®¡¥­ ®±²°®¬³ ­®¦³ | ²®² ¨ ¤°³£®© ¤®±²¨£ ¾² ¶¥«¨ «¥£ª® ¨ ¯°®±²®.
°³£®¥ ±° ¢­¥­¨¥: ·¥«®¢¥ª, ¯®«¼§³¾¹¨©±¿ ¯«®µ¨¬  «£®°¨²¬®¬, ¯®¤®¡¥­ ¯®¢ °³, ®²¡¨¢ ¾¹¥¬³ ¬¿±® ®²¢¥°²ª®©: ¥¤¢  ±º¥¤®¡­»© ¨ ¬ «®¯°¨¢«¥ª ²¥«¼­»© °¥§³«¼² ² ¤®±²¨£ ¥²±¿ ¶¥­®© ¡®«¼¸¨µ ³±¨«¨©.
 ±²® ° §­¨¶  ¬¥¦¤³ ¯«®µ¨¬ ¨ µ®°®¸¨¬  «£®°¨²¬®¬ ¡®«¥¥ ±³¹¥±²¢¥­­ , ·¥¬ ¬¥¦¤³ ¡»±²°»¬ ¨ ¬¥¤«¥­­»¬ ª®¬¯¼¾²¥°®¬. ³±²¼
¬» µ®²¨¬ ®²±®°²¨°®¢ ²¼ ¬ ±±¨¢ ¨§ ¬¨««¨®­  ·¨±¥«. ²® ¡»±²°¥¥
| ±®°²¨°®¢ ²¼ ¥£® ¢±² ¢ª ¬¨ ­  ±³¯¥°ª®¬¯¼¾²¥°¥ (100 ¬¨««¨®­®¢ ®¯¥° ¶¨© ¢ ±¥ª³­¤³) ¨«¨ ±«¨¿­¨¥¬ ­  ¤®¬ ¸­¥¬ ª®¬¯¼¾²¥°¥
(1 ¬¨««¨®­ ®¯¥° ¶¨©)? ³±²¼ ª ²®¬³ ¦¥ ±®°²¨°®¢ª  ¢±² ¢ª ¬¨ ­ ¯¨± ­  ­   ±±¥¬¡«¥°¥ ·°¥§¢»· ©­® ½ª®­®¬­®, ¨ ¤«¿ ±®°²¨°®¢ª¨ n
·¨±¥« ­³¦­®, ±ª ¦¥¬, «¨¸¼ 2n2 ®¯¥° ¶¨©.  ²® ¦¥ ¢°¥¬¿  «£®°¨²¬
±«¨¿­¨¥¬ ­ ¯¨± ­ ¡¥§ ®±®¡®© § ¡®²» ®¡ ½´´¥ª²¨¢­®±²¨ ¨ ·¨±«®
®¯¥° ¶¨© ¥±²¼ 50n log n. «¿ ±®°²¨°®¢ª¨ ¬¨««¨®­  ·¨±¥« ¯®«³· ¥¬
2  (106)2 ®¯¥° ¶¨© = 20 000 ±¥ª³­¤  5;56 · ±®¢
108 ®¯¥° ¶¨© ¢ ±¥ª³­¤³
¤«¿ ±³¯¥°ª®¬¯¼¾²¥°  ¨ ¢±¥£®
50  (106) log(106) ®¯¥° ¶¨©  1 000 ±¥ª³­¤  17 ¬¨­³²
106 ®¯¥° ¶¨© ¢ ±¥ª³­¤³
¤«¿ ¤®¬ ¸­¥£® ª®¬¯¼¾²¥° .
» ¢¨¤¨¬, ·²® ° §° ¡®²ª  ½´´¥ª²¨¢­»µ  «£®°¨²¬®¢ | ­¥ ¬¥­¥¥
¢ ¦­ ¿ ª®¬¯¼¾²¥°­ ¿ ²¥µ­®«®£¨¿, ·¥¬ ° §° ¡®²ª  ¡»±²°®© ½«¥ª²°®­¨ª¨.  ½²®© ®¡« ±²¨ ² ª¦¥ ¯°®¨±µ®¤¨² § ¬¥²­»© ¯°®£°¥±±.

 ¤ ·¨ ª £« ¢¥ 1

27

¯° ¦­¥­¨¿
1.3-1 ³±²¼ ±®°²¨°®¢ª¨ ¢±² ¢ª ¬¨ ¨ ±«¨¿­¨¥¬ ¨±¯®«­¿¾²±¿ ­ 
®¤­®© ¨ ²®© ¦¥ ¬ ¸¨­¥ ¨ ²°¥¡³¾² 8n2 ¨ 64n log n ±®®²¢¥²±²¢¥­­®.
«¿ ª ª¨µ §­ ·¥­¨© n ±®°²¨°®¢ª  ¢±² ¢ª ¬¨ ¿¢«¿¥²±¿ ¡®«¥¥ ½´´¥ª²¨¢­®©?  ª ¬®¦­® ³«³·¸¨²¼  «£®°¨²¬ ±®°²¨°®¢ª¨ ±«¨¿­¨¥¬?
1.3-2 °¨ ª ª®¬ ­ ¨¬¥­¼¸¥¬ §­ ·¥­¨¨ n  «£®°¨²¬, ¤¥« ¾¹¨©
100n2 ®¯¥° ¶¨©, ½´´¥ª²¨¢­¥¥  «£®°¨²¬ , ¤¥« ¾¹¥£® 2n ®¯¥° ¶¨©?

 ¤ ·¨
1-1 ° ¢­¥­¨¥ ¢°¥¬¥­¨ ° ¡®²»
³±²¼ ¨¬¥¥²±¿  «£®°¨²¬, °¥¸ ¾¹¨© § ¤ ·³ ° §¬¥°  n §  f (n)
¬¨ª°®±¥ª³­¤.  ª®¢ ¬ ª±¨¬ «¼­»© ° §¬¥° § ¤ ·¨, ª®²®°³¾ ®­
±¬®¦¥² °¥¸¨²¼ §  ¢°¥¬¿ t?  ©²¨ ¥£® ¤«¿ ´³­ª¶¨© ¨ ¢°¥¬¥­, ¯¥°¥·¨±«¥­­»µ ¢ ² ¡«¨¶¥.
1
1
1
1
1
1
1
±¥ª ¬¨­ · ± ¤¥­¼ ¬¥±¿¶ £®¤ ¢¥ª
log
n
p

n
n

n log n
n2
n3
2n
n!

1-2 ®°²¨°®¢ª  ¢±² ¢ª ¬¨ ¤«¿ ª®°®²ª¨µ ª³±ª®¢
±¨¬¯²®²¨·¥±ª¨ ±®°²¨°®¢ª  ±«¨¿­¨¥¬ ¡»±²°¥¥ ±®°²¨°®¢ª¨
¢±² ¢ª ¬¨, ­® ¤«¿ ¬ «»µ n ±®®²­®¸¥­¨¥ ®¡° ²­®¥. ®½²®¬³ ¨¬¥¥²
±¬»±« ¤®±² ²®·­® ª®°®²ª¨¥ ª³±ª¨ ­¥ ° §¡¨¢ ²¼ ¤ «¼¸¥,   ¯°¨¬¥­¿²¼ ª ­¨¬ ±®°²¨°®¢ª³ ¢±² ¢ª ¬¨. ®¯°®± ¢ ²®¬, £¤¥ ±«¥¤³¥²
¯°®¢¥±²¨ £° ­¨¶³.
 . ³±²¼ ¬ ±±¨¢ ¤«¨­» n ° §¡¨² ­  k · ±²¥© ° §¬¥°  n=k. ®ª ¦¨²¥, ·²® ¬®¦­® ®²±®°²¨°®¢ ²¼ ¢±¥ · ±²¨ ¯® ®²¤¥«¼­®±²¨ (±
¯®¬®¹¼¾ ±®°²¨°®¢ª¨ ¢±² ¢ª ¬¨) §  ¢°¥¬¿ (nk).
¡. ®ª ¦¨²¥, ·²® ¯®±«¥ ½²®£® ¬®¦­® ±«¨²¼ ¢±¥ · ±²¨ ¢ ®¤¨­ ³¯®°¿¤®·¥­­»© ¬ ±±¨¢ §  ¢°¥¬¿ (n log(n=k)).
¢. ¥¬ ± ¬»¬ ®¡¹¥¥ ¢°¥¬¿ ° ¡®²» ² ª®£® ±¬¥¸ ­­®£®  «£®°¨²¬ 
¥±²¼ (nk + n log(n=k)).  ª®¢  ¬ ª±¨¬ «¼­ ¿ ±ª®°®±²¼ °®±²  k ª ª
´³­ª¶¨¨ ®² n, ¯°¨ ª®²®°®¬ ½²® ¢°¥¬¿ ¯®-¯°¥¦­¥¬³ ¥±²¼ (n log n)?
£.  ª ¡» ¢» ±² «¨ ¢»¡¨° ²¼ ®¯²¨¬ «¼­®¥ §­ ·¥­¨¥ k ­  ¯° ª-

28

« ¢  1 ¢¥¤¥­¨¥

²¨ª¥?
1-3 ¨±«® ¨­¢¥°±¨©
³±²¼ A[1 : :n] | ¬ ±±¨¢ ¨§ n ° §«¨·­»µ ·¨±¥«.  ± ¡³¤¥² ¨­²¥°¥±®¢ ²¼ ª®«¨·¥±²¢® ¨­¢¥°±¨© (inversions) ¢ ½²®¬ ¬ ±±¨¢¥, ². ¥.
·¨±«® ¯ ° i < j , ¤«¿ ª®²®°»µ A[i] > A[j ].
 . ª ¦¨²¥ ¯¿²¼ ¨­¢¥°±¨© ¢ ¬ ±±¨¢¥ h2; 3; 8; 6; 1i.
¡.  ª®¢® ¬ ª±¨¬ «¼­® ¢®§¬®¦­®¥ ·¨±«® ¨­¢¥°±¨© ¢ ¬ ±±¨¢¥ ¤«¨­» n?
¢.  ª ±¢¿§ ­® ¢°¥¬¿ ° ¡®²»  «£®°¨²¬  ±®°²¨°®¢ª¨ ¢±² ¢ª ¬¨
¨ ·¨±«® ¨­¢¥°±¨©? ¡º¿±­¨²¥ ±¢®© ®²¢¥².
£. ®±²°®©²¥  «£®°¨²¬, ª®²®°»© ±·¨² ¥² ·¨±«® ¨­¢¥°±¨© ¢ ¬ ±±¨¢¥ ¤«¨­» n §  ¢°¥¬¿ (n log n). (ª § ­¨¥: ®¤¨´¨¶¨°³©²¥  «£®°¨²¬ ±®°²¨°®¢ª¨ ±«¨¿­¨¥¬.)

 ¬¥· ­¨¿
±²¼ ¬­®¦¥±²¢® µ®°®¸¨µ ª­¨£ ® ¯®±²°®¥­¨¨  «£®°¨²¬®¢. ®²
­¥ª®²®°»¥ ¨§ ­¨µ: µ®, ®¯ª°®´² ¨ «¼¬ ­ [4,5],   ± [14], ° ±± ° ¨ °¥²«¨ [14], ®°®¢¨¶ ¨  µ­¨ [105], ­³² [121, 122, 123],
 ­¡¥° [142], ¥«¼µ®°­ [144, 145, 146], ³°¤®¬ ¨ ° ³­ [164], ¥©­£®«¼¤, ¨¢¥°£¥«¼² ¨ ¥® [167], ¥¤¦¢¨ª [175], ¨«´ [201]. ° ª²¨·¥±ª¨¥  ±¯¥ª²» ° §° ¡®²ª¨ ½´´¥ª²¨¢­»µ  «£®°¨²¬®¢: ¥­²«¨
[24,25], ®­­¥² [90].
 1968 £®¤³ ­³² ®¯³¡«¨ª®¢ « ¯¥°¢»© ¨§ ²°¥µ ²®¬®¢ ±¥°¨¨ ±ª³±±²¢® ¯°®£° ¬¬¨°®¢ ­¨¿ ¤«¿  [121, 122, 123], ª®²®°»© ±² «
­ · «®¬ ­®¢®© ½¯®µ¨ ¢ ­ ³ª¥ ®¡ ½´´¥ª²¨¢­»µ  «£®°¨²¬ µ. ±¥ ²°¨
²®¬  ¤® ±¨µ ¯®° ®±² ¾²±¿ ­¥§ ¬¥­¨¬»¬ ±¯° ¢®·­¨ª®¬.  ª ¯¨¸¥²
­³², ±«®¢® À «£®°¨²¬Á ¯°®¨±µ®¤¨² ®² ¨¬¥­¨  ° ¡±ª®£® ¬ ²¥¬ ²¨ª  ¤¥¢¿²®£® ¢¥ª  «-®°¥§¬¨ (al-Khow^arizm^, ¨«¨ al-Khw^arizm^).
µ®, ®¯ª°®´² ¨ «¼¬ ­ [4] ³ª § «¨ ­  ¢ ¦­®±²¼  ±¨¬¯²®²¨·¥±ª®£®  ­ «¨§  ¢°¥¬¥­¨ ° ¡®²» ª ª ±°¥¤±²¢  ±° ¢­¥­¨¿ ½´´¥ª²¨¢­®±²¨  «£®°¨²¬®¢. ­¨ ¸¨°®ª® ¨±¯®«¼§®¢ «¨ °¥ª³°°¥­²­»¥ ±®®²­®¸¥­¨¿ ¤«¿ ¯®«³·¥­¨¿ ®¶¥­®ª ¢°¥¬¥­¨ ° ¡®²».
­¨£  ­³²  [123] ±®¤¥°¦¨² ¨±·¥°¯»¢ ¾¹¥¥ ¨§«®¦¥­¨¥ ¬­®¦¥±²¢   «£®°¨²¬®¢ ±®°²¨°®¢ª¨. ­ ±° ¢­¨¢ ¥² ° §«¨·­»¥  «£®°¨²¬», ²®·­® ¯®¤±·¨²»¢ ¿ ·¨±«® ° §«¨·­»µ ¸ £®¢ (¬» ¤¥« «¨ ½²®
¤«¿ ±®°²¨°®¢ª¨ ±° ¢­¥­¨¥¬).  ±±¬ ²°¨¢ ¾²±¿ ° §«¨·­»¥ ¢ °¨ ­²» ±®°²¨°®¢ª¨ ¢±² ¢ª ¬¨, ¢ª«¾· ¿ ±®°²¨°®¢ª³ ¥««  (D. L. Shell),
ª®²®° ¿ ¨±¯®«¼§³¥² ±®°²¨°®¢ª³ ¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¥© ± ¯®±²®¿­­»¬ ¸ £®¬ ¤«¿ ³¬¥­¼¸¥­¨¿ ·¨±«  ®¯¥° ¶¨©.
®°²¨°®¢ª  ±«¨¿­¨¥¬ ² ª¦¥ ®¯¨± ­  ¢ ª­¨£¥ ­³² , ª®²®°»©
³ª §»¢ ¥², ·²® ¬¥µ ­¨·¥±ª®¥ ³±²°®©±²¢® ¤«¿ ±«¨¿­¨¿ ¤¢³µ ±²®¯®ª ¯¥°´®ª °² §  ®¤¨­ ¯°®µ®¤ ¡»«® ¨§®¡°¥²¥­® ¢ 1938 £®¤³. ®-

 ¬¥· ­¨¿ ª £« ¢¥ 1

29

¢¨¤¨¬®¬³, ¦®­ ´®­ ¥©¬ ­ (J. von Neumann), ®¤¨­ ¨§ ®±­®¢ ²¥«¥© ¨­´®°¬ ²¨ª¨, ­ ¯¨± « ¯°®£° ¬¬³ ±®°²¨°®¢ª¨ ±«¨¿­¨¥¬ ¤«¿
ª®¬¯¼¾²¥°  EDVAC ¢ 1945 £®¤³.

I

 ²¥¬ ²¨·¥±ª¨¥ ®±­®¢»  ­ «¨§   «£®°¨²¬®¢

¢¥¤¥­¨¥
 ½²®© · ±²¨ ±®¡° ­» ±¢¥¤¥­¨¿ ¨§ ¬ ²¥¬ ²¨ª¨, ª®²®°»¥ ¨±¯®«¼§³¾²±¿ ¯°¨  ­ «¨§¥  «£®°¨²¬®¢. » ±®¢¥²³¥¬ ¡¥£«® ¯°®±¬®²°¥²¼
¥¥ ¨ ¯¥°¥©²¨ ª ±«¥¤³¾¹¨¬ £« ¢ ¬, ¢®§¢° ¹ ¿±¼ ª ¯°®±¬®²°¥­­®¬³
¯® ¬¥°¥ ­ ¤®¡­®±²¨.
 £« ¢¥ 2 ¬» ¢¢®¤¨¬ ¯®­¿²¨¿ ¨ ®¡®§­ ·¥­¨¿, ±¢¿§ ­­»¥ ±  ±¨¬¯²®²¨ª®© ´³­ª¶¨© ( ¨ ¤°.),   ² ª¦¥ ­¥ª®²®°»¥ ¤°³£¨¥.  ¸  ¶¥«¼
§¤¥±¼ ­¥ ° ±±ª § ²¼ ® ·¥¬-²® ­®¢®¬,   ¯°®±²® ±®£« ±®¢ ²¼ ®¡®§­ ·¥­¨¿ ¨ ²¥°¬¨­®«®£¨¾.
 £« ¢¥ 3 ¯°¨¢®¤¿²±¿ ° §«¨·­»¥ ¬¥²®¤» ¢»·¨±«¥­¨¿ ¨ ®¶¥­ª¨
±³¬¬ (¯®¤°®¡­®¥ ¨§«®¦¥­¨¥ ¬®¦­® ­ ©²¨ ¢ «¾¡®¬ ³·¥¡­¨ª¥ ¬ ²¥¬ ²¨·¥±ª®£®  ­ «¨§ ).
« ¢  4 ¯®±¢¿¹¥­  ¯°¥®¡° §®¢ ­¨¾ °¥ª³°°¥­²­»µ ±®®²­®¸¥­¨©
¢ ¿¢­»¥ ®¶¥­ª¨. » ´®°¬³«¨°³¥¬ ¨ ¤®ª §»¢ ¥¬ ®¡¹¥¥ ³²¢¥°¦¤¥­¨¥ ² ª®£® °®¤  (²¥®°¥¬  4.1), ª®²®°®£® ¢ ¡®«¼¸¨­±²¢¥ ±«³· ¥¢
®ª §»¢ ¥²±¿ ¤®±² ²®·­®. £® ¤®ª § ²¥«¼±²¢® ¤®¢®«¼­® ¤«¨­­®, ­®
¢ ¤ «¼­¥©¸¥¬ ­¥ ¨±¯®«¼§³¥²±¿, ² ª ·²® ¯°¨ ¯¥°¢®¬ ·²¥­¨¨ ¥£® ¬®¦­® ¯°®¯³±²¨²¼.
 £« ¢¥ 5 ¬» ¤ ¥¬ ®¯°¥¤¥«¥­¨¿ ° §«¨·­»µ ¯®­¿²¨©, ±¢¿§ ­­»µ ±
¬­®¦¥±²¢ ¬¨, ®²­®¸¥­¨¿¬¨, ´³­ª¶¨¿¬¨, £° ´ ¬¨ ¨ ¤¥°¥¢¼¿¬¨, ¨
¢¢®¤¨¬ ±®®²¢¥²±²¢³¾¹¨¥ ®¡®§­ ·¥­¨¿.
« ¢  6 ¯®±¢¿¹¥­  ®±­®¢­»¬ ¯®­¿²¨¿¬ ª®¬¡¨­ ²®°¨ª¨ ¨ ²¥®°¨¨
¢¥°®¿²­®±²¥©. ®«¼¸ ¿ · ±²¼ ª­¨£¨ ­¥ ¨±¯®«¼§³¥² ½²®£® ¬ ²¥°¨ « , ² ª ·²® ¯°¨ ¯¥°¢®¬ ·²¥­¨¨ ½²³ £« ¢³ (®±®¡¥­­® ¯®±«¥¤­¨¥
° §¤¥«») ¬®¦­® ±¬¥«® ¯°®¯³±²¨²¼, ¢®§¢° ¹ ¿±¼ ª ¯°®¯³¹¥­­®¬³
¯® ¬¥°¥ ­ ¤®¡­®±²¨.

2

ª®°®±²¼ °®±²  ´³­ª¶¨©

° ¢­¨¢ ¿ ¤¢   «£®°¨²¬  ±®°²¨°®¢ª¨ ¢ £« ¢¥ 1, ¬» ³±² ­®¢¨«¨,
·²® ¢°¥¬¿ ° ¡®²» ®¤­®£® (±®°²¨°®¢ª  ±«¨¿­¨¥¬) ¯°¨¬¥°­® ¯°®¯®°¶¨®­ «¼­® n2 ,   ¤°³£®£® (±®°²¨°®¢ª  ¢±² ¢ª ¬¨) | n lg n.  ª®¢»
¡» ­¨ ¡»«¨ ª®½´´¨¶¨¥­²» ¯°®¯®°¶¨®­ «¼­®±²¨, ¤«¿ ¤®±² ²®·­®
¡®«¼¸¨µ n ¯¥°¢»©  «£®°¨²¬ ° ¡®² ¥² ¡»±²°¥¥.
­ «¨§¨°³¿  «£®°¨²¬, ¬®¦­® ±² ° ²¼±¿ ­ ©²¨ ²®·­®¥ ·¨±«® ¢»¯®«­¿¥¬»µ ¨¬ ¤¥©±²¢¨©. ® ¢ ¡®«¼¸¨­±²¢¥ ±«³· ¥¢ ¨£°  ­¥ ±²®¨²
±¢¥·, ¨ ¤®±² ²®·­® ®¶¥­¨²¼  ±¨¬¯²®²¨ª³ °®±²  ¢°¥¬¥­¨ ° ¡®²»
 «£®°¨²¬  ¯°¨ ±²°¥¬«¥­¨¨ ° §¬¥°  ¢µ®¤  ª ¡¥±ª®­¥·­®±²¨ (asymptotic eciency). ±«¨ ³ ®¤­®£®  «£®°¨²¬  ±ª®°®±²¼ °®±²  ¬¥­¼¸¥,
·¥¬ ³ ¤°³£®£®, ²® ¢ ¡®«¼¸¨­±²¢¥ ±«³· ¥¢ ®­ ¡³¤¥² ½´´¥ª²¨¢­¥¥ ¤«¿
¢±¥µ ¢µ®¤®¢, ª°®¬¥ ±®¢±¥¬ ª®°®²ª¨µ. (®²¿ ¡»¢ ¾² ¨ ¨±ª«¾·¥­¨¿.)

2.1. ±¨¬¯²®²¨·¥±ª¨¥ ®¡®§­ ·¥­¨¿
®²¿ ¢® ¬­®£¨µ ±«³· ¿µ ½²¨ ®¡®§­ ·¥­¨¿ ¨±¯®«¼§³¾²±¿ ­¥´®°¬ «¼­®, ¯®«¥§­® ­ · ²¼ ± ²®·­»µ ®¯°¥¤¥«¥­¨©.
-®¡®§­ ·¥­¨¥
 £« ¢¥ 2 ¬» £®¢®°¨«¨, ·²® ¢°¥¬¿ T (n) ° ¡®²»  «£®°¨²¬  ±®°²¨°®¢ª¨ ¢±² ¢ª ¬¨ ­  ¢µ®¤ µ ¤«¨­» n ¥±²¼ (n2 ). ®·­»© ±¬»±« ½²®£® ³²¢¥°¦¤¥­¨¿ ² ª®©: ­ ©¤³²±¿ ² ª¨¥ ª®­±² ­²» c1; c2 > 0 ¨ ² ª®¥
·¨±«® n0 , ·²® c1n2 6 T (n) 6 c2n2 ¯°¨ ¢±¥µ n > n0 . ®®¡¹¥, ¥±«¨
g(n) | ­¥ª®²®° ¿ ´³­ª¶¨¿, ²® § ¯¨±¼ f (n) = (g (n)) ®§­ · ¥², ·²®
­ ©¤³²±¿ ² ª¨¥ c1 ; c2 > 0 ¨ ² ª®¥ n0 , ·²® 0 6 c1g (n) 6 f (n) 6 c2 g (n)
¤«¿ ¢±¥µ n > n0 (±¬. °¨±. 2.1). ( ¯¨±¼ f (n) = (g (n)) ·¨² ¥²±¿ ² ª:
À½´ ®² ½­ ¥±²¼ ²½²  ®² ¦¥ ®² ½­Á.)
[!!!!!!!!! ¨±³­®ª 2.1 - ¯®¤¯¨±¼ ª ­¥¬³: ]
««¾±²° ¶¨¨ ª ®¯°¥¤¥«¥­¨¿¬ f (n) = (g (n)), f (n) = O(g (n)) ¨
f (n) = 
(g(n)).
 §³¬¥¥²±¿, ½²® ®¡®§­ ·¥­¨¥ ±«¥¤³¥² ³¯®²°¥¡«¿²¼ ± ®±²®°®¦­®±²¼¾: ³±² ­®¢¨¢, ·²® f1 (n) = (g (n)) ¨ f2 (n) = (g (n)), ­¥ ±«¥¤³¥²

±¨¬¯²®²¨·¥±ª¨¥ ®¡®§­ ·¥­¨¿

33

§ ª«¾· ²¼, ·²® f1 (n) = f2 (n)!
¯°¥¤¥«¥­¨¥ (g (n)) ¯°¥¤¯®« £ ¥², ·²® ´³­ª¶¨¨ f (n) ¨ g (n)
 ±¨¬¯²®²¨·¥±ª¨ ­¥®²°¨¶ ²¥«¼­», ². ¥. ­¥®²°¨¶ ²¥«¼­» ¤«¿ ¤®±² ²®·­® ¡®«¼¸¨µ §­ ·¥­¨© n.  ¬¥²¨¬, ·²® ¥±«¨ ´³­ª¶¨¨ f ¨ g ±²°®£® ¯®«®¦¨²¥«¼­», ²® ¬®¦­® ¨±ª«¾·¨²¼ n0 ¨§ ®¯°¥¤¥«¥­¨¿ (¨§¬¥­¨¢
ª®­±² ­²» c1 ¨ c2 ² ª, ·²®¡» ¤«¿ ¬ «»µ n ­¥° ¢¥­±²¢® ² ª¦¥ ¢»¯®«­¿«®±¼).
±«¨ f (n) = (g (n)), ²® £®¢®°¿², ·²® g (n) ¿¢«¿¥²±¿  ±¨¬¯²®²¨·¥±ª¨ ²®·­®© ®¶¥­ª®© ¤«¿ f (n).   ± ¬®¬ ¤¥«¥ ½²® ®²­®¸¥­¨¥
±¨¬¬¥²°¨·­®: ¥±«¨ f (n) = (g (n)), ²® g (n) = (f (n)).
¥°­¥¬±¿ ª ¯°¨¬¥°³ ¨§ £« ¢» 1 ¨ ¯°®¢¥°¨¬, ·²® (1=2)n2 ; 3n =
(n2 ). ®£« ±­® ®¯°¥¤¥«¥­¨¾, ­ ¤® ³ª § ²¼ ¯®«®¦¨²¥«¼­»¥ ª®­±² ­²» c1; c2 ¨ ·¨±«® n0 ² ª, ·²®¡» ­¥° ¢¥­±²¢ 
c1n2 6 12 n2 ; 3n 6 c2n2
¢»¯®«­¿«¨±¼ ¤«¿ ¢±¥µ n > n0 .  §¤¥«¨¬ ­  n2 :
c1 6 21 ; n3 6 c2
¨¤­®, ·²® ¢»¯®«­¥­¨¿ ¢²®°®£® ­¥° ¢¥­±²¢  ¤®±² ²®·­® ¯®«®¦¨²¼
c2 = 1=2. ¥°¢®¥ ¡³¤¥² ¢»¯®«­¥­®, ¥±«¨ (­ ¯°¨¬¥°) n0 = 7 ¨ c1 =
1=14.
°³£®© ¯°¨¬¥° ¨±¯®«¼§®¢ ­¨¿ ´®°¬ «¼­®£® ®¯°¥¤¥«¥­¨¿: ¯®ª ¦¥¬, ·²® 6n3 6= (n2 ).  ± ¬®¬ ¤¥«¥, ¯³±²¼ ­ ©¤³²±¿ ² ª¨¥ c2 ¨ n0 ,
·²® 6n3 6 c2n2 ¤«¿ ¢±¥µ n > n0 . ® ²®£¤  n 6 c2 =6 ¤«¿ ¢±¥µ n > n0
| ·²® ¿¢­® ­¥ ² ª.
²»±ª¨¢ ¿  ±¨¬¯²®²¨·¥±ª¨ ²®·­³¾ ®¶¥­ª³ ¤«¿ ±³¬¬», ¬» ¬®¦¥¬ ®²¡° ±»¢ ²¼ ·«¥­» ¬¥­¼¸¥£® ¯®°¿¤ª , ª®²®°»¥ ¯°¨ ¡®«¼¸¨µ
n ±² ­®¢¿²±¿ ¬ «»¬¨ ¯® ±° ¢­¥­¨¾ ± ®±­®¢­»¬ ±« £ ¥¬»¬.  ¬¥²¨¬ ² ª¦¥, ·²® ª®½´´¨¶¨¥­² ¯°¨ ±² °¸¥¬ ·«¥­¥ °®«¨ ­¥ ¨£° ¥²
(®­ ¬®¦¥² ¯®¢«¨¿²¼ ²®«¼ª® ­  ¢»¡®° ª®­±² ­² c1 ¨ c2).  ¯°¨¬¥°, ° ±±¬®²°¨¬ ª¢ ¤° ²¨·­³¾ ´³­ª¶¨¾ f (n) = an2 + bn + c, £¤¥
a; b; c | ­¥ª®²®°»¥ ª®­±² ­²» ¨ a > 0. ²¡° ±»¢ ¿ ·«¥­» ¬« ¤¸¨µ ¯®°¿¤ª®¢ ¨ ª®½´´¨¶¨¥­² ¯°¨ ±² °¸¥¬ ·«¥­¥, ­ µ®¤¨¬, ·²®
f (n) = (n2). ²®¡» ³¡¥¤¨²¼±¿ ¢ ½²®¬ ´®°¬ «¼­®,
¬®¦­® ¯®«®p
¦¨²¼ c1 = a=4, c2 = 7a=4 ¨ n0 = 2  max((jbj=a); jcj=a) (¯°®¢¥°¼²¥,
·²® ²°¥¡®¢ ­¨¿ ¤¥©±²¢¨²¥«¼­® ¢»¯®«­¥­»). ®®¡¹¥, ¤«¿ «¾¡®£®
¯®«¨­®¬  p(n) ±²¥¯¥­¨ d ± ¯®«®¦¨²¥«¼­»¬ ±² °¸¨¬ ª®½´´¨¶¨¥­²®¬ ¨¬¥¥¬ p(n) = (nd ) (§ ¤ ·  2-1).
¯®¬¿­¥¬ ¢ ¦­»© · ±²­»© ±«³· © ¨±¯®«¼§®¢ ­¨¿ ®¡®§­ ·¥­¨©: (1) ®¡®§­ · ¥² ®£° ­¨·¥­­³¾ ´³­ª¶¨¾, ®²¤¥«¥­­³¾ ®² ­³«¿ ­¥ª®²®°»© ¯®«®¦¨²¥«¼­®© ª®­±² ­²®© ¯°¨
¤®±² ²®·­® ¡®«¼¸¨µ §­ ·¥­¨¿µ  °£³¬¥­² . (§ ª®­²¥ª±²  ®¡»·­®
¿±­®, ·²® ¨¬¥­­® ±·¨² ¥²±¿  °£³¬¥­²®¬ ´³­ª¶¨¨.)

34

« ¢  2 ª®°®±²¼ °®±²  ´³­ª¶¨©

O- ¨ 
-®¡®§­ ·¥­¨¿
 ¯¨±¼ f (n) = (g (n)) ¢ª«¾· ¥² ¢ ±¥¡¿ ¤¢¥ ®¶¥­ª¨: ¢¥°µ­¾¾ ¨
­¨¦­¾¾. µ ¬®¦­® ° §¤¥«¨²¼. ®¢®°¿², ·²® f (n) = O(g (n)), ¥±«¨
­ ©¤¥²±¿ ² ª ¿ ª®­±² ­²  c > 0 ¨ ² ª®¥ ·¨±«® n0 , ·²® 0 6 f (n) 6
cg (n) ¤«¿ ¢±¥µ n > n0 ®¢®°¿², ·²® f (n) = 
(g (n)), ¥±«¨ ­ ©¤¥²±¿
² ª ¿ ª®­±² ­²  c > 0 ¨ ² ª®¥ ·¨±«® n0 , ·²® 0 6 cg (n) 6 f (n) ¤«¿
¢±¥µ n > n0 . ²¨ § ¯¨±¨ ·¨² ¾²±¿ ² ª: À½´ ®² ½­ ¥±²¼ ® ¡®«¼¸®¥
®² ¦¥ ®² ½­Á, À½´ ®² ½­ ¥±²¼ ®¬¥£  ¡®«¼¸ ¿ ®² ¦¥ ®² ½­Á.
®-¯°¥¦­¥¬³ ¬» ¯°¥¤¯®« £ ¥¬, ·²® ´³­ª¶¨¨ f ¨ g ­¥®²°¨¶ ²¥«¼­» ¤«¿ ¤®±² ²®·­® ¡®«¼¸¨µ §­ ·¥­¨©  °£³¬¥­² . ¥£ª® ¢¨¤¥²¼
(³¯°. 2.1-5), ·²® ¢»¯®«­¥­» ±«¥¤³¾¹¨¥ ±¢®©±²¢ :
¥®°¥¬  2.1. «¿ «¾¡»µ ¤¢³µ ´³­ª¶¨© f (n) ¨ g (n) ±¢®©±²¢® f (n) =
(g (n)) ¢»¯®«­¥­® ²®£¤  ¨ ²®«¼ª® ²®£¤ , ª®£¤  f (n) = O(g (n)) ¨
f (n) = 
(g(n)).
«¿ «¾¡»µ ¤¢³µ ´³­ª¶¨© ±¢®©±²¢  f (n) = O(g (n)) ¨ g (n) =

(f (n)) ° ¢­®±¨«¼­».
 ª ¬» ¢¨¤¥«¨, an2 + bn + c = (n2 ) (¯°¨ ¯®«®¦¨²¥«¼­»µ a).
®½²®¬³ an2 + bn + c = O(n2 ). °³£®© ¯°¨¬¥°: ¯°¨ a > 0 ¬®¦­®
­ ¯¨± ²¼ an + b = O(n2) (¯®«®¦¨¬ c = a + jbj ¨ n0 = 1).  ¬¥²¨¬,
·²® ¢ ½²®¬ ±«³· ¥ an + b 6= 
(n2 ¨ an + b 6= (n2 ).
±¨¬¯²®²¨·¥±ª¨¥ ®¡®§­ ·¥­¨¿ (, O ¨ 
) · ±²® ³¯®²°¥¡«¿¾²±¿
¢­³²°¨ ´®°¬³«.  ¯°¨¬¥°, ¢ £« ¢¥ 1 ¬» ¯®«³·¨«¨ °¥ª³°°¥­²­®¥
±®®²­®¸¥­¨¥
T (n) = 2T (n=2) + (n)
¤«¿ ¢°¥¬¥­¨ ° ¡®²» ±®°²¨°®¢ª¨ ±«¨¿­¨¥¬. ¤¥±¼ (n) ®¡®§­ · ¥²
­¥ª®²®°³¾ ´³­ª¶¨¾, ¯°® ª®²®°³¾ ­ ¬ ¢ ¦­® §­ ²¼ «¨¸¼, ·²® ®­ 
­¥ ¬¥­¼¸¥ c1n ¨ ­¥ ¡®«¼¸¥ c2n ¤«¿ ­¥ª®²®°»µ ¯®«®¦¨²¥«¼­»µ c1 ¨
c2 ¨ ¤«¿ ¢±¥µ ¤®±² ²®·­® ¡®«¼¸¨µ n.
 ±²®  ±¨¬¯²®²¨·¥±ª¨¥ ®¡®§­ ·¥­¨¿ ³¯®²°¥¡«¿¾²±¿ ­¥ ¢¯®«­¥
´®°¬ «¼­®, µ®²¿ ¨µ ¯®¤° §³¬¥¢ ¥¬»© ±¬»±« ®¡»·­® ¿±¥­ ¨§ ª®­²¥ª±² .  ¯°¨¬¥°, ¬» ¬®¦¥¬ ­ ¯¨± ²¼ ¢»° ¦¥­¨¥
n
X
i=1

O(i)

¨¬¥¿ ¢ ¢¨¤³ ±³¬¬³ h(1) + h(2) + : : : + h(n), £¤¥ h(i) | ­¥ª®²®° ¿
´³­ª¶¨¿, ¤«¿ ª®²®°®© h(i) = O(i). ¥£ª® ¢¨¤¥²¼, ·²® ± ¬  ½² 
±³¬¬  ª ª ´³­ª¶¨¿ ®² n ¥±²¼ O(n2).
¨¯¨·­»© ¯°¨¬¥° ¨±¯®«¼§®¢ ­¨¿  ±¨¬¯²®²¨·¥±ª¨µ ®¡®§­ ·¥­¨© | ¶¥¯®·ª  ° ¢¥­±²¢ ­ ¯®¤®¡¨¥ 2n2 + 3n + 1 = 2n2 + (n) =
(n2 ). ²®°®¥ ¨§ ½²¨µ ° ¢¥­±²¢ (2n2 + (n) = (n2 )) ¯®­¨¬ ¥²±¿
¯°¨ ½²®¬ ² ª: ª ª®¢  ¡» ­¨ ¡»«  ´³­ª¶¨¿ h(n) = (n) ¢ «¥¢®©
· ±²¨, ±³¬¬  2n2 + h(n) ¥±²¼ (n2 ).

±¨¬¯²®²¨·¥±ª¨¥ ®¡®§­ ·¥­¨¿

35

o- ¨ !-®¡®§­ ·¥­¨¿
 ¯¨±¼ f (n) = O(g (n)) ®§­ · ¥², ·²® ± °®±²®¬ n ®²­®¸¥­¨¥
f (n)=g (n) ®±² ¥²±¿ ®£° ­¨·¥­­»¬. ±«¨ ª ²®¬³ ¦¥
f (n) = 0;
(2.1)
lim
n!1 g (n)
²® ¬» ¯¨¸¥¬ f (n) = o(g (n)) (·¨² ¥²±¿ À½´ ®² ½­ ¥±²¼ ® ¬ «®¥ ®²
¦¥ ®² ½­Á). ®°¬ «¼­® £®¢®°¿, f (n) = o(g (n)), ¥±«¨ ¤«¿ ¢±¿ª®£®
¯®«®¦¨²¥«¼­®£® " > 0 ­ ©¤¥²±¿ ² ª®¥ n0 , ·²® 0 6 f (n) 6 "g (n) ¯°¨
¢±¥µ n > n0 . (¥¬ ± ¬»¬ § ¯¨±¼ f (n) = o(g (n)) ¯°¥¤¯®« £ ¥², ·²®
f (n) ¨ g(n) ­¥®²°¨¶ ²¥«¼­» ¤«¿ ¤®±² ²®·­® ¡®«¼¸¨µ n.)
°¨¬¥°: 2n = o(n2 ), ­® 2n2 6= o(n2 ).
­ «®£¨·­»¬ ®¡° §®¬ ¢¢®¤¨²±¿ ! -®¡®§­ ·¥­¨¥: £®¢®°¿², ·²®
f (n) ¥±²¼ !(g (n)) (À½´ ®² ½­ ¥±²¼ ®¬¥£  ¬ « ¿ ®² ¦¥ ®² ½­Á), ¥±«¨ ¤«¿ «¾¡®£® ¯®«®¦¨²¥«¼­®£® c ±³¹¥±²¢³¥² ² ª®¥ n0 , ·²® 0 6
cg (n) 6 f (n) ¯°¨ ¢±¥µ n > n0 . °³£¨¬¨ ±«®¢ ¬¨, f (n) = ! (g (n))
®§­ · ¥², ·²® g (n) = o(f (n)).
°¨¬¥°: n2 =2 = ! (n), ­® n2 =2 6= ! (n2 ).
° ¢­¥­¨¥ ´³­ª¶¨©
¢¥¤¥­­»¥ ­ ¬¨ ®¯°¥¤¥«¥­¨¿ ®¡« ¤ ¾² ­¥ª®²®°»¬¨ ±¢®©±²¢ ¬¨
²° ­§¨²¨¢­®±²¨, °¥´«¥ª±¨¢­®±²¨ ¨ ±¨¬¬¥²°¨·­®±²¨:
° ­§¨²¨¢­®±²¼:
f (n) = (g (n)) ¨ g(n) = (h(n)) ¢«¥·¥² f (n) = (h(n)),
f (n) = O(g (n)) ¨ g(n) = O(h(n)) ¢«¥·¥² f (n) = O(h(n)),
f (n) = 
(g (n)) ¨ g(n) = 
(h(n)) ¢«¥·¥² f (n) = 
(h(n)),
f (n) = o(g(n)) ¨ g (n) = o(h(n)) ¢«¥·¥² f (n) = o(h(n)),
f (n) = !(g (n)) ¨ g(n) = !(h(n)) ¢«¥·¥² f (n) = ! (h(n)).
¥´«¥ª±¨¢­®±²¼:
f (n) = (f (n)), f (n) = O(f (n)), f (n) = 
(f (n)).
¨¬¬¥²°¨·­®±²¼:
f (n) = (g (n)) ¥±«¨ ¨ ²®«¼ª® ¥±«¨ g(n) = (f (n)).
¡° ¹¥­¨¥:
f (n) = O(g (n)) ¥±«¨ ¨ ²®«¼ª® ¥±«¨ g (n) = 
(f (n)),
f (n) = o(g(n)) ¥±«¨ ¨ ²®«¼ª® ¥±«¨ g (n) = ! (f (n)).
®¦­® ¯°®¢¥±²¨ ² ª³¾ ¯ ° ««¥«¼: ®²­®¸¥­¨¿ ¬¥¦¤³ ´³­ª¶¨¿¬¨
f ¨ g ¯®¤®¡­» ®²­®¸¥­¨¿¬ ¬¥¦¤³ ·¨±« ¬¨ a ¨ b:

f (n) = O(g (n))
f (n) = 
(g (n))
f (n) = (g(n))
f (n) = o(g (n))
f (n) = !(g (n))







a6b
a>b
a=b
a<b
a>b

36

« ¢  2 ª®°®±²¼ °®±²  ´³­ª¶¨©

 ° ««¥«¼ ½² , ¢¯°®·¥¬, ¢¥±¼¬  ³±«®¢­ : ±¢®©±²¢  ·¨±«®¢»µ ­¥° ¢¥­±²¢ ­¥ ¯¥°¥­®±¿²±¿ ­  ´³­ª¶¨¨.  ¯°¨¬¥°, ¤«¿ «¾¡»µ ¤¢³µ
·¨±¥« a ¨ b ¢±¥£¤  ¨«¨ a 6 b, ¨«¨ a > b, ®¤­ ª® ­¥«¼§¿ ³²¢¥°¦¤ ²¼, ·²® ¤«¿ «¾¡»µ ¤¢³µ (¯®«®¦¨²¥«¼­»µ) ´³­ª¶¨© f (n) ¨ g (n)
¨«¨ f (n) = O(g (n)), ¨«¨ f (n) = 
(g (n)).  ± ¬®¬ ¤¥«¥, ¬®¦­® ¯°®¢¥°¨²¼, ·²® ­¨ ®¤­® ¨§ ½²¨µ ¤¢³µ ±®®²­®¸¥­¨© ­¥ ¢»¯®«­¥­® ¤«¿
f (n) = n ¨ g(n) = n1+sin n (¯®ª § ²¥«¼ ±²¥¯¥­¨ ¢ ¢»° ¦¥­¨¨ ¤«¿
g(n) ¬¥­¿¥²±¿ ¢ ¨­²¥°¢ «¥ ®² 0 ¤® 2).  ¬¥²¨¬ ¥¹¥, ·²® ¤«¿ ·¨±¥« a 6 b ¢«¥·¥² a < b ¨«¨ a = b, ¢ ²® ¢°¥¬¿ ª ª ¤«¿ ´³­ª¶¨©
f (n) = O(g(n)) ­¥ ¢«¥·¥² f (n) = o(g(n)) ¨«¨ f (n) = (g (n)).
¯° ¦­¥­¨¿
2.1-1 ³±²¼ f (n) ¨ g (n) ­¥®²°¨¶ ²¥«¼­» ¤«¿ ¤®±² ²®·­® ¡®«¼¸¨µ
n. ®ª ¦¨²¥, ·²® max(f (n); g (n)) = (f (n) + g(n)).
2.1-2 ®ª ¦¨²¥, ·²®
(n + a)b = (nb )
(2.2)
¤«¿ «¾¡®£® ¢¥¹¥±²¢¥­­®£® a ¨ ¤«¿ «¾¡®£® b > 0.
2.1-3 ®·¥¬³ ³²¢¥°¦¤¥­¨¥ À¢°¥¬¿ ° ¡®²»  «£®°¨²¬  A ­¥ ¬¥­¼¸¥ O(n2)Á ­¥ ¨¬¥¥² ±¬»±« ?
2.1-4
2.1-5

®¦­® «¨ ³²¢¥°¦¤ ²¼, ·²® 2n+1 = O(2n )? ²® 22n = O(2n )?
®ª ¦¨²¥ ²¥®°¥¬³ 2.1.

2.1-6 °¨¢¥¤¨²¥ ¯°¨¬¥° ´³­ª¶¨© f (n) ¨ g (n), ¤«¿ ª®²®°»µ
f (n) = O(g (n)), ­® f (n) 6= o(g (n)) ¨ f (n) 6= (g (n)).
2.1-7 ®ª ¦¨²¥, ·²® ±¢®©±²¢  f (n) = o(g (n)) ¨ f (n) = ! (g (n)) ­¥
¬®£³² ¡»²¼ ¢»¯®«­¥­» ®¤­®¢°¥¬¥­­®.
2.1-8 ±¨¬¯²®²¨·¥±ª¨¥ ®¡®§­ ·¥­¨¿ ¬®£³² ¡»²¼ ¢¢¥¤¥­» ¨ ¤«¿
´³­ª¶¨©, § ¢¨±¿¹¨µ ®² ­¥±ª®«¼ª¨µ ¯ ° ¬¥²°®¢. ®¢®°¿², ·²®
f (m; n) = O(g(m; n)), ¥±«¨ ­ ©¤³²±¿ n0 , m0 ¨ ¯®«®¦¨²¥«¼­®¥ c, ¤«¿
ª®²®°»µ 0 6 f (m; n) 6 cg (m; n) ¤«¿ ¢±¥µ n > n0 ¨ m > m0 .  ©²¥
 ­ «®£¨·­»¥ ®¯°¥¤¥«¥­¨¿ ¤«¿ (g (m; n)) ¨ 
(g (m; n)).

2.2. ² ­¤ °²­»¥ ´³­ª¶¨¨ ¨ ®¡®§­ ·¥­¨¿
®­®²®­­®±²¼
®¢®°¿², ·²® ´³­ª¶¨¿ f (n) ¬®­®²®­­® ¢®§° ±² ¥² (is monotonically increasing), ¥±«¨ f (m) 6 f (n) ¯°¨ m 6 n. ®¢®°¿², ·²®

² ­¤ °²­»¥ ´³­ª¶¨¨ ¨ ®¡®§­ ·¥­¨¿

37

´³­ª¶¨¿ f (n) ¬®­®²®­­® ³¡»¢ ¥² (is monotonically decreasing), ¥±«¨ f (m) > f (n) ¯°¨ m 6 n. ®¢®°¿², ·²® ´³­ª¶¨¿ f (n) ±²°®£®
¢®§° ±² ¥² (is strictly increasing), ¥±«¨ f (m) < f (n) ¯°¨ m < n.
®¢®°¿², ·²® ´³­ª¶¨¿ f (n) ±²°®£® ³¡»¢ ¥² (is strictly decreasing),
¥±«¨ f (m) > f (n) ¯°¨ m < n.
¥«»¥ ¯°¨¡«¨¦¥­¨¿ ±­¨§³ ¨ ±¢¥°µ³
«¿ «¾¡®£® ¢¥¹¥±²¢¥­­®£® ·¨±«  x ·¥°¥§ bxc (the oor of x) ¬»
®¡®§­ · ¥¬ ¥£® ¶¥«³¾ · ±²¼, ². ¥. ­ ¨¡®«¼¸¥¥ ¶¥«®¥ ·¨±«®, ­¥ ¯°¥¢®±µ®¤¿¹¥¥ x. ¨¬¬¥²°¨·­»¬ ®¡° §®¬ dxe (the ceiling of x) ®¡®§­ · ¥² ­ ¨¬¥­¼¸¥¥ ¶¥«®¥ ·¨±«®, ­¥ ¬¥­¼¸¥¥ x. ·¥¢¨¤­®,
x ; 1 < bxc 6 x 6 dxe < x + 1
¤«¿ «¾¡®£® x. °®¬¥ ²®£®,

dn=2e + bn=2c = n
¤«¿ «¾¡®£® ¶¥«®£® n.  ª®­¥¶, ¤«¿ «¾¡®£® x ¨ ¤«¿ «¾¡»µ ¶¥«»µ
¯®«®¦¨²¥«¼­»µ a ¨ b ¨¬¥¥¬

ddx=ae=be = dx=abe

(2.3)

bbx=ac=bc = bx=abc

(2.4)

¨
(·²®¡» ³¡¥¤¨²¼±¿ ¢ ½²®¬, ¯®«¥§­® § ¬¥²¨²¼, ·²® ¤«¿ «¾¡®£® z ¨
¤«¿ ¶¥«®£® n ±¢®©±²¢  n 6 z ¨ n 6 bz c ° ¢­®±¨«¼­»).
³­ª¶¨¨ x 7! bxc ¨ x 7! dxe ¬®­®²®­­® ¢®§° ±² ¾².
­®£®·«¥­»
­®£®·«¥­®¬ (¯®«¨­®¬®¬) ±²¥¯¥­¨ d ®² ¯¥°¥¬¥­­®© n (polynomial in n of degree d) ­ §»¢ ¾² ´³­ª¶¨¾

p(n) =

d
X
i=0

ai ni

(d | ­¥®²°¨¶ ²¥«¼­®¥ ¶¥«®¥ ·¨±«®). ¨±«  a0 ; a1; : : :; ad ­ §»¢ ¾²
ª®½´´¨¶¨¥­² ¬¨ (coecients) ¬­®£®·«¥­ . » ±·¨² ¥¬, ·²® ±² °¸¨© ª®½´´¨¶¨¥­² ad ­¥ ° ¢¥­ ­³«¾ (¥±«¨ ½²® ­¥ ² ª, ³¬¥­¼¸¨¬ d
| ½²® ¬®¦­® ±¤¥« ²¼, ¥±«¨ ²®«¼ª® ¬­®£®·«¥­ ­¥ ° ¢¥­ ­³«¾ ²®¦¤¥±²¢¥­­®).
«¿ ¡®«¼¸¨µ §­ ·¥­¨© n §­ ª ¬­®£®·«¥­  p(n) ®¯°¥¤¥«¿¥²±¿
±² °¸¨¬ ª®½´´¨¶¨¥­²®¬ (®±² «¼­»¥ ·«¥­» ¬ «» ¯® ±° ¢­¥­¨¾ ±

38

« ¢  2 ª®°®±²¼ °®±²  ´³­ª¶¨©

­¨¬), ² ª ·²® ¯°¨ ad > 0 ¬­®£®·«¥­ p(n)  ±¨¬¯²®²¨·¥±ª¨ ¯®«®¦¨²¥«¥­ (¯®«®¦¨²¥«¥­ ¯°¨ ¡®«¼¸¨µ n) ¨ ¬®¦­® ­ ¯¨± ²¼ p(n) =
(nd ).
°¨ a > 0 ´³­ª¶¨¿ n 7! na ¬®­®²®­­® ¢®§° ±² ¥², ¯°¨ a 6
0 | ¬®­®²®­­® ³¡»¢ ¥². ®¢®°¿², ·²® ´³­ª¶¨¿ f (n) ¯®«¨­®¬¨ «¼­® ®£° ­¨·¥­ , ¥±«¨ f (n) = nO(1) , ¨«¨, ¤°³£¨¬¨ ±«®¢ ¬¨, ¥±«¨
f (n) = O(nk ) ¤«¿ ­¥ª®²®°®© ª®­±² ­²» k (±¬. ³¯°. 2.2-2).
ª±¯®­¥­²»
«¿ «¾¡»µ ¢¥¹¥±²¢¥­­»µ m, n ¨ a 6= 0 ¨¬¥¥¬

a0 = 1;
(am )n = amn ;
a1 = a;
(am )n = (an )m ;
a;1 = 1=a;
am an = am+n :
°¨ a > 1 ´³­ª¶¨¿ n 7! an ¬®­®²®­­® ¢®§° ±² ¥².

» ¡³¤¥¬ ¨­®£¤  ³±«®¢­® ¯®« £ ²¼ 00 = 1.
³­ª¶¨¿ n 7! an ­ §»¢ ¥²±¿ ¯®ª § ²¥«¼­®© ´³­ª¶¨¥©, ¨«¨ ½ª±¯®­¥­²®© (exponential). °¨ a > 1 ¯®ª § ²¥«¼­ ¿ ´³­ª¶¨¿ ° ±²¥²
¡»±²°¥¥ «¾¡®£® ¯®«¨­®¬ : ª ª®¢® ¡» ­¨ ¡»«® b,
b

n =0
lim
n!1 an

(2.5)

¨«¨, ¤°³£¨¬¨ ±«®¢ ¬¨, nb = o(an ). ±«¨ ¢ ª ·¥±²¢¥ ®±­®¢ ­¨¿ ±²¥¯¥­¨ ¢§¿²¼ ·¨±«® e = 2;71828 : : : , ²® ½ª±¯®­¥­²³ ¬®¦­® § ¯¨± ²¼ ¢
¢¨¤¥ °¿¤ 
1 k
3
2
X
ex = 1 + x + x2! + x3! + : : : = xk!
k=0

(2.6)

£¤¥ k! = 1  2  3  : : :  k (±¬. ­¨¦¥ ® ´ ª²®°¨ « µ).
«¿ ¢±¥µ ¢¥¹¥±²¢¥­­»µ x ¢»¯®«­¥­® ­¥° ¢¥­±²¢®

ex > 1 + x

(2.7)

ª®²®°®¥ ®¡° ¹ ¥²±¿ ¢ ° ¢¥­±²¢® «¨¸¼ ¯°¨ x = 0. °¨ jxj 6 1 ¬®¦­®
®¶¥­¨²¼ ex ±¢¥°µ³ ¨ ±­¨§³ ² ª:
1 + x 6 ex 6 1 + x + x2

(2.8)

®¦­® ±ª § ²¼, ·²® ex = 1 + x + (x2 ) ¯°¨ x ! 0, ¨¬¥¿ ¢ ¢¨¤³
±®®²¢¥²±²¢³¾¹¥¥ ¨±²®«ª®¢ ­¨¥ ®¡®§­ ·¥­¨¿  (¢ ª®²®°®¬ n ! 1
§ ¬¥­¥­® ­  x ! 0).
;

°¨ ¢±¥µ x ¢»¯®«­¥­® ° ¢¥­±²¢® limn!1 1 + nx n = ex .

² ­¤ °²­»¥ ´³­ª¶¨¨ ¨ ®¡®§­ ·¥­¨¿

39

®£ °¨´¬»
» ¡³¤¥¬ ¨±¯®«¼§®¢ ²¼ ² ª¨¥ ®¡®§­ ·¥­¨¿:
lg n = log2 n (¤¢®¨·­»© «®£ °¨´¬),
ln n = loge n (­ ²³° «¼­»© «®£ °¨´¬),
lgk n = (lg n)k ;
lg lg n = lg(lg n) (¯®¢²®°­»© «®£ °¨´¬).
» ¡³¤¥¬ ±·¨² ²¼, ·²® ¢ ´®°¬³« µ §­ ª «®£ °¨´¬  ®²­®±¨²±¿
«¨¸¼ ª ­¥¯®±°¥¤±²¢¥­­® ±«¥¤³¾¹¥¬³ §  ­¨¬ ¢»° ¦¥­¨¾, ² ª ·²®
lg n + k ¥±²¼ lg(n) + k (  ­¥ lg(n + k)). °¨ b > 1 ´³­ª¶¨¿ n 7! logb n
(®¯°¥¤¥«¥­­ ¿ ¯°¨ ¯®«®¦¨²¥«¼­»µ n) ±²°®£® ¢®§° ±² ¥².
«¥¤³¾¹¨¥ ²®¦¤¥±²¢  ¢¥°­» ¯°¨ ¢±¥µ a > 0, b > 0, c > 0 ¨ ¯°¨
¢±¥µ n (¥±«¨ ²®«¼ª® ®±­®¢ ­¨¿ «®£ °¨´¬®¢ ­¥ ° ¢­» 1):
a = blogb a ;
logb (1=a) = ; logb a
logc (ab) = logc a + logc b;
logb a = log1 b
(2.9)
logb an = n logb a;
a
ca
alogb c = clogb a
logb a = log
logc b
§¬¥­¥­¨¥ ®±­®¢ ­¨¿ ³ «®£ °¨´¬  ³¬­®¦ ¥² ¥£® ­  ª®­±² ­²³,
¯®½²®¬³ ¢ § ¯¨±¨ ²¨¯  O(log n) ¬®¦­® ­¥ ³²®·­¿²¼, ª ª®¢® ®±­®¢ ­¨¥ «®£ °¨´¬ . » ¡³¤¥¬ · ¹¥ ¢±¥£® ¨¬¥²¼ ¤¥«® ± ¤¢®¨·­»¬¨
«®£ °¨´¬ ¬¨ (®­¨ ¯®¿¢«¿¾²±¿, ª®£¤  § ¤ ·  ¤¥«¨²±¿ ­  ¤¢¥ · ±²¨)
¨ ¯®²®¬³ ®±² ¢«¿¥¬ §  ­¨¬¨ ®¡®§­ ·¥­¨¥ lg.
«¿ ­ ²³° «¼­®£® «®£ °¨´¬  ¥±²¼ °¿¤ (ª®²®°»© ±µ®¤¨²±¿ ¯°¨
jxj < 1):
3
4
5
2
ln(1 + x) = x ; x2 + x3 ; x4 + x5 ; : : :
°¨ x > ;1 ±¯° ¢¥¤«¨¢» ­¥° ¢¥­±²¢ 

x
(2.10)
1 + x 6 ln(1 + x) 6 x
ª®²®°»¥ ®¡° ¹ ¾²±¿ ¢ ° ¢¥­±²¢  «¨¸¼ ¯°¨ x = 0.
®¢®°¿², ·²® ´³­ª¶¨¿ f (n) ®£° ­¨·¥­  ¯®«¨«®£ °¨´¬®¬ (is polylogaritmically bounded), ¥±«¨ f (n) = lgO(1) n. °¥¤¥« (2:5) ¯®±«¥ ¯®¤±² ­®¢®ª n = lg m ¨ a = 2c ¤ ¥²
lgb m = lim lgb m = 0
lim
m!1 (2c )lg m m!1 mc
¨, ² ª¨¬ ®¡° §®¬, lgb n = o(nc ) ¤«¿ «¾¡®© ª®­±² ­²» c > 0. °³£¨¬¨ ±«®¢ ¬¨, «¾¡®© ¯®«¨­®¬ ° ±²¥² ¡»±²°¥¥ «¾¡®£® ¯®«¨«®£ °¨´¬ .

40

« ¢  2 ª®°®±²¼ °®±²  ´³­ª¶¨©

 ª²®°¨ «»
 ¯¨±¼ n! (·¨² ¥²±¿ À½­ ´ ª²®°¨ «Á, \n factorial") ®¡®§­ · ¥²
¯°®¨§¢¥¤¥­¨¥ ¢±¥µ ·¨±¥« ®² 1 ¤® n. ®« £ ¾² 0! = 1, ² ª ·²® n! =
n  (n ; 1)! ¯°¨ ¢±¥µ n = 1; 2; 3; : : : .
° §³ ¦¥ ¢¨¤­®, ·²® n! 6 nn (ª ¦¤»© ¨§ ±®¬­®¦¨²¥«¥© ­¥ ¡®«¼¸¥ n). ®«¥¥ ²®·­ ¿ ®¶¥­ª  ¤ ¥²±¿ ´®°¬³«®© ²¨°«¨­£  (Stirling's
approximation), ª®²®° ¿ £« ±¨², ·²®

p  n
n! = 2n ne (1 + (1=n))

(2.11)

§ ´®°¬³«» ²¨°«¨­£  ±«¥¤³¥², ·²®
n! = o(nn);
n! = ! (2n );
lg(n!) = (n lg n):
¯° ¢¥¤«¨¢  ² ª¦¥ ±«¥¤³¾¹ ¿ ®¶¥­ª :

 n
p  n
2n ne 6 n! 6 2n ne e1=12n:

p

(2.12)

²¥° ¶¨¨ «®£ °¨´¬ 
» ¨±¯®«¼§³¥¬ ®¡®§­ ·¥­¨¥ log n (À«®£ °¨´¬ ±® §¢¥§¤®·ª®© ®²
½­Á) ¤«¿ ´³­ª¶¨¨: ­ §»¢ ¥¬®© ¨²¥°¨°®¢ ­­»¬ «®£ °¨´¬®¬ (iterated logarithm). ²  ´³­ª¶¨¿ ®¯°¥¤¥«¿¥²±¿ ² ª. ­ · «¥ ° ±±¬®²°¨¬ i-³¾ ¨²¥° ¶¨¾ «®£ °¨´¬ , ´³­ª¶¨¾ lg(i) , ®¯°¥¤¥«¥­­³¾ ² ª:
lg(0) n = n ¨ lg(i)(n) = lg(lg(i;1) n) ¯°¨ i > 0. (®±«¥¤­¥¥ ¢»° ¦¥­¨¥
®¯°¥¤¥«¥­®, ¥±«¨ lg(i;1) n ®¯°¥¤¥«¥­® ¨ ¯®«®¦¨²¥«¼­®.) ³¤¼²¥ ¢­¨¬ ²¥«¼­»: ®¡®§­ ·¥­¨¿ lgi n ¨ lg(i) n ¢­¥¸­¥ ¯®µ®¦¨, ­® ®§­ · ¾²
±®¢¥°¸¥­­® ° §­»¥ ´³­ª¶¨¨.
¥¯¥°¼ lg n ®¯°¥¤¥«¿¥²±¿ ª ª ¬¨­¨¬ «¼­®¥ ·¨±«® i > 0, ¯°¨ ª®²®°®¬ lg(i) n 6 1. °³£¨¬¨ ±«®¢ ¬¨, lg n | ½²® ·¨±«® ° §, ª®²®°®¥
­³¦­® ¯°¨¬¥­¨²¼ ´³­ª¶¨¾ lg, ·²®¡» ¨§ n ¯®«³·¨²¼ ·¨±«®, ­¥ ¯°¥¢®±µ®¤¿¹¥¥ 1.
³­ª¶¨¿ lg n ° ±²¥² ¨±ª«¾·¨²¥«¼­® ¬¥¤«¥­­®:
lg 2 = 1;
lg 4 = 2;
lg 16 = 3;
lg 65536 = 4;
lg 265536 = 5:
®±ª®«¼ª³ ·¨±«®  ²®¬®¢ ¢ ­ ¡«¾¤ ¥¬®© · ±²¨ ±¥«¥­­®© ®¶¥­¨¢ ¥²±¿ ª ª 1080, ·²® ¬­®£® ¬¥­¼¸¥ 265536, ²® §­ ·¥­¨¿ n, ¤«¿ ª®²®°»µ
lg n > 5, ¢°¿¤ «¨ ¬®£³² ¢±²°¥²¨²¼±¿.

² ­¤ °²­»¥ ´³­ª¶¨¨ ¨ ®¡®§­ ·¥­¨¿

41

¨±«  ¨¡®­ ··¨
®±«¥¤®¢ ²¥«¼­®±²¼ ·¨±¥« ¨¡®­ ··¨ (Fibonacci numbers) ®¯°¥¤¥«¿¥²±¿ °¥ª³°°¥­²­»¬ ±®®²­®¸¥­¨¥¬:
F0 = 0; F1 = 1; Fi = Fi;1 + Fi;2 ¯°¨ i > 2
(2.13)
°³£¨¬¨ ±«®¢ ¬¨, ¢ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¨¡®­ ··¨
0; 1; 1; 2; 3; 5; 8; 13; 21; 34; 55 : : :
ª ¦¤®¥ ·¨±«® ° ¢­® ±³¬¬¥ ¤¢³µ ¯°¥¤»¤³¹¨µ. ¨±«  ¨¡®­ ··¨
±¢¿§ ­» ± ² ª ­ §»¢ ¥¬»¬ ®²­®¸¥­¨¥¬ §®«®²®£® ±¥·¥­¨¿ (golden
ratio) ' ¨ ± ±®¯°¿¦¥­­»¬ ± ­¨¬ ·¨±«®¬ '^:

p

' = 1 +2 5 = 1;61803 : : : ;
p
1
;
'^ = 2 5 = ;0;61803 : : :

(2.14)

¬¥­­®, ¨¬¥¥² ¬¥±²® ´®°¬³« 

i
i
Fi = ' p; '^

(2.15)
5
ª®²®°³¾ ¬®¦­® ¤®ª § ²¼
¯® ¨­¤³ª¶¨¨ (³¯°. 2.2-7). ®±ª®«¼ª³ j'^j <
i =p5j ¬¥­¼¸¥ 1=p5 < 1=2, ² ª ·²® Fi ° ¢­® ·¨±«³
1, ±« £ ¥¬®¥
j
'
^
p
'i = 5, ®ª°³£«¥­­®¬³ ¤® ¡«¨¦ ©¸¥£® ¶¥«®£®.
¨±«® Fi ¡»±²°® (½ª±¯®­¥­¶¨ «¼­®) ° ±²¥² ± °®±²®¬ i.
¯° ¦­¥­¨¿
2.2-1 ®ª ¦¨²¥, ·²® ¤«¿ ¬®­®²®­­® ¢®§° ±² ¾¹¨µ ´³­ª¶¨© f (n)
¨ g (n) ´³­ª¶¨¨ f (n) + g (n) ¨ f (g (n)) ¡³¤³² ² ª¦¥ ¬®­®²®­­® ¢®§° ±² ²¼. ±«¨ ª ²®¬³ ¦¥ f (n) ¨ g (n) ­¥®²°¨¶ ²¥«¼­» ¯°¨ ¢±¥µ n,
²® ¨ ´³­ª¶¨¿ f (n)g (n) ¡³¤¥² ¬®­®²®­­® ¢®§° ±² ²¼.
2.2-2 ®ª ¦¨²¥, ·²® T (n) = nO(1) ²®£¤  ¨ ²®«¼ª® ²®£¤ , ª®£¤ 
±³¹¥±²¢³¥² ¯®«®¦¨²¥«¼­®¥ k, ¯°¨ ª®²®°®¬ T (n) = O(nk ) (±·¨² ¥¬,
·²® T (n) > 1).
2.2-3

®ª ¦¨²¥ ° ¢¥­±²¢  (2.9).

2.2-4 ®ª ¦¨²¥, ·²® lg(n!) = (n lg n) ¨ ·²® n! = o(nn ).
2.2-5? ³¤¥² «¨ ´³­ª¶¨¿ dlg ne! ¯®«¨­®¬¨ «¼­® ®£° ­¨·¥­­®©?
³¤¥² «¨ ´³­ª¶¨¿ dlg lg ne! ¯®«¨­®¬¨ «¼­® ®£° ­¨·¥­­®©?
2.2-6? ²® ¡®«¼¸¥ (¯°¨ ¡®«¼¸¨µ n): lg(lg n) ¨«¨ lg(lg n)?

42

« ¢  2 ª®°®±²¼ °®±²  ´³­ª¶¨©

2.2-7

®ª ¦¨²¥ ¯® ¨­¤³ª¶¨¨ ´®°¬³«³ (2.15).

2.2-8 ®ª ¦¨²¥ ² ª³¾ ®¶¥­ª³ ¤«¿ ·¨±¥« ¨¡®­ ··¨: Fi+2 > 'i
¯°¨ i > 0 (§¤¥±¼ ' | ®²­®¸¥­¨¥ §®«®²®£® ±¥·¥­¨¿).

 ¤ ·¨
2-1 ±¨¬¯²®²¨ª  ¬­®£®·«¥­®¢
³±²¼ p(n) = a0 + a1 n + : : : + ad nd | ¬­®£®·«¥­ ±²¥¯¥­¨ d, ¯°¨·¥¬
ad > 0. ®ª ¦¨²¥, ·²®
 . p(n) = O(nk ) ¯°¨ k > d.
¡. p(n) = 
(nk ) ¯°¨ k 6 d.
¢. p(n) = (nk ) ¯°¨ k = d.
£. p(n) = o(nk ) ¯°¨ k > d.
¤. p(n) = ! (nk ) ¯°¨ k < d.
2-2 ° ¢­¥­¨¥  ±¨¬¯²®²¨ª
«¿ ¢±¥µ ª«¥²®ª ±«¥¤³¾¹¥© ² ¡«¨¶» ®²¢¥²¼²¥ À¤ Á ¨«¨ À­¥²Á ­ 
¢®¯°®± ® ²®¬, ¬®¦­® «¨ § ¯¨± ²¼ A ª ª O, o, 
, ! ¨«¨  ®² B
(k > 1, " > 0, c > 1 | ­¥ª®²®°»¥ ª®­±² ­²»).

A

lgk n
nk

B
n"
cn

 .
¡. p
¢.
n nsin n
£. 2n
2n=2
lg
m
¤. n
mlg n
¥. lg(n!) lg(nn )

O o 
 ! 

2-3 ° ¢­¥­¨¥ ±ª®°®±²¨ °®±² 
 .  ±¯®«®¦¨²¥ ±«¥¤³¾¹¨¥ 30 ´³­ª¶¨© ¢ ¯®°¿¤ª¥ ³¢¥«¨·¥­¨¿ ±ª®°®±²¨ °®±²  (ª ¦¤ ¿ ´³­ª¶¨¿ ¥±²¼ O(±«¥¤³¾¹ ¿)) ¨ ®²¬¥²¼²¥, ª ª¨¥ ¨§ ½²¨µ ´³­ª¶¨© ­  ± ¬®¬ ¤¥«¥ ¨¬¥¾² ®¤¨­ ª®¢³¾ ±ª®°®±²¼
°®±²  (®¤­  ¥±²¼  ®² ¤°³£®©):
p
lg(lg n) 2lg n ( 2)lg n n2
n!n (lg n)!
2
n
3
(3=2)
n
lg n lg(n!) 22
n1= lg n

n
lg
lg
n
ln ln n
lg n
n2 n
ln n p 1
2lg n (lgpn)lg n
en
4lg n (n + 1)! lg n
n
2n
n lg n 22n
lg lg n 2 2 lg n
¡. ª ¦¨²¥ ­¥®²°¨¶ ²¥«¼­³¾ ´³­ª¶¨¾ f (n), ª®²®° ¿ ­¥ ±° ¢­¨¬  ­¨ ± ®¤­®© ¨§ ´³­ª¶¨© gi ½²®© ² ¡«¨¶» (f (n) ­¥ ¥±²¼ O(gi(n))
¨ gi (n) ­¥ ¥±²¼ O(f (n))).
+1

 ¤ ·¨ ª £« ¢¥ 2

43

2-4 ¢®©±²¢   ±¨¬¯²®²¨·¥±ª¨µ ®¡®§­ ·¥­¨©
³±²¼ ´³­ª¶¨¨ f (n) ¨ g (n) ¯®«®¦¨²¥«¼­» ¯°¨ ¤®±² ²®·­® ¡®«¼¸¨µ n. ®¦­® «¨ ³²¢¥°¦¤ ²¼, ·²®
 . ¥±«¨ f (n) = O(g (n)), ²® g (n) = O(f (n))?
¡. f (n) + g (n) = (min(f (n); g (n)))?
¢. f (n) = O(g (n)) ¢«¥·¥² lg(f (n)) = O(lg(g (n))), ¥±«¨ lg(g (n)) > 0
¨ f (n) > 1 ¤«¿ ¤®±² ²®·­® ¡®«¼¸¨µ n?
£. f (n) = O(g (n)) ¢«¥·¥² 2f (n) = O(2g(n))?
¤. f (n) = O((f (n))2)?
¥. f (n) = O(g (n)) ¢«¥·¥² g (n) = 
(f (n))?
¦. f (n) = (f (n=2))?
§. f (n) + o(f (n)) = (f (n))?
2-5  °¨ ­²»  ±¨¬¯²®²¨·¥±ª¨µ ®¡®§­ ·¥­¨©
 ­¥ª®²®°»µ ª­¨£ µ 
-®¡®§­ ·¥­¨¥ ¨±¯®«¼§³¥²±¿ ¢ ¨­®¬ ±¬»±«¥. » ¡³¤¥¬ ¨±¯®«¼§®¢ ²¼ ®¡®§­ ·¥­¨¥ 
1 ¤«¿ ½²®£® ¢ °¨ ­² ,
·²®¡» ¨§¡¥¦ ²¼ ¯³² ­¨¶». ³±²¼ f (n) ¨ g (n) | ´³­ª¶¨¨ ­ ²³° «¼­®£®  °£³¬¥­² . ®¢®°¿², ·²® f (n) = 
1 (g (n)), ¥±«¨ ­ ©¤¥²±¿
¯®«®¦¨²¥«¼­®¥ ·¨±«® c, ¯°¨ ª®²®°®¬ f (n) > cg (n) > 0 ¤«¿ ¡¥±ª®­¥·­® ¬­®£¨µ ­ ²³° «¼­»µ n.
 . ®ª ¦¨²¥, ·²® ¤«¿ «¾¡»µ ¤¢³µ ´³­ª¶¨© f (n) ¨ g (n), ¯®«®¦¨²¥«¼­»µ ¯°¨ ¡®«¼¸¨µ §­ ·¥­¨¿µ n, ¢»¯®«­¥­® «¨¡® f (n) = O(g (n)),
«¨¡® f (n) = 
1 (g (n)), ¨ ·²® ¤«¿ ­ ¸¥£® ¯°¥¦­¥£® ®¯°¥¤¥«¥­¨¿

(g (n)) ½²®£® ³²¢¥°¦¤ ²¼ ­¥«¼§¿.
¡.  ª®¢» ¢®§¬®¦­»¥ ¤®±²®¨­±²¢  ¨ ­¥¤®±² ²ª¨ ¯°¨¬¥­¥­¨¿ ®¶¥­®ª ¢¨¤  
1 ¯°¨ ¨±±«¥¤®¢ ­¨¨ ¢°¥¬¥­¨ ° ¡®²»  «£®°¨²¬®¢?
¥ª®²®°»¥  ¢²®°» ¢ § ¯¨±¨ f (n) = O(g (n)) ­¥ ²°¥¡³¾², ·²®¡» ´³­ª¶¨¿ f (n) ¡»«   ±¨¬¯²®²¨·¥±ª¨ ¯®«®¦¨²¥«¼­®©. ³¤¥¬ ¨±¯®«¼§®¢ ²¼ ®¡®§­ ·¥­¨¥ O0 ¨ ±ª ¦¥¬, ·²® f (n) = O0(g (n)), ¥±«¨
jf (n)j = O(g(n)).
¢. ²® ¯°®¨±µ®¤¨² ¯°¨ ² ª®¬ ®¯°¥¤¥«¥­¨¨ ± ³²¢¥°¦¤¥­¨¿¬¨ ²¥®°¥¬» 2.1?
¥ª®²®°»¥  ¢²®°» ¨±¯®«¼§³¾² ¥¹¥ ®¤¨­ ¢ °¨ ­² ®¯°¥¤¥«¥­¨¿:
¡³¤¥¬ £®¢®°¨²¼, ·²® f (n) = O~ (g (n)), ¥±«¨ ­ ©¤³²±¿ ¯®«®¦¨²¥«¼­»¥
·¨±«  c ¨ k, ¤«¿ ª®²®°»µ 0 6 f (n) 6 cg (n) lgk n ¤«¿ ¢±¥µ ¤®±² ²®·­®
¡®«¼¸¨µ n.
£. ¯°¥¤¥«¨²¥ 
~ ¨ ~  ­ «®£¨·­»¬ ®¡° §®¬ ¨ ¤®ª ¦¨²¥  ­ «®£
²¥®°¥¬» 2.1.
2-6 ²¥° ¶¨¨
» ¨²¥°¨°®¢ «¨ «®£ °¨´¬¨·¥±ª³¾ ´³­ª¶¨¾, ­®  ­ «®£¨·­ ¿
®¯¥° ¶¨¿ ¢®§¬®¦­  ¨ ¤«¿ ¤°³£¨µ ´³­ª¶¨©. ³±²¼ f (n) | ­¥ª®²®° ¿
´³­ª¶¨¿, ¯°¨·¥¬ f (n) < n. ¯°¥¤¥«¨¬ f (i)(n), ¯®«®¦¨¢ f (0)(n) = n
¨ f (i)(n) = f (f (i;1)(n)) ¯°¨ i > 0.
«¿ ´¨ª±¨°®¢ ­­®£® ·¨±«  c ®¯°¥¤¥«¨¬ ´³­ª¶¨¾ fc (n) ª ª ¬¨-

44

« ¢  2 ª®°®±²¼ °®±²  ´³­ª¶¨©

­¨¬ «¼­®¥ i > 0, ¤«¿ ª®²®°®£® f (i) (n) 6 c. (°³£¨¬¨ ±«®¢ ¬¨, fc |
½²® ±ª®«¼ª® ° § ­³¦­® ¯°¨¬¥­¿²¼ ´³­ª¶¨¾ f , ·²®¡» ¨§ n ¯®«³·¨²¼
·¨±«®, ­¥ ¯°¥¢®±µ®¤¿¹¥¥ c.)  ¬¥²¨¬, ·²® fc(n) ®¯°¥¤¥«¥­® ¤ «¥ª®
­¥ ¢±¥£¤ .
«¿ ª ¦¤®© ¨§ ±«¥¤³¾¹¨µ ´³­ª¶¨© f (n) ¨ §­ ·¥­¨© c ®¶¥­¨²¥
fc ¢®§¬®¦­® ²®·­¥¥:
 .
¡.
¢.
£.
¤.
¥.
¦.
§.

f (n)
lg n
n;1
n=2
n=
pn2
pn
n1=3
n= lg n

c fc(n)

1
0
1
2
2
1
2
2

 ¬¥· ­¨¿
 ª ±·¨² ¥² ­³² [121], ¨±¯®«¼§®¢ ­¨¥ O-®¡®§­ ·¥­¨© ¢®±µ®¤¨² ª ³·¥¡­¨ª³ ¯® ²¥®°¨¨ ·¨±¥« (P. Bachmann, 1892). ¡®§­ ·¥­¨¥ o(g (n)) ¡»«® ¨±¯®«¼§®¢ ­®  ­¤ ³ (E. Landau) ¢ 1909 £®¤³ ¯°¨ ®¡±³¦¤¥­¨¨ ° ±¯°¥¤¥«¥­¨¿ ¯°®±²»µ ·¨±¥«. ±¯®«¼§®¢ ­¨¥

- ¨ -®¡®§­ ·¥­¨© °¥ª®¬¥­¤®¢ ­® ­³²®¬ [124]: ½²¨ ®¡®§­ ·¥­¨¿ ¯®§¢®«¿¾² ¨§¡¥¦ ²¼ ²¥µ­¨·¥±ª¨ ­¥ª®°°¥ª²­®£® ³¯®²°¥¡«¥­¨¿
O-®¡®§­ ·¥­¨© ¤«¿ ­¨¦­¨µ ®¶¥­®ª (µ®²¿ ¬­®£¨¥ «¾¤¨ ¯°®¤®«¦ ¾² ² ª ¤¥« ²¼). ®¤°®¡­¥¥ ®¡  ±¨¬¯²®²¨·¥±ª¨µ ®¡®§­ ·¥­¨¿µ ±¬.
­³² [121, 124] ¨ ° ±± ° ¨ °¥²«¨ [33].
¤­¨ ¨ ²¥ ¦¥ ®¡®§­ ·¥­¨¿ ¯®°®© ¨±¯®«¼§³¾²±¿ ¢ ° §«¨·­»µ ±¬»±« µ, µ®²¿ ° §­¨¶ , ª ª ¯° ¢¨«®, ®ª §»¢ ¥²±¿ ­¥±³¹¥±²¢¥­­®©. 
· ±²­®±²¨, ¨­®£¤  ±° ¢­¨¢ ¥¬»¥ ´³­ª¶¨¨ ­¥ ¯°¥¤¯®« £ ¾²±¿ ­¥®²°¨¶ ²¥«¼­»¬¨ ¯°¨ ¡®«¼¸¨µ n (¨ ±° ¢­¨¢ ¾²±¿ ¬®¤³«¨).
³¹¥±²¢³¥² ¬­®£® ±¯° ¢®·­¨ª®¢, ±®¤¥°¦ ¹¨µ ±¢¥¤¥­¨¿ ®¡ ½«¥¬¥­² °­»µ ´³­ª¶¨¿µ: ¡° ¬®¢¨· ¨ ²¥£³­ [1], ¥©¥° [27]. ®¦­®
² ª¦¥ ¢§¿²¼ «¾¡®© ³·¥¡­¨ª ¯®  ­ «¨§³ (±¬., ­ ¯°¨¬¥°, ¯®±²®« [12]
¨«¨ ®¬ ± ¨ ¨­­¨ [192]). ­¨£  ­³²  [121] ±®¤¥°¦¨² ¬­®£® ¯®«¥§­»µ ¬ ²¥¬ ²¨·¥±ª¨µ ±¢¥¤¥­¨©, ¨±¯®«¼§³¥¬»µ ¯°¨  ­ «¨§¥  «£®°¨²¬®¢.

3

³¬¬¨°®¢ ­¨¥

±«¨  «£®°¨²¬ ±®¤¥°¦¨² ¶¨ª« (for, while), ²® ¢°¥¬¿ ¥£® ° ¡®²»
¿¢«¿¥²±¿ ±³¬¬®© ¢°¥¬¥­ ®²¤¥«¼­»µ ¸ £®¢.  ¯°¨¬¥°, ª ª ¬» §­ ¥¬ ¨§ ° §¤¥«  1.2, ¢»¯®«­¥­¨¥ j -£® ¸ £   «£®°¨²¬  ±®°²¨°®¢ª¨
¢±² ¢ª ¬¨ ²°¥¡³¥² ¢°¥¬¥­¨, ¯°®¯®°¶¨®­ «¼­®£® j . ®½²®¬³ ®¡¹¥¥
¢°¥¬¿ ¡³¤¥² ®¯°¥¤¥«¿²¼±¿ ±³¬¬®©
n
X
j =1

j;

ª®²®° ¿ ¥±²¼ (n2 ). ®¤®¡­®£® °®¤  ±³¬¬» ­ ¬ ­¥ ° § ¢±²°¥²¿²±¿
(¢ · ±²­®±²¨, ¢ £« ¢¥ 4 ¯°¨  ­ «¨§¥ °¥ª³°°¥­²­»µ ±®®²­®¸¥­¨©).
 ° §¤¥«¥ 3.1 ¯¥°¥·¨±«¥­» ®±­®¢­»¥ ±¢®©±²¢  ±³¬¬. ¥ª®²®°»¥
¨§ ½²¨µ ±¢®©±²¢ ¤®ª §»¢ ¾²±¿ ¢ ° §¤¥«¥ 3.2; ¡®«¼¸¨­±²¢® ¯°®¯³¹¥­­»µ ¤®ª § ²¥«¼±²¢ ¬®¦­® ­ ©²¨ ¢ ³·¥¡­¨ª µ ¯® ¬ ²¥¬ ²¨·¥±ª®¬³  ­ «¨§³.

3.1. ³¬¬» ¨ ¨µ ±¢®©±²¢ 
«¿ ±³¬¬» a1 + a2 + : : : + an ¨±¯®«¼§³¾² ®¡®§­ ·¥­¨¥
n
X
k=1

ak :

°¨ n = 0 §­ ·¥­¨¥ ±³¬¬» ±·¨² ¥²±¿ ° ¢­»¬ 0.
 ª ¯° ¢¨«®, ­¨¦­¨© ¨ ¢¥°µ­¨© ¯°¥¤¥«» ±³¬¬¨°®¢ ­¨¿ | ¶¥«»¥
·¨±« . (±«¨ ½²® ­¥ ² ª, ®¡»·­® ¯®¤° §³¬¥¢ ¾²±¿ ¶¥«»¥ · ±²¨.)
 ª®­¥·­»µ ±³¬¬ µ ±« £ ¥¬»¥ ¬®¦­® ¯°®¨§¢®«¼­® ¯¥°¥±² ¢«¿²¼.
 ª³°± µ  ­ «¨§  ®¯°¥¤¥«¿¾² ±³¬¬³ ¡¥±ª®­¥·­®£® °¿¤  (series)
a1 + a2 + a3 + : : : ¨«¨
1
X

k=1

ak

46

« ¢  3 ³¬¬¨°®¢ ­¨¥

ª ª ¯°¥¤¥« ¯®±«¥¤®¢ ²¥«¼­®±²¨ · ±²¨·­»µ ±³¬¬
lim
n!1

n
X
k=1

ak :

±«¨ ¯°¥¤¥«  ­¥ ±³¹¥±²¢³¥², £®¢®°¿², ·²® °¿¤ ° ±µ®¤¨²±¿
(diP1
verges); ¢ ¯°®²¨¢­®¬
±«³· ¥
®­
±µ®¤¨²±¿.
±«¨
°¿¤
j
a
j
±µ®k
k=1
P
¤¨²±¿, ²® °¿¤ 1
k=1 ak ­ §»¢ ¾²  ¡±®«¾²­® ±µ®¤¿¹¨¬±¿ (absolutely
convergent series); ¢±¿ª¨©  ¡±®«¾²­® ±µ®¤¿¹¨©±¿ °¿¤ ±µ®¤¨²±¿, ­®
­¥ ­ ®¡®°®². °¨ ¯¥°¥±² ­®¢ª¥ ·«¥­®¢  ¡±®«¾²­® ±µ®¤¿¹¥£®±¿ °¿¤  ®­ ®±² ¥²±¿  ¡±®«¾²­® ±µ®¤¿¹¨¬±¿ ¨ ¥£® ±³¬¬  ­¥ ¬¥­¿¥²±¿.
¨­¥©­®±²¼
¢®©±²¢® «¨­¥©­®±²¨ £« ±¨², ·²®
n
X

n
X

k=1

k=1

(cak + bk ) = c

ak +

n
X
k=1

bk

¤«¿ «¾¡®£® ·¨±«  c ¨ ¤«¿ «¾¡»µ ª®­¥·­»µ ¯®±«¥¤®¢ ²¥«¼­®±²¥©
a1; : : :; an ¨ b1; : : :; bn. ®·«¥­­® ±ª« ¤»¢ ²¼ ¨ ³¬­®¦ ²¼ ­  ·¨±« 
¬®¦­® ­¥ ²®«¼ª® ª®­¥·­»¥ ±³¬¬», ­® ¨ ±µ®¤¿¹¨¥±¿ ¡¥±ª®­¥·­»¥
°¿¤».
°¨´¬¥²¨·¥±ª¨¥ ¯°®£°¥±±¨¨
³¬¬ 

n
X
k=1

k = 1 + 2 + : : : + n;

ª®²®° ¿ ¢®§­¨ª«  ¯°¨  ­ «¨§¥  «£®°¨²¬  ±®°²¨°®¢ª¨ ¢±² ¢ª ¬¨,
¿¢«¿¥²±¿  °¨´¬¥²¨·¥±ª®© ¯°®£°¥±±¨¥© (arithmetic series). ¥ §­ ·¥­¨¥ ° ¢­®
n
X
k=1

k = 12 n(n + 1) =
= (n2 ):

(3.1)
(3.2)

¥®¬¥²°¨·¥±ª¨¥ ¯°®£°¥±±¨¨
°¨ x 6= 1 ±³¬¬³ £¥®¬¥²°¨·¥±ª®© ¯°®£°¥±±¨¨ (geometric ¨«¨ exponential series)
n
X
k=0

xk = 1 + x + x2 + : : : + xn

³¬¬» ¨ ¨µ ±¢®©±²¢ 

47

¬®¦­® ­ ©²¨ ¯® ´®°¬³«¥
n
X
k=0

n+1
xk = x x ;;1 1 :

(3.3)

³¬¬  ¡¥±ª®­¥·­® ³¡»¢ ¾¹¥© £¥®¬¥²°¨·¥±ª®© ¯°®£°¥±±¨¨ (¯°¨
jxj < 1) ¤ ¥²±¿ ´®°¬³«®©
1
X
k=0

xk = 1 ;1 x :

(3.4)

 °¬®­¨·¥±ª¨© °¿¤
¨¬¥¥² ¢¨¤ 1 + 1=2 + 1=3 + : : : + 1=n + : : : ; ¥£® n- ¿ · ±²¨·­ ¿ ±³¬¬ 
(nth harmonic number) ° ¢­ 
n
X
1
1
1
Hn = 1 + 2 + 3 + : : : + n = k1 = ln n + O(1):
k=1

(3.5)

®·«¥­­®¥ ¨­²¥£°¨°®¢ ­¨¥ ¨ ¤¨´´¥°¥­¶¨°®¢ ­¨¥
¨´´¥°¥­¶¨°³¿ ¨«¨ ¨­²¥£°¨°³¿ ®¡¥ · ±²¨ ¨§¢¥±²­®£® ²®¦¤¥±²¢ , ¬®¦­® ¯®«³·¨²¼ ­®¢®¥.  ¯°¨¬¥°, ¤¨´´¥°¥­¶¨°³¿ ²®¦¤¥±²¢® (3.4) ¨ ³¬­®¦ ¿ °¥§³«¼² ² ­  x, ¯®«³· ¥¬
1
X
k=0

kxk = (1 ;x x)2 :

(3.6)

³¬¬» ° §­®±²¥©
«¿ «¾¡®© ¯®±«¥¤®¢ ²¥«¼­®±²¨ a0; a1; : : :; an ¬®¦­® § ¯¨± ²¼ ²®¦¤¥±²¢®
n
X
k=1

(ak ; ak;1 ) = an ; a0

(3.7)

(¢±¥ ¯°®¬¥¦³²®·­»¥ ·«¥­» ±®ª° ¹ ¾²±¿).  ª¨¥ ±³¬¬» ¯®- ­£«¨©±ª¨ ­ §»¢ ¾² telescoping series. ­ «®£¨·­®,
n;1
X
k=0

(ak ; ak+1 ) = a0 ; an :

48

« ¢  3 ³¬¬¨°®¢ ­¨¥

²®² ¯°¨¥¬ ¯®§¢®«¿¥² ¯°®±³¬¬¨°®¢ ²¼ °¿¤
1 , ¯®«³· ¥¬, ·²®
±ª®«¼ª³ k(k1+1) = k1 ; k+1
nX
;1

Pn;1

1
k=1 k(k+1) .

®-

;1 1
1 = nX
1 = 1 ; 1:
;
n
k=1 k(k + 1) k=1 k k + 1




°®¨§¢¥¤¥­¨¿
°®¨§¢¥¤¥­¨¥ ·¨±¥« a1; : : :; an § ¯¨±»¢ ¾² ª ª
n
Y
k=1

ak :

°¨ n = 0 §­ ·¥­¨¥ defn¯°®¨§¢¥¤¥­¨¿ (product) ±·¨² ¥²±¿ ° ¢­»¬ 1. ®£ °¨´¬¨°®¢ ­¨¥ ¯°¥¢° ¹ ¥² ¯°®¨§¢¥¤¥­¨¥ ¢ ±³¬¬³:
lg

n
Y
k=1

ak =

n
X
k=1

lg ak :

¯° ¦­¥­¨¿
P

3.1-1 »·¨±«¨²¥ nk=1 (2k ; 1).
3.1-2? ®ª ¦¨²¥, ¨±¯®«¼§³¿
´®°¬³«³ ¤«¿p· ±²¨·­»µ ±³¬¬ £ °¬®P
­¨·¥±ª®£® °¿¤ , ·²® nk=1 1=(2k ; 1) = ln( n) + O(1).
k
3.1-3? ®ª ¦¨²¥, ·²® 1
k=0 (k ; 1)=2 = 0.
P
2k
3.1-4? »·¨±«¨²¥ ±³¬¬³ 1
k=1 (2k + 1)x .
P

3.1-5 ±¯®«¼§³¿ «¨­¥©­®±²¼ ±³¬¬», ±´®°¬³«¨°³©²¥ ¨ ¤®ª ¦¨²¥
³²¢¥°¦¤¥­¨¥ ® ¢®§¬®¦­®±²¨ ¯¥°¥±² ­®¢ª¨  ±¨¬¯²®²¨·¥±ª®£® O®¡®§­ ·¥­¨¿ ¨ ±³¬¬¨°®¢ ­¨¿.
3.1-6 ±¯®«¼§³¿ «¨­¥©­®±²¼ ±³¬¬», ±´®°¬³«¨°³©²¥ ¨ ¤®ª ¦¨²¥ ³²¢¥°¦¤¥­¨¥ ® ¢®§¬®¦­®±²¨ ¯¥°¥±² ­®¢ª¨  ±¨¬¯²®²¨·¥±ª®£® 
®¡®§­ ·¥­¨¿ ¨ ±³¬¬¨°®¢ ­¨¿.
Q
3.1-7 »·¨±«¨²¥ ¯°®¨§¢¥¤¥­¨¥ nk=1 2  4k .
Q
3.1-8? »·¨±«¨²¥ ¯°®¨§¢¥¤¥­¨¥ nk=2 (1 ; 1=k2 ).

¶¥­ª¨ ±³¬¬

49

3.2. ¶¥­ª¨ ±³¬¬
 ±±¬®²°¨¬ ­¥±ª®«¼ª® ¯°¨¥¬®¢, ª®²®°»¥ ¯®§¢®«¿¾² ­ ©²¨ §­ ·¥­¨¥ ±³¬¬» (¨«¨ µ®²¿ ¡» ®¶¥­¨²¼ ½²³ ±³¬¬³ ±¢¥°µ³ ¨«¨ ±­¨§³).
­¤³ª¶¨¿
±«¨ ³¤ «®±¼ ³£ ¤ ²¼ ´®°¬³«³ ¤«¿ ±³¬¬», ¥¥ «¥£ª® ¯°®¢¥°¨²¼ ±
¯®¬®¹¼¾ ¬ ²¥¬ ²¨·¥±ª®© ¨­¤³ª¶¨¨.
°¨¬¥°: ¤®ª ¦¥¬, ·²® ±³¬¬ 
Pn
 °¨´¬¥²¨·¥±ª®© ¯°®£°¥±±¨¨ Sn = k=1 k ° ¢­  n(n+1)=2. °¨ n =
1 ½²® ¢¥°­®. ¥¯¥°¼ ¯°¥¤¯®«®¦¨¬, ·²® ° ¢¥­±²¢® Sn = n(n + 1)=2
¢¥°­® ¯°¨ ­¥ª®²®°®¬ n ¨ ¯°®¢¥°¨¬ ¥£® ¤«¿ n + 1.  ± ¬®¬ ¤¥«¥,
nX
+1
k=1

k=

n
X
k=1

k + (n + 1) = n(n + 1)=2 + (n + 1) = (n + 1)(n + 2)=2:

­¤³ª¶¨¾ ¬®¦­® ¨±¯®«¼§®¢ ²¼ ¨ ¤«¿ ­¥° ¢¥­±²¢.
¯®Pn  ¯°¨¬¥°,
k ¥±²¼ O(3n).
ª ¦¥¬, ·²® ±³¬¬  £¥®¬¥²°¨·¥±ª®©
¯°®£°¥±±¨¨
3
k=0
P
®·­¥¥, ¬» ¯®ª ¦¥¬, ·²® nk=0 3k 6 c  3n ¤«¿ ­¥ª®²®°®©
ª®­±² ­²»
P
c (ª®²®°³¾ ¬» ¢»¡¥°¥¬ ¯®§¤­¥¥). °¨ n = 0 ¨¬¥¥¬ 0k=0 3k = 1 6
c  1; ½²® ¢¥°­® ¯°¨ c > 1. °¥¤¯®« £ ¿ ±¯° ¢¥¤«¨¢®±²¼ ®¶¥­ª¨ ¯°¨
­¥ª®²®°®¬ n, ¤®ª ¦¥¬ ¥¥ ¤«¿ n + 1. ¬¥¥¬:
nX
+1



n
X
1
1
k
k
n
+1
n
n
+1
3 = 3 + 3 6 c3 + 3 = 3 + c c3n+1 6 c3n+1:
k=0
k=0

®±«¥¤­¨©P¯¥°¥µ®¤ § ª®­¥­, ¥±«¨ (1=3 + 1=c) 6 1, ². ¥. ¥±«¨ c > 3=2.
®½²®¬³ nk=0 3k = O(3n ), ·²® ¨ ²°¥¡®¢ «®±¼ ¤®ª § ²¼.
­¤³ª¶¨¥© ±«¥¤³¥² ¯®«¼§®¢ ²¼±¿  ªª³° ²­®, ®±®¡¥­­® ¯°¨ ¤®ª § ²¥«¼±²¢¥  ±¨¬¯²®²¨·¥±ª¨µ ®¶¥­®ª,P¯®±ª®«¼ª³ ²³² «¥£ª® ®¸¨¡¨²¼±¿.
«¿ ¯°¨¬¥°  À¤®ª ¦¥¬Á, ·²® nk=1 k = O(n). ·¥¢¨¤­®,
P1
k=1 k = O(1). °¥¤¯®« £ ¿ ±¯° ¢¥¤«¨¢®±²¼ ®¶¥­ª¨ ¯°¨ ­¥ª®²®°®¬ n, ¤®ª ¦¥¬ ¥¥ ¤«¿ ±«¥¤³¾¹¥£® §­ ·¥­¨¿ n.  ± ¬®¬ ¤¥«¥,
nX
+1
k=1

k=

n
X
k=1

k + (n + 1) = O(n) + (n + 1) [­¥¢¥°­®!]
= O(n + 1):

¸¨¡ª  ¢ ²®¬, ·²® ª®­±² ­² , ¯®¤° §³¬¥¢ ¥¬ ¿ ¢ ®¡®§­ ·¥­¨¨

O(n), ° ±²¥² ¢¬¥±²¥ ± n.
®·«¥­­»¥ ±° ¢­¥­¨¿

­®£¤  ¬®¦­® ¯®«³·¨²¼ ¢¥°µ­¾¾ ®¶¥­ª³ ¤«¿ ±³¬¬», § ¬¥­¨¢
ª ¦¤»© ¥¥ ·«¥­ ­  ¡®«¼¸¨© (­ ¯°¨¬¥°, ­  ­ ¨¡®«¼¸¨© ¨§ ·«¥­®¢

50

« ¢  3 ³¬¬¨°®¢ ­¨¥

±³¬¬»).  ª, ¯°®±²¥©¸¥©
®¶¥­ª®© ±¢¥°µ³ ¤«¿ ±³¬¬»  °¨´¬¥²¨·¥P
±ª®© ¯°®£°¥±±¨¨ nk=1 k ¡³¤¥²
n
X
k=1

 ®¡¹¥¬ ±«³· ¥

k6

n
X
k=1

n = n2:

n
X

ak 6 namax;
k=1
­ ¨¡®«¼¸¥¥ ¨§ a1 ; : : :; an .

£¤¥ amax |
 ­¥ª®²®°»µ ±«³· ¿µ ¬®¦­® ¯°¨¬¥­¨²¼ ¡®«¥¥ ²®·­»© ¬¥²®¤ |
±° ¢­¥­¨¥
± £¥®¬¥²°¨·¥±ª®© ¯°®£°¥±±¨¥©. ®¯³±²¨¬, ¤ ­ °¿¤
Pn
a
±
¯®«®¦¨²¥«¼­»¬¨
·«¥­ ¬¨, ¤«¿ ª®²®°®£® ak+1 =ak 6 r
k
k=0
¯°¨ ¢±¥µ k > 0 ¨ ­¥ª®²®°®¬ r < 1. ®£¤  ak 6 a0 rk , ¨ ±³¬¬  ¬®¦¥²
¡»²¼ ®£° ­¨·¥­  ±¢¥°µ³ ¡¥±ª®­¥·­®© ³¡»¢ ¾¹¥© £¥®¬¥²°¨·¥±ª®©
¯°®£°¥±±¨¥©:
n
X
k=0

ak 6

1
X
k=0

rk

a0 = a0

1
X

rk = a0 1 ;1 r :

k=0
P
;k
½²®² ¬¥²®¤ ¤«¿ ±³¬¬» 1
k=1 k3 . ¥°¢»© ·«¥­ ° ¢¥­

°¨¬¥­¨¬
1=3, ®²­®¸¥­¨¥ ±®±¥¤­¨µ ·«¥­®¢ ° ¢­®

(k + 1)3;(k+1) = 1  k + 1 6 2
k3;k
3 k
3
¤«¿ ¢±¥µ k > 1. «¥¤®¢ ²¥«¼­®, ª ¦¤»© ·«¥­ ±³¬¬» ®¶¥­¨¢ ¥²±¿
±¢¥°µ³ ¢¥«¨·¨­®© (1=3)(2=3)k, ² ª ·²®
1
X

1 1  2 k 1
X
;
k
k 3 6 3  3 = 3  1 2 = 1:
1; 3
k=1
k=1

 ¦­®, ·²® ®²­®¸¥­¨¥ ±®±¥¤­¨µ ·«¥­®¢ ­¥ ¯°®±²® ¬¥­¼¸¥ 1,  
®£° ­¨·¥­® ­¥ª®²®°®© ª®­±² ­²®© r < 1, ®¡¹¥© ¤«¿ ¢±¥µ ·«¥­®¢
°¿¤ .  ¯°¨¬¥°, ¤«¿ £ °¬®­¨·¥±ª®£® °¿¤  ®²­®¸¥­¨¥ (k + 1)-£® ¨
k < 1. ¥¬ ­¥ ¬¥­¥¥
k-£® ·«¥­®¢ ° ¢­® k+1
1
X
k=1

n
1 = lim X
1 = lim (lg n) = 1:
k n!1 k n!1
k=1

¤¥±¼ ­¥ ±³¹¥±²¢³¥² ª®­±² ­²» r, ®²¤¥«¿¾¹¥© ®²­®¸¥­¨¿ ±®±¥¤­¨µ
·«¥­®¢ ®² ¥¤¨­¨¶».

¶¥­ª¨ ±³¬¬

51

 §¡¨¥­¨¥ ­  · ±²¨
®¦­® ° §¡¨²¼ ±³¬¬³ ­  · ±²¨ ¨ ®¶¥­¨¢ ²¼ ª ¦¤³¾ · ±²¼ ¯®
®²¤¥«¼­®±²¨.  ª ·¥±²¢¥ ¯°¨¬¥°  ¯®«³·¨¬
­¨¦­¾¾ ®¶¥­ª³ ¤«¿
P
±³¬¬»  °¨´¬¥²¨·¥±ª®© ¯°®£°¥±±¨¨ nk=1 k. ±«¨
P ¬» ®¶¥­¨¬ ±­¨§³ ª ¦¤»© ·«¥­ ¥¤¨­¨¶¥©, ²® ¯®«³·¨¬ ®¶¥­ª³ nk=1 k > n.  §­¨¶ 
± ¢¥°µ­¥© ®¶¥­ª®© O(n2) ±«¨¸ª®¬ ¢¥«¨ª , ¯®½²®¬³ ¯®±²³¯¨¬ ¯®¤°³£®¬³:
n
X
k=1

k=

n=2
X
k=1

k+

n
X

k=n=2+1

k>

n=2
X
k=1

0+

n
X

k=n=2+1

n =  n 2 :
2

2

²  ®¶¥­ª  ³¦¥  ±¨¬¯²®²¨·¥±ª¨ ²®·­  (®²«¨· ¥²±¿ ®² ¢¥°µ­¥©
®¶¥­ª¨, ¨ ²¥¬ ± ¬»¬ ®² ¨±²¨­­®£® §­ ·¥­¨¿, ­¥ ¡®«¥¥ ·¥¬ ¢ ª®­±² ­²³ ° §).
­®£¤  ¯®«¥§­® ®²¡°®±¨²¼ ­¥±ª®«¼ª® ¯¥°¢»µ ·«¥­®¢ ¯®±«¥¤®¢ ²¥«¼­®±²¨, § ¯¨± ¢ (¤«¿ ´¨ª±¨°®¢ ­­®£® k0 )
n
X
k=0

ak =

k0
X
k=0

 ¯°¨¬¥°, ¤«¿ °¿¤ 

ak +

n
X

k=k0 +1

1
X

ak = (1) +

n
X

k=k0 +1

ak :

k2

k
k=0 2

®²­®¸¥­¨¥ ¯®±«¥¤®¢ ²¥«¼­»µ ·«¥­®¢
(k + 1)2=2k+1 = (k + 1)2
k2 =2k
2k2
­¥ ¢±¥£¤  ¬¥­¼¸¥ 1. ®½²®¬³, ·²®¡» ¯°¨¬¥­¨²¼ ¬¥²®¤ ±° ¢­¥­¨¿
± £¥®¬¥²°¨·¥±ª®© ¯°®£°¥±±¨¥©, ¢»¤¥«¨¬ ²°¨ ¯¥°¢»µ ·«¥­  °¿¤ .
«¿ ¢±¥µ ±«¥¤³¾¹¨µ ·«¥­®¢ (k > 3) ®²­®¸¥­¨¥ ­¥ ¯°¥¢®±µ®¤¨² 8=9,
¯®½²®¬³
2 2 X
1 k2
1  8 k
1 k2 X
X
X
k
9
= O(1);
k =
k+
k 6 O(1) + 8
k=0 2
k=3 2
k=0 9
k=0 2
¯®±ª®«¼ª³ ¢²®° ¿ ±³¬¬  | ¡¥±ª®­¥·­® ³¡»¢ ¾¹ ¿ £¥®¬¥²°¨·¥±ª ¿
¯°®£°¥±±¨¿.
 §¡¨¥­¨¥ °¿¤  ­  · ±²¨ ¡»¢ ¥² ¯®«¥§­® ¨ ¢ ¡®«¥¥ ±«®¦­»µ ±¨²³ ¶¨¿µ.P¶¥­¨¬, ­ ¯°¨¬¥°, · ±²¨·­»¥ ±³¬¬» £ °¬®­¨·¥±ª®£® °¿¤ 
Hn = nk=1 1k . «¿ ½²®£® ° §®¡¼¥¬ ®²°¥§®ª ®² 1 ¤® n ­  blg nc · ±²¥© 1 + (1=2 + 1=3) + (1=4 + 1=5 + 1=6 + 1=7) + : : : .  ¦¤ ¿ · ±²¼ ­¥
¯°¥¢®±µ®¤¨² 1 (§ ¬¥­¨¬ ¢±¥ ±« £ ¥¬»¥ ¢ ­¥© ­  ¯¥°¢®¥ ¨§ ­¨µ), ¢±¥£® · ±²¥© blg nc + 1 (¯®±«¥¤­¿¿ ¬®¦¥² ¡»²¼ ­¥¯®«­®©). ®«³· ¥¬,
·²®
1 + 1=2 + 1=3 + : : : + 1=n 6 lg n + 1:
(3.8)

52

« ¢  3 ³¬¬¨°®¢ ­¨¥

° ¢­¥­¨¥ ± ¨­²¥£° « ¬¨
«¿ ¬®­®²®­­®
¢®§° ±² ¾¹¥© ´³­ª¶¨¨ f ¬» ¬®¦¥¬ § ª«¾·¨²¼
Pn
±³¬¬³ k=m f (k) ¬¥¦¤³ ¤¢³¬¿ ¨­²¥£° « ¬¨:
Zn

f (x) dx 6

m;1

n
X
k=m

f (k ) 6

nZ+1
m

f (x) dx:

(3.9)

 ± ¬®¬ ¤¥«¥, ª ª ¢¨¤­® ¨§ °¨±. 3.1, ±³¬¬  (¯«®¹ ¤¼ ¢±¥µ ¯°¿¬®³£®«¼­¨ª®¢) ±®¤¥°¦¨² ®¤­³ § ª° ¸¥­­³¾ ®¡« ±²¼ (¢¥°µ­¨© °¨±³­®ª) ¨ ±®¤¥°¦¨²±¿ ¢ ¤°³£®© (­¨¦­¨© °¨±³­®ª). ­ «®£¨·­®¥ ­¥° ¢¥­±²¢® ¬®¦­® ­ ¯¨± ²¼ ¤«¿ ¬®­®²®­­® ³¡»¢ ¾¹¥© ´³­ª¶¨¨ f :
nZ+1

n
X

m

k =m

f (x) dx 6

f (k) 6

Zn

m;1

f (x) dx:

(3.10)

²¨¬ ¬¥²®¤®¬ ¬®¦­® ¯®«³·¨²¼ µ®°®¸¨¥ ®¶¥­ª¨ ¤«¿ · ±²¨·­»µ
±³¬¬ £ °¬®­¨·¥±ª®£® °¿¤ : ­¨¦­¾¾ ®¶¥­ª³
n
X

nZ+1

1>

k=1 k

1

dx = ln(n + 1)
x

(3.11)

¨ ¢¥°µ­¾¾ ®¶¥­ª³ (¤«¿ °¿¤  ¡¥§ ¯¥°¢®£® ·«¥­ )
n
X
k=2

16
k

Zn

®²ª³¤ 
n
X

1

dx = ln n;
x

1 6 ln n + 1:

k=1 k

(3.12)

¯° ¦­¥­¨¿
P

3.2-1 ®ª ¦¨²¥, ·²® ±³¬¬  nk=1 k1 ®£° ­¨·¥­  ±¢¥°µ³ ª®­±² ­²®© (­¥ § ¢¨±¿¹¥© ®² n).
3.2-2  ©¤¨²¥  ±¨¬¯²®²¨·¥±ª³¾ ¢¥°µ­¾¾ ®¶¥­ª³ ¤«¿ ±³¬¬»
2

bX
lg nc
k=0

dn=2k e:

¶¥­ª¨ ±³¬¬

53

P

° ¢­¥­¨¥ ±³¬¬» nk=m f (k) ± ¨­²¥£° « ¬¨. ­³²°¨ ª ¦¤®£® ¯°¿¬®³£®«¼­¨ª  § ¯¨± ­  ¥£® ¯«®¹ ¤¼. ¡¹ ¿ ¯«®¹ ¤¼ ¢±¥µ ¯°¿¬®³£®«¼­¨ª®¢ ° ¢­ 
§­ ·¥­¨¾ ±³¬¬». ­ ·¥­¨¥ ¨­²¥£° «  ° ¢­®R n¯«®¹ ¤¨ § ª° ¸¥­­®©
´¨£³°» ¯®¤
P
ª°¨¢®©. ( ) ° ¢­¨¢ ¿ ¯«®¹ ¤¨, ¯®«³· ¥¬ m;1 f (x) dx 6 nk=m f (k). (¡) ¤¢¨R
P
£ ¿ ¯°¿¬®³£®«¼­¨ª¨ ­  ¥¤¨­¨¶³ ¢¯° ¢®, ¢¨¤¨¬, ·²® nk=m f (k) 6 mn+1 f (x) dx.
¨±. 3.1

54

« ¢  3 ³¬¬¨°®¢ ­¨¥

3.2-3  §¡¨¢ ¿ ±³¬¬³ ­  · ±²¨, ¯®ª ¦¨²¥, ·²® n-¿ · ±²¨·­ ¿
±³¬¬  £ °¬®­¨·¥±ª®£® °¿¤  ¥±²¼ 
(lg n).
P
3.2-4  ª«¾·¨²¥ ±³¬¬³ nk=1 k3 ¬¥¦¤³ ¤¢³¬¿ ¨­²¥£° « ¬¨.
3.2-5 ®·¥¬³ ¯°¨ ¯®«³·¥­¨¨ ¢¥°µ­¥© ®¶¥­ª¨ ¤«¿ · ±²¨·­®© ±³¬¬» £ °¬®­¨·¥±ª®£® °¿¤  ¬» ®²¡°®±¨«¨ ¯¥°¢»© ·«¥­ ¨ ²®«¼ª® ¯®²®¬ ¯°¨¬¥­¨«¨ ®¶¥­ª³ (3.10)?

 ¤ ·¨
3-1 ¶¥­ª¨ ¤«¿ ±³¬¬
 ©¤¨²¥  ±¨¬¯²®²¨·¥±ª¨ ²®·­»¥ ®¶¥­ª¨ ¤«¿ ±«¥¤³¾¹¨µ ±³¬¬
(±·¨² ¿ r > 0 ¨ s > 0 ª®­±² ­² ¬¨):
P
 . nk=1 kr .
P
¡. nk=1 lgs k.
P
¢. nk=1 kr lgs k.

 ¬¥· ­¨¿
­¨£  ­³²  [121] | ¯°¥ª° ±­»© ±¯° ¢®·­¨ª ¯® ¬ ²¥°¨ «³ ½²®©
£« ¢». ±­®¢­»¥ ±¢®©±²¢  °¿¤®¢ ¬®¦­® ­ ©²¨ ¢ «¾¡®¬ ³·¥¡­¨ª¥ ¯®
¬ ²¥¬ ²¨·¥±ª®¬³  ­ «¨§³ ( ¢²®°» ®²±»« ¾²  ­£«®¿§»·­®£® ·¨² ²¥«¿ ª ª­¨£ ¬ [12] ¨ [192]).

4

¥ª³°°¥­²­»¥ ±®®²­®¸¥­¨¿

¶¥­¨¢ ¿ ¢°¥¬¿ ° ¡®²» °¥ª³°±¨¢­®© ¯°®¶¥¤³°», ¬» · ±²® ¯°¨µ®¤¨¬ ª ±®®²­®¸¥­¨¾, ª®²®°®¥ ®¶¥­¨¢ ¥² ½²® ¢°¥¬¿ ·¥°¥§ ¢°¥¬¿
° ¡®²» ²®© ¦¥ ¯°®¶¥¤³°» ­  ¢µ®¤­»µ ¤ ­­»µ ¬¥­¼¸¥£® ° §¬¥° .  ª®£® °®¤  ±®®²­®¸¥­¨¿ ­ §»¢ ¾²±¿ °¥ª³°°¥­²­»¬¨ (recurrences).  ¯°¨¬¥°, ª ª ¬» ¢¨¤¥«¨ ¢ £« ¢¥ 1, ¢°¥¬¿ ° ¡®²» ¯°®¶¥¤³°» Merge-Sort ®¯¨±»¢ ¥²±¿ ±®®²­®¸¥­¨¥¬

T (n) =

(

(1);
¥±«¨ n = 1,
2T (n=2) + (n); ¥±«¨ n > 1.

(4.1)

¨§ ª®²®°®£® ¢»²¥ª ¥² (ª ª ¬» ³¢¨¤¨¬), ·²® T (n) = (n lg n).
 ½²®© £« ¢¥ ¯°¥¤« £ ¾²±¿ ²°¨ ±¯®±®¡ , ¯®§¢®«¿¾¹¨¥ °¥¸¨²¼
°¥ª³°°¥­²­®¥ ±®®²­®¸¥­¨¥, ². ¥. ­ ©²¨  ±¨¬¯²®²¨·¥±ª³¾ (ÀÁ ¨«¨
ÀOÁ) ®¶¥­ª³ ¤«¿ ¥£® °¥¸¥­¨©. ®-¯¥°¢»µ, ¬®¦­® ³£ ¤ ²¼ ®¶¥­ª³,
  § ²¥¬ ¤®ª § ²¼ ¥¥ ¯® ¨­¤³ª¶¨¨, ¯®¤±² ¢«¿¿ ³£ ¤ ­­³¾ ´®°¬³«³ ¢ ¯° ¢³¾ · ±²¼ ±®®²­®¸¥­¨¿ (¬¥²®¤ ¯®¤±² ­®¢ª¨, substitution
method). ®-¢²®°»µ, ¬®¦­® À° §¢¥°­³²¼Á °¥ª³°°¥­²­³¾ ´®°¬³«³,
¯®«³·¨¢ ¯°¨ ½²®¬ ±³¬¬³, ª®²®°³¾ ¬®¦­® § ²¥¬ ®¶¥­¨¢ ²¼ (¬¥²®¤
¨²¥° ¶¨©, iteration method).  ª®­¥¶, ¬» ¯°¨¢®¤¨¬ ®¡¹¨© °¥§³«¼² ² ® °¥ª³°°¥­²­»µ ±®®²­®¸¥­¨¿µ ¢¨¤ 

T (n) = aT (n=b) + f (n);
£¤¥ a > 1, b > 1 | ­¥ª®²®°»¥ ª®­±² ­²»,   f (n) | § ¤ ­­ ¿ ´³­ª-

¶¨¿. ®®²¢¥²±²¢³¾¹¨© °¥§³«¼² ² ¬» ¡³¤¥² ­ §»¢ ²¼ ®±­®¢­®© ²¥®°¥¬®© ® °¥ª³°°¥­²­»µ ±®®²­®¸¥­¨¿µ (master theorem). ®°¬³«¨°®¢ª  ½²®© ²¥®°¥¬» ¤®¢®«¼­® ¤«¨­­ , § ²® ¢® ¬­®£¨µ ±«³· ¿µ ®­ 
±° §³ ¯°¨¢®¤¨² ª ®²¢¥²³.
¥µ­¨·¥±ª¨¥ ¤¥² «¨
®°¬³«¨°³¿ ¨ ¤®ª §»¢ ¿ ³²¢¥°¦¤¥­¨¿ ¯°® °¥ª³°°¥­²­»¥ ±®®²­®¸¥­¨¿, ¬» ¡³¤¥¬ ®¯³±ª ²¼ ­¥ª®²®°»¥ ²¥µ­¨·¥±ª¨¥ ¯®¤°®¡­®±²¨.
 ¯°¨¬¥°, ¢ ¯°¨¢¥¤¥­­®© ¢»¸¥ ´®°¬³«¥ ¤«¿ ¯°®¶¥¤³°» Merge-

56

« ¢  4 ¥ª³°°¥­²­»¥ ±®®²­®¸¥­¨¿

Sort ¤®«¦­» ±²®¿²¼ ¶¥«»¥ · ±²¨ (T (n) ®¯°¥¤¥«¥­® «¨¸¼ ¯°¨ ¶¥-

«»µ n):

(

(1);
¥±«¨ n = 1,
(4.2)
T (dn=2e) + T (bn=2c) + (n); ¥±«¨ n > 1.
°®¬¥ ²®£®, ®¡»·­® ¬» ¡³¤¥¬ ®¯³±ª ²¼ ­ · «¼­»¥ ³±«®¢¨¿, ¨¬¥¿
¢ ¢¨¤³, ·²® T (n) = (1) ¤«¿ ­¥¡®«¼¸¨µ n.  ª¨¬ ®¡° §®¬, ±®®²­®¸¥­¨¥ (4.1) § ¯¨¸¥²±¿ ¢ ¢¨¤¥
T (n) = 2T (n=2) + (n):
(4.3)
²® ¯®§¢®«¨²¥«¼­®, ² ª ª ª ­ · «¼­®¥ ³±«®¢¨¥ (§­ ·¥­¨¥ T (1)) ¢«¨¿¥² ²®«¼ª® ­  ¯®±²®¿­­»© ¬­®¦¨²¥«¼, ­® ­¥ ­  ¯®°¿¤®ª °®±² 
´³­ª¶¨¨ T (n).
 ª®¥ ­¥¡°¥¦­®¥ ®¡° ¹¥­¨¥ ± ¤¥² «¿¬¨, ª®­¥·­®, ²°¥¡³¥² ®±²®°®¦­®±²¨, ·²®¡» ­¥ ³¯³±²¨²¼ (¯³±²¼ °¥¤ª¨µ) ±«³· ¥¢, ¢ ª®²®°»µ
¯®¤®¡­»¥ ¤¥² «¨ ¢«¨¿¾² ­  °¥§³«¼² ².  ½²®© £« ¢¥ ¬» ° §¡¥°¥¬
­¥±ª®«¼ª® ¯°¨¬¥°®¢, ¯®ª §»¢ ¾¹¨µ, ª ª ¢®±¯®«­¨²¼ ¯°®¯³¹¥­­»¥
¤¥² «¨ (±¬. ¤®ª § ²¥«¼±²¢® ²¥®°¥¬» 4.1 ¨ § ¤ ·³ 4.5).

T (n) =

4.1. ¥²®¤ ¯®¤±² ­®¢ª¨
¤¥¿ ¯°®±² : ®²£ ¤ ²¼ ®²¢¥² ¨ ¤®ª § ²¼ ¥£® ¯® ¨­¤³ª¶¨¨.  ±²®
®²¢¥² ±®¤¥°¦¨² ª®½´´¨¶¨¥­²», ª®²®°»¥ ­ ¤® ¢»¡° ²¼ ² ª, ·²®¡»
° ±±³¦¤¥­¨¥ ¯® ¨­¤³ª¶¨¨ ¯°®µ®¤¨«®.
­¤³ª²¨¢­»© ¬¥²®¤ ¯°¨¬¥­¨¬ ¨ ª ­¨¦­¨¬, ¨ ª ¢¥°µ­¨¬ ®¶¥­ª ¬.  ª ·¥±²¢¥ ¯°¨¬¥°  ­ ©¤¥¬ ¢¥°µ­¾¾ ®¶¥­ª³ ¤«¿ ´³­ª¶¨¨,
§ ¤ ­­®© ±®®²­®¸¥­¨¥¬
T (n) = 2T (bn=2c) + n;
(4.4)
ª®²®°®¥  ­ «®£¨·­® (4.2) ¨ (4.3). ®¦­® ¯°¥¤¯®«®¦¨²¼, ·²® T (n) =
O(n lg n), ². ¥. ·²® T (n) 6 cn lg n ¤«¿ ¯®¤µ®¤¿¹¥£® c > 0. ³¤¥¬ ¤®ª §»¢ ²¼ ½²® ¯® ¨­¤³ª¶¨¨. ³±²¼ ½²  ®¶¥­ª  ¢¥°­  ¤«¿ bn=2c, ². ¥.
T (bn=2c) 6 cbn=2c lg(bn=2c). ®¤±² ¢¨¢ ¥¥ ¢ ±®®²­®¸¥­¨¥, ¯®«³·¨¬
T (n) 6 2(cbn=2c lg(bn=2c)) + n 6
6 cn lg(n=2) + n = cn lg n ; cn lg 2 + n = cn lg n ; cn + n 6
6 cn lg n:
®±«¥¤­¨© ¯¥°¥µ®¤ § ª®­¥­ ¯°¨ c > 1.
«¿ § ¢¥°¸¥­¨¿ ° ±±³¦¤¥­¨¿ ®±² ¥²±¿ ¯°®¢¥°¨²¼ ¡ §¨± ¨­¤³ª¶¨¨, ². ¥. ¤®ª § ²¼ ®¶¥­ª³ ¤«¿ ­ · «¼­®£® §­ ·¥­¨¿ n. ³² ¬» ±² «ª¨¢ ¥¬±¿ ± ²¥¬, ·²® ¯°¨ n = 1 ¯° ¢ ¿ · ±²¼ ­¥° ¢¥­±²¢  ®¡° ¹ ¥²±¿ ¢ ­³«¼, ª ª¨¬ ¡» ­¨ ¢§¿²¼ c (¯®±ª®«¼ª³ lg 1 = 0). °¨µ®¤¨²±¿ ¢±¯®¬­¨²¼, ·²®  ±¨¬¯²®²¨·¥±ª³¾ ®¶¥­ª³ ¤®±² ²®·­® ¤®ª § ²¼

¥²®¤ ¯®¤±² ­®¢ª¨

57

¤«¿ ¢±¥µ n, ­ ·¨­ ¿ ± ­¥ª®²®°®£®. ®¤¡¥°¥¬ c ² ª, ·²®¡» ®¶¥­ª 
T (n) 6 cn lg n ¡»«  ¢¥°­  ¯°¨ n = 2 ¨ n = 3. ®£¤  ¤«¿ ¡®«¼¸¨µ n
¬®¦­® ° ±±³¦¤ ²¼ ¯® ¨­¤³ª¶¨¨, ¨ ®¯ ±­»© ±«³· © n = 1 ­ ¬ ­¥
¢±²°¥²¨²±¿ (¯®±ª®«¼ª³ bn=2c > 2 ¯°¨ n > 3).
 ª ®²£ ¤ ²¼ ®¶¥­ª³?
«¿ ½²®£® ­³¦¥­ ­ ¢»ª ¨ ­¥¬­®£® ¢¥§¥­¨¿. ®² ­¥±ª®«¼ª® ­ ¢®¤¿¹¨µ ±®®¡° ¦¥­¨©.
­ «®£¨¿.  ±±¬®²°¨¬ ¤«¿ ¯°¨¬¥°  ±®®²­®¸¥­¨¥

T (n) = 2T (bn=2c + 17) + n:
ª®²®°®¥ ®²«¨· ¥²±¿ ®² (4.4) ¤®¡ ¢®·­»¬ ±« £ ¥¬»¬ 17 ¢ ¯° ¢®©
· ±²¨. ®¦­® ®¦¨¤ ²¼, ®¤­ ª®, ·²® ½²  ¤®¡ ¢ª  ­¥ ¬®¦¥² ±³¹¥±²¢¥­­® ¨§¬¥­¨²¼ µ ° ª²¥° °¥¸¥­¨¿: ¯°¨ ¡®«¼¸¨µ n ° §­¨¶ 
¬¥¦¤³ bn=2c + 17 ¨ bn=2c ¢°¿¤ «¨ ² ª ³¦ ±³¹¥±²¢¥­­ . ®¦­®
¯°¥¤¯®«®¦¨²¼, ·²® ®¶¥­ª  T (n) = O(n lg n) ®±² ¥²±¿ ¢ ±¨«¥,  
§ ²¥¬ ¨ ¤®ª § ²¼ ½²® ¯® ¨­¤³ª¶¨¨ (±¬. ³¯°. 4.1-5).
®±«¥¤®¢ ²¥«¼­»¥ ¯°¨¡«¨¦¥­¨¿. ®¦­® ­ · ²¼ ± ¯°®±²»µ ¨ £°³¡»µ ®¶¥­®ª,   § ²¥¬ ³²®·­¿²¼ ¨µ.  ¯°¨¬¥°, ¤«¿ ±®®²­®¸¥­¨¿ (4.1) ¥±²¼ ®·¥¢¨¤­ ¿ ­¨¦­¿¿ ®¶¥­ª  T (n) = 
(n) (¯®±ª®«¼ª³
±¯° ¢  ¥±²¼ ·«¥­ n), ¨ ¢¥°µ­¿¿ ®¶¥­ª  T (n) = O(n2) (ª®²®°³¾
«¥£ª® ¤®ª § ²¼ ¯® ¨­¤³ª¶¨¨).  «¥¥ ¬®¦­® ¯®±²¥¯¥­­® ±¡«¨¦ ²¼ ¨µ, ±²°¥¬¿±¼ ¯®«³·¨²¼  ±¨¬¯²®²¨·¥±ª¨ ²®·­»¥ ­¨¦­¾¾
¨ ¢¥°µ­¾¾ ®¶¥­ª¨, ®²«¨· ¾¹¨¥±¿ ­¥ ¡®«¥¥ ·¥¬ ¢ ª®­±² ­²³ ° §.
®­ª®±²¨
­®£¤  ° ±±³¦¤¥­¨¥ ¯® ¨­¤³ª¶¨¨ ±² «ª¨¢ ¥²±¿ ± ²°³¤­®±²¿¬¨,
µ®²¿ ®²¢¥² ³£ ¤ ­ ¯° ¢¨«¼­®. ¡»·­® ½²® ¯°®¨±µ®¤¨² ¯®²®¬³, ·²®
¤®ª §»¢ ¥¬®¥ ¯® ¨­¤³ª¶¨¨ ³²¢¥°¦¤¥­¨¥ ­¥¤®±² ²®·­® ±¨«¼­®. 
½²®¬ ±«³· ¥ ¬®¦¥² ¯®¬®·¼ ¢»·¨² ­¨¥ ·«¥­  ¬¥­¼¸¥£® ¯®°¿¤ª .
 ±±¬®²°¨¬ ±®®²­®¸¥­¨¥

T (n) = T (bn=2c) + T (dn=2e) + 1:
®¦­® ­ ¤¥¿²¼±¿, ·²® ¢ ½²®¬ ±«³· ¥ T (n) = O(n). ²® ¤¥©±²¢¨²¥«¼­® ² ª. ®¯°®¡³¥¬, ®¤­ ª®, ¤®ª § ²¼, ·²® T (n) 6 cn ¯°¨ ¯®¤µ®¤¿¹¥¬ ¢»¡®°¥ ª®­±² ­²» c. ­¤³ª²¨¢­®¥ ¯°¥¤¯®«®¦¥­¨¥ ¤ ¥²
T (n) 6 cbn=2c + cdn=2e + 1 = cn + 1;
  ®²±¾¤  ­¨ ¤«¿ ª ª®£® c ­¥ ¢»²¥ª ¥² ­¥° ¢¥­±²¢  T (n) 6 cn. 

² ª®© ±¨²³ ¶¨¨ ¬®¦­® ¯®¯»² ²¼±¿ ¤®ª § ²¼ ¡®«¥¥ ±« ¡³¾ ®¶¥­ª³,
­ ¯°¨¬¥° O(n2 ), ­® ­  ± ¬®¬ ¤¥«¥ ¢ ½²®¬ ­¥² ­¥®¡µ®¤¨¬®±²¨: ­ ¸ 

58

« ¢  4 ¥ª³°°¥­²­»¥ ±®®²­®¸¥­¨¿

¤®£ ¤ª  ¢¥°­ , ­ ¤® ²®«¼ª® ­¥ ®±« ¡¨²¼,   ³±¨«¨²¼ ¯°¥¤¯®«®¦¥­¨¥
¨­¤³ª¶¨¨.
®¢ ¿ £¨¯®²¥§  ¢»£«¿¤¨² ² ª: T (n) 6 cn ; b ¤«¿ ­¥ª®²®°»µ ª®­±² ­² b ¨ c. ®¤±² ­®¢ª  ¢ ¯° ¢³¾ · ±²¼ ¤ ¥²

T (n) 6 (cbn=2c ; b) + (cdn=2e ; b) + 1 = cn ; 2b + 1 6 cn ; b
®±«¥¤­¨© ¯¥°¥µ®¤ § ª®­¥­ ¯°¨ b > 1. ±² ¥²±¿ «¨¸¼ ¢»¡° ²¼ ª®­±² ­²³ c ± ³·¥²®¬ ­ · «¼­»µ ³±«®¢¨©.
²® ° ±±³¦¤¥­¨¥ ¢»§»¢ ¥² ­¥¤®³¬¥­¨¥: ¥±«¨ ¤®ª § ²¥«¼±²¢® ­¥
¯°®µ®¤¨², ­¥ ±«¥¤³¥² «¨ ®±« ¡¨²¼ (³¢¥«¨·¨²¼) ®¶¥­ª³,   ­¥ ³±¨«¨¢ ²¼ ¥¥? ® ­  ± ¬®¬ ¤¥«¥ ­¨·¥£® ±²° ­­®£® §¤¥±¼ ­¥² | ³±¨«¨¢
®¶¥­ª³, ¬» ¯®«³· ¥¬ ¢®§¬®¦­®±²¼ ¢®±¯®«¼§®¢ ²¼±¿ ¡®«¥¥ ±¨«¼­»¬
¨­¤³ª²¨¢­»¬ ¯°¥¤¯®«®¦¥­¨¥¬.
 ª ¤¥« ²¼ ­¥ ­ ¤®
±¨¬¯²®²¨·¥±ª ¿ § ¯¨±¼ ®¯ ±­  ¯°¨ ­¥³¬¥«®¬ ¯°¨¬¥­¥­¨¨: ¢®²
¯°¨¬¥° ­¥¯° ¢¨«¼­®£® À¤®ª § ²¥«¼±²¢ Á ®¶¥­ª¨ T (n) = O(n) ¤«¿
±®®²­®¸¥­¨¿ (4.4). °¥¤¯®«®¦¨¬, ·²® T (n) 6 cn, ²®£¤  ¬®¦­® § ¯¨± ²¼
T (n) 6 2(cbn=2c) + n 6 cn + n = O(n):
²® ° ±±³¦¤¥­¨¥, ®¤­ ª®, ­¨·¥£® ­¥ ¤®ª §»¢ ¥², ² ª ª ª ¨­¤³ª²¨¢­»© ¯¥°¥µ®¤ ²°¥¡³¥², ·²®¡» ¢ ¯° ¢®© · ±²¨ ¡»«® cn c ²®© ¦¥
± ¬®© ª®­±² ­²®© c,   ­¥  ¡±²° ª²­®¥ O(n).
 ¬¥­  ¯¥°¥¬¥­­»µ
 ±²® ­¥±«®¦­ ¿ § ¬¥­  ¯¥°¥¬¥­­»µ ¯®§¢®«¿¥² ¯°¥®¡° §®¢ ²¼
°¥ª³°°¥­²­®¥ ±®®²­®¸¥­¨¥ ª ¯°¨¢»·­®¬³ ¢¨¤³.  ¯°¨¬¥°, ±®®²­®¸¥­¨¥
p
T (n) = 2T (b nc) + ln n
ª ¦¥²±¿ ¤®¢®«¼­® ±«®¦­»¬, ®¤­ ª® § ¬¥­®© ¯¥°¥¬¥­­»µ ¥£® «¥£ª®
³¯°®±²¨²¼. ¤¥« ¢ § ¬¥­³ m = lg n, ¯®«³·¨¬

T (2m) = 2T (2m=2) + m:
¡®§­ ·¨¢ T (2m ) ·¥°¥§ S (m), ¯°¨µ®¤¨¬ ª ±®®²­®¸¥­¨¾
S (m) = 2S (m=2) + m;
ª®²®°®¥ ³¦¥ ¢±²°¥· «®±¼ (4.4). £® °¥¸¥­¨¥: S (m) = O(m lg m).
®§¢° ¹ ¿±¼ ª T (n) ¢¬¥±²® S (m), ¯®«³·¨¬
T (n) = T (2m ) = S (m) = O(m lg m) = O(lg n lg lg n):

°¥®¡° §®¢ ­¨¥ ¢ ±³¬¬³

59

°¨¢¥¤¥­­®¥ ° ±±³¦¤¥­¨¥ ²°¥¡³¥², ª®­¥·­®, ³²®·­¥­¨©, ¯®±ª®«¼ª³ ¯®ª  ·²® ¬» ¤®ª § «¨ ®¶¥­ª³ ­  T (n) «¨¸¼ ¤«¿ n, ¿¢«¿¾¹¨µ±¿
±²¥¯¥­¿¬¨ ¤¢®©ª¨. ²®¡» ¢»©²¨ ¨§ ¯®«®¦¥­¨¿, ¬®¦­® ®¯°¥¤¥«¨²¼
S (m) ª ª ¬ ª±¨¬³¬ T (n) ¯® ¢±¥¬ n, ­¥ ¯°¥¢®±µ®¤¿¹¨¬ 2m.
¯° ¦­¥­¨¿
4.1-1 ®ª ¦¨²¥, ·²® ¨§ T (n) = T (dn=2e) + 1 ±«¥¤³¥², ·²® T (n) =
O(lg n).
4.1-2 ®ª ¦¨²¥, ·²® ¨§ T (n) = 2T (bn=2c) + n ¢»²¥ª ¥² T (n) =

(n lg n), ¨ ²¥¬ ± ¬»¬ T (n) = (n lg n).
4.1-3  ª ®¡®©²¨ ²°³¤­®±²¼ ± ­ · «¼­»¬ §­ ·¥­¨¥¬ n = 1 ¯°¨
¨±±«¥¤®¢ ­¨¨ ±®®²­®¸¥­¨¿ (4.4), ¨§¬¥­¨¢ ¤®ª §»¢ ¥¬®¥ ¯® ¨­¤³ª¶¨¨ ³²¢¥°¦¤¥­¨¥, ­® ­¥ ¬¥­¿¿ ­ · «¼­®£® §­ ·¥­¨¿?
4.1-4 ®ª ¦¨²¥, ·²® ±®®²­®¸¥­¨¥ (4.2) ¤«¿ ±®°²¨°®¢ª¨ ±«¨¿­¨¥¬
¨¬¥¥² °¥¸¥­¨¥¬ (n lg n).
4.1-5 ®ª ¦¨²¥, ·²® T (n) = 2T (bn=2c + 17) + n ¢«¥·¥² T (n) =
O(n lg n).
4.1-6 ¥¸¨²¥
± ¯®¬®¹¼¾ § ¬¥­» ¯¥°¥¬¥­­»µ ±®®²­®¸¥­¨¥
p
T (n) = 2T ( n) + 1, (®¯³±ª ¿ ¯®¤°®¡­®±²¨, ±¢¿§ ­­»¥ ± ²¥¬, ·²®
§­ ·¥­¨¿ ¯¥°¥¬¥­­»µ | ­¥ ¶¥«»¥).

4.2. °¥®¡° §®¢ ­¨¥ ¢ ±³¬¬³
 ª ¡»²¼, ¥±«¨ ­¥ ³¤ ¥²±¿ ³£ ¤ ²¼ °¥¸¥­¨¥? ®£¤  ¬®¦­®, ¨²¥°¨°³¿ ½²® ±®®²­®¸¥­¨¥ (¯®¤±² ¢«¿¿ ¥£® ± ¬® ¢ ±¥¡¿), ¯®«³·¨²¼ °¿¤,
ª®²®°»© ¬®¦­® ®¶¥­¨¢ ²¼ ²¥¬ ¨«¨ ¨­»¬ ±¯®±®¡®¬.
«¿ ¯°¨¬¥°  ° ±±¬®²°¨¬ ±®®²­®¸¥­¨¥
T (n) = 3T (bn=4c) + n:
®¤±² ¢«¿¿ ¥£® ¢ ±¥¡¿, ¯®«³·¨¬:
T (n) = n + 3T (bn=4c) = n + 3(bn=4c + 3T (bn=16c))
= n + 3(bn=4c + 3(bn=16c + 3T (bn=64c)))
= n + 3bn=4c + 9bn=16c + 27T (bn=64c);
» ¢®±¯®«¼§®¢ «¨±¼ ²¥¬, ·²®, ±®£« ±­® (2.4), bbn=4c=4c = bn=16c
¨ bbn=16c=4c = bn=64c. ª®«¼ª® ¸ £®¢ ­ ¤® ±¤¥« ²¼, ·²®¡» ¤®©²¨
¤® ­ · «¼­®£® ³±«®¢¨¿? ®±ª®«¼ª³ ¯®±«¥ i-®© ¨²¥° ¶¨¨ ±¯° ¢  ®ª ¦¥²±¿ T (bn=4ic), ¬» ¤®©¤¥¬ ¤® T (1), ª®£¤  bn=4i c = 1, ². ¥. ª®£¤ 

60

« ¢  4 ¥ª³°°¥­²­»¥ ±®®²­®¸¥­¨¿

i > log4 n.  ¬¥²¨¢, ·²® bn=4ic 6 n=4i , ¬» ¬®¦¥¬ ®¶¥­¨²¼ ­ ¸ °¿¤

³¡»¢ ¾¹¥© £¥®¬¥²°¨·¥±ª®© ¯°®£°¥±±¨¥© (¯«¾± ¯®±«¥¤­¨© ·«¥­, ±®®²¢¥²±²¢³¾¹¨© 3log n § ¤ · ¬ ®£° ­¨·¥­­®£® ° §¬¥° ):
T (n) 6 n + 3n=4 + 9n=16 + 27n=64 + : : : + 3log n (1)
1  3 i
X
+ (nlog 3 )
6n
4
i=0
= 4n + o(n) = O(n)
(» § ¬¥­¨«¨ ª®­¥·­³¾ ±³¬¬³ ¨§ ­¥ ¡®«¥¥ ·¥¬ log4 n + 1 ·«¥­®¢
­  ±³¬¬³ ¡¥±ª®­¥·­®£® °¿¤ ,   ² ª¦¥ ¯¥°¥¯¨± «¨ 3log n ª ª nlog 3 ,
·²® ¥±²¼ o(n), ² ª ª ª log4 3 < 1.)
 ±²® ¯°¥®¡° §®¢ ­¨¥ °¥ª³°°¥­²­®£® ±®®²­®¸¥­¨¿ ¢ ±³¬¬³ ¯°¨¢®¤¨² ª ¤®¢®«¼­® ±«®¦­»¬ ¢»ª« ¤ª ¬. °¨ ½²®¬ ¢ ¦­® ±«¥¤¨²¼
§  ¤¢³¬¿ ¢¥¹ ¬¨: ±ª®«¼ª® ¸ £®¢ ¯®¤±² ­®¢ª¨ ²°¥¡³¥²±¿ ¨ ª ª®¢ 
±³¬¬  ·«¥­®¢, ¯®«³· ¾¹¨µ±¿ ­  ¤ ­­®¬ ¸ £¥. ­®£¤  ­¥±ª®«¼ª®
¯¥°¢»µ ¸ £®¢ ¯®§¢®«¿¾² ®²£ ¤ ²¼ ®²¢¥², ª®²®°»© § ²¥¬ ³¤ ¥²±¿
¤®ª § ²¼ ¯® ¨­¤³ª¶¨¨ (± ¬¥­¼¸¨¬ ª®«¨·¥±²¢®¬ ¢»·¨±«¥­¨©).
±®¡¥­­® ¬­®£® µ«®¯®² ¤®±² ¢«¿¾² ®ª°³£«¥­¨¿ (¯¥°¥µ®¤ ª ¶¥«®© · ±²¨). «¿ ­ · «  ±²®¨² ¯°¥¤¯®«®¦¨²¼, ·²® §­ ·¥­¨¿ ¯ ° ¬¥²°  ² ª®¢», ·²® ®ª°³£«¥­¨¿ ­¥ ²°¥¡³¾²±¿ (¢ ­ ¸¥¬ ¯°¨¬¥°¥ ¯°¨
n = 4k ­¨·¥£® ®ª°³£«¿²¼ ­¥ ¯°¨¤¥²±¿). ®®¡¹¥ £®¢®°¿, ² ª®¥ ¯°¥¤¯®«®¦¥­¨¥ ­¥ ¢¯®«­¥ § ª®­­®, ² ª ª ª ®¶¥­ª³ ­ ¤® ¤®ª § ²¼ ¤«¿
¢±¥µ ¤®±² ²®·­® ¡®«¼¸¨µ ¶¥«»µ ·¨±¥«,   ­¥ ²®«¼ª® ¤«¿ ±²¥¯¥­¥©
·¥²¢¥°ª¨. » ³¢¨¤¨¬ ¢ ° §¤¥«¥ 4.3, ª ª ¬®¦­® ®¡®©²¨ ½²³ ²°³¤­®±²¼ (±¬. ² ª¦¥ § ¤ ·³ 4-5).
4

4

4

4

4

¥°¥¢¼¿ °¥ª³°±¨¨
°®¶¥±± ¯®¤±² ­®¢ª¨ ±®®²­®¸¥­¨¿ ¢ ±¥¡¿ ¬®¦­® ¨§®¡° §¨²¼ ¢
¢¨¤¥ ¤¥°¥¢  °¥ª³°±¨¨ (recursion tree).  ª ½²® ¤¥« ¥²±¿, ¯®ª § ­®
­  °¨±. 4.1 ­  ¯°¨¬¥°¥ ±®®²­®¸¥­¨¿
T (n) = 2T (n=2) + n2 :
«¿ ³¤®¡±²¢  ¯°¥¤¯®«®¦¨¬, ·²® n | ±²¥¯¥­¼ ¤¢®©ª¨. ¢¨£ ¿±¼ ®²
( ) ª (£), ¬» ¯®±²¥¯¥­­® ° §¢®° ·¨¢ ¥¬ ¢»° ¦¥­¨¥ ¤«¿ T (n), ¨±¯®«¼§³¿ ¢»° ¦¥­¨¿ ¤«¿ T (n), T (n=2), T (n=4) ¨ ². ¤. ¥¯¥°¼ ¬» ¬®¦¥¬ ¢»·¨±«¨²¼ T (n), ±ª« ¤»¢ ¿ §­ ·¥­¨¿ ¢¥°¸¨­ ­  ª ¦¤®¬ ³°®¢­¥.   ¢¥°µ­¥¬ ³°®¢­¥ ¯®«³· ¥¬ n2 , ­  ¢²®°®¬ | (n=2)2 + (n=2)2 =
n2=2, ­  ²°¥²¼¥¬ | (n=4)2 + (n=4)2 + (n=4)2 + (n=4)2 = n2=4. ®«³· ¥²±¿ ³¡»¢ ¾¹ ¿ £¥®¬¥²°¨·¥±ª ¿ ¯°®£°¥±±¨¿, ±³¬¬  ª®²®°®©
®²«¨· ¥²±¿ ®² ¥¥ ¯¥°¢®£® ·«¥­  ­¥ ¡®«¥¥ ·¥¬ ­  ¯®±²®¿­­»© ¬­®¦¨²¥«¼. ² ª, T (n) = (n2 ).
  °¨±. 4.2 ¯®ª § ­ ¡®«¥¥ ±«®¦­»© ¯°¨¬¥° | ¤¥°¥¢® ¤«¿ ±®®²­®¸¥­¨¿
T (n) = T (n=3) + T (2n=3) + n

°¥®¡° §®¢ ­¨¥ ¢ ±³¬¬³

61

Total=¢±¥£®

2
¨±. 4.1 ¥°¥¢® °¥ª³°±¨¨ ¤«¿ ±®®²­®¸¥­¨¿ T (n) = 2T (n=2) + n . »±®²  ¯®«­®±²¼¾ ° §¢¥°­³²®£® ¤¥°¥¢  (£) ° ¢­  lg n (¤¥°¥¢® ¨¬¥¥² lg n + 1 ³°®¢­¥©).

¨±. 4.2

¥°¥¢® °¥ª³°±¨¨ ¤«¿ ±®®²­®¸¥­¨¿ T (n) = T (n=3) + T (2n=3) + n.

62

« ¢  4 ¥ª³°°¥­²­»¥ ±®®²­®¸¥­¨¿

(¤«¿ ¯°®±²®²» ¬» ¢­®¢¼ ¨£­®°¨°³¥¬ ®ª°³£«¥­¨¿). ¤¥±¼ ±³¬¬ 
§­ ·¥­¨© ­  ª ¦¤®¬ ³°®¢­¥ ° ¢­  n. ¥°¥¢® ®¡°»¢ ¥²±¿, ª®£¤ 
§­ ·¥­¨¿  °£³¬¥­²  ±² ­®¢¿²±¿ ±° ¢­¨¬»¬¨ ± 1. «¿ ° §­»µ ¢¥²¢¥© ½²® ¯°®¨±µ®¤¨² ­  ° §­®© £«³¡¨­¥, ¨ ± ¬»© ¤«¨­­»© ¯³²¼
n ! (2=3)n ! (2=3)2n !    ! 1 ²°¥¡³¥² ®ª®«® k = log3=2 n ¸ £®¢
(¯°¨ ² ª®¬ k ¬» ¨¬¥¥¬ (2=3)kn = 1). ®½²®¬³ T (n) ¬®¦­® ®¶¥­¨²¼
ª ª O(n lg n).
¯° ¦­¥­¨¿
4.2-1 ²¥°¨°³¿ (¯®¤±² ¢«¿¿ ¢ ±¥¡¿) ±®®²­®¸¥­¨¥ T (n) =
3T (bn=2c) + n, ­ ©¤¨²¥ µ®°®¸³¾ ¢¥°µ­¾¾  ±¨¬¯²®²¨·¥±ª³¾
®¶¥­ª³ ¤«¿ T (n).
4.2-2 ­ «¨§¨°³¿ ¤¥°¥¢® °¥ª³°±¨¨, ¯®ª ¦¨²¥, ·²® T (n) =
T (n=3) + T (2n=3) + n ¢«¥·¥² T (n) = 
(n lg n).
4.2-3  °¨±³©²¥ ¤¥°¥¢® °¥ª³°±¨¨ ¤«¿ T (n) = 4T (bn=2c) + n ¨
¯®«³·¨²¥  ±¨¬¯²®²¨·¥±ª¨ ²®·­»¥ ®¶¥­ª¨ ¤«¿ T (n).
4.2-4  ¯®¬®¹¼¾ ¨²¥° ¶¨© °¥¸¨²¥ ±®®²­®¸¥­¨¥ T (n) = T (n ;
a) + T (a) + n, £¤¥ a > 1 | ­¥ª®²®° ¿ ª®­±² ­² .
4.2-5  ¯®¬®¹¼¾ ¤¥°¥¢  °¥ª³°±¨¨ °¥¸¨²¥ ±®®²­®¸¥­¨¥ T (n) =
T (n) + T ((1 ; )n) + n, £¤¥  | ª®­±² ­²  ¢ ¨­²¥°¢ «¥ 0 <  < 1.

4.3. ¡¹¨© °¥¶¥¯²
²®² ¬¥²®¤ £®¤¨²±¿ ¤«¿ °¥ª³°°¥­²­»µ ±®®²­®¸¥­¨© ¢¨¤ 

T (n) = aT (n=b) + f (n);

(4.5)

£¤¥ a > 1 ¨ b > 1 | ­¥ª®²®°»¥ ª®­±² ­²»,   f | ¯®«®¦¨²¥«¼­ ¿
(¯® ª° ©­¥© ¬¥°¥ ¤«¿ ¡®«¼¸¨µ §­ ·¥­¨©  °£³¬¥­² ) ´³­ª¶¨¿. ­
¤ ¥² ®¡¹³¾ ´®°¬³«³; § ¯®¬­¨¢ ¥¥, ¬®¦­® °¥¸ ²¼ ¢ ³¬¥ ° §«¨·­»¥
°¥ª³°°¥­²­»¥ ±®®²­®¸¥­¨¿.
®®²­®¸¥­¨¥ (4.5) ¢®§­¨ª ¥², ¥±«¨  «£®°¨²¬ ° §¡¨¢ ¥² § ¤ ·³
° §¬¥°  n ­  a ¯®¤§ ¤ · ° §¬¥°  n=b, ½²¨ ¯®¤§ ¤ ·¨ °¥¸ ¾²±¿
°¥ª³°±¨¢­® (ª ¦¤ ¿ §  ¢°¥¬¿ T (n=b)) ¨ °¥§³«¼² ²» ®¡º¥¤¨­¿¾²±¿. °¨ ½²®¬ § ²° ²» ­  ° §¡¨¥­¨¥ ¨ ®¡º¥¤¨­¥­¨¥ ®¯¨±»¢ ¾²±¿
´³­ª¶¨¥© f (n) (¢ ®¡®§­ ·¥­¨¿µ ° §¤¥«  1.3.2 f (n) = C (n) + D(n)).
 ¯°¨¬¥°, ¤«¿ ¯°®¶¥¤³°» Merge-Sort ¬» ¨¬¥¥¬ a = 2, b = 2,
f (n) = (n).
 ª ¢±¥£¤ , ¢ ´®°¬³«¥ (4.5) ¢®§­¨ª ¥² ¯°®¡«¥¬  ± ®ª°³£«¥­¨¥¬: n=b ¬®¦¥² ­¥ ¡»²¼ ¶¥«»¬. ®°¬ «¼­® ±«¥¤®¢ «® ¡» § ¬¥­¨²¼

¡¹¨© °¥¶¥¯²

63

T (n=b) ­  T (bn=bc) ¨«¨ T (dn=be). ¡  ¢ °¨ ­² , ª ª ¬» ³¢¨¤¨¬ ¢

±«¥¤³¾¹¥¬ ° §¤¥«¥, ¯°¨¢®¤¿² ª ®¤­®¬³ ¨ ²®¬³ ¦¥ ®²¢¥²³, ¨ ¤«¿
¯°®±²®²» ¬» ¡³¤¥¬ ®¯³±ª ²¼ ®ª°³£«¥­¨¥ ¢ ­ ¸¨µ ´®°¬³« µ.
±­®¢­ ¿ ²¥®°¥¬  ® °¥ª³°°¥­²­»µ ®¶¥­ª µ
¥®°¥¬  4.1. ³±²¼ a > 1 ¨ b > 1 | ª®­±² ­²», f (n) | ´³­ª¶¨¿,
T (n) ®¯°¥¤¥«¥­® ¯°¨ ­¥®²°¨¶ ²¥«¼­»µ n ´®°¬³«®©
T (n) = aT (n=b) + f (n);
£¤¥ ¯®¤ n=b ¯®­¨¬ ¥²±¿ «¨¡® dn=be, «¨¡® bn=bc. ®£¤ :
1. ±«¨ f (n) = O(nlogb a;" ) ¤«¿ ­¥ª®²®°®£® " > 0, ²® T (n) =
(nlogb a ).
2. ±«¨ f (n) = (nlogb a ), ²® T (n) = (nlogb a lg n).
3. ±«¨ f (n) = 
(nlogb a+" ) ¤«¿ ­¥ª®²®°®£® " > 0 ¨ ¥±«¨ af (n=b) 6
cf (n) ¤«¿ ­¥ª®²®°®© ª®­±² ­²» c < 1 ¨ ¤®±² ²®·­® ¡®«¼¸¨µ n,
²® T (n) = (f (n)).

 ·¥¬ ±³²¼ ½²®© ²¥®°¥¬»?  ª ¦¤®¬ ¨§ ²°¥µ ±«³· ¥¢ ¬» ±° ¢­¨¢ ¥¬ f (n) ± nlogb a ; ¥±«¨ ®¤­  ¨§ ½²¨µ ´³­ª¶¨© ° ±²¥² ¡»±²°¥¥ ¤°³£®©, ²® ®­  ¨ ®¯°¥¤¥«¿¥² ¯®°¿¤®ª °®±²  T (n) (±«³· ¨ 1 ¨ 3). ±«¨
®¡¥ ´³­ª¶¨¨ ®¤­®£® ¯®°¿¤ª  (±«³· © 2), ²® ¯®¿¢«¿¥²±¿ ¤®¯®«­¨²¥«¼­»© «®£ °¨´¬¨·¥±ª¨© ¬­®¦¨²¥«¼ ¨ ®²¢¥²®¬ ±«³¦¨² ´®°¬³« 
(nlogb a lg n) = (f (n) lg n).
²¬¥²¨¬ ¢ ¦­»¥ ²¥µ­¨·¥±ª¨¥ ¤¥² «¨.  ¯¥°¢®¬ ±«³· ¥ ­¥¤®±² ²®·­®, ·²®¡» f (n) ¡»«  ¯°®±²® ¬¥­¼¸¥, ·¥¬ nlogb a : ­ ¬ ­³¦¥­ À§ §®°Á ° §¬¥°  n" ¤«¿ ­¥ª®²®°®£® " > 0. ®·­® ² ª ¦¥ ¢ ²°¥²¼¥¬
±«³· ¥ f (n) ¤®«¦­  ¡»²¼ ¡®«¼¸¥ nlogb a ± § ¯ ±®¬, ¨ ª ²®¬³ ¦¥
³¤®¢«¥²¢®°¿²¼ ³±«®¢¨¾ À°¥£³«¿°­®±²¨Á af (n=b) 6 cf (n); ¯°®¢¥°ª 
¯®±«¥¤­¥£® ³±«®¢¨¿, ª ª ¯° ¢¨«®, ­¥ ±®±² ¢«¿¥² ²°³¤ .
 ¬¥²¨¬, ·²® ²°¨ ³ª § ­­»µ ±«³· ¿ ­¥ ¨±·¥°¯»¢ ¾² ¢±¥µ ¢®§¬®¦­®±²¥©: ¬®¦¥² ®ª § ²¼±¿, ­ ¯°¨¬¥°, ·²® ´³­ª¶¨¿ f (n) ¬¥­¼¸¥,
·¥¬ nlogb a, ­® § §®° ­¥¤®±² ²®·­® ¢¥«¨ª ¤«¿ ²®£®, ·²®¡» ¢®±¯®«¼§®¢ ²¼±¿ ¯¥°¢»¬ ³²¢¥°¦¤¥­¨¥¬ ²¥®°¥¬». ­ «®£¨·­ ¿ À¹¥«¼Á ¥±²¼ ¨
¬¥¦¤³ ±«³· ¿¬¨ 2 ¨ 3.  ª®­¥¶, ´³­ª¶¨¿ ¬®¦¥² ­¥ ®¡« ¤ ²¼ ±¢®©±²¢®¬ °¥£³«¿°­®±²¨.
°¨¬¥­¥­¨¿ ®±­®¢­®© ²¥®°¥¬»
 ±±¬®²°¨¬ ­¥±ª®«¼ª® ¯°¨¬¥°®¢, £¤¥ ¯°¨¬¥­¥­¨¥ ²¥®°¥¬» ¯®§¢®«¿¥² ±° §³ ¦¥ ¢»¯¨± ²¼ ®²¢¥².
«¿ ­ · «  ° ±±¬®²°¨¬ ±®®²­®¸¥­¨¥
T (n) = 9T (n=3) + n:
 ½²®¬ ±«³· ¥ a = 9, b = 3, f (n) = n,   nlogb a = nlog 9 = (n2 ).
3

64

« ¢  4 ¥ª³°°¥­²­»¥ ±®®²­®¸¥­¨¿

®±ª®«¼ª³ f (n) = O(nlog 9;" ) ¤«¿ " = 1, ¬» ¯°¨¬¥­¿¥¬ ¯¥°¢®¥
³²¢¥°¦¤¥­¨¥ ²¥®°¥¬» ¨ § ª«¾· ¥¬, ·²® T (n) = (n2 ).
¥¯¥°¼ ° ±±¬®²°¨¬ ±®®²­®¸¥­¨¥
3

T (n) = T (2n=3) + 1:
¤¥±¼ a = 1, b = 3=2, f (n) = 1 ¨ nlogb a = nlog = 1 = n0 = 1. ®¤µ®¤¨²
±«³· © 2, ¯®±ª®«¼ª³ f (n) = (nlogb a ) = (1), ¨ ¬» ¯®«³· ¥¬, ·²®
T (n) = (lg n).
«¿ ±®®²­®¸¥­¨¿
3 2

T (n) = 3T (n=4) + n lg n
¬» ¨¬¥¥¬ a = 3, b = 4, f (n) = n lg n; ¯°¨ ½²®¬ nlogb a =
nlog 3 = O(n0;793).  §®° (± "  0;2) ¥±²¼, ®±² ¥²±¿ ¯°®¢¥°¨²¼ ³±«®¢¨¥ °¥£³«¿°­®±²¨. «¿ ¤®±² ²®·­® ¡®«¼¸®£® n ¨¬¥¥¬ af (n=b) =
3(n=4) lg(n=4) 6 (3=4)n lg n = cf (n) ¤«¿ c = 3=4. ¥¬ ± ¬»¬ ¯®
²°¥²¼¥¬³ ³²¢¥°¦¤¥­¨¾ ²¥®°¥¬» T (n) = (n lg n).
®² ¯°¨¬¥°, ª®£¤  ²¥®°¥¬³ ¯°¨¬¥­¨²¼ ­¥ ³¤ ¥²±¿: ¯³±²¼ T (n) =
2T (n=2) + n lg n. ¤¥±¼ a = 2, b = 2, f (n) = n lg n, nlogb a = n. ¨¤­®,
·²® f (n) = n lg n  ±¨¬¯²®²¨·¥±ª¨ ¡®«¼¸¥, ·¥¬ nlogb a , ­® § §®° ­¥¤®±² ²®·¥­: ®²­®¸¥­¨¥ f (n)=nlogb a = (n lg n)=n = lg n ­¥ ®¶¥­¨¢ ¥²±¿
±­¨§³ ¢¥«¨·¨­®© n" ­¨ ¤«¿ ª ª®£® " > 0. ²® ±®®²­®¸¥­¨¥ ¯®¯ ¤ 4

¥² ¢ ¯°®¬¥¦³²®ª ¬¥¦¤³ ±«³· ¿¬¨ 2 ¨ 3; ¤«¿ ­¥£® ¬®¦­® ¯®«³·¨²¼
®²¢¥² ¯® ´®°¬³«¥ ¨§ ³¯°. 4.4-2.
¯° ¦­¥­¨¿

4.3-1 ±¯®«¼§³¿ ®±­®¢­³¾ ²¥®°¥¬³, ­ ©¤¨²¥  ±¨¬¯²®²¨·¥±ª¨
²®·­»¥ ®¶¥­ª¨ ¤«¿ ±®®²­®¸¥­¨¿
 . T (n) = 4T (n=2) + n;
¡. T (n) = 4T (n=2) + n2 ;
¢. T (n) = 4T (n=2) + n3 .
4.3-2 °¥¬¿ ° ¡®²»  «£®°¨²¬  A ®¯¨±»¢ ¥²±¿ ±®®²­®¸¥­¨¥¬
T (n) = 7T (n=2) + n2,   ¢°¥¬¿ ° ¡®²»  «£®°¨²¬  A0 | ±®®²­®¸¥­¨¥¬ T 0 (n) = aT 0 (n=4) + n2 . °¨ ª ª®¬ ­ ¨¡®«¼¸¥¬ ¶¥«®¬ §­ ·¥­¨¨ a
 «£®°¨²¬ A0  ±¨¬¯²®²¨·¥±ª¨ ¡»±²°¥¥, ·¥¬ A?
4.3-3 ±¯®«¼§³¿ ®±­®¢­³¾ ²¥®°¥¬³, ¯®ª ¦¨²¥, ·²® ±®®²­®¸¥­¨¥
T (n) = T (n=2) + (1) (¤«¿ ¤¢®¨·­®£® ¯®¨±ª , ±¬. ³¯°. 1.3-5) ¢«¥·¥²
T (n) = (lg n).
4.3-4 ®ª ¦¨²¥, ·²® ³±«®¢¨¿ °¥£³«¿°­®±²¨ (±«³· © 3) ­¥ ¢»²¥ª ¥² ¨§ ¤°³£¨µ ³±«®¢¨©: ¯°¨¢¥¤¨²¥ ¯°¨¬¥° ´³­ª¶¨¨ f , ¤«¿ ª®²®°®©
±³¹¥±²¢³¥² ²°¥¡³¥¬ ¿ ª®­±² ­²  ", ­® ³±«®¢¨¥ °¥£³«¿°­®±²¨ ­¥ ¢»¯®«­¥­®.

4.4 ®ª § ²¥«¼±²¢® ¥®°¥¬» 4.1

65

? 4.4 ®ª § ²¥«¼±²¢® ¥®°¥¬» 4.1
» ¯°¨¢¥¤¥¬ ¤®ª § ²¥«¼±²¢® ²¥®°¥¬» 4.1 ¤«¿ ¤®²®¸­»µ ·¨² ²¥«¥©; ¢ ¤ «¼­¥©¸¥¬ ®­® ­¥ ¯®­ ¤®¡¨²±¿, ² ª ·²® ¯°¨ ¯¥°¢®¬ ·²¥­¨¨
¥£® ¢¯®«­¥ ¬®¦­® ¯°®¯³±²¨²¼.
®ª § ²¥«¼±²¢® ±®±²®¨² ¨§ ¤¢³µ · ±²¥©. ­ · «  ¬» ° ±±¬ ²°¨¢ ¥¬ ²®«¼ª® ²¥ n, ª®²®°»¥ ¿¢«¿¾²±¿ ±²¥¯¥­¿¬¨ ·¨±«  b; ¢±¥ ®±­®¢­»¥ ¨¤¥¨ ¢¨¤­» ³¦¥ ¤«¿ ½²®£® ±«³· ¿.  ²¥¬ ¯®«³·¥­­»© °¥§³«¼² ² ° ±¯°®±²° ­¿¥²±¿ ­  ¢±¥ ­ ²³° «¼­»¥ ·¨±« , ¯°¨ ½²®¬ ¬»  ªª³° ²­® ±«¥¤¨¬ §  ®ª°³£«¥­¨¿¬¨ ¨ ². ¯.
 ½²®¬ ° §¤¥«¥ ¬» ¯®§¢®«¨¬ ±¥¡¥ ­¥ ±®¢±¥¬ ª®°°¥ª²­® ®¡° ¹ ²¼±¿ ±  ±¨¬¯²®²¨·¥±ª®© § ¯¨±¼¾: ¡³¤¥¬ ¨±¯®«¼§®¢ ²¼ ¥¥ ¤«¿ ´³­ª¶¨©, ®¯°¥¤¥«¥­­»µ ²®«¼ª® ­  ±²¥¯¥­¿µ ·¨±«  b, µ®²¿ ®¯°¥¤¥«¥­¨¥
²°¥¡³¥², ·²®¡» ®¶¥­ª¨ ¤®ª §»¢ «¨±¼ ¤«¿ ¢±¥µ ¤®±² ²®·­® ¡®«¼¸¨µ
­ ²³° «¼­»µ ·¨±¥«.
§ ª®­²¥ª±²  ¡³¤¥² ¯®­¿²­®, ·²® ¨¬¥¥²±¿ ¢ ¢¨¤³, ­® ­³¦­® ¡»²¼
¢­¨¬ ²¥«¼­»¬, ·²®¡» ­¥ § ¯³² ²¼±¿: ¥±«¨ ® ´³­ª¶¨¨ T (n) ­¨·¥£®
­¥ ¨§¢¥±²­®, ²® ®¶¥­ª  T (n) = O(n) ¤«¿ n, ¿¢«¿¾¹¨µ±¿ ±²¥¯¥­¿¬¨
¤¢®©ª¨, ­¨·¥£® ­¥ £ ° ­²¨°³¥² ¤«¿ ¯°®¨§¢®«¼­»µ n. (®§¬®¦­®,
·²® T (n) = n ¯°¨ n = 1; 2; 4; 8; : : : ¨ T (n) = n2 ¯°¨ ®±² «¼­»µ n.)
4.4.1. «³· © ­ ²³° «¼­»µ ±²¥¯¥­¥©
³±²¼ T (n) ®¯°¥¤¥«¥­® ¤«¿ ·¨±¥«, ¿¢«¿¾¹¨µ±¿ (­ ²³° «¼­»¬¨)
±²¥¯¥­¿¬¨ ·¨±«  b > 1 (­¥ ®¡¿§ ²¥«¼­® ¶¥«®£®) ¨ ³¤®¢«¥²¢®°¿¥²
±®®²­®¸¥­¨¾ (4.5), ². ¥.

T (n) = aT (n=b) + f (n):
» ¯®«³·¨¬ ®¶¥­ª³ ¤«¿ T ² ª: ¯¥°¥©¤¥¬ ®² ½²®£® ±®®²­®¸¥­¨¿ ª

±³¬¬¨°®¢ ­¨¾ («¥¬¬  4.2), § ²¥¬ ®¶¥­¨¬ ¯®«³·¥­­³¾ ±³¬¬³ («¥¬¬  4.3) ¨ ¯®¤¢¥¤¥¬ ¨²®£¨ («¥¬¬  4.4).
¥¬¬  4.2. ³±²¼ a > 1, b > 1 | ª®­±² ­²», ¨ ¯³±²¼ f (n) |
­¥®²°¨¶ ²¥«¼­ ¿ ´³­ª¶¨¿, ®¯°¥¤¥«¥­­ ¿ ­  ±²¥¯¥­¿µ b. ³±²¼
T (n) | ´³­ª¶¨¿, ®¯°¥¤¥«¥­­ ¿ ­  ±²¥¯¥­¿µ b ±®®²­®¸¥­¨¥¬
T (n) = aT (n=b) + f (n) ¯°¨ n > 1, ¯°¨·¥¬ T (1) > 0. ®£¤ 

T (n) = (nlogb a ) +

logX
b n;1

j =0

aj f (n=bj ):

(4.6)

66

« ¢  4 ¥ª³°°¥­²­»¥ ±®®²­®¸¥­¨¿

¥°¥¢® °¥ª³°±¨¨ ¤«¿ ±®®²­®¸¥­¨¿ T (n) = aT (n=b) + f (n) ¿¢«¿¥²±¿
¯®«­»¬ a-¨·­»¬ ¤¥°¥¢®¬ ¢»±®²» log b n ± nlogb a . ³¬¬  ¢¥±®¢ ¯® ³°®¢­¿¬ ¯®ª § ­  ±¯° ¢ ,   ®¡¹ ¿ ±³¬¬  ¤ ¥²±¿ ´®°¬³«®© (4.6).
¨±. 4.3

®ª § ²¥«¼±²¢®. ®±«¥¤®¢ ²¥«¼­® ¯®¤±² ¢«¿¿ ±®®²­®¸¥­¨¥ ± ¬®
¢ ±¥¡¿, ¯®«³· ¥¬

T (n) = f (n) + aT (n=b)
= f (n) + af (n=b) + a2T (n=b2)
= f (n) + af (n=b) + a2f (n=b2) + : : :
+ alogb n;1 f (n=blogb n;1 ) + alogb n T (1):
®±ª®«¼ª³ alogb n = nlogb a , ¯®±«¥¤­¨© ·«¥­ ¬®¦¥² ¡»²¼ § ¯¨± ­ ª ª
(nlogb a ). ±² ¢¸¨¥±¿ ·«¥­» ®¡° §³¾² ±³¬¬³, ´¨£³°¨°³¾¹³¾ ¢
³²¢¥°¦¤¥­¨¨ «¥¬¬».
¥°¥¢® °¥ª³°±¨¨
®ª § ²¥«¼±²¢® «¥¬¬» 4.2 ¬®¦­® ¯®¿±­¨²¼ ¢ ²¥°¬¨­ µ ¤¥°¥¢ 
°¥ª³°±¨¨ (°¨±. 4.3), ¥±«¨ ·¨±«® a ¶¥«®¥ (µ®²¿ ± ¬® ¤®ª § ²¥«¼±²¢®
½²®£® ­¥ ²°¥¡³¥²).  ª®°­¥ ±²®¨² ·¨±«® f (n), ¢ ª ¦¤®¬ ¨§ a ¥£® ¤¥²¥© ±²®¨² ·¨±«® f (n=b), ¢ ª ¦¤®¬ ¨§ a2 ¢­³ª®¢ ±²®¨² f (n=b2 ) ¨ ². ¤.
  ³°®¢­¥ j ¨¬¥¥²±¿ aj ¢¥°¸¨­; ¢¥± ª ¦¤®© | f (n=bj ). ¨±²¼¿ ­ µ®¤¿²±¿ ­  ° ±±²®¿­¨¨ logb n ®² ª®°­¿, ¨ ¨¬¥¾² ¯®«®¦¨²¥«¼­»© ¢¥±
T (1); ¢±¥£® ­  ¤¥°¥¢¥ alogb n = nlogb a «¨±²¼¥¢.

4.4 ®ª § ²¥«¼±²¢® ¥®°¥¬» 4.1

67

 ¢¥­±²¢® (4.6) ¯®«³· ¥²±¿, ¥±«¨ ±«®¦¨²¼ ¢¥±  ­  ¢±¥µ ³°®¢­¿µ:
®¡¹¨© ¢¥± ­  j -¬ ³°®¢­¥ ¥±²¼ aj f (n=bj ),   ®¡¹¨© ¢¥± ¢­³²°¥­­¥©
· ±²¨ ¤¥°¥¢  ¥±²¼
logX
b n;1

j =0

aj f (n=bj ):

±«¨ °¥ª³°°¥­²­®¥ ±®®²­®¸¥­¨¥ ¯°®¨§®¸«® ¨§  «£®°¨²¬  ²¨¯ 
À° §¤¥«¿© ¨ ¢« ±²¢³©Á, ½²  ±³¬¬  ®²° ¦ ¥² ±²®¨¬®±²¼ ° §¡¨¥­¨¿
§ ¤ ·¨ ­  ¯®¤§ ¤ ·¨ ¨ ®¡º¥¤¨­¥­¨¿ °¥¸¥­¨©. ³¬¬ °­»© ¢¥± ¢±¥µ
«¨±²¼¥¢ ¥±²¼ ±²®¨¬®±²¼ °¥¸¥­¨¿ ¢±¥µ nlogb a § ¤ · ° §¬¥°  1, ª®²®° ¿ ±®±² ¢«¿¥² (nlogb a).
 ²¥°¬¨­ µ ¤¥°¥¢  °¥ª³°±¨¨ «¥£ª® ®¡º¿±­¨²¼, ·¥¬³ ±®®²¢¥²±²¢³¾² ²°¨ ±«³· ¿ ¢ ´®°¬³«¨°®¢ª¥ ®±­®¢­®© ²¥®°¥¬».  ¯¥°¢®¬ ±«³· ¥
®±­®¢­ ¿ · ±²¼ ¢¥±  ±®±°¥¤®²®·¥­  ¢ «¨±²¼¿µ, ¢ ²°¥²¼¥¬ | ¢ ª®°­¥,
¢® ¢²®°®¬ ¢¥± ° ¢­®¬¥°­® ° ±¯°¥¤¥«¥­ ¯® ³°®¢­¿¬ ¤¥°¥¢ .
¥¯¥°¼ ®¶¥­¨¬ ¢¥«¨·¨­³ ±³¬¬» ¢ ´®°¬³«¥ (4.6).
¥¬¬  4.3. ³±²¼ a > 1, b > 1 | ª®­±² ­²», f (n) | ­¥®²°¨¶ ²¥«¼­ ¿ ´³­ª¶¨¿, ®¯°¥¤¥«¥­­ ¿ ­  ­ ²³° «¼­»µ ±²¥¯¥­¿µ b.  ±±¬®²°¨¬ ´³­ª¶¨¾ g (n), ®¯°¥¤¥«¥­­³¾ ´®°¬³«®©

g (n) =

logX
b n;1

j =0

aj f (n=bj )

(4.7)

(¤«¿ n, ¿¢«¿¾¹¨µ±¿ ±²¥¯¥­¿¬¨ b). ®£¤ 
1. ±«¨ f (n) = O(nlogb a;" ) ¤«¿ ­¥ª®²®°®© ª®­±² ­²» " > 0, ²®
g(n) = O(nlogb a).
2. ±«¨ f (n) = (nlogb a ), ²® g (n) = (nlogb a lg n).
3. ±«¨ af (n=b) 6 cf (n) ¤«¿ ­¥ª®²®°®© ª®­±² ­²» c < 1 ¨ ¤«¿
¢±¥µ n > b, ²® g (n) = (f (n)).
®ª § ²¥«¼±²¢®. 1.  ¯¥°¢®¬ ±«³· ¥ ¤®±² ²®·­® ¤®ª § ²¼ ³²¢¥°¦¤¥­¨¥ «¥¬¬» ¤«¿ ´³­ª¶¨¨ f (n) = n , £¤¥  = logb a ; " «¿ ² ª®©
´³­ª¶¨¨ f ° ¢¥­±²¢® (4.7) ¬®¦¥² ¡»²¼ ¯¥°¥¯¨± ­® ² ª: (²¥¯¥°¼
 = logb a)

g (n) = f (n) + af (n=b) + a2f (n=b2) + : : : + ak;1f (n=bk;1)
= n + a(n=b) + a2 (n=b2) + : : : + ak;1 (n=bk;1) ; (4.8)

¯° ¢ ¿ · ±²¼ ¯°¥¤±² ¢«¿¥² ±®¡®© £¥®¬¥²°¨·¥±ª³¾ ¯°®£°¥±±¨¾ ¤«¨­» k = logb n ±® §­ ¬¥­ ²¥«¥¬ a=b; ½²®² §­ ¬¥­ ²¥«¼ ¡®«¼¸¥ 1, ² ª
ª ª  < logb a ¨ b < a. «¿ ² ª®© ¯°®£°¥±¨¨ ±³¬¬  ¯® ¯®°¿¤ª³ ° ¢­  ¯®±«¥¤­¥¬³ ·«¥­³ (®²«¨· ¥²±¿ ®² ­¥£® ­¥ ¡®«¥¥ ·¥¬ ­  ª®­±² ­²³
° §). ²®² ¯®±«¥¤­¨© ·«¥­ ¥±²¼ O(ak ) = O(nlogb a).
«¿ ¯¥°¢®£® ±«³· ¿ ³²¢¥°¦¤¥­¨¥ «¥¬¬» ¤®ª § ­®.

68

« ¢  4 ¥ª³°°¥­²­»¥ ±®®²­®¸¥­¨¿

2. ® ¢²®°®¬ ±«³· ¥  ­ «®£¨·­®¥ ° ±±³¦¤¥­¨¥ ¤ ¥² ±³¬¬³ ²®£®
¦¥ ¢¨¤ :

g(n) = f (n) + af (n=b) + a2 f (n=b2) + : : :
= n + a(n=b) + a2 (n=b2) + : : : ;
(4.9)
­® ²¥¯¥°¼  = logb a ¨ ¯®²®¬³ §­ ¬¥­ ²¥«¼ £¥®¬¥²°¨·¥±ª®© ¯°®£°¥±±¨¨ ° ¢¥­ 1 ¨ ¢±¥ ¥¥ ·«¥­» ° ¢­». µ ·¨±«® ¥±²¼ logb n, ¨ ¯®²®¬³ ±³¬¬  ° ¢­ 

nlogb a logb n = (nlogb a lg n):
«³· © 2 ° §®¡° ­.
3.  ½²®¬ ±«³· ¥ ³±«®¢¨¥ °¥£³«¿°­®±²¨ ´³­ª¶¨¨ f £ ° ­²¨°³¥²,
·²® ¢ ­ ¸¥© ±³¬¬¥ ª ¦¤»© ±«¥¤³¾¹¨© ·«¥­ ­¥ ¯°¥¢®±µ®¤¨² ¯°¥¤»¤³¹¥£®, ³¬­®¦¥­­®£® ­  c < 1. ¥¬ ± ¬»¬ ¥¥ ¬®¦­® ®¶¥­¨²¼ ±¢¥°µ³
³¡»¢ ¾¹¥© £¥®¬¥²°¨·¥±ª®© ¯°®£°¥±±¨¥© ±® §­ ¬¥­ ²¥«¥¬ c, ¨ ±³¬¬  ² ª®© ¯°®£°¥±±¨¨ ­¥ ¡®«¥¥ ·¥¬ ¢ ª®­±² ­²³ (° ¢­³¾ 1=(1 ; c))
° § ¯°¥¢®±µ®¤¨² ¯¥°¢»© ·«¥­ (­® ¨ ­¥ ¬¥­¼¸¥ ¥£®, ² ª ª ª ¢±¥ ±« £ ¥¬»¥ ­¥®²°¨¶ ²¥«¼­»).  ª¨¬ ®¡° §®¬, g (n) = (f (n)) ¤«¿ n,
¿¢«¿¾¹¨µ±¿ ±²¥¯¥­¿¬¨ b. ®ª § ²¥«¼±²¢® «¥¬¬» § ¢¥°¸¥­®.
¥¯¥°¼ ¬» ¬®¦¥¬ ¤®ª § ²¼ ®±­®¢­³¾ ²¥®°¥¬³ ® °¥ª³°°¥­²­»µ
®¶¥­ª µ ¤«¿ ±«³· ¿, ª®£¤  n ¥±²¼ ­ ²³° «¼­ ¿ ±²¥¯¥­¼ b.
¥¬¬  4.4. ³±²¼ a > 1, b > 1 | ª®­±² ­²», ¨ ¯³±²¼ f (n) |
­¥®²°¨¶ ²¥«¼­ ¿ ´³­ª¶¨¿, ®¯°¥¤¥«¥­­ ¿ ­  ±²¥¯¥­¿µ b. ³±²¼
T (n) | ´³­ª¶¨¿, ®¯°¥¤¥«¥­­ ¿ ­  ±²¥¯¥­¿µ b ±®®²­®¸¥­¨¥¬
T (n) = aT (n=b) + f (n) ¯°¨ n > 1 ¨ T (1) > 0. ®£¤ :
1. ±«¨ f (n) = O(nlogb a;" ) ¤«¿ ­¥ª®²®°®£® " > 0, ²® T (n) =
(nlogb a ).
2. ±«¨ f (n) = (nlogb a ), ²® T (n) = (nlogb a ) lg n.
3. ±«¨ f (n) = 
(nlogb a+" ) ¤«¿ ­¥ª®²®°®£® " > 0 ¨ ¥±«¨ af (n=b) 6
cf (n) ¤«¿ ­¥ª®²®°®© ª®­±² ­²» c < 1 ¨ ¤«¿ ¤®±² ²®·­® ¡®«¼¸¨µ n, ²® T (n) = (f (n)).
???????  ª ³¡° ²¼ ²®·ª³ ¢ ª®­¶¥ ±«®¢  ®ª § ²¥«¼±²¢®?
®ª § ²¥«¼±²¢®. ±®±²®¨² ¢ ª®¬¡¨­ ¶¨¨ «¥¬¬ 4.2 ¨ 4.3.  ¯¥°¢®¬
±«³· ¥ ¯®«³· ¥¬

T (n) = (nlogb a ) + O(nlogb a ) = (nlogb a):
® ¢²®°®¬ ±«³· ¥ ¨¬¥¥¬

T (n) = (nlogb a ) + (nlogb a lg n) = (nlogb a lg n):

4.4 ®ª § ²¥«¼±²¢® ¥®°¥¬» 4.1

69

 ²°¥²¼¥¬ ±«³· ¥

T (n) = (nlogb a) + (f (n)) = (f (n)):
 ¬¥²¨¬, ·²® ¢ ¯®±«¥¤­¥¬ ±«³· ¥ ³±«®¢¨¥ Àf (n) = 
(nlogb a+" ) ¤«¿
­¥ª®²®°®£® " > 0Á ¬®¦­® ¡»«® ¡» ®¯³±²¨²¼, ² ª ª ª ®­® ¢»²¥ª ¥²

¨§ ³±«®¢¨¿ °¥£³«¿°­®±²¨ (±¬. ³¯°. 4.4-3).
¥¬¬  4.4 ¤®ª § ­ .

4.4.2. ¥«»¥ ¯°¨¡«¨¦¥­¨¿ ±¢¥°µ³ ¨ ±­¨§³
 ¬ ®±² «®±¼ ° §®¡° ²¼±¿ ¯®¤°®¡­® ± ¯°®¨§¢®«¼­»¬¨ n, ­¥ ¿¢«¿¾¹¨¬¨±¿ ±²¥¯¥­¿¬¨ ·¨±«  b.  ½²®¬ ±«³· ¥ n=b ¯®¤«¥¦¨² ®ª°³£«¥­¨¾ ¨ ±®®²­®¸¥­¨¥ ¨¬¥¥² ¢¨¤

T (n) = aT (dn=be) + f (n)

(4.10)

T (n) = aT (bn=bc) + f (n):

(4.11)

¨«¨
 ¤® ³¡¥¤¨²¼±¿, ·²® ®¶¥­ª  ®±² ¥²±¿ ¢ ±¨«¥ ¨ ¤«¿ ½²®£® ±«³· ¿.
®±¬®²°¨¬, ª ª¨¥ ¨§¬¥­¥­¨¿ ­ ¤® ¢­¥±²¨ ¢ ­ ¸¨ ° ±±³¦¤¥­¨¿.
¬¥±²® ¯®±«¥¤®¢ ²¥«¼­®±²¨ n; n=b; n=b2; : : : ²¥¯¥°¼ ­ ¤® ° ±±¬ ²°¨¢ ²¼ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ni , ®¯°¥¤¥«¥­­³¾ ² ª:
(

ni =

n;
¥±«¨ i = 0,
dni;1=be; ¥±«¨ i > 0.

(4.12)

(¬» ° ±±¬ ²°¨¢ ¥¬ ±«³· © ®ª°³£«¥­¨¿ ± ¨§¡»²ª®¬). ²  ¯®±«¥¤®¢ ²¥«¼­®±²¼ | ³¡»¢ ¾¹ ¿, ­® ­¥ ®¡¿§ ²¥«¼­® ±²°¥¬¨²±¿ ª ¥¤¨­¨¶¥.
¤­ ª® ¬» ¬®¦¥¬ ³²¢¥°¦¤ ²¼, ·²® ¯®±«¥ logb n ¨²¥° ¶¨© ¯®«³·¨²±¿ ·¨±«®, ®£° ­¨·¥­­®¥ ­¥ § ¢¨±¿¹¥© ®² n (µ®²¿ § ¢¨±¿¹¥© ®² b)
ª®­±² ­²®©.
 ± ¬®¬ ¤¥«¥, ¨§ ­¥° ¢¥­±²¢  dxe 6 x + 1 ±«¥¤³¥², ·²®

n0 6 n;
n1 6 nb + 1;
n2 6 bn2 + 1b + 1;
n3 6 bn3 + b12 + 1b + 1;
::::::::::::::::::::::
®±ª®«¼ª³ 1 + 1=b + 1=b2 + : : : 6 1=(b ; 1), ¤«¿ i = blogb nc ¬»
¯®«³· ¥¬ ni 6 n=bi + b=(b ; 1) 6 b + b=(b ; 1) = O(1).

70

« ¢  4 ¥ª³°°¥­²­»¥ ±®®²­®¸¥­¨¿

²¥°¨°³¿ ±®®²­®¸¥­¨¥ (4.10), ¬» ¯®«³· ¥¬

T (n) = f (n0) + aT (n1)
= f (n0) + af (n1 ) + a2 T (n2)
6 f (n0) + af (n1) + a2f (n2) + : : : +
+ ablogb nc;1 f (nblogb nc;1 ) + ablogb nc T (nblogb nc )
= (nlogb a ) +

blogX
b nc;1
j =0

aj f (nj ):

(4.13)

²® ¢»° ¦¥­¨¥ ®·¥­¼ ¯®µ®¦¥ ­  (4.6), ²®«¼ª® §¤¥±¼ n ­¥ ®¡¿§ ­®
¡»²¼ ±²¥¯¥­¼¾ ·¨±«  b.
[²°®£® £®¢®°¿, ±ª § ­­®¥ ²°¥¡³¥² ­¥ª®²®°»µ ³²®·­¥­¨©. ¥«® ¢
²®¬, ·²® ¢¥«¨·¨­  T (ndlog bne ) ¬®¦¥² ®ª § ²¼±¿ ° ¢­®© ­³«¾. ® ¬»
§­ ¥¬, ·²® f (n)  ±¨¬¯²®²¨·¥±ª¨ ¯®«®¦¨²¥«¼­ , ². ¥. ¯®«®¦¨²¥«¼­ 
¤«¿ ¢±¥µ n, ­ ·¨­ ¿ ± ­¥ª®²®°®£® n0 . ®½²®¬³ ¢ ° §¢¥°²»¢ ­¨¨
±³¬¬» ­³¦­® ®±² ­®¢¨²¼±¿, ­¥¬­®£® ­¥ ¤®©¤¿ ¤® ½²®£® n0 . »
®¯³±ª ¥¬ ¯®¤°®¡­®±²¨.]
¥¯¥°¼ ­ ¤® ° §®¡° ²¼±¿ ± ±®®²­®¸¥­¨¿¬¨ ¬¥¦¤³ ±« £ ¥¬»¬¨ ¢
±³¬¬¥

g (n) =

blogX
b nc;1
j =0

aj f (nj ):

(4.14)

 ­¼¸¥ ¬» ±° ¢­¨¢ «¨ ½²³ ±³¬¬³ ± £¥®¬¥²°¨·¥±ª®© ¯°®£°¥±±¨¥©, ¢ ª®²®°®© §­ ¬¥­ ²¥«¼ ¡»« ¡®«¼¸¥ ¥¤¨­¨¶» (¯¥°¢»© ±«³· ©), ° ¢¥­ ¥¤¨­¨¶¥ (¢²®°®© ±«³· ©) ¨«¨ ¬¥­¼¸¥ ¥¤¨­¨¶» (²°¥²¨© ±«³· ©). °¥²¨© ±«³· © ­¥ ¢»§»¢ ¥² ¤®¯®«­¨²¥«¼­»µ ¯°®¡«¥¬, ² ª ª ª ¢ ³±«®¢¨¨ °¥£³«¿°­®±²¨ ² ª¦¥ ¯°¥¤³±¬ ²°¨¢ ¥²±¿ ®ª°³£«¥­¨¥ (¯°¨·¥¬ ¢ ²³ ¦¥ ±²®°®­³, ·²® ¨ ¢ °¥ª³°°¥­²­®¬
±®®²­®¸¥­¨¨). ® ¢²®°®¬ ±«³· ¥ ¬» ¤®«¦­» ®¶¥­¨²¼, ­ ±ª®«¼ª® ¢¥«¨ª¨ ¨§¬¥­¥­¨¿ ¢±«¥¤±²¢¨¥ § ¬¥­» n=bi ­  ni .  ª ¬» ¢¨¤¥«¨, ° §­¨¶  ­¥ ¯°¥¢®±µ®¤¨² b=(b ; 1), ­® ­ ¤® ¥¹¥ ®²  ¡±®«¾²­®© ®¸¨¡ª¨ ¯¥°¥©²¨ ª ®²­®±¨²¥«¼­®©.  ¬ ­ ¤® ¯°®¢¥°¨²¼, ·²®
f (nj ) = O(nlogb a =aj ) = O((n=bj )logb a ), ²®£¤  ¯°®µ®¤¨² ¤®ª § ²¥«¼±²¢® «¥¬¬» 4.3 (±«³· © 2).  ¬¥²¨¬, ·²® bj =n 6 1 ¯°¨ j 6 blogb nc.
§ ®¶¥­ª¨ f (n) = O(nlogb a ) ¢»²¥ª ¥², ·²® ¤«¿ ¯®¤µ®¤¿¹¥£® c ¨

 ¤ ·¨ ª £« ¢¥ 4

71

¤®±² ²®·­® ¡®«¼¸¨µ nj
log a
b
b
n
f (nj ) 6 c bj + b ; 1
 log a  
 j
logb a
b
= c n aj
1 + bn  b ;b 1
logb a
 log a  
b
n
b
1+ b;1
6 c aj
 log a 
b
= O n aj :


®±«¥¤­¨© ¯¥°¥µ®¤ ¨±¯®«¼§³¥² ²®, ·²® c(1 + b=(b ; 1))logb a | ª®­±² ­² . ² ª, ±«³· © 2 ° §®¡° ­.
 ±±³¦¤¥­¨¥ ¤«¿ ±«³· ¿ 1 ¯®·²¨ ² ª®¥ ¦¥.  ¬ ­³¦­® ¤®ª § ²¼
®¶¥­ª³ f (nj ) = O(nlogb a;" );   ½²® ¤¥« ¥²±¿ ¯°¨¬¥°­® ² ª ¦¥, ª ª ¨
¢ ±«³· ¥ 2, µ®²¿ ¯°¥®¡° §®¢ ­¨¿ ¡³¤³² ­¥±ª®«¼ª® ±«®¦­¥¥.
² ª, ¬» ° ±±¬®²°¥«¨ ±«³· © ¯°®¨§¢®«¼­®£® n ¤«¿ ®ª°³£«¥­¨¿
± ¨§¡»²ª®¬. ­ «®£¨·­® ¬®¦­® ° ±±¬®²°¥²¼ ±«³· © ®ª°³£«¥­¨¿ ±
­¥¤®±² ²ª®¬, ¯°¨ ½²®¬ ­³¦­® ¡³¤¥² ¤®ª §»¢ ²¼, ·²® nj ­¥ ¬®¦¥²
¡»²¼ ±¨«¼­® ¬¥­¼¸¥ n=bj .
¯° ¦­¥­¨¿
4.4-1? ª ¦¨²¥ ¯°®±²³¾ ¿¢­³¾ ´®°¬³«³ ¤«¿ ni ¨§ (4.12), ¥±«¨ b |
¯®«®¦¨²¥«¼­®¥ ¶¥«®¥ ·¨±«®.
4.4-2? ®ª ¦¨²¥, ·²® ¥±«¨ f (n) = (nlogb a lgk n), £¤¥ k > 0, ²®
±®®²­®¸¥­¨¥ (4.5) ¢«¥·¥² T (n) = (nlogb a lgk+1 n). «¿ ¯°®±²®²»
° ±±¬®²°¨²¥ «¨¸¼ ±«³· © ¶¥«»µ ±²¥¯¥­¥© b.
4.4-3? ®ª ¦¨²¥, ·²® ¢ ±«³· ¥ 3 ®±­®¢­®© ²¥®°¥¬» ®¤­® ¨§ ³±«®¢¨© «¨¸­¥¥: ³±«®¢¨¥ °¥£³«¿°­®±²¨ (af (n=b) 6 cf (n) ¤«¿ ­¥ª®²®°®£® c < 1) £ ° ­²¨°³¥², ·²® ±³¹¥±²¢³¥² " > 0, ¤«¿ ª®²®°®£®
f (n) = 
(nlogb a+" ).

 ¤ ·¨
4-1 °¨¬¥°» °¥ª³°°¥­²­»µ ±®®²­®¸¥­¨©
 ©²¥ ª ª ¬®¦­® ¡®«¥¥ ²®·­»¥  ±¨¬¯²®²¨·¥±ª¨¥ ¢¥°µ­¨¥ ¨ ­¨¦­¨¥ ®¶¥­ª¨ ¤«¿ ±«¥¤³¾¹¨µ ±®®²­®¸¥­¨© (±·¨² ¥¬, ·²® T (n) | ª®­±² ­²  ¯°¨ n 6 2):
 . T (n) = 2T (n=2) + n3 .
¡. T (n) = T (9n=10) + n.

72

« ¢  4 ¥ª³°°¥­²­»¥ ±®®²­®¸¥­¨¿

¢. T (n) = 16T (n=4) + n2 .
£. T (n) = 7T (n=3) + n2 .
¤. T (n) = 7T (n=2) + p
n2 .
¥. T (n) = 2T (n=4) + n.
¦. T (n) = T (pn ; 1) + n.
§. T (n) = T ( n) + 1.
4-2 ¥¤®±² ¾¹¥¥ ·¨±«®
 ±±¨¢ A[1 : :n] ±®¤¥°¦¨² ¢±¥ ¶¥«»¥ ·¨±«  ®² 0 ¤® n, ª°®¬¥ ®¤­®£®. ²®¡» ­ ©²¨ ¯°®¯³¹¥­­®¥ ·¨±«®, ¬®¦­® ®²¬¥· ²¼ ¢® ¢±¯®¬®£ ²¥«¼­®¬ ¬ ±±¨¢¥ B [0 : :n] ¢±¥ ·¨±« , ¢±²°¥· ¾¹¨¥±¿ ¢ A, ¨ § ²¥¬
¯®±¬®²°¥²¼, ª ª®¥ ·¨±«® ­¥ ®²¬¥·¥­® (¢±¥ ¢¬¥±²¥ ²°¥¡³¥² ¢°¥¬¥­¨ O(n)). °¨ ½²®¬ ¨±¯®«¼§®¢ ­¨¥ ½«¥¬¥­²  ¬ ±±¨¢  A ¢ ª ·¥±²¢¥
¨­¤¥ª±  ±·¨² ¥²±¿ ½«¥¬¥­² °­®© ®¯¥° ¶¨¥©.
 «®¦¨¬ ² ª®¥ ¤®¯®«­¨²¥«¼­®¥ ®£° ­¨·¥­¨¥ ­  ¤®±²³¯ ª ¬ ±±¨¢³ A: §  ®¤­® ¤¥©±²¢¨¥ ¬» ¬®¦¥¬ ¯®±¬®²°¥²¼ § ¤ ­­»© ¡¨² § ¤ ­­®£® ½«¥¬¥­²  ¬ ±±¨¢  A.
®ª ¦¨²¥, ·²® ¨ ¯°¨ ² ª¨µ ®£° ­¨·¥­¨¿µ ¬» ¬®¦¥¬ ­ ©²¨ ¯°®¯³¹¥­­®¥ ·¨±«® §  ¢°¥¬¿ O(n).
4-3 °¥¬¿ ¯¥°¥¤ ·¨ ¯ ° ¬¥²°®¢
 ½²®© ª­¨£¥ ¬» ¯°¥¤¯®« £ ¥¬, ·²® ¯¥°¥¤ ·  ¯ ° ¬¥²°®¢ § ­¨¬ ¥² ¯®±²®¿­­®¥ ¢°¥¬¿, ¤ ¦¥ ¥±«¨ ¯¥°¥¤ ¢ ¥¬»© ¯ ° ¬¥²° |
¬ ±±¨¢.  ¡®«¼¸¨­±²¢¥ ¿§»ª®¢ ¯°®£° ¬¬¨°®¢ ­¨¿ ½²® ² ª ¨ ¥±²¼,
¯®±ª®«¼ª³ ¯¥°¥¤ ¥²±¿ ­¥ ± ¬ ¬ ±±¨¢,   ³ª § ²¥«¼ ­  ­¥£®. ® ¢®§¬®¦­» ¨ ¤°³£¨¥ ¢ °¨ ­²». ° ¢­¨¬ ²°¨ ±¯®±®¡  ¯¥°¥¤ ·¨ ¬ ±±¨¢®¢ ¢ ª ·¥±²¢¥ ¯ ° ¬¥²°®¢:
1.  ±±¨¢ ¯¥°¥¤ ¥²±¿ ª ª ³ª § ²¥«¼ §  ¢°¥¬¿ (1).
2.  ±±¨¢ ª®¯¨°³¥²±¿ §  ¢°¥¬¿ (N ), £¤¥ N | ° §¬¥° ¬ ±±¨¢ .
3.  ¯°®¶¥¤³°³ ¯¥°¥¤ ¥²±¿ ²®«¼ª® ²  · ±²¼ ¬ ±±¨¢ , ª®²®° ¿ ¡³¤¥² ¢ ­¥© ¨±¯®«¼§®¢ ²¼±¿. °¨ ½²®¬ ²°¥¡³¥²±¿ ¢°¥¬¿ (q ; p + 1),
¥±«¨ ¯¥°¥¤ ¥²±¿ ³· ±²®ª A[p : :q ].
 .  ±±¬®²°¨¬ °¥ª³°±¨¢­»©  «£®°¨²¬ ¤¢®¨·­®£® ¯®¨±ª  ·¨±«  ¢
³¯®°¿¤®·¥­­®¬ ¬ ±±¨¢¥ (³¯°. 1.3-5).  ª®¢® ¡³¤¥² ¢°¥¬¿ ¥£® ° ¡®²» ¯°¨ ª ¦¤®¬ ¨§ ³ª § ­­»µ ±¯®±®¡®¢ ¯¥°¥¤ ·¨ ¯ ° ¬¥²° ? (°£³¬¥­² ¬¨ °¥ª³°±¨¢­®© ¯°®¶¥¤³°» ¿¢«¿¾²±¿ ¨±ª®¬»© ½«¥¬¥­² ¨
¬ ±±¨¢, ¢ ª®²®°®¬ ®±³¹¥±²¢«¿¥²±¿ ¯®¨±ª.)
¡. °®¢¥¤¨²¥ ² ª®©  ­ «¨§ ¤«¿  «£®°¨²¬  Merge-Sort ¨§ ° §¤¥«  1.3.1.
4-4 ¹¥ ­¥±ª®«¼ª® °¥ª³°°¥­²­»µ ±®®²­®¸¥­¨©
ª ¦¨²¥ ¢®§¬®¦­® ¡®«¥¥ ²®·­»¥  ±¨¬¯²®²¨·¥±ª¨¥ ¢¥°µ­¨¥ ¨
­¨¦­¨¥ ®¶¥­ª¨ ¤«¿ T (n) ¢ ª ¦¤®¬ ¨§ ³ª § ­­»µ ­¨¦¥ ¯°¨¬¥°®¢.
°¥¤¯®« £ ¥²±¿, ·²® T (n) | ª®­±² ­²  ¯°¨ n 6 8.
 . T (n) = 3T (n=2) + n lg n.

 ¤ ·¨ ª £« ¢¥ 4

73

¡. T (n) = 3T (n=3 + 5) + n=2.
¢. T (n) = 2T (n=2) + n= lg n.
£. T (n) = T (n ; 1) + 1=n.
¤. T (n) = p
T (n ;p1) + lg n.
¥. T (n) = nT ( n) + n.
4-5 ¥°¥µ®¤ ®² ±²¥¯¥­¥© ª ¯°®¨§¢®«¼­»¬  °£³¬¥­² ¬
³±²¼ ¬» ¯®«³·¨«¨ ®¶¥­ª³ ¤«¿ T (n) ¯°¨ ¢±¥µ n, ¿¢«¿¾¹¨µ±¿ ±²¥¯¥­¿¬¨ ­¥ª®²®°®£® ¶¥«®£® b.  ª ° ±¯°®±²° ­¨²¼ ¥¥ ­  ¯°®¨§¢®«¼­»¥ n?
 . ³±²¼ T (n) ¨ h(n) | ¬®­®²®­­® ¢®§° ±² ¾¹¨¥ ´³­ª¶¨¨, ®¯°¥¤¥«¥­­»¥ ¤«¿ ¯°®¨§¢®«¼­»µ ¯®«®¦¨²¥«¼­»µ  °£³¬¥­²®¢ (­¥ ®¡¿§ ²¥«¼­® ¶¥«»µ), ¯°¨·¥¬ T (n) 6 h(n) ¤«¿ ¢±¥µ n, ¿¢«¿¾¹¨µ±¿ ±²¥¯¥­¿¬¨ ¶¥«®£® ·¨±«  b > 1. ³±²¼ ¨§¢¥±²­®, ª°®¬¥ ²®£®, ·²® h
À° ±²¥² ¤®±² ²®·­® ¬¥¤«¥­­®Á: h(n) = O(h(n=b)). ®ª ¦¨²¥, ·²®
T (n) = O(h(n)).
¡. ³±²¼ ¤«¿ ´³­ª¶¨¨ T ¢»¯®«­¥­® ±®®²­®¸¥­¨¥ T (n) =
aT (n=b) + f (n) ¯°¨ n > n0 ; ¯³±²¼ a > 1, b > 1 ¨ f (n) ¬®­®²®­­® ¢®§° ±² ¥². ³±²¼ T (n) ¬®­®²®­­® ¢®§° ±² ¥² ¯°¨ n 6 n0 , ¨
¯°¨ ½²®¬ T (n0) 6 aT (n0=b)+ f (n0): ®ª ¦¨²¥, ·²® T (n) ¬®­®²®­­®
¢®§° ±² ¥².
¢. ¯°®±²¨²¥ ¤®ª § ²¥«¼±²¢® ²¥®°¥¬» 4.1 ¤«¿ ±«³· ¿ ¬®­®²®­­®©
¨ À¤®±² ²®·­® ¬¥¤«¥­­® ° ±²³¹¥©Á ´³­ª¶¨¨ f (n). ®±¯®«¼§³©²¥±¼
«¥¬¬®© 4.4.
4-6 ¨±«  ¨¡®­ ··¨
¨±«  ¨¡®­ ··¨ ®¯°¥¤¥«¿¾²±¿ ±®®²­®¸¥­¨¥¬ (2.13). ¤¥±¼ ¬»
° ±±¬®²°¨¬ ­¥ª®²®°»¥ ¨µ ±¢®©±²¢ . «¿ ½²®£® ®¯°¥¤¥«¨¬ ¯°®¨§¢®¤¿¹³¾ ´³­ª¶¨¾ (generating function), ®¯°¥¤¥«¿¥¬³¾ ª ª ´®°¬ «¼­»© ±²¥¯¥­­®© °¿¤ (formal power series)

F=

1
X
i=0

Fi z i = 0 + z + z 2 + 2z 3 + 3z4 + 5z5 + 8z 6 + 13z7 + : : :

 . ®ª ¦¨²¥, ·²® F (z ) = z + z F (z ) + z 2F (z ).
¡. ®ª ¦¨²¥, ·²®


z
1
z
1
1
F (z) = 1 ; z ; z2 = (1 ; 'z)(1 ; 'z
= p 1 ; 'z ; 1 ; 'z
b )
b
5
£¤¥
p
1
+
' = 2 5 = 1;61803 : : :
¨
p
1
;
'b = 2 5 = ;0;61803 : : :

74

« ¢  4 ¥ª³°°¥­²­»¥ ±®®²­®¸¥­¨¿

¢. ®ª ¦¨²¥, ·²®

F (z) =

1
X
i=0

p1 ('i ; 'bi)zi:
5

p

£. ®ª ¦¨²¥, ·²® Fi ¯°¨ i > 0 ° ¢­® ¡«¨¦ ©¸¥¬³ ª 'i = 5 ¶¥«®¬³
·¨±«³. (ª § ­¨¥: j'bj < 1.)
¤. ®ª ¦¨²¥, ·²® Fi+2 > 'i ¤«¿ ¢±¥µ i > 0.
4-7 ¥±²¨°®¢ ­¨¥ ¬¨ª°®±µ¥¬
¬¥¥²±¿ n ®¤¨­ ª®¢»µ ¬¨ª°®±µ¥¬, ±¯®±®¡­»µ ¯°®¢¥°¿²¼ ¤°³£
¤°³£ ; ­¥ª®²®°»¥ ¨§ ­¨µ ¨±¯° ¢­», ­¥ª®²®°»¥ | ­¥². «¿ ¯°®¢¥°ª¨ ¯ °  ¬¨ª°®±µ¥¬ ¢±² ¢«¿¥²±¿ ¢ ±¯¥¶¨ «¼­³¾ ¯« ²³, ¯®±«¥ ·¥£®
ª ¦¤ ¿ ¨§ ­¨µ ±®®¡¹ ¥² ® ±®±²®¿­¨¨ ±®±¥¤ . ±¯° ¢­ ¿ ¬¨ª°®±µ¥¬  ¯°¨ ½²®¬ ­¨ª®£¤  ­¥ ®¸¨¡ ¥²±¿,   ­¥¨±¯° ¢­ ¿ ¬®¦¥² ¤ ²¼
«¾¡®© ®²¢¥².
²¢¥² A
²¢¥² B
¥§³«¼² ²
B ¨±¯° ¢­  A ¨±¯° ¢­  ®¡¥ µ®°®¸¨¥ ¨«¨ ®¡¥ ¯«®µ¨¥
B ¨±¯° ¢­  A ­¥¨±¯° ¢­  µ®²¿ ¡» ®¤­  ­¥¨±¯° ¢­ 
B ­¥¨±¯° ¢­  A ¨±¯° ¢­  µ®²¿ ¡» ®¤­  ­¥¨±¯° ¢­ 
B ­¥¨±¯° ¢­  A ­¥¨±¯° ¢­  µ®²¿ ¡» ®¤­  ­¥¨±¯° ¢­ 
 . ®ª ¦¨²¥, ·²® ¥±«¨ ¡®«¼¸¥ ¯®«®¢¨­» ¬¨ª°®±µ¥¬ ¯«®µ¨¥, ²®
¯®¯ °­®¥ ²¥±²¨°®¢ ­¨¥ ­¥ ¯®§¢®«¨² ³§­ ²¼ ­ ¢¥°­¿ª , ª ª¨¥ ¨¬¥­­® ¬¨ª°®±µ¥¬» ¯«®µ¨ (®­¨ ±¬®£³² ­ ± ®¡¬ ­³²¼).
¡. ³±²¼ ­³¦­® ­ ©²¨ µ®²¿ ¡» ®¤­³ µ®°®¸³¾ ¬¨ª°®±µ¥¬³ ¨§
n ¸²³ª, ¨§ ª®²®°»µ ¡®«¼¸¥ ¯®«®¢¨­» ¨±¯° ¢­»µ. ®ª ¦¨²¥, ·²®
¤®±² ²®·­® bn=2c ¯®¯ °­»µ ²¥±²®¢, ·²®¡» ±¢¥±²¨ § ¤ ·³ ª  ­ «®£¨·­®© § ¤ ·¥ ¯®«®¢¨­­®£® ° §¬¥° .
¢. ³±²¼ ¨±¯° ¢­® ¡®«¼¸¥ ¯®«®¢¨­» ¬¨ª°®±µ¥¬. ®ª ¦¨²¥, ·²®
¬®¦­® ­ ©²¨ ¢±¥ µ®°®¸¨¥ ¬¨ª°®±µ¥¬» §  (n) ¯®¯ °­»µ ²¥±²®¢.
(®±¯®«¼§³©²¥±¼ °¥ª³°°¥­²­»¬ ±®®²­®¸¥­¨¥¬.)
[²³ § ¤ ·³ ¬®¦­® ¯¥°¥´®°¬³«¨°®¢ ²¼ ¢ ¨­»µ ²¥°¬¨­ µ: ¨¬¥¥²±¿ n ®¤¨­ ª®¢»µ ­  ¢¨¤ ¯°¥¤¬¥²®¢, ­® ­  ± ¬®¬ ¤¥«¥ ®­¨ ®²­®±¿²±¿ ª ­¥±ª®«¼ª¨¬ ª ²¥£®°¨¿¬. ±²¼ ¯°¨¡®°, ª®²®°»© ¯® ¤¢³¬
¯°¥¤¬¥² ¬ ¯°®¢¥°¿¥², ®¤¨­ ª®¢» «¨ ®­¨. §¢¥±²­®, ·²® ¯°¥¤¬¥²»
­¥ª®²®°®© ª ²¥£®°¨¨ ±®±² ¢«¿¾² ¡®«¼¸¨­±²¢®.  ¤® ­ ©²¨ ¯°¥¤±² ¢¨²¥«¼ ½²®£® ¡®«¼¸¨­±²¢  §  O(n) ±° ¢­¥­¨©. ®¬¨¬® °¥ª³°°¥­²­®£® °¥¸¥­¨¿, ½²  § ¤ ·  ¨¬¥¥² ¯°®±²®¥ ¨²¥° ²¨¢­®¥ °¥¸¥­¨¥.  ¢¥¤¥¬ ª®°®¡ª³, ¢ ª®²®°®© ¡³¤¥¬ ­ ª ¯«¨¢ ²¼ ®¤¨­ ª®¢»¥
¯°¥¤¬¥²»,   ² ª¦¥ ³°­³, ª³¤  ¬®¦­® ¢»ª¨¤»¢ ²¼ ¯°¥¤¬¥²». ¥°¥ª« ¤»¢ ¥¬ ­¥¯°®±¬®²°¥­­»¥ ½«¥¬¥­²» ¢ ª®°®¡ª³ ¨«¨ ³°­³, ¯®¤¤¥°¦¨¢ ¿ ² ª®¥ ±¢®©±²¢®: ±°¥¤¨ ­¥¢»ª¨­³²»µ ¨±ª®¬»¥ ±®±² ¢«¿¾²
¡®«¼¸¨­±²¢®.]

 ¬¥· ­¨¿ ª £« ¢¥ 4

75

 ¬¥· ­¨¿
¨±«  ¨¡®­ ··¨ ° ±±¬ ²°¨¢ «¨±¼ ¨¡®­ ··¨ (L. Fibonacci) ¢
1202 £®¤³. ³ ¢° (A. De Moivre) ¯°¨¬¥­¨« ¯°®¨§¢®¤¿¹¨¥ ´³­ª¶¨¨
¤«¿ °¥¸¥­¨¿ °¥ª³°°¥­²­»µ ±®®²­®¸¥­¨© (±¬. § ¤ ·³ 4-6). ±­®¢­ ¿ ²¥®°¥¬  ® °¥ª³°°¥­²­»µ ±®®²­®¸¥­¨¿µ § ¨¬±²¢®¢ ­  ¨§ ° ¡®²» ¥­²«¨,  ª¥­ ¨  ª±  [26], £¤¥ ¯°¨¢®¤¨²±¿ ¡®«¥¥ ±¨«¼­»© °¥§³«¼² ² (¢ª«¾· ¾¹¨© °¥§³«¼² ² ³¯°. 4.4-2). ­³² [121] ¨ ¾ [140]
¯®ª §»¢ ¾², ª ª °¥¸ ²¼ «¨­¥©­»¥ °¥ª³°°¥­²­»¥ ±®®²­®¸¥­¨¿ ±
¯®¬®¹¼¾ ¯°®¨§¢®¤¿¹¨µ ´³­ª¶¨©. ®¯®«­¨²¥«¼­»¥ ±¢¥¤¥­¨¿ ® °¥¸¥­¨¨ °¥ª³°°¥­²­»µ ±®®²­®¸¥­¨© ¯°¨¢®¤¿² ³°¤®¬ ¨ ° ³­ [164].

76

« ¢  4 ¥ª³°°¥­²­»¥ ±®®²­®¸¥­¨¿

1257

5

­®¦¥±²¢ 

 ½²®© £« ¢¥ ¬» ­ ¯®¬¨­ ¥¬ ®¯°¥¤¥«¥­¨¿, ²¥°¬¨­®«®£¨¾, ®¡®§­ ·¥­¨¿ ¨ ®±­®¢­»¥ ±¢®©±²¢  ¬­®¦¥±²¢, ®²­®¸¥­¨©, ´³­ª¶¨©, £° ´®¢
¨ ¤¥°¥¢¼¥¢. ¨² ²¥«¨, §­ ª®¬»¥ ± ­¨¬¨, ¬®£³² ¯°®¯³±²¨²¼ ½²³ £« ¢³ (®¡° ¹ ¿±¼ ª ­¥© ¯® ¬¥°¥ ­¥®¡µ®¤¨¬®±²¨).

5.1. ­®¦¥±²¢ 
­®¦¥±²¢® (set) ±®±²®¨² ¨§ ½«¥¬¥­²®¢ (members, elements). ±«¨
®¡º¥ª² x ¿¢«¿¥²±¿ ½«¥¬¥­²®¬ ¬­®¦¥±²¢  S , ¬» ¯¨¸¥¬ x 2 S (·¨² ¥²±¿ Àx ¯°¨­ ¤«¥¦¨² S Á). ±«¨ x ­¥ ¯°¨­ ¤«¥¦¨² S , ¯¨¸¥¬ x 2= S .
®¦­® § ¤ ²¼ ¬­®¦¥±²¢® ¯¥°¥·¨±«¥­¨¥¬ ¥£® ½«¥¬¥­²®¢ ·¥°¥§ § ¯¿²»¥ ¢ ´¨£³°­»µ ±ª®¡ª µ.  ¯°¨¬¥°, ¬­®¦¥±²¢® S = f1; 2; 3g ±®¤¥°¦¨² ½«¥¬¥­²» 1; 2; 3 ¨ ²®«¼ª® ¨µ. ¨±«® 2 ¿¢«¿¥²±¿ ½«¥¬¥­²®¬ ½²®£®
¬­®¦¥±²¢ ,   ·¨±«® 4 | ­¥², ² ª ·²® 2 2 S , 4 2= S . ­®¦¥±²¢® ­¥
¬®¦¥² ±®¤¥°¦ ²¼ ¤¢³µ ®¤¨­ ª®¢»µ ½«¥¬¥­²®¢, ¨ ¯®°¿¤®ª ½«¥¬¥­²®¢ ­¥ ´¨ª±¨°®¢ ­. ¢  ¬­®¦¥±²¢  A ¨ B ° ¢­» (are equal), ¥±«¨
®­¨ ±®±²®¿² ¨§ ®¤­¨µ ¨ ²¥µ ¦¥ ½«¥¬¥­²®¢.  ½²®¬ ±«³· ¥ ¯¨¸³²
A = B .  ¯°¨¬¥°, f1; 2; 3; 1g = f1; 2; 3g = f3; 2; 1g.
«¿ · ±²® ¨±¯®«¼§³¥¬»µ ¬­®¦¥±²¢ ¨¬¥¾²±¿ ±¯¥¶¨ «¼­»¥ ®¡®§­ ·¥­¨¿:
 ? ®¡®§­ · ¥² ¯³±²®¥ ¬­®¦¥±²¢® (empty set), ­¥ ±®¤¥°¦ ¹¥¥ ­¨
®¤­®£® ½«¥¬¥­² .
 Z ®¡®§­ · ¥² ¬­®¦¥±²¢® ¶¥«»µ ·¨±¥« (integers); Z =
f: : : ; ;2; ;1; 0; 1; 2; : : : g;
 R ®¡®§­ · ¥² ¬­®¦¥±²¢® ¢¥¹¥±²¢¥­­»µ (¤¥©±²¢¨²¥«¼­»µ) ·¨±¥«
(real numbers);
 N ®¡®§­ · ¥² ¬­®¦¥±²¢® ­ ²³° «¼­»µ ·¨±¥« (natural numbers);
1
N = f0; 1; 2; : : : g
±«¨ ¢±¥ ½«¥¬¥­²» ¬­®¦¥±²¢  A ¿¢«¿¾²±¿ ½«¥¬¥­² ¬¨ ¬­®¦¥±²¢ 
1

­®£¤  ­³¬¥° ¶¨¾ ­ ²³° «¼­»µ ·¨±¥« ­ ·¨­ ¾² ± 1 | ° ­¼¸¥ ² ª ¡»«® ¯°¨­¿²®.

78

« ¢  5 ­®¦¥±²¢ 

B, (¨§ x 2 A ±«¥¤³¥² x 2 B), £®¢®°¿², ·²® A ¿¢«¿¥²±¿ ¯®¤¬­®¦¥±²¢®¬ (subset) ¬­®¦¥±²¢  B ¨ ¯¨¸³² A  B . ±«¨ ¯°¨ ½²®¬ A
­¥ ±®¢¯ ¤ ¥² ± B , ²® A ­ §»¢ ¥²±¿ ±®¡±²¢¥­­»¬ ¯®¤¬­®¦¥±²¢®¬
(proper subset) ¬­®¦¥±²¢  B ; ¢ ½²®¬ ±«³· ¥ ¯¨¸³² A  B . (­®£¨¥
 ¢²®°» ¨±¯®«¼§³¾² ®¡®§­ ·¥­¨¥ A  B ¤«¿ ¯®¤¬­®¦¥±²¢,   ­¥ ¤«¿
±®¡±²¢¥­­»µ ¯®¤¬­®¦¥±²¢ .) «¿ «¾¡®£® ¬­®¦¥±²¢  A ¢»¯®«­¥­®
±®®²­®¸¥­¨¥ A  A. ­®¦¥±²¢  A ¨ B ° ¢­» ²®£¤  ¨ ²®«¼ª® ²®£¤ , ª®£¤  A  B ¨ B  A. «¿ «¾¡»µ ²°¥µ ¬­®¦¥±²¢ A, B ¨ C ¨§
A  B ¨ B  C ±«¥¤³¥² A  C . «¿ «¾¡®£® ¬­®¦¥±²¢  A ¨¬¥¥²
¬¥±²® ±®®²­®¸¥­¨¥  A.
?

­®£¤  ¬­®¦¥±²¢® ®¯°¥¤¥«¿¥²±¿ ª ª · ±²¼ ¤°³£®£® ¬­®¦¥±²¢ :
¬» ¬®¦¥¬ ¢»¤¥«¨²¼ ¨§ ¬­®¦¥±²¢  A ¢±¥ ½«¥¬¥­²», ®¡« ¤ ¾¹¨¥
­¥ª®²®°»¬ ±¢®©±²¢®¬, ¨ ®¡° §®¢ ²¼ ¨§ ­¨µ ­®¢®¥ ¬­®¦¥±²¢® B .
 ¯°¨¬¥°, ¬­®¦¥±²¢® ·¥²­»µ ·¨±¥« ¬®¦­® ®¯°¥¤¥«¨²¼ ª ª fx : x 2
Z¨ x=2 | ¶¥«®¥ ·¨±«®g. ²® ®¡»·­® ·¨² ¾² À¬­®¦¥±²¢® x ¨§ Z, ¤«¿
ª®²®°»µ...Á ­®£¤  ¢¬¥±²® ¤¢®¥²®·¨¿ ¨±¯®«¼§³¥²±¿ ¢¥°²¨ª «¼­ ¿
·¥°² .
«¿ «¾¡»µ ¬­®¦¥±²¢ A ¨ B ¬®¦­® ¯®±²°®¨²¼ ±«¥¤³¾¹¨¥ ¬­®¦¥±²¢ , ¯®«³· ¥¬»¥ ± ¯®¬®¹¼¾ ²¥®°¥²¨ª®-¬­®¦¥±²¢¥­­»µ ®¯¥° ¶¨©
(set operations):
 ¥°¥±¥·¥­¨¥ (intersection) ¬­®¦¥±²¢ A ¨ B ®¯°¥¤¥«¿¥²±¿ ª ª
¬­®¦¥±²¢®
A \ B = fx : x 2 A ¨ x 2 Bg:
 ¡º¥¤¨­¥­¨¥ (union) ¬­®¦¥±²¢ A ¨ B ®¯°¥¤¥«¿¥²±¿ ª ª ¬­®¦¥±²¢®
A [ B = fx : x 2 A ¨«¨ x 2 Bg:
  §­®±²¼ (dierence) ¬­®¦¥±²¢ A ¨ B ®¯°¥¤¥«¿¥²±¿ ª ª ¬­®¦¥±²¢®
A n B = fx : x 2 A ¨ x 2= B g:
¥®°¥²¨ª®-¬­®¦¥±²¢¥­­»¥ ®¯¥° ¶¨¨ ®¡« ¤ ¾² ±«¥¤³¾¹¨¬¨
±¢®©±²¢ ¬¨:
¢®©±²¢  ¯³±²®£® ¬­®¦¥±²¢  (empty set laws):

A\ = ;
?

?

A [ = A:
?

¤¥¬¯®²¥­²­®±²¼ (idempotency laws):

A \ A = A;

A [ A = A:

®¬¬³² ²¨¢­®±²¼ (commutative laws):

A \ B = B \ A;

A [ B = B [ A:

­®¦¥±²¢ 

79

???   ª °²¨­ª¥ ±«¥¤³¥² § ¬¥­¨²¼ ¬¨­³± ­  n
¨ £° ¬¬  ¥­­ , ¨««¾±²°¨°³¾¹ ¿ ¯¥°¢»© ¨§ § ª®­®¢ ¤¥ ®°£ ­  (5.2). ­®¦¥±²¢  A; B; C ¨§®¡° ¦¥­» ª°³£ ¬¨ ­  ¯«®±ª®±²¨.
¨±. 5.1

±±®¶¨ ²¨¢­®±²¼ (associative laws):
A \ (B \ C ) = (A \ B) \ C; A [ (B [ C ) = (A [ B) [ C:
¨±²°¨¡³²¨¢­®±²¼ (distributive laws):
A \ (B [ C ) = (A \ B) [ (A \ C );
A [ (B \ C ) = (A [ B) \ (A [ C )

(5.1)

 ª®­» ¯®£«®¹¥­¨¿ (absorption laws):
A \ (A [ B ) = A; A [ (A \ B ) = A
 ª®­» ¤¥ ®°£ ­  (DeMorgan's laws):
A n (B \ C ) = (A n B) [ (A n C );
(5.2)
A n ( B [ C ) = ( A n B ) \ (A n C )
¨±. 5.1 ¨««¾±²°¨°³¥² ¯¥°¢»© ¨§ § ª®­®¢ ¤¥ ®°£ ­  (5.1);
¬­®¦¥±²¢  A, B ¨ C ¨§®¡° ¦¥­» ¢ ¢¨¤¥ ª°³£®¢ ­  ¯«®±ª®±²¨.
 ±²® ¢±¥ ° ±±¬ ²°¨¢ ¥¬»¥ ¬­®¦¥±²¢  ¿¢«¿¾²±¿ ¯®¤¬­®¦¥±²¢ 
­¥ª®²®°®£® ´¨ª±¨°®¢ ­­®£® ¬­®¦¥±²¢ , ­ §»¢ ¥¬®£® ³­¨¢¥°±³¬®¬
(universe).  ¯°¨¬¥°, ¥±«¨ ­ ± ¨­²¥°¥±³¾² ¬­®¦¥±²¢ , ½«¥¬¥­² ¬¨
ª®²®°»µ ¿¢«¿¾²±¿ ¶¥«»¥ ·¨±« , ²® ¢ ª ·¥±²¢¥ ³­¨¢¥°±³¬  ¬®¦­®
¢§¿²¼ ¬­®¦¥±²¢® Z ¶¥«»µ ·¨±¥«. ±«¨ ³­¨¢¥°±³¬ U ´¨ª±¨°®¢ ­,
¬®¦­® ®¯°¥¤¥«¨²¼ ¤®¯®«­¥­¨¥ (complement) ¬­®¦¥±²¢  A ª ª A =
U n A. «¿ «¾¡®£® A  U ¢¥°­» ² ª¨¥ ³²¢¥°¦¤¥­¨¿:

A = A;

A\A= ;
?

A [ A = U:

§ § ª®­®¢ ¤¥ ®°£ ­  (5.2) ±«¥¤³¥², ·²® ¤«¿ «¾¡»µ ¬­®¦¥±²¢

A; B  U ¨¬¥¾² ¬¥±²® ° ¢¥­±²¢ 
A \ B = A [ B; A [ B = A \ B:
¢  ¬­®¦¥±²¢  A ¨ B ­ §»¢ ¾²±¿ ­¥¯¥°¥±¥ª ¾¹¨¬¨±¿ (disjoint),
¥±«¨ ®­¨ ­¥ ¨¬¥¾² ®¡¹¨µ ½«¥¬¥­²®¢, ². ¥. ¥±«¨ A \ B = . ®¢®°¿²,
·²® ±¥¬¥©±²¢® S = fSig ­¥¯³±²»µ ¬­®¦¥±²¢ ®¡° §³¥² ° §¡¨¥­¨¥
(partition) ¬­®¦¥±²¢  S , ¥±«¨
?

80

« ¢  5 ­®¦¥±²¢ 

 ¬­®¦¥±²¢  Si ¯®¯ °­® ­¥ ¯¥°¥±¥ª ¾²±¿ (are pairwise disjoint),
². ¥. Si \ Sj = ¯°¨ i 6= j ,
 ¨µ ®¡º¥¤¨­¥­¨¥ ¥±²¼ S , ². ¥.
[
Si
S=
?

Si 2S

°³£¨¬¨ ±«®¢ ¬¨, ±¥¬¥©±²¢® S ®¡° §³¥² ° §¡¨¥­¨¥ ¬­®¦¥±²¢  S ,
¥±«¨ «¾¡®© ½«¥¬¥­² s 2 S ¯°¨­ ¤«¥¦¨² °®¢­® ®¤­®¬³ ¨§ ¬­®¦¥±²¢
Si ±¥¬¥©±²¢ .
¨±«® ½«¥¬¥­²®¢ ¢ ¬­®¦¥±²¢¥ S ­ §»¢ ¥²±¿ ¥£® ¬®¹­®±²¼¾ (cardinality), ¨«¨ ° §¬¥°®¬ (size), ¨ ®¡®§­ · ¥²±¿ jS j. ¢  ¬­®¦¥±²¢ 
¨¬¥¾² ®¤­³ ¨ ²³ ¦¥ ¬®¹­®±²¼, ¥±«¨ ¬¥¦¤³ ¨µ ½«¥¬¥­² ¬¨ ¬®¦­®
³±² ­®¢¨²¼ ¢§ ¨¬­® ®¤­®§­ ·­®¥ ±®®²¢¥²±²¢¨¥. ®¹­®±²¼ ¯³±²®£® ¬­®¦¥±²¢  ° ¢­  ­³«¾: j?j = 0. ®¹­®±²¼ ª®­¥·­®£® (nite)
¬­®¦¥±²¢  | ­ ²³° «¼­®¥ ·¨±«®; ¤«¿ ¡¥±ª®­¥·­»µ (innite) ¬­®¦¥±²¢ ¯®­¿²¨¥ ¬®¹­®±²¨ ²°¥¡³¥²  ªª³° ²­®£® ®¯°¥¤¥«¥­¨¿. ­®
­ ¬ ­¥ ¯®­ ¤®¡¨²±¿; ³¯®¬¿­¥¬ «¨¸¼, ·²® ¬­®¦¥±²¢ , ½«¥¬¥­²» ª®²®°»µ ¬®¦­® ¯®±² ¢¨²¼ ¢® ¢§ ¨¬­® ®¤­®§­ ·­®¥ ±®®²¢¥²±²¢¨¥ ±
­ ²³° «¼­»¬¨ ·¨±« ¬¨, ­ §»¢ ¾²±¿ ±·¥²­»¬¨ (countably innite);
¡¥±ª®­¥·­»¥ ¬­®¦¥±²¢ , ­¥ ¿¢«¿¾¹¨¥±¿ ±·¥²­»¬¨, ­ §»¢ ¾² ­¥±·¥²­»¬¨ (uncountable). ­®¦¥±²¢® ¶¥«»µ ·¨±¥« Z ±·¥²­®, ¢ ²®
¢°¥¬¿ ª ª ¬­®¦¥±²¢® ¢¥¹¥±²¢¥­­»µ ·¨±¥« R ­¥±·¥²­®.
«¿ «¾¡»µ ¤¢³µ ª®­¥·­»µ ¬­®¦¥±²¢ A ¨ B ¢»¯®«­¥­® ° ¢¥­±²¢®

jA [ Bj = jAj + jBj ; jA \ Bj

(5.3)

¨§ ½²®£® ° ¢¥­±²¢  ¢»²¥ª ¥², ·²®

jA [ Bj 6 jAj + jBj
±«¨ ¬­®¦¥±²¢  A ¨ B ­¥ ¯¥°¥±¥ª ¾²±¿, ²® jA \ B j = 0 ¨ ½²®
­¥° ¢¥­±²¢® ®¡° ¹ ¥²±¿ ¢ ° ¢¥­±²¢®: jA [ B j = jAj + jB j. ±«¨ A 
B, ²® jAj 6 jB j.
®­¥·­®¥ ¬­®¦¥±²¢® ¨§ n ½«¥¬¥­²®¢ ­ §»¢ ¾² n-½«¥¬¥­²­»¬ (n-

set); ®¤­®½«¥¬¥­²­®¥ ¬­®¦¥±²¢® ¨¬¥­³¾² ¨­®£¤  ±¨­£«¥²®­®¬ (singleton).   ­£«¨©±ª®© «¨²¥° ²³°¥ ³¯®²°¥¡«¿¥²±¿ ² ª¦¥ ²¥°¬¨­ ksubset, ®§­ · ¾¹¨© k-½«¥¬¥­²­®¥ ¯®¤¬­®¦¥±²¢® (ª ª®£®-«¨¡® ¬­®¦¥±²¢ ).
«¿ ¤ ­­®£® ¬­®¦¥±²¢  S ¬®¦­® ° ±±¬®²°¥²¼ ¬­®¦¥±²¢® ¢±¥µ
¥£® ¯®¤¬­®¦¥±²¢, ¢ª«¾· ¿ ¯³±²®¥ ¬­®¦¥±²¢® ¨ ± ¬® S ; ¥£® ®¡®§­ · ¾² 2S ¨ ­ §»¢ ¾² ¬­®¦¥±²¢®¬-±²¥¯¥­¼¾ (power set).  ¯°¨¬¥°,
2fa;bg = f?; fag; fbg; fa; bgg. «¿ ª®­¥·­®£® S ¬­®¦¥±²¢® 2S ±®¤¥°¦¨² 2jS j ½«¥¬¥­²®¢.
¯®°¿¤®·¥­­ ¿ ¯ °  ¨§ ¤¢³µ ½«¥¬¥­²®¢ a ¨ b ®¡®§­ · ¥²±¿ (a; b) ¨
´®°¬ «¼­® ¬®¦¥² ¡»²¼ ®¯°¥¤¥«¥­  ª ª (a; b) = fa; fa; bgg, ² ª ·²®
(a; b) ®²«¨· ¥²±¿ ®² (b; a). [²® ®¯°¥¤¥«¥­¨¥ ³¯®°¿¤®·¥­­®© ¯ °»

­®¦¥±²¢ 

81

¯°¥¤«®¦¥­® ³° ²®¢±ª¨¬. ®¦­® ¡»«® ¡» ¨±¯®«¼§®¢ ²¼ ¨ ¤°³£®¥
®¯°¥¤¥«¥­¨¥, ¢ ¦­® ²®«¼ª®, ·²®¡» (a; b) = (c; d) ¡»«® ° ¢­®±¨«¼­®
(a = c) ¨ (b = d).]
¥ª °²®¢® ¯°®¨§¢¥¤¥­¨¥ (cartesian product) ¤¢³µ ¬­®¦¥±²¢ A ¨
B ®¯°¥¤¥«¿¥²±¿ ª ª ¬­®¦¥±²¢® ¢±¥µ ³¯®°¿¤®·¥­­»µ ¯ °, ³ ª®²®°»µ
¯¥°¢»© ½«¥¬¥­² ¯°¨­ ¤«¥¦¨² A,   ¢²®°®© | B . ¡®§­ ·¥­¨¥: AB .
®°¬ «¼­® ¬®¦­® § ¯¨± ²¼

A  B = f(a; b) : a 2 A ¨ b 2 B g
 ¯°¨¬¥°, fa; bg  fa; b; cg = f(a; a); (a; b); (a; c); (b; a); (b; b); (b; c)g.
«¿ ª®­¥·­»µ ¬­®¦¥±²¢ A ¨ B ¬®¹­®±²¼ ¨µ ¯°®¨§¢¥¤¥­¨¿ ° ¢­ 

¯°®¨§¢¥¤¥­¨¾ ¬®¹­®±²¥©:

jA  Bj = jAj  jBj:
(5.4)
¥ª °²®¢® ¯°®¨§¢¥¤¥­¨¥ n ¬­®¦¥±²¢ A1 ; A2; : : :; An ®¯°¥¤¥«¿¥²±¿
ª ª ¬­®¦¥±²¢® n-®ª (n-tuples)
A1A2 : : :An = f(a1; a2; : : : ; an) : ai 2 Ai ¯°¨ ¢±¥µ i = 1; 2; : : : ; ng
(´®°¬ «¼­® ¬®¦­® ®¯°¥¤¥«¨²¼ ²°®©ª³ (a; b; c) ª ª ((a; b); c),
·¥²¢¥°ª³ (a; b; c; d) ª ª ((a; b; c); d) ¨ ² ª ¤ «¥¥).

¨±«® ½«¥¬¥­²®¢ ¢ ¤¥ª °²®¢®¬ ¯°®¨§¢¥¤¥­¨¥ ° ¢­® ¯°®¨§¢¥¤¥­¨¾
¬®¹­®±²¥© ±®¬­®¦¨²¥«¥©:

jA1  A2  : : :  Anj = jA1j  jA2j  : : :  jAnj
®¦­® ®¯°¥¤¥«¨²¼ ² ª¦¥ ¤¥ª °²®¢³ ±²¥¯¥­¼

An = A  A  : : :  A
ª ª ¯°®¨§¢¥¤¥­¨¥ n ®¤¨­ ª®¢»µ ±®¬­®¦¨²¥«¥©; ¤«¿ ª®­¥·­®£® A
¬®¹­®±²¼ An ° ¢­  jAjn . ²¬¥²¨¬, ·²® n-ª¨ ¬®¦­® ° ±±¬ ²°¨¢ ²¼
ª ª ª®­¥·­»¥ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¤«¨­» n (±¬. ±. 5.3).
¯° ¦­¥­¨¿
5.1-1  °¨±³©²¥ ¤¨ £° ¬¬³ ¥­­  ¤«¿ ¯¥°¢®£® ¨§ ±¢®©±²¢ ¤¨±²°¨¡³²¨¢­®±²¨ (5.1).
5.1-2 ®ª ¦¨²¥ ®¡®¡¹¥­¨¥ § ª®­®¢ ¤¥ ®°£ ­  ­  ±«³· © ¡®«¼¸¥£® ·¨±«  ¬­®¦¥±²¢:

A1 \ A2 \ : : : \ An = A1 [ A2 [ : : : [ An ;
A1 [ A2 [ : : : [ An = A1 \ A2 \ : : : \ An:

82

« ¢  5 ­®¦¥±²¢ 

5.1-3 ®ª ¦¨²¥ ®¡®¡¹¥­¨¥ ° ¢¥­±²¢  (5.3), ­ §»¢ ¥¬®¥ ´®°¬³«®© ¢ª«¾·¥­¨© ¨ ¨±ª«¾·¥­¨© (principle of inclusion and exclusion):

jA1 [ A2 [ : : : [ Anj = jA1j + jA2j + : : : + jAn j
; jA1 \ A2j ; jA1 \ A3j ; : : :
+ jA1 \ A2 \ A3 j + : : :
+ (;1)n;1 jA1 \ A2 \ : : : \ An j
5.1-4 ®ª § ²¼, ·²® ¬­®¦¥±²¢® ­¥·¥²­»µ ­ ²³° «¼­»µ ·¨±¥«
±·¥²­®.
5.1-5 ®ª § ²¼, ·²® ¥±«¨ ¬­®¦¥±²¢® S ª®­¥·­® ¨ ±®¤¥°¦¨² n ½«¥¬¥­²®¢, ²® ¬­®¦¥±²¢®-±²¥¯¥­¼ 2S ±®¤¥°¦¨² 2n ½«¥¬¥­²®¢. (°³£¨¬¨ ±«®¢ ¬¨, ¬­®¦¥±²¢® S ¨¬¥¥² 2n ° §«¨·­»µ ¯®¤¬­®¦¥±²¢.)
5.1-6  ©²¥ ´®°¬ «¼­® ¨­¤³ª²¨¢­®¥ ®¯°¥¤¥«¥­¨¥ n-ª¨, ¨±¯®«¼§³¿ ¯®­¿²¨¥ ³¯®°¿¤®·¥­­®© ¯ °».

5.2. ²­®¸¥­¨¿
¨­ °­»¬ ®²­®¸¥­¨¥¬ (binary relation) R ¬¥¦¤³ ½«¥¬¥­² ¬¨
¬­®¦¥±²¢ A ¨ B ­ §»¢ ¥²±¿ ¯®¤¬­®¦¥±²¢® ¤¥ª °²®¢  ¯°®¨§¢¥¤¥­¨¿ A  B . ±«¨ (a; b) 2 R, ¯¨¸³² aRb ¨ £®¢®°¿², ·²® ½«¥¬¥­² a
­ µ®¤¨²±¿ ¢ ®²­®¸¥­¨¨ R ± ½«¥¬¥­²®¬ b. ¨­ °­»¬ ®²­®¸¥­¨¥¬ ­ 
¬­®¦¥±²¢¥ A ­ §»¢ ¾² ¯®¤¬­®¦¥±²¢® ¤¥ª °²®¢  ª¢ ¤° ²  A  A.
 ¯°¨¬¥°, ®²­®¸¥­¨¥ À¡»²¼ ¬¥­¼¸¥Á ­  ¬­®¦¥±²¢¥ ­ ²³° «¼­»µ
·¨±¥« ¥±²¼ ¬­®¦¥±²¢® f(a; b) : a; b 2 N ¨ a < bg. ®¤ n-¬¥±²­»¬ ®²­®¸¥­¨¥¬ (n-ary relation) ­  ¬­®¦¥±²¢ µ A1 ; A2; : : : ; An ¯®­¨¬ ¾²
¯®¤¬­®¦¥±²¢® ¤¥ª °²®¢  ¯°®¨§¢¥¤¥­¨¿ A1  A2  : : :  An .
¨­ °­®¥ ®²­®¸¥­¨¥ R  A  A ­ §»¢ ¾² °¥´«¥ª±¨¢­»¬ (reexive), ¥±«¨

aRa

¤«¿ ¢±¥µ a 2 A.  ¯°¨¬¥°, ®²­®¸¥­¨¿ À=Á ¨ À6Á ¿¢«¿¾²±¿ °¥´«¥ª±¨¢­»¬¨ ®²­®¸¥­¨¿¬¨ ­  ¬­®¦¥±²¢¥ N, ­® ®²­®¸¥­¨¥ À<Á ² ª®¢»¬
­¥ ¿¢«¿¥²±¿. ²­®¸¥­¨¥ R ­ §»¢ ¥²±¿ ±¨¬¬¥²°¨·­»¬ (symmetric),
¥±«¨
aRb ¢«¥·¥² bRa
¤«¿ ¢±¥µ a; b 2 A. ²­®¸¥­¨¥ ° ¢¥­±²¢  ¿¢«¿¥²±¿ ±¨¬¬¥²°¨·­»¬,  
®²­®¸¥­¨¿ À<Á ¨ À6Á | ­¥². ²­®¸¥­¨¥ R ­ §»¢ ¾² ²° ­§¨²¨¢­»¬
(transitive), ¥±«¨
aRb ¨ bRc ¢«¥·¥² aRc

²­®¸¥­¨¿

83

¤«¿ ¢±¥µ a; b; c 2 A.  ¯°¨¬¥°, ®²­®¸¥­¨¿ À<Á, À6Á ¨ À=Á ¿¢«¿¾²±¿
²° ­§¨²¨¢­»¬¨,   ®²­®¸¥­¨¥ R = f(a; b) : a; b 2 N ¨ a = b ; 1g |
­¥², ² ª ª ª 3R4 ¨ 4R5, ­® ­¥ 3R5.
²­®¸¥­¨¥, ¿¢«¿¾¹¥¥±¿ ®¤­®¢°¥¬¥­­® °¥´«¥ª±¨¢­»¬, ±¨¬¬¥²°¨·­»¬ ¨ ²° ­§¨²¨¢­»¬, ­ §»¢ ¾² ®²­®¸¥­¨¥¬ ½ª¢¨¢ «¥­²­®±²¨ (equivalence relation). ±«¨ R | ®²­®¸¥­¨¥ ½ª¢¨¢ «¥­²­®±²¨ ­ 
¬­®¦¥±²¢¥ A, ²® ¬®¦­® ®¯°¥¤¥«¨²¼ ª« ±± ½ª¢¨¢ «¥­²­®±²¨ (equivalence class) ½«¥¬¥­²  a 2 A ª ª ¬­®¦¥±²¢® [a] = fb 2 A : aRbg ¢±¥µ
½«¥¬¥­²®¢, ½ª¢¨¢ «¥­²­»µ a.  ¯°¨¬¥°, ­  ¬­®¦¥±²¢¥ ­ ²³° «¼­»µ ·¨±¥« ¬®¦­® ®¯°¥¤¥«¨²¼ ®²­®¸¥­¨¥ ½ª¢¨¢ «¥­²­®±²¨, ±·¨² ¿
·¨±«  a ¨ b ½ª¢¨¢ «¥­²­»¬¨, ¥±«¨ ¨µ ±³¬¬  a + b ·¥²­ . ²® ®²­®¸¥­¨¥ (­ §®¢¥¬ ¥£® R) ¤¥©±²¢¨²¥«¼­® ¡³¤¥² ®²­®¸¥­¨¥¬ ½ª¢¨¢ «¥­²­®±²¨.  ± ¬®¬ ¤¥«¥, ±³¬¬  a + a ¢±¥£¤  ·¥²­ , ² ª ·²® ®­®
°¥´«¥ª±¨¢­®; a + b = b + a, ² ª ·²® R ±¨¬¬¥²°¨·­®; ­ ª®­¥¶, ¥±«¨
a + b ¨ b + c | ·¥²­»¥ ·¨±« , ²® a + c = (a + b) + (b + c) ; 2b ² ª¦¥ ·¥²­®, ² ª ·²® R ²° ­§¨²¨¢­®. « ±± ½ª¢¨¢ «¥­²­®±²¨ ·¨±« 
4 ¥±²¼ [4] = f0; 2; 4; 6; : : : g,   ª« ±± ½ª¢¨¢ «¥­²­®±²¨ ·¨±«  3 ¥±²¼
[3] = f1; 3; 5; 7; : : : g. ±­®¢­®¥ ±¢®©±²¢® ª« ±±®¢ ½ª¢¨¢ «¥­²­®±²¨
±®±²®¨² ¢ ±«¥¤³¾¹¥¬:
¥®°¥¬  5.1 (²­®¸¥­¨¿ ½ª¢¨¢ «¥­²­®±²¨ ±®®²¢¥²±²¢³¾² ° §¡¨¥­¨¿¬).
«¿ «¾¡®£® ®²­®¸¥­¨¿ ½ª¢¨¢ «¥­²­®±²¨ ­  ¬­®¦¥±²¢¥ A ª« ±±»
½ª¢¨¢ «¥­²­®±²¨ ®¡° §³¾² ° §¡¨¥­¨¥ A.  ¯°®²¨¢, ¤«¿ «¾¡®£® ° §¡¨¥­¨¿ ¬­®¦¥±²¢  A ®²­®¸¥­¨¥ À¡»²¼ ¢ ®¤­®¬ ª« ±±¥Á
¿¢«¿¥²±¿ ®²­®¸¥­¨¥¬ ½ª¢¨¢ «¥­²­®±²¨.
®ª § ²¥«¼±²¢®. ²®¡» ¤®ª § ²¼ ¯¥°¢®¥ ³²¢¥°¦¤¥­¨¥, ­ ¤® ¯®ª § ²¼, ·²® ª« ±±» ½ª¢¨¢ «¥­²­®±²¨ ­¥¯³±²», ¯®¯ °­® ­¥ ¯¥°¥±¥ª ¾²±¿ ¨ ¢ ®¡º¥¤¨­¥­¨¨ ¤ ¾² ¢±¥ ¬­®¦¥±²¢® A. ® ±¢®©±²¢³ °¥´«¥ª±¨¢­®±²¨ a 2 [a], ¯®½²®¬³ ª« ±±» ­¥¯³±²» ¨ ¯®ª°»¢ ¾² ¢±¥ a.
®ª ¦¥¬, ·²® ¥±«¨ ª« ±±» [a] ¨ [b] ¯¥°¥±¥ª ¾²±¿, ²® ®­¨ ±®¢¯ ¤ ¾². ³±²¼ c | ¨µ ®¡¹¨© ½«¥¬¥­², ²®£¤  aRc, bRc, cRb (±¨¬¬¥²°¨·­®±²¼) ¨ aRb (²° ­§¨²¨¢­®±²¼). ¥¯¥°¼ ¢¨¤­®, ·²® [b]  [a]: ¥±«¨
x | ¯°®¨§¢®«¼­»© ½«¥¬¥­² b, ²® bRx ¨ ¯® ²° ­§¨²¨¢­®±²¨ aRx.
­ «®£¨·­®, [a]  [b] ¨ ¯®²®¬³ [a] = [b].
²®°®¥ ³²¢¥°¦¤¥­¨¥ ²¥®°¥¬» ±®¢±¥¬ ®·¥¢¨¤­®.
¨­ °­®¥ ®²­®¸¥­¨¥ R ­  ¬­®¦¥±²¢¥ A ­ §»¢ ¥²±¿  ­²¨±¨¬¬¥²°¨·­»¬, ¥±«¨
aRb ¨ bRa ¢«¥·¥² a = b:
 ¯°¨¬¥°, ®²­®¸¥­¨¥ À6Á ­  ­ ²³° «¼­»µ ·¨±« µ ¿¢«¿¥²±¿  ­²¨±¨¬¬¥²°¨·­»¬, ¯®±ª®«¼ª³ ¨§ a 6 b ¨ b 6 a ±«¥¤³¥² a = b. ¥´«¥ª±¨¢­®¥,  ­²¨±¨¬¬¥²°¨·­®¥ ¨ ²° ­§¨²¨¢­®¥ ®²­®¸¥­¨¥ ­ §»¢ ¥²±¿ ®²­®¸¥­¨¥¬ · ±²¨·­®£® ¯®°¿¤ª  (partial order), ¨ ¬­®¦¥±²¢®
¢¬¥±²¥ ± ² ª¨¬ ®²­®¸¥­¨¥¬ ­  ­¥¬ ­ §»¢ ¥²±¿ · ±²¨·­® ³¯®°¿¤®·¥­­»¬ ¬­®¦¥±²¢®¬ (partially ordered set).  ¯°¨¬¥°, ®²­®¸¥­¨¥

84

« ¢  5 ­®¦¥±²¢ 

À¡»²¼ ¯®²®¬ª®¬Á ­  ¬­®¦¥±²¢¥ «¾¤¥© ¿¢«¿¥²±¿ · ±²¨·­»¬ ¯®°¿¤ª®¬, ¥±«¨ ¬» ±·¨² ¥¬ ·¥«®¢¥ª  ±¢®¨¬ ¯®²®¬ª®¬.
 ±²¨·­® ³¯®°¿¤®·¥­­®¥ ¬­®¦¥±²¢®, ¤ ¦¥ ª®­¥·­®¥, ¬®¦¥² ­¥
¨¬¥²¼ ­ ¨¡®«¼¸¥£® ½«¥¬¥­²  | ² ª®£® ½«¥¬¥­²  x, ·²® yRx ¤«¿
«¾¡®£® ½«¥¬¥­²  y . «¥¤³¥² ° §«¨· ²¼ ¯®­¿²¨¿ ­ ¨¡®«¼¸¥£® ¨ ¬ ª±¨¬ «¼­®£® ½«¥¬¥­²®¢: ½«¥¬¥­² x ­ §»¢ ¥²±¿ ¬ ª±¨¬ «¼­»¬ (maximal), ¥±«¨ ­¥ ±³¹¥±²¢³¥² ¡®«¼¸¥£® ½«¥¬¥­² , ². ¥. ¥±«¨ ¨§ xRy ±«¥¤³¥² x = y .  ¯°¨¬¥°, ±°¥¤¨ ­¥±ª®«¼ª¨µ ª °²®­­»µ ª®°®¡®ª ¬®¦¥² ­¥ ¡»²¼ ­ ¨¡®«¼¸¥© (¢ ª®²®°³¾ ¯®¬¥¹ ¥²±¿ «¾¡ ¿ ¤°³£ ¿),
­® § ¢¥¤®¬® ¥±²¼ ®¤­  ¨«¨ ­¥±ª®«¼ª® ¬ ª±¨¬ «¼­»µ (ª®²®°»¥ ­¥
¢«¥§ ¾² ­¨ ¢ ®¤­³ ¤°³£³¾).
 ±²¨·­»© ¯®°¿¤®ª ­ §»¢ ¥²±¿ «¨­¥©­»¬ (total order, linear order), ¥±«¨ ¤«¿ «¾¡»µ ½«¥¬¥­²®¢ a ¨ b ¢»¯®«­¥­® «¨¡® aRb, «¨¡® bRa
(¨«¨ ®¡  | ²®£¤  ®­¨ ° ¢­» ¯® ±¢®©±²¢³  ­²¨±¨¬¬¥²°¨·­®±²¨).
 ¯°¨¬¥°, ®²­®¸¥­¨¥ À6Á­  ¬­®¦¥±²¢¥ ­ ²³° «¼­»µ ·¨±¥« ¿¢«¿¥²±¿ «¨­¥©­»¬ ¯®°¿¤ª®¬,   ®²­®¸¥­¨¥ À¡»²¼ ¯®²®¬ª®¬Á ­  ¬­®¦¥±²¢¥ «¾¤¥© | ­¥² (¬®¦­® ­ ©²¨ ¤¢³µ ·¥«®¢¥ª, ­¥ ¿¢«¿¾¹¨µ±¿
¯®²®¬ª ¬¨ ¤°³£ ¤°³£ ).
¯° ¦­¥­¨¿
5.2-1 ®ª § ²¼, ·²® ®²­®¸¥­¨¥ ÀÁ ­  ¬­®¦¥±²¢¥ ¢±¥µ ¯®¤¬­®¦¥±²¢ ¬­®¦¥±²¢  Z¿¢«¿¥²±¿ ®²­®¸¥­¨¥¬ · ±²¨·­®£®, ­® ­¥ «¨­¥©­®£® ¯®°¿¤ª .
®ª § ²¼, ·²® ¤«¿ «¾¡®£® ¯®«®¦¨²¥«¼­®£® n ®²­®¸¥­¨¥
a  b (mod n) ¿¢«¿¥²±¿ ®²­®¸¥­¨¥¬ ½ª¢¨¢ «¥­²­®±²¨ ­  ¬­®¦¥±²¢¥ . (®¢®°¿², ·²® a  b (mod n), ¥±«¨ ±³¹¥±²¢³¥² ¶¥«®¥ q , ¤«¿
ª®²®°®£® a;b = qn.) ª®«¼ª® ª« ±±®¢ ½ª¢¨¢ «¥­²­®±²¨ ¥±²¼ ³ ½²®£®
5.2-2

Z

®²­®¸¥­¨¿?
5.2-3 °¨¢¥¤¨²¥ ¯°¨¬¥° ®²­®¸¥­¨¿, ª®²®°®¥
 . °¥´«¥ª±¨¢­® ¨ ±¨¬¬¥²°¨·­®, ­® ­¥ ²° ­§¨²¨¢­®;
¡. °¥´«¥ª±¨¢­® ¨ ²° ­§¨²¨¢­®, ­® ­¥ ±¨¬¬¥²°¨·­®;
¢. ±¨¬¬¥²°¨·­® ¨ ²° ­§¨²¨¢­®, ­® ­¥ °¥´«¥ª±¨¢­®.
5.2-4 ³±²¼ S | ª®­¥·­®¥ ¬­®¦¥±²¢®, R | ®²­®¸¥­¨¥ ½ª¢¨¢ «¥­²­®±²¨ ­  S . ®ª ¦¨²¥, ·²® ¥±«¨ R  ­²¨±¨¬¬¥²°¨·­®, ·²® ¢±¥
ª« ±±» ½ª¢¨¢ «¥­²­®±²¨ ±®¤¥°¦ ² ¯® ®¤­®¬³ ½«¥¬¥­²³.

5.2-5 °®´¥±±®° ¤³¬ ¥², ·²® ¢±¿ª®¥ ±¨¬¬¥²°¨·­®¥ ¨ ²° ­§¨²¨¢­®¥ ®²­®¸¥­¨¥ °¥´«¥ª±¨¢­®, ¨ ¯°¥¤« £ ¥² ² ª®¥ ¤®ª § ²¥«¼±²¢®:
¨§ aRb ±«¥¤³¥² bRa ¯® ±¨¬¬¥²°¨·­®±²¨, ®²ª³¤  ±«¥¤³¥² aRa ¯®
²° ­§¨²¨¢­®±²¨. ° ¢¨«¼­® «¨ ½²® ¤®ª § ²¥«¼±²¢®?

³­ª¶¨¨

85

5.3. ³­ª¶¨¨
³±²¼ ¤ ­» ¤¢  ¬­®¦¥±²¢  A ¨ B . ³­ª¶¨¥© (function), ®²®¡° ¦ ¾¹¥© A ¢ B , ­ §»¢ ¥²±¿ ¡¨­ °­®¥ ®²­®¸¥­¨¥ f  A  B , ®¡« ¤ ¾¹¥¥ ² ª¨¬ ±¢®©±²¢®¬: ¤«¿ ª ¦¤®£® a 2 A ±³¹¥±²¢³¥² °®¢­®
®¤­® b 2 B , ¤«¿ ª®²®°®£® (a; b) 2 f . ­®¦¥±²¢® A ­ §»¢ ¥²±¿ ®¡« ±²¼¾ ®¯°¥¤¥«¥­¨¿ (domain) ´³­ª¶¨¨; ¤«¿ ¬­®¦¥±²¢  B ¢ °³±±ª®¬
¿§»ª¥ ­¥² ®¡¹¥¯°¨­¿²®£® ­ §¢ ­¨¿,   ¯®- ­£«¨©±ª¨ ®­® ­ §»¢ ¥²±¿
codomain.
®¦­® ±ª § ²¼, ·²® ´³­ª¶¨¿ f ±®¯®±² ¢«¿¥² ± ª ¦¤»¬ ½«¥¬¥­²®¬ ¬­®¦¥±²¢  A ­¥ª®²®°»© ½«¥¬¥­² ¬­®¦¥±²¢  B . ¤­®¬³ ½«¥¬¥­²³ ¬­®¦¥±²¢  A ¬®¦¥² ±®®²¢¥²±²¢®¢ ²¼ ²®«¼ª® ®¤¨­ ½«¥¬¥­²
¬­®¦¥±²¢  B , µ®²¿ ®¤¨­ ¨ ²®² ¦¥ ½«¥¬¥­² B ¬®¦¥² ±®®²¢¥²±²¢®¢ ²¼ ­¥±ª®«¼ª¨¬ ° §«¨·­»¬ ½«¥¬¥­² ¬ A.  ¯°¨¬¥°, ¡¨­ °­®¥ ®²­®¸¥­¨¥
f = f(a; b) : a 2 N ¨ b = a mod 2g
¬®¦­® ° ±±¬ ²°¨¢ ²¼ ª ª ´³­ª¶¨¾ f : N ! f0; 1g, ¯®±ª®«¼ª³ ¤«¿
ª ¦¤®£® ­ ²³° «¼­®£® ·¨±«  a ±³¹¥±²¢³¥² ¥¤¨­±²¢¥­­®¥ b 2 f0; 1g,
° ¢­®¥ a mod 2. ®¦­® § ¯¨± ²¼ f (0) = 0, f (1) = 1, f (2) = 0 ¨ ² ª
¤ «¥¥.  ¤°³£®© ±²®°®­», ®²­®¸¥­¨¥

g = f(a; b) : a; b 2 ¨ a + b ·¥²­®g
N

­¥ ¿¢«¿¥²±¿ ´³­ª¶¨¥©, ¯®±ª®«¼ª³ (­ ¯°¨¬¥°) ¯ °» (1; 3) ¨ (1; 5),
¯°¨­ ¤«¥¦ ¹¨¥ ½²®¬³ ®²­®¸¥­¨¾, ¨¬¥¾² ° ¢­»¥ ¯¥°¢»¥ ·«¥­»,
­® ° §­»¥ ¢²®°»¥.
±«¨ ¯ °  (a; b) ¯°¨­ ¤«¥¦¨² ®²­®¸¥­¨¾ f , ¿¢«¿¾¹¥¬³±¿ ´³­ª¶¨¥©, ²® £®¢®°¿², ·²® b ¿¢«¿¥²±¿ §­ ·¥­¨¥¬ (value) ´³­ª¶¨¨ ¤«¿
 °£³¬¥­²  (argument) a, ¨ ¯¨¸³² b = f (a). ²®¡» § ¤ ²¼ ´³­ª¶¨¾, ­ ¤® ³ª § ²¼ ¥¥ §­ ·¥­¨¥ ¤«¿ ª ¦¤®£®  °£³¬¥­² , ¯°¨­ ¤«¥¦ ¹¥£® ¥¥ ®¡« ±²¨ ®¯°¥¤¥«¥­¨¿.  ¯°¨¬¥°, ¬®¦­® § ¤ ²¼ ´³­ª¶¨¾
f : N ! N ´®°¬³«®© f (n) = 2n, ª®²®° ¿ ®§­ · ¥², ·²® f = f(n; 2n) :
n 2 Ng. ¢¥ ´³­ª¶¨¨ f; g : A ! B ±·¨² ¾²±¿ ° ¢­»¬¨ (equal), ¥±«¨
f (a) = g(a) ¤«¿ ¢±¥µ a 2 A. (¡° ²¨²¥ ¢­¨¬ ­¨¥, ·²® ± ´®°¬ «¼­®© ²®·ª¨ §°¥­¨¿ ¬» ±·¨² ¥¬ ´³­ª¶¨¨ f : A ! B1 ¨ g : A ! B2
° §«¨·­»¬¨ ¯°¨ B1 6= B2 , ¤ ¦¥ ¥±«¨ f (a) = g (a) ¯°¨ ¢±¥µ a!)
®­¥·­®© ¯®±«¥¤®¢ ²¥«¼­®±²¼¾ (nite sequence) ¤«¨­» n ­ §»¢ ¾² ´³­ª¶¨¾ f , ®¡« ±²¼ ®¯°¥¤¥«¥­¨¿ ª®²®°®© ¥±²¼ ¬­®¦¥±²¢®
f0; 1; 2; : : :; n;1g. ®­¥·­³¾ ¯®±«¥¤®¢ ²¥«¼­®±²¼ · ±²® § ¯¨±»¢ ¾²
ª ª ±¯¨±®ª ¥¥ §­ ·¥­¨©, ². ¥. ª ª hf (0); f (1); : : :; f (n ; 1)i. ¥±ª®­¥·­®© ¯®±«¥¤®¢ ²¥«¼­®±²¼¾ (innite sequence) ­ §»¢ ¥²±¿ ´³­ª¶¨¿,
®¡« ±²¼¾ ®¯°¥¤¥«¥­¨¿ ª®²®°®© ¿¢«¿¥²±¿ ¬­®¦¥±²¢® N ­ ²³° «¼­»µ
·¨±¥«.  ¯°¨¬¥°, ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¨¡®­ ··¨, § ¤ ­­ ¿ ³° ¢­¥­¨¥¬ (2.13), ¬®¦¥² ¡»²¼ § ¯¨± ­  ª ª h0; 1; 1; 2; 3; 5; 8; 13; 21; : : : i.

86

« ¢  5 ­®¦¥±²¢ 

±«¨ ®¡« ±²¼ ®¯°¥¤¥«¥­¨¿ ´³­ª¶¨¨ ¿¢«¿¥²±¿ ¤¥ª °²®¢»¬ ¯°®¨§¢¥¤¥­¨¥¬ ­¥±ª®«¼ª¨µ ¬­®¦¥±²¢ , ¬» ®¡»·­® ®¯³±ª ¥¬ ¤®¯®«­¨²¥«¼­»¥ ±ª®¡ª¨ ¢®ª°³£  °£³¬¥­²®¢.  ¯°¨¬¥°, ¥±«¨ f : A1  A2 
: : : An ! B , ¬» ¯¨¸¥¬ f (a1; a2; : : :; an) ¢¬¥±²® ¡®«¥¥ ´®°¬ «¼­®£®
f ((a1; a2; : : : ; an)).  ¦¤®¥ ¨§ ai ² ª¦¥ ­ §»¢ ¥²±¿  °£³¬¥­²®¬ (argument) ´³­ª¶¨¨ f , µ®²¿ ´®°¬ «¼­® ¥¥  °£³¬¥­²®¢ ±«¥¤®¢ «® ¡»
±·¨² ²¼ n-ª³ (a1; a2; : : :; an ).
±«¨ b = f (a) ¤«¿ ­¥ª®²®°®© ´³­ª¶¨¨ f : A ! B ¨ ­¥ª®²®°»µ
a 2 A, b 2 B , ²® ½«¥¬¥­² b ­ §»¢ ¾² ®¡° §®¬ (image) ½«¥¬¥­²  a.
«¿ ¯°®¨§¢®«¼­®£® ¯®¤¬­®¦¥±²¢  A0 ¬­®¦¥±²¢  A ¥£® ®¡° § f (A0)
®¯°¥¤¥«¿¾² ´®°¬³«®©

f (A0) = fb 2 B : b = f (a)¤«¿ ­¥ª®²®°®£® a 2 A0 g:
­®¦¥±²¢® §­ ·¥­¨© (range) ´³­ª¶¨¨ f ®¯°¥¤¥«¿¥²±¿ ª ª ®¡° §
®¡« ±²¨ ¥¥ ®¯°¥¤¥«¥­¨¿, ². ¥. ª ª f (A).  ¯°¨¬¥°, ¬­®¦¥±²¢® §­ ·¥­¨© ´³­ª¶¨¨ f : ! , ®¯°¥¤¥«¥­­®© ´®°¬³«®© f (n) = 2n, ¥±²¼
N

N

¬­®¦¥±²¢® ¢±¥µ ·¥²­»µ ­ ²³° «¼­»µ ·¨±¥«, ª®²®°®¥ ¬®¦­® § ¯¨± ²¼ ª ª f (N) = fm : m = 2n ¤«¿ ­¥ª®²®°®£® n 2 Ng.
³­ª¶¨¿ f : A ! B ­ §»¢ ¥²±¿ ±¾°º¥ª¶¨¥© (surjection), ¨«¨ ­ «®¦¥­¨¥¬, ¥±«¨ ¥¥ ®¡° § ±®¢¯ ¤ ¥² ± ¬­®¦¥±²¢®¬ B , ². ¥. ¢±¿ª¨©
½«¥¬¥­² b 2 B ¿¢«¿¥²±¿ ®¡° §®¬ ­¥ª®²®°®£® ½«¥¬¥­²  a 2 A.  ¯°¨¬¥°, ´³­ª¶¨¿ f : N ! N, § ¤ ­­ ¿ ´®°¬³«®© f (n) = bn=2c, ¿¢«¿¥²±¿ ±¾°º¥ª¶¨¥©. ³­ª¶¨¿ f (n) = 2n ­¥ ¡³¤¥² ±¾°º¥ª¶¨¥©, ¥±«¨
±·¨² ²¼, ·²® f : N ! N, ­® ¡³¤¥² ² ª®¢®©, ¥±«¨ ±·¨² ²¼ ¥¥ ®²®¡° ¦ ¾¹¥© ¬­®¦¥±²¢® ­ ²³° «¼­»µ ·¨±¥« ¢ ¬­®¦¥±²¢® ·¥²­»µ ­ ²³° «¼­»µ ·¨±¥«. ³­ª¶¨¾ f : A ! B , ¿¢«¿¾¹³¾±¿ ±¾°º¥ª¶¨¥©,
­ §»¢ ¾² ² ª¦¥ ®²®¡° ¦¥­¨¥¬ A ­  B (onto B ).
³­ª¶¨¿ f : A ! B ­ §»¢ ¥²±¿ ¨­º¥ª¶¨¥© (injection), ¨«¨ ¢«®¦¥­¨¥¬, ¥±«¨ ° §«¨·­»¬  °£³¬¥­² ¬ ±®®²¢¥²±²¢³¾² ° §«¨·­»¥
§­ ·¥­¨¿, ². ¥. ¥±«¨ f (a) 6= f (a0) ¯°¨ a 6= a0.  ¯°¨¬¥°, ´³­ª¶¨¿
f (n) = 2n ¿¢«¿¥²±¿ ¨­º¥ª¶¨¥© ¬­®¦¥±²¢  N ¢ ¬­®¦¥±²¢® N, ¯®±ª®«¼ª³ «¾¡®¥ ·¨±«® n ¿¢«¿¥²±¿ ®¡° §®¬ ± ¬®¥ ¡®«¼¸¥¥ ®¤­®£®
½«¥¬¥­²  (n=2, ¥±«¨ n ·¥²­®; ­¥·¥²­»¥ ·¨±«  ­¥ ¿¢«¿¾²±¿ ®¡° § ¬¨
­¨ª ª¨µ ½«¥¬¥­²®¢). ³­ª¶¨¿ f (n) = bn=2c ­¥ ¿¢«¿¥²±¿ ¨­º¥ª¶¨¥©,
² ª ª ª (­ ¯°¨¬¥°) f (2) = f (3) = 1.   ­£«¨©±ª®© «¨²¥° ²³°¥ ¤«¿
¨­º¥ª¶¨© ³¯®²°¥¡«¿¥²±¿ ² ª¦¥ ²¥°¬¨­ Àone-to-one functionÁ.
³­ª¶¨¿ f : A ! B ­ §»¢ ¥²±¿ ¡¨¥ª¶¨¥© (bijection), ¥±«¨ ®­  ®¤­®¢°¥¬¥­­® ¿¢«¿¥²±¿ ¨­º¥ª¶¨¥© ¨ ±¾°º¥ª¶¨¥©.  ¯°¨¬¥°, ´³­ª¶¨¿
f (n) = (;1)n dn=2e, ° ±±¬ ²°¨¢ ¥¬ ¿ ª ª ´³­ª¶¨¿, ®²®¡° ¦ ¾¹ ¿

³­ª¶¨¨
N

87

¢ Z, ¿¢«¿¥²±¿ ¡¨¥ª¶¨¥©:
0! 0
1 ! ;1
2! 1
3 ! ;2
4! 2
..
.

­º¥ª²¨¢­®±²¼ ®§­ · ¥², ·²® ­¨ª ª®© ½«¥¬¥­² ¬­®¦¥±²¢  Z ­¥
¿¢«¿¥²±¿ ®¡° §®¬ ¤¢³µ ° §­»µ ½«¥¬¥­²®¢ ¬­®¦¥±²¢  N. ¾°º¥ª²¨¢­®±²¼ ®§­ · ¥², ·²® ¢±¿ª¨© ½«¥¬¥­² ¬­®¦¥±²¢  Z¿¢«¿¥²±¿ ®¡° §®¬ µ®²¿ ¡» ®¤­®£® ½«¥¬¥­²  ¬­®¦¥±²¢  N. ¨¥ª¶¨¨ ­ §»¢ ¾² ² ª¦¥ ¢§ ¨¬­® ®¤­®§­ ·­»¬¨ ±®®²¢¥²±²¢¨¿¬¨ (one-to-one correspondence), ¯®±ª®«¼ª³ ®­¨ ³±² ­ ¢«¨¢ ¾² ±®®²¢¥²±²¢¨¿ ¬¥¦¤³ ½«¥¬¥­² ¬¨ ¬­®¦¥±²¢ A ¨ B . ¨¥ª²¨¢­ ¿ ´³­ª¶¨¿, ®²®¡° ¦ ¾¹ ¿ ¬­®¦¥±²¢® A ¢ ±¥¡¿, ­ §»¢ ¥²±¿ ¯¥°¥±² ­®¢ª®© (permutation) ¬­®¦¥±²¢  A.
±«¨ ´³­ª¶¨¿ f ¡¨¥ª²¨¢­ , ¬®¦­® ®¯°¥¤¥«¨²¼ ®¡° ²­³¾ (inverse)
´³­ª¶¨¾ f ;1 ±®®²­®¸¥­¨¥¬

f ;1 (b) = a ²®£¤  ¨ ²®«¼ª® ²®£¤ , ª®£¤  f (a) = b:
 ¯°¨¬¥°, ¤«¿ ° ±±¬®²°¥­­®© ¢»¸¥ ´³­ª¶¨¨ f (n) = (;1)n dn=2e
®¡° ²­ ¿ ´³­ª¶¨¿ ¢»·¨±«¿¥²±¿ ¯® ´®°¬³«¥

f ;1 (m) =

(

2m;
¥±«¨ m > 0,
;2m ; 1; ¥±«¨ m < 0.

¯° ¦­¥­¨¿
5.3-1 ³±²¼ A ¨ B | ª®­¥·­»¥ ¬­®¦¥±²¢ , ¨ f : A ! B | ­¥ª®²®° ¿ ´³­ª¶¨¿. ®ª ¦¨²¥, ·²®
 . ¥±«¨ f | ¨­º¥ª¶¨¿, ²® jAj 6 jB j;
¡. ¥±«¨ f | ±¾°º¥ª¶¨¿, ²® jAj > jB j.
5.3-2 ³¤¥² «¨ ¡¨¥ª¶¨¥© ´³­ª¶¨¿ f : N ! N, § ¤ ­­ ¿ ´®°¬³«®©
f (x) = x + 1? ®² ¦¥ ¢®¯°®± ¤«¿ ´³­ª¶¨¨ Z! Z, § ¤ ­­®© ²®© ¦¥
´®°¬³«®©.
5.3-3  ©²¥ ®¯°¥¤¥«¥­¨¥ ®¡° ²­®£® ª ¡¨­ °­®¬³ ®²­®¸¥­¨¾.
(±«¨ ®²­®¸¥­¨¥ ¿¢«¿¥²±¿ ¡¨¥ª¶¨¥©, ²® ®¯°¥¤¥«¥­¨¥ ¤®«¦­® ¤ ¢ ²¼
®¡° ²­³¾ ¡¨¥ª¶¨¾ ¢ ®¯¨± ­­®¬ ¢»¸¥ ±¬»±«¥.)
5.3-4? ®±²°®©²¥ ¡¨¥ª¶¨¾ f : Z! Z Z.

88

« ¢  5 ­®¦¥±²¢ 

5.2 °¨¥­²¨°®¢ ­­»¥
¨ ­¥®°¨¥­²¨°®¢ ­­»¥ £° ´». ( ) °¨¥­²¨°®¢ ­­»© £° ´ (V; E ), £¤¥ V
= f1; 2; 3; 4; 5; 6g ¨ E =
f(1; 2); (2; 2); (2; 4); (2; 5); (4; 1); (4; 5); (5; 4); (6; 3)g. ¥¡°® (2; 2) ¿¢«¿¥²±¿ °¥¡°®¬¶¨ª«®¬. (¡) ¥®°¨¥­²¨°®¢ ­­»© £° ´ G = (V; E ), £¤¥ V = f1; 2; 3; 4; 5; 6g ¨
E = f(1; 2); (1; 5); (2; 5); (3; 6)g. ¥°¸¨­  4 ¿¢«¿¥²±¿ ¨§®«¨°®¢ ­­®© (­¥ ¨¬¥¥²
±¬¥¦­»µ ¢¥°¸¨­). (¢) ®¤£° ´ £° ´  ( ), ¯®«³· ¾¹¨©±¿ ¥£® ®£° ­¨·¥­¨¥¬ ­ 
¬­®¦¥±²¢® ¢¥°¸¨­ f1; 2; 3; 6g.
¨±.

5.4. ° ´»
 ½²®¬ ° §¤¥«¥ ¬» ° ±±¬®²°¨¬ ®±­®¢­»¥ ¯®­¿²¨¿, ±¢¿§ ­­»¥
± ®°¨¥­²¨°®¢ ­­»¬¨ ¨ ­¥®°¨¥­²¨°®¢ ­­»¬¨ £° ´ ¬¨. «¥¤³¥²
¨¬¥²¼ ¢ ¢¨¤³, ·²® ²¥°¬¨­®«®£¨¿ §¤¥±¼ ­¥ ¢¯®«­¥ ³±²®¿« ±¼ ¨ ¢ ° §­»µ ª­¨£ µ ¬®¦­® ¢±²°¥²¨²¼ ° §­»¥ ®¯°¥¤¥«¥­¨¿, ­® ¯® ¡®«¼¸¥©
· ±²¨ ° §«¨·¨¿ ­¥¢¥«¨ª¨. » ¢¥°­¥¬±¿ ª £° ´ ¬ ¢ £« ¢¥ 23, £¤¥
° ±±¬ ²°¨¢ ¾²±¿ ° §«¨·­»¥  «£®°¨²¬» ­  £° ´ µ.
°¨¥­²¨°®¢ ­­»© £° ´ (directed graph) ®¯°¥¤¥«¿¥²±¿ ª ª ¯ ° 
(V; E ), £¤¥ V | ª®­¥·­®¥ ¬­®¦¥±²¢®,   E | ¡¨­ °­®¥ ®²­®¸¥­¨¥ ­  V , ². ¥. ¯®¤¬­®¦¥±²¢® ¬­®¦¥±²¢  V  V . °¨¥­²¨°®¢ ­­»©
£° ´ ¨­®£¤  ¤«¿ ª° ²ª®±²¨ ­ §»¢ ¾² ®°£° ´®¬ (digraph). ­®¦¥±²¢® V ­ §»¢ ¾² ¬­®¦¥±²¢®¬ ¢¥°¸¨­ £° ´  (vertex set); ¥£®
½«¥¬¥­² ­ §»¢ ¾² ¢¥°¸¨­®© £° ´  (vertex; ¬­®¦¥±²¢¥­­®¥ ·¨±«®
vertices). ­®¦¥±²¢® E ­ §»¢ ¾² ¬­®¦¥±²¢®¬ °¥¡¥° (edge set) £° ´ ; ¥£® ½«¥¬¥­²» ­ §»¢ ¾² °¥¡° ¬¨ (edges).   °¨±³­ª¥ 5.2 ( ) ¯®ª § ­ ®°¨¥­²¨°®¢ ­­»© £° ´ ± ¬­®¦¥±²¢®¬ ¢¥°¸¨­ f1; 2; 3; 4; 5; 6g.
¥°¸¨­» ¨§®¡° ¦¥­» ª°³¦ª ¬¨,   °¥¡°  | ±²°¥«ª ¬¨.  ¬¥²¨¬,
·²® £° ´ ¬®¦¥² ±®¤¥°¦ ²¼ °¥¡° -¶¨ª«» (self-loops), ±®¥¤¨­¿¾¹¨¥
¢¥°¸¨­³ ± ±®¡®©.
 ­¥®°¨¥­²¨°®¢ ­­®¬ (undirected) £° ´¥ G = (V; E ) ¬­®¦¥±²¢®
°¥¡¥° (V ) ±®±²®¨² ¨§ ­¥³¯®°¿¤®·¥­­»µ (unordered) ¯ ° ¢¥°¸¨­:
¯ ° ¬¨ ¿¢«¿¾²±¿ ¬­®¦¥±²¢  fu; v g, £¤¥ u; v 2 V ¨ u 6= v . » ¡³¤¥¬ ®¡®§­ · ²¼ ­¥®°¨¥­²¨°®¢ ­­®¥ °¥¡°® ª ª (u; v ) ¢¬¥±²® fu; v g;
¯°¨ ½²®¬ ¤«¿ ­¥®°¨¥­²¨°®¢ ­­®£® £° ´  (u; v ) ¨ (v; u) ®¡®§­ · ¾²
®¤­® ¨ ²® ¦¥ °¥¡°®. ¥®°¨¥­²¨°®¢ ­­»© £° ´ ­¥ ¬®¦¥² ±®¤¥°¦ ²¼ °¥¡¥°-¶¨ª«®¢, ¨ ª ¦¤®¥ °¥¡°® ±®±²®¨² ¨§ ¤¢³µ ° §«¨·­»µ
¢¥°¸¨­ (À±®¥¤¨­¿¿Á ¨µ).   °¨±. 5.2 (¡) ¨§®¡° ¦¥­ ­¥®°¨¥­²¨°®¢ ­­»© £° ´ ± ¬­®¦¥±²¢®¬ ¢¥°¸¨­ f1; 2; 3; 4; 5; 6g.

° ´»

89

­®£¨¥ ¯®­¿²¨¿ ¯ ° ««¥«¼­® ®¯°¥¤¥«¿¾²±¿ ¤«¿ ®°¨¥­²¨°®¢ ­­»µ ¨ ­¥®°¨¥­²¨°®¢ ­­»µ £° ´®¢ (± ±®®²¢¥²±²¢³¾¹¨¬¨ ¨§¬¥­¥­¨¿¬¨). °® °¥¡°® (u; v ) ®°¨¥­²¨°®¢ ­­®£® £° ´  £®¢®°¿², ·²® ®­®
¢»µ®¤¨² ¨§ (incident from, leaves) ¢¥°¸¨­» u ¨ ¢µ®¤¨² (incident to,
enters) ¢ ¢¥°¸¨­³ v .  ¯°¨¬¥°, ­  °¨±. 5.2 ( ) ¨¬¥¥²±¿ ²°¨ °¥¡° ,
¢»µ®¤¿¹¨µ ¨§ ¢¥°¸¨­» 2 ((2; 2); (2; 4); (2; 5)) ¨ ¤¢  °¥¡° , ¢ ­¥¥
¢µ®¤¿¹¨µ ((1; 2); (2; 2)). °® °¥¡°® (u; v ) ­¥®°¨¥­²¨°®¢ ­­®£® £° ´  £®¢®°¿², ·²® ®­® ¨­¶¨¤¥­²­® ¢¥°¸¨­ ¬ (incident on vertices) u ¨
v.  ¯°¨¬¥°, ­  °¨±. 2.5 (¡) ¥±²¼ ¤¢  °¥¡° , ¨­¶¨¤¥­²­»¥ ¢¥°¸¨­¥ 2
(°¥¡°  (1; 2) ¨ (2; 5)).
±«¨ ¢ £° ´¥ G ¨¬¥¥²±¿ °¥¡°® (u; v ), £®¢®°¿², ·²® ¢¥°¸¨­  v
±¬¥¦­  ± ¢¥°¸¨­®© u (is adjacent to u). «¿ ­¥®°¨¥­²¨°®¢ ­­»µ
£° ´®¢ ®²­®¸¥­¨¥ ±¬¥¦­®±²¨ ¿¢«¿¥²±¿ ±¨¬¬¥²°¨·­»¬, ­® ¤«¿ ®°¨¥­²¨°®¢ ­­»µ £° ´®¢ ½²® ­¥ ®¡¿§ ²¥«¼­®. ±«¨ ¢¥°¸¨­  v ±¬¥¦­ 
± ¢¥°¸¨­®© u ¢ ®°¨¥­²¨°®¢ ­­®¬ £° ´¥, ¯¨¸³² u ! v . «¿ ®¡®¨µ
°¨±³­ª®¢ 5.2 ( ) ¨ 5.2 (¡) ¢¥°¸¨­  2 ¿¢«¿¥²±¿ ±¬¥¦­®© ± ¢¥°¸¨­®© 1, ­® «¨¸¼ ¢® ¢²®°®¬ ¨§ ­¨µ ¢¥°¸¨­  1 ±¬¥¦­  ± ¢¥°¸¨­®© 2
(¢ ¯¥°¢®¬ ±«³· ¥ °¥¡°® (2; 1) ®²±³²±²¢³¥² ¢ £° ´¥).
²¥¯¥­¼¾ (degree) ¢¥°¸¨­» ¢ ­¥®°¨¥­²¨°®¢ ­­®¬ £° ´¥ ­ §»¢ ¥²±¿ ·¨±«® ¨­¶¨¤¥­²­»µ ¥© °¥¡¥°.  ¯°¨¬¥°, ¤«¿ £° ´  °¨±. 5.2 (¡)
±²¥¯¥­¼ ¢¥°¸¨­» 2 ° ¢­  2. «¿ ®°¨¥­²¨°®¢ ­­®£® £° ´  ° §«¨· ¾² ¨±µ®¤¿¹³¾ ±²¥¯¥­¼ (out-degree), ®¯°¥¤¥«¿¥¬³¾ ª ª ·¨±«® ¢»µ®¤¿¹¨µ ¨§ ­¥¥ °¥¡¥°, ¨ ¢µ®¤¿¹³¾ ±²¥¯¥­¼ (in-degree), ®¯°¥¤¥«¿¥¬³¾
ª ª ·¨±«® ¢µ®¤¿¹¨µ ¢ ­¥¥ °¥¡¥°. ³¬¬  ¨±µ®¤¿¹¥© ¨ ¢µ®¤¿¹¥© ±²¥¯¥­¥© ­ §»¢ ¥²±¿ ±²¥¯¥­¼¾ (degree) ¢¥°¸¨­».  ¯°¨¬¥°, ¢¥°¸¨­  2 ¢ £° ´¥ °¨±. 5.2 ( ) ¨¬¥¥² ¢µ®¤¿¹³¾ ±²¥¯¥­¼ 2, ¨±µ®¤¿¹³¾
±²¥¯¥­¼ 3 ¨ ±²¥¯¥­¼ 5.
³²¼ ¤«¨­» k (path of length k) ¨§ ¢¥°¸¨­» u ¢ ¢¥°¸¨­³ v ®¯°¥¤¥«¿¥²±¿ ª ª ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¢¥°¸¨­ hv0 ; v1; v2; : : :; vk i, ¢ ª®²®°®©
v0 = u, vk = v ¨ (vi;1 ; vi) 2 E ¤«¿ ¢±¥µ i = 1; 2; : : :; k.  ª¨¬ ®¡° §®¬, ¯³²¼ ¤«¨­» k ±®±²®¨² ¨§ k °¥¡¥°. ²®² ¯³²¼ ±®¤¥°¦¨² (contains) ¢¥°¸¨­» v0 ; v1; : : :; vk ¨ °¥¡°  (v0 ; v1); (v1; v2); : : :; (vk;1; vk ).
¥°¸¨­³ v0 ­ §»¢ ¾² ­ · «®¬ ¯³²¨, ¢¥°¸¨­³ vk | ¥£® ª®­¶®¬;
£®¢®°¿², ·²® ¯³²¼ ¢¥¤¥² ¨§ v0 ¢ vk . ±«¨ ¤«¿ ¤ ­­»µ ¢¥°¸¨­ u ¨ u0
±³¹¥±²¢³¥² ¯³²¼ p ¨§ u ¢ u0 , ²® £®¢®°¿², ·²® ¢¥°¸¨­  u0 ¤®±²¨¦¨¬  ¨§ u ¯® ¯³²¨ p (u0 is reachable from u via p).  ½²®¬ ±«³· ¥ ¬»
¯¨¸¥¬ (¤«¿ ®°¨¥­²¨°®¢ ­­»µ £° ´®¢) u p u0 .
³²¼ ­ §»¢ ¥²±¿ ¯°®±²»¬ (simple), ¥±«¨ ¢±¥ ¢¥°¸¨­» ¢ ­¥¬ ° §«¨·­».  ¯°¨¬¥°, ­  °¨±. 5.2 ( ) ¥±²¼ ¯°®±²®© ¯³²¼ h1; 2; 5; 4i ¤«¨­» 3,   ² ª¦¥ ¯³²¼ h2; 5; 4; 5i ²®© ¦¥ ¤«¨­», ­¥ ¿¢«¿¾¹¨©±¿ ¯°®±²»¬.
®¤¯³²¼ (subpath) ¯³²¨ p = hv0; v1; : : :; vk i ¯®«³·¨²±¿, ¥±«¨ ¬»
¢®§¼¬¥¬ ­¥ª®²®°®¥ ·¨±«® ¨¤³¹¨µ ¯®¤°¿¤ ¢¥°¸¨­ ½²®£® ¯³²¨, ². ¥.
¯®±«¥¤®¢ ²¥«¼­®±²¼ hvi ; vi+1; : : :; vj i ¯°¨ ­¥ª®²®°»µ i; j , ¤«¿ ª®²®°»µ 0 6 i 6 j 6 k.

90

« ¢  5 ­®¦¥±²¢ 

¨ª«®¬ (cycle) ¢ ®°¨¥­²¨°®¢ ­­®¬ £° ´¥ ­ §»¢ ¥²±¿ ¯³²¼, ¢ ª®²®°®¬ ­ · «¼­ ¿ ¢¥°¸¨­  ±®¢¯ ¤ ¥² ± ª®­¥·­®© ¨ ª®²®°»© ±®¤¥°¦¨² µ®²¿ ¡» ®¤­® °¥¡°®. ¨ª« hv0 ; v1; : : :; vk i ­ §»¢ ¥²±¿ ¯°®±²»¬,
¥±«¨ ¢ ­¥¬ ­¥² ®¤¨­ ª®¢»µ ¢¥°¸¨­ (ª°®¬¥ ¯¥°¢®© ¨ ¯®±«¥¤­¥©),
². ¥. ¥±«¨ ¢±¥ ¢¥°¸¨­» v1 ; v2; : : :; vk ° §«¨·­». ¥¡°®-¶¨ª« ¿¢«¿¥²±¿
¶¨ª«®¬ ¤«¨­» 1. » ®²®¦¤¥±²¢«¿¥¬ ¶¨ª«», ®²«¨· ¾¹¨¥±¿ ±¤¢¨£®¬ ¢¤®«¼ ¶¨ª« : ®¤¨­ ¨ ²®² ¦¥ ¶¨ª« ¤«¨­» k ¬®¦¥² ¡»²¼ ¯°¥¤±² ¢«¥­ k ° §«¨·­»¬¨ ¯³²¿¬¨ (¢ ª ·¥±²¢¥ ­ · «  ¨ ª®­¶  ¬®¦­®
¢§¿²¼ «¾¡³¾ ¨§ k ¢¥°¸¨­).  ¯°¨¬¥°, ­  °¨±. 5.2 ( ) ¯³²¨ h1; 2; 4; 1i,
h2; 4; 1; 2i ¨ h4; 1; 2; 4i ¯°¥¤±² ¢«¿¾² ®¤¨­ ¨ ²®² ¦¥ ¶¨ª«. ²®² ¶¨ª«
¿¢«¿¥²±¿ ¯°®±²»¬, ¢ ²® ¢°¥¬¿ ª ª ¶¨ª« h1; 2; 4; 5; 4; 1i ² ª®¢»¬ ­¥
¿¢«¿¥²±¿.   ²®¬ ¦¥ °¨±³­ª¥ ¥±²¼ ¶¨ª« h2; 2i, ®¡° §®¢ ­­»© ¥¤¨­±²¢¥­­»¬ °¥¡°®¬-¶¨ª«®¬ (2; 2). °¨¥­²¨°®¢ ­­»© £° ´, ­¥ ±®¤¥°¦ ¹¨© °¥¡¥°-¶¨ª«®¢, ­ §»¢ ¥²±¿ ¯°®±²»¬ (simple).
 ­¥®°¨¥­²¨°®¢ ­­®¬ £° ´¥ ¯³²¼ hv0; v1; : : :; vk i ­ §»¢ ¥²±¿ (¯°®±²»¬) ¶¨ª«®¬, ¥±«¨ k > 3, v0 = vk ¨ ¢±¥ ¢¥°¸¨­»
v1 ; v2; : : :; vk ° §«¨·­».  ¯°¨¬¥°, ­  °¨±. 5.2 (¡) ¨¬¥¥²±¿ ¯°®±²®© ¶¨ª« h1; 2; 5; 1i.
° ´, ¢ ª®²®°®¬ ­¥² ¶¨ª«®¢, ­ §»¢ ¥²±¿  ¶¨ª«¨·¥±ª¨¬ (acyclic).
¥®°¨¥­²¨°®¢ ­­»© £° ´ ­ §»¢ ¥²±¿ ±¢¿§­»¬ (connected), ¥±«¨ ¤«¿ «¾¡®© ¯ °» ¢¥°¸¨­ ±³¹¥±²¢³¥² ¯³²¼ ¨§ ®¤­®© ¢ ¤°³£³¾. «¿ ­¥®°¨¥­²¨°®¢ ­­®£® £° ´  ®²­®¸¥­¨¥ À¡»²¼ ¤®±²¨¦¨¬»¬ ¨§Á ¿¢«¿¥²±¿ ®²­®¸¥­¨¥¬ ½ª¢¨¢ «¥­²­®±²¨ ­  ¬­®¦¥±²¢¥ ¢¥°¸¨­. « ±±» ½ª¢¨¢ «¥­²­®±²¨ ­ §»¢ ¾²±¿ ±¢¿§­»¬¨ ª®¬¯®­¥­² ¬¨ (connected components) £° ´ .  ¯°¨¬¥°, ­  °¨±. 5.2 (¡) ¨¬¥¾²±¿ ²°¨ ±¢¿§­»¥ ª®¬¯®­¥­²»: f1; 2; 5g, f3; 6g ¨ f4g. ¥®°¨¥­²¨°®¢ ­­»© £° ´ ±¢¿§¥­ ²®£¤  ¨ ²®«¼ª® ²®£¤ , ª®£¤  ®­ ±®±²®¨² ¨§
¥¤¨­±²¢¥­­®© ±¢¿§­®© ª®¬¯®­¥­²».
°¨¥­²¨°®¢ ­­»© £° ´ ­ §»¢ ¥²±¿ ±¨«¼­® ±¢¿§­»¬ (strongly
connected), ¥±«¨ ¨§ «¾¡®© ¥£® ¢¥°¸¨­» ¤®±²¨¦¨¬  (¯® ®°¨¥­²¨°®¢ ­­»¬ ¯³²¿¬) «¾¡ ¿ ¤°³£ ¿. ¾¡®© ®°¨¥­²¨°®¢ ­­»© £° ´ ¬®¦­® ° §¡¨²¼ ­  ±¨«¼­® ±¢¿§­»¥ ª®¬¯®­¥­²» (strongly connected components), ª®²®°»¥ ®¯°¥¤¥«¿¾²±¿ ª ª ª« ±±» ½ª¢¨¢ «¥­²­®±²¨ ®²­®¸¥­¨¿ Àu ¤®±²¨¦¨¬® ¨§ v ¨ v ¤®±²¨¦¨¬® ¨§ uÁ. °¨¥­²¨°®¢ ­­»©
£° ´ ±¨«¼­® ±¢¿§¥­ ²®£¤  ¨ ²®«¼ª® ²®£¤ , ª®£¤  ±®±²®¨² ¨§ ¥¤¨­±²¢¥­­®© ±¨«¼­® ±¢¿§­®© ª®¬¯®­¥­²». ° ´ °¨±. 5.2 ( ) ¨¬¥¥² ²°¨
² ª¨µ ª®¬¯®­¥­²»: f1; 2; 4; 5g, f3g ¨ f6g.  ¬¥²¨¬, ·²® ¢¥°¸¨­»
f3; 6g ­¥ ¢µ®¤¿² ¢ ®¤­³ ±¨«¼­® ±¢¿§­³¾ ª®¬¯®­¥­²³, ² ª ª ª 3 ¤®±²¨¦¨¬  ¨§ 6, ­® ­¥ ­ ®¡®°®².
¢  £° ´  G = (V; E ) ¨ G0 = (V 0 ; E 0) ­ §»¢ ¾²±¿ ¨§®¬®°´­»¬¨
(isomorphic), ¥±«¨ ±³¹¥±²¢³¥² ¢§ ¨¬­® ®¤­®§­ ·­®¥ ±®®²¢¥²±²¢¨¥
f : V ! V 0 ¬¥¦¤³ ¬­®¦¥±²¢ ¬¨ ¨µ ¢¥°¸¨­, ¯°¨ ª®²®°®¬ °¥¡° ¬
®¤­®£® £° ´  ±®®²¢¥²±²¢³¾² °¥¡°  ¤°³£®£®: (u; v ) 2 E ²®£¤  ¨
²®«¼ª® ²®£¤ , ª®£¤  (f (u); f (v )) 2 E 0. ®¦­® ±ª § ²¼, ·²® ¨§®¬®°´­»¥ £° ´» | ½²® ®¤¨­ ¨ ²®² ¦¥ £° ´, ¢ ª®²®°®¬ ¢¥°¸¨­»
­ §¢ ­» ¯®-° §­®¬³.   °¨±. 5.3 ( ) ¯°¨¢¥¤¥­ ¯°¨¬¥° ¤¢³µ ¨§®-

° ´»

91

( )  °  ¨§®¬®°´­»µ £° ´®¢. (¡) ¥¨§®¬®°´­»¥ £° ´»: ¢¥°µ­¨© ¨¬¥¥² ¢¥°¸¨­³ ±²¥¯¥­¨ 4,   ­¨¦­¨© | ­¥².
¨±. 5.3

¬®°´­»µ £° ´®¢ G ¨ G0 ± ¬­®¦¥±²¢ ¬¨ ¢¥°¸¨­ V = f1; 2; 3; 4; 5; 6g
¨ V 0 = fu; v; w; x; y; z g. ³­ª¶¨¿ f : V ! V 0 , ¤«¿ ª®²®°®© f (1) = u,
f (2) = v , f (3) = w, f (4) = x, f (5) = y , f (6) = z, ¿¢«¿¥²±¿ ¨§®¬®°´¨§¬®¬.  ¯°®²¨¢, £° ´» ­  °¨±. 5.3 (¡) ­¥ ¨§®¬®°´­», µ®²¿ ®¡ 
¨¬¥¾² ¯® 5 ¢¥°¸¨­ ¨ ¯® 7 °¥¡¥°. ²®¡» ³¡¥¤¨²¼±¿, ·²® ®­¨ ­¥ ¨§®¬®°´­», ¤®±² ²®·­® ®²¬¥²¨²¼, ·²® ¢ ¢¥°µ­¥¬ £° ´¥ ¥±²¼ ¢¥°¸¨­ 
±²¥¯¥­¨ 4,   ¢ ­¨¦­¥¬ | ­¥².
° ´ G0 = (E 0; V 0 ) ­ §»¢ ¾² ¯®¤£° ´®¬ (subgraph) £° ´  G =
(E; V ), ¥±«¨ E 0  E ¨ V 0  V . ±«¨ ¢ £° ´¥ G = (E; V ) ¢»¡° ²¼
¯°®¨§¢®«¼­®¥ ¬­®¦¥±²¢® ¢¥°¸¨­ V 0 , ²® ¬®¦­® ° ±±¬®²°¥²¼ ¥£®
¯®¤£° ´, ±®±²®¿¹¨© ¨§ ½²¨µ ¢¥°¸¨­ ¨ ¢±¥µ ±®¥¤¨­¿¾¹¨µ ¨µ °¥¡¥°,
². ¥. £° ´ G0 = (E 0; V 0 ), ¤«¿ ª®²®°®£®

E 0 = f(u; v ) 2 E : u; v 2 V 0 g
²®² ¯®¤£° ´ ¬®¦­® ­ §¢ ²¼ ®£° ­¨·¥­¨¥¬ £° ´  G ­  ¬­®¦¥±²¢® ¢¥°¸¨­ V 0 (subgraph of G induced by V 0 ). £° ­¨·¥­¨¥ £° ´ 
°¨±. 5.2 ( ) ­  ¬­®¦¥±²¢® ¢¥°¸¨­ f1; 2; 3; 6g ¯®ª § ­® ­  °¨±. 5.2 (¢)
¨ ¨¬¥¥² ²°¨ °¥¡°  (1; 2), (2; 2), (6; 3).
«¿ «¾¡®£® ­¥®°¨¥­²¨°®¢ ­­®£® £° ´  G ¬®¦­® ° ±±¬®²°¥²¼
¥£® ®°¨¥­²¨°®¢ ­­»© ¢ °¨ ­² (directed version), § ¬¥­¨¢ ª ¦¤®¥
­¥®°¨¥­²¨°®¢ ­­®¥ °¥¡°® fu; v g ­  ¯ °³ ®°¨¥­²¨°®¢ ­­»µ °¥¡¥°
(u; v ) ¨ (v; u), ¨¤³¹¨µ ¢ ¯°®²¨¢®¯®«®¦­»µ ­ ¯° ¢«¥­¨¿µ.  ¤°³£®© ±²®°®­», ¤«¿ ª ¦¤®£® ®°¨¥­²¨°®¢ ­­®£® £° ´  ¬®¦­® ° ±±¬®²°¥²¼ ¥£® ­¥®°¨¥­²¨°®¢ ­­»© ¢ °¨ ­² (undirected version), § ¡»¢
¯°® ®°¨¥­² ¶¨¾ °¥¡¥°, ³¤ «¨¢ °¥¡° -¶¨ª«» ¨ ±®¥¤¨­¨¢ °¥¡°  (u; v )
¨ (v; u) ¢ ®¤­® ­¥®°¨¥­²¨°®¢ ­­®¥ °¥¡°® fu; v g.  ®°¨¥­²¨°®¢ ­­®¬
£° ´¥ ±®±¥¤®¬ (neighbor) ¢¥°¸¨­» u ­ §»¢ ¾² «¾¡³¾ ¢¥°¸¨­³, ±®¥¤¨­¥­­³¾ ± ­¥© °¥¡°®¬ (¢ ²³ ¨«¨ ¤°³£³¾ ±²®°®­³); ² ª¨¬ ®¡° §®¬,
v ¿¢«¿¥²±¿ ±®±¥¤®¬ u ²®£¤  ¨ ²®«¼ª® ²®£¤ , ª®£¤  v ±¬¥¦­® u ¨«¨

92

« ¢  5 ­®¦¥±²¢ 

u ±¬¥¦­® v. «¿ ­¥®°¨¥­²¨°®¢ ­­®£® £° ´  ¢»° ¦¥­¨¿ Àv | ±®±¥¤
uÁ ¨ Àv ±¬¥¦­  ± uÁ ¿¢«¿¾²±¿ ±¨­®­¨¬ ¬¨.

¥ª®²®°»¥ ¢¨¤» £° ´®¢ ¨¬¥¾² ±¯¥¶¨ «¼­»¥ ­ §¢ ­¨¿. ®«­»¬
(complete) £° ´®¬ ­ §»¢ ¾² ­¥®°¨¥­²¨°®¢ ­­»© £° ´, ±®¤¥°¦ ¹¨© ¢±¥ ¢®§¬®¦­»¥ °¥¡°  ¤«¿ ¤ ­­®£® ¬­®¦¥±²¢  ¢¥°¸¨­ («¾¡ ¿
¢¥°¸¨­  ±¬¥¦­  «¾¡®© ¤°³£®©). ¥®°¨¥­²¨°®¢ ­­»© £° ´ (V; E )
­ §»¢ ¾² ¤¢³¤®«¼­»¬ (bipartite), ¥±«¨ ¬­®¦¥±²¢® ¢¥°¸¨­ V ¬®¦­® ° §¡¨²¼ ­  ¤¢¥ · ±²¼ V1 ¨ V2 ² ª¨¬ ®¡° §®¬, ·²® ª®­¶» «¾¡®£® °¥¡°  ®ª §»¢ ¾²±¿ ¢ ° §­»µ · ±²¿µ. ¶¨ª«¨·¥±ª¨© ­¥®°¨¥­²¨°®¢ ­­»© £° ´ ­ §»¢ ¾² «¥±®¬ (forest),   ±¢¿§­»©  ¶¨ª«¨·¥±ª¨© ­¥®°¨¥­²¨°®¢ ­­»© £° ´ ­ §»¢ ¾² ¤¥°¥¢®¬ (¡¥§ ¢»¤¥«¥­­®£® ª®°­¿; ¯®¤°®¡­® ¤¥°¥¢¼¿ ° ±±¬ ²°¨¢ ¾²±¿ ¢ ±«¥¤³¾¹¥¬ ° §¤¥«¥). ®- ­£«¨©±ª¨ ¤¥°¥¢® ¡¥§ ¢»¤¥«¥­­®£® ª®°­¿ ­ §»¢ ¥²±¿ free
tree. °¨¥­²¨°®¢ ­­»©  ¶¨ª«¨·¥±ª¨© £° ´ (directed acyclic graph)
¯®- ­£«¨©±ª¨ · ±²® ±®ª° ¹ ¾² ¤® ÀdagÁ (¯® ¯¥°¢»¬ ¡³ª¢ ¬).
­®£¤  ° ±±¬ ²°¨¢ ¾² ®¡®¡¹¥­¨¿ ¯®­¿²¨¿ £° ´ .  ¯°¨¬¥°,
¬®¦­® ° ±±¬ ²°¨¢ ²¼ ¬³«¼²¨£° ´ (multigraph), ª®²®°»© ¯®µ®¦ ­ 
­¥®°¨¥­²¨°®¢ ­­»© £° ´, ­® ¬®¦¥² ±®¤¥°¦ ²¼ ¬­®£® °¥¡¥°, ±®¥¤¨­¿¾¹¨µ ®¤­³ ¨ ²³ ¦¥ ¯ °³ ¢¥°¸¨­,   ² ª¦¥ °¥¡° -¶¨ª«». ¨¯¥°£° ´ (hypergraph) ®²«¨· ¥²±¿ ®² ­¥®°¨¥­²¨°®¢ ­­®£® £° ´  ²¥¬,
·²® ®­ ±®¤¥°¦¨² £¨¯¥°°¥¡°  (hyperedges), ±®¥¤¨­¿¾¹¨¥ ­¥ ¤¢¥ ¢¥°¸¨­»,   ¯°®¨§¢®«¼­®¥ ¬­®¦¥±²¢® ¢¥°¸¨­. ­®£¨¥  «£®°¨²¬» ®¡° ¡®²ª¨ ®¡»·­»µ £° ´®¢ ¬®£³² ¡»²¼ ®¡®¡¹¥­» ­  ² ª¨¥ £° ´®¯®¤®¡­»¥ ±²°³ª²³°».
¯° ¦­¥­¨¿
5.4-1   ¢¥·¥°¨­ª¥ ª ¦¤»© £®±²¼ ±·¨² ¥², ±ª®«¼ª® °³ª®¯®¦ ²¨© ®­ ±¤¥« «. ®²®¬ ¢±¥ ·¨±«  ±ª« ¤»¢ ¾²±¿. ®ª ¦¨²¥, ·²® ¯®«³·¨²±¿ ·¥²­®¥ ·¨±«®, ¤®ª § ¢ ±«¥¤³¾¹³¾ «¥¬¬³ ® °³ª®¯®¦ ²¨¿µ
(handshaking lemma): ¤«¿ ­¥®°¨¥­²¨°®¢ ­­®£® £° ´  ±³¬¬  ±²¥¯¥­¥© ¢±¥µ ¥£® ¢¥°¸¨­ ° ¢­  ³¤¢®¥­­®¬³ ·¨±«³ °¥¡¥°.
5.4-2 ®ª ¦¨²¥, ·²® ²°¥¡®¢ ­¨¥ k > 3 ¢ ®¯°¥¤¥«¥­¨¨ ¶¨ª«  ¢ ­¥®°¨¥­²¨°®¢ ­­®¬ £° ´¥ ±³¹¥±²¢¥­­® (¥±«¨ ¥£® ®²¬¥­¨²¼, ¢ «¾¡®¬
£° ´¥, £¤¥ ¥±²¼ µ®²¼ ®¤­® °¥¡°®, ¡³¤¥² ¶¨ª«).
5.4-3 ®ª ¦¨²¥, ·²® ¥±«¨ ¢ £° ´¥ (®°¨¥­²¨°®¢ ­­®¬ ¨«¨ ­¥®°¨¥­²¨°®¢ ­­®¬) ¥±²¼ ¯³²¼ ¨§ ¢¥°¸¨­» u ¢ ¢¥°¸¨­³ v , ²® ¢ ­¥¬ ¥±²¼
¯°®±²®© ¯³²¼ ¨§ u ¢ v . ®ª ¦¨²¥, ·²® ¥±«¨ ¢ ®°¨¥­²¨°®¢ ­­®¬
£° ´¥ ¥±²¼ ¶¨ª«, ²® ¢ ­¥¬ ¥±²¼ ¯°®±²®© ¶¨ª«.
5.4-4 ®ª ¦¨²¥, ·²® ¢ ±¢¿§­®¬ ­¥®°¨¥­²¨°®¢ ­­®¬ £° ´¥ (V; E )
·¨±«® ¢¥°¸¨­ ¯°¥¢®±µ®¤¨² ·¨±«® °¥¡¥° ­¥ ¡®«¥¥ ·¥¬ ­  1: jE j >
jV j ; 1

¥°¥¢¼¿

93

5.4-5 °®¢¥°¼²¥, ·²® ®²­®¸¥­¨¥ À¡»²¼ ¤®±²¨¦¨¬»¬ ¨§Á ¿¢«¿¥²±¿ (¤«¿ ­¥®°¨¥­²¨°®¢ ­­®£® £° ´ ) ®²­®¸¥­¨¥¬ ½ª¢¨¢ «¥­²­®±²¨.
 ª¨¥ ¨§ ²°¥µ ±¢®©±²¢, ¢µ®¤¿¹¨µ ¢ ®¯°¥¤¥«¥­¨¥ ®²­®¸¥­¨¿ ½ª¢¨¢ «¥­²­®±²¨, ±¯° ¢¥¤«¨¢» ¤«¿ ®²­®¸¥­¨¿ ¤®±²¨¦¨¬®±²¨ ¢ ®°¨¥­²¨°®¢ ­­®¬ £° ´¥?
5.4-6  °¨±³©²¥ ­¥®°¨¥­²¨°®¢ ­­³¾ ¢¥°±¨¾ £° ´  °¨±. 5.2 ( ) ¨
®°¨¥­²¨°®¢ ­­³¾ ¢¥°±¨¾ £° ´  °¨±. 5.2 (¡).
5.4-7?  ª ¬®¦­® ¯°¥¤±² ¢¨²¼ £¨¯¥°£° ´ ± ¯®¬®¹¼¾ ¤¢³¤®«¼­®£® £° ´ , ¨§®¡° ¦ ¿ ®²­®¸¥­¨¥ ¨­¶¨¤¥­²­®±²¨ ¢ £¨¯¥°£° ´¥ ®²­®¸¥­¨¥¬ ±¬¥¦­®±²¨ ¢ ¤¢³¤®«¼­®¬ £° ´¥? (ª § ­¨¥: ¢¥°¸¨­ ¬¨
¤¢³¤®«¼­®£® £° ´  ¤®«¦­» ¡»²¼ ¢¥°¸¨­» £¨¯¥°£° ´ ,   ² ª¦¥
£¨¯¥°°¥¡°  £¨¯¥°£° ´ .)

5.5. ¥°¥¢¼¿
 ª ¨ ±«®¢® À£° ´Á, ±«®¢® À¤¥°¥¢®Á ² ª¦¥ ³¯®²°¥¡«¿¥²±¿ ¢ ­¥±ª®«¼ª¨µ °®¤±²¢¥­­»µ ±¬»±« µ.  ½²®¬ ° §¤¥«¥ ¬» ¤ ¥¬ ®¯°¥¤¥«¥­¨¿ ¨ ° ±±¬ ²°¨¢ ¥¬ ±¢®©±²¢  ­¥±ª®«¼ª¨µ ¢¨¤®¢ ¤¥°¥¢¼¥¢.  ° §¤¥« µ 11.4 ¨ 23.1 ¬» ¢¥°­¥¬±¿ ª ¤¥°¥¢¼¿¬ ¨ ° ±±¬®²°¨¬ ±¯®±®¡»
¨µ ¯°¥¤±² ¢«¥­¨¿ ¢ ¯°®£° ¬¬ µ.
5.5.1. ¥°¥¢¼¿ ¡¥§ ¢»¤¥«¥­­®£® ª®°­¿
 ª ¬» £®¢®°¨«¨ ¢ ° §¤¥«¥ 5.4, ¤¥°¥¢® (¡¥§ ¢»¤¥«¥­­®£® ª®°­¿,
free tree) ®¯°¥¤¥«¿¥²±¿ ª ª ±¢¿§­»©  ¶¨ª«¨·¥±ª¨© ­¥®°¨¥­²¨°®¢ ­­»© £° ´. ±«¨ ­¥®°¨¥­²¨°®¢ ­­»© £° ´ ¿¢«¿¥²±¿  ¶¨ª«¨·¥±ª¨¬,
­® (¢®§¬®¦­®) ­¥±¢¿§­»¬, ¥£® ­ §»¢ ¾² «¥±®¬ (forest); ª ª ¨ ¯®«®¦¥­®, «¥± ±®±²®¨² ¨§ ¤¥°¥¢¼¥¢ (¿¢«¿¾¹¨µ±¿ ¥£® ±¢¿§­»¬¨ ª®¬¯®­¥­² ¬¨). ­®£¨¥  «£®°¨²¬» ®¡° ¡®²ª¨ ¤¥°¥¢¼¥¢ ¯°¨¬¥­¨¬» ¨ ª
«¥± ¬.   °¨±. 5.4 ( ) ¨§®¡° ¦¥­® ¤¥°¥¢®; ­  °¨±. 5.4 (¡) ¨§®¡° ¦¥­
«¥±. ¥± °¨±³­ª  5.4 (¡) ­¥ ¿¢«¿¥²±¿ ¤¥°¥¢®¬, ² ª ª ª ­¥ ±¢¿§¥­.
° ´ ­  °¨±³­ª¥ 5.4 (¢) ­¥ ¿¢«¿¥²±¿ ­¨ ¤¥°¥¢®¬, ­¨ ¤ ¦¥ «¥±®¬,
² ª ª ª ¢ ­¥¬ ¥±²¼ ¶¨ª«.
 ±«¥¤³¾¹¥© ²¥®°¥¬¥ ³ª § ­® ­¥±ª®«¼ª® ¢ ¦­»µ ±¢®©±²¢ ¤¥°¥¢¼¥¢.
¥®°¥¬  5.2 (¢®©±²¢  ¤¥°¥¢¼¥¢). ³±²¼ G = (V; E ) | ­¥®°¨¥­²¨°®¢ ­­»© £° ´. ®£¤  ±«¥¤³¾¹¨¥ ±¢®©±²¢  ° ¢­®±¨«¼­»:
1. G ¿¢«¿¥²±¿ ¤¥°¥¢®¬ (¡¥§ ¢»¤¥«¥­­®£® ª®°­¿).
2. «¿ «¾¡»µ ¤¢³µ ¢¥°¸¨­ G ±³¹¥±²¢³¥² ¥¤¨­±²¢¥­­»© ±®¥¤¨­¿¾¹¨© ¨µ ¯°®±²®© ¯³²¼.
3. ° ´ G ±¢¿§¥­, ­® ¯¥°¥±² ¥² ¡»²¼ ±¢¿§­»¬, ¥±«¨ ³¤ «¨²¼
«¾¡®¥ ¥£® °¥¡°®.

94

« ¢  5 ­®¦¥±²¢ 

( ) ¥°¥¢® ¡¥§ ¢»¤¥«¥­­®£® ª®°­¿. (¡) ¥±. (¢) ° ´, ±®¤¥°¦ ¹¨©
¶¨ª«, ­¥ ¿¢«¿¥²±¿ ­¨ ¤¥°¥¢®¬, ­¨ «¥±®¬.
¨±. 5.4

¨±. 5.5

¢  ¯°®±²»µ ¯³²¨ ¨§ u ¢ v

4. ° ´ G ±¢¿§¥­ ¨ jE j = jV j ; 1.
5. ° ´ G  ¶¨ª«¨·¥±ª¨© ¨ jE j = jV j ; 1.
6. ° ´ G  ¶¨ª«¨·¥±ª¨©, ­® ¤®¡ ¢«¥­¨¥ «¾¡®£® °¥¡°  ª ­¥¬³ ¯®°®¦¤ ¥² ¶¨ª«.
®ª § ²¥«¼±²¢®. (1) ) (2): ®±ª®«¼ª³ ¤¥°¥¢® ±¢¿§­®, ¤«¿ «¾¡»µ
¤¢³µ ¢¥°¸¨­ ±³¹¥±²¢³¥² ±®¥¤¨­¿¾¹¨© ¨µ ¯³²¼; ¢»ª¨­³¢ ¨§ ­¥£®
«¨¸­¥¥, ¬®¦¥¬ ±·¨² ²¼, ·²® ½²®² ¯³²¼ ¯°®±²®©. ³±²¼ ¥±²¼ ¤¢ 
° §­»µ ¯°®±²»µ ¯³²¨ p1 ¨ p2 ¨§ ­¥ª®²®°»© ¢¥°¸¨­» u ¢ ¤°³£³¾
¢¥°¸¨­³ v (°¨±. 5.5). ®±¬®²°¨¬, £¤¥ ½²¨ ¯³²¨ ° ±µ®¤¿²±¿; ¯³±²¼
w | ¯®±«¥¤­¿¿ ®¡¹ ¿ ¢¥°¸¨­  ¯¥°¥¤ ° §¢¥²¢«¥­¨¥¬,   x ¨ y |
° §«¨·­»¥ ¢¥°¸¨­», ±«¥¤³¾¹¨¥ §  w ¢ ¯³²¿µ p1 ¨ p2. ¢¨£ ¿±¼ ¯®
¯¥°¢®¬³ ¯³²¨, ¤®¦¤¥¬±¿ ¬®¬¥­² , ª®£¤  ¯³²¼ ¢­®¢¼ ¯¥°¥±¥ª ¥²±¿
±® ¢²®°»¬ ¢ ­¥ª®²®°®© ¢¥°¸¨­¥ z .  ±±¬®²°¨¬ ³· ±²®ª p0 ¯¥°¢®£®
¯³²¨ ®² w ¤® z (·¥°¥§ x) ¨ ³· ±²®ª ¢²®°®£® ¯³²¨ p00 ®² w ¤® z
(·¥°¥§ y ). ³²¨ p0 ¨ p00 ­¥ ¨¬¥¾² ®¡¹¨µ ¢¥°¸¨­ (­¥ ±·¨² ¿ ª®­¶®¢),
¯®±ª®«¼ª³ z ¡»«® ¯¥°¢®© ¢¥°¸¨­®© ­  ¯³²¨ p1 ¯®±«¥ w, ¯®¯ ¢¸¥©
¢ p2 . ®½²®¬³ ¬» ¯®«³· ¥¬ ¶¨ª« (±®±²®¿¹¨© ¨§ p0 ¨ ®¡° ¹¥­¨¿
¯³²¨ p00 ).
(2) ) (3) ° ´, ®·¥¢¨¤­®, ±¢¿§¥­. ³±²¼ (u; v ) | «¾¡®¥ ¥£® °¥¡°®. ±«¨ ¯®±«¥ ¥£® ³¤ «¥­¨¿ £° ´ ®±² ­¥²±¿ ±¢¿§­»¬, ²® ¢ ­¥¬
¡³¤¥² ¯³²¼, ±®¥¤¨­¿¾¹¨© u ¨ v | ¢²®°®© ¯³²¼, ·²® ¯°®²¨¢®°¥·¨²
¯°¥¤¯®«®¦¥­¨¾.
(3) ) (4) ® ³±«®¢¨¾, £° ´ ±¢¿§¥­, ¯®½²®¬³ jE j > jV j;1 (³¯°. 5.44). ®ª ¦¥¬, ·²® jE j 6 jV j ; 1, ° ±±³¦¤ ¿ ¯® ¨­¤³ª¶¨¨. ¢¿§­»©
£° ´ ± n = 1; 2 ¢¥°¸¨­ ¬¨ ¨¬¥¥² n ; 1 °¥¡¥°. ³±²¼ £° ´ G ¨¬¥¥²
n > 3 °¥¡¥° ¨ ¤«¿ £° ´®¢ ± ¬¥­¼¸¨¬ ·¨±«®¬ °¥¡¥° ­ ¸¥ ­¥° ¢¥­±²¢® ³¦¥ ¤®ª § ­®. ¤ «¥­¨¥ °¥¡°  ° §¡¨¢ ¥² £° ´ G ­  k > 2 ±¢¿§-

¥°¥¢¼¿

95

­»µ ª®¬¯®­¥­² (­  ± ¬®¬ ¤¥«¥ ­  ¤¢¥, ­® ½²® ­ ¬ ­¥ ¢ ¦­®). «¿
ª ¦¤®© ¨§ ª®¬¯®­¥­² ¢»¯®«­¥­® ³±«®¢¨¥ (3). ­¤³ª²¨¢­®¥ ¯°¥¤¯®«®¦¥­¨¥ £ ° ­²¨°³¥², ·²® ®¡¹¥¥ ·¨±«® °¥¡¥° ¢ ­¨µ ­¥ ¡®«¼¸¥
jV j ; k 6 jV j ; 2. ­ ·¨², ¤® ³¤ «¥­¨¿ °¥¡°  ¡»«® ­¥ ¡®«¥¥ jV j ; 1
°¥¡¥°.
(4) ) (5) ³±²¼ £° ´ ±¢¿§¥­ ¨ jE j = jV j;1. ®ª ¦¥¬, ·²® £° ´ ­¥
¨¬¥¥² ¶¨ª«®¢. ±«¨ ¶¨ª« ¥±²¼, ³¤ «¥­¨¥ «¾¡®£® °¥¡°  ¨§ ¶¨ª«  ­¥
­ °³¸ ¥² ±¢¿§­®±²¨ (¬®¦­® ¯°®©²¨ ¯® ®±² ¾¹¥©±¿ · ±²¨ ¶¨ª« ).
³¤¥¬ ¯®¢²®°¿²¼ ½²® ¤® ²¥µ ¯®°, ¯®ª  ­¥ ®±² ­¥²±¿ ±¢¿§­»© £° ´
¡¥§ ¶¨ª«®¢ (¤¥°¥¢®).  ª ¬» ³¦¥ §­ ¥¬, ¤«¿ ¤¥°¥¢  ·¨±«® °¥¡¥°
­  ¥¤¨­¨¶³ ¬¥­¼¸¥ ·¨±«  ¢¥°¸¨­ | ­® ¯® ¯°¥¤¯®«®¦¥­¨¾ ²® ¦¥
±®®²­®¸¥­¨¥ ¡»«® ¨ ¤® ³¤ «¥­¨¿ °¥¡¥°, ² ª ·²® ³¤ «¨²¼ ¬» ­¨·¥£®
­¥ ¬®£«¨ ¨ ± ± ¬®£® ­ · «  ­¥ ¡»«® ¶¨ª«®¢.
(5) ) (6) ³±²¼ £° ´ G ­¥ ¨¬¥¥² ¶¨ª«®¢ ¨ jE j = jV j ; 1. ³±²¼
G ¨¬¥¥² k ±¢¿§­»µ ª®¬¯®­¥­²; ®­¨ ¯® ®¯°¥¤¥«¥­¨¾ ¿¢«¿¾²±¿ ¤¥°¥¢¼¿¬¨. » §­ ¥¬, ·²® ¢ ª ¦¤®© ¨§ ­¨µ ·¨±«® °¥¡¥° ­  ¥¤¨­¨¶³
¬¥­¼¸¥ ·¨±«  ¢¥°¸¨­, ¯®½²®¬³ ®¡¹¥¥ ·¨±«® °¥¡¥° ­  k ¬¥­¼¸¥ ·¨±«  ¢¥°¸¨­. ­ ·¨², k = 1 ¨ £° ´ ¯°¥¤±² ¢«¿¥² ±®¡®© ¤¥°¥¢®. 
­¥¬ «¾¡»¥ ¤¢¥ ¢¥°¸¨­» ¬®£³² ¡»²¼ ±®¥¤¨­¥­» ¯°®±²»¬ ¯³²¥¬
(¬» ³¦¥ §­ ¥¬, ·²® (1) ) (2)), ¨ ¯®²®¬³ ¤®¡ ¢«¥­¨¥ «¾¡®£® °¥¡° 
¯®°®¦¤ ¥² ¶¨ª«.
(6) ) (1) ³±²¼ £° ´ ¿¢«¿¥²±¿  ¶¨ª«¨·¥±ª¨¬, ­® ¤®¡ ¢«¥­¨¥ «¾¡®£® °¥¡°  ¯®°®¦¤ ¥² ¶¨ª«.  ¤® ¯®ª § ²¼, ·²® ®­ ±¢¿§¥­.  ± ¬®¬ ¤¥«¥, ° ±±¬®²°¨¬ ¤¢¥ ¯°®¨§¢®«¼­»¥ ¢¥°¸¨­» u ¨ v . » §­ ¥¬,
·²® ¤®¡ ¢«¥­¨¥ °¥¡°  (u; v ) ¯®°®¦¤ ¥² ¶¨ª«.  ½²®¬ ¶¨ª«¥ ¤®«¦­® ¢±²°¥· ²¼±¿ °¥¡°® (u; v ), ¯®±ª®«¼ª³ ¤® ¥£® ¤®¡ ¢«¥­¨¿ ¶¨ª«  ­¥
¡»«® | ­® ²®«¼ª® ®¤¨­ ° §, ¨ ®±² «¼­ ¿ · ±²¼ ¶¨ª«  ±®¥¤¨­¿¥² u
¨ v , ·²® ¨ ²°¥¡®¢ «®±¼.
5.5.2. ¥°¥¢¼¿ ± ª®°­¥¬. °¨¥­²¨°®¢ ­­»¥ ¤¥°¥¢¼¿
¥°¥¢® ± ª®°­¥¬, ¨«¨ ª®°­¥¢®¥ ¤¥°¥¢® (rooted tree), ¯®«³· ¥²±¿,
¥±«¨ ¢ ¤¥°¥¢¥ (±¢¿§­®¬  ¶¨ª«¨·¥±ª®¬ ­¥®°¨¥­²¨°®¢ ­­®¬ £° ´¥)
¢»¤¥«¨²¼ ®¤­³ ¨§ ¢¥°¸¨­ ¢»¤¥«¥­ , ­ §¢ ¢ ¥¥ ª®°­¥¬ (root). ¥°¸¨­» ª®°­¥¢®£® ¤¥°¥¢  ¯®- ­£«¨©±ª¨ ­ §»¢ ¾²±¿ ² ª¦¥ ÀnodesÁ.
  °¨±³­ª¥ 5.6 ( ) ¯®ª § ­® ª®°­¥¢®¥ ¤¥°¥¢® ± 12 ¢¥°¸¨­ ¬¨ ¨
ª®°­¥¬ 7.
³±²¼ x | ¯°®¨§¢®«¼­ ¿ ¢¥°¸¨­  ª®°­¥¢®£® ¤¥°¥¢  ± ª®°­¥¬ ¢ r.
³¹¥±²¢³¥² ¥¤¨­±²¢¥­­»© ¯³²¼ ¨§ r ¢ x; ¢±¥ ¢¥°¸¨­», ­ µ®¤¿¹¨¥±¿
­  ½²®¬ ¯³²¨, ¬» ­ §»¢ ¥¬ ¯°¥¤ª ¬¨ (ancestors) ¢¥°¸¨­» x. ±«¨ y
¿¢«¿¥²±¿ ¯°¥¤ª®¬ x, ²® x ­ §»¢ ¥²±¿ ¯®²®¬ª®¬ (descendant) y .  ¦¤³¾ ¢¥°¸¨­³ ¬» ±·¨² ¥¬ ±¢®¨¬ ¯°¥¤ª®¬ ¨ ¯®²®¬ª®¬. °¥¤ª¨ ¨
¯®²®¬ª¨ ¢¥°¸¨­» x, ­¥ ±®¢¯ ¤ ¾¹¨¥ ± x, ­ §»¢ ¾²±¿ ±®¡±²¢¥­­»¬¨ ¯°¥¤ª ¬¨ (proper ancestors) ¨ ±®¡±²¢¥­­»¬¨ ¯®²®¬ª ¬¨ (proper
descendants) ¢¥°¸¨­» x. [²  ²¥°¬¨­®«®£¨¿ ­¥ ¢¯®«­¥ ³¤ ·­ : ´° -

96

« ¢  5 ­®¦¥±²¢ 

¢»±®²  = 4, £«³¡¨­  0, £«³¡¨­  1 ¨ ².¯.

( ) ®°­¥¢®¥ ¤¥°¥¢® ¢»±®²» 4. ¥°¥¢® ­ °¨±®¢ ­® ®¡»·­»¬ ®¡° §®¬:
ª®°¥­¼ (¢¥°¸¨­  7) ­ °¨±®¢ ­  ±¢¥°µ³, ±®±¥¤­¨¥ ± ­¨¬ ¢¥°¸¨­» (¤¥²¨ ª®°­¿,
¢¥°¸¨­» £«³¡¨­» 1) ­ °¨±®¢ ­» ¯®¤ ­¥©, ¢¥°¸¨­» ±«¥¤³¾¹¥£® ³°®¢­¿ (¤¥²¨
¤¥²¥© ª®°­¿, ¢¥°¸¨­» £«³¡¨­» 2) ¯®¤ ­¨¬¨ ¨ ². ¤. «¿ ¤¥°¥¢¼¥¢ ± ¯®°¿¤ª®¬ ­ 
¤¥²¿µ ¤«¿ ª ¦¤®© ¢¥°¸¨­» ´¨ª±¨°®¢ ­ ¯®°¿¤®ª ­  ¬­®¦¥±²¢¥ ¥¥ ¤¥²¥©. (¡) ®
¦¥ ± ¬®¥ ª®°­¥¢®¥ ¤¥°¥¢®, ­® ± ¤°³£¨¬ ¯®°¿¤ª®¬ (±°¥¤¨ ¤¥²¥© ¢¥°¸¨­» 3),
¡³¤¥² ¤°³£¨¬ ¤¥°¥¢®¬ ± ¯®°¿¤ª®¬ ­  ¤¥²¿µ.
¨±. 5.6

§³ À¢¥°¸¨­  ¿¢«¿¥²±¿ ±¢®¨¬ ±®¡±²¢¥­­»¬ ¯®²®¬ª®¬Á ¬®¦­® ²®«ª®¢ ²¼ ¯® ° §­®¬³, ¨ ¯°¨ ®¤­®¬ ²®«ª®¢ ­¨¨ ®­  ¢¥°­ ,   ¯°¨ ¤°³£®¬
­¥².]
«¿ ª ¦¤®© ¢¥°¸¨­» x ¬®¦­® ° ±±¬®²°¥²¼ ¤¥°¥¢®, ±®±²®¿¹¥¥
¨§ ¢±¥µ ¯®²®¬ª®¢ x, ¢ ª®²®°®¬ x ±·¨² ¥²±¿ ª®°­¥¬. ­® ­ §»¢ ¥²±¿ ¯®¤¤¥°¥¢®¬ ± ª®°­¥¬ ¢ x (subtree rooted at x).  ¯°¨¬¥°, ­ 
°¨±. 5.6 ( ) ¯®¤¤¥°¥¢® ± ª®°­¥¬ ¢ 8 ±®¤¥°¦¨² ¢¥°¸¨­» 8, 6, 5 ¨ 9.
±«¨ (y; x) | ¯®±«¥¤­¥¥ °¥¡°® ­  ¯³²¨ ¨§ ª®°­¿ ¢ x, ²® y ­ §»¢ ¥²±¿ °®¤¨²¥«¥¬ (parent) x,   x ­ §»¢ ¥²±¿ °¥¡¥­ª®¬ y . [ ­¼¸¥ ¢¬¥±²® À°®¤¨²¥«¼Á ¨ À°¥¡¥­®ªÁ £®¢®°¨«¨ À®²¥¶Á (father) ¨ À±»­Á(son),
·²® ¡»«® ¡®«¥¥ «®£¨·­®, ² ª ª ª ¢®®¡¹¥-²® ³ ·¥«®¢¥ª  ¤¢®¥ °®¤¨²¥«¥©,   ³ ¢¥°¸¨­» ¤¥°¥¢  | ­¥ ¡®«¥¥ ®¤­®£®.  ²® ¯°¨­¿² ¿ ²¥¯¥°¼
¢  ¬¥°¨ª ­±ª®© «¨²¥° ²³°¥ ²¥°¬¨­®«®£¨¿ À¯®«¨²¨·¥±ª¨ ª®°°¥ª²­ Á.]
®°¥­¼ ¿¢«¿¥²±¿ ¥¤¨­±²¢¥­­®© ¢¥°¸¨­®©, ³ ª®²®°®© ­¥² °®¤¨²¥«¿. ¥°¸¨­», ¨¬¥¾¹¨¥ ®¡¹¥£® °®¤¨²¥«¿, ­ §»¢ ¾² ¢  ¬¥°¨ª ­±ª®© «¨²¥° ²³°¥ siblings; ª ±®¦ «¥­¨¾, °³±±ª®£® ¯¥°¥¢®¤  ³ ½²®£®
±«®¢  ­¥², ¨ ¬» ¡³¤¥¬ (ª ª ½²® ¤¥« «®±¼ ° ­¼¸¥) ­ §»¢ ²¼ ² ª¨¥
¢¥°¸¨­» ¡° ²¼¿¬¨. ¥°¸¨­  ª®°­¥¢®£® ¤¥°¥¢ , ­¥ ¨¬¥¾¹ ¿ ¤¥²¥©,
­ §»¢ ¥²±¿ «¨±²®¬ (leaf, external node). ¥°¸¨­», ¨¬¥¾¹¨¥ ¤¥²¥©,
­ §»¢ ¾²±¿ ¢­³²°¥­­¨¬¨ (internal).
¨±«® ¤¥²¥© ³ ¢¥°¸¨­» ª®°­¥¢®£® ¤¥°¥¢  ­ §»¢ ¥²±¿ ¥¥ ±²¥¯¥­¼¾ (degree). ²¬¥²¨¬, ·²® ¤«¿ ¢±¥µ ¢¥°¸¨­, ª°®¬¥ ª®°­¿, ±²¥¯¥­¼
­  ¥¤¨­¨¶³ ¬¥­¼¸¥ ±²¥¯¥­¨ ²®© ¦¥ ¢¥°¸¨­» ¢ ²®¬ ¦¥ ¤¥°¥¢¥, ¥±«¨ ° ±±¬ ²°¨¢ ²¼ ¤¥°¥¢® ª ª ­¥®°¨¥­²¨°®¢ ­­»© £° ´ (¯®±ª®«¼ª³
²®£¤  ­ ¤® ³·¨²»¢ ²¼ ¨ °¥¡°®, ¨¤³¹¥¥ ¢¢¥°µ). «¨­  ¯³²¨ ®² ª®°­¿
¤® ¯°®¨§¢®«¼­®© ¢¥°¸¨­» x ­ §»¢ ¥²±¿ £«³¡¨­®© (depth) ¢¥°¸¨­» x.  ª±¨¬ «¼­ ¿ £«³¡¨­  ¢¥°¸¨­ ¤¥°¥¢  ­ §»¢ ¥²±¿ ¢»±®²®©

¥°¥¢¼¿

97

¢®¨·­»¥ ¤¥°¥¢¼¿. ( ) ¢®¨·­®¥ ¤¥°¥¢®, ¨§®¡° ¦¥­­®¥ ²° ¤¨¶¨®­­»¬ ®¡° §®¬. ¥¢»© °¥¡¥­®ª ¢¥°¸¨­» ­ °¨±®¢ ­ ±«¥¢ -±­¨§³ ®² ­¥¥, ¯° ¢»©
| ±¯° ¢ -±­¨§³. (¡) °³£®¥ ¤¢®¨·­®¥ ¤¥°¥¢® (®²«¨·¨¥ ¢ ²®¬, ·²® ²¥¯¥°¼ ³ ¢¥°¸¨­» 7 ¥±²¼ ¯° ¢»© °¥¡¥­®ª 5 ¨ ­¥² «¥¢®£®,   ­¥ ­ ®¡®°®²).  ª®¥ ° §«¨·¨¥
¢®§¬®¦­® ¢ ¤¢®¨·­®¬ ¤¥°¥¢¥, ­® ­¥ ¢ ¤¥°¥¢¥ ± ¯®°¿¤ª®¬ ­  ¤¥²¿µ. (¢) ®¡ ¢«¿¿
¤®¯®«­¨²¥«¼­»¥ «¨±²¼¿ ª ¤¥°¥¢³ (a), ¬» ¯®«³· ¥¬ ¤¥°¥¢®, ³ ª®²®°®£® ª ¦¤ ¿
±² ° ¿ ¢¥°¸¨­  ¨¬¥¥² ¤¢³µ ¤¥²¥©. ®¡ ¢«¥­­»¥ «¨±²¼¿ ¨§®¡° ¦¥­» ª¢ ¤° ²¨ª ¬¨.
¨±. 5.7

(height) ¤¥°¥¢ .
¥°¥¢®¬ ± ¯®°¿¤ª®¬ ­  ¤¥²¿µ (ordered tree) ­ §»¢ ¥²±¿ ª®°­¥¢®¥
¤¥°¥¢® ± ¤®¯®«­¨²¥«¼­®© ±²°³ª²³°®©: ¤«¿ ª ¦¤®© ¢¥°¸¨­» ¬­®¦¥±²¢® ¥¥ ¤¥²¥© ³¯®°¿¤®·¥­® (¨§¢¥±²­®, ª ª®© ¥¥ ¯®²®¬®ª ¯¥°¢»©,
ª ª®© ¢²®°®© ¨ ². ¤.). ¢  ¤¥°¥¢  ­  °¨±. 5.6 ®¤¨­ ª®¢» ª ª ª®°­¥¢»¥ ¤¥°¥¢¼¿, ­® ° §«¨·­» ª ª ¤¥°¥¢¼¿ ± ¯®°¿¤ª®¬ ­  ¤¥²¿µ.
5.5.3. ¢®¨·­»¥ ¤¥°¥¢¼¿. ®§¨¶¨®­­»¥ ¤¥°¥¢¼¿
¢®¨·­®¥ ¤¥°¥¢® (binary tree) ¯°®¹¥ ¢±¥£® ®¯°¥¤¥«¨²¼ °¥ª³°±¨¢­® ª ª ª®­¥·­»© ­ ¡®° ¢¥°¸¨­, ª®²®°»©
 «¨¡® ¯³±² (­¥ ±®¤¥°¦¨² ¢¥°¸¨­),
 «¨¡® ° §¡¨² ­  ²°¨ ­¥¯¥°¥±¥ª ¾¹¨¥±¿ · ±²¨: ¢¥°¸¨­³, ­ §»¢ ¥¬³¾ ª®°­¥¬ (root), ¤¢®¨·­®¥ ¤¥°¥¢®, ­ §»¢ ¥¬®¥ «¥¢»¬ ¯®¤¤¥°¥¢®¬ (left subtree) ª®°­¿, ¨ ¤¢®¨·­®¥ ¤¥°¥¢®, ­ §»¢ ¥¬®¥ ¯° ¢»¬ ¯®¤¤¥°¥¢®¬ (right subtree) ª®°­¿.
¢®¨·­®¥ ¤¥°¥¢®, ­¥ ±®¤¥°¦ ¹¥¥ ¢¥°¸¨­, ­ §»¢ ¥²±¿ ¯³±²»¬ (empty). ­® ¨­®£¤  ®¡®§­ · ¥²±¿ nil. ±«¨ «¥¢®¥ ¯®¤¤¥°¥¢® ­¥¯³±²®,
²® ¥£® ª®°¥­¼ ­ §»¢ ¥²±¿ «¥¢»¬ °¥¡¥­ª®¬ (left child) ª®°­¿ ¢±¥£®
¤¥°¥¢ ; ¯° ¢»© °¥¡¥­®ª (right child) ®¯°¥¤¥«¿¥²±¿  ­ «®£¨·­®. ±«¨
«¥¢®¥ ¨«¨ ¯° ¢®¥ ¯®¤¤¥°¥¢® ª®°­¿ ¯³±²®, ²® £®¢®°¿², ·²® ³ ª®°­¿
­¥² «¥¢®£® ¨«¨ ¯° ¢®£® °¥¡¥­ª  (child is absent). °¨¬¥° ¤¢®¨·­®£®
¤¥°¥¢  ¯®ª § ­ ­  °¨±. 5.7 ( ).
»«® ¡» ®¸¨¡ª®© ®¯°¥¤¥«¨²¼ ¤¢®¨·­®¥ ¤¥°¥¢® ¯°®±²® ª ª ¤¥°¥¢® ± ¯®°¿¤ª®¬ ­  ¤¥²¿µ, ¢ ª®²®°®¬ ±²¥¯¥­¼ ª ¦¤®© ¢¥°¸¨­» ­¥
¯°¥¢®±µ®¤¨² 2. ¥«® ¢ ²®¬, ·²® ¢ ¤¢®¨·­®¬ ¤¥°¥¢¥ ¢ ¦­®, ª ª¨¬
¿¢«¿¥²±¿ ¥¤¨­±²¢¥­­»© °¥¡¥­®ª ¢¥°¸¨­» ±²¥¯¥­¨ 1 | «¥¢»¬ ¨«¨

98

« ¢  5 ­®¦¥±²¢ 

¢»±®² =3, £«³¡¨­  0, £«³¡¨­  1 ¨ ².¯.

¨±. 5.8

¢¥°¸¨­.

®«­®¥ ¤¢®¨·­®¥ ¤¥°¥¢® ¢»±®²» 3 ¨¬¥¥² 8 «¨±²¼¥¢ ¨ 7 ¢­³²°¥­­¨µ

¯° ¢»¬,   ¤«¿ ¤¥°¥¢  ± ¯®°¿¤ª®¬ ­  ¤¥²¿µ ² ª®£® ° §«¨·¨¿ ­¥ ±³¹¥±²¢³¥².   °¨±. 5.7 ( ,¡) ¯®ª § ­» ¤¢  ° §«¨·­»µ ¤¢®¨·­»µ ¤¥°¥¢ ,
ª®²®°»¥ ®¤¨­ ª®¢» ª ª ¤¥°¥¢¼¿ ± ¯®°¿¤ª®¬ ­  ¤¥²¿µ.
³±²³¾¹¨¥ ¬¥±²  ¢ ¤¢®¨·­®¬ ¤¥°¥¢¥ · ±²® § ¯®«­¿¾² ´¨ª²¨¢­»¬¨ «¨±²¼¿¬¨. ®±«¥ ½²®£® ³ ª ¦¤®© ±² °®© ¢¥°¸¨­» ¡³¤¥² ¤¢®¥
¤¥²¥© («¨¡® ¯°¥¦­¨µ, «¨¡® ¤®¡ ¢«¥­­»µ). ²® ¯°¥®¡° §®¢ ­¨¥ ¯®ª § ­® ­  °¨±. 5.7 (¢).
®¦­® ®¯°¥¤¥«¨²¼  ­ «®£¨ ¤¢®¨·­»µ ¤¥°¥¢¼¥¢ ¤«¿ ¤¥°¥¢¼¥¢
¡®«¼¸¥© ±²¥¯¥­¨: ¤¢®¨·­»¥ ¤¥°¥¢¼¿ ¿¢«¿¾²±¿ · ±²­»¬ ±«³· ¥¬ k¨·­»µ (k-ary) ¤¥°¥¢¼¥¢ ¯°¨ k = 2. ®«¥¥ ¯®¤°®¡­®, ¯®§¨¶¨®­­®¥ ¤¥°¥¢® (positional tree) ®¯°¥¤¥«¿¥²±¿ ª ª ª®°­¥¢®¥ ¤¥°¥¢®, ¢ ª®²®°®¬
¤¥²¨ «¾¡®© ¢¥°¸¨­» ¯®¬¥·¥­» ° §«¨·­»¬¨ ¶¥«»¬¨ ¯®«®¦¨²¥«¼­»¬¨ ·¨±« ¬¨, ª®²®°»¥ ±·¨² ¾²±¿ ¨µ ­®¬¥° ¬¨. °¨ ½²®¬ ³ ª ¦¤®© ¢¥°¸¨­» ¥±²¼ ¢ ª ­±¨¨ ¤«¿ ¤¥²¥© ­®¬¥° 1, 2, 3 ¨ ² ª ¤ «¥¥, ¨§
ª®²®°»µ ­¥ª®²®°»¥ (ª®­¥·­®¥ ·¨±«®) § ¯®«­¥­»,   ®±² «¼­»¥ ±¢®¡®¤­» (ith child is absent). °¨ ½²®¬ k-¨·­»¬ ¤¥°¥¢®¬ ­ §»¢ ¥²±¿
¯®§¨¶¨®­­®¥ ¤¥°¥¢®, ­¥ ¨¬¥¾¹¥¥ ¢¥°¸¨­ ± ­®¬¥° ¬¨ ¡®«¼¸¥ k.
®«­»¬ k-¨·­»¬ ¤¥°¥¢®¬ (complete k-ary tree) ­ §»¢ ¥²±¿ k¨·­®¥ ¤¥°¥¢®, ¢ ª®²®°®¬ ¢±¥ «¨±²¼¿ ¨¬¥¾² ®¤¨­ ª®¢³¾ £«³¡¨­³
¨ ¢±¥ ¢­³²°¥­­¨¥ ¢¥°¸¨­» ¨¬¥¾² ±²¥¯¥­¼ k. (¥¬ ± ¬»¬ ±²°³ª²³°  ² ª®£® ¤¥°¥¢  ¯®«­®±²¼¾ ®¯°¥¤¥«¿¥²±¿ ¥£® ¢»±®²®©.)   °¨±. 5.8
¯®ª § ­® ¯®«­®¥ ¤¢®¨·­®¥ ¤¥°¥¢® ¢»±®²» 3. ®¤±·¨² ¥¬, ±ª®«¼ª®
«¨±²¼¥¢ ¨¬¥¥² ¯®«­®¥ k-¨·­®¥ ¤¥°¥¢® ¢»±®²» h. ®°¥­¼ ¿¢«¿¥²±¿
¥¤¨­±²¢¥­­®© ¢¥°¸¨­®© £«³¡¨­» 0, ¥£® k ¤¥²¥© ¿¢«¿¾²±¿ ¢¥°¸¨­ ¬¨ £«³¡¨­» 1, ¨µ ¤¥²¼¬¨ ¿¢«¿¾²±¿ k2 ¢¥°¸¨­ £«³¡¨­» k ¨ ² ª
¤ «¥¥ ¢¯«®²¼ ¤® kh «¨±²¼¥¢ £«³¡¨­» h. ®¦­® ¤®¡ ¢¨²¼, ·²® ¢»±®² 
k-¨·­®£® ¤¥°¥¢  ± n «¨±²¼¿¬¨ ° ¢­  logk n (² ª®¥ ¤¥°¥¢® ±³¹¥±²¢³¥², ²®«¼ª® ¥±«¨ ½²®² «®£ °¨´¬ ¶¥«»©). ¨±«® ¢­³²°¥­­¨µ ¢¥°¸¨­
¯®«­®£® k-¨·­®£® ¤¥°¥¢  ¢»±®²» h ° ¢­®
h
1 + k + k2 + : : : + kh;1 = kk ;;11

(±¬. (3.3)).  · ±²­®±²¨, ¤«¿ ¯®«­®£® ¤¢®¨·­®£® ¤¥°¥¢  ·¨±«® ¢­³²°¥­­¨µ ¢¥°¸¨­ ­  ¥¤¨­¨¶³ ¬¥­¼¸¥ ·¨±«  «¨±²¼¥¢.

 ¤ ·¨ ª £« ¢¥ 5

99

¯° ¦­¥­¨¿
5.5-1  °¨±³©²¥ ¢±¥ ¤¥°¥¢¼¿ (¡¥§ ¢»¤¥«¥­­®£® ª®°­¿), ±®¤¥°¦ ¹¨¥ ²°¨ ¢¥°¸¨­» A, B ¨ C .  °¨±³©²¥ ¢±¥ ª®°­¥¢»¥ ¤¥°¥¢¼¿ ± ¢¥°¸¨­ ¬¨ A, B ¨ C ¨ ª®°­¥¬ A.  °¨±³©²¥ ¢±¥ (ª®°­¥¢»¥) ¤¥°¥¢¼¿ ±
¯®°¿¤ª®¬ ­  ¤¥²¿µ ± ¢¥°¸¨­ ¬¨ A, B ¨ C ¨ ª®°­¥¬ A.  °¨±³©²¥
¢±¥ ¤¢®¨·­»¥ ¤¥°¥¢¼¿ ± ¢¥°¸¨­ ¬¨ A, B ¨ C ¨ ª®°­¥¬ A.
5.5-2 ®ª ¦¨²¥, ·²® ¤«¿ «¾¡®£® n > 7 ±³¹¥±²¢³¥² ¤¥°¥¢® c n
¢¥°¸¨­ ¬¨, ¨§ ª®²®°®£® ¬®¦­® ¯®«³·¨²¼ n ° §«¨·­»µ ª®°­¥¢»µ
¤¥°¥¢¼¥¢, ®¡º¿¢¨¢ ª®°­¥¬ ®¤­³ ¨§ n ¢¥°¸¨­.
5.5-3 ³±²¼ G = (V; E ) | ®°¨¥­²¨°®¢ ­­»©  ¶¨ª«¨·¥±ª¨© £° ´,
¢ ª®²®°®¬ ±³¹¥±²¢³¥² ¢¥°¸¨­  v0 , ¨§ ª®²®°®© ¢ ª ¦¤³¾ ¤°³£³¾
v 2 V ¢¥¤¥² ¥¤¨­±²¢¥­­»© ¯³²¼. ®ª ¦¨²¥, ·²® ­¥®°¨¥­²¨°®¢ ­­»© ¢ °¨ ­² £° ´  G ¿¢«¿¥²±¿ ¤¥°¥¢®¬.
5.5-4 ®ª ¦¨²¥ ¯® ¨­¤³ª¶¨¨, ·²® ¢ «¾¡®¬ ¤¢®¨·­®¬ ¤¥°¥¢¥ ·¨±«® ¢¥°¸¨­ ±²¥¯¥­¨ 2 ­  ¥¤¨­¨¶³ ¬¥­¼¸¥ ·¨±«  «¨±²¼¥¢.
5.5-5 ®ª ¦¨²¥, ·²® ¤¢®¨·­®¥ ¤¥°¥¢® ± n ¢¥°¸¨­ ¬¨ ¨¬¥¥² ¢»±®²³ ­¥ ¬¥­¼¸¥ blg nc.
5.5-6? ¯°¥¤¥«¨¬ ¢­³²°¥­­¾¾ ±³¬¬³ ¤«¨­ (internal path length)
¤«¿ ¤¢®¨·­®£® ¤¥°¥¢ , ¢ ª®²®°®¬ ª ¦¤ ¿ ¢¥°¸¨­  ¨¬¥¥² ±²¥¯¥­¼ 0
¨«¨ 2, ª ª ±³¬¬³ £«³¡¨­ ¢±¥µ ¢­³²°¥­­¨µ ¢¥°¸¨­. ¯°¥¤¥«¨¬ ¢­¥¸­¾¾ ±³¬¬³ ¤«¨­ ¤«¿ ½²®£® ¦¥ ¤¥°¥¢  ª ª ±³¬¬³ £«³¡¨­ ¢±¥µ ¥£®
«¨±²¼¥¢. ³±²¼ n | ·¨±«® ¢­³²°¥­­¨µ ¢¥°¸¨­ ² ª®£® ¤¥°¥¢ , i ¨ e
| ¢­³²°¥­­¿¿ ¨ ¢­¥¸­¿¿ ±³¬¬» ¤«¨­. ®ª ¦¨²¥, ·²® e = i + 2n.
5.5-7? ¯°¥¤¥«¨¬ À¢¥±Á «¨±²  ¢ ¤¢®¨·­®¬ ¤¥°¥¢¥ ª ª 2;d , £¤¥ d |
¥£® £«³¡¨­ . ®ª ¦¨²¥, ·²® ±³¬¬  ¢¥±®¢ ¢±¥µ «¨±²¼¥¢ ¢ ¤¢®¨·­®¬
¤¥°¥¢¥ ­¥ ¯°¥¢®±µ®¤¨² 1 (­¥° ¢¥­±²¢® ° ´² , Kraft inequality)
5.5-8? ®ª ¦¨²¥, ·²® ¢ «¾¡®¬ ¤¢®¨·­®¬ ¤¥°¥¢¥ ± L «¨±²¼¿¬¨ ¬®¦­® ­ ©²¨ ¯®¤¤¥°¥¢®, ·¨±«® «¨±²¼¥¢ ¢ ª®²®°®¬ ­ µ®¤¨²±¿ ­  ®²°¥§ª¥
[L=3; 2L=3].

 ¤ ·¨
5-1  ±ª° ±ª  £° ´ 
 §®¢¥¬ k-° ±ª° ±ª®© ­¥®°¨¥­²¨°®¢ ­­®£® £° ´  (V; E ) ´³­ª¶¨¾ c : V ! f0; 1; : : :; k ; 1g, ¤«¿ ª®²®°®£® c(u) 6= c(v ) ¤«¿ «¾¡»µ
¤¢³µ ±¬¥¦­»µ ¢¥°¸¨­ u ¨ v . (®­¶» «¾¡®£® °¥¡°  ¤®«¦­» ¨¬¥²¼
° §­»¥ ¶¢¥² .)
 . ®ª ¦¨²¥, ·²® «¾¡®¥ ¤¥°¥¢® ¨¬¥¥² 2-° ±ª° ±ª³.

100

« ¢  5 ­®¦¥±²¢ 

¡. ®ª ¦¨²¥, ·²® ±«¥¤³¾¹¨¥ ±¢®©±²¢  ­¥®°¨¥­²¨°®¢ ­­®£® £° ´  G ° ¢­®±¨«¼­»:
1. ° ´ G ¤¢³¤®«¼­»©.
2. ° ´ G ¨¬¥¥² 2-° ±ª° ±ª³.
3. ° ´ G ­¥ ¨¬¥¥² ¶¨ª«®¢ ­¥·¥²­®© ¤«¨­».
¢. ³±²¼ d | ¬ ª±¨¬ «¼­ ¿ ±²¥¯¥­¼ ¢¥°¸¨­ ­¥®°¨¥­²¨°®¢ ­­®£®
£° ´  G. ®ª ¦¨²¥, ·²® G ¨¬¥¥² (d + 1)-° ±ª° ±ª³.
£.p®ª ¦¨²¥, ·²® ¥±«¨ £° ´ G ¨¬¥¥² O(jV j) °¥¡¥°, ²® G ¨¬¥¥²
O( jV j)-° ±ª° ±ª³.
5-2 ° ´» ¨ «¾¤¨
¥°¥¢¥¤¨²¥ ­  ¿§»ª ­¥®°¨¥­²¨°®¢ ­­»µ £° ´®¢ ±«¥¤³¾¹¨¥
³²¢¥°¦¤¥­¨¿ ¨ ¤®ª ¦¨²¥ ¨µ. (°¥¤¯®« £ ¥²±¿, ·²® ®²­®¸¥­¨¥
À¡»²¼ ¤°³£®¬Á ±¨¬¬¥²°¨·­®, ¨ ·¥«®¢¥ª ­¥ ¢ª«¾· ¥²±¿ ¢ ·¨±«®
±¢®¨µ ¤°³§¥©.)
 .  «¾¡®© ª®¬¯ ­¨¨ ¨§ n > 2 ·¥«®¢¥ª ­ ©¤³²±¿ ¤¢  ·¥«®¢¥ª  ±
®¤¨­ ª®¢»¬ ·¨±«®¬ ¤°³§¥© (±°¥¤¨ ¯°¨±³²±²¢³¾¹¨µ).
¡.  «¾¡®© £°³¯¯¥ ¨§ 6 ·¥«®¢¥ª ¬®¦­® ­ ©²¨ «¨¡® ²°¥µ ·¥«®¢¥ª,
¿¢«¿¾¹¨µ±¿ ¤°³§¼¿¬¨ ¤°³£ ¤°³£ , «¨¡® ²°¥µ ·¥«®¢¥ª, ­¨ª ª¨¥ ¤¢®¥
¨§ ª®²®°»µ ­¥ ¿¢«¿¾²±¿ ¤°³§¼¿¬¨.
¢. ¾¡³¾ ª®¬¯ ­¨¾ «¾¤¥© ¬®¦­® ° §¢¥±²¨ ¯® ¤¢³¬ ª®¬­ ² ¬
² ª, ·²® ¤«¿ ª ¦¤®£® ·¥«®¢¥ª  ª ª ¬¨­¨¬³¬ ¯®«®¢¨­  ¥£® ¤°³§¥©
®ª ¦³²±¿ ¢ ¤°³£®© ª®¬­ ²¥.
£. ±«¨ ¢ ª®¬¯ ­¨¨ ¨§ n ·¥«®¢¥ª ³ ª ¦¤®£® ­¥ ¬¥­¥¥ n=2 ¤°³§¥©,
²® ½²³ ª®¬¯ ­¨¾ ¬®¦­® ° ±± ¤¨²¼ §  ª°³£«»¬ ±²®«®¬ ² ª, ·²®¡»
ª ¦¤»© ±¨¤¥« ¬¥¦¤³ ¤¢³¬¿ ±¢®¨¬¨ ¤°³§¼¿¬¨.
5-3  §¡¨¥­¨¥ ¤¥°¥¢¼¥¢ ­  · ±²¨
­®£¨¥  «£®°¨²¬» ­  £° ´ µ, ¤¥©±²¢³¾¹¨¥ ¯® ¯°¨­¶¨¯³ À° §¤¥«¿© ¨ ¢« ±²¢³©Á, ¤¥«¿² £° ´ ­  ¤¢¥ · ±²¨, ¯°¨ ½²®¬ ¦¥« ²¥«¼­®
³¤ «¿²¼ ª ª ¬®¦­® ¬¥­¼¸¥ °¥¡¥° ¨ ¯®«³·¨²¼ ¤¢¥ · ±²¨ ¯® ¢®§¬®¦­®±²¨ ¡«¨§ª®£® ° §¬¥° .
 . ®ª ¦¨²¥, ·²® ¢ «¾¡®¬ ¤¢®¨·­®¬ ¤¥°¥¢¥ ± n ¢¥°¸¨­ ¬¨ ¬®¦­®
­ ©²¨ °¥¡°®, ¯®±«¥ ³¤ «¥­¨¿ ª®²®°®£® ¯®«³· ²±¿ ¤¢¥ · ±²¨ ° §¬¥° 
­¥ ¡®«¼¸¥ 3n=4 ª ¦¤ ¿.
¡. ®ª ¦¨²¥, ·²® ª®­±² ­²³ 3=4 ¢ ¯³­ª²¥ ( ) ­¥«¼§¿ ³«³·¸¨²¼,
¯°¨¢¥¤¿ ¯°¨¬¥° ¤¢®¨·­®£® ¤¥°¥¢ , ¤«¿ ª®²®°®£® ¯®±«¥ ³¤ «¥­¨¿
«¾¡®£® °¥¡°  ¢ ®¤­®© ¨§ · ±²¥© ®±² ¥²±¿ ­¥ ¬¥­¥¥ 3n=4 ¢¥°¸¨­.
¢. ®ª ¦¨²¥, ·²® ¬­®¦¥±²¢® ¢¥°¸¨­ «¾¡®£® ¤¢®¨·­®£® ¤¥°¥¢  ±
n ¢¥°¸¨­ ¬¨ ¬®¦­® ° §¡¨²¼ ­  ¤¢¥ · ±²¨ A ¨ B ² ª¨¬ ®¡° §®¬,
·²® jAj = bn=2c, jB j = dn=2e,   ·¨±«® °¥¡¥°, ±®¥¤¨­¿¾¹¨µ ¢¥°¸¨­»
¨§ ° §­»µ · ±²¥©, ¥±²¼ O(lg n).

 ¬¥· ­¨¿ ª £« ¢¥ 5

101

 ¬¥· ­¨¿
±­®¢ ²¥«¼ ±¨¬¢®«¨·¥±ª®© «®£¨ª¨ ³«¼ (G. Boole) ¢¢¥« ¬­®£¨¥ ¨§ ­»­¥¸­¨µ ²¥®°¥²¨ª®-¬­®¦¥±²¢¥­­»µ ®¡®§­ ·¥­¨© ¢ ª­¨£¥,
®¯³¡«¨ª®¢ ­­®© ¢ 1854 £®¤³. ®¢°¥¬¥­­ ¿ ²¥®°¨¿ ¬­®¦¥±²¢ (¯°¥¦¤¥ ¢±¥£® ²¥®°¨¿ ¬®¹­®±²¥© ¡¥±ª®­¥·­»µ ¬­®¦¥±²¢) ¡»«  ±®§¤ ­ 
 ­²®°®¬ (G. Cantor) ¢ 1874{1895 £®¤ µ. ¥°¬¨­ À´³­ª¶¨¿Á ¨±¯®«¼§®¢ « ¥©¡­¨¶ (G.W. Leibnitz) ¢ ¯°¨¬¥­¥­¨¨ ª ­¥ª®²®°»¬ ¬ ²¥¬ ²¨·¥±ª¨¬ ´®°¬³« ¬. ¯°¥¤¥«¥­¨¥ ´³­ª¶¨¨ ¢¯®±«¥¤±²¢¨¨ ¬­®£®ª° ²­® ®¡®¡¹ «®±¼. ¥®°¨¿ £° ´®¢ ¢®±µ®¤¨² ª 1736 £®¤³, ª®£¤ 
©«¥° (L. Euler) ¯®ª § «, ·²® ­¥¢®§¬®¦­® ¯°®©²¨ ¯® ¢±¥¬ ±¥¬¨ ¬®±² ¬ £®°®¤  ¥­¨£±¡¥°£  ¯® ®¤­®¬³ ° §³ ¨ ¢¥°­³²¼±¿ ¢ ¨±µ®¤­³¾
²®·ª³.
®«¥§­»¬ ±¯° ¢®·­¨ª®¬ ¯® ®¯°¥¤¥«¥­¨¿¬ ¨ °¥§³«¼² ² ¬ ²¥®°¨¨
£° ´®¢ ¿¢«¿¥²±¿ ª­¨£   ° °¨ [94].

6

®¬¡¨­ ²®°¨ª  ¨ ¢¥°®¿²­®±²¼

 ½²®© £« ¢¥ ¨§« £ ¾²±¿ ­ · «  ª®¬¡¨­ ²®°¨ª¨ ¨ ²¥®°¨¨ ¢¥°®¿²­®±²¥©. ±«¨ ¢» §­ ª®¬» ± ­¨¬¨, ±®¢¥²³¥¬ ¯°®±¬®²°¥²¼ ­ · «®
£« ¢» ¨ ¢­¨¬ ²¥«¼­® ¯°®·¥±²¼ ¯®±«¥¤­¨¥ ° §¤¥«». ­®£¨¥ £« ¢»
½²®© ª­¨£¨ ­¥ ¨±¯®«¼§³¾² ²¥®°¨¾ ¢¥°®¿²­®±²¥©, ­® ª®¥-£¤¥ ®­ 
­¥®¡µ®¤¨¬ .
 §¤¥« 6.1 ­ ¯®¬¨­ ¥² ®±­®¢­»¥ ´ ª²» ª®¬¡¨­ ²®°¨ª¨ (¢ ²®¬
·¨±«¥ ´®°¬³«» ¤«¿ ¯¥°¥±² ­®¢®ª ¨ ±®·¥² ­¨©).  §¤¥« 6.2 ±®¤¥°¦¨²  ª±¨®¬» ¢¥°®¿²­®±²¨ ¨ ®±­®¢­»¥ ´ ª²» ® ° ±¯°¥¤¥«¥­¨¿µ ¢¥°®¿²­®±²¥©.  ° §¤¥«¥ 6.3 ®¯°¥¤¥«¿¾²±¿ ¯®­¿²¨¿ ±«³· ©­®© ¢¥«¨·¨­», ¥¥ ¬ ²¥¬ ²¨·¥±ª®£® ®¦¨¤ ­¨¿ ¨ ¤¨±¯¥°±¨¨.  §¤¥« 6.4 ¯®±¢¿¹¥­ £¥®¬¥²°¨·¥±ª®¬³ ¨ ¡¨­®¬¨ «¼­®¬³ ° ±¯°¥¤¥«¥­¨¿¬. ±±«¥¤®¢ ­¨¥ ¡¨­®¬¨ «¼­®£® ° ±¯°¥¤¥«¥­¨¿ ¯°®¤®«¦ ¥²±¿ ¢ ° §¤¥«¥ 6.5
(®¶¥­ª  Àµ¢®±²®¢Á).  ¯®±«¥¤­¥¬ ° §¤¥«¥ 6.6 ¯°¨¬¥­¥­¨¥ ²¥®°¨¨ ¢¥°®¿²­®±²¥© ¨««¾±²°¨°³¥²±¿ ­  ¯°¨¬¥°¥ ²°¥µ § ¤ ·: ¯ ° ¤®ª±  ¤­¿
°®¦¤¥­¨¿, ±«³· ©­®£® ° ±¯°¥¤¥«¥­¨¿ ¸ °®¢ ¯® ³°­ ¬ ¨ ®¶¥­ª¨ ¤«¨­» ¢»¨£°»¸­»µ ³· ±²ª®¢ ¯°¨ ¡°®± ­¨¨ ¬®­¥²».

6.1. ®¤±·¥² ª®«¨·¥±²¢
­®£¤  ¬®¦­® ­ ©²¨ ·¨±«® ¯°¥¤¬¥²®¢ ®¯°¥¤¥«¥­­®£® ¢¨¤ , ­¥
¯¥°¥·¨±«¿¿ ¨µ ¢±¥.  ¯°¨¬¥°, «¥£ª® ­ ©²¨ ·¨±«® ¢±¥µ n-¡¨²®¢»µ
±²°®ª ¨«¨ ¢±¥µ ¯¥°¥±² ­®¢®ª n ®¡º¥ª²®¢.  ½²®¬ ° §¤¥«¥ ¬» ° ±±¬®²°¨¬ ®±­®¢­»¥ ¬¥²®¤» ² ª®£® ¯®¤±·¥² . °¥¤¯®« £ ¥²±¿, ·²®
·¨² ²¥«¼ §­ ª®¬ ± ¯®­¿²¨¿¬¨ ²¥®°¨¨ ¬­®¦¥±²¢ (±¬. ° §¤. 5.1).
° ¢¨«  ±³¬¬» ¨ ¯°®¨§¢¥¤¥­¨¿
­®¦¥±²¢®, ª®«¨·¥±²¢® ½«¥¬¥­²®¢ ª®²®°®£® ¬» µ®²¨¬ ¯®¤±·¨² ²¼, · ±²® ¬®¦¥² ¡»²¼ ¯°¥¤±² ¢«¥­® ¢ ¢¨¤¥ ®¡º¥¤¨­¥­¨¿ ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ¬­®¦¥±²¢ ¨«¨ ¤¥ª °²®¢  ¯°®¨§¢¥¤¥­¨¿ ¬­®¦¥±²¢.
° ¢¨«® ±³¬¬» (rule of sum) £« ±¨², ·²® jA [ B j = jAj + jB j
¤«¿ ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ª®­¥·­»µ ¬­®¦¥±²¢ A ¨ B (· ±²­»© ±«³· © ´®°¬³«» (5.3)). ±«¨ ±¨¬¢®« ­  ­®¬¥°¥ ¬ ¸¨­» ¤®«¦¥­ ¡»²¼

®¤±·¥² ª®«¨·¥±²¢

103

«¨¡® « ²¨­±ª®© ¡³ª¢®©, «¨¡® ¶¨´°®©, ²® ¢±¥£® ¥±²¼ 26 + 10 = 36
¢®§¬®¦­®±²¥©, ² ª ª ª ¡³ª¢ 26,   ¶¨´° 10.
° ¢¨«® ¯°®¨§¢¥¤¥­¨¿ (rule of product) ³²¢¥°¦¤ ¥², ·²® jA 
Bj = jAj  jB j ¤«¿ ª®­¥·­»µ ¬­®¦¥±²¢ A ¨ B, ±¬. (5.4).  ¯°¨¬¥°,
¨¬¥¿ 28 ±®°²®¢ ¬®°®¦¥­®£® ¨ 4 ¢¨¤  ±¨°®¯ , ¬®¦­® ¨§£®²®¢¨²¼
28  4 = 112 ¢ °¨ ­²®¢ ¬®°®¦¥­®£® ± ±¨°®¯®¬ (­¥ ±¬¥¸¨¢ ¿ ° §­»¥
±®°²  ¬®°®¦¥­®£® ¨ ±¨°®¯ ).
²°®ª¨
²°®ª®© (string; ¯®-°³±±ª¨ £®¢®°¿² ² ª¦¥ ® ±«®¢ µ) ­ §»¢ ¾² ª®­¥·­³¾ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ½«¥¬¥­²®¢ ­¥ª®²®°®£® ª®­¥·­®£® ¬­®¦¥±²¢  S (­ §»¢ ¥¬®£®  «´ ¢¨²®¬).  ¯°¨¬¥°, ±³¹¥±²¢³¥² 8 ¤¢®¨·­»µ (±®±² ¢«¥­­»µ ¨§ ­³«¥© ¨ ¥¤¨­¨¶) ±²°®ª ¤«¨­» 3:
000; 001; 010; 011; 100; 101; 110; 111:
­®£¤  ±²°®ª³ ¤«¨­» k ­ §»¢ ¾² k-±²°®ª®© (k-string). ®¤±²°®ª®© (substring) s0 ±²°®ª¨ s ­ §»¢ ¥²±¿ ¯°®¨§¢®«¼­ ¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¨¤³¹¨µ ¯®¤°¿¤ ½«¥¬¥­²®¢ ±²°®ª¨ s. ®¢®°¿ ® k-¯®¤±²°®ª¥
(k-substring), ¨¬¥¾² ¢ ¢¨¤³ ¯®¤±²°®ª³ ¤«¨­» k.  ª, 010 ¿¢«¿¥²±¿
3-¯®¤±²°®ª®© ±²°®ª¨ 01101001 (®­  ­ ·¨­ ¥²±¿ ± ¯®§¨¶¨¨ 4),   111
| ­¥².
²°®ª  ¤«¨­» k ¨§ ½«¥¬¥­²®¢ ¬­®¦¥±²¢  S ¿¢«¿¥²±¿ ½«¥¬¥­²®¬
¯°¿¬®£® ¯°®¨§¢¥¤¥­¨¿ S k , ² ª ·²® ¢±¥£® ±³¹¥±²¢³¥² jS jk ±²°®ª ¤«¨­» k.  · ±²­®±²¨, ¨¬¥¥²±¿ 2k ¤¢®¨·­»µ ±²°®ª ¤«¨­» k. ²® ¬®¦­® ®¡º¿±­¨²¼ ¥¹¥ ¨ ² ª: ¯¥°¢»© ½«¥¬¥­² ±²°®ª¨ ¬®¦­® ¢»¡° ²¼
jS j ±¯®±®¡ ¬¨; ¤«¿ ª ¦¤®£® ¨§ ­¨µ ¥±²¼ jS j ¢ °¨ ­²®¢ ¯°®¤®«¦¥­¨¿, ¨ ² ª ¤ «¥¥ | ¢±¥£® k ¢»¡®°®¢, ¯®«³· ¥²±¿ jS j  jS j  : : :  jS j
(k ¬­®¦¨²¥«¥©) ¢ °¨ ­²®¢.
¥°¥±² ­®¢ª¨
¥°¥±² ­®¢ª®© (permutation) ª®­¥·­®£® ¬­®¦¥±²¢  S ­ §»¢ ¥²±¿ ³¯®°¿¤®·¥­­ ¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¢±¥µ ¥£® ½«¥¬¥­²®¢, ¢ ª®²®°®© ª ¦¤»© ½«¥¬¥­² ¢±²°¥· ¥²±¿ °®¢­® ®¤¨­ ° §.  ª, ±³¹¥±²¢³¥²
6 ¯¥°¥±² ­®¢®ª ¬­®¦¥±²¢  S = fa; b; cg :

abc; acb; bac; bca; cab; cba:
±¥£® ¨¬¥¥²±¿ n! ¯¥°¥±² ­®¢®ª ¬­®¦¥±²¢  ¨§ n ½«¥¬¥­²®¢, ² ª
ª ª ¯¥°¢»© ½«¥¬¥­² ¯¥°¥±² ­®¢ª¨ ¬®¦­® ¢»¡° ²¼ n ±¯®±®¡ ¬¨,
¢²®°®© n ; 1 ±¯®±®¡ ¬¨, ²°¥²¨© n ; 2 ±¯®±®¡ ¬¨, ¨ ². ¤.

104

« ¢  6 ®¬¡¨­ ²®°¨ª  ¨ ¢¥°®¿²­®±²¼

 §¬¥¹¥­¨¿ ¡¥§ ¯®¢²®°¥­¨©
±«¨ ª ¦¤»© ½«¥¬¥­² ¬®¦­® ¨±¯®«¼§®¢ ²¼ ²®«¼ª® ®¤¨­ ° §, ­®
­¥ ²°¥¡³¥²±¿ ¨±¯®«¼§®¢ ²¼ ¢±¥ ½«¥¬¥­²», £®¢®°¿² ® ° §¬¥¹¥­¨¿µ
¡¥§ ¯®¢²®°¥­¨©. ³±²¼ ´¨ª±¨°®¢ ­® ¬­®¦¥±²¢® S ¨§ n ½«¥¬¥­²®¢
¨ ­¥ª®²®°®¥ k, ­¥ ¯°¥¢®±µ®¤¿¹¥¥ n.  §¬¥¹¥­¨¥¬ ¡¥§ ¯®¢²®°¥­¨©
¨§ n ¯® k ­ §»¢ ¾² ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¤«¨­» k, ±®±² ¢«¥­­³¾
¨§ ° §«¨·­»µ ½«¥¬¥­²®¢ S . (­£«¨©±ª¨© ²¥°¬¨­ | k-permutation.)
¨±«® ² ª¨µ ° §¬¥¹¥­¨© ° ¢­®
(6.1)
n(n ; 1)(n ; 2)    (n ; k + 1) = (n ;n! k)!
² ª ª ª ±³¹¥±²¢³¥² n ±¯®±®¡®¢ ¢»¡®°  ¯¥°¢®£® ½«¥¬¥­² , n ; 1 ±¯®±®¡®¢ ¢»¡®°  ¢²®°®£® ½«¥¬¥­² , ¨ ² ª ¤ «¥¥ ¤® k-£® ½«¥¬¥­² , ª®²®°»© ¬®¦­® ¢»¡° ²¼ n ; k + 1 ±¯®±®¡ ¬¨.
 ¯°¨¬¥°, ±³¹¥±²¢³¥² 12 = 4  3 ¯®±«¥¤®¢ ²¥«¼­®±²¥© ¨§ ¤¢³µ
° §«¨·­»µ ½«¥¬¥­²®¢ ¬­®¦¥±²¢  fa; b; c; dg:

ab; ac; ad; ba; bc; bd; ca; cb; cd; da; db; dc:
 ±²­»¬ ±«³· ¥¬ ½²®© ´®°¬³«» ¿¢«¿¥²±¿ ´®°¬³«  ¤«¿ ·¨±«  ¯¥°¥±² ­®¢®ª (¯®±ª®«¼ª³ ¯¥°¥±² ­®¢ª¨ ¿¢«¿¾²±¿ · ±²­»¬ ±«³· ¥¬
° §¬¥¹¥­¨© ¯°¨ n = k).
®·¥² ­¨¿
®·¥² ­¨¿¬¨ (k-combinations) ¨§ n ½«¥¬¥­²®¢ ¯® k ­ §»¢ ¾²±¿ k½«¥¬¥­²­»¥ ¯®¤¬­®¦¥±²¢  ª ª®£®-«¨¡® n-½«¥¬¥­²­®£® ¬­®¦¥±²¢ .
 ¯°¨¬¥°, ³ ¬­®¦¥±²¢  fa; b; c; dg ¨§ 4 ½«¥¬¥­²®¢ ¨¬¥¥²±¿ 6 ¤¢³µ½«¥¬¥­²­»µ ¯®¤¬­®¦¥±²¢

fa; bg; fa; cg; fa; dg; fb; cg; fb; dg; fc; dg:
¨±«® ±®·¥² ­¨© ¨§ n ¯® k ¢ k! ° § ¬¥­¼¸¥ ·¨±«  ° §¬¥¹¥­¨© ¡¥§
¯®¢²®°¥­¨© (¤«¿ ²¥µ ¦¥ n ¨ k), ² ª ª ª ¨§ ª ¦¤®£® k-±®·¥² ­¨¿
¬®¦­® ±¤¥« ²¼ k! ° §¬¥¹¥­¨© ¡¥§ ¯®¢²®°¥­¨©, ¯¥°¥±² ¢«¿¿ ¥£® ½«¥-

¬¥­²». ®½²®¬³ ¨§ ´®°¬³«» (6.1) ±«¥¤³¥², ·²® ·¨±«® ±®·¥² ­¨©
¨§ n ¯® k ° ¢­®
n! :
(6.2)
k!(n ; k)!
«¿ k = 0 ½²  ´®°¬³«  ¤ ¥² 1, ª ª ¨ ¤®«¦­® ¡»²¼ (¥±²¼ °®¢­® ®¤­®
¯³±²®¥ ¯®¤¬­®¦¥±²¢®; ­ ¯®¬­¨¬, ·²® 0! = 1).

®¤±·¥² ª®«¨·¥±²¢

105

¨­®¬¨ «¼­»¥ ª®½´´¨¶¨¥­²»
«¿ ·¨±«  ±®·¥² ­¨© ¨§ n;¯® k ¨±¯®«¼§³¥²±¿ ®¡®§­ ·¥­¨¥ Cnk ¨«¨
(¢  ­£«¨©±ª®© «¨²¥° ²³°¥) nk :
 

(6.3)
= nk = k!(nn;! k)! :
²  ´®°¬³«  ±¨¬¬¥²°¨·­  ®²­®±¨²¥«¼­® § ¬¥­» k ­  n ; k :

Cnk

Cnk = Cnn;k :

(6.4)

¨±«  Cnk ¨§¢¥±²­» ² ª¦¥ ª ª ¡¨­®¬¨ «¼­»¥ ª®½´´¨¶¨¥­²» (binomial coecients), ¯®¿¢«¿¾¹¨¥±¿ ¢ ¡¨­®¬¥ ¼¾²®­  (binomial expansion):
(x + y )n =

n
X

k=0
(x + y )n ,

Cnk xk yn;k

(6.5)

(¥±«¨ ° ±ª°»²¼ ±ª®¡ª¨ ¢
²® ª®«¨·¥±²¢® ·«¥­®¢, ±®¤¥°¦ ¹¨µ k ¬­®¦¨²¥«¥© x ¨ n ; k ¬­®¦¨²¥«¥© y , ° ¢­® ª®«¨·¥±²¢³
±¯®±®¡®¢ ¢»¡° ²¼ k ¬¥±² ¨§ n, ². ¥. Cnk ).
°¨ x = y = 1 ¡¨­®¬ ¼¾²®­  ¤ ¥²
2n =

n
X
k=0

Cnk :

(6.6)

(®¬¡¨­ ²®°­»© ±¬»±«: 2n ¤¢®¨·­»µ ±²°®ª ¤«¨­» n ±£°³¯¯¨°®¢ ­» ¯® ·¨±«³ ¥¤¨­¨¶: ¨¬¥¥²±¿ ª ª ° § Cnk ±²°®ª ± k ¥¤¨­¨¶ ¬¨.)
³¹¥±²¢³¥² ¬­®£® ²®¦¤¥±²¢ ± ¡¨­®¬¨ «¼­»¬¨ ª®½´´¨¶¨¥­² ¬¨
(­¥ª®²®°»¥ ¨§ ­¨µ ¯°¥¤« £ ¾²±¿ ¢ ª ·¥±²¢¥ ³¯° ¦­¥­¨© ¢ ª®­¶¥
½²®£® ° §¤¥« ).
¶¥­ª¨ ¡¨­®¬¨ «¼­»µ ª®½´´¨¶¨¥­²®¢
 ­¥ª®²®°»µ ±«³· ¿µ ­ ¬ ¯®­ ¤®¡¨²±¿ ®¶¥­¨²¼ ¢¥«¨·¨­³ ¡¨­®¬¨ «¼­»µ ª®½´´¨¶¨¥­²®¢. «¿ 1 6 k 6 n ¨¬¥¥¬ ®¶¥­ª³ ±­¨§³
Cnk = n(n ;k(1)k ; 1)(n ;  1k + 1)



 
n
n
;
1
n
;
k
+
1
= k k ;1 
1
 k
> nk :

(6.7)

106

« ¢  6 ®¬¡¨­ ²®°¨ª  ¨ ¢¥°®¿²­®±²¼

±¯®«¼§³¿ ­¥° ¢¥­±²¢® k! > ( ke )k , ¿¢«¿¾¹¥¥±¿ ±«¥¤±²¢¨¥¬ ´®°¬³«» ²¨°«¨­£  (2.12), ¯®«³· ¥¬ ®¶¥­ª³ ±¢¥°µ³
Cnk = n(n ;k(1)k ; 1)(n ;  1k + 1)
k

6 nk!
 k
6 en
k :

(6.8)
(6.9)

«¿ ¢±¥µ 0 6 k 6 n ¬®¦­® ¯® ¨­¤³ª¶¨¨ (±¬. ³¯°. 6.1-12) ¤®ª § ²¼
®¶¥­ª³
n
Cnk 6 kk (n ;n k)n;k ;

(6.10)

£¤¥ ° ¤¨ ³¤®¡±²¢  § ¯¨±¨ ¯®« £ ¥¬ 00 = 1. «¿ k = n, £¤¥ 0 6  6
1, ½²  ®¶¥­ª  ¬®¦¥² ¡»²¼ § ¯¨± ­  ª ª
n
Cnn 6 (n)n((1 n; )n)(1;)n

=

  

1



= 2nH ();
£¤¥ ¢¥«¨·¨­ 

1

1;

1; !n

(6.11)
(6.12)

H () = ; lg  ; (1 ; ) lg(1 ; )

(6.13)
­ §»¢ ¥²±¿ (¤¢®¨·­®©) ¸¥­­®­®¢±ª®© ½­²°®¯¨¥©, ¯®- ­£«¨©±ª¨ (binary) entropy function.  ½²®© § ¯¨±¨ ¬» ¯®« £ ¥¬ 0 lg 0 = 0, ² ª
·²® H (0) = H (1) = 0.
¯° ¦­¥­¨¿
6.1-1 ª®«¼ª® ±³¹¥±²¢³¥² k-¯®¤±²°®ª ±²°®ª¨ ¤«¨­» n? (®¤±²°®ª¨, ­ ·¨­ ¾¹¨¥±¿ ± ° §«¨·­»µ ¯®§¨¶¨© ±²°®ª¨, ±·¨² ¾²±¿
° §­»¬¨.) ª ª®¢® ®¡¹¥¥ ·¨±«® ¯®¤±²°®ª ±²°®ª¨ ¤«¨­» n?
6.1-2 ³«¥¢  ´³­ª¶¨¿ (boolean function) ± n ¢µ®¤ ¬¨ ¨ m ¢»µ®¤ ¬¨ | ½²® ´³­ª¶¨¿, ®¯°¥¤¥«¥­­ ¿ ­  ¬­®¦¥±²¢¥ ftrue; falsegn ±®
§­ ·¥­¨¿¬¨ ¢ ¬­®¦¥±²¢¥ ftrue; falsegm . ª®«¼ª® ±³¹¥±²¢³¥² ° §«¨·­»µ ¡³«¥¢»µ ´³­ª¶¨© ± n ¢µ®¤ ¬¨ ¨ ®¤­¨¬ ¢»µ®¤®¬?  ¡³«¥¢»µ
´³­ª¶¨© ± n ¢µ®¤ ¬¨ ¨ m ¢»µ®¤ ¬¨?
6.1-3 ª®«¼ª¨¬¨ ±¯®±®¡ ¬¨ n (° §«¨·­»µ) ¯°®´¥±±®°®¢ ¬®£³²
° ±¯®«®¦¨²¼±¿ §  ª°³£«»¬ ±²®«®¬? ¯®±®¡», ®²«¨· ¾¹¨¥±¿ ¯®¢®°®²®¬, ±·¨² ¾²±¿ ®¤¨­ ª®¢»¬¨.

®¤±·¥² ª®«¨·¥±²¢

107

6.1-4 ª®«¼ª¨¬¨ ±¯®±®¡ ¬¨ ¬®¦­® ¢»¡° ²¼ ²°¨ ° §«¨·­»µ ·¨±«  ¨§ ¬­®¦¥±²¢  f1; 2; : : :; 100g ² ª, ·²®¡» ¨µ ±³¬¬  ¡»«  ·¥²­®©?
(®°¿¤®ª ¢»¡®°  ±³¹¥±²¢¥­.)
6.1-5 ®ª ¦¨²¥ ²®¦¤¥±²¢®
¤«¿ 0 < k 6 n.
6.1-6

Cnk = nk Cnk;;11

(6.14)

®ª ¦¨²¥ ²®¦¤¥±²¢®

Cnk = n ;n k Cnk;1

¤«¿ 0 6 k < n.
6.1-7 »¡¨° ¿ k ¯°¥¤¬¥²®¢ ¨§ n, ¬®¦­® ®²¬¥²¨²¼ ®¤¨­ ¨§ ¯°¥¤¬¥²®¢ ¨ ±«¥¤¨²¼, ¢»¡° ­ ®­ ¨«¨ ­¥². ±¯®«¼§³¿ ½²® ®¡±²®¿²¥«¼±²¢®,
¤®ª ¦¨²¥, ·²®
Cnk = Cnk;1 + Cnk;;11 :
6.1-8 ±¯®«¼§³¿ °¥§³«¼² ² ³¯° ¦­¥­¨¿ 6.1-7, ±®±² ¢¼²¥ ² ¡«¨¶³
¤«¿ Cnk ¯°¨ n = 0; 1; 2; : : :; 6 ¨ ¯°¨ k ®² 0 ¤® n ¢ ¢¨¤¥ ° ¢­®¡¥¤°¥­­®£® ²°¥³£®«¼­¨ª  (C00 ±¢¥°µ³, C10 ¨ C11 ¢ ±«¥¤³¾¹¥© ±²°®ª¥,
¨ ² ª ¤ «¥¥). ²®² ²°¥³£®«¼­¨ª ­ §»¢ ¾² ²°¥³£®«¼­¨ª®¬  ±ª «¿
(Pascal's triangle).
6.1-9

®ª ¦¨²¥ ° ¢¥­±²¢®

n
X
i=1

i = Cn2+1:

6.1-10 ®ª ¦¨²¥, ·²® ¤«¿ ´¨ª±¨°®¢ ­­®£® n > 0 ¢¥«¨·¨­  Cnk
¤®±²¨£ ¥² ­ ¨¡®«¼¸¥£® (±°¥¤¨ ¢±¥µ k ®² 0 ¤® n) §­ ·¥­¨¿ ¯°¨ k =
bn=2c ¨ ¯°¨ k = dn=2e (² ª ·²® ¤«¿ ·¥²­®£® n ¬ ª±¨¬³¬ ®¤¨­,  
¤«¿ ­¥·¥²­®£® | ¤¢  ±²®¿¹¨µ °¿¤®¬).
6.1-11? ®ª ¦¨²¥, ·²® ¤«¿ «¾¡»µ n > 0, j > 0, k > 0, j + k 6 n
¢»¯®«­¥­® ­¥° ¢¥­±²¢®

Cnj+k 6 Cnj Cnk;j

± ¯®¬®¹¼¾ ª®¬¡¨­ ²®°­»µ ° ±±³¦¤¥­¨©,   ² ª¦¥ ± ¨±¯®«¼§®¢ ­¨¥¬ ´®°¬³«» (6.3).  ª ª¨µ ±«³· ¿µ ½²® ­¥° ¢¥­±²¢® ®¡° ¹ ¥²±¿ ¢
° ¢¥­±²¢®?
6.1-12? ®ª ¦¨²¥ ¯® ¨­¤³ª¶¨¨ ­¥° ¢¥­±²¢® (6.10) ¤«¿ k 6 n=2;
§ ²¥¬, ¨±¯®«¼§³¿ (6.4), ¤®ª ¦¨²¥ ¥£® ¤«¿ ¢±¥µ k 6 n.

108

« ¢  6 ®¬¡¨­ ²®°¨ª  ¨ ¢¥°®¿²­®±²¼

6.1-13? ±¯®«¼§³¿ ´®°¬³«³ ²¨°«¨­£ , ¤®ª ¦¨²¥, ·²®
2n
C n = p2 (1 + O(1=n)):
2n

n

(6.16)

6.1-14? ¨´´¥°¥­¶¨°³¿ H (), ¯®ª ¦¨²¥, ·²® ¬ ª±¨¬³¬ ¤®±²¨£ ¥²±¿ ¯°¨  = 1=2. ¥¬³ ° ¢­® H (1=2)?

6.2. ¥°®¿²­®±²¼
 ½²®¬ ° §¤¥«¥ ¬» ­ ¯®¬­¨¬ ®±­®¢­»¥ ¯®­¿²¨¿ ²¥®°¨¨ ¢¥°®¿²­®±²¥©.
³±²¼ § ¤ ­® ­¥ª®²®°®¥ ¬­®¦¥±²¢® S , ª®²®°®¥ ¬» ­ §»¢ ¥¬ ¢¥°®¿²­®±²­»¬ ¯°®±²° ­±²¢®¬ (sample space),   ¥£® ½«¥¬¥­²» | ½«¥¬¥­² °­»¬¨ ±®¡»²¨¿¬¨ (elementary events).  ¦¤»© ¨§ ½«¥¬¥­²®¢
¬®¦¥² ° ±±¬ ²°¨¢ ²¼±¿ ª ª ¢®§¬®¦­»© ¨±µ®¤ ¨±¯»² ­¨¿.  ¯°¨¬¥°, ¡°®± ­¨¾ ¤¢³µ ° §«¨·­»µ ¬®­¥² ±®®²¢¥²±²¢³¥² ¢¥°®¿²­®±²­®¥ ¯°®±²° ­±²¢®, ±®¤¥°¦ ¹¥¥ ·¥²»°¥ ±²°®ª¨ ¤«¨­» 2, ±®±² ¢«¥­­»¥ ¨§ ±¨¬¢®«®¢ ® (®°¥«) ¨ ° (°¥¸ª ):
S = f®®; ®°; °®; °°g
®¡»²¨¥¬ (event) ­ §»¢ ¥²±¿ ¯®¤¬­®¦¥±²¢® ¯°®±²° ­±²¢  S .
 ¯°¨¬¥°, ¢ ­ ¸¥¬ ¯°¨¬¥°¥ ¬®¦­® ° ±±¬®²°¥²¼ ±®¡»²¨¥ À¢»¯ «
®¤¨­ ®°¥« ¨ ®¤­  °¥¸ª Á, ². ¥. ¬­®¦¥±²¢® f®°; °®g.
®¡»²¨¥ S (¢±¥ ¢¥°®¿²­®±²­®¥ ¯°®±²° ­±²¢®) ­ §»¢ ¥²±¿ ¤®±²®¢¥°­»¬ ±®¡»²¨¥¬ (certain event),   ±®¡»²¨¥ ? ­ §»¢ ¥²±¿ ­¥¢®§¬®¦­»¬ ±®¡»²¨¥¬ (null event). ®¡»²¨¿ A ¨ B ­ §»¢ ¾²±¿ ­¥±®¢¬¥±²­»¬¨ (mutually exclusive), ¥±«¨ A \ B = ?.  ¦¤®¥ ½«¥¬¥­² °­®¥ ±®¡»²¨¥ s 2 S ¬» ¡³¤¥¬ ±·¨² ²¼ ±®¡»²¨¥¬ fsg  S .  §«¨·­»¥
½«¥¬¥­² °­»¥ ±®¡»²¨¿ ­¥±®¢¬¥±²­».
ª § ­­®¥ ®²­®±¨²±¿ ¡¥§ ®£®¢®°®ª ª ±«³· ¾ ª®­¥·­®£® ¨«¨
±·¥²­®£® ¬­®¦¥±²¢  S .  ®¡¹¥¬ ±«³· ¥ ®¯°¥¤¥«¥­¨¥ ±«®¦­¥¥, ¨ ±®¡»²¨¿¬¨ ±·¨² ¾²±¿ ­¥ ¢±¥ ¯®¤¬­®¦¥±²¢  ¬­®¦¥±²¢  S ,   ²®«¼ª®
­¥ª®²®°»¥. ­¨ ¤®«¦­» ®¡° §®¢»¢ ²¼  - «£¥¡°³ (¯¥°¥±¥·¥­¨¥ ¨
®¡º¥¤¨­¥­¨¥ ±·¥²­®£® ·¨±«  ±®¡»²¨© ¥±²¼ ±®¡»²¨¥; ¤®¯®«­¥­¨¥ ±®¡»²¨¿ ¥±²¼ ±®¡»²¨¥). » ­¥ ¡³¤¥¬ £®¢®°¨²¼ ®¡ ½²®¬ ¯®¤°®¡­®,
µ®²¿ ­¥ª®²®°»¥ ¯°¨¬¥°» ² ª®£® °®¤  (° ¢­®¬¥°­®¥ ° ±¯°¥¤¥«¥­¨¥
­  ®²°¥§ª¥) ­ ¬ ¢±²°¥²¿²±¿.
ª±¨®¬» ¢¥°®¿²­®±²¨
 ±¯°¥¤¥«¥­¨¥¬ ¢¥°®¿²­®±²¥© (probability distribution) ­  ¢¥°®¿²­®±²­®¬ ¯°®±²° ­±²¢¥ S ­ §»¢ ¥²±¿ ´³­ª¶¨¿ P, ±² ¢¿¹ ¿ ¢ ±®®²¢¥²±²¢¨¥ ª ¦¤®¬³ ±®¡»²¨¾ ­¥ª®²®°®¥ ­¥®²°¨¶ ²¥«¼­®¥ ·¨±«®

¥°®¿²­®±²¼

109

¨ ³¤®¢«¥²¢®°¿¾¹ ¿ ±«¥¤³¾¹¨¬ ²°¥¡®¢ ­¨¿¬ ( ª±¨®¬ ¬ ¢¥°®¿²­®±²¨, ¯®- ­£«¨©±ª¨ probability axioms):
1. PA > 0 ¤«¿ «¾¡®£® ±®¡»²¨¿ A.
2. PfS g = 1.
3. PfA [ B g = PfAg + PfB g ¤«¿ «¾¡»µ ¤¢³µ ­¥±®¢¬¥±²­»µ ±®¡»²¨© A ¨ B , ¨, ¡®«¥¥ ²®£®,

Pf[i Ai g =

X

i

PfAi g:

¤«¿ «¾¡®© (ª®­¥·­®© ¨«¨ ±·¥²­®©) ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¯®¯ °­® ­¥±®¢¬¥±²­»µ ±®¡»²¨© A1; A2; : : :
¨±«® PfAg ­ §»¢ ¥²±¿ ¢¥°®¿²­®±²¼¾ ±®¡»²¨¿ A (probability of
the event A).  ¬¥²¨¬, ·²®  ª±¨®¬  2 ´¨ª±¨°³¥² À¥¤¨­¨¶³ ¨§¬¥°¥­¨¿Á ¢¥°®¿²­®±²¥©, ¯°¨­¨¬ ¿ §  1 ¢¥°®¿²­®±²¼ ¤®±²®¢¥°­®£® ±®¡»²¨¿.
®² ­¥±ª®«¼ª® ¯°®±²»µ ±«¥¤±²¢¨© ¨§ ½²¨µ  ª±¨®¬. ¥¢®§¬®¦­®¥
±®¡»²¨¥ ¨¬¥¥² ­³«¥¢³¾ ¢¥°®¿²­®±²¼ Pf?g = 0. ±«¨ A  B , ²®
PfAg 6 PfB g. ±¯®«¼§³¿ ®¡®§­ ·¥­¨¥ A ¤«¿ ±®¡»²¨¿ S ; A (¤®¯®«­¥­¨¥ ª A), ¨¬¥¥¬ PfAg = 1 ; PfAg. «¿ «¾¡»µ ¤¢³µ ±®¡»²¨© A ¨
B ¨¬¥¥² ¬¥±²®
PfA [ B g = PfAg + PfB g ; PfA \ B g
(6.17)
6 PfAg + PfBg:
(6.18)
 ­ ¸¥¬ ¯°¨¬¥°¥ ± ¡°®± ­¨¥¬ ¤¢³µ ¬®­¥², ¯®«®¦¨¬ ¢¥°®¿²­®±²¼
ª ¦¤®£® ½«¥¬¥­² °­®£® ¨±µ®¤  ° ¢­®© 1=4. ®£¤  ¢¥°®¿²­®±²¼ ¢»¯ ¤¥­¨¿ ¯® ª° ©­¥© ¬¥°¥ ®¤­®£® ®°«  ¡³¤¥²
Pf®®; ®°; °®g = Pf®®g + Pf®°g + Pf°®g
= 3=4:
­ ·¥: ¢¥°®¿²­®±²¼ ²®£®, ·²® ­¥ ¡³¤¥² ­¨ ®¤­®£® ®°« , ° ¢­ 
Pf°°g = 1=4, ¯®½²®¬³ ¢¥°®¿²­®±²¼ ¯®¿¢«¥­¨¿ ¯® ¬¥­¼¸¥© ¬¥°¥ ®¤­®£® ®°«  ¥±²¼ 1 ; 1=4 = 3=4.
6.2.1. ¨±ª°¥²­®¥ ° ±¯°¥¤¥«¥­¨¥ ¢¥°®¿²­®±²¥©
 ±¯°¥¤¥«¥­¨¥ ¢¥°®¿²­®±²¥© ­  ª®­¥·­®¬ ¨«¨ ±·¥²­®¬ ¢¥°®¿²­®±²­®¬ ¯°®±²° ­±²¢¥ ­ §»¢ ¥²±¿ ¤¨±ª°¥²­»¬ (discrete). «¿ ² ª¨µ ° ±¯°¥¤¥«¥­¨© ¬®¦­® ­ ¯¨± ²¼

PfAg =

X

s2 A

Pfsg;

¤«¿ «¾¡®£® ±®¡»²¨¿ A, ¯®±ª®«¼ª³ ®­® ¿¢«¿¥²±¿ ®¡º¥¤¨­¥­¨¥¬ ­¥
¡®«¥¥ ·¥¬ ±·¥²­®£® ¬­®¦¥±²¢  ­¥±®¢¬¥±²­»µ ½«¥¬¥­² °­»µ ±®¡»²¨©. ±«¨ ¬­®¦¥±²¢® S ª®­¥·­® ¨ ¢±¥ ½«¥¬¥­²» ¥£® ° ¢­®¢¥°®¿²­»,

110

« ¢  6 ®¬¡¨­ ²®°¨ª  ¨ ¢¥°®¿²­®±²¼

²® ¯®«³· ¥²±¿ ° ¢­®¬¥°­®¥ ° ±¯°¥¤¥«¥­¨¥ ¢¥°®¿²­®±²¥© (uniform
probability distribution) ­  ª®­¥·­®¬ ¬­®¦¥±²¢¥ S . °¨ ½²®¬ ¢¥°®¿²­®±²¼ «¾¡®£® ±®¡»²¨¿, ¢ª«¾· ¾¹¥£® ¢ ±¥¡¿ k ½«¥¬¥­² °­»µ
¨±µ®¤®¢ ¨§ jS j, ° ¢­  k=jS j.  ² ª¨µ ±«³· ¿µ £®¢®°¿² À¢»¡¥°¥¬ ±«³· ©­® ½«¥¬¥­² s 2 S Á.
 ª ·¥±²¢¥ ¯°¨¬¥°  ° ±±¬®²°¨¬ ¡°®± ­¨¥ ±¨¬¬¥²°¨·­®© ¬®­¥²» (ipping a fair coin), ¤«¿ ª®²®°®© ¢¥°®¿²­®±²¨ ®°«  ¨ °¥¸ª¨
®¤¨­ ª®¢» ¨ ° ¢­» 1=2. °®± ¿ ¥¥ n ° §, ¬» ¯°¨µ®¤¨¬ ª ° ¢­®¬¥°­®¬³ ° ±¯°¥¤¥«¥­¨¾ ­  ¯°®±²° ­±²¢¥ S = f®; °gn , ±®±²®¿¹¥¬
¨§ 2n ½«¥¬¥­²®¢.  ¦¤®¥ ½«¥¬¥­² °­®¥ ±®¡»²¨¥ ¨§ S ¬®¦­® ° ±±¬ ²°¨¢ ²¼ ª ª ±²°®ª³ ¤«¨­» n ½«¥¬¥­²®¢ ¬­®¦¥±²¢  f®; °g, ¨ ¢±¥
² ª¨¥ ±²°®ª¨ ¨¬¥¾² ¢¥°®¿²­®±²¼ 1=2n . ®¡»²¨¥

A = f¢»¯ «® k ®°«®¢ ¨ n ; k °¥¸¥ªg
¥±²¼ ¯®¤¬­®¦¥±²¢® S ¨ ±®±²®¨² ¨§ jAj = Cnk ½«¥¬¥­²®¢, ² ª ª ª
±³¹¥±²¢³¥² Cnk ±²°®ª, ±®¤¥°¦ ¹¨µ °®¢­® k ®°«®¢. ¥¬ ± ¬»¬, ¢¥°®¿²­®±²¼ ±®¡»²¨¿ A ° ¢­  PfAg = Cnk =2n.
¥¯°¥°»¢­®¥ ° ¢­®¬¥°­®¥ ° ±¯°¥¤¥«¥­¨¥ ¢¥°®¿²­®±²¥©
³¤¥¬ ±·¨² ²¼ ½«¥¬¥­² °­»¬¨ ¨±µ®¤ ¬¨ ²®·ª¨ ­¥ª®²®°®£® ®²°¥§ª  [a; b]. ¯°¥¤¥«¨¬ ¢¥°®¿²­®±²¼ ±®¡»²¨¿ [c; d]  [a; b] ´®°¬³«®©

Pf[c; d]g = bd ;; ac :
 ½²®¬ ±«³· ¥, ª ª ¬» £®¢®°¨«¨, ­ ¤® ±·¨² ²¼ ±®¡»²¨¿¬¨ ­¥ ¢±¥
¯®¤¬­®¦¥±²¢  ®²°¥§ª ,   ²®«¼ª® ­¥ª®²®°»¥, ª®²®°»¥ ­ §»¢ ¾² ¨§¬¥°¨¬»¬¨. » ­¥ ¯°¨¢®¤¨¬ ±®®²¢¥²±²¢³¾¹¨µ ®¯°¥¤¥«¥­¨©, ®²±»« ¿ ·¨² ²¥«¿ ª «¾¡®¬³ ³·¥¡­¨ª³ ¯® ²¥®°¨¨ ¢¥°®¿²­®±²¥© ¨«¨ ¯®
²¥®°¨¨ ¬¥°».
 ¬¥²¨¬, ·²® ¢¥°®¿²­®±²¼ ª ¦¤®© ²®·ª¨ ° ¢­  0, ¨ ¯®²®¬³ ¢¥°®¿²­®±²¼ ¯®«³¨­²¥°¢ «  (c; d] ¨ ¨­²¥°¢ «  (c; d) ¬®£³² ¡»²¼ ®¯°¥¤¥«¥­» ²®© ¦¥ ´®°¬³«®©.
 ª®¥ ° ±¯°¥¤¥«¥­¨¥ ¢¥°®¿²­®±²¥© ­ §»¢ ¾² ­¥¯°¥°»¢­»¬ ° ¢­®¬¥°­»¬ ° ±¯°¥¤¥«¥­¨¥¬ (continuous uniform probability distribution).
±«®¢­ ¿ ¢¥°®¿²­®±²¼ ¨ ­¥§ ¢¨±¨¬®±²¼
­®£¤  ¬» ° ±¯®« £ ¥¬ · ±²¨·­®© ¨­´®°¬ ¶¨¥© ® °¥§³«¼² ²¥
½ª±¯¥°¨¬¥­² .  ¯°¨¬¥°, ¯³±²¼ ­ ¬ ¨§¢¥±²­®, ·²® ¢ °¥§³«¼² ²¥
¡°®± ­¨¿ ¤¢³µ ±¨¬¬¥²°¨·­»µ ¬®­¥² ¯® ª° ©­¥© ¬¥°¥ ®¤­  ¨§ ­¨µ
¢»¯ «  ®°«®¬.  ª®¢  ¢¥°®¿²­®±²¼ ²®£®, ·²® ®¡¥ ¬®­¥²» ¢»¯ «¨
®°«®¬? §¢¥±²­ ¿ ­ ¬ ¨­´®°¬ ¶¨¿ ¯®§¢®«¿¥² ¨±ª«¾·¨²¼ ±«³· ©

¥°®¿²­®±²¼

111

¢»¯ ¤¥­¨¿ ¤¢³µ °¥¸¥ª. °¨ ®±² ¢¸¨µ±¿ ¨±µ®¤  ¡³¤³² ° ¢­®¢¥°®¿²­», ¯®½²®¬³ ¢¥°®¿²­®±²¼ ª ¦¤®£® (¢ ²®¬ ·¨±«¥ ¨ ¨­²¥°¥±³¾¹¥£®
­ ±) ¥±²¼ 1=3.
²  ¨¤¥¿ ´®°¬ «¨§³¥²±¿ ¢ ®¯°¥¤¥«¥­¨¨ ³±«®¢­®© ¢¥°®¿²­®±²¨
(conditional probability) ±®¡»²¨¿ A ¯°¨ ³±«®¢¨¨ ±®¡»²¨¿ B ; ®­ 
®¡®§­ · ¥²±¿ PfAjB g ¨ ®¯°¥¤¥«¿¥²±¿ ´®°¬³«®©
(6.19)
PfAjB g = PfPAfB\ gB g ;
(¬» ¯°¥¤¯®« £ ¥¬, ·²® PfB g 6= 0). ­²³¨²¨¢­»© ±¬»±« ¯®­¿²¥­:
±®¡»²¨¥ B ¯°®¨±µ®¤¨² ¢ ­¥ª®²®°®© ¤®«¥ ½ª±¯¥°¨¬¥­²®¢; ¬» ±¬®²°¨¬, ª ª³¾ · ±²¼ ±°¥¤¨ ­¨µ ±®±² ¢«¿¾² ²¥, ª®£¤  ¯°®¨§®¸«® ¥¹¥
¨ ±®¡»²¨¥ A.
¢  ±®¡»²¨¿ ­ §»¢ ¾²±¿ ­¥§ ¢¨±¨¬»¬¨ (independent), ¥±«¨

PfA \ B g = PfAgPfB g;
 ±«³· ¥ PfB g 6= 0 ½²® ³±«®¢¨¥ ¬®¦­® ¯¥°¥¯¨± ²¼ ª ª
PfAjB g = PfAg:
 ­ ¸¥¬ ¯°¨¬¥°¥ ± ¤¢³ª° ²­»¬ ¡°®± ­¨¥¬ ¬®­¥²» ¯®¿¢«¥­¨¿
®°«  ¯°¨ ¯¥°¢®¬ ¨ ¢²®°®¬ ¡°®± ­¨¨ ¡³¤³² ­¥§ ¢¨±¨¬»¬¨, ² ª ª ª
ª ¦¤®¥ ±®¡»²¨¥ ¨¬¥¥² ¢¥°®¿²­®±²¼ 1=2,   ¨µ ¯¥°¥±¥·¥­¨¥ (¤¢  ®°« ) | 1=4.  ²®¬ ¦¥ ¯°¨¬¥°¥ ±®¡»²¨¿ À¯¥°¢ ¿ ¬®­¥²  ¢»¯ «  ®°«®¬Á ¨ À¢»¯ « ®¤¨­ ®°¥« ¨ ®¤­  °¥¸ª Á ² ª¦¥ ­¥§ ¢¨±¨¬», µ®²¿
½²® ±° §³ ¨ ­¥ ² ª ¿±­®. ® ¢ ½²®¬ «¥£ª® ³¡¥¤¨²¼±¿ ¯® ®¯°¥¤¥«¥­¨¾:
¢¥°®¿²­®±²¼ ª ¦¤®£® ±®¡»²¨¿ ° ¢­  1=2, ¢¥°®¿²­®±²¼ ¨µ ¯¥°¥±¥·¥­¨¿ ° ¢­  1=4.  ¢®² ±®¡»²¨¿ À¯¥°¢ ¿ ¬®­¥²  ¢»¯ «  ®°«®¬Á ¨
À¢»¯ «  µ®²¼ ®¤­  °¥¸ª Á ­¥ ¡³¤³² ­¥§ ¢¨±¨¬»¬¨.
®¡»²¨¿ À¯¥°¢ ¿ ¬®­¥²  ¢»¯ «  ®°«®¬Á ¨ À¢²®° ¿ ¬®­¥²  ¢»¯ « 
®°«®¬Á ¯¥°¥±² ­³² ¡»²¼ ­¥§ ¢¨±¨¬»¬¨, ¥±«¨ ¨§¬¥­¨²¼ ° ±¯°¥¤¥«¥­¨¥ ¢¥°®¿²­®±²¥© ¨ ±·¨² ²¼, ·²® ¬®­¥²» ±ª«¥¥­» ¨ ®¤­®¢°¥¬¥­­®
¢»¯ ¤ ¾² «¨¡® ®°«®¬, «¨¡® °¥¸ª®© (². ¥. ·²® ª®¬¡¨­ ¶¨¨ ®® ¨ °°
¨¬¥¾² ¢¥°®¿²­®±²¼ 1=2).
®¡»²¨¿ A1 ; A2; : : :; An ­ §»¢ ¾²±¿ ¯®¯ °­® ­¥§ ¢¨±¨¬»¬¨
(pairwise independent), ¥±«¨
PfAi \ Aj g = PfAi gPfAj g
¤«¿ ¢±¥µ 1 6 i < j 6 n.
®¡»²¨¿ A1 ; A2;    ; An ­ §»¢ ¾²±¿ ­¥§ ¢¨±¨¬»¬¨ ¢ ±®¢®ª³¯­®±²¨ (mutually independent), ¥±«¨ ¤«¿ «¾¡®£® ­ ¡®°  Ai ; Ai ; : : :; Aik
½²¨µ ±®¡»²¨© (§¤¥±¼ 2 6 k 6 n ¨ 1 6 i1 < i2 <    < ik 6 n) ¨¬¥¥²
¬¥±²® ° ¢¥­±²¢®
PfAi \ Ai \ : : : \ Aik g = PfAi gPfAi g    PfAik g:
1

1

2

1

2

2

112

« ¢  6 ®¬¡¨­ ²®°¨ª  ¨ ¢¥°®¿²­®±²¼

²® ²°¥¡®¢ ­¨¥ | ¡®«¥¥ ±¨«¼­®¥: ­ ¯°¨¬¥°, ¢ ­ ¸¥¬ ¯°¨¬¥°¥ ±®¡»²¨¿ À¯¥°¢ ¿ ¬®­¥²  ¢»¯ «  ®°«®¬Á, À¢²®° ¿ ¬®­¥²  ¢»¯ «  ®°«®¬Á ¨ À¤¢¥ ¬®­¥²» ¢»¯ «¨ ®¤¨­ ª®¢®Á ¯®¯ °­® ­¥§ ¢¨±¨¬», ­® ­¥
¿¢«¿¾²±¿ ­¥§ ¢¨±¨¬»¬¨ ¢ ±®¢®ª³¯­®±²¨.
®°¬³«   ©¥± 
§ ®¯°¥¤¥«¥­¨¿ ³±«®¢­®© ¢¥°®¿²­®±²¨ (6.19) ±«¥¤³¥², ·²® ¤«¿
¤¢³µ ±®¡»²¨© A ¨ B , ¢¥°®¿²­®±²¨ ª®²®°»µ ¯®«®¦¨²¥«¼­», ¢»¯®«­¥­® ° ¢¥­±²¢®

PfA \ B g = PfB gPfAjB g
= PfAgPfB jAg:

(6.20)

»° ¦ ¿ ®²±¾¤  PfAjB g, ¯®«³· ¥¬ ´®°¬³«³

PfAjB g = PfAPgfPBfBg jAg ;

(6.21)

¨§¢¥±²­³¾ ª ª ´®°¬³«   ©¥±  (Bayes's theorem). ²³ ´®°¬³«³
¬®¦­® ¯¥°¥¯¨± ²¼ ² ª: ¯®±ª®«¼ª³ B = (B \ A) [ (B \ A),   B \ A ¨
B \ A | ­¥±®¢¬¥±²­»¥ ±®¡»²¨¿, ²®

PfB g = PfB \ Ag + PfB \ Ag
= PfAgPfB jAg + PfAgPfB jAg:
®¤±² ¢«¿¿ ¤ ­­®¥ ¢»° ¦¥­¨¥ ¢ ´®°¬³«³ (6.21), ¯®«³· ¥¬ ¤°³£®©
¢ °¨ ­² ´®°¬³«»  ©¥± :
PfAgPfB jAg
PfAjB g =
:
PfAgPfB jAg + PfAgPfB jAg
®°¬³«   ©¥±  ¯®¬®£ ¥² ¢»·¨±«¿²¼ ³±«®¢­»¥ ¢¥°®¿²­®±²¨.
³±²¼ ³ ­ ± ¥±²¼ ¤¢¥ ¬®­¥²»: ®¤­  ±¨¬¬¥²°¨·­ ¿,   ¤°³£ ¿ ¢±¥£¤ 
¢»¯ ¤ ¥² ®°«®¬. » ±«³· ©­»¬ ®¡° §®¬ ¢»¡¨° ¥¬ ®¤­³ ¨§ ¤¢³µ
¬®­¥², ¯®±«¥ ·¥£® ¥¥ ¤¢ ¦¤» ¯®¤¡° ±»¢ ¥¬. °¥¤¯®«®¦¨¬, ·²® ®¡ 
° §  ¢»¯ «¨ ®°«».  ª®¢  ¢¥°®¿²­®±²¼ ²®£®, ·²® ¡»«  ¢»¡° ­ 
­¥±¨¬¬¥²°¨·­ ¿ ¬®­¥² ?
¥¸¨¬ ½²³ § ¤ ·³ ¯°¨ ¯®¬®¹¨ ´®°¬³«»  ©¥± . ³±²¼ ±®¡»²¨¥ A | ¢»¡®° ­¥±¨¬¬¥²°¨·­®© ¬®­¥²», ±®¡»²¨¥ B | ¢»¯ ¤¥­¨¥
¢»¡° ­­®© ¬®­¥²» ®°« ¬¨ ¤¢ ¦¤».  ¬ ­³¦­® ¢»·¨±«¨²¼ PfAjB g.
¬¥¥¬: PfAg = 1=2, PfB jAg = 1, PfAg = 1=2 ¨ PfB jAg = 1=4,
±«¥¤®¢ ²¥«¼­®,
1
PfB jAg = (1=2)  1(1+=2)
(1=2)  (1=4) = 4=5:

¥°®¿²­®±²¼

113

¯° ¦­¥­¨¿
6.2-1

®ª ¦¨²¥ ­¥° ¢¥­±²¢® ³«¿ (Boole's inequality):
PfA1 [ A2 [ : : : g 6 PfA1 g + PfA2 g + : : :
(6.22)
¤«¿ «¾¡®© ª®­¥·­®© ¨«¨ ±·¥²­®© ¯®±«¥¤®¢ ²¥«¼­®±²¨ ±®¡»²¨©
A1; A2; : : : .
6.2-2 °®´¥±±®° ¡°®± ¥² ±¨¬¬¥²°¨·­³¾ ¬®­¥²³,   ±²³¤¥­² ¡°®± ¥² ¡°®± ¥² ¤¢¥ ±¨¬¬¥²°¨·­»¥ ¬®­¥²».  ª®¢  ¢¥°®¿²­®±²¼ ²®£®,
·²® ³ ¯°®´¥±±®°  ¢»¯ ¤¥² ¡®«¼¸¥ ®°«®¢, ·¥¬ ³ ±²³¤¥­² ? (±¥ ²°¨
¡°®± ­¨¿ ­¥§ ¢¨±¨¬».)
6.2-3 ®«®¤³ ª °² (± ·¨±« ¬¨ ®² 1 ¤® 10) ² ±³¾² ¨ ¢»­¨¬ ¾²
²°¨ ª °²».  ª®¢  ¢¥°®¿²­®±²¼ ²®£®, ·²® ·¨±«  ­  ½²¨µ ª °² µ
¡³¤³² ¨¤²¨ ¢ ¢®§° ±² ¾¹¥¬ ¯®°¿¤ª¥?
6.2-4? ¬¥¥²±¿ ­¥±¨¬¬¥²°¨·­ ¿ ¬®­¥² , ¤«¿ ª®²®°®© ¢¥°®¿²­®±²¼
¢»¯ ¤¥­¨¿ ®°«  ¥±²¼ ­¥¨§¢¥±²­®¥ ­ ¬ ·¨±«® p (0 < p < 1). ®ª ¦¨²¥, ª ª ± ¥¥ ¯®¬®¹¼¾ ¬®¦­® ¨¬¨²¨°®¢ ²¼ ±¨¬¬¥²°¨·­³¾ ¬®­¥²³,
±¤¥« ¢ ­¥±ª®«¼ª® ¡°®± ­¨©. (ª § ­¨¥: ¡°®±¼²¥ ¬®­¥²³ ¤¢ ¦¤»; ¥±«¨ °¥§³«¼² ²» ° §­»¥, ¤ ©²¥ ®²¢¥²; ¥±«¨ ®¤¨­ ª®¢»¥, ¯®¢²®°¿©²¥
¨±¯»² ­¨¥.)
6.2-5?  ª ¨¬¨²¨°®¢ ²¼ ¡°®± ­¨¥ ¬®­¥²» ± ¢¥°®¿²­®±²¼¾ ¯®¿¢«¥­¨¿ ®°«  a=b, ¨¬¥¿ ±¨¬¬¥²°¨·­³¾ ¬®­¥²³, ª®²®°³¾ ¬®¦­® ¯®¤¡° ±»¢ ²¼ ­¥±ª®«¼ª® ° §? (¨±«  a ¨ b ¶¥«»¥, 0 < a < b, ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ·¨±«  ¡°®± ­¨© ¤®«¦­® ¡»²¼ ®£° ­¨·¥­® ±¢¥°µ³
¯®«¨­®¬®¬ ®² lg b.)
6.2-6

®ª ¦¨²¥, ·²®
PfAjB g + PfAjB g = 1:

6.2-7

®ª ¦¨²¥, ·²® ¤«¿ «¾¡®£® ­ ¡®°  ±®¡»²¨© A1 ; A2; : : :; An ,

PfA1 \ A2 \ : : : \ An g =
= PfA1g PfA2jA1 g  PfA3jA1 \ A2 g    PfAn jA1 \ A2 \   \ An;1 g:
6.2-8? °¨¤³¬ ©²¥ ¬­®¦¥±²¢® ¨§ n ¯®¯ °­® ­¥§ ¢¨±¨¬»µ ±®¡»²¨©, ¤«¿ ª®²®°®£® «¾¡®¥ ¯®¤¬­®¦¥±²¢® ¨§ k > 2 ±®¡»²¨© ­¥ ¡³¤¥²
­¥§ ¢¨±¨¬»¬ ¢ ±®¢®ª³¯­®±²¨.
6.2-9? ®¡»²¨¿ A ¨ B ¿¢«¿¾²±¿ ³±«®¢­® ­¥§ ¢¨±¨¬»¬¨ (conditionally independent) ¯°¨ ³±«®¢¨¨ ±®¡»²¨¿ C , ¥±«¨
PfA \ B jC g = PfAjC g  PfB jC g:

114

« ¢  6 ®¬¡¨­ ²®°¨ª  ¨ ¢¥°®¿²­®±²¼

°¨¤³¬ ©²¥ ¯°®±²®© (­® ­¥ ²°¨¢¨ «¼­»©) ¯°¨¬¥° ¤¢³µ ±®¡»²¨©,
ª®²®°»¥ ­¥ ¿¢«¿¾²±¿ ­¥§ ¢¨±¨¬»¬¨, ­® ³±«®¢­® ­¥§ ¢¨±¨¬» ¯°¨
³±«®¢¨¨ ­¥ª®²®°®£® ²°¥²¼¥£® ±®¡»²¨¿.
6.2-10? » ³· ±²¢³¥²¥ ¢ ¨£°¥, ¢ ª®²®°®© ¯°¨§ ±ª°»² §  ®¤­®© ¨§
²°¥µ ¸¨°¬ (¨ ¢»¨£° ¥²¥ ¯°¨§, ¥±«¨ ®²£ ¤ ¥²¥, £¤¥). ®±«¥ ²®£®
ª ª ¢» ¢»¡° «¨ ®¤­³ ¨§ ¸¨°¬, ¢¥¤³¹¨© ¨£°» ®²ª°»« ®¤­³ ¨§ ¤¢³µ
®±² ¢¸¨µ±¿ ¸¨°¬, ¨ ®ª § «®±¼, ·²® ² ¬ ¯°¨§  ­¥².  ½²®² ¬®¬¥­²
¬®¦­® ¯®¬¥­¿²¼ ±¢®© ¢»¡®°, ³ª § ¢ ­  ²°¥²¼¾ ¸¨°¬³.  ª ¨§¬¥­¿²±¿ ¸ ­±» ­  ¢»¨£°»¸, ¥±«¨ ¢» ±¤¥« ¥²¥ ½²®?
6.2-11?  · «¼­¨ª ²¾°¼¬» ¢»¡° « ®¤­®£® ¨§ ²°¥µ § ª«¾·¥­­»µ
X , Y ¨ Z , ·²®¡» ®²¯³±²¨²¼ ¥£® ­  ¢®«¾. ±² «¼­»¥ ¤¢®¥ ¡³¤³² ª §­¥­». ²° ¦ §­ ¥², ª²® ¨§ ²°®¨µ ¢»©¤¥² ­  ±¢®¡®¤³, ­® ­¥ ¨¬¥¥²
¯° ¢  ±®®¡¹ ²¼ ­¨ª ª®¬³ ¨§ ³§­¨ª®¢ ¨­´®°¬ ¶¨¾ ® ¥£® ±³¤¼¡¥.
 ª«¾·¥­­»© X ¯°®±¨² ±²° ¦  ­ §¢ ²¼ ¥¬³ ¨¬¿ ®¤­®£® ¨§ § ª«¾·¥­­»µ Y ¨«¨ Z , ª®²®°»© ¡³¤¥² ª §­¥­, ®¡º¿±­¿¿, ·²® ¥¬³ ¨
² ª ¨§¢¥±²­®, ·²® ®¤¨­ ¨§ ­¨µ ²®·­® ¡³¤¥² ª §­¥­,  , §­ ·¨², ®­
­¥ ¯®«³·¨² ­¨ª ª®© ¨­´®°¬ ¶¨¨ ® ±¢®¥© ±³¤¼¡¥. ²° ¦ ±®®¡¹ ¥² X , ·²® Y ¡³¤¥² ª §­¥­.  ª«¾·¥­­»© X ° ¤³¥²±¿, ±·¨² ¿, ·²®
¥£® ¸ ­±» ®±² ²¼±¿ ¢ ¦¨¢»µ ¢®§°®±«¨ ¤® 1=2 (®±¢®¡®¦¤¥­ ¡³¤¥²
¨«¨ ®­, ¨«¨ Z ). ° ¢ «¨ ®­?

6.3. ¨±ª°¥²­»¥ ±«³· ©­»¥ ¢¥«¨·¨­»
¨±ª°¥²­ ¿ ±«³· ©­ ¿ ¢¥«¨·¨­  (discrete random variable) X |
½²® ´³­ª¶¨¿, ®²®¡° ¦ ¾¹ ¿ ª®­¥·­®¥ ¨«¨ ±·¥²­®¥ ¢¥°®¿²­®±²­®¥
¯°®±²° ­±²¢® S ¢ ¬­®¦¥±²¢® ¤¥©±²¢¨²¥«¼­»µ ·¨±¥«.  ¦¤®¬³ ¢®§¬®¦­®¬³ ¨±µ®¤³ ¨±¯»² ­¨¿ ®­  ±² ¢¨² ¢ ±®®²¢¥²±²¢¨¥ ¤¥©±²¢¨²¥«¼­®¥ ·¨±«®. (¥¬ ± ¬»¬ ­  ¬­®¦¥±²¢¥ §­ ·¥­¨© ´³­ª¶¨¨ X ¢®§­¨ª ¥² ° ±¯°¥¤¥«¥­¨¥ ¢¥°®¿²­®±²¥©.)
 ²¥®°¨¨ ¢¥°®¿²­®±²¥© ° ±±¬ ²°¨¢ ¾² ¨ ±«³· ©­»¥ ¢¥«¨·¨­»
­  ­¥±·¥²­»µ ¢¥°®¿²­®±²­»µ ¯°®±²° ­±²¢ µ, ­® ½²® ±«®¦­¥¥, ¨ ¬»
®¡®©¤¥¬±¿ ¡¥§ ­¨µ.
«¿ ±«³· ©­®© ¢¥«¨·¨­» X ¨ ¤¥©±²¢¨²¥«¼­®£® ·¨±«  x ®¯°¥¤¥«¿¥¬ ±®¡»²¨¥ X = x ª ª fs 2 S : X (s) = xg; ¢¥°®¿²­®±²¼ ½²®£®
±®¡»²¨¿ ° ¢­ 

PfX = xg =
³­ª¶¨¿

X

fs2S :X (s)=xg

f (x) = PfX = xg

Pfsg:

­ §»¢ ¥²±¿ ´³­ª¶¨¥© ° ±¯°¥¤¥«¥­¨¿ ¢¥°®¿²­®±²¥© (probability
density function) ±«³· ©­®© ¢¥«¨·¨­» X . §  ª±¨®¬ ¢¥°®¿²­®±²¨

¨±ª°¥²­»¥ ±«³· ©­»¥ ¢¥«¨·¨­»

115

P

±«¥¤³¥², ·²® PfX = xg > 0 ¨ x PfX = xg = 1.
«¿ ¯°¨¬¥°  ° ±±¬®²°¨¬ ¡°®± ­¨¥ ¯ °» ®¡»·­»µ ¸¥±²¨£° ­­»µ ª®±²¥©. ¬¥¥²±¿ 36 ½«¥¬¥­² °­»µ ±®¡»²¨©, ±®±² ¢«¿¾¹¨µ ¢¥°®¿²­®±²­®¥ ¯°®±²° ­±²¢®. ³¤¥¬ ¯°¥¤¯®« £ ²¼, ·²® ¢±¥ ®­¨ ° ¢­®¢¥°®¿²­»: Pfsg = 1=36. ¯°¥¤¥«¨¬ ±«³· ©­³¾ ¢¥«¨·¨­³ X , ª ª
¬ ª±¨¬ «¼­®¥ ·¨±«®, ¢»¯ ¢¸¥¥ ­  ®¤­®© ¨§ ¤¢³µ ª®±²¥©. ®£¤ 
PfX = 3g = 5=36, ² ª ª ª X ¯°¨­¨¬ ¥² §­ ·¥­¨¥ 3 ¯°¨ 5 ½«¥¬¥­² °­»µ ¨±µ®¤ µ (  ¨¬¥­­®, (1; 3), (2; 3), (3; 3), (3; 2) ¨ (3; 1)).
 ª ¯° ¢¨«®, ­  ®¤­®¬ ¨ ²®¬ ¦¥ ¢¥°®¿²­®±²­®¬ ¯°®±²° ­±²¢¥
° ±±¬ ²°¨¢ ¾² ­¥±ª®«¼ª® ±«³· ©­»µ ¢¥«¨·¨­. ±«¨ X ¨ Y | ±«³· ©­»¥ ¢¥«¨·¨­», ²® ´³­ª¶¨¿

f (x; y) = PfX = x; Y = y g
­ §»¢ ¥²±¿ ´³­ª¶¨¥© ±®¢¬¥±²­®£® ° ±¯°¥¤¥«¥­¨¿ ¢¥°®¿²­®±²¥©
(joint probability density function) ¢¥«¨·¨­ X ¨ Y . «¿ ´¨ª±¨°®¢ ­­®£® §­ ·¥­¨¿ y

PfY = y g =

X

x

PfX = x; Y = y g:

­ «®£¨·­®, ¤«¿ ´¨ª±¨°®¢ ­­®£® §­ ·¥­¨¿ x,

PfX = xg =

X

y

PfX = x; Y = y g:

±¯®«¼§³¿ ®¯°¥¤¥«¥­¨¥ ³±«®¢­®© ¢¥°®¿²­®±²¨ (6.19), ¬®¦­® § ¯¨± ²¼
PfX = xjY = y g = PfXP=fYx;=Yy g= y g :

¢¥ ±«³· ©­»¥ ¢¥«¨·¨­» ­ §»¢ ¾²±¿ ­¥§ ¢¨±¨¬»¬¨ (independent),
¥±«¨ ±®¡»²¨¿ X = x ¨ Y = y ¿¢«¿¾²±¿ ­¥§ ¢¨±¨¬»¬¨ ¤«¿ «¾¡»µ
§­ ·¥­¨© x ¨ y , ¤°³£¨¬¨ ±«®¢ ¬¨, ¥±«¨ ¥±«¨ PfX = x; Y = y g =
PfX = xgPfY = y g ¤«¿ ¢±¥µ x ¨ y .
ª« ¤»¢ ¿ ¨ ³¬­®¦ ¿ ±«³· ©­»¥ ¢¥«¨·¨­», ®¯°¥¤¥«¥­­»¥ ­  ®¤­®¬ ¨ ²®¬ ¦¥ ¢¥°®¿²­®±²­®¬ ¯°®±²° ­±²¢¥, ¬» ¯®«³· ¥¬ ­®¢»¥
±«³· ©­»¥ ¢¥«¨·¨­», ®¯°¥¤¥«¥­­»¥ ­  ²®¬ ¦¥ ¯°®±²° ­±²¢¥.
 ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ±«³· ©­®© ¢¥«¨·¨­»
°®±²¥©¸ ¿ ¨ ­ ¨¡®«¥¥ · ±²® ¨±¯®«¼§³¥¬ ¿ µ ° ª²¥°¨±²¨ª  ±«³· ©­®© ¢¥«¨·¨­» | ½²® ¥¥ ±°¥¤­¥¥ (mean), ­ §»¢ ¥¬®¥ ² ª¦¥ ¬ ²¥¬ ²¨·¥±ª¨¬ ®¦¨¤ ­¨¥¬ (expected value, expectation). «¿ ¤¨±ª°¥²­®© ±«³· ©­®© ¢¥«¨·¨­» X ®­® ®¯°¥¤¥«¿¥²±¿ ´®°¬³«®©

M[X ] =

X

x

xPfX = xg;

(6.23)

116

« ¢  6 ®¬¡¨­ ²®°¨ª  ¨ ¢¥°®¿²­®±²¼

¨ ±³¹¥±²¢³¥², ª®£¤  ½²®² °¿¤ ¨¬¥¥² ª®­¥·­®¥ ·¨±«® ·«¥­®¢ ¨«¨
 ¡±®«¾²­® ±µ®¤¨²±¿. ­®£¤  ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ®¡®§­ · ¥²±¿ X ¨«¨ ¯°®±²® , ¥±«¨ ¨§ ª®­²¥ª±²  ¿±­®, ® ª ª®© ±«³· ©­®©
¢¥«¨·¨­¥ ¨¤¥² °¥·¼.
³±²¼ ¢ ¨£°¥ ¤¢ ¦¤» ¡°®± ¾² ±¨¬¬¥²°¨·­³¾ ¬®­¥²³; ¢» ¯®«³· ¥²¥ 3 °³¡«¿ §  ª ¦¤®£® ¢»¯ ¢¸¥£® ®°«  ¨ ®²¤ ¥²¥ 2 °³¡«¿ § 
ª ¦¤³¾ ¢»¯ ¢¸³¾ °¥¸ª³. »¨£°»¸ X ¡³¤¥² ±«³· ©­®© ¢¥«¨·¨­®©, ¨ ¥¥ ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ¡³¤¥² ° ¢­®
M[X ] = 6  Pf2 ®°« g + 1  Pf1 ®°¥« ¨ 1 °¥¸ª g ; 4  Pf2 °¥¸ª¨g
= 6(1=4) + 1(1=2) ; 4(1=4)
= 1:
 ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ±³¬¬» ±«³· ©­»µ ¢¥«¨·¨­ ° ¢­® ±³¬¬¥ ¨µ ®¦¨¤ ­¨©:
M[X + Y ] = M[X ] + M[Y ];
(6.24)
¥±«¨ M[X ] ¨ M[Y ] ®¯°¥¤¥«¥­». ²® ¯° ¢¨«® ¬®¦­® ° ±¯°®±²° ­¨²¼
­  «¾¡»¥ ª®­¥·­»¥ ¨  ¡±®«¾²­® ±µ®¤¿¹¨¥±¿ ¡¥±ª®­¥·­»¥ ±³¬¬».
³±²¼ X | ±«³· ©­ ¿ ¢¥«¨·¨­ ,   g (x) | ¯°®¨§¢®«¼­ ¿ ´³­ª¶¨¿.
®£¤  ¬®¦­® ° ±±¬®²°¥²¼ ±«³· ©­³¾ ¢¥«¨·¨­³ g (X ) (­  ²®¬ ¦¥
¢¥°®¿²­®±²­®¬ ¯°®±²° ­±²¢¥). ¥ ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ (¥±«¨
®­® ®¯°¥¤¥«¥­®) ¬®¦­® ­ ©²¨ ¯® ´®°¬³«¥

M[g (X )] =

X

x

g (x)PfX = xg:

«¿ ´³­ª¶¨¨ g (x) = ax, £¤¥ a | ­¥ª®²®° ¿ ª®­±² ­² , ¨¬¥¥¬
M[aX ] = aM[X ]:
(6.25)
¢  ¯®±«¥¤­¨µ ±¢®©±²¢  ¬®¦­® ±ª®¬¡¨­¨°®¢ ²¼ ¢ ®¤­®© ´®°¬³«¥
(±¢®©±²¢® «¨­¥©­®±²¨): ¤«¿ «¾¡»µ ¤¢³µ ±«³· ©­»µ ¢¥«¨·¨­ X ¨ Y
¨ «¾¡®© ª®­±² ­²» a
M[aX + Y ] = aM[X ] + M[Y ]:
(6.26)
±«¨ ¤¢¥ ±«³· ©­»¥ ¢¥«¨·¨­» X ¨ Y ­¥§ ¢¨±¨¬» ¨ ¨µ ¬ ²¥¬ ²¨·¥±ª¨¥ ®¦¨¤ ­¨¿ ®¯°¥¤¥«¥­», ²®

M[XY ] =
=

XX

x

y

x

y

XX

=(

X

x

xy PfX = x; Y = y g
xy PfX = xgPfY = yg
X

xPfX = xg)(

= M[X ]M[Y ]:

y

y PfY = y g)

¨±ª°¥²­»¥ ±«³· ©­»¥ ¢¥«¨·¨­»

117

®«¥¥ ®¡¹®, ¥±«¨ ¨¬¥¥²±¿ n ­¥§ ¢¨±¨¬»µ ¢ ±®¢®ª³¯­®±²¨ ±«³· ©­»µ ¢¥«¨·¨­ X1; X2; : : :; Xn, ¨¬¥¾¹¨µ ¬ ²¥¬ ²¨·¥±ª¨¥ ®¦¨¤ ­¨¿,
²®
M[X1X2    Xn ] = M[X1]M[X2]    M[Xn ]:
(6.27)
±«¨ ±«³· ©­ ¿ ¢¥«¨·¨­  X ¬®¦¥² ¯°¨­¨¬ ²¼ ²®«¼ª® ­ ²³° «¼­»¥ §­ ·¥­¨¿ (0; 1; 2; : : : ), ²® ¨¬¥¥²±¿ ª° ±¨¢ ¿ ´®°¬³«  ¤«¿ ¥¥ ¬ ²¥¬ ²¨·¥±ª®£® ®¦¨¤ ­¨¿:

M[X ] =
=
=

1
X
i=0
1
X
i=0
1
X
i=1

iPfX = ig
i(PfX > ig ; PfX > i + 1g)
PfX > ig:

(6.28)

 ± ¬®¬ ¤¥«¥, ª ¦¤»© ·«¥­ PfX > ig ¯°¨±³²±²¢³¥² ¢ ±³¬¬¥ i ° §
±® §­ ª®¬ ¯«¾± ¨ i ; 1 ° § ±® §­ ª®¬ ¬¨­³± (¨±ª«¾·¥­¨¥ ±®±² ¢«¿¥²
·«¥­ PfX > 0g, ¢®¢±¥ ®²±³²±²¢³¾¹¨© ¢ ±³¬¬¥).
¨±¯¥°±¨¿ ¨ ±² ­¤ °²­®¥ ®²ª«®­¥­¨¥
¨±¯¥°±¨¿ (variance) ±«³· ©­®© ¢¥«¨·¨­» X ± ¬ ²¥¬ ²¨·¥±ª¨¬
®¦¨¤ ­¨¥¬ M[X ] ®¯°¥¤¥«¿¥²±¿ ª ª
D[X ] = M[(X ; M[X ])2]
= M[X 2 ; 2X M[X ] + M2[X ]]
= M[X 2] ; 2M[X M[X ]] + M2[X ]
= M[X 2] ; 2M2[X ] + M2[X ]
= M[X 2] ; M2[X ]:
(6.29)
¥°¥µ®¤» M[M2[X ]] = M2 [X ] ¨ M[X M[X ]] = M2 [X ] § ª®­­», ² ª
ª ª M[X ] | ½²® ·¨±«® (  ­¥ ±«³· ©­ ¿ ¢¥«¨·¨­ ) ¨ ¬®¦­® ±®±« ²¼±¿
­  (6.25), ¯®« £ ¿ a = M[X ]. ®°¬³«³ (6.29) ¬®¦­® ¯¥°¥¯¨± ²¼ ² ª:
M[X 2] = D[X ] + M2 [X ]
(6.30)
°¨ ³¢¥«¨·¥­¨¨ ±«³· ©­®© ¢¥«¨·¨­» ¢ a ° § ¥¥ ¤¨±¯¥°±¨¿ ° ±²¥²
¢ a2 ° §:
D[aX ] = a2D[X ]:
±«¨ X ¨ Y ­¥§ ¢¨±¨¬», ²®
D[X + Y ] = D[X ] + D[Y ]:

118

« ¢  6 ®¬¡¨­ ²®°¨ª  ¨ ¢¥°®¿²­®±²¼

®«¥¥ ®¡¹®, ¤¨±¯¥°±¨¿ ±³¬¬» n ¯®¯ °­® ­¥§ ¢¨±¨¬»µ ±«³· ©­»µ
¢¥«¨·¨­ X1; : : :; Xn ° ¢­  ±³¬¬¥ ¨µ ¤¨±¯¥°±¨©:

D

"
n
X

i=1

#

Xi =

n
X
i=1

D[Xi]:

(6.31)

² ­¤ °²­»¬ ®²ª«®­¥­¨¥¬ (standard deviation) ±«³· ©­®© ¢¥«¨·¨­» X ­ §»¢ ¥²±¿ ª¢ ¤° ²­»© ª®°¥­¼ ¨§ ¥¥ ¤¨±¯¥°±¨¨.  ±²®
±² ­¤ °²­®¥ ®²ª«®­¥­¨¥ ±«³· ©­®© ¢¥«¨·¨­» ®¡®§­ · ¥²±¿ X ¨«¨
¯°®±²®  , ¥±«¨ ¨§ ª®­²¥ª±²  ¿±­®, ® ª ª®© ±«³· ©­®© ¢¥«¨·¨­¥ ¨¤¥²
°¥·¼.  ½²®© § ¯¨±¨ ¤¨±¯¥°±¨¿ ®¡®§­ · ¥²±¿  2 .
¯° ¦­¥­¨¿
6.3-1 ®¤¡° ±»¢ ¾²±¿ ¤¢¥ ®¡»·­»¥ ¸¥±²¨£° ­­»¥ ª®±²¨. ¥¬³
° ¢­® ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ±³¬¬» ¢»¯ ¢¸¨µ ·¨±¥«? ¥¬³
° ¢­® ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ¬ ª±¨¬³¬  ¨§ ¤¢³µ ¢»¯ ¢¸¨µ ·¨±¥«?
6.3-2  ¬ ±±¨¢¥ A[1 : :n] ¨¬¥¥²±¿ n ° ±¯®«®¦¥­­»µ ¢ ±«³· ©­®¬
¯®°¿¤ª¥ ° §«¨·­»µ ·¨±¥«; ¢±¥ ¢®§¬®¦­»¥ ° ±¯®«®¦¥­¨¿ ·¨±¥« ° ¢­®¢¥°®¿²­». ¥¬³ ° ¢­® ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ­®¬¥°  ¬¥±² ,
­  ª®²®°®¬ ­ µ®¤¨²±¿ ¬ ª±¨¬ «¼­»© ½«¥¬¥­²? ®¬¥°  ¬¥±² , ­ 
ª®²®°®¬ ­ µ®¤¨²±¿ ¬¨­¨¬ «¼­»© ½«¥¬¥­²?
6.3-3  ª®°®¡®·ª¥ «¥¦ ² ²°¨ ¨£° «¼­»¥ ª®±²¨. £°®ª ±² ¢¨²
¤®«« ° ­  ®¤­® ¨§ ·¨±¥« ®² 1 ¤® 6. ®°®¡®·ª  ¢±²°¿µ¨¢ ¥²±¿ ¨ ®²ª°»¢ ¥²±¿. ±«¨ ­ §¢ ­­®¥ ¨£°®ª®¬ ·¨±«® ­¥ ¢»¯ «® ¢®¢±¥, ²® ®­
¯°®¨£°»¢ ¥² ±¢®© ¤®«« °.  ¯°®²¨¢­®¬ ±«³· ¥ ®­ ±®µ° ­¿¥² ¥£® ¨
¯®«³· ¥² ¤®¯®«­¨²¥«¼­® ±²®«¼ª® ¤®«« °®¢, ±ª®«¼ª® ¢»¯ «® ª®±²¥©
± ­ §¢ ­­»¬ ¨¬ ·¨±«®¬. ª®«¼ª® ¢ ±°¥¤­¥¬ ¢»¨£°»¢ ¥² ¨£°®ª ¢
®¤­®© ¯ °²¨¨?
6.3-4? ³±²¼ X ¨ Y | ­¥§ ¢¨±¨¬»¥ ±«³· ©­»¥ ¢¥«¨·¨­». ®ª ¦¨²¥, ·²® f (X ) ¨ g (Y ) ² ª¦¥ ­¥§ ¢¨±¨¬» ¤«¿ «¾¡»µ ´³­ª¶¨© f
¨ g.
6.3-5? ³±²¼ X | ­¥®²°¨¶ ²¥«¼­ ¿ ±«³· ©­ ¿ ¢¥«¨·¨­  ± ¬ ²¥¬ ²¨·¥±ª¨¬ ®¦¨¤ ­¨¥¬ M[X ]. ®ª ¦¨²¥ ­¥° ¢¥­±²¢®  °ª®¢ 
(Markov's inequality)
PfX > tg 6 M[X ]=t
(6.32)
¤«¿ ¢±¥µ t > 0. [²® ­¥° ¢¥­±²¢® ­ §»¢ ¾² ² ª¦¥ ­¥° ¢¥­±²¢®¬
¥¡»¸¥¢ .]
6.3-6? ³±²¼ S | ¢¥°®¿²­®±²­®¥ ¯°®±²° ­±²¢®, ­  ª®²®°®¬ ®¯°¥¤¥«¥­» ±«³· ©­»¥ ¢¥«¨·¨­» X ¨ X 0, ¯°¨·¥¬ X (s) > X 0(s) ¤«¿ ¢±¥µ

¥®¬¥²°¨·¥±ª®¥ ¨ ¡¨­®¬¨ «¼­®¥ ° ±¯°¥¤¥«¥­¨¿

119

s 2 S . ®ª ¦¨²¥, ·²® ¤«¿ «¾¡®£® ¤¥©±²¢¨²¥«¼­®£® ·¨±«  t,
PfX > tg > PfX 0 > tg:
6.3-7 ²® ¡®«¼¸¥: ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ª¢ ¤° ²  ±«³· ©­®© ¢¥«¨·¨­» ¨«¨ ª¢ ¤° ² ¥¥ ¬ ²¥¬ ²¨·¥±ª®£® ®¦¨¤ ­¨¿?
6.3-8 ®ª ¦¨²¥, ·²® ¤«¿ ±«³· ©­®© ¢¥«¨·¨­», ¯°¨­¨¬ ¾¹¥©
²®«¼ª® §­ ·¥­¨¿ 0 ¨ 1, ¢»¯®«­¥­® ° ¢¥­±²¢® D[X ] = M[X ]M[1 ; X ].
6.3-9 »¢¥¤¨²¥ ¨§ ®¯°¥¤¥«¥­¨¿ ¤¨±¯¥°±¨¨ (6.29), ·²® D[aX ] =
a2 D[X ].

6.4. ¥®¬¥²°¨·¥±ª®¥ ¨ ¡¨­®¬¨ «¼­®¥ ° ±¯°¥¤¥«¥­¨¿
°®± ­¨¥ ±¨¬¬¥²°¨·­®© ¬®­¥²» | · ±²­»© ±«³· © ¨±¯»² ­¨©
¯® ±µ¥¬¥ ¥°­³««¨ (Bernouilli trials) ¢ ª®²®°®© ° ±±¬ ²°¨¢ ¥²±¿
n ­¥§ ¢¨±¨¬»µ ¢ ±®¢®ª³¯­®±²¨ ¨±¯»² ­¨©, ª ¦¤®¥ ¨§ ª®²®°»µ ¨¬¥¥² ¤¢  ¢®§¬®¦­»µ ¨±µ®¤ : ³±¯¥µ (success), ¯°®¨±µ®¤¿¹¨© ± ¢¥°®¿²­®±²¼¾ p, ¨ ­¥³¤ ·³ (failure), ¨¬¥¾¹³¾ ¢¥°®¿²­®±²¼ 1 ; p. ¢ 
¢ ¦­»µ ° ±¯°¥¤¥«¥­¨¿ ¢¥°®¿²­®±²¥© | £¥®¬¥²°¨·¥±ª®¥ ¨ ¡¨­®¬¨ «¼­®¥ | ±¢¿§ ­» ±® ±µ¥¬®© ¥°­³««¨.
¥®¬¥²°¨·¥±ª®¥ ° ±¯°¥¤¥«¥­¨¥
 ±±¬®²°¨¬ ±¥°¨¾ ¨±¯»² ­¨© ¥°­³««¨, ¢ ª ¦¤®¬ ¨§ ª®²®°»µ
³±¯¥µ ¨¬¥¥² ¢¥°®¿²­®±²¼ p (  ­¥³¤ ·  ¨¬¥¥² ¢¥°®¿²­®±²¼ q = 1 ; p).
 ª®¥ ¨±¯»² ­¨¥ ¡³¤¥² ¯¥°¢»¬ ³±¯¥¸­»¬? ³±²¼ ±«³· ©­ ¿ ¢¥«¨·¨­  X | ¥£® ­®¬¥°; ½²  ¢¥«¨·¨­  ¯°¨­¨¬ ¥² §­ ·¥­¨¿ 1; 2; : : : ,
¯°¨·¥¬
PfX = kg = q k;1 p
(6.33)
(¯¥°¢»© ³±¯¥µ ¡³¤¥² ¨¬¥²¼ ­®¬¥° k, ¥±«¨ k ; 1 ¨±¯»² ­¨© ¤® ­¥£®
¡»«¨ ­¥³¤ ·­»¬¨,   k-¥ ®ª § «®±¼ ³¤ ·­»¬).  ±¯°¥¤¥«¥­¨¥ ¢¥°®¿²­®±²¥©, § ¤ ­­®¥ ´®°¬³«®© (6.33), ­ §»¢ ¥²±¿ £¥®¬¥²°¨·¥±ª¨¬
° ±¯°¥¤¥«¥­¨¥¬ (geometric distribution). ­® ¯®ª § ­® ­  °¨±. 6.1.
°¥¤¯®« £ ¿, ·²® p < 1, ­ ©¤¥¬ ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ £¥®¬¥²°¨·¥±ª®£® ° ±¯°¥¤¥«¥­¨¿, ¨±¯®«¼§³¿ ´®°¬³«³ (3.6):
1
X

1
X
p
q = 1=p:
k=p
M[X ] =
kq
(6.34)
q k=0
q (1 ; q)2
k=1
°³£¨¬¨ ±«®¢ ¬¨, ­³¦­® ¢ ±°¥¤­¥¬ 1=p ° § ¯°®¢¥±²¨ ¨±¯»² ­¨¥,

kqk;1 p =

·²®¡» ¤®¡¨²¼±¿ ³±¯¥µ , ·²® ¥±²¥±²¢¥­­® ®¦¨¤ ²¼, ¯®±ª®«¼ª³ ¢¥°®¿²­®±²¼ ³±¯¥µ  ° ¢­  p. ¨±¯¥°±¨¾ ¬®¦­® ¢»·¨±«¨²¼  ­ «®£¨·­»¬

120

« ¢  6 ®¬¡¨­ ²®°¨ª  ¨ ¢¥°®¿²­®±²¼

¥®¬¥²°¨·¥±ª®¥ ° ±¯°¥¤¥«¥­¨¥ ± ¢¥°®¿²­®±²¼¾ ³±¯¥µ  p = 1=3 ¨ ¢¥°®¿²­®±²¼¾ ­¥³¤ ·¨ q = 1 ; p.  ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ° ¢­® 1=p = 3.
¨±. 6.1

®¡° §®¬; ¯®«³·¨²±¿, ·²®

D[X ] = q=p2 :
(6.35)
°¨¬¥°: ¡³¤¥¬ ¡°®± ²¼ ¯ °³ ª®±²¥©, ¯®ª  ¢ ±³¬¬¥ ­¥ ¢»¯ ¤¥²
¨«¨ ±¥¬¼ ¨«¨ ®¤¨­­ ¤¶ ²¼. «¿ ®¤­®£® ½ª±¯¥°¨¬¥­²  ¥±²¼ 36 ¢®§¬®¦­»µ ¨±µ®¤®¢, ¢ 6 ¨§ ­¨µ ¯®«³· ¥²±¿ ±¥¬¼ ¨ ¢ 2 ¯®«³· ¥²±¿ ®¤¨­­ ¤¶ ²¼. ®½²®¬³ ¢¥°®¿²­®±²¼ ³±¯¥µ  p ° ¢­  8=36 = 2=9, ¨ ­ ¬
¢ ±°¥¤­¥¬ ¯°¨¤¥²±¿ 1=p = 9=2 = 4;5 ° §  ¡°®±¨²¼ ª®±²¨, ·²®¡»
¢»¯ «® ±¥¬¼ ¨«¨ ®¤¨­­ ¤¶ ²¼.
¨­®¬¨ «¼­®¥ ° ±¯°¥¤¥«¥­¨¥
 ±±¬®²°¨¬ n ¨±¯»² ­¨© ¯® ±µ¥¬¥ ¥°­³««¨ ± ¢¥°®¿²­®±²¼¾
³±¯¥µ  p ¨ ¢¥°®¿²­®±²¼¾ ­¥³¤ ·¨ q = 1 ; p. ³±²¼ ±«³· ©­ ¿ ¢¥«¨·¨­  X | ª®«¨·¥±²¢® ³±¯¥µ®¢ ¢ n ¨±¯»² ­¨¿µ. ¥ §­ ·¥­¨¥ ¬®¦¥²
¡»²¼ ° ¢­® 0; 1; : : :; n, ¨

PfX = kg = Cnk pk (1 ; p)n;k ;

(6.36)

¤«¿ «¾¡®£® k = 0; 1; : : :; n ² ª ª ª ¨¬¥¥²±¿ Cnk ±¯®±®¡®¢ ¢»¡° ²¼
¨§ n ¨±¯»² ­¨© k ³¤ ·­»µ, ¨ ¢¥°®¿²­®±²¼ ª ¦¤®£® ² ª®£® ±«³· ¿
¡³¤¥² pk q n;k .  ±¯°¥¤¥«¥­¨¥ (6.36) ­ §»¢ ¾² ¡¨­®¬¨ «¼­»¬ (binomial distribution). «¿ ¡¨­®¬¨ «¼­»µ ° ±¯°¥¤¥«¥­¨© ¬» ¨±¯®«¼§³¥¬

¥®¬¥²°¨·¥±ª®¥ ¨ ¡¨­®¬¨ «¼­®¥ ° ±¯°¥¤¥«¥­¨¿

121

¨±. 6.2 ¨­®¬¨ «¼­®¥ ° ±¯°¥¤¥«¥­¨¥ b(k ; 15; 1=3), ¯®°®¦¤ ¥¬®¥ n = 15 ¨±¯»² ­¨¿¬¨ ¯® ±µ¥¬¥ ¥°­³««¨, ª ¦¤®¥ ¨§ ª®²®°»µ ¨¬¥¥² ¢¥°®¿²­®±²¼ ³±¯¥µ 
p = 1=3.  ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ° ¢­® np = 5.

®¡®§­ ·¥­¨¥

b(k; n; p) = Cnk pk (1 ; p)n;k :

(6.37)

°¨¬¥° ¡¨­®¬¨ «¼­®£® ° ±¯°¥¤¥«¥­¨¿ ¯®ª § ­ ­  °¨±³­ª¥ 6.2.
 §¢ ­¨¥ À¡¨­®¬¨ «¼­®¥Á ±¢¿§ ­® ± ²¥¬, ·²® ¯° ¢ ¿ · ±²¼ ´®°¬³«» (6.37) | ½²® k-© ·«¥­ ¡¨­®¬  ¼¾²®­  (p + q )n . ±¯®¬¨­ ¿, ·²®
p + q = 1, ¯®«³· ¥¬
n
X
k=0

b(k; n; p) = 1;

(6.38)

ª ª ¨ ¤®«¦­® ¡»²¼ ( ª±¨®¬  2).
 ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ¤«¿ ±«³· ©­®© ¢¥«¨·¨­», ¨¬¥¾¹¥©
¡¨­®¬¨ «¼­®¥ ° ±¯°¥¤¥«¥­¨¥, ¬®¦­® ¢»·¨±«¨²¼ ± ¯®¬®¹¼¾ (6.14)
¨ (6.38). ³±²¼ X | ±«³· ©­ ¿ ¢¥«¨·¨­ , ¨¬¥¾¹ ¿ ¡¨­®¬¨ «¼­®¥
° ±¯°¥¤¥«¥­¨¥ b(k; n; p). ®«®¦¨¬ q = 1 ; p. ® ®¯°¥¤¥«¥­¨¾ ¬ ²¥-

122

« ¢  6 ®¬¡¨­ ²®°¨ª  ¨ ¢¥°®¿²­®±²¼

¬ ²¨·¥±ª®£® ®¦¨¤ ­¨¿, ¨¬¥¥¬

M[X ] =
=

n
X
k=0
n
X
k=1

= np
= np
= np

kb(k; n; p)
kCnk pk qn;k

n
X
k=1
nX
;1
k=0
nX
;1
k=0

Cnk;;11 pk;1q n;k
Cnk;1 pk q(n;1);k
b(k; n ; 1; p)

= np:

(6.39)

®² ¦¥ ± ¬»© °¥§³«¼² ² ¯®·²¨ ¡¥§ ¢»·¨±«¥­¨© ¬®¦­® ¯®«³·¨²¼
² ª: ¯³±²¼ Xi | ª®«¨·¥±²¢® ³±¯¥µ®¢ ¢ i-¬ ¨±¯»² ­¨¨ (ª®²®°®¥
° ¢­® 0 ± ¢¥°®¿²­®±²¼¾ q ¨ ° ¢­® 1 ± ¢¥°®¿²­®±²¼¾ p). ®£¤ 
M[Xi] = p  1 + q  0 = p. ±² ¥²±¿ § ¬¥²¨²¼, ·²® X = X1 + : : : + Xn ,
¨ ¯®²®¬³ ¯® ±¢®©±²¢³ «¨­¥©­®±²¨ (6.26)

M[X ] = M

"
n
X

i=1

#

Xi =

n
X
i=1

M[Xi] =

n
X
i=1

p = np:

®¤®¡­»¬ ®¡° §®¬ ¬®¦­® ¢»·¨±«¨²¼ ¨ ¤¨±¯¥°±¨¾. § (6.29) ±«¥¤³¥², ·²® D[Xi] = M[Xi2] ; M2[Xi ]. ®±ª®«¼ª³ Xi ¯°¨­¨¬ ¥² «¨¸¼
§­ ·¥­¨¿ 0 ¨ 1, ²® M[Xi2] = M[Xi] = p, ¨, §­ ·¨²,

D[Xi] = p ; p2 = pq:
(6.40)
¥¯¥°¼ ¢®±¯®«¼§³¥¬±¿ ­¥§ ¢¨±¨¬®±²¼¾ ¨±¯»² ­¨© ¨ ´®°¬³«®©
(6.31):
D[X ] = D

"
n
X

i=1

#

Xi =

n
X
i=1

D[Xi] =

n
X
i=1

pq = npq:

(6.41)

  °¨±³­ª¥ 6.2 ¢¨¤­®, ·²® b(k; n; p) ª ª ´³­ª¶¨¿ ®² k ±­ · « 
³¢¥«¨·¨¢ ¥²±¿, ¯®ª  k ­¥ ¤®±²¨£­¥² §­ ·¥­¨¿ np,   § ²¥¬ ³¬¥­¼¸ ¥²±¿. ²® ¬®¦­® ¯°®¢¥°¨²¼, ¢»·¨±«¨¢ ®²­®¸¥­¨¥ ¤¢³µ ¯®±«¥¤®¢ -

¥®¬¥²°¨·¥±ª®¥ ¨ ¡¨­®¬¨ «¼­®¥ ° ±¯°¥¤¥«¥­¨¿

123

²¥«¼­»µ ·«¥­®¢:

b(k; n; p) = Cnk pk qn;k
b(k ; 1; n; p) Cnk;1pk;1 qn;k+1
= n!(k ; 1)!(n ; k + 1)!p
k!(n ; k)!n!q
= (n ; k + 1)p
kq
1)p ; k :
= 1 + (n + kq

(6.42)

²® ®²­®¸¥­¨¥ ¡®«¼¸¥ 1, ª®£¤  (n + 1)p ; k ¯®«®¦¨²¥«¼­®, ² ª
·²® b(k; n; p) > b(k ; 1; n; p) ¯°¨ k < (n + 1)p (´³­ª¶¨¿ ° ±²¥²), ¨
b(k; n; p) < b(k ; 1; n; p) ¯°¨ k > (n + 1)p (´³­ª¶¨¿ ³¡»¢ ¥²). ±«¨
·¨±«® (n + 1)p | ¶¥«®¥, ²® ´³­ª¶¨¿ ¨¬¥¥² ¤¢®©­®© ¬ ª±¨¬³¬: ¢
²®·ª µ (n +1)p ¨ (n +1)p ; 1 = np ; q .  ¯°®²¨¢­®¬ ±«³· ¥ ¬ ª±¨¬³¬
®¤¨­, ¨ ¤®±²¨£ ¥²±¿ ®­ ¢ ¶¥«®© ²®·ª¥ k, «¥¦ ¹¥© ¢ ¤¨ ¯ §®­¥ np ;
q < k < (n + 1)p.
«¥¤³¾¹ ¿ «¥¬¬  ¤ ¥² ¢¥°µ­¾¾ ®¶¥­ª³ ¤«¿ ¡¨­®¬¨ «¼­®£® ° ±¯°¥¤¥«¥­¨¿.
¥¬¬  6.1. ³±²¼ n > 0, 0 < p < 1, q = 1 ; p, 0 6 k 6 n. ®£¤ 
n;k
k 
np
nq
b(k; n; p) 6 k
:
n;k


®ª § ²¥«¼±²¢®. ®£« ±­® ­¥° ¢¥­±²¢³ (6.10), ¨¬¥¥¬
b(k; n; p) = Cnk pk qn;k
n;k
6 nk n ;n k
pk qn;k
 np k  nq n;k
= k
:
n;k
 k 



¯° ¦­¥­¨¿
6.4-1 °®¢¥°¼²¥  ª±¨®¬³ 2 ¤«¿ £¥®¬¥²°¨·¥±ª®£® ° ±¯°¥¤¥«¥­¨¿.
6.4-2 ª®«¼ª® ° § ¢ ±°¥¤­¥¬ ­³¦­® ¡°®± ²¼ 6 ±¨¬¬¥²°¨·­»µ ¬®­¥² ¤® ¢»¯ ¤¥­¨¿ 3 ®°«®¢ ¨ 3 °¥¸¥ª (¢ ®¤­®¬ ¨±¯»² ­¨¨)?
6.4-3 ®ª ¦¨²¥, ·²® b(k; n; p) = b(n ; k; n; q ), £¤¥ q = 1 ; p.
6.4-4 ®ª ¦¨²¥, ·²® ¬ ª±¨¬³¬
¡¨­®¬¨ «¼­®£® ° ±¯°¥¤¥«¥­¨¿
b(k; n; p) ¯°¨¬¥°­® ° ¢¥­ 1=p2npq, £¤¥ q = 1 ; p.

124

« ¢  6 ®¬¡¨­ ²®°¨ª  ¨ ¢¥°®¿²­®±²¼

6.4-5? ®ª ¦¨²¥, ·²® ¢¥°®¿²­®±²¼ ­¥ ¯®«³·¨²¼ ­¨ ®¤­®£® ³±¯¥µ 
¢ n ­¥§ ¢¨±¨¬»µ ¨±¯»² ­¨¿µ ± ¢¥°®¿²­®±²¼¾ ³±¯¥µ  1=n ¯°¨¬¥°­®
° ¢­  1=e.  ²¥¬ ¯®ª ¦¨²¥, ·²® ¢¥°®¿²­®±²¼ ¯®«³·¨²¼ °®¢­® ®¤¨­
³±¯¥¸­»© ¨±µ®¤ ² ª¦¥ ¯°¨¡«¨§¨²¥«¼­® ° ¢­  1=e.
6.4-6? °®´¥±±®° ¡°®± ¥² ±¨¬¬¥²°¨·­³¾ ¬®­¥²³ n ° §, ±²³¤¥­²
¤¥« ¥² ²® ¦¥ ± ¬®¥. ®ª ¦¨²¥, ·²® ¢¥°®¿²­®±²¼ ²®£®, ·²® ·¨±«® ®°«®¢ ³ ­¨µ ¡³¤¥² ®¤¨­ ª®¢®, ° ¢­  C2nn =4n . (ª § ­¨¥. ±«¨ ±·¨² ²¼
®°«  ³±¯¥µ®¬ ¯°®´¥±±®°  ¨ ­¥³¤ ·¥© ±²³¤¥­² , ²® ¨±ª®¬®¥ ±®¡»²¨¥
¥±²¼ ¯®¿¢«¥­¨¥ n ³±¯¥µ®¢ ±°¥¤¨ 2n ¨±¯»² ­¨©.) »¢¥¤¨²¥ ®²±¾¤ 
²®¦¤¥±²¢®
n
X
(Cnk )2 = C2nn :
k=0

6.4-7? ®ª ¦¨²¥, ·²® ¤«¿ 0 6 k 6 n,
b(k; n; 1=2) 6 2nH (k=n);n;
£¤¥ H (x) | ´³­ª¶¨¿ ½­²°®¯¨¨ (6.13).
6.4-8?  ±±¬®²°¨¬ n ­¥§ ¢¨±¨¬»µ ¨±¯»² ­¨©. ³±²¼ pi | ¢¥°®¿²­®±²¼ ³±¯¥µ  ¢ i-¬ ¨±¯»² ­¨¨,   ±«³· ©­ ¿ ¢¥«¨·¨­  X ¥±²¼ ª®«¨·¥±²¢® ³±¯¥µ®¢ ¢® ¢±¥µ ½²¨µ ¨±¯»² ­¨¿µ. ³±²¼ p > pi ¤«¿ ¢±¥µ
i = 1; 2; : : :; n. ®ª ¦¨²¥, ·²®

PfX < kg 6

k;1
X
i=0

b(i; n; p)

¯°¨ «¾¡®¬ k = 1; 2; : : :; n.
6.4-9?  ±±¬®²°¨¬ ±«³· ©­³¾ ¢¥«¨·¨­³ X , ° ¢­³¾ ·¨±«³ ³±¯¥µ®¢
¢ n ¨±¯»² ­¨¿µ ± ¢¥°®¿²­®±²¿¬¨ ³±¯¥µ  p1 ; : : :; pn . ³±²¼ X 0 |
 ­ «®£¨·­ ¿ ±«³· ©­ ¿ ¢¥«¨·¨­ , ¤«¿ ª®²®°®© ¢¥°®¿²­®±²¨ ³±¯¥µ 
° ¢­» p01 ; : : :; p0n . ³±²¼ p0i > pi ¯°¨ ¢±¥µ i. ®ª ¦¨²¥, ·²®
PfX 0 > kg > PfX > kg:
¯°¨ «¾¡®¬ k = 0; : : :; n
(ª § ­¨¥: ¬®¦­® ±·¨² ²¼, ·²® °¥§³«¼² ²» ¢²®°®© ±¥°¨¨ ¨±¯»² ­¨© ¯®«³· ¾²±¿ ² ª: ±­ · «  ¤¥« ¥²±¿ ¯¥°¢ ¿ ±¥°¨¿,   ¯®²®¬ ¥¥
°¥§³«¼² ²» ª®°°¥ª²¨°³¾²±¿ ±«³· ©­»¬ ®¡° §®¬ ¢ ±²®°®­³ ³¢¥«¨·¥­¨¿. ±¯®«¼§³©²¥ °¥§³«¼² ² ³¯° ¦­¥­¨¿ 3.3-6.)

6.5. ¢®±²» ¡¨­®¬¨ «¼­®£® ° ±¯°¥¤¥«¥­¨¿

 ®°¨£¨­ «¥ ±® ® ¬­®£¨µ § ¤ · µ ¢ ¦­  ¢¥°®¿²­®±²¼ ­¥ ¢ ²®·­®±²¨ k ³±¯¥µ®¢
§¢¥§¤®©! ¯°¨ ¡¨­®¬¨ «¼­®¬ ° ±¯°¥¤¥«¥­¨¨,   ­¥ ¬¥­¥¥ k ³±¯¥µ®¢ (¨«¨ ­¥ ¡®-

¢®±²» ¡¨­®¬¨ «¼­®£® ° ±¯°¥¤¥«¥­¨¿

125

«¥¥ k ³±¯¥µ®¢).  ½²®¬ ° §¤¥«¥ ¬» ¨±±«¥¤³¥¬ ½²®² ¢®¯°®±, ®¶¥­¨¢
µ¢®±²» (tails) ¡¨­®¬¨ «¼­®£® ° ±¯°¥¤¥«¥­¨¿.  ª¨¥ ®¶¥­ª¨ ¯®ª §»¢ ¾², ·²® ¡®«¼¸¨¥ ®²ª«®­¥­¨¿ ·¨±«  ³±¯¥µ®¢ ®² ¬ ²¥¬ ²¨·¥±ª®£®
®¦¨¤ ­¨¿ (np) ¬ «®¢¥°®¿²­».
­ · «  ¯®«³·¨¬ ®¶¥­ª³ ¤«¿ ¯° ¢®£® µ¢®±²  ° ±¯°¥¤¥«¥­¨¿
b(k; n; p). ¶¥­ª¨ ¤«¿ «¥¢®£® µ¢®±²  ±¨¬¬¥²°¨·­» (³±¯¥µ¨ ¬¥­¿¾²±¿ ¬¥±² ¬¨ ± ­¥³¤ · ¬¨).
¥®°¥¬  6.2. ³±²¼ X | ·¨±«® ³±¯¥µ®¢ ¢ ±¥°¨¨ ¨§ n ­¥§ ¢¨±¨¬»µ
¨±¯»² ­¨© ± ¢¥°®¿²­®±²¼¾ ³±¯¥µ  p. ®£¤ 

PfX > kg =

n
X
i=k

b(i; n; p) 6 Cnk pk :

®ª § ²¥«¼±²¢®. ®±¯®«¼§³¥¬±¿ ­¥° ¢¥­±²¢®¬ (6.15):

Cnk+i 6 Cnk Cni ;k :

 ¬¥²¨¬, ·²®

PfX > kg =
=
=

6

n
X
i=k
nX
;k
i=0
nX
;k
i=0
nX
;k
i=0

b(i; n; p)
b(k + i; n; p)
Cnk+i pk+i(1 ; p)n;(k+i)
Cnk Cni ;k pk+i (1 ; p)n;(k+i)

= Cnk pk
= Cnk pk

nX
;k
i=0
nX
;k
i=0

Cni ;k pi (1 ; p)(n;k);i
b(i; n ; k; p)

= Cnk pk ;

;k b(i; n ; k; p) = 1 ¯® ´®°¬³«¥ (6.38).
² ª ª ª ni=0
¥°¥¯¨±»¢ ¿ ½²® ³²¢¥°¦¤¥­¨¥ ¤«¿ «¥¢®£® µ¢®±² , ¯®«³· ¥¬ ² ª®¥
«¥¤±²¢¨¥ 6.3. ³±²¼ X | ·¨±«® ³±¯¥µ®¢ ¢ ±¥°¨¨ ¨§ n ­¥§ ¢¨±¨¬»µ
¨±¯»² ­¨© ± ¢¥°®¿²­®±²¼¾ ³±¯¥µ  p. ®£¤ 
P

PfX 6 kg =

k
X
i=0

b(i; n; p) 6 Cnn;k (1 ; p)n;k = Cnk (1 ; p)n;k :

126

« ¢  6 ®¬¡¨­ ²®°¨ª  ¨ ¢¥°®¿²­®±²¼

 ¸  ±«¥¤³¾¹ ¿ ®¶¥­ª  ¡³¤¥² ¤«¿ «¥¢®£® µ¢®±²  ¡¨­®¬¨ «¼­®£®
° ±¯°¥¤¥«¥­¨¿: ± ³¤ «¥­¨¥¬ £° ­¨¶» ®² ²®·ª¨ ¬ ª±¨¬³¬  ¢¥°®¿²­®±²¼, ¯°¨µ®¤¿¹ ¿±¿ ­  µ¢®±², ½ª±¯®­¥­¶¨ «¼­® ³¬¥­¼¸ ¥²±¿.
¥®°¥¬  6.4. ³±²¼ X | ·¨±«® ³±¯¥µ®¢ ¢ ±¥°¨¨ ¨§ n ­¥§ ¢¨±¨¬»µ
¨±¯»² ­¨© ± ¢¥°®¿²­®±²¼¾ ³±¯¥µ  p ¨ ¢¥°®¿²­®±²¼¾ ­¥³¤ ·¨ q =
1 ; p. ®£¤ 

PfX < kg =

k ;1
X
i=0

b(i; n; p) < npkq; k b(k; n; p)

¯°¨ 0 < k < np.
P ;1
®ª § ²¥«¼±²¢®. » ±° ¢­¨¢ ¥¬ ki=0
b(i; n; p) ± ±³¬¬®© £¥®¬¥²°¨·¥±ª®© ¯°®£°¥±±¨¨ (±¬. ° §¤. 3.2). «¿ i = 1; 2; : : :; k ´®°¬³«  (6.42) ¤ ¥²


b(i ; 1; n; p) =
iq
i
<
b(i; n; p)
(n ; i + 1)p
n;i
®«®¦¨¢

 



q 6 k
p
n;k

 

q :
p



 
k
x = n ; k pq < 1;
¢¨¤¨¬, ·²® ¢ ¯®±«¥¤®¢ ²¥«¼­®±²¨ b(i; n; p) ¯°¨ 0 6 i 6 k ª ¦¤»©
·«¥­ ¬¥­¼¸¥ ±«¥¤³¾¹¥£®, ³¬­®¦¥­­®£® ­  x. ®½²®¬³ ¨­²¥°¥±³¾¹ ¿ ­ ± ±³¬¬  (®² i = 0 ¤® i = k ; 1) ¬¥­¼¸¥ §­ ·¥­¨¿ b(k; n; p),
³¬­®¦¥­­®£® ­  x + x2 + x3 + : : : = x=(1 ; x):

k ;1
X
i=0

b(i; n; p) < 1 ;x x b(k; n; p) = npkq; k b(k; n; p):

°¨ k 6 np=2 ª®½´´¨¶¨¥­² kq=(np ; k) ­¥ ¯°¥¢®±µ®¤¨² 1, ² ª
·²® b(k; n; p) ¿¢«¿¥²±¿ ®¶¥­ª®© ±¢¥°µ³ ¤«¿ ±³¬¬» ¢±¥µ ¯°¥¤»¤³¹¨µ
·«¥­®¢. «¿ ¯°¨¬¥°  ° ±±¬®²°¨¬ n ¡°®± ­¨© ±¨¬¬¥²°¨·­®© ¬®­¥²». ®«®¦¨¬ p = 1=2 ¨ k = n=4. ¥®°¥¬  6.4 £ ° ­²¨°³¥², ·²®
¢¥°®¿²­®±²¼ ¯®¿¢«¥­¨¿ ¬¥­¥¥ ·¥¬ n=4 ®°«®¢ ¬¥­¼¸¥ ¢¥°®¿²­®±²¨
¢»¯ ¤¥­¨¿ ¢ ²®·­®±²¨ n=4 ®°«®¢. (®«¥¥ ²®£®, ¤«¿ «¾¡®£® ¯®«®¦¨²¥«¼­®£® r 6 n=4 ¢¥°®¿²­®±²¼ ¯®¿¢«¥­¨¿ ¬¥­¥¥ r ®°«®¢ ¬¥­¼¸¥
¢¥°®¿²­®±²¨ ¯®¿¢«¥­¨¿ ¢ ²®·­®±²¨ r ®°«®¢.) ¥®°¥¬  6.4 ¬®¦¥²
¡»²¼ ¨±¯®«¼§®¢ ­  ¢¬¥±²¥ ± ®¶¥­ª ¬¨ ¡¨­®¬¨ «¼­®£® ° ±¯°¥¤¥«¥­¨¿ ±¢¥°µ³, ­ ¯°¨¬¥° ± «¥¬¬®© 6.1.
¨¬¬¥²°¨·­ ¿ ®¶¥­ª  ¤«¿ ¯° ¢®£® µ¢®±²  ¢»£«¿¤¨² ² ª:

¢®±²» ¡¨­®¬¨ «¼­®£® ° ±¯°¥¤¥«¥­¨¿

127

«¥¤±²¢¨¥ 6.5. ³±²¼ X | ·¨±«® ³±¯¥µ®¢ ¢ ±¥°¨¨ ¨§ n ­¥§ ¢¨±¨¬»µ
¨±¯»² ­¨© ± ¢¥°®¿²­®±²¼¾ ³±¯¥µ  p ¨ ¢¥°®¿²­®±²¼¾ ­¥³¤ ·¨ q =
1 ; p. ®£¤ 

PfX > kg =

n
X
i=k+1

k)p b(k; n; p)
b(i; n; p) < (kn ;; np

¯°¨ np < k < n.
 ±«¥¤³¾¹¥© ²¥®°¥¬¥ ° ±±¬ ²°¨¢ ¥²±¿ ¡®«¥¥ ®¡¹¨© ±«³· ©: ª ¦¤®¥ ¨§ ¨±¯»² ­¨© ¨¬¥¥² ±¢®¾ ¢¥°®¿²­®±²¼ ³±¯¥µ .
¥®°¥¬  6.6.  ±±¬®²°¨¬ ±¥°¨¾ ¨§ n ­¥§ ¢¨±¨¬»µ ¨±¯»² ­¨©; ¢¥°®¿²­®±²¼ ³±¯¥µ  ¢ i-¬ ¨§ ­¨µ ®¡®§­ ·¨¬ pi (¢¥°®¿²­®±²¼ ­¥³¤ ·¨ qi ° ¢­  1;pi). ³±²¼ ±«³· ©­ ¿ ¢¥«¨·¨­  X ¥±²¼ ·¨±«® ³±¯¥µ®¢
¢ ±¥°¨¨, ¨ ¯³±²¼  = M[X ]. ®£¤  ¤«¿ r >  ¢»¯®«­¥­® ­¥° ¢¥­±²¢®
 r
PfX ;  > rg 6 e :

r

®ª § ²¥«¼±²¢®. «¿ «¾¡®£®  > 0 ´³­ª¶¨¿ ex ±²°®£® ¢®§° ±² ¥² ¯® x, ¯®½²®¬³

PfX ;  > rg = Pfe(X ;) > er g;
«¿ ®¶¥­ª¨ ¯° ¢®© · ±²¨ ¬» ¨±¯®«¼§³¥¬ ­¥° ¢¥­±²¢®  °ª®¢  (6.32) (  ­ ¨¡®«¥¥ ¢»£®¤­®¥ §­ ·¥­¨¥  ¯®¤¡¥°¥¬ ¯®§¤­¥¥):

PfX ;  > rg 6 M[e(X ;)]e;r :

(6.43)

±² ¥²±¿ ®¶¥­¨²¼ M[e(X ;)] ¨ ¢»¡° ²¼ §­ ·¥­¨¥ ¤«¿ .  ±±¬®²°¨¬ ±«³· ©­³¾ ¢¥«¨·¨­³ Xi , ° ¢­³¾ 1 ¢ ±«³· ¥ ³±¯¥µ  i-£® ¨±¯»² ­¨¿ ¨ 0 ¢ ±«³· ¥ ¥£® ­¥³¤ ·¨. ®£¤ 

X=
¨

X;=

n
X
i=1

Xi

n
X
i=1

(Xi ; pi ):

®±ª®«¼ª³ ¨±¯»² ­¨¿ ­¥§ ¢¨±¨¬», ²® ¢¥«¨·¨­» Xi ­¥§ ¢¨±¨¬».
®½²®¬³ ¢¥«¨·¨­» e(Xi ;pi )] ­¥§ ¢¨±¨¬» (³¯°. 6.3-4), ¨ ¯® ´®°¬³«¥ (6.27) ¬®¦­® ¯¥°¥±² ¢¨²¼ ¯°®¨§¢¥¤¥­¨¥ ¨ ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥:

M[e(X ;)] = M

"
n
Y

i=1

#

e(Xi;pi ) =

n
Y
i=1

M[e(Xi;pi ) ]:

128

« ¢  6 ®¬¡¨­ ²®°¨ª  ¨ ¢¥°®¿²­®±²¼

 ¦¤»© ¬­®¦¨²¥«¼ ¬®¦­® ®¶¥­¨²¼ ² ª:

M[e(Xi;pi ) ] = e(1;pi ) pi + e(0;pi ) qi
= pi eqi + qi e;pi
6 pie + 1
6 exp(pie);

(6.44)

£¤¥ exp(x) ®¡®§­ · ¥² ½ª±¯®­¥­¶¨ «¼­³¾ ´³­ª¶¨¾: exp(x) = ex .
(» ¢®±¯®«¼§®¢ «¨±¼ ²¥¬, ·²®  > 0, qi 6 1, eqi 6 e ¨ e;pi 6 1,
  ² ª¦¥ ­¥° ¢¥­±²¢®¬ (2.7).) «¥¤®¢ ²¥«¼­®,
n
Y

(
X
;

)
M[e
] 6 exp(pie ) = exp(e );
i=1
Pn
² ª ª ª  = i=1 pi .  ª¨¬ ®¡° §®¬, ¨§ ­¥° ¢¥­±²¢  (6.43) ±«¥¤³¥²

®¶¥­ª 

PfX ;  > rg 6 exp(e ; r):
»¡¨° ¿  = ln(r=) (±¬. ³¯°. 6.5-6), ¯®«³· ¥¬

(6.45)

PfX ;  > rg 6 exp(eln(r=) ; r ln(r=))
er =  e r :
= exp(r ; r ln(r=)) = (r=
)r
r
[®°¬ «¼­® ½²  ®¶¥­ª  ¯°¨¬¥­¨¬  ¯°¨ «¾¡®¬ r > , ­® ¥¥ ¨¬¥¥²
±¬»±« ¯°¨¬¥­¿²¼ ²®«¼ª® ¥±«¨ r ¡®«¼¸¥  ¡®«¥¥ ·¥¬ ¢ e ° §, ¨­ ·¥
¯° ¢ ¿ · ±²¼ ¡³¤¥² ¡®«¼¸¥ ¥¤¨­¨¶».]
¥®°¥¬³ 6.6 ¬®¦­® ¯°¨¬¥­¿²¼ ¨ ¤«¿ ±«³· ¿ ° ¢­»µ ¢¥°®¿²­®±²¥©. °¨ ½²®¬  = M[X ] = np, ¨ ¯®«³· ¥²±¿ ² ª®¥
«¥¤±²¢¨¥ 6.7. ³±²¼ X | ·¨±«® ³±¯¥µ®¢ ¢ ±¥°¨¨ ¨§ n ­¥§ ¢¨±¨¬»µ
¨±¯»² ­¨© ¯® ±µ¥¬¥ ¥°­³««¨ ± ¢¥°®¿²­®±²¼¾ ³±¯¥µ  p. ®£¤ 

PfX ; np > rg =

n
X


r
b(k; n; p) 6 npe
:
r
k=dnp+re

¯° ¦­¥­¨¿
6.5-1? ²® ¬¥­¥¥ ¢¥°®¿²­®: ­¥ ¯®«³·¨²¼ ­¨ ®¤­®£® ®°«  ¯°¨ n ¡°®± ­¨¿µ ±¨¬¬¥²°¨·­®© ¬®­¥²», ¨«¨ ¯®«³·¨²¼ ¬¥­¥¥ n ®°«®¢ ¯°¨
4n ¡°®± ­¨¿µ ±¨¬¬¥²°¨·­®© ¬®­¥²»?

¥°®¿²­®±²­»©  ­ «¨§

129

6.5-2? ®ª ¦¨²¥, ·²®
k ;1
X
i=0

Cni ai < (a + 1)n na ; kk(a + 1) b(k; n; a=(a + 1))

¯°¨ a > 0 ¨ 0 < k < n.
6.5-3? ®ª ¦¨²¥, ·²® ¯°¨ 0 < k < np, £¤¥ 0 < p < 1 ¨ q = 1 ; p,
¢»¯®«­¥­® ­¥° ¢¥­±²¢®
k;1
X
i=0


k  nq n;k
pi q n;i < npkq; k np
:
k
n;k

6.5-4? ®ª ¦¨²¥, ·²® ¢ ³±«®¢¨¿µ ²¥®°¥¬» 6.6 ¢»¯®«­¥­® ­¥° ¢¥­±²¢®

r
(
n
;

)
e
Pf  ; X > r g 6
;
r
  ¢ ³±«®¢¨¿µ ±«¥¤±²¢¨¿ 6.7 ¢»¯®«­¥­® ­¥° ¢¥­±²¢®

r
Pfnp ; X > rg 6 nqe
r :

6.5-5?  ±±¬®²°¨¬ ±¥°¨¾ ¨§ n ­¥§ ¢¨±¨¬»µ ¨±¯»² ­¨©; ¢¥°®¿²­®±²¼ ³±¯¥µ  ¢ i-¬ ¨§ ­¨µ ®¡®§­ ·¨¬ pi (¢¥°®¿²­®±²¼ ­¥³¤ ·¨ qi
° ¢­  1 ; pi ). ³±²¼ ±«³· ©­ ¿ ¢¥«¨·¨­  X ¥±²¼ ·¨±«® ³±¯¥µ®¢ ¢
±¥°¨¨, ¨ ¯³±²¼  = M[X ]. ®ª ¦¨²¥, ·²® ¯°¨ r > 0 ¢»¯®«­¥­®
­¥° ¢¥­±²¢®
PfX ;  > rg 6 e;r =2n :
2

6.5-6? ®ª ¦¨²¥, ·²® ¯°¨ ¢»¡° ­­®¬ §­ ·¥­¨¨  = ln(r=) ¯° ¢ ¿
· ±²¼ ­¥° ¢¥­±²¢  (6.45) ¤®±²¨£ ¥² ¬¨­¨¬³¬ .

6.6. ¥°®¿²­®±²­»©  ­ «¨§
 ½²®¬ ° §¤¥«¥ ¬» ¯°¨¢¥¤¥¬ ²°¨ ¯°¨¬¥°  ¯°¨¬¥­¥­¨¿ ° §®¡° ­­»µ ¬¥²®¤®¢ ®¶¥­ª¨ ¢¥°®¿²­®±²¥©. °¨¬¥°» ½²¨ ² ª®¢»: ±®¢¯ ¤¥­¨¥ ¤­¥© °®¦¤¥­¨© ³ ¤¢³µ ·¥«®¢¥ª ±°¥¤¨ ¤ ­­»µ k ·¥«®¢¥ª, ° ±¯°¥¤¥«¥­¨¥ ¸ °®¢ ¯® ³°­ ¬ ¨ ³· ±²ª¨ ¯®¢²®°¿¾¹¨µ±¿ ¨±µ®¤®¢ ¯°¨
¡°®± ­¨¨ ¬®­¥²».
6.6.1.  ° ¤®ª± ¤­¿ °®¦¤¥­¨¿
 ° ¤®ª± ¤­¿ °®¦¤¥­¨¿ (birthday paradox) ±¢¿§ ­ ± ² ª¨¬ ¢®¯°®±®¬: ±ª®«¼ª® ·¥«®¢¥ª ¤®«¦­® ¡»²¼ ¢ ª®¬­ ²¥, ·²®¡» ± ¡®«¼¸®©

130

« ¢  6 ®¬¡¨­ ²®°¨ª  ¨ ¢¥°®¿²­®±²¼

¢¥°®¿²­®±²¼¾ ±°¥¤¨ ­¨µ ®ª § «¨±¼ ¤¢®¥ °®¤¨¢¸¨µ±¿ ¢ ®¤¨­ ¤¥­¼?
 ° ¤®ª± ±®±²®¨² ¢ ²®¬, ·²® ®²¢¥² §­ ·¨²¥«¼­® ¬¥­¼¸¥ ·¨±«  ¤­¥©
¢ £®¤³, ·²® ª ¦¥²±¿ ±²° ­­»¬.
» ±·¨² ¥¬, ·²® ¢ £®¤³ 365 ¤­¥© ¨ ·²® ¤­¨ °®¦¤¥­¨¿ k ·¥«®¢¥ª ¢»¡¨° ¾²±¿ ±«³· ©­® ¨ ­¥§ ¢¨±¨¬® ¤°³£ ®² ¤°³£ . ¶¥­¨¬
¢¥°®¿²­®±²¼ ²®£®, ·²® ¢±¥ ¤­¨ °®¦¤¥­¨¿ ®ª ¦³²±¿ ° §«¨·­»¬¨.
³±²¼ ¤¥­¼ °®¦¤¥­¨¿ ¯¥°¢®£® ³¦¥ ¢»¡° ­; ¿±­®, ·²® ¤¥­¼ °®¦¤¥­¨¿ ¢²®°®£® ±®¢¯ ¤¥² ± ­¨¬ ± ¢¥°®¿²­®±²¼¾ 1=365. °¨ ¢»¡° ­­»µ
(¨ ° §«¨·­»µ) ¤­¿µ °®¦¤¥­¨¿ ¯¥°¢®£® ¨ ¢²®°®£® ¢¥°®¿²­®±²¼, ·²®
³ ²°¥²¼¥£® ¤¥­¼ °®¦¤¥­¨¿ ±®¢¯ ¤¥² ± ®¤­¨¬ ¨§ ³¦¥ ¨¬¥¾¹¨µ±¿, ¡³¤¥² 2=365 ¨ ² ª ¤ «¥¥.  ¨²®£¥ ¢¥°®¿²­®±²¼ ²®£®, ·²® ³ k ·¥«®¢¥ª
¡³¤³² ° §«¨·­»¥ ¤­¨ °®¦¤¥­¨¿, ¥±²¼





2 ::: 1; k ; 1 :
1
1 ; 365
1 ; 365
365
®«¥¥ ´®°¬ «¼­®, ¯³±²¼ n | ·¨±«® ¤­¥© ¢ £®¤³, ¨ ¯³±²¼ Ai |
±®¡»²¨¥ À¤¥­¼ °®¦¤¥­¨¿ (i + 1)-£® ·¥«®¢¥ª  ­¥ ±®¢¯ ¤ ¥² ± ¤­¿¬¨
°®¦¤¥­¨¿ ¯°¥¤»¤³¹¨µ i ·¥«®¢¥ªÁ. ®£¤  ¯¥°¥±¥·¥­¨¥ Bi = A1 \
A2 \ : : : \ Ai;1 ¡³¤¥² ±®¡»²¨¥¬ À³ ¯¥°¢»µ i ·¥«®¢¥ª ¤­¨ °®¦¤¥­¨¿
° §«¨·­»Á.
®±ª®«¼ª³ Bk = Ak;1 \ Bk;1 , ²® ¨§ ´®°¬³«» (6.20) ¯®«³· ¥¬
±®®²­®¸¥­¨¥

PfBk g = PfBk;1 gPfAk;1 jBk;1 g:
(6.46)
 · «¼­®¥ ³±«®¢¨¥: PfB1 g = 1.
±«®¢­ ¿ ¢¥°®¿²­®±²¼ PfAk;1 jBk;1 g ° ¢­  (n ; k + 1)=n, ² ª ª ª
±°¥¤¨ n ¤­¥© ¨¬¥¥²±¿ n ; (k ; 1) ±¢®¡®¤­»µ (¯® ³±«®¢¨¾ ¢±¥ ¯°¥¤»¤³¹¨¥ ¤­¨ °®¦¤¥­¨¿ ° §«¨·­»). ®½²®¬³
PfBk g = PfB1 gPfA1jB1 gPfA2jB2 g    PfAk;1 jBk;1 g





n
;
2
n
;
k
+
1
n
;
1
= 1 n
:::
n
n





1
= 1  1 ; n1 1 ; n2 t : : : 1 ; k ;
n
¥¯¥°¼ ¨§ ­¥° ¢¥­±²¢  1 + x 6 ex (2.7) ±«¥¤³¥², ·²®
PfBk g 6 e;1=n e;2=n e;(k;1)=n
= e;(1+2+3+:::+(k;1))=n
= e;k(k;1)=2n
6 1=2;
¥±«¨ ;k(k ; 1)=2n 6 ln(1=2). ¥°®¿²­®±²¼ ²®£®, ·²® ¢±¥ k ¤­¥© °®¦¤¥­¨© ° §«¨·­», ­¥ ¯°¥¢®±µ®¤¨² 1=2 ¯°¨ k(k ; 1) > 2n ln 2. ¥¸ ¿

¥°®¿²­®±²­»©  ­ «¨§

131

p

½²® ª¢ ¤° ²­®¥ ­¥° ¢¥­±²¢®, ¯®«³· ¥¬ k > (1 + 1 + (8 ln 2)n)=2.
«¿ n = 365, ¨¬¥¥¬ k > 23. ² ª, ¥±«¨ ¢ ª®¬­ ²¥ ­ µ®¤¨²±¿ ­¥
¬¥­¥¥ 23 ·¥«®¢¥ª, ²® ± ¢¥°®¿²­®±²¼¾ ­¥ ¬¥­¥¥ 1=2 ª ª¨¥-²® ¤¢®¥
¨§ ­¨µ °®¤¨«¨±¼ ¢ ®¤¨­ ¨ ²®² ¦¥ ¤¥­¼.    °±¥, £¤¥ £®¤ ±®±²®¨² ¨§ 669 ¬ °±¨ ­±ª¨µ ±³²®ª, ¢ ª®¬­ ²¥ ¤®«¦­® ¡»²¼ ­¥ ¬¥­¥¥ 31
¬ °±¨ ­¨­ .
°³£®© ¬¥²®¤  ­ «¨§ 
±²¼ ¤°³£®©, ¡®«¥¥ ¯°®±²®© ±¯®±®¡ ¯®«³·¨²¼ ®¶¥­ª³ ¤«¿ °®¤±²¢¥­­®© § ¤ ·¨. «¿ ª ¦¤®© ¯ °» «¾¤¥© (i; j ), ­ µ®¤¿¹¨µ±¿ ¢ ª®¬­ ²¥, ° ±±¬®²°¨¬ ±«³· ©­³¾ ¢¥«¨·¨­³ Xij
(

Xij =

1; ¥±«¨ i ¨ j °®¤¨«¨±¼ ¢ ®¤¨­ ¤¥­¼,
0; ¢ ¯°®²¨¢­®¬ ±«³· ¥.

¥°®¿²­®±²¼ ²®£®, ·²® ¤­¨ °®¦¤¥­¨¿ ¤¢³µ ¤ ­­»µ «¾¤¥© ±®¢¯ ¤ ¾², ° ¢­  1=n, ¯®½²®¬³ ¯® ®¯°¥¤¥«¥­¨¾ ¬ ²¥¬ ²¨·¥±ª®£® ®¦¨¤ ­¨¿ (6.23)
M[Xij ] = 1  (1=n) + 0  (1 ; 1=n) = 1=n
¯°¨ i 6= k.
³¬¬  ¢±¥µ Xij ¯® ¢±¥¬ ¯ ° ¬ 1 6 i < j 6 k ¨¬¥¥² ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥, ° ¢­®¥ ±³¬¬¥ ®¦¨¤ ­¨© ¤«¿ ª ¦¤®© ¯ °»; ¢±¥£®
¯ ° Ck2 = k(k ; 1)=2,p² ª ·²® ½²  ±³¬¬  ° ¢­  k(k ; 1)=2n. ®½²®¬³ ­³¦­® ¯°¨¬¥°­® 2n ·¥«®¢¥ª, ·²®¡» ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥
·¨±«  ¯ ° «¾¤¥© ± ±®¢¯ ¤ ¾¹¨¬¨ ¤­¿¬¨ °®¦¤¥­¨¿ ±° ¢­¿«®±¼ ± 1.
 ¯°¨¬¥°, ¯°¨ n = 365 ¨ k = 28 ®¦¨¤ ¥¬®¥ ·¨±«® ¯ ° «¾¤¥©, °®¤¨¢¸¨µ±¿ ¢ ®¤¨­ ¤¥­¼, ° ¢­® (28  27)=(2  365)  1;0356.    °±¥
¤«¿ ½²®£® ²°¥¡³¥²±¿ 38 ¬ °±¨ ­.
 ¬¥²¨¬, ·²® ¬» ®¶¥­¨¢ «¨
P ¤¢¥ ° §­»¥ ¢¥¹¨: (1) ¯°¨ ª ª®¬ k
¢¥°®¿²­®±²¼ ±®¡»²¨¿ X = Xij > 0 ¡®«¼¸¥ 1=2, ¨ (2) ¯°¨ ª ª®¬ k
¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ X ¡®«¼¸¥ 1. ®°¬ «¼­® ½²® ° §­»¥ ¢®¯°®±» (¬®¦­® § ¬¥²¨²¼ «¨¸¼, ·²® ¥±«¨ ¢¥°®¿²­®±²¼ PfX > 0g >
1=2, ²® M[X ] > 1=2, ² ª ª ª ¢¥«¨·¨­  X ¯°¨­¨¬ ¥² ¶¥«»¥ §­ ·¥­¨¿).
p ¤­ ª® ¨ ¢ ²®¬, ¨ ¢ ¤°³£®¬ ±«³· ¥ ®²¢¥² ¨¬¥¥²  ±¨¬¯²®²¨ª³
( n).
6.6.2.  °» ¨ ³°­»
³±²¼ ¨¬¥¥²±¿ b ³°­, ¯°®­³¬¥°®¢ ­­»µ ®² 1 ¤® b. » ®¯³±ª ¥¬ ¢
­¨µ ¸ °»: ª ¦¤»© ¸ ° ± ° ¢­®© ¢¥°®¿²­®±²¼¾ ¯®¬¥¹ ¥²±¿ ¢ ®¤­³
¨§ ³°­ ­¥§ ¢¨±¨¬® ®² ¯°¥¤»¤³¹¨µ.  ª¨¬ ®¡° §®¬, ± ²®·ª¨ §°¥­¨¿
«¾¡®© ¨§ ³°­ ¯°®¨±µ®¤¨² ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¨±¯»² ­¨© ¯® ±µ¥¬¥
¥°­³««¨ ± ¢¥°®¿²­®±²¼¾ ³±¯¥µ  1=b (³±¯¥µ | ¯®¯ ¤ ­¨¥ ¸ °  ¢

132

« ¢  6 ®¬¡¨­ ²®°¨ª  ¨ ¢¥°®¿²­®±²¼

½²³ ³°­³). » ° ±±¬®²°¨¬ ­¥±ª®«¼ª® § ¤ ·, ±¢¿§ ­­»µ ± ² ª¨¬
¯°®¶¥±±®¬.
ª®«¼ª® ¸ °®¢ ¯®¯ ¤¥² ¢ ¤ ­­³¾ ³°­³? ®«¨·¥±²¢® ¸ °®¢, ¯®¯ ¢¸¨µ ¢ ¤ ­­³¾ ³°­³, ®¯¨±»¢ ¥²±¿ ¡¨­®¬¨ «¼­»¬ ° ±¯°¥¤¥«¥­¨¥¬ b(k; n; 1=b). ±«¨ ¢±¥£® ¡°®± ¥²±¿ n ¸ °®¢, ²® ¬ ²¥¬ ²¨·¥±ª®¥
®¦¨¤ ­¨¥ ·¨±«  ¯®¯ ¢¸¨µ ¢ ³°­³ ¸ °®¢ ° ¢­® n=b.
ª®«¼ª® ¢ ±°¥¤­¥¬ ¸ °®¢ ­³¦­® ¡°®±¨²¼, ¯®ª  ¢ ¤ ­­³¾ ³°­³
­¥ ¯®¯ ¤¥² ¸ °? ®«¨·¥±²¢® ¡°®±ª®¢ ¤® ¯¥°¢®£® ¯®¯ ¤ ­¨¿ ¢ § ¤ ­­³¾ ³°­³ ¨¬¥¥² £¥®¬¥²°¨·¥±ª®¥ ° ±¯°¥¤¥«¥­¨¥ ± ¢¥°®¿²­®±²¼¾
1=b, ¯®½²®¬³ ®¦¨¤ ¥¬®¥ ·¨±«® ¡°®±ª®¢ ¥±²¼ 1=(1=b) = b.
ª®«¼ª® ¸ °®¢ ­³¦­® ¡°®±¨²¼, ·²®¡» ª ¦¤ ¿ ³°­  ±®¤¥°¦ «  ¯® ¬¥­¼¸¥© ¬¥°¥ ®¤¨­ ¸ °? ³¤¥¬ ±«¥¤¨²¼ §  ·¨±«®¬ § ¯®«­¥­­»µ ³°­. ­ · «¥ ®­® ° ¢­® ­³«¾,   § ²¥¬ ³¢¥«¨·¨¢ ¥²±¿, ¯®ª  ­¥ ¤®±²¨£­¥² b. ¡®§­ ·¨¬ ·¥°¥§ ni ±«³· ©­³¾ ¢¥«¨·¨­³, ° ¢­³¾ ·¨±«³ ¯®¯»²®ª, ¯®²°¥¡®¢ ¢¸¨µ±¿, ·²®¡» ½²® ·¨±«® ¢®§°®±«®
®² i ; 1 ¤® i. ( ª¨¬ ®¡° §®¬, ¥±«¨ ¢²®° ¿ ¨ ²°¥²¼¿ ¯®¯»²ª¨ ¯°¨¸«¨±¼ ­  ²³ ¦¥ ³°­³, ·²® ¯¥°¢ ¿,   ·¥²¢¥°² ¿ | ­  ¤°³£³¾, ²®
n1 = 1, n2 = 3.) ¡¹¥¥ ·¨±«® ¯®¯»²®ª ¤® § ¯®«­¥­¨¿ ¢±¥µ ³°­ ° ¢­® n1 + n2 + : : : + nb . » ¢»·¨±«¨¬ ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ½²®©
±³¬¬» ª ª ±³¬¬³ ¬ ²¥¬ ²¨·¥±ª¨µ ®¦¨¤ ­¨©. ®£¤  ¬» ¦¤¥¬ § ¯®«­¥­¨¿ i-© ³°­», § ¯®«­¥­® i ; 1 ³°­ ¨§ b ¨ ¢¥°®¿²­®±²¼ ¯®¯ ±²¼
¢ ­¥§ ¯®«­¥­­³¾ ° ¢­  (b ; i + 1)=b. ® ±¢®©±²¢³ £¥®¬¥²°¨·¥±ª®£® ° ±¯°¥¤¥«¥­¨¿ ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ¢¥«¨·¨­» ni ®¡° ²­®
½²®© ¢¥°®¿²­®±²¨ ¨ ° ¢­® b=(b ; i +1). ³¬¬  ½²¨µ ¢¥«¨·¨­ ¯® ¢±¥¬ i
° ¢­  b(1=b + 1=(b ; 1) + : : : + 1=2 + 1) = b(ln b + O(1)). (¬. ´®°¬³«³ (3.5) ¤«¿ ±³¬¬» £ °¬®­¨·¥±ª®£® °¿¤ .)
² ª, ²°¥¡³¥²±¿ ±¤¥« ²¼ ¢ ±°¥¤­¥¬ ¯°¨¬¥°­® b ln b ¡°®±ª®¢, ¯°¥¦¤¥ ·¥¬ ¢ ª ¦¤®© ³°­¥ ¯®¿¢¨²±¿ ¯® ¸ °³.
6.6.3. · ±²ª¨ ¯®¢²®°¿¾¹¨µ±¿ ¨±µ®¤®¢
³±²¼ ¬» ¡°®± ¥¬ ±¨¬¬¥²°¨·­³¾ ¬®­¥²³ n ° §.  ª®¥ ¬ ª±¨¬ «¼­®¥ ·¨±«® ¨¤³¹¨µ ¯®¤°¿¤ ®°«®¢ ¬» ®¦¨¤ ¥¬ ³¢¨¤¥²¼? ª §»¢ ¥²±¿, ®²¢¥² ­  ½²®² ¢®¯°®± | (lg n).
­ · «  ¤®ª ¦¥¬, ·²® ®¦¨¤ ¥¬ ¿ ¤«¨­  ­ ¨¡®«¼¸¥£® ³· ±²ª 
¥±²¼ O(lg n). ³±²¼ ±®¡»²¨¥ Aik ±®±²®¨² ¢ ²®¬, ·²® ¨¬¥¥²±¿ ³· ±²®ª
¨§ k ¨«¨ ¡®«¥¥ ®°«®¢, ­ ·¨­ ¾¹¨©±¿ ± i-£® ¡°®± ­¨¿. ·¥¢¨¤­®,
PfAik g = 1=2k :
(6.47)
°¨ k = 2dlg ne ¢¥°®¿²­®±²¼ ¯®¿¢«¥­¨¿ k ®°«®¢ ¢ ¤ ­­»µ ¯®§¨¶¨¿µ ­¥ ¯°¥¢®±µ®¤¨² 1=n2 ,   ¢®§¬®¦­»µ ¬¥±² (§­ ·¥­¨© i) ¬¥­¼¸¥
·¥¬ n, ² ª ·²® ¢¥°®¿²­®±²¼ ¯®¿¢«¥­¨¿ k ®°«®¢ ¯®¤°¿¤ (£¤¥-­¨¡³¤¼)
­¥ ¡®«¼¸¥ 1=n. ¥¯¥°¼ ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ¬ ª±¨¬ «¼­®£®
·¨±«  ¨¤³¹¨µ ¯®¤°¿¤ ®°«®¢ ®¶¥­¨¢ ¥²±¿ ² ª: ½²® ·¨±«® ­¨ª®£¤  ­¥
¯°¥¢®±µ®¤¨² n ¨ ¯®·²¨ ¢±¥£¤  (± ¢¥°®¿²­®±²¼¾ 1 ; 1=n) ­¥ ¯°¥¢®±µ®¤¨² 2dlg ne, ¯®½²®¬³ ®¦¨¤ ­¨¥ ­¥ ¡®«¼¸¥ d2 lg ne+n(1=n) = O(lg n).

¥°®¿²­®±²­»©  ­ «¨§

133

¥°®¿²­®±²¼ ®¡° §®¢ ­¨¿ ³· ±²ª  ®°«®¢ ¤«¨­» ­¥ ¬¥­¥¥ rdlg ne
¡»±²°® ³¬¥­¼¸ ¥²±¿ ± °®±²®¬ r (¤«¿ ´¨ª±¨°®¢ ­­®© ¯®§¨¶¨¨ ®­ 
­¥ ¡®«¼¸¥ 2;r lg n = n;r ,   ¤«¿ ¢±¥µ ¯®§¨¶¨© ¢ ±³¬¬¥ ®­  ­¥ ¯°¥¢®±µ®¤¨² n  n;r = n;(r;1) .)  ¯°¨¬¥°, ¤«¿ n = 1000 ¢¥°®¿²­®±²¼
¯®¿¢«¥­¨¿ ³· ±²ª  ¨§ ¯® ¬¥­¼¸¥© ¬¥°¥ 2dlg ne = 20 ®°«®¢ ­¥ ¯°¥¢®±µ®¤¨² 1=n = 1=1000,   ¢¥°®¿²­®±²¼ ¯®¿¢«¥­¨¿ ³· ±²ª  3dlg ne = 30
®°«®¢ ­¥ ¡®«¼¸¥ 1=n2 = 10;6.
¥¯¥°¼ ¤®ª ¦¥¬ ®¶¥­ª³ ±­¨§³: ®¦¨¤ ¥¬ ¿ ¤«¨­  ­ ¨¡®«¼¸¥£® ³· ±²ª  ¥±²¼ 
(lg n). «¿ ½²®£® ° ±±¬®²°¨¬ ³· ±²ª¨ ¤«¨­»
b(lg n)=2c. ®£« ±­® (6.47) ¢¥°®¿²­®±²¼ ¯®¿¢«¥­¨¿
p ² ª®£® ³· ±²ª 
¢ ¤ ­­®© ¯®§¨¶¨¨ ­¥ ¬¥­¼¸¥ p1=2b(lg n)=2c > 1= n,   ¢¥°®¿²­®±²¼ ¥£®
­¥¯®¿¢«¥­¨¿ ­¥ ¡®«¼¸¥ 1 ; 1= n.  §®¡¼¥¬ ¢±¾ ¯®±«¥¤®¢ ²¥«¼­®±²¼
¡°®± ­¨© ­  ­¥¯¥°¥±¥ª ¾¹¨¥±¿ £°³¯¯», ±®±²®¿¹¨¥ ¨§ b(lg n)=2c
¡°®± ­¨© ª ¦¤ ¿. (¥±ª®«¼ª® ·«¥­®¢ ®ª ¦³²±¿ ¢­¥ £°³¯¯, ¥±«¨ ¯°¨
¤¥«¥­¨¨ ¡³¤¥² ®±² ²®ª.) ¨±«® £°³¯¯ ­¥ ¬¥­¼¸¥ 2n= lg n ; 1.
®¡»²¨¿ ¢ ° §­»µ £°³¯¯ µ ­¥§ ¢¨±¨¬», ¯®½²®¬³ ¢¥°®¿²­®±²¼
²®£®, ·²® ­¨ ®¤­  ¨§ ½²¨µ £°³¯¯ ­¥ ±®±²®¨² ¨§ ®¤­¨µ ®°«®¢, ­¥
¡®«¼¸¥
p
p
(1 ; 1= n)2n= lg n;1 6 e;(2n= lg n;1)= n
= O(e; lg n ) = O(1=n)
» ¨±¯®«¼§®¢ «¨
²®² ´ ª², ·²® 1 + x 6 ex (2.7),   ² ª¦¥ ²®, ·²®
p
(2n= lg n ; 1)= n > lg n ; O(1).
² ª, ± ¢¥°®¿²­®±²¼¾ ­¥ ¬¥­¥¥ 1 ; O(1=n) ¤«¨­  ­ ¨¡®«¼¸¥£®
³· ±²ª  ¯®¤°¿¤ ¨¤³¹¨µ ®°«®¢ ­¥ ¬¥­¼¸¥ blg n=2c = 
(lg n), ¯®½²®¬³ ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ­¨ª ª ­¥ ¬¥­¼¸¥ (1 ; 1=n)
(lg n) =

(lg n).
¯° ¦­¥­¨¿
6.6-1  °» ¡°®± ¾² ¢ b ³°­; ¢±¥ ¡°®± ­¨¿ ­¥§ ¢¨±¨¬» ¤°³£ ®²
¤°³£ , ¨ ª ¦¤»© ¸ ° ° ¢­®¢¥°®¿²­® ¯®¯ ¤ ¥² ¢ «¾¡³¾ ¨§ ³°­.
¥¬³ ° ¢­® ®¦¨¤ ¥¬®¥ ª®«¨·¥±²¢® ¡°®± ­¨© ¤® ¬®¬¥­² , ª®£¤  ¢
®¤­®© ¨§ ³°­ ®ª ¦¥²±¿ ¤¢  ¸ ° ?
6.6-2? ³¹¥±²¢¥­­® «¨ ¤«¿ ¯°¨¢¥¤¥­­®£® ­ ¬¨  ­ «¨§  ¯ ° ¤®ª± 
¤­¿ °®¦¤¥­¨¿ ²®, ·²® ¤­¨ °®¦¤¥­¨¿ ­¥§ ¢¨±¨¬» ¢ ±®¢®ª³¯­®±²¨,
¨«¨ ¡»«® ¡» ¤®±² ²®·­® ¨µ ¯®¯ °­®© ­¥§ ¢¨±¨¬®±²¨? ¡º¿±­¨²¥
±¢®© ®²¢¥².
6.6-3? ª®«¼ª¨µ £®±²¥© ­ ¤® ¯°¨£« ±¨²¼ ­  ¢¥·¥°¨­ª³, ·²®¡» ±ª®°¥¥ ¢±¥£® ®ª § «®±¼, ·²® ¯® ¬¥­¼¸¥© ¬¥°¥ ²°®¥ ¨§ ­¨µ °®¤¨«¨±¼ ¢
®¤¨­ ¤¥­¼?
6.6-4?  ª³¾ ¤®«¾ ±®±² ¢«¿¾² ¨­º¥ª¶¨¨ ±°¥¤¨ ¢±¥µ ®²®¡° ¦¥­¨©
k-½«¥¬¥­²­®£® ¬­®¦¥±²¢  ¢ n-½«¥¬¥­²­®¥?  ª ±¢¿§ ­ ½²®² ¢®¯°®±

134

« ¢  6 ®¬¡¨­ ²®°¨ª  ¨ ¢¥°®¿²­®±²¼

± ¯ ° ¤®ª±®¬ ¤­¿ °®¦¤¥­¨¿?
6.6-5? ³±²¼ n ¸ °®¢ ¡°®± ¾² ¢ n ³°­, ¢±¥ ¡°®± ­¨¿ ­¥§ ¢¨±¨¬»,
¯®¯ ¤ ­¨¿ ª ¦¤®£® ¸ °  ¢® ¢±¥ ³°­» ° ¢­®¢¥°®¿²­». ¥¬³ ° ¢­®
®¦¨¤ ¥¬®¥ ª®«¨·¥±²¢® ¯³±²»µ ³°­?  ®¦¨¤ ¥¬®¥ ª®«¨·¥±²¢® ³°­,
¢ ª®²®°»¥ ¯®¯ «® ¢ ²®·­®±²¨ ¯® ®¤­®¬³ ¸ °³?
6.6-6? «³·¸¨²¥ ­¨¦­¾¾ ®¶¥­ª³ ¤«¿ ¤«¨­ ³· ±²ª®¢ ¨§ ®¤­¨µ ®°«®¢, ¯®ª § ¢, ·²® ¯°¨ n ¡°®± ­¨¿µ ±¨¬¬¥²°¨·­®© ¬®­¥²» ³· ±²®ª
¤«¨­» lg n ; 2 lg lg n ­ ©¤¥²±¿ ± ¢¥°®¿²­®±²¼¾ ­¥ ¬¥­¼¸¥ 1 ; 1=n.

 ¤ ·¨
6-1  °» ¨ ³°­»
 ½²®© § ¤ ·¥ ¬» ±·¨² ¥¬ ·¨±«® ±¯®±®¡®¢ ° §«®¦¨²¼ n ¸ °®¢ ¢
b ° §«¨·­»µ ³°­.
 . °¥¤¯®«®¦¨¬, ·²® ¢±¥ ¸ °» ° §­»¥, ¨µ ¯®°¿¤®ª ¢­³²°¨ ³°­»
­¥ ³·¨²»¢ ¥²±¿. ®ª ¦¨²¥, ·²® ±³¹¥±²¢³¥² bn ±¯®±®¡®¢ ¯®¬¥±²¨²¼
¸ °» ¢ ³°­».
¡. °¥¤¯®«®¦¨¬, ·²® ¢±¥ ¸ °» ° §­»¥ ¨ ¨µ ¯®°¿¤®ª ¢ ³°­¥ ±³¹¥±²¢¥­. ®ª ¦¨²¥, ·²® ¸ °» ¬®¦­® ° §«®¦¨²¼ ¯® ³°­ ¬
(b + n ; 1)!=(b ; 1)! ±¯®±®¡ ¬¨. (ª § ­¨¥: ¯®¤±·¨² ©²¥ ·¨±«® ±¯®±®¡®¢ ° ±±² ¢¨²¼ n ° §«¨·­»µ ¸ °®¢ ¨ b ; 1 ®¤¨­ ª®¢»µ ·¥°²®·¥ª
¢ °¿¤.)
¢. °¥¤¯®«®¦¨¬, ·²® ¢±¥ ¸ °» ®¤¨­ ª®¢», ¨ ¨µ ¯®°¿¤®ª ¢ ³°­¥ ­¥
¨¬¥¥² §­ ·¥­¨¿. ®ª ¦¨²¥, ·²® ·¨±«® ±¯®±®¡®¢ ° ±ª« ¤ª¨ ¸ °®¢
¯® ³°­ ¬ ° ¢­¿¥²±¿ Cbn+n;1 . (ª § ­¨¥: ¨±¯®«¼§³©²¥ ²³ ¦¥ ¨¤¥¾,
·²® ¢ ¯³­ª²¥ (¡).)
£. ®ª ¦¨²¥, ·²® ¥±«¨ ¸ °» ®¤¨­ ª®¢»¥ ¨ ¢ «¾¡³¾ ³°­³ ¯®¬¥¹ ¥²±¿ ­¥ ¡®«¼¸¥ ®¤­®£® ¸ ° , ²® ·¨±«® ±¯®±®¡®¢ ° ¢­® Cbn .
¤. ®ª ¦¨²¥, ·²® ¥±«¨ ¸ °» ®¤¨­ ª®¢»¥ ¨ ¢ «¾¡®© ³°­¥ ¤®«¦¥­
®ª § ²¼±¿ ¯® ¬¥­¼¸¥© ¬¥°¥ ®¤¨­ ¸ °, ²® ·¨±«® ±¯®±®¡®¢ ° ±ª« ¤ª¨
¸ °®¢ ° ¢­® Cnb;;11 .
6-2 °®£° ¬¬  ¢»·¨±«¥­¨¿ ¬ ª±¨¬³¬ 
 ±±¬®²°¨¬ ² ª³¾ ¯°®£° ¬¬³ ¯®¨±ª  ¬ ª±¨¬³¬  ¢ ­¥³¯®°¿¤®·¥­­®¬ ¬ ±±¨¢¥ A[1 : :n].
1 max ;1
2 for i 1 to n
3
do . ° ¢­¨²¼ A[i] ± max.
4
if A[i] > max
5
then max A[i]
» µ®²¨¬ ®¯°¥¤¥«¨²¼, ±ª®«¼ª® ° § ¢ ±°¥¤­¥¬ ¢»¯®«­¿¥²±¿ ¯°¨-

 ¤ ·¨ ª £« ¢¥ 6

135

±¢ ¨¢ ­¨¥ ¢ ±²°®ª¥ 5. °¥¤¯®« £ ¥²±¿, ·²® ·¨±«  ¢ ¬ ±±¨¢¥ A ° §«¨·­» ¨ ° ±¯®«®¦¥­» ¢ ±«³· ©­®¬ ¯®°¿¤ª¥ (¢±¥ ¯¥°¥±² ­®¢ª¨ ° ¢­®¢¥°®¿²­»).
 . ±«¨ ·¨±«® x ±«³· ©­® ¢»¡° ­® ¨§ i ° §«¨·­»µ ·¨±¥«, ²® ± ª ª®© ¢¥°®¿²­®±²¼¾ ®­® ®ª ¦¥²±¿ ¬ ª±¨¬ «¼­»¬ ·¨±«®¬ ±°¥¤¨ ­¨µ?
¡.  ª ±®®²­®±¨²±¿ A[i] ± ¯°¥¤»¤³¹¨¬¨ ½«¥¬¥­² ¬¨ ¬ ±±¨¢  ¤«¿
²¥µ i, ¯°¨ ª®²®°»µ ¢»¯®«­¿¥²±¿ ±²°®ª  5?
¢. ¥¬³ ° ¢­  ¢¥°®¿²­®±²¼ ¢»¯®«­¥­¨¿ ±²°®ª¨ 5 ¯°®£° ¬¬» ¤«¿
¤ ­­®£® §­ ·¥­¨¿ i?
£. ³±²¼ si | ±«³· ©­ ¿ ¢¥«¨·¨­ , ° ¢­ ¿ 1 ¨«¨ 0 ¢ § ¢¨±¨¬®±²¨
®² ²®£®, ¢»¯®«­¿« ±¼ ±²°®ª  5 ­  i-¬ ¸ £¥ ¶¨ª«  ¨«¨ ­¥². ¥¬³
° ¢­® M[si ]?
¤. ³±²¼ s = s1 +s2 +  +sn | ®¡¹¥¥ ·¨±«® ¯°¨±¢ ¨¢ ­¨© ¢ ±²°®ª¥
5 ¯°¨ ¨±¯®«­¥­¨¨ ¢±¥© ¯°®£° ¬¬». ®ª ¦¨²¥, ·²® M[s] = (lg n).
6-3 °®¡«¥¬  ¢»¡®° 
 ¢¥¤³¾¹ ¿ ª ´¥¤°®© ¯°¨­¨¬ ¥² ­  ° ¡®²³ ­®¢®£® ±®²°³¤­¨ª . ­  ­ §­ ·¨«  ±®¡¥±¥¤®¢ ­¨¿ n ¯°¥²¥­¤¥­² ¬ ¨ µ®·¥² ¢»¡° ²¼
­ ¨¡®«¥¥ ª¢ «¨´¨¶¨°®¢ ­­®£® ¨§ ­¨µ. ¤­ ª® ³­¨¢¥°±¨²¥²±ª¨¥
¯° ¢¨«  ²°¥¡³¾², ·²®¡» ¯®±«¥ ¡¥±¥¤» ¯°¥²¥­¤¥­²³ ±° §³ ±®®¡¹ «®±¼, ¯°¨­¿² ®­ ¨«¨ ­¥².
«¿ ½²®£® ®­  ¯°¨¬¥­¿¥² ² ª®¥ ¯° ¢¨«®. ­ · «  ®­  £®¢®°¨² ±
¯¥°¢»¬¨ k ¯°¥²¥­¤¥­² ¬¨, ®²ª §»¢ ¿ ¨¬ ­¥§ ¢¨±¨¬® ®² ¨µ ª¢ «¨´¨ª ¶¨¨. ±«¨ ±°¥¤¨ ®±² ¢¸¨µ±¿ ¥±²¼ ¡®«¥¥ ª¢ «¨´¨¶¨°®¢ ­­»©,
·¥¬ ¯¥°¢»¥ k, ²® ¯¥°¢»© ¨§ ² ª®¢»µ ¯°¨­¨¬ ¥²±¿. ±«¨ ­¥², ¯°¨­¨¬ ¥²±¿ ¯®±«¥¤­¨© ¨§ ¯°¥²¥­¤¥­²®¢. ®ª ¦¨²¥, ·²® ¢¥°®¿²­®±²¼
¢»¡° ²¼ ² ª¨¬ ±¯®±®¡®¬ «³·¸¥£® ¨§ ¯°¥²¥­¤¥­²®¢ ¡³¤¥² ¬ ª±¨¬ «¼­  (¨ ° ¢­  ¯°¨¬¥°­® 1=e), ¥±«¨ k ¯°¨¬¥°­® ° ¢­® n=e.
6-4 ¥°®¿²­®±²­»© ±·¥²·¨ª
 ¯®¬®¹¼¾ t-¡¨²­®£® ±·¥²·¨ª  ¬» ¬®¦¥¬ ±·¨² ²¼ ¤® 2t ; 1.
«¥¤³¾¹¨© ¯°¨¥¬ ¢¥°®¿²­®±²­®£® ¯®¤±·¥²  (probabilistic counting,
R. Morris) ¤ ¥² ¢®§¬®¦­®±²¼ ¢¥±²¨ ±·¥² ¤® ª³¤  ¡®«¼¸¨µ §­ ·¥­¨©,
¯° ¢¤  ¶¥­®¾ ­¥ª®²®°®© ¯®²¥°¨ ²®·­®±²¨.
»¡¥°¥¬ ¢®§° ±² ¾¹³¾ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¶¥«»µ ­¥®²°¨¶ ²¥«¼­»µ ·¨±¥« ni (£¤¥ i ¬¥­¿¥²±¿ ®² 0 ¤® 2t ;1). ¥ ±¬»±« ² ª®¢: ¥±«¨
§­ ·¥­¨¥ t-¡¨²­®£® °¥£¨±²°  ° ¢­® i, ²® ½²® ®§­ · ¥², ·²® ¯®¤±·¨²»¢ ¥¬®¥ ª®«¨·¥±²¢® (·¨±«® ¢»¯®«­¥­­»µ ®¯¥° ¶¨© Increment)
¯°¨¬¥°­® ° ¢­® ni . » ±·¨² ¥¬, ·²® n0 = 0.
¯¥° ¶¨¿ Increment ³¢¥«¨·¨¢ ¥² §­ ·¥­¨¥ ±·¥²·¨ª , ±®¤¥°¦ ¹¥£® i, ± ­¥ª®²®°®© ¢¥°®¿²­®±²¼¾. ¬¥­­®, ·¨±«® i ³¢¥«¨·¨¢ ¥²±¿
­  1 ± ¢¥°®¿²­®±²¼¾ 1=(ni+1 ; ni ), ¨ ®±² ¥²±¿ ­¥¨§¬¥­­»¬ ¢ ®±² «¼­»µ ±«³· ¿µ. (±«¨ i = 2t ; 1, ²® ¯°®¨±µ®¤¨² ¯¥°¥¯®«­¥­¨¥.) ¤¥¿
¯°®±² : ¢ ±°¥¤­¥¬ ¤«¿ ³¢¥«¨·¥­¨¿ i ­  ¥¤¨­¨¶³ ¯®²°¥¡³¥²±¿ ª ª
° § ni+1 ; ni ®¯¥° ¶¨©.

136

« ¢  6 ®¬¡¨­ ²®°¨ª  ¨ ¢¥°®¿²­®±²¼

±«¨ ni = i ¤«¿ ¢±¥µ i > 0, ²® ¯®«³· ¥¬ ®¡»·­»© ±·¥²·¨ª. ®«¥¥
¨­²¥°¥±­»¥ ±¨²³ ¶¨¨ ¢®§­¨ª ¾², ¥±«¨ ¢»¡° ²¼, ­ ¯°¨¬¥°, ni =
2i;1 ¤«¿ i > 0 ¨«¨ ni = Fi (i-¥ ·¨±«® ¨¡®­ ··¨, ±¬. ° §¤. 2.2).
» ¡³¤¥¬ ¯°¥¤¯®« £ ²¼, ·²® n2t ;1 ¤®±² ²®·­® ¢¥«¨ª®, ¨ ¯°¥­¥¡°¥£ ²¼ ¢®§¬®¦­®±²¼¾ ¯¥°¥¯®«­¥­¨¿.
 . ®ª ¦¨²¥, ·²® ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ±®¤¥°¦¨¬®£®
±·¥²·¨ª  ¯®±«¥ ¢»¯®«­¥­¨¿ n ®¯¥° ¶¨© Increment, ¢ ²®·­®±²¨
° ¢­® n.
¡. ¨±¯¥°±¨¿ ±«³· ©­®© ¢¥«¨·¨­», ° ¢­®© ±®¤¥°¦¨¬®¬³
±·¥²·¨ª  ¯®±«¥ n ®¯¥° ¶¨© Increment, § ¢¨±¨² ®² ¢»¡®°  ¯®±«¥¤®¢ ²¥«¼­®±²¨ n0 ; n1; : : : .  ©¤¨²¥ ½²³ ¤¨±¯¥°±¨¾ ¤«¿ ±«³· ¿
ni = 100i.

 ¬¥· ­¨¿
¡¹¨¥ ¬¥²®¤» °¥¸¥­¨¿ ¢¥°®¿²­®±²­»µ § ¤ · ®¡±³¦¤ «¨±¼ ¢ §­ ¬¥­¨²®© ¯¥°¥¯¨±ª¥  ±ª «¿ (B. Pascal) ¨ ¥°¬  (P. de Fermat), ­ · ¢¸¥©±¿ ¢ 1654 £®¤³, ¨ ¢ ª­¨£¥ ¾©£¥­±  (C. Huygens, 1657). ®«¥¥ ±²°®£®¥ ¨§«®¦¥­¨¥ ²¥®°¨¨ ¢¥°®¿²­®±²¥© ¡»«® ¤ ­® ¢ ° ¡®² µ
¥°­³««¨ (J. Bernoulli, 1713) ¨ ³ ¢°  (A.De Moivre, 1730).  «¼­¥©¸¥¥ ° §¢¨²¨¥ ²¥®°¨¨ ¢¥°®¿²­®±²¥© ±¢¿§ ­® ± ¨¬¥­ ¬¨  ¯« ± 
(P. S. de Laplace), ³ ±±®­  (S.-D. Poisson) ¨  ³±±  (C. F. Gauss).
³¬¬» ±«³· ©­»µ ¢¥«¨·¨­ ¨±±«¥¤®¢ «¨±¼ . . ¥¡»¸¥¢»¬ ¨
. .  °ª®¢»¬ (±² °¸¨¬).  1933 £®¤³ . . ®«¬®£®°®¢ ±´®°¬³«¨°®¢ «  ª±¨®¬» ²¥®°¨¨ ¢¥°®¿²­®±²¥©. ¶¥­ª¨ µ¢®±²®¢ ° ±¯°¥¤¥«¥­¨© ¯°¨¢®¤¿² ¥°­®¢ [40] ¨ ®´¤¨­£ [99].  ¦­»¥ °¥§³«¼² ²» ® ±«³· ©­»µ ª®¬¡¨­ ²®°­»µ ±²°³ª²³° µ ¯°¨­ ¤«¥¦ ² °¤¥¸³
(P. Erdos).
¨²¥° ²³°  ¯® ²¥¬¥ £« ¢»: ­³² [121], ¾ [140] (µ®°®¸¨¥ ¯®±®¡¨¿ ¯® ½«¥¬¥­² °­®© ª®¬¡¨­ ²®°¨ª¥ ¨ ¯®¤±·¥²³); ¨««¨­£±«¨ [28],
 ­£ [41], °¥©ª [57], ¥««¥° [66], ®§ ­®¢ [171] (±² ­¤ °²­»¥ ³·¥¡­¨ª¨ ¯® ²¥®°¨¨ ¢¥°®¿²­®±²¥©); ®««®¡ ± [30], ®´°¨ [100], ¯¥­±¥° [179] (²¥µ­¨ª  ¢¥°®¿²­®±²­®£®  ­ «¨§ ).

II

®°²¨°®¢ª  ¨ ¯®°¿¤ª®¢»¥ ±² ²¨±²¨ª¨

¢¥¤¥­¨¥
 ½²®© · ±²¨ ¬» ° ±±¬®²°¨¬ ­¥±ª®«¼ª®  «£®°¨²¬®¢, °¥¸ ¾¹¨µ
§ ¤ ·³ ±®°²¨°®¢ª¨ (sorting problem). ±µ®¤­»¬ ¤ ­­»¬ ¤«¿ ½²®©
§ ¤ ·¨ ¿¢«¿¥²±¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ·¨±¥« ha1 ; a2; : : :; an i. ¥§³«¼² ²®¬ ¤®«¦­  ¡»²¼ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ha01; a02; : : :; a0n i, ±®±²®¿¹ ¿
¨§ ²¥µ ¦¥ ·¨±¥«, ¨¤³¹¨µ ¢ ­¥³¡»¢ ¾¹¥¬ ¯®°¿¤ª¥: a01 6 a02 6    6
a0n . ¡»·­® ¨±µ®¤­ ¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼ § ¤ ­  ª ª ¬ ±±¨¢, µ®²¿
¢®§¬®¦­» ¨ ¤°³£¨¥ ¢ °¨ ­²» (­ ¯°¨¬¥°, ±¢¿§ ­­»© ±¯¨±®ª).
²°³ª²³°  ±®°²¨°³¥¬»µ ®¡º¥ª²®¢
  ¯° ª²¨ª¥ °¥¤ª® ²°¥¡³¥²±¿ ³¯®°¿¤®·¨¢ ²¼ ·¨±«  ª ª ² ª®¢»¥.
¡»·­® ­ ¤® ±®°²¨°®¢ ²¼ § ¯¨±¨ (records), ±®¤¥°¦ ¹¨¥ ­¥±ª®«¼ª®
¯®«¥©, ¨ ° ±¯®« £ ²¼ ¨µ ¢ ¯®°¿¤ª¥, ®¯°¥¤¥«¿¥¬»¬ ®¤­¨¬ ¨§ ¯®«¥©. [ ¯°¨¬¥°, ¢  °µ¨¢¥ ®²¤¥«  ª ¤°®¢ ¤«¿ ª ¦¤®£® ±®²°³¤­¨ª 
´¨°¬» ¬®¦¥² µ° ­¨²¼±¿ § ¯¨±¼, ±®¤¥°¦ ¹ ¿ ° §«¨·­»¥ ¯®«¿ (´ ¬¨«¨¿, ¨¬¿, ®²·¥±²¢®, £®¤ °®¦¤¥­¨¿,  ¤°¥± ¨ ². ¯.), ¨ ¢ ª ª®©-²®
¬®¬¥­² ¬®¦¥² ¯®­ ¤®¡¨²¼±¿ ³¯®°¿¤®·¨²¼ ¢±¥ § ¯¨±¨ ¯® £®¤ ¬ °®¦¤¥­¨¿.] ®«¥, ¯® ª®²®°®¬³ ¯°®¢®¤¨²±¿ ±®°²¨°®¢ª  (£®¤ °®¦¤¥­¨¿
¢ ­ ¸¥¬ ¯°¨¬¥°¥), ­ §»¢ ¥²±¿ ª«¾·®¬ (key),   ®±² «¼­»¥ ¯®«¿ |
¤®¯®«­¨²¥«¼­»¬¨ ¤ ­­»¬¨ (satellite data). ®¦­® ¯°¥¤±² ¢«¿²¼
±¥¡¥ ¤¥«® ² ª:  «£®°¨²¬ ±®°²¨°³¥² ª«¾·¨, ­® ¢¬¥±²¥ ± ª ¦¤»¬
ª«¾·®¬ ¯¥°¥¬¥¹ ¾²±¿ (¡¥§ ¨§¬¥­¥­¨¿) ¤®¯®«­¨²¥«¼­»¥ ¤ ­­»¥, ±
­¨¬ ±¢¿§ ­­»¥. (±«¨ ½²¨µ ¤ ­­»µ ¬­®£®, ° §³¬­® ¯¥°¥¬¥¹ ²¼ ­¥
± ¬¨ ¤ ­­»¥,   «¨¸¼ ³ª § ²¥«¼ ­  ­¨µ.)
±¥ ½²¨ ¯®¤°®¡­®±²¨ ¬» ­¥ ° ±±¬ ²°¨¢ ¥¬, ®£° ­¨·¨¢ ¿±¼ § ¤ ·¥© ±®°²¨°®¢ª¨ ª«¾·¥©. °¨¢®¤¨¬»¥ ­ ¬¨  «£®°¨²¬» ¿¢«¿¾²±¿,
² ª¨¬ ®¡° §®¬, «¨¸¼ À±ª¥«¥²®¬Á °¥ «¼­®© ¯°®£° ¬¬», ª ª®²®°®¬³
­³¦­® ¤®¡ ¢¨²¼ ®¡° ¡®²ª³ ¤®¯®«­¨²¥«¼­»µ ¤ ­­»µ (·²® ®¡»·­®
­¥ ±«®¦­®, µ®²¿ ¨ µ«®¯®²­®).

140

 ±²¼ II ®°²¨°®¢ª  ¨ ¯®°¿¤ª®¢»¥ ±² ²¨±²¨ª¨

«£®°¨²¬» ±®°²¨°®¢ª¨
» ³¦¥ ¢±²°¥· «¨±¼ ¢ £« ¢¥ 1 ± ¤¢³¬¿  «£®°¨²¬ , ±®°²¨°³¾¹¨¬¨ n ·¨±¥« §  ¢°¥¬¿ (n2 ) ¢ µ³¤¸¥¬ ±«³· ¥. µ ¯°®±²®² , ®¤­ ª®, ¤¥« ¥² ¨µ ½´´¥ª²¨¢­»¬¨ ¤«¿ ±®°²¨°®¢ª¨ ­¥¡®«¼¸®£® ¬ ±±¨¢ 
¡¥§ ¤®¯®«­¨²¥«¼­®© ¯ ¬¿²¨ (in place). (¬¥¥²±¿ ¢ ¢¨¤³, ·²® ¬» ­¥
¨¬¥¥¬ ¯° ¢  § ¢®¤¨²¼ ¥¹¥ ®¤­®£® ¬ ±±¨¢ , ­® ¯¥°¥¬¥­­»¥ ¤«¿ ·¨±¥« ¨±¯®«¼§®¢ ²¼ ¬®¦­®). «£®°¨²¬ ±®°²¨°®¢ª¨ ±«¨¿­¨¥¬ ¨¬¥¥²
«³·¸³¾  ±¨¬¯²®²¨·¥±ª³¾ ®¶¥­ª³ ¢°¥¬¥­¨ ° ¡®²», ­® ®­ ²°¥¡³¥²
¤®¯®«­¨²¥«¼­®£® ¬ ±±¨¢ .
 ½²®© · ±²¨ ª­¨£¨ ¬» ° ±±¬®²°¨¬ ¥¹¥ ¤¢   «£®°¨²¬  ±®°²¨°®¢ª¨ ¢¥¹¥±²¢¥­­»µ ·¨±¥«. ¥°¢»© ¨§ ­¨µ ­ §»¢ ¥²±¿ À±®°²¨°®¢ª®©
± ¯®¬®¹¼¾ ª³·¨Á (heapsort). ¤¥±¼ Àª³· Á | ­¥ª®²®° ¿ ±²°³ª²³° 
¤ ­­»µ, ¨¬¥¾¹ ¿ ¬­®£® ¯°¨«®¦¥­¨© (®¤­® ¨§ ­¨µ, ®·¥°¥¤¨ ± ¯°¨®°¨²¥² ¬¨, ¬» ² ª¦¥ ° ±±¬®²°¨¬ ¢ £« ¢¥ 7). ²®²  «£®°¨²¬ ­¥
²°¥¡³¥² ¤®¯®«­¨²¥«¼­®£® ¬ ±±¨¢  ¨ ° ¡®² ¥² §  ¢°¥¬¿ (n lg n) ¢
µ³¤¸¥¬ ±«³· ¥.
 £« ¢¥ 8 ±²°®¨²±¿ ¤°³£®©  «£®°¨²¬, ­ §»¢ ¥¬»© À¡»±²°®© ±®°²¨°®¢ª®©Á (quicksort).  µ³¤¸¥¬ ±«³· ¥ ®­ ²°¥¡³¥² ¢°¥¬¥­¨ (n2 ),
­® ¢ ±°¥¤­¥¬ | «¨¸¼ (n lg n), ¨ ­  ¯° ª²¨ª¥ ®­ ®¡»·­® ¡»±²°¥¥
±®°²¨°®¢ª¨ ± ¯®¬®¹¼¾ ª³·¨ (¥£® ¢­³²°¥­­¨© ¶¨ª« ¯°®±², ¯®½²®¬³
ª®­±² ­²  ¢  ±¨¬¯²®²¨·¥±ª®© ®¶¥­ª¥ ¬¥­¼¸¥).
±¥ ½²¨  «£®°¨²¬» (±®°²¨°®¢ª¨ ¢±² ¢ª ¬¨, ±«¨¿­¨¥¬, ± ¯®¬®¹¼¾ ª³·¨ ¨ ¡»±²° ¿ ±®°²¨°®¢ª ) ¨±¯®«¼§³¾² ²®«¼ª® ¯®¯ °­»¥
±° ¢­¥­¨¿ ®¡º¥ª²®¢, ­® ­¥ ¨µ ¢­³²°¥­­¾¾ ±²°³ª²³°³.  £« ¢¥ 9 ¬»
¯®ª §»¢ ¥¬, ·²® «¾¡ ¿ ±®°²¨°®¢ª  ² ª®£® ¢¨¤  ¢ µ³¤¸¥¬ ±«³· ¥
²°¥¡³¥² ¢°¥¬¥­¨ 
(n lg n), ¢¢¥¤¿ ¯®¤µ®¤¿¹³¾ ´®°¬ «¼­³¾ ¬®¤¥«¼
(° §°¥¸ ¾¹¨¥ ¤¥°¥¢¼¿). ¥¬ ± ¬»¬ ±² ­®¢¨²±¿ ¿±­»¬, ·²® ±®°²¨°®¢ª¨ ±«¨¿­¨¥¬ ¨ ± ¯®¬®¹¼¾ ª³·¨  ±¨¬¯²®²¨·¥±ª¨ ®¯²¨¬ «¼­».
¤­ ª® ½²  ­¨¦­¿¿ ®¶¥­ª  ­¥ ° ±¯°®±²° ­¿¥²±¿ ­   «£®°¨²¬», ¨±¯®«¼§³¾¹¨¥ ¢­³²°¥­­¾¾ ±²°³ª²³°³ ¤ ­­»µ.  £« ¢¥ 9 ° ±±¬ ²°¨¢ ¥²±¿ ­¥±ª®«¼ª® ¯°¨¬¥°®¢ ² ª®£® °®¤ . ®°²¨°®¢ª  ¯®¤±·¥²®¬ (counting sort) ¯®§¢®«¿¥² ®²±®°²¨°®¢ ²¼ n ¶¥«»µ ·¨±¥« ¢
¤¨ ¯ §®­¥ ®² 1 ¤® k §  ¢°¥¬¿ O(n+k), ¨±¯®«¼§³¿ ±®°²¨°³¥¬»¥ ·¨±« 
ª ª ¨­¤¥ª±» ¢ ¬ ±±¨¢¥ ° §¬¥°  k. ±«¨ k = O(n), ¢°¥¬¿ ±®°²¨°®¢ª¨
±² ­®¢¨²±¿ ¯°®¯®°¶¨®­ «¼­»¬ ° §¬¥°³ ¬ ±±¨¢ . ®¤±²¢¥­­»©  «£®°¨²¬, ­ §»¢ ¥¬»© À¶¨´°®¢®© ±®°²¨°®¢ª®©Á, ¯°¨¬¥­¿¥² ±µ®¤­»©
¯°¨¥¬ ¯®° §°¿¤­®, ¨ ¯®§¢®«¿¥² ®²±®°²¨°®¢ ²¼ n ¶¥«»µ ·¨±¥«, ª ¦¤®¥ ¨§ ª®²®°»µ ¨¬¥¥² d ° §°¿¤®¢ ¢ k-¨·­®© ±¨±²¥¬¥ ±·¨±«¥­¨¿, § 
¢°¥¬¿ O(d(n + k)). ±«¨ ±·¨² ²¼, ·²® d ¯®±²®¿­­®,   k ¥±²¼ O(n), ²®
®¡¹¥¥ ¢°¥¬¿ ¥±²¼ O(n). °¥²¨©  «£®°¨²¬ ² ª®£® °®¤ , ±®°²¨°®¢ª 
¢»·¥°¯»¢ ­¨¥¬, ¯°¥¤¯®« £ ¥², ·²® ±®°²¨°³¥¬»¥ ·¨±«  ° ¢­®¬¥°­® ° ±¯°¥¤¥«¥­» ­  ®²°¥§ª¥ ¨ ­¥§ ¢¨±¨¬», ¨ ¢ ±°¥¤­¥¬ ²°¥¡³¥²
O(n) ¤¥©±²¢¨© ¤«¿ n ·¨±¥«.

 ±²¼ II ®°²¨°®¢ª  ¨ ¯®°¿¤ª®¢»¥ ±² ²¨±²¨ª¨

141

®°¿¤ª®¢»¥ ±² ²¨±²¨ª¨
±«¨ ­ ¬ ­ ¤® ­ ©²¨ i-© ¯® ¢¥«¨·¨­¥ ½«¥¬¥­² ¬ ±±¨¢ , ¬®¦­®
±­ · «  ®²±®°²¨°®¢ ²¼ ¬ ±±¨¢, ·²® ²°¥¡³¥² ¢°¥¬¥­¨ 
(n lg n), ¥±«¨ ­¥ ¯®«¼§®¢ ²¼±¿ ¢­³²°¥­­¥© ±²°³ª²³°®© ½«¥¬¥­²®¢ (£« ¢  9). ®
¯°¨ ½²®¬ ¢»¯®«­¿¥²±¿ «¨¸­¿¿ ° ¡®²  (±®°²¨°®¢ª  ®±² «¼­»µ ½«¥¬¥­²®¢), ¨ ¬®¦­® ¯®±²°®¨²¼ ¡®«¥¥ ½´´¥ª²¨¢­»¥  «£®°¨²¬» ¤«¿
§ ¤ ·¨ ®²»±ª ­¨¿ i-£® ¯® ¢¥«¨·¨­¥ ½«¥¬¥­²  (ª®²®°³¾ ­ §»¢ ¾²
² ª¦¥ § ¤ ·¥© ® ¯®°¿¤ª®¢»µ ±² ²¨±²¨ª µ).  £« ¢¥ 10 ¯°¨¢®¤¿²±¿
¤¢  ² ª¨µ  «£®°¨²¬ : ®¤¨­ ²°¥¡³¥² ¢°¥¬¥­¨ O(n2) ¢ µ³¤¸¥¬ ±«³· ¥ ¨ O(n) ¢ ±°¥¤­¥¬; ¤°³£®©, ¡®«¥¥ ±«®¦­»©, ®¡µ®¤¨²±¿ ¢°¥¬¥­¥¬
O(n) ¢ µ³¤¸¥¬ ±«³· ¥.
±¯®«¼§³¥¬»¥ ±¢¥¤¥­¨¿ ¨§ ¬ ²¥¬ ²¨ª¨
®«¼¸ ¿ · ±²¼ ¬ ²¥°¨ «  £« ¢ 7{10 ¤®±²³¯­  ·¨² ²¥«¾ ±
¬¨­¨¬ «¼­®© ¬ ²¥¬ ²¨·¥±ª®© ¯®¤£®²®¢ª®©. ¤­ ª® ¢¥°®¿²­®±²­»©  ­ «¨§  «£®°¨²¬®¢ (¡»±²°®© ±®°²¨°®¢ª¨, ±®°²¨°®¢ª¨
¢»·¥°¯»¢ ­¨¥¬ ¨ ®²»±ª ­¨¿ i-£® ¯® ¢¥«¨·¨­¥ ½«¥¬¥­² ) ²°¥¡³¥² §­ ª®¬±²¢  ± ²¥®°¨¥© ¢¥°®¿²­®±²¥© (£« ¢  6). ®¡ ¢¨¬, ·²®
 «£®°¨²¬ ®²»±ª ­¨¿ i-£® ½«¥¬¥­²  §  «¨­¥©­®¥ ¢°¥¬¿ (¢ µ³¤¸¥¬
±«³· ¥) ¡®«¥¥ ±«®¦¥­, ·¥¬ ¤°³£¨¥  «£®°¨²¬» ½²®© £« ¢».

7

®°²¨°®¢ª  ± ¯®¬®¹¼¾ ª³·¨

 ½²®© £« ¢¥ ° ±±¬®²°¥­  «£®°¨²¬ ±®°²¨°®¢ª¨ ± ¯®¬®¹¼¾ ª³·¨
(heapsort).  ª ¨  «£®°¨²¬ ±®°²¨°®¢ª¨ ±«¨¿­¨¥¬, ®­ ²°¥¡³¥² ¢°¥¬¥­¨ O(n lg n) ¤«¿ ±®°²¨°®¢ª¨ n ®¡º¥ª²®¢, ­® ®¡µ®¤¨²±¿ ¤®¯®«­¨²¥«¼­®© ¯ ¬¿²¼¾ ° §¬¥°  O(1) (¢¬¥±²® O(n) ¤«¿ ±®°²¨°®¢ª¨ ±«¨¿­¨¥¬).  ª¨¬ ®¡° §®¬, ½²®²  «£®°¨²¬ ±®·¥² ¥² ¯°¥¨¬³¹¥±²¢  ¤¢³µ
° ­¥¥ ° ±±¬®²°¥­­»µ  «£®°¨²¬®¢ | ±®°²¨°®¢ª¨ ±«¨¿­¨¥¬ ¨ ±®°²¨°®¢ª¨ ¢±² ¢ª ¬¨.
²°³ª²³°  ¤ ­­»µ, ª®²®°³¾ ¨±¯®«¼§³¥²  «£®°¨²¬ (®­  ­ §»¢ ¥²±¿ À¤¢®¨·­®© ª³·¥©Á) ®ª §»¢ ¥²±¿ ¯®«¥§­®© ¨ ¢ ¤°³£¨µ ±¨²³ ¶¨¿µ.  · ±²­®±²¨, ­  ¥¥ ¡ §¥ ¬®¦­® ½´´¥ª²¨¢­® ®°£ ­¨§®¢ ²¼
®·¥°¥¤¼ ± ¯°¨®°¨²¥² ¬¨ (±¬. ° §¤. 7.5).  ±«¥¤³¾¹¨µ £« ¢ µ ­ ¬
¢±²°¥²¿²±¿  «£®°¨²¬», ¨±¯®«¼§³¾¹¨¥ ±µ®¤­»¥ ±²°³ª²³°» ¤ ­­»µ
(¡¨­®¬¨ «¼­»¥ ª³·¨, ´¨¡®­ ··¨¥¢» ª³·¨).
¥°¬¨­ Àª³· Á ¨­®£¤  ¨±¯®«¼§³¾² ¢ ¤°³£®¬ ±¬»±«¥ (®¡« ±²¼ ¯ ¬¿²¨, £¤¥ ¤ ­­»¥ ° §¬¥¹ ¾²±¿ ± ¯°¨¬¥­¥­¨¥¬  ¢²®¬ ²¨·¥±ª®©
À±¡®°ª¨ ¬³±®° Á | ­ ¯°¨¬¥°, ¢ ¿§»ª¥ Lisp), ­® ¬» ½²®£® ¤¥« ²¼
­¥ ¡³¤¥¬.

7.1. ³·¨
¢®¨·­®© ª³·¥© (binary heap) ­ §»¢ ¾² ¬ ±±¨¢ ± ®¯°¥¤¥«¥­­»¬¨
±¢®©±²¢ ¬¨ ³¯®°¿¤®·¥­­®±²¨, ²®¡» ±´®°¬³«¨°®¢ ²¼ ½²¨ ±¢®©±²¢ , ¡³¤¥¬ ° ±±¬ ²°¨¢ ²¼ ¬ ±±¨¢ ª ª ¤¢®¨·­®¥ ¤¥°¥¢® (°¨±. 7.1).
 ¦¤ ¿ ¢¥°¸¨­  ¤¥°¥¢  ±®®²¢¥²±²¢³¥² ½«¥¬¥­²³ ¬ ±±¨¢ . ±«¨
¢¥°¸¨­  ¨¬¥¥² ¨­¤¥ª± i, ²® ¥¥ °®¤¨²¥«¼ ¨¬¥¥² ¨­¤¥ª± bi=2c (¢¥°¸¨­  ± ¨­¤¥ª±®¬ 1 ¿¢«¿¥²±¿ ª®°­¥¬),   ¥¥ ¤¥²¨ | ¨­¤¥ª±» 2i ¨
2i + 1. ³¤¥¬ ±·¨² ²¼, ·²® ª³·  ¬®¦¥² ­¥ § ­¨¬ ²¼ ¢±¥£® ¬ ±±¨¢ 
¨ µ° ­¨²¼ ¬ ±±¨¢ A, ¥£® ¤«¨­³ length[A] ¨ ±¯¥¶¨ «¼­»© ¯ ° ¬¥²°
heap-size[A] (° §¬¥° ª³·¨), ¯°¨·¥¬ heap-size[A] 6 length[A]. ³· 
±®±²®¨² ¨§ ½«¥¬¥­²®¢ A[1]; : : :; A[heap-size[A]]. ¢¨¦¥­¨¥ ¯® ¤¥°¥¢³
®±³¹¥±²¢«¿¥²±¿ ¯°®¶¥¤³° ¬¨

³·¨

143

³·³ ¬®¦­® ° ±±¬ ²°¨¢ ²¼ ª ª ¤¥°¥¢® ( ) ¨«¨ ª ª ¬ ±±¨¢ (¡). ­³²°¨
¢¥°¸¨­» ¯®ª § ­® ¥¥ §­ ·¥­¨¥. ª®«® ¢¥°¸¨­» ¯®ª § ­ ¥¥ ¨­¤¥ª± ¢ ¬ ±±¨¢¥.
¨±. 7.1

Parent(i)

return bi=2c

Left(i)

return 2i

Right(i)

return 2i + 1
«¥¬¥­² A[1] ¿¢«¿¥²±¿ ª®°­¥¬ ¤¥°¥¢ .
 ¡®«¼¸¨­±²¢¥ ª®¬¯¼¾²¥°®¢ ¤«¿ ¢»¯®«­¥­¨¿ ¯°®¶¥¤³° Left ¨
Parent ¬®¦­® ¨±¯®«¼§®¢ ²¼ ª®¬ ­¤» «¥¢®£® ¨ ¯° ¢®£® ±¤¢¨£ 
(Left, Parent); Right ²°¥¡³¥² «¥¢®£® ±¤¢¨£ , ¯®±«¥ ª®²®°®£® ¢
¬« ¤¸¨© ° §°¿¤ ¯®¬¥¹ ¥²±¿ ¥¤¨­¨¶ .
«¥¬¥­²», µ° ­¿¹¨¥±¿ ¢ ª³·¥, ¤®«¦­» ®¡« ¤ ²¼ ®±­®¢­»¬ ±¢®©±²¢®¬ ª³·¨ (heap property): ¤«¿ ª ¦¤®© ¢¥°¸¨­» i, ª°®¬¥ ª®°­¿
(². ¥. ¯°¨ 2 6 i 6 heap-size[A]),

A[Parent(i)] > A[i]:

(7.1)

²±¾¤  ±«¥¤³¥², ·²® §­ ·¥­¨¥ ¯®²®¬ª  ­¥ ¯°¥¢®±µ®¤¨² §­ ·¥­¨¿
¯°¥¤ª .  ª¨¬ ®¡° §®¬, ­ ¨¡®«¼¸¨© ½«¥¬¥­² ¤¥°¥¢  (¨«¨ «¾¡®£®
¯®¤¤¥°¥¢ ) ­ µ®¤¨²±¿ ¢ ª®°­¥¢®© ¢¥°¸¨­¥ ¤¥°¥¢  (½²®£® ¯®¤¤¥°¥¢ ).
»±®²®© (height) ¢¥°¸¨­» ¤¥°¥¢  ­ §»¢ ¥²±¿ ¢»±®²  ¯®¤¤¥°¥¢  ± ª®°­¥¬ ¢ ½²®© ¢¥°¸¨­¥ (·¨±«® °¥¡¥° ¢ ± ¬®¬ ¤«¨­­®¬ ¯³²¨
± ­ · «®¬ ¢ ½²®© ¢¥°¸¨­¥ ¢­¨§ ¯® ¤¥°¥¢³ ª «¨±²³). »±®²  ¤¥°¥¢ , ² ª¨¬ ®¡° §®¬, ±®¢¯ ¤ ¥² ± ¢»±®²®© ¥£® ª®°­¿.  ¤¥°¥¢¥,
±®±² ¢«¿¾¹¥¬ ª³·³, ¢±¥ ³°®¢­¨ (ª°®¬¥, ¡»²¼ ¬®¦¥², ¯®±«¥¤­¥£®),
§ ¯®«­¥­» ¯®«­®±²¼¾. ®½²®¬³ ¢»±®²  ½²®£® ¤¥°¥¢  ° ¢­  (lg n),
£¤¥ n | ·¨±«® ½«¥¬¥­²®¢ ¢ ª³·¥ (±¬. ³¯°. 7.1-2).  ª ¬» ³¢¨¤¨¬
­¨¦¥, ¢°¥¬¿ ° ¡®²» ®±­®¢­»µ ®¯¥° ¶¨© ­ ¤ ª³·¥© ¯°®¯®°¶¨®­ «¼­® ¢»±®²¥ ¤¥°¥¢  ¨, ±«¥¤®¢ ²¥«¼­®, ±®±² ¢«¿¥² O(lg n). ±² ¢¸ ¿±¿

144

« ¢  7 ®°²¨°®¢ª  ± ¯®¬®¹¼¾ ª³·¨

· ±²¼ £« ¢» ¯®±¢¿¹¥­   ­ «¨§³ ½²¨µ ®¯¥° ¶¨© ¨ ¯°¨¬¥­¥­¨¾ ª³·¨
¢ § ¤ · µ ±®°²¨°®¢ª¨ ¨ ¬®¤¥«¨°®¢ ­¨¿ ®·¥°¥¤¨ ± ¯°¨®°¨²¥² ¬¨.
¥°¥·¨±«¨¬ ®±­®¢­»¥ ®¯¥° ¶¨¨ ­ ¤ ª³·¥©:
 °®¶¥¤³°  Heapify ¯®§¢®«¿¥² ¯®¤¤¥°¦¨¢ ²¼ ®±­®¢­®¥ ±¢®©±²¢® (7.1). °¥¬¿ ° ¡®²» ±®±² ¢«¿¥² O(lg n).
 °®¶¥¤³°  Build-Heap ±²°®¨² ª³·³ ¨§ ¨±µ®¤­®£® (­¥®²±®°²¨°®¢ ­­®£®) ¬ ±±¨¢ . °¥¬¿ ° ¡®²» O(n).
 °®¶¥¤³°  Heapsort ±®°²¨°³¥² ¬ ±±¨¢, ­¥ ¨±¯®«¼§³¿ ¤®¯®«­¨²¥«¼­®© ¯ ¬¿²¨. °¥¬¿ ° ¡®²» O(n lg n).
 °®¶¥¤³°» Extract-Max (¢§¿²¨¥ ­ ¨¡®«¼¸¥£®) ¨ Insert (¤®¡ ¢«¥­¨¥ ½«¥¬¥­² ) ¨±¯®«¼§³¾²±¿ ¯°¨ ¬®¤¥«¨°®¢ ­¨¨ ®·¥°¥¤¨
± ¯°¨®°¨²¥² ¬¨ ­  ¡ §¥ ª³·¨. °¥¬¿ ° ¡®²» ®¡¥¨µ ¯°®¶¥¤³°
±®±² ¢«¿¥² O(lg n).
¯° ¦­¥­¨¿
7.1-1 ³±²¼ ª³·  ¨¬¥¥² ¢»±®²³ h. ª®«¼ª® ½«¥¬¥­²®¢ ¬®¦¥² ¢
­¥© ¡»²¼? (ª ¦¨²¥ ¬ ª±¨¬ «¼­®¥ ¨ ¬¨­¨¬ «¼­®¥ §­ ·¥­¨¿.)
7.1-2 ®ª ¦¨²¥, ·²® ª³·  ¨§ n ½«¥¬¥­²®¢ ¨¬¥¥² ¢»±®²³ blg nc.
7.1-3 ®ª ¦¨²¥, ·²® ¯°¨ ¢»¯®«­¥­¨¨ ®±­®¢­®£® ±¢®©±²¢  ª³·¨
ª®°­¥¢ ¿ ¢¥°¸¨­  «¾¡®£® ¯®¤¤¥°¥¢  ¿¢«¿¥²±¿ ­ ¨¡®«¼¸¥© ¢ ½²®¬
¯®¤¤¥°¥¢¥.
7.1-4 ¤¥ ¬®¦¥² ­ µ®¤¨²¼±¿ ­ ¨¬¥­¼¸¨© ½«¥¬¥­² ª³·¨, ¥±«¨ ¢±¥
¥¥ ½«¥¬¥­²» ° §«¨·­»?
7.1-5 ³±²¼ ¬ ±±¨¢ ®²±®°²¨°®¢ ­ ¢ ®¡° ²­®¬ ¯®°¿¤ª¥ (¯¥°¢»©
½«¥¬¥­² | ­ ¨¡®«¼¸¨©). ¢«¿¥²±¿ «¨ ² ª®© ¬ ±±¨¢ ª³·¥©?
7.1-6

¢«¿¥²±¿ «¨ ª³·¥© ¬ ±±¨¢ h23; 17; 14; 6; 13; 10; 1; 5; 7; 12i?

7.2. ®µ° ­¥­¨¥ ®±­®¢­®£® ±¢®©±²¢  ª³·¨
°®¶¥¤³°  Heapify | ¢ ¦­®¥ ±°¥¤±²¢® ° ¡®²» ± ª³·¥©. ¥ ¯ ° ¬¥²° ¬¨ ¿¢«¿¾²±¿ ¬ ±±¨¢ A ¨ ¨­¤¥ª± i. °¥¤¯®« £ ¥²±¿, ·²® ¯®¤¤¥°¥¢¼¿ ± ª®°­¿¬¨ Left(i) ¨ Right(i) ³¦¥ ®¡« ¤ ¾² ®±­®¢­»¬ ±¢®©±²¢®¬. °®¶¥¤³°  ¯¥°¥±² ¢«¿¥² ½«¥¬¥­²» ¯®¤¤¥°¥¢  ± ¢¥°¸¨­®© i,
¯®±«¥ ·¥£® ®­® ®¡« ¤ ¥² ®±­®¢­»¬ ±¢®©±²¢®¬. ¤¥¿ ¯°®±² : ¥±«¨
½²® ±¢®©±²¢® ­¥ ¢»¯®«­¥­® ¤«¿ ¢¥°¸¨­» i, ²® ¥¥ ±«¥¤³¥² ¯®¬¥­¿²¼
± ¡®«¼¸¨¬ ¨§ ¥¥ ¤¥²¥© ¨ ². ¤., ¯®ª  ½«¥¬¥­² A[i] ­¥ À¯®¤£°³§¨²±¿Á
¤® ­³¦­®£® ¬¥±² .

®µ° ­¥­¨¥ ®±­®¢­®£® ±¢®©±²¢  ª³·¨

145

 ¡®²  ¯°®¶¥¤³°» Heapify(A; 2) ¯°¨ heap-size[A] = 10. ( )  · «¼­®¥ ±®±²®¿­¨¥ ª³·¨.  ¢¥°¸¨­¥ i = 2 ®±­®¢­®¥ ±¢®©±²¢® ­ °³¸¥­®. ²®¡»
¢®±±² ­®¢¨²¼ ¥£®, ­¥®¡µ®¤¨¬® ¯®¬¥­¿²¼ A[2] ¨ A[4]. ®±«¥ ½²®£® (¡) ®±­®¢­®¥
±¢®©±²¢® ­ °³¸ ¥²±¿ ¢ ¢¥°¸¨­¥ ± ¨­¤¥ª±®¬ 4. ¥ª³°±¨¢­»© ¢»§®¢ ¯°®¶¥¤³°» Heapify(A; 4) ¢®±±² ­ ¢«¨¢ ¥² ®±­®¢­®¥ ±¢®©±²¢® ¢ ¢¥°¸¨­¥ ± ¨­¤¥ª±®¬ 4
¯³²¥¬ ¯¥°¥±² ­®¢ª¨ A[4] $ A[9] (¢). ®±«¥ ½²®£® ®±­®¢­®¥ ±¢®©±²¢® ¢»¯®«­¥­®
¤«¿ ¢±¥µ ¢¥°¸¨­, ² ª ·²® ¯°®¶¥¤³°  Heapify(A; 9) ³¦¥ ­¨·¥£® ­¥ ¤¥« ¥².
¨±. 7.2

Heapify(A; i)
1 l Left(i)
2 r Right(i)

3 if l 6 heap-size[A] ¨ A[l] > A[i]
4
then largest l
5
else largest i
6 if r 6 heap-size[A] ¨ A[r] > A[largest]
7
then largest r
8 if largest 6= i
9
then ®¡¬¥­¿²¼ A[i] $ A[largest]
10
Heapify(A; largest)
 ¡®²  ¯°®¶¥¤³°» Heapify ¯®ª § ­  ­  °¨±. 7.2.  ±²°®ª µ 3{7
¢ ¯¥°¥¬¥­­³¾ largest ¯®¬¥¹ ¥²±¿ ¨­¤¥ª± ­ ¨¡®«¼¸¥£® ¨§ ½«¥¬¥­²®¢
A[i], A[Left(i)] ¨ A[Right(i)]. ±«¨ largest = i, ²® ½«¥¬¥­² A[i] ³¦¥
À¯®£°³§¨«±¿Á ¤® ­³¦­®£® ¬¥±² , ¨ ° ¡®²  ¯°®¶¥¤³°» § ª®­·¥­ .
­ ·¥ ¯°®¶¥¤³°  ¬¥­¿¥² ¬¥±² ¬¨ A[i] ¨ A[largest] (·²® ®¡¥±¯¥·¨¢ ¥² ¢»¯®«­¥­¨¥ ±¢®©±²¢  (7.1) ¢ ¢¥°¸¨­¥ i, ­® ¢®§¬®¦­®, ­ °³¸ ¥²

146

« ¢  7 ®°²¨°®¢ª  ± ¯®¬®¹¼¾ ª³·¨

½²® ±¢®©±²¢® ¢ ¢¥°¸¨­¥ largest ) ¨ °¥ª³°±¨¢­® ¢»§»¢ ¥² ±¥¡¿ ¤«¿
¢¥°¸¨­» largest, ·²®¡» ¨±¯° ¢¨²¼ ¢®§¬®¦­»¥ ­ °³¸¥­¨¿.
¶¥­¨¬ ¢°¥¬¿ ° ¡®²» ¯°®¶¥¤³°» Heapify.   ª ¦¤®¬ ¸ £¥ ²°¥¡³¥²±¿ ¯°®¨§¢¥±²¨ (1) ¤¥©±²¢¨©, ­¥ ±·¨² ¿ °¥ª³°±¨¢­®£® ¢»§®¢ .
³±²¼ T (n) | ¢°¥¬¿ ° ¡®²» ¤«¿ ¯®¤¤¥°¥¢ , ±®¤¥°¦ ¹¥£® n ½«¥¬¥­²®¢. ±«¨ ¯®¤¤¥°¥¢® ± ª®°­¥¬ i ±®±²®¨² ¨§ n ½«¥¬¥­²®¢, ²® ¯®¤¤¥°¥¢¼¿ ± ª®°­¿¬¨ Left(i) ¨ Right(i) ±®¤¥°¦ ² ­¥ ¡®«¥¥ ·¥¬ ¯® 2n=3
½«¥¬¥­²®¢ ª ¦¤®¥ (­ ¨µ³¤¸¨© ±«³· © | ª®£¤  ¯®±«¥¤­¨© ³°®¢¥­¼
¢ ¯®¤¤¥°¥¢¥ § ¯®«­¥­ ­ ¯®«®¢¨­³).  ª¨¬ ®¡° §®¬,
T (n) 6 T (2n=3) + (1)
§ ²¥®°¥¬» 4.1 (±«³· © 2) ¯®«³· ¥¬, ·²® T (n) = O(lg n). ²³ ¦¥
®¶¥­ª³ ¬®¦­® ¯®«³·¨²¼ ² ª: ­  ª ¦¤®¬ ¸ £¥ ¬» ±¯³±ª ¥¬±¿ ¯®
¤¥°¥¢³ ­  ®¤¨­ ³°®¢¥­¼,   ¢»±®²  ¤¥°¥¢  ¥±²¼ O(lg n).
¯° ¦­¥­¨¿
7.2-1

®ª ¦¨²¥, ±«¥¤³¿ ®¡° §¶³ °¨±. 7.2, ª ª ° ¡®² ¥² ¯°®¶¥¤³° 
Heapify(A; 3) ¤«¿ ¬ ±±¨¢  h27; 17; 3; 16; 13; 10; 1; 5; 7; 12; 4; 8; 9; 0i.
7.2-2 ³±²¼ ½«¥¬¥­² A[i] ¡®«¼¸¥, ·¥¬ ¥£® ¤¥²¨.  ª®¢ ¡³¤¥² °¥§³«¼² ² ¢»§®¢  ¯°®¶¥¤³°» Heapify(A; i)?
7.2-3 ³±²¼ i > heap-size[A]=2.  ª®¢ ¡³¤¥² °¥§³«¼² ² ¢»§®¢ 
¯°®¶¥¤³°» Heapify(A; i)?
7.2-4 §¬¥­¨²¥ ¯°®¶¥¤³°³ Heapify, § ¬¥­¨¢ °¥ª³°±¨¾ ¶¨ª«®¬.
(¥ª®²®°»¥ ª®¬¯¨«¿²®°» ¯°¨ ½²®¬ ¯®°®¦¤ ¾² ¡®«¥¥ ½´´¥ª²¨¢­»© ª®¤.)
7.2-5

®ª ¦¨²¥, ·²® ­ ¨¡®«¼¸¥¥ ¢°¥¬¿ ° ¡®²» ¯°®¶¥¤³°»
Heapify ¤«¿ ª³·¨ ¨§ n ½«¥¬¥­²®¢ ° ¢­® 
(lg n). (ª § ­¨¥: ¯°¨¢¥¤¨²¥ ¯°¨¬¥°, ª®£¤  ¯°®¶¥¤³°  ¢»§»¢ ¥²±¿ ¤«¿ ª ¦¤®© ¢¥°¸¨­»
­  ¯³²¨ ®² ª®°­¿ ª «¨±²³).

7.3. ®±²°®¥­¨¥ ª³·¨
³±²¼ ¤ ­ ¬ ±±¨¢ A[1 : :n], ª®²®°»© ¬» µ®²¨¬ ¯°¥¢° ²¨²¼ ¢ ª³·³, ¯¥°¥±² ¢¨¢ ¥£® ½«¥¬¥­²». «¿ ½²®£® ¬®¦­® ¨±¯®«¼§®¢ ²¼ ¯°®¶¥¤³°³ Heapify, ¯°¨¬¥­¿¿ ¥¥ ¯® ®·¥°¥¤¨ ª® ¢±¥¬ ¢¥°¸¨­ ¬, ­ ·¨­ ¿ ± ­¨¦­¨µ. ®±ª®«¼ª³ ¢¥°¸¨­» ± ­®¬¥° ¬¨ bn=2c + 1; : : :; n
¿¢«¿¾²±¿ «¨±²¼¿¬¨, ¯®¤¤¥°¥¢¼¿ ± ½²¨¬¨ ¢¥°¸¨­ ¬¨ ³¤®¢«¥²¢®°¿¾²
®±­®¢­®¬³ ±¢®©±²¢³. «¿ ª ¦¤®© ¨§ ®±² ¢¸¨µ±¿ ¢¥°¸¨­, ¢ ¯®°¿¤ª¥
³¡»¢ ­¨¿ ¨­¤¥ª±®¢, ¬» ¯°¨¬¥­¿¥¬ ¯°®¶¥¤³°³ Heapify. ®°¿¤®ª
®¡° ¡®²ª¨ ¢¥°¸¨­ £ ° ­²¨°³¥², ·²® ª ¦¤»© ° § ³±«®¢¨¿ ¢»§®¢ 

®±²°®¥­¨¥ ª³·¨

147

¯°®¶¥¤³°» (¢»¯®«­¥­¨¥ ®±­®¢­®£® ±¢®©±²¢  ¤«¿ ¯®¤¤¥°¥¢¼¥¢) ¡³¤³² ¢»¯®«­¥­».
Build-Heap (A)
1 heap-size[A] length[A]
2 for i blength[A]=2c downto 1
3
do Heapify(A; i)
°¨¬¥° ° ¡®²» ¯°®¶¥¤³°» Build-Heap ¯®ª § ­ ­  °¨±. 7.3.
±­®, ·²® ¢°¥¬¿ ° ¡®²» ¯°®¶¥¤³°» Build-Heap ­¥ ¯°¥¢»¸ ¥² O(n lg n). ¥©±²¢¨²¥«¼­®, ¯°®¶¥¤³°  Heapify ¢»§»¢ ¥²±¿ O(n)
° §,   ª ¦¤®¥ ¥¥ ¢»¯®«­¥­¨¥ ²°¥¡³¥² ¢°¥¬¥­¨ O(lg n). ¤­ ª® ½²³
®¶¥­ª³ ¬®¦­® ³«³·¸¨²¼, ·¥¬ ¬» ±¥©· ± ¨ § ©¬¥¬±¿.
¥«® ¢ ²®¬, ·²® ¢°¥¬¿ ° ¡®²» ¯°®¶¥¤³°» Heapify § ¢¨±¨² ®²
¢»±®²» ¢¥°¸¨­», ¤«¿ ª®²®°®© ®­  ¢»§»¢ ¥²±¿ (¨ ¯°®¯®°¶¨®­ «¼­®
½²®© ¢»±®²¥). ®±ª®«¼ª³ ·¨±«® ¢¥°¸¨­ ¢»±®²» h ¢ ª³·¥ ¨§ n ½«¥¬¥­²®¢ ­¥ ¯°¥¢»¸ ¥² dn=2h+1 e (±¬. ³¯°. 7.3-3),   ¢»±®²  ¢±¥ ª³·¨
­¥ ¯°¥¢»¸ ¥² blg nc (³¯°. 7.1-2), ¢°¥¬¿ ° ¡®²» ¯°®¶¥¤³°» BuildHeap ­¥ ¯°¥¢»¸ ¥²
bX
lg nc l
h=0

n

m

2h+1

0

O(h) = O @n

bX
lg nc
h=0

1

hA

2h

(7.2)

®« £ ¿ x = 1=2 ¢ ´®°¬³«¥ (3.6), ¯®«³· ¥¬ ¢¥°µ­¾¾ ®¶¥­ª³ ¤«¿
±³¬¬» ¢ ¯° ¢®© · ±²¨:
1
X

h = 1=2 = 2:
h (1 ; 1=2)2
2
h=0
 ª¨¬ ®¡° §®¬, ¢°¥¬¿ ° ¡®²» ¯°®¶¥¤³°» Build-Heap ±®±² ¢«¿¥²

O n

1
X
h=0

!

h = O(n):
2h

¯° ¦­¥­¨¿
7.3-1

®ª ¦¨²¥, ±«¥¤³¿ ®¡° §¶³ °¨±. 7.3, ª ª ° ¡®² ¥² ¯°®¶¥¤³° 

Build-Heap ¤«¿ ¬ ±±¨¢  A = h5; 3; 17; 10; 84; 19; 6; 22; 9i.

7.3-2 ®·¥¬³ ¢ ¯°®¶¥¤³°¥ Build-Heap ±³¹¥±²¢¥­­®, ·²® ¯ ° ¬¥²° i ¯°®¡¥£ ¥² §­ ·¥­¨¿ ®² blength[A]=2c ¤® 1 (  ­¥ ­ ®¡®°®²)?
7.3-3 ®ª ¦¨²¥, ·²® ª³·  ¨§ n ½«¥¬¥­²®¢ ±®¤¥°¦¨² ­¥ ¡®«¥¥
dn=2h+1e ¢¥°¸¨­ ¢»±®²» h.

148

« ¢  7 ®°²¨°®¢ª  ± ¯®¬®¹¼¾ ª³·¨

 ¡®²  ¯°®¶¥¤³°» Build-Heap. ®ª § ­® ±®±²®¿­¨¥ ¤ ­­»µ ¯¥°¥¤
ª ¦¤»¬ ¢»§®¢®¬ ¯°®¶¥¤³°» Heapify ¢ ±²°®ª¥ 3.
¨±. 7.3

«£®°¨²¬ ±®°²¨°®¢ª¨ ± ¯®¬®¹¼¾ ª³·¨

149

7.4. «£®°¨²¬ ±®°²¨°®¢ª¨ ± ¯®¬®¹¼¾ ª³·¨
«£®°¨²¬ ±®°²¨°®¢ª¨ ± ¯®¬®¹¼¾ ª³·¨ ±®±²®¨² ¨§ ¤¢³µ · ±²¥©.
­ · «  ¢»§»¢ ¥²±¿ ¯°®¶¥¤³°  Build-Heap, ¯®±«¥ ¢»¯®«­¥­¨¿ ª®²®°®© ¬ ±±¨¢ ¿¢«¿¥²±¿ ª³·¥©. ¤¥¿ ¢²®°®© · ±²¨ ¯°®±² : ¬ ª±¨¬ «¼­»© ½«¥¬¥­² ¬ ±±¨¢  ²¥¯¥°¼ ­ µ®¤¨²±¿ ¢ ª®°­¥ ¤¥°¥¢  (A[1]).
£® ±«¥¤³¥² ¯®¬¥­¿²¼ c A[n], ³¬¥­¼¸¨²¼ ° §¬¥° ª³·¨ ­  1 ¨ ¢®±±² ­®¢¨²¼ ®±­®¢­®¥ ±¢®©±²¢® ¢ ª®°­¥¢®© ¢¥°¸¨­¥ (¯®±ª®«¼ª³ ¯®¤¤¥°¥¢¼¿ ± ª®°­¿¬¨ Left(1) ¨ Right(1) ­¥ ³²° ²¨«¨ ®±­®¢­®£® ±¢®©±²¢ 
ª³·¨, ½²® ¬®¦­® ±¤¥« ²¼ ± ¯®¬®¹¼¾ ¯°®¶¥¤³°» Heapify). ®±«¥
½²®£® ¢ ª®°­¥ ¡³¤¥² ­ µ®¤¨²¼±¿ ¬ ª±¨¬ «¼­»© ¨§ ®±² ¢¸¨µ±¿ ½«¥¬¥­²®¢.  ª ¤¥« ¥²±¿ ¤® ²¥µ ¯®°, ¯®ª  ¢ ª³·¥ ­¥ ®±² ­¥²±¿ ¢±¥£®
®¤¨­ ½«¥¬¥­².
Heapsort(A)
1 Build-Heap(A)
2 for i length[A] downto 2
3
do ¯®¬¥­¿²¼ A[1] $ A[i]
4
heap-size[A] heap-size[A] ; 1
5
Heapify(A; 1)
 ¡®²  ¢²®°®© · ±²¨  «£®°¨²¬  ¯®ª § ­  ­  °¨±. 7.4. §®¡° ¦¥­»
±®±²®¿­¨¿ ª³·¨ ¯¥°¥¤ ª ¦¤»¬ ¢»¯®«­¥­¨¥¬ ¶¨ª«  for (±²°®ª  2).
°¥¬¿ ° ¡®²» ¯°®¶¥¤³°» Heapsort ±®±² ¢«¿¥² O(n lg n). ¥©±²¢¨²¥«¼­®, ¯¥°¢ ¿ · ±²¼ (¯®±²°®¥­¨¥ ª³·¨) ²°¥¡³¥² ¢°¥¬¥­¨ O(n),
  ª ¦¤®¥ ¨§ n ; 1 ¢»¯®«­¥­¨© ¶¨ª«  for § ­¨¬ ¥² ¢°¥¬¿ O(lg n).
¯° ¦­¥­¨¿
7.4-1

®ª ¦¨²¥, ±«¥¤³¿ ®¡° §¶³ °¨±. 7.4, ª ª ° ¡®² ¥² ¯°®¶¥¤³° 
Heapsort ¤«¿ ¬ ±±¨¢  A = h5; 13; 2; 25; 7; 17; 20; 8; 4i.
7.4-2 ³±²¼ ¨±µ®¤­»© ¬ ±±¨¢ A ³¦¥ ®²±®°²¨°®¢ ­ ¢ ¯®°¿¤ª¥ ¢®§° ±² ­¨¿.  ª®¢® ¡³¤¥² ¢°¥¬¿ ±®°²¨°®¢ª¨ ± ¯®¬®¹¼¾ ª³·¨?  ¥±«¨
¬ ±±¨¢ ¡»« ®²±®°²¨°®¢ ­ ¢ ¯®°¿¤ª¥ ³¡»¢ ­¨¿?
7.4-3 ®ª ¦¨²¥, ·²® ¢°¥¬¿ ° ¡®²» ¯°®¶¥¤³°» Heapsort ±®±² ¢«¿¥² 
(n lg n).

7.5. ·¥°¥¤¨ ± ¯°¨®°¨²¥² ¬¨
  ¯° ª²¨ª¥  «£®°¨²¬ ±®°²¨°®¢ª¨ ± ¯®¬®¹¼¾ ª³·¨ ­¥ ¿¢«¿¥²±¿
± ¬»¬ ¡»±²°»¬ | ª ª ¯° ¢¨«®, ¡»±²° ¿ ±®°²¨°®¢ª  (£«. 8) ° ¡®² ¥² ¡»±²°¥¥. ¤­ ª® ± ¬  ª³·  ª ª ±²°³ª²³°  ¤ ­­»µ · ±²® ®ª -

150

« ¢  7 ®°²¨°®¢ª  ± ¯®¬®¹¼¾ ª³·¨

 ¡®²  ¯°®¶¥¤³°» Heapsort. ®ª § ­® ±®±²®¿­¨¥ ¬ ±±¨¢  ¯¥°¥¤ ª ¦¤»¬ ¢»§®¢®¬ ¯°®¶¥¤³°» Heapify.  ·¥°­¥­­»¥ ½«¥¬¥­²» ³¦¥ ­¥ ¢µ®¤¿² ¢
ª³·³.
¨±. 7.4

§»¢ ¥²±¿ ¯®«¥§­®©.  ½²®¬ ° §¤¥«¥ ¬» ° ±±¬®²°¨¬ ¬®¤¥«¨°®¢ ­¨¥
®·¥°¥¤¨ ± ¯°¨®°¨²¥² ¬¨ ­  ¡ §¥ ª³·¨ | ®¤¨­ ¨§ ± ¬»µ ¨§¢¥±²­»µ
¯°¨¬¥°®¢ ¨±¯®«¼§®¢ ­¨¿ ª³·¨.
·¥°¥¤¼ ± ¯°¨®°¨²¥² ¬¨ (priority queue) | ½²® ¬­®¦¥±²¢® S ,
½«¥¬¥­²» ª®²®°®£® ¬» ¡³¤¥¬ ±·¨² ²¼ ·¨±« ¬¨.   ¯° ª²¨ª¥ ½«¥¬¥­² ¬¨ ¬­®¦¥±²¢  S ¿¢«¿¾²±¿ ¯ °» hkey; i, £¤¥ key | ·¨±«®,
®¯°¥¤¥«¿¾¹¥¥ ¯°¨®°¨²¥² ½«¥¬¥­²  ¨ ­ §»¢ ¥¬®¥ ª«¾·®¬ (key).  
 | ±¢¿§ ­­ ¿ ± ­¨¬ ¨­´®°¬ ¶¨¿; ½²  ¨­´®°¬ ¶¨¿ µ° ­¨²±¿ °¿¤®¬ ± ½«¥¬¥­²®¬ ¨ ¯¥°¥¬¥¹ ¥²±¿ ¢¬¥±²¥ ± ­¨¬, ­¥ ¢«¨¿¿ ­  ¥£®
®¡° ¡®²ª³.
®§¬®¦­» ±«¥¤³¾¹¨¥ ®¯¥° ¶¨¨ ­ ¤ ®·¥°¥¤¼¾ ± ¯°¨®°¨²¥² ¬¨:
Insert(S; x): ¤®¡ ¢«¥­¨¥ ½«¥¬¥­²  x ª ¬­®¦¥±²¢³ S ;

·¥°¥¤¨ ± ¯°¨®°¨²¥² ¬¨

151

Maximum(S ): ­ ¨¡®«¼¸¨© ½«¥¬¥­² ¬­®¦¥±²¢ ;
Extract-Max(S ): ¨§º¿²¨¥ ¨§ ¬­®¦¥±²¢  ­ ¨¡®«¼¸¥£® ½«¥¬¥­² .

·¥°¥¤¼ ± ¯°¨®°¨²¥² ¬¨ ¬®¦¥², ­ ¯°¨¬¥°, ¨±¯®«¼§®¢ ²¼±¿ ¢ ®¯¥° ¶¨®­­®© ±¨±²¥¬¥ ± ° §¤¥«¥­¨¥¬ ¢°¥¬¥­¨. °¨ ½²®¬ µ° ­¨²±¿ ±¯¨±®ª § ¤ ­¨© ± ¯°¨®°¨²¥² ¬¨; ª ª ²®«¼ª® ¢»¯®«­¥­¨¥ ®·¥°¥¤­®£®
§ ¤ ­¨¿ § ª ­·¨¢ ¥²±¿, ¨§ ®·¥°¥¤¨ ¢»¡¨° ¥²±¿ § ¤ ­¨¥ ± ­ ¨¡®«¼¸¨¬ ¯°¨®°¨²¥²®¬ (®¯¥° ¶¨¿ Extract-Max). ®¢»¥ § ¤ ­¨¿ ¤®¡ ¢«¿¾²±¿ ¢ ®·¥°¥¤¼ ± ¯®¬®¹¼¾ ®¯¥° ¶¨¨ Insert.
°³£®¥ ¯°¨¬¥­¥­¨¥ ²®© ¦¥ ±²°³ª²³°» | ³¯° ¢«¿¥¬®¥ ±®¡»²¨¿¬¨ ¬®¤¥«¨°®¢ ­¨¥ (event-driven simulation).  ®·¥°¥¤¨ ­ µ®¤¿²±¿
±®¡»²¨¿,   ¯°¨®°¨²¥² ®¯°¥¤¥«¿¥²±¿ ¢°¥¬¥­¥¬, ª®£¤  ±®¡»²¨¥ ¤®«¦­® ¯°®¨§®©²¨.  §³¬¥¥²±¿, ±®¡»²¨¿ ¤®«¦­» ¬®¤¥«¨°®¢ ²¼±¿ ¢ ²®¬
¯®°¿¤ª¥, ¢ ª®²®°®¬ ®­¨ ¯°®¨±µ®¤¿². »¡®° ®·¥°¥¤­®£® ±®¡»²¨¿
¯°®¨§¢®¤¨²±¿ ± ¯®¬®¹¼¾ ®¯¥° ¶¨¨ Extract-Min (¯®°¿¤®ª §¤¥±¼
®¡° ²­»©), ¤®¡ ¢«¥­¨¥ ±®¡»²¨© | ± ¯®¬®¹¼¾ ®¯¥° ¶¨¨ Insert.
¯¨¸¥¬ ²¥¯¥°¼ °¥ «¨§ ¶¨¾ ®·¥°¥¤¨ ± ¯°¨®°¨²¥² ¬¨. ³¤¥¬ µ° ­¨²¼ ½«¥¬¥­²» ¬­®¦¥±²¢  ¢ ¢¨¤¥ ª³·¨. °¨ ½²®¬ ¬ ª±¨¬ «¼­»©
½«¥¬¥­² ­ µ®¤¨²±¿ ¢ ª®°­¥, ² ª ·²® ®¯¥° ¶¨¿ Maximum ²°¥¡³¥²
¢°¥¬¥­¨ (1). ²®¡» ¨§º¿²¼ ¬ ª±¨¬ «¼­»© ½«¥¬¥­² ¨§ ®·¥°¥¤¨,
­³¦­® ¤¥©±²¢®¢ ²¼ ² ª ¦¥, ª ª ¨ ¯°¨ ±®°²¨°®¢ª¥:
Heap-Extract-Max(A)
1 if heap-size[A] < 1
2 then ®¸¨¡ª : À®·¥°¥¤¼ ¯³±² Á
3 max A[1]
4 A[1] A[heap-size[A]]
5 heap-size[A] heap-size[A] ; 1
6 Heapify(A; 1)
7 return max
°¥¬¿ ° ¡®²» ±®±² ¢«¿¥² O(lg n) (¯°®¶¥¤³°  Heapify ¢»§»¢ ¥²±¿
®¤¨­ ° §).
²®¡» ¤®¡ ¢¨²¼ ½«¥¬¥­² ª ®·¥°¥¤¨, ¥£® ±«¥¤³¥² ¤®¡ ¢¨²¼ ¢ ª®­¥¶
ª³·¨ (ª ª «¨±²),   § ²¥¬ ¤ ²¼ ¥¬³ À¢±¯«»²¼Á ¤® ­³¦­®£® ¬¥±² :
Heap-Insert (A; key)
1 heap-size[A] heap-size[A] + 1
2 i heap-size[A]
3 while i > 1 ¨ A[Parent(i)] < key
4
do A[i] A[Parent(i)]
5
i Parent(i)
6 A[i] key
°¨¬¥° ° ¡®²» ¯°®¶¥¤³°» Heap-Insert ¯®ª § ­ ­  °¨±. 7.5.
°¥¬¿ ° ¡®²» ±®±² ¢«¿¥² O(lg n), ¯®±ª®«¼ª³ À¯®¤º¥¬Á ­®¢®£® «¨±²  § ­¨¬ ¥² ­¥ ¡®«¥¥ lg n ¸ £®¢ (¨­¤¥ª± i ¯®±«¥ ª ¦¤®© ¨²¥° ¶¨¨

152

« ¢  7 ®°²¨°®¢ª  ± ¯®¬®¹¼¾ ª³·¨

¨±. 7.5  ¡®²  ¯°®¶¥¤³°» Heap-Insert. ®¡ ¢«¿¥²±¿ ½«¥¬¥­² ± ª«¾·¥¢»¬
§­ ·¥­¨¥¬ 15 (²¥¬­»© ª°³¦®ª ®§­ · ¥² ¬¥±²® ¤«¿ ½²®£® ½«¥¬¥­² ).

¶¨ª«  while ³¬¥­¼¸ ¥²±¿ ¯® ª° ©­¥© ¬¥°¥ ¢¤¢®¥).
² ª, ¢±¥ ®¯¥° ¶¨¨ ­ ¤ ®·¥°¥¤¼¾ ± ¯°¨®°¨²¥² ¬¨ ¨§ n ½«¥¬¥­²®¢
²°¥¡³¾² ¢°¥¬¥­¨ O(lg n).
¯° ¦­¥­¨¿
7.5-1

®ª ¦¨²¥, ±«¥¤³¿ ®¡° §¶³ °¨±. 7.5, ª ª ° ¡®² ¥² ¯°®¶¥¤³° 
Heap-Insert(A; 3) ¤«¿ ª³·¨ A = h15; 13; 9; 5; 12; 8; 7; 4; 0; 6; 2; 1i.
7.5-2 ®ª ¦¨²¥ ­  °¨±³­ª µ, ª ª ° ¡®² ¥² ¯°®¶¥¤³°  HeapExtract-Max ¤«¿ ª³·¨ ¨§ ¯°¥¤»¤³¹¥£® ³¯° ¦­¥­¨¿.
7.5-3 ¡º¿±­¨²¥, ª ª °¥ «¨§®¢ ²¼ ®¡»·­³¾ ®·¥°¥¤¼ (rst-in,
rst-out) ¨ ±²¥ª ­  ¡ §¥ ®·¥°¥¤¨ ± ¯°¨®°¨²¥² ¬¨. (¯°¥¤¥«¥­¨¿ ±¬.
¢ ° §¤. 11.1).
7.5-4 ¥ «¨§³©²¥ ¯°®¶¥¤³°³ Heap-Increase-Key (A; i; k) (³¢¥«¨·¥­¨¥ ½«¥¬¥­² ), ª®²®° ¿ ³¢¥«¨·¨¢ ¥² ½«¥¬¥­² A[i] ¤® k, ¥±«¨ ®­
¡»« ¬¥­¼¸¥ k (A[i] max(A[i]; k)) ¨ ¢®±±² ­ ¢«¨¢ ¥² ®±­®¢­®¥
±¢®©±²¢® ª³·¨. °¥¬¿ ° ¡®²» | O(lg n).
7.5-5 ¥ «¨§³©²¥ ®¯¥° ¶¨¾ Heap-Delete (A; i) | ³¤ «¥­¨¥ ½«¥¬¥­²  ± ¨­¤¥ª±®¬ i ¨§ ª³·¨. °¥¬¿ ° ¡®²» O(lg n).

 ¤ ·¨ ª £« ¢¥ 7

153

7.5-6 °¨¤³¬ ©²¥  «£®°¨²¬, ª®²®°»© ¯®§¢®«¿¥² §  ¢°¥¬¿
O(n lg k) ±«¨²¼ k ®²±®°²¨°®¢ ­­»µ ±¯¨±ª®¢ ¢ ®¤¨­ ®²±®°²¨°®¢ ­­»© ±¯¨±®ª (§¤¥±¼ n | ®¡¹¥¥ ·¨±«® ½«¥¬¥­²®¢ ¢ ±¯¨±ª µ).
(ª § ­¨¥: ¨±¯®«¼§³©²¥ ª³·³.)

 ¤ ·¨
7-1 ®±²°®¥­¨¥ ª³·¨ ± ¯®¬®¹¼¾ ¢±² ¢®ª
®¦­® ¯®±²°®¨²¼ ª³·³, ¯®±«¥¤®¢ ²¥«¼­® ¤®¡ ¢«¿¿ ½«¥¬¥­²» ±
¯®¬®¹¼¾ ¯°®¶¥¤³°» Heap-Insert.  ±±¬®²°¨¬ ±«¥¤³¾¹¨©  «£®°¨²¬:
Build-Heap0 (A)
1 heap-size[A] 1
2 for i 2 to length[A]
3
do Heap-Insert (A; A[i])
 .  ¯³±²¨¬ ¯°®¶¥¤³°» Build-Heap ¨ Build-Heap0 ¤«¿ ®¤­®£® ¨ ²®£® ¦¥ ¬ ±±¨¢ . ±¥£¤  «¨ ®­¨ ±®§¤ ¤³² ®¤¨­ ª®¢»¥ ª³·¨?
(®ª ¦¨²¥ ¨«¨ ¯°¨¢¥¤¨²¥ ª®­²°¯°¨¬¥°.)
¡. ®ª ¦¨²¥, ·²® ¢°¥¬¿ ° ¡®²» ¯°®¶¥¤³°» Build-Heap0 ¢ µ³¤¸¥¬ ±«³· ¥ ±®±² ¢«¿¥² (n lg n) (£¤¥ n | ª®«¨·¥±²¢® ½«¥¬¥­²®¢).
7-2  ¡®²  ± d-¨·­»¬¨ ª³· ¬¨
 ±±¬®²°¨¬ d-¨·­³¾ ª³·³ (d-ary heap), ¢ ª®²®°®© ¢¥°¸¨­» ¨¬¥¾² d ¤¥²¥© ¢¬¥±²® ¤¢³µ.
 .  ª ¢»£«¿¤¿² ¤«¿ ² ª®© ª³·¨ ¯°®¶¥¤³°»,  ­ «®£¨·­»¥ Parent, Left ¨ Right?
¡.  ª ¢»±®²  d-¨·­®© ª³·¨ ¨§ n ½«¥¬¥­²®¢ ¢»° ¦ ¥²±¿ ·¥°¥§ n
¨ d?
¢. ¥ «¨§³©²¥ ¯°®¶¥¤³°³ Extract-Max.  ª®¢® ¢°¥¬¿ ¥¥ ° ¡®²» (¢»° §¨²¥ ¥£® ·¥°¥§ n ¨ d)?
£. ¥ «¨§³©²¥ ¯°®¶¥¤³°³ Insert.  ª®¢® ¢°¥¬¿ ¥¥ ° ¡®²»?
¤. ¥ «¨§³©²¥ ¯°®¶¥¤³°³ Heap-Increase-Key (³¯°. 7.5-4).  ª®¢® ¢°¥¬¿ ¥¥ ° ¡®²»?

 ¬¥· ­¨¿
«£®°¨²¬ ±®°²¨°®¢ª¨ ± ¯®¬®¹¼¾ ª³·¨ ¯°¥¤«®¦¨« ¨«¼¿¬± [202];
² ¬ ¦¥ ®¯¨± ­  °¥ «¨§ ¶¨¿ ®·¥°¥¤¨ ± ¯°¨®°¨²¥² ¬¨ ­  ¡ §¥ ª³·¨.
°®¶¥¤³°  Build-Heap ¯°¥¤«®¦¥­  «®©¤®¬ [69].

8

»±²° ¿ ±®°²¨°®¢ª 

 ½²®© £« ¢¥ ° ±±¬®²°¥­ ² ª ­ §»¢ ¥¬»©  «£®°¨²¬ À¡»±²°®© ±®°²¨°®¢ª¨Á. ®²¿ ¢°¥¬¿ ¥£® ° ¡®²» ¤«¿ ¬ ±±¨¢  ¨§ n ·¨±¥« ¢ µ³¤¸¥¬ ±«³· ¥ ±®±² ¢«¿¥² (n2 ), ­  ¯° ª²¨ª¥ ½²®²  «£®°¨²¬ ¿¢«¿¥²±¿
®¤­¨¬ ¨§ ± ¬»µ ¡»±²°»µ: ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ¢°¥¬¥­¨ ° ¡®²» ±®±² ¢«¿¥² (n lg n), ¯°¨·¥¬ ¬­®¦¨²¥«¼ ¯°¨ n lg n ¤®¢®«¼­®
¬ «. °®¬¥ ²®£®, ¡»±²° ¿ ±®°²¨°®¢ª  ­¥ ²°¥¡³¥² ¤®¯®«­¨²¥«¼­®©
¯ ¬¿²¨ ¨ ±®µ° ­¿¥² ½´´¥ª²¨¢­®±²¼ ¤«¿ ±¨±²¥¬ ± ¢¨°²³ «¼­®© ¯ ¬¿²¼¾.
 ° §¤¥«¥ 8.1 ®¯¨±»¢ ¥²±¿  «£®°¨²¬ ¢ ¶¥«®¬ ¨ ¯°®¶¥¤³°  ° §¤¥«¥­¨¿ ¬ ±±¨¢  ­  · ±²¨. ¶¥­ª  ½´´¥ª²¨¢­®±²¨  «£®°¨²¬  ¤®¢®«¼­®
±«®¦­ ; ¢ ° §¤¥«¥ 8.2 ¯°¨¢®¤¿²±¿ ¨­²³¨²¨¢­»¥ ¤®¢®¤»,   ±²°®£¨©
 ­ «¨§ ®²«®¦¥­ ¤® ° §¤¥«  8.4.  ° §¤¥«¥ 8.3 ®¯¨± ­» ¢ °¨ ­²» ¡»±²°®© ±®°²¨°®¢ª¨, ¨±¯®«¼§³¾¹¨¥ £¥­¥° ²®° ±«³· ©­»µ ·¨±¥«. °¨
½²®¬ ¢°¥¬¿ ° ¡®²» ¢ µ³¤¸¥¬ ±«³· ¥ (¯°¨ ­¥³¤ ·­®¬ ±«³· ©­®¬ ¢»¡®°¥) ±®±² ¢«¿¥² O(n2 ), ­® ±°¥¤­¥¥ ¢°¥¬¿ ° ¡®²» ±®±² ¢«¿¥² «¨¸¼
O(n lg n). (®¢®°¿ ® ±°¥¤­¥¬ ¢°¥¬¥­¨, ¬» ¨¬¥¥¬ ¢ ¢¨¤³ ­¥ ³±°¥¤­¥­¨¥ ¯® ¢±¥¬ ¢µ®¤ ¬,   ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ¢°¥¬¥­¨ ° ¡®²»,
ª®²®°®¥ ¤«¿ «¾¡®£® ¢µ®¤  ­¥ ¯°¥¢®±µ®¤¨² O(n log n).) ¤¨­ ¨§ ¢ °¨ ­²®¢ ¢¥°®¿²­®±²­®£®  «£®°¨²¬  ¡»±²°®© ±®°²¨°®¢ª¨ ¯®¤°®¡­®
 ­ «¨§¨°³¥²±¿ ¢ ° §¤¥«¥ 8.4, £¤¥ ¤®ª § ­» ®¶¥­ª¨ ¤«¿ ±°¥¤­¥£® ¨
­ ¨¡®«¼¸¥£® ¢°¥¬¥­¨ ° ¡®²».

8.1. ¯¨± ­¨¥ ¡»±²°®© ±®°²¨°®¢ª¨
»±²° ¿ ±®°²¨°®¢ª  (quicksort), ª ª ¨ ±®°²¨°®¢ª  ±«¨¿­¨¥¬,
®±­®¢ ­  ­  ¯°¨­¶¨¯¥ À° §¤¥«¿© ¨ ¢« ±²¢³©Á (±¬. ° §¤. 1.3.1). ®°²¨°®¢ª  ³· ±²ª  A[p : :r] ¯°®¨±µ®¤¨² ² ª:
 «¥¬¥­²» ¬ ±±¨¢  A ¯¥°¥±² ¢«¿¾²±¿ ² ª, ·²®¡» «¾¡®© ¨§
½«¥¬¥­²®¢ A[p]; : : :; A[q ] ¡»« ­¥ ¡®«¼¸¥ «¾¡®£® ¨§ ½«¥¬¥­²®¢
A[q +1]; : : :; A[r], £¤¥ q | ­¥ª®²®°®¥ ·¨±«® ¢ ¨­²¥°¢ «¥ p 6 q < r.
²³ ®¯¥° ¶¨¾ ¬» ¡³¤¥¬ ­ §»¢ ²¼ ° §¤¥«¥­¨¥¬ (partition).
 °®¶¥¤³°  ±®°²¨°®¢ª¨ °¥ª³°±¨¢­® ¢»§»¢ ¥²±¿ ¤«¿ ¬ ±±¨¢®¢
A[p : :q] ¨ A[q + 1 : :r].

¯¨± ­¨¥ ¡»±²°®© ±®°²¨°®¢ª¨

155

®±«¥ ½²®£® ¬ ±±¨¢ A[p : :r] ®²±®°²¨°®¢ ­.
² ª, ¯°®¶¥¤³°  ±®°²¨°®¢ª¨ Quicksort ¢»£«¿¤¨² ±«¥¤³¾¹¨¬
®¡° §®¬:
Quicksort(A; p; r)
1 if p < r
2 then q Partition(A; p; r)
3
Quicksort(A; p; q )
4
Quicksort(A; q + 1; r)
«¿ ±®°²¨°®¢ª¨ ¢±¥£® ¬ ±±¨¢  ­¥®¡µ®¤¨¬® ¢»¯®«­¨²¼ ¯°®¶¥¤³°³
Quicksort(A; 1; length[A]).
 §¡¨¥­¨¥ ¬ ±±¨¢ 
±­®¢­®© ¸ £  «£®°¨²¬  | ¯°®¶¥¤³°  Partition, ª®²®° ¿ ¯¥°¥±² ¢«¿¥² ½«¥¬¥­²» ¬ ±±¨¢  A[p : :r] ­³¦­»¬ ®¡° §®¬:
Partition(A; p; r)
1 x A[p]
2 i p;1
3 j r+1
4 while true
5
do repeat j j ; 1
6
until A[j ] 6 x
7
repeat i i + 1
8
until A[i] > x
9
if i < j
10
then ¯®¬¥­¿²¼ A[i] $ A[j ]
11
else return j
 ¡®²  ¯°®¶¥¤³°» Partition ¯®ª § ­  ­  °¨±. 8.1. «¥¬¥­² x =
A[p] ¢»¡¨° ¥²±¿ ¢ ª ·¥±²¢¥ À£° ­¨·­®£®Á; ¬ ±±¨¢ A[p : :q] ¡³¤¥² ±®¤¥°¦ ²¼ ½«¥¬¥­²», ­¥ ¡®«¼¸¨¥ x,   ¬ ±±¨¢ A[q +1 : :r] | ½«¥¬¥­²»,
­¥ ¬¥­¼¸¨¥ x. ¤¥¿ ±®±²®¨² ¢ ²®¬, ·²®¡» ­ ª ¯«¨¢ ²¼ ½«¥¬¥­²»,
­¥ ¡®«¼¸¨¥ x, ¢ ­ · «¼­®¬ ®²°¥§ª¥ ¬ ±±¨¢  (A[p : :i]),   ½«¥¬¥­²»,
­¥ ¬¥­¼¸¨¥ x | ¢ ª®­¶¥ (A[j : : r]).  ­ · «¥ ®¡  À­ ª®¯¨²¥«¿Á ¯³±²»: i = p ; 1, j = r + 1.
­³²°¨ ¶¨ª«  while (¢ ±²°®ª µ 5{8) ª ­ · «¼­®¬³ ¨ ª®­¥·­®¬³
³· ±²ª ¬ ¯°¨±®¥¤¨­¿¾²±¿ ½«¥¬¥­²» (ª ª ¬¨­¨¬³¬ ¯® ®¤­®¬³). ®±«¥ ¢»¯®«­¥­¨¿ ½²¨µ ±²°®ª A[i] > x > A[j ]. ±«¨ ¬» ¯®¬¥­¿¥¬ A[i]
¨ A[j ] ¬¥±² ¬¨, ²® ¨µ ¬®¦­® ¡³¤¥² ¯°¨±®¥¤¨­¨²¼ ª ­ · «¼­®¬³ ¨
ª®­¥·­®¬³ ³· ±²ª ¬.
 ¬®¬¥­² ¢»µ®¤  ¨§ ¶¨ª«  ¢»¯®«­¥­® ­¥° ¢¥­±²¢® i > j . °¨
½²®¬ ¬ ±±¨¢ ° §¡¨² ­  · ±²¨ A[p]; : : :; A[j ] ¨ A[j + 1]; : : :; A[r]; «¾¡®© ½«¥¬¥­² ¯¥°¢®© · ±²¨ ­¥ ¯°¥¢®±µ®¤¨² «¾¡®£® ½«¥¬¥­²  ¢²®°®©

156

« ¢  8 »±²° ¿ ±®°²¨°®¢ª 

¨±. 8.1  ¡®²  ¯°®¶¥¤³°» Partition. ¥§ ª° ¸¥­­»¥ ½«¥¬¥­²» ®²­®±¿²±¿
ª ³¦¥ ±´®°¬¨°®¢ ­­»¬ ª³±ª ¬, § ª° ¸¥­­»¥ ¥¹¥ ­¥ ° ±¯°¥¤¥«¥­». ( )  · «¼­®¥ ±®±²®¿­¨¥ ¬ ±±¨¢ , ­ · «¼­»© ¨ ª®­¥·­»© ª³±ª¨ ¯³±²». «¥¬¥­²
x = A[p] = 5 ¨±¯®«¼§³¥²±¿ ¢ ª ·¥±²¢¥ £° ­¨·­®£®. (¡) ¥§³«¼² ² ¯¥°¢®£® ¯°®µ®¤  ¶¨ª«  while (±²°®ª¨ 4{8). (¢) «¥¬¥­²» A[i] ¨ A[j ] ¬¥­¿¾²±¿ ¬¥±² ¬¨ (±²°®ª  10). (£) ¥§³«¼² ² ¢²®°®£® ¯°®µ®¤  ¶¨ª«  while. (¤) ¥§³«¼² ² ²°¥²¼¥£® (¯®±«¥¤­¥£®) ¯°®µ®¤  ¶¨ª«  while. ®±ª®«¼ª³ i > j , ¯°®¶¥¤³°  ®±² ­ ¢«¨¢ ¥²±¿ ¨
¢®§¢° ¹ ¥² §­ ·¥­¨¥ q = j . «¥¬¥­²» ±«¥¢  ®² A[j ] (¢ª«¾· ¿ ± ¬ ½²®² ½«¥¬¥­²)
­¥ ¡®«¼¸¥, ·¥¬ x = 5,   ½«¥¬¥­²» ±¯° ¢  ®² A[j ] ­¥ ¬¥­¼¸¥, ·¥¬ x = 5.

· ±²¨. °®¶¥¤³°  ¢®§¢° ¹ ¥² §­ ·¥­¨¥ j .
®²¿ ¨¤¥¿ ¯°®¶¥¤³°» ®·¥­¼ ¯°®±² , ± ¬  «£®°¨²¬ ±®¤¥°¦¨² °¿¤
²®­ª¨µ ¬®¬¥­²®¢.  ¯°¨¬¥°, ­¥ ®·¥¢¨¤­®, ·²® ¨­¤¥ª±» i ¨ j ­¥
¢»µ®¤¿² §  £° ­¨¶» ¯°®¬¥¦³²ª  [p : :r] ¢ ¯°®¶¥±±¥ ° ¡®²». °³£®© ¯°¨¬¥°: ¢ ¦­®, ·²® ¢ ª ·¥±²¢¥ £° ­¨·­®£® §­ ·¥­¨¿ ¢»¡¨° ¥²±¿ A[p],   ­¥, ±ª ¦¥¬, A[r].  ¯®±«¥¤­¥¬ ±«³· ¥ ¬®¦¥² ®ª § ²¼±¿,
·²® A[r] | ± ¬»© ¡®«¼¸®© ½«¥¬¥­² ¬ ±±¨¢ , ¨ ¢ ª®­¶¥ ¢»¯®«­¥­¨¿ ¯°®¶¥¤³°» ¡³¤¥² i = j = r, ² ª ·²® ¢®§¢° ¹ ²¼ q = j ¡³¤¥²
­¥«¼§¿ | ­ °³¸¨²±¿ ²°¥¡®¢ ­¨¥ q < r, ¨ ¯°®¶¥¤³°  Quicksort
§ ¶¨ª«¨²±¿. ° ¢¨«¼­®±²¼ ¯°®¶¥¤³°» Partition ±®±² ¢«¿¥² ¯°¥¤¬¥² § ¤ ·¨ 8-1.
°¥¬¿ ° ¡®²» ¯°®¶¥¤³°» Partition ±®±² ¢«¿¥² (n), £¤¥ n =
r ; p + 1 (±¬. ³¯°. 8.1-3).
¯° ¦­¥­¨¿
8.1-1

®ª ¦¨²¥, ±«¥¤³¿ ®¡° §¶³ °¨±. 8.1, ª ª ° ¡®² ¥² ¯°®¶¥¤³° 
Partition ¤«¿ ¬ ±±¨¢  A = h13; 19; 9; 5; 12; 8; 7; 4; 11; 2; 6; 21i.
8.1-2 ³±²¼ ¢±¥ ½«¥¬¥­²» ¬ ±±¨¢  A[p : :r] ° ¢­».  ª®¥ §­ ·¥­¨¥
¢¥°­¥² ¯°®¶¥¤³°  Partition?
8.1-3 °¨¢¥¤¨²¥ ¯°®±²®¥ ±®®¡° ¦¥­¨¥, ®¡º¿±­¿¾¹¥¥, ¯®·¥¬³
¢°¥¬¿ ° ¡®²» ¯°®¶¥¤³°» Partition ±®±² ¢«¿¥² (n).

 ¡®²  ¡»±²°®© ±®°²¨°®¢ª¨

157

8.1-4  ª ®²±®°²¨°®¢ ²¼ ¬ ±±¨¢ ¢ ¯®°¿¤ª¥ ³¡»¢ ­¨¿ (  ­¥ ¢®§° ±² ­¨¿), ¨±¯®«¼§³¿ ²¥ ¦¥ ¬¥²®¤»?

8.2.  ¡®²  ¡»±²°®© ±®°²¨°®¢ª¨
°¥¬¿ ° ¡®²»  «£®°¨²¬  ¡»±²°®© ±®°²¨°®¢ª¨ § ¢¨±¨² ®² ²®£®,
ª ª ° §¡¨¢ ¥²±¿ ¬ ±±¨¢ ­  ª ¦¤®¬ ¸ £¥. ±«¨ ° §¡¨¥­¨¥ ¯°®¨±µ®¤¨² ­  ¯°¨¬¥°­® ° ¢­»¥ · ±²¨, ¢°¥¬¿ ° ¡®²» ±®±² ¢«¿¥² O(n lg n),
ª ª ¨ ¤«¿ ±®°²¨°®¢ª¨ ±«¨¿­¨¥¬. ±«¨ ¦¥ ° §¬¥°» · ±²¥© ±¨«¼­®
®²«¨· ¾²±¿, ±®°²¨°®¢ª  ¬®¦¥² § ­¨¬ ²¼ ¢°¥¬¿ O(n2 ), ª ª ¯°¨ ±®°²¨°®¢ª¥ ¢±² ¢ª ¬¨.
 ¨µ³¤¸¥¥ ° §¡¨¥­¨¥
À ¨¡®«¥¥ ­¥° ¢­»¥ · ±²¨Á ¯®«³· ²±¿, ¥±«¨ ®¤­  · ±²¼ ±®¤¥°¦¨²
n ; 1 ½«¥¬¥­²,   ¢²®° ¿ | ¢±¥£® 1. ( ª ¬» ³¢¨¤¨¬ ¢ ° §¤¥«¥ 8.4.1,
½²® ­ ¨µ³¤¸¨© ±«³· © ± ²®·ª¨ §°¥­¨¿ ¢°¥¬¥­¨ ° ¡®²».) °¥¤¯®«®¦¨¬, ·²® ­  ª ¦¤®¬ ¸ £¥ ¯°®¨±µ®¤¨² ¨¬¥­­® ² ª. ®±ª®«¼ª³
¯°®¶¥¤³°  ° §¡¨¥­¨¿ § ­¨¬ ¥² ¢°¥¬¿ (n), ¤«¿ ¢°¥¬¥­¨ ° ¡®²»
T (n) ¯®«³· ¥¬ ±®®²­®¸¥­¨¥
T (n) = T (n ; 1) + (n)
®±ª®«¼ª³ T (1) = (1), ¨¬¥¥¬

T (n) = T (n ; 1) + (n) =

n
X
k=1

(k) = 

n
X
k=1

!

k = (n2 )

(¯®±«¥¤­¿¿ ±³¬¬  |  °¨´¬¥²¨·¥±ª ¿ ¯°®£°¥±±¨¿, ±¬. ´®°¬³«³ (3.2)). ¥°¥¢® °¥ª³°±¨¨ ¤«¿ ½²®£® ±«³· ¿ ¯®ª § ­® ­  °¨±. 8.2.
(® ¯®¢®¤³ ¤¥°¥¢¼¥¢ °¥ª³°±¨¨ ±¬. ° §¤. 4.2.)
» ¢¨¤¨¬, ·²® ¯°¨ ¬ ª±¨¬ «¼­® ­¥±¡ « ­±¨°®¢ ­­®¬ ° §¡¨¥­¨¨
¢°¥¬¿ ° ¡®²» ±®±² ¢«¿¥² (n2 ), ª ª ¨ ¤«¿ ±®°²¨°®¢ª¨ ¢±² ¢ª ¬¨.
 · ±²­®±²¨, ½²® ¯°®¨±µ®¤¨², ¥±«¨ ¬ ±±¨¢ ¨§­ · «¼­® ®²±®°²¨°®¢ ­ (§ ¬¥²¨¬, ·²® ¢ ½²®¬ ±«³· ¥ ±®°²¨°®¢ª  ¢±² ¢ª ¬¨ ¯°®¨§¢®¤¨²±¿ §  ¢°¥¬¿ (n)).
 ¨«³·¸¥¥ ° §¡¨¥­¨¥
±«¨ ­  ª ¦¤®¬ ¸ £¥ ¬ ±±¨¢ ° §¡¨¢ ¥²±¿ °®¢­® ¯®¯®« ¬, ¡»±²° ¿ ±®°²¨°®¢ª  ²°¥¡³¥² §­ ·¨²¥«¼­® ¬¥­¼¸¥ ¢°¥¬¥­¨. ¥©±²¢¨²¥«¼­®, ¢ ½²®¬ ±«³· ¥ °¥ª³°°¥­²­®¥ ±®®²­®¸¥­¨¥ ¨¬¥¥² ¢¨¤
T (n) = 2T (n=2) + (n)
¨, ±®£« ±­® ²¥®°¥¬¥ 4.1 (±«³· © 2), T (n) = (n lg n). ¥°¥¢® °¥ª³°±¨¨ ¤«¿ ½²®£® ±«³· ¿ ¯®ª § ­® ­  °¨±³­ª¥ 8.3.

158

« ¢  8 »±²° ¿ ±®°²¨°®¢ª 

¨±. 8.2 ¥°¥¢® °¥ª³°±¨¨ ¯°®¶¥¤³°» Quicksort ¤«¿ ­ ¨µ³¤¸¥£® ±«³· ¿ (¯°®¶¥¤³°  Partition ª ¦¤»© ° § ¯°®¨§¢®¤¨² ° §¡¨¥­¨¥, ¢ ª®²®°®¬ ®¤­  ¨§ · ±²¥©
±®¤¥°¦¨² ®¤¨­ ½«¥¬¥­²). °¥¬¿ ° ¡®²» ° ¢­® (n2 ).

¨±. 8.3 ¥°¥¢® °¥ª³°±¨¨ ¯°®¶¥¤³°» Quicksort ¤«¿ ­ ¨«³·¸¥£® ±«³· ¿ (¬ ±±¨¢ ª ¦¤»© ° § ° §¡¨¢ ¥²±¿ ¯®¯®« ¬). °¥¬¿ ° ¡®²» ° ¢­® (n lg n).

°®¬¥¦³²®·­»© ±«³· ©
 ª ¡³¤¥² ¯®ª § ­® ¢ ° §¤¥«¥ 8.4, ±°¥¤­¥¥ ¢°¥¬¿ ° ¡®²» (± ²®·­®±²¼¾ ¤® ¬­®¦¨²¥«¿) ±®¢¯ ¤ ¥² ± ¢°¥¬¥­¥¬ ° ¡®²» ¢ ­ ¨«³·¸¥¬
±«³· ¥. ²®¡» ®¡º¿±­¨²¼ ½²®, ¯®±¬®²°¨¬, ª ª ¬¥­¿¥²±¿ °¥ª³°°¥­²­®¥ ±®®²­®¸¥­¨¥ ¢ § ¢¨±¨¬®±²¨ ®² ±²¥¯¥­¨ ±¡ « ­±¨°®¢ ­­®±²¨
° §¡¨¥­¨¿.
³±²¼, ­ ¯°¨¬¥°, ­  ª ¦¤®¬ ¸ £¥ ¬ ±±¨¢ ° §¡¨¢ ¥²±¿ ­  ¤¢¥
· ±²¨ ± ®²­®¸¥­¨¥¬ ° §¬¥°®¢ 9 : 1. ®£¤ 
T (n) = T (9n=10) + T (n=10) + n
(¤«¿ ³¤®¡±²¢  ¬» § ¬¥­¨«¨ (n) ­  n). ¥°¥¢® °¥ª³°±¨¨ ¯®ª § ­® ­  °¨±³­ª¥ 8.4.   ª ¦¤®¬ ³°®¢­¥ ¬» ¯°®¨§¢®¤¨¬ ­¥ ¡®«¥¥ n
¤¥©±²¢¨©, ² ª ·²® ¢°¥¬¿ ° ¡®²» ®¯°¥¤¥«¿¥²±¿ £«³¡¨­®© °¥ª³°±¨¨.

 ¡®²  ¡»±²°®© ±®°²¨°®¢ª¨

159

¥°¥¢® °¥ª³°±¨¨ ¤«¿ ±«³· ¿, ª®£¤  ° §¡¨¥­¨¥ ª ¦¤»© ° § ¯°®¨§¢®¤¨²±¿ ¢ ®²­®¸¥­¨¨ 9 : 1. °¥¬¿ ° ¡®²» ° ¢­® (n lg n).
¨±. 8.4

 ¤ ­­®¬ ±«³· ¥ ½²  £«³¡¨­  ° ¢­  log10=9 n = (lg n), ² ª ·²®
¢°¥¬¿ ° ¡®²» ¯®-¯°¥¦­¥¬³ ±®±² ¢«¿¥² (n lg n), µ®²¿ ª®­±² ­²  ¨
¡®«¼¸¥. ±­®, ·²® ¤«¿ «¾¡®£® ´¨ª±¨°®¢ ­­®£® ®²­®¸¥­¨¿ ° §¬¥°®¢ · ±²¥© (±ª®«¼ ¡» ¢¥«¨ª® ®­® ­¨ ¡»«®) £«³¡¨­  ¤¥°¥¢  °¥ª³°±¨¨
¯®-¯°¥¦­¥¬³ ¡³¤¥² «®£ °¨´¬¨·¥±ª®©,   ¢°¥¬¿ ° ¡®²» ¡³¤¥² ° ¢­®
(n lg n).
°¥¤­¥¥ ¢°¥¬¿: ¨­²³¨²¨¢­»¥ ±®®¡° ¦¥­¨¿
²®¡» ¢®¯°®± ® ±°¥¤­¥¬ ¢°¥¬¥­¨ ° ¡®²» ¨¬¥« ±¬»±«, ­³¦­®
³²®·­¨²¼, ± ª ª®© · ±²®²®© ¯®¿¢«¿¾²±¿ ° §«¨·­»¥ ¢µ®¤­»¥ §­ ·¥­¨¿.  ª ¯° ¢¨«®, ¯°¥¤¯®« £ ¥²±¿, ·²® ¢±¥ ¯¥°¥±² ­®¢ª¨ ¢µ®¤­»µ §­ ·¥­¨© ° ¢­®¢¥°®¿²­». (» ¢¥°­¥¬±¿ ª ½²®¬³ ¢ ±«¥¤³¾¹¥¬
° §¤¥«¥.)
«¿ ­ ³£ ¤ ¢§¿²®£® ¬ ±±¨¢  ° §¡¨¥­¨¿ ¢°¿¤ «¨ ¡³¤³² ¢±¥ ¢°¥¬¿
¯°®¨±µ®¤¨²¼ ¢ ®¤­®¬ ¨ ²®¬ ¦¥ ®²­®¸¥­¨¨ | ±ª®°¥¥ ¢±¥£®, · ±²¼
° §¡¨¥­¨© ¡³¤¥² µ®°®¸® ±¡ « ­±¨°®¢ ­ ,   · ±²¼ ­¥².  ª ¯®ª §»¢ ¥² ³¯°. 8.2-5, ¯°¨¬¥°­® 80 ¯°®¶¥­²®¢ ° §¡¨¥­¨© ¯°®¨§¢®¤¿²±¿ ¢
®²­®¸¥­¨¨ ­¥ ¡®«¥¥ 9 : 1.
³¤¥¬ ¯°¥¤¯®« £ ²¼ ¤«¿ ¯°®±²®²», ·²® ­  ª ¦¤®¬ ¢²®°®¬ ³°®¢­¥ ¢±¥ ° §¡¨¥­¨¿ ­ ¨µ³¤¸¨¥,   ­  ®±² ¢¸¥©±¿ ¯®«®¢¨­¥ ³°®¢­¥©
­ ¨«³·¸¨¥ (¯°¨¬¥° ¯®ª § ­ ­  °¨±. 8.5( )). ®±ª®«¼ª³ ¯®±«¥ ª ¦¤®£® Àµ®°®¸¥£®Á ° §¡¨¥­¨¿ ° §¬¥° · ±²¥© ³¬¥­¼¸ ¥²±¿ ¢¤¢®¥, ·¨±«®
Àµ®°®¸¨µÁ ³°®¢­¥© ° ¢­® (lg n),   ¯®±ª®«¼ª³ ª ¦¤»© ¢²®°®© ³°®¢¥­¼ Àµ®°®¸¨©Á, ®¡¹¥¥ ·¨±«® ³°®¢­¥© ° ¢­® (lg n),   ¢°¥¬¿ ° ¡®²»
| (n lg n).  ª¨¬ ®¡° §®¬, ¯«®µ¨¥ ³°®¢­¨ ­¥ ¨±¯®°²¨«¨  ±¨¬¯²®²¨ª³ ¢°¥¬¥­¨ ° ¡®²» (  «¨¸¼ ³¢¥«¨·¨«¨ ª®­±² ­²³, ±ª°»²³¾ ¢

160

« ¢  8 »±²° ¿ ±®°²¨°®¢ª 

¨±. 8.5 ( ) ¢  ³°®¢­¿: ¯«®µ®© (n ° §¡¨¢ ¥²±¿ ­  n ; 1 ¨ 1) ¨ µ®°®¸¨© (n ; 1
° §¡¨¢ ¥²±¿ ­  ¤¢¥ ° ¢­»¥ · ±²¨). (¡) ±«¨ ½²¨ ¤¢  ³°®¢­¿ § ¬¥­¨²¼ ®¤­¨¬,
¯®«³·¨²±¿ ° §¡¨¥­¨¥ ­  ¯®·²¨ ° ¢­»¥ ¯® ¢¥«¨·¨­¥ · ±²¨.

 ±¨¬¯²®²¨·¥±ª®¬ ®¡®§­ ·¥­¨¨).
¯° ¦­¥­¨¿
8.2-1 ®ª ¦¨²¥, ·²® ¥±«¨ ¬ ±±¨¢ ±®±²®¨² ¨§ ®¤¨­ ª®¢»µ ½«¥¬¥­²®¢, ²® ¢°¥¬¿ ° ¡®²» ¯°®¶¥¤³°» Quicksort ° ¢­® (n lg n).
8.2-2 ³±²¼ ¬ ±±¨¢ ®²±®°²¨°®¢ ­ ¢ ¯®°¿¤ª¥ ³¡»¢ ­¨¿. ®ª ¦¨²¥, ·²® ¢°¥¬¿ ° ¡®²» ¯°®¶¥¤³°» Quicksort ±®±² ¢«¿¥² (n2 ).
8.2-3  ª ¯° ¢¨«®, ¢ ¡ ­ª µ ®¡° ¡ ²»¢ ¾² ·¥ª¨ ¢ ¯®°¿¤ª¥ ¨µ
¯®±²³¯«¥­¨¿; ª«¨¥­²» ¦¥ ¯°¥¤¯®·¨² ¾², ·²®¡» ¢ ®²·¥²¥ ¯« ²¥¦¨
¡»«¨ ³ª § ­» ¢ ¯®°¿¤ª¥ ­®¬¥°®¢ ·¥ª®¢. « ¤¥«¥¶ ·¥ª®¢®© ª­¨¦ª¨
®¡»·­® ¢»¯¨±»¢ ¥² ·¥ª¨ ¯®¤°¿¤,   ¯®«³· ²¥«¨ ·¥ª®¢ ¯°¥¤º¿¢«¿¾²
¨µ ¢ ¡ ­ª ¢±ª®°¥ ¯®±«¥ ¢»¯¨±»¢ ­¨¿.  ª¨¬ ®¡° §®¬, ¯®°¿¤®ª ­®¬¥°®¢ ­ °³¸ ¥²±¿ ­¥§­ ·¨²¥«¼­®. «¥¤®¢ ²¥«¼­®, ¡ ­ª³ ²°¥¡³¥²±¿
®²±®°²¨°®¢ ²¼ ¯®·²¨ ®²±®°²¨°®¢ ­­»© ¬ ±±¨¢. ¡º¿±­¨²¥, ¯®·¥¬³ ±®°²¨°®¢ª  ¢±² ¢ª ¬¨ ¢ ² ª¨µ ±«³· ¿µ ° ¡®² ¥² ¡»±²°¥¥, ·¥¬
¡»±²° ¿ ±®°²¨°®¢ª .
8.2-4 ³±²¼ ° §¡¨¥­¨¿ ­  ª ¦¤®¬ ¸ £¥ ¯°®¨§¢®¤¿²±¿ ¢ ®²­®¸¥­¨¨  : 1 ; , £¤¥ 0 <  6 1=2. ®ª ¦¨²¥, ·²® ¬¨­¨¬ «¼­ ¿ £«³¡¨­ 
«¨±²  ­  ¤¥°¥¢¥ °¥ª³°±¨¨ ¯°¨¬¥°­® ° ¢­  ; lg n= lg ,   ¬ ª±¨¬ «¼­ ¿ ¯°¨¬¥°­® ° ¢­  ; lg n= lg(1;). (¥ § ¡®²¼²¥±¼ ®¡ ®ª°³£«¥­¨¨.)
8.2-5? ®ª ¦¨²¥, ·²® ¤«¿ «¾¡®£® ·¨±«   ¢ ¨­²¥°¢ «¥ 0 <  6 1=2
¢¥°®¿²­®±²¼ ²®£®, ·²® ° §¡¨¥­¨¥ ±«³· ©­®£® ¬ ±±¨¢  ¡³¤¥² ±¡ « ­-

¥°®¿²­®±²­»¥  «£®°¨²¬» ¡»±²°®© ±®°²¨°®¢ª¨

161

±¨°®¢ ­® ­¥ µ³¦¥, ·¥¬  : 1 ; , ¯°¨¬¥°­® ° ¢­  1 ; 2. °¨ ª ª®¬
§­ ·¥­¨¨  ¢¥°®¿²­®±²¼ ½²®£® ±®¡»²¨¿ ° ¢­  1=2?

8.3. ¥°®¿²­®±²­»¥  «£®°¨²¬» ¡»±²°®© ±®°²¨°®¢ª¨
 ­¥¥ ¬» ¯°¥¤¯®«®¦¨«¨, ·²® ¢±¥ ¯¥°¥±² ­®¢ª¨ ¢µ®¤­»µ §­ ·¥­¨©
° ¢­®¢¥°®¿²­». ±«¨ ½²® ² ª,   ° §¬¥° ¬ ±±¨¢  ¤®±² ²®·­® ¢¥«¨ª,
¡»±²° ¿ ±®°²¨°®¢ª  | ®¤¨­ ¨§ ­ ¨¡®«¥¥ ½´´¥ª²¨¢­»µ  «£®°¨²¬®¢.   ¯° ª²¨ª¥, ®¤­ ª®, ½²® ¯°¥¤¯®«®¦¥­¨¥ (° ¢­®© ¢¥°®¿²­®±²¨
¢±¥µ ¯¥°¥±² ­®¢®ª ­  ¢µ®¤¥) ­¥ ¢±¥£¤  ®¯° ¢¤ ­® (±¬. ³¯°. 8.2-3).
 ½²®¬ ° §¤¥«¥ ¬» ¢¢¥¤¥¬ ¯®­¿²¨¥ ¢¥°®¿²­®±²­®£®  «£®°¨²¬  ¨
° ±±¬®²°¨¬ ¤¢  ¢¥°®¿²­®±²­»µ  «£®°¨²¬  ¡»±²°®© ±®°²¨°®¢ª¨,
ª®²®°»¥ ¯®§¢®«¿¾² ®²ª § ²¼±¿ ®² ¯°¥¤¯®«®¦¥­¨¿ ® ° ¢­®© ¢¥°®¿²­®±²¨ ¢±¥µ ¯¥°¥±² ­®¢®ª.
¤¥¿ ±®±²®¨² ¢ ¯°¨¢­¥±¥­¨¨ ±«³· ©­®±²¨, ®¡¥±¯¥·¨¢ ¾¹¥¬ ­³¦­®¥ ° ±¯°¥¤¥«¥­¨¥.  ¯°¨¬¥°, ¯¥°¥¤ ­ · «®¬ ±®°²¨°®¢ª¨ ¬®¦­®
±«³· ©­® ¯¥°¥±² ¢¨²¼ ½«¥¬¥­²», ¯®±«¥ ·¥£® ³¦¥ ¢±¥ ¯¥°¥±² ­®¢ª¨
±² ­³² ° ¢­®¢¥°®¿²­»¬¨ (½²® ¬®¦­® ±¤¥« ²¼ §  ¢°¥¬¿ O(n) | ±¬.
³¯°. 8.3-4).  ª ¿ ¬®¤¨´¨ª ¶¨¿ ­¥ ³¢¥«¨·¨¢ ¥² ±³¹¥±²¢¥­­® ¢°¥¬¿
° ¡®²», ­® ²¥¯¥°¼ ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ¢°¥¬¥­¨ ° ¡®²» ­¥
§ ¢¨±¨² ®² ¯®°¿¤ª  ½«¥¬¥­²®¢ ¢® ¢µ®¤­®¬ ¬ ±±¨¢¥ (®­¨ ¢±¥ ° ¢­®
±«³· ©­® ¯¥°¥±² ¢«¿¾²±¿).
«£®°¨²¬ ­ §»¢ ¥²±¿ ¢¥°®¿²­®±²­»¬ (randomized), ¥±«¨ ®­ ¨±¯®«¼§³¥² £¥­¥° ²®° ±«³· ©­»µ ·¨±¥« (random-number generator).
» ¡³¤¥¬ ±·¨² ²¼, ·²® £¥­¥° ²®° ±«³· ©­»µ ·¨±¥« Random ° ¡®² ¥² ² ª: Random(a; b) ¢®§¢° ¹ ¥² ± ° ¢­®© ¢¥°®¿²­®±²¼¾ «¾¡®¥
¶¥«®¥ ·¨±«® ¢ ¨­²¥°¢ «¥ ®² a ¤® b.  ¯°¨¬¥°, Random(0; 1) ¢®§¢° ¹ ¥² 0 ¨«¨ 1 ± ¢¥°®¿²­®±²¼¾ 1=2. °¨ ½²®¬ ° §­»¥ ¢»§®¢» ¯°®¶¥¤³°» ­¥§ ¢¨±¨¬» ¢ ±¬»±«¥ ²¥®°¨¨ ¢¥°®¿²­®±²¥©. ®¦­® ±·¨² ²¼,
·²® ¬» ª ¦¤»© ° § ¡°®± ¥¬ ª®±²¼ ± (b ; a + 1) £° ­¿¬¨ ¨ ±®®¡¹ ¥¬ ­®¬¥° ¢»¯ ¢¸¥© £° ­¨. (  ¯° ª²¨ª¥ ®¡»·­® ¨±¯®«¼§³¾² £¥­¥° ²®° ¯±¥¢¤®±«³· ©­»µ ·¨±¥« (pseudorandom-number generator) |
¤¥²¥°¬¨­¨°®¢ ­­»©  «£®°¨²¬, ª®²®°»© ¢»¤ ¥² ·¨±« , À¯®µ®¦¨¥Á
­  ±«³· ©­»¥.)
«¿ ² ª®£® ¢¥°®¿²­®±²­®£® ¢ °¨ ­²   «£®°¨²¬  ¢ °¨ ­²  ¡»±²°®© ±®°²¨°®¢ª¨ ­¥² À­¥³¤®¡­»µ ¢µ®¤®¢Á: ³¯° ¦­¥­¨¥ 13.4-4 ¯®ª §»¢ ¥², ·²® ¯¥°¥±² ­®¢®ª, ¯°¨ ª®²®°»µ ¢°¥¬¿ ° ¡®²» ¢¥«¨ª®,
±®¢±¥¬ ¬ «® | ¯®½²®¬³ ¢¥°®¿²­®±²¼ ²®£®, ·²®  «£®°¨²¬ ¡³¤¥² ° ¡®² ²¼ ¤®«£® (¤«¿ «¾¡®£® ª®­ª°¥²­®£® ¢µ®¤ ) ­¥¢¥«¨ª .
­ «®£¨·­»© ¯®¤µ®¤ ¯°¨¬¥­¨¬ ¨ ¢ ¤°³£¨µ ±¨²³ ¶¨¿µ, ª®£¤  ¢
µ®¤¥ ¢»¯®«­¥­¨¿  «£®°¨²¬  ¬» ¤®«¦­» ¢»¡° ²¼ ®¤¨­ ¨§ ¬­®£¨µ
¢ °¨ ­²®¢ ¥£® ¯°®¤®«¦¥­¨¿, ¯°¨·¥¬ ¬» ­¥ §­ ¥¬, ª ª¨¥ ¨§ ­¨µ
µ®°®¸¨¥,   ª ª¨¥ ¯«®µ¨¥, ­® §­ ¥¬, ·²® µ®°®¸¨µ ¢ °¨ ­²®¢ ¤®±² ²®·­® ¬­®£®. ³¦­® ²®«¼ª®, ·²®¡» ¯«®µ¨¥ ¢»¡®°» ­¥ ° §°³¸ «¨

162

« ¢  8 »±²° ¿ ±®°²¨°®¢ª 

¤®±²¨£­³²®£® ¯°¨ ¯°¥¤»¤³¹¨µ µ®°®¸¨µ (ª ª ¬» ¢¨¤¥«¨ ¢ ° §¤¥«¥ 8.2, ¤«¿  «£®°¨²¬  ¡»±²°®© ±®°²¨°®¢ª¨ ½²® ² ª).
¬¥±²® ²®£®, ·²®¡» ¯°¥¤¢ °¨²¥«¼­® ¯¥°¥±² ¢«¿²¼ ½«¥¬¥­²» ¬ ±±¨¢ , ¬» ¬®¦¥¬ ¢­¥±²¨ ½«¥¬¥­² ±«³· ©­®±²¨ ¢ ¯°®¶¥¤³°³ Partition. ¬¥­­®, ¯¥°¥¤ ° §¡¨¥­¨¥¬ ¬ ±±¨¢  A[p : :r] ¡³¤¥¬ ¬¥­¿²¼
½«¥¬¥­² A[p] ±® ±«³· ©­® ¢»¡° ­­»¬ ½«¥¬¥­²®¬ ¬ ±±¨¢ . ®£¤  ª ¦¤»© ½«¥¬¥­² ± ° ¢­®© ¢¥°®¿²­®±²¼¾ ¬®¦¥² ®ª § ²¼±¿ £° ­¨·­»¬,
¨ ¢ ±°¥¤­¥¬ ° §¡¨¥­¨¿ ¡³¤³² ¯®«³· ²¼±¿ ¤®±² ²®·­® ±¡ « ­±¨°®¢ ­­»¬¨.
²®² ¯®¤µ®¤ § ¬¥­¿¥² ° §®¢³¾ ±«³· ©­³¾ ¯¥°¥±² ­®¢ª³ ¢µ®¤®¢
¢ ­ · «¥ ¨±¯®«¼§®¢ ­¨¥¬ ±«³· ©­»µ ¢»¡®°®¢ ­  ¢±¥¬ ¯°®²¿¦¥­¨¨
° ¡®²»  «£®°¨²¬ .  ±³¹­®±²¨ ½²® ²® ¦¥ ± ¬®¥, ¨ ®¡   «£®°¨²¬  ¨¬¥¾² ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ¢°¥¬¥­¨ ° ¡®²» O(n lg n), ­®
­¥¡®«¼¸¨¥ ²¥µ­¨·¥±ª¨¥ ° §«¨·¨¿ ¤¥« ¾²  ­ «¨§ ­®¢®£® ¢ °¨ ­² 
¯°®¹¥, ¨ ¨¬¥­­® ®­ ¡³¤¥² ° ±±¬ ²°¨¢ ²¼±¿ ¢ ° §¤¥«¥ 8.4.
§¬¥­¥­¨¿, ª®²®°»¥ ­³¦­® ¢­¥±²¨ ¢ ¯°®¶¥¤³°», ±®¢±¥¬ ­¥¢¥«¨ª¨:
Randomized-Partition(A; p; r)
1 i Random(p; r)
2 ¯®¬¥­¿²¼ A[p] $ A[i]
3 return Partition(A; p; r)
 ®±­®¢­®© ¯°®¶¥¤³°¥ ²¥¯¥°¼ ¡³¤¥² ¨±¯®«¼§®¢ ²¼±¿ RandomizedPartition ¢¬¥±²® Partition:
Randomized-Quicksort(A; p; r)
1 if p < r
2 then q Randomized-Partition(A; p; r)
3
Randomized-Quicksort(A; p; q )
4
Randomized-Quicksort(A; q + 1; r)
­ «¨§®¬ ½²®£®  «£®°¨²¬  ¬» § ©¬¥¬±¿ ¢ ±«¥¤³¾¹¥¬ ° §¤¥«¥.
¯° ¦­¥­¨¿
8.3-1 ®·¥¬³ ¤«¿ ¢¥°®¿²­®±²­®£®  «£®°¨²¬  ¢ ¦­® ­¥ ¬ ª±¨¬ «¼­®¥ ¢°¥¬¿ ° ¡®²» (¤«¿ ¤ ­­®£® ¢µ®¤ ),   ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ½²®£® ¢°¥¬¥­¨?
8.3-2 ª®«¼ª® ° § ¯°¨ ¢»¯®«­¥­¨¨ ¯°®¶¥¤³°» RandomizedQuicksort ¬®¦¥² ¯°®¨±µ®¤¨²¼ ®¡° ¹¥­¨¥ ª £¥­¥° ²®°³ ±«³· ©­»µ ·¨±¥« Random ¢ µ³¤¸¥¬ ±«³· ¥? §¬¥­¨²±¿ «¨ ®²¢¥² ¤«¿ ­ ¨«³·¸¥£® ±«³· ¿?
8.3-3? ¥ «¨§³©²¥ ¯°®¶¥¤³°³ Random(a; b), ¨±¯®«¼§³¿ ¡°®± ­¨¿
¬®­¥²», ². ¥. ¤ ²·¨ª, ± ° ¢­®© ¢¥°®¿²­®±²¼¾ ¢»¤ ¾¹¨© 0 ¨«¨ 1.

­ «¨§ ¡»±²°®© ±®°²¨°®¢ª¨

163

 ª®¢® ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ¢°¥¬¥­¨ ° ¡®²» ¢ ¸¥© ¯°®¶¥¤³°»?
8.3-4? °¨¤³¬ ©²¥ ¢¥°®¿²­®±²­³¾ ¯°®¶¥¤³°³, ª®²®° ¿ §  ¢°¥¬¿
(n) ±«³· ©­»¬ ®¡° §®¬ ¯¥°¥±² ¢«¿¥² ½«¥¬¥­²» ¢µ®¤­®£® ¬ ±±¨¢ 
A[1 : :n].

8.4. ­ «¨§ ¡»±²°®© ±®°²¨°®¢ª¨
 ½²®¬ ° §¤¥«¥ ¬» ¯°¥¢° ²¨¬ À¨­²³¨²¨¢­»¥Á ±®®¡° ¦¥­¨¿ ° §¤¥«  8.2 ¢ ±²°®£®¥ ° ±±³¦¤¥­¨¥. ­ · «  ¬» ° ±±¬®²°¨¬ ­ ¨µ³¤¸¨© ±«³· © (° ±±³¦¤¥­¨¿ ¡³¤³² ®¤¨­ ª®¢» ¨ ¤«¿  «£®°¨²¬ 
Quicksort, ¨ ¤«¿  «£®°¨²¬  Randomized-Quicksort),   § ²¥¬
­ ©¤¥¬ ±°¥¤­¥¥ ¢°¥¬¿ ° ¡®²»  «£®°¨²¬  Randomized-Quicksort.
8.4.1. ­ «¨§ ­ ¨µ³¤¸¥£® ±«³· ¿
 ° §¤¥«¥ 8.2 ¬» ¢¨¤¥«¨, ·²® ¥±«¨ ° §¡¨¥­¨¥ ­  ª ¦¤®¬ ¸ £¥ ­ ¨¡®«¥¥ ­¥±¡ « ­±¨°®¢ ­®, ²® ¢°¥¬¿ ° ¡®²» ±®±² ¢«¿¥² (n2 ). ­²³¨²¨¢­® ¿±­®, ·²® ½²® ­ ¨µ³¤¸¨© (¢ ±¬»±«¥ ¢°¥¬¥­¨ ° ¡®²») ±«³· ©.
¥©· ± ¬» ±²°®£® ¤®ª ¦¥¬ ½²®.
«¿ ¤®ª § ²¥«¼±²¢  ²®£®, ·²® ¢°¥¬¿ ° ¡®²» ±®±² ¢«¿¥² O(n2),
¬» ¨±¯®«¼§³¥¬ ¬¥²®¤ ¯®¤±² ­®¢ª¨ (±¬. ° §¤. 4.1). ³±²¼ T (n) |
­ ¨¡®«¼¸¥¥ ¢°¥¬¿ ° ¡®²»  «£®°¨²¬  ¤«¿ ¬ ±±¨¢  ¤«¨­» n. ®£¤ ,
®·¥¢¨¤­®,

T (n) = 16max
(T (q ) + T (n ; q )) + (n)
q6n;1

(8.1)

(¬» ° ±±¬ ²°¨¢ ¥¬ ¢±¥ ¢®§¬®¦­»¥ ° §¡¨¥­¨¿ ­  ¯¥°¢®¬ ¸ £¥).
°¥¤¯®«®¦¨¬, ·²® T (q ) 6 cq 2 ¤«¿ ­¥ª®²®°®© ª®­±² ­²» c ¨ ¤«¿
¢±¥µ q , ¬¥­¼¸¨µ ­¥ª®²®°®£® n. ®£¤ 

T (n) 6 16max
(cq 2 +c(n;q )2)+(n) = c16max
(q 2 +(n;q )2 )+(n):
q6n;1
q6n;1
¢ ¤° ²­»© ²°¥µ·«¥­ q 2 + (n ; q )2 ¤®±²¨£ ¥² ¬ ª±¨¬³¬  ­  ®²°¥§ª¥ 1 6 q 6 n ; 1 ¢ ¥£® ª®­¶ µ (¢²®° ¿ ¯°®¨§¢®¤­ ¿ ¯® q ¯®«®¦¨²¥«¼­ , ¯®½²®¬³ ´³­ª¶¨¿ ¢»¯³ª«  ¢­¨§, ±¬. ³¯°. 8.4-2). ²®²
¬ ª±¨¬³¬ ° ¢¥­ 12 + (n ; 1)2 = n2 ; 2(n ; 1). ²±¾¤  ¯®«³· ¥¬

T (n) 6 cn2 ; 2c(n ; 1) + (n) 6 cn2;
¥±«¨ ª®­±² ­²  c ¢»¡° ­  ² ª, ·²®¡» ¯®±«¥¤­¥¥ ±« £ ¥¬®¥ ¡»«®

¬¥­¼¸¥ ¯°¥¤¯®±«¥¤­¥£®. ² ª, ¢°¥¬¿ ° ¡®²» ¢ µ³¤¸¥¬ ±«³· ¥ ±®±² ¢«¿¥² (n2 ).

164

« ¢  8 »±²° ¿ ±®°²¨°®¢ª 

8.4.2. ­ «¨§ ±°¥¤­¥£® ¢°¥¬¥­¨ ° ¡®²»
 ª ¬» ³¦¥ ¢¨¤¥«¨ ¢ ° §¤¥«¥ 8.2, ¥±«¨ ° §¡¨¥­¨¿ ¯°®¨§¢®¤¿²±¿
² ª, ·²® ®²­®¸¥­¨¥ ° §¬¥°®¢ · ±²¥© ®£° ­¨·¥­®, ²® £«³¡¨­  ¤¥°¥¢  °¥ª³°±¨¨ ° ¢­  (lg n),   ¢°¥¬¿ ° ¡®²» | (n lg n). ²®¡» ¯®«³·¨²¼ ®¶¥­ª³ ±°¥¤­¥£® ¢°¥¬¥­¨ ° ¡®²»  «£®°¨²¬  RandomizedQuicksort, ¬» ±­ · «  ¯°® ­ «¨§¨°³¥¬ ° ¡®²³ ¯°®¶¥¤³°» Partition, § ²¥¬ ¯®«³·¨¬ °¥ª³°°¥­²­®¥ ±®®²­®¸¥­¨¥ ­  ±°¥¤­¥¥ ¢°¥¬¿
° ¡®²» ¨ °¥¸¨¬ ¥£® (¯®¯³²­® ¯®«³·¨¢ ®¤­³ ¯®«¥§­³¾ ®¶¥­ª³).
­ «¨§ ° §¡¨¥­¨©
 ¯®¬­¨¬, ·²® ¯¥°¥¤ ²¥¬ ª ª ¢ ±²°®ª¥ 3 ¯°®¶¥¤³°»

Randomized-Partition ¢»§»¢ ¥²±¿ ¯°®¶¥¤³°  Partition, ½«¥-

¬¥­² A[p] ¯¥°¥±² ¢«¿¥²±¿ ±® ±«³· ©­® ¢»¡° ­­»¬ ½«¥¬¥­²®¬
¬ ±±¨¢  A[p : :r]. «¿ ¯°®±²®²» ¬» ¡³¤¥¬ ¯°¥¤¯®« £ ²¼, ·²® ¢±¥
·¨±«  ¢ ¬ ±±¨¢¥ ° §«¨·­». ®²¿ ®¶¥­ª  ±°¥¤­¥£® ¢°¥¬¥­¨ ±®µ° ­¿¥²±¿ ¨ ¢ ²®¬ ±«³· ¥, ª®£¤  ¢ ¬ ±±¨¢¥ ¥±²¼ ®¤¨­ ª®¢»¥ ½«¥¬¥­²»,
¯®«³·¨²¼ ¥¥ ±«®¦­¥¥, ¨ ¬» ½²®£® ¤¥« ²¼ ­¥ ¡³¤¥¬.
°¥¦¤¥ ¢±¥£®, § ¬¥²¨¬, ·²® §­ ·¥­¨¥ q , ª®²®°®¥ ¢®§¢° ²¨² ¯°®¶¥¤³°  Partition, § ¢¨±¨² ²®«¼ª® ®² ²®£®, ±ª®«¼ª® ¢ ¬ ±±¨¢¥ ½«¥¬¥­²®¢, ­¥ ¡®«¼¸¨µ x = A[p] (·¨±«® ² ª¨µ ½«¥¬¥­²®¢ ¬» ¡³¤¥¬
­ §»¢ ²¼ ° ­£®¬ (rank) ½«¥¬¥­²  x ¨ ®¡®§­ · ²¼ rank(x)). ±«¨
n = r ; p + 1 | ·¨±«® ½«¥¬¥­²®¢ ¢ ¬ ±±¨¢¥, ²®, ¯®±ª®«¼ª³ ¢±¥ ½«¥¬¥­²» ¨¬¥¾² ° ¢­»¥ ¸ ­±» ¯®¯ ±²¼ ­  ¬¥±²® A[p], ¢±¥ §­ ·¥­¨¿
rank(x), ®² 1 ¤® n, ° ¢­®¢¥°®¿²­» (¨¬¥¾² ¢¥°®¿²­®±²¼ 1=n).
±«¨ rank(x) > 1, ²®, ª ª «¥£ª® ¢¨¤¥²¼, ¯°¨ ° §¡¨¥­¨¨ «¥¢ ¿
· ±²¼ ¡³¤¥² ±®¤¥°¦ ²¼ rank(x) ; 1 ½«¥¬¥­²®¢ | ¢ ­¥© ®ª ¦³²±¿ ¢±¥
½«¥¬¥­²», ¬¥­¼¸¨¥ x. ±«¨ ¦¥ rank(x) = 1, ²® «¥¢ ¿ · ±²¼ ¡³¤¥²
±®¤¥°¦ ²¼ ®¤¨­ ½«¥¬¥­² (¯®±«¥ ¯¥°¢®£® ¦¥ ¢»¯®«­¥­¨¿ ¶¨ª«  ¡³¤¥²
i = j = p). ²±¾¤  ±«¥¤³¥², ·²® ± ¢¥°®¿²­®±²¼¾ 1=n «¥¢ ¿ · ±²¼
¡³¤¥² ±®¤¥°¦ ²¼ 2; 3; : : :; n ; 1 ½«¥¬¥­²®¢,   ± ¢¥°®¿²­®±²¼¾ 2=n |
®¤¨­ ½«¥¬¥­².
¥ª³°°¥­²­®¥ ±®®²­®¸¥­¨¥ ¤«¿ ±°¥¤­¥£® ¢°¥¬¥­¨ ° ¡®²»
¡®§­ ·¨¬ ±°¥¤­¥¥ ¢°¥¬¿ ° ¡®²»  «£®°¨²¬  RandomizedQuicksort ¤«¿ ¬ ±±¨¢  ¨§ n ½«¥¬¥­²®¢ ·¥°¥§ T (n). ±­®, ·²®

T (1) = (1). °¥¬¿ ° ¡®²» ±®±²®¨² ¨§ ¢°¥¬¥­¨ ° ¡®²» ¯°®¶¥¤³°»
Partition, ª®²®°®¥ ±®±² ¢«¿¥² (n), ¨ ¢°¥¬¥­¨ ° ¡®²» ¤«¿ ¤¢³µ
¬ ±±¨¢®¢ ° §¬¥°  q ¨ n ; q , ¯°¨·¥¬ q ± ¢¥°®¿²­®±²¼¾ 2=n ¯°¨­¨¬ ¥² §­ ·¥­¨¥ 1 ¨ ± ¢¥°®¿²­®±²¼¾ 1=n | §­ ·¥­¨¿ 2; : : :; n ; 1.

­ «¨§ ¡»±²°®© ±®°²¨°®¢ª¨

165

®½²®¬³
0

T (n) = n1 @T (1) + T (n ; 1) +

nX
;1
q=1

1

(T (q ) + T (n ; q ))A + (n) (8.2)

(±« £ ¥¬®¥, ±®®²¢¥²±²¢³¾¹¥¥ q = 1, ¢µ®¤¨² ¤¢ ¦¤»). ®±ª®«¼ª³
T (1) = (1) ¨ T (n) = O(n2), ¨¬¥¥¬
1 (T (1) + T (n ; 1)) = 1 ((1) + O(n2 )) = O(n):

n

n
®½²®¬³ ±« £ ¥¬»¥ T (1) ¨ T (n ; 1) ¢ ¯¥°¢®© ±ª®¡ª¥ (8.2) ¬®¦­®
¢ª«¾·¨²¼ ¢ (n).  ³·¥²®¬ ½²®£® ¯®«³· ¥¬
nX
;1

T (n) = n1

q=1

(T (q ) + T (n ; q )) + (n):

(8.3)

®±ª®«¼ª³ ª ¦¤®¥ ±« £ ¥¬®¥ T (k), £¤¥ k = 1; : : :; n ; 1, ¢±²°¥· ¥²±¿
¢ ±³¬¬¥ ¤¢ ¦¤», ¥¥ ¬®¦­® ¯¥°¥¯¨± ²¼ ² ª:

T (n) = n2

n;1
X
k=1

T (k) + (n):

(8.4)

¥¸¥­¨¥ °¥ª³°°¥­²­®£® ±®®²­®¸¥­¨¿
®®²­®¸¥­¨¥ (8.4) ¬®¦­® °¥¸¨²¼, ¨±¯®«¼§³¿ ¬¥²®¤ ¯®¤±² ­®¢ª¨.
°¥¤¯®«®¦¨¬, ·²® T (n) 6 an lg n + b, £¤¥ ª®­±² ­²» a > 0 ¨ b > 0
¯®ª  ­¥¨§¢¥±²­», ¨ ¯®¯»² ¥¬±¿ ¤®ª § ²¼ ½²® ¯® ¨­¤³ª¶¨¨. °¨
n = 1 ½²® ¢¥°­®, ¥±«¨ ¢§¿²¼ ¤®±² ²®·­® ¡®«¼¸¨¥ a ¨ b. °¨ n > 1
¨¬¥¥¬

T (n) = n2

6 n2

nX
;1
k=1
nX
;1

T (k) + (n)
(ak lg k + b) + (n)

k=1
nX
;1

= 2na

k=1

k lg k + 2nb (n ; 1) + (n):

¨¦¥ ¬» ¯®ª ¦¥¬, ·²® ¯¥°¢³¾ ±³¬¬³ ¬®¦­® ®¶¥­¨²¼ ² ª:
nX
;1
k=1

k lg k 6 12 n2 lg n ; 18 n2 :

(8.5)

166

« ¢  8 »±²° ¿ ±®°²¨°®¢ª 

±¯®«¼§³¿ ½²®, ¯®«³·¨¬


1
1
2
a
2
2
T (n) 6 n 2 n lg n ; 8 n + 2nb (n ; 1) + (n)
6 an lg n ; a4 n + 2b + (n)

= an lg n + b + (n) + b ; a4 n 6 an lg n + b;




¥±«¨ ¢»¡° ²¼ a ² ª, ·²®¡» a4 n ¡»«® ¡®«¼¸¥ (n)+ b. «¥¤®¢ ²¥«¼­®,
±°¥¤­¥¥ ¢°¥¬¿ ° ¡®²» ¥±²¼ O(n lg n).
®ª § ²¥«¼±²¢® ®¶¥­ª¨ ¤«¿ ±³¬¬»
±² «®±¼ ¤®ª § ²¼ ®¶¥­ª³ (8.5). ®±ª®«¼ª³ ª ¦¤®¥ ±« £ ¥¬®¥ ­¥
¯°¥¢»¸ ¥² n lg n, ¯®«³· ¥¬ ®¶¥­ª³
nX
;1

k lg k 6 n2 lg n:

k=1

«¿ ­ ¸¨µ ¶¥«¥© ®­  ­¥ ¯®¤µ®¤¨² | ­ ¬ ­¥®¡µ®¤¨¬  ¡®«¥¥ ²®·­ ¿
®¶¥­ª  12 n2 lg n ; 
(n2 ).
±«¨ ¢ ¯°¥¤»¤³¹¥© ®¶¥­ª¥ § ¬¥­¿²¼ «¨¸¼ lg k ­  lg n, ®±² ¢¨¢ k
¢ ­¥¯°¨ª®±­®¢¥­­®±²¨, ¯®«³·¨¬ ®¶¥­ª³
nX
;1
k=1

k lg k 6 lg n

nX
;1
k=1

k = n(n2; 1) lg n 6 12 n2 lg n:

±² «®±¼ «¨¸¼ § ¬¥²¨²¼, ·²® § ¬¥­¿¿ lg k ­  lg n, ¬» ¯°¨¡ ¢¨«¨
¯® ª° ©­¥© ¬¥°¥ ¯® k  1 ª ª ¦¤®¬³ ±« £ ¥¬®¬ ¯¥°¢®© ¯®«®¢¨­»
±³¬¬» (£¤¥ k 6 n=2), ¢±¥£® ¯°¨¬¥°­® (n=2)2=2 = n2 =8.
®«¥¥ ´®°¬ «¼­®,
nX
;1
k=1

k lg k =

dn=X
2e;1
k=1

k lg k +

nX
;1
k=dn=2e

k lg k

°¨ k < dn=2e ¨¬¥¥¬ lg k 6 lg(n=2) = lg n ; 1. ®½²®¬³
nX
;1
k=1

k lg k 6 (lg n ; 1)
= lg n

nX
;1
k=1

dn=X
2e;1

k;

k + lg n

k=1
dn=X
2e;1
k=1

6 12 n2 lg n ; 81 n2

nX
;1
k=dn=2e

k



k 6 12 n(n ; 1) lg n ; 12 n2 ; 1 n2

­ «¨§ ¡»±²°®© ±®°²¨°®¢ª¨

167

¯°¨ n > 2. ¶¥­ª  (8.5) ¤®ª § ­ .
[«¥¤³¾¹¨© ¯°®±²®© ¢»¢®¤ ®¶¥­ª¨ ¤«¿ ±°¥¤­¥£® ¢°¥¬¥­¨ ° ¡®²» ¢¥°®¿²­®±²­®£®  «£®°¨²¬  ¡»±²°®© ±®°²¨°®¢ª¨ (¤«¿ ­¥±ª®«¼ª®
¤°³£®£® ¢ °¨ ­²   «£®°¨²¬ ) ¯°¥¤«®¦¨« .. ¥¢¨­.
(1) ³¤¥¬ ¯°¥¤±² ¢«¿²¼ ±¥¡¥ ±®°²¨°®¢ª³ ² ª: ¥±²¼ N ª ¬­¥© ° §­®£® ¢¥±  ¨ · ¸¥·­»¥ ¢¥±» ¤«¿ ¨µ ±° ¢­¥­¨¿. » ¡¥°¥¬ ±«³· ©­»©
ª ¬¥­¼ ¨ ¤¥«¨¬ ¢±¾ ª³·³ ­  ²°¨ · ±²¨: «¥£·¥ ¥£®, ²¿¦¥«¥¥ ¥£® ¨ ®­
± ¬, ¯®±«¥ ·¥£® (°¥ª³°±¨¢­»© ¢»§®¢) ±®°²¨°³¥¬ ¯¥°¢³¾ ¨ ¢²®°³¾
· ±²¨.
(2)  ª ¢»¡° ²¼ ±«³· ©­»© ª ¬¥­¼? ®¦­® ±·¨² ²¼, ·²® ±­ · «  ¢±¥¬ ª ¬­¿¬ ±«³· ©­® ¯°¨±¢ ¨¢ ¾²±¿ ° §«¨·­»¥ ° ­£¨ (¡³¤¥¬
±·¨² ²¼ ¨µ ·¨±« ¬¨ ®² 1 ¤® N ), ¨ ¢ ª ·¥±²¢¥ £° ­¨¶» ¡¥°¥²±¿
ª ¬¥­¼ ¬¨­¨¬ «¼­®£® ° ­£  (¨§ ¯®¤«¥¦ ¹¨µ ±®°²¨°®¢ª¥ ¢ ¤ ­­»© ¬®¬¥­²). (®¦­® ¯°®¢¥°¨²¼, ·²® ½²® ° ¢­®±¨«¼­® ­¥§ ¢¨±¨¬»¬ ¢»¡®° ¬ ª ¬­¥© ­  ª ¦¤®¬ ¸ £¥: ­  ¯¥°¢®¬ ¸ £¥ ª ¦¤»© ¨§
ª ¬­¥© ¬®¦¥² ¡»²¼ ¢»¡° ­ ± ° ¢­®© ¢¥°®¿²­®±²¼¾, ¯®±«¥ ² ª®£®
¢»¡®°  ¢ ª ¦¤®© ¨§ £°³¯¯ ¢±¥ ª ¬­¨ ² ª¦¥ ° ¢­®¢¥°®¿²­» ¨ ². ¤.)
(3)  ª¨¬ ®¡° §®¬, ª ¦¤»© ª ¬¥­¼ µ ° ª²¥°¨§³¥²±¿ ¤¢³¬¿ ·¨±« ¬¨ ®² 1 ¤® N | ¯®°¿¤ª®¢»¬ ­®¬¥°®¬ (¢ ¯®°¿¤ª¥ ¢®§° ±² ­¨¿
¢¥±®¢) ¨ ° ­£®¬. ®®²¢¥²±²¢¨¥ ¬¥¦¤³ ­®¬¥° ¬¨ ¨ ° ­£ ¬¨ ®¯°¥¤¥«¿¥² ·¨±«® ®¯¥° ¶¨© ¢ ¯°®¶¥±±¥ ±®°²¨°®¢ª¨.
(4) «¿ ª ¦¤»µ ¤¢³µ ­®¬¥°®¢ i, j ¨§ f1; : : :; N g ·¥°¥§ p(i; j ) ®¡®§­ ·¨¬ ¢¥°®¿²­®±²¼ ²®£®, ·²® ª ¬­¨ ± ½²¨¬¨ ­®¬¥° ¬¨ ¡³¤³² ±° ¢­¨¢ ²¼±¿ ¤°³£ ± ¤°³£®¬.  ¯°¨¬¥°, p(i; i + 1) = 1, ¯®±ª®«¼ª³ ±®±¥¤­¨¥ ¯® ¢¥±³ ª ¬­¨ ¤®«¦­» ¡»²¼ ±° ¢­¥­» ®¡¿§ ²¥«¼­® (±° ¢­¥­¨¿
± ¤°³£¨¬¨ ª ¬­¿¬¨ ¨µ ­¥ ° §«¨· ¾²).
(5)  ¬¥²¨¬, ·²® p(i; i + 2) = 2=3.  ± ¬®¬ ¤¥«¥, ±° ¢­¥­¨¿ ­¥
¯°®¨§®©¤¥² ¢ ²®¬ ¨ ²®«¼ª® ²®¬ ±«³· ¥, ª®£¤  ¨§ ²°¥µ ª ¬­¥© ±
­®¬¥° ¬¨ i, i + 1 ¨ i + 2 ª ¬¥­¼ i + 1 ¨¬¥¥² ­ ¨¬¥­¼¸¨© ° ­£.
­ «®£¨·­®, p(i; i + k) = 2=(k + 1) (ª ¬­¨ ± ­®¬¥° ¬¨ i ¨ i + k
±° ¢­¨¢ ¾²±¿, ¥±«¨ ±°¥¤¨ k + 1 ª ¬­¥© i; i + 1; : : :; i + k ®¤¨­ ¨§
¤¢³µ ª° ©­¨µ ¨¬¥¥² ­ ¨¬¥­¼¸¨© ° ­£).
(6)  ²¥¬ ²¨·¥±ª®¥
®¦¨¤ ­¨¥ ·¨±«  ±° ¢­¥­¨© ¬®¦­® ° §¡¨²¼ ¢
P
±³¬¬³ m(i; j ) ®¦¨¤ ­¨© ·¨±«  ±° ¢­¥­¨© ¬¥¦¤³ ª ¬­¿¬¨ ± ­®¬¥° ¬¨ i ¨ j . ® ¯®±ª®«¼ª³ ¤¢  ¤ ­­»µ ª ¬­¿ ±° ¢­¨¢ ¾²±¿ ­¥ ¡®«¥¥
®¤­®£® ° § , m(i; j ) = p(i; j ).  ª¨¬ ®¡° §®¬, ¯®«³· ¥¬ ²®·­®¥ ¢»° ¦¥­¨¥ ¤«¿ ¬ ²¥¬ ²¨·¥±ª®£® ®¦¨¤ ­¨¿ ·¨±«  ±° ¢­¥­¨©:
X
2 :
16i<j 6n j ; i + 1
(7) °³¯¯¨°³¿ ¢ ½²®© ±³¬¬¥ ° ¢­»¥ ·«¥­» ¨ ¢±¯®¬¨­ ¿, ·²® 1 +
1=2 + 1=3 + : : : + 1=k = O(lg k), ¯®«³· ¥¬ ®¶¥­ª³ O(N lg N ) ¤«¿
¬ ²¥¬ ²¨·¥±ª®£® ®¦¨¤ ­¨¿ ¢°¥¬¥­¨ ° ¡®²» ¡»±²°®© ±®°²¨°®¢ª¨.
­ «¨§ ®¡«¥£· ¥²±¿ ²¥¬, ·²®  «£®°¨²¬ ° §¡¨¥­¨¿ (­  ²°¨ · ±²¨)
¡®«¥¥ ±¨¬¬¥²°¨·¥­. ¥ «¨§ ¶¨¿ ² ª®£® ±¯®±®¡  ° §¡¨¥­¨¿ ² ª¦¥

168

« ¢  8 »±²° ¿ ±®°²¨°®¢ª 

¯°®±² : ¬ ±±¨¢ ¤¥«¨²±¿ ­  ·¥²»°¥ ³· ±²ª  (¯¥°¥·¨±«¿¥¬ ¨µ ±«¥¢ 
­ ¯° ¢®): ¬¥­¼¸¨¥ £° ­¨¶», ° ¢­»¥ £° ­¨¶¥, ­¥¯°®±¬®²°¥­­»¥ ¨
¡®«¼¸¨¥ £° ­¨¶».]
¯° ¦­¥­¨¿
8.4-1 ®ª ¦¨²¥, ·²® ­ ¨¬¥­¼¸¥¥ ¢°¥¬¿ ° ¡®²» ¡»±²°®© ±®°²¨°®¢ª¨ ±®±² ¢«¿¥² 
(n lg n).
8.4-2 ®ª ¦¨²¥, ·²® ´³­ª¶¨¿ q 2 + (n ; q )2 ­  ®²°¥§ª¥ [1; n ; 1]
¯°¨­¨¬ ¥² ­ ¨¡®«¼¸¥¥ §­ ·¥­¨¥ ¢ ª®­¶ µ ®²°¥§ª .
8.4-3 ®ª ¦¨²¥, ·²® ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ¢°¥¬¥­¨ ° ¡®²»
¯°®¶¥¤³°» Randomized-Quicksort ­  «¾¡®¬ ¢µ®¤¥ ¥±²¼ 
(n lg n).
8.4-4   ¯° ª²¨ª¥ ¢°¥¬¿ ° ¡®²» ¡»±²°®© ±®°²¨°®¢ª¨ ¬®¦­® ³¬¥­¼¸¨²¼, ¥±«¨ ­  § ¢¥°¸ ¾¹¥¬ ½² ¯¥ (ª®£¤  ¬ ±±¨¢ ¯®·²¨ ®²±®°²¨°®¢ ­) ¨±¯®«¼§®¢ ²¼ ±®°²¨°®¢ª³ ¢±² ¢ª ¬¨. ¤¥« ²¼ ½²® ¬®¦­®, ­ ¯°¨¬¥°, ² ª: ¯³±²¼ ¯°®¶¥¤³° 
Randomized-Quicksort(A; p; r) ­¨·¥£® ­¥ ¤¥« ¥², ¥±«¨ r ; p +1 < k
(². ¥. ±®°²¨°³¥¬»© ¬ ±±¨¢ ±®¤¥°¦¨² ¬¥­¼¸¥ k ½«¥¬¥­²®¢). ®±«¥
®ª®­· ­¨¿ °¥ª³°±¨¢­»µ ¢»§®¢®¢ ¯®«³·¨¢¸¨©±¿ ¬ ±±¨¢ ±®°²¨°³¥²±¿ ± ¯®¬®¹¼¾ ±®°²¨°®¢ª¨ ¢±² ¢ª ¬¨. ®ª ¦¨²¥, ·²® ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ¢°¥¬¥­¨ ° ¡®²» ² ª®£®  «£®°¨²¬  ±®±² ¢«¿¥²
O(nk + n lg(n=k)).  ª ¡» ¢» ±² «¨ ¢»¡¨° ²¼ ·¨±«® k?
8.4-5? ®ª ¦¨²¥ ° ¢¥­±²¢®
Z

x ln x dx = 12 x2 ln x ; 41 x2

»¢¥¤¨²¥ ®²±¾¤  (¨±¯®«¼§³¿ ¬¥²®¤ ±° ¢­¥­¨¿ ± ¨­²¥£° «®¬)
¡®«¥¥
P ;1
±¨«¼­³¾ (¢ ±° ¢­¥­¨¨ ± (8.5)) ®¶¥­ª³ ¤«¿ ±³¬¬» nk=1
k lg k.
8.4-6?  ±±¬®²°¨¬ ±«¥¤³¾¹³¾ ¬®¤¨´¨ª ¶¨¾ ¯°®¶¥¤³°»
Randomized-Partition: ±«³· ©­»¬ ®¡° §®¬ ¢»¡¨° ¾²±¿ ²°¨
½«¥¬¥­²  ¬ ±±¨¢  ¨ ¢ ª ·¥±²¢¥ £° ­¨·­®£® ½«¥¬¥­²  ¡¥°¥²±¿ ±°¥¤­¨© ¯® ¢¥«¨·¨­¥ ¨§ ¢»¡° ­­»µ ²°¥µ ª ¬­¥©. ¶¥­¨²¥ ¢¥°®¿²­®±²¼
²®£®, ·²® ¯°¨ ½²®¬ ° §¡¨¥­¨¥ ¡³¤¥² ±¡ « ­±¨°®¢ ­® ­¥ µ³¦¥, ·¥¬
 : 1 ; .

 ¤ ·¨
8-1 ° ¢¨«¼­®±²¼ ¯°®¶¥¤³°» ° §¡¨¥­¨¿
®ª ¦¨²¥, ·²® ¯°®¶¥¤³°  Partition ° ¡®² ¥² ¯° ¢¨«¼­®. «¿
½²®£® ¤®ª ¦¨²¥ ±«¥¤³¾¹¥¥:

 ¤ ·¨ ª £« ¢¥ 8

169

 .  ¯°®¶¥±±¥ ° ¡®²» ¯°®¶¥¤³°» ¨­¤¥ª±» i ¨ j ­¥ ¢»µ®¤¿² § 
¯°¥¤¥«» ®²°¥§ª  [p : :r].
¡.  ¬®¬¥­² ®ª®­· ­¨¿ ° ¡®²» ¯°®¶¥¤³°» ¨­¤¥ª± j ­¥ ¬®¦¥²
¡»²¼ ° ¢¥­ r (². ¥. ®¡¥ · ±²¨ ° §¡¨¥­¨¿ ­¥¯³±²»).
¢.  ¬®¬¥­² ®ª®­· ­¨¿ ° ¡®²» ¯°®¶¥¤³°» «¾¡®© ½«¥¬¥­² ¬ ±±¨¢  A[p : :j ] ­¥ ¡®«¼¸¥ «¾¡®£® ½«¥¬¥­²  ¬ ±±¨¢  A[j + 1 : :r].
8-2 «£®°¨²¬ ®¬³²® ¤«¿ ° §¡¨¥­¨¿
 °¨ ­² ¯°®¶¥¤³°» Partition, ª®²®°»© ¬» ±¥©· ± ° ±±¬®²°¨¬,
¯°¨­ ¤«¥¦¨² . ®¬³²® (N. Lomuto).  ¯°®¶¥±±¥ ° ¡®²» ±²°®¿²±¿ ª³±ª¨ A[p : :i] ¨ A[i + 1 : :j ], ¯°¨·¥¬ ½«¥¬¥­²» ¯¥°¢®£® ª³±ª  ­¥
¡®«¼¸¥ x = A[r],   ½«¥¬¥­²» ¢²®°®£® ª³±ª  | ¡®«¼¸¥ x.
Lomuto-Partition(A; p; r)
1 x A[r]
2 i p;1
3 for j p to r
4
do if A[j ] 6 x
5
then i i + 1
6
¯®¬¥­¿²¼ A[i] $ A[j ]
7 if i < r
8 then return i
9 else return i ; 1
 . ®ª ¦¨²¥, ·²® ¯°®¶¥¤³°  Lomuto-Partition ° ¡®² ¥² ¯° ¢¨«¼­®.
¡. ª®«¼ª® ° § ¯°®¶¥¤³°» Partition ¨ Lomuto-Partition ¬®£³² ¯¥°¥¬¥¹ ²¼ ®¤¨­ ¨ ²®² ¦¥ ½«¥¬¥­²? (ª ¦¨²¥ ­ ¨¡®«¼¸¨¥ §­ ·¥­¨¿.)
¢. ®ª ¦¨²¥, ·²® ¯°®¶¥¤³°  Lomuto-Partition, ª ª ¨ ¯°®¶¥¤³°  Partition, ²°¥¡³¥² ¢°¥¬¥­¨ (n), £¤¥ n | ·¨±«® ½«¥¬¥­²®¢ ¢
¬ ±±¨¢¥.
£.  ¬¥­¨¬ ¢ ²¥ª±²¥ ¯°®¶¥¤³°» Quicksort ¯°®¶¥¤³°³ Partition
­  Lomuto-Partition.  ª ¨§¬¥­¨²±¿ ¢°¥¬¿ ¡»±²°®© ±®°²¨°®¢ª¨
¤«¿ ¬ ±±¨¢ , ¢±¥ ½«¥¬¥­²» ª®²®°®£® ° ¢­»?
¤.  ±±¬®²°¨¬ ¯°®¶¥¤³°³ Randomized-Lomuto-Partition,
ª®²®° ¿ ¬¥­¿¥² A[r] ±® ±«³· ©­® ¢»¡° ­­»¬ ½«¥¬¥­²®¬ ¬ ±±¨¢  ¨ § ²¥¬ ¢»§»¢ ¥² ¯°®¶¥¤³°³ Lomuto-Partition. ®ª ¦¨²¥,
·²® ¢¥°®¿²­®±²¼ ²®£®, ·²® ¯°®¶¥¤³°  Randomized-LomutoPartition ¢¥°­¥² §­ ·¥­¨¥ q , ° ¢­  ¢¥°®¿²­®±²¨ ²®£®, ·²® ¯°®¶¥¤³°  Randomized-Partition ¢¥°­¥² §­ ·¥­¨¥ p + r ; q .
8-3 ®°²¨°®¢ª  ¯® · ±²¿¬
°®´¥±±®° ¯°¥¤«®¦¨« ±«¥¤³¾¹¨© À¯°®¤¢¨­³²»©Á  «£®°¨²¬ ±®°²¨°®¢ª¨:

170

« ¢  8 »±²° ¿ ±®°²¨°®¢ª 

Stooge-Sort(A; i; j )

if A[i] > A[j ]
then ¯®¬¥­¿²¼ A[i] $ A[j ]
if i + 1 > j
then return
k b(j ; i + 1)=3c
. ª°³£«¥­¨¥ ± ­¥¤®±² ²ª®¬.
Stooge-Sort(A; i; j ; k) . ¥°¢»¥ ¤¢¥ ²°¥²¨.
Stooge-Sort(A; i + k; j ) . ®±«¥¤­¨¥ ¤¢¥ ²°¥²¨.
Stooge-Sort(A; i; j ; k) . ¯¿²¼ ¯¥°¢»¥ ¤¢¥ ²°¥²¨.
 . ®ª ¦¨²¥, ·²® ¯°®¶¥¤³°  Stooge-Sort ¤¥©±²¢¨²¥«¼­® ±®°²¨°³¥² ¬ ±±¨¢.
¡.  ©¤¨²¥ °¥ª³°°¥­²­®¥ ±®®²­®¸¥­¨¥ ¤«¿ ­ ¨¡®«¼¸¥£® ¢°¥¬¥­¨
° ¡®²» ¯°®¶¥¤³°» Stooge-Sort ¨ ¯®«³·¨²¥ ¨§ ­¥£® ®¶¥­ª³ ½²®£®
¢°¥¬¥­¨.
¢. ° ¢­¨²¥ ­ ¨¡®«¼¸¥¥ ¢°¥¬¿ ° ¡®²» ¯°®¶¥¤³°» Stooge-Sort
± ­ ¨¡®«¼¸¨¬ ¢°¥¬¥­¥¬ ¤«¿ ¤°³£¨µ ¢ °¨ ­²®¢ ±®°²¨°®¢ª¨ (¢±² ¢ª ¬¨, ±«¨¿­¨¥¬, ± ¯®¬®¹¼¾ ª³·¨ ¨ ¡»±²°®© ±®°²¨°®¢ª¨). ²®¨²
«¨ ¯°®¤«¥¢ ²¼ ª®­²° ª² ± ¯°®´¥±±®°®¬?
1
2
3
4
5
6
7
8

8-4  §¬¥° ±²¥ª  ¯°¨ ¡»±²°®© ±®°²¨°®¢ª¥
°®¶¥¤³°  Quicksort ¤¢  ° §  °¥ª³°±¨¢­® ¢»§»¢ ¥² ±¥¡¿ (¤«¿
«¥¢®© ¨ ¤«¿ ¯° ¢®© · ±²¨).  ¤¥©±²¢¨²¥«¼­®±²¨ ¡¥§ ¢²®°®£® °¥ª³°±¨¢­®£® ¢»§®¢  ¬®¦­® ®¡®©²¨±¼, § ¬¥­¨¢ ¥£® ¶¨ª«®¬ (¨¬¥­­® ² ª
µ®°®¸¨¥ ª®¬¯¨«¿²®°» ®¡° ¡ ²»¢ ¾² ±¨²³ ¶¨¾, ª®£¤  ¯®±«¥¤­¨¬
®¯¥° ²®°®¬ ¯°®¶¥¤³°» ¿¢«¿¥²±¿ °¥ª³°±¨¢­»© ¢»§®¢; ¤«¿ ² ª®© ±¨²³ ¶¨¨ ¥±²¼ ²¥°¬¨­ tail recursion):
Quicksort0 (A; p; r)
1 while p < r
2
do .  §¡¨²¼ ¨ ®²±®°²¨°®¢ ²¼ «¥¢³¾ · ±²¼.
3
q Partition(A; p; r)
4
Quicksort0(A; p; q )
5
p q+1
 . ®ª ¦¨²¥, ·²® ¯°®¶¥¤³°  Quicksort0 ¤¥©±²¢¨²¥«¼­® ±®°²¨°³¥² ¬ ±±¨¢.
 ª ¯° ¢¨«®, ª®¬¯¨«¿²®°» °¥ «¨§³¾² °¥ª³°±¨¾ ± ¯®¬®¹¼¾ ±²¥ª , £¤¥ µ° ­¿²±¿ ª®¯¨¨ «®ª «¼­»µ ¯¥°¥¬¥­­»µ ¤«¿ ª ¦¤®£® °¥ª³°±¨¢­®£® ¢»§®¢ . ¥°¸¨­  ±²¥ª  ±®¤¥°¦¨² ¨­´®°¬ ¶¨¾, ®²­®±¿¹³¾±¿ ª ²¥ª³¹¥¬³ ¢»§®¢³; ª®£¤  ®­ § ¢¥°¸ ¥²±¿, ¨­´®°¬ ¶¨¿ ³¤ «¿¥²±¿ ¨§ ±²¥ª .  ­ ¸¥¬ ±«³· ¥ ¤«¿ ª ¦¤®£® °¥ª³°±¨¢­®£® ¢»§®¢ 
«®ª «¼­»¥ ¯¥°¥¬¥­­»¥ § ­¨¬ ¾² ®¡º¥¬ O(1), ² ª ·²® ­¥®¡µ®¤¨¬»© ° §¬¥° ±²¥ª  (stack depth) ¯°®¯®°¶¨®­ «¥­ £«³¡¨­¥ °¥ª³°±¨¨.
¡. ®ª ¦¨²¥, ·²® ¢ ­¥ª®²®°»µ ±«³· ¿µ ¯°®¶¥¤³°  Quicksort0
²°¥¡³¥² ±²¥ª  ° §¬¥°  (n).

 ¬¥· ­¨¿ ª £« ¢¥ 8

171

¢. §¬¥­¨²¥ ¯°®¶¥¤³°³ Quicksort0 ² ª, ·²®¡» ®¡º¥¬ ±²¥ª  ­¥
¯°¥¢»¸ « (lg n) (±®µ° ­¿¿ ®¶¥­ª³ (n lg n) ¤«¿ ±°¥¤­¥£® ¢°¥¬¥­¨
° ¡®²»).
8-5  §¡¨¥­¨¥ ± ¯®¬®¹¼¾ ¬¥¤¨ ­» ²°¥µ ½«¥¬¥­²®¢
 ¡®²³ ¯°®¶¥¤³°» Randomized-Quicksort ¬®¦­® ³±ª®°¨²¼,
¢»¡¨° ¿ £° ­¨·­»© ½«¥¬¥­² ¤«¿ ° §¡¨¥­¨¿ ¡®«¥¥ ²¹ ²¥«¼­®.
¤¨­ ¨§ ° ±¯°®±²° ­¥­­»µ ¯®¤µ®¤®¢ | ½²® ¬¥²®¤ ¬¥¤¨ ­» ²°¥µ
(median-of-3 method): ¢ ª ·¥±²¢¥ £° ­¨·­®£® ½«¥¬¥­²  ¨±¯®«¼§³¥²±¿ ±°¥¤­¨© ¨§ ²°¥µ ±«³· ©­® ¢»¡° ­­»µ ½«¥¬¥­²®¢ ¬ ±±¨¢ .
» ¡³¤¥¬ ¯°¥¤¯®« £ ²¼, ·²® ¢±¥ ½«¥¬¥­²» ¢µ®¤­®£® ¬ ±±¨¢ 
A[1 : :n] ° §«¨·­» ¨ n > 3. ¥°¥§ A0[1 : :n] ¡³¤¥¬ ®¡®§­ · ²¼ ®²±®°²¨°®¢ ­­»© ¬ ±±¨¢ (ª®²®°»© ¬» ¨ µ®²¨¬ ¯®«³·¨²¼). ³±²¼
pi = Pfx = A0 [i]g, £¤¥ x | £° ­¨·­»© ½«¥¬¥­², ¢»¡° ­­»©
®¯¨± ­­»¬ ¢»¸¥ ±¯®±®¡®¬.
 . »° §¨²¥ ¢¥°®¿²­®±²¼ pi (¤«¿ i = 2; 3; : : :; n ; 1) ·¥°¥§ i ¨ n
(§ ¬¥²¼²¥, ·²® p1 = pn = 0).
¡.  ±ª®«¼ª® ¢¥°®¿²­®±²¼ ¢»¡° ²¼ ±°¥¤­¨© ½«¥¬¥­² (A0 [b(n +
1)=2c]) ¡®«¼¸¥, ·¥¬ ¯°¨ ®¡»·­®¬ ±«³· ©­®¬ ¢»¡®°¥?  ·¥¬³ ±²°¥¬¨²±¿ ®²­®¸¥­¨¥ ½²¨µ ¢¥°®¿²­®±²¥© ¯°¨ n ! 1?
¢. ³¤¥¬ ­ §»¢ ²¼ ° §¡¨¥­¨¥ ± £° ­¨·­»¬ ½«¥¬¥­²®¬ x Àµ®°®¸¨¬Á, ¥±«¨ x = A0 [i], £¤¥ n=3 6 i 6 2n=3.  ±ª®«¼ª® ¢¥°®¿²­®±²¼
Àµ®°®¸¥£®Á ° §¡¨¥­¨¿ ¡®«¼¸¥, ·¥¬ ¯°¨ ®¡»·­®¬ ±«³· ©­®¬ ¢»¡®°¥? (ª § ­¨¥: ¯°¨ ¢»·¨±«¥­¨¿µ ®¶¥­¨²¥ ±³¬¬³ ¨­²¥£° «®¬.)
£. ®ª ¦¨²¥, ·²® ¨±¯®«¼§®¢ ­¨¥ ¬¥²®¤  ¬¥¤¨ ­» ²°¥µ ±®µ° ­¿¥²
®¶¥­ª³ 
(n lg n) ¤«¿ ¢°¥¬¥­¨ ° ¡®²» ¡»±²°®© ±®°²¨°®¢ª¨ (¨ ¢«¨¿¥²
«¨¸¼ ­  ª®­±² ­²³ ¯¥°¥¤ n lg n).

 ¬¥· ­¨¿
«£®°¨²¬ ¡»±²°®© ±®°²¨°®¢ª¨ ¯°¨­ ¤«¥¦¨² ® °³ [98].  ±² ²¼¥ ¥¤¦¢¨ª  [174] ®¡±³¦¤ ¾²±¿ ¤¥² «¨ °¥ «¨§ ¶¨¨ ¡»±²°®© ±®°²¨°®¢ª¨ ¨ ¨µ ¢«¨¿­¨¥ ­  ¢°¥¬¿ ° ¡®²». ¥°®¿²­®±²­»¥  «£®°¨²¬»
¤«¿ ° §­»µ § ¤ · ° ±±¬ ²°¨¢ ¾²±¿ ¢ ±² ²¼¥  ¡¨­  [165].

9

®°²¨°®¢ª  §  «¨­¥©­®¥ ¢°¥¬¿

» ¯®§­ ª®¬¨«¨±¼ ± ° §«¨·­»¬¨  «£®°¨²¬ ¬¨, ª®²®°»¥ ¬®£³² ®²±®°²¨°®¢ ²¼ n ·¨±¥« §  ¢°¥¬¿ O(n lg n). «£®°¨²¬» ±®°²¨°®¢ª¨
±«¨¿­¨¥¬ (merge sort) ¨ ±®°²¨°®¢ª¨ ± ¯®¬®¹¼¾ ª³·¨ (heap sort)
° ¡®² ¾² §  ² ª®¥ ¢°¥¬¿ ¢ µ³¤¸¥¬ ±«³· ¥,   ³  «£®°¨²¬  ¡»±²°®© ±®°²¨°®¢ª¨ ² ª®¢»¬ ¿¢«¿¥²±¿ ±°¥¤­¥¥ ¢°¥¬¿ ° ¡®²». ¶¥­ª  O(n lg n) ²®·­ : ¤«¿ ª ¦¤®£® ¨§ ½²¨µ  «£®°¨²¬®¢ ¬®¦­® ¯°¥¤º¿¢¨²¼ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¨§ n ·¨±¥«, ¢°¥¬¿ ®¡° ¡®²ª¨ ª®²®°®©
¡³¤¥² 
(n lg n).
±¥ ³¯®¬¿­³²»¥  «£®°¨²¬» ¯°®¢®¤¿² ±®°²¨°®¢ª³, ®±­®¢»¢ ¿±¼
¨±ª«¾·¨²¥«¼­® ­  ¯®¯ °­»µ ±° ¢­¥­¨¿µ ½«¥¬¥­²®¢, ¯®½²®¬³ ¨µ
¨­®£¤  ­ §»¢ ¾² ±®°²¨°®¢ª ¬¨ ±° ¢­¥­¨¥¬ (comparison sort). 
° §¤¥«¥ 9.1 ¬» ¯®ª ¦¥¬, ·²® ¢±¿ª¨©  «£®°¨²¬ ² ª®£® ²¨¯  ±®°²¨°³¥² n ½«¥¬¥­²®¢ §  ¢°¥¬¿ ­¥ ¬¥­¼¸¥ 
(n lg n) ¢ µ³¤¸¥¬ ±«³· ¥.
¥¬ ± ¬»¬  «£®°¨²¬» ±®°²¨°®¢ª¨ ±«¨¿­¨¥¬ ¨ ± ¯®¬®¹¼¾ ª³·¨
 ±¨¬¯²®²¨·¥±ª¨ ®¯²¨¬ «¼­»: ­¥ ±³¹¥±²¢³¥²  «£®°¨²¬  ±®°²¨°®¢ª¨ ±° ¢­¥­¨¥¬, ª®²®°»© ¯°¥¢®±µ®¤¨« ¡» ³ª § ­­»¥  «£®°¨²¬» ¡®«¥¥, ·¥¬ ¢ ª®­¥·­®¥ ·¨±«® ° §.
 ° §¤¥« µ 9.2, 9.3 ¨ 9.4 ¬» ° ±±¬ ²°¨¢ ¥¬ ²°¨  «£®°¨²¬  ±®°²¨°®¢ª¨ (±®°²¨°®¢ª  ¯®¤±·¥²®¬, ¶¨´°®¢ ¿ ±®°²¨°®¢ª  ¨ ±®°²¨°®¢ª 
¢»·¥°¯»¢ ­¨¥¬), ° ¡®² ¾¹¨µ §  «¨­¥©­®¥ ¢°¥¬¿.  §³¬¥¥²±¿, ®­¨
³«³·¸ ¾² ®¶¥­ª³ 
(n lg n) §  ±·¥² ²®£®, ·²® ¨±¯®«¼§³¾² ­¥ ²®«¼ª® ¯®¯ °­»¥ ±° ¢­¥­¨¿, ­® ¨ ¢­³²°¥­­¾¾ ±²°³ª²³°³ ±®°²¨°³¥¬»µ
®¡º¥ª²®¢.

9.1. ¨¦­¨¥ ®¶¥­ª¨ ¤«¿ ±®°²¨°®¢ª¨
®¢®°¿², ·²®  «£®°¨²¬ ±®°²¨°®¢ª¨ ®±­®¢ ­ ­  ±° ¢­¥­¨¿µ, ¥±«¨ ®­ ­¨ª ª ­¥ ¨±¯®«¼§³¥² ¢­³²°¥­­¾¾ ±²°³ª²³°³ ±®°²¨°³¥¬»µ
½«¥¬¥­²®¢,   «¨¸¼ ±° ¢­¨¢ ¥² ¨µ ¨ ¯®±«¥ ­¥ª®²®°®£® ·¨±«  ±° ¢­¥­¨© ¢»¤ ¥² ®²¢¥² (³ª §»¢ ¾¹¨© ¨±²¨­­»© ¯®°¿¤®ª ½«¥¬¥­²®¢).
 ª ¬» ¯°¨µ®¤¨¬ ª ¬®¤¥«¨  «£®°¨²¬®¢ ±®°²¨°®¢ª¨, ­ §»¢ ¥¬®©
° §°¥¸ ¾¹¨¬¨ ¤¥°¥¢¼¿¬¨.

¨¦­¨¥ ®¶¥­ª¨ ¤«¿ ±®°²¨°®¢ª¨

173

 §°¥¸ ¾¹¥¥ ¤¥°¥¢® ¤«¿  «£®°¨²¬  ±®°²¨°®¢ª¨ ¢±² ¢ª ¬¨, ®¡° ¡ ²»¢ ¾¹¥£® ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¨§ ²°¥µ ½«¥¬¥­²®¢. ®±ª®«¼ª³ ·¨±«® ¯¥°¥±² ­®¢®ª ¨§ ²°¥µ ½«¥¬¥­²®¢ ° ¢­® 3! = 6, ³ ¤¥°¥¢  ¤®«¦­® ¡»²¼ ­¥ ¬¥­¥¥ 6 «¨±²¼¥¢.
¨±. 9.1

 §°¥¸ ¾¹¨¥ ¤¥°¥¢¼¿
 ·­¥¬ ± ¯°¨¬¥° : ­  °¨±. 9.1 ¨§®¡° ¦¥­® ° §°¥¸ ¾¹¥¥ ¤¥°¥¢®
(decision tree), ±®®²¢¥²±²¢³¾¹¥¥ ±®°²¨°®¢ª¥ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¨§
²°¥µ ½«¥¬¥­²®¢ ± ¯®¬®¹¼¾  «£®°¨²¬  ±®°²¨°®¢ª¨ ¢±² ¢ª ¬¨ ¨§
° §¤¥«  1.1.
³±²¼ ²¥¯¥°¼ ¬» ±®°²¨°³¥¬ n ½«¥¬¥­²®¢ a1 ; : : :; an .  ¦¤ ¿ ¢­³²°¥­­¿¿ ¢¥°¸¨­  ° §°¥¸ ¾¹¥£® ¤¥°¥¢  ±®®²¢¥²±²¢³¥² ®¯¥° ¶¨¨
±° ¢­¥­¨¿ ¨ ±­ ¡¦¥­  ¯®¬¥²ª®© ¢¨¤  ai : aj , ³ª §»¢ ¾¹¥©, ª ª¨¥
½«¥¬¥­²» ­ ¤® ±° ¢­¨²¼ (1 6 i; j 6 n).  ¦¤»© «¨±² ° §°¥¸ ¾¹¥£® ¤¥°¥¢  ±­ ¡¦¥­ ¯®¬¥²ª®© h (1);  (2); : : :;  (n)i, £¤¥  | ¯¥°¥±² ­®¢ª  n ½«¥¬¥­²®¢ (±¬. ° §¤. 6.1 ¯® ¯®¢®¤³ ¯¥°¥±² ­®¢®ª). «¿
¯®«³·¥­¨¿ ­¨¦­¨µ ®¶¥­®ª ¬» ¬®¦¥¬ ®£° ­¨·¨²¼±¿ ±«³· ¥¬ ° §«¨·­»µ ½«¥¬¥­²®¢, ²®£¤  °¥§³«¼² ²®¬ ±®°²¨°®¢ª¨ ¡³¤¥² ¯¥°¥±² ­®¢ª 
½«¥¬¥­²®¢ ¢ ¯®°¿¤ª¥ ¢®§° ±² ­¨¿.
¯¨¸¥¬, ª ª®©  «£®°¨²¬ ±®°²¨°®¢ª¨ ±®®²¢¥²±²¢³¥² ¤ ­­®¬³
° §°¥¸ ¾¹¥¬³ ¤¥°¥¢³.  ¤® ¯°®©²¨ ¯® ¤¥°¥¢³ ®² ª®°­¿ ¤® «¨±² .
»¡®° ­ ¯° ¢«¥­¨¿ (­ «¥¢® ¨«¨ ­ ¯° ¢®) ¯°®¨±µ®¤¨² ² ª. ³±²¼ ¢
¢¥°¸¨­¥ ­ ¯¨± ­® ai : aj . ®£¤  ­ ¤® ¨¤²¨ ­ «¥¢®, ¥±«¨ ai 6 aj , ¨
­ ¯° ¢® ¢ ¯°®²¨¢­®¬ ±«³· ¥. ±«¨ ¢ «¨±²¥, ¢ ª®²®°»© ¬» ¢ ¨²®£¥
¯°¨µ®¤¨¬, § ¯¨± ­  ¯¥°¥±² ­®¢ª   , ²® °¥§³«¼² ²®¬ ±®°²¨°®¢ª¨
±·¨² ¥¬ ¯®±«¥¤®¢ ²¥«¼­®±²¼ a(1); a(2); : : :; a(n) , ª®²®° ¿ ¤®«¦­ 
¡»²¼ ­¥³¡»¢ ¾¹¥©, ¥±«¨  «£®°¨²¬ ¯° ¢¨«¥­.
 ¦¤ ¿ ¨§ n! ¯¥°¥±² ­®¢®ª ¤®«¦­  ¯®¿¢¨²¼±¿ µ®²¿ ¡» ­  ®¤­®¬
«¨±²¥ ° §°¥¸ ¾¹¥£® ¤¥°¥¢  (¯®±ª®«¼ª³ ¯° ¢¨«¼­»©  «£®°¨²¬ ¤®«¦¥­ ¯°¥¤³±¬ ²°¨¢ ²¼ ¢±¥ ¢®§¬®¦­»¥ ¯®°¿¤ª¨).
¨¦­¿¿ ®¶¥­ª  ¤«¿ µ³¤¸¥£® ±«³· ¿
¨±«® ±° ¢­¥­¨© ¢ µ³¤¸¥¬ ±«³· ¥ ¤«¿ ² ª®£®  «£®°¨²¬  ° ¢­®
¢»±®²¥ ° §°¥¸ ¾¹¥£® ¤¥°¥¢  | ¬ ª±¨¬ «¼­®© ¤«¨­¥ ¯³²¨ ¢ ½²®¬
¤¥°¥¢¥ ®² ª®°­¿ ¤® «¨±² . «¥¤³¾¹ ¿ ²¥®°¥¬  ¤ ¥² ­¨¦­¾¾ ®¶¥­ª³
­  ½²³ ¢»±®²³.

174

« ¢  9 ®°²¨°®¢ª  §  «¨­¥©­®¥ ¢°¥¬¿

¥®°¥¬  9.1. »±®²  «¾¡®£® ° §°¥¸ ¾¹¥£® ¤¥°¥¢ , ±®°²¨°³¾¹¥£® n ½«¥¬¥­²®¢, ¥±²¼ 
(n lg n).
®ª § ²¥«¼±²¢®. ®±ª®«¼ª³ ±°¥¤¨ «¨±²¼¥¢ ° §°¥¸ ¾¹¥£® ¤¥°¥¢ 
¤®«¦­» ¡»²¼ ¯°¥¤±² ¢«¥­» ¢±¥ ¯¥°¥±² ­®¢ª¨ n ½«¥¬¥­²®¢, ·¨±«®
½²¨µ «¨±²¼¥¢ ­¥ ¬¥­¥¥ n!. ®±ª®«¼ª³ ¤¢®¨·­®¥ ¤¥°¥¢® ¢»±®²» h
¨¬¥¥² ­¥ ¡®«¥¥ 2h «¨±²¼¥¢, ¨¬¥¥¬ n! 6 2h . ®£ °¨´¬¨°³¿ ½²® ­¥° ¢¥­±²¢® ¯® ®±­®¢ ­¨¾ 2 ¨ ¯®«¼§³¿±¼ ­¥° ¢¥­±²¢®¬ n! > (n=e)n ,
¢»²¥ª ¾¹¨¬ ¨§ ´®°¬³«» ²¨°«¨­£  (2.11), ¯®«³· ¥¬, ·²®
h > n lg n ; n lg e = 
(n lg n);
·²® ¨ ³²¢¥°¦¤ «®±¼.
«¥¤±²¢¨¥ 9.2. «£®°¨²¬» ±®°²¨°®¢ª¨ ±«¨¿­¨¥¬ ¨ ± ¯®¬®¹¼¾ ª³·¨  ±¨¬¯²®²¨·¥±ª¨ ®¯²¨¬ «¼­».
®ª § ²¥«¼±²¢®. ­¨ ° ¡®² ¾² §  ¢°¥¬¿ O(n lg n); ¢ ±¨«³ ¤®ª § ­­®© ²¥®°¥¬», ½²  ®¶¥­ª   ±¨¬¯²®²¨·¥±ª¨ ­¥³«³·¸ ¥¬ .
¯° ¦­¥­¨¿
9.1-1  ª®¢  ­ ¨¬¥­¼¸ ¿ ¢®§¬®¦­ ¿ £«³¡¨­  «¨±²  ¢ ° §°¥¸ ¾¹¥¬ ¤¥°¥¢¥  «£®°¨²¬  ±®°²¨°®¢ª¨?
9.1-2
®ª ¦¨²¥  ±¨¬¯²®²¨·¥±ª¨ ²®·­³¾ ®¶¥­ª³ ¤«¿ lg(n!) =
Pn
lg
k=1 k ¡¥§ ´®°¬³«» ²¨°«¨­£ , ¨±¯®«¼§³¿ ¬¥²®¤» ° §¤. 3.2.
9.1-3 ®ª ¦¨²¥, ·²® ­¥ ±³¹¥±²¢³¥²  «£®°¨²¬  ±®°²¨°®¢ª¨, ®±­®¢ ­­®£® ­  ±° ¢­¥­¨¿µ, ª®²®°»© ° ¡®² « ¡» §  «¨­¥©­®¥ ¢°¥¬¿ ¤«¿
¯®«®¢¨­» ¨§ n! ¢®§¬®¦­»µ ¢µ®¤­»µ ¯®±«¥¤®¢ ²¥«¼­®±²¥© ¤«¨­» n.
 ª ¨§¬¥­¨²±¿ ®²¢¥², ¥±«¨ ¢ ½²®© § ¤ ·¥ § ¬¥­¨²¼ 1=2 ­  1=n?  
1=2n ?
9.1-4 °®´¥±±®° ° §° ¡®² « ª®¬¯¼¾²¥°, ª®²®°»© ¯®¤¤¥°¦¨¢ ¥²
À²°®©­»¥ ¢¥²¢«¥­¨¿Á: ¯®±«¥ ®¤­®£®-¥¤¨­±²¢¥­­®£® ±° ¢­¥­¨¿ ai : aj
³¯° ¢«¥­¨¥ ¬®¦¥² ¡»²¼ ¯¥°¥¤ ­® ¢ ®¤­® ¨§ ²°¥µ ¬¥±² ¯°®£° ¬¬»,
¢ § ¢¨±¨¬®±²¨ ®² ²®£®, ª ª®¥ ¨§ ±®®²­®¸¥­¨© ¢»¯®«­¥­®: ai < aj ,
ai = aj ¨«¨ ai > aj . ­ ­ ¤¥¥²±¿, ·²® ¡« £®¤ °¿ ² ª¨¬ ±° ¢­¥­¨¿¬
±®°²¨°®¢ª³ n ½«¥¬¥­²®¢ ¬®¦­® ¯°®¢¥±²¨  ±¨¬¯²®²¨·¥±ª¨ ¡»±²°¥¥,
·¥¬ §  ¢°¥¬¿ 
(n lg n). ®ª ¦¨²¥, ·²® ¯°®´¥±±®° § ¡«³¦¤ ¥²±¿.
9.1-5 ®ª ¦¨²¥, ·²® ¤«¿ ±«¨¿­¨¿ ¤¢³µ ®²±®°²¨°®¢ ­­»µ ¯®±«¥¤®¢ ²¥«¼­®±²¥© ¨§ n ½«¥¬¥­²®¢ ¤®±² ²®·­® 2n ; 1 ±° ¢­¥­¨© ¢ µ³¤¸¥¬ ±«³· ¥.
9.1-6 ®±«¥¤®¢ ²¥«¼­®±²¼ ¨§ n ½«¥¬¥­²®¢, ª®²®°³¾ ­¥®¡µ®¤¨¬®
®²±®°²¨°®¢ ²¼, ° §¡¨²  ­  ³· ±²ª¨ ¤«¨­» k. °¨ ½²®¬ «¾¡®© ½«¥¬¥­² ¯¥°¢®£® ³· ±²ª  ¬¥­¼¸¥ «¾¡®£® ½«¥¬¥­²  ¢²®°®£® ¨ ². ¤. (² ª

®°²¨°®¢ª  ¯®¤±·¥²®¬

175

·²® ®±² ¥²±¿ «¨¸¼ ®²±®°²¨°®¢ ²¼ ½«¥¬¥­²» ¢­³²°¨ ³· ±²ª®¢). ®ª ¦¨²¥, ·²® ² ª ¿ ±®°²¨°®¢ª  ¯®²°¥¡³¥² ­¥ ¬¥­¥¥ 
(n lg k) ±° ¢­¥­¨© ¢ µ³¤¸¥¬ ±«³· ¥. (ª § ­¨¥: ­¥¤®±² ²®·­® ±®±« ²¼±¿ ­  ­¥®¡µ®¤¨¬®±²¼ n=k ° § ±®°²¨°®¢ ²¼ ³· ±²®ª ¤«¨­®© k.)

9.2. ®°²¨°®¢ª  ¯®¤±·¥²®¬
«£®°¨²¬ ±®°²¨°®¢ª¨ ¯®¤±·¥²®¬ (counting sort) ¯°¨¬¥­¨¬, ¥±«¨
ª ¦¤»© ¨§ n ½«¥¬¥­²®¢ ±®°²¨°³¥¬®© ¯®±«¥¤®¢ ²¥«¼­®±²¨ | ¶¥«®¥
¯®«®¦¨²¥«¼­®¥ ·¨±«® ¢ ¨§¢¥±²­®¬ ¤¨ ¯ §®­¥ (­¥ ¯°¥¢®±µ®¤¿¹¥¥ § ° ­¥¥ ¨§¢¥±²­®£® k). ±«¨ k = O(n), ²®  «£®°¨²¬ ±®°²¨°®¢ª¨ ¯®¤±·¥²®¬ ° ¡®² ¥² §  ¢°¥¬¿ O(n).
¤¥¿ ½²®£®  «£®°¨²¬  ¢ ²®¬, ·²®¡» ¤«¿ ª ¦¤®£® ½«¥¬¥­²  x
¯°¥¤¢ °¨²¥«¼­® ¯®¤±·¨² ²¼, ±ª®«¼ª® ½«¥¬¥­²®¢ ¢µ®¤­®© ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¬¥­¼¸¥ x, ¯®±«¥ ·¥£® § ¯¨± ²¼ x ­ ¯°¿¬³¾ ¢ ¢»µ®¤­®©
¬ ±±¨¢ ¢ ±®®²¢¥²±²¢¨¨ ± ½²¨¬ ·¨±«®¬ (¥±«¨, ±ª ¦¥¬, 17 ½«¥¬¥­²®¢
¢µ®¤­®£® ¬ ±±¨¢  ¬¥­¼¸¥ x, ²® ¢ ¢»µ®¤­®¬ ¬ ±±¨¢¥ x ¤®«¦¥­ ¡»²¼
§ ¯¨± ­ ­  ¬¥±²® ­®¬¥° 18). ±«¨ ¢ ±®°²¨°³¥¬®© ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¬®£³² ¯°¨±³²±²¢®¢ ²¼ ° ¢­»¥ ·¨±« , ½²³ ±µ¥¬³ ­ ¤® ±«¥£ª 
¬®¤¨´¨¶¨°®¢ ²¼, ·²®¡» ­¥ § ¯¨± ²¼ ­¥±ª®«¼ª® ·¨±¥« ­  ®¤­® ¬¥±²®.
 ¯°¨¢®¤¨¬®¬ ­¨¦¥ ¯±¥¢¤®ª®¤¥ ¨±¯®«¼§³¥²±¿ ¢±¯®¬®£ ²¥«¼­»©
¬ ±±¨¢ C [1 : :k] ¨§ k ½«¥¬¥­²®¢. µ®¤­ ¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼ § ¯¨± ­  ¢ ¬ ±±¨¢¥ A[1 : :n], ®²±®°²¨°®¢ ­­ ¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼ § ¯¨±»¢ ¥²±¿ ¢ ¬ ±±¨¢ B [1 : :n].
Counting-Sort(A; B; k)
1 for i 1 to k
2
do C [i] 0
3 for j 1 to length[A]
4
do C [A[j ]] C [A[j ]] + 1
5 . C [i] ° ¢­® ª®«¨·¥±²¢³ ½«¥¬¥­²®¢, ° ¢­»µ i.
6 for i 2 to k
7
do C [i] C [i] + C [i ; 1]
8 . C [i] ° ¢­® ª®«¨·¥±²¢³ ½«¥¬¥­²®¢, ­¥ ¯°¥¢®±µ®¤¿¹¨µ i
9 for j length[A] downto 1
10
do B [C [A[j ]]] A[j ]
11
C [A[j ]] C [A[j ]] ; 1
 ¡®²   «£®°¨²¬  ±®°²¨°®¢ª¨ ¯®¤±·¥²®¬ ¯°®¨««¾±²°¨°®¢ ­ 
­  °¨±. 9.2. ®±«¥ ¨­¨¶¨ «¨§ ¶¨¨ (±²°®ª¨ 1{2) ¬» ±­ · «  ¯®¬¥¹ ¥¬ ¢ C [i] ª®«¨·¥±²¢® ½«¥¬¥­²®¢ ¬ ±±¨¢  A, ° ¢­»µ i (±²°®ª¨ 3{4),   § ²¥¬, ­ µ®¤¿ · ±²¨·­»¥ ±³¬¬» ¯®±«¥¤®¢ ²¥«¼­®±²¨
C [1]; C [2]; : : :; C [k], | ª®«¨·¥±²¢® ½«¥¬¥­²®¢, ­¥ ¯°¥¢®±µ®¤¿¹¨µ i
(±²°®ª¨ 6{7).  ª®­¥¶, ¢ ±²°®ª µ 9{11 ª ¦¤»© ¨§ ½«¥¬¥­²®¢ ¬ ±-

176

« ¢  9 ®°²¨°®¢ª  §  «¨­¥©­®¥ ¢°¥¬¿

¨±. 9.2  ¡®²   «£®°¨²¬  Counting-Sort, ¯°¨¬¥­
¥­­®£® ª ¬ ±±¨¢³ A[1 : : 8],
±®±²®¿¹¥¬³ ¨§ ­ ²³° «¼­»µ ·¨±¥«, ­¥ ¯°¥¢®±µ®¤¿¹¨µ k = 6. ( )  ±±¨¢ A ¨
¢±¯®¬®£ ²¥«¼­»© ¬ ±±¨¢ C ¯®±«¥ ¢»¯®«­¥­¨¿ ¶¨ª«  ¢ ±²°®ª µ 3{4. (¡)  ±±¨¢
C ¯®±«¥ ¢»¯®«­¥­¨¿ ¶¨ª«  ¢ ±²°®ª µ 6{7. (¢{¤) »µ®¤­®© ¬ ±±¨¢ B ¨ ¢±¯®¬®£ ²¥«¼­»© ¬ ±±¨¢ C ¯®±«¥ ®¤­®£®, ¤¢³µ ¨ ²°¥µ ¯®¢²®°¥­¨© ¶¨ª«  ¢ ±²°®ª µ 9{11.
 ·¥°­¥­­»¥ ª«¥²ª¨ ±®®²¢¥²±²¢³¾² ½«¥¬¥­² ¬ ¬ ±±¨¢ , §­ ·¥­¨¿ ª®²®°»¬ ¥¹¥
­¥ ¯°¨±¢®¥­». (¥)  ±±¨¢ B ¯®±«¥ ®ª®­· ­¨¿ ° ¡®²»  «£®°¨²¬ .

±¨¢  A ¯®¬¥¹ ¥²±¿ ­  ­³¦­®¥ ¬¥±²® ¢ ¬ ±±¨¢¥ B .  ± ¬®¬ ¤¥«¥,
¥±«¨ ¢±¥ n ½«¥¬¥­²®¢ ° §«¨·­», ²® ¢ ®²±®°²¨°®¢ ­­®¬ ¬ ±±¨¢¥ ·¨±«® A[j ] ¤®«¦­® ±²®¿²¼ ­  ¬¥±²¥ ­®¬¥° C [A[j ]], ¨¡® ¨¬¥­­® ±²®«¼ª®
½«¥¬¥­²®¢ ¬ ±±¨¢  A ­¥ ¯°¥¢®±µ®¤¿² A[j ]; ¥±«¨ ¢ ¬ ±±¨¢¥ A ¢±²°¥· ¾²±¿ ¯®¢²®°¥­¨¿, ²® ¯®±«¥ ª ¦¤®© § ¯¨±¨ ·¨±«  A[j ] ¢ ¬ ±±¨¢
B ·¨±«® C [A[j ]] ³¬¥­¼¸ ¥²±¿ ­  ¥¤¨­¨¶³ (±²°®ª  11), ² ª ·²® ¯°¨
±«¥¤³¾¹¥© ¢±²°¥·¥ ± ·¨±«®¬, ° ¢­»¬ A[j ], ®­® ¡³¤¥² § ¯¨± ­® ­ 
®¤­³ ¯®§¨¶¨¾ «¥¢¥¥.
¶¥­¨¬ ¢°¥¬¿ ° ¡®²»  «£®°¨²¬  ±®°²¨°®¢ª¨ ¯®¤±·¥²®¬. ¨ª«»
¢ ±²°®ª µ 1{2 ¨ 6{7 ° ¡®² ¾² §  ¢°¥¬¿ O(k), ¶¨ª«» ¢ ±²°®ª µ 3{4
¨ 10{11 | §  ¢°¥¬¿ O(n),   ¢¥±¼  «£®°¨²¬, ±² «® ¡»²¼, ° ¡®² ¥²
§  ¢°¥¬¿ O(k + n). ±«¨ k = O(n), ²® ¢°¥¬¿ ° ¡®²» ¥±²¼ O(n).
«¿  «£®°¨²¬  ±®°²¨°®¢ª¨ ¯®¤±·¥²®¬ ­¨¦­¿¿ ®¶¥­ª  ° §¤. 9.1
| ­¥ ¯°¥¯¿²±²¢¨¥, ¯®±ª®«¼ª³ ®­ ­¥ ±° ¢­¨¢ ¥² ±®°²¨°³¥¬»¥ ·¨±« 
¬¥¦¤³ ±®¡®©,   ¨±¯®«¼§³¥² ¨µ ¢ ª ·¥±²¢¥ ¨­¤¥ª±®¢ ¬ ±±¨¢ .
«£®°¨²¬ ±®°²¨°®¢ª¨ ¯®¤±·¥²®¬ ®¡« ¤ ¥² ¢ ¦­»¬ ±¢®©±²¢®¬,
­ §»¢ ¥¬»¬ ³±²®©·¨¢®±²¼¾ (it is stable). ¬¥­­®, ¥±«¨ ¢® ¢µ®¤­®¬
¬ ±±¨¢¥ ¯°¨±³²±²¢³¥² ­¥±ª®«¼ª® ° ¢­»µ ·¨±¥«, ²® ¢ ¢»µ®¤­®¬ ¬ ±±¨¢¥ ®­¨ ±²®¿² ¢ ²®¬ ¦¥ ¯®°¿¤ª¥, ·²® ¨ ¢® ¢µ®¤­®¬. ²® ±¢®©±²¢®
­¥ ¨¬¥¥² ±¬»±« , ¥±«¨ ¢ ¬ ±±¨¢¥ § ¯¨± ­» ²®«¼ª® ·¨±«  ± ¬¨ ¯®
±¥¡¥, ­® ¥±«¨ ¢¬¥±²¥ ± ·¨±« ¬¨ § ¯¨± ­» ¤®¯®«­¨²¥«¼­»¥ ¤ ­­»¥,
½²® ®ª §»¢ ¥²±¿ ¢ ¦­»¬. ®«¥¥ ²®·­®, ¯°¥¤±² ¢¨¬ ±¥¡¥, ·²® ¬»
±®°²¨°³¥¬ ­¥ ¯°®±²® ·¨±« ,   ¯ °» ht; xi, £¤¥ t | ·¨±«® ®² 1 ¤® k,
  x | ¯°®¨§¢®«¼­»© ®¡º¥ª², ¨ µ®²¨¬ ¯¥°¥±² ¢¨²¼ ¨µ ² ª, ·²®¡»
¯¥°¢»¥ ª®¬¯®­¥­²» ¯ ° ¸«¨ ¢ ­¥³¡»¢ ¾¹¥¬ ¯®°¿¤ª¥. ¯¨± ­­»©

¨´°®¢ ¿ ±®°²¨°®¢ª 

177

­ ¬¨  «£®°¨²¬ ¯®§¢®«¿¥² ½²® ±¤¥« ²¼, ¯°¨·¥¬ ®²­®±¨²¥«¼­®¥ ° ±¯®«®¦¥­¨¥ ¯ ° ± ° ¢­»¬¨ ¯¥°¢»¬¨ ª®¬¯®­¥­² ¬¨ ­¥ ¬¥­¿¥²±¿. ²®
±¢®©±²¢® ¨ ­ §»¢ ¥²±¿ ³±²®©·¨¢®±²¼¾. » ³¢¨¤¨¬ ¢ ±«¥¤³¾¹¥¬
° §¤¥«¥, ª ª ®­® ¯°¨¬¥­¿¥²±¿.
¯° ¦­¥­¨¿
9.2-1

«¥¤³¿ ®¡° §¶³ °¨±. 9.2., ¯®ª ¦¨²¥ ° ¡®²³  «£®°¨²¬ 

Counting-Sort ¤«¿ ±«³· ¿ k = 7 ¨ A = h7; 1; 3; 1; 2; 4; 5; 7; 2; 4; 3i.

9.2-2 ®ª ¦¨²¥, ·²®  «£®°¨²¬ Counting-Sort ¿¢«¿¥²±¿ ³±²®©·¨¢»¬.
9.2-3  ¬¥­¨¬ ±²°®ª³ 9  «£®°¨²¬  Counting-Sort ­  ² ª³¾:
9 for j 1 to length[A]
®ª ¦¨²¥, ·²®  «£®°¨²¬ ®±² ¥²±¿ ¯° ¢¨«¼­»¬. ³¤¥² «¨ ®­ ³±²®©·¨¢?
9.2-4 ³±²¼ ­  ¢»µ®¤¥  «£®°¨²¬  ±®°²¨°®¢ª¨ ­ ¤® ­ ¯¥· ² ²¼
½«¥¬¥­²» ¢µ®¤­®© ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¢ ®²±®°²¨°®¢ ­­®¬ ¯®°¿¤ª¥. ®¤¨´¨¶¨°³©²¥  «£®°¨²¬ Counting-Sort ² ª¨¬ ®¡° §®¬,
·²®¡» ®­ ¤¥« « ½²®, ­¥ ¨±¯®«¼§³¿ ¬ ±±¨¢  B ¨«¨ ¨­»µ ¬ ±±¨¢®¢
(¯®¬¨¬® A ¨ C ). (ª § ­¨¥: ±¢¿¦¨²¥ ¢ ±¯¨±ª¨ ½«¥¬¥­²» ¬ ±±¨¢  A
± ®¤¨­ ª®¢»¬ §­ ·¥­¨¥¬; £¤¥ ¢§¿²¼ ¬¥±²® ¤«¿ µ° ­¥­¨¿ ³ª § ²¥«¥©?).
9.2-5  ­® n ¶¥«»µ ·¨±¥« ®² 1 ¤® k.  §° ¡®² ©²¥  «£®°¨²¬, ª®²®°»© ¯®¤¢¥°£ ¥² ½²¨ ¤ ­­»¥ ¯°¥¤¢ °¨²¥«¼­®© ®¡° ¡®²ª¥,   § ²¥¬
§  ¢°¥¬¿ O(1) ®²¢¥· ¥² ­  «¾¡®© ¢®¯°®± ²¨¯  À±ª®«¼ª® ·¨±¥« ¨§
¤ ­­®£® ­ ¡®°  «¥¦¨² ¬¥¦¤³ a ¨ b?Á. °¥¬¿ ­  ¯°¥¤¢ °¨²¥«¼­³¾
®¡° ¡®²ª³ ¤®«¦­® ¡»²¼ O(n + k).

9.3. ¨´°®¢ ¿ ±®°²¨°®¢ª 
«£®°¨²¬ ¶¨´°®¢®© ±®°²¨°®¢ª¨ (radix sort) ¨±¯®«¼§®¢ «±¿ ¢ ¬ ¸¨­ µ ¤«¿ ±®°²¨°®¢ª¨ ¯¥°´®ª °² (±¥©· ± ² ª¨¥ ¬ ¸¨­» ¬®¦­®
­ ©²¨ ° §¢¥ ·²® ¢ ¬³§¥¿µ).  ª °²®­­»µ ¯¥°´®ª °² µ ±¯¥¶¨ «¼­»© ¯¥°´®° ²®° ¯°®¡¨¢ « ¤»°ª¨.  ª ¦¤®© ¨§ 80 ª®«®­®ª ¡»«¨
¬¥±²  ¤«¿ 12 ¯°¿¬®³£®«¼­»µ ¤»°®ª. ®®¡¹¥-²® ¢ ®¤­®© ª®«®­ª¥
¬®¦­® ¡»«® ¯°®¡¨²¼ ­¥±ª®«¼ª® ¤»°®ª, ¨µ ª®¬¡¨­ ¶¨¿ ±®®²¢¥²±²¢®¢ «  ±¨¬¢®«³ (² ª ·²® ­  ª °²¥ ¡»«® ¬¥±²® ¤«¿ 80 ±¨¬¢®«®¢), ­®
¶¨´°» 0{9 ª®¤¨°®¢ «¨±¼ ®¤¨­®·­»¬¨ ¤»°ª ¬¨ ¢ ±²°®ª µ 0{9 ±®®²¢¥²±²¢³¾¹¥© ª®«®­ª¨.
®°²¨°®¢®·­®© ¬ ¸¨­¥ ³ª §»¢ «¨ ±²®«¡¥¶, ¯® ª®²®°®¬³ ­³¦­®

178

« ¢  9 ®°²¨°®¢ª  §  «¨­¥©­®¥ ¢°¥¬¿

329
720
720
329
457
355
329
355
657
436
436
436
839 ) 457 ) 839 ) 457
436
657
355
657
720
329
457
720
355
839
657
839

"

"

"

¨´°®¢ ¿ ±®°²¨°®¢ª  ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¨§ ±¥¬¨ ²°¥µ§­ ·­»µ ·¨±¥«.   ¢µ®¤ ¯®¤ ¾²±¿ ·¨±«  ¯¥°¢®£® ±²®«¡¶ .  «¥¥ ¯®ª § ­ ¯®°¿¤®ª ·¨±¥«
¯®±«¥ ±®°²¨°®¢ª¨ ¯® ²°¥²¼¥©, ¢²®°®© ¨ ¯¥°¢®© ¶¨´° ¬ (¢¥°²¨ª «¼­»¥ ±²°¥«ª¨
³ª §»¢ ¾², ¯® ª ª®© ¶¨´°¥ ¯°®¨§¢®¤¨« ±¼ ±®°²¨°®¢ª ).
¨±. 9.3

¯°®¨§¢¥±²¨ ±®°²¨°®¢ª³, ¨ ®­  ° ±ª« ¤»¢ «  ª®«®¤³ ¯¥°´®ª °² ­ 
10 ±²®¯®ª ¢ § ¢¨±¨¬®±²¨ ®² ²®£®, ª ª ¿ ¨§ ¤»°®ª 0{9 ¡»«  ¯°®¡¨² 
¢ ³ª § ­­®¬ ±²®«¡¶¥.
 ª ®²±®°²¨°®¢ ²¼ ª®«®¤³ ¯¥°´®ª °² ± ¬­®£®§­ ·­»¬¨ ·¨±« ¬¨
(° §°¿¤ ¥¤¨­¨¶ ¢ ®¤­®¬ ±²®«¡¶¥, ¤¥±¿²ª®¢ | ¢ ¯°¥¤»¤³¹¥¬ ¨ ². ¤.)?
¥°¢®¥, ·²® ¯°¨µ®¤¨² ¢ £®«®¢³, | ­ · ²¼ ±®°²¨°®¢ª³ ±® ±² °¸¥£®
° §°¿¤ . °¨ ½²®¬ ¯®«³·¨²±¿ 10 ±²®¯®ª, ª ¦¤³¾ ¨§ ª®²®°»µ ­ 
±«¥¤³¾¹¥¬ ¸ £¥ ¯°¨¤¥²±¿ ° §¡¨¢ ²¼ ­  10 ±²®¯®ª, ¨ ² ª ¤ «¥¥ |
¯®«³·¨²±¿ ¬­®£® ±²®¯®ª ¯¥°´®ª °², ¢ ª®²®°»µ «¥£ª® § ¯³² ²¼±¿
(±¬. ³¯° ¦­¥­¨¥ 9.3-5).
 ª ­¨ ±²° ­­®, ®ª §»¢ ¥²±¿ ³¤®¡­¥¥ ­ · ²¼ ± ¬« ¤¸¥£® ° §°¿¤ , ° §«®¦¨¢ ª®«®¤³ ­  10 ±²®¯®ª ¢ § ¢¨±¨¬®±²¨ ®² ²®£®, £¤¥ ¯°®¡¨²® ®²¢¥°±²¨¥ ¢ À¬« ¤¸¥¬Á ±²®«¡¶¥. ®«³·¥­­»¥ 10 ±²®¯®ª ­ ¤®
¯®±«¥ ½²®£® ±«®¦¨²¼ ¢ ®¤­³ ¢ ² ª®¬ ¯®°¿¤ª¥: ±­ · «  ª °²» ± 0, § ²¥¬ ª °²» ± 1, ¨ ². ¤. ®«³·¨¢¸³¾±¿ ª®«®¤³ ¢­®¢¼ ° ±±®°²¨°³¥¬ ­ 
10 ±²®¯®ª, ­® ³¦¥ ¢ ±®®²¢¥²±²¢¨¨ ± ° §°¿¤®¬ ¤¥±¿²ª®¢, ±«®¦¨¬ ¯®«³·¥­­»¥ ±²®¯ª¨ ¢ ®¤­³ ª®«®¤³, ¨ ². ¤.; ¥±«¨ ­  ¯¥°´®ª °² µ ¡»«¨
§ ¯¨± ­» d-§­ ·­»¥ ·¨±« , ²® ¯®­ ¤®¡¨²±¿ d ° § ¢®±¯®«¼§®¢ ²¼±¿
±®°²¨°®¢®·­®© ¬ ¸¨­®©.   °¨±. 9.3 ¨§®¡° ¦¥­®, ª ª ¤¥©±²¢³¥²
½²®²  «£®°¨²¬, ¯°¨¬¥­¥­­»© ª ±¥¬¨ ²°¥µ§­ ·­»¬ ·¨±« ¬.
 ¦­®, ·²®¡»  «£®°¨²¬, ± ¯®¬®¹¼¾ ª®²®°®£® ¯°®¨±µ®¤¨² ±®°²¨°®¢ª  ¯® ¤ ­­®¬³ ° §°¿¤³, ¡»« ³±²®©·¨¢»¬: ª °²®·ª¨, ³ ª®²®°»µ
¢ ¤ ­­®© ª®«®­ª¥ ±²®¨² ®¤­  ¨ ²  ¦¥ ¶¨´° , ¤®«¦­» ¢»©²¨ ¨§ ±®°²¨°®¢®·­®© ¬ ¸¨­» ¢ ²®© ¦¥ ¯®±«¥¤®¢ ²¥«¼­®±²¨, ¢ ª®²®°®© ®­¨
²³¤  ¯®¤ ¢ «¨±¼ (± ¬® ±®¡®©, ¯°¨ ±ª« ¤»¢ ­¨¨ 10 ±²®¯®ª ¢ ®¤­³
¬¥­¿²¼ ¯®°¿¤®ª ª °² ¢ ±²®¯ª µ ²®¦¥ ­¥ ±«¥¤³¥²).
 ª®¬¯¼¾²¥° µ ¶¨´°®¢ ¿ ±®°²¨°®¢ª  ¨­®£¤  ¨±¯®«¼§³¥²±¿ ¤«¿
³¯®°¿¤®·¥­¨¿ ¤ ­­»µ, ±®¤¥°¦ ¹¨µ ­¥±ª®«¼ª® ¯®«¥©. ³±²¼, ­ ¯°¨¬¥°, ­ ¬ ­ ¤® ®²±®°²¨°®¢ ²¼ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¤ ². ²® ¬®¦­®
±¤¥« ²¼ ± ¯®¬®¹¼¾ «¾¡®£®  «£®°¨²¬  ±®°²¨°®¢ª¨, ±° ¢­¨¢ ¿ ¤ ²»
±«¥¤³¾¹¨¬ ®¡° §®¬: ±° ¢­¨²¼ £®¤», ¥±«¨ £®¤» ±®¢¯ ¤ ¾² | ±° ¢­¨²¼ ¬¥±¿¶», ¥±«¨ ±®¢¯ ¤ ¾² ¨ ¬¥±¿¶» | ±° ¢­¨²¼ ·¨±« . ¬¥±²®

¨´°®¢ ¿ ±®°²¨°®¢ª 

179

½²®£®, ®¤­ ª®, ¬®¦­® ¯°®±²® ²°¨¦¤» ®²±®°²¨°®¢ ²¼ ¬ ±±¨¢ ¤ ² ±
¯®¬®¹¼¾ ³±²®©·¨¢®£®  «£®°¨²¬ : ±­ · «  ¯® ¤­¿¬, ¯®²®¬ ¯® ¬¥±¿¶ ¬, ¯®²®¬ ¯® £®¤ ¬.
°®£° ¬¬³ ¤«¿ ¶¨´°®¢®© ±®°²¨°®¢ª¨ ­ ¯¨± ²¼ «¥£ª®. » ¯°¥¤¯®« £ ¥¬, ·²® ª ¦¤»© ½«¥¬¥­² n-½«¥¬¥­²­®£® ¬ ±±¨¢  A ±®±²®¨²
¨§ d ¶¨´°, ¯°¨·¥¬ ¶¨´°  ­®¬¥° 1 | ¬« ¤¸¨© ° §°¿¤,   ¶¨´° 
­®¬¥° d | ±² °¸¨©.
Radix-Sort(A; d)
1 for i 1 to d
2
do ®²±®°²¨°®¢ ²¼ ¬ ±±¨¢ A ³±²®©·¨¢»¬
 «£®°¨²¬®¬ ¯® §­ ·¥­¨¾ ¶¨´°» ­®¬¥° i
° ¢¨«¼­®±²¼  «£®°¨²¬  ¶¨´°®¢®© ±®°²¨°®¢ª¨ ¤®ª §»¢ ¥²±¿
¨­¤³ª¶¨¥© ¯® ­®¬¥°³ ° §°¿¤  (±¬. ³¯°. 9.3-3). °¥¬¿ ° ¡®²» § ¢¨±¨² ®² ¢°¥¬¥­¨ ° ¡®²» ¢»¡° ­­®£® ³±²®©·¨¢®£®  «£®°¨²¬ . ±«¨
¶¨´°» ¬®£³² ¯°¨­¨¬ ²¼ §­ ·¥­¨¿ ®² 1 ¤® k, £¤¥ k ­¥ ±«¨¸ª®¬ ¢¥«¨ª®, ²® ®·¥¢¨¤­»© ¢»¡®° | ±®°²¨°®¢ª  ¯®¤±·¥²®¬. «¿ n ·¨±¥«
± d §­ ª ¬¨ ®² 0 ¤® k ; 1 ª ¦¤»© ¯°®µ®¤ § ­¨¬ ¥² ¢°¥¬¿ (n + k);
¯®±ª®«¼ª³ ¬» ¤¥« ¥¬ d ¯°®µ®¤®¢, ¢°¥¬¿ ° ¡®²» ¶¨´°®¢®© ±®°²¨°®¢ª¨ ° ¢­® (dn + kd). ±«¨ d ¯®±²®¿­­® ¨ k = O(n), ²® ¶¨´°®¢ ¿
±®°²¨°®¢ª  ° ¡®² ¥² §  «¨­¥©­®¥ ¢°¥¬¿.
°¨ ¶¨´°®¢®© ±®°²¨°®¢ª¥ ¢ ¦­® ¯° ¢¨«¼­® ¢»¡° ²¼ ®±­®¢ ­¨¥ ±¨±²¥¬» ±·¨±«¥­¨¿, ¯®±ª®«¼ª³ ®² ­¥£® § ¢¨±¨² ° §¬¥° ²°¥¡³¥¬®© ¤®¯®«­¨²¥«¼­®© ¯ ¬¿²¨ ¨ ¢°¥¬¿ ° ¡®²». ®­ª°¥²­»© ¯°¨¬¥°:
¯³±²¼ ­ ¤® ®²±®°²¨°®¢ ²¼ ¬¨««¨®­ 64-¡¨²­»µ ·¨±¥«. ±«¨ ° ±±¬ ²°¨¢ ²¼ ¨µ ª ª ·¥²»°¥µ§­ ·­»¥ ·¨±«  ¢ ±¨±²¥¬¥ ±·¨±«¥­¨¿ ± ®±­®¢ ­¨¥¬ 216, ²® ¯°¨ ¶¨´°®¢®© ±®°²¨°®¢ª¥ ¬» ±¯° ¢¨¬±¿ ± ­¨¬¨ § 
·¥²»°¥ ¯°®µ®¤ , ¨±¯®«¼§³¿ ¢ ¯°®¶¥¤³°¥ Counting-Sort ¬ ±±¨¢ B
° §¬¥°®¬ 216 (·²® ­¥¬­®£® ¯® ±° ¢­¥­¨¾ ± ° §¬¥°®¬ ±®°²¨°³¥¬®£® ¬ ±±¨¢ ) ²® ¢»£®¤­® ®²«¨· ¥²±¿ ®² ±®°²¨°®¢ª¨ ±° ¢­¥­¨¥¬,
ª®£¤  ­  ª ¦¤®¥ ·¨±«® ¯°¨µ®¤¨²±¿ ¯® lg n  20 ®¯¥° ¶¨©.  ±®¦ «¥­¨¾, ¶¨´°®¢ ¿ ±®°²¨°®¢ª , ®¯¨° ¾¹ ¿±¿ ­  ±®°²¨°®¢ª³ ¯®¤±·¥²®¬, ²°¥¡³¥² ¥¹¥ ®¤­®£® ¬ ±±¨¢  (²®£® ¦¥ ° §¬¥° , ·²® ¨ ±®°²¨°³¥¬»©) ¤«¿ µ° ­¥­¨¿ ¯°®¬¥¦³²®·­»µ °¥§³«¼² ²®¢, ¢ ²® ¢°¥¬¿ ª ª ¬­®£¨¥  «£®°¨²¬» ±®°²¨°®¢ª¨ ±° ¢­¥­¨¥¬ ®¡µ®¤¿²±¿ ¡¥§
½²®£®. ®½²®¬³, ¥±«¨ ­ ¤® ½ª®­®¬¨²¼ ¯ ¬¿²¼,  «£®°¨²¬ ¡»±²°®©
±®°²¨°®¢ª¨ ¬®¦¥² ®ª § ²¼±¿ ¯°¥¤¯®·²¨²¥«¼­¥¥.
¯° ¦­¥­¨¿
9.3-1 «¥¤³¿ ®¡° §¶³ °¨±. 9.3, ¯®ª ¦¨²¥, ª ª ¯°®¨±µ®¤¨² ¶¨´°®¢ ¿ ±®°²¨°®¢ª  (¯®  «´ ¢¨²³)  ­£«¨©±ª¨µ ±«®¢ COW, DOG, SEA,
RUG, ROW, MOB, BOX, TAB, BAR, EAR, TAR, DIG, BIG, TEA,
NOW, FOX.

180

« ¢  9 ®°²¨°®¢ª  §  «¨­¥©­®¥ ¢°¥¬¿

9.3-2  ª¨¥ ¨§ ±«¥¤³¾¹¨µ  «£®°¨²¬®¢ ±®°²¨°®¢ª¨ ¿¢«¿¾²±¿
³±²®©·¨¢»¬¨: ±®°²¨°®¢ª  ¢±² ¢ª ¬¨, ±®°²¨°®¢ª  ±«¨¿­¨¥¬, ±®°²¨°®¢ª  ± ¯®¬®¹¼¾ ª³·¨, ¡»±²° ¿ ±®°²¨°®¢ª ? ¡º¿±­¨²¥, ª ª¨¬
±¯®±®¡®¬ ¬®¦­® «¾¡®©  «£®°¨²¬ ±®°²¨°®¢ª¨ ¯°¥¢° ²¨²¼ ¢ ³±²®©·¨¢»©. ª®«¼ª® ¯°¨ ½²®¬ ¯®²°¥¡³¥²±¿ ¤®¯®«­¨²¥«¼­®£® ¢°¥¬¥­¨ ¨
¯ ¬¿²¨?
9.3-3 ®ª ¦¨²¥ ¯® ¨­¤³ª¶¨¨, ·²®  «£®°¨²¬ ¶¨´°®¢®© ±®°²¨°®¢ª¨ ¯° ¢¨«¥­. ¤¥ ¢ ¢ ¸¥¬ ¤®ª § ²¥«¼±²¢¥ ¨±¯®«¼§³¥²±¿ ³±²®©·¨¢®±²¼  «£®°¨²¬  ±®°²¨°®¢ª¨ ¶¨´°?
9.3-4 ¡º¿±­¨²¥, ª ª ° ±±®°²¨°®¢ ²¼ n ¶¥«»µ ¯®«®¦¨²¥«¼­»µ
·¨±¥«, ­¥ ¯°¥¢®±µ®¤¿¹¨µ n2 , §  ¢°¥¬¿ O(n).
9.3-5? ³±²¼ ¬» ±®°²¨°³¥¬ ¯¥°´®ª °²» ± ¯®¬®¹¼¾ ±®°²¨°®¢®·­®© ¬ ¸¨­», ­ ·¨­ ¿ ±® ±² °¸¥£® ° §°¿¤ . ª®«¼ª® ° § ¯°¨¤¥²±¿
§ ¯³±²¨²¼ ¬ ¸¨­³ (¢ µ³¤¸¥¬ ±«³· ¥) ¤«¿ ±®°²¨°®¢ª¨ d-§­ ·­»µ
·¨±¥«?  ª®¥ ¬ ª±¨¬ «¼­®¥ ª®«¨·¥±²¢® ±²®¯®ª ª °² ¯°¨¤¥²±¿ ®¤­®¢°¥¬¥­­® µ° ­¨²¼ ¯® µ®¤³ ¤¥« ?

9.4. ®°²¨°®¢ª  ¢»·¥°¯»¢ ­¨¥¬
«£®°¨²¬ ±®°²¨°®¢ª¨ ¢»·¥°¯»¢ ­¨¥¬ (bucket sort) ° ¡®² ¥² § 
«¨­¥©­®¥ (±°¥¤­¥¥) ¢°¥¬¿.  ª ¨ ±®°²¨°®¢ª  ¯®¤±·¥²®¬, ±®°²¨°®¢ª  ¢»·¥°¯»¢ ­¨¥¬ £®¤¨²±¿ ­¥ ¤«¿ «¾¡»µ ¨±µ®¤­»µ ¤ ­­»µ: £®¢®°¿ ® «¨­¥©­®¬ ±°¥¤­¥¬ ¢°¥¬¥­¨, ¬» ¯°¥¤¯®« £ ¥¬, ·²® ­  ¢µ®¤
¯®¤ ¥²±¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ­¥§ ¢¨±¨¬»µ ±«³· ©­»µ ·¨±¥«, ° ¢­®¬¥°­® ° ±¯°¥¤¥«¥­­»µ ­  ¯°®¬¥¦³²ª¥ [0; 1) (®¯°¥¤¥«¥­¨¥ ° ¢­®¬¥°­®£® ° ±¯°¥¤¥«¥­¨¿ ¤ ­® ¢ ° §¤. 6.2).
[ ¬¥²¨¬, ·²® ½²®²  «£®°¨²¬ | ¤¥²¥°¬¨­¨°®¢ ­­»© (­¥ ¨±¯®«¼§³¥² £¥­¥° ²®°  ±«³· ©­»µ ·¨±¥«); ¯®­¿²¨¥ ±«³· ©­®±²¨ ¢®§­¨ª ¥²
«¨¸¼ ¯°¨  ­ «¨§¥ ¢°¥¬¥­¨ ¥£® ° ¡®²».]
¤¥¿  «£®°¨²¬  ±®±²®¨² ¢ ²®¬, ·²® ¯°®¬¥¦³²®ª [0; 1) ¤¥«¨²±¿
­  n ° ¢­»µ · ±²¥©, ¯®±«¥ ·¥£® ¤«¿ ·¨±¥« ¨§ ª ¦¤®© · ±²¨ ¢»¤¥«¿¥²±¿ ±¢®© ¿¹¨ª-·¥°¯ ª (bucket), ¨ n ¯®¤«¥¦ ¹¨µ ±®°²¨°®¢ª¥
·¨±¥« ° ±ª« ¤»¢ ¾²±¿ ¯® ½²¨¬ ¿¹¨ª ¬. ®±ª®«¼ª³ ·¨±«  ° ¢­®¬¥°­® ° ±¯°¥¤¥«¥­» ­  ®²°¥§ª¥ [0; 1), ±«¥¤³¥² ®¦¨¤ ²¼, ·²® ¢ ª ¦¤®¬ ¿¹¨ª¥ ¨µ ¡³¤¥² ­¥¬­®£®. ¥¯¥°¼ ®²±®°²¨°³¥¬ ·¨±«  ¢ ª ¦¤®¬
¿¹¨ª¥ ¯® ®²¤¥«¼­®±²¨ ¨ ¯°®©¤¥¬±¿ ¯® ¿¹¨ª ¬ ¢ ¯®°¿¤ª¥ ¢®§° ±² ­¨¿, ¢»¯¨±»¢ ¿ ¯®¯ ¢¸¨¥ ¢ ª ¦¤»© ¨§ ­¨µ ·¨±«  ² ª¦¥ ¢ ¯®°¿¤ª¥
¢®§° ±² ­¨¿.
³¤¥¬ ±·¨² ²¼, ·²® ­  ¢µ®¤ ¯®¤ ¥²±¿ n-½«¥¬¥­²­»© ¬ ±±¨¢ A,
¯°¨·¥¬ 0 6 A[i] < 1 ¤«¿ ¢±¥µ i. ±¯®«¼§³¥²±¿ ² ª¦¥ ¢±¯®¬®£ ²¥«¼­»© ¬ ±±¨¢ B [0 : : n ; 1], ±®±²®¿¹¨© ¨§ ±¯¨±ª®¢, ±®®²¢¥²±²¢³¾¹¨µ
¿¹¨ª ¬. «£®°¨²¬ ¨±¯®«¼§³¥² ®¯¥° ¶¨¨ ±® ±¯¨±ª ¬¨, ª®²®°»¥ ®¯¨-

®°²¨°®¢ª  ¢»·¥°¯»¢ ­¨¥¬

181

 ¡®²   «£®°¨²¬  Bucket-Sort. ( )   ¢µ®¤ ¯®¤ ­ ¬ ±±¨¢ A[1 : : 10].
(¡)  ±±¨¢ ±¯¨±ª®¢ B [0 : : 9] ¯®±«¥ ¢»¯®«­¥­¨¿ ±²°®ª¨ 5. ¯¨±®ª ± ¨­¤¥ª±®¬ i ±®¤¥°¦¨² ·¨±« , ³ ª®²®°»µ ¯¥°¢»© §­ ª ¯®±«¥ § ¯¿²®© ¥±²¼ i. ²±®°²¨°®¢ ­­»©
¬ ±±¨¢ ¯®«³·¨²±¿, ¥±«¨ ¯®±«¥¤®¢ ²¥«¼­® ¢»¯¨± ²¼ ±¯¨±ª¨ B [0];: : : ; B [9].
¨±. 9.4

± ­» ¢ ° §¤. 11.2.
Bucket-Sort(A)
1 n length[A]
2 for i 1 to n
3
do ¤®¡ ¢¨²¼ A[i] ª ±¯¨±ª³ B [bnA[i]c]
4 for i 0 to n ; 1
5
do ®²±®°²¨°®¢ ²¼ ±¯¨±®ª B [i] (±®°²¨°®¢ª  ¢±² ¢ª ¬¨)
6 ±®¥¤¨­¨²¼ ±¯¨±ª¨ B [0]; B [1]; : : :; B [n ; 1] (¢ ³ª § ­­®¬ ¯®°¿¤ª¥)
  °¨±. 9.4 ¯®ª § ­  ° ¡®²  ½²®£®  «£®°¨²¬  ­  ¯°¨¬¥°¥ ¬ ±±¨¢ 
¨§ 10 ·¨±¥«.
²®¡» ¯®ª § ²¼, ·²®  «£®°¨²¬ ±®°²¨°®¢ª¨ ¢»·¥°¯»¢ ­¨¥¬ ¯° ¢¨«¥­, ° ±±¬®²°¨¬ ¤¢  ·¨±«  A[i] ¨ A[j ]. ±«¨ ®­¨ ¯®¯ «¨ ¢ ° §­»¥
¿¹¨ª¨, ²® ¬¥­¼¸¥¥ ¨§ ­¨µ ¯®¯ «® ¢ ¿¹¨ª ± ¬¥­¼¸¨¬ ­®¬¥°®¬, ¨ ¢
¢»µ®¤­®© ¯®±«¥¤®¢ ²¥«¼­®±²¨ ®­® ®ª ¦¥²±¿ ° ­¼¸¥; ¥±«¨ ®­¨ ¯®¯ «¨ ¢ ®¤¨­ ¿¹¨ª, ²® ¯®±«¥ ±®°²¨°®¢ª¨ ±®¤¥°¦¨¬®£® ¿¹¨ª  ¬¥­¼¸¥¥
·¨±«® ¡³¤¥² ² ª¦¥ ¯°¥¤¸¥±²¢®¢ ²¼ ¡®«¼¸¥¬³.
°® ­ «¨§¨°³¥¬ ¢°¥¬¿ ° ¡®²»  «£®°¨²¬ . ¯¥° ¶¨¨ ¢® ¢±¥µ
±²°®ª µ, ª°®¬¥ ¯¿²®©, ²°¥¡³¾² (®¡¹¥£®) ¢°¥¬¥­¨ O(n). °®±¬®²°
¢±¥µ ¿¹¨ª®¢ ² ª¦¥ § ­¨¬ ¥² ¢°¥¬¿ O(n).  ª¨¬ ®¡° §®¬, ­ ¬
®±² ¥²±¿ ²®«¼ª® ®¶¥­¨²¼ ¢°¥¬¿ ±®°²¨°®¢ª¨ ¢±² ¢ª ¬¨ ¢­³²°¨ ¿¹¨ª®¢.
³±²¼ ¢ ¿¹¨ª B [i] ¯®¯ «® ni ·¨±¥« (ni | ±«³· ©­ ¿ ¢¥«¨·¨­ ).
®±ª®«¼ª³ ±®°²¨°®¢ª  ¢±² ¢ª ¬¨ ° ¡®² ¥² §  ª¢ ¤° ²¨·­®¥ ¢°¥¬¿,
¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ¤«¨²¥«¼­®±²¨ ±®°²¨°®¢ª¨ ·¨±¥« ¢ ¿¹¨ª¥ ­®¬¥° i ¥±²¼ O(M[n2i ]),   ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ±³¬¬ °­®£®

182

« ¢  9 ®°²¨°®¢ª  §  «¨­¥©­®¥ ¢°¥¬¿

¢°¥¬¥­¨ ±®°²¨°®¢ª¨ ¢® ¢±¥µ ¿¹¨ª µ ¥±²¼
nX
;1
i=0

O(M[n2i ]) = O

n;1
X
i=0

!

M[n2i ] :

(9.1)

 ©¤¥¬ ´³­ª¶¨¾ ° ±¯°¥¤¥«¥­¨¿ ±«³· ©­»µ ¢¥«¨·¨­ ni . ®±ª®«¼ª³ ·¨±«  ° ±¯°¥¤¥«¥­» ° ¢­®¬¥°­®,   ¢¥«¨·¨­» ¢±¥µ ®²°¥§ª®¢ ° ¢­», ¢¥°®¿²­®±²¼ ²®£®, ·²® ¤ ­­®¥ ·¨±«® ¯®¯ ¤¥² ¢ ¿¹¨ª ­®¬¥°
i, ° ¢­  1=n. ² «® ¡»²¼, ¬» ­ µ®¤¨¬±¿ ¢ ±¨²³ ¶¨¨ ¯°¨¬¥°  ¨§
° §¤. 6.6.2 ± ¸ ° ¬¨ ¨ ³°­ ¬¨: ³ ­ ± n ¸ °®¢-·¨±¥«, n ³°­-¿¹¨ª®¢,
¨ ¢¥°®¿²­®±²¼ ¯®¯ ¤ ­¨¿ ¤ ­­®£® ¸ °  ¢ ¤ ­­³¾ ³°­³ ° ¢­  p =
1=n. ®½²®¬³ ·¨±«  ni ° ±¯°¥¤¥«¥­» ¡¨­®¬ «¼­®: ¢¥°®¿²­®±²¼ ²®£®, ·²® ni = k, ° ¢­  Cnk pk (1 ; p)n;k , ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥
° ¢­® M[ni ] = np = 1, ¨ ¤¨±¯¥°±¨¿ ° ¢­  D[ni] = np(1 ; p) = 1 ; 1=n.
§ ´®°¬³«» (6.30) ¨¬¥¥¬:
M[n2 ] = D[n ] + M2[n ] = 2 ; 1 = (1):
i

i

i

n

®¤±² ¢«¿¿ ½²³ ®¶¥­ª³ ¢ (9.1), ¯®«³· ¥¬, ·²® ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ±³¬¬ °­®£® ¢°¥¬¥­¨ ±®°²¨°®¢ª¨ ¢±¥µ ¿¹¨ª®¢ ¥±²¼ O(n), ² ª
·²® ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ¢°¥¬¥­¨ ° ¡®²»  «£®°¨²¬  ±®°²¨°®¢ª¨ ¢»·¥°¯»¢ ­¨¥¬ ¢ ± ¬®¬ ¤¥«¥ «¨­¥©­® § ¢¨±¨² ®² ª®«¨·¥±²¢ 
·¨±¥«.
¯° ¦­¥­¨¿
9.4-1 «¥¤³¿ ®¡° §¶³ °¨±. 9.4, ¯®ª ¦¨²¥, ª ª ° ¡®² ¥²  «£®°¨²¬ Bucket-Sort ¤«¿ ¬ ±±¨¢  A = h0:79; 0:13; 0:16; 0:64; 0:39;
0:20; 0:89; 0:53; 0:71; 0:42i.
9.4-2  ª®¢® ¢°¥¬¿ ° ¡®²»  «£®°¨²¬  ±®°²¨°®¢ª¨ ¢»·¥°¯»¢ ­¨¥¬ ¢ µ³¤¸¥¬ ±«³· ¥? °¨¤³¬ ©²¥ ¥£® ¯°®±²³¾ ¬®¤¨´¨ª ¶¨¾,
±®µ° ­¿¾¹³¾ «¨­¥©­®¥ ±°¥¤­¥¥ ¢°¥¬¿ ° ¡®²» ¨ ±­¨¦ ¾¹³¾ ¢°¥¬¿
° ¡®²» ¢ µ³¤¸¥¬ ±«³· ¥ ¤® O(n lg n).
9.4-3?  ­® n ­¥§ ¢¨±¨¬»µ ±«³· ©­»µ ²®·¥ª ± ª®®°¤¨­ ² ¬¨
(xi ; yi), ° ¢­®¬¥°­® ° ±¯°¥¤¥«¥­­»µ ¢ ª°³£¥ ° ¤¨³±  1 ± ¶¥­²°®¬
¢ ­ · «¥ ª®®°¤¨­ ² (½²® ®§­ · ¥², ·²® ¢¥°®¿²­®±²¼ ­ ©²¨ ²®·ª³
¢ ª ª®©-²® ®¡« ±²¨ ¯°®¯®°¶¨®­ «¼­  ¯«®¹ ¤¨ ½²®© ®¡« ±²¨).  §° ¡®² ©²¥  «£®°¨²¬, ° ±¯®« £ ¾¹¨© ²®·ª¨ ¢ ¯®°¿¤ª¥ ¢®§° ±² ­¨¿ ° ±±²®¿­¨¿ ®² ¶¥­²°  ¨ ¨¬¥¾¹¨© ±°¥¤­¥¥ ¢°¥¬¿ ° ¡®²» (n).
(ª § ­¨¥: ¢®±¯®«¼§³©²¥±¼ ±®°²¨°®¢ª®© ¢»·¥°¯»¢ ­¨¥¬, ­® ¯®§ ¡®²¼²¥±¼ ® ²®¬, ·²®¡» ¯«®¹ ¤¨ ¿¹¨ª®¢ ¡»«¨ ° ¢­»).
9.4-4? ³±²¼ X | ±«³· ©­ ¿ ¢¥«¨·¨­ . ¥ ´³­ª¶¨¿ ° ±¯°¥¤¥«¥­¨¿
(probability distribution function) ®¯°¥¤¥«¿¥²±¿ ´®°¬³«®© P (x) =

 ¤ ·¨ ª £« ¢¥ 9

183

PfX 6 xg. °¥¤¯®«®¦¨¬, ·²® ­  ¢µ®¤  «£®°¨²¬  ¯®±²³¯ ¥² ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¨§ n ·¨±¥«, ª®²®°»¥ ¿¢«¿¾²±¿ ­¥§ ¢¨±¨¬»¬¨ ±«³· ©­»¬¨ ¢¥«¨·¨­ ¬¨ ± ´³­ª¶¨¥© ° ±¯°¥¤¥«¥­¨¿ P . ³­ª¶¨¿ P ­¥¯°¥°»¢­  ¨ ¬®¦¥² ¡»²¼ ¢»·¨±«¥­  §  ¢°¥¬¿ O(1).  ª ®²±®°²¨°®¢ ²¼ ² ª³¾ ¯®±«¥¤®¢ ²¥«¼­®±²¼, ·²®¡» ±°¥¤­¥¥ ¢°¥¬¿ ±®°²¨°®¢ª¨
«¨­¥©­® § ¢¨±¥«® ®² n?

 ¤ ·¨
9-1 ¨¦­¨¥ ®¶¥­ª¨ ¤«¿ ±°¥¤­¥£® ·¨±«  ±° ¢­¥­¨©
 ½²®© § ¤ ·¥ ¬» ¤®ª ¦¥¬, ·²® ±°¥¤­¥¥ ¢°¥¬¿ ° ¡®²» «¾¡®£®
¤¥²¥°¬¨­¨°®¢ ­­®£® ¨«¨ ¢¥°®¿²­®±²­®£®  «£®°¨²¬  ±®°²¨°®¢ª¨ n
·¨±¥«, ®±­®¢ ­­®£® ­  ±° ¢­¥­¨¿µ, ¥±²¼ 
(n lg n).  ·­¥¬ ± ²®£®,
·²® ° ±±¬®²°¨¬ ¤¥²¥°¬¨­¨°®¢ ­­»©  «£®°¨²¬ A, ®±­®¢ ­­»© ­ 
±° ¢­¥­¨¿µ; ¯³±²¼ TA | ¥£® ° §°¥¸ ¾¹¥¥ ¤¥°¥¢®. » ¯°¥¤¯®« £ ¥¬, ·²® ¢±¥ ¯¥°¥±² ­®¢ª¨ ¢µ®¤­®© ¯®±«¥¤®¢ ²¥«¼­®±²¨ ° ¢­®¢¥°®¿²­».
 .  ¯¨¸¥¬ ­  ª ¦¤®¬ «¨±²¥ ¤¥°¥¢  TA ¢¥°®¿²­®±²¼ ²®£®, ·²®
 «£®°¨²¬ § ¢¥°¸¨²±¿ ¢ ½²®¬ «¨±²¥. ®ª ¦¨²¥, ·²® ¢ n! «¨±² µ ­ ¯¨± ­® 1=n!,   ¢ ®±² «¼­»µ «¨±² µ ­ ¯¨± ­ ­³«¼.
¡. ¡®§­ ·¨¬ ·¥°¥§ D(T ) ±³¬¬³ £«³¡¨­ ¢±¥µ «¨±²¼¥¢ ¢ ¤¢®¨·­®¬ ¤¥°¥¢¥ T (¬» ¯°¥¤¯®« £ ¥¬, ·²® ª ¦¤ ¿ ¢¥°¸¨­  «¨¡® ¿¢«¿¥²±¿ «¨±²®¬, «¨¡® ¨¬¥¥² ¤¢³µ ¤¥²¥© | ² ª ³±²°®¥­» ° §°¥¸ ¾¹¨¥ ¤¥°¥¢¼¿). ³±²¼ T | ¤¥°¥¢® ± k > 1 «¨±²¼¿¬¨, ¨ ¯³±²¼ ·¥°¥§
LT ¨ RT ®¡®§­ ·¥­» «¥¢®¥ ¨ ¯° ¢®¥ ¯®¤¤¥°¥¢¼¿. ®ª ¦¨²¥, ·²®
D(T ) = D(LT ) + D(RT ) + k.
¢. ³±²¼ d(m) | ­ ¨¬¥­¼¸¥¥ §­ ·¥­¨¥ ·¨±«  D(T ) ±°¥¤¨ ¢±¥µ
¤¥°¥¢¼¥¢ T ± m «¨±²¼¿¬¨. ®ª ¦¨²¥, ·²® d(k) = min16i6k;1 fd(i) +
d(k ; i) + kg. (ª § ­¨¥: ¤¥°¥¢® LT ¬®¦¥² ±®¤¥°¦ ²¼ ®² 1 ¤® k ; 1
«¨±²¼¥¢.)
£. ®ª ¦¨²¥, ·²® ¤«¿ ´¨ª±¨°®¢ ­­®£® k ¢»° ¦¥­¨¥ i lg i + (k ;
i) lg(k ; i) ¤®±²¨£ ¥² ¬¨­¨¬³¬  ­  ®²°¥§ª¥ ®² 1 ¤® k ; 1 ¢ ²®·ª¥
i = k=2. »¢¥¤¨²¥ ®²±¾¤ , ·²® d(k) = 
(k lg k).
¤. ®ª ¦¨²¥, ·²® D(TA ) = 
(n! lg(n!)), ¨ ¢»¢¥¤¨²¥ ®²±¾¤ , ·²®
¢°¥¬¿ ±®°²¨°®¢ª¨ n ·¨±¥« ± ¯®¬®¹¼¾ ° §°¥¸ ¾¹¥£® ¤¥°¥¢  TA ,
³±°¥¤­¥­­®¥ ¯® ¢±¥¬ ¯¥°¥±² ­®¢ª ¬ ­  ¢µ®¤¥, ¥±²¼ 
(n lg n).
¥¯¥°¼ ° ±±¬®²°¨¬ ¢¥°®¿²­®±²­»©  «£®°¨²¬ B , ®±­®¢ ­­»© ­ 
±° ¢­¥­¨¿µ. £® ¬®¦­® ®¯¨± ²¼ ± ¯®¬®¹¼¾ ° §°¥¸ ¾¹¥£® ¤¥°¥¢ ,
¢ ª®²®°®¬ ¡»¢ ¾² ³§«» ¤¢³µ ²¨¯®¢: ±®®²¢¥²±²¢³¾¹¨¥ ±° ¢­¥­¨¿¬ ¨ ±«³· ©­»¬ ¢»¡®° ¬.  ³§« µ ¢²®°®£® ²¨¯  ¯°®¨±µ®¤¨² ¢»§®¢
¯°®¶¥¤³°» Random(1; r); ³ ² ª®£® ³§«  r ¤¥²¥©, ª ¦¤»© ¨§ ª®²®°»µ ¢»¡¨° ¥²±¿ ± ° ¢­®© ¢¥°®¿²­®±²¼¾. («¿ ° §­»µ ³§«®¢ ·¨±«®
r ¬®¦¥² ¡»²¼ ° §­»¬.)
¥. ³±²¼ ¨¬¥¥²±¿ ¢¥°®¿²­®±²­»©  «£®°¨²¬ ±®°²¨°®¢ª¨ B . «¿

184

« ¢  9 ®°²¨°®¢ª  §  «¨­¥©­®¥ ¢°¥¬¿

ª ¦¤®© ¯¥°¥±² ­®¢ª¨ ­  ¢µ®¤¥ ­ ©¤¥¬ ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥
·¨±«  ±° ¢­¥­¨©. ±°¥¤­¨¬ ½²¨ ®¦¨¤ ­¨¿ ¯® ¢±¥¬ ¢µ®¤ ¬; ¯®«³·¨²±¿ ­¥ª®²®°®¥ ·¨±«® T . ®ª ¦¨²¥, ·²® ±³¹¥±²¢³¥² ¤¥²¥°¬¨­¨°®¢ ­­»©  «£®°¨²¬ A, ³ ª®²®°®£® ±°¥¤­¥¥ (¯® ¢±¥¬ ¯¥°¥±² ­®¢ª ¬
­  ¢µ®¤¥) ·¨±«® ±° ¢­¥­¨© ­¥ ¯°¥¢®±µ®¤¨² T . »¢¥¤¨²¥ ®²±¾¤ ,
·²® ¤«¿ «¾¡®£® ¢¥°®¿²­®±²­®£®  «£®°¨²¬  ¬ ª±¨¬ «¼­®¥ (¯® ¢±¥¬
¢µ®¤ ¬) ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ·¨±«  ±° ¢­¥­¨© ¥±²¼ 
(n lg n).
(ª § ­¨¥. ±«¨ ±°¥¤­¥¥ ¯® ¢±¥¬ ¢µ®¤ ¬ ¨ ¢±¥¬ ¢ °¨ ­² ¬ ±«³· ©­»µ ·¨±¥« ° ¢­® T , ²® ±³¹¥±²¢³¥² ² ª®© ­ ¡®° ±«³· ©­»µ ·¨±¥«, ¯°¨ ª®²®°®¬ ±°¥¤­¥¥ ¯® ¢±¥¬ ¢µ®¤ ¬ ­¥ ¡®«¼¸¥ T .)
9-2 ®°²¨°®¢ª  ¡¥§ ¤®¯®«­¨²¥«¼­®© ¯ ¬¿²¨ §  «¨­¥©­®¥ ¢°¥¬¿
 . ³±²¼ ­ ¬ ¤ ­ ¬ ±±¨¢ § ¯¨±¥©, ª®²®°»© ­¥®¡µ®¤¨¬® ®²±®°²¨°®¢ ²¼ ¯® ª«¾·³, ¯°¨­¨¬ ¾¹¥¬³ §­ ·¥­¨¥ 0 ¨«¨ 1. °¨¤³¬ ©²¥
¯°®±²®©  «£®°¨²¬, ®±³¹¥±²¢«¿¾¹¨© ² ª³¾ ±®°²¨°®¢ª³ §  «¨­¥©­®¥ ¢°¥¬¿ ¨ ¨±¯®«¼§³¾¹¨© ¤®¯®«­¨²¥«¼­³¾ ¯ ¬¿²¼ O(1) (¨­»¬¨
±«®¢ ¬¨, ®¡º¥¬ ¤®¯®«­¨²¥«¼­®© ¯ ¬¿²¨ ­¥ § ¢¨±¨² ®² ° §¬¥°®¢
±®°²¨°³¥¬®£® ¬ ±±¨¢ ).
¡. ®¦­® «¨ ¢®±¯®«¼§®¢ ²¼±¿  «£®°¨²¬®¬ ¨§ ¯³­ª²  ( ) ¤«¿ ¶¨´°®¢®© ±®°²¨°®¢ª¨ ¯® b-¡¨²­®¬³ ª«¾·³ §  ¢°¥¬¿ O(bn)? ¡º¿±­¨²¥ ±¢®© ®²¢¥².
¢. ³±²¼ n § ¯¨±¥© ­ ¤® ®²±®°²¨°®¢ ²¼ ¯® ª«¾·³, ¯°¨­¨¬ ¾¹¥¬³ ¶¥«»¥ §­ ·¥­¨¿ ®² 1 ¤® k.  ª ¬®¤¨´¨¶¨°®¢ ²¼ ±®°²¨°®¢ª³
¯®¤±·¥²®¬, ·²®¡» ¬®¦­® ¡»«® ®²±®°²¨°®¢ ²¼ ½²¨ § ¯¨±¨ §  ¢°¥¬¿
O(n + k), ¨ ¯°¨ ½²®¬ ®¡º¥¬ ¨±¯®«¼§³¥¬®© ¯ ¬¿²¨ (¯®¬¨¬® ±®°²¨°³¥¬®£® ¬ ±±¨¢ ) ¡»« O(k)? (ª § ­¨¥.  ·­¨²¥ ±® ±«³· ¿ k = 3.)

 ¬¥· ­¨¿
­ «¨§  «£®°¨²¬®¢ ±®°²¨°®¢ª¨ ± ¯®¬®¹¼¾ ° §°¥¸ ¾¹¨µ ¤¥°¥¢¼¥¢ ¡»« ¯°¥¤«®¦¥­ ®°¤®¬ ¨ ¦®­±®­®¬ [72].  ´³­¤ ¬¥­² «¼­®© ª­¨£¥ ­³²  [123], ¯®±¢¿¹¥­­®© ±®°²¨°®¢ª¥, ° ±±¬ ²°¨¢ ¾²±¿ ¬­®£®·¨±«¥­­»¥ ¢ °¨ ­²» ½²®© § ¤ ·¨ ¨ ¤®ª §»¢ ¥²±¿ ­¨¦­¿¿
®¶¥­ª  ·¨±«  ±° ¢­¥­¨© (¯°¨¢¥¤¥­­ ¿ ¢ ½²®© £« ¢¥). ¨¦­¨¥ ®¶¥­ª¨ ¤«¿ § ¤ ·¨ ±®°²¨°®¢ª¨ ¨ ° §«¨·­»µ ®¡®¡¹¥­¨© ° §°¥¸ ¾¹¨µ
¤¥°¥¢¼¥¢ ¯®¤°®¡­® ¨§³· «¨±¼ ¥­-°®¬ [23].
®£« ±­® ­³²³, § ±«³£  ¨§®¡°¥²¥­¨¿ ±®°²¨°®¢ª¨ ¯®¤±·¥²®¬
(1954 £®¤) ¨ ¥¥ ª®¬¡¨­ ¶¨¨ ± ¶¨´°®¢®© ±®°²¨°®¢ª®© ¯°¨­ ¤«¥¦¨²
¼¾ °¤³ (H. H. Seward).  ¬  ¦¥ ¶¨´°®¢ ¿ ±®°²¨°®¢ª , ¢¨¤¨¬®,
¤ ¢­® ¯°¨¬¥­¿« ±¼ ¤«¿ ±®°²¨°®¢ª¨ ¯¥°´®ª °². ­³² ³²¢¥°¦¤ ¥²,
·²® ¯¥°¢®¥ ¯¥· ²­®¥ ®¯¨± ­¨¥ ½²®£® ¬¥²®¤  ¯®¿¢¨«®±¼ ¢ 1929 £®¤³ ¢
ª ·¥±²¢¥ ±®±² ¢­®© · ±²¨ °³ª®¢®¤±²¢  ¯® ®¡®°³¤®¢ ­¨¾ ¤«¿ ° ¡®²» ± ¯¥°´®ª °² ¬¨, ­ ¯¨± ­­®£® ®¬°¨ (L. J. Comrie). ®°²¨°®¢ª 
¢»·¥°¯»¢ ­¨¥¬ ¨±¯®«¼§³¥²±¿ ± 1956 £®¤ , ª®£¤  ©§¥ª (E. J. Isaac)

 ¬¥· ­¨¿ ª £« ¢¥ 9

¨ ¨­£«¥²®­ (R. C. Singleton) ¯°¥¤«®¦¨«¨ ®±­®¢­³¾ ¨¤¥¾.

185

10

¥¤¨ ­» ¨ ¯®°¿¤ª®¢»¥ ±² ²¨±²¨ª¨

 ½²®© £« ¢¥ ¬» ° ±±¬ ²°¨¢ ¥¬ ² ª³¾ § ¤ ·³: ¤ ­® ¬­®¦¥±²¢® ¨§
n ·¨±¥«; ­ ©²¨ ²®² ¥£® ½«¥¬¥­², ª®²®°»© ¡³¤¥² i-¬ ¯® ±·¥²³, ¥±«¨
° ±¯®«®¦¨²¼ ½«¥¬¥­²» ¬­®¦¥±²¢  ¢ ¯®°¿¤ª¥ ¢®§° ±² ­¨¿.   ­£«®¿§»·­®© «¨²¥° ²³°¥ ² ª®© ½«¥¬¥­² ­ §»¢ ¥²±¿ i-© ¯®°¿¤ª®¢®©
±² ²¨±²¨ª®© (order statistic).  ¯°¨¬¥°, ¬¨­¨¬³¬ (minimum) | ½²®
¯®°¿¤ª®¢ ¿ ±² ²¨±²¨ª  ­®¬¥° 1,   ¬ ª±¨¬³¬ (maximum) | ¯®°¿¤ª®¢ ¿ ±² ²¨±²¨ª  ­®¬¥° n. ¥¤¨ ­®© (median) ­ §»¢ ¥²±¿ ½«¥¬¥­²
¬­®¦¥±²¢ , ­ µ®¤¿¹¨©±¿ (¯® ±·¥²³) ¯®±¥°¥¤¨­¥ ¬¥¦¤³ ¬¨­¨¬³¬®¬
¨ ¬ ª±¨¬³¬®¬. ®·­¥¥ £®¢®°¿, ¥±«¨ n ­¥·¥²­®, ²® ¬¥¤¨ ­  | ½²®
¯®°¿¤ª®¢ ¿ ±² ²¨±²¨ª  ­®¬¥° i = (n + 1)=2,   ¥±«¨ n ·¥²­®, ²®
¬¥¤¨ ­ ¤ ¦¥ ¤¢¥: ± ­®¬¥° ¬¨ i = n=2 ¨ i = n=2 + 1. ®¦­® ¥¹¥
±ª § ²¼, ·²®, ­¥§ ¢¨±¨¬® ®² ·¥²­®±²¨ n, ¬¥¤¨ ­» ¨¬¥¾² ­®¬¥°
i = b(n + 1)=2c ¨ i = d(n + 1)=2e.  ¤ «¼­¥©¸¥¬ ¬» ¡³¤¥¬ ­ §»¢ ²¼ ¬¥¤¨ ­®© ¬¥­¼¸³¾ ¨§ ¤¢³µ (¥±«¨ ¨µ ¤¢¥).
«¿ ³¤®¡±²¢  ¬» ¡³¤¥¬ ±·¨² ²¼, ·²® ¬­®¦¥±²¢®, ¢ ª®²®°®¬ ¬»
¨¹¥¬ ¯®°¿¤ª®¢»¥ ±² ²¨±²¨ª¨, ±®±²®¨² ¨§ ° §«¨·­»µ ½«¥¬¥­²®¢,
µ®²¿ ¯° ª²¨·¥±ª¨ ¢±¥, ·²® ¬» ¤¥« ¥¬, ¯¥°¥­®±¨²±¿ ­  ±¨²³ ¶¨¾,
ª®£¤  ¢® ¬­®¦¥±²¢¥ ¥±²¼ ¯®¢²®°¿¾¹¨¥±¿ ½«¥¬¥­²».  ¤ ·  ¢»¡®° 
½«¥¬¥­²  ± ¤ ­­»¬ ­®¬¥°®¬ (selection problem) ±®±²®¨² ¢ ±«¥¤³¾¹¥¬:
 ­®: ­®¦¥±²¢® A ¨§ n ° §«¨·­»µ ½«¥¬¥­²®¢ ¨ ¶¥«®¥ ·¨±«® i,
1 6 i 6 n.
 ©²¨: «¥¬¥­² x 2 A, ¤«¿ ª®²®°®£® °®¢­® i ; 1 ½«¥¬¥­²®¢ ¬­®¦¥±²¢  A ¬¥­¼¸¥ x.
²³ § ¤ ·³ ¬®¦­® °¥¸¨²¼ §  ¢°¥¬¿ O(n lg n): ®²±®°²¨°®¢ ²¼ ·¨±« ,
¯®±«¥ ·¥£® ¢§¿²¼ i-© ½«¥¬¥­² ¢ ¯®«³·¥­­®¬ ¬ ±±¨¢¥. ±²¼, ®¤­ ª®,
¨ ¡®«¥¥ ¡»±²°»¥  «£®°¨²¬».
 ° §¤¥«¥ 10.1 ¬» ° ±±¬®²°¨¬ ¯°®±²¥©¸¨© ±«³· ©: ­ µ®¦¤¥­¨¥
¬ ª±¨¬ «¼­®£® ¨ ¬¨­¨¬ «¼­®£® ½«¥¬¥­²®¢. ¡¹ ¿ § ¤ ·  ¡®«¥¥
¨­²¥°¥±­ ; ¥© ¯®±¢¿¹¥­» ¤¢  ±«¥¤³¾¹¨µ ° §¤¥« .  ° §¤¥«¥ 10.2
¬» ° ±±¬ ²°¨¢ ¥¬ ³¤®¡­»© ­  ¯° ª²¨ª¥ ¢¥°®¿²­®±²­»©  «£®°¨²¬,
ª®²®°»© ¨¹¥² ¯®°¿¤ª®¢³¾ ±² ²¨±²¨ª³ §  ¢°¥¬¿ O(n) ¢ ±°¥¤­¥¬
(¨¬¥¥²±¿ ¢ ¢¨¤³ ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ¢°¥¬¥­¨ ¥£® ° ¡®²»
­  «¾¡®¬ ¢µ®¤¥).  ° §¤¥«¥ 10.3 ¬» ° ±±¬ ²°¨¢ ¥¬ (¯°¥¤±² ¢«¿-

¨­¨¬³¬ ¨ ¬ ª±¨¬³¬

187

¾¹¨© ±ª®°¥¥ ²¥®°¥²¨·¥±ª¨© ¨­²¥°¥±) ¤¥²¥°¬¨­¨°®¢ ­­»©  «£®°¨²¬, ²°¥¡³¾¹¨© ¢°¥¬¥­¨ O(n) ¢ µ³¤¸¥¬ ±«³· ¥.

10.1. ¨­¨¬³¬ ¨ ¬ ª±¨¬³¬
ª®«¼ª® ±° ¢­¥­¨© ­¥®¡µ®¤¨¬®, ·²®¡» ¢® ¬­®¦¥±²¢¥ ¨§ n ·¨±¥«
­ ©²¨ ­ ¨¬¥­¼¸¥¥?   n ; 1 ±° ¢­¥­¨© ½²® ±¤¥« ²¼ «¥£ª®: ­ ¤® ¯®±«¥¤®¢ ²¥«¼­® ¯¥°¥¡¨° ²¼ ¢±¥ ·¨±« , µ° ­¿ §­ ·¥­¨¥ ­ ¨¬¥­¼¸¥£®
·¨±«  ¨§ ³¦¥ ¯°®±¬®²°¥­­»µ.  ¯¨¸¥¬ ½²®²  «£®°¨²¬, ±·¨² ¿, ·²®
·¨±«  § ¤ ­» ¢ ¢¨¤¥ ¬ ±±¨¢  A ¤«¨­» n.
Minimum(A)
1 min A[1]
2 for i 2 to length[A]
3
do if min > A[i]
4
then min A[i]
5 return min
 §³¬¥¥²±¿,  ­ «®£¨·­»¬ ®¡° §®¬ ¬®¦­® ­ ©²¨ ¨ ¬ ª±¨¬³¬.
®¦­® «¨ ­ ©²¨ ¬¨­¨¬³¬ ¥¹¥ ¡»±²°¥¥? ¥², ¨ ¢®² ¯®·¥¬³.  ±±¬®²°¨¬  «£®°¨²¬ ­ µ®¦¤¥­¨¿ ­ ¨¬¥­¼¸¥£® ·¨±«  ª ª ²³°­¨° ±°¥¤¨ n ·¨±¥«,   ª ¦¤®¥ ±° ¢­¥­¨¥ | ª ª ¬ ²·, ¢ ª®²®°®¬ ¬¥­¼¸¥¥
·¨±«® ¯®¡¥¦¤ ¥². ²®¡» ¯®¡¥¤¨²¥«¼ ¡»« ­ ©¤¥­, ª ¦¤®¥ ¨§ ®±² «¼­»µ ·¨±¥« ¤®«¦­® ¯°®¨£° ²¼ ¯® ª° ©­¥© ¬¥°¥ ®¤¨­ ¬ ²·, ² ª ·²®
¬¥­¼¸¥ n ; 1 ±° ¢­¥­¨© ¡»²¼ ­¥ ¬®¦¥², ¨  «£®°¨²¬ Minimum ®¯²¨¬ «¥­ ¯® ·¨±«³ ±° ¢­¥­¨©.
­²¥°¥±­»© ¢®¯°®±, ±¢¿§ ­­»© ± ½²¨¬  «£®°¨²¬®¬ | ­ µ®¦¤¥­¨¥ ¬ ²¥¬ ²¨·¥±ª®£® ®¦¨¤ ­¨¿ ·¨±«  ¨±¯®«­¥­¨© ±²°®ª¨ 4.  § ¤ ·¥ 6-2 ²°¥¡³¥²±¿ ¯®ª § ²¼, ·²® ½²  ¢¥«¨·¨­  ¥±²¼ (lg n).
¤­®¢°¥¬¥­­»© ¯®¨±ª ¬¨­¨¬³¬  ¨ ¬ ª±¨¬³¬ 
­®£¤  ¡»¢ ¥² ­³¦­® ­ ©²¨ ®¤­®¢°¥¬¥­­® ¬¨­¨¬ «¼­»© ¨ ¬ ª±¨¬ «¼­»© ½«¥¬¥­²» ¬­®¦¥±²¢ . °¥¤±² ¢¨¬ ±¥¡¥ ¯°®£° ¬¬³, ª®²®° ¿ ¤®«¦­  ³¬¥­¼¸¨²¼ °¨±³­®ª (­ ¡®° ²®·¥ª, § ¤ ­­»µ ±¢®¨¬¨
ª®®°¤¨­ ² ¬¨) ² ª, ·²®¡» ®­ ³¬¥±²¨«±¿ ­  ½ª° ­¥. «¿ ½²®£® ­³¦­® ­ ©²¨ ¬ ª±¨¬³¬ ¨ ¬¨­¨¬³¬ ¯® ª ¦¤®© ª®®°¤¨­ ²¥.
±«¨ ¬» ¯®¯°®±²³ ­ ©¤¥¬ ±­ · «  ¬¨­¨¬³¬,   ¯®²®¬ ¬ ª±¨¬³¬,
§ ²° ²¨¢ ­  ª ¦¤»© ¨§ ­¨µ ¯® n ; 1 ±° ¢­¥­¨©, ²® ¢±¥£® ¡³¤¥²
2n ; 2 ±° ¢­¥­¨¿, ·²®  ±¨¬¯²®²¨·¥±ª¨ ®¯²¨¬ «¼­®. ®¦­®, ®¤­ ª®, °¥¸¨²¼ ½²³ § ¤ ·³ ¢±¥£® §  3dn=2e ; 2 ±° ¢­¥­¨©. ¬¥­­®, ¡³¤¥¬ µ° ­¨²¼ §­ ·¥­¨¿ ¬ ª±¨¬³¬  ¨ ¬¨­¨¬³¬  ³¦¥ ¯°®±¬®²°¥­­»µ
·¨±¥«,   ®·¥°¥¤­»¥ ·¨±«  ¡³¤¥¬ ®¡° ¡ ²»¢ ²¼ ¯® ¤¢  ² ª¨¬ ®¡° §®¬: ±­ · «  ±° ¢­¨¬ ¤¢  ®·¥°¥¤­»µ ·¨±«  ¤°³£ ± ¤°³£®¬,   § ²¥¬

188

« ¢  10 ¥¤¨ ­» ¨ ¯®°¿¤ª®¢»¥ ±² ²¨±²¨ª¨

¡®«¼¸¥¥ ¨§ ­¨µ ±° ¢­¨¬ ± ¬ ª±¨¬³¬®¬,   ¬¥­¼¸¥¥ | ± ¬¨­¨¬³¬®¬.
°¨ ½²®¬ ­  ®¡° ¡®²ª³ ¤¢³µ ½«¥¬¥­²®¢ ¬» § ²° ²¨¬ ²°¨ ±° ¢­¥­¨¿ ¢¬¥±²® ·¥²»°¥µ (ª°®¬¥ ¯¥°¢®© ¯ °», £¤¥ ¯®­ ¤®¡¨²±¿ ¢±¥£®
®¤­® ±° ¢­¥­¨¥).
¯° ¦­¥­¨¿
10.1-1 ®ª ¦¨²¥, ·²® ¢²®°®¥ ¯® ¢¥«¨·¨­¥ ·¨±«® ¨§ n ¤ ­­»µ
¬®¦­® ­ ©²¨ ¢ µ³¤¸¥¬ ±«³· ¥ §  n + dlg ne ; 2 ±° ¢­¥­¨¿. (ª § ­¨¥. ¹¨²¥ ½²® ·¨±«® ¢¬¥±²¥ ± ­ ¨¬¥­¼¸¨¬.)
10.1-2? ®ª ¦¨²¥, ·²® ¤«¿ ®¤­®¢°¥¬¥­­®£® ­ µ®¦¤¥­¨¿ ­ ¨¡®«¼¸¥£® ¨ ­ ¨¬¥­¼¸¥£® ¨§ n ·¨±¥« ¢ µ³¤¸¥¬ ±«³· ¥ ­¥®¡µ®¤¨¬® ­¥
¬¥­¥¥ d3n=2e ; 2 ±° ¢­¥­¨©. (ª § ­¨¥.  ª ¦¤»© ¬®¬¥­² ½«¥¬¥­²» ¤¥«¿²±¿ ­  ·¥²»°¥ £°³¯¯»: (1) ­¥¯°®±¬®²°¥­­»¥ (ª®²®°»¥ ¬®£³² ®ª § ²¼±¿ ¨ ¬¨­¨¬ «¼­»¬¨, ¨ ¬ ª±¨¬ «¼­»¬¨); (2) ²¥, ·²®
¥¹¥ ¬®£³² ®ª § ²¼±¿ ¬¨­¨¬ «¼­»¬¨, ­® § ¢¥¤®¬® ­¥ ¬ ª±¨¬ «¼­»;
(3) ²¥, ·²® ¥¹¥ ¬®£³² ®ª § ²¼±¿ ¬ ª±¨¬ «¼­»¬¨, ­® ­¥ ¬¨­¨¬ «¼­»¬¨; (4) ®²¡°®¸¥­­»¥ (ª®²®°»¥ § ¢¥¤®¬® ­¥ ¬¨­¨¬ «¼­» ¨ ­¥
¬ ª±¨¬ «¼­»). ³±²¼ a1 ; a2; a3; a4 | ª®«¨·¥±²¢® ½«¥¬¥­²®¢ ª ¦¤®©
£°³¯¯».  ª ¬¥­¿¾²±¿ ½²¨ ·¨±«  ¯°¨ ±° ¢­¥­¨¿µ?)

10.2. »¡®° §  «¨­¥©­®¥ ¢ ±°¥¤­¥¬ ¢°¥¬¿
®²¿ ®¡¹ ¿ § ¤ ·  ¢»¡®°  ¢»£«¿¤¨² ¡®«¥¥ ±«®¦­®©, ·¥¬ § ¤ ·  ®
¬¨­¨¬³¬¥ ¨«¨ ¬ ª±¨¬³¬¥, ¥¥, ª ª ­¨ ±²° ­­®, ²®¦¥ ¬®¦­® °¥¸¨²¼
§  ¢°¥¬¿ (n).  ½²®¬ ° §¤¥«¥ ¬» ° ±±¬®²°¨¬ ¢¥°®¿²­®±²­»©  «£®°¨²¬ Randomized-Select ¤«¿ °¥¸¥­¨¿ ½²®© § ¤ ·¨, ¤¥©±²¢³¾¹¨© ¯® ±µ¥¬¥ À° §¤¥«¿© ¨ ¢« ±²¢³©Á. ­  ­ «®£¨·¥­  «£®°¨²¬³
¡»±²°®© ±®°²¨°®¢ª¨ ¨§ £« ¢» 8: ¬ ±±¨¢ ° §¡¨¢ ¥²±¿ ­  ¬¥­¼¸¨¥
· ±²¨. ¤­ ª®  «£®°¨²¬ ¡»±²°®© ±®°²¨°®¢ª¨, ° §¡¨¢ ¬ ±±¨¢ ­ 
¤¢  ª³±ª , ®¡° ¡ ²»¢ ¥² ®¡ ,    «£®°¨²¬ Randomized-Select |
²®«¼ª® ®¤¨­ ¨§ ½²¨µ ª³±ª®¢. ®½²®¬³ ®­ ¡»±²°¥¥: ±°¥¤­¥¥ ¢°¥¬¿ ¡»±²°®© ±®°²¨°®¢ª¨ ¥±²¼ (n lg n), ¢ ²® ¢°¥¬¿ ª ª  «£®°¨²¬
Randomized-Select ° ¡®² ¥² ¢ ±°¥¤­¥¬ §  ¢°¥¬¿ (n).
«£®°¨²¬ Randomized-Select
¨±¯®«¼§³¥² ¯°®¶¥¤³°³ Randomized-Partition, ®¯¨± ­­³¾ ¢ ° §¤¥«¥ 8.3, ¯®¢¥¤¥­¨¥
ª®²®°®© (¨, ±² «® ¡»²¼, ¢±¥£®  «£®°¨²¬ ) § ¢¨±¨² ®² ¤ ²·¨ª  ±«³· ©­»µ ·¨±¥«. »§®¢ Randomized-Select(A; p; r; i) ¢®§¢° ¹ ¥²
i-© ¯® ±·¥²³ ¢ ¯®°¿¤ª¥ ¢®§° ±² ­¨¿ ½«¥¬¥­² ¬ ±±¨¢  A[p : :r].

»¡®° §  «¨­¥©­®¥ ¢ ±°¥¤­¥¬ ¢°¥¬¿

Randomized-Select (A; p; r; i)

189

1 if p = r
2 then return A[p]
3 q Randomized-Partition(A; p; r)
4 k q;p+1
5 if i 6 k
6 then return Randomized-Select(A; p; q; i)
7 else return Randomized-Select(A; q + 1; r; i ; k)
®±«¥ ¨±¯®«­¥­¨¿ ¯°®¶¥¤³°» Randomized-Partition ¢ ±²°®ª¥ 3
¬ ±±¨¢ A[p : :r] ±®±²®¨² ¨§ ¤¢³µ ­¥¯³±²»µ · ±²¥© A[p : :q ] ¨ A[q +
1 : :r], ¯°¨·¥¬ ¢±¿ª¨© ½«¥¬¥­² A[p : :q ] ¬¥­¼¸¥ ¢±¿ª®£® ½«¥¬¥­² 
A[q +1 : :r].  ±²°®ª¥ 4 ¢»·¨±«¿¥²±¿ ª®«¨·¥±²¢® ½«¥¬¥­²®¢ ¢ ¬ ±±¨¢¥
A[p : :q].  «¼­¥©¸¥¥ § ¢¨±¨² ®² ²®£®, ¢ ª ª®¬ ¨§ ½²¨µ ¤¢³µ ¬ ±±¨¢®¢ «¥¦¨² i-© ¯® ¢¥«¨·¨­¥ ½«¥¬¥­² ¬ ±±¨¢  A[p : :r]. ±«¨ i 6 k, ²®
­³¦­»© ­ ¬ ½«¥¬¥­² «¥¦¨² ¢ «¥¢®© · ±²¨ (¬ ±±¨¢¥ A[p : :q ]), ®²ª³¤ 
¨ ¨§¢«¥ª ¥²±¿ ¢ °¥§³«¼² ²¥ (°¥ª³°±¨¢­®£®) ¢»§®¢  RandomizedSelect ¢ ±²°®ª¥ 6. ±«¨ ¦¥ i > k, ²® ¢±¥ k ½«¥¬¥­²®¢ «¥¢®© · ±²¨
(A[p : :q ]) § ¢¥¤®¬® ¬¥­¼¸¥ ¨±ª®¬®£®, ª®²®°»© ¬®¦­® ­ ©²¨ ª ª
(i ; k)-© ¯® ±·¥²³ ½«¥¬¥­² ¬ ±±¨¢  A[q + 1 : :r] (±²°®ª  7).
°¥¬¿ ° ¡®²»  «£®°¨²¬  Randomized-Select (± ³·¥²®¬ ¢°¥¬¥­¨ ° ¡®²» ¯°®¶¥¤³°» Randomized-Partition) ¢ µ³¤¸¥¬ ±«³· ¥
¥±²¼ (n2 ), ¤ ¦¥ ¥±«¨ ¬» ¨¹¥¬ ¢±¥£® «¨¸¼ ¬¨­¨¬³¬: ¢ ± ¬®¬ ¤¥«¥,
¯°¨ ®±®¡®¬ ­¥¢¥§¥­¨¨ ¬®¦¥² ®ª § ²¼±¿, ·²® ¬» ¢±¥ ¢°¥¬¿ ° §¡¨¢ ¥¬ ¬ ±±¨¢ ¢®§«¥ ­ ¨¡®«¼¸¥£® ®±² ¢¸¥£®±¿ ½«¥¬¥­² . ¤­ ª® ±«³· ©­»© ¢»¡®° £ ° ­²¨°³¥², ·²® ¤«¿ «¾¡®£® ¢µ®¤  ±°¥¤­¥¥ ¢°¥¬¿
° ¡®²»  «£®°¨²¬  ¡³¤¥² ­¥¢¥«¨ª®.
®ª ¦¥¬ ½²®.  ±±¬®²°¨¬ ¤«¿ ª ¦¤®© ¨§ ¢®§¬®¦­»µ ¯¥°¥±² ­®¢®ª n ½«¥¬¥­²®¢ ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ¢°¥¬¥­¨ ° ¡®²»  «£®°¨²¬  (±°¥¤­¥¥ ¯® ¢±¥¬ ±«³· ©­»¬ ¢»¡®° ¬). ³±²¼ T (n) | ¬ ª±¨¬ «¼­®¥ ¨§ ½²¨µ ®¦¨¤ ­¨©.  ª ¬» ®²¬¥· «¨ ¢ ° §¤¥«¥ 8.4, ¯®±«¥
¢»§®¢  Randomized-Partition «¥¢ ¿ · ±²¼ ° §¡¨¥­¨¿ ±®¤¥°¦¨² 1
½«¥¬¥­² ± ¢¥°®¿²­®±²¼¾ 2=n, ¨ ±®¤¥°¦¨² i > 1 ½«¥¬¥­²®¢ ± ¢¥°®¿²­®±²¼¾ 1=n ¤«¿ «¾¡®£® i ®² 2 ¤® n ; 1. ®¦­® ±·¨² ²¼, ·²® T (n)
¬®­®²®­­® ¢®§° ±² ¥² ± °®±²®¬ n (¥±«¨ ½²® ­¥ ² ª, § ¬¥­¨¬ T (n)
­  T 0(n) = max16i6n T (i) ¨ ¯®¢²®°¨¬ ¢±¥ ° ±±³¦¤¥­¨¿ ¤«¿ T 0).  ¬¥²¨¬, ·²® µ³¤¸¨¬ ±«³· ¥¬ ¡³¤¥² ²®², ª®£¤  i-© ¯® ±·¥²³ ½«¥¬¥­²
¯®¯ ¤ ¥² ¢ ¡®«¼¸³¾ ¨§ ¤¢³µ ¯®«®¢¨­, ­  ª®²®°»¥ ° §¡¨¢ ¥²±¿ ¬ ±-

190

« ¢  10 ¥¤¨ ­» ¨ ¯®°¿¤ª®¢»¥ ±² ²¨±²¨ª¨

±¨¢. ²±¾¤  ¨¬¥¥¬:

!

nX
;1
T (n) 6 n1 T (max(1; n ; 1)) + T (max(k; n ; k)) + O(n)
k=1

0

1

nX
;1
T (k)A + O(n)
6 n1 @T (n ; 1) + 2

= n2

nX
;1
k=dn=2e

k=dn=2e

T (k) + O(n)

(¬» ±£°³¯¯¨°®¢ «¨ ®¤¨­ ª®¢»¥ ±« £ ¥¬»¥ ¯°¨ ¯¥°¥µ®¤¥ ®² ¯¥°¢®©
±²°®ª¨ ª® ¢²®°®© ¨ ®²¡°®±¨«¨ T (n ; 1)=n ¯°¨ ¯¥°¥µ®¤¥ ®² ¢²®°®©
±²°®ª¨ ª ²°¥²¼¥©, ² ª ª ª ¢ µ³¤¸¥¬ ±«³· ¥ T (n ; 1) = O(n2 ), ¨ ²¥¬
± ¬»¬ ±« £ ¥¬®¥ T (n ; 1)=n ¬®¦­® ¢ª«¾·¨²¼ ¢ O(n)).
¥¯¥°¼ ¤®ª ¦¥¬, ·²® T (n) 6 cn, ° ±±³¦¤ ¿ ¯® ¨­¤³ª¶¨¨ (ª ª
¢»¡° ²¼ c, ¬» ±ª ¦¥¬ ¯®±«¥).  ± ¬®¬ ¤¥«¥, ¯³±²¼ ­¥° ¢¥­±²¢®
T (j ) 6 cj ¢¥°­® ¤«¿ ¢±¥µ j < n. ®£¤ , ¨±¯®«¼§³¿ ´®°¬³«³ ¤«¿
±³¬¬»  °¨´¬¥²¨·¥±ª®© ¯°®£°¥±±¨¨, ¯®«³· ¥¬, ·²®

T (n) 6 n2

nX
;1
k=dn=2e

ck + O(n)

6 2nc  n2  n=2 + 12+ n ; 1 + O(n)
= 3cn + O(n) 6 cn;
4
¥±«¨ ¢»¡° ²¼ c ±²®«¼ ¡®«¼¸¨¬, ·²®¡» c=4 ¯°¥¢®±µ®¤¨«® ª®­±² ­²³,
¯®¤° §³¬¥¢ ¥¬³¾ ¢ ±« £ ¥¬®¬ O(n).
² «® ¡»²¼, «¾¡ ¿ ¯®°¿¤ª®¢ ¿ ±² ²¨±²¨ª , ¨ ¬¥¤¨ ­  ¢ ²®¬ ·¨±«¥, ¬®¦¥² ¡»²¼ ­ ©¤¥­  §  «¨­¥©­®¥ ¢ ±°¥¤­¥¬ ¢°¥¬¿.
¯° ¦­¥­¨¿
10.2-1  ¯¨¸¨²¥ ¢¥°±¨¾ ¯°®¶¥¤³°» Randomized-Select, ­¥ ¨±¯®«¼§³¾¹³¾ °¥ª³°±¨¨.
10.2-2 °¥¤¯®«®¦¨¬, ·²® ¬» ¨±¯®«¼§³¥¬  «£®°¨²¬ RandomizedSelect ¤«¿ ¢»¡®°  ­ ¨¬¥­¼¸¥£® ½«¥¬¥­²  ¨§ ¬ ±±¨¢  A =
h3; 2; 9; 0; 7; 5; 4; 8; 6; 1i. ¯¨¸¨²¥ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ° §¡¨¥­¨©,
±®®²¢¥²±²¢³¾¹³¾ µ³¤¸¥¬³ ±«³· ¾.
10.2-3 ³¤¥² «¨  «£®°¨²¬ Randomized-Select ¯° ¢¨«¼­® ° ¡®² ²¼, ¥±«¨ ¢ ¬ ±±¨¢¥ A ¥±²¼ ° ¢­»¥ ½«¥¬¥­²» (ª ª ¬» ¯®¬­¨¬, ¢
½²®¬ ±«³· ¥ ¯°®¶¥¤³°  Randomized-Partition ° §¡¨¢ ¥² A[p : :r]

»¡®° §  «¨­¥©­®¥ ¢ µ³¤¸¥¬ ±«³· ¥ ¢°¥¬¿

191

­  · ±²¨ A[p : :q ] ¨ A[q + 1 : :r] ² ª¨¬ ®¡° §®¬, ·²® ¢±¿ª¨© ½«¥¬¥­²
A[p : :q] ­¥ ¯°¥¢®±µ®¤¨² ¢±¿ª®£® ½«¥¬¥­²  A[q + 1 : :r])?

10.3. »¡®° §  «¨­¥©­®¥ ¢ µ³¤¸¥¬ ±«³· ¥ ¢°¥¬¿
¥¯¥°¼ ° ±±¬®²°¨¬ (¤¥²¥°¬¨­¨°®¢ ­­»©)  «£®°¨²¬ Select, °¥¸ ¾¹¨© § ¤ ·³ ® ¯®°¿¤ª®¢»µ ±² ²¨±²¨ª µ §  ¢°¥¬¿ O(n) ¢ µ³¤¸¥¬ ±«³· ¥.  ª ¨ Randomized-Select, ½²®²  «£®°¨²¬ ®±­®¢ ­
­  ¯®±«¥¤®¢ ²¥«¼­®¬ ° §¡¨¥­¨¨ ¬ ±±¨¢  ­  ¬¥­¼¸¨¥ · ±²¨; ¢ ¤ ­­®¬ ±«³· ¥, ®¤­ ª®, ¬» £ ° ­²¨°³¥¬, ·²® ¢»¡° ­­®¥ ° §¡¨¥­¨¥ ­¥
¿¢«¿¥²±¿ ­¥³¤ ·­»¬. «£®°¨²¬ Select ¨±¯®«¼§³¥² (¤¥²¥°¬¨­¨°®¢ ­­³¾) ¯°®¶¥¤³°³ Partition (±¬. ®¯¨± ­¨¥  «£®°¨²¬  ¡»±²°®©
±®°²¨°®¢ª¨ ¢ ° §¤. 8.1), ¬®¤¨´¨¶¨°®¢ ­­³¾ ² ª¨¬ ®¡° §®¬, ·²®¡» ½«¥¬¥­², ± ª®²®°»¬ ±° ¢­¨¢ ¾², § ¤ ¢ «±¿ ª ª ¯ ° ¬¥²°.
«£®°¨²¬ Select ­ µ®¤¨² i-© ¯® ¯®°¿¤ª³ ½«¥¬¥­² ¢ ¬ ±±¨¢¥ ° §¬¥°  n > 1 ±«¥¤³¾¹¨¬ ®¡° §®¬:
1.  §¡¨²¼ n ½«¥¬¥­²®¢ ¬ ±±¨¢  ­  bn=5c £°³¯¯ ¯® 5 ½«¥¬¥­²®¢ ¨
(¢®§¬®¦­®) ®¤­³ £°³¯¯³, ¢ ª®²®°®© ¬¥­¥¥ ¯¿²¨ ½«¥¬¥­²®¢.
2.  ©²¨ ¬¥¤¨ ­³ ª ¦¤®© ¨§ dn=5e £°³¯¯ (¤«¿ ·¥£® ®²±®°²¨°®¢ ²¼
£°³¯¯³ ¢±² ¢ª ¬¨).
3. »§¢ ¢ (°¥ª³°±¨¢­®) ¯°®¶¥¤³°³ Select, ­ ©²¨ ·¨±«® x, ¿¢«¿¾¹¥¥±¿ ¬¥¤¨ ­®© ­ ©¤¥­­»µ dn=5e ¬¥¤¨ ­.
4. »§¢ ¢ ¬®¤¨´¨¶¨°®¢ ­­³¾ ¯°®¶¥¤³°³ Partition, ° §¡¨²¼ ¬ ±±¨¢ ®²­®±¨²¥«¼­® ­ ©¤¥­­®© À¬¥¤¨ ­» ¬¥¤¨ ­Á. ³±²¼ k | ª®«¨·¥±²¢® ½«¥¬¥­²®¢ ¢ ­¨¦­¥© · ±²¨ ½²®£® ° §¡¨¥­¨¿ (¢ ¢¥°µ­¥©
· ±²¨, ±² «® ¡»²¼, n ; k).
5. »§¢ ¢ (°¥ª³°±¨¢­®) ¯°®¶¥¤³°³ Select, ­ ©²¨ i-³¾ ¯®°¿¤ª®¢³¾ ±² ²¨±²¨ª³ ­¨¦­¥© · ±²¨ ° §¡¨¥­¨¿, ¥±«¨ i 6 k, ¨«¨ (i ; k)¾ ¯®°¿¤ª®¢³¾ ±² ²¨±²¨ª³ ¢¥°µ­¥© · ±²¨ ° §¡¨¥­¨¿, ¥±«¨ i > k.
¶¥­¨¬ ¢°¥¬¿ ° ¡®²»  «£®°¨²¬  Select. «¿ ­ · «  ¢»¿±­¨¬, ±ª®«¼ª® ·¨±¥« § ¢¥¤®¬® ¡³¤³² ¡®«¼¸¥ À¬¥¤¨ ­» ¬¥¤¨ ­Á x
(±¬. °¨±. 10.1). ¥ ¬¥­¥¥ ¯®«®¢¨­» ¬¥¤¨ ­, ­ ©¤¥­­»µ ­  ¢²®°®¬
¸ £¥, ¡³¤³² ¡®«¼¸¥ ¨«¨ ° ¢­» x. ² «® ¡»²¼, ¯® ª° ©­¥© ¬¥°¥
¯®«®¢¨­  ¨§ dn=5e £°³¯¯ ¤ ±² ¯® ²°¨ ·¨±« , ¡®«¼¸¨µ x, §  ¤¢³¬¿
¢®§¬®¦­»¬¨ ¨±ª«¾·¥­¨¿¬¨: £°³¯¯ , ±®¤¥°¦ ¹ ¿ x, ¨ ¯®±«¥¤­¿¿
­¥¯®«­ ¿ £°³¯¯ . ¥¬ ± ¬»¬ ¨¬¥¥²±¿ ­¥ ¬¥­¥¥
 l m

3 21 n5 ; 2 > 310n ; 6:
½«¥¬¥­²®¢, § ¢¥¤®¬® ¡®«¼¸¨µ x, ¨ ²®·­® ² ª ¦¥ ¯®«³· ¥¬, ·²® ¨¬¥¥²±¿ ­¥ ¬¥­¥¥ 3n=10 ; 6 ½«¥¬¥­²®¢, § ¢¥¤®¬® ¬¥­¼¸¨µ x. ­ ·¨²,
 «£®°¨²¬ Select, °¥ª³°±¨¢­® ¢»§»¢ ¥¬»© ­  ¯¿²®¬ ¸ £¥, ¡³¤¥²
®¡° ¡ ²»¢ ²¼ ¬ ±±¨¢ ¤«¨­®© ­¥ ¡®«¥¥ 7n=10 + 6.

192

« ¢  10 ¥¤¨ ­» ¨ ¯®°¿¤ª®¢»¥ ±² ²¨±²¨ª¨

­ «¨§  «£®°¨²¬  Select. «¥¬¥­²» ¬ ±±¨¢  (¨µ n) ¨§®¡° ¦¥­»
ª°³¦ª ¬¨, ª ¦¤»© ±²®«¡¥¶ | £°³¯¯  ¨§ 5 ¨«¨ ¬¥­¼¸¥ ½«¥¬¥­²®¢, ¡¥«»¥ ª°³¦ª¨ | ¬¥¤¨ ­» £°³¯¯. À¥¤¨ ­  ¬¥¤¨ ­Á ®¡®§­ ·¥­  ¡³ª¢®© x. ²°¥«ª¨ ¨¤³²
®² ¡®«¼¸¨µ ·¨±¥« ª ¬¥­¼¸¨¬. ¨¤­®, ·²® ¢ ª ¦¤®¬ ¨§ ¯®«­»µ ±²®«¡¶®¢ ¯° ¢¥¥
x ¨¬¥¥²±¿ ²°¨ ·¨±« , ¡®«¼¸¨µ x, ¨ ·²® ¢ ª ¦¤®¬ ¨§ ±²®«¡¶®¢ «¥¢¥¥ x ¨¬¥¥²±¿
²°¨ ·¨±« , ¬¥­¼¸¨µ x. ­®¦¥±²¢® ·¨±¥«, § ¢¥¤®¬® ¡®«¼¸¨µ x, ¢»¤¥«¥­® ±¥°»¬.
¨±. 10.1

³±²¼ ²¥¯¥°¼ T (n) | ¢°¥¬¿ ° ¡®²»  «£®°¨²¬  Select ­  ¬ ±±¨¢¥ ¨§ n ½«¥¬¥­²®¢ ¢ µ³¤¸¥¬ ±«³· ¥. ¥°¢»©, ¢²®°®© ¨ ·¥²¢¥°²»©
¸ £¨ ¢»¯®«­¿¾²±¿ §  ¢°¥¬¿ O(n) (­  ¢²®°®¬ ¸ £¥ ¬» O(n) ° § ±®°²¨°³¥¬ ¬ ±±¨¢» ° §¬¥°®¬ O(1)), ²°¥²¨© ¸ £ ¢»¯®«­¿¥²±¿ §  ¢°¥¬¿
­¥ ¡®«¥¥ T (dn=5e),   ¯¿²»© ¸ £, ¯® ¤®ª § ­­®¬³, | §  ¢°¥¬¿, ­¥
¯°¥¢®±µ®¤¿¹¥¥ T (b7n=10+6c) (ª ª ¨ ° ­¼¸¥, ¬®¦­® ¯°¥¤¯®« £ ²¼,
·²® T (n) ¬®­®²®­­® ¢®§° ±² ¥² ± °®±²®¬ n). ² «® ¡»²¼,

T (n) 6 T (dn=5e) + T (b7n=10 + 6c) + O(n):
®±ª®«¼ª³ ±³¬¬  ª®½´´¨¶¨¥­²®¢ ¯°¨ n ¢ ¯° ¢®© · ±²¨ (1=5 +
7=10 = 9=10) ¬¥­¼¸¥ ¥¤¨­¨¶», ¨§ ½²®£® °¥ª³°°¥­²­®£® ±®®²­®¸¥­¨¿ ¢»²¥ª ¥², ·²® T (n) 6 cn ¤«¿ ­¥ª®²®°®© ª®­±² ­²» c. ²®

¬®¦­® ¤®ª § ²¼ ¯® ¨­¤³ª¶¨¨.  ± ¬®¬ ¤¥«¥, ¯°¥¤¯®« £ ¿, ·²®
T (m) 6 cm ¤«¿ ¢±¥µ m < n, ¨¬¥¥¬
T (n) 6 c(dn=5e) + c(b7n=10 + 6c) + O(n)
6 c(n=5 + 1) + c(7n=10 + 6) + O(n)
6 9cn=10 + 7c + O(n) =
= cn ; c(n=10 ; 7) + O(n):
°¨ ¯®¤µ®¤¿¹¥¬ ¢»¡®°¥ c ½²® ¢»° ¦¥­¨¥ ¡³¤¥² ­¥ ¡®«¼¸¥ cn ¯°¨
¢±¥µ n > 70 (­ ¤®, ·²®¡» c(n=10 ; 6) ¯°¥¢®±µ®¤¨«® ª®½´´¨¶¨¥­²,
¯®¤° §³¬¥¢ ¥¬»© ¢ O(n)).  ª¨¬ ®¡° §®¬, ¨­¤³ª²¨¢­»© ¯¥°¥µ®¤
¢®§¬®¦¥­ ¯°¨ n > 70 (§ ¬¥²¨¬ ¥¹¥, ·²® ¯°¨ ² ª¨µ n ¢»° ¦¥­¨¿
dn=5e ¨ b7n=10 + 6c ¬¥­¼¸¥ n).
¢¥«¨·¨¢ c ¥¹¥ (¥±«¨ ­ ¤®), ¬®¦­® ¤®¡¨²¼±¿ ²®£®, ·²®¡» T (n)
­¥ ¯°¥¢®±µ®¤¨«® cn ¨ ¯°¨ ¢±¥µ n 6 70, ·²® § ¢¥°¸ ¥² ° ±±³¦¤¥­¨¥
¯® ¨­¤³ª¶¨¨. ² «® ¡»²¼,  «£®°¨²¬ Select ° ¡®² ¥² §  «¨­¥©­®¥
¢°¥¬¿ (¢ µ³¤¸¥¬ ±«³· ¥).

»¡®° §  «¨­¥©­®¥ ¢ µ³¤¸¥¬ ±«³· ¥ ¢°¥¬¿

193

²¬¥²¨¬, ·²®  «£®°¨²¬» Select ¨ Randomized-Select, ¢ ®²«¨·¨¥ ®² ®¯¨± ­­»µ ¢ £« ¢¥ 9  «£®°¨²¬®¢ ±®°²¨°®¢ª¨ §  «¨­¥©­®¥ ¢°¥¬¿, ¨±¯®«¼§³¾² ²®«¼ª® ¯®¯ °­»¥ ±° ¢­¥­¨¿ ½«¥¬¥­²®¢ ¬ ±±¨¢  ¨ ¯°¨¬¥­¨¬» ¤«¿ ¯°®¨§¢®«¼­®£® ³¯®°¿¤®·¥­­®£® ¬­®¦¥±²¢ .
²¨  «£®°¨²¬»  ±¨¬¯²®²¨·¥±ª¨ ½´´¥ª²¨¢­¥¥ ®·¥¢¨¤­®£® ¯®¤µ®¤ 
À³¯®°¿¤®·¨ ¬­®¦¥±²¢® ¨ ¢»¡¥°¨ ­³¦­»© ½«¥¬¥­²Á, ¯®±ª®«¼ª³ ¢±¿ª¨©  «£®°¨²¬ ±®°²¨°®¢ª¨, ¨±¯®«¼§³¾¹¨© ²®«¼ª® ¯®¯ °­»¥ ±° ¢­¥­¨¿, ²°¥¡³¥² ¢°¥¬¥­¨ 
(n lg n) ­¥ ²®«¼ª® ¢ µ³¤¸¥¬ ±«³· ¥ (° §¤¥« 9.1), ­® ¨ ¢ ±°¥¤­¥¬ (§ ¤ ·  9-1).
¯° ¦­¥­¨¿
10.3-1 ³¤¥² «¨  «£®°¨²¬ Select ° ¡®² ²¼ §  «¨­¥©­®¥ ¢°¥¬¿,
¥±«¨ ° §¡¨¢ ²¼ ¬ ±±¨¢ ­  £°³¯¯» ­¥ ¨§ ¯¿²¨,   ¨§ ±¥¬¨ ½«¥¬¥­²®¢? ®ª ¦¨²¥, ·²® ¤«¿ £°³¯¯ ¨§ ²°¥µ ½«¥¬¥­²®¢ ° ±±³¦¤¥­¨¥ ­¥
¯°®µ®¤¨².
10.3-2 ³±²¼ x | À¬¥¤¨ ­  ¬¥¤¨ ­Á ¢  «£®°¨²¬¥ Select (¬ ±±¨¢
±®¤¥°¦¨² n ½«¥¬¥­²®¢). ®ª ¦¨²¥, ·²® ¯°¨ n > 38 ª®«¨·¥±²¢® ½«¥¬¥­²®¢, ¡®«¼¸¨µ x (² ª ¦¥ ª ª ¨ ª®«¨·¥±²¢® ½«¥¬¥­²®¢, ¬¥­¼¸¨µ x)
­¥ ¬¥­¼¸¥ dn=4e.
10.3-3 ®¤¨´¨¶¨°³©²¥  «£®°¨²¬ ¡»±²°®© ±®°²¨°®¢ª¨ ² ª, ·²®¡» ®­ ° ¡®² « §  ¢°¥¬¿ O(n lg n) ¢ µ³¤¸¥¬ ±«³· ¥.
10.3-4? ³±²¼  «£®°¨²¬ ¢»¡®°  i-£® ¯® ±·¥²³ ½«¥¬¥­²  ¨±¯®«¼§³¥² ²®«¼ª® ¯®¯ °­»¥ ±° ¢­¥­¨¿. ®ª ¦¨²¥, ·²® ± ¯®¬®¹¼¾ ²¥µ ¦¥
±° ¢­¥­¨© ¬®¦­® ¢ ª ·¥±²¢¥ ¯®¡®·­®£® °¥§³«¼² ²  ¯®«³·¨²¼ ±¯¨±ª¨ ½«¥¬¥­²®¢, ¬¥­¼¸¨µ ¨±ª®¬®£®,   ² ª¦¥ ¡®«¼¸¨µ ¨±ª®¬®£®.
10.3-5 ³±²¼ ³ ­ ± ¥±²¼ ª ª®©-²®  «£®°¨²¬, ­ µ®¤¿¹¨© ¬¥¤¨ ­³ §  «¨­¥©­®¥ ¢ µ³¤¸¥¬ ±«³· ¥ ¢°¥¬¿. ±¯®«¼§³¿ ¥£® ¢ ª ·¥±²¢¥
¯®¤¯°®£° ¬¬», ° §° ¡®² ©²¥ ¯°®±²®©  «£®°¨²¬, °¥¸ ¾¹¨© § ¤ ·³ ­ µ®¦¤¥­¨¿ ¯°®¨§¢®«¼­®© ¯®°¿¤ª®¢®© ±² ²¨±²¨ª¨ §  «¨­¥©­®¥
¢°¥¬¿.
10.3-6 ®¤ k-ª¢ ­²¨«¿¬¨ (k-th quantiles) ¬­®¦¥±²¢  ¨§ n ·¨±¥«
¬» ¯®­¨¬ ¥¬ k ; 1 ¥£® ½«¥¬¥­²®¢, ®¡« ¤ ¾¹¨µ ±«¥¤³¾¹¨¬ ±¢®©±²¢®¬: ¥±«¨ ° ±¯®«®¦¨²¼ ½«¥¬¥­²» ¬­®¦¥±²¢  ¢ ¯®°¿¤ª¥ ¢®§° ±² ­¨¿, ²® ª¢ ­²¨«¨ ¡³¤³² ° §¡¨¢ ²¼ ¬­®¦¥±²¢® ­  k ° ¢­»µ (²®·­¥¥,
®²«¨· ¾¹¨µ±¿ ­¥ ¡®«¥¥ ·¥¬ ­  ®¤¨­ ½«¥¬¥­²) · ±²¥©.  §° ¡®² ©²¥
 «£®°¨²¬, ª®²®°»© §  ¢°¥¬¿ O(n lg k) ­ µ®¤¨² k-ª¢ ­²¨«¨ ¤ ­­®£®
¬­®¦¥±²¢ .
10.3-7  §° ¡®² ©²¥  «£®°¨²¬, ª®²®°»© ¯® § ¤ ­­®¬³ k ­ µ®¤¨²
¢ ¤ ­­®¬ ¬­®¦¥±²¢¥ S ¥£® k ½«¥¬¥­²®¢, ¬¥­¥¥ ¢±¥£® ®²±²®¿¹¨µ ®²
¬¥¤¨ ­». ¨±«® ®¯¥° ¶¨© ¤®«¦­® ¡»²¼ O(jS j).

194

« ¢  10 ¥¤¨ ­» ¨ ¯®°¿¤ª®¢»¥ ±² ²¨±²¨ª¨

¨±. 10.2  ª ¯°®¢¥±²¨ ± ¢®±²®ª  ­  § ¯ ¤ ¬ £¨±²° «¼, ·²®¡» ±³¬¬ °­ ¿ ¤«¨­  ¯®¤¢®¤¿¹¨µ ²°³¡®¯°®¢®¤®¢ ¡»«  ¬¨­¨¬ «¼­ ?

10.3-8 ³±²¼ X [1 : :n] ¨ Y [1 : :n] | ¤¢  ¢®§° ±² ¾¹¨µ ¬ ±±¨¢ .
 §° ¡®² ©²¥  «£®°¨²¬, ­ µ®¤¿¹¨© §  ¢°¥¬¿ O(lg n) ¬¥¤¨ ­³ ¬­®¦¥±²¢ , ¯®«³·¥­­®£® ®¡º¥¤¨­¥­¨¥¬ ½«¥¬¥­²®¢ ½²¨µ ¬ ±±¨¢®¢.
10.3-9 °®´¥±±®° ª®­±³«¼²¨°³¥² ­¥´²¿­³¾ ª®¬¯ ­¨¾, ª®²®°®©
²°¥¡³¥²±¿ ¯°®¢¥±²¨ ¬ £¨±²° «¼­»© ­¥´²¥¯°®¢®¤ ¢ ­ ¯° ¢«¥­¨¨
±²°®£® ± § ¯ ¤  ­  ¢®±²®ª ·¥°¥§ ­¥´²¥­®±­®¥ ¯®«¥, ­  ª®²®°®¬
° ±¯®«®¦¥­» n ­¥´²¿­»µ ±ª¢ ¦¨­. ² ª ¦¤®© ±ª¢ ¦¨­» ­¥®¡µ®¤¨¬® ¯®¤¢¥±²¨ ª ¬ £¨±²° «¨ ²°³¡®¯°®¢®¤ ¯® ª° ²· ©¸¥¬³ ¯³²¨
(±²°®£® ­  ±¥¢¥° ¨«¨ ­  ¾£, °¨±. 10.2). ®®°¤¨­ ²» ¢±¥µ ±ª¢ ¦¨­
¯°®´¥±±®°³ ¨§¢¥±²­»; ­¥®¡µ®¤¨¬® ¢»¡° ²¼ ¬¥±²®¯®«®¦¥­¨¥ ¬ £¨±²° «¨, ·²®¡» ±³¬¬  ¤«¨­ ¢±¥µ ²°³¡®¯°®¢®¤®¢, ¢¥¤³¹¨µ ®² ±ª¢ ¦¨­ ª ¬ £¨±²° «¨, ¡»«  ¬¨­¨¬ «¼­ . ®ª ¦¨²¥, ·²® ®¯²¨¬ «¼­®¥
¬¥±²® ¤«¿ ¬ £¨±²° «¨ ¬®¦­® ­ ©²¨ §  «¨­¥©­®¥ ¢°¥¬¿.

 ¤ ·¨
10-1 ®°²¨°®¢ª  i ­ ¨¡®«¼¸¨µ ½«¥¬¥­²®¢
 ­® ¬­®¦¥±²¢® ¨§ n ·¨±¥«; ²°¥¡³¥²±¿ ¢»¡° ²¼ ¨§ ­¨µ i ­ ¨¡®«¼¸¨µ ¨ ®²±®°²¨°®¢ ²¼ (¯®«¼§³¿±¼ ²®«¼ª® ¯®¯ °­»¬¨ ±° ¢­¥­¨¿¬¨).
«¿ ª ¦¤®£® ¨§ ¯°¨¢¥¤¥­­»µ ­¨¦¥ ¯®¤µ®¤®¢ ° §° ¡®² ©²¥ ±®®²¢¥²±²¢³¾¹¨©  «£®°¨²¬ ¨ ¢»¿±­¨²¥, ª ª § ¢¨±¨² ®² n ¨ i ¢°¥¬¿
° ¡®²» ½²¨µ  «£®°¨²¬®¢ ¢ µ³¤¸¥¬ ±«³· ¥.
 . ²±®°²¨°®¢ ²¼ ¢±¥ ·¨±«  ¨ ¢»¯¨± ²¼ i ­ ¨¡®«¼¸¨µ.
¡. ®¬¥±²¨²¼ ·¨±«  ¢ ®·¥°¥¤¼ ± ¯°¨®°¨²¥² ¬¨ ¨ ¢»§¢ ²¼ i ° §
¯°®¶¥¤³°³ Extract-Max.

 ¤ ·¨ ª £« ¢¥ 10
¢.

195

 ©²¨ ± ¯®¬®¹¼¾  «£®°¨²¬  ° §¤¥«  10.3 i-¥ ¯® ¢¥«¨·¨­¥ ·¨±«®
(±·¨² ¿ ®² ­ ¨¡®«¼¸¥£®), ° §¡¨²¼ ¬ ±±¨¢ ®²­®±¨²¥«¼­® ­¥£® ¨
®²±®°²¨°®¢ ²¼ i ­ ¨¡®«¼¸¨µ ·¨±¥«.

10-2 §¢¥¸¥­­ ¿ ¬¥¤¨ ­ 
³±²¼ ¤ ­® n ° §«¨·­»µ ·¨±¥« x1; : : :; xn , ¨ ¯³±²¼ ª ¦¤®¬³ xi
±®¯®±² ¢«¥­® ¯®«®¦¨²¥«¼­®¥ ·¨±«® (À¢¥±Á) wi , ¯°¨·¥¬ ±³¬¬  ¢±¥µ
¢¥±®¢ ° ¢­  1. §¢¥¸¥­­®© ¬¥¤¨ ­®© (weighted median) ­ §»¢ ¥²±¿
² ª®¥ ·¨±«® xk , ·²®
X
X
wi 6 12 ¨
wi 6 12 :
xi <xk
xi >xk
®ª ¦¨²¥, ·²® ¥±«¨ ¢±¥ ¢¥±  ° ¢­» 1=n, ²® ¢§¢¥¸¥­­ ¿ ¬¥¤¨ ­ 
±®¢¯ ¤ ¥² ± ®¡»·­®©.
¡.  ª ­ ©²¨ ¢§¢¥¸¥­­³¾ ¬¥¤¨ ­³ n ·¨±¥« ± ¯®¬®¹¼¾ ±®°²¨°®¢ª¨
§  ¢°¥¬¿ O(n lg n) ¢ µ³¤¸¥¬ ±«³· ¥?
¢.  ª ¬®¤¨´¨¶¨°®¢ ²¼  «£®°¨²¬ Select (° §¤¥« 10.3), ·²®¡» ®­
¨±ª « ¢§¢¥¸¥­­³¾ ¬¥¤¨ ­³ §  ¢°¥¬¿ (n) ¢ µ³¤¸¥¬ ±«³· ¥?
 ¤ ·  ® ¢»¡®°¥ ¬¥±²  ¤«¿ ¯®·²» (post-oce location problem)
±®±²®¨² ¢ ±«¥¤³¾¹¥¬.  ­® n ²®·¥ª p1 ; : : :; pn ¨ n ¯®«®¦¨²¥«¼­»µ
¢¥±®¢ w1; : : :; wn; ²°¥¡³¥²±¿ ­ ©²¨ ²®·ª³ p (­¥ ®¡¿§ ²¥«¼­®
±®¢¯ ¤ Pn
¾¹³¾ ± ®¤­®© ¨§ pi ), ¤«¿ ª®²®°®© ¢»° ¦¥­¨¥ i=1 wid(p; pi) ¡³¤¥²
¬¨­¨¬ «¼­® (·¥°¥§ d(a; b) ®¡®§­ · ¥²±¿ ° ±±²®¿­¨¥ ¬¥¦¤³ ²®·ª ¬¨ a ¨ b).
¤. ®ª ¦¨²¥, ·²® ¢ ®¤­®¬¥°­®¬ ±«³· ¥ (²®·ª¨ | ¢¥¹¥±²¢¥­­»¥
·¨±« , d(a; b) = ja ; bj) ¢§¢¥¸¥­­ ¿ ¬¥¤¨ ­  ¡³¤¥² °¥¸¥­¨¥¬ ½²®©
§ ¤ ·¨.
¥.  ©¤¨²¥ ®¯²¨¬ «¼­®¥ °¥¸¥­¨¥ ¢ ¤¢³¬¥°­®¬ ±«³· ¥ (²®·ª¨ |
¯ °» ¢¥¹¥±²¢¥­­»µ ·¨±¥«), ¥±«¨ ° ±±²®¿­¨¥ ¬¥¦¤³ ²®·ª ¬¨ a =
(x1 ; y1) ¨ b = (x2 ; y2) § ¤ ¥²±¿ À¢ L1 -¬¥²°¨ª¥Á: d(a; b) = jx1 ;
x2j + jy1 ; y2j ( ¬¥°¨ª ­¶» ­ §»¢ ¾² ² ª³¾ ¬¥²°¨ª³ Manhattan
distance, ¯® ­ §¢ ­¨¾ ° ©®­  ¼¾-®°ª , ° §¡¨²®£® ³«¨¶ ¬¨ ­ 
¯°¿¬®³£®«¼­»¥ ª¢ °² «»)
 .

10-3  µ®¦¤¥­¨¥ i-£® ¯® ¢¥«¨·¨­¥ ½«¥¬¥­²  ¯°¨ ¬ «»µ i
³±²¼ T (n) | ¢°¥¬¿ ° ¡®²» ¯°®¶¥¤³°» Select, ¯°¨¬¥­¥­­®© ª
¬ ±±¨¢³ ¨§ n ·¨±¥«; ¢ µ³¤¸¥¬ ±«³· ¥ T (n) = (n), ­® ª®½´´¨¶¨¥­²
¯°¨ n, ¯®¤° §³¬¥¢ ¥¬»© ¢ ½²®¬ ®¡®§­ ·¥­¨¨, ¤®¢®«¼­® ¢¥«¨ª. ±«¨
i ¬ «® ¯® ±° ¢­¥­¨¾ ± n, ²® ®²®¡° ²¼ i-»© ¯® ¢¥«¨·¨­¥ ½«¥¬¥­²
¬®¦­® ¡»±²°¥¥.

196

« ¢  10 ¥¤¨ ­» ¨ ¯®°¿¤ª®¢»¥ ±² ²¨±²¨ª¨
 .

¯¨¸¨²¥  «£®°¨²¬, ª®²®°»© ­ µ®¤¨² i-© ¯® ¢¥«¨·¨­¥ ½«¥¬¥­²
¢ ¬­®¦¥±²¢¥ ¨§ n ·¨±¥«, ¤¥« ¿ Ui (n) ±° ¢­¥­¨©, ¯°¨·¥¬
(

Ui (n) =

¡.
¢.

£.

T (n)
¥±«¨ n 6 2i,
n=2 + Ui(bn=2c) + T (2i + 1) ¨­ ·¥.

(ª § ­¨¥: ±¤¥« ©²¥ bn=2c ¯®¯ °­»µ ±° ¢­¥­¨© ¨ ®²¡¥°¨²¥ i
­ ¨¬¥­¼¸¨µ ±°¥¤¨ ¬¥­¼¸¨µ ½«¥¬¥­²®¢ ¯ °.)
®ª ¦¨²¥, ·²® Ui (n) = n + O(T (2i) log(n=i)).
®ª ¦¨²¥, ·²®, ¯°¨ ¯®±²®¿­­®¬ i, ¨¬¥¥¬ Ui (n) = n + O(lg n).
[  ¦¥ ®¶¥­ª  ¯®«³·¨²±¿, ¥±«¨ ¯®±²°®¨²¼ ª³·³ ¨§ £« ¢» 7,  
§ ²¥¬ i ° § ¢»¡° ²¼ ¨§ ­¥¥ ¬¨­¨¬ «¼­»© ½«¥¬¥­².]
³±²¼ i = n=k, ¯°¨·¥¬ k > 2; ¯®ª ¦¨²¥, ·²® Ui (n) = n +
O(T (2n=k) lg k).

 ¬¥· ­¨¿
«£®°¨²¬ ¤«¿ ­ µ®¦¤¥­¨¿ ¬¥¤¨ ­» §  «¨­¥©­®¥ ¢ µ³¤¸¥¬ ±«³· ¥ ¢°¥¬¿ ¯°¥¤«®¦¨«¨ «¾¬, «®©¤, ° ²², ¨¢¥±² ¨  °¼¿­ [29].
¥°®¿²­®±²­»©  «£®°¨²¬ ± «¨­¥©­»¬ ±°¥¤­¨¬ ¢°¥¬¥­¥¬ ° ¡®²»
¯°¨­ ¤«¥¦¨² ® °³ [97]. «®©¤ ¨ ¨¢¥±² [70] ° §° ¡®² «¨ ³±®¢¥°¸¥­±²¢®¢ ­­³¾ ¢¥°±¨¾ ½²®£®  «£®°¨²¬ , ¢ ª®²®°®© £° ­¨¶  ° §¡¨¥­¨¿ ®¯°¥¤¥«¿¥²±¿ ¯® ­¥¡®«¼¸®© ±«³· ©­®© ¢»¡®°ª¥.

III

²°³ª²³°» ¤ ­­»µ

¢¥¤¥­¨¥
 ¯°®£° ¬¬¨°®¢ ­¨¨ · ±²® ¯°¨µ®¤¨²±¿ ¨¬¥²¼ ¤¥«® ± ¬­®¦¥±²¢ ¬¨, ¬¥­¿¾¹¨¬¨±¿ ¢ ¯°®¶¥±±¥ ¢»¯®«­¥­¨¿  «£®°¨²¬ .  ±«¥¤³¾¹¨µ ¯¿²¨ £« ¢ µ ¬» ° ±±¬®²°¨¬ ±²°³ª²³°» ¤ ­­»µ, ¯°¥¤­ §­ ·¥­­»¥ ¤«¿ µ° ­¥­¨¿ ¨§¬¥­¿¾¹¨µ±¿ (¤¨­ ¬¨·¥±ª¨µ, ¯®- ­£«¨©±ª¨
dynamic) ¬­®¦¥±²¢.
 §­»¥  «£®°¨²¬» ¨±¯®«¼§³¾² ° §­»¥ ®¯¥° ¶¨¨. ¥°¥¤ª®, ­ ¯°¨¬¥°, ²°¥¡³¥²±¿ «¨¸¼ ¤®¡ ¢«¿²¼ ¨ ³¤ «¿²¼ ½«¥¬¥­²» ¢ ¬­®¦¥±²¢®,   ² ª¦¥ ¯°®¢¥°¿²¼, ¯°¨­ ¤«¥¦¨² «¨ ¬­®¦¥±²¢³ ¤ ­­»© ½«¥¬¥­². ²°³ª²³°  ¤ ­­»µ, ¯®¤¤¥°¦¨¢ ¾¹ ¿ ² ª¨¥ ®¯¥° ¶¨¨, ­ §»¢ ¥²±¿ ±«®¢ °¥¬ (dictionary).  ¤°³£¨µ ±¨²³ ¶¨¿µ ¬®£³² ¯®­ ¤®¡¨²¼±¿ ¡®«¥¥ ±«®¦­»¥ ®¯¥° ¶¨¨.  ¯°¨¬¥°, ®·¥°¥¤¨ ± ¯°¨®°¨²¥² ¬¨, ® ª®²®°»µ ¸«  °¥·¼ ¢ £« ¢¥ 7 ¢ ±¢¿§¨ ± ª³· ¬¨, ° §°¥¸ ¾²
¢»¡¨° ²¼ ¨ ³¤ «¿²¼ ­ ¨¬¥­¼¸¨© ½«¥¬¥­² (¯®¬¨¬® ¤®¡ ¢«¥­¨¿ ½«¥¬¥­²®¢). ®­¿²­®, ·²® ¢»¡®° °¥ «¨§ ¶¨¨ ¤¨­ ¬¨·¥±ª®£® ¬­®¦¥±²¢  § ¢¨±¨² ®² ²®£®, ª ª¨¥ ®¯¥° ¶¨¨ ± ­¨¬ ­ ¬ ¯®²°¥¡³¾²±¿.
«¥¬¥­²» ¬­®¦¥±²¢
¡»·­® ½«¥¬¥­² ¤¨­ ¬¨·¥±ª®£® ¬­®¦¥±²¢  | ½²® § ¯¨±¼, ±®¤¥°¦ ¹ ¿ ° §«¨·­»¥ ¯®«¿.  ±²® ®¤­® ¨§ ¯®«¥© ° ±±¬ ²°¨¢ ¥²±¿
ª ª ª«¾· (key), ¯°¥¤­ §­ ·¥­­»© ¤«¿ ¨¤¥­²¨´¨ª ¶¨¨ ½«¥¬¥­² ,  
®±² «¼­»¥ ¯®«¿ | ª ª ¤®¯®«­¨²¥«¼­ ¿ ¨­´®°¬ ¶¨¿ (satellite data), µ° ­¿¹ ¿±¿ ¢¬¥±²¥ ± ª«¾·®¬. «¥¬¥­² ¬­®¦¥±²¢  ¨¹¥²±¿ ¯®
ª«¾·³; ª®£¤  ½«¥¬¥­², ¬» ¬®¦¥¬ ¯°®·¥±²¼ ¨«¨ ¨§¬¥­¨²¼ ¤®¯®«­¨²¥«¼­³¾ ¨­´®°¬ ¶¨¾, ¨¬¥¾¹³¾±¿ ¢ ½²®¬ ½«¥¬¥­²¥. ® ¬­®£¨µ
±«³· ¿µ ¢±¥ ª«¾·¨ ° §«¨·­», ¨ ²®£¤  ¬­®¦¥±²¢® ¬®¦­® ° ±±¬ ²°¨¢ ²¼ ª ª ´³­ª¶¨¾, ª®²®° ¿ ± ª ¦¤»¬ (±³¹¥±²¢³¾¹¨¬) ª«¾·®¬
±®¯®±² ¢«¿¥² ­¥ª®²®°³¾ ¤®¯®«­¨²¥«¼­³¾ ¨­´®°¬ ¶¨¾.
­®£¨¥ ±¯®±®¡» °¥ «¨§ ¶¨¨ ¬­®¦¥±²¢ ²°¥¡³¾², ·²®¡» ¢¬¥±²¥ ±
ª ¦¤»¬ ª«¾·®¬ µ° ­¨«¨±¼ ­¥ ²®«¼ª® ¤®¯®«­¨²¥«¼­»¥ ¤ ­­»¥, ­® ¨

200

 ±²¼ III ²°³ª²³°» ¤ ­­»µ

­¥ª®²®° ¿ ±«³¦¥¡­ ¿ ¨­´®°¬ ¶¨¿ (­ ¯°¨¬¥°, ³ª § ²¥«¨ ­  ¤°³£¨¥
½«¥¬¥­²» ¬­®¦¥±²¢ )
 ±²® ­  ¬­®¦¥±²¢¥ ª«¾·¥© ¨¬¥¥²±¿ ¥±²¥±²¢¥­­»© «¨­¥©­»©
¯®°¿¤®ª (­ ¯°¨¬¥°, ª«¾·¨ ¬®£³² ¡»²¼ ¤¥©±²¢¨²¥«¼­»¬¨ ·¨±« ¬¨ ¨«¨ ±«®¢ ¬¨, ­  ª®²®°»µ ¥±²¼ «¥ª±¨ª®£° ´¨·¥±ª¨© ¯®°¿¤®ª).
 ½²®¬ ±«³· ¥ ¬®¦­® £®¢®°¨²¼, ­ ¯°¨¬¥°, ® ­ ¨¬¥­¼¸¥¬ ½«¥¬¥­²¥
¬­®¦¥±²¢  ¨«¨ ®¡ ½«¥¬¥­²¥, ­¥¯®±°¥¤±²¢¥­­® ±«¥¤³¾¹¥¬ §  ¤ ­­»¬.
» ¯°¥¤¯®« £ ¥¬, ·²® ½«¥¬¥­²» ¬­®¦¥±²¢  µ° ­¿²±¿ ¢ ­¥ª®²®°®© ®¡¹¥© ®¡« ±²¨ ¯ ¬¿²¨ ¨ ¤«¿ ª ¦¤®£® ¨¬¥¥²±¿ ³ª § ²¥«¼,
ª®²®°»© ¯®§¢®«¿¥² ¯®«³·¨²¼ ¤®±²³¯ ª ½²®¬³ ½«¥¬¥­²³. ¡»·­® ¢
ª ·¥±²¢¥ ³ª § ²¥«¿ ¢»±²³¯ ¥² ¯°®±²®  ¤°¥± ¢ ¯ ¬¿²¨; ¥±«¨ ¿§»ª
¯°®£° ¬¬¨°®¢ ­¨¿ ½²®£® ­¥ ¯°¥¤³±¬ ²°¨¢ ¥², ³ª § ²¥«¥¬ ¬®¦¥²
¡»²¼ ¨­¤¥ª± ¢ ¬ ±±¨¢¥.
¯¥° ¶¨¨ ­ ¤ ¬­®¦¥±²¢ ¬¨
¯¥° ¶¨¨ ­ ¤ ¬­®¦¥±²¢ ¬¨ ¤¥«¿²±¿ ­  § ¯°®±» (queries), ª®²®°»¥ ­¥ ¬¥­¿¾² ¬­®¦¥±²¢ , ¨ ®¯¥° ¶¨¨, ¬¥­¿¾¹¨¥ ¬­®¦¥±²¢® (modifying operations). ¨¯¨·­»¥ ®¯¥° ¶¨¨ ± ¬­®¦¥±²¢ ¬¨ ² ª®¢»:
Search(S; k) (¯®¨±ª).  ¯°®±, ª®²®°»© ¯® ¤ ­­®¬³ ¬­®¦¥±²¢³ S ¨
ª«¾·³ k ¢®§¢° ¹ ¥² ³ª § ²¥«¼ ­  ½«¥¬¥­² ¬­®¦¥±²¢  S ± ª«¾·®¬ k. ±«¨ ² ª®£® ½«¥¬¥­²  ¢ ¬­®¦¥±²¢¥ S ­¥², ¢®§¢° ¹ ¥²±¿ nil.
Insert(S; x) ¤®¡ ¢«¿¥² ª ¬­®¦¥±²¢³ S ½«¥¬¥­², ­  ª®²®°»© ³ª §»¢ ¥² ³ª § ²¥«¼ x (¯®¤° §³¬¥¢ ¥²±¿, ·²® ª ½²®¬³ ¬®¬¥­²³ ¢±¥
¯®«¿ ¢ § ¯¨±¨, ­  ª®²®°³¾ ³ª §»¢ ¥² x, ³¦¥ § ¯®«­¥­»).
Delete(S; x) ³¤ «¿¥² ¨§ ¬­®¦¥±²¢  S ½«¥¬¥­², ­  ª®²®°»© ³ª §»¢ ¥² ³ª § ²¥«¼ x (®¡° ²¨²¥ ¢­¨¬ ­¨¥, ·²® x | ³ª § ²¥«¼,   ­¥
ª«¾·).
Minimum(S ) ¢»¤ ¥² ³ª § ²¥«¼ ­  ½«¥¬¥­² ¬­®¦¥±²¢  S ± ­ ¨¬¥­¼¸¨¬ ª«¾·®¬ (±·¨² ¥¬, ·²® ª«¾·¨ «¨­¥©­® ³¯®°¿¤®·¥­»).
Maximum(S ) ¢»¤ ¥² ³ª § ²¥«¼ ­  ½«¥¬¥­² ¬­®¦¥±²¢  S ± ­ ¨¡®«¼¸¨¬ ª«¾·®¬.
Successor(S; x) (±«¥¤³¾¹¨©) ¢®§¢° ¹ ¥² ³ª § ²¥«¼ ­  ½«¥¬¥­²
¬­®¦¥±²¢  S , ­¥¯®±°¥¤±²¢¥­­® ±«¥¤³¾¹¨© §  ½«¥¬¥­²®¬ x (¢
±¬»±«¥ «¨­¥©­®£® ¯®°¿¤ª  ­  ª«¾· µ). ±«¨ x | ­ ¨¡®«¼¸¨©
½«¥¬¥­², ¢®§¢° ¹ ¥²±¿ nil.
Predecessor(S; x) (¯°¥¤»¤³¹¨©) ¢®§¢° ¹ ¥² ³ª § ²¥«¼ ­  ½«¥¬¥­², ­¥¯®±°¥¤±²¢¥­­® ¯°¥¤¸¥±²¢³¾¹¨© ½«¥¬¥­²³ x (¥±«¨ x |
­ ¨¬¥­¼¸¨© ½«¥¬¥­², ¢®§¢° ¹ ¥²±¿ nil).
 ¯°®±» Successor ¨ Predecessor · ±²® ¨±¯®«¼§³¾²±¿ ¨ ¯°¨ ° ¡®²¥ ± ¬­®¦¥±²¢ ¬¨, ¢ ª®²®°»µ ª«¾·¨ ° §«¨·­»µ ½«¥¬¥­²®¢ ¬®£³²

 ±²¼ III ²°³ª²³°» ¤ ­­»µ

201

±®¢¯ ¤ ²¼. °¨ ½²®¬ ° §³¬­ ¿ °¥ «¨§ ¶¨¿ £ ° ­²¨°³¥², ·²® ´³­ª¶¨¨ Successor ¨ Predecessor ®¡° ²­», ·²® ­ · ¢ ± Minumum(S )
¨ ¯°¨¬¥­¿¿ ´³­ª¶¨¾ Successor, ¬» ¯¥°¥·¨±«¨¬ ¢±¥ ½«¥¬¥­²»
¬­®¦¥±²¢  ¢ ­¥³¡»¢ ¾¹¥¬ ¯®°¿¤ª¥ ¨ ². ¯.
²®¨¬®±²¼ ®¯¥° ¶¨© ­ ¤ ¬­®¦¥±²¢ ¬¨ ®¡»·­® ®¶¥­¨¢ ¥²±¿ ·¥°¥§ ° §¬¥° ¬­®¦¥±²¢, ª ª®²®°»¬ ®­¨ ¯°¨¬¥­¿¾²±¿.  ¯°¨¬¥°, ¢
£« ¢¥ 14 ¬» ®¯¨±»¢ ¥¬ ±²°³ª²³°³ ¤ ­­»µ, ª®²®° ¿ ¯®§¢®«¿¥² ¢»¯®«­¨²¼ ª ¦¤³¾ ¨§ ¯¥°¥·¨±«¥­­»µ ®¯¥° ¶¨© §  ¢°¥¬¿ O(lg n), £¤¥
n | ·¨±«® ½«¥¬¥­²®¢ ¬­®¦¥±²¢ .
¡§®° · ±²¨ III
 £« ¢ µ 11{15 ¬» ®¯¨±»¢ ¥¬ ° §«¨·­»¥ ±²°³ª²³°» ¤ ­­»µ,
¯°¥¤­ §­ ·¥­­»¥ ¤«¿ ° ¡®²» ± ¤¨­ ¬¨·¥±ª¨¬¨ ¬­®¦¥±²¢ ¬¨. 
¯®¬®¹¼¾ ½²¨µ ±²°³ª²³° ¤ ­­»µ ¬®¦­® ° §° ¡®² ²¼ ½´´¥ª²¨¢­»¥
 «£®°¨²¬» ¤«¿ °¥¸¥­¨¿ ¬­®£¨µ ° §«¨·­»µ § ¤ ·. ±² ²¨, ± ®¤­®© ¢ ¦­®© ±²°³ª²³°®© ¤ ­­»µ (ª³·¥©) ¬» ³¦¥ ¯®§­ ª®¬¨«¨±¼ ¢
£« ¢¥ 7.
 £« ¢¥ 11 ¬» ° §¡¨° ¥¬ ¯°¨­¶¨¯» ° ¡®²» ± ¯°®±²¥©¸¨¬¨
±²°³ª²³° ¬¨ ¤ ­­»µ: ±²¥ª ¬¨, ®·¥°¥¤¿¬¨, ±¢¿§ ­­»¬¨ ±¯¨±ª ¬¨ ¨
ª®°­¥¢»¬¨ ¤¥°¥¢¼¿¬¨.  ½²®© ¦¥ £« ¢¥ ° ±±ª §»¢ ¥²±¿, ª ª °¥ «¨§®¢ ²¼ § ¯¨±¨ ¨ ³ª § ²¥«¨ ± ¯®¬®¹¼¾ ¿§»ª®¢ ¯°®£° ¬¬¨°®¢ ­¨¿,
¢ ª®²®°»µ ­¥² ±®®²¢¥²±²¢³¾¹¨µ ²¨¯®¢ ¤ ­­»µ. ®«¼¸ ¿ · ±²¼ ¬ ²¥°¨ «  ½²®© £« ¢» ±®±² ¢«¿¥² ±² ­¤ °²­»© ¬ ²¥°¨ « ­ · «¼­®£®
ª³°±  ¯°®£° ¬¬¨°®¢ ­¨¿.
 £« ¢¥ 12 ¬» ¯®§­ ª®¬¨¬±¿ ± µ¥¸-² ¡«¨¶ ¬¨, ¯®¤¤¥°¦¨¢ ¾¹¨¬¨ ®¯¥° ¶¨¨ Insert, Delete ¨ Search.  µ³¤¸¥¬ ±«³· ¥ ¯®¨±ª
¢ µ¥¸-² ¡«¨¶¥ ²°¥¡³¥² ¢°¥¬¥­¨ (n), ­® ±°¥¤­¥¥ ¢°¥¬¿, ­¥®¡µ®¤¨¬®¥ ¤«¿ ¢»¯®«­¥­¨¿ «¾¡®© ¨§ ±«®¢ °­»µ ®¯¥° ¶¨© ± µ¥¸-² ¡«¨¶¥©,
±®±² ¢«¿¥² (¯°¨ ­¥ª®²®°»µ ¯°¥¤¯®«®¦¥­¨¿µ) «¨¸¼ O(1). ­ «¨§
µ¥¸¨°®¢ ­¨¿ ¨±¯®«¼§³¥² ²¥®°¨¾ ¢¥°®¿²­®±²¥©, ­® ¤«¿ ¯®­¨¬ ­¨¿
¡®«¼¸¥© · ±²¨ £« ¢» §­ ª®¬±²¢® ± ½²®© ²¥®°¨¥© ­¥ ®¡¿§ ²¥«¼­®.
 £« ¢¥ 13 ¬» § ­¨¬ ¥¬±¿ ¤¥°¥¢¼¿¬¨ ¤¢®¨·­®£® ¯®¨±ª . ²¨ ¤¥°¥¢¼¿ ¯®¤¤¥°¦¨¢ ¾² ¢±¥ ¯¥°¥·¨±«¥­­»¥ ®¯¥° ¶¨¨ ± ¬­®¦¥±²¢ ¬¨.
 µ³¤¸¥¬ ±«³· ¥ ±²®¨¬®±²¼ ª ¦¤®© ¨§ ®¯¥° ¶¨© ¥±²¼ (n), ­® ¤«¿
±«³· ©­® ¯®±²°®¥­­®£® ¤¥°¥¢  ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ½²®© ±²®¨¬®±²¨ ¥±²¼ O(lg n).   ¡ §¥ ¤¥°¥¢¼¥¢ ¤¢®¨·­®£® ¯®¨±ª  ±²°®¿²±¿
¬­®£¨¥ ¤°³£¨¥ ±²°³ª²³°» ¤ ­­»µ.
« ¢  14 ¯®±¢¿¹¥­  ª° ±­®-·¥°­»¬ ¤¥°¥¢¼¿¬. ²  ° §­®¢¨¤­®±²¼
¤¥°¥¢¼¥¢ ¤¢®¨·­®£® ¯®¨±ª  £ ° ­²¨°®¢ ­­® ° ¡®² ¥² ¡»±²°®: ¢°¥¬¿ ¢»¯®«­¥­¨¿ ª ¦¤®© ®¯¥° ¶¨¨ ¢ µ³¤¸¥¬ ±«³· ¥ ¥±²¼ O(lg n).
° ±­®-·¥°­»¥ ¤¥°¥¢¼¿ ¯°¥¤±² ¢«¿¾² ±®¡®© ®¤¨­ ¨§ ¢ °¨ ­²®¢
À±¡ « ­±¨°®¢ ­­»µÁ ¤¥°¥¢¼¥¢ ¯®¨±ª ; ¤°³£®© ¢ °¨ ­² (-¤¥°¥¢¼¿)
®¡±³¦¤ ¥²±¿ ¢ £« ¢¥ 19. «£®°¨²¬» ¤«¿ ° ¡®²» ± ª° ±­®-·¥°­»¬¨
¤¥°¥¢¼¿¬¨ ³±²°®¥­» ¤®¢®«¼­® µ¨²°®. ®²¿ ¤¥² «¨ ¬®¦­® ®¯³±²¨²¼

202

 ±²¼ III ²°³ª²³°» ¤ ­­»µ

¯°¨ ¯¥°¢®¬ ·²¥­¨¨, ¨­²¥°¥±­® ¢ ­¨µ ° §®¡° ²¼±¿.
 £« ¢¥ 15 ¬» ° ±±¬ ²°¨¢ ¥¬ ¤®¯®«­¨²¥«¼­»¥ ±²°³ª²³°» ­ 
ª° ±­®-·¥°­»µ ¤¥°¥¢¼¿µ, ¯®§¢®«¿¾¹¨¥ ¢»¯®«­¿²¼ ¥¹¥ ­¥±ª®«¼ª®
®¯¥° ¶¨© (¯®°¿¤ª®¢»¥ ±² ²¨±²¨ª¨, ®¯¥° ¶¨¨ ± ¤¥°¥¢¼¿¬¨ ¯°®¬¥¦³²ª®¢).

11

«¥¬¥­² °­»¥ ±²°³ª²³°» ¤ ­­»µ

 ½²®© £« ¢¥ ¬» ° ±±¬ ²°¨¢ ¥¬ ­¥±ª®«¼ª® ¯°®±²»µ ±²°³ª²³° ¤ ­­»µ ¤«¿ µ° ­¥­¨¿ ¬­®¦¥±²¢: ±²¥ª¨, ®·¥°¥¤¨, ±¯¨±ª¨, ª®°­¥¢»¥ ¤¥°¥¢¼¿. » ¯®ª ¦¥¬, ª ª ¬®¦­® °¥ «¨§®¢ ²¼ ¨µ ± ¯®¬®¹¼¾ ³ª § ²¥«¥© ¨«¨ ¬ ±±¨¢®¢.

11.1. ²¥ª¨ ¨ ®·¥°¥¤¨
²¥ª¨ ¨ ®·¥°¥¤¨ | ½²® ¤¨­ ¬¨·¥±ª¨¥ ¬­®¦¥±²¢ , ¢ ª®²®°»µ
½«¥¬¥­², ³¤ «¿¥¬»© ¨§ ¬­®¦¥±²¢  ®¯¥° ¶¨¥© Delete, ­¥ § ¤ ¥²±¿
¯°®¨§¢®«¼­®,   ®¯°¥¤¥«¿¥²±¿ ±²°³ª²³°®© ¬­®¦¥±²¢ . ¬¥­­®, ¨§
±²¥ª  (stack) ¬®¦­® ³¤ «¨²¼ ²®«¼ª® ²®² ½«¥¬¥­², ª®²®°»© ¡»« ¢
­¥£® ¤®¡ ¢«¥­ ¯®±«¥¤­¨¬: ±²¥ª ° ¡®² ¥² ¯® ¯°¨­¶¨¯³ À¯®±«¥¤­¨¬
¯°¨¸¥« | ¯¥°¢»¬ ³¸¥«Á (last-in, rst-out | ±®ª° ¹¥­­® LIFO). §
®·¥°¥¤¨ (queue), ­ ¯°®²¨¢, ¬®¦­® ³¤ «¨²¼ ²®«¼ª® ²®² ½«¥¬¥­², ª®²®°»© ­ µ®¤¨«±¿ ¢ ®·¥°¥¤¨ ¤®«¼¸¥ ¢±¥£®: ° ¡®² ¥² ¯°¨­¶¨¯ À¯¥°¢»¬ ¯°¨¸¥« | ¯¥°¢»¬ ³¸¥«Á (rst-in, rst-out, ±®ª° ¹¥­­® FIFO).
³¹¥±²¢³¥² ­¥±ª®«¼ª® ±¯®±®¡®¢ ½´´¥ª²¨¢­® °¥ «¨§®¢ ²¼ ±²¥ª¨ ¨
®·¥°¥¤¨.  ½²®¬ ° §¤¥«¥ ¬» ° ±±ª ¦¥¬, ª ª °¥ «¨§®¢ ²¼ ¨µ ­  ¡ §¥
¬ ±±¨¢ .
²¥ª¨
¯¥° ¶¨¿ ¤®¡ ¢«¥­¨¿ ½«¥¬¥­²  ¢ ±²¥ª · ±²® ®¡®§­ · ¥²±¿ Push,
  ®¯¥° ¶¨¿ ³¤ «¥­¨¿ ¢¥°µ­¥£® ½«¥¬¥­²  ¨§ ±²¥ª  · ±²® ®¡®§­ · ¥²±¿ Pop (push ¢ ¤ ­­®¬ ª®­²¥ª±²¥ ®§­ · ¥² À§ ¯¨µ¨¢ ²¼Á,   pop |
À¢»­¨¬ ²¼Á). ²¥ª ¬®¦­® ³¯®¤®¡¨²¼ ±²®¯ª¥ ² °¥«®ª, ¨§ ª®²®°®©
¬®¦­® ¢§¿²¼ ¢¥°µ­¾¾ ¨ ­  ª®²®°³¾ ¬®¦­® ¯®«®¦¨²¼ ­®¢³¾ ² °¥«ª³. [°³£®¥ ­ §¢ ­¨¥ ±²¥ª  ¢ °³±±ª®© «¨²¥° ²³°¥ | À¬ £ §¨­Á
| ¯®­¿²­® ¢±¿ª®¬³, ª²® ° §¡¨° «  ¢²®¬ ²  « ¸­¨ª®¢ .]
  °¨±. 11.1 ¯®ª § ­®, ª ª ¬®¦­® °¥ «¨§®¢ ²¼ ±²¥ª ¥¬ª®±²¼¾ ­¥
¡®«¥¥ n ½«¥¬¥­²®¢ ­  ¡ §¥ ¬ ±±¨¢  S [1 : :n].  °¿¤³ ± ¬ ±±¨¢®¬ ¬»
µ° ­¨¬ ·¨±«® top[S ], ¿¢«¿¾¹¥¥±¿ ¨­¤¥ª±®¬ ¯®±«¥¤­¥£® ¤®¡ ¢«¥­­®£® ¢ ±²¥ª ½«¥¬¥­² . ²¥ª ±®±²®¨² ¨§ ½«¥¬¥­²®¢ S [1 : : top[S ]], £¤¥

204

« ¢  11 «¥¬¥­² °­»¥ ±²°³ª²³°» ¤ ­­»µ

¨±. 11.1 ¥ «¨§ ¶¨¿ ±²¥ª  ­  ¡ §¥ ¬ ±±¨¢  S . ¢¥²«®-±¥°»¥ ª«¥²ª¨ § ­¿²»
½«¥¬¥­² ¬¨ ±²¥ª . ( ) ²¥ª S ±®¤¥°¦¨² 4 ½«¥¬¥­² , ¢¥°µ­¨© ½«¥¬¥­² | ·¨±«® 9.
(¡) ®² ¦¥ ±²¥ª ¯®±«¥ ¢»¯®«­¥­¨¿ ®¯¥° ¶¨© Push(S; 17) ¨ Push(S; 3). (¢) ²¥ª
¯®±«¥ ²®£®, ª ª ®¯¥° ¶¨¿ Pop(S ) ¢¥°­³«  §­ ·¥­¨¥ 3 (¯®±«¥¤­¨© ¤®¡ ¢«¥­­»©
¢ ±²¥ª ½«¥¬¥­²). ®²¿ ·¨±«® 3 ¯®-¯°¥¦­¥¬³ ¯°¨±³²±²¢³¥² ¢ ¬ ±±¨¢¥ S , ¢ ±²¥ª¥
¥£® ³¦¥ ­¥²; ­  ¢¥°¸¨­¥ ±²¥ª  | ·¨±«® 17.

S [1] | ­¨¦­¨© ½«¥¬¥­² ±²¥ª  (À¤­®Á)   S [top[S ]] | ¢¥°µ­¨© ½«¥¬¥­², ¨«¨ ¢¥°¸¨­  ±²¥ª .
±«¨ top[S ] = 0, ²® ±²¥ª ¯³±² (is empty). ±«¨ top[S ] = n, ²® ¯°¨
¯®¯»²ª¥ ¤®¡ ¢¨²¼ ½«¥¬¥­² ¯°®¨±µ®¤¨² ¯¥°¥¯®«­¥­¨¥ (overow), ¯®±ª®«¼ª³ ° §¬¥° ±²¥ª  ¢ ­ ¸¥© °¥ «¨§ ¶¨¨ ®£° ­¨·¥­ ·¨±«®¬ n.
¨¬¬¥²°¨·­ ¿ ±¨²³ ¶¨¿ | ¯®¯»²ª  ³¤ «¨²¼ ½«¥¬¥­² ¨§ ¯³±²®£®
±²¥ª  | ¯®-°³±±ª¨ ­¨ª ª ­¥ ­ §»¢ ¥²±¿ (À­¥¤®-¯®«­¥­¨¥Á?),   ¯® ­£«¨©±ª¨ ­ §»¢ ¥²±¿ underow.  ½²®© £« ¢¥ ¤«¿ ¯°®±²®²» ¬» ­¥
¡³¤¥¬ ®¡° ¹ ²¼ ¢­¨¬ ­¨¥ ­  ¢®§¬®¦­®±²¼ ¯¥°¥¯®«­¥­¨¿ ±²¥ª .
¯¥° ¶¨¨ ±® ±²¥ª®¬ (¯°®¢¥°ª  ¯³±²®²», ¤®¡ ¢«¥­¨¥ ½«¥¬¥­² ,
³¤ «¥­¨¥ ½«¥¬¥­² ) § ¯¨±»¢ ¾²±¿ ² ª:
Stack-Empty(S )
1 if top[S ] = 0
2 then return true
3 else return false
Push(S; x)

1 top[S ] top[S ] + 1
2 S [top[S ]] x

Pop(S )
1 if Stack-Empty(S )

2
3
4

then error \underow"
else top[S ] top[S ] ; 1
return S [top[S ] + 1]
»¯®«­¥­¨¥ ®¯¥° ¶¨© Push ¨ Pop ¯®ª § ­® ­  °¨±. 11.1.  ¦¤ ¿
¨§ ²°¥µ ®¯¥° ¶¨© ±® ±²¥ª®¬ ¢»¯®«­¿¥²±¿ §  ¢°¥¬¿ O(1).

²¥ª¨ ¨ ®·¥°¥¤¨

205

·¥°¥¤¨
¯¥° ¶¨¾ ¤®¡ ¢«¥­¨¿ ½«¥¬¥­²  ª ®·¥°¥¤¨ ¬» ¡³¤¥¬ ®¡®§­ · ²¼
Enqueue,   ®¯¥° ¶¨¾ ³¤ «¥­¨¿ ½«¥¬¥­²  ¨§ ®·¥°¥¤¨ ¡³¤¥¬ ®¡®§­ · ²¼ Dequeue. ( ª ¨ ¤«¿ ±²¥ª®¢, ³¤ «¿¥¬»© ¨§ ®·¥°¥¤¨ ½«¥¬¥­²
®¯°¥¤¥«¥­ ®¤­®§­ ·­® ¨ ¯®½²®¬³ ¿¢«¿¥²±¿ ­¥ ¯¥°¥¤ ¥²±¿ ¯°®¶¥¤³°¥
¯°®¶¥¤³°¥ Dequeue,   ¢®§¢° ¹ ¥²±¿ ½²®© ¯°®¶¥¤³°®©.) ° ¢¨«®
§¤¥±¼ ² ª®¥ ¦¥, ª ª ¢ ¦¨¢®© ®·¥°¥¤¨: ¯¥°¢»¬ ¯°¨¸¥« | ¯¥°¢»¬
®¡±«³¦¥­. ( ¥±«¨ ­ ¸¨ ¯°®£° ¬¬» ¯° ¢¨«¼­», ¬®¦­® ­¥ ®¯ ± ²¼±¿, ·²® ª²®-²® ¯°®©¤¥² ¡¥§ ®·¥°¥¤¨.)
°³£¨¬¨ ±«®¢ ¬¨, ³ ®·¥°¥¤¨ ¥±²¼ £®«®¢  (head) ¨ µ¢®±² (tail).
«¥¬¥­², ¤®¡ ¢«¿¥¬»© ¢ ®·¥°¥¤¼, ®ª §»¢ ¥²±¿ ¢ ¥¥ µ¢®±²¥, ª ª
²®«¼ª® ·²® ¯®¤®¸¥¤¸¨© ¯®ª³¯ ²¥«¼; ½«¥¬¥­², ³¤ «¿¥¬»© ¨§ ®·¥°¥¤¨, ­ µ®¤¨²±¿ ¢ ¥¥ £®«®¢¥, ª ª ²®² ¯®ª³¯ ²¥«¼, ·²® ®²±²®¿« ¤®«¼¸¥
¢±¥µ.
  °¨±. 11.2 ¯®ª § ­®, ª ª ¬®¦­® °¥ «¨§®¢ ²¼ ®·¥°¥¤¼, ¢¬¥¹ ¾¹³¾ ­¥ ¡®«¥¥ ·¥¬ n ; 1 ½«¥¬¥­², ­  ¡ §¥ ¬ ±±¨¢  Q[1 : :n]. »
µ° ­¨¬ ·¨±«  head[Q] | ¨­¤¥ª± £®«®¢» ®·¥°¥¤¨, ¨ tail[Q] | ¨­¤¥ª± ±¢®¡®¤­®© ¿·¥©ª¨, ¢ ª®²®°³¾ ¡³¤¥² ¯®¬¥¹¥­ ±«¥¤³¾¹¨© ¤®¡ ¢«¿¥¬»© ª ®·¥°¥¤¨ ½«¥¬¥­². ·¥°¥¤¼ ±®±²®¨² ¨§ ½«¥¬¥­²®¢ ¬ ±±¨¢ , ±²®¿¹¨µ ­  ¬¥±² µ ± ­®¬¥° ¬¨ head[Q], head[Q] + 1, : : : ,
tail[Q] ; 1 (¯®¤° §³¬¥¢ ¥²±¿, ·²® ¬ ±±¨¢ ±¢¥°­³² ¢ ª®«¼¶®: §  n ±«¥¤³¥² 1). ±«¨ head[Q] = tail[Q], ²® ®·¥°¥¤¼ ¯³±² . ¥°¢®­ · «¼­®
¨¬¥¥¬ head[Q] = tail[Q] = 1. ±«¨ ®·¥°¥¤¼ ¯³±² , ¯®¯»²ª  ³¤ «¨²¼
½«¥¬¥­² ¨§ ­¥¥ ¢¥¤¥² ª ®¸¨¡ª¥ (underow); ¥±«¨ head[Q] = tail[Q]+1,
²® ®·¥°¥¤¼ ¯®«­®±²¼¾ § ¯®«­¥­ , ¨ ¯®¯»²ª  ¤®¡ ¢¨²¼ ª ­¥© ½«¥¬¥­² ¢»§®¢¥² ¯¥°¥¯®«­¥­¨¥ (overow).
 ­ ¸¨µ °¥ «¨§ ¶¨¿µ ¯°®¶¥¤³° Enqueue ¨ Dequeue ¬» ¨£­®°¨°³¥¬ ¢®§¬®¦­®±²¼ ¯¥°¥¯®«­¥­¨¿ ¨«¨ ¯®¯»²ª¨ ¨§º¿²¨¿ ½«¥¬¥­² 
¨§ ¯³±²®© ®·¥°¥¤¨ (¢ ³¯° ¦­¥­¨¨ 11.1-4 ¬» ¯®¯°®±¨¬ ¢ ± ¢­¥±²¨ ¢
ª®¤ ±®®²¢¥²±²¢³¾¹¨¥ ¯°®¢¥°ª¨).
Enqueue(Q; x)
1 Q[tail[Q]] x
2 if tail[Q] = length[Q]
3 then tail[Q] 1
4 else tail[Q] tail[Q] + 1
Dequeue(Q)

1 x Q[head[Q]]
2 if head[Q] = length[Q]
3 then head[Q] 1
4 else head[Q] head[Q] + 1
5 return x
 ¡®²  ¯°®¶¥¤³° Enqueue ¨ Dequeue ¯®ª § ­  ­  °¨±. 11.2.

206

« ¢  11 «¥¬¥­² °­»¥ ±²°³ª²³°» ¤ ­­»µ

·¥°¥¤¼, °¥ «¨§®¢ ­­ ¿ ­  ¡ §¥ ¬ ±±¨¢  Q[1 : : n]. ¢¥²«®-±¥°»¥ ª«¥²ª¨ § ­¿²» ½«¥¬¥­² ¬¨ ®·¥°¥¤¨. ( )  ®·¥°¥¤¨ ­ µ®¤¿²±¿ 5 ½«¥¬¥­²®¢ (¯®§¨¶¨¨ Q[7 : : 11]). (¡) ·¥°¥¤¼ ¯®±«¥ ¢»¯®«­¥­¨¿ ¯°®¶¥¤³° Enqueue(Q; 17), Enqueue(Q; 3) ¨ Enqueue(Q; 5). (¢) ·¥°¥¤¼ ¯®±«¥ ¢»¯®«­¥­¨¿ ¯°®¶¥¤³°» Dequeue(Q) (ª®²®° ¿ ¢®§¢° ¹ ¥² §­ ·¥­¨¥ 15). ®¢®© £®«®¢®© ®·¥°¥¤¨ ±² «® ·¨±«® 6.
¨±. 11.2

 ¦¤ ¿ ¨§ ½²¨µ ¯°®¶¥¤³° ° ¡®² ¥² §  ¢°¥¬¿ O(1).
¯° ¦­¥­¨¿
11.1-1 «¥¤³¿ ®¡° §¶³ °¨±. 11.1, ¯®ª ¦¨²¥ ° ¡®²³ ®¯¥° ¶¨©
Push(S; 4), Push(S; 1), Push(S; 3), Pop(S ), Push(S; 8) ¨ Pop(S ) ­ 
±²¥ª¥, °¥ «¨§®¢ ­­®¬ ± ¯®¬®¹¼¾ ¬ ±±¨¢  S [1 : : 6]. ¥°¢®­ · «¼­®
±²¥ª ¯³±².
11.1-2  ª ­  ¡ §¥ ®¤­®£® ¬ ±±¨¢  A[1 : :n] °¥ «¨§®¢ ²¼ ¤¢  ±²¥ª 
±³¬¬ °­®© ¤«¨­» ­¥ ¡®«¼¸¥ n? ¯¥° ¶¨¨ Push ¨ Pop ¤®«¦­»
¢»¯®«­¿²¼±¿ §  ¢°¥¬¿ O(1).
11.1-3

«¥¤³¿ ®¡° §¶³ °¨±. 11.2, ¯®ª ¦¨²¥ ° ¡®²³ ®¯¥° ¶¨©

Enqueue(Q; 4), Enqueue(Q; 1), Enqueue(Q; 3), Dequeue(Q),
Enqueue(Q; 8) ¨ Dequeue(Q) ­  ®·¥°¥¤¨, °¥ «¨§®¢ ­­®© ± ¯®¬®-

¹¼¾ ¬ ±±¨¢  Q[1 : : 5]. ¥°¢®­ · «¼­® ®·¥°¥¤¼ ¯³±² .

11.1-4 ¥°¥¯¨¸¨²¥ ¯°®¶¥¤³°» Enqueue ¨ Dequeue, ¯°¥¤³±¬®²°¥¢ ¯°®¢¥°ª¨ ­  ±«³· © ¯¥°¥¯®«­¥­¨¿ ¨«¨ underow.
11.1-5 ²¥ª ¯®§¢®«¿¥² ¤®¡ ¢«¿²¼ ¨ ³¤ «¿²¼ ½«¥¬¥­²» ²®«¼ª® ±
®¤­®£® ª®­¶ .  ®·¥°¥¤¼ ¤®¡ ¢«¿²¼ ½«¥¬¥­²» ¬®¦­® ²®«¼ª® ± ®¤­®£® ª®­¶ ,   ³¤ «¿²¼ | ²®«¼ª® ± ¤°³£®£®. ²°³ª²³°  ¤ ­­»µ, ­ §»¢ ¥¬ ¿ ¤¥ª®¬ (deque, ®² double-ended queue | À®·¥°¥¤¼ ± ¤¢³¬¿

¢¿§ ­­»¥ ±¯¨±ª¨

207

ª®­¶ ¬¨Á), ¯®§¢®«¿¥² ¤®¡ ¢«¿²¼ ¨ ³¤ «¿²¼ ½«¥¬¥­²» ± ®¡®¨µ ª®­¶®¢. ¥ «¨§³©²¥ ¤¥ª ­  ¡ §¥ ¬ ±±¨¢  ² ª¨¬ ®¡° §®¬, ·²®¡» ®¯¥° ¶¨¨ ¤®¡ ¢«¥­¨¿ ¨ ³¤ «¥­¨¿ ½«¥¬¥­²  ± ª ¦¤®£® ¨§ ª®­¶®¢ § ­¨¬ «¨
¢°¥¬¿ O(1).
11.1-6 ¡º¿±­¨²¥, ª ª ¬®¦­® °¥ «¨§®¢ ²¼ ®·¥°¥¤¼ ­  ¡ §¥ ¤¢³µ
±²¥ª®¢.  ª®¢® ¢°¥¬¿ ° ¡®²» ®¯¥° ¶¨© Enqueue ¨ Dequeue ¯°¨
² ª®© °¥ «¨§ ¶¨¨?
11.1-7 ¡º¿±­¨²¥, ª ª °¥ «¨§®¢ ²¼ ±²¥ª ­  ¡ §¥ ¤¢³µ ®·¥°¥¤¥©.
 ª®¢® ¢°¥¬¿ ° ¡®²» ±²¥ª®¢»µ ®¯¥° ¶¨©?

11.2. ¢¿§ ­­»¥ ±¯¨±ª¨
 ±¢¿§ ­­®¬ ±¯¨±ª¥ (¨«¨ ¯°®±²® ±¯¨±ª¥; ¯®- ­£«¨©±ª¨ linked list)
½«¥¬¥­²» «¨­¥©­® ³¯®°¿¤®·¥­», ­® ¯®°¿¤®ª ®¯°¥¤¥«¿¥²±¿ ­¥ ­®¬¥° ¬¨, ª ª ¢ ¬ ±±¨¢¥,   ³ª § ²¥«¿¬¨, ¢µ®¤¿¹¨¬¨ ¢ ±®±² ¢ ½«¥¬¥­²®¢
±¯¨±ª . ¯¨±ª¨ ¿¢«¿¾²±¿ ³¤®¡­»¬ ±¯®±®¡®¬ °¥ «¨§ ¶¨¨ ¤¨­ ¬¨·¥±ª¨µ ¬­®¦¥±²¢, ¯®§¢®«¿¾¹¨¬ °¥ «¨§®¢ ²¼ ¢±¥ ®¯¥° ¶¨¨, ¯¥°¥·¨±«¥­­»¥ ¢® ¢¢¥¤¥­¨¨ ª ½²®© · ±²¨ (µ®²¿ ¨ ­¥ ¢±¥£¤  ½´´¥ª²¨¢­®).
±«¨ ª ¦¤»© ±²®¿¹¨© ¢ ®·¥°¥¤¨ § ¯®¬­¨², ª²® §  ­¨¬ ±²®¨²,
¯®±«¥ ·¥£® ¢±¥ ¢ ¡¥±¯®°¿¤ª¥ ° ±±¿¤³²±¿ ­  « ¢®·ª¥, ¯®«³·¨²±¿ ®¤­®±²®°®­­¥ ±¢¿§ ­­»© ±¯¨±®ª; ¥±«¨ ®­ § ¯®¬­¨² ¥¹¥ ¨ ¢¯¥°¥¤¨ ±²®¿¹¥£®, ¡³¤¥² ¤¢³±²®°®­­¥ ±¢¿§ ­­»© ±¯¨±®ª.
°³£¨¬¨ ±«®¢ ¬¨, ª ª ¯®ª § ­® ­  °¨±. 11.3, ½«¥¬¥­² ¤¢³±²®°®­­¥ ±¢¿§ ­­®£® ±¯¨±ª  (doubly linked list) | ½²® § ¯¨±¼, ±®¤¥°¦ ¹ ¿
²°¨ ¯®«¿: key (ª«¾·) ¨ ¤¢  ³ª § ²¥«¿ next (±«¥¤³¾¹¨©) ¨ prev (®²
previous | ¯°¥¤»¤³¹¨©). ®¬¨¬® ½²®£®, ½«¥¬¥­²» ±¯¨±ª  ¬®£³²
±®¤¥°¦ ²¼ ¤®¯®«­¨²¥«¼­»¥ ¤ ­­»¥. ±«¨ x | ½«¥¬¥­² ±¯¨±ª , ²®
next[x] ³ª §»¢ ¥² ­  ±«¥¤³¾¹¨© ½«¥¬¥­² ±¯¨±ª ,   prev[x] | ­ 
¯°¥¤¸¥±²¢³¾¹¨©. ±«¨ prev[x] = nil, ²® ³ ½«¥¬¥­²  x ­¥² ¯°¥¤¸¥±²¢³¾¹¥£®: ½²® £®«®¢  (head) ±¯¨±ª . ±«¨ next[x] = nil, ²® x |
¯®±«¥¤­¨© ½«¥¬¥­² ±¯¨±ª  ¨«¨, ª ª £®¢®°¿², ¥£® µ¢®±² (tail).
°¥¦¤¥ ·¥¬ ¤¢¨£ ²¼±¿ ¯® ³ª § ²¥«¿¬, ­ ¤® §­ ²¼ µ®²¿ ¡» ®¤¨­
½«¥¬¥­² ±¯¨±ª ; ¬» ¯°¥¤¯®« £ ¥¬, ·²® ¤«¿ ±¯¨±ª  L ¨§¢¥±²¥­ ³ª § ²¥«¼ head[L] ­  ¥£® £®«®¢³. ±«¨ head[L] = nil, ²® ±¯¨±®ª ¯³±².
 ° §«¨·­»µ ±¨²³ ¶¨¿µ ¨±¯®«¼§³¾²±¿ ° §­»¥ ¢¨¤» ±¯¨±ª®¢. 
®¤­®±²®°®­­¥ ±¢¿§ ­­®¬ (singly linked) ±¯¨±ª¥ ®²±³²±²¢³¾² ¯®«¿ prev.  ³¯®°¿¤®·¥­­®¬ (sorted) ±¯¨±ª¥ ½«¥¬¥­²» ° ±¯®«®¦¥­»
¢ ¯®°¿¤ª¥ ¢®§° ±² ­¨¿ ª«¾·¥©, ² ª ·²® ³ £®«®¢» ±¯¨±ª  ª«¾· ­ ¨¬¥­¼¸¨©,   ³ µ¢®±²  ±¯¨±ª  | ­ ¨¡®«¼¸¨©, ¢ ®²«¨·¨¥ ®² ­¥³¯®°¿¤®·¥­­®£® (unsorted) ±¯¨±ª .  ª®«¼¶¥¢®¬ ±¯¨±ª¥ (circular list)
¯®«¥ prev £®«®¢» ±¯¨±ª  ³ª §»¢ ¥² ­  µ¢®±² ±¯¨±ª ,   ¯®«¥ next
µ¢®±²  ±¯¨±ª  ³ª §»¢ ¥² ­  £®«®¢³ ±¯¨±ª .
±«¨ ¨­®¥ ­¥ ®£®¢®°¥­® ®±®¡®, ¯®¤ ±¯¨±ª®¬ ¬» ¡³¤¥¬ ¯®­¨¬ ²¼

208

« ¢  11 «¥¬¥­² °­»¥ ±²°³ª²³°» ¤ ­­»µ

( ) ¢³±²®°®­­¥ ±¢¿§ ­­»© ±¯¨±®ª L ±®¤¥°¦¨² ·¨±«  1; 4; 9; 16.  ¦¤»© ½«¥¬¥­² ±¯¨±ª  | ½²® § ¯¨±¼ ± ¯®«¿¬¨ ¤«¿ ª«¾·  ¨ ³ª § ²¥«¥© ­  ¯°¥¤»¤³¹¨© ¨ ¯®±«¥¤³¾¹¨© ½«¥¬¥­²» (½²¨ ³ª § ²¥«¨ ¨§®¡° ¦¥­» ±²°¥«ª ¬¨). 
¯®«¥ next ³ µ¢®±²  ±¯¨±ª  ¨ ¢ ¯®«¥ prev ³ £®«®¢» ±¯¨±ª  ­ µ®¤¨²±¿ ³ª § ²¥«¼ nil
(ª®± ¿ ·¥°²  ­  °¨±³­ª¥); head[L] ³ª §»¢ ¥² ­  £®«®¢³ ±¯¨±ª . (¡)  °¥§³«¼² ²¥ ¢»¯®«­¥­¨¿ ®¯¥° ¶¨¨ List-Insert(L; x), £¤¥ key[x] = 25, ¢ ±¯¨±ª¥ ¯®¿¢¨«±¿
­®¢»© ½«¥¬¥­² ± ª«¾·®¬ 25; ®­ ±² « ­®¢®© £®«®¢®© ±¯¨±ª ,   ¥£® ¯®«¥ next
³ª §»¢ ¥² ­  ¡»¢¸³¾ £®«®¢³ | ½«¥¬¥­² ± ª«¾·®¬ 9. (¢) ±«¥¤ §  ½²¨¬ ¡»« 
¢»¯®«­¥­  ®¯¥° ¶¨¿ List-Delete(L; x), £¤¥ x | ³ª § ²¥«¼ ­  ½«¥¬¥­² ± ª«¾·®¬
4.
¨±. 11.3

­¥³¯®°¿¤®·¥­­»© ¤¢³±²®°®­­¥ ±¢¿§ ­­»© ±¯¨±®ª.
®¨±ª ¢ ±¯¨±ª¥
°®¶¥¤³°  List-Search(L; k) ­ µ®¤¨² ¢ ±¯¨±ª¥ L (± ¯®¬®¹¼¾
¯°®±²®£® «¨­¥©­®£® ¯®¨±ª ) ¯¥°¢»© ½«¥¬¥­², ¨¬¥¾¹¨© ª«¾· k.
®·­¥¥ £®¢®°¿, ®­  ¢®§¢° ¹ ¥² ³ª § ²¥«¼ ­  ½²®² ½«¥¬¥­², ¨«¨ nil,
¥±«¨ ½«¥¬¥­²  ± ² ª¨¬ ª«¾·®¬ ¢ ±¯¨±ª¥ ­¥². ±«¨, ­ ¯°¨¬¥°, L |
±¯¨±®ª °¨±. 11.3 , ²® ¢»§®¢ List-Search(L; 4) ¢¥°­¥² ³ª § ²¥«¼ ­ 
²°¥²¨© ½«¥¬¥­² ±¯¨±ª ,   ¢»§®¢ List-Search(L; 7) ¢¥°­¥² nil.
List-Search(L; k)
1 x head[L]
2 while x 6= nil and key[x] 6= k
3
do x next[x]
4 return x
®¨±ª ¢ ±¯¨±ª¥ ¨§ n ½«¥¬¥­²®¢ ²°¥¡³¥² ¢ µ³¤¸¥¬ ±«³· ¥ (ª®£¤ 
¯°¨µ®¤¨²±¿ ¯°®±¬ ²°¨¢ ²¼ ¢¥±¼ ±¯¨±®ª) (n) ®¯¥° ¶¨©.
®¡ ¢«¥­¨¥ ½«¥¬¥­²  ¢ ±¯¨±®ª
°®¶¥¤³°  List-Insert ¤®¡ ¢«¿¥² ½«¥¬¥­² x ª ±¯¨±ª³ L, ¯®¬¥¹ ¿
¥£® ¢ £®«®¢³ ±¯¨±ª  (°¨±. 11.3¡).

¢¿§ ­­»¥ ±¯¨±ª¨

209

List-Insert(L; x)

1 next[x] head[L]
2 if head[L] 6= nil
3 then prev[head[L]] x
4 head[L] x
5 prev[x] nil
°®¶¥¤³°  List-Insert ¢»¯®«­¿¥²±¿ §  ¢°¥¬¿ O(1) (­¥ § ¢¨±¿¹¥¥
®² ¤«¨­» ±¯¨±ª ).
¤ «¥­¨¥ ½«¥¬¥­²  ¨§ ±¯¨±ª 
°®¶¥¤³°  List-Delete ³¤ «¿¥² ½«¥¬¥­² x ¨§ ±¯¨±ª  L, ­ ¯° ¢«¿¿ ³ª § ²¥«¨ À¢ ®¡µ®¤Á ½²®£® ½«¥¬¥­² . °¨ ½²®¬ ¢ ª ·¥±²¢¥  °£³¬¥­²  ¥© ¯¥°¥¤ ¥²±¿ ³ª § ²¥«¼ ­  x. ±«¨ § ¤ ­ ª«¾· ½«¥¬¥­²  x,
²® ¯¥°¥¤ ³¤ «¥­¨¥¬ ­ ¤® ­ ©²¨ ¥£® ³ª § ²¥«¼ ± ¯®¬®¹¼¾ ¯°®¶¥¤³°» List-Search.
List-Delete(L; x)
1 if prev[x] 6= nil
2 then next[prev[x]] next[x]
3 else head[L] next[x]
4 if next[x] 6= nil
5 then prev[next[x]] prev[x]
¤ «¥­¨¥ ½«¥¬¥­²  ¨§ ±¯¨±ª  ¯°®¨««¾±²°¨°®¢ ­® ­  °¨±. 11.3¢.
°®¶¥¤³°  List-Delete ° ¡®² ¥² §  ¢°¥¬¿ O(1); ®¤­ ª® ¤«¿ ³¤ «¥­¨¿ ½«¥¬¥­²  ± § ¤ ­­»¬ ª«¾·®¬ ¥£® ­ ¤® ±­ · «  ­ ©²¨, ·²®
¯®²°¥¡³¥² ¢°¥¬¥­¨ (n).
¨ª²¨¢­»¥ ½«¥¬¥­²»
±«¨ § ¡»²¼ ®¡ ®±®¡»µ ±¨²³ ¶¨¿µ ­  ª®­¶ µ ±¯¨±ª , ¯°®¶¥¤³°³ List-Delete ¬®¦­® § ¯¨± ²¼ ±®¢±¥¬ ¯°®±²®:
List-Delete0 (L; x)
1 next[prev[x]] next[x]
2 prev[next[x]] prev[x]
 ª¨¥ ³¯°®¹¥­¨¿ ±² ­³² § ª®­­»¬¨, ¥±«¨ ¤®¡ ¢¨²¼ ª ±¯¨±ª³ L
´¨ª²¨¢­»© ½«¥¬¥­² nil[L], ª®²®°»© ¡³¤¥² ¨¬¥²¼ ¯®«¿ next ¨ prev
­ ° ¢­¥ ± ¯°®·¨¬¨ ½«¥¬¥­² ¬¨ ±¯¨±ª . ²®² ½«¥¬¥­² (­ §»¢ ¥¬»©
sentinel | · ±®¢®©) ­¥ ¯®§¢®«¨² ­ ¬ ¢»©²¨ §  ¯°¥¤¥«» ±¯¨±ª . ª § ²¥«¼ ­  ­¥£® ¨£° ¥² °®«¼ §­ ·¥­¨¿ nil.  ¬ª­¥¬ ±¯¨±®ª ¢ ª®«¼¶®: ¢ ¯®«¿ next[nil[L]] ¨ prev[nil[L]] § ¯¨¸¥¬ ³ª § ²¥«¨ ­  £®«®¢³ ¨
µ¢®±² ±¯¨±ª  ±®®²¢¥²±²¢¥­­®,   ¢ ¯®«¿ prev ³ £®«®¢» ±¯¨±ª  ¨ next

210

« ¢  11 «¥¬¥­² °­»¥ ±²°³ª²³°» ¤ ­­»µ

¯¨±®ª L, ¨±¯®«¼§³¾¹¨© ´¨ª²¨¢­»© ½«¥¬¥­² nil[L] (²¥¬­®-±¥°»©
¯°¿¬®³£®«¼­¨ª). ¬¥±²® head[L] ¨±¯®«¼§³¥¬ next[nil[L]]. ( ) ³±²®© ±¯¨±®ª.
(¡) ¯¨±®ª °¨±. 11.3  (½«¥¬¥­² ± ª«¾·®¬ 9 | £®«®¢ , 1 | µ¢®±²). (¢) ®² ¦¥
±¯¨±®ª ¯®±«¥ ¯°®¶¥¤³°» List-Insert0 (L; x), ¥±«¨ key[x] = 25. (£) ®±«¥ ³¤ «¥­¨¿
½«¥¬¥­²  ± ª«¾·®¬ 1. ®¢»© µ¢®±² ¨¬¥¥² ª«¾· 4.
¨±. 11.4

³ µ¢®±²  ±¯¨±ª  § ­¥±¥¬ ³ª § ²¥«¨ ­  nil[L] (°¨±. 11.4). °¨ ½²®¬
next[nil[L]] | ³ª § ²¥«¼ ­  £®«®¢³ ±¯¨±ª , ² ª ·²®  ²°¨¡³² head[L]
±² ­®¢¨²±¿ «¨¸­¨¬. ³±²®© ±¯¨±®ª L ²¥¯¥°¼ ¡³¤¥² ª®«¼¶®¬, ¢ ª®²®°®¬ nil[L] | ¥¤¨­±²¢¥­­»© ½«¥¬¥­².
 ¯°®¶¥¤³°¥ List-Search ­³¦­® «¨¸¼ § ¬¥­¨²¼ nil ­  nil[L] ¨
head[L] ­  next[nil[L]]:
List-Search0 (L; k)
1 x next[nil[L]]
2 while x 6= nil[L] and key[x] 6= k
3
do x next[x]
4 return x
«¿ ³¤ «¥­¨¿ ½«¥¬¥­²  £®¤¨²±¿ ¯°®¶¥¤³°  List-Delete0 , ¯°¨¢¥¤¥­­ ¿ ¢»¸¥.  ª®­¥¶, ¤®¡ ¢«¿²¼ ½«¥¬¥­² ª ±¯¨±ª³ ¬®¦­® ² ª:
List-Insert0 (L; x)
1 next[x] next[nil[L]]
2 prev[next[nil[L]]] x
3 next[nil[L]] x
4 prev[x] nil[L]
°¨¬¥° ° ¡®²» ¯°®¶¥¤³° List-Insert0 ¨ List-Delete0 ¯®ª § ­ ­ 
°¨±. 11.4.
±¯®«¼§®¢ ­¨¥ ´¨ª²¨¢­»µ ½«¥¬¥­²®¢ ¥¤¢  «¨ ¬®¦¥² ³«³·¸¨²¼
 ±¨¬¯²®²¨ª³ ¢°¥¬¥­¨ ° ¡®²»  «£®°¨²¬ , ­® ³¯°®¹ ¥² ¯°®£° ¬¬³. ­®£¤  (¥±«¨ ¨±¯®«¼§®¢ ­¨¥ ´¨ª²¨¢­»µ ½«¥¬¥­²®¢ ¯®§¢®«¿¥²
±®ª° ²¨²¼ ´° £¬¥­² ª®¤ , ­ µ®¤¿¹¨©±¿ £«³¡®ª® ¢­³²°¨ ¶¨ª« ),
¬®¦­® ³±ª®°¨²¼ ¨±¯®«­¥­¨¥ ¯°®£° ¬¬» ¢ ­¥±ª®«¼ª® ° §.
¥ ±«¥¤³¥² ¯°¨¬¥­¿²¼ ´¨ª²¨¢­»¥ ½«¥¬¥­²» ¡¥§ ­³¦¤». ±«¨  «£®°¨²¬ ¨±¯®«¼§³¥² ¬­®£® ª®°®²ª¨µ ±¯¨±ª®¢, ¨±¯®«¼§®¢ ­¨¥ ´¨ª-

¢¿§ ­­»¥ ±¯¨±ª¨

211

²¨¢­»µ ½«¥¬¥­²®¢ ¬®¦¥² ®¡¥°­³²¼±¿ ±¥°¼¥§­®© ¤®¯®«­¨²¥«¼­®©
²° ²®© ¯ ¬¿²¨.  ½²®© ª­¨£¥ ´¨ª²¨¢­»¥ ½«¥¬¥­²» ¨±¯®«¼§³¾²±¿
²®«¼ª® ²®£¤ , ª®£¤  ½²® ±³¹¥±²¢¥­­® ³¯°®¹ ¥² ¯°®£° ¬¬³.
¯° ¦­¥­¨¿
11.2-1 ®¦­® «¨ ¤®¡ ¢¨²¼ ½«¥¬¥­² ¢ ¬­®¦¥±²¢®, ¯°¥¤±² ¢«¥­­®¥
®¤­®±²®°®­­¥ ±¢¿§ ­­»¬ ±¯¨±ª®¬, §  ¢°¥¬¿ O(1)? ®² ¦¥ ¢®¯°®±
¤«¿ ³¤ «¥­¨¿ ½«¥¬¥­² .
11.2-2 ¥ «¨§³©²¥ ±²¥ª ­  ¡ §¥ ®¤­®±²®°®­­¥ ±¢¿§ ­­®£® ±¯¨±ª .
¯¥° ¶¨¨ Push ¨ Pop ¤®«¦­» ¢»¯®«­¿²¼±¿ §  ¢°¥¬¿ O(1).
11.2-3 ¥ «¨§³©²¥ ®·¥°¥¤¼ ­  ¡ §¥ ®¤­®±²®°®­­¥ ±¢¿§ ­­®£®
±¯¨±ª . ¯¥° ¶¨¨ Enqueue ¨ Dequeue ¤®«¦­» ¢»¯®«­¿²¼±¿ § 
¢°¥¬¿ O(1).
11.2-4 ¥ «¨§³©²¥ ±«®¢ °­»¥ ®¯¥° ¶¨¨ Insert, Delete
¨ Search ¤«¿ ±¢¥°­³²®£® ¢ ª®«¼¶® ®¤­®±²®°®­­¥ ±¢¿§ ­­®£®
±¯¨±ª .  ª®¢® ¢°¥¬¿ ° ¡®²» ¢ ¸¨µ ¯°®¶¥¤³°?
11.2-5 ¯¥° ¶¨¿ Union (®¡º¥¤¨­¥­¨¥) ¯®«³· ¥² ­  ¢µ®¤¥ ¤¢  ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ¬­®¦¥±²¢  ¨ ¢®§¢° ¹ ¥² ¨µ ®¡º¥¤¨­¥­¨¥ (± ¬¨
¨±µ®¤­»¥ ¬­®¦¥±²¢  ¯°¨ ½²®¬ ¯°®¯ ¤ ¾²). ¥ «¨§³©²¥ ½²³ ®¯¥° ¶¨¾ ² ª, ·²®¡» ®­  ° ¡®² «  §  ¢°¥¬¿ O(1), ¯°¥¤±² ¢«¿¿ ¬­®¦¥±²¢  ±¯¨±ª ¬¨ ¯®¤µ®¤¿¹¥£® ²¨¯ .
11.2-6  ¯¨¸¨²¥ ¯°®¶¥¤³°³, ª®²®° ¿ ±«¨¢ ¥² ¤¢  ®¤­®±²®°®­­¥
±¢¿§ ­­»µ ³¯®°¿¤®·¥­­»µ ±¯¨±ª  ¢ ®¤¨­ (² ª¦¥ ³¯®°¿¤®·¥­­»©),
­¥ ¨±¯®«¼§³¿ ´¨ª²¨¢­»µ ½«¥¬¥­²®¢.  ²¥¬ ±¤¥« ©²¥ ½²®, ¨±¯®«¼§³¿
´¨ª²¨¢­»© ½«¥¬¥­² ± ª«¾·®¬ 1 (¤®¡ ¢«¿¥¬»© ¢ ª®­¥¶ ±¯¨±ª®¢).
 ª ¿ ¨§ ¤¢³µ ¯°®£° ¬¬ ¯°®¹¥?
11.2-7  ¯¨¸¨²¥ ­¥°¥ª³°±¨¢­³¾ ¯°®¶¥¤³°³, ª®²®° ¿ §  ¢°¥¬¿
(n) ¯¥°¥±² ¢«¿¥² ½«¥¬¥­²» ®¤­®±²®°®­­¥ ±¢¿§ ­­®£® ±¯¨±ª  ¢
®¡° ²­®¬ ¯®°¿¤ª¥. ¡º¥¬ ¤®¯®«­¨²¥«¼­®© (¯®¬¨¬® ­¥®¡µ®¤¨¬®©
¤«¿ µ° ­¥­¨¿ ¨±µ®¤­®£® ±¯¨±ª ) ¯ ¬¿²¨ ¤®«¦¥­ ¡»²¼ O(1).
11.2-8? ±²¼ ±¯®±®¡ ±½ª®­®¬¨²¼ ¬¥±²® ¯°¨ °¥ «¨§ ¶¨¨ ¤¢³±²®°®­­¥ ±¢¿§ ­­®£® ±¯¨±ª , ±¦ ¢ ¤¢  ³ª § ²¥«¿ next ¨ prev ¢ ®¤­® §­ ·¥­¨¥ np[x]. ³¤¥¬ ±·¨² ²¼, ·²® ¢±¥ ³ª § ²¥«¨ ±³²¼ k-¡¨²­»¥ ·¨±«  ¨ ³ª § ²¥«¾ nil ±®®²¢¥²±²¢³¥² ·¨±«® ­³«¼. ¯°¥¤¥«¨¬ np[x] ¯®
´®°¬³«¥ np[x] = next[x] XOR prev[x], £¤¥ XOR | ¯®¡¨²®¢®¥ ±«®¦¥­¨¥ ¯® ¬®¤³«¾ 2 (¨±ª«¾· ¾¹¥¥ ). ¥ § ¡³¤¼²¥ ³ª § ²¼, ª ª¨¬
®¡° §®¬ µ° ­¨²±¿ ¨­´®°¬ ¶¨¿ ® £®«®¢¥ ±¯¨±ª .  ª °¥ «¨§®¢ ²¼
®¯¥° ¶¨¨ Search, Insert ¨ Delete? ¡º¿±­¨²¥, ª ª ¯¥°¥±² ¢¨²¼
² ª®© ±¯¨±®ª ¢ ®¡° ²­®¬ ¯®°¿¤ª¥ §  ¢°¥¬¿ O(1).

212

« ¢  11 «¥¬¥­² °­»¥ ±²°³ª²³°» ¤ ­­»µ

¯¨±®ª °¨±. 11.3 , ¯°¥¤±² ¢«¥­­»© ± ¯®¬®¹¼¾ ²°®©ª¨ ¬ ±±¨¢®¢
(key; next; prev).  ¦¤®¬³ ½«¥¬¥­²³ ±¯¨±ª  ±®®²¢¥²±²¢³¥² ±¢¥²«®-±¥°»© ±²®«¡¨ª.
 ¢¥°µ­¥© ±²°®·ª¥ ¢»¯¨± ­» ¯®°¿¤ª®¢»¥ ­®¬¥° , ¨£° ¾¹¨¥ °®«¼ ³ª § ²¥«¥©;
¤¥©±²¢¨¥ ³ª § ²¥«¥© ¯®ª § ­® ±²°¥«ª ¬¨. ­ ·¥­¨¥ ¯¥°¥¬¥­­®© L | ³ª § ²¥«¼
­  £®«®¢³ ±¯¨±ª .
¨±. 11.5

11.3. ¥ «¨§ ¶¨¿ ³ª § ²¥«¥© ¨ § ¯¨±¥© ± ­¥±ª®«¼ª¨¬¨ ¯®«¿¬¨
 ¿§»ª µ ¢°®¤¥ ´®°²° ­  ­¥ ¯°¥¤³±¬®²°¥­® ­¨ ³ª § ²¥«¥©, ­¨
½«¥¬¥­²®¢, ¨¬¥¾¹¨µ ­¥±ª®«¼ª® ¯®«¥©.  ² ª®¬ ±«³· ¥ ¯°¨µ®¤¨²±¿
®¡µ®¤¨²¼±¿ ¬ ±±¨¢ ¬¨, ¨±¯®«¼§³¿ ¨­¤¥ª± ¢ ¬ ±±¨¢¥ ª ª ³ª § ²¥«¼
¨ § ¬¥­¿¿ ¬ ±±¨¢ § ¯¨±¥© ­¥±ª®«¼ª¨¬¨ ¬ ±±¨¢ ¬¨.
°¥¤±² ¢«¥­¨¥ ± ¯®¬®¹¼¾ ­¥±ª®«¼ª¨µ ¬ ±±¨¢®¢
 ±±¨¢, ±®±² ¢«¥­­»© ¨§ § ¯¨±¥©, ¬®¦­® § ¬¥­¨²¼ ­¥±ª®«¼ª¨¬¨ ¬ ±±¨¢ ¬¨ (¯® ®¤­®¬³ ­  ª ¦¤®¥ ¯®«¥ § ¯¨±¨).  ¯°¨¬¥°, ­ 
°¨±. 11.5 ¯®ª § ­®, ª ª ¯°¥¤±² ¢¨²¼ ¢ ¢¨¤¥ ²°¥µ ¬ ±±¨¢®¢ ²®² ¦¥
±¯¨±®ª, ·²® ¨ ­  °¨±. 11.3 : ¢ ¬ ±±¨¢¥ key µ° ­¿²±¿ ª«¾·¨,   ¢
¬ ±±¨¢ µ next ¨ prev | ³ª § ²¥«¨.  ¦¤®¬³ ½«¥¬¥­²³ ±¯¨±ª  ±®®²¢¥²±²¢³¥² ²°®©ª  (key[x]; next[x]; prev[x]) ¤«¿ ­¥ª®²®°®£® ¨­¤¥ª±  x. ®«¼ ³ª § ²¥«¿ ­  ½²®² ½«¥¬¥­² ¨£° ¥² ·¨±«® x.  ª ·¥±²¢¥
nil ¬®¦­® ¨±¯®«¼§®¢ ²¼ ·¨±«®, ­¥ ¿¢«¿¾¹¥¥±¿ ¨­¤¥ª±®¬ ­¨ª ª®£®
½«¥¬¥­²  ¬ ±±¨¢®¢ (­ ¯°¨¬¥°, 0 ¨«¨ ;1).   °¨±. 11.3  § ¯¨±¼ ±
ª«¾·®¬ 4 ±²®¨² ¢ ±¯¨±ª¥ ±° §³ ¯®±«¥ § ¯¨±¨ ± ª«¾·®¬ 16; ¨ ¤¥©±²¢¨²¥«¼­®, ·¨±«® 16 ±²®¨² ¢ ¬ ±±¨¢¥ key ­  ¬¥±²¥ ± ­®¬¥°®¬ 5,
·¨±«® 4 | ­  ¬¥±²¥ ­®¬¥° 2, ¨ ¨¬¥¥¬ next[5] = 2,   ² ª¦¥ prev[2] = 5.
 ­ ¸¨µ ¯°®£° ¬¬ µ ®¡®§­ ·¥­¨¥ ²¨¯  key[x] ¬®¦¥² ¯®­¨¬ ²¼±¿
¤¢®¿ª®: ¨ ª ª ½«¥¬¥­² ¬ ±±¨¢  key ± ¨­¤¥ª±®¬ x, ¨ ª ª ¯®«¥ key
§ ¯¨±¨ ±  ¤°¥±®¬ x (¢ § ¢¨±¨¬®±²¨ ®² ¢®§¬®¦­®±²¥© ¿§»ª  ¯°®£° ¬¬¨°®¢ ­¨¿ ¯®«¥§­® ²® ¨«¨ ¤°³£®¥ ¯®­¨¬ ­¨¥).
°¥¤±² ¢«¥­¨¥ ± ¯®¬®¹¼¾ ®¤­®£® ¬ ±±¨¢ 
¬¥±²® ­¥±ª®«¼ª¨µ ¬ ±±¨¢®¢ ¬®¦­® ¨±¯®«¼§®¢ ²¼ ®¤¨­, ° §¬¥¹ ¿ ¢ ­¥¬ ° §«¨·­»¥ ¯®«¿ ®¤­®£® ®¡º¥ª²  °¿¤®¬.  ª ®¡»·­® ¯®±²³¯ ¥² ª®¬¯¨«¿²®°: ¥±«¨ ¢ ¯°®£° ¬¬¥ ¨±¯®«¼§³¥²±¿ ¬ ±±¨¢ ½«¥-

¥ «¨§ ¶¨¿ ³ª § ²¥«¥© ¨ § ¯¨±¥© ± ­¥±ª®«¼ª¨¬¨ ¯®«¿¬¨

213

¨±. 11.6 ®² ¦¥ ±¯¨±®ª, ·²® ­  °¨±. 11.3  ¨ 11.5, °¥ «¨§®¢ ­­»© ­  ¡ §¥ ¥¤¨­±²¢¥­­®£® ¬ ±±¨¢  A.  ¦¤®© § ¯¨±¨ ±®®²¢¥²±²¢³¥² ²°®©ª  ¨¤³¹¨µ ¯®¤°¿¤
½«¥¬¥­²®¢ ¬ ±±¨¢ . ®«¿¬ key, next ¨ prev ±®®²¢¥²±²¢³¾² ±¤¢¨£¨ 0, 1 ¨ 2. ª § ²¥«¼ ­  § ¯¨±¼ | ¨­¤¥ª± ¯¥°¢®£® ¨§ ®²¢¥¤¥­­»µ ¤«¿ ­¥¥ ½«¥¬¥­²®¢. ¢¥²«®±¥°»¥ § ¯¨±¨ ¢µ®¤¿² ¢ ±¯¨±®ª; ±²°¥«ª ¬¨ ¨§®¡° ¦¥­® ¤¥©±²¢¨¥ ³ª § ²¥«¥©.

¬¥­²®¢, ª ¦¤»© ¨§ ª®²®°»µ ¨¬¥¥² ­¥±ª®«¼ª® ¯®«¥©, ²® ­  ª ¦¤»©
½«¥¬¥­² ®²¢®¤¨²±¿ ­¥¯°¥°»¢­»© ³· ±²®ª ¯ ¬¿²¨, ¢ ª®²®°®¬ ¤°³£
§  ¤°³£®¬ ° §¬¥¹ ¾²±¿ §­ ·¥­¨¿ ¯®«¥©. ª § ²¥«¥¬ ­  ½«¥¬¥­²
®¡»·­® ±·¨² ¾²  ¤°¥± ¯¥°¢®© ¿·¥©ª¨ ½²®£® ³· ±²ª ;  ¤°¥±  ¯®«¥©
¯®«³· ¾²±¿ ±¤¢¨£®¬ ­  ®¯°¥¤¥«¥­­»¥ ª®­±² ­²».
°¨ °¥ «¨§ ¶¨¨ § ¯¨±¥© ­  ¡ §¥ ¬ ±±¨¢  ¬®¦­® ¢®±¯®«¼§®¢ ²¼±¿
²®© ¦¥ ±²° ²¥£¨¥©.  ±±¬®²°¨¬ ®¤¨­-¥¤¨­±²¢¥­­»© ¬ ±±¨¢ A.  ¦¤ ¿ § ¯¨±¼ ¡³¤¥² § ­¨¬ ²¼ ¢ ­¥¬ ­¥¯°¥°»¢­»© ³· ±²®ª A[j : :k].
ª § ²¥«¼ ­  § ¯¨±¼ | ½²® ¨­¤¥ª± j ; ª ¦¤®¬³ ¯®«¾ § ¯¨±¨ ±®®²¢¥²±²¢³¥² ·¨±«® ¨§ ¨­²¥°¢ «  [0 : :k ; j ] | ±¤¢¨£.  ¯°¨¬¥°, ¯°¨
¯°¥¤±² ¢«¥­¨¨ ¢±¥ ²®£® ¦¥ ±¯¨±ª , ·²® ¨ ­  °¨±. 11.3  ¨ 11.5, ¬®¦­®
°¥¸¨²¼, ·²® ¯®«¿¬ key, next ¨ prev ±®®²¢¥²±²¢³¾² ±¤¢¨£¨ 0, 1 ¨ 2.
®£¤  §­ ·¥­¨¥ prev[i], £¤¥ i | ³ª § ²¥«¼ (= ¨­¤¥ª± ¢ ¬ ±±¨¢¥ A),
¥±²¼ ­¥ ·²® ¨­®¥, ª ª A[i + 2] (±¬. °¨±. 11.6).
 ª®¥ ¯°¥¤±² ¢«¥­¨¥ ¯®§¢®«¿¥² µ° ­¨²¼ ¢ ®¤­®¬ ¬ ±±¨¢¥ § ¯¨±¨ ° §­»µ ²¨¯®¢ (®²¢®¤¿ ¯®¤ ­¨µ ³· ±²ª¨ ° §­®© ¤«¨­»), ­® ¤«¿
­ ¸¨µ ¶¥«¥© ¡³¤¥² ¤®±² ²®·­® ¯°¥¤±² ¢«¥­¨¿ ¢ ¢¨¤¥ ­¥±ª®«¼ª¨µ
¬ ±±¨¢®¢, ¯®±ª®«¼ª³ ¡®«¼¸¨­±²¢® ±²°³ª²³° ¤ ­­»µ, ± ª®²®°»¬¨
¬» ¡³¤¥¬ ¨¬¥²¼ ¤¥«®, ±®±²®¿² ¨§ ®¤­®²¨¯­»µ § ¯¨±¥©.
»¤¥«¥­¨¥ ¨ ®±¢®¡®¦¤¥­¨¥ ¯ ¬¿²¨
°¨ ¤®¡ ¢«¥­¨¨ ­®¢®£® ½«¥¬¥­²  ¢ ±¯¨±®ª ­ ¤® ®²¢¥±²¨ ¯®¤ ­¥£®
¬¥±²® ¢ ¯ ¬¿²¨. ² «® ¡»²¼, ­¥®¡µ®¤¨¬® ¢¥±²¨ ³·¥² ¨±¯®«¼§®¢ ­¨¿
 ¤°¥±®¢.  ­¥ª®²®°»µ ±¨±²¥¬ µ ½²¨¬ ¢¥¤ ¥² ±¯¥¶¨ «¼­ ¿ ¯®¤¯°®£° ¬¬  | ±¡®°¹¨ª ¬³±®°  (garbage collector), ª®²®° ¿ ®¯°¥¤¥«¿¥²,
ª ª¨¥ ³· ±²ª¨ ¯ ¬¿²¨ ¡®«¥¥ ­¥ ¨±¯®«¼§³¾²±¿, ¨ ¢®§¢° ¹ ¥² ¨µ ¤«¿
¯®¢²®°­®£® ¨±¯®«¼§®¢ ­¨¿. ® ¬­®£¨µ ±«³· ¿µ, ®¤­ ª®, ¬®¦­® ¢®§«®¦¨²¼ ®¡¿§ ­­®±²¨ ¯® ¢»¤¥«¥­¨¾ ¨ ®±¢®¡®¦¤¥­¨¾ ¯ ¬¿²¨ ­  ± ¬³
±²°³ª²³°³ ¤ ­­»µ.  ½²®¬ ° §¤¥«¥ ¬» ¯®ª ¦¥¬, ª ª ½²® ¤¥« ¥²±¿; ¢ ª ·¥±²¢¥ ¯°¨¬¥°  ° ±±¬®²°¨¬ ¤¢³±²®°®­­¥ ±¢¿§ ­­»© ±¯¨±®ª,
¯°¥¤±² ¢«¥­­»© ± ¯®¬®¹¼¾ ­¥±ª®«¼ª¨µ ¬ ±±¨¢®¢.
³±²¼ ¬ ±±¨¢», ± ¯®¬®¹¼¾ ª®²®°»µ ¬» ¯°¥¤±² ¢«¿¥¬ ­ ¸ ±¯¨-

214

« ¢  11 «¥¬¥­² °­»¥ ±²°³ª²³°» ¤ ­­»µ

 ¡®²  ¯°®¶¥¤³° Allocate-Object ¨ Free-Object. ( ) ®² ¦¥ ±¯¨±®ª, ·²® ­  °¨±. 11.5 (±¢¥²«®-±¥°»©) ¨ ±¯¨±®ª ±¢®¡®¤­»µ ¯®§¨¶¨© (²¥¬­®-±¥°»©).
²°³ª²³°  ±¯¨±ª  ±¢®¡®¤­»µ ¯®§¨¶¨© ¨§®¡° ¦¥­  ± ¯®¬®¹¼¾ ±²°¥«®ª. (¡) ®²
·²® ¯®«³·¨²±¿ ¯®±«¥ ¢»§®¢  Allocate-Object() (¢®§¢° ¹ ¥² §­ ·¥­¨¥ 4), ¯°¨±¢ ¨¢ ­¨¿ key[4] 25 ¨ ¢»§®¢  List-Insert(L; 4). ®¢»© ±¯¨±®ª ±¢®¡®¤­»µ
¯®§¨¶¨© ­ ·¨­ ¥²±¿ ± 8 (² ª®¢® ¡»«® §­ ·¥­¨¥ next[4]). (¢) ¥¯¥°¼ ¬» ¢»§¢ «¨ List-Delete(L; 5),   § ²¥¬ Free-Object(5). ®§¨¶¨¿ 5 | £®«®¢  ­®¢®£®
±¯¨±ª  ±¢®¡®¤­»µ ¯®§¨¶¨©, §  ­¥© ±«¥¤³¥² 8.
¨±. 11.7

±®ª, ¨¬¥¾² ¤«¨­³ m, ¨ ¯³±²¼ ¢ ¤ ­­»© ¬®¬¥­² ¢ ±¯¨±ª¥ ±®¤¥°¦¨²±¿
n 6 m ½«¥¬¥­²®¢. ±² «¼­»¥ n ; m ¬¥±² (¯®§¨¶¨©) ¢ ¬ ±±¨¢¥ ±¢®¡®¤­» (free).
» ¡³¤¥¬ µ° ­¨²¼ ±¢®¡®¤­»¥ ¯®§¨¶¨¨ ¢ ®¤­®±²®°®­­¥ ±¢¿§ ­­®¬
±¯¨±ª¥, ­ §»¢ ¥¬®¬ ±¯¨±ª®¬ ±¢®¡®¤­»µ ¯®§¨¶¨© (free list). ²®²
±¯¨±®ª ¨±¯®«¼§³¥² ²®«¼ª® ¬ ±±¨¢ next: ¨¬¥­­®, next[i] ±®¤¥°¦¨² ¨­¤¥ª± ±¢®¡®¤­®© ¯®§¨¶¨¨, ±«¥¤³¾¹¥© §  ±¢®¡®¤­®© ¯®§¨¶¨¥© i. ®«®¢  ±¯¨±ª  µ° ­¨²±¿ ¢ ¯¥°¥¬¥­­®© free. ¯¨±®ª ±¢®¡®¤­»µ ¯®§¨¶¨©
µ° ­¨²±¿ ¢¯¥°¥¬¥¦ª³ ±® ±¯¨±ª®¬ L (°¨±. 11.7). ¡° ²¨²¥ ¢­¨¬ ­¨¥, ·²® ª ¦¤®¬³ ·¨±«³ ¨§ ®²°¥§ª  [1; m] ®²¢¥· ¥² ½«¥¬¥­² «¨¡®
±¯¨±ª  L, «¨¡® ±¯¨±ª  ±¢®¡®¤­»µ ¬¥±².
¯¨±®ª ±¢®¡®¤­»µ ¯®§¨¶¨© ¢¥¤¥² ±¥¡¿ ª ª ±²¥ª: ¨§ ¢±¥µ ±¢®¡®¤­»µ ³· ±²ª®¢ ¯ ¬¿²¨ ¯®¤ ­®¢³¾ § ¯¨±¼ ¢»¤¥«¿¥²±¿ ²®², ª®²®°»©
¡»« ®±¢®¡®¦¤¥­ ¯®±«¥¤­¨¬. ®½²®¬³ ¤«¿ ¢»¤¥«¥­¨¿ ¨ ®±¢®¡®¦¤¥­¨¿ ¯ ¬¿²¨ ¬®¦­® ¢®±¯®«¼§®¢ ²¼±¿ °¥ «¨§ ¶¨¥© ±²¥ª®¢»µ ®¯¥° ¶¨© Push ¨ Pop ­  ¡ §¥ ±¯¨±ª .  ¯°¨¢®¤¨¬»µ ­¨¦¥ ¯°®¶¥¤³° µ Allocate-Object (¢»¤¥«¨²¼ ¬¥±²®) ¨ Free-Object (®±¢®¡®¤¨²¼ ¬¥±²®) ¯®¤° §³¬¥¢ ¥²±¿, ·²® ¢ £«®¡ «¼­®© ¯¥°¥¬¥­­®© free
§ ¯¨± ­ ¨­¤¥ª± ¯¥°¢®© (¢ ±¯¨±ª¥) ±¢®¡®¤­®© ¯®§¨¶¨¨.

¥ «¨§ ¶¨¿ ³ª § ²¥«¥© ¨ § ¯¨±¥© ± ­¥±ª®«¼ª¨¬¨ ¯®«¿¬¨

215

¯¨±ª¨ L1 (±¢¥²«®-±¥°»©) ¨ L2 (²¥¬­®-±¥°»©),   ² ª¦¥ ±¯¨±®ª ±¢®¡®¤­»µ ¬¥±² (·¥°­»©) µ° ­¿²±¿ ¢ ®¤­®© ²°®©ª¥ ¬ ±±¨¢®¢.
¨±. 11.8

Allocate-Object ()
1 if free = nil

2
3
4
5

then error À¢®¡®¤­®£® ¬¥±²  ­¥²Á
else x free
free next[x]
return x

Free-Object (x)

1 next[x] free
2 free x
¥°¢®­ · «¼­® ±¯¨±®ª ±¢®¡®¤­»µ ¯®§¨¶¨© ±®¤¥°¦¨² n ½«¥¬¥­²®¢. ±«¨ ±¢®¡®¤­®£® ¬¥±²  ­¥ ®±² «®±¼, ¯°®¶¥¤³°  AllocateObject ±®®¡¹ ¥² ®¡ ®¸¨¡ª¥.
 ±²® ®¤¨­ ±¯¨±®ª ±¢®¡®¤­»µ ¯®§¨¶¨© ®¡±«³¦¨¢ ¥² ±° §³ ­¥±ª®«¼ª® ¤¨­ ¬¨·¥±ª¨µ ¬­®¦¥±²¢ (°¨±. 11.8).
¯¨± ­­»¥ ¯°®¶¥¤³°» ¢»¤¥«¥­¨¿ ¨ ®±¢®¡®¦¤¥­¨¿ ¯ ¬¿²¨ ¯°®±²» ¨ ³¤®¡­» (° ¡®² ¾² §  ¢°¥¬¿ O(1)). µ ¬®¦­® ¯°¨±¯®±®¡¨²¼
¤«¿ µ° ­¥­¨¿ ®¤­®²¨¯­»µ § ¯¨±¥© «¾¡®£® ¢¨¤ , ®²¢¥¤¿ ®¤­® ¨§ ¯®«¥© § ¯¨±¨ ¯®¤ µ° ­¥­¨¥ ¨­¤¥ª±  next (¢ ±¢®¡®¤­»µ ¯®§¨¶¨¿µ).
¯° ¦­¥­¨¿
11.3-1 «¥¤³¿ ®¡° §¶³ °¨±. 11.5, ¨§®¡° §¨²¥ ¯°¥¤±² ¢«¥­¨¥ ¯®±«¥¤®¢ ²¥«¼­®±²¨ h13; 4; 8; 19; 5; 11i ¢ ¢¨¤¥ ¤¢³±²®°®­­¥ ±¢¿§ ­­®£® ±¯¨±ª , °¥ «¨§®¢ ­­®£® ± ¯®¬®¹¼¾ ²°¥µ ¬ ±±¨¢®¢; ¯® ®¡° §¶³
°¨±. 11.6 ¨§®¡° §¨²¥ ²®² ¦¥ ±¯¨±®ª, °¥ «¨§®¢ ­­»© ± ¯®¬®¹¼¾ ®¤­®£® ¬ ±±¨¢ .
11.3-2  ¯¨¸¨²¥ ¯°®¶¥¤³°» Allocate-Object ¨ Free-Object
¤«¿ ±«³· ¿ ®¤­®²¨¯­»µ § ¯¨±¥©, µ° ­¿¹¨µ±¿ ¢ ®¤­®¬ ¬ ±±¨¢¥.
11.3-3 ®·¥¬³ ¢ ¯°®¶¥¤³° µ Allocate-Object ¨ Free-Object
­¨ª ª ­¥ ´¨£³°¨°³¥² ¯®«¥ prev?
11.3-4  ±²® (­ ¯°¨¬¥°, ¯°¨ ±²° ­¨·­®© ®°£ ­¨§ ¶¨¨ ¢¨°²³ «¼­®© ¯ ¬¿²¨) ¡»¢ ¥² ¯®«¥§­® µ° ­¨²¼ ½«¥¬¥­²» ±¯¨±ª  ¢ ­¥¯°¥°»¢-

216

« ¢  11 «¥¬¥­² °­»¥ ±²°³ª²³°» ¤ ­­»µ

­®¬ ³· ±²ª¥ ¯ ¬¿²¨.  ±±¬®²°¨¬ °¥ «¨§ ¶¨¾ ±¯¨±ª  ± ¯®¬®¹¼¾
­¥±ª®«¼ª¨µ ¬ ±±¨¢®¢. ¥°¥¯¨¸¨²¥ ¯°®¶¥¤³°» Allocate-Object
¨ Free-Object ² ª¨¬ ®¡° §®¬, ·²®¡» ½«¥¬¥­²» ±¯¨±ª  § ­¨¬ «¨
¯®§¨¶¨¨ 1 : :m, £¤¥ m | ·¨±«® ½«¥¬¥­²®¢ ±¯¨±ª . (ª § ­¨¥: ¢®±¯®«¼§³©²¥±¼ °¥ «¨§ ¶¨¥© ±²¥ª  ­  ¡ §¥ ¬ ±±¨¢ .)
11.3-5 ³±²¼ ¤¢³±²®°®­­¥ ±¢¿§ ­­»© ±¯¨±®ª L ¤«¨­» m ¯°¥¤±² ¢«¥­ ± ¯®¬®¹¼¾ ²°¥µ ¬ ±±¨¢®¢ key, prev ¨ next ¤«¨­» n,   ¯°®¶¥¤³°» ¢»¤¥«¥­¨¿ ¨ ®±¢®¡®¦¤¥­¨¿ ¬¥±²  ¯®¤¤¥°¦¨¢ ¾² ¤¢³±²®°®­­¥
±¢¿§ ­­»© ±¯¨±®ª ±¢®¡®¤­»µ ¯®§¨¶¨©.
 ¯¨¸¨²¥ ¯°®¶¥¤³°³ Compactify-List (±¦ ²¨¥ ±¯¨±ª ), ª®²®° ¿ ¯¥°¥¯¨±»¢ ¥² ±¯¨±®ª L ¤«¨­» m ¢ ¯¥°¢»¥ m ¯®§¨¶¨© ¬ ±±¨¢®¢, ±®µ° ­¿¿ ¥£® ±²°³ª²³°³ (¨ ¨§¬¥­¿¿ ±¯¨±®ª ±¢®¡®¤­»µ ¯®§¨¶¨©
­³¦­»¬ ®¡° §®¬). °¥¬¿ ° ¡®²»  «£®°¨²¬  ¤®«¦­® ¡»²¼ (m),
° §¬¥° ¨±¯®«¼§³¥¬®© ¯ ¬¿²¨ (±¢¥°µ § ­¿²®© ¬ ±±¨¢ ¬¨) ¤®«¦¥­
¡»²¼ O(1). ¥ § ¡³¤¼²¥ ¤®ª § ²¼ ¯° ¢¨«¼­®±²¼ ±¢®¥£®  «£®°¨²¬ .

11.4. °¥¤±² ¢«¥­¨¥ ª®°­¥¢»µ ¤¥°¥¢¼¥¢
¯¨± ­­»¥ ¢ ¯°¥¤»¤³¹¥¬ ° §¤¥«¥ ±¯®±®¡» ¯°¥¤±² ¢«¥­¨¿ ±¯¨±ª®¢ ¯°¨¬¥­¨¬» ¨ ª ¤°³£¨¬ ±²°³ª²³° ¬ ¤ ­­»µ, ±®±² ¢«¥­­»¬ ¨§
®¤­®²¨¯­»µ ½«¥¬¥­²®¢.  ½²®¬ ° §¤¥«¥ ¬» ­ ³·¨¬±¿ ¨±¯®«¼§®¢ ²¼
³ª § ²¥«¨ ¤«¿ ¯°¥¤±² ¢«¥­¨¿ ¤¥°¥¢¼¥¢.  ·­¥¬ ¬» ± ¤¢®¨·­»µ ¤¥°¥¢¼¥¢,   § ²¥¬ ®¡º¿±­¨¬, ª ª ¯°¥¤±² ¢«¿²¼ ¤¥°¥¢¼¿ ± ¯°®¨§¢®«¼­»¬ ¢¥²¢«¥­¨¥¬.
 ¦¤ ¿ ¢¥°¸¨­  ¤¥°¥¢  ¡³¤¥² § ¯¨±¼¾ ± ­¥±ª®«¼ª¨¬¨ ¯®«¿¬¨.
¤­® ¨§ ½²¨µ ¯®«¥© ±®¤¥°¦¨² ª«¾·, ª ª ¨ ¢ ±«³· ¥ ±® ±¯¨±ª ¬¨. ±² «¼­»¥ ¯®«¿ ¯°¥¤­ §­ ·¥­» ¤«¿ µ° ­¥­¨¿ ¤®¯®«­¨²¥«¼­»µ
¤ ­­»µ ¨, £« ¢­®¥, ³ª § ²¥«¥© ­  ¤°³£¨¥ ¢¥°¸¨­».  ª ª®­ª°¥²­®
³±²°®¥­» ½²¨ ¯®«¿, § ¢¨±¨² ®² ²¨¯  ¤¥°¥¢ .
¢®¨·­»¥ ¤¥°¥¢¼¿
 ª ¯®ª § ­® ­  °¨±. 11.9, ¯°¨ ¯°¥¤±² ¢«¥­¨¨ ¤¢®¨·­®£® ¤¥°¥¢  T ¬» ¨±¯®«¼§³¥¬ ¯®«¿ p, left ¨ right, ¢ ª®²®°»µ µ° ­¿²±¿ ³ª § ²¥«¨ ­  °®¤¨²¥«¿, «¥¢®£® ¨ ¯° ¢®£® °¥¡¥­ª  ¢¥°¸¨­» x ±®®²¢¥²±²¢¥­­®. ±«¨ p[x] = nil, ²® x | ª®°¥­¼; ¥±«¨ ³ x ­¥² «¥¢®£® ¨«¨
¯° ¢®£® °¥¡¥­ª , ²® left[x] ¨«¨ right[x] ¥±²¼ nil.  ¤¥°¥¢®¬ T ±¢¿§ ­
 ²°¨¡³² root[T ] | ³ª § ²¥«¼ ­  ¥£® ª®°¥­¼. ±«¨ root[T ] = nil, ²®
¤¥°¥¢® T ¯³±²®.

°¥¤±² ¢«¥­¨¥ ª®°­¥¢»µ ¤¥°¥¢¼¥¢

217

°¥¤±² ¢«¥­¨¥ ¤¢®¨·­®£® ¤¥°¥¢  T .  ¦¤ ¿ ¢¥°¸¨­  x ¢ª«¾· ¥²
¯®«¿ p[x] (±¢¥°µ³), left[x] (¢­¨§³ ±«¥¢ ) ¨ right[x] (¢­¨§³ ±¯° ¢ ). «¾·¨ ­  ±µ¥¬¥
­¥ ¯®ª § ­».
¨±. 11.9

®°­¥¢»¥ ¤¥°¥¢¼¿ ± ¯°®¨§¢®«¼­»¬ ¢¥²¢«¥­¨¥¬
±«¨ ¨§¢¥±²­®, ·²® ·¨±«® ¤¥²¥© ª ¦¤®© ¢¥°¸¨­» ®£° ­¨·¥­®
±¢¥°µ³ ª®­±² ­²®© k, ²® ² ª®¥ ¤¥°¥¢® ¬®¦­® °¥ «¨§®¢ ²¼  ­ «®£¨·­® ¤¢®¨·­®¬³ ¤¥°¥¢³, ¯®¬¥¹ ¿ ³ª § ²¥«¨ ­  ¤¥²¥© ¢ ¯®«¿
child1 ; child2; : : :; childk , § ¬¥­¿¾¹¨¥ ¯®«¿ left ¨ right. ±«¨ ª®«¨·¥±²¢® ¤¥²¥© ¬®¦¥² ¡»²¼ «¾¡»¬, ² ª ¤¥« ²¼ ­¥«¼§¿: § ° ­¥¥ ­¥¨§¢¥±²­®, ±ª®«¼ª® ¯®«¥© (¨«¨ ¬ ±±¨¢®¢ | ¯°¨ ¯°¥¤±² ¢«¥­¨¨ ± ¯®¬®¹¼¾ ­¥±ª®«¼ª¨µ ¬ ±±¨¢®¢) ­ ¤® ¢»¤¥«¨²¼.
°®¡«¥¬  ¬®¦¥² ¢®§­¨ª­³²¼ ¨ ¢ ²®¬ ±«³· ¥, ¥±«¨ ª®«¨·¥±²¢®
¤¥²¥© ®£° ­¨·¥­® § ° ­¥¥ ¨§¢¥±²­»¬ ·¨±«®¬ k, ­® ³ ¡®«¼¸¨­±²¢ 
¢¥°¸¨­ ·¨±«® ¤¥²¥© ¬­®£® ¬¥­¼¸¥ k: ®¯¨± ­­ ¿ °¥ «¨§ ¶¨¿ ²° ²¨²
¬­®£® ¯ ¬¿²¨ §°¿.
 ª ¦¥ ¡»²¼?  ¬¥²¨¬, ·²® «¾¡®¥ ¤¥°¥¢® ¬®¦­® ¯°¥®¡° §®¢ ²¼
¢ ¤¢®¨·­®¥. °¨ ½²®¬ ³ ª ¦¤®© ¢¥°¸¨­» ¡³¤¥² ­¥ ¡®«¥¥ ¤¢³µ ¤¥²¥©:
«¥¢»© °¥¡¥­®ª ®±² ­¥²±¿ ²¥¬ ¦¥, ­® ¯° ¢»¬ °¥¡¥­ª®¬ ±² ­¥² ¢¥°¸¨­ , ª®²®° ¿ ¡»«  ¯° ¢»¬ ±®±¥¤®¬ (­¥¯®±°¥¤±²¢¥­­® ±«¥¤³¾¹¨¬
°¥¡¥­ª®¬ ²®£® ¦¥ °®¤¨²¥«¿). ¥¯¥°¼ ½²® ¤¢®¨·­®¥ ¤¥°¥¢® ¬®¦­®
µ° ­¨²¼ ®¯¨± ­­»¬ ¢»¸¥ ±¯®±®¡®¬.
¯¨¸¥¬ ±µ¥¬³ µ° ­¥­¨¿ ¤¥°¥¢¼¥¢ ± ¯°®¨§¢®«¼­»¬ ¢¥²¢«¥­¨¥¬,
®±­®¢ ­­³¾ ­  ½²®© ¨¤¥¥, ¡®«¥¥ ¯®¤°®¡­®. ­  ­ §»¢ ¥²±¿ À«¥¢»©
°¥¡¥­®ª | ¯° ¢»© ±®±¥¤Á (left-child, right-sibling representation) ¨
¯®ª § ­  ­  °¨±. 11.10. ®-¯°¥¦­¥¬³ ¢ ª ¦¤®© ¢¥°¸¨­¥ µ° ­¨²±¿ ³ª § ²¥«¼ p ­  °®¤¨²¥«¿ ¨  ²°¨¡³² root[T ] ¿¢«¿¥²±¿ ³ª § ²¥«¥¬
­  ª®°¥­¼ ¤¥°¥¢ . °®¬¥ p, ¢ ª ¦¤®© ¢¥°¸¨­¥ µ° ­¿²±¿ ¥¹¥ ¤¢ 
³ª § ²¥«¿:
1. left-child[x] ³ª §»¢ ¥² ­  ± ¬®£® «¥¢®£® °¥¡¥­ª  ¢¥°¸¨­» x;

218

« ¢  11 «¥¬¥­² °­»¥ ±²°³ª²³°» ¤ ­­»µ

°¥¤±² ¢«¥­¨¥ ¤¥°¥¢  T ¯® ±µ¥¬¥ À«¥¢»© °¥¡¥­®ª | ¯° ¢»© ±®±¥¤Á.
 ª ¦¤®© § ¯¨±¨ x ¯°¨±³²±²¢³¾² ¯®«¿ p[x] (±¢¥°µ³), left-child[x] (¢­¨§³ ±«¥¢ )
¨ right-sibling[x] (¢­¨§³ ±¯° ¢ ). «¾·¨ ­¥ ¯®ª § ­».
¨±. 11.10

2. right-sibling[x] ³ª §»¢ ¥² ­  ¡«¨¦ ©¸¥£® ±¯° ¢  ±®±¥¤  ¢¥°¸¨­» x (À±«¥¤³¾¹¥£® ¯® ±² °¸¨­±²¢³ ¡° ² Á)
¥°¸¨­  x ­¥ ¨¬¥¥² ¤¥²¥© ²®£¤  ¨ ²®«¼ª® ²®£¤ , ª®£¤  left-child[x] = nil. ±«¨ ¢¥°¸¨­  x | ª° ©­¨© ¯° ¢»© °¥¡¥­®ª
±¢®¥£® °®¤¨²¥«¿, ²® right-sibling[x] = nil.
°³£¨¥ ±¯®±®¡» ¯°¥¤±² ¢«¥­¨¿ ¤¥°¥¢¼¥¢
­®£¤  ¢±²°¥· ¾²±¿ ¤°³£¨¥ ±¯®±®¡» ¯°¥¤±² ¢«¥­¨¿ ¤¥°¥¢¼¥¢.
 ¯°¨¬¥°, ¢ £« ¢¥ 7 ¯°¨ °¥ «¨§ ¶¨¨ ª³·¨ ­¥ ­ ¤® ¡»«® µ° ­¨²¼
³ª § ²¥«¥© ­  °®¤¨²¥«¿ ¨ ¤¥²¥©, ¯®±ª®«¼ª³ ¨µ ­®¬¥°  ¯®«³· «¨±¼
³¬­®¦¥­¨¥¬ ¨ ¤¥«¥­¨¥¬ ­  2.  £« ¢¥ 22 ­ ¬ ¢±²°¥²¿²±¿ ¤¥°¥¢¼¿,
¯® ª®²®°»¬ ¤¢¨£ ¾²±¿ ®² «¨±²¼¥¢ ª ª®°­¾ (¨ ¯®²®¬³ ³ª § ²¥«¨
­  ¤¥²¥© ¨«¨ ±®±¥¤¥© ­¥ ­³¦­»). ®­ª°¥²­»© ¢»¡®° ¯°¥¤±² ¢«¥­¨¿ ¤¥°¥¢  ®¯°¥¤¥«¿¥²±¿ ±¯¥¶¨´¨ª®© § ¤ ·¨.
¯° ¦­¥­¨¿
11.4-1  °¨±³©²¥ ¤¢®¨·­®¥ ¤¥°¥¢®, ¯°¥¤±² ¢«¥­­®¥ ±«¥¤³¾¹¨¬
®¡° §®¬:

 ¤ ·¨ ª £« ¢¥ 11

219

¨­¤¥ª± key left right
1
12 7
3
2
15 8 nil
3
4 10 nil
4
10 5
9
5
2 nil nil
6
18 1
4
7
7 nil nil
8
14 6
2
9
21 nil nil
10
5 nil nil
®°¥­¼ ¤¥°¥¢  | ¢ ¢¥°¸¨­¥ ± ¨­¤¥ª±®¬ 6.
11.4-2  ¯¨¸¨²¥ ° ¡®² ¾¹³¾ §  «¨­¥©­®¥ ¢°¥¬¿ °¥ª³°±¨¢­³¾
¯°®¶¥¤³°³, ª®²®° ¿ ¯¥· ² ¥² ª«¾·¨ ¢±¥µ ¢¥°¸¨­ ¤ ­­®£® ¤¢®¨·­®£® ¤¥°¥¢ .
11.4-3  ª ±¤¥« ²¼ ²® ¦¥ ± ¬®¥ (·²® ¨ ¢ ¯°¥¤»¤³¹¥¬ ³¯° ¦­¥­¨¨), ¨±¯®«¼§³¿ ­¥°¥ª³°±¨¢­³¾ ¯°®¶¥¤³°³? (°¨ ³±²° ­¥­¨¨ °¥ª³°±¨¨ ¯®«¥§¥­ ±²¥ª.)
11.4-4  ¯¨¸¨²¥ ° ¡®² ¾¹³¾ §  «¨­¥©­®¥ ¢°¥¬¿ ¯°®¶¥¤³°³, ¯¥· ² ¾¹³¾ ª«¾·¨ ¢±¥µ ¢¥°¸¨­ ¤¥°¥¢ , ¯°¥¤±² ¢«¥­­®£® ¯® ±µ¥¬¥
À«¥¢»© °¥¡¥­®ª | ¯° ¢»© ±®±¥¤Á.
11.4-5?  ¯¨¸¨²¥ ° ¡®² ¾¹³¾ §  «¨­¥©­®¥ ¢°¥¬¿ ­¥°¥ª³°±¨¢­³¾
¯°®¶¥¤³°³, ¯¥· ² ¾¹³¾ ª«¾·¨ ¢±¥µ ¢¥°¸¨­ ¤¢®¨·­®£® ¤¥°¥¢ , ¤«¿
ª®²®°®© ®¡º¥¬ ¨±¯®«¼§³¥¬®© ¯ ¬¿²¨ (±¢¥°µ ¯ ¬¿²¨, ¢ ª®²®°®© µ° ­¨²±¿ ¤¥°¥¢®) ¥±²¼ O(1), ¨ ¢® ¢°¥¬¿ ° ¡®²» ¯°®¶¥¤³°» ¤¥°¥¢® ­¥
¬¥­¿¥²±¿ (¤ ¦¥ ¢°¥¬¥­­®).
11.4-6? °¨¤³¬ ©²¥ ±¯®±®¡ µ° ­¥­¨¿ ¤¥°¥¢  ± ¯°®¨§¢®«¼­»¬ ¢¥²¢«¥­¨¥¬, ¯°¨ ª®²®°®¬ ¢ ª ¦¤®© ¢¥°¸¨­¥ µ° ­¿²±¿ ¢±¥£® ¤¢  (  ­¥
²°¨, ª ª ¢ ±µ¥¬¥ À«¥¢»© °¥¡¥­®ª | ¯° ¢»© ±®±¥¤Á) ³ª § ²¥«¿ ¯«¾±
®¤­  ¡³«¥¢  ¯¥°¥¬¥­­ ¿.

 ¤ ·¨
11-1 ° ¢­¥­¨¥ ° §­»µ ²¨¯®¢ ±¯¨±ª®¢
 ©¤¨²¥  ±¨¬¯²®²¨ª³ ¢°¥¬¥­¨ ° ¡®²» (¢ µ³¤¸¥¬ ±«³· ¥) ¤«¿ ª ¦¤®© ¨§ ¯¥°¥·¨±«¥­­»µ ¢ ­ · «¥ · ±²¨ III (±. 194) ®¯¥° ¶¨©, ¯°¨¬¥­¥­­®© ª ª ¦¤®¬³ ¨§ ³ª § ­­»µ ²¨¯®¢ ±¯¨±ª®¢.

220

« ¢  11 «¥¬¥­² °­»¥ ±²°³ª²³°» ¤ ­­»µ

Search(L; k)
Insert(L; x)
Delete(L; x)
Successor(L; x)
Predecessor (L; x)
Minimum(L)
Maximum(L)

­¥³¯®°¿¤®·¥­­»©,
³¯®°¿¤®·¥­­»©, ­¥³¯®°¿¤®·¥­­»©,³¯®°¿¤®·¥­
®¤­®±²®°®­­¥ ®¤­®±²®°®­­¥ ¤¢³±²®°®­­¥ ¤¢³±²®°®­­
±¢¿§ ­­»©
±¢¿§ ­­»©
±¢¿§ ­­»©
±¢¿§ ­­»©

11-2 ¥ «¨§ ¶¨¿ ±«¨¢ ¥¬»µ ª³· ­  ¡ §¥ ±¯¨±ª®¢
²°³ª²³°  ¤ ­­»µ ¯®¤ ­ §¢ ­¨¥¬ ±«¨¢ ¥¬»¥ ª³·¨ (mergeable
heaps) µ° ­¨² ­ ¡®° ¤¨­ ¬¨·¥±ª¨µ ¬­®¦¥±²¢ (ª³·), ¨ ¯®¤¤¥°¦¨¢ ¥² ±«¥¤³¾¹¨¥ ®¯¥° ¶¨¨: Make-Heap (±®§¤ ­¨¥ ¯³±²®© ª³·¨),
Insert, Minimum, Extract-Min ¨, ­ ª®­¥¶, Union (®¡º¥¤¨­¥­¨¥
¤¢³µ ª³· ¢ ®¤­³; ¤¢¥ ±² °»¥ ª³·¨ ¯°®¯ ¤ ¾²). «¿ ª ¦¤®£® ¨§
¯¥°¥·¨±«¥­­»µ ­¨¦¥ ±«³· ¥¢ °¥ «¨§³©²¥ (¯® ¢®§¬®¦­®±²¨ ½´´¥ª²¨¢­®) ±«¨¢ ¥¬»¥ ª³·¨ ­  ¡ §¥ ±¯¨±ª®¢. ¶¥­¨²¥ ¢°¥¬¿ ° ¡®²»
®¯¥° ¶¨© ·¥°¥§ ° §¬¥°» ³· ±²¢³¾¹¨µ ¬­®¦¥±²¢.
 . ¯¨±ª¨ ³¯®°¿¤®·¥­».
¡. ¯¨±ª¨ ­¥³¯®°¿¤®·¥­».
¢. ¯¨±ª¨ ­¥³¯®°¿¤®·¥­», ®¡º¥¤¨­¿¥¬»¥ ¬­®¦¥±²¢  ­¥ ¯¥°¥±¥ª ¾²±¿ ¤°³£ ± ¤°³£®¬.
11-3 ®¨±ª ¢ ®²±®°²¨°®¢ ­­®¬ ±¦ ²®¬ ±¯¨±ª¥
 ³¯° ¦­¥­¨¨ 11.3-4 ²°¥¡®¢ «®±¼ µ° ­¨²¼ ±¯¨±ª¨ Àª®¬¯ ª²­®Á:
n-½«¥¬¥­²­»© ±¯¨±®ª ¤®«¦¥­ ¡»« § ­¨¬ ²¼ ¯¥°¢»¥ n ¯®§¨¶¨© ¬ ±±¨¢ . °¥¤¯®«®¦¨¬ ¥¹¥, ·²® ¢±¥ ª«¾·¨ ° §«¨·­» ¨ ·²® ±¯¨±®ª ³¯®°¿¤®·¥­ (¨­»¬¨ ±«®¢ ¬¨, key[i] < key[next[i]] ¯°¨ next[i] 6= nil).
ª §»¢ ¥²±¿, ·²® ¢ ½²¨µ ¯°¥¤¯®«®¦¥­¨¿µ ±«¥¤³¾¹¨© ¢¥°®¿²­®±²­»©  «£®°¨²¬ ¢»¯®«­¿¥² ¯®¨±ª ¢ ±¯¨±ª¥ §  ¢°¥¬¿ o(n):
Compact-List-Search(L; k)
1 i head[L]
2 n length[L]
3 while i 6= nil and key[i] 6 k
4
do j Random(1; n)
5
if key[i] < key[j ] and key[j ] < k
6
then i j
7
i next[i]
8
if key[i] = k
9
then return i
10 return nil

 ¬¥· ­¨¿ ª £« ¢¥ 11

221

¥§ ±²°®ª 4{6 ½²® ¡»« ¡» ®¡»·­»©  «£®°¨²¬ ± ¯®±«¥¤®¢ ²¥«¼­»¬
¯¥°¥¡®°®¬ ½«¥¬¥­²®¢ ±¯¨±ª .  ±²°®ª µ 4{6 ¬» ¯»² ¥¬±¿ ¯¥°¥±ª®·¨²¼ ­  ±«³· ©­® ¢»¡° ­­³¾ ¯®§¨¶¨¾ j . ±«¨ key[i] < key[j ] < k,
²® ¯°¨ ½²®¬ ¬» ½ª®­®¬¨¬ ¢°¥¬¿, ² ª ª ª ­¥ ¯°®¢¥°¿¥¬ ½«¥¬¥­²»,
«¥¦ ¹¨¥ ¢ ¯®§¨¶¨¿µ ¬¥¦¤³ i ¨ j . (« £®¤ °¿ ²®¬³, ·²® ±¯¨±®ª § ­¨¬ ¥² ­¥¯°¥°»¢­»© ³· ±²®ª ¬ ±±¨¢ , ¬» ¬®¦¥¬ ¢»¡° ²¼ ¢ ­¥¬
±«³· ©­»© ½«¥¬¥­².)
 .  ·¥¬ ­³¦­® ¯°¥¤¯®« £ ²¼, ·²® ¢±¥ ª«¾·¨ ° §«¨·­»? ®ª ¦¨²¥, ·²® ¤«¿ ­¥³¡»¢ ¾¹¥£® ±¯¨±ª  ± (¢®§¬®¦­®) ±®¢¯ ¤ ¾¹¨¬¨ ª«¾· ¬¨ ±«³· ©­»¥ ±ª ·ª¨ ¬®£³² ­¥ ³«³·¸¨²¼  ±¨¬¯²®²¨ª³
¢°¥¬¥­¨ ¯®¨±ª .
 ª ®¶¥­¨²¼ ¢°¥¬¿ ° ¡®²»? °¥¤±² ¢¨¬ ±¥¡¥, ·²® ­  ­¥±ª®«¼ª¨µ ¯¥°¢»µ ¸ £ µ ¬» ¢»¯®«­¿¥¬ ²®«¼ª® ±«³· ©­»¥ ±ª ·ª¨,   ­ 
®±² «¼­»µ ¢»¯®«­¿¥¬ «¨­¥©­»© ¯®¨±ª. ®¦­® ®¶¥­¨²¼ ®¦¨¤ ¥¬®¥
° ±±²®¿­¨¥ ¤® ¨±ª®¬®£® ½«¥¬¥­²  ¯®±«¥ ¯¥°¢®© ´ §» | ¨ ²¥¬ ± ¬»¬ ¤«¨²¥«¼­®±²¼ ¢²®°®© ´ §».  ¸  «£®°¨²¬ ¡³¤¥² ° ¡®² ²¼
­¥ µ³¦¥ ² ª®£® ³±¥·¥­­®£®, ¨ ®±² ¥²±¿ ²®«¼ª® ¯° ¢¨«¼­® ¢»¡° ²¼
¤«¨²¥«¼­®±²¼ ¯¥°¢®© ´ §», ·²®¡» ¯®«³·¨²¼ ®¶¥­ª³ ¯®«³·¸¥.
¤¥« ¥¬ ½²®  ªª³° ²­®. «¿ ª ¦¤®£® t > 0 ®¡®§­ ·¨¬ ·¥°¥§
Xt ±«³· ©­³¾ ¢¥«¨·¨­³, ° ¢­³¾ ° ±±²®¿­¨¾ (¨§¬¥°¥­­®¬³ ¢¤®«¼
±¯¨±ª ) ®² ¯®§¨¶¨¨ i ¤® ¨±ª®¬®£® ª«¾·  k ¯®±«¥ t ±«³· ©­»µ ±ª ·ª®¢.
¡. ®ª ¦¨²¥, ·²® ¤«¿ ª ¦¤®£® t > 0 ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥
¢°¥¬¥­¨ ° ¡®²»  «£®°¨²¬  Compact-List-Search ¥±²¼ O(t +
E [Xt]).
P
¢. ®ª ¦¨²¥, ·²® E (Xt) 6 nr=1 (1 ; r=n)t . (ª § ­¨¥: ¢®±¯®«¼§³©²¥±¼ ´®°¬³«®© (6.28)).
P ;1
£. ®ª ¦¨²¥, ·²® nr=0
ª5¥ 6 nt+1 =(t + 1).
¤. ®ª ¦¨²¥, ·²® E (Xt) 6 n=(t + 1), ¨ ®¡º¿±­¨²¥ À­  ¯ «¼¶ µÁ,
¯®·¥¬³ ½²® ­¥° ¢¥­±²¢® ¤®«¦­® ¡»²¼ ¢¥°­®.
e. ®ª ¦¨²¥, ·²® ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥
¢°¥¬¥­¨ ° ¡®²»  «p
£®°¨²¬  Compact-List-Search ¥±²¼ O( n).

 ¬¥· ­¨¿
°¥ª° ±­»¥ ±¯° ¢®·­¨ª¨ ¯® ±²°³ª²³° ¬ ¤ ­­»µ | ª­¨£¨ µ®,
®¯ª°®´²  ¨ «¼¬ ­  [5] ¨ ­³²  [121]. ¥§³«¼² ²» ½ª±¯¥°¨¬¥­²®¢
¯® ±° ¢­¥­¨¾ ½´´¥ª²¨¢­®±²¨ ° §«¨·­»µ ®¯¥° ¶¨© ­  ±²°³ª²³° µ
¤ ­­»µ ¬®¦­® ­ ©²¨ ¢ ®­­¥² [90]
²¥ª¨ ¨ ®·¥°¥¤¨ ¨±¯®«¼§®¢ «¨±¼ ¢ ¬ ²¥¬ ²¨ª¥ ¨ ¤¥«®¯°®¨§¢®¤±²¢¥ ¢ ¤®ª®¬¯¼¾²¥°­³¾ ½°³. ­³² [121] ®²¬¥· ¥², ·²® ¢ 1947 £®¤³
¼¾°¨­£ (A. M. Turing) ¨±¯®«¼§®¢ « ±²¥ª¨ ¤«¿ ±¢¿§¨ ¯®¤¯°®£° ¬¬.

222

« ¢  11 «¥¬¥­² °­»¥ ±²°³ª²³°» ¤ ­­»µ

²°³ª²³°» ¤ ­­»µ, ®±­®¢ ­­»¥ ­  ³ª § ²¥«¿µ, ² ª¦¥, ¢¨¤¨¬®,
®²­®±¿²±¿ ª À´®«¼ª«®°³Á. ®£« ±­® ­³²³, ³ª § ²¥«¨ ¨±¯®«¼§®¢ «¨±¼ ¥¹¥ ¢ ¯¥°¢»µ ª®¬¯¼¾²¥° µ ± ¬ £­¨²­»¬¨ ¡ ° ¡ ­ ¬¨.  1951
£®¤³ ®¯¯¥° (G. M. Hopper) ° §° ¡®² « ¿§»ª A-1, ¢ ª®²®°®¬  «£¥¡° ¨·¥±ª¨¥ ´®°¬³«» ¯°¥¤±² ¢«¿«¨±¼ ¢ ¢¨¤¥ ¤¢®¨·­»µ ¤¥°¥¢¼¥¢.
®² ¦¥ ­³² ³ª §»¢ ¥², ·²® ±¨±²¥¬ ²¨·¥±ª®¥ ¨±¯®«¼§®¢ ­¨¥ ³ª § ²¥«¥© ­ · «®±¼ ± ¿§»ª  IPL-II, ª®²®°»© ° §° ¡®² «¨ ¢ 1956 £®¤³
¼¾½««, ®³ ¨  ©¬®­ (A. Newell, J. C. Shaw, H. A. Simon).  ° §° ¡®² ­­®¬ ²¥¬¨ ¦¥  ¢²®° ¬¨ ¢ 1957 £®¤³ ¿§»ª¥ IPL-III ¯®¿¢¨«¨±¼
¢ ¿¢­®¬ ¢¨¤¥ ®¯¥° ¶¨¨ ±® ±²¥ª ¬¨.

12

¥¸-² ¡«¨¶»

 ±²® ¡»¢ ¾² ­³¦­» ¤¨­ ¬¨·¥±ª¨¥ ¬­®¦¥±²¢ , ¯®¤¤¥°¦¨¢ ¾¹¨¥
²®«¼ª® À±«®¢ °­»¥ ®¯¥° ¶¨¨Á ¤®¡ ¢«¥­¨¿, ¯®¨±ª  ¨ ³¤ «¥­¨¿ ½«¥¬¥­² .  ½²®¬ ±«³· ¥ · ±²® ¯°¨¬¥­¿¾² ² ª ­ §»¢ ¥¬®¥ µ¥¸¨°®¢ ­¨¥; ±®®²¢¥²±²¢³¾¹ ¿ ±²°³ª²³°  ¤ ­­»µ ­ §»¢ ¥²±¿ Àµ¥¸² ¡«¨¶ Á (¨«¨ À² ¡«¨¶  ° ±±² ­®¢ª¨Á).  µ³¤¸¥¬ ±«³· ¥ ¯®¨±ª ¢
µ¥¸-² ¡«¨¶¥ ¬®¦¥² § ­¨¬ ²¼ ±²®«¼ª® ¦¥ ¢°¥¬¥­¨, ±ª®«¼ª® ¯®¨±ª
¢ ±¯¨±ª¥ ((n)), ­® ­  ¯° ª²¨ª¥ µ¥¸¨°®¢ ­¨¥ ¢¥±¼¬  ½´´¥ª²¨¢­®.
°¨ ¢»¯®«­¥­¨¨ ­¥ª®²®°»µ ¥±²¥±²¢¥­­»µ ³±«®¢¨© ¬ ²¥¬ ²¨·¥±ª®¥
®¦¨¤ ­¨¥ ¢°¥¬¥­¨ ¯®¨±ª  ½«¥¬¥­²  ¢ µ¥¸-² ¡«¨¶¥ ¥±²¼ O(1).
¥¸-² ¡«¨¶³ ¬®¦­® ° ±±¬ ²°¨¢ ²¼ ª ª ®¡®¡¹¥­¨¥ ®¡»·­®£®
¬ ±±¨¢ . ±«¨ ³ ­ ± ¤®±² ²®·­® ¯ ¬¿²¨ ¤«¿ ¬ ±±¨¢ , ·¨±«® ½«¥¬¥­²®¢ ª®²®°®£® ° ¢­® ·¨±«³ ¢±¥µ ¢®§¬®¦­»µ ª«¾·¥©, ¤«¿ ª ¦¤®£®
¢®§¬®¦­®£® ª«¾·  ¬®¦­® ®²¢¥±²¨ ¿·¥©ª³ ¢ ½²®¬ ¬ ±±¨¢¥ ¨ ²¥¬ ± ¬»¬ ¨¬¥²¼ ¢®§¬®¦­®±²¼ ¤®¡° ²¼±¿ ¤® «¾¡®© § ¯¨±¨ §  ¢°¥¬¿ O(1)
(À¯°¿¬ ¿  ¤°¥± ¶¨¿Á, ±¬. ° §¤. 12.1). ¤­ ª® ¥±«¨ °¥ «¼­®¥ ª®«¨·¥±²¢® § ¯¨±¥© §­ ·¨²¥«¼­® ¬¥­¼¸¥, ·¥¬ ª®«¨·¥±²¢® ¢®§¬®¦­»µ
ª«¾·¥©, ²® ½´´¥ª²¨¢­¥¥ ¯°¨¬¥­¨²¼ µ¥¸¨°®¢ ­¨¥: ¢»·¨±«¿²¼ ¯®§¨¶¨¾ § ¯¨±¨ ¢ ¬ ±±¨¢¥, ¨±µ®¤¿ ¨§ ª«¾· .  ° §¤¥«¥ 12.2 ®¡±³¦¤ ¾²±¿ ®±­®¢­»¥ ¨¤¥¨,   ¢ ° §¤¥«¥ 12.3 | ª®­ª°¥²­»¥ ±¯®±®¡» ² ª®£® ¢»·¨±«¥­¨¿.  ½²®© £« ¢¥ ¯°¥¤±² ¢«¥­® ­¥±ª®«¼ª® ¢ °¨ ­²®¢
µ¥¸¨°®¢ ­¨¿.
» ³¢¨¤¨¬, ·²® µ¥¸¨°®¢ ­¨¥ | ½´´¥ª²¨¢­»© ¨ ³¤®¡­»© ±¯®±®¡
¢»¯®«­¿²¼ ®±­®¢­»¥ ±«®¢ °­»¥ ®¯¥° ¶¨¨ (±°¥¤­¥¥ ¢°¥¬¿ O(1) ¯°¨
­¥ª®²®°»µ ¯°¥¤¯®«®¦¥­¨¿µ).

12.1. °¿¬ ¿  ¤°¥± ¶¨¿
°¿¬ ¿  ¤°¥± ¶¨¿ ¯°¨¬¥­¨¬ , ¥±«¨ ª®«¨·¥±²¢® ¢®§¬®¦­»µ
ª«¾·¥© ­¥¢¥«¨ª®. ³±²¼ ¢®§¬®¦­»¬¨ ª«¾· ¬¨ ¿¢«¿¾²±¿ ·¨±« 
¨§ ¬­®¦¥±²¢  U = f0; 1; : : :; m ; 1g (·¨±«® m ­¥ ®·¥­¼ ¢¥«¨ª®).
°¥¤¯®«®¦¨¬ ² ª¦¥, ·²® ª«¾·¨ ¢±¥µ ½«¥¬¥­²®¢ ° §«¨·­».
«¿ µ° ­¥­¨¿ ¬­®¦¥±²¢  ¬» ¯®«¼§³¥¬±¿ ¬ ±±¨¢®¬ T [0 : :m ; 1],
­ §»¢ ¥¬»¬ ² ¡«¨¶¥© ± ¯°¿¬®©  ¤°¥± ¶¨¥© (direct-address table).

224

« ¢  12 ¥¸-² ¡«¨¶»

¥°¥¢®¤» ­ ¤¯¨±¥© ­  ± ¬®© ª °²¨­ª¥: universe of keys | ¢±¥¢®§¬®¦­»¥ ª«¾·¨, actual keys | ¨±¯®«¼§³¥¬»¥ ª«¾·¨, key | ª«¾·,
satellite data | ¤®¯®«­¨²¥«¼­»¥ ¤ ­­»¥.

¥ «¨§ ¶¨¿ ¤¨­ ¬¨·¥±ª®£® ¬­®¦¥±²¢  ± ¯®¬®¹¼¾ ² ¡«¨¶» T ± ¯°¿¬®©  ¤°¥± ¶¨¥©. ­®¦¥±²¢® ¢®§¬®¦­»µ ª«¾·¥© ¥±²¼ U = f0; 1; : : : ; 9g.  ¦¤®¬³ ¨§ ½²¨µ ª«¾·¥© ±®®²¢¥²±²¢³¥² ±¢®¥ ¬¥±²® ¢ ² ¡«¨¶¥.  ¯®§¨¶¨¿µ ² ¡«¨¶»
± ­®¬¥° ¬¨ 2, 3, 5 ¨ 8 (´ ª²¨·¥±ª¨ ¨±¯®«¼§³¥¬»¥ ª«¾·¨) § ¯¨± ­» ³ª § ²¥«¨
­  ½«¥¬¥­²» ¬­®¦¥±²¢ ,   ¢ ­¥¨±¯®«¼§³¥¬»µ ¯®§¨¶¨¿µ ² ¡«¨¶» (²¥¬­®-±¥°»¥)
§ ¯¨± ­ nil.
¨±. 12.1

 ¦¤ ¿ ¯®§¨¶¨¿, ¨«¨ ¿·¥©ª , (¯®- ­£«¨©±ª¨ slot ¨«¨ position) ±®®²¢¥²±²¢³¥² ®¯°¥¤¥«¥­­®¬³ ª«¾·³ ¨§ ¬­®¦¥±²¢  U (°¨±. 12.1: T [k] |
¬¥±²®, ¯°¥¤­ §­ ·¥­­®¥ ¤«¿ § ¯¨±¨ ³ª § ²¥«¿ ­  ½«¥¬¥­² ± ª«¾·®¬ k; ¥±«¨ ½«¥¬¥­²  ± ª«¾·®¬ k ¢ ² ¡«¨¶¥ ­¥², ²® T [k] = nil).
¥ «¨§ ¶¨¿ ±«®¢ °­»µ ®¯¥° ¶¨© ²°¨¢¨ «¼­ :
Direct-Address-Search (T; k)
return T [k]
Direct-Address-Insert (T; x)

T [key[x]]

x

Direct-Address-Delete (T; x)
T [key[x]] nil

 ¦¤ ¿ ¨§ ½²¨µ ®¯¥° ¶¨© ²°¥¡³¥² ¢°¥¬¥­¨ O(1).
­®£¤  ¬®¦­® ±½ª®­®¬¨²¼ ¬¥±²®, § ¯¨±»¢ ¿ ¢ ² ¡«¨¶³ T ­¥ ³ª § ²¥«¨ ­  ½«¥¬¥­²» ¬­®¦¥±²¢ ,   ± ¬¨ ½²¨ ½«¥¬¥­²». ®¦­® ®¡®©²¨±¼ ¨ ¡¥§ ®²¤¥«¼­®£® ¯®«¿ Àª«¾·Á: ª«¾·®¬ ±«³¦¨² ¨­¤¥ª± ¢ ¬ ±±¨¢¥. ¯°®·¥¬, ¥±«¨ ¬» ®¡µ®¤¨¬±¿ ¡¥§ ª«¾·¥© ¨ ³ª § ²¥«¥©, ²® ­ ¤®
¨¬¥²¼ ±¯®±®¡ ³ª § ²¼, ·²® ¤ ­­ ¿ ¯®§¨¶¨¿ ±¢®¡®¤­ .
¯° ¦­¥­¨¿
12.1-1 ¯¨¸¨²¥ ¯°®¶¥¤³°³ ¤«¿ ­ µ®¦¤¥­¨¿ ­ ¨¡®«¼¸¥£® ½«¥¬¥­²  ¤¨­ ¬¨·¥±ª®£® ¬­®¦¥±²¢ , ¯°¥¤±² ¢«¥­­®£® ¢ ¢¨¤¥ ² ¡«¨¶» ±
¯°¿¬®©  ¤°¥± ¶¨¥©.  ª®¢® ¢°¥¬¿ ° ¡®²» ½²®© ¯°®¶¥¤³°» ¢ µ³¤-

¥¸-² ¡«¨¶»

225

¸¥¬ ±«³· ¥?
12.1-2 ¨²®¢»© ¢¥ª²®° (bit vector) | ½²® ¬ ±±¨¢ ¡¨²®¢ (­³«¥© ¨
¥¤¨­¨¶). ¨²®¢»© ¢¥ª²®° ¤«¨­» m § ­¨¬ ¥² §­ ·¨²¥«¼­® ¬¥­¼¸¥
¬¥±² , ·¥¬ ¬ ±±¨¢ ¨§ m ³ª § ²¥«¥©.  ª, ¯®«¼§³¿±¼ ¡¨²®¢»¬ ¢¥ª²®°®¬, °¥ «¨§®¢ ²¼ ¤¨­ ¬¨·¥±ª®¥ ¬­®¦¥±²¢®, ±®±²®¿¹¥¥ ¨§ ° §«¨·­»µ ½«¥¬¥­²®¢ ¨ ­¥ ±®¤¥°¦ ¹¥¥ ¤®¯®«­¨²¥«¼­»µ ¤ ­­»µ? «®¢ °­»¥ ®¯¥° ¶¨¨ ¤®«¦­» ¢»¯®«­¿²¼±¿ §  ¢°¥¬¿ O(1).
12.1-3  ª °¥ «¨§®¢ ²¼ ² ¡«¨¶³ ± ¯°¿¬®©  ¤°¥± ¶¨¥©, ¢ ª®²®°®© ª«¾·¨ ° §«¨·­»µ ½«¥¬¥­²®¢ ¬®£³² ±®¢¯ ¤ ²¼,   ± ¬¨ ½«¥¬¥­²»
¬®£³² ±®¤¥°¦ ²¼ ¤®¯®«­¨²¥«¼­»¥ ¤ ­­»¥? ¯¥° ¶¨¨ ¤®¡ ¢«¥­¨¿,
³¤ «¥­¨¿ ¨ ¯®¨±ª  ¤®«¦­» ¢»¯®«­¿²¼±¿ §  ¢°¥¬¿ O(1) (­¥ § ¡³¤¼²¥,
·²®  °£³¬¥­²®¬ ¯°®¶¥¤³°» ³¤ «¥­¨¿ Delete ¿¢«¿¥²±¿ ³ª § ²¥«¼
­  ³¤ «¿¥¬»© ½«¥¬¥­²,   ­¥ ª«¾·).
12.1-4? °¥¤¯®«®¦¨¬, ·²® ­ ¬ ­ ¤® °¥ «¨§®¢ ²¼ ¤¨­ ¬¨·¥±ª®¥
¬­®¦¥±²¢®, ¯®¤¤¥°¦¨¢ ¾¹¥¥ ±«®¢ °­»¥ ®¯¥° ¶¨¨, ­  ¡ §¥ ®·¥­¼
¡®«¼¸®£® ¬ ±±¨¢ . ¥°¢®­ · «¼­® ¢ ¬ ±±¨¢¥ ¬®¦¥² ¡»²¼ § ¯¨± ­®
·²®-²®, ­¥ ¨¬¥¾¹¥¥ ®²­®¸¥­¨¥ ª ­ ¸¥© § ¤ ·¥, ­® ¬ ±±¨¢ ² ª®©
¡®«¼¸®©, ·²® ¯°¥¤¢ °¨²¥«¼­® ®·¨¹ ²¼ ¥£® ­¥¯° ª²¨·­®.  ª ¢ ² ª¨µ ³±«®¢¨¿µ °¥ «¨§®¢ ²¼ ² ¡«¨¶³ ± ¯°¿¬®©  ¤°¥± ¶¨¥©?  ¦¤ ¿
§ ¯¨±¼ ¤®«¦­  § ­¨¬ ²¼ ¬¥±²® ° §¬¥°®¬ O(1), ®¯¥° ¶¨¨ ¤®¡ ¢«¥­¨¿, ³¤ «¥­¨¿ ¨ ¯®¨±ª  ¤®«¦­» ¢»¯®«­¿²¼±¿ §  ¢°¥¬¿ O(1), ¢°¥¬¿
­  ¨­¨¶¨ «¨§ ¶¨¾ ±²°³ª²³°» ¤ ­­»µ ² ª¦¥ ¤®«¦­® ¡»²¼ ° ¢­®
O(1). (ª § ­¨¥: ·²®¡» ¨¬¥²¼ ¢®§¬®¦­®±²¼ ³§­ ²¼, ¨¬¥¥² «¨ ¤ ­­»© ½«¥¬¥­² ¬ ±±¨¢  ®²­®¸¥­¨¥ ª ­ ¸¥© ±²°³ª²³°¥ ¤ ­­»µ, § ¢¥¤¨²¥ ±²¥ª, ° §¬¥° ª®²®°®£® ° ¢¥­ ª®«¨·¥±²¢³ § ¯¨±¥© ¢ ² ¡«¨¶¥).

12.2. ¥¸-² ¡«¨¶»
°¿¬ ¿  ¤°¥± ¶¨¿ ®¡« ¤ ¥² ®·¥¢¨¤­»¬ ­¥¤®±² ²ª®¬: ¥±«¨ ¬­®¦¥±²¢® U ¢±¥¢®§¬®¦­»µ ª«¾·¥© ¢¥«¨ª®, ²® µ° ­¨²¼ ¢ ¯ ¬¿²¨ ¬ ±±¨¢ T ° §¬¥°®¬ jU j ­¥¯° ª²¨·­®,   ²® ¨ ­¥¢®§¬®¦­®. °®¬¥ ²®£®,
¥±«¨ ·¨±«® °¥ «¼­® ¯°¨±³²±²¢³¾¹¨µ ¢ ² ¡«¨¶¥ § ¯¨±¥© ¬ «® ¯®
±° ¢­¥­¨¾ ± jU j, ²® ¬­®£® ¯ ¬¿²¨ ²° ²¨²±¿ §°¿.
±«¨ ª®«¨·¥±²¢® § ¯¨±¥© ¢ ² ¡«¨¶¥ ±³¹¥±²¢¥­­® ¬¥­¼¸¥, ·¥¬ ª®«¨·¥±²¢® ¢±¥¢®§¬®¦­»µ ª«¾·¥©, ²® µ¥¸-² ¡«¨¶  § ­¨¬ ¥² £®° §¤® ¬¥­¼¸¥ ¬¥±² , ·¥¬ ² ¡«¨¶  ± ¯°¿¬®©  ¤°¥± ¶¨¥©. ¬¥­­®, µ¥¸² ¡«¨¶  ²°¥¡³¥² ¯ ¬¿²¨ ®¡º¥¬®¬ (jK j), £¤¥ K | ¬­®¦¥±²¢® § ¯¨±¥©, ¯°¨ ½²®¬ ¢°¥¬¿ ¯®¨±ª  ¢ µ¥¸-² ¡«¨¶¥ ¯®-¯°¥¦­¥¬³ ¥±²¼ O(1)
(¥¤¨­±²¢¥­­®¥ À­®Á ¢ ²®¬, ·²® ­  ±¥© ° § ½²® | ®¶¥­ª  ¢ ±°¥¤­¥¬,
  ­¥ ¢ µ³¤¸¥¬ ±«³· ¥, ¤  ¨ ²® ²®«¼ª® ¯°¨ ®¯°¥¤¥«¥­­»µ ¯°¥¤¯®«®¦¥­¨¿µ).
 ²® ¢°¥¬¿ ª ª ¯°¨ ¯°¿¬®©  ¤°¥± ¶¨¨ ½«¥¬¥­²³ ± ª«¾·®¬ k ®²¢®-

226

« ¢  12 ¥¸-² ¡«¨¶»

¥°¥¢®¤» ­ ¤¯¨±¥© ­  ± ¬®© ª °²¨­ª¥: universe of keys | ¢±¥¢®§¬®¦­»¥ ª«¾·¨, actual keys | ¨±¯®«¼§³¥¬»¥ ª«¾·¨

±¯®«¼§®¢ ­¨¥ µ¥¸-´³­ª¶¨¨ ¤«¿ ®²®¡° ¦¥­¨¿ ª«¾·¥© ¢ ¯®§¨¶¨¨
µ¥¸-² ¡«¨¶». ¥¸-§­ ·¥­¨¿ ª«¾·¥© k2 ¨ k5 ±®¢¯ ¤ ¾² | ¨¬¥¥² ¬¥±²® ª®««¨§¨¿.
¨±. 12.2

¤¨²±¿ ¯®§¨¶¨¿ ­®¬¥° k, ¯°¨ µ¥¸¨°®¢ ­¨¨ ½²®² ½«¥¬¥­² § ¯¨±»¢ ¥²±¿ ¢ ¯®§¨¶¨¾ ­®¬¥° h(k) ¢ µ¥¸-² ¡«¨¶¥ (hash table) T [0 : :m ; 1],
£¤¥
h : U ! f0; 1; : : :; m ; 1g
| ­¥ª®²®° ¿ ´³­ª¶¨¿, ­ §»¢ ¥¬ ¿ µ¥¸-´³­ª¶¨¥© (hash function).
¨±«® h(k) ­ §»¢ ¾² µ¥¸-§­ ·¥­¨¥¬ (hash value) ª«¾·  k. ¤¥¿
µ¥¸¨°®¢ ­¨¿ ¯®ª § ­  ­  °¨±. 12.2: ¯®«¼§³¿±¼ ¬ ±±¨¢®¬ ¤«¨­» m,
  ­¥ jU j, ¬» ½ª®­®¬¨¬ ¯ ¬¿²¼.
°®¡«¥¬ , ®¤­ ª®, ¢ ²®¬, ·²® µ¥¸-§­ ·¥­¨¿ ¤¢³µ ° §­»µ ª«¾·¥©
¬®£³² ±®¢¯ ±²¼.  ² ª¨µ ±«³· ¿µ £®¢®°¿², ·²® ±«³·¨« ±¼ ª®««¨§¨¿,
¨«¨ ±²®«ª­®¢¥­¨¥ (collision).  ±· ±²¼¾, ½²  ¯°®¡«¥¬  ° §°¥¸¨¬ :
µ¥¸-´³­ª¶¨¿¬¨ ¬®¦­® ¯®«¼§®¢ ²¼±¿ ¨ ¯°¨ ­ «¨·¨¨ ±²®«ª­®¢¥­¨©.
®²¥«®±¼ ¡» ¢»¡° ²¼ µ¥¸-´³­ª¶¨¾ ² ª, ·²®¡» ª®««¨§¨¨ ¡»«¨ ­¥¢®§¬®¦­». ® ¯°¨ jU j > m ­¥¨§¡¥¦­® ±³¹¥±²¢³¾² ° §­»¥ ª«¾·¨, ¨¬¥¾¹¨¥ ®¤­® ¨ ²® ¦¥ µ¥¸-§­ ·¥­¨¥.  ª ·²® ¬®¦­®
«¨¸¼ ­ ¤¥¿²¼±¿, ·²® ¤«¿ ´ ª²¨·¥±ª¨ ¯°¨±³²±²¢³¾¹¨µ ¢ ¬­®¦¥±²¢¥
ª«¾·¥© ª®««¨§¨© ¡³¤¥² ­¥¬­®£®, ¨ ¡»²¼ £®²®¢»¬¨ ®¡° ¡ ²»¢ ²¼
²¥ ª®««¨§¨¨, ª®²®°»¥ ¢±¥-² ª¨ ¯°®¨§®©¤³².
»¡¨° ¿ µ¥¸-´³­ª¶¨¾, ¬» ®¡»·­® ­¥ §­ ¥¬ § ° ­¥¥, ª ª¨¥ ¨¬¥­­® ª«¾·¨ ¡³¤³² µ° ­¨²¼±¿. ® ­  ¢±¿ª¨© ±«³· © ° §³¬­® ±¤¥« ²¼
±¤¥« ²¼ µ¥¸-´³­ª¶¨¾ ¢ ª ª®¬-²® ±¬»±«¥ À±«³· ©­®©Á, µ®°®¸® ¯¥°¥¬¥¸¨¢ ¾¹¥© ª«¾·¨ ¯® ¿·¥©ª ¬ ( ­£«¨©±ª¨© £« £®« \to hash"
®§­ · ¥² À¬¥«ª® ¯®°³¡¨²¼, ¯®¬¥¸¨¢ ¿Á).  §³¬¥¥²±¿, À±«³· ©­ ¿Á
µ¥¸-´³­ª¶¨¿ ¤®«¦­  ¢±¥ ¦¥ ¡»²¼ ¤¥²¥°¬¨­¨°®¢ ­­®© ¢ ²®¬ ±¬»±«¥, ·²® ¯°¨ ¥¥ ¯®¢²®°­»µ ¢»§®¢ µ ± ®¤­¨¬ ¨ ²¥¬ ¦¥  °£³¬¥­²®¬
®­  ¤®«¦­  ¢®§¢° ¹ ²¼ ®¤­® ¨ ²® ¦¥ µ¥¸-§­ ·¥­¨¥.
 ½²®¬ ° §¤¥«¥ ¬» ° ±±¬®²°¨¬ ¯°®±²¥©¸¨© ±¯®±®¡ ®¡° ¡®²ª¨
(ª ª £®¢®°¿², À° §°¥¸¥­¨¿Á) ª®««¨§¨© ± ¯®¬®¹¼¾ ¶¥¯®·¥ª. °³£®©
±¯®±®¡ | ®²ª°»² ¿  ¤°¥± ¶¨¿ | ° ±±¬ ²°¨¢ ¥²±¿ ¢ ° §¤¥«¥ 12.4.

¥¸-² ¡«¨¶»

227

¥°¥¢®¤» ­ ¤¯¨±¥© ­  ± ¬®© ª °²¨­ª¥: universe of keys | ¢±¥¢®§¬®¦­»¥ ª«¾·¨, actual keys | ¨±¯®«¼§³¥¬»¥ ª«¾·¨

¨±. 12.3  §°¥¸¥­¨¥ ª®««¨§¨© ± ¯®¬®¹¼¾ ¶¥¯®·¥ª.  ¯®§¨¶¨¨ T [j ] µ° ­¨²±¿
³ª § ²¥«¼ ­  ±¯¨±®ª ½«¥¬¥­²®¢ ± µ¥¸-§­ ·¥­¨¥¬ j .  ¯°¨¬¥°, h(k1 ) = h(k4 ) ¨
h(k5 ) = h(k2 ) = h(k7 ).

 §°¥¸¥­¨¥ ª®««¨§¨© ± ¯®¬®¹¼¾ ¶¥¯®·¥ª
¥µ­®«®£¨¿ ±¶¥¯«¥­¨¿ ½«¥¬¥­²®¢ (chaining) ±®±²®¨² ¢ ²®¬, ·²®
½«¥¬¥­²» ¬­®¦¥±²¢ , ª®²®°»¬ ±®®²¢¥²±²¢³¥² ®¤­® ¨ ²® ¦¥ µ¥¸§­ ·¥­¨¥, ±¢¿§»¢ ¾²±¿ ¢ ¶¥¯®·ª³-±¯¨±®ª (°¨±. 12.3).  ¯®§¨¶¨¨ ­®¬¥° j µ° ­¨²±¿ ³ª § ²¥«¼ ­  £®«®¢³ ±¯¨±ª  ²¥µ ½«¥¬¥­²®¢, ³ ª®²®°»µ µ¥¸-§­ ·¥­¨¥ ª«¾·  ° ¢­® j ; ¥±«¨ ² ª¨µ ½«¥¬¥­²®¢ ¢ ¬­®¦¥±²¢¥ ­¥², ¢ ¯®§¨¶¨¨ j § ¯¨± ­ nil.
¯¥° ¶¨¨ ¤®¡ ¢«¥­¨¿, ¯®¨±ª  ¨ ³¤ «¥­¨¿ °¥ «¨§³¾²±¿ «¥£ª®:
Chained-Hash-Insert(T; x)
¤®¡ ¢¨²¼ x ¢ £®«®¢³ ±¯¨±ª  T [h(key[x])]
Chained-Hash-Search(T; k)

­ ©²¨ ½«¥¬¥­² ± ª«¾·®¬ k ¢ ±¯¨±ª¥ T [h(k)]

Chained-Hash-Delete(T; x)

³¤ «¨²¼ x ¨§ ±¯¨±ª  T [h(key[x])]
¯¥° ¶¨¿ ¤®¡ ¢«¥­¨¿ ° ¡®² ¥² ¢ µ³¤¸¥¬ ±«³· ¥ §  ¢°¥¬¿ O(1).
 ª±¨¬ «¼­®¥ ¢°¥¬¿ ° ¡®²» ®¯¥° ¶¨¨ ¯®¨±ª  ¯°®¯®°¶¨®­ «¼­®
¤«¨­¥ ±¯¨±ª  (­¨¦¥ ¬» ° ±±¬®²°¨¬ ½²®² ¢®¯°®± ¯®¤°®¡­¥¥).  ª®­¥¶, ³¤ «¥­¨¥ ½«¥¬¥­²  ¬®¦­® ¯°®¢¥±²¨ §  ¢°¥¬¿ O(1) | ¯°¨ ³±«®¢¨¨, ·²® ±¯¨±ª¨ ¤¢³±²®°®­­¥ ±¢¿§ ­» (¥±«¨ ±¯¨±ª¨ ±¢¿§ ­» ®¤­®±²®°®­­¥, ²® ¤«¿ ³¤ «¥­¨¿ ½«¥¬¥­²  x ­ ¤® ¯°¥¤¢ °¨²¥«¼­® ­ ©²¨
¥£® ¯°¥¤¸¥±²¢¥­­¨ª , ¤«¿ ·¥£® ­¥®¡µ®¤¨¬ ¯®¨±ª ¯® ±¯¨±ª³; ¢ ² ª®¬
±«³· ¥ ±²®¨¬®±²¼ ³¤ «¥­¨¿ ¨ ¯®¨±ª  ¯°¨¬¥°­® ®¤¨­ ª®¢»).

228

« ¢  12 ¥¸-² ¡«¨¶»

­ «¨§ µ¥¸¨°®¢ ­¨¿ ± ¶¥¯®·ª ¬¨
 ½²®¬ ° §¤¥«¥ ¬» ®¶¥­¨¬ ¢°¥¬¿ ° ¡®²» ®¯¥° ¶¨© ¤«¿ µ¥¸¨°®¢ ­¨¿ ± ¶¥¯®·ª ¬¨.
³±²¼ T | µ¥¸-² ¡«¨¶  ± m ¯®§¨¶¨¿¬¨, ¢ ª®²®°³¾ § ­¥±¥­® n
½«¥¬¥­²®¢. ®½´´¨¶¨¥­²®¬ § ¯®«­¥­¨¿ (load factor) ² ¡«¨¶» ­ §»¢ ¥²±¿ ·¨±«®  = n=m (½²® ·¨±«® ¬®¦¥² ¡»²¼ ¨ ¬¥­¼¸¥, ¨ ¡®«¼¸¥
¥¤¨­¨¶»). » ¡³¤¥¬ ®¶¥­¨¢ ²¼ ±²®¨¬®±²¼ ®¯¥° ¶¨© ¢ ²¥°¬¨­ µ .
 µ³¤¸¥¬ ±«³· ¥ µ¥¸¨°®¢ ­¨¥ ± ¶¥¯®·ª ¬¨ ¢¥¤¥² ±¥¡¿ ®²¢° ²¨²¥«¼­®: ¥±«¨ µ¥¸-§­ ·¥­¨¿ ¢±¥µ n ª«¾·¥© ±®¢¯ ¤ ¾², ²® ² ¡«¨¶ 
±¢®¤¨²±¿ ª ®¤­®¬³ ±¯¨±ª³ ¤«¨­» n, ¨ ­  ¯®¨±ª ¡³¤¥² ²° ²¨²¼±¿ ²®
¦¥ ¢°¥¬¿ (n), ·²® ¨ ­  ¯®¨±ª ¢ ±¯¨±ª¥, ¯«¾± ¥¹¥ ¢°¥¬¿ ­  ¢»·¨±«¥­¨¥ µ¥¸-´³­ª¶¨¨. ®­¥·­®, ¢ ² ª®© ±¨²³ ¶¨¨ µ¥¸¨°®¢ ­¨¥
¡¥±±¬»±«¥­­®.
°¥¤­¿¿ ±²®¨¬®±²¼ ¯®¨±ª  § ¢¨±¨² ®² ²®£®, ­ ±ª®«¼ª® ° ¢­®¬¥°­® µ¥¸-´³­ª¶¨¿ ° ±¯°¥¤¥«¿¥² µ¥¸-§­ ·¥­¨¿ ¯® ¯®§¨¶¨¿¬ ² ¡«¨¶».
®¯°®±³ ® ²®¬, ª ª ¤®¡¨¢ ²¼±¿ ½²®© ° ¢­®¬¥°­®±²¨, ¯®±¢¿¹¥­ ° §¤¥« 12.3; ¯®ª  ¦¥ ¡³¤¥¬ ³±«®¢­® ¯°¥¤¯®« £ ²¼, ·²® ª ¦¤»© ¤ ­­»©
½«¥¬¥­² ¬®¦¥² ¯®¯ ±²¼ ¢ «¾¡³¾ ¨§ m ¯®§¨¶¨© ² ¡«¨¶» ± ° ¢­®©
¢¥°®¿²­®±²¼¾ ¨ ­¥§ ¢¨±¨¬® ®² ²®£®, ª³¤  ¯®¯ « ¤°³£®© ½«¥¬¥­².
» ¡³¤¥¬ ­ §»¢ ²¼ ½²® ¯°¥¤¯®«®¦¥­¨¥ £¨¯®²¥§®© À° ¢­®¬¥°­®£®
µ¥¸¨°®¢ ­¨¿Á (simple uniform hashing).
³¤¥¬ ±·¨² ²¼, ·²® ¤«¿ ¤ ­­®£® ª«¾·  k ¢»·¨±«¥­¨¥ µ¥¸§­ ·¥­¨¿ h(k), ¸ £ ¯® ±¯¨±ª³ ¨ ±° ¢­¥­¨¥ ª«¾·¥© ²°¥¡³¥² ´¨ª±¨°®¢ ­­®£® ¢°¥¬¥­¨, ² ª ·²® ¢°¥¬¿ ¯®¨±ª  ½«¥¬¥­²  ± ª«¾·®¬ k
«¨­¥©­® § ¢¨±¨² ®² ª®«¨·¥±²¢  ½«¥¬¥­²®¢ ¢ ±¯¨±ª¥ T [h(k)], ª®²®°»¥ ¬» ¯°®±¬ ²°¨¢ ¥¬ ¢ ¯°®¶¥±±¥ ¯®¨±ª . ³¤¥¬ ° §«¨· ²¼ ¤¢ 
±«³· ¿: ¢ ¯¥°¢®¬ ±«³· ¥ ¯®¨±ª ®ª ­·¨¢ ¥²±¿ ­¥³¤ ·¥© (½«¥¬¥­²  ±
ª«¾·®¬ k ¢ ±¯¨±ª¥ ­¥²), ¢® ¢²®°®¬ ¯®¨±ª ³±¯¥¸¥­ | ½«¥¬¥­² ±
²°¥¡³¥¬»¬ ª«¾·®¬ ®¡­ °³¦¨¢ ¥²±¿.
¥®°¥¬  12.1. ³±²¼ T | µ¥¸-² ¡«¨¶  ± ¶¥¯®·ª ¬¨, ¨¬¥¾¹ ¿ ª®½´´¨¶¨¥­² § ¯®«­¥­¨¿ . °¥¤¯®«®¦¨¬, ·²® µ¥¸¨°®¢ ­¨¥ ° ¢­®¬¥°­®. ®£¤  ¯°¨ ¯®¨±ª¥ ½«¥¬¥­² , ®²±³²±²¢³¾¹¥£® ¢ ² ¡«¨¶¥,
¡³¤¥² ¯°®±¬®²°¥­® ¢ ±°¥¤­¥¬  ½«¥¬¥­²®¢ ² ¡«¨¶»,   ±°¥¤­¥¥
¢°¥¬¿ ² ª®£® ¯®¨±ª  (¢ª«¾· ¿ ¢°¥¬¿ ­  ¢»·¨±«¥­¨¥ µ¥¸-´³­ª¶¨¨)
¡³¤¥² ° ¢­® (1 + ).
®ª § ²¥«¼±²¢®. ®±ª®«¼ª³ ¢ ¯°¥¤¯®«®¦¥­¨¨ ° ¢­®¬¥°­®£® µ¥¸¨°®¢ ­¨¿ ¢±¥ ¯®§¨¶¨¨ ² ¡«¨¶» ¤«¿ ¤ ­­®£® ª«¾·  ° ¢­®¢¥°®¿²­», ±°¥¤­¥¥ ¢°¥¬¿ ¯®¨±ª  ®²±³²±²¢³¾¹¥£® ½«¥¬¥­²  ±®¢¯ ¤ ¥²
±® ±°¥¤­¨¬ ¢°¥¬¥­¥¬ ¯®«­®£® ¯°®±¬®²°  ®¤­®£® ¨§ m ±¯¨±ª®¢, ²®
¥±²¼ ¯°®¯®°¶¨®­ «¼­® ±°¥¤­¥© ¤«¨­¥ ­ ¸¨µ m ±¯¨±ª®¢. ²  ±°¥¤­¿¿ ¤«¨­  ¥±²¼ n=m = , ®²ª³¤  ¯®«³· ¥¬ ¯¥°¢®¥ ³²¢¥°¦¤¥­¨¥ ²¥®°¥¬»; ¢²®°®¥ ³²¢¥°¦¤¥­¨¥ ¯®«³·¨²±¿, ¥±«¨ ¤®¡ ¢¨²¼ ¢°¥¬¿ (1)
­  ¢»·¨±«¥­¨¥ µ¥¸-§­ ·¥­¨¿.

¥¸-² ¡«¨¶»

229

¥®°¥¬  12.2. °¨ ° ¢­®¬¥°­®¬ µ¥¸¨°®¢ ­¨¨ ±°¥¤­¥¥ ¢°¥¬¿
³±¯¥¸­®£® ¯®¨±ª  ¢ µ¥¸-² ¡«¨¶¥ ± ¶¥¯®·ª ¬¨ ¥±²¼ (1 + ),
£¤¥  | ª®½´´¨¶¨¥­² § ¯®«­¥­¨¿.
®ª § ²¥«¼±²¢®. ®²¿ ´®°¬³«¨°®¢ª  ½²®© ²¥®°¥¬» ¯®µ®¦  ­ 
¯°¥¤»¤³¹³¾, ±¬»±« ³²¢¥°¦¤¥­¨¿ ­¥±ª®«¼ª® ¨­®©.  ¯°¥¤»¤³¹¥©
²¥®°¥¬¥ ¬» ° ±±¬ ²°¨¢ «¨ ¯°®¨§¢®«¼­³¾ ² ¡«¨¶³ ± ª®½´´¨¶¨¥­²®¬ § ¯®«­¥­¨¿  ¨ ®¶¥­¨¢ «¨ ±°¥¤­¥¥ ·¨±«® ¤¥©±²¢¨©, ­¥®¡µ®¤¨¬»µ ¤«¿ ¯®¨±ª  ±«³· ©­®£® ½«¥¬¥­² , ° ¢­®¢¥°®¿²­® ¯®¯ ¤ ¾¹¥£®
¢® ¢±¥ ¿·¥©ª¨ ² ¡«¨¶».
 ½²®© ²¥®°¥¬¥ ² ª ¤¥« ²¼ ­¥«¼§¿: ¥±«¨ ¬» ¢®§¼¬¥¬ ¯°®¨§¢®«¼­³¾ ² ¡«¨¶³ ¨, ±·¨² ¿ ¢±¥ ¥¥ ½«¥¬¥­²» ° ¢­®¢¥°®¿²­»¬¨, ¡³¤¥¬
¨±ª ²¼ ±°¥¤­¥¥ ¢°¥¬¿ ¯®¨±ª  ±«³· ©­® ¢»¡° ­­®£® ¨§ ­¨µ, ²® ®¶¥­ª¨ ¢¨¤  (1 + ) ­¥ ¯®«³·¨²±¿ (ª®­²°¯°¨¬¥°: ² ¡«¨¶ , ¢ ª®²®°®©
¢±¥ ½«¥¬¥­²» ¯®¯ «¨ ¢ ®¤¨­ ±¯¨±®ª)
®°¬³«¨°®¢ª  ¯®¤° §³¬¥¢ ¥² ¤¢®©­®¥ ³±°¥¤­¥­¨¥: ±­ · «  ¬»
° ±±¬ ²°¨¢ ¥¬ ±«³· ©­® ¢»¡° ­­³¾ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ½«¥¬¥­²®¢, ¤®¡ ¢«¿¥¬»µ ¢ ² ¡«¨¶³, ¯°¨·¥¬ ­  ª ¦¤®¬ ¸ £¥ ¢±¥ §­ ·¥­¨¿
ª«¾·  ° ¢­®¢¥°®¿²­» ¨ ¸ £¨ ­¥§ ¢¨±¨¬»,   § ²¥¬ ¢ ¯®«³·¥­­®©
² ¡«¨¶¥ ¢»¡¨° ¥¬ ½«¥¬¥­² ¤«¿ ¯®¨±ª , ±·¨² ¿ ¢±¥ ¥¥ ½«¥¬¥­²» ° ¢­®¢¥°®¿²­»¬¨.
®±¬®²°¨¬ ­  ±¨²³ ¶¨¾ ¢ ²®² ¬®¬¥­², ª®£¤  ² ¡«¨¶  ³¦¥ ¯®±²°®¥­ , ­® ±«³· ©­»© ½«¥¬¥­² ¤«¿ ¯®¨±ª  ¥¹¥ ­¥ ¢»¡° ­. ¥¬³
° ¢­® ±°¥¤­¥¥ ¢°¥¬¿ ¯®¨±ª , ³±°¥¤­¥­­®¥ ¯® ¢±¥¬ n ½«¥¬¥­² ¬ ² ¡«¨¶»?  ¤® ±«®¦¨²¼ ¯®§¨¶¨¨ ¢±¥µ ½«¥¬¥­²®¢ ¢ ±¢®¨µ ±¯¨±ª µ ¨
¯®¤¥«¨²¼ ±³¬¬³ ­  n (®¡¹¥¥ ·¨±«® ½«¥¬¥­²®¢).
±«¨ ¯°¥¤±² ¢¨²¼ ±¥¡¥, ·²® ¯°¨ § ¯®«­¥­¨¨ ² ¡«¨¶» ½«¥¬¥­²»
¤®¯¨±»¢ «¨±¼ ¢ ª®­¥¶ ±®®²¢¥²±²¢³¾¹¨µ ±¯¨±ª®¢ (±¬. ³¯°. 12.2-3),
²® ³¯®¬¿­³² ¿ ±³¬¬  ¯® ¯®°¿¤ª³ ¢¥«¨·¨­» ° ¢­  ®¡¹¥¬³ ·¨±«®
®¯¥° ¶¨©, ¢»¯®«­¥­­»µ ¯°¨ § ¯®«­¥­¨¨ ² ¡«¨¶» (¯®±ª®«¼ª³ ¯°¨
¤®¡ ¢«¥­¨¨ ¢ ª®­¥¶ ¨ ¯°¨ ¯®¨±ª¥ ¢»¯®«­¿¥²±¿ ®¤­® ¨ ²® ¦¥ ª®«¨·¥±²¢® ¤¥©±²¢¨©).
¥¯¥°¼ ¢±¯®¬­¨¬ ®¡ ³±°¥¤­¥­¨¨ ¯® ° §«¨·­»¬ ¢®§¬®¦­®±²¿¬ ¢
¯°®¶¥±±¥ ¯®±²°®¥­¨¿ ² ¡«¨¶». °¨ ¤®¡ ¢«¥­¨¨ ¢ ­¥¥ i-£® ½«¥¬¥­² 
¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ·¨±«  ¤¥©±²¢¨© ° ¢­® (1 + (i ; 1)=m)
(±¬. ¤®ª § ²¥«¼±²¢® ¯°¥¤»¤³¹¥© ²¥®°¥¬»), ¨ ¯®²®¬³ ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ®¡¹¥£® ·¨±«  ¤¥©±²¢¨© ¯°¨ § ¯®«­¥­¨¨ ² ¡«¨¶»,
¤¥«¥­­®¥ ­  n, ¥±²¼
n
X
1

1+ i;1


n i=1

m

!

!
n
X
1
(i ; 1) =
= 1+

nm i=1

1  (n ; 1)n =
=  1 + nm
2


=  1 + 2 ; 21m = (1 + ):


230

« ¢  12 ¥¸-² ¡«¨¶»

±«¨ ª®«¨·¥±²¢® ¯®§¨¶¨© ¢ µ¥¸-² ¡«¨¶¥ ±·¨² ²¼ ¯°®¯®°¶¨®­ «¼­»¬ ·¨±«³ ½«¥¬¥­²®¢ ¢ ² ¡«¨¶¥, ²® ¨§ ¤®ª § ­­»µ ²¥®°¥¬ ¢»²¥ª ¥², ·²® ±°¥¤­¥¥ ¢°¥¬¿ ­  ¯®¨±ª (¢ ®¯²¨¬¨±²¨·¥±ª¨µ ¯°¥¤¯®«®¦¥­¨¿µ ® ° ±¯°¥¤¥«¥­¨¨ ¢¥°®¿²­®±²¥©) ¥±²¼ O(1).  ± ¬®¬ ¤¥«¥, ¥±«¨
n = O(m), ²®  = n=m = O(1) ¨ O(1 + ) = O(1). ®±ª®«¼ª³
±²®¨¬®±²¼ ¤®¡ ¢«¥­¨¿ ¢ µ¥¸-² ¡«¨¶³ ± ¶¥¯®·ª ¬¨ ¥±²¼ O(1) (¤ ¦¥
¯°¨ ¤®¡ ¢«¥­¨¨ ¢ ª®­¥¶, ±¬. ³¯°. 12.2-3),   ±²®¨¬®±²¼ ³¤ «¥­¨¿ ½«¥¬¥­²  ¥±²¼ O(1) (¬» ±·¨² ¥¬, ·²® ±¯¨±ª¨ ¤¢³±²®°®­­¥ ±¢¿§ ­»),
±°¥¤­¥¥ ¢°¥¬¿ ¢»¯®«­¥­¨¿ «¾¡®© ±«®¢ °­®© ®¯¥° ¶¨¨ (¢ ¯°¥¤¯®«®¦¥­¨¨ ° ¢­®¬¥°­®£® µ¥¸¨°®¢ ­¨¿) ¥±²¼ O(1).
¯° ¦­¥­¨¿
12.2-1 ³±²¼ h | ±«³· ©­ ¿ µ¥¸-´³­ª¶¨¿, ±®¯®±² ¢«¿¾¹ ¿ ± ª ¦¤»¬ ¨§ n ° §«¨·­»µ ª«¾·¥© fk1; k2; : : :; kng ®¤­³ ¨§ m ¯®§¨¶¨©
¢ ² ¡«¨¶¥.  ª®¢® ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ·¨±«  ª®««¨§¨© (²®·­¥¥, ·¨±«  ¯ ° (i; j ), ¤«¿ ª®²®°»µ ·²® h(ki) = h(kj ))?
12.2-2  ª ¡³¤¥² ¢»£«¿¤¥²¼ µ¥¸-² ¡«¨¶  ± ¶¥¯®·ª ¬¨ ¯®±«¥ ²®£®, ª ª ¢ ­¥¥ ¯®±«¥¤®¢ ²¥«¼­® ¯®¬¥±²¨«¨ ½«¥¬¥­²» ± ª«¾· ¬¨
5; 28; 19; 15; 20; 33; 12; 17; 10 (¢ ³ª § ­­®¬ ¯®°¿¤ª¥)? ¨±«® ¯®§¨¶¨©
¢ ² ¡«¨¶¥ ° ¢­® 9, µ¥¸-´³­ª¶¨¿ ¨¬¥¥² ¢¨¤ h(k) = k mod 9.
12.2-3 ®ª ¦¨²¥, ·²® ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ¢°¥¬¥­¨ ¤®¡ ¢«¥­¨¿ ­®¢®£® ½«¥¬¥­²  (¢ ¯°¥¤¯®«®¦¥­¨¨ ° ¢­®¬¥°­®£® µ¥¸¨°®¢ ­¨¿) ¥±²¼ O(1 + ), ¥±«¨ ¬» ¤®¡ ¢«¿¥¬ ­®¢»© ½«¥¬¥­² ¢ ª®­¥¶
±®®²¢¥²±²¢³¾¹¥© ¶¥¯®·ª¨.
12.2-4 °®´¥±±®° ¯°¥¤¯®« £ ¥², ·²® µ¥¸¨°®¢ ­¨¥ ± ¶¥¯®·ª ¬¨
¡³¤¥² £®° §¤® ½´´¥ª²¨¢­¥¥, ¥±«¨ ±¯¨±ª¨ ½«¥¬¥­²®¢ ± ¤ ­­»¬ µ¥¸§­ ·¥­¨¥¬ ¡³¤³² ³¯®°¿¤®·¥­­»¬¨.  ª ½²®² ¯®¤µ®¤ ¯®¢«¨¿¥² ­ 
±²®¨¬®±²¼ ³±¯¥¸­®£® ¯®¨±ª , ¯®¨±ª  ®²±³²±²¢³¾¹¥£® ½«¥¬¥­² ,
¤®¡ ¢«¥­¨¿, ³¤ «¥­¨¿?
12.2-5  §° ¡®² ©²¥ °¥ «¨§ ¶¨¾ µ¥¸-² ¡«¨¶» ± ¶¥¯®·ª ¬¨, ¢ ª®²®°®© § ¯¨±¨ µ° ­¿²±¿ ¢­³²°¨ ± ¬®© µ¥¸-² ¡«¨¶» (­¥¨±¯®«¼§³¥¬»¥ ¯®§¨¶¨¨ ±¢¿§»¢ ¾²±¿ ¢ ±¯¨±®ª ±¢®¡®¤­»µ ¬¥±²). ·¨² ©²¥,
·²® ¢ ª ¦¤®© ¯®§¨¶¨¨ ¬®£³² µ° ­¨²¼±¿ «¨¡® ´« £ ¨ ¤¢  ³ª § ²¥«¿, «¨¡® ´« £, ³ª § ²¥«¼ ¨ ½«¥¬¥­². ±¥ ±«®¢ °­»¥ ®¯¥° ¶¨¨,  
² ª¦¥ ®¯¥° ¶¨¨ ¯® ¢»¤¥«¥­¨¾ ¨ ®±¢®¡®¦¤¥­¨¾ ¬¥±² , ¤®«¦­» ¢»¯®«­¿²¼±¿ §  ¢°¥¬¿ O(1). ¡¿§ ²¥«¼­® «¨ ¤¥« ²¼ ±¯¨±®ª ±¢®¡®¤­»µ
¬¥±² ¤¢³±²®°®­­¥ ±¢¿§ ­­»¬?
12.2-6 ³±²¼ ®¡¹¥¥ ·¨±«® ¢®§¬®¦­»µ ª«¾·¥© (° §¬¥° ¬­®¦¥±²¢ 
U ) ¯°¥¢®±µ®¤¨² mn, £¤¥ m | ª®«¨·¥±²¢® µ¥¸-§­ ·¥­¨©. ®ª ¦¨²¥,

¥¸-´³­ª¶¨¨

231

·²® ±³¹¥±²¢³¥² ­¥ ¬¥­¥¥ n ª«¾·¥© ± ®¤­¨¬ ¨ ²¥¬ ¦¥ µ¥¸-§­ ·¥­¨¥¬,
² ª ·²® ¢ µ³¤¸¥¬ ±«³· ¥ ¯®¨±ª ¢ µ¥¸-² ¡«¨¶¥ ± ¶¥¯®·ª ¬¨ § ©¬¥²
¢°¥¬¿ (n).

12.3. ¥¸-´³­ª¶¨¨
 ½²®¬ ° §¤¥«¥ ¬» ®¡±³¤¨¬, ·¥£® ¬» ¦¤¥¬ ®² µ®°®¸¥© µ¥¸´³­ª¶¨¨,   § ²¥¬ ° §¡¥°¥¬ ²°¨ ±¯®±®¡  ¯®±²°®¥­¨¿ µ¥¸-´³­ª¶¨©:
¤¥«¥­¨¥ ± ®±² ²ª®¬, ³¬­®¦¥­¨¥ ¨ ³­¨¢¥°± «¼­®¥ µ¥¸¨°®¢ ­¨¥.
 ª®© ¤®«¦­  ¡»²¼ µ®°®¸ ¿ µ¥¸-´³­ª¶¨¿?
®°®¸ ¿ µ¥¸-´³­ª¶¨¿ ¤®«¦­  (¯°¨¡«¨¦¥­­®) ³¤®¢«¥²¢®°¿²¼
¯°¥¤¯®«®¦¥­¨¿¬ ° ¢­®¬¥°­®£® µ¥¸¨°®¢ ­¨¿: ¤«¿ ®·¥°¥¤­®£®
ª«¾·  ¢±¥ m µ¥¸-§­ ·¥­¨© ¤®«¦­» ¡»²¼ ° ¢­®¢¥°®¿²­». ²®¡»
½²® ¯°¥¤¯®«®¦¥­¨¥ ¨¬¥«® ±¬»±«, ´¨ª±¨°³¥¬ ° ±¯°¥¤¥«¥­¨¥ ¢¥°®¿²­®±²¥© P ­  ¬­®¦¥±²¢¥ U ; ¡³¤¥¬ ¯°¥¤¯®« £ ²¼, ·²® ª«¾·¨
¢»¡¨° ¾²±¿ ¨§ U ­¥§ ¢¨±¨¬® ¤°³£ ®² ¤°³£ , ¨ ª ¦¤»© ° ±¯°¥¤¥«¥­
¢ ±®®²¢¥²±²¢¨¨ ± P . ®£¤  ° ¢­®¬¥°­®¥ µ¥¸¨°®¢ ­¨¥ ®§­ · ¥²,
·²®
X
P (k) = 1 ¤«¿ j = 0; 1; : : :; m ; 1.
(12.1)
k : h(k)=j

m

 ±®¦ «¥­¨¾, ° ±¯°¥¤¥«¥­¨¥ P ®¡»·­® ­¥¨§¢¥±²­®, ² ª ·²® ¯°®¢¥°¨²¼ ½²® ­¥¢®§¬®¦­® (¤  ¨ ª«¾·¨ ­¥ ¢±¥£¤  ° §³¬­® ±·¨² ²¼
­¥§ ¢¨±¨¬»¬¨).
§°¥¤ª  ° ±¯°¥¤¥«¥­¨¥ P ¡»¢ ¥² ¨§¢¥±²­®. ³±²¼, ­ ¯°¨¬¥°,
ª«¾·¨ | ±«³· ©­»¥ ¤¥©±²¢¨²¥«¼­»¥ ·¨±« , ­¥§ ¢¨±¨¬® ¨ ° ¢­®¬¥°­® ° ±¯°¥¤¥«¥­­»¥ ­  ¨­²¥°¢ «¥ [0; 1).  ½²®¬ ±«³· ¥ «¥£ª® ¢¨¤¥²¼, ·²® µ¥¸-´³­ª¶¨¿ h(k) = bkmc ³¤®¢«¥²¢®°¿¥² ³±«®¢¨¾ (12.1).
  ¯° ª²¨ª¥ ¯°¨ ¢»¡®°¥ µ¥¸-´³­ª¶¨© ¯®«¼§³¾²±¿ ° §«¨·­»¬¨
½¢°¨±²¨ª ¬¨, ®±­®¢ ­­»¬¨ ­  ±¯¥¶¨´¨ª¥ § ¤ ·¨.  ¯°¨¬¥°, ª®¬¯¨«¿²®° ¿§»ª  ¯°®£° ¬¬¨°®¢ ­¨¿ µ° ­¨² ² ¡«¨¶³ ±¨¬¢®«®¢, ¢ ª®²®°®© ª«¾· ¬¨ ¿¢«¿¾²±¿ ¨¤¥­²¨´¨ª ²®°» ¯°®£° ¬¬».  ±²® ¢
¯°®£° ¬¬¥ ¨±¯®«¼§³¥²±¿ ­¥±ª®«¼ª® ¯®µ®¦¨µ ¨¤¥­²¨´¨ª ²®°®¢ (­ ¯°¨¬¥°, pt ¨ pts). ®°®¸ ¿ µ¥¸-´³­ª¶¨¿ ¡³¤¥² ±² ° ²¼±¿, ·²®¡»
µ¥¸-§­ ·¥­¨¿ ³ ² ª¨µ ¯®µ®¦¨µ ¨¤¥­²¨´¨ª ²®°®¢ ¡»«¨ ° §«¨·­».
¡»·­® ±² ° ¾²±¿ ¯®¤®¡° ²¼ µ¥¸-´³­ª¶¨¾ ² ª¨¬ ®¡° §®¬, ·²®¡» ¥¥ ¯®¢¥¤¥­¨¥ ­¥ ª®°°¥«¨°®¢ «® ± ° §«¨·­»¬¨ § ª®­®¬¥°­®±²¿¬¨, ª®²®°»¥ ¬®£³² ¢±²°¥²¨²¼±¿ ¢ µ¥¸¨°³¥¬»µ ¤ ­­»µ.  ¯°¨¬¥°,
®¯¨±»¢ ¥¬»© ­¨¦¥ ¬¥²®¤ ¤¥«¥­¨¿ ± ®±² ²ª®¬ ±®±²®¨² ¢ ²®¬, ·²®
¢ ª ·¥±²¢¥ µ¥¸-§­ ·¥­¨¿ ¡¥°¥²±¿ ®±² ²®ª ®² ¤¥«¥­¨¿ ª«¾·  ­  ­¥ª®²®°®¥ ¯°®±²®¥ ·¨±«®. ±«¨ ½²® ¯°®±²®¥ ·¨±«® ­¨ª ª ­¥ ±¢¿§ ­® ±

232

« ¢  12 ¥¸-² ¡«¨¶»

´³­ª¶¨¥© ° ±¯°¥¤¥«¥­¨¿ P , ²® ² ª®© ¬¥²®¤ ¤ ¥² µ®°®¸¨¥ °¥§³«¼² ²».
 ¬¥²¨¬ ¢ § ª«¾·¥­¨¥, ·²® ¨­®£¤  ¦¥« ²¥«¼­®, ·²®¡» µ¥¸´³­ª¶¨¿ ³¤®¢«¥²¢®°¿«  ³±«®¢¨¿¬, ¢»µ®¤¿¹¨¬ §  ¯°¥¤¥«» ²°¥¡®¢ ­¨¿ ° ¢­®¬¥°­®£® µ¥¸¨°®¢ ­¨¿.  ¯°¨¬¥°, ¬®¦­® ±² ° ²¼±¿,
·²®¡» À¡«¨§ª¨¬Á ¢ ª ª®¬-«¨¡® ±¬»±«¥ ª«¾· ¬ ±®®²¢¥²±²¢®¢ «¨
À¤ «¥ª¨¥Á µ¥¸-§­ ·¥­¨¿ (½²® ®±®¡¥­­® ¦¥« ²¥«¼­® ¯°¨ ¯®«¼§®¢ ­¨¨
®¯¨± ­­®© ¢ ° §¤¥«¥ 12.4 «¨­¥©­®© ¯®±«¥¤®¢ ²¥«¼­®±²¼¾ ¯°®¡).
«¾·¨ ª ª ­ ²³° «¼­»¥ ·¨±« 
¡»·­® ¯°¥¤¯®« £ ¾², ·²® ®¡« ±²¼ ®¯°¥¤¥«¥­¨¿ µ¥¸-´³­ª¶¨¨ |
¬­®¦¥±²¢® ¶¥«»µ ­¥®²°¨¶ ²¥«¼­»µ ·¨±¥«. ±«¨ ª«¾·¨ ­¥ ¿¢«¿¾²±¿ ­ ²³° «¼­»¬¨ ·¨±« ¬¨, ¨µ ®¡»·­® ¬®¦­® ¯°¥®¡° §®¢ ²¼ ª ² ª®¬³ ¢¨¤³ (µ®²¿ ·¨±«  ¬®£³² ¯®«³·¨²¼±¿ ¡®«¼¸¨¬¨).  ¯°¨¬¥°,
¯®±«¥¤®¢ ²¥«¼­®±²¨ ±¨¬¢®«®¢ ¬®¦­® ¨­²¥°¯°¥²¨°®¢ ²¼ ª ª ·¨±« ,
§ ¯¨± ­­»¥ ¢ ±¨±²¥¬¥ ±·¨±«¥­¨¿ ± ¯®¤µ®¤¿¹¨¬ ®±­®¢ ­¨¥¬: ¨¤¥­²¨´¨ª ²®° pt | ½²® ¯ °  ·¨±¥« (112; 116) (² ª®¢» ASCII-ª®¤» ¡³ª¢ p
¨ t), ¨«¨ ¦¥ ·¨±«® (112  128) + 116 = 14452 (¢ ±¨±²¥¬¥ ±·¨±«¥­¨¿
¯® ®±­®¢ ­¨¾ 128).  «¥¥ ¬» ¢±¥£¤  ¡³¤¥¬ ±·¨² ²¼, ·²® ª«¾·¨ |
¶¥«»¥ ­¥®²°¨¶ ²¥«¼­»¥ ·¨±« .
12.3.1. ¥«¥­¨¥ ± ®±² ²ª®¬
®±²°®¥­¨¥ µ¥¸-´³­ª¶¨¨ ¬¥²®¤®¬ ¤¥«¥­¨¿ ± ®±² ²ª®¬ (division
method) ±®±²®¨² ¢ ²®¬, ·²® ª«¾·³ k ±² ¢¨²±¿ ¢ ±®®²¢¥²±²¢¨¥ ®±² ²®ª ®² ¤¥«¥­¨¿ k ­  m, £¤¥ m | ·¨±«® ¢®§¬®¦­»µ µ¥¸-§­ ·¥­¨©:
h(k) = k mod m:
 ¯°¨¬¥°, ¥±«¨ ° §¬¥° µ¥¸-² ¡«¨¶» ° ¢¥­ m = 12 ¨ ª«¾· ° ¢¥­ 100, ²® µ¥¸-§­ ·¥­¨¥ ° ¢­® 4.
°¨ ½²®¬ ­¥ª®²®°»µ §­ ·¥­¨© m ±²®¨² ¨§¡¥£ ²¼.  ¯°¨¬¥°, ¥±«¨ m = 2p , ²® h(k) | ½²® ¯°®±²® p ¬« ¤¸¨µ ¡¨²®¢ ·¨±«  k. ±«¨
­¥² ³¢¥°¥­­®±²¨, ·²® ¢±¥ ª®¬¡¨­ ¶¨¨ ¬« ¤¸¨µ ¡¨²®¢ ª«¾·  ¡³¤³²
¢±²°¥· ²¼±¿ ± ®¤¨­ ª®¢®© · ±²®²®©, ²® ±²¥¯¥­¼ ¤¢®©ª¨ ¢ ª ·¥±²¢¥
·¨±«  m ­¥ ¢»¡¨° ¾². ¥µ®°®¸® ² ª¦¥ ¢»¡¨° ²¼ ¢ ª ·¥±²¢¥ m ±²¥¯¥­¼ ¤¥±¿²ª¨, ¥±«¨ ª«¾·¨ ¥±²¥±²¢¥­­® ¢®§­¨ª ¾² ª ª ¤¥±¿²¨·­»¥
·¨±« : ¢¥¤¼ ¢ ½²®¬ ±«³· ¥ ®ª ¦¥²±¿, ·²® ³¦¥ · ±²¼ ¶¨´° ª«¾·  ¯®«­®±²¼¾ ®¯°¥¤¥«¿¥² µ¥¸-§­ ·¥­¨¥. ±«¨ ª«¾·¨ ¥±²¥±²¢¥­­® ¢®§­¨ª ¾² ª ª ·¨±«  ¢ ±¨±²¥¬¥ ±·¨±«¥­¨¿ ± ®±­®¢ ­¨¥¬ 2p , ²® ­¥µ®°®¸®
¡° ²¼ m = 2p ;1, ¯®±ª®«¼ª³ ¯°¨ ½²®¬ ®¤¨­ ª®¢®¥ µ¥¸-§­ ·¥­¨¥ ¨¬¥¾² ª«¾·¨, ®²«¨· ¾¹¨¥±¿ «¨¸¼ ¯¥°¥±² ­®¢ª®© À2p-¨·­»µ ¶¨´°Á.
®°®¸¨¥ °¥§³«¼² ²» ®¡»·­® ¯®«³· ¾²±¿, ¥±«¨ ¢»¡° ²¼ ¢ ª ·¥±²¢¥ m ¯°®±²®¥ ·¨±«®, ¤ «¥ª® ®²±²®¿¹¥¥ ®² ±²¥¯¥­¥© ¤¢®©ª¨.
³±²¼, ­ ¯°¨¬¥°, ­ ¬ ­ ¤® ¯®¬¥±²¨²¼ ¯°¨¬¥°­® 2000 § ¯¨±¥© ¢

¥¸-´³­ª¶¨¨

233

¥°¥¢®¤» ­ ¤¯¨±¥©: w bits | w ¡¨²®¢; extract p bits | ¢»¤¥«¨²¼ p
¡¨²®¢. : ­  °¨±³­ª¥ ­ ¤®  §­ ª¨ ¶¥«®© · ±²¨,
§ ¬¥­¨¢ bA  2w c ­  A  2w !!!!!!!

¥¸¨°®¢ ­¨¥ ¬¥²®¤®¬ ³¬­®¦¥­¨¿. «¾· k, ¯°¥¤±² ¢«¥­­»© ¢ ¢¨¤¥
w-¡¨²­®£® ·¨±« , ³¬­®¦ ¥²±¿ ­  w-¡¨²­®¥ ·¨±«® A  2w , £¤¥ A | ª®­±² ­²  ¨§
¨­²¥°¢ «  (0; 1).  ¯°®¨§¢¥¤¥­¨¿ ¡¥°³² ¬« ¤¸¨¥ w ¡¨²®¢,   ¨§ ½²¨µ w ¡¨²®¢
¢»¤¥«¿¾² p ±² °¸¨µ. ²® ¨ ¥±²¼ µ¥¸-§­ ·¥­¨¥ h(k).
¨±. 12.4

µ¥¸-² ¡«¨¶³ ± ¶¥¯®·ª ¬¨, ¯°¨·¥¬ ­ ± ­¥ ¯³£ ¥² ¢®§¬®¦­»© ¯¥°¥¡®° ²°¥µ ¢ °¨ ­²®¢ ¯°¨ ¯®¨±ª¥ ®²±³²±²¢³¾¹¥£® ¢ ² ¡«¨¶¥ ½«¥¬¥­² . ²® ¦, ¢®±¯®«¼§³¥¬±¿ ¬¥²®¤®¬ ¤¥«¥­¨¿ ± ®±² ²ª®¬ ¯°¨ ¤«¨­¥
µ¥¸-² ¡«¨¶» m = 701. ¨±«® 701 ¯°®±²®¥, 701  2000=3, ¨ ¤® ±²¥¯¥­¥© ¤¢®©ª¨ ®² ·¨±«  701 ²®¦¥ ¤ «¥ª®. ² «® ¡»²¼, ¬®¦­® ¢»¡° ²¼
µ¥¸-´³­ª¶¨¾ ¢¨¤ 
h(k) = k mod 701:
  ¢±¿ª¨© ±«³· © ¬®¦­® ¥¹¥ ¯®½ª±¯¥°¨¬¥­²¨°®¢ ²¼ ± °¥ «¼­»¬¨
¤ ­­»¬¨ ­  ¯°¥¤¬¥² ²®£®, ­ ±ª®«¼ª® ° ¢­®¬¥°­® ¡³¤³² ° ±¯°¥¤¥«¥­» ¨µ µ¥¸-§­ ·¥­¨¿.
12.3.2. ¬­®¦¥­¨¥
®±²°®¥­¨¥ µ¥¸-´³­ª¶¨¨ ¬¥²®¤®¬ ³¬­®¦¥­¨¿ (multiplication
method) ±®±²®¨² ¢ ±«¥¤³¾¹¥¬. ³±²¼ ª®«¨·¥±²¢® µ¥¸-§­ ·¥­¨© ° ¢­® m.  ´¨ª±¨°³¥¬ ª®­±² ­²³ A ¢ ¨­²¥°¢ «¥ 0 < A < 1, ¨ ¯®«®¦¨¬
h(k) = bm(kA mod 1)c;
£¤¥ kA mod 1 | ¤°®¡­ ¿ · ±²¼ kA.
®±²®¨­±²¢® ¬¥²®¤  ³¬­®¦¥­¨¿ ¢ ²®¬, ·²® ª ·¥±²¢® µ¥¸´³­ª¶¨¨ ¬ «® § ¢¨±¨² ®² ¢»¡®°  m. ¡»·­® ¢ ª ·¥±²¢¥ m
¢»¡¨° ¾² ±²¥¯¥­¼ ¤¢®©ª¨, ¯®±ª®«¼ª³ ¢ ¡®«¼¸¨­±²¢¥ ª®¬¯¼¾²¥°®¢
³¬­®¦¥­¨¥ ­  ² ª®¥ m °¥ «¨§³¥²±¿ ª ª ±¤¢¨£ ±«®¢ . ³±²¼, ­ ¯°¨¬¥°, ¤«¨­  ±«®¢  ¢ ­ ¸¥¬ ª®¬¯¼¾²¥°¥ ° ¢­  w ¡¨² ¬ ¨ ª«¾· k
¯®¬¥¹ ¥²±¿ ¢ ®¤­® ±«®¢®. ®£¤ , ¥±«¨ m = 2p, ²® ¢»·¨±«¥­¨¥
µ¥¸-´³­ª¶¨¨ ¬®¦­® ¯°®¢¥±²¨ ² ª: ³¬­®¦¨¬ k ­  w-¡¨²­®¥ ¶¥«®¥
·¨±«® A  2w (¬» ¯°¥¤¯®« £ ¥¬, ·²® ½²® ·¨±«® ¿¢«¿¥²±¿ ¶¥«»¬);
¯®«³·¨²±¿ 2w-¡¨²­®¥ ·¨±«®
¥²®¤ ³¬­®¦¥­¨¿ ° ¡®² ¥² ¯°¨ «¾¡®¬ ¢»¡®°¥ ª®­±² ­²» A, ­®
­¥ª®²®°»¥ §­ ·¥­¨¿ A ¬®£³² ¡»²¼ «³·¸¥ ¤°³£¨µ. ¯²¨¬ «¼­»©

234

« ¢  12 ¥¸-² ¡«¨¶»

¢»¡®° § ¢¨±¨² ®² ²®£®, ª ª®£® °®¤  ¤ ­­»¥ ¯®¤¢¥°£ ¾²±¿ µ¥¸¨°®¢ ­¨¾.  ª­¨£¥ [123] ­³² ®¡±³¦¤ ¥² ¢»¡®° ª®­±² ­²» A ¨ ¯°¨µ®¤¨² ª ¢»¢®¤³, ·²® §­ ·¥­¨¥

p
A  ( 5 ; 1)=2 = 0;6180339887 : : :

(12.2)

¿¢«¿¥²±¿ ¤®¢®«¼­® ³¤ ·­»¬.
 § ª«¾·¥­¨¥ ¯°¨¢¥¤¥¬ ¯°¨¬¥°: ¥±«¨ k = 123456, m = 10000 ¨ A
®¯°¥¤¥«¥­® ´®°¬³«®© (12.2), ²®

h(k) = b10000  (123456  0;61803 : : : mod 1)c =
= b10000  (76300;0041151 : : : mod 1)c =
= b10000  0;0041151 : : : c =
= b41;151 : : : c = 41:
12.3.3. ­¨¢¥°± «¼­®¥ µ¥¸¨°®¢ ­¨¥
±«¨ ­¥¤®¡°®¦¥« ²¥«¼ ¡³¤¥² ±¯¥¶¨ «¼­® ¯®¤¡¨° ²¼ ¤ ­­»¥ ¤«¿
µ¥¸¨°®¢ ­¨¿, ²® (§­ ¿ ´³­ª¶¨¾ h) ®­ ¬®¦¥² ³±²°®¨²¼ ² ª, ·²®
¢±¥ n ª«¾·¥© ¡³¤³² ±®®²¢¥²±²¢®¢ ²¼ ®¤­®© ¯®§¨¶¨¨ ¢ ² ¡«¨¶¥, ¢
°¥§³«¼² ²¥ ·¥£® ¢°¥¬¿ ¯®¨±ª  ¡³¤¥² ° ¢­® (n). ¾¡ ¿ ´¨ª±¨°®¢ ­­ ¿ µ¥¸-´³­ª¶¨¿ ¬®¦¥² ¡»²¼ ¤¨±ª°¥¤¨²¨°®¢ ­  ² ª¨¬ ®¡° §®¬. ¤¨­±²¢¥­­»© ¢»µ®¤ ¨§ ¯®«®¦¥­¨¿ | ¢»¡¨° ²¼ µ¥¸-´³­ª¶¨¾
±«³· ©­»¬ ®¡° §®¬, ­¥ § ¢¨±¿¹¨¬ ®² ²®£®, ª ª¨¥ ¨¬¥­­® ¤ ­­»¥
¢» µ¥¸¨°³¥²¥.  ª®© ¯®¤µ®¤ ­ §»¢ ¥²±¿ ³­¨¢¥°± «¼­»¬ µ¥¸¨°®¢ ­¨¥¬ (universal hashing). ²® ¡» ­¨ ¯°¥¤¯°¨­¨¬ « ¢ ¸ ­¥¤®¡°®¦¥« ²¥«¼, ¥±«¨ ®­ ­¥ ¨¬¥¥² ¨­´®°¬ ¶¨¨ ® ¢»¡° ­­®© µ¥¸-´³­ª¶¨¨,
±°¥¤­¥¥ ¢°¥¬¿ ¯®¨±ª  ®±² ­¥²±¿ µ®°®¸¨¬.
±­®¢­ ¿ ¨¤¥¿ ³­¨¢¥°± «¼­®£® µ¥¸¨°®¢ ­¨¿ | ¢»¡¨° ²¼ µ¥¸´³­ª¶¨¾ ¢® ¢°¥¬¿ ¨±¯®«­¥­¨¿ ¯°®£° ¬¬» ±«³· ©­»¬ ®¡° §®¬ ¨§
­¥ª®²®°®£® ¬­®¦¥±²¢ . ² «® ¡»²¼, ¯°¨ ¯®¢²®°­®¬ ¢»§®¢¥ ± ²¥¬¨
¦¥ ¢µ®¤­»¬¨ ¤ ­­»¬¨  «£®°¨²¬ ¡³¤¥² ° ¡®² ²¼ ³¦¥ ¯®-¤°³£®¬³.
 ª ¨ ¢ ±«³· ¥ ±  «£®°¨²¬®¬ ¡»±²°®© ±®°²¨°®¢ª¨, ° ­¤®¬¨§ ¶¨¿ £ ° ­²¨°³¥², ·²® ­¥«¼§¿ ¯°¨¤³¬ ²¼ ¢µ®¤­»µ ¤ ­­»µ, ­  ª®²®°»µ  «£®°¨²¬ ¢±¥£¤  ¡» ° ¡®² « ¬¥¤«¥­­® (¢ ¯°¨¬¥°¥ ± ª®¬¯¨«¿²®°®¬ ¨ ² ¡«¨¶¥© ±¨¬¢®«®¢ ­¥ ±¬®¦¥² ¯®«³·¨²¼±¿, ·²® ª ª®©-²®
®¯°¥¤¥«¥­­»© ±²¨«¼ ¢»¡®°  ¨¤¥­²¨´¨ª ²®°®¢ ¯°¨¢®¤¨² ª § ¬¥¤«¥­¨¾ ª®¬¯¨«¿¶¨¨: ¢¥°®¿²­®±²¼, ·²® ª®¬¯¨«¿¶¨¿ § ¬¥¤«¨²±¿ ¨§-§ 
­¥³¤ ·­®£® µ¥¸¨°®¢ ­¨¿, ¢®-¯¥°¢»µ, ¬ « , ¨ ¢®-¢²®°»µ, § ¢¨±¨²
²®«¼ª® ®² ª®«¨·¥±²¢  ¨¤¥­²¨´¨ª ²®°®¢, ­® ­¥ ®² ¨µ ¢»¡®° ).
³±²¼ H | ª®­¥·­®¥ ±¥¬¥©±²¢® ´³­ª¶¨©, ®²®¡° ¦ ¾¹¨µ ¤ ­­®¥ ¬­®¦¥±²¢® U (¬­®¦¥±²¢® ¢±¥¢®§¬®¦­»µ ª«¾·¥©) ¢® ¬­®¦¥±²¢® f0; 1; : : :; m ; 1g (¬­®¦¥±²¢® µ¥¸-§­ ·¥­¨©). ²® ±¥¬¥©±²¢® ­ §»¢ ¥²±¿ ³­¨¢¥°± «¼­»¬ (universal), ¥±«¨ ¤«¿ «¾¡»µ ¤¢³µ ª«¾·¥©
x; y 2 U ·¨±«® ´³­ª¶¨© h 2 H, ¤«¿ ª®²®°»µ h(x) = h(y), ° ¢­®

¥¸-´³­ª¶¨¨

235

jHj=m. ­»¬¨ ±«®¢ ¬¨, ¯°¨ ±«³· ©­®¬ ¢»¡®°¥ µ¥¸-´³­ª¶¨¨ ¢¥-

°®¿²­®±²¼ ª®««¨§¨¨ ¬¥¦¤³ ¤¢³¬¿ ¤ ­­»¬¨ ª«¾· ¬¨ ¤®«¦­  ° ¢­¿²¼±¿ ¢¥°®¿²­®±²¨ ±®¢¯ ¤¥­¨¿ ¤¢³µ ±«³· ©­® ¢»¡° ­­»µ µ¥¸§­ ·¥­¨© (ª®²®° ¿ ° ¢­  1=m).
«¥¤³¾¹ ¿ ²¥®°¥¬  ¯®ª §»¢ ¥², ·²® ³­¨¢¥°± «¼­®¥ ±¥¬¥©±²¢®
µ¥¸-´³­ª¶¨© ®¡¥±¯¥·¨¢ ¥² µ®°®¸³¾ ¯°®¨§¢®¤¨²¥«¼­®±²¼ ¢ ±°¥¤­¥¬.
¥®°¥¬  12.3. ³±²¼ ­ ¬ ­¥®¡µ®¤¨¬® ¯®¬¥±²¨²¼ n ´¨ª±¨°®¢ ­­»µ ª«¾·¥© ¢ ² ¡«¨¶³ ° §¬¥°  m, £¤¥ m > n, ¨ µ¥¸-´³­ª¶¨¿ ¢»¡¨° ¥²±¿ ±«³· ©­»¬ ®¡° §®¬ ¨§ ³­¨¢¥°± «¼­®£® ±¥¬¥©±²¢ . ®£¤ 
¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ·¨±«  ª®««¨§¨©, ¢ ª®²®°»µ ³· ±²¢³¥²
¤ ­­»© ª«¾· x, ¬¥­¼¸¥ ¥¤¨­¨¶».
®ª § ²¥«¼±²¢®.  ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ·¨±«  ª®««¨§¨© ¤ ­­®£® ª«¾·  x ± ¤ ­­»¬ ª«¾·®¬ y ° ¢­® 1=m ¯® ®¯°¥¤¥«¥­¨¾ ³­¨¢¥°± «¼­®£® ±¥¬¥©±²¢ . ®±ª®«¼ª³ ¢±¥£® ¨¬¥¥²±¿ n ; 1 ª«¾·¥©, ®²«¨·­»µ ®² x, ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ·¨±«  ª®««¨§¨© ± ª ª¨¬­¨¡³¤¼ ¨§ ½²¨µ ª«¾·¥© ° ¢­® (n ; 1)=m, ·²® ¬¥­¼¸¥ ¥¤¨­¨¶», ¯®±ª®«¼ª³ n 6 m.
 ª ¦¥ ¯®±²°®¨²¼ ³­¨¢¥°± «¼­®¥ ±¥¬¥©±²¢®?  ¬ ¯®¬®¦¥²
¢ ½²®¬ ½«¥¬¥­² °­ ¿ ²¥®°¨¿ ·¨±¥«. ¨±«® m (ª®«¨·¥±²¢® µ¥¸§­ ·¥­¨©) ¢»¡¥°¥¬ ¯°®±²»¬. ³¤¥¬ ±·¨² ²¼, ·²® ª ¦¤»© ª«¾·
¯°¥¤±² ¢«¿¥² ±®¡®© ¯®±«¥¤®¢ ²¥«¼­®±²¼ r + 1 À¡ ©²®¢Á (¡ ©², ¨«¨
±¨¬¢®«,| ½²® ¯°®±²® ¤¢®¨·­®¥ ·¨±«® ± ®£° ­¨·¥­­»¬ ·¨±«®¬
° §°¿¤®¢; ¬» ¡³¤¥¬ ±·¨² ²¼, ·²® ¬ ª±¨¬ «¼­®¥ §­ ·¥­¨¥ ¡ ©² 
¬¥­¼¸¥ m). «¿ ª ¦¤®© ¯®±«¥¤®¢ ²¥«¼­®±²¨ a = ha0 ; a1; : : :; ar i,
½«¥¬¥­²» ª®²®°®© ¿¢«¿¾²±¿ ¢»·¥² ¬¨ ¯® ¬®¤³«¾ m (²® ¥±²¼
¯°¨­ ¤«¥¦ ² ¬­®¦¥±²¢³ f0; 1; : : :; m ; 1g), ° ±±¬®²°¨¬ ´³­ª¶¨¾
ha, § ¤ ­­³¾ ´®°¬³«®©

ha(x) =

r
X
i=0

ai xi mod m;

(12.3)

£¤¥ ª«¾· x ¥±²¼ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¡ ©²®¢ hx0; x1; : : :; xr i. ®«®¦¨¬
[
H = fhag;
(12.4)
a

·¥¢¨¤­®, ¬­®¦¥±²¢® H ±®¤¥°¦¨² mr+1 ½«¥¬¥­²®¢.
¥®°¥¬  12.4. ¥¬¥©±²¢® ´³­ª¶¨© H, ®¯°¥¤¥«¥­­®¥ ¯® ´®°¬³« ¬ (12.3) ¨ (12.4), ¿¢«¿¥²±¿ ³­¨¢¥°± «¼­»¬ ±¥¬¥©±²¢®¬ µ¥¸´³­ª¶¨©.
®ª § ²¥«¼±²¢®. ³±²¼ x = hx0; x1; : : :; xr i ¨ y = hy0 ; y1; : : :; yr i |
¤¢  ° §«¨·­»µ ª«¾· ; ­¥ ®£° ­¨·¨¢ ¿ ®¡¹­®±²¨, ¬®¦­® ±·¨² ²¼,

236

« ¢  12 ¥¸-² ¡«¨¶»

·²® x0 6= y0 . ±«¨ a = ha0; a1; : : :; ar i, ²® ha (x) = ha (y ) ²®£¤  ¨
²®«¼ª® ²®£¤ , ª®£¤ 

a0 (x0 ; y0)  ;

r
X
j =1

ai (xi ; yi) (mod m):

®±ª®«¼ª³ x0 ; y0 6 0 (mod m), ¤«¿ ª ¦¤®© ¯®±«¥¤®¢ ²¥«¼­®±²¨ ha1; : : :; ar i ±³¹¥±²¢³¥² ¨ ¥¤¨­±²¢¥­­® §­ ·¥­¨¥ a0 , ¯°¨ ª®²®°®¬
½²® ° ¢¥­±²¢® ¢»¯®«­¥­® (° §¤¥« 33.4). ®«¨·¥±²¢® ² ª¨µ ¯®±«¥¤®¢ ²¥«¼­®±²¥© ° ¢­® mr , ¨ ² ª®¢® ¦¥, ±² «® ¡»²¼, ª®«¨·¥±²¢® ´³­ª¶¨© ¨§ H, ­¥ ° §«¨· ¾¹¨µ ª«¾·¨ x ¨ y . ®±ª®«¼ª³ mr = jHj=m,
¢±¥ ¤®ª § ­®.
[®°®·¥ ¬®¦­® ±ª § ²¼ ² ª: ­¥­³«¥¢®© «¨­¥©­»© ´³­ª¶¨®­ «
h 7! h(x ; y) ± ° ¢­®© ¢¥°®¿²­®±²¼¾ ¯°¨­¨¬ ¥² «¾¡®¥ ¨§ m ±¢®¨µ
§­ ·¥­¨©, ¢ ²®¬ ·¨±«¥ 0.]
¯° ¦­¥­¨¿
12.3-1 ³±²¼ ¢ ±¢¿§ ­­®¬ ±¯¨±ª¥ ª ¦¤»© ½«¥¬¥­² µ° ­¨²±¿ ¢¬¥±²¥ ± ¥£® ª«¾·®¬ k ¨ ±®®²¢¥²±²¢³¾¹¨¬ µ¥¸-§­ ·¥­¨¥¬ h(k). «¾·
¯°¥¤±² ¢«¿¥² ±®¡®© ¤«¨­­³¾ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ±¨¬¢®«®¢.  ª
¬®¦­® ³¯°®±²¨²¼ ¯®¨±ª ¢ ½²®¬ ±¯¨±ª¥ ½«¥¬¥­²  ± ¤ ­­»¬ ª«¾·®¬?
12.3-2 °¥¤¯®«®¦¨¬, ·²® ª«¾· ¬¨ ¿¢«¿¾²±¿ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ±¨¬¢®«®¢, ª®²®°»¥ ¬» ° ±±¬ ²°¨¢ ¥¬ ª ª ·¨±« , § ¯¨± ­­»¥
¢ ±¨±²¥¬¥ ±·¨±«¥­¨¿ ± ®±­®¢ ­¨¥¬ 128. ¨±«® m ¯®¬¥¹ ¥²±¿ ¢ 32¡¨²­®¬ ±«®¢¥ ± § ¯ ±®¬, ­® ·¨±« , ±®®²¢¥²±²¢³¾¹¨¥ ª«¾· ¬, ³¦¥
­¥ ¯®¬¥¹ ¾²±¿, ¯®±ª®«¼ª³ ª«¾·¨ ±®¤¥°¦ ² ¬­®£® ¤¥±¿²ª®¢ ±¨¬¢®«®¢.  ª ¢»·¨±«¨²¼ µ¥¸-´³­ª¶¨¾, ¯®±²°®¥­­³¾ ¬¥²®¤®¬ ¤¥«¥­¨¿? (¥² ­¥®¡µ®¤¨¬®±²¨ °¥ «¨§®¢»¢ ²¼  °¨´¬¥²¨·¥±ª¨¥ ®¯¥° ¶¨¨ ± ¤«¨­­»¬¨ ·¨±« ¬¨ | ¤®±² ²®·­® ¤®¯®«­¨²¥«¼­®© ¯ ¬¿²¨
¯®±²®¿­­®£® ®¡º¥¬ .)
12.3-3 ³±²¼ ª«¾·¨ ¯°¥¤±² ¢«¿¾² ±®¡®© ¯®±«¥¤®¢ ²¥«¼­®±²¨ p¡¨²­»µ ±¨¬¢®«®¢, ° ±±¬ ²°¨¢ ¥¬»¥ ª ª ·¨±«  ¢ 2p -¨·­®© ±¨±²¥¬¥
±·¨±«¥­¨¿,   ¢ ª ·¥±²¢¥ µ¥¸-´³­ª¶¨¨ ¢»¡° ­ ®±² ²®ª ¯°¨ ¤¥«¥­¨¨
­  m = 2p ; 1. ®ª ¦¨²¥, ·²® ¤¢³¬ ª«¾· ¬, ®²«¨· ¾¹¨¬±¿ ²®«¼ª® ¯®°¿¤ª®¬ ±¨¬¢®«®¢, ±®®²¢¥²±²¢³¥² ®¤­® ¨ ²® ¦¥ µ¥¸-§­ ·¥­¨¥.
°¨¢¥¤¨²¥ ¯°¨¬¥° ¯°¨«®¦¥­¨¿, ¢ ª®²®°®¬ ¯°¨¬¥­¥­¨¥ ² ª®© µ¥¸´³­ª¶¨¨ ¡»«® ¡» ­¥¦¥« ²¥«¼­®.
12.3-4 ³±²¼ ° §¬¥° µ¥¸-² ¡«¨¶» ° ¢¥­ m = 1000,
p   µ¥¸´³­ª¶¨¿ ¨¬¥¥² ¢¨¤ h(k) = bm(kA mod 1)c, £¤¥ A = ( 5 ; 1)=2.
 ª ª¨¥ ¯®§¨¶¨¨ ¯®¯ ¤³² ª«¾·¨ 61, 62, 63, 64 ¨ 65?
12.3-5 ¤ «¨¬ ¨§ ±¥¬¥©±²¢  H, ®¯°¥¤¥«¥­­®£® ¯® ´®°¬³« ¬ (12.3) ¨ (12.4), ²¥ ´³­ª¶¨¨ ha , ¢ ª®²®°»µ µ®²¿ ¡» ®¤­® ¨§ ai

²ª°»² ¿  ¤°¥± ¶¨¿

237

° ¢­  ­³«¾. ®ª ¦¨²¥, ·²® ¯®«³·¨¢¸¥¥±¿ ±¥¬¥©±²¢® µ¥¸-´³­ª¶¨©
³­¨¢¥°± «¼­»¬ ­¥ ¡³¤¥².

12.4. ²ª°»² ¿  ¤°¥± ¶¨¿
 ®²«¨·¨¥ ®² µ¥¸¨°®¢ ­¨¿ ± ¶¥¯®·ª ¬¨, ¯°¨ ®²ª°»²®©  ¤°¥± ¶¨¨ (open addressing) ­¨ª ª¨µ ±¯¨±ª®¢ ­¥²,   ¢±¥ § ¯¨±¨ µ° ­¿²±¿ ¢
± ¬®© µ¥¸-² ¡«¨¶¥: ª ¦¤ ¿ ¿·¥©ª  ² ¡«¨¶» ±®¤¥°¦¨² «¨¡® ½«¥¬¥­²
¤¨­ ¬¨·¥±ª®£® ¬­®¦¥±²¢ , «¨¡® nil. ®¨±ª § ª«¾· ¥²±¿ ¢ ²®¬, ·²®
¬» ®¯°¥¤¥«¥­­»¬ ®¡° §®¬ ¯°®±¬ ²°¨¢ ¥¬ ½«¥¬¥­²» ² ¡«¨¶», ¯®ª 
­¥ ­ ©¤¥¬ ²®, ·²® ¨¹¥¬, ¨«¨ ­¥ ³¤®±²®¢¥°¨¬±¿, ·²® ½«¥¬¥­²  ± ² ª¨¬ ª«¾·®¬ ¢ ² ¡«¨¶¥ ­¥². ¥¬ ± ¬»¬ ·¨±«® µ° ­¨¬»µ ½«¥¬¥­²®¢
­¥ ¬®¦¥² ¡»²¼ ¡®«¼¸¥ ° §¬¥°  ² ¡«¨¶»: ª®½´´¨¶¨¥­² § ¯®«­¥­¨¿
­¥ ¡®«¼¸¥ 1.
®­¥·­®, ¨ ¯°¨ µ¥¸¨°®¢ ­¨¨ ± ¶¥¯®·ª ¬¨ ¬®¦­® ¨±¯®«¼§®¢ ²¼
±¢®¡®¤­»¥ ¬¥±²  ¢ µ¥¸-² ¡«¨¶¥ ¤«¿ µ° ­¥­¨¿ ±¯¨±ª®¢ (³¯° ¦­¥­¨¥ 12.2-5), ­® ¯°¨ ®²ª°»²®©  ¤°¥± ¶¨¨ ³ª § ²¥«¨ ¢®®¡¹¥ ­¥ ¨±¯®«¼§³¾²±¿: ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¯°®±¬ ²°¨¢ ¥¬»µ ¿·¥¥ª ¢»·¨±«¿¥²±¿.   ±·¥² ½ª®­®¬¨¨ ¯ ¬¿²¨ ­  ³ª § ²¥«¿µ ¬®¦­® ³¢¥«¨·¨²¼
ª®«¨·¥±²¢® ¯®§¨¶¨© ¢ ² ¡«¨¶¥, ·²® ³¬¥­¼¸ ¥² ·¨±«® ª®««¨§¨© ¨
±®ª° ¹ ¥² ¯®¨±ª.
²®¡» ¤®¡ ¢¨²¼ ­®¢»© ½«¥¬¥­² ¢ ² ¡«¨¶³ ± ®²ª°»²®©  ¤°¥± ¶¨¥©, ¿·¥©ª¨ ª®²®°®© § ­³¬¥°®¢ ­» ¶¥«»¬¨ ·¨±« ¬¨ ®² 0 ¤® m ; 1,
¬» ¯°®±¬ ²°¨¢ ¥¬ ¥¥, ¯®ª  ­¥ ­ ©¤¥¬ ±¢®¡®¤­®¥ ¬¥±²®. ±«¨ ¢±¿ª¨© ° § ¯°®±¬ ²°¨¢ ²¼ ¿·¥©ª¨ ¯®¤°¿¤ (0; 1; : : :; m ; 1), ¯®²°¥¡³¥²±¿ ¢°¥¬¿ (n), ­® ±³²¼ ¢ ²®¬, ·²® ¯®°¿¤®ª ¯°®±¬®²°  ² ¡«¨¶»
§ ¢¨±¨² ®² ª«¾· ! ­»¬¨ ±«®¢ ¬¨, ¬» ¤®¡ ¢«¿¥¬ ª µ¥¸-´³­ª¶¨¨
¢²®°®©  °£³¬¥­² | ­®¬¥° ¯®¯»²ª¨ (­³¬¥° ¶¨¾ ­ ·¨­ ¥¬ ± ­³«¿),
² ª ·²® µ¥¸-´³­ª¶¨¿ ¨¬¥¥² ¢¨¤
h : U  f0; 1; : : :; m ; 1g ! f0; 1; : : :; m ; 1g
(U | ¬­®¦¥±²¢® ª«¾·¥©). ®±«¥¤®¢ ²¥«¼­®±²¼ ¨±¯°®¡®¢ ­­»µ
¬¥±² (probe sequence), ¨«¨ (ª®°®·¥) ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¯°®¡ ¤«¿
¤ ­­®£® ª«¾·  k ¨¬¥¥² ¢¨¤
hh(k; 0); h(k; 1); : : :; h(k; m ; 1)i;
´³­ª¶¨¿ h ¤®«¦­  ¡»²¼ ² ª®©, ·²®¡» ª ¦¤®¥ ¨§ ·¨±¥« ®² 0 ¤® m ; 1
¢±²°¥²¨«®±¼ ¢ ½²®© ¯®±«¥¤®¢ ²¥«¼­®±²¨ °®¢­® ®¤¨­ ° § (¤«¿ ª ¦¤®£® ª«¾·  ¢±¥ ¯®§¨¶¨¨ ² ¡«¨¶» ¤®«¦­» ¡»²¼ ¤®±²³¯­»). ¨¦¥
¯°¨¢®¤¨²±¿ ²¥ª±² ¯°®¶¥¤³°» ¤®¡ ¢«¥­¨¿ ¢ ² ¡«¨¶³ T ± ®²ª°»²®©
 ¤°¥± ¶¨¥©; ¢ ­¥¬ ¯®¤° §³¬¥¢ ¥²±¿, ·²® § ¯¨±¨ ­¥ ±®¤¥°¦ ² ¤®¯®«­¨²¥«¼­®© ¨­´®°¬ ¶¨¨, ª°®¬¥ ª«¾· . ±«¨ ¿·¥©ª  ² ¡«¨¶» ¯³±² , ¢ ­¥© § ¯¨± ­ nil (´¨ª±¨°®¢ ­­®¥ §­ ·¥­¨¥, ®²«¨·­®¥ ®² ¢±¥µ
ª«¾·¥©).

238

« ¢  12 ¥¸-² ¡«¨¶»

Hash-Insert(T; k)

1 i 0
2 repeat j h(k; i)
3
if T [j ] = nil
4
then T [j ] k
5
return j
6
else i i + 1
7 until i = m
8 error À¯¥°¥¯®«­¥­¨¥ µ¥¸-² ¡«¨¶»Á
°¨ ¯®¨±ª¥ ½«¥¬¥­²  ± ª«¾·®¬ k ¢ ² ¡«¨¶¥ ± ®²ª°»²®©  ¤°¥± ¶¨¥© ¿·¥©ª¨ ² ¡«¨¶» ¯°®±¬ ²°¨¢ ¾²±¿ ¢ ²®¬ ¦¥ ¯®°¿¤ª¥, ·²® ¨ ¯°¨
¤®¡ ¢«¥­¨¨ ¢ ­¥¥ ½«¥¬¥­²  ± ª«¾·®¬ k. ±«¨ ¯°¨ ½²®¬ ¬» ­ ²»ª ¥¬±¿ ­  ¿·¥©ª³, ¢ ª®²®°®© § ¯¨± ­ nil, ²® ¬®¦­® ¡»²¼ ³¢¥°¥­­»¬,
·²® ¨±ª®¬®£® ½«¥¬¥­²  ¢ ² ¡«¨¶¥ ­¥² (¨­ ·¥ ®­ ¡»« ¡» § ­¥±¥­ ¢
½²³ ¿·¥©ª³). (­¨¬ ­¨¥: ¬» ¯°¥¤¯®« £ ¥¬, ·²® ­¨ª ª¨¥ ½«¥¬¥­²»
¨§ ² ¡«¨¶» ­¥ ³¤ «¿¾²±¿!)
®² ²¥ª±² ¯°®¶¥¤³°» ¯®¨±ª  Hash-Search (¥±«¨ ½«¥¬¥­² ± ª«¾·®¬ k ±®¤¥°¦¨²±¿ ¢ ² ¡«¨¶¥ T ¢ ¯®§¨¶¨¨ j , ¯°®¶¥¤³°  ¢®§¢° ¹ ¥² j ,
¢ ¯°®²¨¢­®¬ ±«³· ¥ ®­  ¢®§¢° ¹ ¥² nil).
Hash-Search(T; k)
1 i 0
2 repeat j h(k; i)
3
if T [j ] = k
4
then return j
5
i i+1
6 until T [j ] = nil ¨«¨ i = m
7 return nil
¤ «¨²¼ ½«¥¬¥­² ¨§ ² ¡«¨¶» ± ®²ª°»²®©  ¤°¥± ¶¨¥© ­¥ ² ª ¯°®±²®. ±«¨ ¯°®±²® § ¯¨± ²¼ ­  ¥£® ¬¥±²® nil, ²® ¢ ¤ «¼­¥©¸¥¬ ¬» ­¥
±¬®¦¥¬ ­ ©²¨ ²¥ ½«¥¬¥­²», ¢ ¬®¬¥­² ¤®¡ ¢«¥­¨¿ ª®²®°»µ ¢ ² ¡«¨¶³ ½²® ¬¥±²® ¡»«® § ­¿²® (¨ ¨§-§  ½²®£® ¡»« ¢»¡° ­ ¡®«¥¥ ¤ «¥ª¨©
½«¥¬¥­² ¢ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¨±¯°®¡®¢ ­­»µ ¬¥±²). ®§¬®¦­®¥
°¥¸¥­¨¥ | § ¯¨±»¢ ²¼ ­  ¬¥±²® ³¤ «¥­­®£® ½«¥¬¥­²  ­¥ nil,   ±¯¥¶¨ «¼­®¥ §­ ·¥­¨¥ deleted (À³¤ «¥­Á), ¨ ¯°¨ ¤®¡ ¢«¥­¨¨ ° ±±¬ ²°¨¢ ²¼ ¿·¥©ª³ ± § ¯¨±¼¾ deleted ª ª ±¢®¡®¤­³¾,   ¯°¨ ¯®¨±ª¥ |
ª ª § ­¿²³¾ (¨ ¯°®¤®«¦ ²¼ ¯®¨±ª). ¥¤®±² ²®ª ½²®£® ¯®¤µ®¤  ¢
²®¬, ·²® ¢°¥¬¿ ¯®¨±ª  ¬®¦¥² ®ª § ²¼±¿ ¡®«¼¸¨¬ ¤ ¦¥ ¯°¨ ­¨§ª®¬
ª®½´´¨¶¨¥­²¥ § ¯®«­¥­¨¿. ®½²®¬³, ¥±«¨ ²°¥¡³¥²±¿ ³¤ «¿²¼ § ¯¨±¨ ¨§ µ¥¸-² ¡«¨¶», ¯°¥¤¯®·²¥­¨¥ ®¡»·­® ®²¤ ¾² µ¥¸¨°®¢ ­¨¾ ±
¶¥¯®·ª ¬¨.
 ­ ¸¥¬  ­ «¨§¥ ®²ª°»²®©  ¤°¥± ¶¨¨ ¬» ¡³¤¥¬ ¨±µ®¤¨²¼ ¨§
¯°¥¤¯®«®¦¥­¨¿, ·²® µ¥¸¨°®¢ ­¨¥ ° ¢­®¬¥°­® (uniform) ¢ ²®¬ ±¬»±«¥, ·²® ¢±¥ m! ¯¥°¥±² ­®¢®ª ¬­®¦¥±²¢  f0; 1; : : :; m ; 1g ° ¢­®¢¥-

²ª°»² ¿  ¤°¥± ¶¨¿

239

°®¿²­».   ¯° ª²¨ª¥ ½²® ¢°¿¤ «¨ ² ª, µ®²¿ ¡» ¯® ²®© ¯°¨·¨­¥,
·²® ¤«¿ ½²®£® ­¥®¡µ®¤¨¬®, ·²®¡» ·¨±«® ¢®§¬®¦­»µ ª«¾·¥© ¡»«®
ª ª ¬¨­¨¬³¬ 6 m!, £¤¥ m | ·¨±«® µ¥¸-§­ ·¥­¨©. ®½²®¬³ ®¡»·­®
¯®«¼§³¾²±¿ ¡®«¥¥ ¨«¨ ¬¥­¥¥ ³¤ ·­»¬¨ ±³°°®£ ² ¬¨, ¢°®¤¥ ®¯¨±»¢ ¥¬®£® ­¨¦¥ ¤¢®©­®£® µ¥¸¨°®¢ ­¨¿.
¡»·­® ¯°¨¬¥­¿¾² ² ª¨¥ ²°¨ ±¯®±®¡  ¢»·¨±«¥­¨¿ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¨±¯°®¡®¢ ­­»µ ¬¥±²: «¨­¥©­»©, ª¢ ¤° ²¨·­»© ¨ ¤¢®©­®¥ µ¥¸¨°®¢ ­¨¥.  ª ¦¤®¬ ¨§ ½²¨µ ±¯®±®¡®¢ ¯®±«¥¤®¢ ²¥«¼­®±²¼ hh(k; 0); h(k; 1); : : :; h(k; m ; 1)i ¡³¤¥² ¯¥°¥±² ­®¢ª®© ¬­®¦¥±²¢  f0; 1; : : :; m ; 1g ¯°¨ «¾¡®¬ §­ ·¥­¨¨ ª«¾·  k, ­® ­¨ ®¤¨­
¨§ ½²¨µ ±¯®±®¡®¢ ­¥ ¿¢«¿¥²±¿ ° ¢­®¬¥°­»¬ ¯® ²®© ¯°¨·¨­¥, ·²®
®­¨ ¤ ¾² ­¥ ¡®«¥¥ m2 ¯¥°¥±² ­®¢®ª ¨§ m! ¢®§¬®¦­»µ. ®«¼¸¥ ¢±¥£® ° §­»µ ¯¥°¥±² ­®¢®ª ¯®«³· ¥²±¿ ¯°¨ ¤¢®©­®¬ µ¥¸¨°®¢ ­¨¨; ­¥
³¤¨¢¨²¥«¼­®, ·²® ¨ ­  ¯° ª²¨ª¥ ½²®² ±¯®±®¡ ¤ ¥² «³·¸¨¥ °¥§³«¼² ²».
¨­¥©­ ¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¯°®¡
³±²¼ h0 : U ! f0; 1; : : :; m ; 1g | À®¡»·­ ¿Á µ¥¸-´³­ª¶¨¿.
³­ª¶¨¿, ®¯°¥¤¥«¿¾¹ ¿ «¨­¥©­³¾ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¯°®¡ (linear probing), § ¤ ¥²±¿ ´®°¬³«®©
h(k; i) = (h0 (k) + i) mod m:
­»¬¨ ±«®¢ ¬¨, ¯°¨ ° ¡®²¥ ± ª«¾·®¬ k ­ ·¨­ ¾² ± ¿·¥©ª¨ T [h0(k)],
  § ²¥¬ ¯¥°¥¡¨° ¾² ¿·¥©ª¨ ² ¡«¨¶» ¯®¤°¿¤: T [h0 (k) + 1]; T [h0(k) +
2]; : : : (¯®±«¥ T [m ; 1] ¯¥°¥µ®¤¿² ª T [0]). ®±ª®«¼ª³ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¯°®¡ ¯®«­®±²¼¾ ®¯°¥¤¥«¿¥²±¿ ¯¥°¢®© ¿·¥©ª®©, °¥ «¼­® ¨±¯®«¼§³¥²±¿ ¢±¥£® «¨¸¼ m ° §«¨·­»µ ¯®±«¥¤®¢ ²¥«¼­®±²¥©.
²ª°»²³¾  ¤°¥± ¶¨¾ ± «¨­¥©­®© ¯®±«¥¤®¢ ²¥«¼­®±²¼¾ ¯°®¡ «¥£ª® °¥ «¨§®¢ ²¼, ­® ³ ½²®£® ¬¥²®¤  ¥±²¼ ®¤¨­ ­¥¤®±² ²®ª: ®­ ¬®¦¥²
¯°¨¢¥±²¨ ª ®¡° §®¢ ­¨¾ ª« ±²¥°®¢, ²® ¥±²¼ ¤«¨­­»µ ¯®±«¥¤®¢ ²¥«¼­®±²¥© § ­¿²»µ ¿·¥¥ª, ¨¤³¹¨µ ¯®¤°¿¤ (¯®- ­£«¨©±ª¨ ½²® ¿¢«¥­¨¥ ­ §»¢ ¥²±¿ primary clustering). ²® ³¤«¨­¿¥² ¯®¨±ª; ¢ ± ¬®¬
¤¥«¥, ¥±«¨ ¢ ² ¡«¨¶¥ ¨§ m ¿·¥¥ª ¢±¥ ¿·¥©ª¨ ± ·¥²­»¬¨ ­®¬¥° ¬¨
§ ­¿²»,   ¿·¥©ª¨ ± ­¥·¥²­»¬¨ ­®¬¥° ¬¨ ±¢®¡®¤­», ²® ±°¥¤­¥¥ ·¨±«® ¯°®¡ ¯°¨ ¯®¨±ª¥ ½«¥¬¥­² , ®²±³²±²¢³¾¹¥£® ¢ ² ¡«¨¶¥, ¥±²¼ 1;5;
±«¨, ®¤­ ª®, ²¥ ¦¥ m=2 § ­¿²»µ ¿·¥¥ª ¨¤³² ¯®¤°¿¤, ²® ±°¥¤­¥¥
·¨±«® ¯°®¡ ¯°¨¬¥°­® ° ¢­® m=8 = n=4 (n | ·¨±«® § ­¿²»µ ¬¥±²
¢ ² ¡«¨¶¥). ¥­¤¥­¶¨¿ ª ®¡° §®¢ ­¨¾ ª« ±²¥°®¢ ®¡º¿±­¿¥²±¿ ¯°®±²®: ¥±«¨ i § ¯®«­¥­­»µ ¿·¥¥ª ¨¤³² ¯®¤°¿¤, ¢¥°®¿²­®±²¼ ²®£®, ·²®
¯°¨ ®·¥°¥¤­®© ¢±² ¢ª¥ ¢ ² ¡«¨¶³ ¡³¤¥² ¨±¯®«¼§®¢ ­  ¿·¥©ª , ±«¥¤³¾¹ ¿ ­¥¯®±°¥¤±²¢¥­­® §  ­¨¬¨, ¥±²¼ (i + 1)=m, ¢ ²® ¢°¥¬¿ ª ª
¤«¿ ±¢®¡®¤­®© ¿·¥©ª¨, ¯°¥¤¸¥±²¢¥­­¨¶  ª®²®°®© ² ª¦¥ ±¢®¡®¤­ ,
¢¥°®¿²­®±²¼ ¡»²¼ ¨±¯®«¼§®¢ ­­®© ° ¢­  ¢±¥£® «¨¸¼ 1=m. ±¥ ¢»¸¥¨§«®¦¥­­®¥ ¯®ª §»¢ ¥², ·²® «¨­¥©­ ¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¯°®¡
¤®¢®«¼­® ¤ «¥ª  ®² ° ¢­®¬¥°­®£® µ¥¸¨°®¢ ­¨¿.

240

« ¢  12 ¥¸-² ¡«¨¶»

¢ ¤° ²¨·­ ¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¯°®¡
³­ª¶¨¿, ®¯°¥¤¥«¿¾¹ ¿ ª¢ ¤° ²¨·­³¾ ¯®±«¥¤®¢ ²¥«¼­®±²¼
¯°®¡ (quadratic probing), § ¤ ¥²±¿ ´®°¬³«®©
h(k; i) = (h0 (k) + c1i + c2i2) mod m;
(12.5)
£¤¥ ¯®-¯°¥¦­¥¬³ h0 | ®¡»·­ ¿ µ¥¸-´³­ª¶¨¿,   c1 ¨ c2 6= 0 | ­¥ª®²®°»¥ ª®­±² ­²». °®¡» ­ ·¨­ ¾²±¿ ± ¿·¥©ª¨ ­®¬¥° T [h0 (k)], ª ª
¨ ¯°¨ «¨­¥©­®¬ ¬¥²®¤¥, ­® ¤ «¼¸¥ ¿·¥©ª¨ ¯°®±¬ ²°¨¢ ¾²±¿ ­¥
¯®¤°¿¤: ­®¬¥° ¯°®¡³¥¬®© ¿·¥©ª¨ ª¢ ¤° ²¨·­® § ¢¨±¨² ®² ­®¬¥° 
¯®¯»²ª¨. ²®² ¬¥²®¤ ° ¡®² ¥² §­ ·¨²¥«¼­® «³·¸¥, ·¥¬ «¨­¥©­»©,
­® ¥±«¨ ¬» µ®²¨¬, ·²®¡» ¯°¨ ¯°®±¬®²°¥ µ¥¸-² ¡«¨¶» ¨±¯®«¼§®¢ «¨±¼ ¢±¥ ¿·¥©ª¨, §­ ·¥­¨¿ m, c1 ¨ c2 ­¥«¼§¿ ¢»¡¨° ²¼ ª ª ¯®¯ «®;
®¤¨­ ¨§ ±¯®±®¡®¢ ¢»¡®°  ®¯¨± ­ ¢ § ¤ ·¥ 12-4.  ª ¨ ¯°¨ «¨­¥©­®¬
¬¥²®¤¥, ¢±¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¯°®¡ ®¯°¥¤¥«¿¥²±¿ ±¢®¨¬ ¯¥°¢»¬
·«¥­®¬, ² ª ·²® ®¯¿²¼ ¯®«³· ¥²±¿ ¢±¥£® m ° §«¨·­»µ ¯¥°¥±² ­®¢®ª. ¥­¤¥­¶¨¨ ª ®¡° §®¢ ­¨¾ ª« ±²¥°®¢ ¡®«¼¸¥ ­¥², ­®  ­ «®£¨·­»© ½´´¥ª² ¯°®¿¢«¿¥²±¿ ¢ (¡®«¥¥ ¬¿£ª®©) ´®°¬¥ ®¡° §®¢ ­¨¿
¢²®°¨·­»µ ª« ±²¥°®¢ (secondary clustering).
¢®©­®¥ µ¥¸¨°®¢ ­¨¥
¢®©­®¥ µ¥¸¨°®¢ ­¨¥ (double hashing) | ®¤¨­ ¨§ «³·¸¨µ ¬¥²®¤®¢ ®²ª°»²®©  ¤°¥± ¶¨¨. ¥°¥±² ­®¢ª¨ ¨­¤¥ª±®¢, ¢®§­¨ª ¾¹¨¥
¯°¨ ¤¢®©­®¬ µ¥¸¨°®¢ ­¨¨, ®¡« ¤ ¾² ¬­®£¨¬¨ ±¢®©±²¢ ¬¨, ¯°¨±³¹¨¬¨ ° ¢­®¬¥°­®¬³ µ¥¸¨°®¢ ­¨¾. °¨ ¤¢®©­®¬ µ¥¸¨°®¢ ­¨¨
´³­ª¶¨¿ h ¨¬¥¥² ¢¨¤
h(k; i) = (h1(k) + ih2(k)) mod m;
£¤¥ h1 ¨ h2 | ®¡»·­»¥ µ¥¸-´³­ª¶¨¨. ­»¬¨ ±«®¢ ¬¨, ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¯°®¡ ¯°¨ ° ¡®²¥ ± ª«¾·®¬ k ¯°¥¤±² ¢«¿¥² ±®¡®©  °¨´¬¥²¨·¥±ª³¾ ¯°®£°¥±±¨¾ (¯® ¬®¤³«¾ m) ± ¯¥°¢»¬ ·«¥­®¬ h1 (k) ¨
¸ £®¬ h2 (k). °¨¬¥° ¤¢®©­®£® µ¥¸¨°®¢ ­¨¿ ¯°¨¢¥¤¥­ ­  °¨±. 12.5.
²®¡» ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¨±¯°®¡®¢ ­­»µ ¬¥±² ¯®ª°»«  ¢±¾ ² ¡«¨¶³, §­ ·¥­¨¥ h2 (k) ¤®«¦­® ¡»²¼ ¢§ ¨¬­® ¯°®±²»¬ ± m (¥±«¨
­ ¨¡®«¼¸¨© ®¡¹¨© ¤¥«¨²¥«¼ h2(k) ¨ m ¥±²¼ d, ²®  °¨´¬¥²¨·¥±ª ¿
¯°®£°¥±±¨¿ ¯® ¬®¤³«¾ m ± ° §­®±²¼¾ h2 (k) § ©¬¥² ¤®«¾ 1=d ¢
² ¡«¨¶¥; ±¬. £« ¢³ 33). °®±²®© ±¯®±®¡ ¤®¡¨²¼±¿ ¢»¯®«­¥­¨¿ ½²®£® ³±«®¢¨¿ | ¢»¡° ²¼ ¢ ª ·¥±²¢¥ m ±²¥¯¥­¼ ¤¢®©ª¨,   ´³­ª¶¨¾
h2 ¢§¿²¼ ² ª³¾, ·²®¡» ®­  ¯°¨­¨¬ «  ²®«¼ª® ­¥·¥²­»¥ §­ ·¥­¨¿.
°³£®© ¢ °¨ ­²: m | ¯°®±²®¥ ·¨±«®, §­ ·¥­¨¿ h2 | ¶¥«»¥ ¯®«®¦¨²¥«¼­»¥ ·¨±« , ¬¥­¼¸¨¥ m.  ¯°¨¬¥°, ¤«¿ ¯°®±²®£® m ¬®¦­®
¯®«®¦¨²¼
h1 (k) = k mod m;
h2 (k) = 1 + (k mod m0);

²ª°»² ¿  ¤°¥± ¶¨¿

241

®¡ ¢«¥­¨¥ ½«¥¬¥­²  ¢ ² ¡«¨¶³ ± ®²ª°»²®©  ¤°¥± ¶¨¥© ¯°¨ ¤¢®©­®¬
µ¥¸¨°®¢ ­¨¨.  ­ ¸¥¬ ±«³· ¥ m = 13, h1 (k) = k mod 13, h2 (k) = 1+(k mod 11).
±«¨ k = 14, ²® ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¯°®¡ ¡³¤¥² ² ª ¿: 1 ¨ 5 § ­¿²», 9 ±¢®¡®¤­®,
¯®¬¥¹ ¥¬ ²³¤ .
¨±. 12.5

£¤¥ m0 ·³²¼ ¬¥­¼¸¥, ·¥¬ m (­ ¯°¨¬¥°, m0 = m ; 1 ¨«¨ m ; 2).
±«¨, ­ ¯°¨¬¥°, m = 701, m0 = 700 ¨ k = 123456, ²® h1 (k) = 80
¨ h2 (k) = 257. ² «® ¡»²¼, ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¯°®¡ ­ ·¨­ ¥²±¿ ±
¯®§¨¶¨¨ ­®¬¥° 80 ¨ ¨¤¥² ¤ «¥¥ ± ¸ £®¬ 257, ¯®ª  ¢±¿ ² ¡«¨¶  ­¥
¡³¤¥² ¯°®±¬®²°¥­  (¨«¨ ­¥ ¡³¤¥² ­ ©¤¥­® ­³¦­®¥ ¬¥±²®).
 ®²«¨·¨¥ ®² «¨­¥©­®£® ¨ ª¢ ¤° ²¨·­®£® ¬¥²®¤®¢, ¯°¨ ¤¢®©­®¬
µ¥¸¨°®¢ ­¨¨ ¬®¦­® ¯®«³·¨²¼ (¯°¨ ¯° ¢¨«¼­®¬ ¢»¡®°¥ h1 ¨ h2 )
­¥ m,   (m2) ° §«¨·­»µ ¯¥°¥±² ­®¢®ª, ¯®±ª®«¼ª³ ª ¦¤®© ¯ °¥ (h1 (k); h2(k)) ±®®²¢¥²±²¢³¥² ±¢®¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¯°®¡. « £®¤ °¿ ½²®¬³ ¯°®¨§¢®¤¨²¥«¼­®±²¼ ¤¢®©­®£® µ¥¸¨°®¢ ­¨¿ ¡«¨§ª  ª
²®©, ·²® ¯®«³·¨« ±¼ ¡» ¯°¨ ­ ±²®¿¹¥¬ ° ¢­®¬¥°­®¬ µ¥¸¨°®¢ ­¨¨.
­ «¨§ µ¥¸¨°®¢ ­¨¿ ± ®²ª°»²®©  ¤°¥± ¶¨¥©
 ª ¦¥, ª ª ¨ ¯°¨  ­ «¨§¥ µ¥¸¨°®¢ ­¨¿ ± ¶¥¯®·ª ¬¨, ¯°¨  ­ «¨§¥
®²ª°»²®©  ¤°¥± ¶¨¨ ¬» ¡³¤¥¬ ®¶¥­¨¢ ²¼ ±²®¨¬®±²¼ ®¯¥° ¶¨© ¢
²¥°¬¨­ µ ª®½´´¨¶¨¥­²  § ¯®«­¥­¨¿  = n=m (n | ·¨±«® § ¯¨±¥©,
m | ° §¬¥° ² ¡«¨¶»). ®±ª®«¼ª³ ¯°¨ ®²ª°»²®©  ¤°¥± ¶¨¨ ª ¦¤®©
¿·¥©ª¥ ±®®²¢¥²±²¢³¥² ­¥ ¡®«¥¥ ®¤­®© § ¯¨±¨,  6 1.
» ¡³¤¥¬ ¨±µ®¤¨²¼ ¨§ ¯°¥¤¯®«®¦¥­¨¿ ® ° ¢­®¬¥°­®±²¨ µ¥¸¨°®¢ ­¨¿.  ½²®© ¨¤¥ «¨§¨°®¢ ­­®© ±µ¥¬¥ ¯°¥¤¯®« £ ¥²±¿ ±«¥¤³¾¹¥¥:
¬» ¢»¡¨° ¥¬ ª«¾·¨ ±«³· ©­»¬ ®¡° §®¬, ¯°¨·¥¬ ¢±¥ m! ¢®§¬®¦­»µ
¯®±«¥¤®¢ ²¥«¼­®±²¥© ¯°®¡ ° ¢­®¢¥°®¿²­». ®±ª®«¼ª³ ½²  ¨¤¥ «¨§¨°®¢ ­­ ¿ ±µ¥¬  ¤ «¥ª  ®² °¥ «¼­®±²¨, ¤®ª §»¢ ¥¬»¥ ­¨¦¥ °¥§³«¼² ²» ±«¥¤³¥² ° ±±¬ ²°¨¢ ²¼ ­¥ ª ª ¬ ²¥¬ ²¨·¥±ª¨¥ ²¥®°¥¬»,
®¯¨±»¢ ¾¹¨¥ ° ¡®²³ °¥ «¼­»µ  «£®°¨²¬®¢ ®²ª°»²®©  ¤°¥± ¶¨¨,

242

« ¢  12 ¥¸-² ¡«¨¶»

  ª ª ½¢°¨±²¨·¥±ª¨¥ ®¶¥­ª¨.
 ·­¥¬ ± ²®£®, ·²® ®¶¥­¨¬ ¢°¥¬¿ ­  ¯®¨±ª ½«¥¬¥­² , ®²±³²±²¢³¾¹¥£® ¢ ² ¡«¨¶¥.
¥®°¥¬  12.5.  ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ·¨±«  ¯°®¡ ¯°¨ ¯®¨±ª¥
¢ ² ¡«¨¶¥ ± ®²ª°»²®©  ¤°¥± ¶¨¥© ®²±³²±²¢³¾¹¥£® ¢ ­¥© ½«¥¬¥­²  ­¥ ¯°¥¢®±µ®¤¨² 1=(1 ; ) (µ¥¸¨°®¢ ­¨¥ ¯°¥¤¯®« £ ¥²±¿ ° ¢­®¬¥°­»¬, ·¥°¥§  < 1 ®¡®§­ ·¥­ ª®½´´¨¶¨¥­² § ¯®«­¥­¨¿).
®ª § ²¥«¼±²¢®. » ¯°¥¤¯®« £ ¥¬, ·²® ² ¡«¨¶  ´¨ª±¨°®¢ ­ ,  
¨±ª®¬»© ½«¥¬¥­² ¢»¡¨° ¥²±¿ ±«³· ©­®, ¯°¨·¥¬ ¢±¥ ¢®§¬®¦­»¥ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¯°®¡ ° ¢­®¢¥°®¿²­».  ± ¨­²¥°¥±³¥² ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ·¨±«  ¯®¯»²®ª, ­¥®¡µ®¤¨¬»µ ¤«¿ ®¡­ °³¦¥­¨¿
±¢®¡®¤­®© ¿·¥©ª¨, ²® ¥±²¼ ±³¬¬ 
1+

1
X
i=0

ipi:

(12.6)

£¤¥ pi | ¢¥°®¿²­®±²¼ ²®£®, ·²® ¬» ¢±²°¥²¨¬ °®¢­® i § ­¿²»µ ¿·¥¥ª.
 ¦¤ ¿ ­®¢ ¿ ¯°®¡  ¢»¡¨° ¥²±¿ ° ¢­®¬¥°­® ±°¥¤¨ ®±² ¢¸¨µ±¿ ­¥ ¨±¯°®¡®¢ ­­»¬¨ ¿·¥¥ª; ¥±«¨ ° §°¥¸¨²¼ ¯°®¡®¢ ²¼ ¯®¢²®°­®
³¦¥ ¨±¯°®¡®¢ ­­»¥ ¿·¥©ª¨, ²® · ±²¼ ¯°®¡ ¯°®¯ ¤¥² §°¿ ¨ ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ²®«¼ª® ³¢¥«¨·¨²±¿. ® ¤«¿ ½²®£® ­®¢®£® ¢ °¨ ­²  ¬» ³¦¥ ¢»·¨±«¿«¨ ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ (° §¤¥« 6.4,
£¥®¬¥²°¨·¥±ª®¥ ° ±¯°¥¤¥«¥­¨¥), ¨ ®­® ° ¢­®
1=(1 ; )

(12.7)

¯®±ª®«¼ª³ ¢¥°®¿²­®±²¼ ³±¯¥µ  ¤«¿ ª ¦¤®© ¯°®¡» ° ¢­  1 ; .
±«¨ ª®½´´¨¶¨¥­² § ¯®«­¥­¨¿ ®²¤¥«¥­ ®² ¥¤¨­¨¶», ²¥®°¥¬  12.5
¯°¥¤±ª §»¢ ¥², ·²® ¯®¨±ª ®²±³²±²¢³¾¹¥£® ½«¥¬¥­²  ¡³¤¥² ¢ ±°¥¤­¥¬ ¯°®µ®¤¨²¼ §  ¢°¥¬¿ O(1).  ¯°¨¬¥°, ¥±«¨ ² ¡«¨¶  § ¯®«­¥­ 
­ ¯®«®¢¨­³, ²® ±°¥¤­¥¥ ·¨±«® ¯°®¡ ¡³¤¥² ­¥ ¡®«¼¸¥ 1=(1 ; 0;5) = 2,
  ¥±«¨ ­  90%, ²® ­¥ ¡®«¼¸¥ 1=(1 ; 0;9) = 10.
§ ²¥®°¥¬» 12.5 ­¥¬¥¤«¥­­® ¯®«³· ¥²±¿ ¨ ®¶¥­ª  ­  ±²®¨¬®±²¼
®¯¥° ¶¨¨ ¤®¡ ¢«¥­¨¿ ª ² ¡«¨¶¥:
«¥¤±²¢¨¥ 12.6.  ¯°¥¤¯®«®¦¥­¨¨ ° ¢­®¬¥°­®£® µ¥¸¨°®¢ ­¨¿ ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ·¨±«  ¯°®¡ ¯°¨ ¤®¡ ¢«¥­¨¨ ­®¢®£® ½«¥¬¥­²  ¢ ² ¡«¨¶³ ± ®²ª°»²®©  ¤°¥± ¶¨¥© ­¥ ¯°¥¢®±µ®¤¨² 1=(1 ; ), £¤¥
 < 1 | ª®½´´¨¶¨¥­² § ¯®«­¥­¨¿.
®ª § ²¥«¼±²¢®. °¨ ¤®¡ ¢«¥­¨¨ ¢ ² ¡«¨¶³ ®²±³²±²¢³¾¹¥£® ¢
­¥© ½«¥¬¥­²  ¯°®¨±µ®¤¿² ²¥ ¦¥ ¯°®¡», ·²® ¯°¨ ¯®¨±ª¥ ®²±³²±²¢³¾¹¥£® ¢ ¢ ­¥© ½«¥¬¥­² .
¶¥­¨²¼ ±°¥¤­¥¥ ¢°¥¬¿ ³±¯¥¸­®£® ¯®¨±ª  ­¥¬­®£¨¬ ±«®¦­¥¥.

²ª°»² ¿  ¤°¥± ¶¨¿

243

¥®°¥¬  12.7.  ±±¬®²°¨¬ ² ¡«¨¶³ ± ®²ª°»²®©  ¤°¥± ¶¨¥©, ª®½´´¨¶¨¥­² § ¯®«­¥­¨¿ ª®²®°®© ° ¢¥­  < 1. ³±²¼ µ¥¸¨°®¢ ­¨¥ ° ¢­®¬¥°­®. ®£¤  ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ·¨±«  ¯°®¡ ¯°¨
³±¯¥¸­®¬ ¯®¨±ª¥ ½«¥¬¥­²  ¢ ² ¡«¨¶¥ ­¥ ¯°¥¢®±µ®¤¨²
1 ln 1 ;
 1;
¥±«¨ ±·¨² ²¼, ·²® ª«¾· ¤«¿ ³±¯¥¸­®£® ¯®¨±ª  ¢ ² ¡«¨¶¥ ¢»¡¨° ¥²±¿ ±«³· ©­»¬ ®¡° §®¬ ¨ ¢±¥ ² ª¨¥ ¢»¡®°» ° ¢­®¢¥°®¿²­».
®ª § ²¥«¼±²¢®. ²®·­¨¬, ª ª ¯°®¨§¢®¤¨²±¿ ³±°¥¤­¥­¨¥: ±­ · « 
¬» § ¯®«­¿¥¬ ² ¡«¨¶³ ­¥§ ¢¨±¨¬® ¢»¡¨° ¥¬»¬¨ ª«¾· ¬¨, ¯°¨·¥¬
¤«¿ ª ¦¤®£® ¨§ ­¨µ ¢»¯®«­¿¥²±¿ ¯°¥¤¯®«®¦¥­¨¥ ° ¢­®¬¥°­®£® µ¥¸¨°®¢ ­¨¿.  ²¥¬ ¬» ³±°¥¤­¿¥¬ ¯® ¢±¥¬ ½«¥¬¥­² ¬ ² ¡«¨¶» ¢°¥¬¿
¨µ ¯®¨±ª .
 ¬¥²¨¬, ·²® ¯°¨ ³±¯¥¸­®¬ ¯®¨±ª¥ ª«¾·  k ¬» ¤¥« ¥¬ ²¥ ¦¥
± ¬»¥ ¯°®¡», ª®²®°»¥ ¯°®¨§¢®¤¨«¨±¼ ¯°¨ ¯®¬¥¹¥­¨¨ ª«¾·  k ¢
² ¡«¨¶³. ¥¬ ± ¬»¬ ±°¥¤­¥¥ ·¨±«® ¯°®¡ ¯°¨ ¯®¨±ª¥ (³±°¥¤­¥­¨¥ ¯®
½«¥¬¥­² ¬) ° ¢­® ®¡¹¥¬³ ·¨±«³ ¯°®¡ ¯°¨ ¤®¡ ¢«¥­¨¨, ¤¥«¥­­®¬³ ­ 
·¨±«® ½«¥¬¥­²®¢ ¢ ² ¡«¨¶¥, ª®²®°®¥ ¬» ®¡®§­ · ¥¬ n.  ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ®¡¹¥£® ·¨±«  ¯°®¡ ¯°¨ ¤®¡ ¢«¥­¨¨ ° ¢­® ±³¬¬¥
¬ ²¥¬ ²¨·¥±ª¨µ ®¦¨¤ ­¨© ¤«¿ ª ¦¤®£® ®²¤¥«¼­®£® ¸ £ .  ¬®¬¥­²³ ¤®¡ ¢«¥­¨¿ (i+1)-£® ½«¥¬¥­²  ¢ ² ¡«¨¶¥ § ¯®«­¥­® i ¯®§¨¶¨©,
ª®½´´¨¶¨¥­² § ¯®«­¥­¨¿ ° ¢¥­ i=m (m | ·¨±«® ¬¥±² ¢ ² ¡«¨¶¥),
¨ ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ­¥ ¡®«¼¸¥ 1=(1 ; i=m) = m=(m ; i).
®½²®¬³ ±³¬¬  ¬ ²¥¬ ²¨·¥±ª¨µ ®¦¨¤ ­¨© ­¥ ¯°¥¢®±µ®¤¨²

m + m + m + :::+ m :
m m;1 m;2
m;n+1
²  ±³¬¬  ° ¢­  m  (1=(m ; n + 1) + : : : + 1=(m ; 1) + 1=m) ¨
®¶¥­¨¢ ¥²±¿ ±¢¥°µ³ ± ¯®¬®¹¼¾ ¨­²¥£° «  (3.10):

m

Zm

m;n

1 dt = m ln(m=(m ; n)):

t

±¯®¬¨­ ¿, ·²® ®¡¹¥¥ ·¨±«® ®¯¥° ¶¨© ­ ¤® ¯®¤¥«¨²¼ ­  n, ¯®«³· ¥¬ ®¶¥­ª³ (m=n) ln(m=(m ; n)) = (1=) ln(1=(1 ; )).
±«¨, ­ ¯°¨¬¥°, ² ¡«¨¶  § ¯®«­¥­  ­ ¯®«®¢¨­³, ²® ±°¥¤­¥¥ ·¨±«®
¯°®¡ ¤«¿ ³±¯¥¸­®£® ¯®¨±ª  ­¥ ¯°¥¢®±µ®¤¨² 1;387,   ¥±«¨ ­  90%,
²® 2;559.
¯° ¦­¥­¨¿
12.4-1 »¯®«­¨²¥ ¤®¡ ¢«¥­¨¥ ª«¾·¥© 10; 22; 31; 4; 15; 28; 17; 88; 59
(¢ ³ª § ­­®¬ ¯®°¿¤ª¥) ¢ µ¥¸-² ¡«¨¶³ ± ®²ª°»²®©  ¤°¥± ¶¨¥© ° §-

244

« ¢  12 ¥¸-² ¡«¨¶»

¬¥°  m = 11. «¿ ¢»·¨±«¥­¨¿ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¯°®¡ ¨±¯®«¼§³¥²±¿ «¨­¥©­»© ¬¥²®¤ ± h0 (k) = k mod m. »¯®«­¨²¥ ²® ¦¥ § ¤ ­¨¥, ¥±«¨ ¨±¯®«¼§³¥²±¿ ª¢ ¤° ²¨·­»© ¬¥²®¤ ± ²®© ¦¥ h0, c1 = 1,
c2 = 3,   ² ª¦¥ ¤«¿ ¤¢®©­®£® µ¥¸¨°®¢ ­¨¿ ± h1 = h0 ¨ h2 (k) =
1 + (k mod (m ; 1)).
12.4-2  ¯¨¸¨²¥ ¯°®¶¥¤³°³ Hash-Delete ¤«¿ ³¤ «¥­¨¿ ½«¥¬¥­²  ¨§ ² ¡«¨¶» ± ®²ª°»²®©  ¤°¥± ¶¨¥©, °¥ «¨§³¾¹³¾ ®¯¨± ­­³¾
±µ¥¬³ (±® §­ ·¥­¨¥¬ deleted), ¨ ¯¥°¥¯¨¸¨²¥ ±®®²¢¥²±²¢³¾¹¨¬
®¡° §®¬ ¯°®¶¥¤³°» Hash-Insert ¨ Hash-Search.
12.4-3? ®ª ¦¨²¥, ·²® ¯°¨ ¤¢®©­®¬ µ¥¸¨°®¢ ­¨¨ (h(k; i) =
(h1 (k) + ih2(k)) mod m) ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¯°®¡, ±®®²¢¥²±²¢³¾¹ ¿ ª«¾·³ k, ¿¢«¿¥²±¿ ¯¥°¥±² ­®¢ª®© ¬­®¦¥±²¢  f0; 1; : : :; m ; 1g
²®£¤  ¨ ²®«¼ª® ²®£¤ , ª®£¤  h2 (k) ¢§ ¨¬­® ¯°®±²® ± m. (ª § ­¨¥:
±¬. £« ¢³ 33.)
12.4-4  ©¤¨²¥ ·¨±«¥­­»¥ §­ ·¥­¨¿ ¢¥°µ­¨µ ®¶¥­®ª ²¥®°¥¬ 12.5
¨ 12.7 ¤«¿ ¯®¨±ª¥ ¯°¨±³²±²¢³¾¹¥£® ¨ ®²±³²±²¢³¾¹¥£® ½«¥¬¥­²®¢
¤«¿ ª®½´´¨¶¨¥­²®¢ § ¯®«­¥­¨¿ 1=2, 3=4 ¨ 7=8.
12.4-5? °¥¤¯®«®¦¨¬, ·²® ¬» ¯®¬¥¹ ¥¬ n § ¯¨±¥© ¢ ² ¡«¨¶³ ±
®²ª°»²®©  ¤°¥± ¶¨¥©; ° §¬¥° ² ¡«¨¶» ° ¢¥­ m, µ¥¸¨°®¢ ­¨¥ ° ¢­®¬¥°­®, ª«¾·¨ § ¯¨±¥© ¢»¡¨° ¾²±¿ ±«³· ©­»¬ ®¡° §®¬. ¡®§­ ·¨¬ ·¥°¥§ p(n; m) ¢¥°®¿²­®±²¼ ²®£®, ·²® ¯°¨ ½²®¬ ­¥ ¯°®¨§®©¤¥²
ª®««¨§¨©. ®ª ¦¨²¥, ·²® p(n; m) 6 e;n(n;1)=2m . (ª § ­¨¥: ±¬. ­¥° ¢¥­±²¢®
(2.7).) ²  ¢¥«¨·¨­  ®·¥­¼ ¬ « , ª®£¤  n § ¬¥²­® ¡®«¼p
¸¥ n.
12.4-6?  ±²¨·­»¥ ±³¬¬» £ °¬®­¨·¥±ª®£® °¿¤  ¬®¦­® ®¶¥­¨²¼
² ª:

Hn = ln n +  + 2"n ;

(12.8)

£¤¥  = 0;5772156649 : : : | ² ª ­ §»¢ ¥¬ ¿ ¯®±²®¿­­ ¿ ©«¥°  (Euler's constant) ¨ 0 < " < 1 (¤®ª § ²¥«¼±²¢® ±¬. ¢ ª­¨£¥ ­³²  [121]).
 ª ¨±¯®«¼§®¢ ²¼ ½²® ¤«¿ ®¶¥­ª¨ ª³±ª  £ °¬®­¨·¥±ª®£® °¿¤  ¢ ¤®ª § ²¥«¼±²¢¥ ²¥®°¥¬» 12.7?
12.4-7?  ©¤¨²¥ ­¥­³«¥¢®¥ §­ ·¥­¨¥ ª®½´´¨¶¨¥­²  § ¯®«­¥­¨¿ ,
¯°¨ ª®²®°®¬ ®¶¥­ª  ±°¥¤­¥£® ·¨±«  ¯°®¡ ¯°¨ ¯®¨±ª¥ ®²±³²±²¢³¾¹¥£® ½«¥¬¥­²  (²¥®°¥¬  12.5) ¢¤¢®¥ ¯°¥¢®±µ®¤¨² ®¶¥­ª³ ±°¥¤­¥£®
·¨±«  ¯°®¡ ¯°¨ ³±¯¥¸­®¬ ¯®¨±ª¥ (²¥®°¥¬  12.7).

 ¤ ·¨ ª £« ¢¥ 12

245

 ¤ ·¨
12-1  ¨¡®«¼¸¥¥ ·¨±«® ¯°®¡ ¯°¨ ¤®¡ ¢«¥­¨¨ ½«¥¬¥­² 
 ±±¬®²°¨¬ µ¥¸-² ¡«¨¶³ ± ®²ª°»²®©  ¤°¥± ¶¨¥© ° §¬¥°  m, ¢
ª®²®°³¾ ®¤¨­ §  ¤°³£¨¬ ¯®¬¥¹ ¾²±¿ n ª«¾·¥©, ¯°¨·¥¬ n 6 m=2.
°¥¤¯®«®¦¨¬, ·²® µ¥¸¨°®¢ ­¨¥ ° ¢­®¬¥°­®.
 . ®ª ¦¨²¥, ·²® ¤«¿ «¾¡®£® i = 1; 2; : : :; n ¢¥°®¿²­®±²¼ ²®£®, ·²®
¯°¨ ¤®¡ ¢«¥­¨¨ i-£® ª«¾·  ¢ ² ¡«¨¶³ ¯°®¨§®¸«® ¡®«¥¥ k ¯°®¡,
­¥ ¯°¥¢®±µ®¤¨² 2;k .
¡. ®ª ¦¨²¥, ·²® ¤«¿ «¾¡®£® i = 1; 2; : : :; n ¢¥°®¿²­®±²¼ ²®£®, ·²®
¯°¨ ¤®¡ ¢«¥­¨¨ i-£® ª«¾·  ¢ ² ¡«¨¶³ ¯°®¨§®¸«® ¡®«¥¥ 2 lg n
¯°®¡, ­¥ ¯°¥¢®±µ®¤¨² 1=n2 .
³±²¼ X | ±«³· ©­ ¿ ¢¥«¨·¨­ , ° ¢­ ¿ ¬ ª±¨¬ «¼­®¬³ ·¨±«³ ¯°®¡
¯°¨ ¤®¡ ¢«¥­¨¨ ½«¥¬¥­²®¢ ± ­®¬¥° ¬¨ 1; 2; : : :; n.
¢. ®ª ¦¨²¥, ·²® PfX > 2 lg ng 6 1=n.
£. ®ª ¦¨²¥, ·²® ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ¢¥«¨·¨­» X (­ ¨¡®«¼¸¥£® ·¨±«  ¯°®¡) ¥±²¼ O(lg n).
12-2 ®¨±ª ¢ ­¥¨§¬¥­¿¾¹¥¬±¿ ¬­®¦¥±²¢¥
³±²¼ ¬» ° ¡®² ¥¬ ± ¬­®¦¥±²¢®¬ ¨§ n ½«¥¬¥­²®¢, ¢ ª®²®°®¬
ª«¾·¨ ¿¢«¿¾²±¿ ·¨±« ¬¨,   ¥¤¨­±²¢¥­­ ¿ ®¯¥° ¶¨¿, ª®²®°³¾ ­ ¤®
¯®¤¤¥°¦¨¢ ²¼, | ½²® ¯®¨±ª (½«¥¬¥­²» ­¥ ¤®¡ ¢«¿¾²±¿ ¨ ­¥ ³¤ «¿¾²±¿). °¥¡³¥²±¿ °¥ «¨§®¢ ²¼ ¯®¨±ª ¬ ª±¨¬ «¼­® ½´´¥ª²¨¢­® (¤®
²®£®, ª ª ­ ·­³² ¯®±²³¯ ²¼ § ¯°®±» ­  ¯®¨±ª, ¬­®¦¥±²¢® ¬®¦­®
¯°¥¤¢ °¨²¥«¼­® ®¡° ¡®² ²¼, ¨ ¢°¥¬¿ ­  ² ª³¾ ®¡° ¡®²ª³ ­¥ ®£° ­¨·¥­®).
 . ®ª ¦¨²¥, ·²® ¯®¨±ª ¬®¦­® °¥ «¨§®¢ ²¼ ² ª¨¬ ®¡° §®¬, ·²®¡» ¢ µ³¤¸¥¬ ±«³· ¥ ®­ § ­¨¬ « ¢°¥¬¿ O(lg n),   ¤®¯®«­¨²¥«¼­ ¿
¯ ¬¿²¼ (±¢¥°µ ²®©, ¢ ª®²®°®© µ° ­¨²±¿ ± ¬® ¬­®¦¥±²¢®) ­¥ ¨±¯®«¼§®¢ « ±¼.
¡. ³±²¼ ¬» °¥¸¨«¨ § ¯¨± ²¼ ½«¥¬¥­²» ­ ¸¥£® ¬­®¦¥±²¢  ¢ µ¥¸² ¡«¨¶³ ± ®²ª°»²®©  ¤°¥± ¶¨¥©, ±®±²®¿¹³¾ ¨§ m ¿·¥¥ª. °¥¤¯®«®¦¨¬, ·²® µ¥¸¨°®¢ ­¨¥ ° ¢­®¬¥°­®. °¨ ª ª®¬ ¬¨­¨¬ «¼­®¬ ®¡º¥¬¥ m ; n ¤®¯®«­¨²¥«¼­®© ¯ ¬¿²¨ ±°¥¤­¿¿ ±²®¨¬®±²¼
®¯¥° ¶¨¨ ¯®¨±ª  ½«¥¬¥­² , ®²±³²±²¢³¾¹¥£® ¢ ¬­®¦¥±²¢¥, ¡³¤¥²
­¥ µ³¦¥, ·¥¬ ¢ ¯³­ª²¥ ( )?  ª ·¥±²¢¥ ®²¢¥²  ¯°¨¢¥¤¨²¥  ±¨¬¯²®²¨·¥±ª³¾ ®¶¥­ª³ m ; n ·¥°¥§ n.
12-3 «¨­» ¶¥¯®·¥ª ¯°¨ µ¥¸¨°®¢ ­¨¨
 ±±¬®²°¨¬ µ¥¸-² ¡«¨¶³ ± n ¿·¥©ª ¬¨, ¢ ª®²®°®© ª®««¨§¨¨ ° §°¥¸ ¾²±¿ ± ¯®¬®¹¼¾ ¶¥¯®·¥ª. ¥¸¨°®¢ ­¨¥ ° ¢­®¬¥°­®: ª ¦¤»©
­®¢»© ª«¾· ¨¬¥¥² ° ¢­»¥ ¸ ­±» ¯®¯ ±²¼ ¢® ¢±¥ ¿·¥©ª¨ ­¥§ ¢¨±¨¬®

246

« ¢  12 ¥¸-² ¡«¨¶»

®² ¯°¥¤»¤³¹¨µ. ³±²¼ M | ¬ ª±¨¬ «¼­ ¿ ¤«¨­  ¶¥¯®·¥ª ¯®±«¥ ¤®¡ ¢«¥­¨¿ n ª«¾·¥©.  ¸  § ¤ ·  | ¤®ª § ²¼, ·²® ¬ ²¥¬ ²¨·¥±ª®¥
®¦¨¤ ­¨¥ M ¥±²¼ O(lg n= lg lg n).
 . ¨ª±¨°³¥¬ ­¥ª®²®°®¥ µ¥¸-§­ ·¥­¨¥. ³±²¼ Qk | ¢¥°®¿²­®±²¼
²®£®, ¥¬³ ±®®²¢¥²±²¢³¥² k ° §«¨·­»µ ª«¾·¥©. ®ª ¦¨²¥, ·²®
n;k
 k 
1
1
k
1;
:
Q =C
k

n

n

n

¡. ³±²¼ Pk | ¢¥°®¿²­®±²¼ ²®£®, ·²® ¬ ª±¨¬ «¼­ ¿ ¤«¨­  ¶¥¯®·ª¨
° ¢­  k. ®ª ¦¨²¥, ·²® Pk 6 nQk .
¢. »¢¥¤¨²¥ ¨§ ´®°¬³«» ²¨°«¨­£  (2.11), ·²® Qk < ek =kk .
£. ®ª ¦¨²¥, ·²® ±³¹¥±²¢³¥² ² ª ¿ ª®­±² ­²  c > 1, ·²® Qk <
1=n3 ¯°¨ k > c lg n= lg lg n.  ª«¾·¨²¥ ®²±¾¤ , ·²® Pk < 1=n2
¯°¨ ² ª¨µ k.
¤. ®ª ¦¨²¥, ·²® ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ¢¥«¨·¨­» M ­¥ ¯°¥¢®±µ®¤¨²




c
lg
n
c
lg
n
P M > lg lg n  n + P M 6 lg lg n  lgc lglgnn ;
¨ ¢»¢¥¤¨²¥ ®²±¾¤ , ·²® ½²® ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ¥±²¼
O(lg n= lg lg n).
12-4 °¨¬¥° ª¢ ¤° ²¨·­®© ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¯°®¡
³±²¼ ­ ¬ ­ ¤® ¯®¬¥±²¨²¼ § ¯¨±¼ ± ª«¾·®¬ k ¢ µ¥¸-² ¡«¨¶³,
¿·¥©ª¨ ª®²®°®© ¯°®­³¬¥°®¢ ­» ·¨±« ¬¨ 0; 1; : : :; m ; 1.  ­ ± ¥±²¼
µ¥¸-´³­ª¶¨¿ h, ®²®¡° ¦ ¾¹ ¿ ¬­®¦¥±²¢® ª«¾·¥© ¢ ¬­®¦¥±²¢®
f0; 1; : : :; m ; 1g. ³¤¥¬ ¤¥©±²¢®¢ ²¼ ² ª:
1.  µ®¤¨¬ i h(k) ¨ ¯®« £ ¥¬ j 0.
2. °®¢¥°¿¥¬ ¯®§¨¶¨¾ ­®¬¥° i. ±«¨ ®­  ±¢®¡®¤­ , § ­®±¨¬ ²³¤ 
§ ¯¨±¼ ¨ ­  ½²®¬ ®±² ­ ¢«¨¢ ¥¬±¿.
3. ®« £ ¥¬ j (j +1) mod m ¨ i (i + j ) mod m ¨ ¢®§¢° ¹ ¥¬±¿
ª ¸ £³ 2.
 . ®ª ¦¨²¥, ·²® ®¯¨± ­­»©  «£®°¨²¬ | · ±²­»© ±«³· © Àª¢ ¤° ²¨·­®£® ¬¥²®¤ Á ¤«¿ ¯®¤µ®¤¿¹¨µ §­ ·¥­¨© c1 ¨ c2.
°¥¤¯®«®¦¨¬, ·²® m ¿¢«¿¥²±¿ ±²¥¯¥­¼¾ ¤¢®©ª¨.
¡. ®ª ¦¨²¥, ·²® ¢ µ³¤¸¥¬ ±«³· ¥ ¡³¤¥² ¯°®±¬®²°¥­  ¢±¿ ² ¡«¨¶ .
12-5 k-³­¨¢¥°± «¼­®¥ µ¥¸¨°®¢ ­¨¥
³±²¼ H | ±¥¬¥©±²¢® µ¥¸-´³­ª¶¨©, ®²®¡° ¦ ¾¹¨µ ¬­®¦¥±²¢® ¢®§¬®¦­»µ ª«¾·¥© U ¢ f0; 1; : : :; m ; 1g. ³¤¥¬ £®¢®°¨²¼,
·²® H ¿¢«¿¥²±¿ k-³­¨¢¥°± «¼­»¬, ¥±«¨ ¤«¿ «¾¡®© ¯®±«¥¤®¢ ²¥«¼­®±²¨ k ° §«¨·­»µ ª«¾·¥© hx1 ; : : :; xk i ±«³· ©­ ¿ ¢¥«¨·¨­ 
hh(x1); : : :; h(xk)i (£¤¥ h | ±«³· ©­»© ½«¥¬¥­² H) ¯°¨­¨¬ ¥²
¢±¥ mk ±¢®¨µ ¢®§¬®¦­»µ §­ ·¥­¨© ± ° ¢­»¬¨ ¢¥°®¿²­®±²¿¬¨.

 ¬¥· ­¨¿ ª £« ¢¥ 12

247

 . ®ª ¦¨²¥, ·²® ¢±¿ª®¥ 2-³­¨¢¥°± «¼­®¥ ±¥¬¥©±²¢® ³­¨¢¥°± «¼­®.
¡. ®ª ¦¨²¥, ·²® ±¥¬¥©±²¢® H, ®¯¨± ­­®¥ ¢ ° §¤¥«¥ 12.3.3, ­¥ ¿¢«¿¥²±¿ 2-³­¨¢¥°± «¼­»¬.
¢.  ±¸¨°¨¬ ±¥¬¥©±²¢® H ¨§ ° §¤. 12.3.3 ¨ ° ±±¬®²°¨¬ ¢±¥¢®§¬®¦­»¥ ´³­ª¶¨¨ ¢¨¤ 

ha;b (x) = ha(x) + b mod m;
£¤¥ b | ­¥ª®²®°»© ¢»·¥² ¯® ¬®¤³«¾ m. ®ª ¦¨²¥, ·²® ¯®«³·¥­­®¥ ±¥¬¥©±²¢® ¡³¤¥² 2-³­¨¢¥°± «¼­»¬.

 ¬¥· ­¨¿
«£®°¨²¬» µ¥¸¨°®¢ ­¨¿ ¯°¥ª° ±­® ¨§«®¦¥­» ³ ­³²  [123] ¨
®­­¥²  [90]. ®£« ±­® ­³²³, µ¥¸-² ¡«¨¶» ¨ ¬¥²®¤ ¶¥¯®·¥ª ¡»«¨ ¨§®¡°¥²¥­» ³­®¬ (H. P. Luhn) ¢ 1953 £®¤³. °¨¬¥°­® ¢ ²® ¦¥
¢°¥¬¿ ¬¤ «¼ (G.M. Amdahl) ¨§®¡°¥« ®²ª°»²³¾  ¤°¥± ¶¨¾.

13

¢®¨·­»¥ ¤¥°¥¢¼¿ ¯®¨±ª 

¥°¥¢¼¿ ¯®¨±ª  (search trees) ¯®§¢®«¿¾² ¢»¯®«­¿²¼ ±«¥¤³¾¹¨¥ ®¯¥° ¶¨¨ ± ¤¨­ ¬¨·¥±ª¨¬¨ ¬­®¦¥±²¢ ¬¨: Search (¯®¨±ª), Minimum
(¬¨­¨¬³¬), Maximum (¬ ª±¨¬³¬), Predecessor (¯°¥¤»¤³¹¨©),
Successor (±«¥¤³¾¹¨©), Insert (¢±² ¢¨²¼) ¨ Delete (³¤ «¨²¼).
 ª¨¬ ®¡° §®¬, ¤¥°¥¢® ¯®¨±ª  ¬®¦¥² ¡»²¼ ¨±¯®«¼§®¢ ­® ¨ ª ª ±«®¢ °¼, ¨ ª ª ®·¥°¥¤¼ ± ¯°¨®°¨²¥² ¬¨.
°¥¬¿ ¢»¯®«­¥­¨¿ ®±­®¢­»µ ®¯¥° ¶¨© ¯°®¯®°¶¨®­ «¼­® ¢»±®²¥
¤¥°¥¢ . ±«¨ ¤¢®¨·­®¥ ¤¥°¥¢® À¯«®²­® § ¯®«­¥­®Á (¢±¥ ¥£® ³°®¢­¨
¨¬¥¾² ¬ ª±¨¬ «¼­® ¢®§¬®¦­®¥ ·¨±«® ¢¥°¸¨­), ²® ¥£® ¢»±®²  (¨
¢°¥¬¿ ¢»¯®«­¥­¨¿ ®¯¥° ¶¨©) ¯°®¯®°¶¨®­ «¼­» «®£ °¨´¬³ ·¨±« 
¢¥°¸¨­.  ¯°®²¨¢, ¥±«¨ ¤¥°¥¢® ¯°¥¤±² ¢«¿¥² ±®¡®© «¨­¥©­³¾ ¶¥¯®·ª³ ¨§ n ¢¥°¸¨­, ½²® ¢°¥¬¿ ¢»° ±² ¥² ¤® (n).  ° §¤¥«¥ 13.4
¬» ³¢¨¤¨¬, ·²® ¢»±®²  ±«³· ©­®£® ¤¢®¨·­®£® ¤¥°¥¢  ¯®¨±ª  ¥±²¼
O(lg n), ² ª ·²® ¢ ½²®¬ ±«³· ¥ ¢°¥¬¿ ¢»¯®«­¥­¨¿ ®±­®¢­»µ ®¯¥° ¶¨© ¥±²¼ (lg n).
®­¥·­®, ¢®§­¨ª ¾¹¨¥ ­  ¯° ª²¨ª¥ ¤¢®¨·­»¥ ¤¥°¥¢¼¿ ¯®¨±ª 
¬®£³² ¡»²¼ ¤ «¥ª¨ ®² ±«³· ©­»µ. ¤­ ª®, ¯°¨­¿¢ ±¯¥¶¨ «¼­»¥ ¬¥°» ¯® ¡ « ­±¨°®¢ª¥ ¤¥°¥¢¼¥¢, ¬» ¬®¦¥¬ £ ° ­²¨°®¢ ²¼, ·²® ¢»±®²  ¤¥°¥¢¼¥¢ ± n ¢¥°¸¨­ ¬¨ ¡³¤¥² O(log n).  £« ¢¥ 14 ° ±±¬®²°¥­
®¤¨­ ¨§ ¯®¤µ®¤®¢ ² ª®£® °®¤  (ª° ±­®-·¥°­»¥ ¤¥°¥¢¼¿).  £« ¢¥ 19
° ±±¬ ²°¨¢ ¾²±¿ -¤¥°¥¢¼¿, ª®²®°»¥ ®±®¡¥­­® ³¤®¡­» ¤«¿ ¤ ­­»µ, µ° ­¿¹¨µ±¿ ¢® ¢²®°¨·­®© ¯ ¬¿²¨ ± ¯°®¨§¢®«¼­»¬ ¤®±²³¯®¬
(­  ¤¨±ª¥).
 ½²®© £« ¢¥ ¬» ° ±±¬®²°¨¬ ®±­®¢­»¥ ®¯¥° ¶¨¨ ± ¤¢®¨·­»¬¨
¤¥°¥¢¼¿¬¨ ¯®¨±ª  ¨ ¯®ª ¦¥¬, ª ª ­ ¯¥· ² ²¼ ½«¥¬¥­²» ¤¥°¥¢  ¢
­¥³¡»¢ ¾¹¥¬ ¯®°¿¤ª¥, ª ª ¨±ª ²¼ § ¤ ­­»© ½«¥¬¥­², ª ª ­ ©²¨
¬ ª±¨¬ «¼­»© ¨«¨ ¬¨­¨¬ «¼­»© ½«¥¬¥­², ª ª ­ ©²¨ ½«¥¬¥­², ±«¥¤³¾¹¨© §  ¤ ­­»¬ ¨ ¯°¥¤¸¥±²¢³¾¹¨© ¤ ­­®¬³, ¨, ­ ª®­¥¶, ª ª
¤®¡ ¢¨²¼ ¨«¨ ³¤ «¨²¼ ½«¥¬¥­².  ¯®¬­¨¬, ·²® ®¯°¥¤¥«¥­¨¥ ¤¥°¥¢ 
¨ ®±­®¢­»¥ ±¢®©±²¢  ¤¥°¥¢¼¥¢ ¯°¨¢®¤¿²±¿ ¢ £« ¢¥ 5.

²® ² ª®¥ ¤¢®¨·­®¥ ¤¥°¥¢® ¯®¨±ª ?

249

¢®¨·­»¥ ¤¥°¥¢¼¿ ¯®¨±ª . ¥¢®¥ ¯®¤¤¥°¥¢® ¯°®¨§¢®«¼­®© ¢¥°¸¨­» x
±®¤¥°¦¨² ª«¾·¨, ­¥ ¯°¥¢®±µ®¤¿¹¨¥ key[x], ¯° ¢®¥ | ­¥ ¬¥­¼¸¨¥ key[x].  §­»¥
¤¢®¨·­»¥ ¤¥°¥¢¼¿ ¯®¨±ª  ¬®£³² ¯°¥¤±² ¢«¿²¼ ®¤­® ¨ ²® ¦¥ ¬­®¦¥±²¢®. °¥¬¿
¢»¯®«­¥­¨¿ (¢ µ³¤¸¥¬ ±«³· ¥) ¡®«¼¸¨­±²¢  ®¯¥° ¶¨© ¯°®¯®°¶¨®­ «¼­® ¢»±®²¥
¤¥°¥¢ . ( ) ¢®¨·­®¥ ¤¥°¥¢® ¯®¨±ª  ¢»±®²» 2 ± 6 ¢¥°¸¨­ ¬¨. (¡) ¥­¥¥ ½´´¥ª²¨¢­®¥ ¤¥°¥¢® ¢»±®²» 4, ±®¤¥°¦ ¹¥¥ ²¥ ¦¥ ª«¾·¨.
¨±. 13.1

13.1. ²® ² ª®¥ ¤¢®¨·­®¥ ¤¥°¥¢® ¯®¨±ª ?
 ¤¢®¨·­®¬ ¤¥°¥¢¥ ¯®¨±ª  (binary search tree; ¯°¨¬¥° ¯°¨¢¥¤¥­
­  °¨±. 13.1) ª ¦¤ ¿ ¢¥°¸¨­  ¬®¦¥² ¨¬¥²¼ (¨«¨ ­¥ ¨¬¥²¼) «¥¢®£® ¨
¯° ¢®£® °¥¡¥­ª ; ª ¦¤ ¿ ¢¥°¸¨­ , ª°®¬¥ ª®°­¿, ¨¬¥¥² °®¤¨²¥«¿.
°¨ ¯°¥¤±² ¢«¥­¨¨ ± ¨±¯®«¼§®¢ ­¨¥¬ ³ª § ²¥«¥© ¬» µ° ­¨¬ ¤«¿
ª ¦¤®© ¢¥°¸¨­» ¤¥°¥¢ , ¯®¬¨¬® §­ ·¥­¨¿ ª«¾·  key ¨ ¤®¯®«­¨²¥«¼­»µ ¤ ­­»µ, ² ª¦¥ ¨ ³ª § ²¥«¨ left, right ¨ p («¥¢»© °¥¡¥­®ª,
¯° ¢»© °¥¡¥­®ª, °®¤¨²¥«¼). ±«¨ °¥¡¥­ª  (¨«¨ °®¤¨²¥«¿ | ¤«¿
ª®°­¿) ­¥², ±®®²¢¥²±²¢³¾¹¥¥ ¯®«¥ ±®¤¥°¦¨² nil.
«¾·¨ ¢ ¤¢®¨·­®¬ ¤¥°¥¢¥ ¯®¨±ª  µ° ­¿²±¿ ± ±®¡«¾¤¥­¨¥¬ ±¢®©±²¢  ³¯®°¿¤®·¥­­®±²¨ (binary-search-tree property):
³±²¼ x | ¯°®¨§¢®«¼­ ¿ ¢¥°¸¨­  ¤¢®¨·­®£® ¤¥°¥¢  ¯®¨±ª .
±«¨ ¢¥°¸¨­  y ­ µ®¤¨²±¿ ¢ «¥¢®¬ ¯®¤¤¥°¥¢¥ ¢¥°¸¨­» x, ²®
key[y ] 6 key[x]. ±«¨ y ­ µ®¤¨²±¿ ¢ ¯° ¢®¬ ¯®¤¤¥°¥¢¥ x, ²®
key[y ] > key[x].
 ª, ­  °¨±. 13.1( ) ¢ ª®°­¥ ¤¥°¥¢  µ° ­¨²±¿ ª«¾· 5, ª«¾·¨ 2, 3 ¨ 5
«¥¢®¬ ¯®¤¤¥°¥¢¥ ª®°­¿ ­¥ ¯°¥¢®±µ®¤¿² 5,   ª«¾·¨ 7 ¨ 8 ¢ ¯° ¢®¬ |
­¥ ¬¥­¼¸¥ 5. ® ¦¥ ± ¬®¥ ¢¥°­® ¤«¿ ¢±¥µ ¢¥°¸¨­ ¤¥°¥¢ .  ¯°¨¬¥°,
ª«¾· 3 ­  °¨±. 13.1( ) ­¥ ¬¥­¼¸¥ ª«¾·  2 ¢ «¥¢®¬ ¯®¤¤¥°¥¢¥ ¨ ­¥
¡®«¼¸¥ ª«¾·  5 ¢ ¯° ¢®¬.
¢®©±²¢® ³¯®°¿¤®·¥­­®±²¨ ¯®§¢®«¿¥² ­ ¯¥· ² ²¼ ¢±¥ ª«¾·¨ ¢ ­¥³¡»¢ ¾¹¥¬ ¯®°¿¤ª¥ ± ¯®¬®¹¼¾ ¯°®±²®£® °¥ª³°±¨¢­®£®  «£®°¨²¬ 
(­ §»¢ ¥¬®£® ¯®- ­£«¨©±ª¨ inorder tree walk). ²®²  «£®°¨²¬ ¯¥· ² ¥² ª«¾· ª®°­¿ ¯®¤¤¥°¥¢  ¯®±«¥ ¢±¥µ ª«¾·¥© ¥£® «¥¢®£® ¯®¤¤¥°¥¢ , ­® ¯¥°¥¤ ª«¾· ¬¨ ¯° ¢®£® ¯®¤¤¥°¥¢ . ( ¬¥²¨¬ ¢ ±ª®¡ª µ,

250

« ¢  13 ¢®¨·­»¥ ¤¥°¥¢¼¿ ¯®¨±ª 

·²® ¯®°¿¤®ª, ¯°¨ ª®²®°®¬ ª®°¥­¼ ¯°¥¤¸¥±²¢³¥² ®¡®¨¬ ¯®¤¤¥°¥¢¼¿¬, ­ §»¢ ¥²±¿ preorder; ¯®°¿¤®ª, ¢ ª®²®°®¬ ª®°¥­¼ ±«¥¤³¥² § 
­¨¬¨, ­ §»¢ ¥²±¿ postorder.)
»§®¢ Inorder-Tree-Walk (root[T ]) ¯¥· ² ¥² (¢ ³ª § ­­®¬ ¯®°¿¤ª¥) ¢±¥ ª«¾·¨, ¢µ®¤¿¹¨¥ ¢ ¤¥°¥¢® T ± ª®°­¥¬ root[T ].
Inorder-Tree-Walk (x)
1 if x 6= nil
2 then Inorder-Tree-Walk (left[x])
3
­ ¯¥· ² ²¼ key[x]
4
Inorder-Tree-Walk (right[x])
 ¯°¨¬¥°³, ¤«¿ ®¡®¨µ ¤¥°¥¢¼¥¢ °¨±. 13.1 ¡³¤¥² ­ ¯¥· ² ­®
2; 3; 5; 5; 7; 8. ¢®©±²¢® ³¯®°¿¤®·¥­­®±²¨ £ ° ­²¨°³¥² ¯° ¢¨«¼­®±²¼  «£®°¨²¬  (¨­¤³ª¶¨¿ ¯® ¢»±®²¥ ¯®¤¤¥°¥¢ ). °¥¬¿ ° ¡®²»
­  ¤¥°¥¢¥ ± n ¢¥°¸¨­ ¬¨ ¥±²¼ (n): ­  ª ¦¤³¾ ¢¥°¸¨­³ ²° ²¨²±¿
®£° ­¨·¥­­®¥ ¢°¥¬¿ (¯®¬¨¬® °¥ª³°±¨¢­»µ ¢»§®¢®¢) ¨ ª ¦¤ ¿
¢¥°¸¨­  ®¡° ¡ ²»¢ ¥²±¿ ®¤¨­ ° §.
¯° ¦­¥­¨¿
13.1-1  °¨±³©²¥ ¤¢®¨·­»¥ ¤¥°¥¢¼¿ ¯®¨±ª  ¢»±®²» 2, 3, 4, 5 ¨ 6
¤«¿ ®¤­®£® ¨ ²®£® ¦¥ ¬­®¦¥±²¢  ª«¾·¥© f1; 4; 5; 10; 16; 17; 21g.
13.1-2 ³·¨ ¨§ ° §¤¥«  7.1 ² ª¦¥ ¡»«¨ ¤¢®¨·­»¬¨ ¤¥°¥¢¼¿¬¨, ¨
²°¥¡®¢ ­¨¥ ³¯®°¿¤®·¥­­®±²¨ ² ¬ ²®¦¥ ¡»«®.  ·¥¬ ° §­¨¶  ¬¥¦¤³ ²¥¬ ²°¥¡®¢ ­¨¥¬ ¨ ²¥¯¥°¥¸­¨¬?  ª ¢» ¤³¬ ¥²¥, ¬®¦­® «¨
­ ¯¥· ² ²¼ ½«¥¬¥­²» ¤¢®¨·­®© ª³·¨ ¢ ­¥³¡»¢ ¾¹¥¬ ¯®°¿¤ª¥ § 
¢°¥¬¿ O(n)? ¡º¿±­¨²¥ ¢ ¸ ®²¢¥².
13.1-3  ¯¨¸¨²¥ ­¥°¥ª³°±¨¢­»©  «£®°¨²¬, ¯¥· ² ¾¹¨© ª«¾·¨
¢ ¤¢®¨·­®¬ ¤¥°¥¢¥ ¯®¨±ª  ¢ ­¥³¡»¢ ¾¹¥¬ ¯®°¿¤ª¥. (ª § ­¨¥: °®±²®¥ °¥¸¥­¨¥ ¨±¯®«¼§³¥² ¢ ª ·¥±²¢¥ ¤®¯®«­¨²¥«¼­®© ±²°³ª²³°»
±²¥ª; ¡®«¥¥ ¨§¿¹­®¥ °¥¸¥­¨¥ ­¥ ²°¥¡³¥² ±²¥ª , ­® ¯°¥¤¯®« £ ¥²,
·²® ¬®¦­® ¯°®¢¥°¿²¼ ° ¢¥­±²¢® ³ª § ²¥«¥©.)
13.1-4  ¯¨¸¨²¥ °¥ª³°±¨¢­»¥  «£®°¨²¬» ¤«¿ ®¡µ®¤  ¤¥°¥¢¼¥¢
¢ ° §«¨·­»µ ¯®°¿¤ª µ (preorder, postorder).  ª ¨ ° ­¼¸¥, ¢°¥¬¿
° ¡®²» ¤®«¦­® ¡»²¼ O(n) (£¤¥ n | ·¨±«® ¢¥°¸¨­).
13.1-5 ®ª ¦¨²¥, ·²® «¾¡®©  «£®°¨²¬ ¯®±²°®¥­¨¿ ¤¢®¨·­®£® ¤¥°¥¢  ¯®¨±ª , ±®¤¥°¦ ¹¥£® § ¤ ­­»¥ n ½«¥¬¥­²®¢, ²°¥¡³¥² (¢ µ³¤¸¥¬ ±«³· ¥) ¢°¥¬¥­¨ 
(n lg n). ®±¯®«¼§³©²¥±¼ ²¥¬, ·²® ±®°²¨°®¢ª  n ·¨±¥« ²°¥¡³¥² 
(n lg n) ¤¥©±²¢¨©.

®¨±ª ¢ ¤¢®¨·­®¬ ¤¥°¥¢¥

251

®¨±ª ¢ ¤¢®¨·­®¬ ¤¥°¥¢¥. ¹  ª«¾· 13, ¬» ¨¤¥¬ ®² ª®°­¿ ¯® ¯³²¨
15 ! 6 ! 7 ! 13. ²®¡» ­ ©²¨ ¬¨­¨¬ «¼­»© ª«¾· 2, ¬» ¢±¥ ¢°¥¬¿ ¨¤¥¬ ­ «¥¢®; ·²®¡» ­ ©²¨ ¬ ª±¨¬ «¼­»© ª«¾· 20 | ­ ¯° ¢®. «¿ ¢¥°¸¨­» ± ª«¾·®¬ 15
±«¥¤³¾¹¥© ¡³¤¥² ¢¥°¸¨­  ± ª«¾·®¬ 17 (½²® ¬¨­¨¬ «¼­»© ª«¾· ¢ ¯° ¢®¬ ¯®¤¤¥°¥¢¥ ¢¥°¸¨­» ± ª«¾·®¬ 15).  ¢¥°¸¨­» ± ª«¾·®¬ 13 ­¥² ¯° ¢®£® ¯®¤¤¥°¥¢ ;
¯®½²®¬³, ·²®¡» ­ ©²¨ ±«¥¤³¾¹³¾ §  ­¥© ¢¥°¸¨­³, ¬» ¯®¤­¨¬ ¥¬±¿ ¢¢¥°µ, ¯®ª  ­¥ ¯°®©¤¥¬ ¯® °¥¡°³, ¢¥¤³¹¥¬³ ¢¯° ¢®-¢¢¥°µ; ¢ ¤ ­­®¬ ±«³· ¥ ±«¥¤³¾¹ ¿
¢¥°¸¨­  ¨¬¥¥² ª«¾· 15.
¨±. 13.2

13.2. ®¨±ª ¢ ¤¢®¨·­®¬ ¤¥°¥¢¥
 ½²®¬ ° §¤¥«¥ ¬» ¯®ª ¦¥¬, ·²® ¤¢®¨·­»¥ ¤¥°¥¢¼¿ ¯®¨±ª  ¯®§¢®«¿¾² ¢»¯®«­¿²¼ ®¯¥° ¶¨¨ Search, Minimum, Maximum, Successor ¨ Predecessor §  ¢°¥¬¿ O(h), £¤¥ h | ¢»±®²  ¤¥°¥¢ .
®¨±ª
°®¶¥¤³°  ¯®¨±ª  ¯®«³· ¥² ­  ¢µ®¤ ¨±ª®¬»© ª«¾· k ¨ ³ª § ²¥«¼ x ­  ª®°¥­¼ ¯®¤¤¥°¥¢ , ¢ ª®²®°®¬ ¯°®¨§¢®¤¨²±¿ ¯®¨±ª. ­ 
¢®§¢° ¹ ¥² ³ª § ²¥«¼ ­  ¢¥°¸¨­³ ± ª«¾·®¬ k (¥±«¨ ² ª ¿ ¥±²¼)
¨«¨ ±¯¥¶¨ «¼­®¥ §­ ·¥­¨¥ nil (¥±«¨ ² ª®© ¢¥°¸¨­» ­¥²).
Tree-Search (x; k)
1 if x = nil ¨«¨ k = key[x]
2 then return x
3 if k < key[x]
4 then return Tree-Search(left[x]; k)
5 else return Tree-Search(right[x]; k)
 ¯°®¶¥±±¥ ¯®¨±ª  ¬» ¤¢¨£ ¥¬±¿ ®² ª®°­¿, ±° ¢­¨¢ ¿ ª«¾· k ±
ª«¾·®¬, µ° ­¿¹¨¬±¿ ¢ ²¥ª³¹¥© ¢¥°¸¨­¥ x. ±«¨ ®­¨ ° ¢­», ¯®¨±ª § ¢¥°¸ ¥²±¿. ±«¨ k < key[x], ²® ¯®¨±ª ¯°®¤®«¦ ¥²±¿ ¢ «¥¢®¬
¯®¤¤¥°¥¢¥ x (ª«¾· k ¬®¦¥² ¡»²¼ ²®«¼ª® ² ¬, ±®£« ±­® ±¢®©±²¢³
³¯®°¿¤®·¥­­®±²¨). ±«¨ k > key[x], ²® ¯®¨±ª ¯°®¤®«¦ ¥²±¿ ¢ ¯° ¢®¬ ¯®¤¤¥°¥¢¥. «¨­  ¯³²¨ ¯®¨±ª  ­¥ ¯°¥¢®±µ®¤¨² ¢»±®²» ¤¥°¥¢ ,

252

« ¢  13 ¢®¨·­»¥ ¤¥°¥¢¼¿ ¯®¨±ª 

¯®½²®¬³ ¢°¥¬¿ ¯®¨±ª  ¥±²¼ O(h) (£¤¥ h | ¢»±®²  ¤¥°¥¢ ).
®² ¨²¥° ²¨¢­ ¿ ¢¥°±¨¿ ²®© ¦¥ ¯°®¶¥¤³°» (ª®²®° ¿, ª ª ¯° ¢¨«®, ¡®«¥¥ ½´´¥ª²¨¢­ ):
Iterative-Tree-Search (x; k)
1 while x 6= nil ¨ k 6= key[x]
2
do if k < key[x]
3
then x left[x]
4
else x right[x]
5 return x
¨­¨¬³¬ ¨ ¬ ª±¨¬³¬
¨­¨¬ «¼­»© ª«¾· ¢ ¤¥°¥¢¥ ¯®¨±ª  ¬®¦­® ­ ©²¨, ¯°®©¤¿ ¯®
³ª § ²¥«¿¬ left ®² ª®°­¿ (¯®ª  ­¥ ³¯°¥¬±¿ ¢ nil), ±¬. °¨±. 13.2. °®¶¥¤³°  ¢®§¢° ¹ ¥² ³ª § ²¥«¼ ­  ¬¨­¨¬ «¼­»© ½«¥¬¥­² ¯®¤¤¥°¥¢ 
± ª®°­¥¬ x.
Tree-Minimum(x)
1 while left[x] 6= nil
2
do x left[x]
3 return x
¢®©±²¢® ³¯®°¿¤®·¥­­®±²¨ £ ° ­²¨°³¥² ¯° ¢¨«¼­®±²¼ ¯°®¶¥¤³°»
Tree-Minimum. ±«¨ ³ ¢¥°¸¨­» x ­¥² «¥¢®£® °¥¡¥­ª , ²® ¬¨­¨¬ «¼­»© ½«¥¬¥­² ¯®¤¤¥°¥¢  ± ª®°­¥¬ x ¥±²¼ x, ² ª ª ª «¾¡®© ª«¾·
¢ ¯° ¢®¬ ¯®¤¤¥°¥¢¥ ­¥ ¬¥­¼¸¥ key[x]. ±«¨ ¦¥ «¥¢®¥ ¯®¤¤¥°¥¢® ¢¥°¸¨­» x ­¥ ¯³±²®, ²® ¬¨­¨¬ «¼­»© ½«¥¬¥­² ¯®¤¤¥°¥¢  ± ª®°­¥¬ x
­ µ®¤¨²±¿ ¢ ½²®¬ «¥¢®¬ ¯®¤¤¥°¥¢¥ (¯®±ª®«¼ª³ ± ¬ x ¨ ¢±¥ ½«¥¬¥­²»
¯° ¢®£® ¯®¤¤¥°¥¢  ¡®«¼¸¥).
«£®°¨²¬ Tree-Maximum ±¨¬¬¥²°¨·¥­:
Tree-Maximum(x)
1 while right[x] 6= nil
2
do x right[x]
3 return x
¡   «£®°¨²¬  ²°¥¡³¾² ¢°¥¬¥­¨ O(h), £¤¥ h | ¢»±®²  ¤¥°¥¢  (¯®±ª®«¼ª³ ¤¢¨£ ¾²±¿ ¯® ¤¥°¥¢³ ²®«¼ª® ¢­¨§).
«¥¤³¾¹¨© ¨ ¯°¥¤»¤³¹¨© ½«¥¬¥­²»
 ª ­ ©²¨ ¢ ¤¢®¨·­®¬ ¤¥°¥¢¥ ½«¥¬¥­², ±«¥¤³¾¹¨© §  ¤ ­­»¬?
¢®©±²¢® ³¯®°¿¤®·¥­­®±²¨ ¯®§¢®«¿¥² ±¤¥« ²¼ ½²®, ¤¢¨£ ¿±¼ ¯® ¤¥°¥¢³. ®² ¯°®¶¥¤³° , ª®²®° ¿ ¢®§¢° ¹ ¥² ³ª § ²¥«¼ ­  ±«¥¤³¾¹¨©
§  x ½«¥¬¥­² (¥±«¨ ¢±¥ ª«¾·¨ ° §«¨·­», ®­ ±®¤¥°¦¨² ±«¥¤³¾¹¨©

®¨±ª ¢ ¤¢®¨·­®¬ ¤¥°¥¢¥

253

¯® ¢¥«¨·¨­¥ ª«¾·) ¨«¨ nil, ¥±«¨ ½«¥¬¥­² x | ¯®±«¥¤­¨© ¢ ¤¥°¥¢¥.
Tree-Successor(x)
1 if right[x] 6= nil
2 then return Tree-Minimum(right[x])
3 y p[x]
4 while y 6= nil and x = right[y ]
5
do x y
6
y p[y ]
7 return y
°®¶¥¤³°  Tree-Successor ®²¤¥«¼­® ° ±±¬ ²°¨¢ ¥² ¤¢  ±«³· ¿. ±«¨ ¯° ¢®¥ ¯®¤¤¥°¥¢® ¢¥°¸¨­» x ­¥¯³±²®, ²® ±«¥¤³¾¹¨©
§  x ½«¥¬¥­² | ¬¨­¨¬ «¼­»© ½«¥¬¥­² ¢ ½²®¬ ¯®¤¤¥°¥¢¥ ¨ ° ¢¥­ Tree-Minimum(right[x]).  ¯°¨¬¥°, ­  °¨±. 13.2 §  ¢¥°¸¨­®© ±
ª«¾·®¬ 15 ±«¥¤³¥² ¢¥°¸¨­  ± ª«¾·®¬ 17.
³±²¼ ²¥¯¥°¼ ¯° ¢®¥ ¯®¤¤¥°¥¢® ¢¥°¸¨­» x ¯³±²®. ®£¤  ¬» ¨¤¥¬
®² x ¢¢¥°µ, ¯®ª  ­¥ ­ ©¤¥¬ ¢¥°¸¨­³, ¿¢«¿¾¹³¾±¿ «¥¢»¬ ±»­®¬ ±¢®¥£® °®¤¨²¥«¿ (±²°®ª¨ 3{7). ²®² °®¤¨²¥«¼ (¥±«¨ ®­ ¥±²¼) ¨ ¡³¤¥²
¨±ª®¬»¬ ½«¥¬¥­²®¬. [®°¬ «¼­® £®¢®°¿, ¶¨ª« ¢ ±²°®ª µ 4{6 ±®µ° ­¿¥² ² ª®¥ ±¢®©±²¢®: y = p[x]; ¨±ª®¬»© ½«¥¬¥­² ­¥¯®±°¥¤±²¢¥­­®
±«¥¤³¥² §  ½«¥¬¥­² ¬¨ ¯®¤¤¥°¥¢  ± ª®°­¥¬ ¢ x.]
°¥¬¿ ° ¡®²» ¯°®¶¥¤³°» Tree-Successor ­  ¤¥°¥¢¥ ¢»±®²» h
¥±²¼ O(h), ² ª ª ª ¬» ¤¢¨£ ¥¬±¿ «¨¡® ²®«¼ª® ¢¢¥°µ, «¨¡® ²®«¼ª®
¢­¨§.
°®¶¥¤³°  Tree-Predecessor ±¨¬¬¥²°¨·­ .
 ª¨¬ ®¡° §®¬, ¬» ¤®ª § «¨ ±«¥¤³¾¹³¾ ²¥®°¥¬³.
¥®°¥¬  13.1. ¯¥° ¶¨¨ Search, Minimum, Maximum, Successor ¨ Predecessor ­  ¤¥°¥¢¥ ¢»±®²» h ¢»¯®«­¿¾²±¿ §  ¢°¥¬¿ O(h).
¯° ¦­¥­¨¿
13.2-1 °¥¤¯®«®¦¨¬, ·²® ¢ ¤¢®¨·­®¬ ¤¥°¥¢¥ ¯®¨±ª  µ° ­¿²±¿ ·¨±«  ®² 1 ¤® 1000 ¨ ¬» µ®²¨¬ ­ ©²¨ ·¨±«® 363.  ª¨¥ ¨§ ±«¥¤³¾¹¨µ ¯®±«¥¤®¢ ²¥«¼­®±²¥© ­¥ ¬®£³² ¡»²¼ ¯®±«¥¤®¢ ²¥«¼­®±²¿¬¨
¯°®±¬ ²°¨¢ ¥¬»µ ¯°¨ ½²®¬ ª«¾·¥©?
 . 2; 252; 401; 398; 330; 344; 397; 363;
¡. 924; 220; 911; 244; 898; 258; 362; 363;
¢. 925; 202; 911; 240; 912; 245; 363;
£. 2; 399; 387; 219; 266; 382; 381; 278; 363;
¤. 935; 278; 347; 621; 299; 392; 358; 363.
13.2-2 ³±²¼ ¯®¨±ª ª«¾·  ¢ ¤¢®¨·­®¬ ¤¥°¥¢¥ § ¢¥°¸ ¥²±¿ ¢ «¨±²¥.  ±±¬®²°¨¬ ²°¨ ¬­®¦¥±²¢ : A (½«¥¬¥­²» ±«¥¢  ®² ¯³²¨ ¯®¨±-

254

« ¢  13 ¢®¨·­»¥ ¤¥°¥¢¼¿ ¯®¨±ª 

ª ), B (½«¥¬¥­²» ­  ¯³²¨) ¨ C (±¯° ¢  ®² ¯³²¨). °®´¥±±®° ³²¢¥°¦¤ ¥², ·²® ¤«¿ «¾¡»µ ²°¥µ ª«¾·¥© a 2 A, b 2 B ¨ c 2 C ¢¥°­®
a 6 b 6 c. ®ª ¦¨²¥, ·²® ®­ ­¥¯° ¢, ¨ ¯°¨¢¥¤¨²¥ ª®­²°¯°¨¬¥°
¬¨­¨¬ «¼­® ¢®§¬®¦­®£® ° §¬¥° .
13.2-3

®ª ¦¨²¥ ´®°¬ «¼­® ¯° ¢¨«¼­®±²¼ ¯°®¶¥¤³°» Tree-

Successor.

13.2-4  ° §¤¥«¥ 13.1 ¡»« ¯®±²°®¥­  «£®°¨²¬, ¯¥· ² ¾¹¨© ¢±¥
ª«¾·¨ ¢ ­¥³¡»¢ ¾¹¥¬ ¯®°¿¤ª¥. ¥¯¥°¼ ½²® ¬®¦­® ±¤¥« ²¼ ¨­ ·¥:
­ ©²¨ ¬¨­¨¬ «¼­»© ½«¥¬¥­²,   ¯®²®¬ n ; 1 ° § ¨±ª ²¼ ±«¥¤³¾¹¨©
½«¥¬¥­². ®ª ¦¨²¥, ·²® ¢°¥¬¿ ° ¡®²» ² ª®£®  «£®°¨²¬  ¥±²¼ O(n).
®ª ¦¨²¥, ·²® k ¯®±«¥¤®¢ ²¥«¼­»µ ¢»§®¢®¢ TreeSuccessor ¢»¯®«­¿¾²±¿ §  O(k + h) ¸ £®¢ (h | ¢»±®²  ¤¥°¥¢ )
­¥§ ¢¨±¨¬® ®² ²®£®, ± ª ª®© ¢¥°¸¨­» ¬» ­ ·¨­ ¥¬.
13.2-5

13.2-6 ³±²¼ T | ¤¢®¨·­®¥ ¤¥°¥¢® ¯®¨±ª , ¢±¥ ª«¾·¨ ¢ ª®²®°®¬
° §«¨·­», x | ¥£® «¨±²,   y | °®¤¨²¥«¼ x. ®ª ¦¨²¥, ·²® key[y ]
¿¢«¿¥²±¿ ±®±¥¤­¨¬ ± key[x] ª«¾·®¬ (±«¥¤³¾¹¨¬ ¨«¨ ¯°¥¤»¤³¹¨¬ ¢
±¬»±«¥ ¯®°¿¤ª  ­  ª«¾· µ).

13.3. ®¡ ¢«¥­¨¥ ¨ ³¤ «¥­¨¥ ½«¥¬¥­² 
²¨ ®¯¥° ¶¨¨ ¬¥­¿¾² ¤¥°¥¢®, ±®µ° ­¿¿ ±¢®©±²¢® ³¯®°¿¤®·¥­­®±²¨.  ª ¬» ³¢¨¤¨¬, ¤®¡ ¢«¥­¨¥ ±° ¢­¨²¥«¼­® ¯°®±²®; ³¤ «¥­¨¥
·³²¼ ±«®¦­¥¥.
®¡ ¢«¥­¨¥
°®¶¥¤³°  Tree-Insert ¤®¡ ¢«¿¥² § ¤ ­­»© ½«¥¬¥­² ¢ ¯®¤µ®¤¿¹¥¥ ¬¥±²® ¤¥°¥¢  T (±®µ° ­¿¿ ±¢®©±²¢® ³¯®°¿¤®·¥­­®±²¨).  ° ¬¥²°®¬ ¯°®¶¥¤³°» ¿¢«¿¥²±¿ ³ª § ²¥«¼ z ­  ­®¢³¾ ¢¥°¸¨­³, ¢
ª®²®°³¾ ¯®¬¥¹¥­» §­ ·¥­¨¿ key[z ] (¤®¡ ¢«¿¥¬®¥ §­ ·¥­¨¥ ª«¾· ),
left[z ] = nil ¨ right[z ] = nil.  µ®¤¥ ° ¡®²» ¯°®¶¥¤³°  ¬¥­¿¥² ¤¥°¥¢® T ¨ (¢®§¬®¦­®) ­¥ª®²®°»¥ ¯®«¿ ¢¥°¸¨­» z , ¯®±«¥ ·¥£® ­®¢ ¿
¢¥°¸¨­  ± ¤ ­­»¬ §­ ·¥­¨¥¬ ª«¾·  ®ª §»¢ ¥²±¿ ¢±² ¢«¥­­®© ¢
¯®¤µ®¤¿¹¥¥ ¬¥±²® ¤¥°¥¢ .

®¡ ¢«¥­¨¥ ¨ ³¤ «¥­¨¥ ½«¥¬¥­² 

255

®¡ ¢«¥­¨¥ ½«¥¬¥­²  ± ª«¾·®¬ 13. ¢¥²«®-±¥°»¥ ¢¥°¸¨­» ­ µ®¤¿²±¿ ­  ¯³²¨ ®² ª®°­¿ ¤® ¯®§¨¶¨¨ ­®¢®£® ½«¥¬¥­² . ³­ª²¨° ±¢¿§»¢ ¥² ­®¢»©
½«¥¬¥­² ±® ±² °»¬¨.
¨±. 13.3

Tree-Insert (T; z )
1 y nil

2 x root[T ]
3 while x 6= nil
4
do y x
5
if key[z ] < key[x]
6
then x left[x]
7
else x right[x]
8 p[z ] y
9 if y = nil
10
then root[T ] z
11
else if key[z ] < key[y ]
12
then left[y ] z
13
else right[y ] z
  °¨±³­ª¥ 13.3 ¯®ª § ­®, ª ª ° ¡®² ¥² ¯°®¶¥¤³°  Tree-Insert.
®¤®¡­® ¯°®¶¥¤³° ¬ Tree-Search ¨ Iterative-Tree-Search,
®­  ¤¢¨£ ¥²±¿ ¢­¨§ ¯® ¤¥°¥¢³, ­ · ¢ ± ¥£® ª®°­¿. °¨ ½²®¬ ¢ ¢¥°¸¨­¥ y ±®µ° ­¿¥²±¿ ³ª § ²¥«¼ ­  °®¤¨²¥«¿ ¢¥°¸¨­» x (¶¨ª« ¢ ±²°®ª µ 3{7). ° ¢­¨¢ ¿ key[z ] ± key[x], ¯°®¶¥¤³°  °¥¸ ¥², ª³¤  ¨¤²¨
| ­ «¥¢® ¨«¨ ­ ¯° ¢®. °®¶¥±± § ¢¥°¸ ¥²±¿, ª®£¤  x ±² ­®¢¨²±¿
° ¢­»¬ nil. ²®² nil ±²®¨² ª ª ° § ² ¬, ª³¤  ­ ¤® ¯®¬¥±²¨²¼ z ,
·²® ¨ ¤¥« ¥²±¿ ¢ ±²°®ª µ 8{13.
 ª ¨ ®±² «¼­»¥ ®¯¥° ¶¨¨, ¤®¡ ¢«¥­¨¥ ²°¥¡³¥² ¢°¥¬¥­¨ O(h) ¤«¿
¤¥°¥¢  ¢»±®²» h.
¤ «¥­¨¥
 ° ¬¥²°®¬ ¯°®¶¥¤³°» ³¤ «¥­¨¿ ¿¢«¿¥²±¿ ³ª § ²¥«¼ ­  ³¤ «¿¥¬³¾ ¢¥°¸¨­³. °¨ ³¤ «¥­¨¨ ¢®§¬®¦­» ²°¨ ±«³· ¿, ¯®ª § ­­»¥ ­ 
°¨±³­ª¥ 13.4. ±«¨ ³ z ­¥² ¤¥²¥©, ¤«¿ ³¤ «¥­¨¿ z ¤®±² ²®·­® ¯®¬¥±²¨²¼ nil ¢ ±®®²¢¥²±²¢³¾¹¥¥ ¯®«¥ ¥£® °®¤¨²¥«¿ (¢¬¥±²® z ). ±«¨
³ z ¥±²¼ ®¤¨­ °¥¡¥­®ª, ¬®¦­® À¢»°¥§ ²¼Á z , ±®¥¤¨­¨¢ ¥£® °®¤¨²¥«¿

256

« ¢  13 ¢®¨·­»¥ ¤¥°¥¢¼¿ ¯®¨±ª 

¨±. 13.4 ¤ «¥­¨¥ ¢¥°¸¨­» z ¨§ ¤¢®¨·­®£® ¤¥°¥¢  ¯®¨±ª . ( ) ±«¨ ¢¥°¸¨­ 
z ­¥ ¨¬¥¥² ¤¥²¥©, ¥¥ ¬®¦­® ³¤ «¨²¼ ¡¥§ ¯°®¡«¥¬. (¡) ±«¨ ¢¥°¸¨­  z ¨¬¥¥²
®¤­®£® °¥¡¥­ª , ¯®¬¥¹ ¥¬ ¥£® ­  ¬¥±²® ¢¥°¸¨­» z . (¢) ±«¨ ³ ¢¥°¸¨­» z ¤¢®¥
¤¥²¥©, ¬» ±¢®¤¨¬ ¤¥«® ª ¯°¥¤»¤³¹¥¬³ ±«³· ¾, ³¤ «¿¿ ¢¬¥±²® ­¥¥ ¢¥°¸¨­³ y ±

­¥¯®±°¥¤±²¢¥­­® ±«¥¤³¾¹¨¬ §­ ·¥­¨¥¬ ª«¾·  (³ ½²®© ¢¥°¸¨­» °¥¡¥­®ª ®¤¨­)
¨ ¯®¬¥¹ ¿ ª«¾· key[y] (¨ ±¢¿§ ­­»¥ ± ­¨¬ ¤®¯®«­¨²¥«¼­»¥ ¤ ­­»¥) ­  ¬¥±²®
¢¥°¸¨­» z .

­ ¯°¿¬³¾ ± ¥£® °¥¡¥­ª®¬. ±«¨ ¦¥ ¤¥²¥© ¤¢®¥, ²°¥¡³¾²±¿ ­¥ª®²®°»¥ ¯°¨£®²®¢«¥­¨¿: ¬» ­ µ®¤¨¬ ±«¥¤³¾¹¨© (¢ ±¬»±«¥ ¯®°¿¤ª  ­ 
ª«¾· µ) §  z ½«¥¬¥­² y ; ³ ­¥£® ­¥² «¥¢®£® °¥¡¥­ª  (³¯°. 13.3-4).
¥¯¥°¼ ¬®¦­® ±ª®¯¨°®¢ ²¼ ª«¾· ¨ ¤®¯®«­¨²¥«¼­»¥ ¤ ­­»¥ ¨§ ¢¥°¸¨­» y ¢ ¢¥°¸¨­³ z ,   ± ¬³ ¢¥°¸¨­³ y ³¤ «¨²¼ ®¯¨± ­­»¬ ¢»¸¥
±¯®±®¡®¬.
°¨¬¥°­® ² ª ¨ ¤¥©±²¢³¥² ¯°®¶¥¤³°  Tree-Delete (µ®²¿ ° ±±¬ ²°¨¢ ¥² ½²¨ ²°¨ ±«³· ¿ ¢ ­¥±ª®«¼ª® ¤°³£®¬ ¯®°¿¤ª¥).

®¡ ¢«¥­¨¥ ¨ ³¤ «¥­¨¥ ½«¥¬¥­² 

257

Tree-Delete (T; z )
1 if left[z ] = nil ¨«¨ right[z ] = nil

2
then y z
3
else y Tree-Successor(z )
4 if left[y ] 6= nil
5
then x left[y ]
6
else x right[y ]
7 if x 6= nil
8
then p[x] p[y ]
9 if p[y ] = nil
10
then root[T ] x
11
else if y = left[p[y ]]
12
then left[p[y ]] x
13
else right[p[y ]] x
14 if y 6= z
15
then key[z ] key[y ]
16
. ª®¯¨°³¥¬ ¤®¯®«­¨²¥«¼­»¥ ¤ ­­»¥, ±¢¿§ ­­»¥ ± y
17 return y
 ±²°®ª µ 1{3 ®¯°¥¤¥«¿¥²±¿ ¢¥°¸¨­  y , ª®²®°³¾ ¬» ¯®²®¬ ¢»°¥¦¥¬ ¨§ ¤¥°¥¢ . ²® «¨¡® ± ¬  ¢¥°¸¨­  z (¥±«¨ ³ z ­¥ ¡®«¥¥ ®¤­®£®
°¥¡¥­ª ), «¨¡® ±«¥¤³¾¹¨© §  z ½«¥¬¥­² (¥±«¨ ³ z ¤¢®¥ ¤¥²¥©).  ²¥¬ ¢ ±²°®ª µ 4{6 ¯¥°¥¬¥­­ ¿ x ±² ­®¢¨²±¿ ³ª § ²¥«¥¬ ­  ±³¹¥±²¢³¾¹¥£® °¥¡¥­ª  ¢¥°¸¨­» y , ¨«¨ ° ¢­®© nil, ¥±«¨ ³ y ­¥² ¤¥²¥©.
¥°¸¨­  y ¢»°¥§ ¥²±¿ ¨§ ¤¥°¥¢  ¢ ±²°®ª µ 7{13 (¬¥­¿¾²±¿ ³ª § ²¥«¨ ¢ ¢¥°¸¨­ µ p[y ] ¨ x). °¨ ½²®¬ ®²¤¥«¼­® ° ±±¬ ²°¨¢ ¾²±¿
£° ­¨·­»¥ ±«³· ¨, ª®£¤  x = nil ¨ ª®£¤  y ¿¢«¿¥²±¿ ª®°­¥¬ ¤¥°¥¢ .  ª®­¥¶, ¢ ±²°®ª µ 14{16, ¥±«¨ ¢»°¥§ ­­ ¿ ¢¥°¸¨­  y ®²«¨·­ 
®² z , ª«¾· (¨ ¤®¯®«­¨²¥«¼­»¥ ¤ ­­»¥) ¢¥°¸¨­» y ¯¥°¥¬¥¹ ¾²±¿
¢ z (¢¥¤¼ ­ ¬ ­ ¤® ¡»«® ³¤ «¨²¼ z ,   ­¥ y ).  ª®­¥¶, ¯°®¶¥¤³°  ¢®§¢° ¹ ¥² ³ª § ²¥«¼ y (½²® ¯®§¢®«¨² ¢»§»¢ ¾¹¥© ¯°®¶¥¤³°¥
¢¯®±«¥¤±²¢¨¨ ®±¢®¡®¤¨²¼ ¯ ¬¿²¼, § ­¿²³¾ ¢¥°¸¨­®© y ). °¥¬¿ ¢»¯®«­¥­¨¿ ¥±²¼ O(h) ­  ¤¥°¥¢¥ ¢»±®²» h.
² ª, ¬» ¤®ª § «¨ ±«¥¤³¾¹³¾ ²¥®°¥¬³.
¥®°¥¬  13.2. ¯¥° ¶¨¨ Insert ¨ Delete ¬®£³² ¡»²¼ ¢»¯®«­¥­»
§  ¢°¥¬¿ O(h), £¤¥ h | ¢»±®²  ¤¥°¥¢ .
¯° ¦­¥­¨¿
13.3-1

Insert.

 ¯¨¸¨²¥ °¥ª³°±¨¢­»© ¢ °¨ ­² ¯°®¶¥¤³°» Tree-

13.3-2  ·¨­ ¿ ± ¯³±²®£® ¤¥°¥¢ , ¡³¤¥¬ ¤®¡ ¢«¿²¼ ½«¥¬¥­²» ±
° §«¨·­»¬¨ ª«¾· ¬¨ ®¤¨­ §  ¤°³£¨¬. ±«¨ ¯®±«¥ ½²®£® ¬» ¯°®¢®¤¨¬ ¯®¨±ª ½«¥¬¥­²  ± ª«¾·®¬ x, ²® ·¨±«® ±° ¢­¥­¨© ­  ¥¤¨­¨¶³

258

« ¢  13 ¢®¨·­»¥ ¤¥°¥¢¼¿ ¯®¨±ª 

¡®«¼¸¥ ·¨±«  ±° ¢­¥­¨©, ¢»¯®«­¥­­»µ ¯°¨ ¤®¡ ¢«¥­¨¨ ½²®£® ½«¥¬¥­² . ®·¥¬³?
13.3-3  ¡®° ¨§ n ·¨±¥« ¬®¦­® ®²±®°²¨°®¢ ²¼, ±­ · «  ¤®¡ ¢¨¢
¨µ ®¤¨­ §  ¤°³£¨¬ ¢ ¤¢®¨·­®¥ ¤¥°¥¢® ¯®¨±ª  (± ¯®¬®¹¼¾ ¯°®¶¥¤³°» Tree-Insert),   ¯®²®¬ ®¡®©²¨ ¤¥°¥¢® ± ¯®¬®¹¼¾ ¯°®¶¥¤³°»
Inorder-Tree-Walk.  ©¤¨²¥ ¢°¥¬¿ ° ¡®²» ² ª®£®  «£®°¨²¬  ¢
µ³¤¸¥¬ ¨ ¢ «³·¸¥¬ ±«³· ¥.
13.3-4 ®ª ¦¨²¥, ·²®, ¥±«¨ ¢¥°¸¨­  ¤¢®¨·­®£® ¤¥°¥¢  ¯®¨±ª 
¨¬¥¥² ¤¢®¨µ ¤¥²¥©, ²® ±«¥¤³¾¹ ¿ §  ­¥© ¢¥°¸¨­  ­¥ ¨¬¥¥² «¥¢®£®
°¥¡¥­ª ,   ¯°¥¤¸¥±²¢³¾¹ ¿ ¥© ¢¥°¸¨­  | ¯° ¢®£®.
13.3-5 °¥¤¯®«®¦¨¬, ·²® ³ª § ²¥«¼ ­  ¢¥°¸¨­³ y µ° ­¨²±¿ ¢
ª ª®©-²® ¢­¥¸­¥© ±²°³ª²³°¥ ¤ ­­»µ ¨ ·²® ¯°¥¤¸¥±²¢³¾¹ ¿ y ¢¥°¸¨­  ¤¥°¥¢  ³¤ «¿¥²±¿ ± ¯®¬®¹¼¾ ¯°®¶¥¤³°» Tree-Delete.  ª¨¥ ¯°¨ ½²®¬ ¬®£³² ¢®§­¨ª­³²¼ ¯°®¡«¥¬»?  ª ¬®¦­® ¨§¬¥­¨²¼
Tree-Delete, ·²®¡» ½²¨µ ¯°®¡«¥¬ ¨§¡¥¦ ²¼?
13.3-6 ®¬¬³²¨°³¾² «¨ ®¯¥° ¶¨¨ ³¤ «¥­¨¿ ¤¢³µ ¢¥°¸¨­? °³£¨¬¨ ±«®¢ ¬¨, ¯®«³·¨¬ «¨ ¬» ®¤¨­ ª®¢»¥ ¤¥°¥¢¼¿, ¥±«¨ ¢ ®¤­®¬
±«³· ¥ ³¤ «¨¬ ±­ · «  x,   ¯®²®¬ y ,   ¢ ¤°³£®¬ | ­ ®¡®°®²? ¡º¿±­¨²¥ ±¢®© ®²¢¥².
±«¨ ³ z ¤¢®¥ ¤¥²¥©, ¬» ¬®¦¥¬ ¨±¯®«¼§®¢ ²¼ ¢ TreeDelete ­¥ ±«¥¤³¾¹¨© §  z ½«¥¬¥­²,   ¯°¥¤»¤³¹¨©. ®¦­® ­ ¤¥¿²¼±¿, ·²® ±¯° ¢¥¤«¨¢»© ¯®¤µ®¤, ª®²®°»© ¢ ¯®«®¢¨­¥ ±«³· ¥¢
¢»¡¨° ¥² ¯°¥¤»¤³¹¨©,   ¢ ¯®«®¢¨­¥ | ±«¥¤³¾¹¨© ½«¥¬¥­², ¡³¤¥²
¯°¨¢®¤¨²¼ ª «³·¸¥ ±¡ « ­±¨°®¢ ­­®¬³ ¤¥°¥¢³.  ª ¨§¬¥­¨²¼ ²¥ª±²
¯°®¶¥¤³°», ·²®¡» °¥ «¨§®¢ ²¼ ² ª®© ¯®¤µ®¤?
13.3-7

? 13.4 «³· ©­»¥ ¤¢®¨·­»¥ ¤¥°¥¢¼¿ ¯®¨±ª 
 ª ¬» ¢¨¤¥«¨, ®±­®¢­»¥ ®¯¥° ¶¨¨ ± ¤¢®¨·­»¬¨ ¤¥°¥¢¼¿¬¨ ¯®¨±ª  ²°¥¡³¾² ¢°¥¬¥­¨ O(h), £¤¥ h | ¢»±®²  ¤¥°¥¢ . ®½²®¬³ ¢ ¦­®
¯®­¿²¼, ª ª®¢  ¢»±®²  À²¨¯¨·­®£®Á ¤¥°¥¢ . «¿ ½²®£® ­¥®¡µ®¤¨¬®
¯°¨­¿²¼ ª ª¨¥-²® ±² ²¨±²¨·¥±ª¨¥ ¯°¥¤¯®«®¦¥­¨¿ ® ° ±¯°¥¤¥«¥­¨¨
ª«¾·¥© ¨ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¢»¯®«­¿¥¬»µ ®¯¥° ¶¨©.
 ±®¦ «¥­¨¾, ¢ ®¡¹¥¬ ±«³· ¥ ±¨²³ ¶¨¿ ²°³¤­  ¤«¿  ­ «¨§ , ¨ ¬»
¡³¤¥¬ ° ±±¬ ²°¨¢ ²¼ «¨¸¼ ¤¥°¥¢¼¿, ¯®«³·¥­­»¥ ¤®¡ ¢«¥­¨¥¬ ¢¥°¸¨­ (¡¥§ ³¤ «¥­¨©). ¯°¥¤¥«¨¬ ±«³· ©­®¥ ¤¢®¨·­®¥ ¤¥°¥¢® (randomly built search tree) ¨§ n ° §«¨·­»µ ª«¾·¥© ª ª ¤¥°¥¢®, ¯®«³· ¾¹¥¥±¿ ¨§ ¯³±²®£® ¤¥°¥¢  ¤®¡ ¢«¥­¨¥¬ ½²¨µ ª«¾·¥© ¢ ±«³· ©­®¬ ¯®°¿¤ª¥ (¢±¥ n! ¯¥°¥±² ­®¢®ª ±·¨² ¥¬ ° ¢­®¢¥°®¿²­»¬¨). ( ª

13.4 «³· ©­»¥ ¤¢®¨·­»¥ ¤¥°¥¢¼¿ ¯®¨±ª 

259

¢¨¤­® ¨§ ³¯°. 13.4-2, ½²® ­¥ ®§­ · ¥², ·²® ¢±¥ ¤¢®¨·­»¥ ¤¥°¥¢¼¿ ° ¢­®¢¥°®¿²­», ¯®±ª®«¼ª³ ° §­»¥ ¯®°¿¤ª¨ ¤®¡ ¢«¥­¨¿ ¬®£³² ¯°¨¢®¤¨²¼ ª ®¤­®¬³ ¨ ²®¬³ ¦¥ ¤¥°¥¢³.)  ½²®¬ ° §¤¥«¥ ¬» ¤®ª ¦¥¬, ·²®
¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ¢»±®²» ±«³· ©­®£® ¤¥°¥¢  ¨§ n ª«¾·¥©
¥±²¼ O(lg n).
®±¬®²°¨¬, ª ª ±¢¿§ ­  ±²°³ª²³°  ¤¥°¥¢  ± ¯®°¿¤ª®¬ ¤®¡ ¢«¥­¨¿ ª«¾·¥©.
¥¬¬  13.3. ³±²¼ T | ¤¥°¥¢®, ¯®«³· ¾¹¥¥±¿ ¯®±«¥ ¤®¡ ¢«¥­¨¿
n ° §«¨·­»µ ª«¾·¥© k1; k2; : : :; kn (¢ ³ª § ­­®¬ ¯®°¿¤ª¥) ª ¨§­ · «¼­® ¯³±²®¬³ ¤¥°¥¢³. ®£¤  ki ¿¢«¿¥²±¿ ¯°¥¤ª®¬ kj ¢ T ²®£¤ 
¨ ²®«¼ª® ²®£¤ , ª®£¤  i < j , ¨ ¯°¨ ½²®¬
ki = minfkl : 1 6 l 6 i ¨ kl > kj g
(ª«¾· ki ¡®«¼¸¥ kj ¨ ¨µ ­¥ ° §¤¥«¿¥² ­¨ ®¤¨­ ª«¾· ±°¥¤¨ k1; : : :; ki)
¨«¨
ki = maxfkl : 1 6 l 6 i ¨ kl < kj g
(ª«¾· ki ¬¥­¼¸¥ kj ¨ ¨µ ­¥ ° §¤¥«¿¥² ­¨ ®¤¨­ ª«¾· ±°¥¤¨
k1; : : : ; ki)
®ª § ²¥«¼±²¢®. ): °¥¤¯®«®¦¨¬, ·²® ki ¿¢«¿¥²±¿ ¯°¥¤ª®¬ kj .
·¥¢¨¤­®, i < j (¯®²®¬®ª ¯®¿¢«¿¥²±¿ ¢ ¤¥°¥¢¥ ¯®§¦¥ ¯°¥¤ª ).  ±±¬®²°¨¬ ¤¥°¥¢® Ti , ª®²®°®¥ ¯®«³· ¥²±¿ ¯®±«¥ ¤®¡ ¢«¥­¨¿ ª«¾·¥©
k1; k2; : : :; ki. ³²¼ ¢ Ti ®² ª®°­¿ ¤® ki ²®² ¦¥, ·²® ¨ ¯³²¼ ¢ T ®² ª®°­¿ ¤® ki .  ª¨¬ ®¡° §®¬, ¥±«¨ ¡» ª«¾· kj ¡»« ¤®¡ ¢«¥­ ¢ Ti, ®­ ±² «
¡» ¯° ¢»¬ ¨«¨ «¥¢»¬ °¥¡¥­ª®¬ ki . «¥¤®¢ ²¥«¼­® (±¬. ³¯°. 13.2-6),
ki ¿¢«¿¥²±¿ «¨¡® ­ ¨¬¥­¼¸¨¬ ±°¥¤¨ ²¥µ ª«¾·¥© ¨§ k1; k2; : : :; ki, ª®²®°»¥ ¡®«¼¸¥ kj , «¨¡® ­ ¨¡®«¼¸¨¬ ±°¥¤¨ ª«¾·¥© ¨§ ²®£® ¦¥ ­ ¡®° , ¬¥­¼¸¨µ kj .
(: °¥¤¯®«®¦¨¬, ·²® ki ¿¢«¿¥²±¿ ­ ¨¬¥­¼¸¨¬ ±°¥¤¨ ²¥µ ª«¾·¥©
k1; k2; : : :; ki, ª®²®°»¥ ¡®«¼¸¥ kj . (°³£®© ±«³· © ±¨¬¬¥²°¨·¥­.)
²® ¡³¤¥² ¯°®¨±µ®¤¨²¼ ¯°¨ ¯®¬¥¹¥­¨¨ ª«¾·  kj ¢ ¤¥°¥¢®? ° ¢­¥­¨¥ kj ± ª«¾· ¬¨ ­  ¯³²¨ ®² ª®°­¿ ª ki ¤ ±² ²¥ ¦¥ °¥§³«¼² ²»,
·²® ¨ ¤«¿ ki . «¥¤®¢ ²¥«¼­®, ¬» ¯°®©¤¥¬ ¯³²¼ ®² ª®°­¿ ¤® ki , ² ª
·²® kj ±² ­¥² ¯®²®¬ª®¬ ki .
¥¬¬  ¤®ª § ­ .
¥¯¥°¼ ¬®¦­® ¯®­¿²¼, ª ª § ¢¨±¨² £«³¡¨­  ª ¦¤®£® ª«¾·  ®²
¯¥°¥±² ­®¢ª¨ ­  ¢µ®¤¥.
«¥¤±²¢¨¥ 13.4. ³±²¼ T | ¤¥°¥¢®, ¯®«³·¥­­®¥ ¨§ ¯³±²®£® ¤®¡ ¢«¥­¨¥¬ n ° §«¨·­»µ ª«¾·¥© k1 ; k2; : : :; kn (¢ ³ª § ­­®¬ ¯®°¿¤ª¥).
«¿ ª ¦¤®£® ª«¾·  kj (¯°¨ ¢±¥µ 1 6 j 6 n) ° ±±¬®²°¨¬ ¬­®¦¥±²¢ 
Gj = fki : 1 6 i < j ¨ kl > ki > kj ¯°¨ ¢±¥µ l < i, ¤«¿ ª®²®°»µ kl > kj g
¨
Lj = fki : 1 6 i < j ¨ kl < ki < kj ¯°¨ ¢±¥µ l < i, ¤«¿ ª®²®°»µ kl < kj g:

260

« ¢  13 ¢®¨·­»¥ ¤¥°¥¢¼¿ ¯®¨±ª 

®£¤  ª«¾·¨ ­  ¯³²¨ ¨§ ª®°­¿ ¢ kj | ¢ ²®·­®±²¨ Gj [ Lj ,   £«³¡¨­  kj ¢ ¤¥°¥¢¥ T ° ¢­ 
d(kj ; T ) = jGj j + jLj j:
  °¨±³­ª¥ 13.5 ¨§®¡° ¦¥­» ¬­®¦¥±²¢  Gj ¨ Lj . µ ¯®±²°®¥­¨¥
¬®¦­® ®¡º¿±­¨²¼ ² ª. ·¨² ¿ ¤«¿ ­ £«¿¤­®±²¨ ª«¾·¨ ·¨±« ¬¨, ¡³¤¥¬ ®²¬¥· ²¼ ¨µ ­  ·¨±«®¢®© ®±¨: ±­ · «  k1, ¯®²®¬ k2 ¨ ² ª ¤ «¥¥
¢¯«®²¼ ¤® kj .  ª ¦¤»© ¬®¬¥­² ­  ®±¨ ®²¬¥·¥­® ­¥±ª®«¼ª® ²®·¥ª
k1; : : :; kt (£¤¥ 1 6 t 6 j ; 1). ®±¬®²°¨¬, ª ª ¿ ¨§ ½²¨µ ²®·¥ª
¡³¤¥² ¡«¨¦ ©¸¥© ±¯° ¢  ª ¡³¤³¹¥¬³ ¯®«®¦¥­¨¾ ª«¾·  kj . ­®¦¥±²¢® ¢±¥µ ² ª¨µ ¡«¨¦ ©¸¨µ ²®·¥ª (¤«¿ ¢±¥µ ¬®¬¥­²®¢ ¢°¥¬¥­¨
t = 1; 2; : : : ; j ; 1) ¨ ¥±²¼ Gj . «¨¦ ©¸¨¥ ±«¥¢  ²®·ª¨ ®¡° §³¾²
¬­®¦¥±²¢® Lj .
 ¸  ¶¥«¼ | ®¶¥­¨²¼ ±¢¥°µ³ ª®«¨·¥±²¢® ½«¥¬¥­²®¢ ¢ Gj ¨ Lj ,
¯®±ª®«¼ª³ ±³¬¬  ½²¨µ ª®«¨·¥±²¢ ° ¢­  £«³¡¨­¥ ª«¾·  kj . ¨ª±¨°³¥¬ ­¥ª®²®°®¥ j . ¨±«® ½«¥¬¥­²®¢ ¢ Gj ¡³¤¥² ±«³· ©­®© ¢¥«¨·¨­®©, § ¢¨±¿¹¥© ®² ¯®°¿¤ª  ª«¾·¥© ­  ¢µ®¤¥ (¨¬¥¥² §­ ·¥­¨¥ «¨¸¼
¯®°¿¤®ª ­  ª«¾· µ k1 ; : : :; kj ). » µ®²¨¬ ®¶¥­¨²¼ ½²® ·¨±«® ±¢¥°µ³
(¤®ª § ²¼, ·²® ¢¥°®¿²­®±²¼ ±®¡»²¨¿ À½²® ·¨±«® ¢¥«¨ª®Á ¬ « ).
«¥¤³¾¹¨© ´ ª² ¨§ ²¥®°¨¨ ¢¥°®¿²­®±²¥© ¨£° ¥² ¶¥­²° «¼­³¾
°®«¼ ¯°¨ ½²®© ®¶¥­ª¥.
¥¬¬  13.5. ³±²¼ k1; k2; : : :; kn ¥±²¼ ±«³· ©­ ¿ ¯¥°¥±² ­®¢ª 
n ° §«¨·­»µ ·¨±¥«. «¿ ª ¦¤®£® i ®² 1 ¤® n ° ±±¬®²°¨¬ ¬¨­¨¬ «¼­»© ½«¥¬¥­² ¢ ¬­®¦¥±²¢¥ fk1; k2; : : :; kig. ­®¦¥±²¢® ¢±¥µ
² ª¨µ ½«¥¬¥­²®¢ ­ §®¢¥¬ S :
S = fki : 1 6 i 6 n ¨ kl > ki ¤«¿ ¢±¥µ l < ig:
(13.1)
®£¤  PfjS j > ( + 1)Hn g 6 1=n2 , £¤¥ Hn | n-¿ · ±²¨·­ ¿ ±³¬¬ 
£ °¬®­¨·¥±ª®£® °¿¤ ,     4;32 | ª®°¥­¼ ³° ¢­¥­¨¿ (ln  ;1) = 2.
®ª § ²¥«¼±²¢®. ³¤¥¬ ±«¥¤¨²¼ §  ²¥¬, ª ª ¬¥­¿¥²±¿ ¬­®¦¥±²¢®
fk1; : : :; kig ± °®±²®¬ i.   i-¬ ¸ £¥ ª ­¥¬³ ¤®¡ ¢«¿¥²±¿ ½«¥¬¥­² ki,
¯°¨·¥¬ ®­ ± ° ¢­»¬¨ ¢¥°®¿²­®±²¿¬¨ ¬®¦¥² ®ª § ²¼±¿ ¯¥°¢»¬,
¢²®°»¬,: : : , i-¬ ¯® ¢¥«¨·¨­¥ (ª ¦¤®© ¨§ ½²¨µ ¢®§¬®¦­®±²¥© ±®®²¢¥²±²¢³¥² ° ¢­ ¿ ¤®«¿ ¢µ®¤­»µ ¯¥°¥±² ­®¢®ª).  ª¨¬ ®¡° §®¬,
¢¥°®¿²­®±²¼ ³¢¥«¨·¥­¨¿ ¬­®¦¥±²¢  S ­  i-¬ ¸ £¥ ° ¢­  1=i ¯°¨
«¾¡®¬ ¯®°¿¤ª¥ ±°¥¤¨ ª«¾·¥© k1; : : :; ki;1, ² ª ·²® ¤«¿ ° §­»µ i ½²¨
±®¡»²¨¿ ­¥§ ¢¨±¨¬».
» ¯°¨µ®¤¨¬ ª ±¨²³ ¶¨¨, ®¯¨± ­­®© ¢ ²¥®°¥¬¥ 6.6: ¨¬¥¥²±¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ­¥§ ¢¨±¨¬»µ ¨±¯»² ­¨©, ¢¥°®¿²­®±²¼ ³±¯¥µ  ¢
i-¬ ¨±¯»² ­¨¨ ° ¢­  1=i.  ¬ ­ ¤® ®¶¥­¨²¼ ·¨±«® ³±¯¥µ®¢.
 ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ½²®£® ·¨±«  ° ¢­® 1+1=2+ : : : +1=i =
Hi = ln i + O(1), ±¬. ´®°¬³«³ (3.5) ¨ § ¤ ·³ 6-2.  ¬ ­ ¤® ®¶¥­¨²¼
¢¥°®¿²­®±²¼ ²®£®, ·²® ·¨±«® ³±¯¥µ®¢ ¡®«¼¸¥ ±¢®¥£® ¬ ²¥¬ ²¨·¥±ª®£® ®¦¨¤ ­¨¿ ¢  + 1 ° §.

13.4 «³· ©­»¥ ¤¢®¨·­»¥ ¤¥°¥¢¼¿ ¯®¨±ª 

261

²® ¤¥« ¥²±¿ ± ¯®¬®¹¼¾ ²¥®°¥¬» 6.6.  ¯®¬­¨¬, ·²® ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ jS j ¥±²¼  = Hn > ln n, ¨ ¯® ²¥®°¥¬¥ 6.6 ¬»
¨¬¥¥¬
PfjS j > ( + 1)Hn g = P fjS j ;  > Hn g 6
Hn
eH
n
=
6 H
n
= e(1;ln  )Hn 6
6 e;(ln ;1) ln n =
= n;(ln  ;1) =
= 1=n2


±®£« ±­® ®¯°¥¤¥«¥­¨¾ ·¨±«   .
®±«¥ ² ª®© ¯®¤£®²®¢ª¨ ¢¥°­¥¬±¿ ª ¤¥°¥¢¼¿¬ ¯®¨±ª .
¥®°¥¬  13.6. °¥¤­¿¿ ¢»±®²  ±«³· ©­®£® ¤¢®¨·­®£® ¤¥°¥¢  ¯®¨±ª , ¯®±²°®¥­­®£® ¯® n ° §«¨·­»¬ ª«¾· ¬, ¥±²¼ O(lg n).
®ª § ²¥«¼±²¢®. ³±²¼ k1; k2; : : :; kn | ±«³· ©­ ¿ ¯¥°¥±² ­®¢ª 
¤ ­­»µ n ª«¾·¥©, T | ¤¥°¥¢®, ¯®«³·¥­­®¥ ¯®±«¥¤®¢ ²¥«¼­»¬ ¤®¡ ¢«¥­¨¥¬ ½²¨µ ª«¾·¥© ª ¯³±²®¬³. «¿ ´¨ª±¨°®¢ ­­®£® ­®¬¥°  j ¨
¤«¿ ¯°®¨§¢®«¼­®£® ·¨±«  t ° ±±¬®²°¨¬ ¢¥°®¿²­®±²¼ ²®£®, ·²® £«³¡¨­  d(kj ; T ) ª«¾·  kj ­¥ ¬¥­¼¸¥ t. ®£« ±­® ±«¥¤±²¢¨¾ 13.4, ¢ ½²®¬
±«³· ¥ µ®²¿ ¡» ®¤­® ¨§ ¬­®¦¥±²¢ Gj ¨ Lj ¤®«¦­® ¨¬¥²¼ ° §¬¥° ­¥
¬¥­¥¥ t=2.  ª¨¬ ®¡° §®¬,
Pfd(kj ; T ) > tg 6 PfjGj j > t=2g + PfjLj j > t=2g:
(13.2)
­ · «¥ ° ±±¬®²°¨¬ PfjGj j > t=2g. ¶¥­¨¬ ³±«®¢­³¾ ¢¥°®¿²­®±²¼
½²®£® ±®¡»²¨¿ ¯°¨ ´¨ª±¨°®¢ ­­®¬ ¬­®¦¥±²¢¥ U = ft : 1 6 t 6
j ; 1 ¨ kt > kj g (²® ¥±²¼ ª®£¤  ¨§¢¥±²­®, ª ª¨¥ ¨§ ½«¥¬¥­²®¢
k1; : : :; kj;1 ¡®«¼¸¥ kj ). » ­ µ®¤¨¬±¿ ¢ ±¨²³ ¶¨¨ «¥¬¬» 13.5 (¢±¥
¯¥°¥±² ­®¢ª¨ ½«¥¬¥­²®¢ ± ¨­¤¥ª± ¬¨ ¨§ U ° ¢­®¢¥°®¿²­»), ¨ ¯®½²®¬³ ³±«®¢­ ¿ ¢¥°®¿²­®±²¼ ±®¡»²¨¿ jGj j > t=2 ¯°¨ ¤ ­­®¬ U ° ¢­  ¢¥°®¿²­®±²¨ ²®£®, ·²® ¢ ±«³· ©­®© ¯¥°¥±² ­®¢ª¥ ¨§ u = jU j ½«¥¬¥­²®¢ ¥±²¼ ¯® ª° ©­¥© ¬¥°¥ t=2 ½«¥¬¥­²®¢, ¬¥­¼¸¨µ ¢±¥µ ¯°¥¤»¤³¹¨µ.  °®±²®¬ u ½²  ¢¥°®¿²­®±²¼ ²®«¼ª® ° ±²¥², ² ª ·²® ¢±¥
³±«®¢­»¥ ¢¥°®¿²­®±²¨ ­¥ ¯°¥¢®±µ®¤¿² PfjS j > t=2g, £¤¥ S ®¯°¥¤¥«¥­® ª ª ¢ «¥¬¬¥ 13.5. ®½²®¬³ ¨ ¯®«­ ¿ ¢¥°®¿²­®±²¼ ±®¡»²¨¿
fjGj j > t=2g ­¥ ¯°¥¢®±µ®¤¨² PfjS j > t=2g.
­ «®£¨·­»¬ ®¡° §®¬
PfjLj j > t=2g 6 PfjS j > t=2g
¨, ±®£« ±­® ­¥° ¢¥­±²¢³ (13.2),
Pfd(kj ; T ) > tg 6 2PfjS j > t=2g:

262

« ¢  13 ¢®¨·­»¥ ¤¥°¥¢¼¿ ¯®¨±ª 

§¿¢ ²¥¯¥°¼ t = 2( + 1)Hn , £¤¥ Hn = 1 + 1=2 + : : : + 1=n (    4;32
| ª®°¥­¼ ³° ¢­¥­¨¿ (ln  ; 1) = 2) ¨ ¯°¨¬¥­¨¢ «¥¬¬³ 13.5, ¬»
§ ª«¾· ¥¬, ·²®

Pfd(kj ; T ) > 2( + 1)Hn g 6 2PfjS j > ( + 1)Hn g 6 2=n2 :
±¥£® ¢¥°¸¨­ ¢ ¤¥°¥¢¥ ­¥ ¡®«¥¥ n, ¯®½²®¬³ ¢¥°®¿²­®±²¼ ²®£®,
·²® ª ª ¿-²® ¢¥°¸¨­  ¡³¤¥² ¨¬¥²¼ £«³¡¨­³ 2( +1)Hn ¨«¨ ¡®«¼¸¥,
­¥ ¡®«¥¥ ·¥¬ ¢ n ° § ¯°¥¢®±µ®¤¨² ² ª³¾ ¦¥ ¢¥°®¿²­®±²¼ ¤«¿ ®¤­®©
¢¥°¸¨­», ¨ ¯®²®¬³ ­¥ ¯°¥¢®±µ®¤¨² 2=n. ² ª, ± ¢¥°®¿²­®±²¼¾ ¯®
¬¥­¼¸¥© ¬¥°¥ 1 ; 2=n ¢»±®²  ±«³· ©­®£® ¤¥°¥¢  ­¥ ¯°¥¢®±µ®¤¨²
2( + 1)Hn , ¨ ¢ «¾¡®¬ ±«³· ¥ ®­  ­¥ ¡®«¼¸¥ n.  ª¨¬ ®¡° §®¬,
¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ­¥ ¯°¥¢®±µ®¤¨² (2( + 1)Hn)(1 ; 2=n) +
n(2=n) = O(lg n).
¯° ¦­¥­¨¿
13.4-1 °¨¢¥¤¨²¥ ¯°¨¬¥° ¤¥°¥¢  ¯®¨±ª , ¢ ª®²®°®¬ ±°¥¤­¿¿ (¯®
¢±¥¬ ¢¥°¸¨­ ¬) £«³¡¨­  ¢¥°¸¨­» ¥±²¼ (lg n), ­® ¢»±®²  ¤¥°¥¢ 
¥±²¼ ! (lg n).  ±ª®«¼ª® ¢¥«¨ª  ¬®¦¥² ¡»²¼ ¢»±®²  ¤¥°¥¢ , ¥±«¨
±°¥¤­¿¿ £«³¡¨­  ¢¥°¸¨­» ¥±²¼ (lg n)?
13.4-2 ®ª ¦¨²¥, ·²® ¯°¨ ­ ¸¥¬ ¯®­¨¬ ­¨¨ ±«³· ©­®£® ¤¢®¨·­®£® ¤¥°¥¢  ¯®¨±ª  ­¥ ¢±¥ ³¯®°¿¤®·¥­­»¥ ¤¥°¥¢¼¿ ± ¤ ­­»¬¨
n ª«¾· ¬¨ ° ¢­®¢¥°®¿²­». (ª § ­¨¥:  ±±¬®²°¨²¥ ±«³· © n = 3.)
13.4-3? «¿ ¤ ­­®© ª®­±² ­²» r > 1 ³ª ¦¨²¥ ª®­±² ­²³ t, ¤«¿ ª®²®°®© ¢¥°®¿²­®±²¼ ±®¡»²¨¿ À¢»±®²  ±«³· ©­®£® ¤¢®¨·­®£® ¤¥°¥¢ 
¯®¨±ª  ­¥ ¬¥­¼¸¥ tHn Á ¬¥­¼¸¥ 1=nr .
13.4-4?  ±±¬®²°¨¬  «£®°¨²¬ Randomized-Quicksort, ¯°¨¬¥­¥­­»© ª ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¨§ n ·¨±¥«. ®ª ¦¨²¥, ·²® ¤«¿
«¾¡®© ª®­±² ­²» k > 0 ±³¹¥±²¢³¥² ² ª ¿ ª®­±² ­²  c, ·²® ±
¢¥°®¿²­®±²¼¾ ­¥ ¬¥­¥¥ 1 ; c=nk  «£®°¨²¬ § ¢¥°¸ ¥² ° ¡®²³ § 
¢°¥¬¿ cn lg n.

 ¤ ·¨
13-1 ¢®¨·­»¥ ¤¥°¥¢¼¿ ¯®¨±ª  ¨ ° ¢­»¥ ª«¾·¨
 ¢­»¥ ª«¾·¨ | ¨±²®·­¨ª ¯°®¡«¥¬ ¯°¨ ° ¡®²¥ ± ¤¥°¥¢¼¿¬¨ ¯®¨±ª .
 .  ª®¢   ±¨¬¯²®²¨ª  ¢°¥¬¥­¨ ° ¡®²» ¯°®¶¥¤³°» Tree-Insert
¯°¨ ¤®¡ ¢«¥­¨¨ n ®¤¨­ ª®¢»µ ª«¾·¥© ¢ ¨§­ · «¼­® ¯³±²®¥ ¤¥°¥¢®?

 ¤ ·¨ ª £« ¢¥ 13

263

°¨·¨­  ²³² ¢ ²®¬, ·²® ¯°¨ ¢»¡®°¥ ¢ ±²°®ª µ 5{7 ¨ 11{13 ¬» ¢ ±«³· ¥ ° ¢¥­±²¢  ¢±¥£¤  ¤¢¨£ ¥¬±¿ ­ ¯° ¢® ¯® ¤¥°¥¢³. ³¤¥¬ ° ±±¬ ²°¨¢ ²¼ ±«³· © ° ¢¥­±²¢  ®²¤¥«¼­®. ¶¥­¨²¥  ±¨¬¯²®²¨ª³ ¢°¥¬¥­¨ ¤®¡ ¢«¥­¨¿ n ° ¢­»µ ª«¾·¥© ¢ ¯³±²®¥ ¤¥°¥¢® ¯°¨ ¨±¯®«¼§®¢ ­¨¨
²°¥µ ° §«¨·­»µ ¯®¤µ®¤®¢:
¡. ° ­¨¬ ¢ ¢¥°¸¨­¥ x ´« £ b[x], ¨ ¢»¡¨° ¥¬ «¥¢®£® ¨«¨ ¯° ¢®£® °¥¡¥­ª  ¢ § ¢¨±¨¬®±²¨ ®² §­ ·¥­¨¿ b[x]. °¨ ½²®¬ ´« £ ¬¥­¿¥²±¿ ¯°¨ ª ¦¤®¬ ¯®±¥¹¥­¨¨ ¢¥°¸¨­», ² ª ·²® ­ ¯° ¢«¥­¨¿
·¥°¥¤³¾²±¿.
¢. ° ­¨¬ ½«¥¬¥­²» ± ° ¢­»¬¨ ª«¾· ¬¨ ¢ ®¤­®© ¢¥°¸¨­¥ (± ¯®¬®¹¼¾ ±¯¨±ª ) ¨ ¤®¡ ¢«¿¥¬ ½«¥¬¥­² ± ³¦¥ ¢±²°¥· ¢¸¨¬±¿ ª«¾·®¬
¢ ½²®² ±¯¨±®ª.
£.  ¯° ¢«¥­¨¥ ¤¢¨¦¥­¨¿ ¢»¡¨° ¥¬ ±«³· ©­®. ( ª®¢® ¡³¤¥² ¢°¥¬¿ ¢ µ³¤¸¥¬ ±«³· ¥? ²® ¢» ¬®¦¥²¥ ±ª § ²¼ ® ¬ ²¥¬ ²¨·¥±ª®¬
®¦¨¤ ­¨¨?)
13-2 ¨´°®¢»¥ ¤¥°¥¢¼¿
 ±±¬®²°¨¬ ¤¢¥ ±²°®ª¨ a = a0 a1 : : :ap ¨ b = b0 b1 : : :bq , ±®±² ¢«¥­­»¥ ¨§ ±¨¬¢®«®¢ ­¥ª®²®°®£® (³¯®°¿¤®·¥­­®£®)  «´ ¢¨² . ®¢®°¿²,
·²® ±²°®ª  a «¥ª±¨ª®£° ´¨·¥±ª¨ ¬¥­¼¸¥ ±²°®ª¨ b (a is lexicographically less than b), ¥±«¨ ¢»¯®«­¿¥²±¿ ®¤­® ¨§ ¤¢³µ ³±«®¢¨©:
1. ³¹¥±²¢³¥² ·¨±«® j ¨§ 0:: min(p; q ), ¯°¨ ª®²®°®¬ ai = bi ¤«¿ ¢±¥µ
i = 0; 1; : : :; j ; 1 ¨ aj < bj .
2. p < q ¨ ai = bi ¤«¿ ¢±¥µ i = 0; 1; : : :; p.
 ¯°¨¬¥°, 10100 < 10110 ±®£« ±­® ¯° ¢¨«³ 1 (¯°¨ j = 3),   10100 <
101000 ±®£« ±­® ¯° ¢¨«³ 2.  ª®© ¯®°¿¤®ª ¯°¨¬¥­¿¥²±¿ ¢ ±«®¢ °¿µ.
²°®¥­¨¥ ¶¨´°®¢®£® ¤¥°¥¢  (radix tree) ¢¨¤­® ¨§ ¯°¨¬¥°  ­ 
°¨±. 13.6, £¤¥ ¯®ª § ­® ¤¥°¥¢®, µ° ­¿¹¥¥ ¡¨²®¢»¥ ±²°®ª¨ 1011, 10,
011, 100 ¨ 0. °¨ ¯®¨±ª¥ ±²°®ª¨ a = a0 a1 : : :ap ¬» ­  i-¬ ¸ £¥ ¨¤¥¬
­ «¥¢® ¯°¨ ai = 0 ¨ ­ ¯° ¢® ¯°¨ ai = 1. ³±²¼ ½«¥¬¥­² ¬¨ ¬­®¦¥±²¢  S ¿¢«¿¾²±¿ ¯®¯ °­® ° §«¨·­»¥ ¡¨²®¢»¥ ±²°®ª¨ ±³¬¬ °­®©
¤«¨­» n. ®ª ¦¨²¥, ª ª ± ¯®¬®¹¼¾ ¶¨´°®¢®£® ¤¥°¥¢  ®²±®°²¨°®¢ ²¼ S ¢ «¥ª±¨ª®£° ´¨·¥±ª®¬ ¯®°¿¤ª¥ §  (n) ¤¥©±²¢¨©. ( ¯°¨¬¥°, ¤«¿ ¬­®¦¥±²¢  °¨±. 13.6 °¥§³«¼² ²®¬ ±®°²¨°®¢ª¨ ¡³¤¥²
¯®±«¥¤®¢ ²¥«¼­®±²¼ 0; 011; 10; 100; 1011.)
13-3 °¥¤­¿¿ £«³¡¨­  ¢¥°¸¨­» ¢ ±«³· ©­®¬ ¤¢®¨·­®¬ ¤¥°¥¢¥
 ½²®© § ¤ ·¥ ¬» ¤®ª ¦¥¬, ·²® ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ±°¥¤­¥© £«³¡¨­» ¢¥°¸¨­» ¢ ±«³· ©­®¬ ¤¢®¨·­®¬ ¤¥°¥¢¥ ± n ¢¥°¸¨­ ¬¨ ¥±²¼ O(lg n). ®²¿ ½²®² °¥§³«¼² ² ±« ¡¥¥, ·¥¬ °¥§³«¼² ² ²¥®°¥¬» 13.6, ¤®ª § ²¥«¼±²¢® ³±² ­ ¢«¨¢ ¥² ¨­²¥°¥±­»¥  ­ «®£¨¨
¬¥¦¤³ ¤¢®¨·­»¬¨ ¤¥°¥¢¼¿¬¨ ¯®¨±ª  ¨ ¯°®¶¥¤³°®© RandomizedQuicksort ¨§ ° §¤¥«  8.3.

264

« ¢  13 ¢®¨·­»¥ ¤¥°¥¢¼¿ ¯®¨±ª 

 ±±¬®²°¨¬ (±°. £« ¢³ 5, ³¯°. 5.5-6) ±³¬¬³ £«³¡¨­ d(x; T ) ¢±¥µ
¢¥°¸¨­ x ¤¥°¥¢  T , ª®²®°³¾ ¬» ¡³¤¥¬ ®¡®§­ · ²¼ P (T ).
 . °¥¤­¿¿ £«³¡¨­  ¢¥°¸¨­» ¢ ¤¥°¥¢¥ T ¥±²¼
1 X d(x; T ) = 1 P (T ):

n x2T

¡.

¢.

n

 ª¨¬ ®¡° §®¬, ­ ¤® ¯®ª § ²¼, ·²® ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥
P (T ) ¥±²¼ O(n lg n).
¡®§­ ·¨¬ ·¥°¥§ TL ¨ TR «¥¢®¥ ¨ ¯° ¢®¥ ¯®¤¤¥°¥¢¼¿ ¤¥°¥¢  T .
¡¥¤¨²¥±¼, ·²® ¥±«¨ T ±®¤¥°¦¨² n ¢¥°¸¨­, ²®

P (T ) = P (TL ) + P (TR) + n ; 1:
¡®§­ ·¨¬ ·¥°¥§ P (n) ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ¢­³²°¥­­¥©
±³¬¬» ¤«¨­ ¤«¿ ±«³· ©­®£® ¤¢®¨·­®£® ¤¥°¥¢  ¯®¨±ª  ± n ¢¥°¸¨­ ¬¨. ®ª ¦¨²¥, ·²®

P (n) = n1
£.

n;1
X
i=0

(P (i) + P (n ; i ; 1) + n ; 1):

®ª ¦¨²¥, ·²®

P (n) = n2

nX
;1
k=1

P (k) + (n):

±¯®¬¨­ ¿ ° ±±³¦¤¥­¨¥ ¨§ ° §¤¥«  8.4.2 (®¶¥­ª  ¬ ²¥¬ ²¨·¥±ª®£® ®¦¨¤ ­¨¿ ¢°¥¬¥­¨ ¡»±²°®© ±®°²¨°®¢ª¨), ¯®ª ¦¨²¥, ·²®
P (n) = O(n lg n).
 ª ¦¤®¬ °¥ª³°±¨¢­®¬ ¢»§®¢¥ ¡»±²°®© ±®°²¨°®¢ª¨ ¬» ±«³· ©­»¬ ®¡° §®¬ ¢»¡¨° ¥¬ £° ­¨·­»© ½«¥¬¥­². ®¤®¡­® ½²®¬³, ª ¦¤ ¿ ¢¥°¸¨­  ¤¥°¥¢  ¯®¨±ª  ¿¢«¿¥²±¿ £° ­¨¶¥© ¬¥¦¤³ «¥¢»¬ ¨
¯° ¢»¬ ±¢®¨¬ ¯®¤¤¥°¥¢®¬.
¥. ¯¨¸¨²¥ °¥ «¨§ ¶¨¾  «£®°¨²¬  ¡»±²°®© ±®°²¨°®¢ª¨, ¯°¨ ª®²®°®¬ ¢ ¯°®¶¥±±¥ ±®°²¨°®¢ª¨ ½«¥¬¥­²®¢ k1; : : :; kn ¢»¯®«­¿¾²±¿
¢ ²®·­®±²¨ ²¥ ¦¥ ±° ¢­¥­¨¿, ·²® ¨ ¯°¨ ¤®¡ ¢«¥­¨¨ ¨µ ¢ (¨§­ · «¼­® ¯³±²®¥) ¤¥°¥¢®. (®°¿¤®ª ±° ¢­¥­¨© ¬®¦¥² ¡»²¼ ¤°³£¨¬.)
¤.

13-4 ®«¨·¥±²¢® ° §­»µ ¤¢®¨·­»µ ¤¥°¥¢¼¥¢
¡®§­ ·¨¬ ·¥°¥§ bn ª®«¨·¥±²¢® ° §«¨·­»µ ¤¢®¨·­»µ ¤¥°¥¢¼¥¢
± n ¢¥°¸¨­ ¬¨.  ½²®© § ¤ ·¥ ²°¥¡³¥²±¿ ¢»¢¥±²¨ ´®°¬³«³ ¤«¿ bn
¨ ®¶¥­¨²¼ ±ª®°®±²¼ °®±²  ·¨±«  bn .

 ¬¥· ­¨¿ ª £« ¢¥ 13
 .

265

®ª ¦¨²¥, ·²® b0 = 1 ¨ ·²®

bn =
¡.

nX
;1
k=0

bk bn;1;k

¯°¨ n > 1.
³±²¼ B (x) | ¯°®¨§¢®¤¿¹ ¿ ´³­ª¶¨¿

B (x) =

1
X
n=0

bn xn

(®¯°¥¤¥«¥­¨¥ ¯°®¨§¢®¤¿¹¨µ ´³­ª¶¨© ¤ ­® ¢ § ¤ ·¥ 4-6). ®ª ¦¨²¥, ·²® B (x) = xB (x)2 + 1 ¨, ² ª¨¬ ®¡° §®¬,
p
B(x) = 21x (1 ; 1 ; 4x):
¿¤ ¥©«®°  (Taylor expansion) ´³­ª¶¨¨ f (x) ¢ ²®·ª¥ x = a ®¯°¥¤¥«¿¥²±¿ ´®°¬³«®©

f (x) =

1
X

f (k) (a) (x ; a)k
k=0 k!

£¤¥ f (k) (a) | k-¿ ¯°®¨§¢®¤­ ¿ f ¢ ²®·ª¥ a.
¢. ®ª ¦¨²¥, ·²®
bn = n +1 1 C2nn

p

° §«®¦¨¢
¢ °¿¤ ¥©«®°  ´³­ª¶¨¾ 1 ; 4x ¢ ²®·ª¥ 0. (¿¤ ¤«¿
p
1 + h = (1 + h)1=2 ¬®¦­® ¯®«³·¨²¼ ² ª¦¥ ª ª ®¡®¡¹¥­¨¥ ¡¨­®¬  ¼¾²®­ , ¥±«¨ ¤«¿ ­¥¶¥«»µ n ¨ ¶¥«»µ ­¥®²°¨¶ ²¥«¼­»µ k
¯®«®¦¨²¼ Cnk = n(n ; 1) : : : (n ; k + 1)=k!.)
¨±«® bn ­ §»¢ ¥²±¿ n-¬ ·¨±«®¬  ² « ­  (Catalan number).
£. ®ª ¦¨²¥, ·²®
n
b = p 4 (1 + O(1=n)):
n

n3=2

 ¬¥· ­¨¿
®¤°®¡­®¥ ®¡±³¦¤¥­¨¥ ¤¢®¨·­»µ ¤¥°¥¢¼¥¢ ¯®¨±ª  ¨ ¬­®£¨µ  ­ «®£¨·­»µ ±²°³ª²³° ¤ ­­»µ ¬®¦­® ­ ©²¨ ³ ­³²  [123]. ¨¤¨¬®,
¤¢®¨·­»¥ ¤¥°¥¢¼¿ ¯®¨±ª  ¡»«¨ ­¥§ ¢¨±¨¬® ¯°¨¤³¬ ­» ¬­®£¨¬¨
«¾¤¼¬¨ ­¥§ ¤®«£® ¤® 1960 £®¤ .

266

« ¢  13 ¢®¨·­»¥ ¤¥°¥¢¼¿ ¯®¨±ª 

ª«¾·¨ 21 9 4 25 7 12 3 10 19 29 17 6 26 18
G0j
21
25
19 29
Gj
21
19
9 4
7 12 3 10
L0j
Lj
9
12
(¡)
­®¦¥±²¢  Gj ¨ Lj , ±®±² ¢«¿¾¹¨¥ ¬­®¦¥±²¢® ª«¾·¥© ­  ¯³²¨ ª
ª«¾·³ kj = 17. ( ) ¥°­»¥ ¢¥°¸¨­» ±®¤¥°¦ ² ª«¾·¨ ¨§ Gj , ¡¥«»¥ ¨§ Lj , ®±² «¼­»¥ ¢¥°¸¨­» | ±¥°»¥. »¤¥«¥­ ¯³²¼ ª ª«¾·³ kj . «¾·¨ «¥¢¥¥ ¯³­ª²¨°­®©
«¨­¨¨ ¬¥­¼¸¥ kj , ª«¾·¨ ¯° ¢¥¥ | ¡®«¼¸¥. (¡) ­®¦¥±²¢® G0j = f21; 25; 19; 29g
±®±²®¨² ¨§ ª«¾·¥©, ¤®¡ ¢«¥­­»µ ° ­¼¸¥ ª«¾·  17 ¨ ¡®«¼¸¨µ 17. ­®¦¥±²¢®
Gj = f21; 19g ±®¤¥°¦¨² ª«¾·¨, ¡»¢¸¨¥ ¡«¨¦ ©¸¨¬¨ ±¯° ¢ 
ª ª«¾·³ 17, ²® ¥±²¼
¡»¢¸¨¥ ¬¨­¨¬ «¼­»¬¨ ¢ ³¦¥ ¯®¿¢¨¢¸¥©±¿ · ±²¨ G0j . «¾· 21 ¡»« ¤®¡ ¢«¥­
¯¥°¢»¬ ª G0j ¨ ¯®¯ « ¢ Gj ; ª«¾· 25 ­¥ ¯®¯ « (®­ ¡®«¼¸¥ ²¥ª³¹¥£® ¬¨­¨¬³¬ ,
° ¢­®£® 21). «¾· 19 ¯®¯ ¤ ¥² ¢ Gj , ¯®²®¬³ ·²® ®­ ¬¥­¼¸¥ 21,   29 | ­¥², ² ª
ª ª 29 > 19. ­®¦¥±²¢  L0j ¨ Lj ±²°®¿²±¿  ­ «®£¨·­»¬ ®¡° §®¬.
¨±. 13.5

 ¬¥· ­¨¿ ª £« ¢¥ 13

267

¨´°®¢®¥ ¤¥°¥¢® µ° ­¨² ±²°®ª¨ 1011, 10, 011, 100 ¨ 0.  ¦¤®© ¢¥°¸¨­¥ ±®®²¢¥²±²¢³¥² ª«¾· | ±²°®ª , ª®²®°³¾ ¬®¦­® ¯°®·¥±²¼, ¨¤¿ ¨§ ª®°­¿
¢ ½²³ ¢¥°¸¨­³, ¯®½²®¬³ ½²¨ ª«¾·¨ ­¥ ­ ¤® µ° ­¨²¼ ±¯¥¶¨ «¼­® (­  °¨±³­ª¥
®­¨ ¯®ª § ­» ¤«¿ ­ £«¿¤­®±²¨). ¥¬­»¥ ¢¥°¸¨­» ­¥ ±®®²¢¥²±²¢³¾² ª«¾· ¬,
  ¿¢«¿¾²±¿ ¯°®¬¥¦³²®·­»¬¨ ¤«¿ ¤°³£¨µ ¢¥°¸¨­.
¨±. 13.6

14

° ±­®-·
¥°­»¥ ¤¥°¥¢¼¿

 £« ¢¥ 13 ¬» ¯®ª § «¨, ·²® ®±­®¢­»¥ ®¯¥° ¶¨¨ ± ¤¢®¨·­»¬ ¤¥°¥¢®¬ ¯®¨±ª  ¢»±®²» h ¬®£³² ¡»²¼ ¢»¯®«­¥­» §  O(h) ¤¥©±²¢¨©.
¥°¥¢¼¿ ½´´¥ª²¨¢­», ¥±«¨ ¨µ ¢»±®²  ¬ «  | ­® ¬ « ¿ ¢»±®²  ­¥
£ ° ­²¨°³¥²±¿, ¨ ¢ µ³¤¸¥¬ ±«³· ¥ ¤¥°¥¢¼¿ ­¥ ¡®«¥¥ ½´´¥ª²¨¢­»,
·¥¬ ±¯¨±ª¨. ° ±­®-·¥°­»¥ ¤¥°¥¢¼¿ | ®¤¨­ ¨§ ²¨¯®¢ À±¡ « ­±¨°®¢ ­­»µÁ ¤¥°¥¢¼¥¢ ¯®¨±ª , ¢ ª®²®°»µ ¯°¥¤³±¬®²°¥­» ®¯¥° ¶¨¨
¡ « ­±¨°®¢ª¨, £ ° ­²¨°³¾¹¨¥, ·²® ¢»±®²  ¤¥°¥¢  ­¥ ¯°¥¢§®©¤¥²
O(lg n).

14.1. ¢®©±²¢  ª° ±­®-·¥°­»µ ¤¥°¥¢¼¥¢
° ±­®-·¥°­®¥ ¤¥°¥¢® (red-black tree) | ½²® ¤¢®¨·­®¥ ¤¥°¥¢®
¯®¨±ª , ¢¥°¸¨­» ª®²®°®£® ° §¤¥«¥­» ­  ª° ±­»¥ (red) ¨ ·¥°­»¥
(black).  ª¨¬ ®¡° §®¬, ª ¦¤ ¿ ¢¥°¸¨­  µ° ­¨² ®¤¨­ ¤®¯®«­¨²¥«¼­»© ¡¨² | ¥¥ ¶¢¥².
°¨ ½²®¬ ¤®«¦­» ¢»¯®«­¿²¼±¿ ®¯°¥¤¥«¥­­»¥ ²°¥¡®¢ ­¨¿, ª®²®°»¥ £ ° ­²¨°³¾², ·²® £«³¡¨­» «¾¡»µ ¤¢³µ «¨±²¼¥¢ ®²«¨· ¾²±¿
­¥ ¡®«¥¥ ·¥¬ ¢ ¤¢  ° § , ¯®½²®¬³ ¤¥°¥¢® ¬®¦­® ­ §¢ ²¼ ±¡ « ­±¨°®¢ ­­»¬ (balanced).
 ¦¤ ¿ ¢¥°¸¨­  ª° ±­®-·¥°­®£® ¤¥°¥¢  ¨¬¥¥² ¯®«¿ color (¶¢¥²),
key (ª«¾·), left («¥¢»© °¥¡¥­®ª), right (¯° ¢»© °¥¡¥­®ª) ¨ p (°®¤¨²¥«¼). ±«¨ ³ ¢¥°¸¨­» ®²±³²±²¢³¥² °¥¡¥­®ª ¨«¨ °®¤¨²¥«¼, ±®®²¢¥²±²¢³¾¹¥¥ ¯®«¥ ±®¤¥°¦¨² nil. «¿ ³¤®¡±²¢  ¬» ¡³¤¥¬ ±·¨² ²¼, ·²®
§­ ·¥­¨¿ nil, µ° ­¿¹¨¥±¿ ¢ ¯®«¿µ left ¨ right, ¿¢«¿¾²±¿ ±±»«ª ¬¨
­  ¤®¯®«­¨²¥«¼­»¥ (´¨ª²¨¢­»¥) «¨±²¼¿ ¤¥°¥¢ .  ² ª®¬ ¯®¯®«­¥­­®¬ ¤¥°¥¢¥ ª ¦¤ ¿ ±² ° ¿ ¢¥°¸¨­  (±®¤¥°¦ ¹ ¿ ª«¾·) ¨¬¥¥² ¤¢³µ
¤¥²¥©.
¢®¨·­®¥ ¤¥°¥¢® ¯®¨±ª  ­ §»¢ ¥²±¿ ª° ±­®-·¥°­»¬ ¤¥°¥¢®¬, ¥±«¨ ®­® ®¡« ¤ ¥² ±«¥¤³¾¹¨¬¨ ±¢®©±²¢ ¬¨ (¡³¤¥¬ ­ §»¢ ²¼ ¨µ RB±¢®©±²¢ ¬¨, ¯®- ­£«¨©±ª¨ red-black properties):
1.  ¦¤ ¿ ¢¥°¸¨­  | «¨¡® ª° ±­ ¿, «¨¡® ·¥°­ ¿.
2.  ¦¤»© «¨±² (nil) | ·¥°­»©.

¢®©±²¢  ª° ±­®-·¥°­»µ ¤¥°¥¢¼¥¢

269

¨±. 14.1 ° ±­®-·
¥°­®¥ ¤¥°¥¢®. ¥°­»¥ ¢¥°¸¨­» ¯®ª § ­» ª ª ²¥¬­»¥, ª° ±­»¥ | ª ª ±¥°»¥.  ¦¤ ¿ ¢¥°¸¨­  «¨¡® ª° ±­ ¿, «¨¡® ·¥°­ ¿. ±¥ nil-«¨±²¼¿
·¥°­»¥. ¥²¨ ª° ±­®© ¢¥°¸¨­» | ·¥°­»¥. «¿ ª ¦¤®© ¢¥°¸¨­» ¢±¥ ¯³²¨ ®²
­¥¥ ¢­¨§ ª «¨±²¼¿¬ ±®¤¥°¦¨² ®¤¨­ ª®¢®¥ ª®«¨·¥±²¢® ·¥°­»µ ¢¥°¸¨­. ª®«®
ª ¦¤®© ¢¥°¸¨­» (ª°®¬¥ «¨±²¼¥¢) § ¯¨± ­  ¥¥ ·¥°­ ¿ ¢»±®² . ¥°­ ¿ ¢»±®² 
«¨±²¼¥¢ ° ¢­  0.

3. ±«¨ ¢¥°¸¨­  ª° ±­ ¿, ®¡  ¥¥ °¥¡¥­ª  ·¥°­»¥.
4. ±¥ ¯³²¨, ¨¤³¹¨¥ ¢­¨§ ®² ª®°­¿ ª «¨±²¼¿¬, ±®¤¥°¦ ² ®¤¨­ ª®¢®¥ ª®«¨·¥±²¢® ·¥°­»µ ¢¥°¸¨­.
°¨¬¥° ª° ±­®-·¥°­®£® ¤¥°¥¢  ¯®ª § ­ ­  °¨±³­ª¥ 14.1.
 ±±¬®²°¨¬ ¯°®¨§¢®«¼­³¾ ¢¥°¸¨­³ x ª° ±­®-·¥°­®£® ¤¥°¥¢  ¨
¯³²¨, ¢¥¤³¹¨¥ ¢­¨§ ®² ­¥¥ ª «¨±²¼¿¬. ±¥ ®­¨ ±®¤¥°¦ ² ®¤­® ¨
²® ¦¥ ·¨±«® ·¥°­»µ ¢¥°¸¨­ (¤®¡ ¢¨¬ ª ­¨¬ ¯³²¼ ¨§ ª®°­¿ ¢ x
¨ ¯°¨¬¥­¨¬ ±¢®©±²¢® 4). ¨±«® ·¥°­»µ ¢¥°¸¨­ ¢ «¾¡®¬ ¨§ ­¨µ
(± ¬³ ¢¥°¸¨­³ x ¬» ­¥ ±·¨² ¥¬) ¡³¤¥¬ ­ §»¢ ²¼ ·¥°­®© ¢»±®²®©
(black-height) ¢¥°¸¨­» x ¨ ®¡®§­ · ²¼ bh(x). ¥°­®© ¢»±®²®© ¤¥°¥¢  ¡³¤¥¬ ±·¨² ²¼ ·¥°­³¾ ¢»±®²³ ¥£® ª®°­¿.
«¥¤³¾¹ ¿ «¥¬¬  ¯®ª §»¢ ¥², ·²® ª° ±­®-·¥°­»¥ ¤¥°¥¢¼¿ µ®°®¸¨ ª ª ¤¥°¥¢¼¿ ¯®¨±ª .
¥¬¬  14.1. ° ±­®-·¥°­®¥ ¤¥°¥¢® ± n ¢­³²°¥­­¨¬¨ ¢¥°¸¨­ ¬¨
(². ¥. ­¥ ±·¨² ¿ nil-«¨±²¼¥¢) ¨¬¥¥² ¢»±®²³ ­¥ ¡®«¼¸¥ 2 lg(n +1).
®ª § ²¥«¼±²¢®. ­ · «  ¯®ª ¦¥¬, ·²® ¯®¤¤¥°¥¢® ± ª®°­¥¬ ¢ x
±®¤¥°¦¨² ¯® ¬¥­¼¸¥© ¬¥°¥ 2bh(x) ; 1 ¢­³²°¥­­¨µ ¢¥°¸¨­. ®ª § ²¥«¼±²¢® ¯°®¢¥¤¥¬ ¨­¤³ª¶¨¥© ®² «¨±²¼¥¢ ª ª®°­¾. «¿ «¨±²¼¥¢
·¥°­ ¿ ¢»±®²  ° ¢­  0, ¨ ¯®¤¤¥°¥¢® ¢ ± ¬®¬ ¤¥«¥ ±®¤¥°¦¨² ­¥ ¬¥­¥¥
2bh(x) ; 1 = 20 ; 1 = 0 ¢­³²°¥­­¨µ ¢¥°¸¨­. ³±²¼ ²¥¯¥°¼ ¢¥°¸¨­  x ­¥ ¿¢«¿¥²±¿ «¨±²®¬ ¨ ¨¬¥¥² ·¥°­³¾ ¢»±®²³ k. ®£¤  ®¡  ¥¥
°¥¡¥­ª  ¨¬¥¾² ·¥°­³¾ ¢»±®²³ ­¥ ¬¥­¼¸¥ k ; 1 (ª° ±­»© °¥¡¥­®ª
¡³¤¥² ¨¬¥²¼ ¢»±®²³ k, ·¥°­»© | k ; 1). ® ¯°¥¤¯®«®¦¥­¨¾ ¨­¤³ª¶¨¨ «¥¢®¥ ¨ ¯° ¢®¥ ¯®¤¤¥°¥¢¼¿ ¢¥°¸¨­» x ±®¤¥°¦ ² ­¥ ¬¥­¥¥
2k;1 ; 1 ¢¥°¸¨­, ¨ ¯®²®¬³ ¯®¤¤¥°¥¢® ± ª®°­¥¬ ¢ x ±®¤¥°¦¨² ¯®
¬¥­¼¸¥© ¬¥°¥ 2k;1 ; 1 + 2k;1 ; 1 + 1 = 2k ; 1 ¢­³²°¥­­¨µ ¢¥°¸¨­.
²®¡» § ¢¥°¸¨²¼ ¤®ª § ²¥«¼±²¢® «¥¬¬», ®¡®§­ ·¨¬ ¢»±®²³ ¤¥°¥¢  ·¥°¥§ h. ®£« ±­® ±¢®©±²¢³ 3, ¯® ¬¥­¼¸¥© ¬¥°¥ ¯®«®¢¨­³ ¢±¥µ

270

« ¢  14 ° ±­®-·¥°­»¥ ¤¥°¥¢¼¿

¢¥°¸¨­ ­  ¯³²¨ ®² ª®°­¿ ª «¨±²³, ­¥ ±·¨² ¿ ª®°¥­¼, ±®±² ¢«¿¾²
·¥°­»¥ ¢¥°¸¨­». «¥¤®¢ ²¥«¼­®, ·¥°­ ¿ ¢»±®²  ¤¥°¥¢  ­¥ ¬¥­¼¸¥ h=2. ®£¤ 
n > 2h=2 ; 1:
¥°¥­®±¿ 1 ­ «¥¢® ¨ ¯¥°¥©¤¿ ª «®£ °¨´¬ ¬, ¯®«³· ¥¬ lg(n + 1) >
h=2, ¨«¨ h 6 2 lg(n + 1). ¥¬¬  ¤®ª § ­ .
¥¬ ± ¬»¬ ¤«¿ ª° ±­®-·¥°­»µ ¤¥°¥¢¼¥¢ ®¯¥° ¶¨¨ Search, Minimum, Maximum, Successor ¨ Predecessor ¢»¯®«­¿¾²±¿ §  ¢°¥¬¿
O(lg n), ² ª ª ª ¢°¥¬¿ ¨µ ¢»¯®«­¥­¨¿ ¥±²¼ O(h) ¤«¿ ¤¥°¥¢  ¢»±®²» h,   ª° ±­®-·¥°­®¥ ¤¥°¥¢® ± n ¢¥°¸¨­ ¬¨ ¨¬¥¥² ¢»±®²³ O(lg n).
«®¦­¥¥ ®¡±²®¨² ¤¥«® ± ¯°®¶¥¤³° ¬¨ Tree-Insert ¨ TreeDelete ¨§ £« ¢» 13: ¯°®¡«¥¬  ¢ ²®¬, ·²® ®­¨ ¬®£³² ¨±¯®°²¨²¼
±²°³ª²³°³ ª° ±­®-·¥°­®£® ¤¥°¥¢ , ­ °³¸¨¢ RB-±¢®©±²¢ . ®½²®¬³ ½²¨ ¯°®¶¥¤³°» ¯°¨¤¥²±¿ ¬®¤¨´¨¶¨°®¢ ²¼. » ³¢¨¤¨¬ ¢ ° §¤¥« µ 14.3 ¨ 14.4, ª ª ¬®¦­® °¥ «¨§®¢ ²¼ ¤®¡ ¢«¥­¨¥ ¨ ³¤ «¥­¨¥
½«¥¬¥­²®¢ §  ¢°¥¬¿ O(lg n) ± ±®µ° ­¥­¨¥¬ RB-±¢®©±²¢.
¯° ¦­¥­¨¿
14.1-1  °¨±³©²¥ ¯®«­®¥ ¤¢®¨·­®¥ ¤¥°¥¢® ¯®¨±ª  ¢»±®²» 3 ±
ª«¾· ¬¨ f1; 2; : : :; 15g. ®¡ ¢¼²¥ nil-«¨±²¼¿ ¨ ¯®ª° ±¼²¥ ¢¥°¸¨­»
²°¥¬¿ ±¯®±®¡ ¬¨ ² ª, ·²®¡» ¯®«³·¨¢¸¨¥±¿ ª° ±­®-·¥°­»¥ ¤¥°¥¢¼¿
¨¬¥«¨ ·¥°­³¾ ¢»±®²³ 2, 3 ¨ 4.
14.1-2 °¥¤¯®«®¦¨¬, ·²® ª®°¥­¼ ª° ±­®-·¥°­®£® ¤¥°¥¢  ª° ±­»©. ±«¨ ¬» ¯®ª° ±¨¬ ¥£® ¢ ·¥°­»© ¶¢¥², ®±² ­¥²±¿ «¨ ¤¥°¥¢®
ª° ±­®-·¥°­»¬?
14.1-3 ®ª ¦¨²¥, ·²® ± ¬»© ¤«¨­­»© ¯³²¼ ¢­¨§ ®² ¢¥°¸¨­» x ª
«¨±²³ ­¥ ¡®«¥¥ ·¥¬ ¢¤¢®¥ ¤«¨­­¥¥ ± ¬®£® ª®°®²ª®£® ² ª®£® ¯³²¨.
14.1-4  ª®¥ ­ ¨¡®«¼¸¥¥ ¨ ­ ¨¬¥­¼¸¥¥ ª®«¨·¥±²¢® ¢­³²°¥­­¨µ
¢¥°¸¨­ ¬®¦¥² ¡»²¼ ¢ ª° ±­®-·¥°­®¬ ¤¥°¥¢¥ ·¥°­®© ¢»±®²» k?
14.1-5 ¯¨¸¨²¥ ª° ±­®-·¥°­®¥ ¤¥°¥¢®, ±®¤¥°¦ ¹¥¥ n ª«¾·¥©, ±
­ ¨¡®«¼¸¨¬ ¢®§¬®¦­»¬ ®²­®¸¥­¨¥¬ ·¨±«  ª° ±­»µ ¢­³²°¥­­¨µ
¢¥°¸¨­ ª ·¨±«³ ·¥°­»µ ¢­³²°¥­­¨µ ¢¥°¸¨­. ¥¬³ ° ¢­® ½²® ®²­®¸¥­¨¥? «¿ ª ª®£® ¤¥°¥¢  ½²® ®²­®¸¥­¨¥ ¡³¤¥² ­ ¨¬¥­¼¸¨¬, ¨
·¥¬³ ° ¢­® ½²® ®²­®¸¥­¨¥?

14.2. ° ¹¥­¨¿
¯¥° ¶¨¨ Tree-Insert ¨ Tree-Delete ¢»¯®«­¿¾²±¿ ­  ª° ±­®·¥°­®¬ ¤¥°¥¢¥ §  ¢°¥¬¿ O(lg n), ­® ®­¨ ¨§¬¥­¿¾² ¤¥°¥¢®, ¨ °¥§³«¼-

° ¹¥­¨¿

271

¨±. 14.2 ¯¥° ¶¨¨ ¢° ¹¥­¨¿ ­  ¤¢®¨·­®¬ ¤¥°¥¢¥ ¯®¨±ª . ¯¥° ¶¨¿ RightRotate ¯°¥®¡° §³¥² «¥¢®¥ ¤¥°¥¢® ¢ ¯° ¢®¥, ¬¥­¿¿ ­¥±ª®«¼ª® ³ª § ²¥«¥©. ° ¢®¥
¤¥°¥¢® ¬®¦­® ¯¥°¥¢¥±²¨ ¢ «¥¢®¥ ®¡° ²­®© ®¯¥° ¶¨¥© Left-Rotate. ¥°¸¨­» x

¨ y ¬®£³² ­ µ®¤¨²¼±¿ ¢ «¾¡®¬ ¬¥±²¥ ¤¥°¥¢ . ³ª¢» ,  ¨  ®¡®§­ · ¾² ¯®¤¤¥°¥¢¼¿.  ®¡®¨µ ¤¥°¥¢¼¿µ ¢»¯®«­¥­® ®¤­® ¨ ²® ¦¥ ±¢®©±²¢® ³¯®°¿¤®·¥­­®±²¨:
ª«¾·¨ ¨§  ¯°¥¤¸¥±²¢³¾² key[x], ª®²®°»© ¯°¥¤¸¥±²¢³¥² ª«¾· ¬ ¨§  , ª®²®°»¥
¯°¥¤¸¥±²¢³¾² key[y], ª®²®°»© ¯°¥¤¸¥±²¢³¥² ª«¾· ¬ ¨§  .

² ² ¬®¦¥² ­¥ ®¡« ¤ ²¼ RB-±¢®©±²¢ ¬¨, ®¯¨± ­­»¬¨ ¢ ° §¤¥«¥ 14.1.
²®¡» ¢®±±² ­®¢¨²¼ ½²¨ ±¢®©±²¢ , ­ ¤® ¯¥°¥ª° ±¨²¼ ­¥ª®²®°»¥
¢¥°¸¨­» ¨ ¨§¬¥­¨²¼ ±²°³ª²³°³ ¤¥°¥¢ .
» ¡³¤¥¬ ¬¥­¿²¼ ±²°³ª²³°³ ± ¯®¬®¹¼¾ ¢° ¹¥­¨© (rotations).
° ¹¥­¨¥ ¯°¥¤±² ¢«¿¥² ±®¡®© «®ª «¼­³¾ ®¯¥° ¶¨¾ (¬¥­¿¥²±¿ ­¥±ª®«¼ª® ³ª § ²¥«¥©) ¨ ±®µ° ­¿¥² ±¢®©±²¢® ³¯®°¿¤®·¥­­®±²¨.   °¨±³­ª¥ 14.2 ¯®ª § ­» ¤¢  ¢§ ¨¬­® ®¡° ²­»µ ¢° ¹¥­¨¿: «¥¢®¥ ¨ ¯° ¢®¥. ¥¢®¥ ¢° ¹¥­¨¥ ¢®§¬®¦­® ¢ «¾¡®© ¢¥°¸¨­¥ x, ¯° ¢»© °¥¡¥­®ª
ª®²®°®© (­ §®¢¥¬ ¥£® y ) ­¥ ¿¢«¿¥²±¿ «¨±²®¬ (nil). ®±«¥ ¢° ¹¥­¨¿ y
®ª §»¢ ¥²±¿ ª®°­¥¬ ¯®¤¤¥°¥¢ , x | «¥¢»¬ °¥¡¥­ª®¬ y ,   ¡»¢¸¨©
«¥¢»© °¥¡¥­®ª y | ¯° ¢»¬ °¥¡¥­ª®¬ x.
 ¯°®¶¥¤³°¥ Left-Rotate ¯°¥¤¯®« £ ¥²±¿, ·²® right[x] 6= nil.
Left-Rotate(T; x)
1 y right[x]
.  µ®¤¨¬ y .
2 right[x] left[y ]
. ¥¢®¥ ¯®¤¤¥°¥¢® y ±² ­®¢¨²±¿
¯° ¢»¬ ¯®¤¤¥°¥¢®¬ x.
3 if left[y ] 6= nil
4
then p[left[y ]] x
5 p[y ] p[x]
. ¥« ¥¬ °®¤¨²¥«¿ x °®¤¨²¥«¥¬ y .
6 if p[x] = nil
7
then root[T ] y
8
else if x = left[p[x]]
9
then left[p[x]] y
10
else right[p[x]] y
11 left[y ] x
. ¥« ¥¬ x «¥¢»¬ °¥¡¥­ª®¬ y .
12 p[x] y
  °¨±³­ª¥ 14.3 ¯®ª § ­® ¤¥©±²¢¨¥ ¯°®¶¥¤³°» Left-Rotate. °®¶¥¤³°  Right-Rotate  ­ «®£¨·­ . ¡¥ ®­¨ ° ¡®² ¾² §  ¢°¥¬¿
O(1) ¨ ¬¥­¿¾² ²®«¼ª® ³ª § ²¥«¨. ±² «¼­»¥ ¯®«¿ ¢¥°¸¨­ ®±² ¾²±¿ ­¥¨§¬¥­­»¬¨.

272

« ¢  14 ° ±­®-·¥°­»¥ ¤¥°¥¢¼¿

¨±. 14.3 °¨¬¥° ¤¥©±²¢¨¿ ¯°®¶¥¤³°» Left-Rotate. ®¯®«­¨²¥«¼­»¥ nil«¨±²¼¿ ­¥ ¯®ª § ­». ®°¿¤®ª ª«¾·¥© ¢ ­ · «¼­®¬ ¨ ª®­¥·­®¬ ¤¥°¥¢¼¿µ ®¤¨­ ¨
²®² ¦¥.

¯° ¦­¥­¨¿
14.2-1  °¨±³©²¥ ¤¥°¥¢®, ª®²®°®¥ ¯®«³·¨²±¿, ¥±«¨ ± ¯®¬®¹¼¾
¯°®¶¥¤³°» Tree-Insert ¤®¡ ¢¨²¼ ª«¾· 36 ª ¤¥°¥¢³ °¨±. 14.1. ±«¨
±¤¥« ²¼ ¤®¡ ¢«¥­­³¾ ¢¥°¸¨­³ ª° ±­®©, ¡³¤¥² «¨ ¯®«³·¥­­®¥ ¤¥°¥¢®
®¡« ¤ ²¼ RB-±¢®©±²¢ ¬¨?  ¥±«¨ ±¤¥« ²¼ ¥¥ ·¥°­®©?
14.2-2

 ¯¨¸¨²¥ ¯°®¶¥¤³°³ Right-Rotate.

14.2-3 ¡¥¤¨²¥±¼, ·²® ¢° ¹¥­¨¿ ±®µ° ­¿¾² ±¢®©±²¢® ³¯®°¿¤®·¥­­®±²¨.
14.2-4 ³±²¼ a, b ¨ c | ¯°®¨§¢®«¼­»¥ ¢¥°¸¨­» ¢ ¯®¤¤¥°¥¢¼¿µ
,  ¨  ­  °¨±. 14.2 (±¯° ¢ ).  ª ¨§¬¥­¨²±¿ £«³¡¨­  a, b ¨ c ¯°¨
¢»¯®«­¥­¨¨ «¥¢®£® ¢° ¹¥­¨¿?
14.2-5 ®ª ¦¨²¥, ·²® ¯°®¨§¢®«¼­®¥ ¤¢®¨·­®¥ ¤¥°¥¢® ¯®¨±ª 
± n ¢¥°¸¨­ ¬¨ ¬®¦¥² ¡»²¼ ¯°¥®¡° §®¢ ­® ¢ «¾¡®¥ ¤°³£®¥ ¤¥°¥¢®
± ²¥¬ ¦¥ ·¨±«®¬ ¢¥°¸¨­ (¨ ²¥¬¨ ¦¥ ª«¾· ¬¨) ± ¯®¬®¹¼¾ O(n)
¢° ¹¥­¨©. (ª § ­¨¥: ­ · «  ¯®ª ¦¨²¥, ·²® n ; 1 ¯° ¢»µ ¢° ¹¥­¨© ¤®±² ²®·­®, ·²®¡» ¯°¥®¡° §®¢ ²¼ «¾¡®¥ ¤¥°¥¢® ¢ ¨¤³¹³¾
¢¯° ¢® ¶¥¯®·ª³.)

®¡ ¢«¥­¨¥ ¢¥°¸¨­»

273

14.3. ®¡ ¢«¥­¨¥ ¢¥°¸¨­»
®¡ ¢«¥­¨¥ ¢¥°¸¨­» ¢ ª° ±­®-·¥°­®¥ ¤¥°¥¢® ¯°®¢®¤¨²±¿ §  ¢°¥¬¿ O(lg n). ­ · «  ¬» ¯°¨¬¥­¿¥¬ ¯°®¶¥¤³°³ Tree-Insert, ª ª
¤¥« «®±¼ ¤«¿ ¤¢®¨·­»µ ¤¥°¥¢¼¥¢ ¯®¨±ª , ¨ ª° ±¨¬ ­®¢³¾ ¢¥°¸¨­³
¢ ª° ±­»© ¶¢¥². ®±«¥ ½²®£® ­ ¤® ¢®±±² ­®¢¨²¼ RB-±¢®©±²¢ , ¤«¿
·¥£® ¯°¨µ®¤¨²±¿ ¯¥°¥ª° ±¨²¼ ­¥ª®²®°»¥ ¢¥°¸¨­» ¨ ¯°®¨§¢¥±²¨
¢° ¹¥­¨¿. °¨ ½²®¬ ¢®§¬®¦­» ° §«¨·­»¥ ±¨²³ ¶¨¨, ± ª®²®°»¬¨
­ ¤®  ªª³° ²­® ° §®¡° ²¼±¿.
RB-Insert (T; x)
1 Tree-Insert (T; x)
2 color[x] red
3 while x 6= root[T ] ¨ color[p[x]] = red
4
do if p[x] = left[p[p[x]]]
5
then y right[p[p[x]]]
6
if color[y ] = red
7
then color[p[x]] black
. «³· © 1
8
color[y ] black
. «³· © 1
9
color[p[p[x]]] red
. «³· © 1
10
x p[p[x]]
. «³· © 1
11
else if x = right[p[x]]
12
then x p[x]
. «³· © 2
13
Left-Rotate(T; x) . «³· © 2
14
color[p[x]] black
. «³· © 3
15
color[p[p[x]]] red
. «³· © 3
16
Right-Rotate(T; p[p[x]]) . «³· © 3
17
else ( ­ «®£¨·­»© ²¥ª±² ±
§ ¬¥­®© left $ right)
18 color[root[T ]] black
  °¨±³­ª¥ 14.4 ¯®ª § ­ ¯°¨¬¥° ¯°¨¬¥­¥­¨¿ ¯°®¶¥¤³°» RBInsert.
°®¶¥¤³°  RB-Insert ¯°®¹¥, ·¥¬ ª ¦¥²±¿ ­  ¯¥°¢»© ¢§£«¿¤.
®±«¥ ¢»¯®«­¥­¨¿ ±²°®ª 1{2 ¢»¯®«­¿¾²±¿ ¢±¥ RB-±¢®©±²¢ , ª°®¬¥ ®¤­®£®: ª° ±­ ¿ ¢¥°¸¨­  x ¬®¦¥² ¨¬¥²¼ ª° ±­®£® °®¤¨²¥«¿.
(±¬. °¨±. 14.4 ).  ®±² «¼­®¬ ¢±¥ ¢ ¯®°¿¤ª¥ | ¤°³£¨¥ ±¢®©±²¢  À­¥
§ ¬¥· ¾²Á ¤®¡ ¢«¥­¨¿ ª° ±­®© ¢¥°¸¨­» (®²¬¥²¨¬, ·²® ­®¢ ¿ ª° ±­ ¿ ¢¥°¸¨­  ¨¬¥¥² ¤¢³µ ·¥°­»µ nil-¤¥²¥©).
 ª ¿ ±¨²³ ¶¨¿ (¢»¯®«­¥­» ¢±¥ RB-±¢®©±²¢ , §  ¨±ª«¾·¥­¨¥¬
²®£®, ·²® ª° ±­ ¿ ¢¥°¸¨­  x ¬®¦¥² ¨¬¥²¼ ª° ±­®£® °®¤¨²¥«¿) ¡³¤¥² ±®µ° ­¿²¼±¿ ¯®±«¥ «¾¡®£® ·¨±«  ¨²¥° ¶¨© ¶¨ª« .   ª ¦¤®¬
¸ £¥ ¢¥°¸¨­  x ¯®¤­¨¬ ¥²±¿ ¢¢¥°µ ¯® ¤¥°¥¢³ (¥±«¨ ²®«¼ª® ­¥ ³¤ «®±¼ ³±²° ­¨²¼ ­ °³¸¥­¨¿ ¯®«­®±²¼¾; ¢ ½²®¬ ±«³· ¥ ¬» ¢»µ®¤¨¬
¨§ ¶¨ª« ).

274

« ¢  14 ° ±­®-·¥°­»¥ ¤¥°¥¢¼¿

¨±. 14.4  ¡®²  ¯°®¶¥¤³°» RB-Insert. ( ) ®¡ ¢«¥­  ¢¥°¸¨­  x; ¯°¨ ½²®¬
­ °³¸¨«®±¼ ±¢®©±²¢® 3: x ¨ ¥£® °®¤¨²¥«¼ ª° ±­»¥. ¥°¸¨­  y (ª®²®°³¾ ¬®¦­®
­ §¢ ²¼ À¤¿¤¥©Á ¢¥°¸¨­» x) ª° ±­ ¿, ¯®½²®¬³ ¨¬¥¥² ¬¥±²® ±«³· © 1. ®±«¥ ¯¥°¥ª° ¸¨¢ ­¨¿ ¢¥°¸¨­ ¯®«³· ¥²±¿ ¤¥°¥¢® (¡). ®¢ ¿ ¢¥°¸¨­  x ¨ ¥¥ °®¤¨²¥«¼
ª° ±­»¥, ­® ¤¿¤¿ y ·¥°­»©.  ª ª ª x | ¯° ¢»© °¥¡¥­®ª, ¨¬¥¥² ¬¥±²® ±«³· © 2.
°®¨§¢®¤¨²±¿ «¥¢®¥ ¢° ¹¥­¨¥, ª®²®°®¥ ¤ ¥² ¤¥°¥¢® (¢). ¥¯¥°¼ ³¦¥ x ¿¢«¿¥²±¿
«¥¢»¬ °¥¡¥­ª®¬, ¨ ½²® | ±«³· © 3. ®±«¥ ¯° ¢®£® ¢° ¹¥­¨¿ ¯®«³· ¥¬ ª®°°¥ª²­®¥ ª° ±­®-·¥°­®¥ ¤¥°¥¢® (£).

®¡ ¢«¥­¨¥ ¢¥°¸¨­»

275

«³· © 1.  °³¸¥­® ±¢®©±²¢® 3: x ¨ ¥£® °®¤¨²¥«¼ | ª° ±­»¥.  ¸¨
¤¥©±²¢¨¿ ­¥ § ¢¨±¿² ®² ²®£®, ¿¢«¿¥²±¿ «¨ x ¯° ¢»¬ ( ) ¨«¨ «¥¢»¬ (¡) ±»­®¬.
±¥ ¯®¤¤¥°¥¢¼¿ ,  ,  ,  ¨ " ¨¬¥¾² ·¥°­»© ª®°¥­¼ ¨ ®¤¨­ ª®¢³¾ ·¥°­³¾
¢»±®²³. °®¶¥¤³°  ¬¥­¿¥² ¶¢¥² ¢¥°¸¨­» p[p[x]] ¨ ¥¥ ¤¥²¥©. ¨ª« ¯°®¤®«¦ ¥²±¿
¯®±«¥ ¯°¨±¢ ¨¢ ­¨¿ x p[p[x]]; ±¢®©±²¢® 3 ¬®¦¥² ¡»²¼ ­ °³¸¥­® ²®«¼ª® ¬¥¦¤³
ª° ±­®© ¢¥°¸¨­®© p[p[x]] ¨ ¥¥ °®¤¨²¥«¥¬ (¥±«¨ ®­ ²®¦¥ ª° ±­»©).
¨±. 14.5

­³²°¨ ¶¨ª«  ° ±±¬ ²°¨¢ ¾²±¿ ¸¥±²¼ ±«³· ¥¢, ­® ²°¨ ¨§ ­¨µ
±¨¬¬¥²°¨·­» ²°¥¬ ¤°³£¨¬, ° §«¨·¨¿ «¨¸¼ ¢ ²®¬, ¿¢«¿¥²±¿ «¨ °®¤¨²¥«¼ ¢¥°¸¨­» x «¥¢»¬ ¨«¨ ¯° ¢»¬ °¥¡¥­ª®¬ ±¢®¥£® °®¤¨²¥«¿.
²¨ ±«³· ¨ ° §¤¥«¿¾²±¿ ¢ ±²°®ª¥ 4. » ¢»¯¨± «¨ ´° £¬¥­² ¯°®¶¥¤³°» ¤«¿ ±«³· ¿, ª®£¤  p[x] | «¥¢»© °¥¡¥­®ª ±¢®¥£® °®¤¨²¥«¿.
(¨¬¬¥²°¨·­»¥ ±«³· ¨ ®²­®±¿²±¿ ª ±²°®ª¥ 17.)
» ¡³¤¥¬ ¯°¥¤¯®« £ ²¼, ·²® ¢® ¢±¥µ ° ±±¬ ²°¨¢ ¥¬»µ ­ ¬¨
ª° ±­®-·¥°­»µ ¤¥°¥¢¼¿µ ª®°¥­¼ ·¥°­»© (¨ ¯®¤¤¥°¦¨¢ ²¼ ½²® ±¢®©±²¢® | ¤«¿ ½²®£® ¨±¯®«¼§³¥²±¿ ±²°®ª  18). ®½²®¬³ ¢ ±²°®ª¥ 4
ª° ±­ ¿ ¢¥°¸¨­  p[x] ­¥ ¬®¦¥² ¡»²¼ ª®°­¥¬ (p[p[x]] ±³¹¥±²¢³¥²).
¯¥° ¶¨¨ ¢­³²°¨ ¶¨ª«  ­ ·¨­ ¾²±¿ ± ­ µ®¦¤¥­¨¿ ¢¥°¸¨­» y ,
ª®²®° ¿ ¿¢«¿¥²±¿ À¤¿¤¥©Á ¢¥°¸¨­» x (¨¬¥¥² ²®£® ¦¥ °®¤¨²¥«¿, ·²®
¨ ¢¥°¸¨­  p[x]). ±«¨ ¢¥°¸¨­  y ª° ±­ ¿, ¨¬¥¥² ¬¥±²® ±«³· © 1,
¥±«¨ ·¥°­ ¿ | ²® ®¤¨­ ¨§ ±«³· ¥¢ 2 ¨ 3. ® ¢±¥µ ±«³· ¿µ ¢¥°¸¨­ 
p[p[x]] ·¥°­ ¿, ² ª ª ª ¯ °  x{p[x] ¡»«  ¥¤¨­±²¢¥­­»¬ ­ °³¸¥­¨¥¬
RB-±¢®©±²¢.
«³· © 1 (±²°®ª¨ 7{10) ¯®ª § ­ ­  °¨±. 14.5. ²  · ±²¼ ²¥ª±² 
¨±¯®«­¿¥²±¿, ¥±«¨ ¨ p[x], ¨ y ª° ±­»¥. °¨ ½²®¬ ¢¥°¸¨­  p[p[x]]
| ·¥°­ ¿. ¥°¥ª° ±¨¬ p[x] ¨ y ¢ ·¥°­»© ¶¢¥²,   p[p[x]] | ¢ ª° ±­»©. °¨ ½²®¬ ·¨±«® ·¥°­»µ ¢¥°¸¨­ ­  «¾¡®¬ ¯³²¨ ¨§ ª®°­¿ ª
«¨±²¼¿¬ ®±² ­¥²±¿ ¯°¥¦­¨¬.  °³¸¥­¨¥ RB-±¢®©±²¢  ¢®§¬®¦­® ¢
¥¤¨­±²¢¥­­®¬ ¬¥±²¥ ­®¢®£® ¤¥°¥¢ : ³ p[p[x]] ¬®¦¥² ¡»²¼ ª° ±­»©
°®¤¨²¥«¼. ®½²®¬³ ­ ¤® ¯°®¤®«¦¨²¼ ¢»¯®«­¥­¨¥ ¶¨ª« , ¯°¨±¢®¨¢ x §­ ·¥­¨¥ p[p[x]].
 ±«³· ¿µ 2 ¨ 3 ¢¥°¸¨­  y ·¥°­ ¿. ²¨ ¤¢  ±«³· ¿ ° §«¨· ¾²±¿ ²¥¬, ª ª¨¬ °¥¡¥­ª®¬ x ¯°¨µ®¤¨²±¿ ±¢®¥¬³ °®¤¨²¥«¾ | «¥¢»¬

276

« ¢  14 ° ±­®-·¥°­»¥ ¤¥°¥¢¼¿

¨±. 14.6 «³· ¨ 2 ¨ 3 ¢ ¯°®¶¥¤³°¥ RB-Insert.  ª ¨ ¤«¿ ±«³· ¿ 1, ­ °³¸¥­®
±¢®©±²¢® 3 ª° ±­®-·¥°­»µ ¤¥°¥¢¼¥¢, ² ª ª ª ¢¥°¸¨­  x ¨ ¥¥ °®¤¨²¥«¼ p[x] |
ª° ±­»¥. ®°­¨ ¤¥°¥¢¼¥¢ ,  ,  ¨  | ·¥°­»¥; ½²¨ ¤¥°¥¢¼¿ ¨¬¥¾² ®¤¨­ ª®¢³¾
·¥°­³¾ ¢»±®²³. ¡  ¢° ¹¥­¨¿, ¯®ª § ­­»¥ ­  °¨±³­ª¥, ­¥ ¬¥­¿¾² ·¨±«® ·¥°­»µ
¢¥°¸¨­ ­  ¯³²¨ ®² ª®°­¿ ª «¨±²¼¿¬. ®±«¥ ½²®£® ¬» ¢»µ®¤¨¬ ¨§ ¶¨ª« : RB±¢®©±²¢  ¢»¯®«­¥­» ¢±¾¤³.

¨«¨ ¯° ¢»¬. ±«¨ ¯° ¢»¬, ¨±¯®«­¿¾²±¿ ±²°®ª¨ 12{13 (±«³· © 2). 
½²®¬ ±«³· ¥ ¢»¯®«­¿¥²±¿ «¥¢®¥ ¢° ¹¥­¨¥, ª®²®°®¥ ±¢®¤¨² ±«³· © 2
ª ±«³· ¾ 3. ª®£¤  x ¿¢«¿¥²±¿ «¥¢»¬ °¥¡¥­ª®¬ (°¨±. 14.6),  ª ª ª
¨ x, ¨ p[x] ª° ±­»¥, ¯®±«¥ ¢° ¹¥­¨¿ ª®«¨·¥±²¢  ·¥°­»µ ¢¥°¸¨­ ­ 
¯³²¿µ ®±² ¾²±¿ ¯°¥¦­¨¬¨.
² ª, ®±² «®±¼ ° ±±¬®²°¥²¼ ±«³· © 3: ª° ±­ ¿ ¢¥°¸¨­  x ¿¢«¿¥²±¿ «¥¢»¬ °¥¡¥­ª®¬ ª° ±­®© ¢¥°¸¨­» p[x], ª®²®° ¿ ¿¢«¿¥²±¿ «¥¢»¬ °¥¡¥­ª®¬ ·¥°­®© ¢¥°¸¨­» p[p[x]], ¯° ¢»¬ °¥¡¥­ª®¬ ª®²®°®©
¿¢«¿¥²±¿ ·¥°­ ¿ ¢¥°¸¨­  y .  ½²®¬ ±«³· ¥ ¤®±² ²®·­® ¯°®¨§¢¥±²¨
¯° ¢®¥ ¢° ¹¥­¨¥ ¨ ¯¥°¥ª° ±¨²¼ ¤¢¥ ¢¥°¸¨­», ·²®¡» ³±²° ­¨²¼ ­ °³¸¥­¨¥ RB -±¢®©±²¢. ¨ª« ¡®«¼¸¥ ­¥ ¢»¯®«­¿¥²±¿, ² ª ª ª ¢¥°¸¨­  p[x] ²¥¯¥°¼ ·¥°­ ¿.
 ª®¢® ¢°¥¬¿ ¢»¯®«­¥­¨¿ ¯°®¶¥¤³°» RB-Insert? »±®² 
ª° ±­®-·¥°­®£® ¤¥°¥¢  ¥±²¼ O(lg n), ¥±«¨ ¢ ¤¥°¥¢¥ n ¢¥°¸¨­, ¯®½²®¬³ ¢»§®¢ Tree-Insert ²°¥¡³¥² ¢°¥¬¥­¨ O(lg n). ¨ª« ¯®¢²®°¿¥²±¿,
²®«¼ª® ¥±«¨ ¬» ¢±²°¥· ¥¬ ±«³· © 1, ¨ ¯°¨ ½²®¬ x ±¤¢¨£ ¥²±¿ ¢¢¥°µ
¯® ¤¥°¥¢³.  ª¨¬ ®¡° §®¬, ¶¨ª« ¯®¢²®°¿¥²±¿ O(lg n) ° §, ¨ ®¡¹¥¥
¢°¥¬¿ ° ¡®²» ¥±²¼ O(lg n). ­²¥°¥±­®, ·²® ¯°¨ ½²®¬ ¢»¯®«­¿¥²±¿
­¥ ¡®«¥¥ ¤¢³µ ¢° ¹¥­¨© (¯®±«¥ ª®²®°»µ ¬» ¢»µ®¤¨¬ ¨§ ¶¨ª« ).
¯° ¦­¥­¨¿
14.3-1  ±²°®ª¥ 2 ¯°®¶¥¤³°» RB-Insert ¬» ª° ±¨¬ ­®¢³¾ ¢¥°¸¨­³ x ¢ ª° ±­»© ¶¢¥². ±«¨ ¡» ¬» ¯®ª° ±¨«¨ ¥¥ ¢ ·¥°­»© ¶¢¥²,
±¢®©±²¢® 3 ­¥ ¡»«® ¡» ­ °³¸¥­®. ®·¥¬³ ¦¥ ¬» ½²®£® ­¥ ±¤¥« «¨?
14.3-2  ±²°®ª¥ 18 ¬» ª° ±¨¬ ª®°¥­¼ ¤¥°¥¢  ¢ ·¥°­»© ¶¢¥².  ·¥¬ ½²® ¤¥« ¥²±¿?
14.3-3  °¨±³©²¥ ª° ±­®-·¥°­»¥ ¤¥°¥¢¼¿, ª®²®°®¥ ¯®«³· ¾²±¿ ¯°¨ ¯®±«¥¤®¢ ²¥«¼­®¬ ¤®¡ ¢«¥­¨¨ ª ¯³±²®¬³ ¤¥°¥¢³ ª«¾·¥©
41; 38; 31; 12; 19; 8.

¤ «¥­¨¥

277

14.3-4 ³±²¼ ·¥°­ ¿ ¢»±®²  ª ¦¤®£® ¨§ ¯®¤¤¥°¥¢¼¥¢ ,  ,  ,  , "
­  °¨±³­ª µ 14.5 ¨ 14.6 ° ¢­  k.  ©¤¨²¥ ·¥°­»¥ ¢»±®²» ¢±¥µ ¢¥°¸¨­ ­  ½²¨µ °¨±³­ª µ ¨ ¯°®¢¥°¼²¥, ·²® ±¢®©±²¢® 4 ¤¥©±²¢¨²¥«¼­®
­¥ ­ °³¸ ¥²±¿.
14.3-5  ±±¬®²°¨¬ ª° ±­®-·¥°­®¥ ¤¥°¥¢®, ¯®«³·¥­­®¥ ¤®¡ ¢«¥­¨¥¬ n ¢¥°¸¨­ ª ¯³±²®¬³ ¤¥°¥¢³. ¡¥¤¨²¥±¼, ·²® ¯°¨ n > 1 ¢ ¤¥°¥¢¥
¥±²¼ µ®²¿ ¡» ®¤­  ª° ±­ ¿ ¢¥°¸¨­ .
14.3-6  ª ½´´¥ª²¨¢­® °¥ «¨§®¢ ²¼ ¯°®¶¥¤³°³ RB-Insert, ¥±«¨
¢ ¢¥°¸¨­ µ ­¥ µ° ­¿²±¿ ³ª § ²¥«¨ ­  °®¤¨²¥«¥©?

14.4. ¤ «¥­¨¥
 ª ¨ ¤°³£¨¥ ®¯¥° ¶¨¨, ³¤ «¥­¨¥ ¢¥°¸¨­» ¨§ ª° ±­®-·¥°­®£® ¤¥°¥¢  ²°¥¡³¥² ¢°¥¬¥­¨ O(lg n). ¤ «¥­¨¥ ¢¥°¸¨­» ­¥±ª®«¼ª® ±«®¦­¥¥ ¢±² ¢ª¨.
²®¡» ³¯°®±²¨²¼ ®¡° ¡®²ª³ £° ­¨·­»µ ³±«®¢¨©, ¬» ¨±¯®«¼§³¥¬
´¨ª²¨¢­»© ½«¥¬¥­² (¯®- ­£«¨©±ª¨ ­ §»¢ ¥¬»© sentinel) ¢¬¥±²® nil
(±¬. c. ??). «¿ ª° ±­®-·¥°­®£® ¤¥°¥¢  T ´¨ª²¨¢­»© ½«¥¬¥­² nil[T ]
¨¬¥¥² ²¥ ¦¥ ¯®«¿, ·²® ¨ ®¡»·­ ¿ ¢¥°¸¨­  ¤¥°¥¢ . £® ¶¢¥² ·¥°­»©,
  ®±² «¼­»¬ ¯®«¿¬ (p, left, right ¨ key ) ¬®£³² ¡»²¼ ¯°¨±¢®¥­» «¾¡»¥ §­ ·¥­¨¿. » ±·¨² ¥¬, ·²® ¢ ª° ±­®-·¥°­®¬ ¤¥°¥¢¥ ¢±¥ ³ª § ²¥«¨ nil § ¬¥­¥­» ³ª § ²¥«¿¬¨ ­  nil[T ].
« £®¤ °¿ ´¨ª²¨¢­»¬ ½«¥¬¥­² ¬ ¬» ¬®¦¥¬ ±·¨² ²¼ nil-«¨±²,
¿¢«¿¾¹¨©±¿ °¥¡¥­ª®¬ ¢¥°¸¨­» x, ®¡»·­®© ¢¥°¸¨­®©, °®¤¨²¥«¼
ª®²®°®© ¥±²¼ x.  ¯°¨­¶¨¯¥ ¬®¦­® ¡»«® ¡» § ¢¥±²¨ ¯® ®¤­®© ´¨ª²¨¢­®© ¢¥°¸¨­¥ ¤«¿ ª ¦¤®£® «¨±² , ­® ½²® ¡»«® ¡» ­ ¯° ±­®© ¯®²¥°¥© ¯ ¬¿²¨. ²®¡» ¨§¡¥¦ ²¼ ½²®£®, ¬» ¨±¯®«¼§³¥¬ ®¤¨­ ½«¥¬¥­²
nil[T ], ¯°¥¤±² ¢«¿¾¹¨© ¢±¥ «¨±²». ¤­ ª®, ª®£¤  ¬» µ®²¨¬ ° ¡®² ²¼ ± «¨±²®¬ | °¥¡¥­ª®¬ ¢¥°¸¨­» x, ­ ¤® ­¥ § ¡»²¼ ¢»¯®«­¨²¼
¯°¨±¢ ¨¢ ­¨¥ p[nil[T ]] x.
°®¶¥¤³°  RB-Delete ±«¥¤³¥² ±µ¥¬¥ ¯°®¶¥¤³°» Tree-Delete
¨§ ° §¤¥«  13.3. »°¥§ ¢ ¢¥°¸¨­³, ®­  ¢»§»¢ ¥² ¢±¯®¬®£ ²¥«¼­³¾
¯°®¶¥¤³°³ RB-Delete-Fixup, ª®²®° ¿ ¬¥­¿¥² ¶¢¥²  ¨ ¯°®¨§¢®¤¨²
¢° ¹¥­¨¿, ·²®¡» ¢®±±² ­®¢¨²¼ RB-±¢®©±²¢ .

278

« ¢  14 ° ±­®-·¥°­»¥ ¤¥°¥¢¼¿

RB-Delete (T; z )

1 if left[z ] = nil[T ] ¨«¨ right[z ] = nil[T ]
2
then y z
3
else y Tree-Successor(z )
4 if left[y ] 6= nil[T ]
5
then x left[y ]
6
else x right[y ]
7 p[x] p[y ]
8 if p[y ] = nil[T ]
9
then root[T ] x
10
else if y = left[p[y ]]
11
then left[p[y ]] x
12
else right[p[y ]] x
13 if y 6= z
14
then key[z ] key[y ]
15
. ®¯¨°³¥¬ ¤®¯®«­¨²¥«¼­»¥ ¤ ­­»¥ ¨§ ¢¥°¸¨­» y .
16 if color[y ] = black
17
then RB-Delete-Fixup (T; x)
18 return y
±²¼ ²°¨ ° §«¨·¨¿ ¬¥¦¤³ ¯°®¶¥¤³° ¬¨ RB-Delete ¨ TreeDelete. ®-¯¥°¢»µ, ¢¬¥±²® nil ¢±¾¤³ ±²®¨² ³ª § ²¥«¼ ­  ´¨ª²¨¢­»© ½«¥¬¥­² nil[T ]. ®-¢²®°»µ, ¯°®¢¥°ª  x 6= nil ¢ ±²°®ª¥ 7
¯°®¶¥¤³°» Tree-Delete ³¤ «¥­ , ¨ ¯°¨±¢ ¨¢ ­¨¥ p[x] p[y ] ¢»¯®«­¿¥²±¿ ¢ «¾¡®¬ ±«³· ¥. ±«¨ x ¥±²¼ ´¨ª²¨¢­»© ½«¥¬¥­² nil[T ],
²® ¥£® ³ª § ²¥«¼ ­  °®¤¨²¥«¿ ±² ­®¢¨²±¿ ° ¢­»¬ °®¤¨²¥«¾ ³¤ «¿¥¬®£® ½«¥¬¥­²  y . -²°¥²¼¨µ, ¢ ±²°®ª µ 16{17 ¢»§»¢ ¥²±¿ ¯°®¶¥¤³°  RB-Delete-Fixup, ¥±«¨ ³¤ «¿¥¬ ¿ ¢¥°¸¨­  y | ·¥°­ ¿. °¨
³¤ «¥­¨¨ ª° ±­®© ¢¥°¸¨­» RB-±¢®©±²¢  ­¥ ­ °³¸ ¾²±¿ (·¥°­»¥
¢»±®²» ­¥ ¬¥­¿¾²±¿, ¨ ª° ±­»¥ ¢¥°¸¨­» ­¥ ¬®£³² ±² ²¼ ±®±¥¤­¨¬¨). ¥°¥¤ ¢ ¥¬ ¿ ¯°®¶¥¤³°¥ RB-Delete-Fixup ¢¥°¸¨­  x ¿¢«¿« ±¼ ¥¤¨­±²¢¥­­»¬ °¥¡¥­ª®¬ ¢¥°¸¨­» y , ¥±«¨ ³ y ¡»« °¥¡¥­®ª (­¥
¿¢«¿¾¹¨©±¿ «¨±²®¬), ¨«¨ ´¨ª²¨¢­»¬ ½«¥¬¥­²®¬ nil[T ], ¥±«¨ ¢¥°¸¨­  y ­¥ ¨¬¥«  ¤¥²¥©.  ¯®±«¥¤­¥¬ ±«³· ¥ ¯°¨±¢ ¨¢ ­¨¥ ¢ ±²°®ª¥ 7 £ ° ­²¨°³¥², ·²® p[x] ³ª §»¢ ¥² ­  ¡»¢¸¥£® °®¤¨²¥«¿ y |
¢­¥ § ¢¨±¨¬®±²¨ ®² ²®£®, ¿¢«¿¥²±¿ «¨ x ­ ±²®¿¹¥© ¢¥°¸¨­®© ¨«¨
´¨ª²¨¢­»¬ ½«¥¬¥­²®¬.
®±¬®²°¨¬, ª ª ¯°®¶¥¤³°  RB-Delete-Fixup ¢®±±² ­ ¢«¨¢ ¥²
RB-±¢®©±²¢  ¤¥°¥¢ .

¤ «¥­¨¥

RB-Delete-Fixup (T; x)

279

1 while x 6= root[T ] ¨ color[x] = black
2
do if x = left[p[x]]
3
then w right[p[x]]
4
if color[w] = red
5
then color[w] black
. «³· © 1
6
color[p[x]] red
. «³· © 1
7
Left-Rotate(T; p[x])
. «³· © 1
8
w right[p[x]]
. «³· © 1
9
if color[left[w]] = black ¨
color[right[w]] = black
10
then color[w] red
. «³· © 2
11
x p[x]
. «³· © 2
12
else if color[right[w]] = black
13
then color[left[w]] black . «³· © 3
14
color[w] red
. «³· © 3
15
Right-Rotate(T; w) . «³· © 3
16
w right[p[x]]
. «³· © 3
17
color[w] color[p[x]]
. «³· © 4
18
color[p[x]] black
. «³· © 4
19
color[right[w]] black
. «³· © 4
20
Left-Rotate(T; p[x])
. «³· © 4
21
x root[T ]
. «³· © 4
22
else (±¨¬¬¥²°¨·­»© ´° £¬¥­² ±
§ ¬¥­®© left $ right)
23 color[x] black
±«¨ ³¤ «¥­­ ¿ ¯°®¶¥¤³°®© RB-Delete ¢¥°¸¨­  y ¡»«  ·¥°­®©,
²® «¾¡®© ¯³²¼, ·¥°¥§ ­¥¥ ¯°®µ®¤¨¢¸¨©, ²¥¯¥°¼ ±®¤¥°¦¨² ­  ®¤­³
·¥°­³¾ ¢¥°¸¨­³ ¬¥­¼¸¥.  ª¨¬ ®¡° §®¬, ±¢®©±²¢® 4 ­ °³¸¨«®±¼.
» ¬®¦¥¬ ª®¬¯¥­±¨°®¢ ²¼ ½²® §  ±·¥² ¢¥°¸¨­» x (§ ­¿¢¸¥© ¬¥±²® ¢¥°¸¨­» y ). ±«¨ x | ª° ±­ ¿, ±¤¥« ¥¬ ¥¥ ·¥°­®© (§ ®¤­® ¬»
¨§¡¥£ ¥¬ ®¯ ±­®±²¨ ¯®«³·¨²¼ ª° ±­³¾ ¢¥°¸¨­³ ± ª° ±­»¬ °®¤¨²¥«¥¬). ±«¨ x | ·¥°­ ¿, ®¡º¿¢¨¬ ¥¥ À¤¢ ¦¤» ·¥°­®©Á ¨ ¡³¤¥¬ ±·¨² ²¼ §  ¤¢¥ ¯°¨ ¯®¤±·¥²¥ ·¨±«  ·¥°­»µ ¢¥°¸¨­ ­  ¯³²¨ ®² ª®°­¿ ª
«¨±²¼¿¬. ®­¥·­®, ² ª®© ¢»µ®¤ ¬®¦¥² ¡»²¼ «¨¸¼ ¢°¥¬¥­­»¬, ¯®±ª®«¼ª³ ®¯°¥¤¥«¥­¨¥ ª° ±­®-·¥°­»µ ¤¥°¥¢¼¥¢ ­¥ ¯°¥¤³±¬ ²°¨¢ ¥²
¤¢ ¦¤» ·¥°­»µ ¢¥°¸¨­, ¨ ¬» ¤®«¦­» ¯®±²¥¯¥­­® ®² ² ª®© ¢¥°¸¨­» ¨§¡ ¢¨²¼±¿.
°®¶¥¤³°  RB-Delete-Fixup (T; x) ¯°¨¬¥­¿¥²±¿ ª ¤¥°¥¢³, ª®²®°®¥ ®¡« ¤ ¥² ±¢®©±²¢ ¬¨ ª° ±­®-·¥°­®£® ¤¥°¥¢ , ¥±«¨ ³·¥±²¼ ¤®¯®«­¨²¥«¼­³¾ ¥¤¨­¨¶³ ·¥°­®²» ¢ ¢¥°¸¨­¥ x, ¨ ¯°¥¢° ¹ ¥² ¥£®
¢ ­ ±²®¿¹¥¥ ª° ±­®-·¥°­®¥ ¤¥°¥¢®.  ¶¨ª«¥ (±²°®ª¨ 1{22) ¤¥°¥¢® ¬¥­¿¥²±¿, ¨ §­ ·¥­¨¥ ¯¥°¥¬¥­­®© x ²®¦¥ ¬¥­¿¥²±¿ (¢»¤¥«¥­­ ¿
¢¥°¸¨­  ¬®¦¥² ±¤¢¨£ ²¼±¿ ¢¢¥°µ ¯® ¤¥°¥¢³), ­® ±´®°¬³«¨°®¢ ­­®¥

280

« ¢  14 ° ±­®-·¥°­»¥ ¤¥°¥¢¼¿

±¢®©±²¢® ®±² ¥²±¿ ¢¥°­»¬.
¨ª« § ¢¥°¸ ¥²±¿, ¥±«¨ (1) x ³ª §»¢ ¥² ­  ª° ±­³¾ ¢¥°¸¨­³ (²®£¤  ¬» ¢ ±²°®ª¥ 23 ª° ±¨¬ ¥¥ ¢ ·¥°­»© ¶¢¥²) ¨«¨ ¥±«¨ (2) x ³ª §»¢ ¥² ­  ª®°¥­¼ (²®£¤  «¨¸­¿¿ ·¥°­®²  ¬®¦¥² ¡»²¼ ¯°®±²® ³¤ «¥­ 
¨§ ¤¥°¥¢ ). ®¦¥² ®ª § ²¼±¿ ² ª¦¥, ·²® (3) ¢­³²°¨ ²¥«  ¶¨ª« 
³¤ ¥²±¿ ¢»¯®«­¨²¼ ­¥±ª®«¼ª® ¢° ¹¥­¨© ¨ ¯¥°¥ª° ±¨²¼ ­¥±ª®«¼ª®
¢¥°¸¨­, ¯®±«¥ ·¥£® ¤¢ ¦¤» ·¥°­ ¿ ¢¥°¸¨­  ¨±·¥§­¥².  ½²®¬ ±«³· ¥ ¯°¨±¢ ¨¢ ­¨¥ x root[T ] ¯®§¢®«¿¥² ¢»©²¨ ¨§ ¶¨ª« .
­³²°¨ ¶¨ª«  x ³ª §»¢ ¥² ­  ¤¢ ¦¤» ·¥°­³¾ ¢¥°¸¨­³, ­¥ ¿¢«¿¾¹³¾±¿ ª®°­¥¬.  ±²°®ª¥ 2 ¬» ®¯°¥¤¥«¿¥¬, ª ª¨¬ °¥¡¥­ª®¬ ¿¢«¿¥²±¿ x | «¥¢»¬ ¨«¨ ¯° ¢»¬. (®¤°®¡­® ¢»¯¨± ­  · ±²¼ ¯°®¶¥¤³°»
¤«¿ ¯¥°¢®£® ±«³· ¿, ¢²®°®© ±«³· © ±¨¬¬¥²°¨·¥­ ¨ ±ª°»² ¢ ±²°®ª¥ 22.) ¥°¥¬¥­­ ¿ w (±²°®ª  3) ³ª §»¢ ¥² ­  ¢²®°®£® °¥¡¥­ª 
¢¥°¸¨­» p[x] (À¡° ² Á ¢¥°¸¨­» x).  ª ª ª ¢¥°¸¨­  x | ¤¢ ¦¤»
·¥°­ ¿, w ­¥ ¬®¦¥² ¡»²¼ ° ¢­® nil[T ], ¯®±ª®«¼ª³ ¢ ½²®¬ ±«³· ¥
¢¤®«¼ ®¤­®£® ¯³²¨ ®² p[x] ¢­¨§ (·¥°¥§ w) ¡»«® ¡» ¬¥­¼¸¥ ·¥°­»µ
¢¥°¸¨­, ·¥¬ ¢¤®«¼ ¤°³£®£® (·¥°¥§ x).
¥²»°¥ ¢®§¬®¦­»µ ±«³· ¿ ¯®ª § ­» ­  °¨±. 14.7. °¥¦¤¥ ·¥¬
° §¡¨° ²¼±¿ ± ­¨¬¨ ¤¥² «¼­®, ¯®±¬®²°¨¬, ª ª ¯°®¢¥°¨²¼, ·²® ¯°¥®¡° §®¢ ­¨¿ ­¥ ­ °³¸ ¾² ±¢®©±²¢® 4. ®±² ²®·­® ³¡¥¤¨²¼±¿, ·²®
ª®«¨·¥±²¢® ·¥°­»µ ¢¥°¸¨­ ®² ª®°­¿ ¯®ª § ­­®£® ¯®¤¤¥°¥¢  ¤®
ª ¦¤®£® ¨§ ¯®¤¤¥°¥¢¼¥¢ ; ; : : :;  ­¥ ¨§¬¥­¨«®±¼.  ¯°¨¬¥°, ­ 
°¨±. 14.7 , ¨««¾±²°¨°³¾¹¥¬ ±«³· © 1, ª®«¨·¥±²¢® ·¥°­»µ ¢¥°¸¨­
®² ª®°­¿ ¤® ª ¦¤®£® ¨§ ¯®¤¤¥°¥¢¼¥¢  ¨  ° ¢­® 3 ª ª ¤®, ² ª ¨ ¯®±«¥ ¯°¥®¡° §®¢ ­¨¿. ( ¯®¬­¨¬, ·²® ¢¥°¸¨­  x ±·¨² ¥²±¿ §  ¤¢¥.)
­ «®£¨·­®, ª®«¨·¥±²¢® ·¥°­»µ ¢¥°¸¨­ ®² ª®°­¿ ¤®  ,  , " ¨  , ° ¢­® 2 ¤® ¨ ¯®±«¥ ¯°¥®¡° §®¢ ­¨¿.   °¨±. 14.7¡ ¢¥°¸¨­  B ¬®¦¥²
¡»²¼ ¨ ·¥°­®©, ¨ ª° ±­®©. ±«¨ ®­  ª° ±­ ¿, ²® ·¨±«® ·¥°­»µ ¢¥°¸¨­ ®² ª®°­¿ ¤®  (¤® ¨ ¯®±«¥ ¯°¥®¡° §®¢ ­¨¿) ° ¢­® 2, ¥±«¨ ·¥°­ ¿
| ²® 3. ±² «¼­»¥ ±«³· ¨ ¯°®¢¥°¿¾²±¿  ­ «®£¨·­® (³¯°. 14.4-5).
² ª, ° ±±¬®²°¨¬ ¢±¥ ±«³· ¨ ¯® ¯®°¿¤ª³. «³· © 1 (±²°®ª¨ 5{8
¯°®¶¥¤³°» RB-Delete-Fixup, °¨±. 14.7 ) ¨¬¥¥² ¬¥±²®, ª®£¤  ¢¥°¸¨­  w, ¡° ² x, ª° ±­ ¿ (¢ ½²®¬ ±«³· ¥ ¨µ °®¤¨²¥«¼, p[x], ·¥°­»©).
 ª ª ª ®¡  °¥¡¥­ª  ¢¥°¸¨­» w ·¥°­»¥, ¬» ¬®¦¥¬ ¯®¬¥­¿²¼ ¶¢¥²  w ¨ p[x] ¨ ¯°®¨§¢¥±²¨ «¥¢®¥ ¢° ¹¥­¨¥ ¢®ª°³£ p[x], ­¥ ­ °³¸ ¿
RB-±¢®©±²¢. ¥°¸¨­  x ®±² ¥²±¿ ¤¢ ¦¤» ·¥°­®©,   ¥¥ ­®¢»© ¡° ²
| ·¥°­»©, ² ª ·²® ¬» ±¢¥«¨ ¤¥«® ª ®¤­®¬³ ¨§ ±«³· ¥¢ 2, 3 ¨«¨ 4.
±«¨ ¢¥°¸¨­  w ·¥°­ ¿, ¨¬¥¥² ¬¥±²® ®¤¨­ ¨§ ±«³· ¥¢ 2{4. ­¨
° §«¨· ¾²±¿ ¬¥¦¤³ ±®¡®© ¶¢¥²®¬ ¤¥²¥© ¢¥°¸¨­» w.  ±«³· ¥ 2
(±²°®ª¨ 10{11, °¨±. 14.7¡) ®¡  °¥¡¥­ª  ¢¥°¸¨­» w ·¥°­»¥.  ª ª ª
¢¥°¸¨­  w ²®¦¥ ·¥°­ ¿, ¬» ¬®¦¥¬ ±­¿²¼ ·¥°­³¾ ®ª° ±ª³ ± x («¨¸­¾¾) ¨ ± w (±¤¥« ¢ ¥¥ ª° ±­®©), ¨ ¤®¡ ¢¨²¼ ·¥°­®²³ °®¤¨²¥«¾, p[x].
®±«¥ ½²®£® ¯°®¤®«¦¨¬ ¢»¯®«­¥­¨¥ ¶¨ª« .  ¬¥²¨¬, ·²® ¥±«¨ ¬»
¯®¯ «¨ ¢ ±«³· © 2 ¨§ ±«³· ¿ 1, ²® ¢¥°¸¨­  p[x] | ª° ±­ ¿, ¯®½²®¬³
¶¨ª« ±° §³ ¦¥ § ¢¥°¸¨²±¿ (¤®¡ ¢¨¢ ·¥°­®£® ª ª° ±­®© ¢¥°¸¨­¥,
¬» ª° ±¨¬ ¥¥ ¢ ®¡»·­»© ·¥°­»© ¶¢¥²).

¤ «¥­¨¥

281

 ±«³· ¥ 3 (±²°®ª¨ 13{16, °¨±. 14.7¢) ¢¥°¸¨­  w ·¥°­ ¿, ¥¥ «¥¢»©
°¥¡¥­®ª | ª° ±­»©,   ¯° ¢»© | ·¥°­»©. » ¬®¦¥¬ ¯®¬¥­¿²¼
¶¢¥²  w ¨ ¥¥ «¥¢®£® °¥¡¥­ª  ¨ ¯®²®¬ ¯°¨¬¥­¨²¼ ¯° ¢®¥ ¢° ¹¥­¨¥
² ª, ·²® RB-±¢®©±²¢  ¡³¤³² ±®µ° ­¥­». ®¢»¬ ¡° ²®¬ ¢¥°¸¨­» x
²¥¯¥°¼ ¡³¤¥² ·¥°­ ¿ ¢¥°¸¨­  ± ª° ±­»¬ ¯° ¢»¬ °¥¡¥­ª®¬, ¨ ¬»
±¢¥«¨ ±«³· © 3 ª ±«³· ¾ 4.
 ª®­¥¶, ¢ ±«³· ¥ 4 (±²°®ª¨ 17{21, °¨±. 17.4£) ¢¥°¸¨­  w (¡° ²
¢¥°¸¨­» x) ¿¢«¿¥²±¿ ·¥°­®©,   ¥¥ ¯° ¢»© °¥¡¥­®ª | ª° ±­»©. ¥­¿¿ ­¥ª®²®°»¥ ¶¢¥²  ¨ ¯°®¨§¢®¤¿ «¥¢®¥ ¢° ¹¥­¨¥ ¢®ª°³£ p[x], ¬»
¬®¦¥¬ ³¤ «¨²¼ ¨§«¨¸­¾¾ ·¥°­®²³ ³ x, ­¥ ­ °³¸ ¿ RB-±¢®©±²¢.
°¨±¢ ¨¢ ­¨¥ x root[T ] ¢»¢®¤¨² ­ ± ¨§ ¶¨ª« .
 ª®¢® ¢°¥¬¿ ¢»¯®«­¥­¨¿ ¯°®¶¥¤³°» RB-Delete? »±®² 
ª° ±­®-·¥°­®£® ¤¥°¥¢  ± n ¢¥°¸¨­ ¬¨ ¥±²¼ O(lg n), ¯®½²®¬³ ¢°¥¬¿
¨±¯®«­¥­¨¿ RB-Delete ¡¥§ ³·¥²  RB-Delete-Fixup ¥±²¼ O(lg n).
ª®«¼ª® ¢°¥¬¥­¨ ²°¥¡³¥² ¶¨ª« ¢ ¯°®¶¥¤³°¥ RB-Delete-Fixup?
 ª ²®«¼ª® ®¡­ °³¦¨¢ ¥²±¿ ±«³· © 1, 3 ¨«¨ 4, ¬» ¢»µ®¤¨¬ ¨§
¶¨ª«  (¯°¨ ½²®¬ ¢»¯®«­¿¥²±¿ O(1) ®¯¥° ¶¨© ¨ ± ¬®¥ ¡®«¼¸¥¥ ²°¨
¢° ¹¥­¨¿). ® ½²®£® ¢®§¬®¦­® ­¥±ª®«¼ª® ¯®¢²®°¥­¨© ±«³· ¿ 2, ­®
¯°¨ ª ¦¤®¬ ¯®¢²®°¥­¨¨ ³ª § ²¥«¼ x ¯¥°¥¬¥¹ ¥²±¿ ¢¢¥°µ ¯® ¤¥°¥¢³
¨ ­¨ª ª¨¥ ¢° ¹¥­¨¿ ­¥ ¯°®¨§¢®¤¿²±¿, ² ª ·²® ·¨±«® ² ª¨µ ¸ £®¢
¥±²¼ O(lg n).  ª¨¬ ®¡° §®¬, ¯°®¶¥¤³°  RB-Delete-Fixup ²°¥¡³¥² ¢°¥¬¥­¨ O(lg n), ¨ ®¡¹¥¥ ¢°¥¬¿ ° ¡®²» ¯°®¶¥¤³°» RB-Delete
² ª¦¥ ¥±²¼ O(lg n) (®²¬¥²¨¬ ¥¹¥ ° §, ·²® ¯°¨ ½²®¬ ¯°®¨§¢®¤¨²±¿
­¥ ¡®«¥¥ ²°¥µ ¢° ¹¥­¨©).
¯° ¦­¥­¨¿
14.4-1 ¡¥¤¨²¥±¼, ·²® ¯®±«¥ ¢»¯®«­¥­¨¿ ¯°®¶¥¤³°» RB-Delete
ª®°¥­¼ ¤¥°¥¢  ®±² ¥²±¿ ·¥°­»¬, ¥±«¨ ®­ ² ª®¢»¬ ¡»«.
14.4-2  ³¯°. 14.3-3 ¯®±²°®¥­® ª° ±­®-·¥°­®¥ ¤¥°¥¢®, ª®²®°®¥ ¯®«³· ¥²±¿ ¤®¡ ¢«¥­¨¥¬ ª«¾·¥© 41; 38; 31; 12; 19; 8 ¢ ¯³±²®¥ ¤¥°¥¢®.
 °¨±³©²¥ ¤¥°¥¢¼¿, ª®²®°»¥ ¯®«³· ²±¿ ¨§ ­¥£® ¯°¨ ¯®±«¥¤®¢ ²¥«¼­®¬ ³¤ «¥­¨¨ ª«¾·¥© 8; 12; 19; 31; 38; 41.
14.4-3  ª ª¨µ ±²°®ª µ ¯°®¶¥¤³°» RB-Delete-Fixup ¬» ¬®¦¥¬
·¨² ²¼ ¨«¨ ¨§¬¥­¿²¼ ´¨ª²¨¢­»© ½«¥¬¥­² nil[T ]?
14.4-4 ¯°®±²¨²¥ ¯°®¶¥¤³°³ Left-Rotate, ¨±¯®«¼§³¿ ´¨ª²¨¢­»© ½«¥¬¥­² ¤«¿ ¯°¥¤±² ¢«¥­¨¿ nil ¨ ¥¹¥ ®¤¨­ ´¨ª²¨¢­»© ½«¥¬¥­²,
±®¤¥°¦ ¹¨© ³ª § ²¥«¼ ­  ª®°¥­¼ ¤¥°¥¢ .
14.4-5 «¿ ª ¦¤®£® ¨§ ±«³· ¥¢ ­  °¨±³­ª¥ 14.7 ¯®¤±·¨² ©²¥ ª®«¨·¥±²¢® ·¥°­»µ ¢¥°¸¨­ ®² ª®°­¿ ¯®¤¤¥°¥¢  ­  °¨±³­ª¥ ¤® ª ¦¤®£® ¨§ ¯®¤¤¥°¥¢¼¥¢ ; ; : : :;  ¨ ³¡¥¤¨²¥±¼, ·²® ®­® ­¥ ¬¥­¿¥²±¿ ¯°¨
¯°¥®¡° §®¢ ­¨¿µ. ±¯®«¼§³©²¥ ®¡®§­ ·¥­¨¥ count(c) ¤«¿ À±²¥¯¥­¨

282

« ¢  14 ° ±­®-·¥°­»¥ ¤¥°¥¢¼¿

¨±. 14.7 ¥²»°¥ ±«³· ¿, ¢®§¬®¦­»µ ¢ ®±­®¢­®¬ ¶¨ª«¥ ¯°®¶¥¤³°» RBDelete-Fixup. ¥°­»¥ ¢¥°¸¨­» ¯®ª § ­» ª ª ·¥°­»¥, ª° ±­»¥ ¯®ª § ­»

²¥¬­®-±¥°»¬¨. ¢¥²«®-±¥°»¥ ¢¥°¸¨­» ­  °¨±³­ª¥ ¬®£³² ¡»²¼ ¨ ª° ±­»¬¨, ¨
·¥°­»¬¨. (µ ¶¢¥²  ®¡®§­ · ¾²±¿ c ¨ c0 .) ³ª¢» ; ; : : : ;  ®¡®§­ · ¾² ¯°®¨§¢®«¼­»¥ ¯®¤¤¥°¥¢¼¿.  ª ¦¤®¬ ±«³· ¥ ª®­´¨£³° ¶¨¿ ±«¥¢  ¯°¥®¡° §³¥²±¿ ¢
ª®­´¨£³° ¶¨¾ ±¯° ¢  ¯¥°¥ª° ¸¨¢ ­¨¥¬ ¢¥°¸¨­ ¨/¨«¨ ¢° ¹¥­¨¿¬¨. ¥°¸¨­ ,
­  ª®²®°³¾ ³ª §»¢ ¥² x, ¤¢ ¦¤» ·¥°­ ¿. ¤¨­±²¢¥­­»© ±«³· ©, ª®£¤  ¢»¯®«­¥­¨¥ ¶¨ª«  ¯°®¤®«¦ ¥²±¿ | ±«³· © 2. ( ) «³· © 1 ±¢®¤¨²±¿ ª ±«³· ¾ 2, 3
¨«¨ 4, ¥±«¨ ¯®¬¥­¿²¼ ¬¥±² ¬¨ ¶¢¥²  ¢¥°¸¨­ B ¨ D ¨ ¯°®¨§¢¥±²¨ «¥¢®¥ ¢° ¹¥­¨¥. (¡)  ±«³· ¥ 2 À¨§¡»²®ª ·¥°­®²»Á ¢ ¢¥°¸¨­¥ x ¯¥°¥¬¥¹ ¥²±¿ ¢¢¥°µ ¯®
¤¥°¥¢³, ª®£¤  ¬» ¤¥« ¥¬ D ª° ±­®© ¨ ³±² ­ ¢«¨¢ ¥¬ ³ª § ²¥«¼ x ¢ B . ±«¨ ¬»
¯®¯ «¨ ¢ ±«³· © 2 ¨§ ±«³· ¿ 1, ²® ¶¨ª« § ¢¥°¸ ¥²±¿, ² ª ª ª ¢¥°¸¨­  B ¡»« 
ª° ±­®©. (¢) «³· © 3 ±¢®¤¨²±¿ ª ±«³· ¾ 4, ¥±«¨ ¯®¬¥­¿²¼ ¬¥±² ¬¨ ¶¢¥²  ¢¥°¸¨­ C ¨ D ¨ ¢»¯®«­¨²¼ ¯° ¢®¥ ¢° ¹¥­¨¥. (£)  ±«³· ¥ 4 ¬®¦­® ¯¥°¥ª° ±¨²¼
­¥ª®²®°»¥ ¢¥°¸¨­» ¨ ¢»¯®«­¨²¼ «¥¢®¥ ¢° ¹¥­¨¥ (­¥ ­ °³¸¨¢ RB-±¢®©±²¢ )
² ª, ·²® «¨¸­¨© ·¥°­»© ¶¢¥² ¨±·¥§ ¥², ¨ ¶¨ª« ¬®¦­® § ¢¥°¸¨²¼.

 ¤ ·¨ ª £« ¢¥ 14

283

·¥°­®²»Á ¢¥°¸¨­» ¶¢¥²  c, ±·¨² ¿ count(c) ° ¢­»¬ 0 ¤«¿ ª° ±­®©
¢¥°¸¨­» ¨ 1 ¤«¿ ·¥°­®©.
14.4-6 °¥¤¯®«®¦¨¬, ·²® ¢¥°¸¨­  ¢±² ¢«¥­  ¢ ª° ±­®-·¥°­®¥ ¤¥°¥¢®,   ¯®²®¬ ±° §³ ¦¥ ³¤ «¥­ . ³¤¥² «¨ ¯®«³·¨¢¸¥¥±¿ ¤¥°¥¢®
±®¢¯ ¤ ²¼ ± ¨±µ®¤­»¬? ®·¥¬³?

 ¤ ·¨
14-1 ¨­ ¬¨·¥±ª¨¥ ¬­®¦¥±²¢  ± ±®µ° ­¥­¨¥¬ ¯°¥¤»¤³¹¨µ ¢¥°±¨©
­®£¤  ¯®«¥§­® ±®µ° ­¿²¼ ¯°¥¤»¤³¹¨¥ ¢¥°±¨¨ ¬¥­¿¾¹¥£®±¿
¬­®¦¥±²¢ . ( ª¨¥ ±²°³ª²³°» ¤ ­­»µ ­ §»¢ ¾²±¿ ¯®- ­£«¨©±ª¨
persistent data structures.) ®¦­®, ª®­¥·­®, ª®¯¨°®¢ ²¼ ¬­®¦¥±²¢®
ª ¦¤»© ° §, ª®£¤  ®­® ¨§¬¥­¿¥²±¿. ® ² ª®© ¯®¤µ®¤ ²°¥¡³¥² ¬­®£® ¯ ¬¿²¨ ¨ ¢°¥¬¥­¨ | ¨ ¥±²¼ ±¯®±®¡», ¯®§¢®«¿¾¹¨¥ ±¤¥« ²¼ ½²®
¡®«¥¥ ½´´¥ª²¨¢­®.
» µ®²¨¬ ¯°¥¤³±¬®²°¥²¼ ¢®§¬®¦­®±²¼ µ° ­¥­¨¿ ¯°¥¤»¤³¹¨µ
¢¥°±¨© ¤«¿ ¬­®¦¥±²¢  S ± ®¯¥° ¶¨¿¬¨ Insert, Delete ¨ Search.
» ±·¨² ¥¬, ·²® ¬­®¦¥±²¢® S °¥ «¨§®¢ ­® ± ¯®¬®¹¼¾ ¤¢®¨·­»µ
¤¥°¥¢¼¥¢ ¯®¨±ª , ª ª ¯®ª § ­® ­  °¨±. 14.8 . «¿ ª ¦¤®© ¢¥°±¨¨
¬­®¦¥±²¢  ¬» µ° ­¨¬ ±¢®© ®²¤¥«¼­»© ª®°¥­¼. ²®¡» ¤®¡ ¢¨²¼
ª«¾· 5, ¬» ±®§¤ ¥¬ ­®¢³¾ ¢¥°¸¨­³ ± ½²¨¬ ª«¾·®¬. ²  ¢¥°¸¨­ 
±² ­®¢¨²±¿ «¥¢»¬ °¥¡¥­ª®¬ ­®¢®© ¢¥°¸¨­» ± ª«¾·®¬ 7, ² ª ª ª
±³¹¥±²¢³¾¹³¾ ¢¥°¸¨­³ ¬¥­¿²¼ ­¥«¼§¿. ®¤®¡­»¬ ®¡° §®¬ ­®¢ ¿
¢¥°¸¨­  ± ª«¾·®¬ 7 ±² ­®¢¨²±¿ «¥¢»¬ °¥¡¥­ª®¬ ­®¢®© ¢¥°¸¨­»
± ª«¾·®¬ 8, ¯° ¢»© °¥¡¥­®ª ª®²®°®© | ±³¹¥±²¢³¾¹ ¿ ¢¥°¸¨­  ±
ª«¾·®¬ 10.  ±¢®¾ ®·¥°¥¤¼, ­®¢ ¿ ¢¥°¸¨­  ± ª«¾·®¬ 8 ±² ­®¢¨²±¿
¯° ¢»¬ °¥¡¥­ª®¬ ­®¢®£® ª®°­¿ r0 ± ª«¾·®¬ 4, «¥¢»© °¥¡¥­®ª ª®²®°®£® | ±³¹¥±²¢³¾¹ ¿ ¢¥°¸¨­  ± ª«¾·®¬ 3.  ª¨¬ ®¡° §®¬, ¬»
ª®¯¨°³¥¬ «¨¸¼ · ±²¼ ¤¥°¥¢ ,   ¢ ®±² «¼­®¬ ¨±¯®«¼§³¥¬ ±² °®¥, ª ª
½²® ¯®ª § ­® ­  °¨±. 14.8¡.
» ¯°¥¤¯®« £ ¥¬, ·²® ¢¥°¸¨­» ¤¥°¥¢  ±®¤¥°¦ ² ¯®«¿ key, left ¨
right, ­® ­¥ ±®¤¥°¦ ² ¯®«¿ p, ³ª §»¢ ¾¹¥£® ­  °®¤¨²¥«¿. (¬. ² ª¦¥ ³¯°. 14.3-6.)
 . ®ª ¦¨²¥, ª ª¨¥ ¢¥°¸¨­» µ° ­¨¬®£® ² ª¨¬ ®¡° §®¬ ¤¥°¥¢ 
¤®«¦­» ¡»²¼ ¨§¬¥­¥­» (±®§¤ ­») ¢ ®¡¹¥¬ ±«³· ¥ ¯°¨ ¤®¡ ¢«¥­¨¨ ¨«¨ ³¤ «¥­¨¨ ½«¥¬¥­² .
¡.  ¯¨¸¨²¥ ¯°®¶¥¤³°³ Persistent-Tree-Insert, ª®²®° ¿ ¤®¡ ¢«¿¥² ª«¾· k ¢ ¤¥°¥¢® T .
¢. ±«¨ ¢»±®²  ¤¥°¥¢  ° ¢­  h, ±ª®«¼ª® ¢°¥¬¥­¨ ¨ ¯ ¬¿²¨ ²°¥¡³¥² ­ ¯¨± ­­ ¿ ¢ ¬¨ ¯°®¶¥¤³° ? (®«¨·¥±²¢® ¯ ¬¿²¨ ¬®¦­®
¨§¬¥°¿²¼ ª®«¨·¥±²¢®¬ ­®¢»µ ¢¥°¸¨­.)
£. ³±²¼ ¬» ¨±¯®«¼§³¥¬ ¨ ¯®«¿ p ¢ ¢¥°¸¨­ µ ¤¥°¥¢ .  ½²®¬ ±«³· ¥
¯°®¶¥¤³°  Persistent-Tree-Insert ¤®«¦­  ¡³¤¥² ¢»¯®«­¨²¼

284

« ¢  14 ° ±­®-·¥°­»¥ ¤¥°¥¢¼¿

¨±. 14.8 ( ) ¢®¨·­®¥ ¤¥°¥¢® ¯®¨±ª  ± ª«¾· ¬¨ 2; 3; 4; 7; 8; 10. (¡) ¥°¥¢® ±
±®µ° ­¥­¨¥¬ ¯°¥¤»¤³¹¨µ ¢¥°±¨© ¯®±«¥ ¤®¡ ¢«¥­¨¿ ª«¾·  5. ¥ª³¹ ¿ ¢¥°±¨¿
±®±²®¨² ¨§ ¢¥°¸¨­, ¤®±²³¯­»µ ¨§ ²¥ª³¹¥£® ª®°­¿ r0 ,   ¯°¥¤»¤³¹ ¿ ¢¥°±¨¿
±®¤¥°¦¨² ¢¥°¸¨­», ¤®±²³¯­»¥ ¨§ ±² °®£® ª®°­¿ r. ¥¬­®-±¥°»¥ ¢¥°¸¨­» ¤®¡ ¢«¥­» ¯°¨ ¤®¡ ¢«¥­¨¨ ª«¾·  5.

¤.

¤®¯®«­¨²¥«¼­»¥ ¤¥©±²¢¨¿. ®ª ¦¨²¥, ·²® ¢ ½²®¬ ±«³· ¥ ¢°¥¬¿
° ¡®²» ¨ ®¡º¥¬ ­¥®¡µ®¤¨¬®© ¯ ¬¿²¨ ¡³¤³² 
(n), £¤¥ n | ª®«¨·¥±²¢® ¢¥°¸¨­ ¢ ¤¥°¥¢¥.
®ª ¦¨²¥, ª ª ¬®¦­® ¨±¯®«¼§®¢ ²¼ ª° ±­®-·¥°­»¥ ¤¥°¥¢¼¿,
·²®¡» £ ° ­²¨°®¢ ²¼, ·²® ¤®¡ ¢«¥­¨¥ ¨ ³¤ «¥­¨¥ ½«¥¬¥­²  ¤«¿
¬­®¦¥±²¢  ± µ° ­¥­¨¥¬ ¯°¥¤»¤³¹¨µ ¢¥°±¨© ¡³¤³² ²°¥¡®¢ ²¼
¢°¥¬¥­¨ O(lg n) ¢ µ³¤¸¥¬ ±«³· ¥.

14-2 ¯¥° ¶¨¿ ®¡º¥¤¨­¥­¨¿ ª° ±­®-·¥°­»µ ¤¥°¥¢¼¥¢
¯¥° ¶¨¿ ®¡º¥¤¨­¥­¨¿ (join) ¯°¨¬¥­¿¥²±¿ ª ¤¢³¬ ¤¨­ ¬¨·¥±ª¨¬
¬­®¦¥±²¢ ¬ S1 ¨ S2 ¨ ½«¥¬¥­²³ x, ¯°¨·¥¬ § ° ­¥¥ ¨§¢¥±²­®, ·²®
key[x1] 6 key[x] 6 key[x2] ¤«¿ «¾¡»µ x1 2 S1 ¨ x2 2 S2. ¥ °¥§³«¼² ²®¬ ¿¢«¿¥²±¿ ¬­®¦¥±²¢® S = S1 [ fxg [ S2.  ½²®© § ¤ ·¥
¬» ¯®ª ¦¥¬, ª ª °¥ «¨§®¢ ²¼ ®¯¥° ¶¨¾ ®¡º¥¤¨­¥­¨¿ ¤«¿ ª° ±­®·¥°­»µ ¤¥°¥¢¼¥¢.
 . » ¡³¤¥¬ µ° ­¨²¼ ·¥°­³¾ ¢»±®²³ ª° ±­®-·¥°­®£® ¤¥°¥¢  T
¢ ±¯¥¶¨ «¼­®© ¯¥°¥¬¥­­®© bh[T ]. ¡¥¤¨²¥±¼, ·²® ½²® §­ ·¥­¨¥
¬®¦­® ¯®¤¤¥°¦¨¢ ²¼, ­¥ ° §¬¥¹ ¿ ­¨ª ª®© ¤®¯®«­¨²¥«¼­®© ¨­´®°¬ ¶¨¨ ¢ ¢¥°¸¨­ µ ¤¥°¥¢  ¨ ­¥ ³µ³¤¸ ¿  ±¨¬¯²®²¨ª³ ¢°¥¬¥­¨ ° ¡®²» ¯°®¶¥¤³° RB-Insert ¨ RB-Delete. ®ª ¦¨²¥, ·²®,
±¯³±ª ¿±¼ ¯® ¤¥°¥¢³, ¬®¦­® ¢»·¨±«¨²¼ ·¥°­³¾ ¢»±®²³ ª ¦¤®©
¢¥°¸¨­» §  ¢°¥¬¿ O(1) ¢ ° ±·¥²¥ ­  ª ¦¤³¾ ¯°®±¬®²°¥­­³¾
¢¥°¸¨­³.
» µ®²¨¬ °¥ «¨§®¢ ²¼ ®¯¥° ¶¨¾ RB-Join(T1; x; T2), ª®²®° ¿ ¨§
¤¢³µ ¤¥°¥¢¼¥¢ T1 ¨ T2 ´®°¬¨°³¥² ­®¢®¥ ª° ±­®-·¥°­®¥ ¤¥°¥¢® T =
T1 [ fxg [ T2 (±² °»¥ ¤¥°¥¢¼¿ ¯°¨ ½²®¬ ° §°³¸ ¾²±¿). ³±²¼ n |
®¡¹¥¥ ª®«¨·¥±²¢® ¢¥°¸¨­ ¢ T1 ¨ T2.

 ¬¥· ­¨¿ ª £« ¢¥ 14
¡.

¢.

£.
¤.

285

·¨² ¿, ·²® bh[T1] > bh[T2], ®¯¨¸¨²¥  «£®°¨²¬ ±® ¢°¥¬¥­¥¬ ° ¡®²» O(lg n), ­ µ®¤¿¹¨© ±°¥¤¨ ·¥°­»µ ¢¥°¸¨­ ¤¥°¥¢  T1 , ¨¬¥¾¹¨µ ·¥°­³¾ ¢»±®²³ bh[T2], ¢¥°¸¨­³ y ± ­ ¨¡®«¼¸¨¬ ª«¾·®¬.
³±²¼ Ty | ¯®¤¤¥°¥¢® ± ª®°­¥¬ y . ®ª ¦¨²¥, ª ª § ¬¥­¨²¼ Ty
­  Ty [ fxg [ T2 §  ¢°¥¬¿ O(1) ¡¥§ ¯®²¥°¨ ±¢®©±²¢  ³¯®°¿¤®·¥­­®±²¨.
 ª ª®© ¶¢¥² ­ ¤® ¯®ª° ±¨²¼ x, ·²®¡» ±®µ° ­¨²¼ RB-±¢®©±²¢  1,
2 ¨ 4? ¡º¿±­¨²¥, ª ª ¢®±±² ­®¢¨²¼ ±¢®©±²¢® 3 §  ¢°¥¬¿ O(lg n).
¡¥¤¨²¥±¼, ·²® ¢°¥¬¿ ¢»¯®«­¥­¨¿ ¯°®¶¥¤³°» RB-Join ¥±²¼
O(lg n).

 ¬¥· ­¨¿
¤¥¿ ¡ « ­±¨°®¢ª¨ ¤¢®¨·­»µ ¤¥°¥¢¼¥¢ ¯®¨±ª  ¯°¨­ ¤«¥¦¨²
. . ¤¥«¼±®­³-¥«¼±ª®¬³ ¨ . .  ­¤¨±³ [2], ¯°¥¤«®¦¨¢¸¨¬ ¢
1962 £®¤³ ª« ±± ±¡ « ­±¨°®¢ ­­»µ ¤¥°¥¢¼¥¢, ­ §»¢ ¥¬»µ ²¥¯¥°¼
-¤¥°¥¢¼¿¬¨.  « ­± ¯®¤¤¥°¦¨¢ ¥²±¿ ± ¯®¬®¹¼¾ ¢° ¹¥­¨©;
¤«¿ ¥£® ¢®±±² ­®¢«¥­¨¿ ¯®±«¥ ¤®¡ ¢«¥­¨¿ ¨«¨ ³¤ «¥­¨¿ ¢¥°¸¨­»
¬®¦¥² ¯®²°¥¡®¢ ²¼±¿ (lg n) ¢° ¹¥­¨© (¤«¿ ¤¥°¥¢  ± n ¢¥°¸¨­ ¬¨). ¹¥ ®¤¨­ ª« ±± ¤¥°¥¢¼¥¢ ¯®¨±ª , ­ §»¢ ¥¬»µ 2-3-¤¥°¥¢¼¿¬¨,
¡»« ¯°¥¤«®¦¥­ ®¯ª°®´²®¬ (J. E. Hopcroft, ­¥ ®¯³¡«¨ª®¢ ­®) ¢
1970 £®¤³. ¤¥±¼ ¡ « ­± ¯®¤¤¥°¦¨¢ ¥²±¿ §  ±·¥² ¨§¬¥­¥­¨¿ ±²¥¯¥­¥© ¢¥°¸¨­. ¡®¡¹¥­¨¥ 2-3-¤¥°¥¢¼¥¢, ­ §»¢ ¥¬®¥ -¤¥°¥¢¼¿¬¨,
¯°¥¤«®¦¨«¨  ©¥° ¨  ª°¥©² [18]; -¤¥°¥¢¼¿ ®¡±³¦¤ ¾²±¿ ¢
£« ¢¥ 19.
° ±­®-·¥°­»¥ ¤¥°¥¢¼¿ ¯°¥¤«®¦¨«  ©¥° [17], ­ §¢ ¢ ¨µ À±¨¬¬¥²°¨·­»¬¨ ¤¢®¨·­»¬¨ -¤¥°¥¢¼¿¬¨Á. ¨¡ ± ¨ ¥¤¦¢¨ª [93] ¯®¤°®¡­® ¨§³·¨«¨ ¨µ ±¢®©±²¢  ¨ ¯°¥¤«®¦¨«¨ ¨±¯®«¼§®¢ ²¼ ¤«¿ ­ £«¿¤­®±²¨ ª° ±­»© ¨ ·¥°­»© ¶¢¥² .
§ ¬­®£¨µ ¤°³£¨µ ¢ °¨ ¶¨© ­  ²¥¬³ ±¡ « ­±¨°®¢ ­­»µ ¤¥°¥¢¼¥¢
­ ¨¡®«¥¥ «¾¡®¯»²­», ¢¨¤¨¬®, À° ±¸¨°¿¾¹¨¥±¿ ¤¥°¥¢¼¿Á (splay
trees), ª®²®°»¥ ¯°¨¤³¬ «¨ «¥ ²®° ¨  °¼¿­ [177]. ²¨ ¤¥°¥¢¼¿
¿¢«¿¾²±¿ À± ¬®°¥£³«¨°³¾¹¨¬¨±¿Á. (®°®¸¥¥ ®¯¨± ­¨¥ ° ±¸¨°¿¾¹¨µ±¿ ¤¥°¥¢¼¥¢ ¤ «  °¼¿­ [188].)  ±¸¨°¿¾¹¨¥±¿ ¤¥°¥¢¼¿ ¯®¤¤¥°¦¨¢ ¾² ¡ « ­± ¡¥§ ¨±¯®«¼§®¢ ­¨¿ ¤®¯®«­¨²¥«¼­»µ ¯®«¥© (²¨¯ 
¶¢¥² ). ¬¥±²® ½²®£® À° ±¸¨°¿¾¹¨¥ ®¯¥° ¶¨¨Á (splay operations),
¢ª«¾· ¾¹¨¥ ¢° ¹¥­¨¿, ¢»¯®«­¿¾²±¿ ¯°¨ ª ¦¤®¬ ®¡° ¹¥­¨¨ ª ¤¥°¥¢³. ·¥²­ ¿ ±²®¨¬®±²¼ (amortized cost, £«. 18) ¢ ° ±·¥²¥ ­  ®¤­³ ®¯¥° ¶¨¾ ± ¤¥°¥¢®¬ ¤«¿ ° ±¸¨°¿¾¹¨µ±¿ ¤¥°¥¢¼¥¢ ±®±² ¢«¿¥²
O(lg n).

15

®¯®«­¥­¨¥ ±²°³ª²³° ¤ ­­»µ

 «¥ª® ­¥ ¢® ¢±¥µ ±¨²³ ¶¨¿µ ¬®¦­® ®¡®©²¨±¼ «¨¸¼ ª« ±±¨·¥±ª¨¬¨ ±²°³ª²³° ¬¨ ¤ ­­»µ (¤¢®¨·­»¬¨ ¤¥°¥¢¼¿¬¨ ¯®¨±ª , ¤¢³±²®°®­­¥ ±¢¿§ ­­»¬¨ ±¯¨±ª ¬¨, µ¥¸-² ¡«¨¶ ¬¨ ¨ ². ¯.) ¤­ ª® °¥¤ª®
²°¥¡³¥²±¿ ¯°¨¤³¬ ²¼ ·²®-²® ±®¢±¥¬ ­®¢®¥: ¢ ¡®«¼¸¨­±²¢¥ ±«³· ¥¢ ¤®±² ²®·­® ° ±¸¨°¨²¼ ª ª³¾-«¨¡® ¨§ ª« ±±¨·¥±ª¨µ ±²°³ª²³°
¤ ­­»µ, µ° ­¿ ¢¬¥±²¥ ± ¥¥ ®¡º¥ª² ¬¨ ¤®¯®«­¨²¥«¼­³¾ ¨­´®°¬ ¶¨¾. ´´¥ª²¨¢­®¥ ®¡­®¢«¥­¨¥ ½²®© ¨­´®°¬ ¶¨¨ ¯°¨ ¢»¯®«­¥­¨¨
®¯¥° ¶¨© ¨­®£¤  ²°¥¡³¥² ­¥¬ «®© ¨§®¡°¥² ²¥«¼­®±²¨.
 ª ·¥±²¢¥ ¯°¨¬¥°  ¢ ½²®¬ ° §¤¥«¥ ° ±±¬ ²°¨¢ ¾²±¿ ª° ±­®·¥°­»¥ ¤¥°¥¢¼¿. ° ­¿ ¢ ¢¥°¸¨­ µ ¤®¯®«­¨²¥«¼­³¾ ¨­´®°¬ ¶¨¾,
¬» ±¬®¦¥¬ ¡»±²°® ­ µ®¤¨²¼ i-© ¯® ¯®°¿¤ª³ ½«¥¬¥­²,   ² ª¦¥ ¢»¯®«­¿²¼ ®¡° ²­®¥ ¤¥©±²¢¨¥: ­ µ®¤¨²¼ ¯®°¿¤ª®¢»© ­®¬¥° ¤ ­­®£®
½«¥¬¥­²  ¬­®¦¥±²¢  (° §¤. 15.1).  ° §¤¥«¥ 15.2 ®¡±³¦¤ ¥²±¿ ®¡¹ ¿ ±µ¥¬  ° ¡®²» ± ¤®¯®«­¨²¥«¼­®© ¨­´®°¬ ¶¨¥© ¨ ¤®ª §»¢ ¥²±¿
²¥®°¥¬ , ª®²®° ¿ ®¡«¥£· ¥² ¯®¯®«­¥­¨¥ ¤«¿ ª° ±­®-·¥°­»µ ¤¥°¥¢¼¥¢.  ° §¤¥«¥ 15.3 ½²  ¦¥ ²¥®°¥¬  ¨±¯®«¼§³¥²±¿ ¤«¿ ¯®±²°®¥­¨¿
±²°³ª²³°» ¤ ­­»µ, µ° ­¿¹¥© ¤¨­ ¬¨·¥±ª®¥ ¬­®¦¥±²¢® ¯°®¬¥¦³²ª®¢ (­  ·¨±«®¢®© ¯°¿¬®©) ¨ ¯®§¢®«¿¾¹¥© ¡»±²°® ­ µ®¤¨²¼ ½«¥¬¥­²
¬­®¦¥±²¢ , ¯¥°¥ª°»¢ ¾¹¨©±¿ ± § ¤ ­­»¬ ¯°®¬¥¦³²ª®¬.

15.1. ¨­ ¬¨·¥±ª¨¥ ¯®°¿¤ª®¢»¥ ±² ²¨±²¨ª¨
®°¿¤ª®¢»¥ ±² ²¨±²¨ª¨ ³¦¥ ®¡±³¦¤ «¨±¼ ¢ £« ¢¥ 10, £¤¥ ¬» ¨±ª «¨ i-© ¯® ¯®°¿¤ª³ ½«¥¬¥­² ¬­®¦¥±²¢  ¨§ n ½«¥¬¥­²®¢, ·²® ²°¥¡®¢ «® O(n) ®¯¥° ¶¨© (¥±«¨ ¬­®¦¥±²¢® ¯°¥¤¢ °¨²¥«¼­® ­¥ ³¯®°¿¤®·¥­®).  ¤ ­­®¬ ° §¤¥«¥ ¬» ¯®ª ¦¥¬, ª ª ± ¯®¬®¹¼¾ ¯®¯®«­¥­­»µ
ª° ±­®-·¥°­»µ ¤¥°¥¢¼¥¢ ­ ©²¨ i-© ½«¥¬¥­² §  O(log n) ®¯¥° ¶¨©.
°®¬¥ ²®£®, §  ²® ¦¥ ¢°¥¬¿ ¬®¦­® ¡³¤¥² ­ ©²¨ ¯®°¿¤ª®¢»© ­®¬¥°
§ ¤ ­­®£® ½«¥¬¥­² .
®¤µ®¤¿¹ ¿ ±²°³ª²³°  ¤ ­­»µ ¯®ª § ­  ­  °¨±. 15.1. ®°¿¤ª®¢»¬ ¤¥°¥¢®¬ (order-statistic tree) ¬» ­ §»¢ ¥¬ ª° ±­®-·¥°­®¥ ¤¥°¥¢® T , ª ¦¤ ¿ ¢¥°¸¨­  x ª®²®°®£®, ¯®¬¨¬® ®¡»·­»µ ¯®«¥© key[x],
color[x], p[x], left[x] ¨ right[x] ¨¬¥¥² ¯®«¥ size[x].  ­¥¬ µ° ­¨²±¿ ° §-

¨­ ¬¨·¥±ª¨¥ ¯®°¿¤ª®¢»¥ ±² ²¨±²¨ª¨

287

¬¥° (ª®«¨·¥±²¢® ¢¥°¸¨­, ­¥ ±·¨² ¿ nil-«¨±²¼¥¢) ¯®¤¤¥°¥¢  ± ª®°­¥¬ ¢ x (±·¨² ¿ ¨ ± ¬³ ¢¥°¸¨­³ x). ·¨² ¿, ·²® ¢ ¯®«¥ size[nil]
§ ¯¨± ­ 0, ¬®¦­® ­ ¯¨± ²¼ ² ª®¥ ±®®²­®¸¥­¨¥:
size[x] = size[left[x]] + size[right[x]] + 1:
(°¨ °¥ «¨§ ¶¨¨ ¬®¦­® ¨±¯®«¼§®¢ ²¼ ´¨ª²¨¢­»© ½«¥¬¥­² nil[T ],
ª ª ¢ ° §¤¥«¥ 14.4,   ¬®¦­® ª ¦¤»© ° § ¯°®¢¥°¿²¼, ­¥ ° ¢¥­ «¨ ³ª § ²¥«¼ §­ ·¥­¨¾ nil, ¨ ¯®¤±² ¢«¿²¼ 0 ¢¬¥±²® §­ ·¥­¨¿ ¯®«¿ size.)
®¨±ª i-£® ¯® ¢¥«¨·¨­¥ ½«¥¬¥­² 
» ¤®«¦­» ³¬¥²¼ ®¡­®¢«¿²¼ ¤®¯®«­¨²¥«¼­³¾ ¨­´®°¬ ¶¨¾ (¯®«¿ size ) ¯°¨ ¤®¡ ¢«¥­¨¨ ¨ ³¤ «¥­¨¨ ½«¥¬¥­²®¢. ® ±­ · «  ®¡º¿±­¨¬, ª ª ¥¾ ¯®«¼§®¢ ²¼±¿.  ·­¥¬ ± ¯®¨±ª  i-£® ½«¥¬¥­² . ¥ª³°±¨¢­ ¿ ¯°®¶¥¤³°  OS-Select(x; i) ¢®§¢° ¹ ¥² ³ª § ²¥«¼ ­  i-© ½«¥¬¥­² ¯®¤¤¥°¥¢  ± ª®°­¥¬ x.  ©²¨ i-© ½«¥¬¥­² ¢® ¢±¥¬ ¤¥°¥¢¥ T
¬®¦­® ± ¯®¬®¹¼¾ ¢»§®¢  OS-Select(root[T ]; i).
OS-Select(x; i)
1 r size[left[x]]+1
2 if i = r
3 then return x
4 elseif i < r
5 then return OS-Select(left[x]; i)
6 else return OS-Select(right[x]; i ; r)
²®²  «£®°¨²¬ ¨±¯®«¼§³¥² ²³ ¦¥ ¨¤¥¾, ·²® ¨  «£®°¨²¬» ¯®¨±ª 
£« ¢» 10.  ¯®¤¤¥°¥¢¥ ± ª®°­¥¬ x ±­ · «  ¨¤³² size[left[x]] ¢¥°¸¨­ «¥¢®£® ¯®¤¤¥°¥¢ , ¬¥­¼¸¨µ x, § ²¥¬ ± ¬  ¢¥°¸¨­  x (ª®²®° ¿
¿¢«¿¥²±¿ (size[left[x]] + 1)-© ¯® ±·¥²³), ¨ § ²¥¬ ¢¥°¸¨­» ¯° ¢®£®
¯®¤¤¥°¥¢  x.
°®¶¥¤³°  ­ ·¨­ ¥² ± ¢»·¨±«¥­¨¿ ¯®°¿¤ª®¢®£® ­®¬¥°  r ¢¥°¸¨­» x (±²°®ª  1). ±«¨ i = r (±²°®ª  2), ²® x ¨ ¥±²¼ i-© ½«¥¬¥­²,
¨ ¬» ¢®§¢° ¹ ¥¬ ¥£® (±²°®ª  3). ±«¨ i < r, ²® ¨±ª®¬»© ½«¥¬¥­²
­ µ®¤¨²±¿ ¢ «¥¢®¬ ¯®¤¤¥°¥¢¥ ¢¥°¸¨­» x, ¨ ¯°®£° ¬¬  °¥ª³°±¨¢­® ¢»§»¢ ¥² ±¥¡¿ (±²°®ª  5). ±«¨ ¦¥ i > r, ²® ¨±ª®¬»© ½«¥¬¥­²
­ µ®¤¨²±¿ ¢ ¯° ¢®¬ ¯®¤¤¥°¥¢¥ ¢¥°¸¨­» x, ­® ¥£® ¯®°¿¤ª®¢»© ­®¬¥° ¢­³²°¨ ½²®£® ¯®¤¤¥°¥¢  ¡³¤¥² ³¦¥ ­¥ i,   i ; r. ²®² ½«¥¬¥­²
¢»¤ ¥²±¿ ¯°¨ °¥ª³°±¨¢­®¬ ¢»§®¢¥ ¢ ±²°®ª¥ 6.
®ª ¦¥¬, ª ª ¯°®¶¥¤³°  OS-Select ¨¹¥² 17-© ½«¥¬¥­² ¤¥°¥¢ ,
¨§®¡° ¦¥­­®£® ­  °¨±. 15.1. » ­ ·¨­ ¥¬ ± ª®°­¿ (± ª«¾·®¬ 26),
¯°¨ ½²®¬ i = 17.  §¬¥° «¥¢®£® ¯®¤¤¥°¥¢  ª®°­¿ ° ¢¥­ 12, ¯®½²®¬³
¯®°¿¤ª®¢»© ­®¬¥° ª®°­¿ ° ¢¥­ 13, ¨ ¨±ª®¬ ¿ ¢¥°¸¨­  ­ µ®¤¨²±¿ ¢
¯° ¢®¬ ¯®¤¤¥°¥¢¥, ¨¬¥¿ ² ¬ ¯®°¿¤ª®¢»© ­®¬¥° 17 ; 13 = 4. ¹¥¬
4-© ½«¥¬¥­² ¯®¤¤¥°¥¢  ± ª®°­¥¬ 41. ¥¢®¥ ¯®¤¤¥°¥¢® ¢¥°¸¨­» 41
¨¬¥¥² ° §¬¥° 5, ². ¥. ¯®°¿¤ª®¢»© ­®¬¥° ¢¥°¸¨­» 41 ° ¢¥­ 6. ¹¥¬

288

« ¢  15 ®¯®«­¥­¨¥ ±²°³ª²³° ¤ ­­»µ

®°¿¤ª®¢®¥ ¤¥°¥¢®. ° ±­»¥ ¢¥°¸¨­» ¨§®¡° ¦¥­» ª ª ±¢¥²«®±¥°»¥, ·¥°­»¥ | ª ª ²¥¬­»¥. ®¬¨¬® ®¡»·­»µ ¯®«¥© ª° ±­®-·¥°­®£® ¤¥°¥¢ ,
³ ª ¦¤®© ¢¥°¸¨­» x ¥±²¼ ¯®«¥ size[x], £¤¥ µ° ­¨²±¿ ° §¬¥° ¯®¤¤¥°¥¢  ± ª®°­¥¬
¢ x.
¨±. 15.1

4-© ½«¥¬¥­² ¯®¤¤¥°¥¢  ± ª®°­¥¬ 30.  ½²®¬ ¤¥°¥¢¥ ª®°¥­¼ ¨¬¥¥²
¯®°¿¤ª®¢»© ­®¬¥° 2, ¯®½²®¬³ ¨¹¥¬ (4 ; 2) = 2-© ½«¥¬¥­² ¯° ¢®£®
¯®¤¤¥°¥¢ .  ½²®¬ ¤¥°¥¢¥ ª®°¥­¼ 38 ®ª § «±¿ ¢²®°»¬ ¯® ¯®°¿¤ª³
(° §¬¥° «¥¢®£® ¯®¤¤¥°¥¢  ° ¢¥­ 1), ¯®½²®¬³ ¬» ¢®§¢° ¹ ¥¬ ³ª § ²¥«¼ ­  ¢¥°¸¨­³ 38.
°¨ ª ¦¤®¬ °¥ª³°±¨¢­®¬ ¢»§®¢¥ ¯°®¶¥¤³°» ¬» ±¯³±ª ¥¬±¿ ¯®
¤¥°¥¢³ ­  ®¤¨­ ³°®¢¥­¼, ¯®½²®¬³ ¢°¥¬¿ ° ¡®²» ¢ µ³¤¸¥¬ ±«³· ¥
¯°®¯®°¶¨®­ «¼­® ¢»±®²¥. »±®²  ª° ±­®-·¥°­®£® ¤¥°¥¢  ± n ¢¥°¸¨­ ¬¨ ° ¢­  O(log n), ² ª ·²® ¢°¥¬¿ ° ¡®²» ¯°®¶¥¤³°» OSSelect ­  n-½«¥¬¥­²­®¬ ¬­®¦¥±²¢¥ ¥±²¼ O(log n).
¯°¥¤¥«¥­¨¥ ¯®°¿¤ª®¢®£® ­®¬¥°  ½«¥¬¥­² 
°®¶¥¤³°  OS-Rank ¯®«³· ¥² ³ª § ²¥«¼ ­  ½«¥¬¥­² x ¯®°¿¤ª®¢®£® ¤¥°¥¢  T ¨ ­ µ®¤¨² ¯®°¿¤ª®¢»© ­®¬¥° (rank) ½«¥¬¥­²  ¢
¤¥°¥¢¥.
OS-Rank(T; x)
1 r size[left[x]] + 1
2 y x
3 while y 6= root[T ]
4
do if y = right[p[y ]]
5
then r r + size[left[p[y ]]] + 1
6
y p[y ]
7 return r
®°¿¤ª®¢»© ­®¬¥° ½«¥¬¥­²  x ­  ¥¤¨­¨¶³ ¡®«¼¸¥ ª®«¨·¥±²¢ 
½«¥¬¥­²®¢, ¬¥­¼¸¨µ x. ¨ª« ¢ ±²°®ª µ 3{6 ¨¬¥¥² ² ª®© ¨­¢ °¨ ­²:
r ¥±²¼ ¯®°¿¤ª®¢»© ­®¬¥° ¢¥°¸¨­» x ¢ ¯®¤¤¥°¥¢¥ ± ª®°­¥¬ y. ¥°¥¤
¯¥°¢»¬ ¢»¯®«­¥­¨¥¬ ¶¨ª«  ½²® ² ª: r ¥±²¼ ¯®°¿¤ª®¢»© ­®¬¥° x
¢ ¤¥°¥¢¥ ± ª®°­¥¬ ¢ x (±²°®ª  1),   y = x (±²°®ª  2).  ª ­ ¤®
¨§¬¥­¨²¼ r ¯°¨ ¯¥°¥µ®¤¥ ®² ¢¥°¸¨­» y ª ¥¥ °®¤¨²¥«¾ p[y ]? ±«¨ y

¨­ ¬¨·¥±ª¨¥ ¯®°¿¤ª®¢»¥ ±² ²¨±²¨ª¨

289

| «¥¢»© °¥¡¥­®ª ¢¥°¸¨­» p[y ], ²® ¢¥°¸¨­  x ¨¬¥¥² ®¤¨­ ¨ ²®² ¦¥
¯®°¿¤ª®¢»© ­®¬¥° ¢ ¯®¤¤¥°¥¢¼¿µ ± ª®°­¿¬¨ ¢ y ¨ p[y ]. ±«¨ ¦¥ y
| ¯° ¢»© °¥¡¥­®ª, ¯°¨ ¯¥°¥µ®¤¥ ®² y ª p[y ] ª ¯®°¿¤ª®¢®¬³ ­®¬¥°³
¢¥°¸¨­» x ¯°¨¡ ¢¨²±¿ size[left[p[y ]]] ½«¥¬¥­²®¢ «¥¢®£® ¯®¤¤¥°¥¢  ¨
± ¬  ¢¥°¸¨­  p[y ].  ±²°®ª¥ 5 ¬» ³·«¨ ½²³ ¤®¡ ¢ª³.
°¨ ¢»µ®¤¥ ¨§ ¶¨ª«  y = root[T ],   r | ¯®°¿¤ª®¢»© ­®¬¥° x ¢®
¢±¥¬ ¤¥°¥¢¥.
«¿ ¯°¨¬¥°  ¯®±¬®²°¨¬, ª ª ½²  ¯°®¶¥¤³°  ®¯°¥¤¥«¨² ¯®°¿¤ª®¢»© ­®¬¥° ¢¥°¸¨­» ± ª«¾·®¬ 38 ¢ ¤¥°¥¢¥, ¨§®¡° ¦¥­­®¬ ­ 
°¨±. 15.1.  ² ¡«¨¶¥ ¯®ª § ­ ª«¾· ¢¥°¸¨­» y ¨ ·¨±«® r ¢ ­ · «¥ ª ¦¤®£® ¶¨ª« .
 £ key[x] r
1
38
2
2
30
4
3
41
4
4
26 17
®§¢° ¹ ¥²±¿ §­ ·¥­¨¥ 17.
 ª ¦¤»¬ ¸ £®¬ £«³¡¨­  ¢¥°¸¨­» y ³¬¥­¼¸ ¥²±¿ ­  ¥¤¨­¨¶³,
¨ ª ¦¤»© ¸ £ ²°¥¡³¥² ¢°¥¬¥­¨ O(1), ¯®½²®¬³ ¢°¥¬¿ ° ¡®²» ¯°®¶¥¤³°» OS-Rank ­  n-½«¥¬¥­²­®¬ ¬­®¦¥±²¢¥ ¥±²¼ O(log n).
¡­®¢«¥­¨¥ ¨­´®°¬ ¶¨¨ ® ° §¬¥° µ ¯®¤¤¥°¥¢¼¥¢
 ¯®¬®¹¼¾ ¯®«¥© size ¬» ­ ³·¨«¨±¼ ¡»±²°® ¢»·¨±«¿²¼ ¯®°¿¤ª®¢»© ­®¬¥° ½«¥¬¥­² ,   ² ª¦¥ ­ µ®¤¨²¼ i-© ½«¥¬¥­² ¤¥°¥¢ . ¥¯¥°¼
­ ¤® ¯®­¿²¼, ª ª ®¡­®¢«¿²¼ ½²® ¯®«¥ ¯°¨ ¤®¡ ¢«¥­¨¨ ¨ ³¤ «¥­¨¨
½«¥¬¥­²  ¨§ ª° ±­®-·¥°­®£® ¤¥°¥¢ . ª §»¢ ¥²±¿, ½²® ¬®¦­® ±¤¥« ²¼, ­¥ ³µ³¤¸¨¢  ±¨¬¯²®²¨·¥±ª³¾ ®¶¥­ª³ ¢°¥¬¥­¨ ° ¡®²» ¯°®¶¥¤³° ¤®¡ ¢«¥­¨¿ ¨ ³¤ «¥­¨¿ ½«¥¬¥­² .
 ª ¬» ¢¨¤¥«¨ ¢ ° §¤¥«¥ 14.3, ¤®¡ ¢«¥­¨¥ ½«¥¬¥­²  ¢ ª° ±­®·¥°­®¥ ¤¥°¥¢® ±®±²®¨² ¨§ ¤¢³µ · ±²¥©: ±­ · «  ¬» ¤®¡ ¢«¿¥¬ ­®¢³¾
¢¥°¸¨­³, ¤¥« ¿ ¥¥ °¥¡¥­ª®¬ ³¦¥ ±³¹¥±²¢³¾¹¥©,   § ²¥¬ ¯°®¨§¢®¤¨¬ ­¥ª®²®°»¥ ¢° ¹¥­¨¿ ¨ ¯¥°¥ª° ¸¨¢ ­¨¿ (¥±«¨ ½²® ­¥®¡µ®¤¨¬®)
  ¯¥°¢®¬ ½² ¯¥ ¬» ¤«¿ ª ¦¤®© ¯°®©¤¥­­®© ¢¥°¸¨­» x (­  ¯³²¨ ®² ª®°­¿ ¤® ¬¥±²  ¤®¡ ¢«¥­¨¿ ¢¥°¸¨­») ³¢¥«¨·¨¬ ­  ¥¤¨­¨¶³
§­ ·¥­¨¥ size[x].  ¯®«¥ size ¤®¡ ¢«¥­­®© ¢¥°¸¨­» § ¯¨¸¥¬ ·¨±«® 1.
°¨ ½²®¬ ¬» ¯°®µ®¤¨¬ ¯³²¼ ¤«¨­®© O(log n) ¨ ¤®¯®«­¨²¥«¼­® ²° ²¨¬ ¢°¥¬¿ O(log n), ¯®±«¥ ·¥£® ¢±¥ ¯®«¿ size ¯° ¢¨«¼­».
°¨ ¢° ¹¥­¨¨ ¨§¬¥­¿¾²±¿ ° §¬¥°» ²®«¼ª® ¤¢³µ ¯®¤¤¥°¥¢¼¥¢: ¨µ
¢¥°¸¨­ ¬¨ ¿¢«¿¾²±¿ ª®­¶» °¥¡° , ¢®ª°³£ ª®²®°®£® ¯°®¨±µ®¤¨«®
¢° ¹¥­¨¥. ®½²®¬³ ª ²¥ª±²³ ¯°®¶¥¤³°» Left-Rotate(T; x) (° §¤¥« 14.2) ¤®±² ²®·­® ¤®¡ ¢¨²¼ ±²°®ª¨
13 size[y ] size[x]
14 size[x] size[left[x]] + size[right[x]] + 1

290

« ¢  15 ®¯®«­¥­¨¥ ±²°³ª²³° ¤ ­­»µ

¡­®¢«¥­¨¥ ¯®«¿ size ¯°¨ ¢° ¹¥­¨¿µ ¢®ª°³£ °¥¡°  (x; y). ²® ¯®«¥
­¥®¡µ®¤¨¬® ®¡­®¢¨²¼ ²®«¼ª® ³ ¢¥°¸¨­ x ¨ y. «¿ ²®£®, ·²®¡» ³§­ ²¼ ­®¢®¥
§­ ·¥­¨¥, ¤®±² ²®·­® ®¡« ¤ ²¼ ¨­´®°¬ ¶¨¥©, µ° ­¿¹¥©±¿ ¢ x, y ¨ ¢ ª®°­¿µ
¯®¤¤¥°¥¢¼¥¢, ¨§®¡° ¦¥­­»µ ¢ ¢¨¤¥ ²°¥³£®«¼­¨ª®¢.
¨±. 15.2

  °¨±. 15.2 ¯®ª § ­®, ª ª ¬¥­¿¥²±¿ ¯®«¥ size. ­ «®£¨·­»¥ ¨§¬¥­¥­¨¿ ¢­¥±¥¬ ¨ ¢ ¯°®¶¥¤³°³ Right-Rotate.
 ª ª ª ¯°¨ ¤®¡ ¢«¥­¨¨ ½«¥¬¥­²  ¢ ª° ±­®-·¥°­®¥ ¤¥°¥¢® ¢»¯®«­¿¥²±¿ ­¥ ¡®«¼¸¥ ¤¢³µ ¢° ¹¥­¨©, ²® ª®°°¥ª¶¨¿ ¯®«¿ size ¯®±«¥ ¢° ¹¥­¨© ²°¥¡³¥² O(1) ®¯¥° ¶¨© (  ¯¥°¥ª° ¸¨¢ ­¨¥ ¢®®¡¹¥
­¥ ¢«¨¿¥² ­  ° §¬¥°»).  ª¨¬ ®¡° §®¬, ¤®¡ ¢«¥­¨¥ ½«¥¬¥­²  ¢ ¯®°¿¤ª®¢®¥ ¤¥°¥¢® ¨§ n ¢¥°¸¨­ ²°¥¡³¥² ¢°¥¬¥­¨ O(log n), ª ª ¨ ¤«¿
®¡»·­®£® ª° ±­®-·¥°­®£® ¤¥°¥¢ .
¤ «¥­¨¥ ½«¥¬¥­²  ¨§ ª° ±­®-·¥°­®£® ¤¥°¥¢  ² ª¦¥ ±®±²®¨² ¨§
¤¢³µ · ±²¥© | ±­ · «  ¬» ³¤ «¿¥¬ ¢¥°¸¨­³ y ,   § ²¥¬ ¤¥« ¥¬
(± ¬®¥ ¡®«¼¸¥¥) ²°¨ ¢° ¹¥­¨¿ (±¬. ° §¤. 14.4). ®±«¥ ¢»¯®«­¥­¨¿
¯¥°¢®© · ±²¨, ¬» ³¬¥­¼¸¨¬ ­  ¥¤¨­¨¶³ ¯®«¿ size ³ ¢±¥µ ¢¥°¸¨­
­  ¯³²¨ ¨§ y ª ª®°­¾. «¨­  ½²®£® ¯³²¨ O(log n), ¯®½²®¬³ ¤®¯®«­¨²¥«¼­® ­ ¬ ¯®²°¥¡³¥²±¿ ¢°¥¬¿ O(log n). ²® ¯°®¨±µ®¤¨² ± ¢° ¹¥­¨¿¬¨, ¬» ³¦¥ ¢¨¤¥«¨.  ª¨¬ ®¡° §®¬, ®¡­®¢«¥­¨¥ ¯®«¿ size,
­¥ ³µ³¤¸ ¥² ( ±¨¬¯²®²¨·¥±ª¨) ¢°¥¬¿, ­¥®¡µ®¤¨¬®¥ ¤«¿ ³¤ «¥­¨¿ ¨
¤®¡ ¢«¥­¨¿ ½«¥¬¥­² .
¯° ¦­¥­¨¿
15.1-1 ³±²¼ T | ¤¥°¥¢® ­  °¨±. 15.1. ®ª ¦¨²¥, ª ª ° ¡®² ¥²
¯°®¶¥¤³°  OS-Select(T; 10).
15.1-2 ³±²¼ T | ¤¥°¥¢® ­  °¨±. 15.1. ®ª ¦¨²¥, ª ª ° ¡®² ¥²
¯°®¶¥¤³°  OS-Rank(T; x), £¤¥ x | ¢¥°¸¨­  ± ª«¾·®¬ 35.
15.1-3
±¨¨.

¥°¥¯¨¸¨²¥ ¯°®¶¥¤³°³ OS-Select, ­¥ ¨±¯®«¼§³¿ °¥ª³°-

15.1-4 ¥ «¨§³©²¥ °¥ª³°±¨¢­³¾ ¯°®¶¥¤³°³ OS-Key-Rank(T; k),
ª®²®° ¿ ¯®«³· ¥² ­  ¢µ®¤¥ ¯®°¿¤ª®¢®¥ ¤¥°¥¢® T ± ¯®¯ °­® ° §«¨·­»¬¨ ª«¾· ¬¨,   ² ª¦¥ ª«¾· k, ¨ ¢®§¢° ¹ ¥² ¯®°¿¤ª®¢»© ­®¬¥°
ª«¾·  k ¢ ½²®¬ ¤¥°¥¢¥.
15.1-5  ­  ¢¥°¸¨­  x ¯®°¿¤ª®¢®£® ¤¥°¥¢  ¨§ n ¢¥°¸¨­ ¨ ­ ²³° «¼­®¥ ·¨±«® i.  ª ­ ©²¨ i-© ¯® ¯®°¿¤ª³ ½«¥¬¥­², ±·¨² ¿ ®²

¡¹ ¿ ±µ¥¬  ° ¡®²» ± ¤®¯®«­¨²¥«¼­®© ¨­´®°¬ ¶¨¥©

291

¢¥°¸¨­» x, §  ¢°¥¬¿ O(log n)?
15.1-6  ¬¥²¨¬, ·²® ¯°®¶¥¤³°» OS-Select ¨ OS-Rank ¨±¯®«¼§³¾² ¯®«¥ size ²®«¼ª® ¤«¿ ²®£®, ·²®¡» ³§­ ²¼ ¯®°¿¤ª®¢»© ­®¬¥°
¢¥°¸¨­» x ¢ ¯®¤¤¥°¥¢¥ ± ª®°­¥¬ x. °¥¤¯®«®¦¨¬, ·²® ¬» µ° ­¨¬
¢ ¢¥°¸¨­¥ ¢¬¥±²® ¯®«¿ size ½²®² ¯®°¿¤ª®¢»© ­®¬¥°.  ª ®¡­®¢«¿²¼
½²³ ¨­´®°¬ ¶¨¾ ¯°¨ ¤®¡ ¢«¥­¨¨ ¨ ³¤ «¥­¨¨ ½«¥¬¥­² ? ( ¯®¬­¨¬,
·²® ¤®¡ ¢«¥­¨¥ ¨ ³¤ «¥­¨¥ ±®¯°®¢®¦¤ ¾²±¿ ¢° ¹¥­¨¿¬¨.)
15.1-7  ª, ¨±¯®«¼§³¿ ¯®°¿¤ª®¢»¥ ¤¥°¥¢¼¿, ¯®±·¨² ²¼ ·¨±«® ¨­¢¥°±¨© (±¬. § ¤ ·³ 1-3) ¢ ¬ ±±¨¢¥ ° §¬¥°  n §  ¢°¥¬¿ O(n log n)?
15.1-8?  ±±¬®²°¨¬ n µ®°¤ ®ª°³¦­®±²¨, § ¤ ­­»µ ±¢®¨¬¨ ª®­¶ ¬¨ (±·¨² ¥¬, ·²® ¢±¥ 2n ª®­¶¥¢»µ ²®·¥ª ° §«¨·­»). °¨¤³¬ ©²¥
 «£®°¨²¬, ª®²®°»© §  ¢°¥¬¿ O(n lg n) ®¯°¥¤¥«¿¥², ±ª®«¼ª® ¯ ° µ®°¤
¯¥°¥±¥ª ¾²±¿ ¢­³²°¨ ª°³£ . ( ¯°¨¬¥°, ¥±«¨ ¢±¥ µ®°¤» | ¤¨ ¬¥²°», ²® ®²¢¥²®¬ ¡³¤¥² Cn2 .)

15.2. ¡¹ ¿ ±µ¥¬  ° ¡®²» ± ¤®¯®«­¨²¥«¼­®© ¨­´®°¬ ¶¨¥©
¨²³ ¶¨¿, ª®£¤  ²°¥¡³¥²±¿ ¯®¯®«­¨²¼ ª ª³¾-«¨¡® ±² ­¤ °²­³¾
±²°³ª²³°³ ¤ ­­»µ ¤®¯®«­¨²¥«¼­®© ¨­´®°¬ ¶¨¥©, ¤®¢®«¼­® ²¨¯¨·­ . » ¢±²°¥²¨¬±¿ ± ­¥© ±­®¢  ¢ ±«¥¤³¾¹¥¬ ° §¤¥«¥.  ¢ ½²®¬
° §¤¥«¥ ¬» ¤®ª ¦¥¬ ®¡¹³¾ ²¥®°¥¬³, ®¡«¥£· ¾¹³¾ ½²®² ¯°®¶¥±±
¢ ±«³· ¥ ª° ±­®-·¥°­»µ ¤¥°¥¢¼¥¢.
®¯®«­¥­¨¥ ±²°³ª²³°» ¤ ­­»µ ¤¥«¨²±¿ ­  ·¥²»°¥ ¸ £ :
1. ¢»¡¨° ¥¬ ¡ §®¢³¾ ±²°³ª²³°³ ¤ ­­»µ;
2. °¥¸ ¥¬, ª ª³¾ ¤®¯®«­¨²¥«¼­³¾ ¨­´®°¬ ¶¨¾ ¬» ¡³¤¥¬ µ° ­¨²¼
(¨ ®¡­®¢«¿²¼);
3. ¯°®¢¥°¿¥¬, ·²® ½²³ ¨­´®°¬ ¶¨¾ ³¤ ¥²±¿ ®¡­®¢«¿²¼ ¯°¨ ¢»¯®«­¥­¨¨ ®¯¥° ¶¨©, ¤®¯³±²¨¬»µ ¤«¿ ¢»¡° ­­®© ±²°³ª²³°» ¤ ­­»µ;
4. °¥ «¨§³¥¬ ­®¢»¥ ®¯¥° ¶¨¨.
®­¥·­®, ½²¨ ¯° ¢¨«  | ¢±¥£® «¨¸¼ ®¡¹ ¿ ±µ¥¬ , ¨ ¢ ª®­ª°¥²­®©
±¨²³ ¶¨¨ ­ ¤® ¯°®¿¢«¿²¼ ° §³¬­³¾ £¨¡ª®±²¼, ­® ±µ¥¬  ½²  ¬®¦¥²
¡»²¼ ¯®«¥§­®©.
 ¢ ©²¥ ¯®±¬®²°¨¬ ­  ª®­±²°³ª¶¨¨ ° §¤¥«  15.1 ± ²®·ª¨ §°¥­¨¿
½²¨µ ¯° ¢¨«.
  ¸ £¥ 1 ¬» ¢»¡° «¨ ª° ±­®-·¥°­»¥ ¤¥°¥¢¼¿ ¢ ª ·¥±²¢¥ ¡ §®¢®©
±²°³ª²³°».
  ¸ £¥ 2 ¬» °¥¸¨«¨ ¤®¡ ¢¨²¼ ª ª ¦¤®© ¢¥°¸¨­¥ ¯®«¥ size.
¬»±« µ° ­¥­¨¿ ¤®¯®«­¨²¥«¼­®© ¨­´®°¬ ¶¨¨ ±®±²®¨² ¢ ²®¬, ·²®
®­  ¯®§¢®«¿¥² ¢»¯®«­¿²¼ ­¥ª®²®°»¥ ®¯¥° ¶¨¨ ¡»±²°¥¥. ¥§ ¯®«¿
size ¬» ­¥ ±¬®£«¨ ¡» ¢»¯®«­¨²¼ ®¯¥° ¶¨¨ OS-Select ¨ OS-Rank

292

« ¢  15 ®¯®«­¥­¨¥ ±²°³ª²³° ¤ ­­»µ

§  ¢°¥¬¿ O(log n). (¥±ª®«¼ª® ¨­®© ¢ °¨ ­² ¢»¡®°  ¤®¯®«­¨²¥«¼­®© ¨­´®°¬ ¶¨¨ ¤ ­ ¢ ³¯°. 15.2-1.)
  ¸ £¥ 3 ¬» ³¡¥¤¨«¨±¼, ·²® ®¡­®¢«¥­¨¥ ¯®«¥© size ¯°¨ ¤®¡ ¢«¥­¨¨ ¨ ³¤ «¥­¨¨ ½«¥¬¥­²®¢ ¬®¦­® ¢»¯®«­¨²¼ ¡¥§ ³µ³¤¸¥­¨¿  ±¨¬¯²®²¨ª¨ ¤«¿ ¢°¥¬¥­¨ ¤®¡ ¢«¥­¨¿ ¨ ³¤ «¥­¨¿.  ½²®¬ ±¬»±«¥ ­ ¸
¢»¡®° ³¤ ·¥­: ¥±«¨ ¡», ±ª ¦¥¬, ¬» °¥¸¨«¨ µ° ­¨²¼ ¤«¿ ª ¦¤®©
¢¥°¸¨­» ¥¥ ¯®°¿¤ª®¢»© ­®¬¥°, ²® ¯°®¶¥¤³°» OS-Select ¨ OSRank ° ¡®² «¨ ¡» ¡»±²°®, ­® ¤®¡ ¢«¥­¨¥ ­®¢®£® ½«¥¬¥­²  ¯®¢«¥ª«® ¡» §  ±®¡®© ¨§¬¥­¥­¨¥ ¤®¯®«­¨²¥«¼­®© ¨­´®°¬ ¶¨¨ ¢® ¬­®£¨µ
¢¥°¸¨­ µ ¤¥°¥¢  (¢® ¢±¥µ, ¥±«¨ ¤®¡ ¢«¥­­»© ½«¥¬¥­² ¬¨­¨¬ «¥­).
 ¸ ¢»¡®° (¯®«¥ size ) ¤ ¥² ³¤ ·­»© ª®¬¯°®¬¨±± ¬¥¦¤³ «¥£ª®±²¼¾
¨±¯®«¼§®¢ ­¨¿ ¨ ®¡­®¢«¥­¨¿.
  ¸ £¥ 4 ¬» °¥ «¨§®¢ «¨ ¯°®¶¥¤³°» OS-Select ¨ OS-Rank,
¨§-§  ª®²®°»µ ¬», ±®¡±²¢¥­­®, ¨ § ²¥¢ «¨ ¢±¥ ½²® ¤¥«®.
¯°®·¥¬, ¢ ¤°³£¨µ ±¨²³ ¶¨¿µ (³¯°. 15.2-1) ¤®¯®«­¨²¥«¼­ ¿ ¨­´®°¬ ¶¨¿ ¨±¯®«¼§³¥²±¿ ­¥ ¤«¿ °¥ «¨§ ¶¨¨ ­®¢»µ ®¯¥° ¶¨©,   ¤«¿
³±ª®°¥­¨¿ ³¦¥ ¨¬¥¾¹¨µ±¿.
®¯®«­¨²¥«¼­ ¿ ¨­´®°¬ ¶¨¿ ¤«¿ ª° ±­®-·¥°­»µ ¤¥°¥¢¼¥¢
«¥¤³¾¹ ¿ ²¥®°¥¬  ¯®ª §»¢ ¥², ·²® ¤«¿ ª° ±­®-·¥°­»µ ¤¥°¥¢¼¥¢ ¨­´®°¬ ¶¨¾ ®¯°¥¤¥«¥­­®£® ¢¨¤  ¬®¦­® ®¡­®¢«¿²¼, ­¥ § ¬¥¤«¿¿ ( ±¨¬¯²®²¨·¥±ª¨) ®¯¥° ¶¨¨ ¤®¡ ¢«¥­¨¿ ¨ ³¤ «¥­¨¿. ¥ ¤®ª § ²¥«¼±²¢® ¢® ¬­®£®¬ ¯®¢²®°¿¥² ° ±±³¦¤¥­¨¿ ¨§ ° §¤¥«  15.1.
¥®°¥¬  15.1 (®¯®«­¥­¨¥ ª° ±­®-·¥°­®£® ¤¥°¥¢ ).  ±±¬®²°¨¬
¤®¯®«­¨²¥«¼­»©  ²°¨¡³² f , ®¯°¥¤¥«¥­­»© ¤«¿ ¢¥°¸¨­ ª° ±­®·¥°­»µ ¤¥°¥¢¼¥¢. °¥¤¯®«®¦¨¬, ·²® ¤«¿ ¢±¿ª®© ¢¥°¸¨­» x
§­ ·¥­¨¥ f [x] ¯®«­®±²¼¾ § ¤ ¥²±¿ ®±² «¼­®© ¨­´®°¬ ¶¨¥©, µ° ­¿¹¥©±¿ ¢ ¢¥°¸¨­ µ x, left[x] ¨ right[x] (¢ ²®¬ ·¨±«¥ §­ ·¥­¨¿¬¨
f [left[x]] ¨ f [right[x]]), ¨ ¥£® ¢»·¨±«¥­¨¥ ¯® ½²¨¬ ¤ ­­»¬ ²°¥¡³¥²
¢°¥¬¥­¨ O(1). ®£¤  ¯®«¿ f ¬®¦­® ®¡­®¢«¿²¼ ¯°¨ ¤®¡ ¢«¥­¨¨
¨ ³¤ «¥­¨¨ ½«¥¬¥­²  ¨§ ¤¥°¥¢ , ­¥ ³µ³¤¸ ¿ ( ±¨¬¯²®²¨·¥±ª¨)
¢°¥¬¿ ¢»¯®«­¥­¨¿ ¤®¡ ¢«¥­¨¿ ¨ ³¤ «¥­¨¿.
®ª § ²¥«¼±²¢®. ¤¥¿ ¤®ª § ²¥«¼±²¢  ±®±²®¨² ¢ ²®¬, ·²® ¨§¬¥­¥­¨¥ ¯®«¿ f ¢ ­¥ª®²®°®© ¢¥°¸¨­¥ x ¯®¢«¥·¥² §  ±®¡®© ¨§¬¥­¥­¨¿
¯®«¿ f ²®«¼ª® ¢ ¢¥°¸¨­ µ, ° ±¯®«®¦¥­­»µ ­  ¯³²¨ ¨§ ª®°­¿ ¢ x.
 ± ¬®¬ ¤¥«¥, ¨§¬¥­¥­¨¥ f [x] ¯®¢«¥·¥² §  ±®¡®© ¨§¬¥­¥­¨¥ f [p[x]],
·²® ¢ ±¢®¾ ®·¥°¥¤¼ ¨§¬¥­¨² f [p[p[x]]] ¨ ². ¤., ­® ¤°³£¨¥ ¢¥°¸¨­»
®±² ­³²±¿ ­¥²°®­³²»¬¨. ² f [root[T ]] ­¥ § ¢¨±¨² §­ ·¥­¨¥ ¯®«¿ f
¢ ¤°³£¨µ ¢¥°¸¨­ µ, ¨ ¯°®¶¥±± ¨§¬¥­¥­¨© ®±² ­®¢¨²±¿.  ª ª ª ¢»±®²  ¤¥°¥¢  ° ¢­  O(log n), ²® ¯®±«¥ ¨§¬¥­¥­¨¿ ¯®«¿ f [x] ¤«¿ ª ª®©²® ®¤­®© ¢¥°¸¨­» x ¬» ±¬®¦¥¬ ®¡­®¢¨²¼ ¢±¥ ­¥®¡µ®¤¨¬»¥ ¯®«¿ § 
¢°¥¬¿ O(log n).
®¡ ¢«¥­¨¥ ½«¥¬¥­²  x ¢ ¤¥°¥¢® T ¤¥« ¥²±¿ ¢ ¤¢  ½² ¯  (±¬.
° §¤. 14.3).   ¯¥°¢®¬ ½² ¯¥ ¢¥°¸¨­³ x ¤®¡ ¢«¿¾² ¢ ª ·¥±²¢¥

¡¹ ¿ ±µ¥¬  ° ¡®²» ± ¤®¯®«­¨²¥«¼­®© ¨­´®°¬ ¶¨¥©

293

°¥¡¥­ª  ³¦¥ ±³¹¥±²¢³¾¹¥© ¢¥°¸¨­» p[x]. ­ ·¥­¨¥ f [x] ¢»·¨±«¿¥²±¿ §  ¢°¥¬¿ O(1), ² ª ª ª ­®¢ ¿ ¢¥°¸¨­  | «¨±² (²®·­¥¥, ¥¥ ¤¥²¨
| nil-«¨±²¼¿).  «¥¥ ¯°®¨±µ®¤¨² O(lg n) ¨§¬¥­¥­¨© ¯®«¥© ­  ¯³²¨
ª ª®°­¾. ² ª, ¯¥°¢»© ½² ¯ § ­¨¬ ¥² ¢°¥¬¿ O(log n).   ¢²®°®¬
½² ¯¥ ¬» ¢»¯®«­¿¥¬ ¢° ¹¥­¨¿ (± ¬®¥ ¡®«¼¸¥¥ ¤¢ ); ¯®±«¥ ª ¦¤®£® ¯®²°¥¡³¥²±¿ O(lg n) ®¯¥° ¶¨© ¤«¿ ° ±¯°®±²° ­¥­¨¿ ¨§¬¥­¥­¨©
¢¢¥°µ ¯® ¤¥°¥¢³.
¤ «¥­¨¥ ² ª¦¥ ¯°®¢®¤¨²±¿ ¢ ¤¢  ½² ¯  (±¬. ° §¤. 14.4).   ¯¥°¢®¬ ½² ¯¥ ¨§¬¥­¥­¨¿ ¢®§­¨ª ¾², ¥±«¨ ³¤ «¿¥¬ ¿ ¢¥°¸¨­  § ¬¥­¿¥²±¿ ¥¥ ¯®±«¥¤®¢ ²¥«¥¬,   ² ª¦¥ ª®£¤  ¬» ¢»¡° ±»¢ ¥¬ ³¤ «¿¥¬³¾
¢¥°¸¨­³ ¨«¨ ¥¥ ¯®±«¥¤®¢ ²¥«¿.  ¢ ²®¬ ¨ ¢ ¤°³£®¬ ±«³· ¥ ¬» ¨§¬¥­¿¥¬ ¯®«¥ f ³ ®¤­®© ¢¥°¸¨­», ¯®½²®¬³ ®¡­®¢«¥­¨¥ ¢±¥µ ¯®«¥©
§ ©¬¥² ¢°¥¬¿ O(log n).   ¢²®°®¬ ½² ¯¥ ¬» ¤¥« ¥¬ ± ¬®¥ ¡®«¼¸¥¥
²°¨ ¢° ¹¥­¨¿, ª ¦¤®¥ ¨§ ª®²®°»µ ²°¥¡³¥² ¢°¥¬¥­¨ O(log n) ¤«¿
®¡­®¢«¥­¨¿ ¯®«¥© ­  ¯³²¨ ª ª®°­¾.
® ¬­®£¨µ ±«³· ¿µ (¢ · ±²­®±²¨, ¤«¿ ¯®«¿ size ) ¯°¨ ¢° ¹¥­¨¿µ
¢±¥ ¯®«¿ ¬®¦­® ®¡­®¢¨²¼ §  ¢°¥¬¿ O(1),   ­¥ O(log n).  ª ¿ ±¨²³ ¶¨¿ ¢®§­¨ª ¥² ¢ ³¯°. 15.2-4.
¯° ¦­¥­¨¿
15.2-1 ®¯®«­¨²¼ ¯®°¿¤ª®¢®¥ ¤¥°¥¢® (­¥ ³µ³¤¸¨¢  ±¨¬¯²®²¨·¥±ª¨ ¢°¥¬¿ ®¯¥° ¶¨©) ² ª, ·²®¡» ¬¨­¨¬ «¼­»© ¨ ¬ ª±¨¬ «¼­»©
½«¥¬¥­²»,   ² ª¦¥ ¯°¥¤¸¥±²¢¥­­¨ª ¨ ¯®±«¥¤®¢ ²¥«¼ ¤ ­­®£® ½«¥¬¥­²  ®²»±ª¨¢ «¨±¼ ¡» §  ¢°¥¬¿ O(1).
15.2-2 ³¤¥¬ µ° ­¨²¼ ¢ ª ¦¤®© ¢¥°¸¨­¥ ª° ±­®-·¥°­®£® ¤¥°¥¢ 
¥¥ ·¥°­³¾ ¢»±®²³. ®§¬®¦­® «¨ ®¡­®¢«¿²¼ ½²® ¯®«¥ ¯°¨ ¤®¡ ¢«¥­¨¨ ¨ ³¤ «¥­¨¨ ½«¥¬¥­²  ¨§ ¤¥°¥¢ , ­¥ ³µ³¤¸¨¢ ( ±¨¬¯²®²¨·¥±ª¨)
¢°¥¬¿ ° ¡®²» ½²¨µ ®¯¥° ¶¨©?
15.2-3 ³¤¥¬ µ° ­¨²¼ ¢ ¢¥°¸¨­¥ ¥¥ £«³¡¨­³. ®§¬®¦­® «¨ ®¡­®¢«¿²¼ ½²® ¯®«¥ ¯°¨ ¤®¡ ¢«¥­¨¨ ¨ ³¤ «¥­¨¨ ½«¥¬¥­²  ¨§ ¤¥°¥¢ , ­¥
³µ³¤¸¨¢ ( ±¨¬¯²®²¨·¥±ª¨) ¢°¥¬¿ ° ¡®²» ½²¨µ ®¯¥° ¶¨©?
15.2-4? ³±²¼ 
 |  ±±®¶¨ ²¨¢­ ¿ ¡¨­ °­ ¿ ®¯¥° ¶¨¿ ­  ­¥ª®²®°®¬ ¬­®¦¥±²¢¥ M , ¨ ¯³±²¼ ¢ ª ¦¤®© ¢¥°¸¨­¥ ª° ±­®-·¥°­®£® ¤¥°¥¢  µ° ­¨²±¿ ­¥ª®²®°»© ½«¥¬¥­² a ¬­®¦¥±²¢  M (±¢®© ¢ ª ¦¤®©
¢¥°¸¨­¥). ³±²¼ ²¥¯¥°¼ ¬» µ®²¨¬ µ° ­¨²¼ ¢ ª ¦¤®© ¢¥°¸¨­¥ x ¯®«¥ f [x] = a[x1 ] 
 a[x2 ] 
 : : : 
 a[xm ], £¤¥ x1 ; x2; : : :; xm | ¢±¥ ¢¥°¸¨­»
¯®¤¤¥°¥¢  ± ª®°­¥¬ x (¢ ¯®°¿¤ª¥ ¢®§° ±² ­¨¿ ª«¾·¥©). ®ª § ²¼,
·²® ¯®«¥ f ¯°¨ ¢° ¹¥­¨¿µ ¬®¦­® ®¡­®¢«¿²¼ §  ¢°¥¬¿ O(1). °®¢¥±²¨  ­ «®£¨·­®¥ ° ±±³¦¤¥­¨¥ ¤«¿ ¯®«¿ size.
15.2-5? » µ®²¨¬ °¥ «¨§®¢ ²¼ ¤«¿ ª° ±­®-·¥°­»µ ¤¥°¥¢¼¥¢ ®¯¥° ¶¨¾ RB-Enumerate(x; a; b), ª®²®° ¿ ¢»¤ ¥² ±¯¨±®ª ¢±¥µ ¢¥°¸¨­

294

« ¢  15 ®¯®«­¥­¨¥ ±²°³ª²³° ¤ ­­»µ

¢ ¯®¤¤¥°¥¢¥ ± ª®°­¥¬ x, ¤«¿ ª®²®°»µ ª«¾· k ­ µ®¤¨²±¿ ¢ ¯°®¬¥¦³²ª¥ a 6 k 6 b.  ª ±¤¥« ²¼ ½²® §  ¢°¥¬¿ (m + log n), £¤¥ n
| ª®«¨·¥±²¢® ¢¥°¸¨­ ¢ ¤¥°¥¢¥,   m | ·¨±«® ¢»¤ ¢ ¥¬»µ ª«¾·¥©?
(ª § ­¨¥. ®±² ²®·­® ¯®«¥©, ¨¬¥¾¹¨µ±¿ ¢ ª° ±­®-·¥°­»µ ¤¥°¥¢¼¿µ; ­®¢»¥ ¯®«¿ ­¥ ­³¦­».)

15.3. ¥°¥¢¼¿ ¯°®¬¥¦³²ª®¢
 ½²®¬ ° §¤¥«¥ ¬» ¨±¯®«¼§³¥¬ ª° ±­®-·¥°­»¥ ¤¥°¥¢¼¿ ¤«¿ µ° ­¥­¨¿ ¬¥­¿¾¹¥£®±¿ ¬­®¦¥±²¢  ¯°®¬¥¦³²ª®¢. ²°¥§ª®¬ (closed interval) [t1; t2 ] ­ §»¢ ¥²±¿ ¬­®¦¥±²¢® ¢¥¹¥±²¢¥­­»µ ·¨±¥« t, ¤«¿ ª®²®°»µ t1 6 t 6 t2 . (°¥¤¯®« £ ¥²±¿, ·²® t1 6 t2 .) ®«³¨­²¥°¢ «
(half-open interval) ¨ ¨­²¥°¢ « (open interval) ¯®«³· ¾²±¿ ¨§ ®²°¥§ª  ¢»ª¨¤»¢ ­¨¥¬ ®¤­®£® ¨«¨ ¤¢³µ ª®­¶®¢ ±®®²¢¥²±²¢¥­­®.  ½²®¬
° §¤¥«¥ ¬» ¨¬¥¥¬ ¤¥«® ²®«¼ª® ± ®²°¥§ª ¬¨, ­® ¢±¥ °¥§³«¼² ²» «¥£ª® ° ±¯°®±²° ­¿¾²±¿ ­  ¨­²¥°¢ «» ¨ ¯®«³¨­²¥°¢ «».
°¥¤±² ¢¨¬ ±¥¡¥ ¡ §³ ¤ ­­»µ, ¢ ª®²®°®© µ° ­¨²±¿ ¨­´®°¬ ¶¨¿ ®
¯°®²¿¦¥­­»µ ¯® ¢°¥¬¥­¨ ±®¡»²¨¿µ: ¤«¿ ª ¦¤®£® ±®¡»²¨¿ µ° ­¨²±¿ ¯°®¬¥¦³²®ª ¢°¥¬¥­¨, ª®²®°®¥ ®­® § ­¨¬ ¥².  ±±¬ ²°¨¢ ¥¬ ¿ ¢
½²®¬ ° §¤¥«¥ ±²°³ª²³°  ¤ ­­»µ ¯®§¢®«¿¥² ¯® «¾¡®¬³ ¯°®¬¥¦³²ª³
­ ©²¨ ¢±¥ ±®¡»²¨¿, ª®²®°»¥ ¯¥°¥±¥ª ¾²±¿ ± ½²¨¬ ¯°®¬¥¦³²ª®¬,
¯°¨·¥¬ ¤¥« ¥² ½²® ¤®±² ²®·­® ¡»±²°®.
» ±·¨² ¥¬, ·²® ®²°¥§®ª [t1; t2 ] ¯°¥¤±² ¢«¿¥² ±®¡®© § ¯¨±¼ i, ±®±²®¿¹³¾ ¨§ ¤¢³µ ¯®«¥©: low[i] = t1 («¥¢»© ª®­¥¶ (low endpoint))
¨ high[i] = t2 (¯° ¢»© ª®­¥¶ (high endpoint)). ³¤¥¬ £®¢®°¨²¼,
·²® ®²°¥§ª¨ i ¨ i0 ¯¥°¥ª°»¢ ¾²±¿ (overlap), ¥±«¨ low[i] 6 high[i0] ¨
low[i0] 6 high[i]; ¨­»¬¨ ±«®¢ ¬¨, ¥±«¨ i \ i0 6= ;. (¡° ²¨²¥ ¢­¨¬ ­¨¥,
·²® ®²°¥§ª¨, ¨¬¥¾¹¨¥ ®¡¹¨© ª®­¥¶, ±·¨² ¾²±¿ ¯¥°¥ª°»¢ ¾¹¨¬¨±¿.)
±¥£® ¢®§¬®¦­® ²°¨ ¢ °¨ ­²  ¢§ ¨¬­®£® ° ±¯®«®¦¥­¨¿ ®²°¥§ª®¢
i ¨ i0 (°¨±. 15.3):
1. ®²°¥§ª¨ i ¨ i0 ¯¥°¥ª°»¢ ¾²±¿,
2. high[i] < low[i0],
3. high[i0] < low[i].
¥°¥¢®¬ ¯°®¬¥¦³²ª®¢ (interval tree) ­ §®¢¥¬ ª° ±­®-·¥°­®¥ ¤¥°¥¢®, ª ¦¤ ¿ ¢¥°¸¨­  x ª®²®°®£® µ° ­¨² ®²°¥§®ª int[x]. ¥°¥¢®
¯°®¬¥¦³²ª®¢ ¯®§¢®«¿¥² °¥ «¨§®¢ ²¼ ±«¥¤³¾¹¨¥ ®¯¥° ¶¨¨:
Interval-Insert (T; x) ¤®¡ ¢«¿¥² ª ¤¥°¥¢³ T ½«¥¬¥­² x (±®¤¥°¦ ¹¨© ­¥ª®²®°»© ®²°¥§®ª int[x]);
Interval-Delete (T; x) ³¤ «¿¥² ¨§ ¤¥°¥¢  T ½«¥¬¥­² x;
Interval-Search(T; i) ¢®§¢° ¹ ¥² ³ª § ²¥«¼ ­  ½«¥¬¥­² x ¤¥°¥¢ 
T , ¤«¿ ª®²®°®£® ®²°¥§ª¨ i ¨ int[x] ¯¥°¥ª°»¢ ¾²±¿ (¨ ¢®§¢° ¹ ¥²
nil, ¥±«¨ ² ª®£® ½«¥¬¥­²  ¢ ¤¥°¥¢¥ ­¥²).

¥°¥¢¼¿ ¯°®¬¥¦³²ª®¢

295

°¨ ¢ °¨ ­²  ¢§ ¨¬­®£® ° ±¯®«®¦¥­¨¿ ®²°¥§ª®¢ i ¨ i0 . ( ) ²°¥§ª¨
0
i ¨ i 0 ¯¥°¥ª°»¢ ¾²±¿.
®§¬®¦­® ·¥²»°¥ ¢ °¨ ­² ; ¢® ¢±¥µ ·¥²»°¥µ low[i] 6
high[i ] ¨ low[i0 ] 6 high[i]. (¡) high[i] < low[i0]. (¢) high[i0 ] < low[i].
¨±. 15.3

°¨¬¥° ¤¥°¥¢  ¯°®¬¥¦³²ª®¢ ¯®ª § ­ ­  °¨±.15.4. «¥¤³¿ ±µ¥¬¥ ° §¤¥«  15.2, ¬» °¥ «¨§³¥¬ ² ª³¾ ±²°³ª²³°³ ¤ ­­»µ ¨ ®¯¥° ¶¨¨ ­ 
­¥©.
 £ 1:  §®¢ ¿ ±²°³ª²³°  ¤ ­­»µ
» ³¦¥ ¢»¡° «¨ ¡ §®¢³¾ ±²°³ª²³°³: ª° ±­®-·¥°­®¥ ¤¥°¥¢®, ª ¦¤ ¿ ¢¥°¸¨­  x ª®²®°®£® ±®¤¥°¦¨² ®²°¥§®ª int[x]. «¾·®¬ ¢¥°¸¨­» ¿¢«¿¥²±¿ «¥¢»© ª®­¥¶ ®²°¥§ª  low[int[x]]; ®¡µ®¤ ¤¥°¥¢  ¢ ¯®°¿¤ª¥
À«¥¢®¥ ¯®¤¤¥°¥¢® | ª®°¥­¼ | ¯° ¢®¥ ¯®¤¤¥°¥¢®Á ¯¥°¥·¨±«¿¥² ¢¥°¸¨­» ¢ ¯®°¿¤ª¥ ¢®§° ±² ­¨¿ ª«¾·¥©.
 £ 2: ®¯®«­¨²¥«¼­ ¿ ¨­´®°¬ ¶¨¿
 ¦¤ ¿ ¢¥°¸¨­ , ¯®¬¨¬® ®²°¥§ª , ±®¤¥°¦¨² ¯®«¥ max[x], ¢ ª®²®°®¬ µ° ­¨²±¿ ¬ ª±¨¬ «¼­»© ¨§ ¯° ¢»µ ª®­¶®¢ ®²°¥§ª®¢, ±®¤¥°¦ ¹¨µ±¿ ¢ ¯®¤¤¥°¥¢¥ ± ª®°­¥¬ x.
 £ 3: ¡­®¢«¥­¨¥ ¤®¯®«­¨²¥«¼­®© ¨­´®°¬ ¶¨¨
°®¢¥°¨¬, ·²® ¤®¯®«­¨²¥«¼­³¾ ¨­´®°¬ ¶¨¾ ¬®¦­® ®¡­®¢«¿²¼
¯°¨ ¤®¡ ¢«¥­¨¨ ¨ ³¤ «¥­¨¨ ½«¥¬¥­²  ¡¥§ ( ±¨¬¯²®²¨·¥±ª®£®) ³µ³¤¸¥­¨¿ ¢°¥¬¥­¨ ° ¡®²» ½²¨µ ®¯¥° ¶¨©.  ± ¬®¬ ¤¥«¥,
max[x] = max(high[int[x]]; max[left[x]]; max[right[x]]);

¨ ®±² ¥²±¿ «¨¸¼ ±®±« ²¼±¿ ­  ²¥®°¥¬³ 15.1. ®¦­® ®²¬¥²¨²¼ ² ª¦¥, ·²® ¯°¨ ¢° ¹¥­¨¿µ ¯®«¥ max ¬®¦­® ®¡­®¢«¿²¼ §  ¢°¥¬¿ O(1)
(³¯°. 15.2-4 ¨ 15.3-1).

296

« ¢  15 ®¯®«­¥­¨¥ ±²°³ª²³° ¤ ­­»µ

¥°¥¢® ¯°®¬¥¦³²ª®¢. ( )  ¡®° ¨§ 10 ®²°¥§ª®¢ (¢»¸¥ ²®², ³ ª®²®°®£® «¥¢»© ª®­¥¶ ¡®«¼¸¥). (¡) ¥°¥¢® ¯°®¬¥¦³²ª®¢, µ° ­¿¹¥¥ ½²¨ ®²°¥§ª¨. °¨
½²®¬ ±¢®©±²¢® ³¯®°¿¤®·¥­­®±²¨ ¤¥°¥¢  ¢»¯®«­¿¥²±¿ ¤«¿ «¥¢»µ ª®­¶®¢.
¨±. 15.4

 £ 4: ®¢»¥ ®¯¥° ¶¨¨
°®¶¥¤³°  Interval-Search(T; i) ­ µ®¤¨² ¢ ¤¥°¥¢¥ T ®²°¥§®ª,
¯¥°¥ª°»¢ ¾¹¨©±¿ ± i. ±«¨ ² ª®£® ®²°¥§ª  ­¥², ®­  ¢®§¢° ¹ ¥²
§­ ·¥­¨¥ nil.
Interval-Search (T; i)
1 x root[T ]
2 while x 6= nil ¨ int[x] ­¥ ¯¥°¥ª°»¢ ¥²±¿ ± i
3
do if left[x] 6= nil ¨ max[left[x]] > low[i]
4
then x left[x]
5
else x right[x]
6 return x
» ¨¹¥¬ ®²°¥§®ª, ¯°®µ®¤¿ ¤¥°¥¢® ®² ª®°­¿ ª «¨±²³. °®¶¥¤³° 
®±² ­ ¢«¨¢ ¥²±¿, ¥±«¨ ®²°¥§®ª ­ ©¤¥­ ¨«¨ ¥±«¨ §­ ·¥­¨¥ ¯¥°¥¬¥­­®© x ±² «® ° ¢­»¬ nil.  ¦¤ ¿ ¨²¥° ¶¨¿ ¶¨ª«  ²°¥¡³¥² O(1) ¸ £®¢, ¯®½²®¬³ ¢°¥¬¿ ° ¡®²» ¯°®¶¥¤³°» ¯°®¯®°¶¨®­ «¼­® ¢»±®²¥
¤¥°¥¢  (¨ ° ¢­® O(log n) ¤«¿ ¤¥°¥¢  ¨§ n ¢¥°¸¨­).

¥°¥¢¼¿ ¯°®¬¥¦³²ª®¢

297

«¿ ¯°¨¬¥°  ¯®±¬®²°¨¬, ª ª ¯°®¶¥¤³°  ¨¹¥² ¢ ¤¥°¥¢¥ ­ 
°¨±. 15.4 ®²°¥§®ª, ¯¥°¥ª°»¢ ¾¹¨©±¿ ± ®²°¥§ª®¬ i = [22; 25]. »
­ ·¨­ ¥¬ ± ª®°­¿ (x = root[T ]), ª®²®°»© µ° ­¨² ®²°¥§®ª [16; 21],
­¥ ¯¥°¥ª°»¢ ¾¹¨©±¿ ± i.  ª ª ª max[left[x]] = 23, ·²® ¡®«¼¸¥, ·¥¬
low[i] = 22, ²® ¬» ¯¥°¥µ®¤¨¬ ª «¥¢®¬³ °¥¡¥­ª³ ª®°­¿ (x left[x]).
²®² °¥¡¥­®ª µ° ­¨² ®²°¥§®ª [8; 9], ² ª¦¥ ­¥ ¯¥°¥ª°»¢ ¾¹¨©±¿
± i.   ½²®² ° § max[left[x]] = 10 ¬¥­¼¸¥ low[i] = 22, ¯®½²®¬³ ¬»
¯¥°¥µ®¤¨¬ ª ¯° ¢®¬³ °¥¡¥­ª³ ¢¥°¸¨­» x.  ¬ ­ µ®¤¨²±¿ ®²°¥§®ª
[15; 23], ¯¥°¥ª°»¢ ¾¹¨©±¿ ± i, ¨ ¯®¨±ª § ¢¥°¸ ¥²±¿.
 ±±¬®²°¨¬ ¯°¨¬¥° ¡¥§°¥§³«¼² ²­®£® ¯®¨±ª  ¢ ²®¬ ¦¥ ¤¥°¥¢¥ |
¡³¤¥¬ ¨±ª ²¼ ®²°¥§®ª, ¯¥°¥ª°»¢ ¾¹¨©±¿ ± i = [11; 14]. ­®¢  ­ ·¨­ ¥¬ ± ª®°­¿. ®°¥­¼ µ° ­¨² ®²°¥§®ª [16; 21], ­¥ ¯¥°¥ª°»¢ ¾¹¨©±¿
± i.  ª ª ª max[left[x]] = 23 ¡®«¼¸¥ low[i] = 11, ¯¥°¥µ®¤¨¬ ª «¥¢®¬³
°¥¡¥­ª³. ¥¯¥°¼ ¢ x µ° ­¨²±¿ ®²°¥§®ª [8; 9]. ­ ­¥ ¯¥°¥ª°»¢ ¥²±¿
± i, ¨ max[left[x]] = 10 ¬¥­¼¸¥ low[i] = 11, ¯®½²®¬³ ¨¤¥¬ ­ ¯° ¢®. («¥¢  ¨±ª®¬®£® ®²°¥§ª  ¡»²¼ ­¥ ¬®¦¥²).  x ²¥¯¥°¼ µ° ­¨²±¿
[15; 23], ± i ½²®² ®²°¥§®ª ­¥ ¯¥°¥ª°»¢ ¥²±¿, left[x] = nil, ¯®½²®¬³
¨¤¥¬ ­ ¯° ¢® ¨ ¢®§¢° ¹ ¥¬ §­ ·¥­¨¥ nil.
®°°¥ª²­®±²¼ ¯°®¶¥¤³°» Interval-Search ³±² ­ ¢«¨¢ ¥² ²¥®°¥¬  15.2, ª®²®° ¿ ³²¢¥°¦¤ ¥², ·²® ¥±«¨ ®²°¥§ª¨ int[x] ¨ i ­¥ ¯¥°¥ª°»¢ ¾²±¿, ²® ¤ «¼­¥©¸¨© ¯®¨±ª ¨¤¥² ¢ ¯° ¢¨«¼­®¬ ­ ¯° ¢«¥­¨¨
(¥±«¨ ­³¦­»¥ ®²°¥§ª¨ ¢®®¡¹¥ ¥±²¼ ¢ ¤¥°¥¢¥, ²® ®­¨ ¥±²¼ ¨ ¢ ¢»¡¨° ¥¬®© · ±²¨ ¤¥°¥¢ ). ®½²®¬³ ­ ¬ ¤®±² ²®·­® ¯°®±¬®²°¥²¼ ¢±¥£®
®¤¨­ ¯³²¼. (¡° ²¨²¥ ¢­¨¬ ­¨¥, ·²® ±«®¢  À¯° ¢¨«¼­®¥ ­ ¯° ¢«¥­¨¥Á ­¥ ®§­ · ¾², ·²® ¢ ¤°³£®¬ ­ ¯° ¢«¥­¨¨ ¨±ª®¬»µ ®²°¥§ª®¢
­¥²: ¬» ³²¢¥°¦¤ ¥¬ «¨¸¼, ·²® ¥±«¨ ®­¨ ¥±²¼ ¢®®¡¹¥, ²® ¥±²¼ ¨ ¢
À¯° ¢¨«¼­®¬Á ­ ¯° ¢«¥­¨¨!)
¥®°¥¬  15.2. ³±²¼ x | ¯°®¨§¢®«¼­ ¿ ¢¥°¸¨­  ¤¥°¥¢ , i | ®²°¥§®ª, ­¥ ¯¥°¥ª°»¢ ¾¹¨©±¿ ± int[x], ¨ ¬» ¢»¯®«­¿¥¬ ±²°®ª¨ 3{5
¯°®¶¥¤³°» Interval-Search (T; i). ®£¤ :
1. ±«¨ ¢»¯®«­¿¥²±¿ ±²°®ª  4, ²® «¨¡® ¯®¤¤¥°¥¢® ± ª®°­¥¬ left[x]
(«¥¢®¥ ¯®¤¤¥°¥¢®) ±®¤¥°¦¨² ®²°¥§®ª, ¯¥°¥ª°»¢ ¾¹¨©±¿ ± i, «¨¡® ¯®¤¤¥°¥¢® ± ª®°­¥¬ right[x] (¯° ¢®¥ ¯®¤¤¥°¥¢®) ­¥ ±®¤¥°¦¨²
®²°¥§ª , ¯¥°¥ª°»¢ ¾¹¥£®±¿ ± i.
2. ±«¨ ¢»¯®«­¿¥²±¿ ±²°®ª  5, ²® «¥¢®¥ ¯®¤¤¥°¥¢® ­¥ ±®¤¥°¦¨²
®²°¥§ª , ¯¥°¥ª°»¢ ¾¹¥£®±¿ ± i.
®ª § ²¥«¼±²¢®.  ·­¥¬ ± ¡®«¥¥ ¯°®±²®£® ±«³· ¿ 2. ²°®ª  5 ¢»¯®«­¿¥²±¿, ¥±«¨ ­¥ ¢»¯®«­¥­® ³±«®¢¨¥ ¢ ±²°®ª¥ 3, ²® ¥±²¼ ¥±«¨
left[x] = nil ¨«¨ max[left[x]] < low[i].  ¯¥°¢®¬ ±«³· ¥ «¥¢®¥ ¯®¤¤¥°¥¢® ¯³±²®, ¯®½²®¬³ ­¥ ±®¤¥°¦¨² ®²°¥§ª , ¯¥°¥ª°»¢ ¾¹¥£®±¿ ± i.
°¥¤¯®«®¦¨¬, ·²® left[x] 6= nil ¨ max[left[x]] < low[i].  ±±¬®²°¨¬
¯°®¨§¢®«¼­»© ®²°¥§®ª i0 ¨§ «¥¢®£® ¯®¤¤¥°¥¢  (±¬. °¨±. 15.5 ).  ª
ª ª max[left[x]] | ­ ¨¡®«¼¸¨© ¯° ¢»© ª®­¥¶ ² ª¨µ ®²°¥§ª®¢, ²®
high[i0] 6 max[left[i]] < low[i];

298

« ¢  15 ®¯®«­¥­¨¥ ±²°³ª²³° ¤ ­­»µ

²°¥§ª¨ ¢ ¤®ª § ²¥«¼±²¢¥ ²¥®°¥¬» 15.2. ³­ª²¨°®¬ ¯®ª § ­® §­ ·¥­¨¥ max[left[x]]. ( ) «³· © 2: ¬» ¨¤¥¬ ­ ¯° ¢®. ¨ª ª®© ¨­²¥°¢ « i0 ­¥ ¯¥°¥ª°»¢ ¥²±¿ ± i. (¡) «³· © 1: ¬» ¨¤¥¬ ­ «¥¢®. »¡¥°¥¬ ¢ «¥¢®¬ ¯®¤¤¥°¥¢¥
®²°¥§®ª i0 , ¤«¿ ª®²®°®£® high[i0 ] = max[left[x]] > low[i]. ®£¤  «¨¡® i0 ¯¥°¥ª°»¢ ¥²±¿ ± i, «¨¡® i0 «¥¦¨² ¶¥«¨ª®¬ ±¯° ¢  ®² i, ¨ i ­¥ ¯¥°¥ª°»¢ ¥²±¿ ­¨ ± ª ª¨¬
®²°¥§ª®¬ i00 ¨§ ¯° ¢®£® ¯®¤¤¥°¥¢ , ¯®²®¬³ ·²® low[i0 ] 6 low[i00 ].
¨±. 15.5

¯®½²®¬³ ®²°¥§®ª i0 ¶¥«¨ª®¬ «¥¦¨² «¥¢¥¥ ®²°¥§ª  i. «³· © 2 ° ±±¬®²°¥­.
 ±±¬®²°¨¬ ²¥¯¥°¼ ±«³· © 1. °¥¤¯®«®¦¨¬, ·²® ¢ «¥¢®¬ ¯®¤¤¥°¥¢¥ ­¥² ®²°¥§ª®¢, ¯¥°¥ª°»¢ ¾¹¨µ±¿ ± i. ®£¤  ­³¦­® ¤®ª § ²¼,
·²® ² ª¨µ ®²°¥§ª®¢ ­¥² ¨ ¢ ¯° ¢®¬.  ª ª ª ¢»¯®«­¿¥²±¿ ±²°®ª  4,
²® ³±«®¢¨¥ ¢ ±²°®ª¥ 3 ¢»¯®«­¥­®, ¨ max[left[x]] > low[i]. ®½²®¬³ ¢
«¥¢®¬ ¯®¤¤¥°¥¢¥ ­ ©¤¥²±¿ ®²°¥§®ª i0 , ¤«¿ ª®²®°®£®
high[i0] = max[left[i0]] > low[i]
(±¬. °¨±. 15.5¡). ® ®²°¥§ª¨ i ¨ i0 ­¥ ¯¥°¥ª°»¢ ¾²±¿ (¯® ¯°¥¤¯®«®¦¥­¨¾ | ¬» ±·¨² ¥¬, ·²® ¢ «¥¢®¬ ¯®¤¤¥°¥¢¥ ­¥² ®²°¥§ª®¢, ¯¥°¥ª°»¢ ¾¹¨µ±¿ ± i). ²® ®§­ · ¥², ·²® ®²°¥§®ª i0 «¥¦¨² ¶¥«¨ª®¬ ±¯° ¢ 
®² i (¶¥«¨ª®¬ ±«¥¢  ®­ «¥¦ ²¼ ­¥ ¬®¦¥²), ²® ¥±²¼ high[i] < low[i0]. 
¤¥°¥¢¥ T ¢»¯®«­¥­® ±¢®©±²¢® ³¯®°¿¤®·¥­­®±²¨ «¥¢»µ ª®­¶®¢, ¯®½²®¬³ ¨ ¢±¥ ®²°¥§ª¨ ¯° ¢®£® ¯®¤¤¥°¥¢  «¥¦ ² ¶¥«¨ª®¬ ±¯° ¢  ®² i:
¤«¿ ¯°®¨§¢®«¼­®£® ®²°¥§ª  i00 ¨§ ¯° ¢®£® ¯®¤¤¥°¥¢  ¢»¯®«­¥­®
high[i] < low[i0] 6 low[i00 ]:
¯° ¦­¥­¨¿
15.3-1  ¯¨¸¨²¥ ¯°®¶¥¤³°³ Left-Rotate ¤«¿ ¤¥°¥¢  ¯°®¬¥¦³²ª®¢, ª®²®° ¿ ®¡­®¢«¿¥² ¯®«¿ max §  ¢°¥¬¿ O(1).
15.3-2 ¥°¥¯¨¸¨²¥ ¯°®¶¥¤³°³ Interval-Search ¤«¿ ±«³· ¿, ª®£¤  ¢ ¤¥°¥¢¥ ¯°®¬¥¦³²ª®¢ µ° ­¿²±¿ ­¥ ®²°¥§ª¨,   ¨­²¥°¢ «» (²®
¥±²¼ ­ ± ¨­²¥°¥±³¾² ¯¥°¥ª°»²¨¿ ­¥­³«¥¢®© ¤«¨­»).
15.3-3 ®±²°®©²¥  «£®°¨²¬, ª®²®°»© ¯® § ¤ ­­®¬³ ®²°¥§ª³ ¢®§¢° ¹ ¥² ¯¥°¥ª°»¢ ¾¹¨©±¿ ± ­¨¬ ®²°¥§®ª ± ¬¨­¨¬ «¼­»¬ «¥¢»¬
ª®­¶®¬ (¨«¨ ª®­±² ­²³ nil, ¥±«¨ ² ª¨µ ®²°¥§ª®¢ ­¥²).

 ¤ ·¨ ª £« ¢¥ 15

299

15.3-4  ¯¨¸¨²¥ ¯°®£° ¬¬³, ª®²®° ¿ ¯® § ¤ ­­®¬³ ®²°¥§ª³ i ¨ ¤¥°¥¢³ ¯°®¬¥¦³²ª®¢ T ¢®§¢° ¹ ¥² ±¯¨±®ª ¢±¥µ ®²°¥§ª®¢
¤¥°¥¢  T , ¯¥°¥ª°»¢ ¾¹¨µ±¿ ± i. °¥¬¿ ° ¡®²» ¤®«¦­® ¡»²¼
O(min(n; k log n)), £¤¥ k | ·¨±«® ½«¥¬¥­²®¢ ¢®§¢° ¹ ¥¬®£® ±¯¨±ª .
(®¯®«­¨²¥«¼­»© ¢®¯°®±: ª ª ±¤¥« ²¼ ½²®, ­¥ ¬¥­¿¿ ¤¥°¥¢ ?)
15.3-5  ª¨¥ ­ ¤® ¢­¥±²¨ ¨§¬¥­¥­¨¿ ¢ ®¯°¥¤¥«¥­¨¥ ¤¥°¥¢ 
¯°®¬¥¦³²ª®¢, ·²®¡» ¤®¯®«­¨²¥«¼­® °¥ «¨§®¢ ²¼ ¯°®¶¥¤³°³
Interval-Search-Exactly(T; i), ª®²®° ¿ «¨¡® ¢®§¢° ¹ ¥² ¢¥°¸¨­³ x ¤¥°¥¢  T , ¤«¿ ª®²®°®© low[int[x]] = low[i] ¨ high[int[x]] = high[i],
«¨¡® ¢»¤ ¥² ª®­±² ­²³ nil, ¥±«¨ ² ª¨µ ¢¥°¸¨­ ­¥² (¨¹¥² ®²°¥§®ª,
° ¢­»© i,   ­¥ ¯°®±²® ¯¥°¥ª°»¢ ¾¹¨©±¿ ± i.) °¥¬¿ ° ¡®²» ¯°®¶¥¤³°» Interval-Search-Exactly,   ² ª¦¥ ¢±¥µ ¯°¥¦­¨µ ¯°®¶¥¤³°
¯°®¬¥¦³²ª®¢ ¤®«¦­® ®±² ¢ ²¼±¿ ° ¢­»¬ O(log n).
15.3-6

 ±±¬®²°¨¬ ¬­®¦¥±²¢® Q ­ ²³° «¼­»µ ·¨±¥«. ¯°¥¤¥«¨¬

Min-Gap ª ª ° ±±²®¿­¨¥ ¬¥¦¤³ ¤¢³¬¿ ¡«¨¦ ©¸¨¬¨ ·¨±« ¬¨ ¢ Q.
 ¯°¨¬¥°, ¥±«¨ Q = f1; 5; 9; 15; 18; 22g, ²® Min-Gap(Q) ° ¢­® 18 ;

15 = 3. ¥ «¨§³©²¥ ±²°³ª²³°³ ¤ ­­»µ, ½´´¥ª²¨¢­® °¥ «¨§³¾¹³¾
¤®¡ ¢«¥­¨¥, ³¤ «¥­¨¥ ¨ ¯®¨±ª ½«¥¬¥­² ,   ² ª¦¥ ®¯¥° ¶¨¾ MinGap.  ª®¢® ¢°¥¬¿ ° ¡®²» ½²¨µ ®¯¥° ¶¨©?
15.3-7? °¨ ° §° ¡®²ª¥ ¨­²¥£° «¼­»µ ±µ¥¬ ¨­´®°¬ ¶¨¿ · ±²®
¯°¥¤±² ¢«¿¥²±¿ ¢ ¢¨¤¥ ±¯¨±ª  ¯°¿¬®³£®«¼­¨ª®¢. ³±²¼ ¤ ­» n ¯°¿¬®³£®«¼­¨ª®¢ ±® ±²®°®­ ¬¨, ¯ ° ««¥«¼­»¬¨ ®±¿¬ ª®®°¤¨­ ².  ¦¤»© ¯°¿¬®³£®«¼­¨ª § ¤ ¥²±¿ ·¥²»°¼¬¿ ·¨±« ¬¨: ª®®°¤¨­ ² ¬¨
«¥¢®£® ­¨¦­¥£® ¨ ¯° ¢®£® ¢¥°µ­¥£® ³£«®¢.  ¯¨± ²¼ ¯°®£° ¬¬³,
ª®²®° ¿ §  ¢°¥¬¿ O(n log n) ¢»¿±­¿¥², ¥±²¼ «¨ ±°¥¤¨ ½²¨µ ¯°¿¬®³£®«¼­¨ª®¢ ¤¢  ¯¥°¥ª°»¢ ¾¹¨µ±¿ (­® ­¥ ²°¥¡³¥²±¿ ­ ©²¨ ¢±¥ ¯¥°¥ª°»¢ ¾¹¨¥±¿ ¯°¿¬®³£®«¼­¨ª¨). ¡° ²¨²¥ ¢­¨¬ ­¨¥, ·²® £° ­¨¶»
¯¥°¥ª°»¢ ¾¹¨µ±¿ ¯°¿¬®³£®«¼­¨ª®¢ ¬®£³² ­¥ ¯¥°¥±¥ª ²¼±¿, ¥±«¨
®¤¨­ «¥¦¨² ¢­³²°¨ ¤°³£®£®. (ª § ­¨¥. ¢¨£ ¥¬ £®°¨§®­² «¼­³¾
¯°¿¬³¾ ±­¨§³ ¢¢¥°µ ¨ ±¬®²°¨¬, ª ª ¬¥­¿¥²±¿ ¥¥ ¯¥°¥±¥·¥­¨¥ ± ¯°¿¬®³£®«¼­¨ª ¬¨.)

 ¤ ·¨
15-1 ®·ª  ¬ ª±¨¬ «¼­®© ª° ²­®±²¨
» µ®²¨¬ ±«¥¤¨²¼ §  ²®·ª®© ¬ ª±¨¬ «¼­®© ª° ²­®±²¨ (point of
maximum overlap) ¬­®¦¥±²¢  ¯°®¬¥¦³²ª®¢ | ²®·ª®©, ª®²®° ¿ ¯°¨­ ¤«¥¦¨² ¬ ª±¨¬ «¼­®¬³ ·¨±«³ ¯°®¬¥¦³²ª®¢ ¨§ ½²®£® ¬­®¦¥±²¢ .
 ª ­ ¬ ®¡­®¢«¿²¼ ¨­´®°¬ ¶¨¾ ®¡ ½²®© ²®·ª¥ ¯°¨ ¤®¡ ¢«¥­¨¨ ¨
³¤ «¥­¨¨ ½«¥¬¥­² ?

300

« ¢  15 ®¯®«­¥­¨¥ ±²°³ª²³° ¤ ­­»µ

15-2 ¥²±ª ¿ ±·¨² «ª 
 ¤ ·  ® ¤¥²±ª®© ±·¨² «ª¥ (Josephus problem) ±®±²®¨² ¢ ±«¥¤³¾¹¥¬. ¨ª±¨°³¥¬ ¤¢  ·¨±«  m ¨ n (m 6 n). ­ · «¥ n ¤¥²¥© ±²®¿² ¯®
_
ª°³£³.  · ¢ ± ª®£®-²®, ¬» ±·¨² ¥¬ À¯¥°¢»©, ¢²®°®©, ²°¥²¨©...Á ª
²®«¼ª® ¤®µ®¤¨¬ ¤® m-£®, ®­ ¢»µ®¤¨² ¨§ ª°³£ , ¨ ±·¥² ¯°®¤®«¦ ¥²±¿
¤ «¼¸¥ ¯® ª°³£³ ³¦¥ ¡¥§ ­¥£® (­ ·¨­ ¿ ± ¥¤¨­¨¶»).  ª ¯°®¤®«¦ ¥²±¿, ¯®ª  ­¥ ®±² ­¥²±¿ °®¢­® ®¤¨­ ·¥«®¢¥ª.  ± ¡³¤¥² ¨­²¥°¥±®¢ ²¼ § ¢¨±¿¹ ¿ ®² n ¨ m ¯®±«¥¤®¢ ²¥«¼­®±²¼ ((n; m)-Josephus permutation), ¢ ª®²®°®© ¤¥²¨ ¢»µ®¤¿² ¨§ ª°³£ .  ¯°¨¬¥°, ¯°¨ n = 7 ¨
m = 3 ¨±ª®¬ ¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¢»£«¿¤¨² ² ª: h3; 6; 2; 7; 5; 1; 4i.
 .  ´¨ª±¨°³¥¬ m.  ¯¨¸¨²¥ ¯°®£° ¬¬³, ª®²®° ¿ ¯® ¤ ­­®¬³ n
¤ ¥² ½²³ ¯®±«¥¤®¢ ²¥«¼­®±²¼ §  ¢°¥¬¿ O(n).
¡.  ¯¨¸¨²¥ ¯°®£° ¬¬³, ª®²®° ¿ ¯® ¯°®¨§¢®«¼­»¬ n ¨ m ¤ ¥²
¨±ª®¬³¾ ¯®±«¥¤®¢ ²¥«¼­®±²¼ §  ¢°¥¬¿ O(n log n).

 ¬¥· ­¨¿
¯¨± ­¨¿ ­¥ª®²®°»µ ¢¨¤®¢ ¤¥°¥¢¼¥¢ ¯°®¬¥¦³²ª®¢ ¬®¦­® ­ ©²¨ ¢ °¥¯ ° ²  ¨  ¬®± [160].  ¨¡®«¼¸¨© ²¥®°¥²¨·¥±ª¨©
¨­²¥°¥± ¯°¥¤±² ¢«¿¥² §¤¥±¼ °¥§³«¼² ², ª ª®²®°®¬³ ­¥§ ¢¨±¨¬® ¯°¨¸«¨ ¤¥«¼±¡°³­­¥° (H. Edelsbrunner, 1980) ¨  ª°¥©²
(E. M. McCreight, 1981).  §° ¡®² ­­ ¿ ¨¬¨ ±²°³ª²³°  ¤ ­­»µ
µ° ­¨² n ®²°¥§ª®¢ ¨ ¯®§¢®«¿¥² ¯¥°¥·¨±«¨²¼ ²¥ ¨§ ­¨µ, ª®²®°»¥
¯¥°¥ª°»¢ ¾²±¿ ± § ¤ ­­»¬ ®²°¥§ª®¬, §  ¢°¥¬¿ O(k + log n), £¤¥ k
| ª®«¨·¥±²¢® ² ª¨µ ®²°¥§ª®¢.

IV

¥²®¤» ¯®±²°®¥­¨¿ ¨  ­ «¨§   «£®°¨²¬®¢

¢¥¤¥­¨¥
²  · ±²¼ ¯®±¢¿¹¥­  ²°¥¬ ¢ ¦­»¬ ¬¥²®¤ ¬ ¯®±²°®¥­¨¿ ¨  ­ «¨§  ½´´¥ª²¨¢­»µ  «£®°¨²¬®¢: ¤¨­ ¬¨·¥±ª®¬³ ¯°®£° ¬¬¨°®¢ ­¨¾
(£« ¢  16), ¦ ¤­»¬  «£®°¨²¬ ¬ (£« ¢  17) ¨  ¬®°²¨§ ¶¨®­­®¬³
 ­ «¨§³ (£« ¢  18). ²¨ ¬¥²®¤», ¢®§¬®¦­®, ·³²¼ ±«®¦­¥¥ ° §®¡° ­­»µ ° ­¥¥ (À° §¤¥«¿© ¨ ¢« ±²¢³©Á, ¨±¯®«¼§®¢ ­¨¥ ±«³· ©­»µ ·¨±¥«,
°¥¸¥­¨¥ °¥ª³°°¥­²­»µ ±®®²­®¸¥­¨©), ­® ­¥ ¬¥­¥¥ ¢ ¦­».
¨­ ¬¨·¥±ª®¥ ¯°®£° ¬¬¨°®¢ ­¨¥ ®¡»·­® ¯°¨¬¥­¿¥²±¿ ª § ¤ · ¬, ¢ ª®²®°»µ ¨±ª®¬»© ®²¢¥² ±®±²®¨² ¨§ · ±²¥©, ª ¦¤ ¿ ¨§ ª®²®°»µ ¢ ±¢®¾ ®·¥°¥¤¼ ¤ ¥² ®¯²¨¬ «¼­®¥ °¥¸¥­¨¥ ­¥ª®²®°®© ¯®¤§ ¤ ·¨. ¨­ ¬¨·¥±ª®¥ ¯°®£° ¬¬¨°®¢ ­¨¥ ¯®«¥§­®, ¥±«¨ ­  ° §­»µ
¯³²¿µ ¬­®£®ª° ²­® ¢±²°¥· ¾²±¿ ®¤­¨ ¨ ²¥ ¦¥ ¯®¤§ ¤ ·¨; ®±­®¢­®©
²¥µ­¨·¥±ª¨© ¯°¨¥¬ | § ¯®¬¨­ ²¼ °¥¸¥­¨¿ ¢±²°¥· ¾¹¨µ±¿ ¯®¤§ ¤ · ­  ±«³· ©, ¥±«¨ ²  ¦¥ ¯®¤§ ¤ ·  ¢±²°¥²¨²±¿ ¢­®¢¼.
 ¤­»¥  «£®°¨²¬», ª ª ¨ ¤¨­ ¬¨·¥±ª®¥ ¯°®£° ¬¬¨°®¢ ­¨¥,
¯°¨¬¥­¿¾²±¿ ¢ ²¥µ ±«³· ¿µ, ª®£¤  ¨±ª®¬»© ®¡º¥ª² ±²°®¨²±¿ ¯®
· ±²¿¬.  ¤­»©  «£®°¨²¬ ¤¥« ¥² ­  ª ¦¤®¬ ¸ £¥ À«®ª «¼­® ®¯²¨¬ «¼­»©Á ¢»¡®°. °®±²®© ¯°¨¬¥°: ±² ° ¿±¼ ­ ¡° ²¼ ¤ ­­³¾ ±³¬¬³
¤¥­¥£ ¬¨­¨¬ «¼­»¬ ·¨±«®¬ ¬®­¥², ¬®¦­® ¯®±«¥¤®¢ ²¥«¼­® ¡° ²¼
¬®­¥²» ­ ¨¡®«¼¸¥£® ¢®§¬®¦­®£® ¤®±²®¨­±²¢  (­¥ ¯°¥¢®±µ®¤¿¹¥£®
²®© ±³¬¬», ª®²®°³¾ ®±² «®±¼ ­ ¡° ²¼).
 ¤­»©  «£®°¨²¬ ®¡»·­® ° ¡®² ¥² £®° §¤® ¡»±²°¥¥, ·¥¬  «£®°¨²¬, ®±­®¢ ­­»© ­  ¤¨­ ¬¨·¥±ª®¬ ¯°®£° ¬¬¨°®¢ ­¨¨. ¤­ ª®
¦ ¤­»©  «£®°¨²¬ ¢®¢±¥ ­¥ ¢±¥£¤  ¤ ¥² ®¯²¨¬ «¼­®¥ °¥¸¥­¨¥. ®
¬­®£¨µ § ¤ · µ ¯°¨¬¥­¨¬®±²¼ ¦ ¤­»µ  «£®°¨²¬®¢ ³¤ ¥²±¿ ¤®ª § ²¼ ± ¯®¬®¹¼¾ ² ª ­ §»¢ ¥¬»µ ¬ ²°®¨¤®¢, ® ª®²®°»µ ° ±±ª § ­®
¢ £« ¢¥ 17.
¬®°²¨§ ¶¨®­­»©  ­ «¨§ | ½²® ±°¥¤±²¢®  ­ «¨§   «£®°¨²¬®¢,
¯°®¨§¢®¤¿¹¨µ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ®¤­®²¨¯­»µ ®¯¥° ¶¨©. ¬¥±²®
²®£®, ·²®¡» ®¶¥­¨¢ ²¼ ¢°¥¬¿ ° ¡®²» ¤«¿ ª ¦¤®© ¨§ ½²¨µ ®¯¥° ¶¨© ¯® ®²¤¥«¼­®±²¨,  ¬®°²¨§ ¶¨®­­»©  ­ «¨§ ®¶¥­¨¢ ¥² ±°¥¤­¥¥

304

 ±²¼ IV ¥²®¤» ¯®±²°®¥­¨¿ ¨  ­ «¨§   «£®°¨²¬®¢

¢°¥¬¿ ° ¡®²» ¢ ° ±·¥²¥ ­  ®¤­³ ®¯¥° ¶¨¾.  §­¨¶  ¬®¦¥² ®ª § ²¼±¿ ±³¹¥±²¢¥­­®©, ¥±«¨ ¤®«£® ¢»¯®«­¿¥¬»¥ ®¯¥° ¶¨¨ ­¥ ¬®£³²
¨¤²¨ ¯®¤°¿¤.   ± ¬®¬ ¤¥«¥  ¬®°²¨§ ¶¨®­­»©  ­ «¨§ | ­¥ ²®«¼ª®
±°¥¤±²¢®  ­ «¨§   «£®°¨²¬®¢, ­® ¥¹¥ ¨ ¯®¤µ®¤ ª ° §° ¡®²ª¥  «£®°¨²¬®¢: ¢¥¤¼ ° §° ¡®²ª   «£®°¨²¬  ¨  ­ «¨§ ±ª®°®±²¨ ¥£® ° ¡®²»
²¥±­® ±¢¿§ ­».  £« ¢¥ 18 ¬» ° ±±ª §»¢ ¥¬ ® ²°¥µ ¬¥²®¤ µ  ¬®°²¨§ ¶¨®­­®£®  ­ «¨§   «£®°¨²¬®¢.

16

¨­ ¬¨·¥±ª®¥ ¯°®£° ¬¬¨°®¢ ­¨¥

®¤®¡­® ¬¥²®¤³ À° §¤¥«¿© ¨ ¢« ±²¢³©Á, ¤¨­ ¬¨·¥±ª®¥ ¯°®£° ¬¬¨°®¢ ­¨¥ °¥¸ ¥² § ¤ ·³, ° §¡¨¢ ¿ ¥¥ ­  ¯®¤§ ¤ ·¨ ¨ ®¡º¥¤¨­¿¿ ¨µ
°¥¸¥­¨¿.  ª ¬» ¢¨¤¥«¨ ¢ £« ¢¥ 1,  «£®°¨²¬» ²¨¯  À° §¤¥«¿© ¨
¢« ±²¢³©Á ¤¥«¿² § ¤ ·³ ­  ­¥§ ¢¨±¨¬»¥ ¯®¤§ ¤ ·¨, ½²¨ ¯®¤§ ¤ ·¨ | ­  ¡®«¥¥ ¬¥«ª¨¥ ¯®¤§ ¤ ·¨ ¨ ² ª ¤ «¥¥,   § ²¥¬ ±®¡¨° ¾² °¥¸¥­¨¥ ®±­®¢­®© § ¤ ·¨ À±­¨§³ ¢¢¥°µÁ. ¨­ ¬¨·¥±ª®¥ ¯°®£° ¬¬¨°®¢ ­¨¥ ¯°¨¬¥­¨¬® ²®£¤ , ª®£¤  ¯®¤§ ¤ ·¨ ­¥ ¿¢«¿¾²±¿ ­¥§ ¢¨±¨¬»¬¨, ¨­»¬¨ ±«®¢ ¬¨, ª®£¤  ³ ¯®¤§ ¤ · ¥±²¼ ®¡¹¨¥ À¯®¤¯®¤§ ¤ ·¨Á.
 ½²®¬ ±«³· ¥  «£®°¨²¬ ²¨¯  À° §¤¥«¿© ¨ ¢« ±²¢³©Á ¡³¤¥² ¤¥« ²¼
«¨¸­¾¾ ° ¡®²³, °¥¸ ¿ ®¤­¨ ¨ ²¥ ¦¥ ¯®¤¯®¤§ ¤ ·¨ ¯® ­¥±ª®«¼ª³
° §. «£®°¨²¬, ®±­®¢ ­­»© ­  ¤¨­ ¬¨·¥±ª®¬ ¯°®£° ¬¬¨°®¢ ­¨¨,
°¥¸ ¥² ª ¦¤³¾ ¨§ ¯®¤§ ¤ · ¥¤¨­®¦¤» ¨ § ¯®¬¨­ ¥² ®²¢¥²» ¢ ±¯¥¶¨ «¼­®© ² ¡«¨¶¥. ²® ¯®§¢®«¿¥² ­¥ ¢»·¨±«¿²¼ § ­®¢® ®²¢¥² ª ³¦¥
¢±²°¥· ¢¸¥©±¿ ¯®¤§ ¤ ·¥.
 ²¨¯¨·­®¬ ±«³· ¥ ¤¨­ ¬¨·¥±ª®¥ ¯°®£° ¬¬¨°®¢ ­¨¥ ¯°¨¬¥­¿¥²±¿ ª § ¤ · ¬ ®¯²¨¬¨§ ¶¨¨ (optimization problems).  ² ª®© § ¤ ·¨
¬®¦¥² ¡»²¼ ¬­®£® ¢®§¬®¦­»µ °¥¸¥­¨©; ¨µ Àª ·¥±²¢®Á ®¯°¥¤¥«¿¥²±¿ §­ ·¥­¨¥¬ ª ª®£®-²® ¯ ° ¬¥²° , ¨ ²°¥¡³¥²±¿ ¢»¡° ²¼ ®¯²¨¬ «¼­®¥ °¥¸¥­¨¥, ¯°¨ ª®²®°®¬ §­ ·¥­¨¥ ¯ ° ¬¥²°  ¡³¤¥² ¬¨­¨¬ «¼­»¬
¨«¨ ¬ ª±¨¬ «¼­»¬ (¢ § ¢¨±¨¬®±²¨ ®² ¯®±² ­®¢ª¨ § ¤ ·¨). ®®¡¹¥
£®¢®°¿, ®¯²¨¬³¬ ¬®¦¥² ¤®±²¨£ ²¼±¿ ¤«¿ ­¥±ª®«¼ª¨µ ° §­»µ °¥¸¥­¨©.
 ª ±²°®¨²±¿  «£®°¨²¬, ®±­®¢ ­­»© ­  ¤¨­ ¬¨·¥±ª®¬ ¯°®£° ¬¬¨°®¢ ­¨¨?  ¤®:
1. ®¯¨± ²¼ ±²°³ª²³°³ ®¯²¨¬ «¼­»µ °¥¸¥­¨©,
2. ¢»¯¨± ²¼ °¥ª³°°¥­²­®¥ ±®®²­®¸¥­¨¥, ±¢¿§»¢ ¾¹¥¥ ®¯²¨¬ «¼­»¥ §­ ·¥­¨¿ ¯ ° ¬¥²°  ¤«¿ ¯®¤§ ¤ ·,
3. ¤¢¨£ ¿±¼ ±­¨§³ ¢¢¥°µ, ¢»·¨±«¨²¼ ®¯²¨¬ «¼­®¥ §­ ·¥­¨¥ ¯ ° ¬¥²° ,
4. ¯®«¼§³¿±¼ ¯®«³·¥­­®© ¨­´®°¬ ¶¨¥©, ¯®±²°®¨²¼ ®¯²¨¬ «¼­®¥
°¥¸¥­¨¥.
±­®¢­³¾ · ±²¼ ° ¡®²» ±®±² ¢«¿¾² ¸ £¨ 1{3. ±«¨ ­ ± ¨­²¥°¥±³¥²
²®«¼ª® ®¯²¨¬ «¼­®¥ §­ ·¥­¨¥ ¯ ° ¬¥²° , ¸ £ 4 ­¥ ­³¦¥­. ±«¨ ¦¥
¸ £ 4 ­¥®¡µ®¤¨¬, ¤«¿ ¯®±²°®¥­¨¿ ®¯²¨¬ «¼­®£® °¥¸¥­¨¿ ¨­®£¤ 

306

« ¢  16 ¨­ ¬¨·¥±ª®¥ ¯°®£° ¬¬¨°®¢ ­¨¥

¯°¨µ®¤¨²±¿ ¯®«³· ²¼ ¨ µ° ­¨²¼ ¤®¯®«­¨²¥«¼­³¾ ¨­´®°¬ ¶¨¾ ¢
¯°®¶¥±±¥ ¢»¯®«­¥­¨¿ ¸ £  3.
 ½²®© £« ¢¥ ¬» °¥¸¨¬ ­¥±ª®«¼ª® ®¯²¨¬¨§ ¶¨®­­»µ § ¤ · ± ¯®¬®¹¼¾ ¤¨­ ¬¨·¥±ª®£® ¯°®£° ¬¬¨°®¢ ­¨¿.  ° §¤¥«¥ 16.1 ¬» ¢»¿±­¨¬, ª ª ­ ©²¨ ¯°®¨§¢¥¤¥­¨¥ ­¥±ª®«¼ª¨µ ¬ ²°¨¶, ±¤¥« ¢ ª ª ¬®¦­®
¬¥­¼¸¥ ³¬­®¦¥­¨©.  ° §¤¥«¥ 16.2 ¬» ®¡±³¤¨¬, ª ª¨¥ ±¢®©±²¢  § ¤ ·¨ ¤¥« ¾² ¢®§¬®¦­»¬ ¯°¨¬¥­¥­¨¥ ¤¨­ ¬¨·¥±ª®£® ¯°®£° ¬¬¨°®¢ ­¨¿. ®±«¥ ½²®£® ¬» ° ±±ª ¦¥¬ (¢ ° §¤¥«¥ 16.3), ª ª ­ ©²¨
­ ¨¡®«¼¸³¾ ®¡¹³¾ ¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¼ ¤¢³µ ¯®±«¥¤®¢ ²¥«¼­®±²¥©.  ª®­¥¶, ¢ ° §¤¥«¥ 16.4 ¬» ¢®±¯®«¼§³¥¬±¿ ¤¨­ ¬¨·¥±ª¨¬ ¯°®£° ¬¬¨°®¢ ­¨¥¬ ¤«¿ ­ µ®¦¤¥­¨¿ ®¯²¨¬ «¼­®© ²°¨ ­£³«¿¶¨¨ ¢»¯³ª«®£® ¬­®£®³£®«¼­¨ª . (¤¨¢¨²¥«¼­»¬ ®¡° §®¬ ½²  § ¤ ·  ®ª §»¢ ¥²±¿ ¯®µ®¦¥© ­  § ¤ ·³ ® ¯¥°¥¬­®¦¥­¨¨ ­¥±ª®«¼ª¨µ ¬ ²°¨¶.)

16.1. ¥°¥¬­®¦¥­¨¥ ­¥±ª®«¼ª¨µ ¬ ²°¨¶
» µ®²¨¬ ­ ©²¨ ¯°®¨§¢¥¤¥­¨¥

A1A2 : : :An
(16.1)
¯®±«¥¤®¢ ²¥«¼­®±²¨ n ¬ ²°¨¶ hA1; A2; : : :; An i. » ¡³¤¥¬ ¯®«¼§®-

¢ ²¼±¿ ±² ­¤ °²­»¬  «£®°¨²¬®¬ ¯¥°¥¬­®¦¥­¨¿ ¤¢³µ ¬ ²°¨¶ ¢ ª ·¥±²¢¥ ¯®¤¯°®£° ¬¬». ® ¯°¥¦¤¥ ­ ¤® ° ±±² ¢¨²¼ ±ª®¡ª¨ ¢ (16.1),
·²®¡» ³ª § ²¼ ¯®°¿¤®ª ³¬­®¦¥­¨©. ³¤¥¬ £®¢®°¨²¼, ·²® ¢ ¯°®¨§¢¥¤¥­¨¨ ¬ ²°¨¶ ¯®«­®±²¼¾ ° ±±² ¢«¥­» ±ª®¡ª¨ (product is fully parenthesized), ¥±«¨ ½²® ¯°®¨§¢¥¤¥­¨¥ «¨¡® ±®±²®¨² ¨§ ®¤­®©¥¤¨­±²¢¥­­®© ¬ ²°¨¶», «¨¡® ¿¢«¿¥²±¿ § ª«¾·¥­­»¬ ¢ ±ª®¡ª¨ ¯°®¨§¢¥¤¥­¨¥¬ ¤¢³µ ¯°®¨§¢¥¤¥­¨© ± ¯®«­®±²¼¾ ° ±±² ¢«¥­­»¬¨ ±ª®¡ª ¬¨. ®±ª®«¼ª³ ³¬­®¦¥­¨¥ ¬ ²°¨¶  ±±®¶¨ ²¨¢­®, ª®­¥·­»© °¥§³«¼² ² ¢»·¨±«¥­¨© ­¥ § ¢¨±¨² ®² ° ±±² ­®¢ª¨ ±ª®¡®ª.  ¯°¨¬¥°,
¢ ¯°®¨§¢¥¤¥­¨¨ A1 A2 A3A4 ¬®¦­® ¯®«­®±²¼¾ ° ±±² ¢¨²¼ ±ª®¡ª¨ ¯¿²¼¾ ° §­»¬¨ ±¯®±®¡ ¬¨:
(A1(A2 (A3A4 ))); (A1((A2A3 )A4 )); ((A1A2 )(A3A4 ));
((A1(A2 A3 ))A4); (((A1A2 )A3)A4 );
¢® ¢±¥µ ±«³· ¿µ ®²¢¥² ¡³¤¥² ®¤¨­ ¨ ²®² ¦¥.
¥ ¢«¨¿¿ ­  ®²¢¥², ±¯®±®¡ ° ±±² ­®¢ª¨ ±ª®¡®ª ¬®¦¥² ±¨«¼­® ¯®¢«¨¿²¼ ­  ±²®¨¬®±²¼ ¯¥°¥¬­®¦¥­¨¿ ¬ ²°¨¶. ®±¬®²°¨¬ ±­ · « ,
±ª®«¼ª® ®¯¥° ¶¨© ²°¥¡³¥² ¯¥°¥¬­®¦¥­¨¥ ¤¢³µ ¬ ²°¨¶. ®² ±² ­¤ °²­»©  «£®°¨²¬ (rows ¨ columns ®¡®§­ · ¾² ª®«¨·¥±²¢® ±²°®ª
¨ ±²®«¡¶®¢ ¬ ²°¨¶» ±®®²¢¥²±²¢¥­­®):

¥°¥¬­®¦¥­¨¥ ­¥±ª®«¼ª¨µ ¬ ²°¨¶

307

Matrix-Multiply(A; B )

1 if columns[A] 6= rows[B ]
2 then error À³¬­®¦¨²¼ ­¥«¼§¿Á
3 else for i 1 to rows[A]
4
do for j 1 to columns[B ]
5
do C [i; j ] 0
6
for k 1 to columns[A]
7
do C [i; j ] C [i; j ] + A[i; k]  B [k; j ]
8
return C
 ²°¨¶» A ¨ B ¬®¦­® ¯¥°¥¬­®¦ ²¼, ²®«¼ª® ¥±«¨ ·¨±«® ±²®«¡¶®¢
³ A ° ¢­® ·¨±«³ ±²°®ª ³ B . ±«¨ A | ½²® p  q -¬ ²°¨¶ ,   B | ½²®
q  r-¬ ²°¨¶ , ²® ¨µ ¯°®¨§¢¥¤¥­¨¥ C ¿¢«¿¥²±¿ p  r-¬ ²°¨¶¥©. °¨
¢»¯®«­¥­¨¨ ½²®£®  «£®°¨²¬  ¤¥« ¥²±¿ pqr ³¬­®¦¥­¨© (±²°®ª  7)
¨ ¯°¨¬¥°­® ±²®«¼ª® ¦¥ ±«®¦¥­¨©. «¿ ¯°®±²®²» ¬» ¡³¤¥¬ ³·¨²»¢ ²¼ ²®«¼ª® ³¬­®¦¥­¨¿. [ £« ¢¥ 31 ¯°¨¢¥¤¥­  «£®°¨²¬ ²° ±±¥­ ,
²°¥¡³¾¹¨© ¬¥­¼¸¥£® ·¨±«  ³¬­®¦¥­¨©.  ½²®© £« ¢¥ ¬» ¯°¨­¨¬ ¥¬ ª ª ¤ ­­®±²¼ ¯°®±²¥©¸¨© ±¯®±®¡ ³¬­®¦¥­¨¿ ¬ ²°¨¶ ¨ ¨¹¥¬
®¯²¨¬³¬ §  ±·¥² ° ±±² ­®¢ª¨ ±ª®¡®ª.]
²®¡» ³¢¨¤¥²¼, ª ª ° ±±² ­®¢ª  ±ª®¡®ª ¬®¦¥² ¢«¨¿²¼ ­  ±²®¨¬®±²¼, ° ±±¬®²°¨¬ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¨§ ²°¥µ ¬ ²°¨¶ hA1; A2; A3i
° §¬¥°®¢ 10  100, 100  5 ¨ 5  50 ±®®²¢¥²±²¢¥­­®. °¨ ¢»·¨±«¥­¨¨ ((A1A2 )A3) ­³¦­® 10  100  5 = 5000 ³¬­®¦¥­¨©, ·²®¡» ­ ©²¨ 10  5-¬ ²°¨¶³ A1 A2 ,   § ²¥¬ 10  5  50 = 2500 ³¬­®¦¥­¨©,
·²®¡» ³¬­®¦¨²¼ ½²³ ¬ ²°¨¶³ ­  A3 . ±¥£® 7500 ³¬­®¦¥­¨©. °¨
° ±±² ­®¢ª¥ ±ª®¡®ª (A1(A2 A3 )) ¬» ¤¥« ¥¬ 100  5  50 = 25 000
³¬­®¦¥­¨© ¤«¿ ­ µ®¦¤¥­¨¿ 100  50-¬ ²°¨¶» A2 A3 , ¯«¾± ¥¹¥
10  100  50 = 50 000 ³¬­®¦¥­¨© (³¬­®¦¥­¨¥ A1 ­  A2A3 ), ¨²®£®
75 000 ³¬­®¦¥­¨©. ¥¬ ± ¬»¬, ¯¥°¢»© ±¯®±®¡ ° ±±² ­®¢ª¨ ±ª®¡®ª
¢ 10 ° § ¢»£®¤­¥¥.
 ¤ ·  ®¡ ³¬­®¦¥­¨¨ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¬ ²°¨¶ (matrix-chain
multiplication problem) ¬®¦¥² ¡»²¼ ±´®°¬³«¨°®¢ ­  ±«¥¤³¾¹¨¬
®¡° §®¬: ¤ ­  ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¨§ n ¬ ²°¨¶ hA1; A2 ; : : :; An i
§ ¤ ­­»µ ° §¬¥°®¢ (¬ ²°¨¶  Ai ¨¬¥¥² ° §¬¥° pi;1  pi ); ²°¥¡³¥²±¿ ­ ©²¨ ² ª³¾ (¯®«­³¾) ° ±±² ­®¢ª³ ±ª®¡®ª ¢ ¯°®¨§¢¥¤¥­¨¨
A1A2 : : :An , ·²®¡» ¢»·¨±«¥­¨¥ ¯°®¨§¢¥¤¥­¨¿ ²°¥¡®¢ «® ­ ¨¬¥­¼¸¥£® ·¨±«  ³¬­®¦¥­¨©.
®«¨·¥±²¢® ° ±±² ­®¢®ª ±ª®¡®ª
°¥¦¤¥ ·¥¬ ¯°¨¬¥­¿²¼ ¤¨­ ¬¨·¥±ª®¥ ¯°®£° ¬¬¨°®¢ ­¨¥ ª § ¤ ·¥ ®¡ ³¬­®¦¥­¨¨ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¬ ²°¨¶, ±²®¨² ³¡¥¤¨²¼±¿,
·²® ¯°®±²®© ¯¥°¥¡®° ¢±¥µ ¢®§¬®¦­»µ ° ±±² ­®¢®ª ±ª®¡®ª ­¥ ¤ ±²
½´´¥ª²¨¢­®£®  «£®°¨²¬ . ¡®§­ ·¨¬ ±¨¬¢®«®¬ P (n) ª®«¨·¥±²¢®
¯®«­»µ ° ±±² ­®¢®ª ±ª®¡®ª ¢ ¯°®¨§¢¥¤¥­¨¨ n ¬ ²°¨¶. ®±«¥¤­¥¥

308

« ¢  16 ¨­ ¬¨·¥±ª®¥ ¯°®£° ¬¬¨°®¢ ­¨¥

³¬­®¦¥­¨¥ ¬®¦¥² ¯°®¨±µ®¤¨²¼ ­  £° ­¨¶¥ ¬¥¦¤³ k-© ¨ (k + 1)-©
¬ ²°¨¶ ¬¨. ® ½²®£® ¬» ®²¤¥«¼­® ¢»·¨±«¿¥¬ ¯°®¨§¢¥¤¥­¨¥ ¯¥°¢»µ k ¨ ®±² «¼­»µ n ; k ¬ ²°¨¶. ®½²®¬³
8
<

P (n) = :

1;

nP
;1
k=1

¥±«¨ n = 1,
P (k)P (n ; k); ¥±«¨ n > 2.

 § ¤ ·¥ 13-4 ¬» ¯°®±¨«¨ ¢ ± ¤®ª § ²¼, ·²® ½²® ±®®²­®¸¥­¨¥ § ¤ ¥² ¯®±«¥¤®¢ ²¥«¼­®±²¼ ·¨±¥«  ² « ­ 

P (n) = C (n ; 1);
£¤¥

C (n) = n +1 1 C2nn = 
(4n=n3=2):

² «® ¡»²¼, ·¨±«® °¥¸¥­¨© ½ª±¯®­¥­¶¨ «¼­® § ¢¨±¨² ®² n, ² ª ·²®
¯®«­»© ¯¥°¥¡®° ­¥½´´¥ª²¨¢¥­. [°³£®© ±¯®±®¡ ¯®­¿²¼, ·²® ·¨±«®
¢ °¨ ­²®¢ ½ª±¯®­¥­¶¨ «¼­®: ° §®¡¼¥¬ ¬ ²°¨¶» ­  £°³¯¯» ¯® ²°¨;
¯°®¨§¢¥¤¥­¨¥ ¤«¿ ª ¦¤®© £°³¯¯» ¬®¦­® ¢»·¨±«¨²¼ ¤¢³¬¿ ±¯®±®¡ ¬¨, ² ª ·²® ¤«¿ 3n ¬ ²°¨¶ ¥±²¼ ­¥ ¬¥­¥¥ 2n ¢ °¨ ­²®¢.]
 £ 1: ±²°®¥­¨¥ ®¯²¨¬ «¼­®© ° ±±² ­®¢ª¨ ±ª®¡®ª
±«¨ ¬» ±®¡¨° ¥¬±¿ ¢®±¯®«¼§®¢ ²¼±¿ ¤¨­ ¬¨·¥±ª¨¬ ¯°®£° ¬¬¨°®¢ ­¨¥¬, ²® ¤«¿ ­ · «  ¤®«¦­» ®¯¨± ²¼ ±²°®¥­¨¥ ®¯²¨¬ «¼­»µ
°¥¸¥­¨©. «¿ § ¤ ·¨ ®¡ ³¬­®¦¥­¨¨ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¬ ²°¨¶
½²® ¢»£«¿¤¨² ±«¥¤³¾¹¨¬ ®¡° §®¬. ¡®§­ ·¨¬ ¤«¿ ³¤®¡±²¢  ·¥°¥§ Ai::j ¬ ²°¨¶³, ¿¢«¿¾¹³¾±¿ ¯°®¨§¢¥¤¥­¨¥¬ Ai Ai+1 : : :Aj . ¯²¨¬ «¼­ ¿ ° ±±² ­®¢ª  ±ª®¡®ª ¢ ¯°®¨§¢¥¤¥­¨¨ A1 A2 : : :An ° §°»¢ ¥²
¯®±«¥¤®¢ ²¥«¼­®±²¼ ¬¥¦¤³ Ak ¨ Ak+1 ¤«¿ ­¥ª®²®°®£® k, ³¤®¢«¥²¢®°¿¾¹¥£® ­¥° ¢¥­±²¢³ 1 6 k < n. ­»¬¨ ±«®¢ ¬¨, ¯°¨ ¢»·¨±«¥­¨¨ ¯°®¨§¢¥¤¥­¨¿, ¤¨ª²³¥¬®¬ ½²®© ° ±±² ­®¢ª®© ±ª®¡®ª, ¬» ±­ · «  ¢»·¨±«¿¥¬ ¯°®¨§¢¥¤¥­¨¿ A1::k ¨ Ak+1::n ,   § ²¥¬ ¯¥°¥¬­®¦ ¥¬
¨µ ¨ ¯®«³· ¥¬ ®ª®­· ²¥«¼­»© ®²¢¥² A1::n . ² «® ¡»²¼, ±²®¨¬®±²¼
½²®© ®¯²¨¬ «¼­®© ° ±±² ­®¢ª¨ ° ¢­  ±²®¨¬®±²¨ ¢»·¨±«¥­¨¿ ¬ ²°¨¶» A1::k , ¯«¾± ±²®¨¬®±²¼ ¢»·¨±«¥­¨¿ ¬ ²°¨¶» Ak+1::n , ¯«¾±
±²®¨¬®±²¼ ¯¥°¥¬­®¦¥­¨¿ ½²¨µ ¤¢³µ ¬ ²°¨¶.
¥¬ ¬¥­¼¸¥ ³¬­®¦¥­¨© ­ ¬ ¯®²°¥¡³¥²±¿ ¤«¿ ¢»·¨±«¥­¨¿ A1::k
¨ Ak+1::n , ²¥¬ ¬¥­¼¸¥ ¡³¤¥² ®¡¹¥¥ ·¨±«® ³¬­®¦¥­¨©. ² «® ¡»²¼,
®¯²¨¬ «¼­®¥ °¥¸¥­¨¥ § ¤ ·¨ ® ¯¥°¥¬­®¦¥­¨¨ ¯®±«¥¤®¢ ²¥«¼­®±²¨
¬ ²°¨¶ ±®¤¥°¦¨² ®¯²¨¬ «¼­»¥ °¥¸¥­¨¿ § ¤ · ® ¯¥°¥¬­®¦¥­¨¨ ¥¥
· ±²¥©.  ª ¬» ³¢¨¤¨¬ ¢ ° §¤¥«¥ 16.2, ½²® ¨ ¯®§¢®«¿¥² ¯°¨¬¥­¨²¼
¤¨­ ¬¨·¥±ª®¥ ¯°®£° ¬¬¨°®¢ ­¨¥.

¥°¥¬­®¦¥­¨¥ ­¥±ª®«¼ª¨µ ¬ ²°¨¶

309

 £ 2: °¥ª³°°¥­²­®¥ ±®®²­®¸¥­¨¥
¥¯¥°¼ ­ ¤® ¢»° §¨²¼ ±²®¨¬®±²¼ ®¯²¨¬ «¼­®£® °¥¸¥­¨¿ § ¤ ·¨
·¥°¥§ ±²®¨¬®±²¨ ®¯²¨¬ «¼­»µ °¥¸¥­¨© ¥¥ ¯®¤§ ¤ ·.  ª¨¬¨ ¯®¤§ ¤ · ¬¨ ¡³¤³² § ¤ ·¨ ®¡ ®¯²¨¬ «¼­®© ° ±±² ­®¢ª¥ ±ª®¡®ª ¢ ¯°®¨§¢¥¤¥­¨¿µ Ai::j = Ai Ai+1 : : :Aj ¤«¿ 1 6 i 6 j 6 n. ¡®§­ ·¨¬ ·¥°¥§
m[i; j ] ¬¨­¨¬ «¼­®¥ ª®«¨·¥±²¢® ³¬­®¦¥­¨©, ­¥®¡µ®¤¨¬®¥ ¤«¿ ¢»·¨±«¥­¨¿ ¬ ²°¨¶» Ai::j ; ¢ · ±²­®±²¨, ±²®¨¬®±²¼ ¢»·¨±«¥­¨¿ ¢±¥£®
¯°®¨§¢¥¤¥­¨¿ A1::n ¥±²¼ m[1; n].
¨±«  m[i; j ] ¬®¦­® ¢»·¨±«¨²¼ ² ª. ±«¨ i = j , ²® ¯®±«¥¤®¢ ²¥«¼­®±²¼ ±®±²®¨² ¨§ ®¤­®© ¬ ²°¨¶» Ai::i = Ai ¨ ³¬­®¦¥­¨¿ ¢®®¡¹¥ ­¥
­³¦­». ² «® ¡»²¼, m[i; i] = 0 ¤«¿ i = 1; 2; : : :; n. ²®¡» ¯®±·¨² ²¼ m[i; j ] ¤«¿ i < j , ¬» ¢®±¯®«¼§³¥¬±¿ ¨­´®°¬ ¶¨¥© ® ±²°®¥­¨¨
®¯²¨¬ «¼­®£® °¥¸¥­¨¿, ¯®«³·¥­­®© ­  ¸ £¥ 1. ³±²¼ ¯°¨ ®¯²¨¬ «¼­®© ° ±±² ­®¢ª¥ ±ª®¡®ª ¢ ¯°®¨§¢¥¤¥­¨¨ Ai Ai+1 : : :Aj ¯®±«¥¤­¨¬ ¨¤¥² ³¬­®¦¥­¨¥ Ai : : :Ak ­  Ak+1 : : :Aj , £¤¥ i 6 k < j . ®£¤ 
m[i; j ] ° ¢­® ±³¬¬¥ ¬¨­¨¬ «¼­»µ ±²®¨¬®±²¥© ¢»·¨±«¥­¨¿ ¯°®¨§¢¥¤¥­¨© Ai::k ¨ Ak+1::j ¯«¾± ±²®¨¬®±²¼ ¯¥°¥¬­®¦¥­¨¿ ½²¨µ ¤¢³µ
¬ ²°¨¶. ®±ª®«¼ª³ ¤«¿ ¢»·¨±«¥­¨¿ ¯°®¨§¢¥¤¥­¨¿ Ai::k Ak+1::j ²°¥¡³¥²±¿ pi;1 pk pj ³¬­®¦¥­¨©,
m[i; j ] = m[i; k] + m[k + 1; j ] + pi;1 pk pj :
 ½²®¬ ±®®²­®¸¥­¨¨ ¯®¤° §³¬¥¢ ¥²±¿, ·²® ®¯²¨¬ «¼­®¥ §­ ·¥­¨¥ k ­ ¬ ¨§¢¥±²­®; ­  ¤¥«¥ ½²® ­¥ ² ª. ¤­ ª® ·¨±«® k ¬®¦¥²
¯°¨­¨¬ ²¼ ¢±¥£® «¨¸¼ j ; i ° §«¨·­»µ §­ ·¥­¨©: i; i + 1; : : :; j ; 1.
®±ª®«¼ª³ ®¤­® ¨§ ­¨µ ®¯²¨¬ «¼­®, ¤®±² ²®·­® ¯¥°¥¡° ²¼ ½²¨ §­ ·¥­¨¿ k ¨ ¢»¡° ²¼ ­ ¨«³·¸¥¥. ®«³· ¥¬ °¥ª³°°¥­²­³¾ ´®°¬³«³:
(

0
¯°¨ i = j ,
min fm[i; k] + m[k + 1; j ] + pi;1 pk pj g ¯°¨ i < j .
i6k<j
(16.2)
¨±«  m[i; j ] | ±²®¨¬®±²¨ ®¯²¨¬ «¼­»µ °¥¸¥­¨© ¯®¤§ ¤ ·. ²®¡» ¯°®±«¥¤¨²¼ §  ²¥¬, ª ª ¯®«³· ¥²±¿ ®¯²¨¬ «¼­®¥ °¥¸¥­¨¥, ®¡®§­ ·¨¬ ·¥°¥§ s[i; j ] ®¯²¨¬ «¼­®¥ ¬¥±²® ¯®±«¥¤­¥£® ³¬­®¦¥­¨¿, ²®
¥±²¼ ² ª®¥ k, ·²® ¯°¨ ®¯²¨¬ «¼­®¬ ¢»·¨±«¥­¨¨ ¯°®¨§¢¥¤¥­¨¿
AiAi+1 : : :Aj ¯®±«¥¤­¨¬ ¨¤¥² ³¬­®¦¥­¨¥ Ai : : :Ak ­  Ak+1 : : :Aj .
­»¬¨ ±«®¢ ¬¨, s[i; j ] ° ¢­® ·¨±«³ k, ¤«¿ ª®²®°®£® m[i; j ] = m[i; k]+
m[k + 1; j ] + pi;1pk pj .

m[i; j ] =

 £ 3: ¢»·¨±«¥­¨¥ ®¯²¨¬ «¼­®© ±²®¨¬®±²¨
®«¼§³¿±¼ ±®®²­®¸¥­¨¿¬¨ (16.2), ²¥¯¥°¼ «¥£ª® ­ ¯¨± ²¼ °¥ª³°±¨¢­»©  «£®°¨²¬, ®¯°¥¤¥«¿¾¹¨© ¬¨­¨¬ «¼­³¾ ±²®¨¬®±²¼ ¢»·¨±«¥­¨¿ ¯°®¨§¢¥¤¥­¨¿ A1A2 : : :An (². ¥. ·¨±«® m[1; n]). ¤­ ª® ¢°¥¬¿

310

« ¢  16 ¨­ ¬¨·¥±ª®¥ ¯°®£° ¬¬¨°®¢ ­¨¥

° ¡®²» ² ª®£®  «£®°¨²¬  ½ª±¯®­¥­¶¨ «¼­® § ¢¨±¨² ®² n, ² ª ·²®
½²®²  «£®°¨²¬ ­¥ «³·¸¥ ¯®«­®£® ¯¥°¥¡®° .  ±²®¿¹¨© ¢»¨£°»¸
¢® ¢°¥¬¥­¨ ¬» ¯®«³·¨¬, ¥±«¨ ¢®±¯®«¼§³¥¬±¿ ²¥¬, ·²® ¯®¤§ ¤ · ®²­®±¨²¥«¼­® ­¥¬­®£®: ¯® ®¤­®© § ¤ ·¥ ¤«¿ ª ¦¤®© ¯ °» (i; j ), ¤«¿
ª®²®°®© 1 6 i 6 j 6 n,   ¢±¥£® Cn2 + n = (n2 ). ª±¯®­¥­¶¨ «¼­®¥
¢°¥¬¿ ° ¡®²» ¢®§­¨ª ¥² ¯®²®¬³, ·²® °¥ª³°±¨¢­»©  «£®°¨²¬ °¥¸ ¥² ª ¦¤³¾ ¨§ ¯®¤§ ¤ · ¯® ¬­®£³ ° §, ­  ° §­»µ ¢¥²¢¿µ ¤¥°¥¢ 
°¥ª³°±¨¨.  ª®¥ À¯¥°¥ª°»²¨¥ ¯®¤§ ¤ ·Á | µ ° ª²¥°­»© ¯°¨§­ ª
§ ¤ ·, °¥¸ ¥¬»µ ¬¥²®¤®¬ ¤¨­ ¬¨·¥±ª®£® ¯°®£° ¬¬¨°®¢ ­¨¿.
¬¥±²® °¥ª³°±¨¨ ¬» ¢»·¨±«¨¬ ®¯²¨¬ «¼­³¾ ±²®¨¬®±²¼ À±­¨§³
¢¢¥°µÁ.  ­¨¦¥±«¥¤³¾¹¥© ¯°®£° ¬¬¥ ¯°¥¤¯®« £ ¥²±¿, ·²® ¬ ²°¨¶ 
Ai ¨¬¥¥² ° §¬¥° pi;1  pi ¯°¨ i = 1; 2; : : :; n.   ¢µ®¤ ¯®¤ ¥²±¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼ p = hp0; p1; : : :; pni, £¤¥ length[p] = n + 1. °®£° ¬¬ 
¨±¯®«¼§³¥² ¢±¯®¬®£ ²¥«¼­»¥ ² ¡«¨¶» m[1 : :n; 1 : :n] (¤«¿ µ° ­¥­¨¿
±²®¨¬®±²¥© m[i; j ]) ¨ s[1 : :n; 1 : :n] (¢ ­¥© ®²¬¥· ¥²±¿, ¯°¨ ª ª®¬ k
¤®±²¨£ ¥²±¿ ®¯²¨¬ «¼­ ¿ ±²®¨¬®±²¼ ¯°¨ ¢»·¨±«¥­¨¨ m[i; j ]).
Matrix-Chain-Order(p)
1 n length[p] ; 1
2 for i 1 to n
3
do m[i; i] 0
4 for l 2 to n
5
do for i 1 to n ; l + 1
6
do j i + l ; 1
7
m[i; j ] 1
8
for k i to j ; 1
9
do q m[i; k] + m[k + 1; j ] + pi;1 pk pj
10
if q < m[i; j ]
11
then m[i; j ] q
12
s[i; j ] k
13 return m, s
 ¯®«­¿¿ ² ¡«¨¶³ m, ½²®²  «£®°¨²¬ ¯®±«¥¤®¢ ²¥«¼­® °¥¸ ¥² § ¤ ·¨ ®¡ ®¯²¨¬ «¼­®© ° ±±² ­®¢ª¥ ±ª®¡®ª ¤«¿ ®¤­®£®, ¤¢³µ, : : : ,
n ±®¬­®¦¨²¥«¥©.  ± ¬®¬ ¤¥«¥, ±®®²­®¸¥­¨¥ (16.2) ¯®ª §»¢ ¥², ·²®
·¨±«® m[i; j ] | ±²®¨¬®±²¼ ¯¥°¥¬­®¦¥­¨¿ j ; i +1 ¬ ²°¨¶ | § ¢¨±¨²
²®«¼ª® ®² ±²®¨¬®±²¥© ¬¥­¼¸¥£® (·¥¬ j ; i +1) ·¨±«  ¬ ²°¨¶. ¬¥­­®, ¤«¿ k = i; i + 1; : : :; j ; 1 ¯®«³· ¥²±¿, ·²® Ai::k | ¯°®¨§¢¥¤¥­¨¥
k ; i +1 < j ; i +1 ¬ ²°¨¶,   Ak+1::j | ¯°®¨§¢¥¤¥­¨¥ j ; k < j ; i +1
¬ ²°¨¶.
­ · «  (¢ ±²°®ª µ 2{3)  «£®°¨²¬ ¢»¯®«­¿¥² ¯°¨±¢ ¨¢ ­¨¿
m[i; i] 0 ¤«¿ i = 1; 2; : : :; n: ±²®¨¬®±²¼ ¯¥°¥¬­®¦¥­¨¿ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¨§ ®¤­®© ¬ ²°¨¶» ° ¢­  ­³«¾. °¨ ¯¥°¢®¬ ¨±¯®«­¥­¨¨
¶¨ª«  (±²°®ª¨ 4{12) ¢»·¨±«¿¾²±¿ (± ¯®¬®¹¼¾ ±®®²­®¸¥­¨© (16.2))
§­ ·¥­¨¿ m[i; i+1] ¤«¿ i = 1; 2; : : :; n;1 | ½²® ¬¨­¨¬ «¼­»¥ ±²®¨¬®±²¨ ¤«¿ ¯®±«¥¤®¢ ²¥«¼­®±²¥© ¤«¨­» 2. °¨ ¢²®°®¬ ¯°®µ®¤¥ ¢»·¨-

¥°¥¬­®¦¥­¨¥ ­¥±ª®«¼ª¨µ ¬ ²°¨¶

311

 ¡«¨¶» m ¨ s, ¢»·¨±«¿¥¬»¥ ¯°®¶¥¤³°®© Matrix-Chain-Order ¤«¿
n = 6 ¨ ¬ ²°¨¶ ±«¥¤³¾¹¥£® ° §¬¥° :
¨±. 16.1

¬ ²°¨¶  ° §¬¥°
A1
30  35
A2
35  15
A3
15  5
A4
5  10
A5
10  20
A6
20  25
 ¡«¨¶» ¯®¢¥°­³²» ² ª, ·²® £« ¢­ ¿ ¤¨ £®­ «¼ £®°¨§®­² «¼­ .  ² ¡«¨¶¥ m
¨±¯®«¼§³¾²±¿ ²®«¼ª® ª«¥²ª¨, «¥¦ ¹¨¥ ­¥ ­¨¦¥ £« ¢­®© ¤¨ £®­ «¨, ¢ ² ¡«¨¶¥ s
| ²®«¼ª® ª«¥²ª¨, «¥¦ ¹¨¥ ±²°®£® ¢»¸¥. ¨­¨¬ «¼­®¥ ª®«¨·¥±²¢® ³¬­®¦¥­¨©, ­¥®¡µ®¤¨¬®¥ ¤«¿ ¯¥°¥¬­®¦¥­¨¿ ¢±¥µ ¸¥±²¨ ¬ ²°¨¶, ° ¢­® m[1; 6] = 15 125.
 °» ª«¥²®·¥ª, § ¸²°¨µ®¢ ­­»µ ®¤¨­ ª®¢®© ±¢¥²«®© ¸²°¨µ®¢ª®©, ±®¢¬¥±²­®
¢µ®¤¿² ¢ ¯° ¢³¾ · ±²¼ ´®°¬³«» ¢ ¯°®¶¥±±¥ ¢»·¨±«¥­¨¿ m[2; 5] (±²°®ª  9 ¯°®¶¥¤³°» Matrix-Chain-Order
8 m[2; 2] + m[3):; 5] + p p p = 0 + 2500 + 35  15  20 = 13000;
>
1 2 5
<
m[2; 5] = min > m[2; 3] + m[4; 5] + p1 p3 p5 = 2625 + 1000 + 35  5  20 = 7125;
: m[2; 4] + m[5; 5] + p1 p4 p5 = 4375 + 0 + 35  10  20 = 11375:

±«¿¾²±¿ m[i; i +2] ¤«¿ i = 1; 2; : : :; n ; 2 | ¬¨­¨¬ «¼­»¥ ±²®¨¬®±²¨
¯¥°¥¬­®¦¥­¨¿ ¯®±«¥¤®¢ ²¥«¼­®±²¥© ¤«¨­» 3, ¨ ² ª ¤ «¥¥.   ª ¦¤®¬ ¸ £¥ §­ ·¥­¨¥ m[i; j ], ¢»·¨±«¿¥¬®¥ ¢ ±²°®ª µ 9{12, § ¢¨±¨²
²®«¼ª® ®² ¢»·¨±«¥­­»µ ° ­¥¥ §­ ·¥­¨© m[i; k] ¨ m[k + 1; j ].
  °¨±. 16.1 ¯®ª § ­®, ª ª ½²® ¯°®¨±µ®¤¨² ¯°¨ n = 6. ®±ª®«¼ª³ ¬» ®¯°¥¤¥«¿¥¬ m[i; j ] ²®«¼ª® ¤«¿ i 6 j , ¨±¯®«¼§³¥²±¿ · ±²¼
² ¡«¨¶», «¥¦ ¹ ¿ ­ ¤ £« ¢­®© ¤¨ £®­ «¼¾.   °¨±³­ª¥ ² ¡«¨¶»
¯®¢¥°­³²» (£« ¢­ ¿ ¤¨ £®­ «¼ £®°¨§®­² «¼­ ). ­¨§³ ¢»¯¨± ­ 
¯®±«¥¤®¢ ²¥«¼­®±²¼ ¬ ²°¨¶. ¨±«® m[i; j ] | ¬¨­¨¬ «¼­ ¿ ±²®¨¬®±²¼ ¯¥°¥¬­®¦¥­¨¿ ¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¨ Ai Ai+1 : : :Aj | ­ µ®¤¨²±¿ ­  ¯¥°¥±¥·¥­¨¨ ¤¨ £®­ «¥©, ¨¤³¹¨µ ¢¯° ¢®-¢¢¥°µ ®² ¬ ²°¨¶» Ai ¨ ¢«¥¢®-¢¢¥°µ ®² ¬ ²°¨¶» Aj .  ª ¦¤®¬ £®°¨§®­² «¼­®¬ °¿¤³ ±®¡° ­» ±²®¨¬®±²¨ ¯¥°¥¬­®¦¥­¨¿ ¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¥© ´¨ª±¨°®¢ ­­®© ¤«¨­». «¿ § ¯®«­¥­¨¿ ª«¥²ª¨ m[i; j ] ­³¦­®
§­ ²¼ ¯°®¨§¢¥¤¥­¨¿ pi;1 pk pj ¤«¿ k = i; i + 1; : : :; j ; 1 ¨ ±®¤¥°¦¨¬®¥
ª«¥²®ª, «¥¦ ¹¨µ ±«¥¢ -¢­¨§³ ¨ ±¯° ¢ -¢­¨§³ ®² m[i; j ].

312

« ¢  16 ¨­ ¬¨·¥±ª®¥ ¯°®£° ¬¬¨°®¢ ­¨¥

°®±² ¿ ®¶¥­ª  ¯®ª §»¢ ¥², ·²® ¢°¥¬¿ ° ¡®²»  «£®°¨²¬ 

Matrix-Chain-Order ¥±²¼ O(n3 ).  ± ¬®¬ ¤¥«¥, ·¨±«® ¢«®¦¥­­»µ

¶¨ª«®¢ ° ¢­® ²°¥¬, ¨ ª ¦¤»© ¨§ ¨­¤¥ª±®¢ l, i ¨ k ¯°¨­¨¬ ¥²
­¥ ¡®«¥¥ n §­ ·¥­¨©.  ³¯° ¦­¥­¨¨ 16.1-3 ¬» ¯°¥¤«®¦¨¬ ¢ ¬
¯®ª § ²¼, ·²® ¢°¥¬¿ ° ¡®²» ½²®£®  «£®°¨²¬  ¥±²¼ (n3 ). ¡º¥¬
¯ ¬¿²¨, ­¥®¡µ®¤¨¬»© ¤«¿ µ° ­¥­¨¿ ² ¡«¨¶ m ¨ s, ¥±²¼ (n2 ). ¥¬
± ¬»¬ ½²®²  «£®°¨²¬ §­ ·¨²¥«¼­® ½´´¥ª²¨¢­¥¥, ·¥¬ ²°¥¡³¾¹¨©
½ª±¯®­¥­¶¨ «¼­®£® ¢°¥¬¥­¨ ¯¥°¥¡®° ¢±¥µ ° ±±² ­®¢®ª.
 £ 4: ¯®±²°®¥­¨¥ ®¯²¨¬ «¼­®£® °¥¸¥­¨¿

«£®°¨²¬ Matrix-Chain-Order ­ µ®¤¨² ¬¨­¨¬ «¼­®¥ ·¨±«®
³¬­®¦¥­¨©, ­¥®¡µ®¤¨¬®¥ ¤«¿ ¯¥°¥¬­®¦¥­¨¿ ¯®±«¥¤®¢ ²¥«¼­®±²¨
¬ ²°¨¶. ±² «®±¼ ­ ©²¨ ° ±±² ­®¢ª³ ±ª®¡®ª, ¯°¨¢®¤¿¹³¾ ª ² ª®¬³ ·¨±«³ ³¬­®¦¥­¨©.
«¿ ½²®£® ¬» ¨±¯®«¼§³¥¬ ² ¡«¨¶³ s[1 : :n; 1 : :n].  ª«¥²ª¥ s[i; j ]
§ ¯¨± ­® ¬¥±²® ¯®±«¥¤­¥£® ³¬­®¦¥­¨¿ ¯°¨ ®¯²¨¬ «¼­®© ° ±±² ­®¢ª¥ ±ª®¡®ª; ¤°³£¨¬¨ ±«®¢ ¬¨, ¯°¨ ®¯²¨¬ «¼­®¬ ±¯®±®¡¥
¢»·¨±«¥­¨¿ A1::n ¯®±«¥¤­¨¬ ¨¤¥² ³¬­®¦¥­¨¥ A1::s[1;n] ­  As[1;n]+1::n .
°¥¤¸¥±²¢³¾¹¨¥ ³¬­®¦¥­¨¿ ¬®¦­® ­ ©²¨ °¥ª³°±¨¢­®: §­ ·¥­¨¥ s[1; s[1; n]] ®¯°¥¤¥«¿¥² ¯®±«¥¤­¥¥ ³¬­®¦¥­¨¥ ¯°¨ ­ µ®¦¤¥­¨¨ A1::s[1;n] ,   s[s[1; n] + 1; n] ®¯°¥¤¥«¿¥² ¯®±«¥¤­¥¥ ³¬­®¦¥­¨¥ ¯°¨
¢»·¨±«¥­¨¨ As[1;n]+1::n . °¨¢¥¤¥­­ ¿ ­¨¦¥ °¥ª³°±¨¢­ ¿ ¯°®¶¥¤³° 
¢»·¨±«¿¥² ¯°®¨§¢¥¤¥­¨¥ Ai::j , ¨¬¥¿ ±«¥¤³¾¹¨¥ ¤ ­­»¥: ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¬ ²°¨¶ A = hA1; A2; : : :; An i, ² ¡«¨¶³ s, ­ ©¤¥­­³¾
¯°®¶¥¤³°®© Matrix-Chain-Order,   ² ª¦¥ ¨­¤¥ª±» i ¨ j . °®¨§¢¥¤¥­¨¥ A1 A2 : : :An ° ¢­® Matrix-Chain-Multiply(A; s; 1; n).
Matrix-Chain-Multiply(A; s; i; j )
1 if j > i
2 then X Matrix-Chain-Multiply(A; s; i; s[i; j ])
3
Y Matrix-Chain-Multiply(A; s; s[i; j ] + 1; j )
4
return Matrix-Multiply(X; Y )
5 else return Ai
 ¯°¨¬¥°¥ ­  °¨±. 16.1 ¢»§®¢ Matrix-Chain-Multiply(A; s; 1; 6)
¢»·¨±«¨² ¯°®¨§¢¥¤¥­¨¥ ¸¥±²¨ ¬ ²°¨¶ ¢ ±®®²¢¥²±²¢¨¨ ± ° ±±² ­®¢ª®© ±ª®¡®ª
((A1(A2 A3 ))((A4A5 )A6 )):

(16.3)

[¥µ­¨·¥±ª®¥ § ¬¥· ­¨¥: ±«¥¤³¥² ¯®§ ¡®²¨²¼±¿, ·²®¡» ¯°¨ ¯¥°¥¤ ·¥
¬ ±±¨¢  s ¢ ¯°®¶¥¤³°³ ­¥ ¯°®¨±µ®¤¨«® ª®¯¨°®¢ ­¨¿.]

®£¤  ¯°¨¬¥­¨¬® ¤¨­ ¬¨·¥±ª®¥ ¯°®£° ¬¬¨°®¢ ­¨¥

313

¯° ¦­¥­¨¿
16.1-1  ©¤¨²¥ ®¯²¨¬ «¼­³¾ ° ±±² ­®¢ª³ ¢ § ¤ ·¥ ® ¯¥°¥¬­®¦¥­¨¨ ¬ ²°¨¶, ¥±«¨ p = h5; 10; 3; 12; 5; 50; 6i.
16.1-2  §° ¡®² ©²¥  «£®°¨²¬ Print-Optimal-Parens, ¯¥· ² ¾¹¨© ®¯²¨¬ «¼­³¾ ° ±±² ­®¢ª³ ±ª®¡®ª. ( ¡«¨¶  s ³¦¥ ¢»·¨±«¥­ 
 «£®°¨²¬®¬ Matrix-Chain-Order.)
16.1-3 ³±²¼ R(i; j ) ®¡®§­ · ¥² ª®«¨·¥±²¢® ®¡° ¹¥­¨©  «£®°¨²¬  Matrix-Chain-Order ª ½«¥¬¥­²³ m[i; j ] ² ¡«¨¶» m ± ¶¥«¼¾
¢»·¨±«¥­¨¿ ¤°³£¨µ ½«¥¬¥­²®¢ ² ¡«¨¶» [±²°®ª  9]. ®ª ¦¨²¥, ·²®
®¡¹¥¥ ª®«¨·¥±²¢® ² ª¨µ ®¡° ¹¥­¨© ° ¢­®
n X
n
X
i=1 j =1

3
R(i; j ) = n 3; n :
P

(ª § ­¨¥.  ¬ ¬®¦¥² ¯°¨£®¤¨²¼±¿ ´®°¬³«  ni=1 i2 = n(n +
1)(2n + 1)=6.)
16.1-4 ®ª ¦¨²¥, ·²® ¯®«­ ¿ ° ±±² ­®¢ª  ±ª®¡®ª ¢ ¯°®¨§¢¥¤¥­¨¨
n ¬­®¦¨²¥«¥© ¨±¯®«¼§³¥² °®¢­® n ; 1 ¯ ° ±ª®¡®ª.

16.2. ®£¤  ¯°¨¬¥­¨¬® ¤¨­ ¬¨·¥±ª®¥ ¯°®£° ¬¬¨°®¢ ­¨¥
 ½²®¬ ° §¤¥«¥ ¬» ³ª ¦¥¬ ¤¢  ¯°¨§­ ª , µ ° ª²¥°­»µ ¤«¿ § ¤ ·,
°¥¸ ¥¬»µ ¬¥²®¤®¬ ¤¨­ ¬¨·¥±ª®£® ¯°®£° ¬¬¨°®¢ ­¨¿.
¯²¨¬ «¼­®±²¼ ¤«¿ ¯®¤§ ¤ ·
°¨ °¥¸¥­¨¨ ®¯²¨¬¨§ ¶¨®­­®© § ¤ ·¨ ± ¯®¬®¹¼¾ ¤¨­ ¬¨·¥±ª®£® ¯°®£° ¬¬¨°®¢ ­¨¿ ­¥®¡µ®¤¨¬® ±­ · «  ®¯¨± ²¼ ±²°³ª²³°³
®¯²¨¬ «¼­®£® °¥¸¥­¨¿. ³¤¥¬ £®¢®°¨²¼, ·²® § ¤ ·  ®¡« ¤ ¥² ±¢®©±²¢®¬ ®¯²¨¬ «¼­®±²¨ ¤«¿ § ¤ · (has optimal substructure), ¥±«¨
®¯²¨¬ «¼­®¥ °¥¸¥­¨¥ § ¤ ·¨ ±®¤¥°¦¨² ®¯²¨¬ «¼­»¥ °¥¸¥­¨¿ ¥¥
¯®¤§ ¤ ·. ±«¨ § ¤ ·  ®¡« ¤ ¥² ½²¨¬ ±¢®©±²¢®¬, ²® ¤¨­ ¬¨·¥±ª®¥
¯°®£° ¬¬¨°®¢ ­¨¥ ¬®¦¥² ®ª § ²¼±¿ ¯®«¥§­»¬ ¤«¿ ¥¥ °¥¸¥­¨¿ (a
¢®§¬®¦­®, ¯°¨¬¥­¨¬ ¨ ¦ ¤­»©  «£®°¨²¬ | ±¬. £« ¢³ 17).
 ° §¤¥«¥ 16.1 ¬» ¢¨¤¥«¨, ·²® § ¤ ·  ¯¥°¥¬­®¦¥­¨¿ ¬ ²°¨¶
®¡« ¤ ¥² ±¢®©±²¢®¬ ®¯²¨¬ «¼­®±²¨ ¤«¿ ¯®¤§ ¤ ·: ª ¦¤ ¿ ±ª®¡ª 
¢ ®¯²¨¬ «¼­®¬ ¯°®¨§¢¥¤¥­¨¨ ³ª §»¢ ¥² ®¯²¨¬ «¼­»© ±¯®±®¡ ¯¥°¥¬­®¦¥­¨¿ ¢µ®¤¿¹¨µ ¢ ­¥¥ ¬ ²°¨¶. ²®¡» ³¡¥¤¨²¼±¿, ·²® § ¤ · 
®¡« ¤ ¥² ½²¨¬ ±¢®©±²¢®¬, ­ ¤® (ª ª ¢ ° §¤¥«¥ 16.1) ¯®ª § ²¼, ·²®,
³«³·¸ ¿ °¥¸¥­¨¥ ¯®¤§ ¤ ·¨, ¬» ³«³·¸¨¬ ¨ °¥¸¥­¨¥ ¨±µ®¤­®© § ¤ ·¨.

314

« ¢  16 ¨­ ¬¨·¥±ª®¥ ¯°®£° ¬¬¨°®¢ ­¨¥

 ª ²®«¼ª® ±¢®©±²¢® ®¯²¨¬ «¼­®±²¨ ¤«¿ ¯®¤§ ¤ · ³±² ­®¢«¥­®,
®¡»·­® ±² ­®¢¨²±¿ ¿±­®, ± ª ª¨¬ ¨¬¥­­® ¬­®¦¥±²¢®¬ ¯®¤§ ¤ · ¡³¤¥² ¨¬¥²¼ ¤¥«®  «£®°¨²¬.  ¯°¨¬¥°, ¤«¿ § ¤ ·¨ ® ¯¥°¥¬­®¦¥­¨¨
¯®±«¥¤®¢ ²¥«¼­®±²¨ ¬ ²°¨¶ ¯®¤§ ¤ · ¬¨ ¡³¤³² § ¤ ·¨ ® ¯¥°¥¬­®¦¥­¨¨ ª³±ª®¢ ½²®© ¯®±«¥¤®¢ ²¥«¼­®±²¨.
¥°¥ª°»¢ ¾¹¨¥±¿ ¯®¤§ ¤ ·¨
²®°®© ±¢®©±²¢® § ¤ ·, ­¥®¡µ®¤¨¬®¥ ¤«¿ ¨±¯®«¼§®¢ ­¨¿ ¤¨­ ¬¨·¥±ª®£® ¯°®£° ¬¬¨°®¢ ­¨¿, | ¬ «®±²¼ ¬­®¦¥±²¢  ¯®¤§ ¤ ·. « £®¤ °¿ ½²®¬³ ¯°¨ °¥ª³°±¨¢­®¬ °¥¸¥­¨¨ § ¤ ·¨ ¬» ¢±¥ ¢°¥¬¿ ¢»µ®¤¨¬ ­  ®¤­¨ ¨ ²¥ ¦¥ ¯®¤§ ¤ ·¨.  ² ª®¬ ±«³· ¥ £®¢®°¿², ·²®
³ ®¯²¨¬¨§ ¶¨®­­®© § ¤ ·¨ ¨¬¥¾²±¿ ¯¥°¥ª°»¢ ¾¹¨¥±¿ ¯®¤§ ¤ ·¨
(overlapping subproblems).  ²¨¯¨·­»µ ±«³· ¿µ ª®«¨·¥±²¢® ¯®¤§ ¤ · ¯®«¨­®¬¨ «¼­® § ¢¨±¨² ®² ° §¬¥°  ¨±µ®¤­»µ ¤ ­­»µ.
 § ¤ · µ, °¥¸ ¥¬»µ ¬¥²®¤®¬ À° §¤¥«¿© ¨ ¢« ±²¢³©Á, ² ª ­¥ ¡»¢ ¥²: ¤«¿ ­¨µ °¥ª³°±¨¢­»©  «£®°¨²¬, ª ª ¯° ¢¨«®, ­  ª ¦¤®¬ ¸ £¥
¯®°®¦¤ ¥² ±®¢¥°¸¥­­® ­®¢»¥ ¯®¤§ ¤ ·¨. «£®°¨²¬», ®±­®¢ ­­»¥
­  ¤¨­ ¬¨·¥±ª®¬ ¯°®£° ¬¬¨°®¢ ­¨¨, ¨±¯®«¼§³¾² ¯¥°¥ª°»²¨¥ ¯®¤§ ¤ · ±«¥¤³¾¹¨¬ ®¡° §®¬: ª ¦¤ ¿ ¨§ ¯®¤§ ¤ · °¥¸ ¥²±¿ ²®«¼ª®
®¤¨­ ° §, ¨ ®²¢¥² § ­®±¨²±¿ ¢ ±¯¥¶¨ «¼­³¾ ² ¡«¨¶³; ª®£¤  ½²  ¦¥
¯®¤§ ¤ ·  ¢±²°¥· ¥²±¿ ±­®¢ , ¯°®£° ¬¬  ­¥ ²° ²¨² ¢°¥¬¿ ­  ¥¥
°¥¸¥­¨¥,   ¡¥°¥² £®²®¢»© ®²¢¥² ¨§ ² ¡«¨¶».
¥°­¥¬±¿ ¤«¿ ¯°¨¬¥°  ª § ¤ ·¥ ® ¯¥°¥¬­®¦¥­¨¨ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¬ ²°¨¶. § °¨±³­ª  16.1 ¢¨¤­®, ·²® °¥¸¥­¨¥ ª ¦¤®© ¨§ ¯®¤§ ¤ ·, § ¯¨± ­­®¥ ¢ ¤ ­­®© ª«¥²®·ª¥ ² ¡«¨¶», ¬­®£®ª° ²­® ¨±¯®«¼§³¥²±¿ ¯°®¶¥¤³°®© Matrix-Chain-Order ¯°¨ °¥¸¥­¨¨ ¯®¤§ ¤ · ¨§ ° ±¯®«®¦¥­­»µ ¢»¸¥ ª«¥²®·¥ª.  ¯°¨¬¥°, m[3; 4] ¨±¯®«¼§³¥²±¿ ·¥²»°¥¦¤»: ¯°¨ ¢»·¨±«¥­¨¨ m[2; 4], m[1; 4], m[3; 5] ¨ m[3; 6].
»«® ¡» ª° ©­¥ ­¥½´´¥ª²¨¢­® ¢»·¨±«¿²¼ m[3; 4] ¢±¿ª¨© ° § § ­®¢®.  ± ¬®¬ ¤¥«¥, ° ±±¬®²°¨¬ ±«¥¤³¾¹¨© (­¥½´´¥ª²¨¢­»©) °¥ª³°±¨¢­»©  «£®°¨²¬, ®±­®¢ ­­»© ­¥¯®±°¥¤±²¢¥­­® ­  ±®®²­®¸¥­¨¿µ (16.2) ¨ ¢»·¨±«¿¾¹¨© m[i; j ] | ¬¨­¨¬ «¼­®¥ ª®«¨·¥±²¢® ³¬­®¦¥­¨©, ­¥®¡µ®¤¨¬®¥ ¤«¿ ¢»·¨±«¥­¨¿ Ai::j = Ai Ai+1 : : :Aj :
Recursive-Matrix-Chain(p; i; j )
1 if i = j
2 then return 0
3 m[i; j ] 1
4 for k i to j ; 1
5
do q Recursive-Matrix-Chain(p; i; k) +
+ Recursive-Matrix-Chain(p; k + 1; j ) + pi;1 pk pj
6
if q < m[i; j ]
7
then m[i; j ] q
8 return m[i; j ]

®£¤  ¯°¨¬¥­¨¬® ¤¨­ ¬¨·¥±ª®¥ ¯°®£° ¬¬¨°®¢ ­¨¥

315

¨±. 16.2 ¥°¥¢® °¥ª³°±¨¨ ¤«¿ Recursive-Matrix-Chain (p; 1; 4).  ª ¦¤®©
¢¥°¸¨­¥ § ¯¨± ­» §­ ·¥­¨¿ i ¨ j .  ¸²°¨µ®¢ ­» À«¨¸­¨¥Á ¢¥°¸¨­» (¢»·¨±«¥­¨¿ ¢ ª®²®°»µ ¯®¢²®°¿¾² ³¦¥ ¯°®¤¥« ­­»¥).

  °¨±. 16.2 ¨§®¡° ¦¥­® ¤¥°¥¢® °¥ª³°±¨¨ ¤«¿ Recursive-MatrixChain(p; 1; 4).  ª ¦¤®© ¢¥°¸¨­¥ § ¯¨± ­» §­ ·¥­¨¿ i ¨ j . ¡° ²¨²¥ ¢­¨¬ ­¨¥, ·²® ­¥ª®²®°»¥ ¯ °» (i; j ) ¢±²°¥· ¾²±¿ ¬­®£®ª° ²­®.
¥£ª® ¢¨¤¥²¼, ·²® ¢°¥¬¿ ° ¡®²» Recursive-Matrix-Chain(p; 1; n)
§ ¢¨±¨² ®² n ¯® ¬¥­¼¸¥© ¬¥°¥ ½ª±¯®­¥­¶¨ «¼­®.  ± ¬®¬ ¤¥«¥,
®¡®§­ ·¨¬ ¥£® T (n) ¨ ¯°¨¬¥¬, ·²® ¢°¥¬¿ ¨±¯®«­¥­¨¿ ±²°®ª 1{2,  
² ª¦¥ 6{7, ° ¢­® ¥¤¨­¨¶¥. ®£¤ :
T (1) > 1;

T (n) > 1 +

nX
;1
k=1

(T (k) + T (n ; k) + 1);

¥±«¨ n > 1.

 ±³¬¬¥ ¯® k ª ¦¤®¥ T (i) (¯°¨ i = 1; 2; : : :; n ; 1) ¢±²°¥· ¥²±¿
¤¢ ¦¤», ¨ ¥¹¥ ¥±²¼ n ; 1 ¥¤¨­¨¶. ² «® ¡»²¼,

T (n) > 2

n;1
X
i=1

T (i) + n:

(16.4)

®ª ¦¥¬ ¯® ¨­¤³ª¶¨¨, ·²® T (n) > 2n;1 ¤«¿ ¢±¥µ n > 1. °¨ n = 1
­¥° ¢¥­±²¢® ¢»¯®«­¥­®, ² ª ª ª T (1) > 1 = 20.  £ ¨­¤³ª¶¨¨:
nX
;1

n;2
X
i
;
1
T (n) > 2 2 + n = 2 2i + n =
i=1
i=0
n
;
1
= 2(2 ; 1) + n = 2n ; 2 + n > 2n;1 :

» ¢¨¤¨¬, ·²®  «£®°¨²¬ Recursive-Matrix-Chain ²°¥¡³¥² ½ª±¯®­¥­¶¨ «¼­®£® ¢°¥¬¥­¨. °¨·¨­  ¢ ²®¬, ·²® ½²®²  «£®°¨²¬ ¬­®£®ª° ²­® ¢±²°¥· ¥² ®¤¨­ ª®¢»¥ ¯®¤§ ¤ ·¨ ¨ ª ¦¤»© ° § °¥¸ ¥²
¨µ § ­®¢®.  §«¨·­»µ ¯®¤§ ¤ · ¢±¥£® «¨¸¼ (n2 ), ¨ ¬ ±±  ¢°¥¬¥­¨
²¥°¿¥²±¿ ­  «¨¸­¾¾ ° ¡®²³. ¥²®¤ ¤¨­ ¬¨·¥±ª®£® ¯°®£° ¬¬¨°®¢ ­¨¿ ¯®§¢®«¿¥² ½²®© «¨¸­¥© ° ¡®²» ¨§¡¥¦ ²¼.

316

« ¢  16 ¨­ ¬¨·¥±ª®¥ ¯°®£° ¬¬¨°®¢ ­¨¥

¨­ ¬¨·¥±ª®¥ ¯°®£° ¬¬¨°®¢ ­¨¥ À±¢¥°µ³ ¢­¨§Á
«£®°¨²¬ ° §¤¥«  16.1 ¤¥©±²¢®¢ « À±­¨§³ ¢¢¥°µÁ. ® ²®² ¦¥
¯°¨¥¬ (¨±ª«¾·¥­¨¥ ¯®¢²®°­®£® °¥¸¥­¨¿ ¯®¤§ ¤ ·) ¬®¦­® °¥ «¨§®¢ ²¼ ¨ ¤«¿  «£®°¨²¬®¢, ° ¡®² ¾¹¨µ À±¢¥°µ³ ¢­¨§Á. «¿ ½²®£®
­³¦­® § ¯®¬¨­ ²¼ ®²¢¥²» ª ³¦¥ °¥¸¥­­»¬ ¯®¤§ ¤ · ¬ ¢ ±¯¥¶¨ «¼­®© ² ¡«¨¶¥. ­ · «  ¢±¿ ² ¡«¨¶  ¯³±²  (². ¥. § ¯®«­¥­  ±¯¥¶¨ «¼­»¬¨ § ¯¨±¿¬¨, ³ª §»¢ ¾¹¨¬¨ ­  ²®, ·²® ±®®²¢¥²±²¢³¾¹¥¥
§­ ·¥­¨¥ ¥¹¥ ­¥ ¢»·¨±«¥­®). ®£¤  ¢ ¯°®¶¥±±¥ ¢»¯®«­¥­¨¿  «£®°¨²¬  ¯®¤§ ¤ ·  ¢±²°¥· ¥²±¿ ¢ ¯¥°¢»© ° §, ¥¥ °¥¸¥­¨¥ § ­®±¨²±¿
¢ ² ¡«¨¶³.  ¤ «¼­¥©¸¥¬ °¥¸¥­¨¥ ½²®© ¯®¤§ ¤ ·¨ ¡¥°¥²±¿ ¯°¿¬®
¨§ ² ¡«¨¶». ( ­ ¸¥¬ ¯°¨¬¥°¥ ² ¡«¨¶³ ®²¢¥²®¢ § ¢¥±²¨ «¥£ª®, ² ª
ª ª ¯®¤§ ¤ ·¨ ­³¬¥°³¾²±¿ ¯ ° ¬¨ (i; j ).  ¡®«¥¥ ±«®¦­»µ ±«³· ¿µ ¬®¦­® ¨±¯®«¼§®¢ ²¼ µ¥¸¨°®¢ ­¨¥.) ®- ­£«¨©±ª¨ ½²®² ¯°¨¥¬
³«³·¸¥­¨¿ °¥ª³°±¨¢­»µ  «£®°¨²¬®¢ ­ §»¢ ¥²±¿ memoization.
°¨¬¥­¨¬ ½²® ³±®¢¥°¸¥­±²¢®¢ ­¨¥ ª  «£®°¨²¬³ RecursiveMatrix-Chain:
Memoized-Matrix-Chain(p)
1 n length[p] ; 1
2 for i 1 to n
3
do for j i to n
4
do m[i; j ] 1
5 return Lookup-Chain(p; 1; n)
Lookup-Chain(p; i; j )

1 if m[i; j ] < 1
2 then return m[i; j ]
3 if i = j
4 then m[i; j ] 0
5 else for k i to j ; 1
6
do q Lookup-Chain(p; i; k) +
+ Lookup-Chain(p; k + 1; j ) + pi;1 pk pj
7
if q < m[i; j ]
8
then m[i; j ] q
9 return m[i; j ]
°®¶¥¤³°  Memoized-Matrix-Chain, ¯®¤®¡­® Matrix-ChainOrder, § ¯®«­¿¥² ² ¡«¨¶³ m[1 : :n; 1 : :n], £¤¥ m[i; j ] | ¬¨­¨¬ «¼­®¥ ª®«¨·¥±²¢® ³¬­®¦¥­¨©, ­¥®¡µ®¤¨¬®¥ ¤«¿ ¢»·¨±«¥­¨¿ Ai::j . ¥°¢®­ · «¼­® m[i; j ] = 1 ¢ §­ ª ²®£®, ·²® ±®®²¢¥²±²¢³¾¹¥¥ ¬¥±²® ¢
² ¡«¨¶¥ ­¥ § ¯®«­¥­®. ±«¨ ¯°¨ ¨±¯®«­¥­¨¨ Lookup-Chain(p; i; j )
®ª §»¢ ¥²±¿, ·²® m[i; j ] < 1, ²® ¯°®¶¥¤³°  ±° §³ ¢»¤ ¥² ½²® §­ ·¥­¨¥ m[i; j ].  ¯°®²¨¢­®¬ ±«³· ¥ m[i; j ] ¢»·¨±«¿¥²±¿ ª ª ¢ ¯°®¶¥¤³°¥
Recursive-Matrix-Chain, § ¯¨±»¢ ¥²±¿ ¢ ² ¡«¨¶³ ¨ ¢»¤ ¥²±¿ ¢
ª ·¥±²¢¥ ®²¢¥² . ¥¬ ± ¬»¬ ¢»§®¢ Lookup-Chain(p; i; j ) ¢±¥£¤ 

®£¤  ¯°¨¬¥­¨¬® ¤¨­ ¬¨·¥±ª®¥ ¯°®£° ¬¬¨°®¢ ­¨¥

317

¢®§¢° ¹ ¥² m[i; j ], ­® ¢»·¨±«¥­¨¿ ¯°®¢®¤¿²±¿ ²®«¼ª® ¯°¨ ¯¥°¢®¬
² ª®¬ ¢»§®¢¥.
¨±. 16.2 ¨««¾±²°¨°³¥² ½ª®­®¬¨¾, ¤®±²¨£ ¥¬³¾ § ¬¥­®©
Recursive-Matrix-Chain ­  Memoized-Matrix-Chain.  ¸²°¨µ®¢ ­­»¥ ¢¥°¸¨­» ¤¥°¥¢  °¥ª³°±¨¨ ±®®²¢¥²±²¢³¾² ²¥¬
±«³· ¿¬, ª®£¤  §­ ·¥­¨¥ m[i; j ] ­¥ ¢»·¨±«¿¥²±¿,   ¡¥°¥²±¿ ¯°¿¬® ¨§
² ¡«¨¶».
«£®°¨²¬ Memoized-Matrix-Chain ²°¥¡³¥² ¢°¥¬¥­¨ O(n3),
ª ª ¨  «£®°¨²¬ Matrix-Chain-Order.  ± ¬®¬ ¤¥«¥, ª ¦¤ ¿ ¨§
(n2 ) ¯®§¨¶¨© ² ¡«¨¶» ®¤¨­ ° § ¨­¨¶¨ «¨§¨°³¥²±¿ (±²°®ª  4 ¯°®¶¥¤³°» Memoized-Matrix-Chain) ¨ ®¤¨­-¥¤¨­±²¢¥­­»© ° § § ¯®«­¿¥²±¿ | ¯°¨ ¯¥°¢®¬ ¢»§®¢¥ Lookup-Chain(p; i; j ) ¤«¿ ¤ ­­»µ
i ¨ j . ±¥ ¢»§®¢» Lookup-Chain(p; i; j ) ¤¥«¿²±¿ ­  ¯¥°¢»¥ ¨ ¯®¢²®°­»¥.  ¦¤»© ¨§ (n2 ) ¯¥°¢»µ ¢»§®¢®¢ ²°¥¡³¥² ¢°¥¬¥­¨ O(n)
(­¥ ¢ª«¾· ¿ ¢°¥¬¥­¨ ° ¡®²» °¥ª³°±¨¢­»µ ¢»§®¢®¢ Lookup-Chain
¤«¿ ¬¥­¼¸¨µ ³· ±²ª®¢); ®¡¹¥¥ ¢°¥¬¿ ° ¡®²» ¥±²¼ O(n3 ).  ¦¤»©
¨§ ¯®¢²®°­»µ ¢»§®¢®¢ ²°¥¡³¥² ¢°¥¬¥­¨ O(1); ¨µ ·¨±«® ¥±²¼ O(n3 )
(¢»·¨±«¥­¨¿ ¤«¿ ª ¦¤®© ¨§ O(n2 ) ª«¥²®ª ² ¡«¨¶» ¯®°®¦¤ ¾² O(n)
¢»§®¢®¢). ¥¬ ± ¬»¬ °¥ª³°±¨¢­»©  «£®°¨²¬, ²°¥¡³¾¹¨© ¢°¥¬¥­¨ 
(2n), ¯°¥¢° ²¨«±¿ ¢ ¯®«¨­®¬¨ «¼­»©, ²°¥¡³¾¹¨© ¢°¥¬¥­¨ O(n3).
®¤¢¥¤¥¬ ¨²®£¨: § ¤ ·  ®¡ ®¯²¨¬ «¼­®¬ ¯®°¿¤ª¥ ³¬­®¦¥­¨¿
n ¬ ²°¨¶ ¬®¦¥² ¡»²¼ °¥¸¥­  §  ¢°¥¬¿ O(n3) «¨¡® À±¢¥°µ³ ¢­¨§Á
(°¥ª³°±¨¢­»©  «£®°¨²¬ ± § ¯®¬¨­ ­¨¥¬ ®²¢¥²®¢), «¨¡® À±­¨§³
¢¢¥°µÁ (¤¨­ ¬¨·¥±ª®¥ ¯°®£° ¬¬¨°®¢ ­¨¥). ¡   «£®°¨²¬  ®±­®¢ ­» ­  ¯¥°¥ª°»²¨¨ ¯®¤§ ¤ ·; ·¨±«® ¯®¤§ ¤ · ¥±²¼ (n2 ), ¨ ®¡   «£®°¨²¬  °¥¸ ¾² ª ¦¤³¾ ¨§ ¯®¤§ ¤ · «¨¸¼ ¥¤¨­®¦¤».
®®¡¹¥ £®¢®°¿, ¥±«¨ ª ¦¤ ¿ ¨§ ¯®¤§ ¤ · ¤®«¦­  ¡»²¼ °¥¸¥­ 
µ®²¼ ° §, ¬¥²®¤ ¤¨­ ¬¨·¥±ª®£® ¯°®£° ¬¬¨°®¢ ­¨¿ (À±­¨§³ ¢¢¥°µÁ)
®¡»·­® ½´´¥ª²¨¢­¥¥, ·¥¬ °¥ª³°±¨¿ ± § ¯®¬¨­ ­¨¥¬ ®²¢¥²®¢, ¯®±ª®«¼ª³ °¥ «¨§ ¶¨¿ °¥ª³°±¨¨ (  ² ª¦¥ ¯°®¢¥°ª , ¥±²¼ ®²¢¥² ¢ ² ¡«¨¶¥ ¨«¨ ¥¹¥ ­¥²) ²°¥¡³¥² ¤®¯®«­¨²¥«¼­®£® ¢°¥¬¥­¨. ® ¥±«¨ ¤«¿
­ µ®¦¤¥­¨¿ ®¯²¨¬³¬  ­¥ ®¡¿§ ²¥«¼­® °¥¸ ²¼ ¢±¥ ¯®¤§ ¤ ·¨, ¯®¤µ®¤ À±¢¥°µ³ ¢­¨§Á ¨¬¥¥² ²® ¯°¥¨¬³¹¥±²¢®, ·²® °¥¸ ¾²±¿ «¨¸¼ ²¥
¯®¤§ ¤ ·¨, ª®²®°»¥ ¤¥©±²¢¨²¥«¼­® ­³¦­».
¯° ¦­¥­¨¿
16.2-1 ° ¢­¨²¥ ­¥° ¢¥­±²¢® (16.4) ± ´®°¬³«®© (8.4), ¨±¯®«¼§®¢ ­­®© ¯°¨ ®¶¥­ª¥ ¢°¥¬¥­¨ ° ¡®²»  «£®°¨²¬  ¡»±²°®© ±®°²¨°®¢ª¨.  ·¥¬ ¯°¨·¨­  ²®£®, ·²® ®¶¥­ª¨, ¯®«³· ¾¹¨¥±¿ ¨§ ½²¨µ ¤¢³µ
°¥ª³°°¥­²­»µ ±®®²­®¸¥­¨©, ±²®«¼ ° §«¨·­»?
16.2-2  ª «³·¸¥ ¨±ª ²¼ ®¯²¨¬ «¼­»© ¯®°¿¤®ª ¯¥°¥¬­®¦¥­¨¿
¬ ²°¨¶: ¯¥°¥¡¨° ¿ ¢±¥ ° ±±² ­®¢ª¨ ±ª®¡®ª ¨ ¢»·¨±«¿¿ ª®«¨·¥-

318

« ¢  16 ¨­ ¬¨·¥±ª®¥ ¯°®£° ¬¬¨°®¢ ­¨¥

±²¢® ³¬­®¦¥­¨© ¤«¿ ª ¦¤®© ¨§ ­¨µ, ¨«¨ ¦¥ ± ¯®¬®¹¼¾  «£®°¨²¬ 
Recursive-Matrix-Chain?
16.2-3  °¨±³©²¥ ¤¥°¥¢® °¥ª³°±¨¨ ¤«¿  «£®°¨²¬  Merge-Sort
(±®°²¨°®¢ª  ±«¨¿­¨¥¬) ¨§ ° §¤¥«  1.3.1, ¯°¨¬¥­¥­­®£® ª ¬ ±±¨¢³
¨§ 16 ½«¥¬¥­²®¢. ®·¥¬³ §¤¥±¼ ­¥² ±¬»±«  § ¯®¬¨­ ²¼ ®²¢¥²» ª
³¦¥ °¥¸¥­­»¬ ¯®¤§ ¤ · ¬?

16.3.  ¨¡®«¼¸ ¿ ®¡¹ ¿ ¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¼
®¤¯®±«¥¤®¢ ²¥«¼­®±²¼ ¯®«³· ¥²±¿ ¨§ ¤ ­­®© ¯®±«¥¤®¢ ²¥«¼­®±²¨, ¥±«¨ ³¤ «¨²¼ ­¥ª®²®°»¥ ¥¥ ½«¥¬¥­²» (± ¬  ¯®±«¥¤®¢ ²¥«¼­®±²¼
² ª¦¥ ±·¨² ¥²±¿ ±¢®¥© ¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¼¾). ®°¬ «¼­®: ¯®±«¥¤®¢ ²¥«¼­®±²¼ Z = hz1; z2 ; : : :; zk i ­ §»¢ ¥²±¿ ¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¼¾ (subsequence) ¯®±«¥¤®¢ ²¥«¼­®±²¨ X = hx1; x2; : : :; xni, ¥±«¨ ±³¹¥±²¢³¥² ±²°®£® ¢®§° ±² ¾¹ ¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¨­¤¥ª±®¢
hi1; i2; : : :; ik i, ¤«¿ ª®²®°®© zj = xij ¯°¨ ¢±¥µ j = 1; 2; : : :; k.  ¯°¨¬¥°, Z = hB; C; D; B i ¿¢«¿¥²±¿ ¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¼¾ ¯®±«¥¤®¢ ²¥«¼­®±²¨ X = hA; B; C; B; D; A; B i; ±®®²¢¥²±²¢³¾¹ ¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¨­¤¥ª±®¢ ¥±²¼ h2; 3; 5; 7i. (²¬¥²¨¬, ·²® £®¢®°¿ ® ¯®±«¥¤®¢ ²¥«¼­®±²¿µ, ¬» | ¢ ®²«¨·¨¥ ®² ª³°±®¢ ¬ ²¥¬ ²¨·¥±ª®£®
 ­ «¨§  | ¨¬¥¥¬ ¢ ¢¨¤³ ª®­¥·­»¥ ¯®±«¥¤®¢ ²¥«¼­®±²¨.)
³¤¥¬ £®¢®°¨²¼, ·²® ¯®±«¥¤®¢ ²¥«¼­®±²¼ Z ¿¢«¿¥²±¿ ®¡¹¥©
¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¼¾ (common subsequence) ¯®±«¥¤®¢ ²¥«¼­®±²¥© X ¨ Y , ¥±«¨ Z ¿¢«¿¥²±¿ ¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¼¾ ª ª X , ² ª
¨ Y . °¨¬¥°: X = hA; B; C; B; D; A; B i, Y = hB; D; C; A; B; Ai,
Z = hB; C; Ai. ®±«¥¤®¢ ²¥«¼­®±²¼ Z ¢ ½²®¬ ¯°¨¬¥°¥ | ­¥ ± ¬ ¿
¤«¨­­ ¿ ¨§ ®¡¹¨µ ¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¥© X ¨ Y (¯®±«¥¤®¢ ²¥«¼­®±²¼ hB; C; B; Ai ¤«¨­­¥¥). ®±«¥¤®¢ ²¥«¼­®±²¼ hB; C; B; Ai ¡³¤¥²
­ ¨¡®«¼¸¥© ®¡¹¥© ¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¼¾ ¤«¿ X ¨ Y , ¯®±ª®«¼ª³ ®¡¹¨µ ¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¥© ¤«¨­» 5 ³ ­¨µ ­¥².  ¨¡®«¼¸¨µ
®¡¹¨µ ¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¥© ¬®¦¥² ¡»²¼ ­¥±ª®«¼ª®.  ¯°¨¬¥°,
hB; D; A; Bi | ¤°³£ ¿ ­ ¨¡®«¼¸ ¿ ®¡¹ ¿ ¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¼ X
¨ Y.
 ¤ ·  ® ­ ¨¡®«¼¸¥© ®¡¹¥© ¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¨ (±®ª° ¹¥­­® ; ¯®- ­£«¨©±ª¨ LCS = longest-common-subsequence) ±®±²®¨² ¢ ²®¬, ·²®¡» ­ ©²¨ ®¡¹³¾ ¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¼ ­ ¨¡®«¼¸¥©
¤«¨­» ¤«¿ ¤¢³µ ¤ ­­»µ ¯®±«¥¤®¢ ²¥«¼­®±²¥© X ¨ Y .  ½²®¬ ° §¤¥«¥ ¬» ¯®ª ¦¥¬, ª ª °¥¸¨²¼ ½²³ § ¤ ·³ ± ¯®¬®¹¼¾ ¤¨­ ¬¨·¥±ª®£®
¯°®£° ¬¬¨°®¢ ­¨¿.

 ¨¡®«¼¸ ¿ ®¡¹ ¿ ¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¼

319

²°®¥­¨¥ ­ ¨¡®«¼¸¥© ®¡¹¥© ¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¨
±«¨ °¥¸ ²¼ § ¤ ·³ ®  À¢ «®¡Á, ¯¥°¥¡¨° ¿ ¢±¥ ¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¨ ¯®±«¥¤®¢ ²¥«¼­®±²¨ X ¨ ¯°®¢¥°¿¿ ¤«¿ ª ¦¤®© ¨§
­¨µ, ­¥ ¡³¤¥² «¨ ®­  ¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¼¾ ¯®±«¥¤®¢ ²¥«¼­®±²¨
Y , ²®  «£®°¨²¬ ¡³¤¥² ° ¡®² ²¼ ½ª±¯®­¥­¶¨ «¼­®¥ ¢°¥¬¿, ¯®±ª®«¼ª³ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¤«¨­» m ¨¬¥¥² 2m ¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¥©
(±²®«¼ª® ¦¥, ±ª®«¼ª® ¯®¤¬­®¦¥±²¢ ³ ¬­®¦¥±²¢  f1; 2; : : :; mg).
¤­ ª® § ¤ ·  ®  ®¡« ¤ ¥² ±¢®©±²¢®¬ ®¯²¨¬ «¼­®±²¨ ¤«¿
¯®¤§ ¤ ·, ª ª ¯®ª §»¢ ¥² ²¥®°¥¬  16.1 (±¬. ­¨¦¥). ®¤µ®¤¿¹¥¥
¬­®¦¥±²¢® ¯®¤§ ¤ · | ¬­®¦¥±²¢® ¯ ° ¯°¥´¨ª±®¢ ¤¢³µ ¤ ­­»µ
¯®±«¥¤®¢ ²¥«¼­®±²¥©. ³±²¼ X = hx1; x2; : : :; xmi | ­¥ª®²®° ¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼. ¥ ¯°¥´¨ª± (prex) ¤«¨­» i | ½²® ¯®±«¥¤®¢ ²¥«¼­®±²¼ Xi = hx1 ; x2; : : :; xii (¯°¨ i ®² 0 ¤® m).  ¯°¨¬¥°, ¥±«¨
X = hA; B; C; B; D; A; B i, ²® X4 = hA; B; C; B i,   X0 | ¯³±² ¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼.
¥®°¥¬  16.1 (® ±²°®¥­¨¨ ). ³±²¼ Z = hz1; z2; : : :; zk i |
®¤­  ¨§ ­ ¨¡®«¼¸¨µ ®¡¹¨µ ¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¥© ¤«¿
X = hx1; x2; : : :; xmi ¨ Y = hy1; y2; : : :; yni. ®£¤ :
1. ¥±«¨ xm = yn , ²® zk = xm = yn ¨ Zk;1 ¿¢«¿¥²±¿  ¤«¿ Xm;1
¨ Yn;1 ;
2. ¥±«¨ xm 6= yn ¨ zk 6= xm , ²® Z ¿¢«¿¥²±¿  ¤«¿ Xm;1 ¨ Y ;
3. ¥±«¨ xm 6= yn ¨ zk 6= yn , ²® Z ¿¢«¿¥²±¿  ¤«¿ Xm ¨ Yn;1 .
®ª § ²¥«¼±²¢®. (1) ±«¨ zk 6= xm , ²® ¬» ¬®¦¥¬ ¤®¯¨± ²¼ xm =
yn ¢ ª®­¥¶ ¯®±«¥¤®¢ ²¥«¼­®±²¨ Z ¨ ¯®«³·¨²¼ ®¡¹³¾ ¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¼ ¤«¨­» k + 1, ·²® ¯°®²¨¢®°¥·¨² ³±«®¢¨¾. ² «® ¡»²¼,
zk = xm = yn . ±«¨ ³ ¯®±«¥¤®¢ ²¥«¼­®±²¥© Xm;1 ¨ Yn;1 ¥±²¼ ¡®«¥¥
¤«¨­­ ¿ (·¥¬ Zk;1 ) ®¡¹ ¿ ¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¼, ²® ¬» ¬®¦¥¬
¤®¯¨± ²¼ ª ­¥© xm = yn ¨ ¯®«³·¨²¼ ®¡¹³¾ ¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¼
¤«¿ X ¨ Y , ¡®«¥¥ ¤«¨­­³¾, ·¥¬ Z | ¯°®²¨¢®°¥·¨¥.
(2) ®«¼ ±ª®°® zk 6= xm , ¯®±«¥¤®¢ ²¥«¼­®±²¼ Z ¿¢«¿¥²±¿ ®¡¹¥©
¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¼¾ ¤«¿ Xm;1 ¨ Y .  ª ª ª Z |  ¤«¿ X
¨ Y , ²® ®­  ²¥¬ ¡®«¥¥ ¿¢«¿¥²±¿  ¤«¿ Xm;1 ¨ Y .
(3) ­ «®£¨·­® (2).
» ¢¨¤¨¬, ·²®  ¤¢³µ ¯®±«¥¤®¢ ²¥«¼­®±²¥© ±®¤¥°¦¨² ¢ ±¥¡¥
­ ¨¡®«¼¸³¾ ®¡¹³¾ ¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¼ ¨µ ¯°¥´¨ª±®¢. ² «®
¡»²¼, § ¤ ·  ®  ®¡« ¤ ¥² ±¢®©±²¢®¬ ®¯²¨¬ «¼­®±²¨ ¤«¿ ¯®¤§ ¤ ·. ¥©· ± ¬» ³¡¥¤¨¬±¿, ·²® ¯¥°¥ª°»²¨¥ ¯®¤§ ¤ · ² ª¦¥ ¨¬¥¥²
¬¥±²®.
¥ª³°°¥­²­ ¿ ´®°¬³« 
¥®°¥¬  16.1 ¯®ª §»¢ ¥², ·²® ­ µ®¦¤¥­¨¥  ¯®±«¥¤®¢ ²¥«¼­®±²¥© X = hx1; x2; : : :; xm i ¨ Y = hy1; y2 ; : : :; yn i ±¢®¤¨²±¿ ª °¥¸¥-

320

« ¢  16 ¨­ ¬¨·¥±ª®¥ ¯°®£° ¬¬¨°®¢ ­¨¥

­¨¾ «¨¡® ®¤­®©, «¨¡® ¤¢³µ ¯®¤§ ¤ ·. ±«¨ xm = yn , ²® ¤®±² ²®·­®
­ ©²¨  ¯®±«¥¤®¢ ²¥«¼­®±²¥© Xm;1 ¨ Yn;1 ¨ ¤®¯¨± ²¼ ª ­¥© ¢
ª®­¶¥ xm = yn . ±«¨ ¦¥ xm 6= yn , ²® ­ ¤® °¥¸¨²¼ ¤¢¥ ¯®¤§ ¤ ·¨:
­ ©²¨  ¤«¿ Xm;1 ¨ Y ,   § ²¥¬ ­ ©²¨  ¤«¿ X ¨ Yn;1 . ®«¥¥
¤«¨­­ ¿ ¨§ ­¨µ ¨ ¡³¤¥² ±«³¦¨²¼  ¤«¿ X ¨ Y .
¥¯¥°¼ ±° §³ ¢¨¤­®, ·²® ¢®§­¨ª ¥² ¯¥°¥ª°»²¨¥ ¯®¤§ ¤ ·. ¥©±²¢¨²¥«¼­®, ·²®¡» ­ ©²¨  X ¨ Y , ­ ¬ ¬®¦¥² ¯®­ ¤®¡¨²¼±¿
­ ©²¨  Xm;1 ¨ Y ,   ² ª¦¥  X ¨ Yn;1 ; ª ¦¤ ¿ ¨§ ½²¨µ § ¤ · ±®¤¥°¦¨² ¯®¤§ ¤ ·³ ­ µ®¦¤¥­¨¿  ¤«¿ Xm;1 ¨ Yn;1 . ­ «®£¨·­»¥ ¯¥°¥ª°»²¨¿ ¡³¤³² ¢±²°¥· ²¼±¿ ¨ ¤ «¥¥.
 ª ¨ ¢ § ¤ ·¥ ¯¥°¥¬­®¦¥­¨¿ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¬ ²°¨¶, ¬»
­ ·­¥¬ ± °¥ª³°°¥­²­®£® ±®®²­®¸¥­¨¿ ¤«¿ ±²®¨¬®±²¨ ®¯²¨¬ «¼­®£® °¥¸¥­¨¿. ³±²¼ c[i; j ] ®¡®§­ · ¥² ¤«¨­³  ¤«¿ ¯®±«¥¤®¢ ²¥«¼­®±²¥© Xi ¨ Yj . ±«¨ i ¨«¨ j ° ¢­® ­³«¾, ²® ®¤­  ¨§ ¤¢³µ ¯®±«¥¤®¢ ²¥«¼­®±²¥© ¯³±² , ² ª ·²® c[i; j ] = 0. ª § ­­®¥ ¢»¸¥ ¬®¦­®
§ ¯¨± ²¼ ² ª:
8
>
¥±«¨ i = 0 ¨«¨ j = 0,
< 0
c[i; j ] = > c[i ; 1; j ; 1] + 1
¥±«¨ i; j > 0 ¨ xi = yj ,
:
max(c[i; j ; 1]; c[i ; 1; j ]); ¥±«¨ i; j > 0 ¨ xi 6= yj .
(16.5)
»·¨±«¥­¨¥ ¤«¨­» 
±µ®¤¿ ¨§ ±®®²­®¸¥­¨¿ (16.5), «¥£ª® ­ ¯¨± ²¼ °¥ª³°±¨¢­»©  «£®°¨²¬, ° ¡®² ¾¹¨© ½ª±¯®­¥­¶¨ «¼­®¥ ¢°¥¬¿ ¨ ¢»·¨±«¿¾¹¨© ¤«¨­³
 ¤¢³µ ¤ ­­»µ ¯®±«¥¤®¢ ²¥«¼­®±²¥©. ® ¯®±ª®«¼ª³ ° §«¨·­»µ
¯®¤§ ¤ · ¢±¥£® (mn), «³·¸¥ ¢®±¯®«¼§®¢ ²¼±¿ ¤¨­ ¬¨·¥±ª¨¬ ¯°®£° ¬¬¨°®¢ ­¨¥¬.
±µ®¤­»¬¨ ¤ ­­»¬¨ ¤«¿  «£®°¨²¬  LCS-Length ±«³¦ ² ¯®±«¥¤®¢ ²¥«¼­®±²¨ X = hx1; x2; : : :; xmi ¨ Y = hy1; y2 ; : : :; yn i. ¨±« 
c[i; j ] § ¯¨±»¢ ¾²±¿ ¢ ² ¡«¨¶³ c[0 : :m; 0 : :n] ¢ ² ª®¬ ¯®°¿¤ª¥: ±­ · «  § ¯®«­¿¥²±¿ ±«¥¢  ­ ¯° ¢® ¯¥°¢ ¿ ±²°®ª , § ²¥¬ ¢²®° ¿, ¨ ². ¤.
°®¬¥ ²®£®,  «£®°¨²¬ § ¯®¬¨­ ¥² ¢ ² ¡«¨¶¥ b[1 : :m; 1 : :n] À¯°®¨±µ®¦¤¥­¨¥Á c[i; j ]: ¢ ª«¥²ª³ b[i; j ] § ­®±¨²±¿ ±²°¥«ª , ³ª §»¢ ¾¹ ¿ ­ 
ª«¥²ª³ ± ª®®°¤¨­ ² ¬¨ (i ; 1; j ; 1), (i ; 1; j ) ¨«¨ (i; j ; 1), ¢ § ¢¨±¨¬®±²¨ ®² ²®£®, ° ¢­® «¨ c[i; j ] ·¨±«³ c[i ; 1; j ; 1] + 1, c[i ; 1; j ] ¨«¨
c[i; j ; 1] (±¬. (16.5)). ¥§³«¼² ² ¬¨ ° ¡®²»  «£®°¨²¬  ¿¢«¿¾²±¿
² ¡«¨¶» c ¨ b.

 ¨¡®«¼¸ ¿ ®¡¹ ¿ ¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¼

¨±. 16.3

321

 ¡«¨¶» c ¨ b, ±®§¤ ­­»¥  «£®°¨²¬®¬ LCS-Length ¯°¨ X =

hA; B; C; B; D; A;B i ¨ Y = hB; D;C; A; B; Ai.  ª«¥²ª¥ ± ª®®°¤¨­ ² ¬¨ (i; j )

§ ¯¨± ­» ·¨±«® c[i; j ] ¨ ±²°¥«ª  b[i; j ]. ¨±«® 4 ¢ ¯° ¢®© ­¨¦­¥© ª«¥²ª¥ ¥±²¼
¤«¨­  . °¨ i; j > 0 §­ ·¥­¨¥ c[i; j ] ®¯°¥¤¥«¿¥²±¿ ²¥¬, ° ¢­» «¨ xi ¨ yj , ¨
¢»·¨±«¥­­»¬¨ ° ­¥¥ §­ ·¥­¨¿¬¨ c[i ; 1; j ], c[i;j ; 1] ¨ c[i ; 1; j ; 1]. ³²¼ ¯®
±²°¥«ª ¬, ¢¥¤³¹¨© ¨§ c[7; 6], § ¸²°¨µ®¢ ­.  ¦¤ ¿ ª®± ¿ ±²°¥«ª  ­  ½²®¬ ¯³²¨
±®®²¢¥²±²¢³¥² ½«¥¬¥­²³  (½²¨ ½«¥¬¥­²» ¢»¤¥«¥­»).

LCS-Length(X; Y )

1 m length[X ]
2 n length[Y ]
3 for i 1 to m
4
do c[i; 0] 0
5 for j 0 to n
6
do c[0; j ] 0
7 for i 1 to m
8
do for j 1 to n
9
do if xi = yj
10
then c[i; j ] c[i ; 1; j ; 1] + 1
11
b[i; j ] À-Á
12
else if c[i ; 1; j ] > c[i; j ; 1]
13
then c[i; j ] c[i ; 1; j ]
14
b[i; j ] À"Á
15
else c[i; j ] c[i; j ; 1]
16
b[i; j ] À Á
17 return c, b
  °¨±. 16.3 ¯®ª § ­  ° ¡®²  LCS-Length ¤«¿ X =
hA; B; C; B; D; A; Bi ¨ Y = hB; D; C; A; B; Ai.
«£®°¨²¬ LCS-Length ²°¥¡³¥² ¢°¥¬¥­¨ O(mn): ­  ª ¦¤³¾
ª«¥²ª³ ²°¥¡³¥²±¿ O(1) ¸ £®¢.

322

« ¢  16 ¨­ ¬¨·¥±ª®¥ ¯°®£° ¬¬¨°®¢ ­¨¥

®±²°®¥­¨¥ 
 ¡«¨¶  b, ±®§¤ ­­ ¿ ¯°®¶¥¤³°®© LCS-Length, ¯®§¢®«¿¥² ¡»±²°® ­ ©²¨  ¯®±«¥¤®¢ ²¥«¼­®±²¥© X = hx1; x2; : : :; xmi ¨
Y = hy1; y2; : : :; yni. «¿ ½²®£® ­ ¤® ¯°®©²¨ ¯® ¯³²¨, ³ª § ­­®¬³ ±²°¥«ª ¬¨, ­ ·¨­ ¿ ± b[m; n]. °®©¤¥­­ ¿ ±²°¥«ª  - ¢ ª«¥²ª¥ (i; j ) ®§­ · ¥², ·²® xi = yj ¢µ®¤¨² ¢ ­ ¨¡®«¼¸³¾ ®¡¹³¾
¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¼. ®² ª ª ½²® °¥ «¨§®¢ ­® ¢ °¥ª³°±¨¢­®©
¯°®¶¥¤³°¥ Print-LCS ( ¤«¿ X ¨ Y ¯¥· ² ¥²±¿ ¯°¨ ¢»§®¢¥
Print-LCS(b; X; length[X ]; length[Y ])):
Print-LCS(b; X; i; j )
1 if i = 0 ¨«¨ j = 0
2 then return
3 if b[i; j ] = À-Á
4 then Print-LCS(b; X; i ; 1; j ; 1)
5
­ ¯¥· ² ²¼ xi
6 elseif b[i; j ] = À"Á
7 then Print-LCS(b; X; i ; 1; j )
8 else Print-LCS(b; X; i; j ; 1)
³¤³·¨ ¯°¨¬¥­¥­­®© ª ² ¡«¨¶¥ °¨±. 16.3, ½²  ¯°®¶¥¤³°  ­ ¯¥· ² ¥² BCBA. °¥¬¿ ° ¡®²» ¯°®¶¥¤³°» ¥±²¼ O(m + n), ¯®±ª®«¼ª³ ­ 
ª ¦¤®¬ ¸ £¥ µ®²¿ ¡» ®¤­® ¨§ ·¨±¥« m ¨ n ³¬¥­¼¸ ¥²±¿.
«³·¸¥­¨¥  «£®°¨²¬ 
®±«¥ ²®£®, ª ª  «£®°¨²¬ ° §° ¡®² ­, ­¥°¥¤ª® ³¤ ¥²±¿ ±¤¥« ²¼
¥£® ¡®«¥¥ ½ª®­®¬­»¬.  ­ ¸¥¬ ¯°¨¬¥°¥ ¬®¦­® ®¡®©²¨±¼ ¡¥§ ² ¡«¨¶» b.  ± ¬®¬ ¤¥«¥, ª ¦¤®¥ ¨§ ·¨±¥« c[i; j ] § ¢¨±¨² ®² c[i ; 1; j ],
c[i; j ; 1] ¨ c[i ; 1; j ; 1]. ­ ¿ c[i; j ], ¬» ¬®¦¥¬ §  ¢°¥¬¿ O(1) ¢»¿±­¨²¼, ª ª ¿ ¨§ ½²¨µ ²°¥µ § ¯¨±¥© ¨±¯®«¼§®¢ « ±¼. ¥¬ ± ¬»¬ ¬®¦­® ­ ©²¨  §  ¢°¥¬¿ O(m + n) ± ¯®¬®¹¼¾ ®¤­®© ²®«¼ª® ² ¡«¨¶» c (¢ ³¯° ¦­¥­¨¨ 16.3-2 ¬» ¯®¯°®±¨¬ ¢ ± ½²® ±¤¥« ²¼). °¨ ½²®¬
¬» ½ª®­®¬¨¬ (mn) ¯ ¬¿²¨. (¯°®·¥¬,  ±¨¬¯²®²¨ª  ­¥ ¬¥­¿¥²±¿:
®¡º¥¬ ² ¡«¨¶» c ¥±²¼ ² ª¦¥ (mn).)
±«¨ ­ ± ¨­²¥°¥±³¥² ²®«¼ª® ¤«¨­  ­ ¨¡®«¼¸¥© ®¡¹¥© ¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¨, ²® ±²®«¼ª® ¯ ¬¿²¨ ­¥ ­³¦­®: ¢»·¨±«¥­¨¥ c[i; j ] § ²° £¨¢ ¥² ²®«¼ª® ¤¢¥ ±²°®ª¨ ± ­®¬¥° ¬¨ i ¨ i ; 1 (½²® ­¥ ¯°¥¤¥«
½ª®­®¬¨¨: ¬®¦­® ®¡®©²¨±¼ ¯ ¬¿²¼¾ ­  ®¤­³ ±²°®ª³ ² ¡«¨¶» c ¯«¾±
¥¹¥ ·³²¼-·³²¼, ±¬. ³¯° ¦­¥­¨¥ 16.3-4). °¨ ½²®¬, ®¤­ ª®, ± ¬³ ¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¼ ­ ©²¨ (§  ¢°¥¬¿ O(m + n)) ­¥ ³¤ ¥²±¿.

¯²¨¬ «¼­ ¿ ²°¨ ­£³«¿¶¨¿ ¬­®£®³£®«¼­¨ª 

323

¯° ¦­¥­¨¿
16.3-1  ©¤¨²¥  ¯®±«¥¤®¢ ²¥«¼­®±²¥© h1; 0; 0; 1; 0; 1; 0; 1i ¨
h0; 1; 0; 1; 1; 0; 1; 1; 0i.
16.3-2  §° ¡®² ©²¥  «£®°¨²¬, ±²°®¿¹¨©  ¤«¿ X =
hx1; x2; : : :; xmi ¨ Y = hy1; y2; : : :; yni §  ¢°¥¬¿ O(m + n), ¨±µ®¤¿ ²®«¼ª® ¨§ ² ¡«¨¶» c.
16.3-3  §° ¡®² ©²¥ °¥ª³°±¨¢­»© ¢ °¨ ­²  «£®°¨²¬  LCSLength ± § ¯®¬¨­ ­¨¥¬ ®²¢¥²®¢, ²°¥¡³¾¹¨© ¢°¥¬¥­¨ O(mn).
16.3-4 ®ª ¦¨²¥, ª ª ¬®¦­® ¢»·¨±«¨²¼ ¤«¨­³ , ¨±¯®«¼§³¿
¯ ¬¿²¼ ° §¬¥°  2 min(m; n) + O(1) ¨ µ° ­¿ «¨¸¼ · ±²¼ ² ¡«¨¶» c.
 ª ª ½²® ±¤¥« ²¼, ¨±¯®«¼§³¿ ¯ ¬¿²¼ min(m; n) + O(1)?
16.3-5  §° ¡®² ©²¥  «£®°¨²¬, ­ µ®¤¿¹¨© ­ ¨¡®«¼¸³¾ ¢®§° ±² ¾¹³¾ ¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¼ ¤ ­­®© ¯®±«¥¤®¢ ²¥«¼­®±²¨
¨§ n ·¨±¥« ¨ ° ¡®² ¾¹¨© §  ¢°¥¬¿ O(n2 ).
16.3-6?  §° ¡®² ©²¥  «£®°¨²¬, °¥¸ ¾¹¨© ¯°¥¤»¤³¹³¾ § ¤ ·³
§  ¢°¥¬¿ O(n log n). (ª § ­¨¥. ° ­¨¬ ¤«¿ ª ¦¤®£® i ­ ¨¬¥­¼¸¨© ¨§ ¯®±«¥¤­¨µ ½«¥¬¥­²®¢ ¢®§° ±² ¾¹¨µ ¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¥© ¤«¨­» i.  ª ¬¥­¿¾²±¿ ½²¨ ·¨±«  ¯°¨ ¤®¡ ¢«¥­¨¨ ­®¢®£® ½«¥¬¥­² ?)

16.4. ¯²¨¬ «¼­ ¿ ²°¨ ­£³«¿¶¨¿ ¬­®£®³£®«¼­¨ª 
¥±¬®²°¿ ­  ±¢®¾ £¥®¬¥²°¨·¥±ª³¾ ´®°¬³«¨°®¢ª³, ½²  § ¤ · 
®·¥­¼ ¡«¨§ª  ª § ¤ ·¥ ® ¯¥°¥¬­®¦¥­¨¨ ¬ ²°¨¶.
­®£®³£®«¼­¨ª (polygon) | ½²® § ¬ª­³² ¿ ª°¨¢ ¿ ­  ¯«®±ª®±²¨,
±®±² ¢«¥­­ ¿ ¨§ ®²°¥§ª®¢, ­ §»¢ ¥¬»µ ±²®°®­ ¬¨ (sides) ¬­®£®³£®«¼­¨ª . ®·ª , ¢ ª®²®°®© ±µ®¤¿²±¿ ¤¢¥ ±®±¥¤­¨¥ ±²®°®­», ­ §»¢ ¥²±¿ ¢¥°¸¨­®© (vertex). ¥± ¬®¯¥°¥±¥ª ¾¹¨©±¿ ¬­®£®³£®«¼­¨ª
(²®«¼ª® ² ª¨¥ ¬» ¨ ¡³¤¥¬, ª ª ¯° ¢¨«®, ° ±±¬ ²°¨¢ ²¼) ­ §»¢ ¥²±¿ ¯°®±²»¬ (simple). ­®¦¥±²¢® ²®·¥ª ¯«®±ª®±²¨, «¥¦ ¹¨µ ¢­³²°¨ ¯°®±²®£® ¬­®£®³£®«¼­¨ª , ­ §»¢ ¥²±¿ ¢­³²°¥­­®±²¼¾ (interior) ¬­®£®³£®«¼­¨ª , ®¡º¥¤¨­¥­¨¥ ¥£® ±²®°®­ ­ §»¢ ¥²±¿ ¥£® £° ­¨¶¥© (boundary),   ¬­®¦¥±²¢® ¢±¥µ ®±² «¼­»µ ²®·¥ª ¯«®±ª®±²¨
­ §»¢ ¥²±¿ ¥£® ¢­¥¸­®±²¼¾ (exterior). °®±²®© ¬­®£®³£®«¼­¨ª ­ §»¢ ¥²±¿ ¢»¯³ª«»¬ (convex), ¥±«¨ ¤«¿ «¾¡»µ ¤¢³µ ²®·¥ª, «¥¦ ¹¨µ
¢­³²°¨ ¨«¨ ­  £° ­¨¶¥ ¬­®£®³£®«¼­¨ª , ±®¥¤¨­¿¾¹¨© ¨µ ®²°¥§®ª
¶¥«¨ª®¬ «¥¦¨² ¢­³²°¨ ¨«¨ ­  £° ­¨¶¥ ¬­®£®³£®«¼­¨ª .
»¯³ª«»© ¬­®£®³£®«¼­¨ª ¬®¦­® § ¤ ²¼, ¯¥°¥·¨±«¨¢ ¥£® ¢¥°¸¨­» ¯°®²¨¢ · ±®¢®© ±²°¥«ª¨: ¬­®£®³£®«¼­¨ª P = hv0 ; v1; : : :; vn;1 i

324

« ¢  16 ¨­ ¬¨·¥±ª®¥ ¯°®£° ¬¬¨°®¢ ­¨¥

¢¥ ²°¨ ­£³«¿¶¨¨ ¢»¯³ª«®£® ±¥¬¨³£®«¼­¨ª .  ¦¤ ¿ ¤¥«¨² ±¥¬¨³£®«¼­¨ª ­  7 ; 2 = 5 ²°¥³£®«¼­¨ª®¢ ± ¯®¬®¹¼¾ 7 ; 3 = 4 ¤¨ £®­ «¥©.
¨±. 16.4

¨¬¥¥² n ±²®°®­ v0 v1 , v1 v2 ; : : :; vn;1vn . ¤¥±¼ vn | ²® ¦¥ ± ¬®¥, ·²®
v0 (³¤®¡­® ­³¬¥°®¢ ²¼ ¢¥°¸¨­» n-³£®«¼­¨ª  ¢»·¥² ¬¨ ¯® ¬®¤³«¾ n).
±«¨ vi ¨ vj | ¤¢¥ ¢¥°¸¨­», ­¥ ¿¢«¿¾¹¨¥±¿ ±®±¥¤­¨¬¨, ®²°¥§®ª vi vj ­ §»¢ ¥²±¿ ¤¨ £®­ «¼¾ (chord) ¬­®£®³£®«¼­¨ª . ¨ £®­ «¼ vi vj ° §¡¨¢ ¥² ¬­®£®³£®«¼­¨ª ­  ¤¢ : hvi ; vi+1; : : :; vj i ¨
hvj ; vj+1; : : :; vii. °¨ ­£³«¿¶¨¿ (triangulation) ¬­®£®³£®«¼­¨ª  |
½²® ­ ¡®° ¤¨ £®­ «¥©, ° §°¥§ ¾¹¨µ ¬­®£®³£®«¼­¨ª ­  ²°¥³£®«¼­¨ª¨; ±²®°®­ ¬¨ ½²¨µ ²°¥³£®«¼­¨ª®¢ ¿¢«¿¾²±¿ ±²®°®­» ¨±µ®¤­®£®
¬­®£®³£®«¼­¨ª  ¨ ¤¨ £®­ «¨ ²°¨ ­£³«¿¶¨¨.
  °¨±. 16.4 ¨§®¡° ¦¥­» ¤¢¥ ²°¨ ­£³«¿¶¨¨ ±¥¬¨³£®«¼­¨ª . (°¨ ­£³«¿¶¨¾ ¬®¦­® ² ª¦¥ ®¯°¥¤¥«¨²¼ ª ª ¬ ª±¨¬ «¼­®¥ ¬­®¦¥±²¢®
¤¨ £®­ «¥©, ­¥ ¯¥°¥±¥ª ¾¹¨µ ¤°³£ ¤°³£ .)
® ¢±¥µ ²°¨ ­£³«¿¶¨¿µ n-³£®«¼­¨ª  ®¤­® ¨ ²® ¦¥ ·¨±«® ²°¥³£®«¼­¨ª®¢ (±³¬¬  ¢±¥µ ³£«®¢ ¬­®£®³£®«¼­¨ª  ° ¢­  ¯°®¨§¢¥¤¥­¨¾ 180
¨ ·¨±«  ²°¥³£®«¼­¨ª®¢ ¢ ²°¨ ­£³«¿¶¨¨),   ¨¬¥­­® n ; 2. °¨ ½²®¬
¨±¯®«¼§³¾²±¿ n ; 3 ¤¨ £®­ «¨ (¯°®¢®¤¿ ¤¨ £®­ «¼, ¬» ³¢¥«¨·¨¢ ¥¬
·¨±«® · ±²¥© ­  1).
 ¤ ·  ®¡ ®¯²¨¬ «¼­®© ²°¨ ­£³«¿¶¨¨ (optimal triangulation problem) ±®±²®¨² ¢ ±«¥¤³¾¹¥¬.  ­ ¢»¯³ª«»© ¬­®£®³£®«¼­¨ª P =
hv0; v1; : : :; vn;1i ¨ ¢¥±®¢ ¿ ´³­ª¶¨¿ w, ®¯°¥¤¥«¥­­ ¿ ­  ¬­®¦¥±²¢¥
²°¥³£®«¼­¨ª®¢ ± ¢¥°¸¨­ ¬¨ ¢ ¢¥°¸¨­ µ P . °¥¡³¥²±¿ ­ ©²¨ ²°¨ ­£³«¿¶¨¾, ¤«¿ ª®²®°®© ±³¬¬  ¢¥±®¢ ²°¥³£®«¼­¨ª®¢ ¡³¤¥² ­ ¨¬¥­¼¸¥©.
±²¥±²¢¥­­»© ¯°¨¬¥° ¢¥±®¢®© ´³­ª¶¨¨ | ´³­ª¶¨¿

w(4vivj vk ) = jvi vj j + jvj vk j + jvk vi j;
£¤¥ jvi vj j ®¡®§­ · ¥² (¥¢ª«¨¤®¢®) ° ±±²®¿­¨¥ ¬¥¦¤³ vi ¨ vj . »
¯®±²°®¨¬  «£®°¨²¬ °¥¸¥­¨¿ ½²®© § ¤ ·¨, ª®²®°»© ¯°¨¬¥­¨¬ ¤«¿

¯²¨¬ «¼­ ¿ ²°¨ ­£³«¿¶¨¿ ¬­®£®³£®«¼­¨ª 

325

16-5.3
¨±. 16.5 ¥°¥¢¼¿ ° §¡®° . ( ) ¥°¥¢® ° §¡®°  ¤«¿ ((A1 (A2 A3 ))(A4 (A5 A6 ))),
±®®²¢¥²±²¢³¾¹¥¥ ² ª¦¥ ²°¨ ­£³«¿¶¨¨ ­  °¨±. 16.4 . (¡) ®®²¢¥²±²¢¨¥ ¬¥¦¤³
²°¨ ­£³«¿¶¨¥© ¬­®£®³£®«¼­¨ª  ¨ ¡¨­ °­»¬ ¤¥°¥¢®¬.  ²°¨¶  Ai ±®®²¢¥²±²¢³¥² ±²®°®­¥ vi;1 vi (i = 1; 2; : : : ; 6).

(¢) °¨ ­£³«¿¶¨¿ ¨ ±®®²¢¥²±²¢³¾¹ ¿ ¥© ° ±±² ­®¢ª  ±ª®¡®ª.
«¾¡®© ¢¥±®¢®© ´³­ª¶¨¨.
°¨ ­£³«¿¶¨¨ ¨ ° ±±² ­®¢ª¨ ±ª®¡®ª

³¹¥±²¢³¥² ³¤¨¢¨²¥«¼­ ¿ ±¢¿§¼ ¬¥¦¤³ ²°¨ ­£³«¿¶¨¿¬¨ ¬­®£®³£®«¼­¨ª  ¨ ° ±±² ­®¢ª ¬¨ ±ª®¡®ª (±ª ¦¥¬, ¢ ¯°®¨§¢¥¤¥­¨¨ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¬ ²°¨¶). °®¹¥ ¢±¥£® ®¡º¿±­¨²¼ ½²³ ±¢¿§¼ ± ¯®¬®¹¼¾ ¤¥°¥¢¼¥¢.
®«­®© ° ±±² ­®¢ª¥ ±ª®¡®ª ±®®²¢¥²±²¢³¥² ² ª ­ §»¢ ¥¬®¥ ¤¥°¥¢® ° §¡®°  (parse tree) ¢»° ¦¥­¨¿.   °¨±. 16.5  ¨§®¡° ¦¥­® ¤¥°¥¢®
° §¡®°  ¤«¿
((A1(A2 A3 ))(A4(A5A6 ))):

(16.6)

 ¥£® «¨±²¼¿µ ±²®¿² ¬ ²°¨¶»-±®¬­®¦¨²¥«¨,   ¢ ¢¥°¸¨­ µ | ¨µ
¯°®¨§¢¥¤¥­¨¿: ¢ ª ¦¤®© ¢¥°¸¨­¥ ±²®¨² ¯°®¨§¢¥¤¥­¨¥ ¤¢³µ ¢»° ¦¥­¨©, ±²®¿¹¨µ ¢ ¥¥ ¤¥²¿µ.
°¨ ­£³«¿¶¨¾ ¢»¯³ª«®£® ¬­®£®³£®«¼­¨ª  hv0; v1; : : :; vn;1 i ² ª¦¥ ¬®¦­® ¨§®¡° §¨²¼ ¢ ¢¨¤¥ ¤¥°¥¢ . ¨±²¼¿¬¨ ¥£® ¡³¤³² ±²®°®­»
¬­®£®³£®«¼­¨ª  (ª°®¬¥ v0 vn;1 ). ±² «¼­»¥ ¢¥°¸¨­» | ½²® ¤¨ £®­ «¨ ²°¨ ­£³«¿¶¨¨ ¯«¾± ±²®°®­  v0 vn;1 ; ½²³ ¯®±«¥¤­¾¾ ®¡º¿¢¨¬
ª®°­¥¬.
®±²°®¥­¨¥ ¤¥°¥¢  (­  ¯°¨¬¥°¥ ²°¨ ­£³«¿¶¨¨ °¨±. 16.5a) ¯®ª § ­® ­  °¨±. 16.5¡. «¿ ­ · «  ¬» ±¬®²°¨¬, ¢ ª ª®© ²°¥³£®«¼­¨ª
¯®¯ « ª®°¥­¼ v0 vn;1 .  ­ ¸¥¬ ±«³· ¥ ½²® 4v0v3 v6 . ¥²¼¬¨ ª®°­¿

326

« ¢  16 ¨­ ¬¨·¥±ª®¥ ¯°®£° ¬¬¨°®¢ ­¨¥

¡³¤¥¬ ±·¨² ²¼ ¤¢¥ ¤°³£¨¥ ±²®°®­» ½²®£® ²°¥³£®«¼­¨ª . °¨ ­£³«¿¶¨¿ ±®±²®¨² ¨§ ½²®£® ²°¥³£®«¼­¨ª  ¨ ¤¢³µ ²°¨ ­£³«¿¶¨© ®±² ¢¸¨µ±¿ · ±²¥© (hv0; v1; v2; v3i ¨ hv3; v4; v5; v6i, °¨±. 16.5¡), ¯°¨·¥¬ ¤¨ £®­ «¨, ¿¢«¿¾¹¨¥±¿ ¤¥²¼¬¨ ª®°­¿, ¿¢«¿¾²±¿ ±²®°®­ ¬¨ ½²¨µ ¬­®£®³£®«¼­¨ª®¢ (v0v3 ¨ v3 v6 ­  °¨±. 16.5¡). ®¢²®°¨¬ ¤«¿ ª ¦¤®©
¨§ ­¨µ ²³ ¦¥ ª®­±²°³ª¶¨¾: ° ±±¬®²°¨¬ ²°¥³£®«¼­¨ª ²°¨ ­£³«¿¶¨¨ ­®¢®£® ¬­®£®³£®«¼­¨ª , ±®¤¥°¦ ¹¨© ¢»¤¥«¥­­³¾ ±²®°®­³, ¤¢¥
¤°³£¨¥ ±²®°®­» ½²®£® ²°¥³£®«¼­¨ª  ®¡º¿¢¨¬ ¥¥ ¤¥²¼¬¨ ¨ ². ¤. 
ª®­¶¥ ª®­¶®¢ ¬» ¯°¨¤¥¬ ª ¡¨­ °­®¬³ ¤¥°¥¢³ ± n ; 1 «¨±²®¬. ¥©±²¢³¿ ¢ ®¡° ²­®¬ ¯®°¿¤ª¥, ¬®¦­® ¯® ¡¨­ °­®¬³ ¤¥°¥¢³ ¯®±²°®¨²¼
²°¨ ­£³«¿¶¨¾. ®±²°®¥­­®¥ ±®®²¢¥²±²¢¨¥ ¬¥¦¤³ ²°¨ ­£³«¿¶¨¿¬¨
¨ ¡¨­ °­»¬¨ ¤¥°¥¢¼¿¬¨ ¿¢«¿¥²±¿ ¢§ ¨¬­® ®¤­®§­ ·­»¬.
±¯®¬¨­ ¿, ·²® ¯®«­»¥ ° ±±² ­®¢ª¨ ±ª®¡®ª ¢ ¯°®¨§¢¥¤¥­¨¨ n ±®¬­®¦¨²¥«¥© ­ µ®¤¿²±¿ ¢® ¢§ ¨¬­® ®¤­®§­ ·­®¬ ±®®²¢¥²±²¢¨¨ ± ¡¨­ °­»¬¨ ¤¥°¥¢¼¿¬¨ ± n «¨±²¼¿¬¨, ¯®«³· ¥¬ ¢§ ¨¬­® ®¤­®§­ ·­®¥
±®®²¢¥²±²¢¨¥ ¬¥¦¤³ ¯®«­»¬¨ ° ±±² ­®¢ª ¬¨ ±ª®¡®ª ¢ ¯°®¨§¢¥¤¥­¨¨ n ¬ ²°¨¶ ¨ ²°¨ ­£³«¿¶¨¿¬¨ (n + 1)-³£®«¼­¨ª . °¨ ½²®¬ ¬ ²°¨¶  Ai ¢ ¯°®¨§¢¥¤¥­¨¨ A1 A2 : : :An ±®®²¢¥²±²¢³¥² ±²®°®­¥ vi;1 vi ,
  ¤¨ £®­ «¼ vi;1 vj (1 6 i < j 6 n) ±®®²¢¥²±²¢³¥² ¯°®¨§¢¥¤¥­¨¾
Ai::j .
²® ±®®²¢¥²±²¢¨¥ ¬®¦­® ¯®­¿²¼ ¨ ¡¥§ ¤¥°¥¢¼¥¢.  ¯¨¸¥¬ ­  ¢±¥µ
±²®°®­ µ ²°¨ ­£³«¨°®¢ ­­®£® ¬­®£®³£®«¼­¨ª , ª°®¬¥ ®¤­®©, ¯®
±®¬­®¦¨²¥«¾.  «¥¥ ¯®±²³¯ ¥¬ ² ª: ¥±«¨ ¢ ²°¥³£®«¼­¨ª¥ ¤¢¥ ±²®°®­» ³¦¥ ¯®¬¥·¥­», ²® ­  ²°¥²¼¥© ¬» ¯¨¸¥¬ ¨µ ¯°®¨§¢¥¤¥­¨¥.  
¯¥°¢®­ · «¼­® ­¥¯®¬¥·¥­­®© ±²®°®­¥ ¯®¿¢¨²±¿ ¯®«­ ¿ ° ±±² ­®¢ª 
±ª®¡®ª (±¬. ¯°¨¬¥° ­  °¨±. 16.5¢).
 ¬¥²¨¬, ·²® § ¤ ·  ® ¯¥°¥¬­®¦¥­¨¨ ¬ ²°¨¶ ¿¢«¿¥²±¿ · ±²­»¬
±«³· ¥¬ § ¤ ·¨ ®¡ ®¯²¨¬ «¼­®© ²°¨ ­£³«¿¶¨¨. ³±²¼ ­ ¬ ­³¦­®
¢»·¨±«¨²¼ A1 A2 : : :An , £¤¥ Ai ¿¢«¿¥²±¿ pi;1  pi -¬ ²°¨¶¥©.  ±±¬®²°¨¬ (n + 1)-³£®«¼­¨ª P = hv0; v1; : : :; vn i ¨ ¢¥±®¢³¾ ´³­ª¶¨¾

w(4vivj vk ) = pi pj pk :
®£¤  ±²®¨¬®±²¼ ²°¨ ­£³«¿¶¨¨ ¡³¤¥² ° ¢­  ·¨±«³ ³¬­®¦¥­¨© ¯°¨
±®®²¢¥²±²¢³¾¹¥© ° ±±² ­®¢ª¥ ±ª®¡®ª.
®²¿ § ¤ ·  ® ¯¥°¥¬­®¦¥­¨¨ ¬ ²°¨¶ ¿¢«¿¥²±¿ «¨¸¼ · ±²­»¬
±«³· ¥¬ § ¤ ·¨ ®¡ ®¯²¨¬ «¼­®© ²°¨ ­£³«¿¶¨¨, ®ª §»¢ ¥²±¿, ·²®
 «£®°¨²¬ Matrix-Chain-Order ¨§ ° §¤¥«  16.1 «¥£ª® ¯°¨±¯®±®¡¨²¼ ¤«¿ °¥¸¥­¨¿ § ¤ ·¨ ® ²°¨ ­£³«¿¶¨¨.  ¤® ²®«¼ª® ¢ ¥£® § £®«®¢ª¥ § ¬¥­¨²¼ p ­  v ¨ ±²°®ª³ 9 § ¬¥­¨²¼ ­  ² ª³¾:
9
do q m[i; k] + m[k + 1; j ] + w(4vi;1vk vj )
 °¥§³«¼² ²¥ ° ¡®²»  «£®°¨²¬  m[1; n] ±² ­¥² ° ¢­»¬ ¢¥±³ ®¯²¨¬ «¼­®© ²°¨ ­£³«¿¶¨¨.

¯²¨¬ «¼­ ¿ ²°¨ ­£³«¿¶¨¿ ¬­®£®³£®«¼­¨ª 

327

²°®¥­¨¥ ®¯²¨¬ «¼­®© ²°¨ ­£³«¿¶¨¨
®ª ¦¥¬ ¯®±«¥¤­¥¥ ³²¢¥°¦¤¥­¨¥. ³±²¼ T | ®¯²¨¬ «¼­ ¿ ²°¨ ­£³«¿¶¨¿ (n + 1)-³£®«¼­¨ª  P = hv0 ; v1; : : :; vni. ¥¡°® v0 vn ¢µ®¤¨² ¢ ®¤¨­ ¨§ ²°¥³£®«¼­¨ª®¢ ²°¨ ­£³«¿¶¨¨. ³±²¼ ½²® ²°¥³£®«¼­¨ª 4v0vk vn , £¤¥ 1 6 k 6 n ; 1. ®£¤  ¢¥± ²°¨ ­£³«¿¶¨¨ T ° ¢¥­ ¢¥±³ 4v0vk vn ¯«¾± ±³¬¬  ¢¥±®¢ ²°¨ ­£³«¿¶¨© ¬­®£®³£®«¼­¨ª®¢ hv0 ; v1; : : :; vk i ¨ hvk ; vk+1 ; : : :; vn i. «¥¤®¢ ²¥«¼­®, ²°¨ ­£³«¿¶¨¨
³ª § ­­»µ ¬­®£®³£®«¼­¨ª®¢ ®¡¿§ ­» ¡»²¼ ®¯²¨¬ «¼­»¬¨, ¨ ¥±«¨
®¯²¨¬ «¼­»¥ ±²®¨¬®±²¨ ¤«¿ ² ª¨µ ¬­®£®³£®«¼­¨ª®¢ (¯°¨ ° §­»µ
k) ³¦¥ ¢»·¨±«¥­», ²® ®±² ¥²±¿ ¢»¡° ²¼ ®¯²¨¬ «¼­®¥ §­ ·¥­¨¥ k.
¥ª³°°¥­²­ ¿ ´®°¬³« 
°³£¨¬¨ ±«®¢ ¬¨, ¨¬¥¥² ¬¥±²® ±«¥¤³¾¹ ¿ °¥ª³°°¥­²­ ¿ ´®°¬³« . ³±²¼ m[i; j ] | ¢¥± ®¯²¨¬ «¼­®© ²°¨ ­£³«¿¶¨¨ ¬­®£®³£®«¼­¨ª 
hvi;1; vi; : : :; vj i, £¤¥ 1 6 i < j 6 n. ¥± ®¯²¨¬ «¼­®© ²°¨ ­£³«¿¶¨¨
¢±¥£® ¬­®£®³£®«¼­¨ª  ° ¢¥­ m[1; n]. ³¤¥¬ ±·¨² ²¼, ·²® À¤¢³³£®«¼­¨ª¨Á hvi;1 ; vii ¨¬¥¾² ¢¥± 0. ®£¤  m[i; i] = 0 ¤«¿ i = 1; 2; : : :; n.
±«¨ j ; i > 1, ²® ³ ¬­®£®³£®«¼­¨ª  hvi;1 ; vi; : : :; vj i ¨¬¥¥²±¿ ­¥
¬¥­¥¥ ²°¥µ ¢¥°¸¨­, ¨ ­ ¬ ­¥®¡µ®¤¨¬® ­ ©²¨ ¬¨­¨¬³¬ (¯® ¢±¥¬ k
¨§ ¯°®¬¥¦³²ª  i 6 k 6 j ; 1) ² ª®© ±³¬¬»: ¢¥± 4vi;1vk vj , ¯«¾± ¢¥±
®¯²¨¬ «¼­®© ²°¨ ­£³«¿¶¨¨ hvi;1 ; vi ; : : :; vk i, ¯«¾± ¢¥± ®¯²¨¬ «¼­®©
²°¨ ­£³«¿¶¨¨ hvk ; vk+1 ; : : :; vj i. ®½²®¬³
(

m[i; j ] =

0
¯°¨ i = j ,
min
f
m
[
i;
k
]
+
m
[
k
+
1
;
j
]
+
w
(
4
v
v
v
)
g
¯°¨ i < j .
i;1 k j
i6k<j
(16.7)

¤¨­±²¢¥­­®¥ ®²«¨·¨¥ ½²®© ´®°¬³«» ®² ´®°¬³«» (16.2) | ¡®«¥¥ ®¡¹¨© ¢¨¤ ¢¥±®¢®© ´³­ª¶¨¨. ² «® ¡»²¼,  «£®°¨²¬ MatrixChain-Order ± ³ª § ­­»¬¨ ¢»¸¥ ¨§¬¥­¥­¨¿¬¨ ¢»·¨±«¿¥² ¢¥±
®¯²¨¬ «¼­®© ²°¨ ­£³«¿¶¨¨; ¢°¥¬¿ ° ¡®²» (n3 ), ®¡º¥¬ ¨±¯®«¼§³¥¬®© ¯ ¬¿²¨ (n2 ).
¯° ¦­¥­¨¿
16.4-1 ®ª ¦¨²¥, ·²® ¢±¿ª ¿ ²°¨ ­£³«¿¶¨¿ ¢»¯³ª«®£® n-³£®«¼­¨ª  ° §¡¨¢ ¥² ¥£® ­  n ; 2 ²°¥³£®«¼­¨ª  ± ¯®¬®¹¼¾ n ; 3 ¤¨ £®­ «¥©.
16.4-2 °®´¥±±®° ¯°¥¤¯®« £ ¥², ·²® ¤«¿ ±«³· ¿, ª®£¤  ¢¥± ²°¥³£®«¼­¨ª  ° ¢¥­ ¥£® ¯«®¹ ¤¨,  «£®°¨²¬ ­ µ®¦¤¥­¨¿ ®¯²¨¬ «¼­®©
²°¨ ­£³«¿¶¨¨ ¬®¦­® ³¯°®±²¨²¼. ¥ ®¡¬ ­»¢ ¥² «¨ ¥£® ¨­²³¨¶¨¿?

328

« ¢  16 ¨­ ¬¨·¥±ª®¥ ¯°®£° ¬¬¨°®¢ ­¨¥

16.4-3 ³±²¼ ¢¥±®¢ ¿ ´³­ª¶¨¿ ®¯°¥¤¥«¥­  ­  ¬­®¦¥±²¢¥ ¤¨ £®­ «¥© ¬­®£®³£®«¼­¨ª , ¨ ²°¨ ­£³«¿¶¨¿ ±·¨² ¥²±¿ ®¯²¨¬ «¼­®©, ¥±«¨
±³¬¬  ¢¥±®¢ ¢µ®¤¿¹¨µ ¢ ­¥¥ ¤¨ £®­ «¥© ¬¨­¨¬ «¼­ .  ª ±¢¥±²¨
½²³ § ¤ ·³ ª ° §®¡° ­­®© ­ ¬¨ (¢ ª®²®°®© ¢¥±  ¯°¨¯¨±»¢ «¨±¼ ­¥
¤¨ £®­ «¿¬,   ²°¥³£®«¼­¨ª ¬)?
16.4-4  ©¤¨²¥ ®¯²¨¬ «¼­³¾ ²°¨ ­£³«¿¶¨¾ ¯° ¢¨«¼­®£® ¢®±¼¬¨³£®«¼­¨ª  ­  ¥¢ª«¨¤®¢®© ¯«®±ª®±²¨ ¤«¿ ±«³· ¿, ¥±«¨ ¢¥±®¬ ²°¥³£®«¼­¨ª  ±·¨² ¥²±¿ ¥£® ¯¥°¨¬¥²°.

 ¤ ·¨
16-1 ¨²®­¨·¥±ª ¿ ¥¢ª«¨¤®¢  § ¤ ·  ª®¬¬¨¢®¿¦¥° 
¢ª«¨¤®¢  § ¤ ·  ª®¬¬¨¢®¿¦¥°  (euclidean traveling-salesman
problem) ±®±²®¨² ¢ ­ µ®¦¤¥­¨¨ ª° ²· ©¸¥£® § ¬ª­³²®£® ¯³²¨, ±®¥¤¨­¿¾¹¥£® ¤ ­­»¥ n ²®·¥ª ­  ¯«®±ª®±²¨ (±¬. ¯°¨¬¥° ­  °¨±. 16.6 ,
£¤¥ n = 7). ²  § ¤ ·  ¿¢«¿¥²±¿ NP-¯®«­®©, ² ª ·²® ¢°¿¤ «¨ ¥¥
¬®¦­® °¥¸¨²¼ §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿ (±¬. £« ¢³ 36).
¦. ¥­²«¨ ¯°¥¤«®¦¨« ³¯°®±²¨²¼ § ¤ ·³, ° ±±¬ ²°¨¢ ¿ ²®«¼ª®
¡¨²®­¨·¥±ª¨¥ ¯³²¨ (bitonic tours), ². ¥. ¯³²¨, ­ ·¨­ ¾¹¨¥±¿ ¢ ª° ©­¥© «¥¢®© ²®·ª¥, § ²¥¬ ¨¤³¹¨¥ ±«¥¢  ­ ¯° ¢® ¤® ª° ©­¥© ¯° ¢®©
²®·ª¨,   § ²¥¬ ¢®§¢° ¹ ¾¹¨¥±¿ ±¯° ¢  ­ «¥¢® ¢ ¨±µ®¤­³¾ ²®·ª³.
(  °¨±. 16.6¡ ¨§®¡° ¦¥­ ª° ²· ©¸¨© ¡¨²®­¨·¥±ª¨© ¯³²¼ ·¥°¥§
²¥ ¦¥ ±¥¬¼ ²®·¥ª). ²  § ¤ ·  ¯°®¹¥: ¯®±²°®©²¥  «£®°¨²¬ °¥¸¥­¨¿ ½²®© § ¤ ·¨, ²°¥¡³¾¹¨© ¢°¥¬¥­¨ O(n2). » ¬®¦¥²¥ ±·¨² ²¼,
·²®  ¡±¶¨±±» ¢±¥µ ²®·¥ª ° §«¨·­». (ª § ­¨¥: ¯°®±¬ ²°¨¢ ¿ ²®·ª¨
±«¥¢  ­ ¯° ¢®, µ° ­¨²¥ ¤«¿ ²¥ª³¹¥© ²®·ª¨ X ¨ ¤«¿ ¢±¥µ ¯°¥¤»¤³¹¨µ ²®·¥ª Y ¤«¨­³ ª° ²· ©¸¥£® ¯³²¨, ¡¨²®­¨·¥±ª¨ ±®¥¤¨­¿¾¹¥£®
X ± Y ± ¯°®µ®¤®¬ ·¥°¥§ ª° ©­¾¾ «¥¢³¾ ²®·ª³.)

¨±. 16.6 ¥¬¼ ²®·¥ª ­  ¯«®±ª®±²¨ ¢ ³§« µ ¥¤¨­¨·­®© °¥¸
¥²ª¨. ( ) ° ²· ©¸¨© § ¬ª­³²»© ¯³²¼ (¤«¨­»  24;88), ®¡µ®¤¿¹¨© ½²¨ ²®·ª¨. ²®² ¯³²¼ ­¥
¿¢«¿¥²±¿ ¡¨²®­¨·¥±ª¨¬. (¡) ° ²· ©¸¨© ¡¨²®­¨·¥±ª¨© ¯³²¼, ®¡µ®¤¿¹¨© ²¥ ¦¥
²®·ª¨, ¤«¨­   25;58.

 ¤ ·¨ ª £« ¢¥ 16

329

16-2  §¡¨¥­¨¥  ¡§ ¶  ­  ±²°®ª¨
¡§ ¶ ²¥ª±²  ±®±²®¨² ¨§ n ±«®¢ ¤«¨­®© l1; l2; : : :; ln (¤«¨­  ±«®¢  | ·¨±«® ±¨¬¢®«®¢ ¢ ­¥¬). ·¨² ¿, ·²® ¢±¥ ±¨¬¢®«» ¨¬¥¾² ° ¢­³¾ ¸¨°¨­³ (ª ª ­  ¯¨¸³¹¥© ¬ ¸¨­ª¥), ¬» µ®²¨¬ ®¯²¨¬ «¼­»¬
®¡° §®¬ ° §¡¨²¼ ¥£® ­  ±²°®ª¨ ¤«¨­®© ­¥ ¡®«¥¥ M ±¨¬¢®«®¢. ¯²¨¬ «¼­®±²¼ ¯°¨ ½²®¬ ®¯°¥¤¥«¿¥²±¿ ² ª: ¯®±·¨² ¥¬ ·¨±«® À«¨¸­¨µÁ
¯°®¡¥«®¢ ¢ ª ¦¤®© ±²°®ª¥ (²® ¥±²¼ ¯®±¬®²°¨¬, ­  ±ª®«¼ª® ¤«¨­ 
±²°®ª¨ ¬¥­¼¸¥ M , ¥±«¨ ¬¥¦¤³ ±«®¢ ¬¨ ±² ¢¨²¼ ¯® ®¤­®¬³ ¯°®¡¥«³) ¨ ±«®¦¨¬ ª³¡» ½²¨µ ·¨±¥« ¤«¿ ¢±¥µ ±²°®ª, ª°®¬¥ ¯®±«¥¤­¥©: ·¥¬
¡®«¼¸¥ ½²  ±³¬¬ , ²¥¬ µ³¦¥  ¡§ ¶. ±¯®«¼§³¿ ¤¨­ ¬¨·¥±ª®¥ ¯°®£° ¬¬¨°®¢ ­¨¥, ° §° ¡®² ©²¥  «£®°¨²¬ ®¯²¨¬ «¼­®£® ° §¡¨¥­¨¿
 ¡§ ¶  ­  ±²°®ª¨; ®¶¥­¨²¥ ¢°¥¬¿ ¥£® ° ¡®²» ¨ ²°¥¡³¥¬»© ®¡º¥¬
¯ ¬¿²¨.
16-3 ²®¨¬®±²¼ °¥¤ ª²¨°®¢ ­¨¿
» µ®²¨¬ ¯°¥®¡° §®¢ ²¼ ±²°®ª³ ±¨¬¢®«®¢ x[1 : :m] ¢ ­®¢³¾ ±²°®ª³ y [1 : :n] ± ¯®¬®¹¼¾ ±«¥¤³¾¹¨µ ®¯¥° ¶¨©: ¯¥°¥­®± ±¨¬¢®«  ¨§
¨±µ®¤­®© ±²°®ª¨ ¢ ­®¢³¾, ¯¥°¥­®± ¤¢³µ ±®±¥¤­¨µ ±¨¬¢®«®¢ ¨§ ¨±µ®¤­®© ±²°®ª¨ ¢ ­®¢³¾ ± ®¤­®¢°¥¬¥­­®© ¨µ ¯¥°¥±² ­®¢ª®© (À²° ­±¯®§¨¶¨¿Á), ¤®¡ ¢«¥­¨¥ ±¨¬¢®«  (±¯° ¢ ) ª ­®¢®© ±²°®ª¥, ³¤ «¥­¨¥
¯¥°¢®£® ±¨¬¢®«  ¨§ ±² °®© ±²°®ª¨, § ¬¥­  (³¤ «¥­¨¥ ±¨¬¢®«  ¨§
¨±µ®¤­®© ±²°®ª¨ ¨ ¤®¡ ¢«¥­¨¥ ¤°³£®£® ±¨¬¢®«  ¢ ­®¢³¾ ±²°®ª³),
­ ª®­¥¶, ³¤ «¥­¨¥ ®±² ²ª  ±² °®© ±²°®ª¨.
®², ­ ¯°¨¬¥°, ª ª ± ¯®¬®¹¼¾ ½²¨µ ®¯¥° ¶¨© ¯°¥®¡° §®¢ ²¼
±²°®ª³ algorithm ¢ ±²°®ª³ altruistic:
¯¥° ¶¨¿
®¢ ¿ ±²°®ª  ² ° ¿ ±²°®ª 
¯¥°¥­®± a
a
lgorithm
¯¥°¥­®± l
al
gorithm
§ ¬¥­  g ­  t
alt
orithm
³¤ «¥­¨¥ o
alt
rithm
¯¥°¥­®± r
altr
ithm
¤®¡ ¢«¥­¨¥ u
altru
ithm
¤®¡ ¢«¥­¨¥ i
altrui
ithm
¤®¡ ¢«¥­¨¥ s
altruis
ithm
²° ­±¯®§¨¶¨¿ it ¢ ti altruisti
hm
¤®¡ ¢«¥­¨¥ c
altruistic
hm
³¤ «¥­¨¥ ®±² ²ª 
altruistic
 ¦¤®© ¨§ ®¯¥° ¶¨© (À¯¥°¥­®±Á, À²° ­±¯®§¨¶¨¿Á, À¤®¡ ¢«¥­¨¥Á,
À³¤ «¥­¨¥Á, À§ ¬¥­ Á ¨ À³¤ «¥­¨¥ ®±² ²ª Á) ¯°¨¯¨± ­  ±²®¨¬®±²¼
(¬» ¯°¥¤¯®« £ ¥¬, ·²® ±²®¨¬®±²¼ § ¬¥­» ¬¥­¼¸¥, ·¥¬ ±³¬¬ °­ ¿
±²®¨¬®±²¼ ¤®¡ ¢«¥­¨¿ ¨ ³¤ «¥­¨¿, ¨­ ·¥ § ¬¥­  ¡»«  ¡» «¨¸­¥©).

330

« ¢  16 ¨­ ¬¨·¥±ª®¥ ¯°®£° ¬¬¨°®¢ ­¨¥

 ­ ¸¥¬ ¯°¨¬¥°¥ ±²®¨¬®±²¼ ¯°¥®¡° §®¢ ­¨¿ ° ¢­ 
3  ±²®¨¬®±²¼ ¯¥°¥­®±  + ±²®¨¬®±²¼ § ¬¥­» +
+ ±²®¨¬®±²¼ ³¤ «¥­¨¿ + 4  ±²®¨¬®±²¼ ¤®¡ ¢«¥­¨¿ +
+ ±²®¨¬®±²¼ ²° ­±¯®§¨¶¨¨ + ±²®¨¬®±²¼ ³¤ «¥­¨¿ ®±² ²ª :
³±²¼ ¤ ­» ¯®±«¥¤®¢ ²¥«¼­®±²¨ x[1 : :m] ¨ y [1 : :n]. ®£¤  ±²®¨¬®±²¼ °¥¤ ª²¨°®¢ ­¨¿ (edit distance) ¥±²¼ ­ ¨¬¥­¼¸ ¿ ±²®¨¬®±²¼
¶¥¯®·ª¨ ¯°¥®¡° §®¢ ­¨©, ¯¥°¥¢®¤¿¹¥© x ¢ y .  §° ¡®² ©²¥  «£®°¨²¬, ®±­®¢ ­­»© ­  ¤¨­ ¬¨·¥±ª®¬ ¯°®£° ¬¬¨°®¢ ­¨¨, ª®²®°»©
¢»·¨±«¿¥² ±²®¨¬®±²¼ °¥¤ ª²¨°®¢ ­¨¿ ¨ ­ µ®¤¨² ®¯²¨¬ «¼­³¾ ¶¥¯®·ª³ ¯°¥®¡° §®¢ ­¨©. ¶¥­¨²¥ ¢°¥¬¿ ° ¡®²» ¨ ®¡º¥¬ ¨±¯®«¼§³¥¬®© ¯ ¬¿²¨.
16-4 ¥·¥°¨­ª  ¢ ´¨°¬¥
°®´¥±±®°³ ¯®°³·¥­® ³±²°®¨²¼ ¢¥·¥°¨­ª³ ¢ ´¨°¬¥ À
Á. ²°³ª²³°  ´¨°¬» ¨¥° °µ¨·­ : ®²­®¸¥­¨¥ ¯®¤·¨­¥­­®±²¨
§ ¤ ­® ¤¥°¥¢®¬, ª®°¥­¼ ª®²®°®£® | ¤¨°¥ª²®°. ²¤¥« ª ¤°®¢ §­ ¥²
°¥©²¨­£ ª ¦¤®£® ±®²°³¤­¨ª  (¤¥©±²¢¨²¥«¼­®¥ ·¨±«®). ²®¡» ¢±¥¬
¡»«® ¢¥±¥«®, ¤¨°¥ª²®° ° ±¯®°¿¤¨«±¿, ·²®¡» ­¨ª²® ­¥ ®ª § «±¿ ­ 
¢¥·¥°¨­ª¥ ¢¬¥±²¥ ±® ±¢®¨¬ ­¥¯®±°¥¤±²¢¥­­»¬ ­ · «¼­¨ª®¬.
 .  §° ¡®² ©²¥  «£®°¨²¬, ±®±² ¢«¿¾¹¨© ±¯¨±®ª ¯°¨£« ¸¥­­»µ ±
­ ¨¡®«¼¸¨¬ ±³¬¬ °­»¬ °¥©²¨­£®¬.
¡.   ¦¥ § ¤ ·  ± ¤®¯®«­¨²¥«¼­»¬ ®£° ­¨·¥­¨¥¬: ¤¨°¥ª²®° ¤®«¦¥­ ¡»²¼ ¢ ±¯¨±ª¥ ¯°¨£« ¸¥­­»µ.
16-5 «£®°¨²¬ ¨²¥°¡¨
¨­ ¬¨·¥±ª®¥ ¯°®£° ¬¬¨°®¢ ­¨¥ ¬®¦¥² ¡»²¼ ¯°¨¬¥­¥­® ª § ¤ ·¥ ° ±¯®§­ ¢ ­¨¿ °¥·¨.  ª ·¥±²¢¥ ¬®¤¥«¨ ° ±±¬®²°¨¬ ®°¨¥­²¨°®¢ ­­»© £° ´ G = (V; E ) ¨ ®²®¡° ¦¥­¨¥  , ±®¯®±² ¢«¿¾¹¥¥ ± ª ¦¤»¬ °¥¡°®¬ (u; v ) §¢³ª  (u; v ) ¨§ ¬­®¦¥±²¢  ¢®§¬®¦­»µ §¢³ª®¢ .
 £° ´¥ ¢»¤¥«¥­  ­¥ª®²®° ¿ ¢¥°¸¨­  v0 .  ¦¤®¬³ ¯³²¨, ­ ·¨­ ¾¹¥¬³±¿ ¢ v0 , ±®®²¢¥²±²¢³¥² ¯®±«¥¤®¢ ²¥«¼­®±²¼ §¢³ª®¢ (½«¥¬¥­²®¢ ).
 .  §° ¡®² ©²¥ ½´´¥ª²¨¢­»©  «£®°¨²¬, ¢®±±² ­ ¢«¨¢ ¾¹¨©
¯³²¼ ¢ £° ´¥ ¯® ¯®±«¥¤®¢ ²¥«¼­®±²¨ s = h1 ; 2; : : :; ni ½«¥¬¥­²®¢  (¥±«¨ ²°¥¡³¥¬®£® ¯³²¨ ­¥ ±³¹¥±²¢³¥²,  «£®°¨²¬ ¤®«¦¥­
¢»¤ ²¼ ±®®²¢¥²±²¢³¾¹¥¥ ±®®¡¹¥­¨¥). ¶¥­¨²¥ ¢°¥¬¿ ° ¡®²»
 «£®°¨²¬ . (ª § ­¨¥: ¢ ¬ ¬®£³² ¯°¨£®¤¨²¼±¿ ­¥ª®²®°»¥ ¨¤¥¨
¨§ £« ¢» 23).
³±²¼ ²¥¯¥°¼ ¤«¿ ª ¦¤®£® °¥¡°  (u; v ) 2 E ¨§¢¥±²­  ¢¥°®¿²­®±²¼
¯°®©²¨ ¯® °¥¡°³ ¨§ u ¢ v (¨§¤ ²¼ ±®®²¢¥²±²¢³¾¹¨© §¢³ª); ®¡®§­ ·¨¬ ½²³ ¢¥°®¿²­®±²¼ p(u; v ). » ¯°¥¤¯®« £ ¥¬, ·²® ¤«¿ «¾¡®©
¢¥°¸¨­» u ±³¬¬  ¢¥°®¿²­®±²¥© p(u; v ) ¯® ¢±¥¬ °¥¡° ¬, ¢»µ®¤¿¹¨¬

 ¬¥· ­¨¿ ª £« ¢¥ 16

331

¨§ ½²®© ¢¥°¸¨­», ° ¢­  ¥¤¨­¨¶¥. ¥°®¿²­®±²¼¾ ¯³²¨ ±·¨² ¥¬ ¯°®¨§¢¥¤¥­¨¥ ¢¥°®¿²­®±²¥©, ±®®²¢¥²±²¢³¾¹¨µ ¥£® °¥¡° ¬ (². ¥. ¯®±«¥¤®¢ ²¥«¼­»¥ ¢»¡®°» ±·¨² ¥¬ ­¥§ ¢¨±¨¬»¬¨).
¡.. ®¤¨´¨¶¨°³©²¥ ¯®±²°®¥­­»© ¢ ( )  «£®°¨²¬ ² ª, ·²®¡» ®­ ­ µ®¤¨« ­ ¨¡®«¥¥ ¢¥°®¿²­»© ¯³²¼, ±®®²¢¥²±²¢³¾¹¨© ¤ ­­®© ¯®±«¥¤®¢ ²¥«¼­®±²¨ §¢³ª®¢. ¶¥­¨²¥ ¢°¥¬¿ ° ¡®²» ¬®¤¨´¨¶¨°®¢ ­­®£®  «£®°¨²¬ .

 ¬¥· ­¨¿
¨±²¥¬ ²¨·¥±ª®¥ ¨§³·¥­¨¥ ¤¨­ ¬¨·¥±ª®£® ¯°®£° ¬¬¨°®¢ ­¨¿
¡»«® ­ · ²® . ¥««¬ ­®¬ ¢ 1955 £®¤³ [21], µ®²¿ ­¥ª®²®°»¥ ¯°¨¥¬»
² ª®£® °®¤  ¡»«¨ ¨§¢¥±²­» ¨ ° ­¥¥. ±² ²¨, ±«®¢® À¯°®£° ¬¬¨°®¢ ­¨¥Á (programming) ¢ ±«®¢®±®·¥² ­¨¿µ À¤¨­ ¬¨·¥±ª®¥ ¯°®£° ¬¬¨°®¢ ­¨¥Á (dynamic programming),   ² ª¦¥ À«¨­¥©­®¥ ¯°®£° ¬¬¨°®¢ ­¨¥Á (linear programming) ­¥ ®§­ · ¥² ±®±² ¢«¥­¨¥ ¯°®£° ¬¬
¤«¿ ª®¬¯¼¾²¥° .
³ ¨ ¨­£ [106a, 106b] ¯°¨¤³¬ «¨ ° ¡®² ¾¹¨© §  ¢°¥¬¿
O(n log n)  «£®°¨²¬ ¤«¿ § ¤ ·¨ ® ¯®°¿¤ª¥ ¯¥°¥¬­®¦¥­¨¿ ¬ ²°¨¶;
®­¨ ¦¥ ³ª § «¨ ±®®²¢¥²±²¢¨¥ ¬¥¦¤³ ½²®© § ¤ ·¥© ¨ § ¤ ·¥© ®¡
®¯²¨¬ «¼­®© ²°¨ ­£³«¿¶¨¨.
«£®°¨²¬ ¤«¿ ­ µ®¦¤¥­¨¿ ­ ¨¡®«¼¸¥© ®¡¹¥© ¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¨ §  ¢°¥¬¿ O(mn) ®²­®±¨²±¿, ¢¨¤¨¬®, ª ´®«¼ª«®°³.  ° ¡®²¥ [43] ­³² ¯®±² ¢¨« ¢®¯°®±, ¢®§¬®¦¥­ «¨ ¤«¿ ½²®© § ¤ ·¨ ±³¡ª¢ ¤° ²¨·­»©  «£®°¨²¬.  ±¥ª ¨  ²¥°±®­ [143] ¯®ª § «¨, ·²®
¢®§¬®¦¥­, ­ ©¤¿  «£®°¨²¬, ° ¡®² ¾¹¨© §  ¢°¥¬¿ O(mn= log n) ¯°¨
n 6 m ¨ ´¨ª±¨°®¢ ­­®¬ ° §¬¥°¥ ¬­®¦¥±²¢ , ¨§ ª®²®°®£® ¡¥°³²±¿
·«¥­» ¯®±«¥¤®¢ ²¥«¼­®±²¥©. «¿ ±«³· ¿, ª®£¤  ¢ ¯®±«¥¤®¢ ²¥«¼­®±²¿µ ­¥² ¯®¢²®°¥­¨©,  «£®°¨²¬ ± ®¶¥­ª®© O((n + m) log(n + m))
¯®±²°®¥­ ¢ ±² ²¼¥ ¨¬ ­±ª¨ [184]. ­®£¨¥ ¨§ ½²¨µ °¥§³«¼² ²®¢
®¡®¡¹ ¾²±¿ ­  § ¤ ·³ ® ±²®¨¬®±²¨ °¥¤ ª²¨°®¢ ­¨¿ (§ ¤ ·  16-3).

17

 ¤­»¥  «£®°¨²¬»

«¿ ¬­®£¨µ ®¯²¨¬¨§ ¶¨®­­»µ § ¤ · ¥±²¼ ¡®«¥¥ ¯°®±²»¥ ¨ ¡»±²°»¥
 «£®°¨²¬», ·¥¬ ¤¨­ ¬¨·¥±ª®¥ ¯°®£° ¬¬¨°®¢ ­¨¥.  ½²®© £« ¢¥ ¬»
° ±±¬ ²°¨¢ ¥¬ § ¤ ·¨, ª®²®°»¥ ¬®¦­® °¥¸ ²¼ ± ¯®¬®¹¼¾ ¦ ¤­»µ
 «£®°¨²¬®¢ (greedy algorithms).  ª®©  «£®°¨²¬ ¤¥« ¥² ­  ª ¦¤®¬
¸ £¥ «®ª «¼­® ®¯²¨¬ «¼­»© ¢»¡®°, | ¢ ­ ¤¥¦¤¥, ·²® ¨²®£®¢®¥
°¥¸¥­¨¥ ² ª¦¥ ®ª ¦¥²±¿ ®¯²¨¬ «¼­»¬. ²® ­¥ ¢±¥£¤  ² ª | ­®
¤«¿ ¬­®£¨µ § ¤ · ² ª¨¥  «£®°¨²¬» ¤¥©±²¢¨²¥«¼­® ¤ ¾² ®¯²¨¬³¬.
 ¸ ¯¥°¢»© ¯°¨¬¥° | ¯°®±² ¿, ­® ­¥ ¢¯®«­¥ ²°¨¢¨ «¼­ ¿ § ¤ · 
® ¢»¡®°¥ § ¿¢®ª (° §¤¥« 17.1).  «¥¥ (° §¤¥« 17.2) ¬» ®¡±³¦¤ ¥¬,
¤«¿ ª ª¨µ § ¤ · £®¤¿²±¿ ¦ ¤­»¥  «£®°¨²¬».  ° §¤¥«¥ 17.3 ° ±±ª §»¢ ¥²±¿ ® ±¦ ²¨¨ ¨­´®°¬ ¶¨¨ ± ¯®¬®¹¼¾ ª®¤®¢  ´´¬¥­ ,
ª®²®°»¥ ±²°®¿²±¿ ¦ ¤­»¬  «£®°¨²¬®¬.  §¤¥« 17.4 ¯®±¢¿¹¥­ ² ª
­ §»¢ ¥¬»¬ ¬ ²°®¨¤ ¬ | ª®¬¡¨­ ²®°­»¬ ®¡º¥ª² ¬, ±¢¿§ ­­»¬
± ¦ ¤­»¬¨  «£®°¨²¬ ¬¨.  ª®­¥¶, ¢ ° §¤¥«¥ 17.5 ¬» ¯°¨¬¥­¿¥¬
¬ ²°®¨¤» ª § ¤ ·¥ ® ° ±¯¨± ­¨¨ ¤«¿ § ª §®¢ ° ¢­®© ¤«¨²¥«¼­®±²¨
±® ±°®ª ¬¨ ¨ ¸²° ´ ¬¨.
 ±«¥¤³¾¹¨µ £« ¢ µ ¬» ­¥ ° § ¢±²°¥²¨¬±¿ ± ¦ ¤­»¬¨  «£®°¨²¬ ¬¨ (§ ¤ ·  ® ¬¨­¨¬ «¼­®¬ ¯®ª°»¢ ¾¹¥¬ ¤¥°¥¢¥,  «£®°¨²¬
¥©ª±²°» ¯®¨±ª  ª° ²· ©¸¨µ ¯³²¥© ¨§ ¤ ­­®© ¢¥°¸¨­», ¦ ¤­ ¿
½¢°¨±²¨ª  ¢ ² «  ¤«¿ § ¤ ·¨ ® ¯®ª°»²¨¨ ¬­®¦¥±²¢  ¨ ¤°³£¨¥).
¨­¨¬ «¼­»¥ ¯®ª°»¢ ¾¹¨¥ ¤¥°¥¢¼¿ | ª« ±±¨·¥±ª¨© ¯°¨¬¥° ¨±¯®«¼§®¢ ­¨¿ ¦ ¤­®£®  «£®°¨²¬ , ² ª ·²® ¯ ° ««¥«¼­® ± ½²®© £« ¢®© ¬®¦­® ·¨² ²¼ £« ¢³ 24.

17.1.  ¤ ·  ® ¢»¡®°¥ § ¿¢®ª
³±²¼ ¤ ­» n § ¿¢®ª ­  ¯°®¢¥¤¥­¨¥ § ­¿²¨© ¢ ®¤­®© ¨ ²®© ¦¥
 ³¤¨²®°¨¨. ¢  ° §­»µ § ­¿²¨¿ ­¥ ¬®£³² ¯¥°¥ª°»¢ ²¼±¿ ¯® ¢°¥¬¥­¨.  ª ¦¤®© § ¿¢ª¥ ³ª § ­» ­ · «® ¨ ª®­¥¶ § ­¿²¨¿ (si ¨ fi
¤«¿ i-© § ¿¢ª¨).  §­»¥ § ¿¢ª¨ ¬®£³² ¯¥°¥±¥ª ²¼±¿, ¨ ²®£¤  ¬®¦­®
³¤®¢«¥²¢®°¨²¼ ²®«¼ª® ®¤­³ ¨§ ­¨µ. » ®²®¦¤¥±²¢«¿¥¬ ª ¦¤³¾ § ¿¢ª³ ± ¯°®¬¥¦³²ª®¬ [si ; fi), ² ª ·²® ª®­¥¶ ®¤­®£® § ­¿²¨¿ ¬®¦¥²
±®¢¯ ¤ ²¼ ± ­ · «®¬ ¤°³£®£®, ¨ ½²® ­¥ ±·¨² ¥²±¿ ¯¥°¥±¥·¥­¨¥¬.

 ¤ ·  ® ¢»¡®°¥ § ¿¢®ª

333

®°¬ «¼­® £®¢®°¿, § ¿¢ª¨ ± ­®¬¥° ¬¨ i ¨ j ±®¢¬¥±²­» (compatible), ¥±«¨ ¨­²¥°¢ «» [si ; fi) ¨ [sj ; fj ) ­¥ ¯¥°¥±¥ª ¾²±¿ (¨­»¬¨
±«®¢ ¬¨, ¥±«¨ fi 6 sj ¨«¨ fj 6 si ).  ¤ ·  ® ¢»¡®°¥ § ¿¢®ª (activityselection problem) ±®±²®¨² ¢ ²®¬, ·²®¡» ­ ¡° ²¼ ¬ ª±¨¬ «¼­®¥ ª®«¨·¥±²¢® ±®¢¬¥±²­»µ ¤°³£ ± ¤°³£®¬ § ¿¢®ª.
 ¤­»©  «£®°¨²¬ ° ¡®² ¥² ±«¥¤³¾¹¨¬ ®¡° §®¬. » ¯°¥¤¯®« £ ¥¬, ·²® § ¿¢ª¨ ³¯®°¿¤®·¥­» ¢ ¯®°¿¤ª¥ ¢®§° ±² ­¨¿ ¢°¥¬¥­¨
®ª®­· ­¨¿:
f1 6 f2 6 : : : 6 fn:
(17.1)
±«¨ ½²® ­¥ ² ª, ²® ¬®¦­® ®²±®°²¨°®¢ ²¼ ¨µ §  ¢°¥¬¿ O(n log n);
§ ¿¢ª¨ ± ®¤¨­ ª®¢»¬ ¢°¥¬¥­¥¬ ª®­¶  ° ±¯®« £ ¥¬ ¢ ¯°®¨§¢®«¼­®¬
¯®°¿¤ª¥.
®£¤   «£®°¨²¬ ¢»£«¿¤¨² ² ª (f ¨ s | ¬ ±±¨¢»):
Greedy-Activity-Selector(s; f )
1 n length[s]
2 A f1g
3 j 1
4 for i 2 to n
5
do if si > fj
6
then A A [ fig
7
j i
8 return A
 ¡®²  ½²®£®  «£®°¨²¬  ¯®ª § ­  ­  °¨±. 17.1. ­®¦¥±²¢® A ±®±²®¨² ¨§ ­®¬¥°®¢ ¢»¡° ­­»µ § ¿¢®ª, j | ­®¬¥° ¯®±«¥¤­¥© ¨§ ­¨µ;
¯°¨ ½²®¬
fj = maxf fk : k 2 A g;
(17.2)
¯®±ª®«¼ª³ § ¿¢ª¨ ®²±®°²¨°®¢ ­» ¯® ¢°¥¬¥­ ¬ ®ª®­· ­¨¿. ­ · «¥
A ±®¤¥°¦¨² § ¿¢ª³ ­®¬¥° 1, ¨ j = 1 (±²°®ª¨ 2{3).  «¥¥ (¶¨ª« ¢
±²°®ª µ 4{7) ¨¹¥²±¿ § ¿¢ª , ­ ·¨­ ¾¹ ¿±¿ ­¥ ° ­¼¸¥ ®ª®­· ­¨¿
§ ¿¢ª¨ ­®¬¥° j . ±«¨ ² ª®¢ ¿ ­ ©¤¥­ , ®­  ¢ª«¾· ¥²±¿ ¢ ¬­®¦¥±²¢® A ¨ ¯¥°¥¬¥­­®© j ¯°¨±¢ ¨¢ ¥²±¿ ¥¥ ­®¬¥° (±²°®ª¨ 6{7).
«£®°¨²¬ Greedy-Activity-Selector ²°¥¡³¥² ¢±¥£® «¨¸¼
(n) ¸ £®¢ (­¥ ±·¨² ¿ ¯°¥¤¢ °¨²¥«¼­®© ±®°²¨°®¢ª¨).  ª ¨ ¯®¤®¡ ¥² ¦ ¤­®¬³  «£®°¨²¬³, ­  ª ¦¤®¬ ¸ £¥ ®­ ¤¥« ¥² ¢»¡®° ² ª,
·²®¡» ®±² ¾¹¥¥±¿ ±¢®¡®¤­»¬ ¢°¥¬¿ ¡»«® ¬ ª±¨¬ «¼­®.
° ¢¨«¼­®±²¼  «£®°¨²¬ 
¥ ¤«¿ ¢±¥µ § ¤ · ¦ ¤­»©  «£®°¨²¬ ¤ ¥² ®¯²¨¬ «¼­®¥ °¥¸¥­¨¥,
­® ¤«¿ ­ ¸¥© ¤ ¥². ¡¥¤¨¬±¿ ¢ ½²®¬.
¥®°¥¬  17.1. «£®°¨²¬ Greedy-Activity-Selector ¤ ¥² ­ ¡®° ¨§ ­ ¨¡®«¼¸¥£® ¢®§¬®¦­®£® ª®«¨·¥±²¢  ±®¢¬¥±²­»µ § ¿¢®ª.

« ¢  17  ¤­»¥  «£®°¨²¬»

334

i si fi
1

1

4

2

3

5

3

0

6

4

5

7

5

3

8

6

5

9

7

6 10

8

8 11

9

8 12

10 2 13
11 12 14
 ¡®²   «£®°¨²¬  Greedy-Activity-Selector ¤«¿ 11 § ¿¢®ª (² ¡«¨¶  ±«¥¢ ).  ¦¤ ¿ ±²°®ª  ­  °¨±³­ª¥ ±®®²¢¥²±²¢³¥² ®¤­®¬³ ¯°®µ®¤³ ¶¨ª« 
¢ ±²°®ª µ 4{7. ¥°»¥ § ¿¢ª¨ ³¦¥ ¢ª«¾·¥­» ¢ A, ¡¥« ¿ ±¥©· ± ° ±±¬ ²°¨¢ ¥²±¿. ±«¨ «¥¢»© ª®­¥¶ ¡¥«®£® ¯°¿¬®³£®«¼­¨ª  «¥¢¥¥ ¯° ¢®£® ª®­¶  ¯° ¢®£®
±¥°®£® (±²°¥«ª  ¨¤¥² ¢«¥¢®), ²® § ¿¢ª  ®²¢¥°£ ¥²±¿.  ¯°®²¨¢­®¬ ±«³· ¥ ®­ 
¤®¡ ¢«¿¥²±¿ ª A.
¨±. 17.1

 ¤ ·  ® ¢»¡®°¥ § ¿¢®ª

335

®ª § ²¥«¼±²¢®.  ¯®¬­¨¬, ·²® § ¿¢ª¨ ®²±®°²¨°®¢ ­» ¯® ¢®§° ±² ­¨¾ ¢°¥¬¥­¨ ®ª®­· ­¨¿. °¥¦¤¥ ¢±¥£® ¤®ª ¦¥¬, ·²® ±³¹¥±²¢³¥² ®¯²¨¬ «¼­®¥ °¥¸¥­¨¥ § ¤ ·¨ ® ¢»¡®°¥ § ¿¢®ª, ±®¤¥°¦ ¹¥¥ § ¿¢ª³ ­®¬¥° 1 (± ± ¬»¬ ° ­­¨¬ ¢°¥¬¥­¥¬ ®ª®­· ­¨¿).  ± ¬®¬ ¤¥«¥,
¥±«¨ ¢ ª ª®¬-²® ®¯²¨¬ «¼­®¬ ¬­®¦¥±²¢¥ § ¿¢®ª § ¿¢ª  ­®¬¥° 1 ­¥
±®¤¥°¦¨²±¿, ²® ¬®¦­® § ¬¥­¨²¼ ¢ ­¥¬ § ¿¢ª³ ± ± ¬»¬ ° ­­¨¬ ¢°¥¬¥­¥¬ ®ª®­· ­¨¿ ­  § ¿¢ª³ ­®¬¥° 1, ·²® ­¥ ¯®¢°¥¤¨² ±®¢¬¥±²­®±²¨
§ ¿¢®ª (¨¡® § ¿¢ª  ­®¬¥° 1 ª®­· ¥²±¿ ¥¹¥ ° ­¼¸¥, ·¥¬ ¯°¥¦­¿¿, ¨
­¨ ± ·¥¬ ¯¥°¥±¥·¼±¿ ­¥ ¬®¦¥²) ¨ ­¥ ¨§¬¥­¨² ¨µ ®¡¹¥£® ª®«¨·¥±²¢ .
² «® ¡»²¼, ¬®¦­® ¨±ª ²¼ ®¯²¨¬ «¼­®¥ ¬­®¦¥±²¢® § ¿¢®ª A ±°¥¤¨ ±®¤¥°¦ ¹¨µ § ¿¢ª³ ­®¬¥° 1: ±³¹¥±²¢³¥² ®¯²¨¬ «¼­®¥ °¥¸¥­¨¥,
­ ·¨­ ¾¹¥¥±¿ ± ¦ ¤­®£® ¢»¡®° .
®±«¥ ²®£® ª ª ¬» ¤®£®¢®°¨«¨±¼ ° ±±¬ ²°¨¢ ²¼ ²®«¼ª® ­ ¡®°»,
±®¤¥°¦ ¹¨¥ § ¿¢ª³ ­®¬¥° 1, ¢±¥ ­¥±®¢¬¥±²­»¥ ± ­¥© § ¿¢ª¨ ¬®¦­® ¢»ª¨­³²¼, ¨ § ¤ ·  ±¢®¤¨²±¿ ª ¢»¡®°³ ®¯²¨¬ «¼­®£® ­ ¡®° 
§ ¿¢®ª ¨§ ¬­®¦¥±²¢  ®±² ¢¸¨µ±¿ § ¿¢®ª (±®¢¬¥±²­»µ ± § ¿¢ª®© ­®¬¥° 1). °³£¨¬¨ ±«®¢ ¬¨, ¬» ±¢¥«¨ § ¤ ·³ ª  ­ «®£¨·­®© § ¤ ·¥
± ¬¥­¼¸¨¬ ·¨±«®¬ § ¿¢®ª.  ±±³¦¤ ¿ ¯® ¨­¤³ª¶¨¨, ¯®«³· ¥¬, ·²®,
¤¥« ¿ ­  ª ¦¤®¬ ¸ £¥ ¦ ¤­»© ¢»¡®°, ¬» ¯°¨¤¥¬ ª ®¯²¨¬ «¼­®¬³
°¥¸¥­¨¾.

¯° ¦­¥­¨¿
17.1-1  ¤ ·³ ® ¢»¡®°¥ § ¿¢®ª ¬®¦­® °¥¸ ²¼ ± ¯®¬®¹¼¾ ¤¨­ ¬¨·¥±ª®£® ¯°®£° ¬¬¨°®¢ ­¨¿, ¢»·¨±«¿¿ ¯®±«¥¤®¢ ²¥«¼­® (¤«¿
i = 1; 2; : : :; n) ·¨±«® mi | ¬ ª±¨¬ «¼­® ¢®§¬®¦­®¥ ·¨±«® ±®¢¬¥±²­»µ § ¿¢®ª ±°¥¤¨ § ¿¢®ª ± ­®¬¥° ¬¨ 1; 2; : : :; i (±·¨² ¿, ·²® ­¥° ¢¥­±²¢® (17.1) ¢»¯®«­¥­®). ° ¢­¨²¥ ¢°¥¬¿ ° ¡®²» ² ª®£®  «£®°¨²¬ 
¨  «£®°¨²¬  Greedy-Activity-Selector.
17.1-2 ³±²¼ ¯®-¯°¥¦­¥¬³ ¨¬¥¥²±¿ ¬­®¦¥±²¢® § ¿¢®ª ­  ¯°®¢¥¤¥­¨¥ § ­¿²¨© (ª ¦¤ ¿ § ¿¢ª  ³ª §»¢ ¥² ­ · «® ¨ ª®­¥¶), ­®  ³¤¨²®°¨© ±ª®«¼ª® ³£®¤­®. ³¦­® ° ±¯°¥¤¥«¨²¼ § ¿¢ª¨ ¯®  ³¤¨²®°¨¿¬,
¨±¯®«¼§³¿ ª ª ¬®¦­® ¬¥­¼¸¥  ³¤¨²®°¨©.  §° ¡®² ©²¥ ½´´¥ª²¨¢­»© ¦ ¤­»©  «£®°¨²¬, °¥¸ ¾¹¨© ½²³ § ¤ ·³.
²  § ¤ ·  ¨§¢¥±²­  ² ª¦¥ ª ª § ¤ ·  ® ° ±ª° ±ª¥ ¨­²¥°¢ «¼­®£® £° ´  (interval-graph coloring problem).  ±±¬®²°¨¬ £° ´, ¢¥°¸¨­ ¬¨ ª®²®°®£® ¿¢«¿¾²±¿ § ¿¢ª¨, ¯°¨·¥¬ ¢¥°¸¨­» ±®¥¤¨­¥­»
°¥¡°®¬ ²®£¤  ¨ ²®«¼ª® ²®£¤ , ª®£¤  ±®®²¢¥²±²¢³¾¹¨¥ § ¿¢ª¨ ­¥±®¢¬¥±²­».  ¨¬¥­¼¸¥¥ ª®«¨·¥±²¢® ¶¢¥²®¢, ­¥®¡µ®¤¨¬®¥ ¤«¿ ° ±ª° ±ª¨ ¢¥°¸¨­ £° ´  ² ª¨¬ ®¡° §®¬, ·²®¡» ¢¥°¸¨­» ®¤­®£® ¶¢¥²  ­¥ ¡»«¨ ±®¥¤¨­¥­», ¨ ¥±²¼ ­ ¨¬¥­¼¸¥¥ ª®«¨·¥±²¢®  ³¤¨²®°¨©,
­¥®¡µ®¤¨¬®¥ ¤«¿ ¢»¯®«­¥­¨¿ ¢±¥µ § ¿¢®ª.
17.1-3 «¿ § ¤ ·¨ ® ¢»¡®°¥ § ¿¢®ª ¢®§¬®¦­® ­¥±ª®«¼ª® ±¯®±®¡®¢
¦ ¤­®£® ¢»¡®° , ¨ ­¥ ¢±¥ ®­¨ £®¤¿²±¿. ®ª ¦¨²¥ ­  ¯°¨¬¥°¥, ·²®

336

« ¢  17  ¤­»¥  «£®°¨²¬»

¯° ¢¨«  À­  ª ¦¤®¬ ¸ £¥ ¢»¡¨° ²¼ § ¿¢ª³ ­ ¨¬¥­¼¸¥© ¤«¨²¥«¼­®±²¨, ±®¢¬¥±²­³¾ ± ³¦¥ ¢»¡° ­­»¬¨Á,   ² ª¦¥ À­  ª ¦¤®¬ ¸ £¥
¢»¡¨° ²¼ § ¿¢ª³, ±®¢¬¥±²­³¾ ± ­ ¨¡®«¼¸¨¬ ª®«¨·¥±²¢®¬ ®±² ¾¹¨µ±¿Á, ­¥ £®¤¿²±¿.

17.2. ®£¤  ¯°¨¬¥­¨¬ ¦ ¤­»©  «£®°¨²¬?
 ª ³§­ ²¼, ¤ ±² «¨ ¦ ¤­»©  «£®°¨²¬ ®¯²¨¬³¬ ¯°¨¬¥­¨²¥«¼­®
ª ¤ ­­®© § ¤ ·¥? ¡¹¨µ °¥¶¥¯²®¢ ²³² ­¥², ­® ±³¹¥±²¢³¾² ¤¢¥ ®±®¡¥­­®±²¨, µ ° ª²¥°­»¥ ¤«¿ § ¤ ·, °¥¸ ¥¬»µ ¦ ¤­»¬¨  «£®°¨²¬ ¬¨. ²® ¯°¨­¶¨¯ ¦ ¤­®£® ¢»¡®°  ¨ ±¢®©±²¢® ®¯²¨¬ «¼­®±²¨ ¤«¿
¯®¤§ ¤ ·.
°¨­¶¨¯ ¦ ¤­®£® ¢»¡®° 
®¢®°¿², ·²® ª ®¯²¨¬¨§ ¶¨®­­®© § ¤ ·¥ ¯°¨¬¥­¨¬ ¯°¨­¶¨¯ ¦ ¤­®£® ¢»¡®°  (greedy-choice property), ¥±«¨ ¯®±«¥¤®¢ ²¥«¼­®±²¼ «®ª «¼­® ®¯²¨¬ «¼­»µ (¦ ¤­»µ) ¢»¡®°®¢ ¤ ¥² £«®¡ «¼­® ®¯²¨¬ «¼­®¥ °¥¸¥­¨¥.  §«¨·¨¥ ¬¥¦¤¥ ¦ ¤­»¬¨  «£®°¨²¬ ¬¨ ¨ ¤¨­ ¬¨·¥±ª¨¬ ¯°®£° ¬¬¨°®¢ ­¨¥¬ ¬®¦­® ¯®¿±­¨²¼ ² ª: ­  ª ¦¤®¬ ¸ £¥
¦ ¤­»©  «£®°¨²¬ ¡¥°¥² À± ¬»© ¦¨°­»© ª³±®ªÁ,   ¯®²®¬ ³¦¥ ¯»² ¥²±¿ ±¤¥« ²¼ ­ ¨«³·¸¨© ¢»¡®° ±°¥¤¨ ®±² ¢¸¨µ±¿, ª ª®¢» ¡» ®­¨
­¨ ¡»«¨;  «£®°¨²¬ ¤¨­ ¬¨·¥±ª®£® ¯°®£° ¬¬¨°®¢ ­¨¿ ¯°¨­¨¬ ¥²
°¥¸¥­¨¥, ¯°®±·¨² ¢ § ° ­¥¥ ¯®±«¥¤±²¢¨¿ ¤«¿ ¢±¥µ ¢ °¨ ­²®¢.
 ª ¤®ª § ²¼, ·²® ¦ ¤­»©  «£®°¨²¬ ¤ ¥² ®¯²¨¬ «¼­®¥ °¥¸¥­¨¥?
²® ­¥ ¢±¥£¤  ²°¨¢¨ «¼­®, ­® ¢ ²¨¯¨·­®¬ ±«³· ¥ ² ª®¥ ¤®ª § ²¥«¼±²¢® ±«¥¤³¥² ±µ¥¬¥, ¨±¯®«¼§®¢ ­­®© ¢ ¤®ª § ²¥«¼±²¢¥ ²¥®°¥¬» 17.1.
­ · «  ¬» ¤®ª §»¢ ¥¬, ·²® ¦ ¤­»© ¢»¡®° ­  ¯¥°¢®¬ ¸ £¥ ­¥ § ª°»¢ ¥² ¯³²¨ ª ®¯²¨¬ «¼­®¬³ °¥¸¥­¨¾: ¤«¿ ¢±¿ª®£® °¥¸¥­¨¿ ¥±²¼
¤°³£®¥, ±®£« ±®¢ ­­®¥ ± ¦ ¤­»¬ ¢»¡®°®¬ ¨ ­¥ µ³¤¸¥¥ ¯¥°¢®£®.
 ²¥¬ ¯®ª §»¢ ¥²±¿, ·²® ¯®¤§ ¤ · , ¢®§­¨ª ¾¹ ¿ ¯®±«¥ ¦ ¤­®£®
¢»¡®°  ­  ¯¥°¢®¬ ¸ £¥,  ­ «®£¨·­  ¨±µ®¤­®©, ¨ ° ±±³¦¤¥­¨¥ § ¢¥°¸ ¥²±¿ ¯® ¨­¤³ª¶¨¨.
¯²¨¬ «¼­®±²¼ ¤«¿ ¯®¤§ ¤ ·
®¢®°¿ ¨­»¬¨ ±«®¢ ¬¨, °¥¸ ¥¬»¥ ± ¯®¬®¹¼¾ ¦ ¤­»µ  «£®°¨²¬®¢ § ¤ ·¨ ®¡« ¤ ¾² ±¢®©±²¢®¬ ®¯²¨¬ «¼­®±²¨ ¤«¿ ¯®¤§ ¤ · (have
optimal substructure): ®¯²¨¬ «¼­®¥ °¥¸¥­¨¥ ¢±¥© § ¤ ·¨ ±®¤¥°¦¨²
¢ ±¥¡¥ ®¯²¨¬ «¼­»¥ °¥¸¥­¨¿ ¯®¤§ ¤ ·. ( ½²¨¬ ±¢®©±²¢®¬ ¬»
³¦¥ ¢±²°¥· «¨±¼, £®¢®°¿ ® ¤¨­ ¬¨·¥±ª®¬ ¯°®£° ¬¬¨°®¢ ­¨¨.)  ¯°¨¬¥°, ¯°¨ ¤®ª § ²¥«¼±²¢¥ ²¥®°¥¬» 17.1 ¬» ¢¨¤¥«¨, ·²® ¥±«¨
A | ®¯²¨¬ «¼­»© ­ ¡®° § ¿¢®ª, ±®¤¥°¦ ¹¨© § ¿¢ª³ ­®¬¥° 1, ²®
A0 = A nf1g | ®¯²¨¬ «¼­»© ­ ¡®° § ¿¢®ª ¤«¿ ¬¥­¼¸¥£® ¬­®¦¥±²¢ 

®£¤  ¯°¨¬¥­¨¬ ¦ ¤­»©  «£®°¨²¬?

337

§ ¿¢®ª S 0, ±®±²®¿¹¥£® ¨§ ²¥µ § ¿¢®ª, ¤«¿ ª®²®°»µ si > f1 .
 ¤­»©  «£®°¨²¬ ¨«¨ ¤¨­ ¬¨·¥±ª®¥ ¯°®£° ¬¬¨°®¢ ­¨¥?
 ¦ ¤­»¥  «£®°¨²¬», ¨ ¤¨­ ¬¨·¥±ª®¥ ¯°®£° ¬¬¨°®¢ ­¨¥ ®±­®¢»¢ ¾²±¿ ­  ±¢®©±²¢¥ ®¯²¨¬ «¼­®±²¨ ¤«¿ ¯®¤§ ¤ ·, ¯®½²®¬³ ¬®¦¥²
¢®§­¨ª­³²¼ ¨±ª³¸¥­¨¥ ¯°¨¬¥­¨²¼ ¤¨­ ¬¨·¥±ª®¥ ¯°®£° ¬¬¨°®¢ ­¨¥ ¢ ±¨²³ ¶¨¨, £¤¥ µ¢ ²¨«® ¡» ¦ ¤­®£®  «£®°¨²¬ , ¨«¨, ­ ¯°®²¨¢, ¯°¨¬¥­¨²¼ ¦ ¤­»©  «£®°¨²¬ ª § ¤ ·¥, ¢ ª®²®°®© ®­ ­¥ ¤ ±²
®¯²¨¬³¬ . » ¯°®¨««¾±²°¨°³¥¬ ¢®§¬®¦­»¥ «®¢³¸ª¨ ­  ¯°¨¬¥°¥
¤¢³µ ¢ °¨ ­²®¢ ª« ±±¨·¥±ª®© ®¯²¨¬¨§ ¶¨®­­®© § ¤ ·¨.
¨±ª°¥²­ ¿ § ¤ ·  ® °¾ª§ ª¥ (0-1 knapsack problem) ±®±²®¨² ¢
±«¥¤³¾¹¥¬. ³±²¼ ¢®° ¯°®¡° «±¿ ­  ±ª« ¤, ­  ª®²®°®¬ µ° ­¨²±¿
n ¢¥¹¥©. ¥¹¼ ­®¬¥° i ±²®¨² vi ¤®«« °®¢ ¨ ¢¥±¨² wi ª¨«®£° ¬¬®¢
(vi ¨ wi | ¶¥«»¥ ·¨±« ). ®° µ®·¥² ³ª° ±²¼ ²®¢ °  ­  ¬ ª±¨¬ «¼­³¾ ±³¬¬³, ¯°¨·¥¬ ¬ ª±¨¬ «¼­»© ¢¥±, ª®²®°»© ®­ ¬®¦¥² ³­¥±²¨ ¢
°¾ª§ ª¥, ° ¢¥­ W (·¨±«® W ²®¦¥ ¶¥«®¥). ²® ®­ ¤®«¦¥­ ¯®«®¦¨²¼
¢ °¾ª§ ª?
¥¯°¥°»¢­ ¿ § ¤ ·  ® °¾ª§ ª¥ (fractional knapsack problem) ®²«¨· ¥²±¿ ®² ¤¨±ª°¥²­®© ²¥¬, ·²® ¢®° ¬®¦¥² ¤°®¡¨²¼ ª° ¤¥­»¥ ²®¢ °» ­  · ±²¨ ¨ ³ª« ¤»¢ ²¼ ¢ °¾ª§ ª ½²¨ · ±²¨,   ­¥ ®¡¿§ ²¥«¼­®
¢¥¹¨ ¶¥«¨ª®¬ (¥±«¨ ¢ ¤¨±ª°¥²­®© § ¤ ·¥ ¢®° ¨¬¥¥² ¤¥«® ± §®«®²»¬¨
±«¨²ª ¬¨, ²® ¢ ­¥¯°¥°»¢­®© | ± §®«®²»¬ ¯¥±ª®¬).
¡¥ § ¤ ·¨ ® °¾ª§ ª¥ ®¡« ¤ ¾² ±¢®©±²¢®¬ ®¯²¨¬ «¼­®±²¨ ¤«¿
¯®¤§ ¤ ·.  ± ¬®¬ ¤¥«¥, ° ±±¬®²°¨¬ ¤¨±ª°¥²­³¾ § ¤ ·³. »­³¢
¢¥¹¼ ­®¬¥° j ¨§ ®¯²¨¬ «¼­® § £°³¦¥­­®£® °¾ª§ ª , ¯®«³·¨¬ °¥¸¥­¨¥ § ¤ ·¨ ® °¾ª§ ª¥ ± ¬ ª±¨¬ «¼­»¬ ¢¥±®¬ W ;wj ¨ ­ ¡®°®¬ ¨§
n ; 1 ¢¥¹¨ (¢±¥ ¢¥¹¨, ª°®¬¥ j -©). ­ «®£¨·­®¥ ° ±±³¦¤¥­¨¥ ¯°®µ®¤¨² ¨ ¤«¿ ­¥¯°¥°»¢­®© § ¤ ·¨: ¢»­³¢ ¨§ ®¯²¨¬ «¼­® § £°³¦¥­­®£® °¾ª§ ª , ¢ ª®²®°®¬ «¥¦¨² w ª¨«®£° ¬¬®¢ ²®¢ °  ­®¬¥° j , ¢¥±¼
½²®² ²®¢ °, ¯®«³·¨¬ ®¯²¨¬ «¼­®¥ °¥¸¥­¨¥ ­¥¯°¥°»¢­®© § ¤ ·¨, ¢
ª®²®°®© ¬ ª±¨¬ «¼­»© ¢¥± ° ¢¥­ W ; w (¢¬¥±²® W ),   ª®«¨·¥±²¢®
j -£® ²®¢ °  ° ¢­® wj ; w (¢¬¥±²® wj ).
®²¿ ¤¢¥ § ¤ ·¨ ® °¾ª§ ª¥ ¨ ¯®µ®¦¨, ¦ ¤­»©  «£®°¨²¬ ¤ ¥²
®¯²¨¬³¬ ¢ ­¥¯°¥°»¢­®© § ¤ ·¥ ® °¾ª§ ª¥ ¨ ­¥ ¤ ¥² ¢ ¤¨±ª°¥²­®©.
 ± ¬®¬ ¤¥«¥, °¥¸¥­¨¥ ­¥¯°¥°»¢­®© § ¤ ·¨ ® °¾ª§ ª¥ ± ¯®¬®¹¼¾
¦ ¤­®£®  «£®°¨²¬  ¢»£«¿¤¨² ² ª. »·¨±«¨¬ ¶¥­» (¢ ° ±·¥²¥ ­ 
ª¨«®£° ¬¬) ¢±¥µ ²®¢ °®¢ (¶¥­  ²®¢ °  ­®¬¥° i ° ¢­  vi =wi ). ­ · «  ¢®° ¡¥°¥² ¯® ¬ ª±¨¬³¬³ ± ¬®£® ¤®°®£®£® ²®¢ ° ; ¥±«¨ ¢¥±¼ ½²®²
²®¢ ° ª®­·¨«±¿,   °¾ª§ ª ­¥ § ¯®«­¥­, ¢®° ¡¥°¥² ±«¥¤³¾¹¨© ¯® ¶¥­¥ ²®¢ °, § ²¥¬ ±«¥¤³¾¹¨©, ¨ ² ª ¤ «¥¥, ¯®ª  ­¥ ­ ¡¥°¥² ¢¥± W .
®±ª®«¼ª³ ²®¢ °» ­ ¤® ¯°¥¤¢ °¨²¥«¼­® ®²±®°²¨°®¢ ²¼ ¯® ¶¥­ ¬,
­  ·²® ³©¤¥² ¢°¥¬¿ O(n log n), ¢°¥¬¿ ° ¡®²» ®¯¨± ­­®£®  «£®°¨²¬ 
¡³¤¥² O(n log n).  ³¯° ¦­¥­¨¨ 17.2-1 ¬» ¯®¯°®±¨¬ ¢ ± ¤®ª § ²¼,
·²® ®¯¨± ­­»©  «£®°¨²¬ ¤¥©±²¢¨²¥«¼­® ¤ ¥² ®¯²¨¬³¬.

338

« ¢  17  ¤­»¥  «£®°¨²¬»

 ¤¨±ª°¥²­®© § ¤ ·¥ ® °¾ª§ ª¥ ¦ ¤­ ¿ ±²° ²¥£¨¿ ¬®¦¥² ­¥ ±° ¡®² ²¼. ( ) ®° ¤®«¦¥­ ¢»¡° ²¼ ¤¢¥ ¢¥¹¨ ¨§ ²°¥µ ± ²¥¬, ·²®¡» ¨µ ±³¬¬ °­»©
¢¥± ­¥ ¯°¥¢»±¨« 50 ª£. (¡) ¯²¨¬ «¼­»© ¢»¡®° | ¢²®° ¿ ¨ ²°¥²¼¿ ¢¥¹¨; ¥±«¨
¯®«®¦¨²¼ ¢ °¾ª§ ª ¯¥°¢³¾, ²® ¢»¡®° ®¯²¨¬ «¼­»¬ ­¥ ¡³¤¥², µ®²¿ ¨¬¥­­® ®­ 
¤®°®¦¥ ¢±¥µ ¢ ° ±·¥²¥ ­  ¥¤¨­¨¶³ ¢¥± . (¢) «¿ ­¥¯°¥°»¢­®© § ¤ ·¨ ® °¾ª§ ª¥
± ²¥¬¨ ¦¥ ¨±µ®¤­»¬¨ ¤ ­­»¬¨ ¢»¡®° ²®¢ °®¢ ¢ ¯®°¿¤ª¥ ³¡»¢ ­¨¿ ¶¥­» ­ 
¥¤¨­¨¶³ ¢¥±  ¡³¤¥² ®¯²¨¬ «¥­.
¨±. 17.2

²®¡» ³¡¥¤¨²¼±¿ ¢ ²®¬, ·²®  ­ «®£¨·­»© ¦ ¤­»©  «£®°¨²¬ ­¥
®¡¿§ ­ ¤ ¢ ²¼ ®¯²¨¬³¬ ¢ ¤¨±ª°¥²­®© § ¤ ·¥ ® °¾ª§ ª¥, ¢§£«¿­¨²¥
­  °¨±. 17.2 . °³§®¯®¤º¥¬­®±²¼ °¾ª§ ª  50 ª£, ­  ±ª« ¤¥ ¨¬¥¾²±¿
²°¨ ¢¥¹¨, ¢¥±¿¹¨¥ 10, 20 ¨ 30 ª£ ¨ ±²®¿¹¨¥ 60, 100 ¨ 120 ¤®«« °®¢
±®®²¢¥²±²¢¥­­®. ¥­  ¨µ ¢ ° ±·¥²¥ ­  ¥¤¨­¨¶³ ¢¥±  ° ¢­  6, 5 ¨ 4.
 ¤­»©  «£®°¨²¬ ¤«¿ ­ · «  ¯®«®¦¨² ¢ °¾ª§ ª ¢¥¹¼ ­®¬¥° 1;
®¤­ ª® ®¯²¨¬ «¼­®¥ °¥¸¥­¨¥ ¢ª«¾· ¥² ¯°¥¤¬¥²» ­®¬¥° 2 ¨ 3.
«¿ ­¥¯°¥°»¢­®© § ¤ ·¨ ± ²¥¬¨ ¦¥ ¨±µ®¤­»¬¨ ¤ ­­»¬¨ ¦ ¤­»©
 «£®°¨²¬, ¯°¥¤¯¨±»¢ ¾¹¨© ­ · ²¼ ± ²®¢ °  ­®¬¥° 1, ¤ ¥² ®¯²¨¬ «¼­®¥ °¥¸¥­¨¥ (°¨±. 17.2¢).  ¤¨±ª°¥²­®© § ¤ ·¥ ² ª ¿ ±²° ²¥£¨¿ ­¥ ±° ¡ ²»¢ ¥²: ¯®«®¦¨¢ ¢ °¾ª§ ª ¯°¥¤¬¥² ­®¬¥° 1, ¢®° «¨¸ ¥²±¿ ¢®§¬®¦­®±²¨ § ¯®«­¨²¼ °¾ª§ ª À¯®¤ § ¢¿§ª³Á,   ¯³±²®¥ ¬¥±²® ¢ °¾ª§ ª¥ ±­¨¦ ¥² ¶¥­³ ­ ¢®°®¢ ­­®£® ¢ ° ±·¥²¥ ­  ¥¤¨­¨¶³
¢¥± . °¨ °¥¸¥­¨¨ ¤¨±ª°¥²­®© § ¤ ·¨ ® °¾ª§ ª¥, ·²®¡» °¥¸¨²¼,
ª« ±²¼ «¨ ¤ ­­³¾ ¢¥¹¼ ¢ °¾ª§ ª, ­ ¤® ±° ¢­¨²¼ °¥¸¥­¨¥ ¯®¤§ ¤ ·¨, ¢®§­¨ª ¾¹¥©, ¥±«¨ ¤ ­­ ¿ ¢¥¹¼ § ¢¥¤®¬® «¥¦¨² ¢ °¾ª§ ª¥,
± ¯®¤§ ¤ ·¥©, ¢®§­¨ª ¾¹¥©, ¥±«¨ ½²®© ¢¥¹¨ ¢ °¾ª§ ª¥ § ¢¥¤®¬®
­¥². ¥¬ ± ¬»¬ ¤¨±ª°¥²­ ¿ § ¤ ·  ® °¾ª§ ª¥ ¯®°®¦¤ ¥² ¬­®¦¥±²¢® ¯¥°¥ª°»¢ ¾¹¨µ±¿ ¯®¤§ ¤ · | ²¨¯¨·­»© ¯°¨§­ ª ²®£®, ·²®
¬®¦¥² ¯°¨£®¤¨²¼±¿ ¤¨­ ¬¨·¥±ª®¥ ¯°®£° ¬¬¨°®¢ ­¨¥.  ¤¥©±²¢¨²¥«¼­®, ª ¤¨±ª°¥²­®© § ¤ ·¥ ® °¾ª§ ª¥ ®­® ¯°¨¬¥­¨¬® (±¬. ³¯° ¦­¥­¨¥ 17.2-2).
¯° ¦­¥­¨¿
17.2-1 ®ª ¦¨²¥, ·²® ¤«¿ ­¥¯°¥°»¢­®© § ¤ ·¨ ® °¾ª§ ª¥ ¢»¯®«­¥­ ¯°¨­¶¨¯ ¦ ¤­®£® ¢»¡®° .

®¤»  ´´¬¥­ 

339

17.2-2  §° ¡®² ©²¥ ®±­®¢ ­­»© ­  ¤¨­ ¬¨·¥±ª®¬ ¯°®£° ¬¬¨°®¢ ­¨¨  «£®°¨²¬ ¤«¿ °¥¸¥­¨¿ ¤¨±ª°¥²­®© § ¤ ·¨ ® °¾ª§ ª¥. «£®°¨²¬ ¤®«¦¥­ ° ¡®² ²¼ §  ¢°¥¬¿ O(nW ) (n | ª®«¨·¥±²¢® ¢¥¹¥©,
W | ¬ ª±¨¬ «¼­»© ¢¥± °¾ª§ ª ).
17.2-3 ³±²¼ ¢ ¤¨±ª°¥²­®© § ¤ ·¥ ® °¾ª§ ª¥ ¢¥¹¨ ¬®¦­® ³¯®°¿¤®·¨²¼ ² ª¨¬ ®¡° §®¬, ·²®¡» ®¤­®¢°¥¬¥­­® ¢»¯®«­¿«¨±¼ ­¥° ¢¥­±²¢  w1 6 w2 6    6 wn ¨ v1 > v2 >    > vn .  §° ¡®² ©²¥
½´´¥ª²¨¢­»©  «£®°¨²¬ ¤«¿ ­ µ®¦¤¥­¨¿ ®¯²¨¬ «¼­®£® ­ ¡®°  ¨
¤®ª ¦¨²¥, ·²® ®­ ¯° ¢¨«¥­.
17.2-4 °®´¥±±®° ¥¤¥² ¯® ¸®±±¥ ¨§ ¥²¥°¡³°£  ¢ ®±ª¢³, ¨¬¥¿
¯°¨ ±¥¡¥ ª °²³ ± ³ª § ­¨¥¬ ¢±¥µ ±²®¿¹¨µ ­  ¸®±±¥ ¡¥­§®ª®«®­®ª
¨ ° ±±²®¿­¨© ¬¥¦¤³ ­¨¬¨. §¢¥±²­® ° ±±²®¿­¨¥, ª®²®°®¥ ¬®¦¥²
¯°®¥µ ²¼ ¬ ¸¨­  ± ¯®«­®±²¼¾ § ¯° ¢«¥­­»¬ ¡ ª®¬.  §° ¡®² ©²¥ ½´´¥ª²¨¢­»©  «£®°¨²¬, ¯®§¢®«¿¾¹¨© ¢»¿±­¨²¼, ­  ª ª¨µ ¡¥­§®ª®«®­ª µ ­ ¤® § ¯° ¢«¿²¼±¿, ·²®¡» ª®«¨·¥±²¢® § ¯° ¢®ª ¡»«®
¬¨­¨¬ «¼­®. ( ­ · «¥ ¯³²¨ ¡ ª ¯®«®­.)
17.2-5  ­® n ²®·¥ª x1; x2; : : :; xn ­  ª®®°¤¨­ ²­®© ¯°¿¬®©; ²°¥¡³¥²±¿ ¯®ª°»²¼ ¢±¥ ½²¨ ²®·ª¨ ­ ¨¬¥­¼¸¨¬ ·¨±«®¬ ®²°¥§ª®¢ ¤«¨­» 1.  §° ¡®² ©²¥ ½´´¥ª²¨¢­»©  «£®°¨²¬, °¥¸ ¾¹¨© ½²³ ®¯²¨¬¨§ ¶¨®­­³¾ § ¤ ·³.
17.2-6? °¥¤¯®« £ ¿ ¨§¢¥±²­»¬ °¥¸¥­¨¥ § ¤ ·¨ 10-2, ­ ©¤¨²¥ °¥¸¥­¨¥ ­¥¯°¥°»¢­®© § ¤ ·¨ ® °¾ª§ ª¥ §  ¢°¥¬¿ O(n).

17.3. ®¤»  ´´¬¥­ 
®¤»  ´´¬¥­  ¸¨°®ª® ¨±¯®«¼§³¾²±¿ ¯°¨ ±¦ ²¨¿ ¨­´®°¬ ¶¨¨
(¢ ²¨¯¨·­®© ±¨²³ ¶¨¨ ¢»¨£°»¸ ¬®¦¥² ±®±² ¢¨²¼ ®² 20% ¤® 90% ¢
§ ¢¨±¨¬®±²¨ ®² ²¨¯  ´ ©« ). «£®°¨²¬  ´´¬¥­  ­ µ®¤¨² ®¯²¨¬ «¼­»¥ ª®¤» ±¨¬¢®«®¢ (¨±µ®¤¿ ¨§ · ±²®²» ¨±¯®«¼§®¢ ­¨¿ ½²¨µ
±¨¬¢®«®¢ ¢ ±¦¨¬ ¥¬®¬ ²¥ª±²¥) ± ¯®¬®¹¼¾ ¦ ¤­®£® ¢»¡®° .
³±²¼ ¢ ´ ©«¥ ¤«¨­» 100 000 ¨§¢¥±²­» · ±²®²» ±¨¬¢®«®¢
(°¨±. 17.3). » µ®²¨¬ ¯®±²°®¨²¼ ¤¢®¨·­»© ª®¤ (binary character
code), ¢ ª®²®°®¬ ª ¦¤»© ±¨¬¢®« ¯°¥¤±² ¢«¿¥²±¿ ¢ ¢¨¤¥ ª®­¥·­®©
¯®±«¥¤®¢ ²¥«¼­®±²¨ ¡¨²®¢, ­ §»¢ ¥¬®© ª®¤®¢»¬ ±«®¢®¬ (codeword). °¨ ¨±¯®«¼§®¢ ­¨¨ ° ¢­®¬¥°­®£® ª®¤  (xed-length code), ¢
ª®²®°®¬ ¢±¥ ª®¤®¢»¥ ±«®¢  ¨¬¥¾² ®¤¨­ ª®¢³¾ ¤«¨­³, ­  ª ¦¤»©
±¨¬¢®« (¨§ ¸¥±²¨ ¨¬¥¾¹¨µ±¿) ­ ¤® ¯®²° ²¨²¼ ª ª ¬¨­¨¬³¬ ²°¨
¡¨² , ­ ¯°¨¬¥°, a = 000; b = 001; : : :; f = 101.   ¢¥±¼ ´ ©« ³©¤¥²
300 000 ¡¨²®¢ | ­¥«¼§¿ «¨ ³¬¥­¼¸¨²¼ ½²® ·¨±«®?
¥° ¢­®¬¥°­»© ª®¤ (variable-length code) ¡³¤¥² ½ª®­®¬­¥¥, ¥±«¨
· ±²® ¢±²°¥· ¾¹¨¥±¿ ±¨¬¢®«» § ª®¤¨°®¢ ²¼ ª®°®²ª¨¬¨ ¯®±«¥¤®-

340

« ¢  17  ¤­»¥  «£®°¨²¬»
a

b

c

d

e

f

®«¨·¥±²¢® (¢ ²»±¿· µ) 45 13 12 16
9
5
 ¢­®¬¥°­»© ª®¤
000 001 010 011 100 101
¥° ¢­®¬¥°­»© ª®¤
0 101 100 111 1101 1100
 ¤ ·  ® ¢»¡®°¥ ª®¤ .  ´ ©«¥ ¤«¨­®© 100 000 ±¨¬¢®«®¢ ¢±²°¥· ¾²±¿
²®«¼ª® « ²¨­±ª¨¥ ¡³ª¢» ®² a ¤® f (¢ ² ¡«¨¶¥ ³ª § ­®, ¯® ±ª®«¼ª³ ° § ª ¦¤ ¿).
±«¨ ª ¦¤³¾ ¡³ª¢³ § ª®¤¨°®¢ ²¼ ²°¥¬¿ ¡¨² ¬¨, ²® ¢±¥£® ¡³¤¥² 300 000 ¡¨²®¢.
±«¨ ¨±¯®«¼§®¢ ²¼ ­¥° ¢­®¬¥°­»© ª®¤ (­¨¦­¿¿ ±²°®ª ), ²® ¤®±² ²®·­® 224 000
¡¨²®¢.
¨±. 17.3

¢ ²¥«¼­®±²¿¬¨ ¡¨²®¢,   °¥¤ª® ¢±²°¥· ¾¹¨¥±¿ | ¤«¨­­»¬¨. ¤¨­
² ª®© ª®¤ ¯®ª § ­ ­  °¨±. 17.3: ¡³ª¢  a ¨§®¡° ¦ ¥²±¿ ®¤­®¡¨²®¢®©
¯®±«¥¤®¢ ²¥«¼­®±²¼¾ 0,   ¡³ª¢  f | ·¥²»°¥µ¡¨²®¢®© ¯®±«¥¤®¢ ²¥«¼­®±²¼¾ 1100. °¨ ² ª®© ª®¤¨°®¢ª¥ ­  ¢¥±¼ ´ ©« ³©¤¥²
(45  1 + 13  3 + 12  3 + 16  3 + 9  4 + 5  4)  1000 = 224 000
¡¨²®¢, ·²® ¤ ¥² ®ª®«® 25% ½ª®­®¬¨¨. ( «¥¥ ¬» ³¢¨¤¨¬, ·²® ½²®²
ª®¤ ¡³¤¥² ®¯²¨¬ «¼­»¬.)
°¥´¨ª±­»¥ ª®¤»
» ¡³¤¥¬ ° ±±¬ ²°¨¢ ²¼ ²®«¼ª® ª®¤», ¢ ª®²®°»µ ¨§ ¤¢³µ ¯®±«¥¤®¢ ²¥«¼­®±²¥© ¡¨²®¢, ¯°¥¤±² ¢«¿¾¹¨µ ° §«¨·­»¥ ±¨¬¢®«», ­¨
®¤­  ­¥ ¿¢«¿¥²±¿ ¯°¥´¨ª±®¬ ¤°³£®©.  ª¨¥ ª®¤» ­ §»¢ ¾²±¿ ¯°¥´¨ª±­»¬¨ ª®¤ ¬¨ (prex codes; ² ª®¢ ®¡¹¥¯°¨­¿²»© ²¥°¬¨­, µ®²¿
«®£¨·­¥¥ ¡»«® ¡» ­ §»¢ ²¼ ¨µ À¡¥±¯°¥´¨ª±­»¬¨Á ª®¤ ¬¨). ®¦­®
¯®ª § ²¼ (¬» ½²®£® ¤¥« ²¼ ­¥ ¡³¤¥¬), ·²® ¤«¿ «¾¡®£® ª®¤ , ®¡¥±¯¥·¨¢ ¾¹¥£® ®¤­®§­ ·­®¥ ¢®±±² ­®¢«¥­¨¥ ¨­´®°¬ ¶¨¨, ±³¹¥±²¢³¥²
­¥ µ³¤¸¨© ¥£® ¯°¥´¨ª±­»© ª®¤, ² ª ·²® ¬» ­¨·¥£® ­¥ ²¥°¿¥¬.
°¨ ª®¤¨°®¢ ­¨¨ ª ¦¤»© ±¨¬¢®« § ¬¥­¿¥²±¿ ­  ±¢®© ª®¤.  ¯°¨¬¥°, ¤«¿ ­¥° ¢­®¬¥°­®£® ª®¤  °¨±. 17.3 ±²°®ª  abc § ¯¨¸¥²±¿
ª ª 0101100. «¿ ¯°¥´¨ª±­®£® ª®¤  ¤¥ª®¤¨°®¢ ­¨¥ ®¤­®§­ ·­® ¨
¢»¯®«­¿¥²±¿ ±«¥¢  ­ ¯° ¢®. ¥°¢»© ±¨¬¢®« ²¥ª±² , § ª®¤¨°®¢ ­­®£® ¯°¥´¨ª±­»¬ ª®¤®¬, ®¯°¥¤¥«¿¥²±¿ ®¤­®§­ ·­®, ² ª ª ª ª®¤¨°³¾¹ ¿ ¥£® ¯®±«¥¤®¢ ²¥«¼­®±²¼ ­¥ ¬®¦¥² ¡»²¼ ­ · «®¬ ª®¤  ª ª®£®²® ¨­®£® ±¨¬¢®« .  ©¤¿ ½²®² ¯¥°¢»© ±¨¬¢®« ¨ ®²¡°®±¨¢ ª®¤¨°®¢ ¢¸³¾ ¥£® ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¡¨²®¢, ¬» ¯®¢²®°¿¥¬ ¯°®¶¥±± ¤«¿
®±² ¢¸¨µ±¿ ¡¨²®¢, ¨ ² ª ¤ «¥¥.  ¯°¨¬¥°, ±²°®ª  001011101 (¯°¨
¨±¯®«¼§®¢ ­¨¨ ­¥° ¢­®¬¥°­®£® ª®¤  °¨±. 17.3) ° §¡¨¢ ¥²±¿ ­  · ±²¨ 0 0 101 1101 ¨ ¤¥ª®¤¨°³¥²±¿ ª ª aabe.
«¿ ½´´¥ª²¨¢­®© °¥ «¨§ ¶¨¨ ¤¥ª®¤¨°®¢ ­¨¿ ­ ¤® µ° ­¨²¼ ¨­´®°¬ ¶¨¾ ® ª®¤¥ ¢ ³¤®¡­®© ´®°¬¥. ¤­  ¨§ ¢®§¬®¦­®±²¥© | ¯°¥¤±² ¢¨²¼ ª®¤ ¢ ¢¨¤¥ ¤¢®¨·­®£® ¤¥°¥¢ , «¨±²¼¿ ª®²®°®£® ±®®²¢¥²±²¢³¾² ª®¤¨°³¥¬»¬ ±¨¬¢®« ¬. °¨ ½²®¬ ¯³²¼ ®² ¢¥°¸¨­» ¤¥°¥¢  ¤® ª®¤¨°³¥¬®£® ±¨¬¢®«  ®¯°¥¤¥«¿¥² ª®¤¨°³¾¹³¾ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¡¨²®¢: ¯®¢®°®² ­ «¥¢® ¤ ¥² 0,   ¯®¢®°®² ­ ¯° ¢® | 1.

®¤»  ´´¬¥­ 

341

¨±. 17.4 ¥°¥¢¼¿, ±®®²¢¥²±²¢³¾¹¨¥ ¤¢³¬ ª®¤ ¬ °¨±. 17.3.  ª ¦¤®¬ «¨±²¥
³ª § ­ ±®®²¢¥²±²¢³¾¹¨© ±¨¬¢®« ¨ · ±²®²  ¥£® ¨±¯®«¼§®¢ ­¨¿ ¢ ²¥ª±²¥. ® ¢­³²°¥­­¨µ ³§« µ ³ª § ­  ±³¬¬  · ±²®² ¤«¿ «¨±²¼¥¢ ±®®²¢¥²±²¢³¾¹¥£® ¯®¤¤¥°¥¢ .
( ) ¥°¥¢®, ±®®²¢¥²±²¢³¾¹¥¥ ° ¢­®¬¥°­®¬³ ª®¤³ a = 000; : : : ; f = 100. (¡) ¥°¥¢®, ±®®²¢¥²±²¢³¾¹¥¥ ®¯²¨¬ «¼­®¬³ ¯°¥´¨ª±­®¬³ ª®¤³ a = 0; b = 101; : : : ; f =
1100.

  °¨±. 17.4 ¨§®¡° ¦¥­» ¤¥°¥¢¼¿, ±®®²¢¥²±²¢³¾¹¨¥ ¤¢³¬ ª®¤ ¬
°¨±. 17.3.
¯²¨¬ «¼­®¬³ (¤«¿ ¤ ­­®£® ´ ©« ) ª®¤³ ¢±¥£¤  ±®®²¢¥²±²¢³¥²
¤¢®¨·­®¥ ¤¥°¥¢®, ¢ ª®²®°®¬ ¢±¿ª ¿ ¢¥°¸¨­ , ­¥ ¿¢«¿¾¹ ¿±¿ «¨±²®¬, ¨¬¥¥² ¤¢®¨µ ¤¥²¥© (±¬. ³¯° ¦­¥­¨¥ 17.3-1).  · ±²­®±²¨,
° ¢­®¬¥°­»© ª®¤ ¨§ ­ ¸¥£® ¯°¨¬¥°  ®¯²¨¬ «¼­»¬ ¡»²¼ ­¥ ¬®¦¥²,
² ª ª ª ¢ ±®®²¢¥²±²¢³¾¹¥¬ ¤¥°¥¢¥ (°¨±. 17.4 ) ¥±²¼ ¢¥°¸¨­  ± ®¤­¨¬ °¥¡¥­ª®¬ (ª®¤» ­¥ª®²®°»µ ±¨¬¢®«®¢ ­ ·¨­ ¾²±¿ ± 10 : : : , ­®
­¨ ®¤¨­ ª®¤ ±¨¬¢®«  ­¥ ­ ·¨­ ¥²±¿ ± 11 : : : ).  ª®¥ ±¢®©±²¢® ®¯²¨¬ «¼­®£® ª®¤  ¯®§¢®«¿¥² «¥£ª® ¤®ª § ²¼, ·²® ¤¥°¥¢® ®¯²¨¬ «¼­®£®
¯°¥´¨ª±­®£® ª®¤  ¤«¿ ´ ©« , ¢ ª®²®°®¬ ¨±¯®«¼§³¾²±¿ ¢±¥ ±¨¬¢®«»
¨§ ­¥ª®²®°®£® ¬­®¦¥±²¢  C ¨ ²®«¼ª® ®­¨, ±®¤¥°¦¨² °®¢­® jC j «¨±²¼¥¢, ¯® ®¤­®¬³ ­  ª ¦¤»© ±¨¬¢®«, ¨ °®¢­® jC j ; 1 ³§«®¢, ­¥ ¿¢«¿¾¹¨µ±¿ «¨±²¼¿¬¨.
­ ¿ ¤¥°¥¢® T , ±®®²¢¥²±²¢³¾¹¥¥ ¯°¥´¨ª±­®¬³ ª®¤³, «¥£ª® ­ ©²¨
ª®«¨·¥±²¢® ¡¨²®¢, ­¥®¡µ®¤¨¬®¥ ¤«¿ ª®¤¨°®¢ ­¨¿ ´ ©« . ¬¥­­®,
¤«¿ ª ¦¤®£® ±¨¬¢®«  c ¨§  «´ ¢¨²  C ¯³±²¼ f [c] ®¡®§­ · ¥² ·¨±«®
¥£® ¢µ®¦¤¥­¨© ¢ ´ ©«,   dT (c) | £«³¡¨­³ ±®®²¢¥²±²¢³¾¹¥£® «¨±² 
¢ ¤¥°¥¢¥ ¨«¨, ·²® ²® ¦¥ ± ¬®¥, ¤«¨­³ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¡¨²®¢,
ª®¤¨°³¾¹¥© c. ®£¤  ¤«¿ ª®¤¨°®¢ ­¨¿ ´ ©«  ¯®²°¥¡³¥²±¿

B (T ) =

X

c2C

f [c]dT (c)

¡¨²®¢.  §®¢¥¬ ½²® ·¨±«® ±²®¨¬®±²¼¾ (cost) ¤¥°¥¢  T .

(17.3)

342

« ¢  17  ¤­»¥  «£®°¨²¬»

®±²°®¥­¨¥ ª®¤   ´´¬¥­ 
 ´´¬¥­ ¯®±²°®¨« ¦ ¤­»©  «£®°¨²¬, ª®²®°»© ±²°®¨² ®¯²¨¬ «¼­»© ¯°¥´¨ª±­»© ª®¤. ²®² ª®¤ ­ §»¢ ¥²±¿ ª®¤®¬  ´´¬¥­  (Human code). «£®°¨²¬ ±²°®¨² ¤¥°¥¢® T , ±®®²¢¥²±²¢³¾¹¥¥
®¯²¨¬ «¼­®¬³ ª®¤³, ±­¨§³ ¢¢¥°µ, ­ ·¨­ ¿ ± ¬­®¦¥±²¢  ¨§ jC j «¨±²¼¥¢ ¨ ¤¥« ¿ jC j ; 1 À±«¨¿­¨©Á. » ¯°¥¤¯®« £ ¥¬, ·²® ¤«¿ ª ¦¤®£® ±¨¬¢®«  c 2 C § ¤ ­  ¥£® · ±²®²  f [c]. «¿ ­ µ®¦¤¥­¨¿ ¤¢³µ
®¡º¥ª²®¢, ¯®¤«¥¦ ¹¨µ ±«¨¿­¨¾, ¨±¯®«¼§³¥²±¿ ®·¥°¥¤¼ ± ¯°¨®°¨²¥² ¬¨ Q, ¨±¯®«¼§³¾¹ ¿ · ±²®²» f ¢ ª ·¥±²¢¥ ° ­£®¢ | ±«¨¢ ¾²±¿
¤¢  ®¡º¥ª²  ± ­ ¨¬¥­¼¸¨¬¨ · ±²®² ¬¨.  °¥§³«¼² ²¥ ±«¨¿­¨¿ ¯®«³· ¥²±¿ ­®¢»© ®¡º¥ª² (¢­³²°¥­­¿¿ ¢¥°¸¨­ ), · ±²®²  ª®²®°®£®
±·¨² ¥²±¿ ° ¢­®© ±³¬¬¥ · ±²®² ¤¢³µ ±«¨¢ ¥¬»µ ®¡º¥ª²®¢.
Huffman(C )
1 n jC j
2 Q C
3 for i 1 to n ; 1
4
do z Allocate-Node()
5
x left[z] Extract-Min(Q)
6
y right[z ] Extract-Min(Q)
7
f [z ] f [x] + f [y]
8
Insert(Q; z )
9 return Extract-Min(Q)
 ¡®²  ½²®£®  «£®°¨²¬  ¤«¿ ­ ¸¥£® ¯°¨¬¥°  ¯®ª § ­  ­ 
°¨±. 17.5. ®±ª®«¼ª³ ¨¬¥¥²±¿ ¢±¥£® 6 ¡³ª¢, ¯¥°¢®­ · «¼­® ®·¥°¥¤¼
¨¬¥¥² ° §¬¥° n = 6, ¨ ¤«¿ ¯®±²°®¥­¨¿ ¤¥°¥¢  ­³¦­® ±¤¥« ²¼
5 ±«¨¿­¨©. °¥´¨ª±­»© ª®¤ ±®®²¢¥²±²¢³¥² ¤¥°¥¢³, ¯®«³·¥­­®¬³ ¢
°¥§³«¼² ²¥ ¢±¥µ ½²¨µ ±«¨¿­¨©.
 ±²°®ª¥ 2  «£®°¨²¬  ¢ ®·¥°¥¤¼ Q ¯®¬¥¹ ¾²±¿ ±¨¬¢®«» ¨§  «´ ¢¨²  C (± ±®®²¢¥²±²¢³¾¹¨¬¨ · ±²®² ¬¨).  ¶¨ª«¥ (±²°®ª¨ 3{8)
¯®¢²®°¿¥²±¿ n ; 1 ° § ±«¥¤³¾¹ ¿ ®¯¥° ¶¨¿: ¨§ ®·¥°¥¤¨ ¨§»¬ ¾²±¿
¤¢¥ ¢¥°¸¨­» x ¨ y ± ­ ¨¬¥­¼¸¨¬¨ · ±²®² ¬¨ f [x] ¨ f [y ], ª®²®°»¥
§ ¬¥­¿¾²±¿ ­  ®¤­³ ¢¥°¸¨­³ z ± · ±²®²®© f [x] + f [y ] ¨ ¤¥²¼¬¨ x ¨
y (ª®£® ¨§ ­¨µ ±·¨² ²¼ «¥¢»¬ °¥¡¥­ª®¬,   ª®£® ¯° ¢»¬ | ­¥¢ ¦­®: ª®¤ ¯®«³·¨²±¿ ¤°³£®©, ­® ¥£® ±²®¨¬®±²¼ ¡³¤¥² ²  ¦¥).  ª®­¶¥
¢ ®·¥°¥¤¨ ®±² ¥²±¿ ®¤¨­ ³§¥« | ª®°¥­¼ ¯®±²°®¥­­®£® ¤¢®¨·­®£®
¤¥°¥¢ . ±»«ª  ­  ­¥£® ¢®§¢° ¹ ¥²±¿ ¢ ±²°®ª¥ 9.
¶¥­¨¬ ¢°¥¬¿ ° ¡®²»  «£®°¨²¬ , ±·¨² ¿, ·²® ®·¥°¥¤¼ Q °¥ «¨§®¢ ­  ¢ ¢¨¤¥ ¤¢®¨·­®© ª³·¨ (±¬. £« ¢³ 7). ­¨¶¨ «¨§ ¶¨¾ Q ¢
±²°®ª¥ 2 ¬®¦­® ¯°®¢¥±²¨ §  O(n) ®¯¥° ¶¨© ± ¯®¬®¹¼¾ ¯°®¶¥¤³°»
Build-Heap ¨§ ° §¤¥«  7.3. ¨ª« ¢ ±²°®ª µ 3{8 ¨±¯®«­¿¥²±¿ °®¢­® n ; 1 ° §; ¯®±ª®«¼ª³ ª ¦¤ ¿ ®¯¥° ¶¨¿ ± ª³·¥© ²°¥¡³¥² ¢°¥¬¥­¨
O(log n), ®¡¹¥¥ ¢°¥¬¿ ¡³¤¥² O(n log n). ² «® ¡»²¼, ¢°¥¬¿ ° ¡®²»
 «£®°¨²¬  Huffman ¤«¿  «´ ¢¨²  ¨§ n ±¨¬¢®«®¢ ¡³¤¥² O(n log n).

®¤»  ´´¬¥­ 

343

°¨¬¥­¥­¨¥  «£®°¨²¬   ´´¬¥­  ª ² ¡«¨¶¥ · ±²®² °¨±. 17.3. ®ª § ­» ¯®±«¥¤®¢ ²¥«¼­»¥ ±®±²®¿­¨¿ ®·¥°¥¤¨ (¢ ¯®°¿¤ª¥ ¢®§° ±² ­¨¿ · ±²®²).  
ª ¦¤®¬ ¸ £¥ ±«¨¢ ¾²±¿ ¤¢  ¯®¤¤¥°¥¢  ± ­ ¨¬¥­¼¸¨¬¨ · ±²®² ¬¨. ¨±²¼¿ |
¯°¿¬®³£®«¼­¨ª¨, ¢ ª®²®°»µ ±¨¬¢®« ¨ ¥£® · ±²®²  ° §¤¥«¥­» ¤¢®¥²®·¨¥¬. ­³²°¥­­¨¥ ¢¥°¸¨­» ¨§®¡° ¦¥­» ª°³¦ª ¬¨, ¢ ª®²®°»µ ³ª § ­» ±³¬¬» · ±²®² ¨µ
¤¥²¥©. ¥¡°®, ¨¤³¹¥¥ ª «¥¢®¬³ °¥¡¥­ª³, ¯®¬¥·¥­® ­³«¥¬, ª ¯° ¢®¬³ | ¥¤¨­¨¶¥©.  °¥§³«¼²¨°³¾¹¥¬ ¤¥°¥¢¥ ª®¤ «¾¡®£® ±¨¬¢®«  ­ ¯¨± ­ ­  ¯³²¨, ¢¥¤³¹¥¬
¨§ ª®°­¿ ª ½²®¬³ ±¨¬¢®«³. ( )  · «¼­ ¿ ±² ¤¨¿: n = 6 «¨±²¼¥¢, ¯® ®¤­®¬³ ­ 
±¨¬¢®«. (¡){(¤) °®¬¥¦³²®·­»¥ ±² ¤¨¨. (¥) ®²®¢®¥ ¤¥°¥¢®.
¨±. 17.5

° ¢¨«¼­®±²¼  «£®°¨²¬   ´´¬¥­ 
²®¡» ¤®ª § ²¼, ·²® ¦ ¤­»©  «£®°¨²¬ Huffman ¤¥©±²¢¨²¥«¼­® ¤ ¥² ®¯²¨¬³¬, ¬» ¯®ª ¦¥¬, ·²® ¤«¿ § ¤ ·¨ ®¡ ®¯²¨¬ «¼­®¬
¯°¥´¨ª±­®¬ ª®¤¥ ¢»¯®«­¥­» ¯°¨­¶¨¯ ¦ ¤­®£® ¢»¡®°  ¨ ±¢®©±²¢®
®¯²¨¬ «¼­®±²¨ ¤«¿ ¯®¤§ ¤ ·.  ·­¥¬ ± ¯°¨­¶¨¯  ¦ ¤­®£® ¢»¡®° .
¥¬¬  17.2. ³±²¼ ¢  «´ ¢¨²¥ C ª ¦¤»© ±¨¬¢®« c 2 C ¨¬¥¥² · ±²®²³ f [c]. ³±²¼ x; y 2 C | ¤¢  ±¨¬¢®«  ± ­ ¨¬¥­¼¸¨¬¨ · ±²®² ¬¨. ®£¤  ¤«¿ C ±³¹¥±²¢³¥² ®¯²¨¬ «¼­»© ¯°¥´¨ª±­»© ª®¤, ¢
ª®²®°®¬ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¡¨²®¢, ª®¤¨°³¾¹¨¥ x ¨ y , ¨¬¥¾²
®¤¨­ ª®¢³¾ ¤«¨­³ ¨ ° §«¨· ¾²±¿ ²®«¼ª® ¢ ¯®±«¥¤­¥¬ ¡¨²¥.
®ª § ²¥«¼±²¢®. ²¢¥°¦¤¥­¨¥ «¥¬¬» ¡³¤¥² ¢»¯®«­¥­®, ¥±«¨ «¨±²¼¿, ±®®²¢¥²±²¢³¾¹¨¥ x ¨ y , ¡³¤³² ¡° ²¼¿¬¨.  ±±¬®²°¨¬ ¤¥°¥¢® T , ±®®²¢¥²±²¢³¾¹¥¥ ¯°®¨§¢®«¼­®¬³ ®¯²¨¬ «¼­®¬³ ¯°¥´¨ª±­®-

344

« ¢  17  ¤­»¥  «£®°¨²¬»

®ª § ²¥«¼±²¢® «¥¬¬» 17.2. ¤¥±¼ b ¨ c | ­ ¨¡®«¥¥ ³¤ «¥­­»¥ ®²
ª®°­¿ «¨±²¼¿-¡° ²¼¿,   x ¨ y | «¨±²¼¿ ± ­ ¨¬¥­¼¸¨¬¨ · ±²®² ¬¨. ¡¬¥­ x ¨
b ¯°¥¢° ¹ ¥² ¤¥°¥¢® T ¢ T 0 ,   ®¡¬¥­ y ¨ c ¯°¥¢° ¹ ¥² T 0 ¢ T 00 . °¨ ª ¦¤®© ¨§
¯¥°¥±² ­®¢®ª ±²®¨¬®±²¼ ¤¥°¥¢  ­¥ ¢®§° ±² ¥².
¨±. 17.6

¬³ ª®¤³, ¨ ¯®ª ¦¥¬, ·²® ¥£® ¬®¦­® ¬®¤¨´¨¶¨°®¢ ²¼, ­¥ ­ °³¸ ¿
®¯²¨¬ «¼­®±²¨, ² ª, ·²®¡» ¢»¸¥³ª § ­­®¥ ³±«®¢¨¥ ¢»¯®«­¿«®±¼.
 ± ¬®¬ ¤¥«¥, ° ±±¬®²°¨¬ ¯ °³ ±®±¥¤­¨µ (¨¬¥¾¹¨µ ®¡¹¥£® °®¤¨²¥«¿) «¨±²¼¥¢ ¢ ¤¥°¥¢¥ T , ­ µ®¤¿¹³¾±¿ ­  ¬ ª±¨¬ «¼­®¬ ° ±±²®¿­¨¨ ®² ª®°­¿. ( ª¨¥ ±³¹¥±²¢³¾²: ¢ ®¯²¨¬ «¼­®¬ ¤¥°¥¢¥ ¢±¥ ¢­³²°¥­­¨¥ ¢¥°¸¨­» ¨¬¥¾² ±²¥¯¥­¼ 2, ¨ ¯®²®¬³ «¨±² ­ ¨¡®«¼¸¥© £«³¡¨­» ¨¬¥¥² ¡° ² .) ¨¬¢®«», ±²®¿¹¨¥ ¢ ½²¨µ «¨±²¼¿µ (­ §®¢¥¬ ¨µ
b ¨ c) | ­¥ ®¡¿§ ²¥«¼­® x ¨ y , ­® § ¢¥¤®¬® ¨¬¥¾² ­¥ ¬¥­¼¸¨¥ · ±²®²» (¯®±ª®«¼ª³ x ¨ y ¡»«¨ ¤¢³¬¿ ­ ¨¡®«¥¥ °¥¤ª¨¬¨ ±¨¬¢®« ¬¨). ¥
®£° ­¨·¨¢ ¿ ®¡¹­®±²¨, ¬®¦­® ±·¨² ²¼, ·²® f [x] 6 f [b] ¨ f [y ] 6 f [c].
¥¯¥°¼ ¯®¬¥­¿¥¬ ¬¥±² ¬¨ ¢ ¤¥°¥¢¥ T ±¨¬¢®«» b ¨ x (¯®«³·¥­­®¥
¤¥°¥¢® ­ §®¢¥¬ T 0 ),   § ²¥¬ ±¨¬¢®«» c ¨ y (¯®«³·¥­­®¥ ¤¥°¥¢® ­ §®¢¥¬ T 00 ). ®±«¥ ² ª¨µ ®¡¬¥­®¢ x ¨ y (±¬. ¯°¨¬¥° ­  °¨±. 17.6)
±² ­³² ¡° ²¼¿¬¨, ­ µ®¤¿¹¨¬¨±¿ ­  ¬ ª±¨¬ «¼­®© £«³¡¨­¥. ±² «®±¼ ³¡¥¤¨²¼±¿, ·²® ¯°¨ ®¡¬¥­ µ ±²®¨¬®±²¼ ¤¥°¥¢  ­¥ ¢®§° ±² ¥² ¨,
±«¥¤®¢ ²¥«¼­®, ¤¥°¥¢® T 00 ² ª¦¥ ¿¢«¿¥²±¿ ®¯²¨¬ «¼­»¬. °³£¨¬¨
±«®¢ ¬¨, ¬» ¤®«¦­» ¯°®¢¥°¨²¼, ·²® B (T ) > B (T 0 ) > B (T 00 ), £¤¥ B
| ´³­ª¶¨¿ ±²®¨¬®±²¨.  ± ¬®¬ ¤¥«¥, ±²®¨¬®±²¼ ®¯°¥¤¥«¿¥²±¿ ª ª
±³¬¬  ¯® ¢±¥¬ «¨±²¼¿¬ ¯°®¨§¢¥¤¥­¨© · ±²®²» ­  £«³¡¨­³ (17.3).
°¨ ¯¥°¥µ®¤¥ ®² T ª T 0 ¢ ½²®© ±³¬¬¥ ¬¥­¿¾²±¿ ²®«¼ª® ¤¢  ±« £ ¥¬»µ: f [b]dT (b) + f [x]dT (x) § ¬¥­¿¥²±¿ ­  f [b]dT 0 (b) + f [x]dT 0 (x), ². ¥.
­  f [b]dT (x) + f [x]dT (b).  ª¨¬ ®¡° §®¬,

B (T ) ; B (T 0) = f [b]dT (b) + f [x]dT (x) ; f [b]dT (x) ; f [x]dT (b) =
= (f [b] ; f [x])(dT (b) ; dT (x)) > 0:
¡¥ ±ª®¡ª¨ ­¥®²°¨¶ ²¥«¼­»: ¢±¯®¬­¨¬, ·²® f [x] 6 f [b] ¨ ·²®
dT (b) > dT (x), ² ª ª ª «¨±² b ¡»« ®¤­¨¬ ¨§ ­ ¨¡®«¥¥ ³¤ «¥­­»µ
®² ª®°­¿. ­ «®£¨·­»¬ ®¡° §®¬ B (T 0 ) > B (T 00 ), ² ª ·²® B (T ) >
B(T 00 ), ¨ ¯®½²®¬³ T 00 ² ª¦¥ ®¯²¨¬ «¼­® (  ¢±¥ ­ ¸¨ ­¥° ¢¥­±²¢ 

¿¢«¿¾²±¿ ° ¢¥­±²¢ ¬¨). ¥¬¬  ¤®ª § ­ .
®ª § ­­ ¿ «¥¬¬  ¯®ª §»¢ ¥², ·²® ¯®±²°®¥­¨¥ ®¯²¨¬ «¼­®£® ¤¥°¥¢  ¢±¥£¤  ¬®¦­® ­ · ²¼ ±® ±«¨¿­¨¿ ¤¢³µ ±¨¬¢®«®¢ ± ­ ¨¬¥­¼¸¥©
· ±²®²®©. «¥¤³¾¹¥¥ ­ ¡«¾¤¥­¨¥ ®¯° ¢¤»¢ ¥² ­ §¢ ­¨¥ À¦ ¤­»©Á
¤«¿ ² ª®£®  «£®°¨²¬ .  §®¢¥¬ ±²®¨¬®±²¼¾ ±«¨¿­¨¿ ±³¬¬³ · ±²®²

®¤»  ´´¬¥­ 

345

±«¨¢ ¥¬»µ ³§«®¢.  ³¯° ¦­¥­¨¨ 17.3-3 ¬» ¯°¥¤«®¦¨¬ ¢ ¬ ¤®ª § ²¼, ·²® ±²®¨¬®±²¼ ¤¥°¥¢  ° ¢­  ±³¬¬¥ ±²®¨¬®±²¥© ¢±¥µ ±«¨¿­¨©,
­¥®¡µ®¤¨¬»µ ¤«¿ ¥£® ¯®±²°®¥­¨¿. ² «® ¡»²¼,  «£®°¨²¬ Huffman
­  ª ¦¤®¬ ¸ £¥ ¢»¡¨° ¥² ±«¨¿­¨¥, ­ ¨¬¥­¥¥ ³¢¥«¨·¨¢ ¾¹¥¥ ±²®¨¬®±²¼.
¥¯¥°¼ ³±² ­®¢¨¬ ±¢®©±²¢® ®¯²¨¬ «¼­®±²¨ ¤«¿ ¯®¤§ ¤ ·.
³±²¼ ´¨ª±¨°®¢ ­  «´ ¢¨² C ¨ ¤¢  ±¨¬¢®«  x, y ½²®£®  «´ ¢¨² ,
  C 0 |  «´ ¢¨², ª®²®°»© ¯®«³·¨²±¿ ¨§ C , ¥±«¨ ¢»ª¨­³²¼ x ¨ y ¨
¤®¡ ¢¨²¼ ­®¢»© ±¨¬¢®« z .
 ±±¬®²°¨¬ ª®¤®¢»¥ ¤¥°¥¢¼¿ ¤«¿ C , ¢ ª®²®°»µ x ¨ y (²®·­¥¥, ±®®²¢¥²±²¢³¾¹¨¥ ¨¬ «¨±²¼¿) ¿¢«¿¾²±¿ ¡° ²¼¿¬¨.  ¦¤®¬³ ² ª®¬³
¤¥°¥¢³ ±®®²¢¥²±²¢³¥² ª®¤®¢®¥ ¤¥°¥¢® ¤«¿ C 0 , ª®²®°®¥ ¯®«³·¨²±¿,
¥±«¨ ¢»¡°®±¨²¼ ¢¥°¸¨­» x ¨ y ,   ¨µ ®¡¹¥£® °®¤¨²¥«¿ ±·¨² ²¼ ª®¤®¬ ±¨¬¢®«  z .
°¨ ½²®¬ ±®®²¢¥²±²¢¨¨ ª ¦¤®¬³ ª®¤®¢®¬³ ¤¥°¥¢³ ¤«¿ C 0 ±®®²¢¥²±²¢³¥² °®¢­® ¤¢  ª®¤®¢»µ ¤¥°¥¢  ¤«¿ C (¢ ®¤­®¬ ¨§ ­¨µ x ¡³¤¥²
«¥¢»¬ °¥¡¥­ª®¬, ¢ ¤°³£®¬ | ¯° ¢»¬).
³±²¼ ¤«¿ ª ¦¤®£® ±¨¬¢®«  c ¨§ C ´¨ª±¨°®¢ ­  ¥£® · ±²®²  f [c].
¯°¥¤¥«¨¬ · ±²®²» ¤«¿ ±¨¬¢®«®¢ ¨§ C 0 , ±·¨² ¿ · ±²®²®© ±¨¬¢®«  z
±³¬¬³ f [x] + f [y ]; ¤«¿ ®±² «¼­»µ ±¨¬¢®«®¢ · ±²®²» ®±² ¾²±¿ ²¥¬¨
¦¥, ·²® ¨ ¢ C . ®£¤  ¤«¿ ª®¤®¢»µ ¤¥°¥¢¼¥¢ (¤«¿ ®¡®¨µ  «´ ¢¨²®¢)
®¯°¥¤¥«¥­» ±²®¨¬®±²¨.
¥¬¬  17.3. ²®¨¬®±²¨ ±®®²¢¥²±²¢³¾¹¨µ ¤°³£ ¤°³£³ ¤¥°¥¢¼¥¢
T ¨ T 0 (¯°¨ ®¯¨± ­­®¬ ±®®²¢¥²±²¢¨¨) ®²«¨· ¾²±¿ ­  ¢¥«¨·¨­³
f [x] + f [y].
®ª § ²¥«¼±²¢®. ¥£ª® ¢¨¤¥²¼, ·²® dT (c) = dT 0 (c) ¤«¿ ¢±¥µ c 2
C n fx; y g,   ² ª¦¥ ·²® dT (x) = dT (y ) = dT 0 (z) + 1. «¥¤®¢ ²¥«¼­®,

f [x]dT (x) + f [y ]dT (y ) = (f [x] + f [y ])(dT 0(z) + 1) =
= f [z ]dT 0 (z ) + (f [x] + f [y ]);
®²ª³¤  B (T ) = B (T 0 ) + f [x] + f [y ].
²  «¥¬¬  ¯®ª §»¢ ¥², ·²® ¢»¯®«­¥­® ±¢®©±²¢® ®¯²¨¬ «¼­®±²¨
¤«¿ ¯®¤§ ¤ · (®¯²¨¬ «¼­®¥ ¤¥°¥¢® T ±®®²¢¥²±²¢³¥² ®¯²¨¬ «¼­®¬³
¤¥°¥¢³ T 0 ¤«¿ ¬¥­¼¸¥© § ¤ ·¨).
§ ¤¢³µ ¤®ª § ­­»µ «¥¬¬ «¥£ª® ±«¥¤³¥²
¥®°¥¬  17.4. «£®°¨²¬ Huffman ±²°®¨² ®¯²¨¬ «¼­»© ¯°¥´¨ª±­»© ª®¤.
®ª § ²¥«¼±²¢®. ¥¬¬  17.2 ¯®ª §»¢ ¥², ·²® ®¯²¨¬ «¼­»¥ ª®¤®¢»¥ ¤¥°¥¢¼¿ ¬®¦­® ¨±ª ²¼ ±°¥¤¨ ² ª¨µ, ³ ª®²®°»µ ¤¢  ­ ¨¡®«¥¥
°¥¤ª¨µ ±¨¬¢®«  (­ §®¢¥¬ ¨§ x ¨ y ) ¿¢«¿¾²±¿ ¡° ²¼¿¬¨. ¬ ±®®²¢¥²±²¢³¾² ¤¥°¥¢¼¿ ¤«¿  «´ ¢¨²  C 0, ¢ ª®²®°®¬ ±¨¬¢®«» x ¨ y ±«¨²» ¢
®¤¨­ ±¨¬¢®« z . ·¨² ¿ · ±²®²³ ±¨¬¢®«  z ° ¢­®© ±³¬¬¥ · ±²®² x ¨

346

« ¢  17  ¤­»¥  «£®°¨²¬»

y, ¬®¦­® ¯°¨¬¥­¨²¼ «¥¬¬³ 17.3 ¨ ³¢¨¤¥²¼, ·²® ­ ¬ ®±² ¥²±¿ ­ ©²¨
®¯²¨¬ «¼­®¥ ª®¤®¢®¥ ¤¥°¥¢® ¤«¿  «´ ¢¨²  C 0 ¨ § ²¥¬ ¤®¡ ¢¨²¼ ª
¢¥°¸¨­¥ z ¤¢³µ ¤¥²¥©, ¯®¬¥·¥­­»µ ±¨¬¢®« ¬¨ x ¨ y . ²® ¨ ¤¥« ¥²

 «£®°¨²¬ Huffman.
¯° ¦­¥­¨¿

17.3-1 ®ª ¦¨²¥, ·²® ¢ ¡¨­ °­®¬ ¤¥°¥¢¥, ±®®²¢¥²±²¢³¾¹¥¬
®¯²¨¬ «¼­®¬³ ¯°¥´¨ª±­®¬³ ª®¤³, ¢±¿ª ¿ ¢¥°¸¨­  «¨¡® ¿¢«¿¥²±¿
«¨±²®¬, «¨¡® ¨¬¥¥² ¤¢³µ ¤¥²¥©.
17.3-2  ©¤¨²¥ ª®¤  ´´¬¥­  ¤«¿  «´ ¢¨² , ¢ ª®²®°®¬ · ±²®²»
±¨¬¢®«®¢ ±®¢¯ ¤ ¾² ± ¯¥°¢»¬¨ ¢®±¥¬¼¾ ·¨±« ¬¨ ¨¡®­ ··¨:
a : 1 b : 1 c : 2 d : 3 e : 5 f : 8 g : 13 h : 21:
²® ¡³¤¥², ¥±«¨ ¢  «´ ¢¨²¥ n ±¨¬¢®«®¢, · ±²®²» ª®²®°»µ ±®¢¯ ¤ ¾² ± ¯¥°¢»¬¨ n ·¨±« ¬¨ ¨¡®­ ··¨?
17.3-3 ®ª ¦¨²¥, ·²® ±²®¨¬®±²¼ ¤¢®¨·­®£® ¤¥°¥¢ , ±®®²¢¥²±²¢³¾¹¥£® ¯°¥´¨ª±­®¬³ ª®¤³, ¬®¦­® ¢»·¨±«¨²¼ ±«¥¤³¾¹¨¬ ®¡° §®¬:
¤«¿ ª ¦¤®© ¢¥°¸¨­», ­¥ ¿¢«¿¾¹¥©±¿ «¨±²®¬, ­ ©²¨ ±³¬¬³ · ±²®²
¥¥ ¤¥²¥©, ¨ ±«®¦¨²¼ ¢±¥ ¯®«³·¥­­»¥ ·¨±« .
17.3-4  ±¯®«®¦¨¬ ±¨¬¢®«»  «´ ¢¨²  ¢ ¯®°¿¤ª¥ ³¡»¢ ­¨¿ (­¥¢®§° ±² ­¨¿) · ±²®². ®ª ¦¨²¥, ·²® ¢ ®¯²¨¬ «¼­®¬ ¯°¥´¨ª±­®¬
ª®¤¥ ¤«¨­» ª®¤¨°³¾¹¨µ ½²¨ ±¨¬¢®«» ¯®±«¥¤®¢ ²¥«¼­®±²¥© ¡¨²®¢
¡³¤³² ¨¤²¨ ¢ ­¥³¡»¢ ¾¹¥¬ ¯®°¿¤ª¥.
17.3-5 ®ª ¦¨²¥, ·²® ®¯²¨¬ «¼­»© ¯°¥´¨ª±­»© ª®¤ ¤«¿  «´ ¢¨²  ¨§ n ±¨¬¢®«®¢ ¬®¦¥² ¡»²¼ ¯°¥¤±² ¢«¥­ ¯®±«¥¤®¢ ²¥«¼­®±²¼¾ ¨§
2n ; 1 + ndlog2 ne ¡¨²®¢. (ª § ­¨¥: ¤«¿ § ¤ ­¨¿ ±²°³ª²³°» ¤¥°¥¢ 
¤®±² ²®·­® 2n ; 1 ¡¨²®¢.)
17.3-6 ¡®¡¹¨²¥  «£®°¨²¬  ´´¬¥­  ­  ²¥°­ °­»¥ ª®¤» (ª ¦¤»© ±¨¬¢®« ª®¤¨°³¥²±¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼¾ ¨§ ¶¨´° 0, 1 ¨ 2).
®¤», ¯®°®¦¤ ¥¬»¥ ¢ ¸¨¬  «£®°¨²¬®¬, ¤®«¦­» ¡»²¼ ®¯²¨¬ «¼­».
17.3-7 ³±²¼  «´ ¢¨² ±®¤¥°¦¨² 28 = 256 ±¨¬¢®«®¢, ¯°¨·¥¬ ¬ ª±¨¬ «¼­ ¿ · ±²®²  ¯°¥¢®±µ®¤¨² ¬¨­¨¬ «¼­³¾ ­¥ ¡®«¥¥ ·¥¬ ¢¤¢®¥.
®ª ¦¨²¥, ·²® ¤«¿  «´ ¢¨²  ± ² ª¨¬¨ · ±²®² ¬¨ ª®¤  ´´¬¥­ 
­¥ ¡®«¥¥ ½´´¥ª²¨¢¥­, ·¥¬ ° ¢­®¬¥°­»© ¢®±¼¬¨¡¨²®¢»© ª®¤.
17.3-8 °®´¥±±®° ³²¢¥°¦¤ ¥², ·²® ­ ¯¨± ­­ ¿ ¨¬ ¯°®£° ¬¬ 
±¦ ²¨¿ ¨­´®°¬ ¶¨¨ ¯®§¢®«¿¥² ±¦ ²¼ «¾¡®© ´ ©« ¤«¨­» 1000 (¯®±«¥¤®¢ ²¥«¼­®±²¼ ¨§ ²»±¿·¨ 8-¡¨²®¢»µ ¡ ©²®¢) µ®²¿ ¡» ­  ®¤¨­
¡¨², ¯®±«¥ ·¥£® ­ ¯¨± ­­ ¿ ¨¬ ¯°®£° ¬¬  ¢®±±² ­®¢«¥­¨¿ ±¬®¦¥²

17.4 ¥®°¥²¨·¥±ª¨¥ ®±­®¢» ¦ ¤­»µ  «£®°¨²¬®¢

347

¢®±±² ­®¢¨²¼ ¨±µ®¤­»© ´ ©«. ®·¥¬³ ®­ ­¥¯° ¢? (ª § ­¨¥: ±° ¢­¨²¥ ª®«¨·¥±²¢® ¢®§¬®¦­»µ ´ ©«®¢ ± ª®«¨·¥±²¢®¬ ±¦ ²»µ ´ ©«®¢).

? 17.4 ¥®°¥²¨·¥±ª¨¥ ®±­®¢» ¦ ¤­»µ  «£®°¨²¬®¢
 ½²®¬ ° §¤¥«¥ ¬» ¢ª° ²¶¥ ° ±±ª ¦¥¬ ® ª° ±¨¢®¬ ° §¤¥«¥ ª®¬¡¨­ ²®°¨ª¨, ±¢¿§ ­­®¬ ± ¦ ¤­»¬¨  «£®°¨²¬ ¬¨, | ²¥®°¨¨ ¬ ²°®¨¤®¢.  ¯®¬®¹¼¾ ½²®© ²¥®°¨¨ · ±²® (µ®²¿ ¨ ­¥ ¢±¥£¤ : § ¤ ·¨ ¨§
° §¤¥«®¢ 17.1 ¨ 17.3 ²¥®°¨¥© ¬ ²°®¨¤®¢ ­¥ ¯®ª°»¢ ¾²±¿) ³¤ ¥²±¿
³±² ­®¢¨²¼, ·²® ¤ ­­»© ¦ ¤­»©  «£®°¨²¬ ¤ ¥² ®¯²¨¬³¬. ¥®°¨¿
¬ ²°®¨¤®¢ ¡»±²°® ° §¢¨¢ ¥²±¿ (±¬. ±±»«ª¨ ¢ ª®­¶¥ £« ¢»).
17.4.1.  ²°®¨¤»
 ²°®¨¤®¬ (matroid) ­ §»¢ ¥²±¿ ¯ °  M = (S; I ), ³¤®¢«¥²¢®°¿¾¹ ¿ ±«¥¤³¾¹¨¬ ³±«®¢¨¿¬.
1. S | ª®­¥·­®¥ ­¥¯³±²®¥ ¬­®¦¥±²¢®.
2. I | ­¥¯³±²®¥ ±¥¬¥©±²¢® ¯®¤¬­®¦¥±²¢ S ; ¢µ®¤¿¹¨¥ ¢ I ¯®¤¬­®¦¥±²¢  ­ §»¢ ¾² ­¥§ ¢¨±¨¬»¬¨ (independent). °¨ ½²®¬ ¤®«¦­® ¢»¯®«­¿²¼±¿ ² ª®¥ ±¢®©±²¢®: ¨§ B 2 I ¨ A  B ±«¥¤³¥² A 2 I
(¢ · ±²­®±²¨, ¢±¥£¤  ; 2 I ). ¥¬¥©±²¢® I , ³¤®¢«¥²¢®°¿¾¹¥¥ ½²®¬³ ³±«®¢¨¾, ­ §»¢ ¥²±¿ ­ ±«¥¤±²¢¥­­»¬ (hereditary).
3. ±«¨ A 2 I , B 2 I ¨ jAj < jB j, ²® ±³¹¥±²¢³¥² ² ª®© ½«¥¬¥­²
x 2 B n A, ·²® A [ fxg 2 I . ²® ±¢®©±²¢® ±¥¬¥©±²¢  I ­ §»¢ ¾²
±¢®©±²¢®¬ § ¬¥­» (exchange property).
¥°¬¨­ À¬ ²°®¨¤Á ¯°¨­ ¤«¥¦¨²  ±±«¥°³ ¨²­¨ (Hassler Whitney). ­ § ­¨¬ «±¿ ¬ ²°¨·­»¬¨ ¬ ²°®¨¤ ¬¨ (matric matroids), ³
ª®²®°»µ S | ¬­®¦¥±²¢® ¢±¥µ ±²°®ª ­¥ª®²®°®© ¬ ²°¨¶», ¨ ¬­®¦¥±²¢® ±²°®ª ±·¨² ¥²±¿ ­¥§ ¢¨±¨¬»¬, ¥±«¨ ½²¨ ±²°®ª¨ «¨­¥©­® ­¥§ ¢¨±¨¬» ¢ ®¡»·­®¬ ±¬»±«¥. (¥£ª® ¯®ª § ²¼, ·²® ¤¥©±²¢¨²¥«¼­®
¯®«³· ¥²±¿ ¬ ²°®¨¤, ±¬. ³¯°. 17.4-2.)
°³£¨¬ ¯°¨¬¥°®¬ ¿¢«¿¥²±¿ £° ´®¢»© ¬ ²°®¨¤ (graphic matroid)
(SG ; IG ), ±²°®¿¹¨©±¿ ¯® ­¥®°¨¥­²¨°®¢ ­­®¬³ £° ´³ G ±«¥¤³¾¹¨¬
®¡° §®¬: SG ±®¢¯ ¤ ¥² ±® ¬­®¦¥±²¢®¬ °¥¡¥° £° ´ ,   IG ±®±²®¨² ¨§ ¢±¥µ  ¶¨ª«¨·­»µ (². ¥. ¿¢«¿¾¹¨µ±¿ «¥± ¬¨) ¬­®¦¥±²¢ °¥¡¥°.
° ´®¢»¥ ¬ ²°®¨¤» ²¥±­® ±¢¿§ ­» ± § ¤ ·¥© ® ¬¨­¨¬ «¼­®¬ ¯®ª°»¢ ¾¹¥¬ ¤¥°¥¢¥, ª®²®°³¾ ¬» ° ±±¬®²°¨¬ ¢ £« ¢¥ 24.
¥®°¥¬  17.5. ±«¨ G = (V; E ) | ­¥®°¨¥­²¨°®¢ ­­»© £° ´, ²®
MG = (SG ; IG ) ¿¢«¿¥²±¿ ¬ ²°®¨¤®¬.
®ª § ²¥«¼±²¢®.  ª ª ª ¯®¤£° ´  ¶¨ª«¨·­®£® £° ´   ¶¨ª«¨·¥­,
¬­®¦¥±²¢® IG ­ ±«¥¤±²¢¥­­®, ¨ ®±² ¥²±¿ ¯°®¢¥°¨²¼ ±¢®©±²¢® § ¬¥-

348

« ¢  17  ¤­»¥  «£®°¨²¬»

­».  ± ¬®¬ ¤¥«¥, ¯³±²¼ A ¨ B |  ¶¨ª«¨·­»¥ ¯®¤£° ´» G, ¯°¨·¥¬
jBj > jAj. § ²¥®°¥¬» 5.2 ±«¥¤³¥², ·²® «¥± ± k °¥¡° ¬¨ ¿¢«¿¥²±¿
­¥±¢¿§­»¬ ®¡º¥¤¨­¥­¨¥¬ jV j ; k ¤¥°¥¢¼¥¢, £¤¥ jV j | ª®«¨·¥±²¢®
¢¥°¸¨­ (­¥§ ¢¨±¨¬®¥ ¤®ª § ²¥«¼±²¢®: ­ ·­¥¬ ± «¥± , ±®±²®¿¹¥£®
¨§ jV j ¢¥°¸¨­ ¨ ­¥ ¨¬¥¾¹¥£® °¥¡¥°, ¨ ¡³¤¥¬ ¯® ®¤­®¬³ ¤®¡ ¢«¿²¼
°¥¡° , ­¥ ­ °³¸ ¿  ¶¨ª«¨·­®±²¨; ²®£¤  ¤®¡ ¢«¥­¨¥ ª ¦¤®£® °¥¡° 
³¬¥­¼¸ ¥² ª®«¨·¥±²¢® ±¢¿§­»µ ª®¬¯®­¥­² ­  ¥¤¨­¨¶³). «¥¤®¢ ²¥«¼­®, «¥± A ±®±²®¨² ¨§ jV j ; jAj ¤¥°¥¢¼¥¢,   «¥± B | ¨§ jV j ; jB j
¤¥°¥¢¼¥¢. ®±ª®«¼ª³ jV j ; jB j < jV j ; jAj, «¥± B ±®¤¥°¦¨² ² ª®¥
¤¥°¥¢® T , ·²® ¤¢¥ ¥£® ¢¥°¸¨­» ¯°¨­ ¤«¥¦ ² ° §­»¬ ±¢¿§­»¬ ª®¬¯®­¥­² ¬ «¥±  A. ®«¥¥ ²®£®, ¯®±ª®«¼ª³ T ±¢¿§­®, ®­® ¤®«¦­® ±®¤¥°¦ ²¼ ² ª®¥ °¥¡°® (u; v ), ·²® u ¨ v ¯°¨­ ¤«¥¦ ² ° §­»¬ ±¢¿§­»¬ ª®¬¯®­¥­² ¬ «¥±  A. «¥¤®¢ ²¥«¼­®, ¤®¡ ¢«¥­¨¥ ½²®£® °¥¡° 
ª «¥±³ A ­¥ ¬®¦¥² ±®§¤ ²¼ ¶¨ª« , ¨ ¥£® ¬®¦­® ¢§¿²¼ ¢ ª ·¥±²¢¥
½«¥¬¥­²  x ¨§ ®¯°¥¤¥«¥­¨¿ ¬ ²°®¨¤ .
(° ´®¢»¥ ¬ ²°®¨¤» ¿¢«¿¾²±¿ · ±²­»¬ ±«³· ¥¬ ¬ ²°¨·­»µ, ¥±«¨ °¥¡°® £° ´  ° ±±¬ ²°¨¢ ²¼ ª ª ´®°¬ «¼­³¾ ±³¬¬³ ¥£® ¢¥°¸¨­
± ª®½´´¨¶¨¥­² ¬¨ ¢ ¯®«¥ ¢»·¥²®¢ ¯® ¬®¤³«¾ 2, ±¬. § ¤ ·³ 17-2¡.)
±«¨ M = (S; I ) | ¬ ²°®¨¤, ²® ½«¥¬¥­² x 2= A 2 I ­ §»¢ ¥²±¿
­¥§ ¢¨±¨¬»¬ ®² A (extension of A), ¥±«¨ ¬­®¦¥±²¢® A [ fxg ­¥§ ¢¨±¨¬®.  ¯°¨¬¥°, ¢ £° ´®¢®¬ ¬ ²°®¨¤¥ °¥¡°® e ­¥§ ¢¨±¨¬® ®²
«¥±  A ²®£¤  ¨ ²®«¼ª® ²®£¤ , ª®£¤  ¥£® ¤®¡ ¢«¥­¨¥ ª A ­¥ ±®§¤ ¥²
¶¨ª« .
¥§ ¢¨±¨¬®¥ ¯®¤¬­®¦¥±²¢® ¢ ¬ ²°®¨¤¥ ­ §»¢ ¥²±¿ ¬ ª±¨¬ «¼­»¬ (maximal), ¥±«¨ ®­® ­¥ ±®¤¥°¦¨²±¿ ­¨ ¢ ª ª®¬ ¡®«¼¸¥¬ ­¥§ ¢¨±¨¬®¬ ¯®¤¬­®¦¥±²¢¥.  ±²® ¡»¢ ¥² ¯®«¥§­  ±«¥¤³¾¹ ¿
¥®°¥¬  17.6. ±¥ ¬ ª±¨¬ «¼­»¥ ­¥§ ¢¨±¨¬»¥ ¯®¤¬­®¦¥±²¢  ¤ ­­®£® ¬ ²°®¨¤  ±®±²®¿² ¨§ ®¤¨­ ª®¢®£® ·¨±«  ½«¥¬¥­²®¢.
®ª § ²¥«¼±²¢®. ³±²¼ A ¨ B | ¬ ª±¨¬ «¼­»¥ ­¥§ ¢¨±¨¬»¥ ¯®¤¬­®¦¥±²¢ . ±«¨, ±ª ¦¥¬, jAj < jB j, ²® ¨§ ±¢®©±²¢  § ¬¥­» ¢»²¥ª ¥² ±³¹¥±²¢®¢ ­¨¥ ² ª®£® x 2= A, ·²® A [ fxg ­¥§ ¢¨±¨¬® | ¢
¯°®²¨¢®°¥·¨¥ ± ¬ ª±¨¬ «¼­®±²¼¾.
 ª ·¥±²¢¥ ¯°¨¬¥°  ° ±±¬®²°¨¬ £° ´®¢»© ¬ ²°®¨¤ MG , ±®®²¢¥²±²¢³¾¹¨© ±¢¿§­®¬³ £° ´³ G. ±¿ª®¥ ¬ ª±¨¬ «¼­®¥ ­¥§ ¢¨±¨¬®¥ ¯®¤¬­®¦¥±²¢® MG ¤®«¦­® ¡»²¼ ¤¥°¥¢®¬ ± jV j ; 1 °¥¡°®¬, ±®¥¤¨­¿¾¹¨¬ ¢±¥ ¢¥°¸¨­» G.  ª®¥ ¤¥°¥¢® ­ §»¢ ¥²±¿ ¯®ª°»¢ ¾¹¨¬ (®±²®¢­»¬) ¤¥°¥¢®¬ £° ´  G (¯®- ­£«¨©±ª¨ spanning tree).
³¤¥¬ ­ §»¢ ²¼ ¬ ²°®¨¤ M = (S; I ) ¢§¢¥¸¥­­»¬ (weighted), ¥±«¨ ­  ¬­®¦¥±²¢¥ S § ¤ ­  ¢¥±®¢ ¿ ´³­ª¶¨¿ w ±® §­ ·¥­¨¿¬¨ ¢® ¬­®¦¥±²¢¥ ¯®«®¦¨²¥«¼­»µ ·¨±¥«. ³­ª¶¨¿ w ° ±¯°®±²° ­¿¥²±¿ ¯®  ¤¤¨²¨¢­®±²¨ ­  ¢±¥ ¯®¤¬­®¦¥±²¢  ¬­®¦¥±²¢  S ; ¢¥± ¯®¤¬­®¦¥±²¢ 
P
®¯°¥¤¥«¿¥²±¿ ª ª ±³¬¬  ¢¥±®¢ ¥£® ½«¥¬¥­²®¢: w(A) = x2A w(x).
°¨¬¥°: ¥±«¨ MG | £° ´®¢»© ¬ ²°®¨¤,   w(e) | ¤«¨­  °¥¡°  e,
²® w(A) | ±³¬¬  ¤«¨­ °¥¡¥° ¯®¤£° ´  A.

17.4 ¥®°¥²¨·¥±ª¨¥ ®±­®¢» ¦ ¤­»µ  «£®°¨²¬®¢

349

17.4.2.  ¤­»¥  «£®°¨²¬» ¤«¿ ¢§¢¥¸¥­­®£® ¬ ²°®¨¤ 
­®£¨¥ ®¯²¨¬¨§ ¶¨®­­»¥ § ¤ ·¨, °¥¸ ¥¬»¥ ¦ ¤­»¬¨  «£®°¨²¬ ¬¨, ±¢®¤¿²±¿ ª § ¤ ·¥ ® ­ µ®¦¤¥­¨¨ ¢ ¤ ­­®¬ ¢§¢¥¸¥­­®¬ ¬ ²°®¨¤¥ M = (S; I ) ­¥§ ¢¨±¨¬®£® ¯®¤¬­®¦¥±²¢  A  M ¬ ª±¨¬ «¼­®£® ¢¥± . ¥§ ¢¨±¨¬®¥ ¯®¤¬­®¦¥±²¢® ¬ ª±¨¬ «¼­®£® ¢¥±  ­ §»¢ ¥²±¿ ®¯²¨¬ «¼­»¬ (optimal) ¯®¤¬­®¦¥±²¢®¬ ¢§¢¥¸¥­­®£® ¬ ²°®¨¤ . ®±ª®«¼ª³ ¢¥±  ¢±¥µ ½«¥¬¥­²®¢ ¯®«®¦¨²¥«¼­», ®¯²¨¬ «¼­®¥
¯®¤¬­®¦¥±²¢®  ¢²®¬ ²¨·¥±ª¨ ¡³¤¥² ¬ ª±¨¬ «¼­»¬ ­¥§ ¢¨±¨¬»¬
¯®¤¬­®¦¥±²¢®¬.
 ¯°¨¬¥°, § ¤ ·  ® ­ ¨¬¥­¼¸¥¬ ¯®ª°»¢ ¾¹¥¬ ¤¥°¥¢¥
(minimum-spanning-tree problem) ±®±²®¨² ¢ ±«¥¤³¾¹¥¬.  ­
±¢¿§­»© ­¥®°¨¥­²¨°®¢ ­­»© £° ´ G = (V; E ) ¨ ´³­ª¶¨¿ w ¨§
¬­®¦¥±²¢  ¥£® °¥¡¥° ¢® ¬­®¦¥±²¢® ¯®«®¦¨²¥«¼­»µ ·¨±¥« (w(e) ¡³¤¥¬ ­ §»¢ ²¼ ¤«¨­®© °¥¡°  e). °¥¡³¥²±¿ ­ ©²¨ ¬­®¦¥±²¢® °¥¡¥°,
±®¥¤¨­¿¾¹¨µ ¢±¥ ¢¥°¸¨­» ¨ ¨¬¥¾¹¨µ ­ ¨¬¥­¼¸³¾ ±³¬¬ °­³¾
¤«¨­³. ²³ § ¤ ·³ ¬®¦­® ° ±±¬ ²°¨¢ ²¼ ª ª · ±²­»© ±«³· © § ¤ ·¨ ®¡ ®¯²¨¬ «¼­®¬ ¯®¤¬­®¦¥±²¢¥ ¢§¢¥¸¥­­®£® ¬ ²°®¨¤ .  ± ¬®¬
¤¥«¥, ¢»¡¥°¥¬ ·¨±«® w0, ±²°®£® ¡®«¼¸¥¥ ¤«¨­ ¢±¥µ °¥¡¥°, ¨ ¢¢¥¤¥¬
­  £° ´®¢®¬ ¬ ²°®¨¤¥ MG ¢¥±  ¯® ¯° ¢¨«³ w0(e) = w0 ; w(e).
«¿ ¢±¿ª®£® ¬ ª±¨¬ «¼­®£® ­¥§ ¢¨±¨¬®£® ¯®¤¬­®¦¥±²¢  (². ¥.
¯®ª°»¢ ¾¹¥£® ¤¥°¥¢ ) A ¨¬¥¥¬

w0(A) = (jV j ; 1)w0 ; w(A);
£¤¥ V | ¬­®¦¥±²¢® ¢¥°¸¨­ £° ´ . ² «® ¡»²¼, ­ ¨¬¥­¼¸¨¥ ¯®ª°»¢ ¾¹¨¥ ¤¥°¥¢¼¿ ¤«¿ £° ´  G | ²® ¦¥ ± ¬®¥, ·²® ®¯²¨¬ «¼­»¥
¯®¤¬­®¦¥±²¢  ¢ ¬ ²°®¨¤¥ MG ± ¢¥±®¢®© ´³­ª¶¨¥© w0.
 ¤ ·  ® ­ ¨¬¥­¼¸¥¬ ¯®ª°»¢ ¾¹¥¬ ¤¥°¥¢¥ ¯®¤°®¡­® ° ±±¬ ²°¨¢ ¥²±¿ ¢ £« ¢¥ 24; ±¥©· ± ¬» ¯°¨¢¥¤¥¬ ¦ ¤­»©  «£®°¨²¬, ­ µ®¤¿¹¨© ®¯²¨¬ «¼­®¥ ¯®¤¬­®¦¥±²¢® A ¢ «¾¡®¬ ¢§¢¥¸¥­­®¬ ¬ ²°®¨¤¥ M . ±«¨ M = (S; I ), ²® ¬» ¯¨¸¥¬ S = S [M ] ¨ I = I [M ]; ¢¥±®¢ ¿
´³­ª¶¨¿ ®¡®§­ · ¥²±¿ w.
Greedy (M; w)
1 A ;
2 ®²±®°²¨°®¢ ²¼ S [M ] ¢ ¯®°¿¤ª¥ ­¥¢®§° ±² ­¨¿ ¢¥±®¢
3 for x 2 S [M ] (¯¥°¥¡¨° ¥¬ ¢±¥ x ¢ ³ª § ­­®¬ ¯®°¿¤ª¥)
4
do if A [ fxg 2 I [M ]
5
then A A [ fxg
6 return A
«£®°¨²¬ ° ¡®² ¥² ±«¥¤³¾¹¨¬ ®¡° §®¬. ®« £ ¥¬ A = ; (±²°®ª  1; ¯³±²®¥ ¬­®¦¥±²¢®, ª ª ¬» ¯®¬­¨¬, ¢±¥£¤  ­¥§ ¢¨±¨¬®) ¨ ¯¥°¥¡¨° ¥¬ ½«¥¬¥­²» S [M ] ¢ ¯®°¿¤ª¥ ³¡»¢ ­¨¿ ¢¥± ; ¥±«¨ ®·¥°¥¤­®© ½«¥¬¥­² ¬®¦­®, ­¥ ­ °³¸ ¿ ­¥§ ¢¨±¨¬®±²¨, ¤®¡ ¢¨²¼ ª ¬­®¦¥±²¢³ A, ²® ¬» ½²® ¤¥« ¥¬. ±­®, ·²® ¯®«³·¥­­®¥ ¢ °¥§³«¼² ²¥

350

« ¢  17  ¤­»¥  «£®°¨²¬»

¬­®¦¥±²¢® ¡³¤¥² ­¥§ ¢¨±¨¬»¬. ¨¦¥ ¬» ¯®ª ¦¥¬, ·²® ®­® ¤¥©±²¢¨²¥«¼­® ¡³¤¥² ¨¬¥²¼ ¬ ª±¨¬ «¼­»© ¢¥± ±°¥¤¨ ­¥§ ¢¨±¨¬»µ ¯®¤¬­®¦¥±²¢,   ¯®ª  ·²® ®¶¥­¨¬ ¢°¥¬¿ ° ¡®²»  «£®°¨²¬  Greedy.
®°²¨°®¢ª  (±²°®ª  2) § ­¨¬ ¥² ¢°¥¬¿ O(n log n), £¤¥ n = jS j. °®¢¥°ª  ­¥§ ¢¨±¨¬®±²¨ ¬­®¦¥±²¢  (±²°®ª  4) ¯°®¢®¤¨²±¿ n ° §; ¥±«¨
ª ¦¤ ¿ ² ª ¿ ¯°®¢¥°ª  § ­¨¬ ¥² ¢°¥¬¿ f (n), ²® ®¡¹¥¥ ¢°¥¬¿ ° ¡®²» ¡³¤¥² O(n log n + nf (n)).
¥¯¥°¼ ¯®ª ¦¥¬, ·²®  «£®°¨²¬ Greedy ¤¥©±²¢¨²¥«¼­® ¤ ¥²
®¯²¨¬ «¼­®¥ ¯®¤¬­®¦¥±²¢®.
¥¬¬  17.7 (±¢®©±²¢® ¦ ¤­®£® ¢»¡®°  ¤«¿ ¬ ²°®¨¤®¢).
³±²¼ M = (S; I ) | ¢§¢¥¸¥­­»© ¬ ²°®¨¤ ± ¢¥±®¢®© ´³­ª¶¨¥© w. ³±²¼ x 2 S | ½«¥¬¥­² ­ ¨¡®«¼¸¥£® ¢¥±  ¢® ¬­®¦¥±²¢¥ f y 2 S : fy g ­¥§ ¢¨±¨¬® g. ®£¤  x ±®¤¥°¦¨²±¿ ¢ ­¥ª®²®°®¬
®¯²¨¬ «¼­®¬ ¯®¤¬­®¦¥±²¢¥ A  S .
®ª § ²¥«¼±²¢®. ³±²¼ B | ª ª®¥-²® ®¯²¨¬ «¼­®¥ ¯®¤¬­®¦¥±²¢®. ³¤¥¬ ±·¨² ²¼, ·²® x 2= B , ¨­ ·¥ ¤®ª §»¢ ²¼ ­¥·¥£®.
®«®¦¨¬ A0 = fxg. ²® ¬­®¦¥±²¢® ­¥§ ¢¨±¨¬® ¯® ¢»¡®°³ x. °¨¬¥­¿¿ jB j ; 1 ° § ±¢®©±²¢® § ¬¥­», ¬» ° ±¸¨°¿¥¬ A0 ½«¥¬¥­² ¬¨
¨§ B ¨ ¢ ª®­¶¥ ª®­¶®¢ ¯®±²°®¨¬ ­¥§ ¢¨±¨¬®¥ ¬­®¦¥±²¢® A, ±®±²®¿¹¥¥ ¨§ x ¨ jB j ; 1 ½«¥¬¥­²  ¬­®¦¥±²¢  B . ¬¥¥¬ jAj = jB j (² ª
·²® A ¬ ª±¨¬ «¼­®) ¨ w(A) = w(B ) ; w(y ) + w(x), £¤¥ y | ¥¤¨­±²¢¥­­»© ½«¥¬¥­² B , ­¥ ¢µ®¤¿¹¨© ¢ A.  ²® ¦¥ ¢°¥¬¿ ¤«¿ ¢±¿ª®£®
y 2 B ¬­®¦¥±²¢® fy g ­¥§ ¢¨±¨¬® ¢ ±¨«³ ±¢®©±²¢  ­ ±«¥¤±²¢¥­­®±²¨, ² ª ·²® w(x) > w(y ) ¯® ¢»¡®°³ x. ² «® ¡»²¼, w(A) > w(B ),
¨ ¬­®¦¥±²¢® A ² ª¦¥ ®¯²¨¬ «¼­®. ±¥ ¤®ª § ­®.
 «¥¥, ¨¬¥¥² ¬¥±²® ±«¥¤³¾¹ ¿ ®·¥¢¨¤­ ¿
¥¬¬  17.8. ±«¨ M = (S; I ) | ¬ ²°®¨¤, x 2 S ¨ fxg 2= I , ²®
A [ fxg 2= I ¤«¿ ¢±¥µ A  S .
 ¸  ¯®±«¥¤­¿¿ «¥¬¬  ² ª®¢ :
¥¬¬  17.9 (±¢®©±²¢® ®¯²¨¬ «¼­®±²¨ ¯®¤§ ¤ · ¤«¿ ¬ ²°®¨¤®¢).
³±²¼ M = (S; I ) | ¢§¢¥¸¥­­»© ¬ ²°®¨¤, ¨ ¯³±²¼ x 2 S | ­¥ª®²®°»© ¥£® ½«¥¬¥­², ¯°¨·¥¬ ¬­®¦¥±²¢® fxg ­¥§ ¢¨±¨¬®. ®£¤ 
­¥§ ¢¨±¨¬®¥ ¬­®¦¥±²¢® ­ ¨¡®«¼¸¥£® ¢¥± , ±®¤¥°¦ ¹¥¥ x, ¿¢«¿¥²±¿ ®¡º¥¤¨­¥­¨¥¬ fxg ¨ ­¥§ ¢¨±¨¬®£® ¬­®¦¥±²¢  ­ ¨¡®«¼¸¥£®
¢¥±  ¢ ¬ ²°®¨¤¥ M 0 = (S 0; I 0), £¤¥, ¯® ®¯°¥¤¥«¥­¨¾,

S 0 = f y 2 S : fx; y g 2 I g ;
I 0 = f B  S n fxg : B [ fxg 2 I g ;
  ¢¥±®¢ ¿ ´³­ª¶¨¿ ¿¢«¿¥²±¿ ®£° ­¨·¥­¨¥¬ ­  S 0 ¢¥±®¢®© ´³­ª¶¨¨
¤«¿ ¬ ²°®¨¤  M (¢ ² ª¨µ ±«³· ¿µ £®¢®°¿², ·²® ¬ ²°®¨¤ M 0 ¯®«³·¥­ ¨§ M ±²¿£¨¢ ­¨¥¬ (contraction) ½«¥¬¥­²  x).

17.4 ¥®°¥²¨·¥±ª¨¥ ®±­®¢» ¦ ¤­»µ  «£®°¨²¬®¢

351

®ª § ²¥«¼±²¢®. ¥§ ¢¨±¨¬»¥ ¢ S ¬­®¦¥±²¢ , ±®¤¥°¦ ¹¨¥ x, ¯®«³· ¾²±¿ ¤®¡ ¢«¥­¨¥¬ ½«¥¬¥­²  x ª ­¥§ ¢¨±¨¬»¬ ¢ S 0 ¯®¤¬­®¦¥±²¢ ¬. °¨ ½²®¬ ¨µ ¢¥±  ®²«¨· ¾²±¿ °®¢­® ­  w(x), ² ª ·²® ®¯²¨¬ «¼­»¥ ¬­®¦¥±²¢  ±®®²¢¥²±²¢³¾² ®¯²¨¬ «¼­»¬.
¥®°¥¬  17.10 (¯° ¢¨«¼­®±²¼ ¦ ¤­®£®  «£®°¨²¬  ¤«¿ ¬ ²°®¨¤®¢).
 °¥§³«¼² ²¥ ° ¡®²»  «£®°¨²¬  Greedy, ¯°¨¬¥­¥­­®£® ª ¢§¢¥¸¥­­®¬³ ¬ ²°®¨¤³, ¯®«³· ¥²±¿ ®¯²¨¬ «¼­®¥ ¯®¤¬­®¦¥±²¢®.
®ª § ²¥«¼±²¢®. ³±²¼ M = (S; I ) | ¬ ²°®¨¤ ± ¢¥±®¢®© ´³­ª¶¨¥© w.  ±¨«³ «¥¬¬» 17.8 ¬» ¬®¦¥¬ ­¥ ¯°¨­¨¬ ²¼ ¢® ¢­¨¬ ­¨¥
½«¥¬¥­²» x 2 S , ¤«¿ ª®²®°»µ ¬­®¦¥±²¢® fxg ­¥ ­¥§ ¢¨±¨¬®. ±«¨
x 2 S | ¯¥°¢»© ¨§ ¢»¡° ­­»µ  «£®°¨²¬®¬ ½«¥¬¥­²®¢, ²® «¥¬¬  17.7 ¯®ª §»¢ ¥², ·²® ±³¹¥±²¢³¥² ®¯²¨¬ «¼­®¥ ¯®¤¬­®¦¥±²¢®
A  S , ±®¤¥°¦ ¹¥¥ x. ¥¯¥°¼, ±®£« ±­® «¥¬¬¥ 17.9, ¤®±² ²®·­® ­ ©²¨ ®¯²¨¬ «¼­®¥ ¯®¤¬­®¦¥±²¢® ¢ ¬ ²°®¨¤¥ M 0 , ¯®«³·¥­­®¬ ¨§ M
±²¿£¨¢ ­¨¥¬ ½«¥¬¥­²  x (¨ ¤®¡ ¢¨²¼ ª ­¥¬³ x).  «¼­¥©¸ ¿ ° ¡®²   «£®°¨²¬  ¢ ±³¹­®±²¨ ¨ ¯°¥¤±² ¢«¿¥² ±®¡®© ®¡° ¡®²ª³ ¬ ²°®¨¤  M 0 .
[®«¥¥ ´®°¬ «¼­®¥ ° ±±³¦¤¥­¨¥ ¬®¦¥² ¡»²¼ ² ª¨¬. ®±«¥ «¾¡®£® ·¨±«  ¨²¥° ¶¨© ¢»¯®«­¥­ ±«¥¤³¾¹¨© ¨­¢ °¨ ­² ¶¨ª« : (1) ¬­®¦¥±²¢® A ­¥§ ¢¨±¨¬®; (2) ®¯²¨¬ «¼­®¥ ¬­®¦¥±²¢® ¬®¦­® ¨±ª ²¼
±°¥¤¨ ¬­®¦¥±²¢, ¿¢«¿¾¹¨µ±¿ ®¡º¥¤¨­¥­¨¥¬ A ± ­¥ª®²®°»¬¨ ¨§ ¥¹¥
­¥ ¯°®±¬®²°¥­­»µ ½«¥¬¥­²®¢.]

¯° ¦­¥­¨¿
17.4-1 ³±²¼ S | ª®­¥·­®¥ ¬­®¦¥±²¢®, k | ­ ²³° «¼­®¥ ·¨±«®,
Ik | ±¥¬¥©±²¢® ¢±¥µ ¯®¤¬­®¦¥±²¢ S , ±®¤¥°¦ ¹¨µ ­¥ ¡®«¥¥ k ½«¥¬¥­²®¢. ®ª ¦¨²¥, ·²® (S; Ik ) | ¬ ²°®¨¤.
17.4-2? ³±²¼ T | ¢¥¹¥±²¢¥­­ ¿ ¬ ²°¨¶ , S | ¬­®¦¥±²¢® ¥¥
±²®«¡¶®¢, ¨ ¯®¤¬­®¦¥±²¢® A  S ­ §»¢ ¥²±¿ ­¥§ ¢¨±¨¬»¬, ¥±«¨
®­® «¨­¥©­® ­¥§ ¢¨±¨¬® ¢ ®¡»·­®¬ ±¬»±«¥. ®ª ¦¨²¥, ·²® ¯®«³· ¥²±¿ ¬ ²°®¨¤ (­ §»¢ ¥¬»© ¬ ²°¨·­»¬, ª ª ¬» ³¦¥ £®¢®°¨«¨).
17.4-3? ³±²¼ (S; I ) | ¬ ²°®¨¤. ³±²¼ I 0 | ±¥¬¥©±²¢® ¢±¥µ ² ª¨µ ¯®¤¬­®¦¥±²¢ A0  S , ¤«¿ ª®²®°»µ S n A0 ±®¤¥°¦¨² ­¥ª®²®°®¥ ¬ ª±¨¬ «¼­®¥ ­¥§ ¢¨±¨¬®¥ ¯®¤¬­®¦¥±²¢® A  S . ®ª ¦¨²¥,
·²® ¯ °  (S; I 0) ¿¢«¿¥²±¿ ¬ ²°®¨¤®¬.  ¬¥²¨¬, ·²® ¬ ª±¨¬ «¼­»¥
­¥§ ¢¨±¨¬»¥ ¯®¤¬­®¦¥±²¢  (S; I 0) ±³²¼ ¤®¯®«­¥­¨¿ ¬ ª±¨¬ «¼­»µ
­¥§ ¢¨±¨¬»µ ¯®¤¬­®¦¥±²¢ (S; I ).
17.4-4? ³±²¼ S = S1 [ S2 [    [ Sk | ° §¡¨¥­¨¥ ª®­¥·­®£® ¬­®¦¥±²¢  S ­  ­¥¯¥°¥±¥ª ¾¹¨¥±¿ ­¥¯³±²»¥ · ±²¨. ®«®¦¨¬
I = f A  S : jA \ Sij 6 1 ¤«¿ i = 1; 2; : : :; k g. ®ª ¦¨²¥, ·²® ¯ ° 
(S; I ) ¿¢«¿¥²±¿ ¬ ²°®¨¤®¬.

352

« ¢  17  ¤­»¥  «£®°¨²¬»

17.4-5 ³±²¼ ­ ¬ ¤ ­ ¢§¢¥¸¥­­»© ¬ ²°®¨¤. ¡º¿±­¨²¥, ª ª ­ ¤® ¬®¤¨´¨¶¨°®¢ ²¼ ¢¥±®¢³¾ ´³­ª¶¨¾, ·²®¡» ±¢¥±²¨ § ¤ ·³ ­ µ®¦¤¥­¨¿ ¬ ª±¨¬ «¼­®£® ­¥§ ¢¨±¨¬®£® ¯®¤¬­®¦¥±²¢  ± ­ ¨¬¥­¼¸¨¬
¢¥±®¬ ª § ¤ ·¥ ­ µ®¦¤¥­¨¿ ­¥§ ¢¨±¨¬®£® ¯®¤¬­®¦¥±²¢  ± ­ ¨¡®«¼¸¨¬ ¢¥±®¬.

? 17.5  ¤ ·  ® ° ±¯¨± ­¨¨
­²¥°¥±­»¬ ¯°¨¬¥°®¬ ®¯²¨¬¨§ ¶¨®­­®© § ¤ ·¨, °¥¸ ¥¬®© ± ¯®¬®¹¼¾ ¬ ²°®¨¤®¢, ¿¢«¿¥²±¿ § ¤ ·  ® ° ±¯¨± ­¨¨ ¤«¿ § ª §®¢ ° ¢­®© ¤«¨²¥«¼­®±²¨ ± ¥¤¨­±²¢¥­­»¬ ¨±¯®«­¨²¥«¥¬, ±°®ª ¬¨ ¨ ¸²° ´ ¬¨.   ¯¥°¢»© ¢§£«¿¤ ½²  § ¤ ·  ª ¦¥²±¿ ¢¥±¼¬  § ¯³² ­­®©, ­®
¦ ¤­»©  «£®°¨²¬ ¤ ¥² ­¥®¦¨¤ ­­® ¯°®±²®¥ °¥¸¥­¨¥.
² ª, ¯°¥¤¯®«®¦¨¬, ·²® ¨¬¥¥²±¿ ª®­¥·­®¥ ¬­®¦¥±²¢® S , ±®±²®¿¹¥¥ ¨§ § ª §®¢ (tasks), ª ¦¤»© ¨§ ª®²®°»µ ²°¥¡³¥² °®¢­® ®¤­³
¥¤¨­¨¶³ ¢°¥¬¥­¨ ¤«¿ ±¢®¥£® ¢»¯®«­¥­¨¿.  ±¯¨± ­¨¥¬ (schedule)
¤«¿ S ­ §»¢ ¥²±¿ ¯¥°¥±² ­®¢ª  ¬­®¦¥±²¢  S , § ¤ ¾¹ ¿ ¯®°¿¤®ª
¢»¯®«­¥­¨¿ § ª §®¢: ¢»¯®«­¥­¨¥ ¯¥°¢®£® § ª §  ­ ·¨­ ¥²±¿ ¢ ¬®¬¥­² ¢°¥¬¥­¨ 0 ¨ § ª ­·¨¢ ¥²±¿ ¢ ¬®¬¥­² 1, ¢»¯®«­¥­¨¥ ¢²®°®£®
§ ª §  ­ ·¨­ ¥²±¿ ¢ ¬®¬¥­² ¢°¥¬¥­¨ 1 ¨ § ª ­·¨¢ ¥²±¿ ¢ ¬®¬¥­² 2,
¨ ². ¤.
 § ¤ ·¥ ® ° ±¯¨± ­¨¨ ¤«¿ § ª §®¢ ° ¢­®© ¤«¨²¥«¼­®±²¨ ± ¥¤¨­±²¢¥­­»¬ ¨±¯®«­¨²¥«¥¬, ±°®ª ¬¨ ¨ ¸²° ´ ¬¨ (scheduling unit-time
tasks with deadlines and penalties for a single processor) ¨±µ®¤­»¬¨
¤ ­­»¬¨ ¿¢«¿¾²±¿:
 ¬­®¦¥±²¢® S = f 1; 2; : : :; n g, ½«¥¬¥­²» ª®²®°®£® ¬» ­ §»¢ ¥¬
§ ª § ¬¨;
 ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¨§ n ¶¥«»µ ·¨±¥« d1; d2; : : :; dn, ­ §»¢ ¥¬»µ
±°®ª ¬¨ (deadlines) (1 6 di 6 n ¤«¿ ¢±¥µ i, ±°®ª di ®²­®±¨²±¿ ª
§ ª §³ ­®¬¥° i);
 ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¨§ n ­¥®²°¨¶ ²¥«¼­»µ ·¨±¥« w1; w2; : : :; wn,
­ §»¢ ¥¬»µ ¸²° ´ ¬¨ (penalties) (¥±«¨ § ª § ­®¬¥° i ­¥ ¢»¯®«­¥­ ª® ¢°¥¬¥­¨ di, ¢§¨¬ ¥²±¿ ¸²° ´ wi ).
°¥¡³¥²±¿ ­ ©²¨ ° ±¯¨± ­¨¥ ¤«¿ S , ¯°¨ ª®²®°®¬ ±³¬¬  ¸²° ´®¢
¡³¤¥² ­ ¨¬¥­¼¸¥©.
 ª § ­®¬¥° i ¯°®±°®·¥­ (late) ¤«¿ ¤ ­­®£® ° ±¯¨± ­¨¿, ¥±«¨ ¥£®
¢»¯®«­¥­¨¥ § ¢¥°¸ ¥²±¿ ¯®§¦¥ ¬®¬¥­²  di , ¢ ¯°®²¨¢­®¬ ±«³· ¥
§ ª § ±·¨² ¥²±¿ ¢»¯®«­¥­­»¬ ¢ ±°®ª (early). ±¿ª®¥ ° ±¯¨± ­¨¥
¬®¦­®, ­¥ ¬¥­¿¿ ±³¬¬» ¸²° ´®¢, ¬®¤¨´¨¶¨°®¢ ²¼ ² ª¨¬ ®¡° §®¬, ·²®¡» ¢±¥ ¯°®±°®·¥­­»¥ § ª §» ±²®¿«¨ ¢ ­¥¬ ¯®±«¥ ¢»¯®«­¥­­»µ ¢ ±°®ª.  ± ¬®¬ ¤¥«¥, ¥±«¨ ¯°®±°®·¥­­»© § ª § y ¨¤¥² ° ­¼¸¥
¢»¯®«­¥­­®£® ¢ ±°®ª § ª §  x, ²® ¬®¦­® ¯®¬¥­¿²¼ ¨µ ¬¥±² ¬¨ ¢
° ±¯¨± ­¨¨, ¨ ±² ²³± ®¡®¨µ § ª §®¢ ¯°¨ ½²®¬ ­¥ ¨§¬¥­¨²±¿.

17.5  ¤ ·  ® ° ±¯¨± ­¨¨

353

®«¥¥ ²®£®, ª ¦¤®¥ ° ±¯¨± ­¨¥ ¬®¦­®, ­¥ ¬¥­¿¿ ±³¬¬» ¸²° ´®¢, ¯°¥¤±² ¢¨²¼ ¢ ª ­®­¨·¥±ª®¬ ¢¨¤¥ (canonical form),   ¨¬¥­­®,
² ª, ·²®¡» ¢±¥ ¯°®±°®·¥­­»¥ § ª §» ±²®¿«¨ ¯®±«¥ ¢»¯®«­¥­­»µ
¢ ±°®ª,   ±°®ª¨ ¤«¿ ¢»¯®«­¥­­»µ ¢ ±°®ª § ª §®¢ ¸«¨ ¢ ­¥³¡»¢ ¾¹¥¬ ¯®°¿¤ª¥.  ± ¬®¬ ¤¥«¥, ª ª ¬» ¢¨¤¥«¨, ¬®¦­® ±·¨² ²¼, ·²®
¢±¥ ¯°®±°®·¥­­»¥ § ª §» ±²®¿² ¯®±«¥ ¢»¯®«­¥­­»µ ¢ ±°®ª. ±«¨ ²¥¯¥°¼ ¢»¯®«­¥­¨¥ ­¥¯°®±°®·¥­­»µ § ª §®¢ ­®¬¥° i ¨ j § ¢¥°¸ ¥²±¿
¢ ¬®¬¥­²» ¢°¥¬¥­¨ k ¨ k + 1 ±®®²¢¥²±²¢¥­­®, ­® ¯°¨ ½²®¬ dj < di ,
²® ¬®¦­® ¯®¬¥­¿²¼ § ª §» ¬¥±² ¬¨, ¨ ®¡  ¯®-¯°¥¦­¥¬³ ­¥ ¡³¤³²
¯°®±°®·¥­» (ª®«¼ ±ª®°® dj > k + 1, ²® ¨ ¯®¤ ¢­® di > dj > k + 1;
§ ª §³ ¦¥ ­®¬¥° j ¢®®¡¹¥ ­¨·¥£® ­¥ £°®§¨², ¯®±ª®«¼ª³ ¯® ­®¢®¬³
° ±¯¨± ­¨¾ ¥£® ¡³¤³² ¢»¯®«­¿²¼ ° ­¼¸¥, ·¥¬ ¯® ±² °®¬³). ®­¥·­®¥ ·¨±«® ² ª¨µ ®¡¬¥­®¢ ¯°¨¢¥¤¥² ° ±¯¨± ­¨¥ ª ª ­®­¨·¥±ª®¬³
¢¨¤³.
 ª¨¬ ®¡° §®¬, § ¤ ·  ® ° ±¯¨± ­¨¨ ±¢®¤¨²±¿ ª ­ µ®¦¤¥­¨¾
¬­®¦¥±²¢  A, ±®±²®¿¹¥£® ¨§ § ª §®¢, ª®²®°»¥ ­¥ ¡³¤³² ¯°®±°®·¥­»: ª ª ²®«¼ª® ½²® ¬­®¦¥±²¢® ­ ©¤¥­®, ¤«¿ ±®±² ¢«¥­¨¿ ° ±¯¨± ­¨¿ ¤®±² ²®·­® ° ±¯®«®¦¨²¼ § ª §» ¨§ ¬­®¦¥±²¢  A ¢ ¯®°¿¤ª¥
¢®§° ±² ­¨¿ ±°®ª®¢,   ¯®±«¥ ­¨µ ¢ ¯°®¨§¢®«¼­®¬ ¯®°¿¤ª¥ ¯®±² ¢¨²¼
®±² «¼­»¥ § ª §».
³¤¥¬ £®¢®°¨²¼, ·²® ¯®¤¬­®¦¥±²¢® A  S ¿¢«¿¥²±¿ ­¥§ ¢¨±¨¬»¬
(independent), ¥±«¨ ¤«¿ ½²®£® ¬­®¦¥±²¢  § ª §®¢ ¬®¦­® ±®±² ¢¨²¼
° ±¯¨± ­¨¥, ¯® ª®²®°®¬³ ¢±¥ § ª §» ¡³¤³² ¢»¯®«­¥­» ¢ ±°®ª. ¡®§­ ·¨¬ ·¥°¥§ I ±¥¬¥©±²¢® ¢±¥µ ­¥§ ¢¨±¨¬»µ ¯®¤¬­®¦¥±²¢ ¬­®¦¥±²¢  S .
 ª ¢»¿±­¨²¼, ¡³¤¥² «¨ ¤ ­­®¥ ¯®¤¬­®¦¥±²¢® A  S ­¥§ ¢¨±¨¬»¬? «¿ ª ¦¤®£® t = 1; 2; : : :; n ®¡®§­ ·¨¬ ·¥°¥§ Nt(A) ª®«¨·¥±²¢® § ª §®¢ ¨§ ¬­®¦¥±²¢  A, ¤«¿ ª®²®°»µ ±°®ª ­¥ ¯°¥¢®±µ®¤¨² t.
¥¬¬  17.11. «¿ ¢±¿ª®£® ¯®¤¬­®¦¥±²¢  A  S ±«¥¤³¾¹¨¥ ²°¨
³±«®¢¨¿ ½ª¢¨¢ «¥­²­»:
1. ¬­®¦¥±²¢® A ­¥§ ¢¨±¨¬®,
2. ¤«¿ ¢±¥µ t = 1; 2; : : :; n ¨¬¥¥¬ Nt(A) 6 t,
3. ¥±«¨ ° ±¯®«®¦¨²¼ § ª §» ¨§ ¬­®¦¥±²¢  A ¢ ¯®°¿¤ª¥ ­¥³¡»¢ ­¨¿ ±°®ª®¢, ²® ¢±¥ § ª §» ¡³¤³² ¢»¯®«­¥­» ¢ ±°®ª.
®ª § ²¥«¼±²¢®. ±«¨ Nt (A) > t ¤«¿ ­¥ª®²®°®£® t, ²® § ª §®¢, ª®²®°»¥ ¤®«¦­» ¡»²¼ ¢»¯®«­¥­» §  ¯¥°¢»¥ t ¥¤¨­¨¶ ¢°¥¬¥­¨, ¡®«¼¸¥ t ¨ ®¤¨­ ¨§ ­¨µ ­¥¯°¥¬¥­­® ¡³¤¥² ¯°®±°®·¥­.  ª¨¬ ®¡° §®¬,
(1) ¢«¥·¥² (2). ±«¨ ¢»¯®«­¥­® (2), ²® i-© ¯® ¯®°¿¤ª³ ±°®ª ®ª®­· ­¨¿ § ª §  ­¥ ¬¥­¼¸¥ i, ¨ ¯°¨ ° ±±² ­®¢ª¥ § ª §®¢ ¢ ½²®¬ ¯®°¿¤ª¥
¢±¥ ±°®ª¨ ¡³¤³² ±®¡«¾¤¥­». «¥¤®¢ ²¥«¼­®, (2) ¢«¥·¥² (3). ¬¯«¨ª ¶¨¿ (3) ) (1) ®·¥¢¨¤­ .
±«®¢¨¥ (2) ¿¢«¿¥²±¿ ³¤®¡­»¬ ª°¨²¥°¨¥¬ ­¥§ ¢¨±¨¬®±²¨ ¬­®¦¥±²¢  § ª §®¢ (±¬. ³¯° ¦­¥­¨¥ 17.5-2).

354

« ¢  17  ¤­»¥  «£®°¨²¬»

¨­¨¬¨§¨°®¢ ²¼ ±³¬¬³ ¸²° ´®¢ §  ¯°®±°®·¥­­»¥ § ª §» | ¢±¥
° ¢­®, ·²® ¬ ª±¨¬¨§¨°®¢ ²¼ ±³¬¬³ ­¥¢»¯« ·¥­­»µ ¸²° ´®¢, ²®
¥±²¼ ¸²° ´®¢,  ±±®¶¨¨°®¢ ­­»µ ± ¢»¯®«­¥­­»¬¨ ¢ ±°®ª § ª § ¬¨.
«¥¤³¾¹ ¿ ²¥®°¥¬  ¯®ª §»¢ ¥², ·²® ½²³ ®¯²¨¬¨§ ¶¨®­­³¾ § ¤ ·³
¬®¦­® °¥¸¨²¼ ± ¯®¬®¹¼¾ ¦ ¤­®£®  «£®°¨²¬ :
¥®°¥¬  17.12. ³±²¼ S | ¬­®¦¥±²¢® § ª §®¢ ° ¢­®© ¤«¨²¥«¼­®±²¨ ±® ±°®ª ¬¨,   I | ±¥¬¥©±²¢® ­¥§ ¢¨±¨¬»µ ¬­®¦¥±²¢ § ª §®¢.
®£¤  ¯ °  (S; I ) ¿¢«¿¥²±¿ ¬ ²°®¨¤®¬.
®ª § ²¥«¼±²¢®. ·¥¢¨¤­®, ª ¦¤®¥ ¯®¤¬­®¦¥±²¢® ­¥§ ¢¨±¨¬®£®
¬­®¦¥±²¢  ² ª¦¥ ­¥§ ¢¨±¨¬®, ¨ ®±² ¥²±¿ ¯°®¢¥°¨²¼ ¢»¯®«­¥­¨¥
±¢®©±²¢  § ¬¥­». ³±²¼ A ¨ B | ­¥§ ¢¨±¨¬»¥ ¬­®¦¥±²¢ , ¯°¨·¥¬
jBj > jAj. ³¤¥¬ ±° ¢­¨¢ ²¼ ·¨±«  Nt(B) ¨ Nt(A) ¯°¨ ° §«¨·­»µ t.
°¨ t = n ¯¥°¢®¥ ·¨±«® ¡®«¼¸¥; ³¬¥­¼¸ ¿ t, ¤®¦¤¥¬±¿ ¬®¬¥­² ,
ª®£¤  ®­¨ ±° ¢­¿¾²±¿, ¨ ­ §®¢¥¬ ¥£® k (¥±«¨ ½²®£® ­¥ ¯°®¨§®©¤¥²
¤® ± ¬®£® ª®­¶ , ±·¨² ¥¬ k = 0). °¨ ½²®¬ Nk (A) = Nk (B ) (¥±«¨
k > 0) ¨ Nk+1 (B ) > Nk+1 (A). «¥¤®¢ ²¥«¼­®, ¥±²¼ µ®²¿ ¡» ®¤¨­
§ ª § x 2 B n A ±® ±°®ª®¬ k + 1. ®«®¦¨¬ A0 = A [ fxg. ±«¨
t 6 k, ²® Nt(A0) = Nt(A) 6 t ¢ ±¨«³ ­¥§ ¢¨±¨¬®±²¨ ¬­®¦¥±²¢  A;
¥±«¨ t > k, ²® Nt (A0) = Nt (A)+1 6 Nt (B ) 6 t ¢ ±¨«³ ­¥§ ¢¨±¨¬®±²¨
¬­®¦¥±²¢  B ; ±² «® ¡»²¼, ¬­®¦¥±²¢® A0 ­¥§ ¢¨±¨¬® ¯® «¥¬¬¥ 17.11,
¨ ¤«¿ ¯ °» (S; I ) ¢»¯®«­¥­® ±¢®©±²¢® § ¬¥­». ±¥ ¤®ª § ­®.
§ ¤®ª § ­­®© ²¥®°¥¬» ±«¥¤³¥², ·²® ¤«¿ ­ µ®¦¤¥­¨¿ ®¯²¨¬ «¼­®£® ¬­®¦¥±²¢  A ­¥§ ¢¨±¨¬»µ § ª §®¢ ¬®¦­® ¢®±¯®«¼§®¢ ²¼±¿
¦ ¤­»¬  «£®°¨²¬®¬,   § ²¥¬ ±®±² ¢¨²¼ ° ±¯¨± ­¨¥, ­ ·¨­ ¾¹¥¥±¿ ± § ª §®¢ ¨§ ¬­®¦¥±²¢  A, ° ±±² ¢«¥­­»µ ¢ ¯®°¿¤ª¥ ¢®§° ±² ­¨¿ ±°®ª®¢ | ½²® ¨ ¡³¤¥² °¥¸¥­¨¥¬ § ¤ ·¨ ® ° ±¯¨± ­¨¨. ±«¨
¯®«¼§®¢ ²¼±¿  «£®°¨²¬®¬ Greedy, ²® ¢°¥¬¿ ° ¡®²» ¡³¤¥² O(n2),
² ª ª ª ¢ ¯°®¶¥±±¥ ° ¡®²» ½²®£®  «£®°¨²¬  ­ ¤® ±¤¥« ²¼ n ¯°®¢¥°®ª ­¥§ ¢¨±¨¬®±²¨ ¬­®¦¥±²¢ , ¨ ª ¦¤ ¿ ² ª ¿ ¯°®¢¥°ª  ²°¥¡³¥²
O(n) ®¯¥° ¶¨© (³¯°. 17.5-2). ®«¥¥ ¡»±²°»©  «£®°¨²¬ ¯°¨¢¥¤¥­ ¢
§ ¤ ·¥ 17-3.
  °¨±. 17.7 ¯°¨¢¥¤¥­ ¯°¨¬¥° § ¤ ·¨ ® ° ±¯¨± ­¨¨.  ¤­»©  «£®°¨²¬ ®²¡¨° ¥² § ª §» 1, 2, 3 ¨ 4, § ²¥¬ ®²¢¥°£ ¥² § ª §» 5 ¨ 6
¨ ®²¡¨° ¥² § ª § 7. ¯²¨¬ «¼­®¥ ° ±¯¨± ­¨¥:
(2; 4; 1; 3; 7; 5; 6):
³¬¬  ¸²° ´®¢ ° ¢­  w5 + w6 = 50.
¯° ¦­¥­¨¿
17.5-1 ¥¸¨²¥ § ¤ ·³ ® ° ±¯¨± ­¨¨ ¤«¿ ±¥¬¨ § ª §®¢, ¢ ª®²®°®©
±°®ª¨ ²¥ ¦¥, ·²® ­  °¨±. 17.7, ­® ª ¦¤»© ¸²° ´ wi § ¬¥­¥­ ­ 
80 ; wi .

 ¤ ·¨ ª £« ¢¥ 17

di
wi

1
4
70

2
2
60

355

3
4
50

 ª §
4
3
40

5
1
30

6
4
20

7
6
10

°¨¬¥° § ¤ ·¨ ® ° ±¯¨± ­¨¨ ¤«¿ § ª §®¢ ° ¢­®© ¤«¨²¥«¼­®±²¨ ±
¥¤¨­±²¢¥­­»¬ ¨±¯®«­¨²¥«¥¬, ±°®ª ¬¨ ¨ ¸²° ´ ¬¨.
¨±. 17.7

17.5-2  ª, ¨±¯®«¼§³¿ ³±«®¢¨¥ (2) ¨§ «¥¬¬» 17.11, ¢»¿±­¨²¼ § 
¢°¥¬¿ O(jAj), ¡³¤¥² «¨ ¤ ­­®¥ ¬­®¦¥±²¢® § ª §®¢ A ­¥§ ¢¨±¨¬»¬?

 ¤ ·¨
17-1 ¤ ·  ± ¤®«« ° 
³±²¼ ²°¥¡³¥²±¿ ­ ¡° ²¼ ±³¬¬³ ¢ n ¶¥­²®¢, ¨±¯®«¼§³¿ ­ ¨¬¥­¼¸¥¥ ª®«¨·¥±²¢® ¬®­¥².
 . ¯¨¸¨²¥ ¦ ¤­»©  «£®°¨²¬, ­ ¡¨° ¾¹¨© n ¶¥­²®¢ ± ¯®¬®¹¼¾
¬®­¥² ¤®±²®¨­±²¢®¬ ¢ 25, 10, 5 ¨ 1 ¶¥­². [¬¥­­® ² ª¨¥ ¬®­¥²»
¨±¯®«¼§³¾²±¿ ¢ .] ®ª ¦¨²¥, ·²®  «£®°¨²¬ ­ µ®¤¨² ®¯²¨¬ «¼­®¥ °¥¸¥­¨¥.
¡. ³±²¼ ¢ ­ ¸¥¬ ° ±¯®°¿¦¥­¨¨ ¨¬¥¾²±¿ ¬®­¥²» ¤®±²®¨­±²¢®¬
c0; c1; : : :; ck ¶¥­²®¢, £¤¥ c > 1 ¨ k > 1 | ¶¥«»¥ ·¨±« . ®ª ¦¨²¥,
·²® ¦ ¤­»©  «£®°¨²¬ ¤ ±² ¢ ½²®¬ ±«³· ¥ ®¯²¨¬ «¼­®¥ °¥¸¥­¨¥.
¢. °¨¢¥¤¨²¥ ¯°¨¬¥° ­ ¡®°  ²¨¯®¢ ¬®­¥², ¤«¿ ª®²®°®£® ¦ ¤­»©
 «£®°¨²¬ ®¯²¨¬³¬  ­¥ ¤ ±².
17-2 ¶¨ª«¨·­»¥ ¯®¤£° ´»
 . ³±²¼ G = (V; E ) | ­¥®°¨¥­²¨°®¢ ­­»© £° ´. ®ª ¦¨²¥, ·²®
¯ °  (E; I ), £¤¥ A 2 I ²®£¤  ¨ ²®«¼ª® ²®£¤ , ª®£¤  ¬­®¦¥±²¢®
A  ¶¨ª«¨·­®, ¿¢«¿¥²±¿ ¬ ²°®¨¤®¬.
¡.  ²°¨¶¥© ¨­¶¨¤¥­²­®±²¨ (incidence matrix) ­¥®°¨¥­²¨°®¢ ­­®£® £° ´  G = (V; E ) ­ §»¢ ¥²±¿ jV jjE j-¬ ²°¨¶  M , ¢ ª®²®°®©
Mve ° ¢­® ¥¤¨­¨¶¥, ¥±«¨ ¢¥°¸¨­  v ¨­¶¨¤¥­²­  °¥¡°³ e, ¨ ­³«¾
¢ ¯°®²¨¢­®¬ ±«³· ¥. (²®«¡¥¶, ±®®²¢¥²±²¢³¾¹¨© °¥¡°³, ±®¤¥°¦¨² °®¢­® ¤¢¥ ¥¤¨­¨¶», ±®®²¢¥²±²¢³¾¹¨¥ ª®­¶ ¬ ½²®£® °¥¡° .)
®ª ¦¨²¥, ·²® ­ ¡®° ±²®«¡¶®¢ ½²®© ¬ ²°¨¶» «¨­¥©­® ­¥§ ¢¨±¨¬ [­ ¤ ¯®«¥¬ ¢»·¥²®¢ ¨§ ¤¢³µ ½«¥¬¥­²®¢] ²®£¤  ¨ ²®«¼ª® ²®£¤ , ª®£¤  ±®®²¢¥²±²¢³¾¹¨© ­ ¡®° °¥¡¥°  ¶¨ª«¨·¥­. ®«¼§³¿±¼
°¥§³«¼² ²®¬ ³¯° ¦­¥­¨¿ 17.4-2, ¤®ª ¦¨²¥ ²¥¯¥°¼ ¤°³£¨¬ ±¯®±®¡®¬, ·²® ¯ °  (E; I ) ¿¢«¿¥²±¿ ¬ ²°®¨¤®¬.
¢. ³±²¼ ¢ ­¥®°¨¥­²¨°®¢ ­­®¬ £° ´¥ G = (V; E ) ¤«¿ ª ¦¤®£® °¥¡°  e 2 E § ¤ ­ ­¥®²°¨¶ ²¥«¼­»© ¢¥± w(e).  §° ¡®² ©²¥ ½´´¥ª²¨¢­»©  «£®°¨²¬ ¤«¿ ­ µ®¦¤¥­¨¿  ¶¨ª«¨·­®£® ¯®¤¬­®¦¥-

356

« ¢  17  ¤­»¥  «£®°¨²¬»

£.

¤.

¥.

±²¢  ¬­®¦¥±²¢  E ± ­ ¨¡®«¼¸¥© ±³¬¬®© ¢¥±®¢ °¥¡¥°.
³±²¼ G = (V; E ) | ®°¨¥­²¨°®¢ ­­»© £° ´, ¨ ¯³±²¼ I | ±¥¬¥©±²¢® ¢±¥µ  ¶¨ª«¨·­»µ ¯®¤¬­®¦¥±²¢ ¬­®¦¥±²¢  °¥¡¥° (¢ ¤ ­­®¬
±«³· ¥ ±«®¢® À ¶¨ª«¨·­»©Á ®§­ · ¥² À­¥ ±®¤¥°¦ ¹¨© ®°¨¥­²¨°®¢ ­­»µ ¶¨ª«®¢Á). °¨¢¥¤¨²¥ ¯°¨¬¥°, ª®£¤  ¯ °  (E; I ) ­¥ ¡³¤¥² ¬ ²°®¨¤®¬.  ª®¥ ¨§ ³±«®¢¨© ¢ ®¯°¥¤¥«¥­¨¨ ¬ ²°®¨¤  ¡³¤¥²
­ °³¸¥­®?
 ²°¨¶  ¨­¶¨¤¥­²­®±²¨ ¤«¿ ®°¨¥­²¨°®¢ ­­®£® £° ´  G =
(V; E ) | ½²® jV j  jE j-¬ ²°¨¶  M , ¢ ª®²®°®© Mve ° ¢­® ;1,
¥±«¨ ¢¥°¸¨­  v ¿¢«¿¥²±¿ ­ · «®¬ °¥¡°  e, ° ¢­® 1, ¥±«¨ ¢¥°¸¨­  v ¿¢«¿¥²±¿ ª®­¶®¬ °¥¡°  e, ¨ ° ¢­® ­³«¾ ¢ ®±² «¼­»µ
±«³· ¿µ. ®ª ¦¨²¥, ·²® ¬­®¦¥±²¢® °¥¡¥° £° ´ , ±®®²¢¥²±²¢³¾¹¥¥ «¨­¥©­® ­¥§ ¢¨±¨¬®¬³ (­ ¤ R) ­ ¡®°³ ±²®«¡¶®¢ ¬ ²°¨¶»
¨­¶¨¤¥­²­®±²¨, ­¥ ±®¤¥°¦¨² ®°¨¥­²¨°®¢ ­­®£® ¶¨ª« .
 ³¯° ¦­¥­¨¨ 17.4-2 ¬» ¤®ª § «¨, ·²® «¨­¥©­® ­¥§ ¢¨±¨¬»¥
­ ¡®°» ±²®«¡¶®¢ ¤ ­­®© ¬ ²°¨¶» ®¡° §³¾² ¬ ²°®¨¤.  ±¢¥²¥
½²®£® °¥§³«¼² ² , ­¥² «¨ ¯°®²¨¢®°¥·¨¿ ¬¥¦¤³ ³²¢¥°¦¤¥­¨¿¬¨
¯³­ª²®¢ (£) ¨ (¤) ³¯° ¦­¥­¨¿?

17-3 ¹¥ ® ° ±¯¨± ­¨¿µ
 ±±¬®²°¨¬ ±«¥¤³¾¹¨©  «£®°¨²¬ ¤«¿ °¥¸¥­¨¿ § ¤ ·¨ ¨§ ° §¤¥«  17.5 (®¯²¨¬ «¼­®¥ ° ±¯¨± ­¨¥ ¤«¿ § ª §®¢ ° ¢­®© ¤«¨²¥«¼­®±²¨
± ¥¤¨­±²¢¥­­»¬ ¨±¯®«­¨²¥«¥¬, ±°®ª ¬¨ ¨ ¸²° ´ ¬¨). ³¤¥¬ ¯¥°¥¡¨° ²¼ § ª §» ¢ ¯®°¿¤ª¥ ³¡»¢ ­¨¿ ¸²° ´®¢ ¨ § ¯®«­¿²¼ ° ±¯¨± ­¨¥ ² ª: ¥±«¨ ¤«¿ § ª §  ­®¬¥° j ±³¹¥±²¢³¥² µ®²¿ ¡» ®¤­® ±¢®¡®¤­®¥ ¬¥±²® ¢ ° ±¯¨± ­¨¨, ¯®§¢®«¿¾¹¥¥ ¢»¯®«­¨²¼ ¥£® ­¥ ¯®§¤­¥¥
²°¥¡³¥¬®£® ±°®ª  dj , ²® ¯®±² ¢¨¬ ¥£® ­  ± ¬®¥ ¯®§¤­¥¥ ¨§ ² ª¨µ
¬¥±²; ¢ ¯°®²¨¢­®¬ ±«³· ¥ ¯®±² ¢¨¬ ¥£® ­  ± ¬®¥ ¯®§¤­¥¥ ¨§ ±¢®¡®¤­»µ ¬¥±².
 . ®ª ¦¨²¥, ·²® ½²®²  «£®°¨²¬ ¤ ¥² ®¯²¨¬³¬.
¡. ®±¯®«¼§³©²¥±¼ ¯°¥¤±² ¢«¥­¨¥¬ ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ¬­®¦¥±²¢ ±
¯®¬®¹¼¾ «¥± , ®¯¨± ­­»¬ ¢ ° §¤¥«¥ 22.3, ¤«¿ ½´´¥ª²¨¢­®© °¥ «¨§ ¶¨¨ ¢»¸¥®¯¨± ­­®£®  «£®°¨²¬  (¬®¦¥²¥ ±·¨² ²¼, ·²® § ª §» ³¦¥ ° ±¯®«®¦¥­» ¢ ¯®°¿¤ª¥ ³¡»¢ ­¨¿ ¸²° ´®¢). ¶¥­¨²¥
¢°¥¬¿ ° ¡®²»  «£®°¨²¬ .

 ¬¥· ­¨¿
®¯®«­¨²¥«¼­»¥ ±¢¥¤¥­¨¿ ® ¦ ¤­»µ  «£®°¨²¬ µ ¨ ¬ ²°®¨¤ µ
¬®¦­® ­ ©²¨ ³ ®³«¥°  [132] ¨«¨  ¯ ¤¨¬¨²°¨³ ¨ ² ©£«¨¶  [154].
¥°¢®© ° ¡®²®© ¯® ª®¬¡¨­ ²®°­®© ®¯²¨¬¨§ ¶¨¨, ±®¤¥°¦ ¹¥©
¦ ¤­»©  «£®°¨²¬, ¡»«  ° ¡®²  ¤¬®­¤±  [62], ¤ ²¨°®¢ ­­ ¿ 1971
£®¤®¬, µ®²¿ ± ¬® ¯®­¿²¨¥ ¬ ²°®¨¤  ¡»«® ¢¢¥¤¥­® ¢ 1935 £®¤³ ¢

 ¬¥· ­¨¿ ª £« ¢¥ 17

357

±² ²¼¥ ¨²­¨ [200].
 ¤ · ¬¨ ½²®© £« ¢» § ­¨¬ «¨±¼ ¬­®£¨¥  ¢²®°» |  ¢°¨« [80]
(§ ¤ ·  ® ¢»¡®°¥ § ¿¢®ª), ®³«¥° [132], ®°®¢¨¶ ¨  µ­¨ [105],
° ±± ° ¨ ° ²«¨ [33] (§ ¤ ·  ® ° ±¯¨± ­¨¨).
®¤»  ´´¬¥­  ¡»«¨ ¨§®¡°¥²¥­» ¢ 1952 £®¤³ [107]. ¡§®° ¬¥²®¤®¢ ±¦ ²¨¿ ¨­´®°¬ ¶¨¨ (¯® ±®±²®¿­¨¾ ­  1987 £®¤) ¤ «¨ ¥«¥¢¥°
¨ ¨°¸¡¥°£ [136].
®°²¥ ¨ ®¢ ± [127, 128, 129, 130] ±®§¤ «¨ ²¥®°¨¾ £°¨¤®¨¤®¢
(greedoids), ¿¢«¿¾¹³¾±¿ ®¡®¡¹¥­¨¥¬ ²¥®°¨¨, ¨§«®¦¥­­®© ¢ ° §¤¥«¥ 17.4.

18

¬®°²¨§ ¶¨®­­»©  ­ «¨§

¬®°²¨§ ¶¨®­­»©  ­ «¨§ ¯°¨¬¥­¿¥²±¿ ¤«¿ ®¶¥­ª¨ ¢°¥¬¥­¨ ¢»¯®«­¥­¨¿ ­¥±ª®«¼ª¨µ ®¯¥° ¶¨© ± ª ª®©-«¨¡® ±²°³ª²³°®© ¤ ­­»µ (­ ¯°¨¬¥°, ±²¥ª®¬). ²®¡» ®¶¥­¨²¼ ¢°¥¬¿ ¢»¯®«­¥­¨¿ ª ª®©-«¨¡® ¯®±«¥¤®¢ ²¥«¼­®±²¨ ®¯¥° ¶¨©, ¤®±² ²®·­® ³¬­®¦¨²¼ ¬ ª±¨¬ «¼­³¾
¤«¨²¥«¼­®±²¼ ®¯¥° ¶¨¨ ­  ®¡¹¥¥ ·¨±«® ®¯¥° ¶¨©. ­®£¤ , ®¤­ ª®, ³¤ ¥²±¿ ¯®«³·¨²¼ ¡®«¥¥ ²®·­³¾ ®¶¥­ª³ ¢°¥¬¥­¨ ° ¡®²» (¨«¨,
·²® ° ¢­®±¨«¼­®, ±°¥¤­¥£® ¢°¥¬¥­¨ ¢»¯®«­¥­¨¿ ®¤­®© ®¯¥° ¶¨¨),
¨±¯®«¼§³¿ ²®² ´ ª², ·²® ¢® ¬­®£¨µ ±«³· ¿µ ¯®±«¥ ¤«¨²¥«¼­»µ ®¯¥° ¶¨© ­¥±ª®«¼ª® ±«¥¤³¾¹¨µ ®¯¥° ¶¨© ¢»¯®«­¿¾²±¿ ¡»±²°®. ¶¥­ª¨ ² ª®£® °®¤  ­ §»¢ ¾²±¿  ¬®°²¨§ ¶¨®­­»¬  ­ «¨§®¬ (amortized
analysis)  «£®°¨²¬ . ®¤·¥°ª­¥¬, ·²® ®¶¥­ª , ¤ ¢ ¥¬ ¿  ¬®°²¨§ ¶¨®­­»¬  ­ «¨§®¬, ­¥ ¿¢«¿¥²±¿ ¢¥°®¿²­®±²­®©: ½²® ®¶¥­ª  ±°¥¤­¥£® ¢°¥¬¥­¨ ¢»¯®«­¥­¨¿ ®¤­®© ®¯¥° ¶¨¨ ¤«¿ µ³¤¸¥£® ±«³· ¿.
[°¨  ¬®°²¨§ ¶¨®­­®¬  ­ «¨§¥ ª ¦¤®© ®¯¥° ¶¨¨ ¯°¨±¢ ¨¢ ¥²±¿
­¥ª®²®° ¿ ³·¥²­ ¿ ±²®¨¬®±²¼ (amortized cost), ª®²®° ¿ ¬®¦¥² ¡»²¼
¡®«¼¸¥ ¨«¨ ¬¥­¼¸¥ °¥ «¼­®© ¤«¨²¥«¼­®±²¨ ®¯¥° ¶¨¨. °¨ ½²®¬
¤®«¦­® ¢»¯®«­¿²¼±¿ ±«¥¤³¾¹¥¥ ³±«®¢¨¥: ¤«¿ «¾¡®© ¯®±«¥¤®¢ ²¥«¼­®±²¨ ®¯¥° ¶¨© ´ ª²¨·¥±ª ¿ ±³¬¬ °­ ¿ ¤«¨²¥«¼­®±²¼ ¢±¥µ ®¯¥° ¶¨© (¯°¥¤¯®« £ ¥²±¿, ·²® ¤® ¢»¯®«­¥­¨¿ ®¯¥° ¶¨© ±²°³ª²³°  ¤ ­­»µ ­ µ®¤¨²±¿ ¢ ­ · «¼­®¬ ±®±²®¿­¨¨ | ­ ¯°¨¬¥°, ±²¥ª ¯³±²) ­¥
¯°¥¢®±µ®¤¨² ±³¬¬» ¨µ ³·¥²­»µ ±²®¨¬®±²¥©. ±«¨ ½²® ³±«®¢¨¥ ¢»¯®«­¥­®, ²® £®¢®°¿², ·²® ³·¥²­»¥ ±²®¨¬®±²¨ ¯°¨±¢®¥­» ª®°°¥ª²­®.
 ¬¥²¨¬, ·²® ¤«¿ ®¤­®© ¨ ²®© ¦¥ ±²°³ª²³°» ¤ ­­»µ ¨ ®¤­¨µ ¨ ²¥µ
¦¥  «£®°¨²¬®¢ ¢»¯®«­¥­¨¿ ®¯¥° ¶¨© ¬®¦­® ª®°°¥ª²­® ­ §­ ·¨²¼
³·¥²­»¥ ±²®¨¬®±²¨ ­¥±ª®«¼ª¨¬¨ ° §«¨·­»¬¨ ±¯®±®¡ ¬¨.]
 ¯¥°¢»µ ²°¥µ ° §¤¥« µ ½²®© £« ¢» ° ±±ª §»¢ ¥²±¿ ® ²°¥µ ®±­®¢­»µ ¬¥²®¤ µ  ¬®°²¨§ ¶¨®­­®£®  ­ «¨§ .  ° §¤¥«¥ 18.1 °¥·¼ ¨¤¥²
® ¬¥²®¤¥ £°³¯¯¨°®¢ª¨: ¬» ¬®¦¥¬ ®¶¥­¨²¼ ±²®¨¬®±²¼ n ®¯¥° ¶¨© ¢
µ³¤¸¥¬ ±«³· ¥ ¨ ³±² ­®¢¨²¼, ·²® ®­  ­¥ ¯°¥¢®±µ®¤¨² T (n)). ®±«¥
½²®£® ¬®¦­® ®¡º¿¢¨²¼, ·²® ³·¥²­ ¿ ±²®¨¬®±²¼ «¾¡®© ®¯¥° ¶¨¨,
­¥§ ¢¨±¨¬® ®² ¥¥ ¤«¨²¥«¼­®±²¨, ° ¢­  T (n)=n.
 ° §¤¥«¥ 18.2 ° ±±ª §»¢ ¥²±¿ ® ¬¥²®¤¥ ¯°¥¤®¯« ²». °¨ ½²®¬
¬¥²®¤¥  ¬®°²¨§ ¶¨®­­®£®  ­ «¨§  ° §«¨·­»¬ ®¯¥° ¶¨¿¬ ¬®£³²
¯°¨±¢ ¨¢ ²¼±¿ ° §«¨·­»¥ ³·¥²­»¥ ±²®¨¬®±²¨.  ­¥ª®²®°»µ ®¯¥° -

¥²®¤ £°³¯¯¨°®¢ª¨

359

¶¨© ³·¥²­ ¿ ±²®¨¬®±²¼ ®¡º¿¢«¿¥²±¿ ¢»¸¥ °¥ «¼­®©. ®£¤  ¢»¯®«­¿¥²±¿ ² ª ¿ ®¯¥° ¶¨¿, ®±² ¥²±¿ °¥§¥°¢, ª®²®°»© ±·¨² ¥²±¿ µ° ­¿¹¨¬±¿ ¢ ®¯°¥¤¥«¥­­®¬ ¬¥±²¥ ±²°³ª²³°» ¤ ­­»µ. ²®² °¥§¥°¢
¨±¯®«¼§³¥²±¿ ¤«¿ ¤®¯« ²» §  ®¯¥° ¶¨¨, ³·¥²­ ¿ ±²®¨¬®±²¼ ª®²®°»µ ­¨¦¥ ´ ª²¨·¥±ª®©.
 ¬¥²®¤¥ ¯®²¥­¶¨ «®¢, ®¡±³¦¤ ¥¬®¬ ¢ ° §¤¥«¥ 18.3, °¥§¥°¢ ­¥
±¢¿§»¢ ¥²±¿ ± ª ª¨¬¨-²® ª®­ª°¥²­»¬¨ ®¡º¥ª² ¬¨,   ¿¢«¿¥²±¿
´³­ª¶¨¥© ²¥ª³¹¥£® ±®±²®¿­¨¿ ±²°³ª²³°» ¤ ­­»µ. ²  ´³­ª¶¨¿
­ §»¢ ¥²±¿ À¯®²¥­¶¨ «®¬Á, ¨ ³·¥²­»¥ ±²®¨¬®±²¨ ¤®«¦­» ¡»²¼ ±
­¥© ±®£« ±®¢ ­».
» ¨««¾±²°¨°³¥¬ ½²¨ ²°¨ ¬¥²®¤  ­  ¤¢³µ ¯°¨¬¥° µ. ¥°¢»©
¨§ ­¨µ | ±²¥ª, ±­ ¡¦¥­­»© ¤®¯®«­¨²¥«¼­®© ®¯¥° ¶¨¥© Multipop,
³¤ «¿¾¹¥© ¨§ ±²¥ª  ­¥±ª®«¼ª® ½«¥¬¥­²®¢ ®¤­®¢°¥¬¥­­®. ²®°®©
¯°¨¬¥° | ¤¢®¨·­»© ±·¥²·¨ª, ±­ ¡¦¥­­»© ¥¤¨­±²¢¥­­®© ®¯¥° ¶¨¥©
Increment (³¢¥«¨·¨²¼ ­  ¥¤¨­¨¶³).
 ¬¥²¨¬, ·²® ¯®­¿²¨¥ ¯®²¥­¶¨ «  ¨±¯®«¼§³¥²±¿ ¤«¿  ­ «¨§   «£®°¨²¬ ; ¢ ± ¬®© ¯°®£° ¬¬¥ ­¥² ­¥®¡µ®¤¨¬®±²¨ ¢»·¨±«¿²¼ ¨ µ° ­¨²¼ ¥£® §­ ·¥­¨¥.
¤¥¨, ±¢¿§ ­­»¥ ±  ¬®°²¨§ ¶¨®­­»¬  ­ «¨§®¬, ¯®«¥§­® ¨¬¥²¼ ¢
¢¨¤³ ¯°¨ ° §° ¡®²ª¥  «£®°¨²¬®¢. °¨¬¥° ² ª®£® °®¤  ¤ ­ ¢ ° §¤¥«¥ 18.4 (² ¡«¨¶  ¯¥°¥¬¥­­®£® ° §¬¥° ).

18.1. ¥²®¤ £°³¯¯¨°®¢ª¨
¥²®¤ £°³¯¯¨°®¢ª¨ (aggregate method) ±®±²®¨² ¢ ±«¥¤³¾¹¥¬:
¤«¿ ª ¦¤®£® n ®¶¥­¨¢ ¥²±¿ ¢°¥¬¿ T (n), ²°¥¡³¥¬®¥ ­  ¢»¯®«­¥­¨¥
n ®¯¥° ¶¨© (¢ µ³¤¸¥¬ ±«³· ¥). °¥¬¿ ¢ ° ±·¥²¥ ­  ®¤­³ ®¯¥° ¶¨¾,
²® ¥±²¼ ®²­®¸¥­¨¥ T (n)=n, ®¡º¿¢«¿¥²±¿ ³·¥²­®© ±²®¨¬®±²¼¾ ®¤­®© ®¯¥° ¶¨¨. °¨ ½²®¬ ³·¥²­»¥ ±²®¨¬®±²¨ ¢±¥µ ®¯¥° ¶¨© ®ª §»¢ ¾²±¿ ®¤¨­ ª®¢»¬¨ (¯°¨ ¤¢³µ ¤°³£¨µ ¬¥²®¤ µ  ¬®°²¨§ ¶¨®­­®£®
 ­ «¨§  ½²® ¡³¤¥² ­¥ ² ª).
¯¥° ¶¨¨ ±® ±²¥ª®¬
» ¯°¨¬¥­¨¬ ¬¥²®¤ £°³¯¯¨°®¢ª¨ ¤«¿  ­ «¨§  ±²¥ª  ± ®¤­®© ¤®¯®«­¨²¥«¼­®© ®¯¥° ¶¨¥©.  ° §¤¥«¥ 11.1 ¬» ¢¢¥«¨ ¤¢¥ ®±­®¢­»¥
®¯¥° ¶¨¨ ±® ±²¥ª®¬:
Push(S; x) ¤®¡ ¢«¿¥² ½«¥¬¥­² x ª ±²¥ª³ S ;
Pop(S ) ³¤ «¿¥² ¢¥°¸¨­³ ±²¥ª  S (¨ ¢®§¢° ¹ ¥² ¥¥).
 ¦¤ ¿ ¨§ ½²¨µ ®¯¥° ¶¨© ¢»¯®«­¿¥²±¿ §  ¢°¥¬¿ O(1). «¥¤®¢ ²¥«¼­®, ¢»¯®«­¥­¨¥ n ®¯¥° ¶¨© Push ¨ Pop ²°¥¡³¥² ¢°¥¬¥­¨ (n).
¨²³ ¶¨¿ ±² ­®¢¨²±¿ ¡®«¥¥ ¨­²¥°¥±­®©, ¥±«¨ ¤®¡ ¢¨²¼ ®¯¥° ¶¨¾
Multipop(S; k), ª®²®° ¿ ³¤ «¿¥² k ½«¥¬¥­²®¢ ¨§ ±²¥ª  (¥±«¨ ¢ ±²¥ª¥

360

« ¢  18 ¬®°²¨§ ¶¨®­­»©  ­ «¨§

¥©±²¢¨¥ ®¯¥° ¶¨¨ Multipop ­  ±²¥ª¥ S . ( )  · «¼­®¥ ±®±²®¿­¨¥
±²¥ª . Multipop(S; 4) ³¤ «¿¥² ¨§ ±²¥ª  ¢¥°µ­¨¥ ·¥²»°¥ ½«¥¬¥­² , ¨ ±²¥ª ¯°¨µ®¤¨² ¢ ±®±²®¿­¨¥ (¡). ±«¨ ²¥¯¥°¼ ¯°¨¬¥­¨²¼ ®¯¥° ¶¨¾ Multipop(S; 7), ²® ±²¥ª
±² ­¥² ¯³±² (¢), ² ª ª ª ¯¥°¥¤ ¯°¨¬¥­¥­¨¥¬ ½²®© ®¯¥° ¶¨¨ ¢ ±²¥ª¥ ¡»«® ¬¥­¥¥
±¥¬¨ ½«¥¬¥­²®¢.
¨±. 18.1

±®¤¥°¦¨²±¿ ¬¥­¥¥ k ½«¥¬¥­²®¢, ²® ³¤ «¿¥²±¿ ¢±¥, ·²® ² ¬ ¥±²¼). ¥
¬®¦­® °¥ «¨§®¢ ²¼ ² ª (Stack-Empty ¢®§¢° ¹ ¥² true ²®£¤  ¨
²®«¼ª® ²®£¤ , ª®£¤  ±²¥ª ¯³±²):
Multipop(S; k)
1 while not Stack-Empty(S ) and k 6= 0
2
do Pop(S )
3
k k;1
°¨¬¥° ° ¡®²» ®¯¥° ¶¨¨ Multipop ¯°¨¢¥¤¥­ ­  °¨±. 18.1.
°¨ ¯°¨¬¥­¥­¨¨ ®¯¥° ¶¨¨ Multipop(S; k) ª ±²¥ª³, ±®¤¥°¦ ¹¥¬³
s ½«¥¬¥­²®¢, ¡³¤¥² ¯°®¨§¢¥¤¥­® min(s; k) ®¯¥° ¶¨© Pop. ®½²®¬³
(¨¬¥¥²±¿ ¢ ¢¨¤³ ´ ª²¨·¥±ª ¿ ±²®¨¬®±²¼,   ­¥ ³·¥²­ ¿) ¢°¥¬¿ ¥¥
° ¡®²» ¯°®¯®°¶¨®­ «¼­® min(s; k).
·¨² ¿, ·²® ®¯¥° ¶¨¨ Push, Pop ¨¬¥¾² ¥¤¨­¨·­³¾ ±²®¨¬®±²¼
(¨¬¥¥²±¿ ¢ ¢¨¤³ ´ ª²¨·¥±ª ¿ ±²®¨¬®±²¼,   ­¥ ³·¥²­ ¿),   ®¯¥° ¶¨¿ Multipop ¨¬¥¥² ±²®¨¬®±²¼ min(s; k), ®¶¥­¨¬ ±³¬¬ °­³¾ ±²®¨¬®±²¼ n ®¯¥° ¶¨©, ¯°¨¬¥­¥­­»µ ª ¨§­ · «¼­® ¯³±²®¬³ ±²¥ª³. ²®¨¬®±²¼ «¾¡®© ¨§ ®¯¥° ¶¨© ­¥ ¯°¥¢®±µ®¤¨² n (± ¬ ¿ ¤®°®£ ¿ ®¯¥° ¶¨¿ Multipop ±²®¨² ­¥ ¡®«¥¥ n, ¯®±ª®«¼ª³ §  n ®¯¥° ¶¨© ¢ ±²¥ª¥
­¥ ­ ¡¥°¥²±¿ ¡®«¥¥ n ½«¥¬¥­²®¢). «¥¤®¢ ²¥«¼­®, ±³¬¬ °­ ¿ ±²®¨¬®±²¼ n ®¯¥° ¶¨© ¥±²¼ O(n2). ²  ®¶¥­ª , ®¤­ ª®, ±«¨¸ª®¬ £°³¡ .
²®¡» ¯®«³·¨²¼ ²®·­³¾ ®¶¥­ª³, § ¬¥²¨¬, ·²®, ª®«¼ ±ª®°® ¯¥°¢®­ · «¼­® ±²¥ª ¡»« ¯³±², ®¡¹¥¥ ·¨±«® °¥ «¼­® ¢»¯®«­¿¥¬»µ ®¯¥° ¶¨©
Pop (¢ª«¾· ¿ ²¥ ¨§ ­¨µ, ·²® ¢»§»¢ ¾²±¿ ¨§ ¯°®¶¥¤³°» Multipop)
­¥ ¯°¥¢®±µ®¤¨² ®¡¹¥£® ·¨±«  ®¯¥° ¶¨© Push,   ½²® ¯®±«¥¤­¥¥ ­¥
¯°¥¢®±µ®¤¨² n. ² «® ¡»²¼, ±²®¨¬®±²¼ «¾¡®© ¯®±«¥¤®¢ ²¥«¼­®±²¨
¨§ n ®¯¥° ¶¨© Push, Pop ¨ Multipop, ¯°¨¬¥­¥­­»µ ª ¯³±²®¬³ ±²¥ª³, ¥±²¼ O(n). ¥¬ ± ¬»¬ ¬®¦­® ®¡º¿¢¨²¼, ·²® ³·¥²­ ¿ ±²®¨¬®±²¼
ª ¦¤®© ¨§ ®¯¥° ¶¨© ¥±²¼ O(n)=n = O(1).
®¤·¥°ª­¥¬ ¥¹¥ ° §, ·²® ­ ¸  ®¶¥­ª  ­¥ ¿¢«¿¥²±¿ ¢¥°®¿²­®±²­®©: ±²®¨¬®±²¼ (¢ ° ±·¥²¥ ­  ®¤­³ ®¯¥° ¶¨¾) ®¶¥­¨¢ ¥²±¿ ¤«¿ µ³¤¸¥£® ±«³· ¿.

¥²®¤ £°³¯¯¨°®¢ª¨

361

counter value | §­ ·¥­¨¥ ±·¥²·¨ª ,
total cost | ±²®¨¬®±²¼

®±²®¿­¨¿ ¢®±¼¬¨¡¨²®¢®£® ¤¢®¨·­®£® ±·¥²·¨ª  ¢ ¯°®¶¥±±¥ ¢»¯®«­¥­¨¿ 16 ¯®±«¥¤®¢ ²¥«¼­»µ ®¯¥° ¶¨© Increment.  ¸²°¨µ®¢ ­» ¡¨²», §­ ·¥­¨¿
ª®²®°»µ ¨§¬¥­¿²±¿ ¯°¨ ±«¥¤³¾¹¥© ®¯¥° ¶¨¨ Increment.  ¯° ¢®© £° ´¥ ¯®ª § ­  ®¡¹ ¿ ±²®¨¬®±²¼ ¢±¥µ ®¯¥° ¶¨© ¯® ³±² ­®¢ª¥ ¨«¨ ®·¨±²ª¥ ¡¨²®¢, ­¥®¡µ®¤¨¬»µ, ·²®¡» ¤®±·¨² ²¼ ¤® ¤ ­­®£® ·¨±« .  ¬¥²¼²¥, ·²® ¢ ±²°®ª¥ ­®¬¥° k
½²  ±²®¨¬®±²¼ ­¥ ¯°¥¢®±µ®¤¨² 2k.
¨±. 18.2

¢®¨·­»© ±·¥²·¨ª
 ½²®¬ ° §¤¥«¥ ¬» ¯°¨¬¥­¨¬ ¬¥²®¤ £°³¯¯¨°®¢ª¨ ª  ­ «¨§³ k¡¨²­®£® ¤¢®¨·­®£® ±·¥²·¨ª . ·¥²·¨ª °¥ «¨§®¢ ­ ª ªP¬ ±±¨¢ ¡¨;1 A[i]  2i
²®¢ A[0 : :k ; 1] ¨ µ° ­¨² ¤¢®¨·­³¾ § ¯¨±¼ ·¨±«  x = ki=0
(² ª ·²® A[0] | ¬« ¤¸¨© ¡¨²). ¥°¢®­ · «¼­® x = 0, ². ¥. A[i] = 0
¤«¿ ¢±¥µ i. ¯°¥¤¥«¨¬ ®¯¥° ¶¨¾ Increment (³¢¥«¨·¨²¼ ­  1 ¯®
¬®¤³«¾ 2k ) ² ª:
Increment(A)
1 i 0
2 while i < length[A] and A[i] = 1
3
do A[i] 0
4
i i+1
5 if i < length[A]
6 then A[i] 1
® ±³¹¥±²¢³ ²®² ¦¥  «£®°¨²¬ ¨±¯®«¼§³¥²±¿ ¢ °¥ «¼­»µ ª®¬¯¼¾²¥° µ (ª ±ª ¤­®¥ ±«®¦¥­¨¥ | ±¬. ° §¤¥« 29.2.1).   °¨±. 18.2 ¨§®¡° ¦¥­» ±®±²®¿­¨¿ ¤¢®¨·­®£® ±·¥²·¨ª  ¯°¨ 16 ¯®±«¥¤®¢ ²¥«¼­»µ
¯°¨¬¥­¥­¨¿µ ®¯¥° ¶¨¨ Increment, ­ ·¨­ ¿ ®² 0 ¤® 16. ¢¥«¨·¥­¨¥
±·¥²·¨ª  ­  ¥¤¨­¨¶³ ¯°®¨±µ®¤¨² ±«¥¤³¾¹¨¬ ®¡° §®¬: ¢±¥ ­ · «¼­»¥ ¥¤¨­¨·­»¥ ¡¨²» ¢ ¬ ±±¨¢¥ A ±² ­®¢¿²±¿ ­³«¿¬¨ (¶¨ª« ¢ ±²°®ª µ 2{4),   ±«¥¤³¾¹¨© ­¥¯®±°¥¤±²¢¥­­® §  ­¨¬¨ ­³«¥¢®© ¡¨² (¥±«¨

362

« ¢  18 ¬®°²¨§ ¶¨®­­»©  ­ «¨§

² ª®¢®© ¥±²¼) ³±² ­ ¢«¨¢ ¥²±¿ ¢ ¥¤¨­¨¶³. ²®¨¬®±²¼ ®¯¥° ¶¨¨ Increment «¨­¥©­® § ¢¨±¨² ®² ®¡¹¥£® ª®«¨·¥±²¢  ¡¨²®¢, ¯®¤¢¥°£¸¨µ±¿ ®·¨±²ª¥ ¨«¨ ³±² ­®¢ª¥. ²±¾¤  ±° §³ ¯®«³· ¥²±¿ £°³¡ ¿
®¶¥­ª : ¯®±ª®«¼ª³ ¢ µ³¤¸¥¬ ±«³· ¥ (¬ ±±¨¢ A ±®±²®¨² ¨§ ®¤­¨µ
¥¤¨­¨¶) ¬¥­¿¾²±¿ k ¡¨²®¢, ²°¥¡³¥²±¿ O(nk) ®¯¥° ¶¨©, ·²®¡» ±®±·¨² ²¼ ®² 0 ¤® n.
²®¡» ¯®«³·¨²¼ ¡®«¥¥ ²®·­³¾ ®¶¥­ª³, § ¬¥²¨¬, ·²® ­¥ ª ¦¤»©
° § §­ ·¥­¨¿ ¢±¥µ k ¡¨²®¢ ¬¥­¿¾²±¿.  ± ¬®¬ ¤¥«¥, ¬« ¤¸¨© ¡¨²
A[0] ¬¥­¿¥²±¿ ¯°¨ ª ¦¤®¬ ¨±¯®«­¥­¨¨ ®¯¥° ¶¨¨ Increment (±¬.
°¨±. 18.2). «¥¤³¾¹¨© ¯® ±² °¸¨­±²¢³ ¡¨² A[1] ¬¥­¿¥²±¿ ²®«¼ª®
·¥°¥§ ° §: ¯°¨ ®²±·¥²¥ ®² ­³«¿ ¤® n ½²®² ¡¨² ¬¥­¿¥²±¿ bn=2c ° §.
 «¥¥, A[N ] ¬¥­¿¥²±¿ ²®«¼ª® ª ¦¤»© ·¥²¢¥°²»© ° §, ¨ ² ª ¤ «¥¥:
¥±«¨ 0 6 i 6 lg n, ²® ¢ ¯°®¶¥±±¥ ±·¥²  ®² 0 ¤® n ¡¨² A[i] ¬¥­¿¥²±¿
bn=2ic ° §,   ¥±«¨ i > blg nc, ²® ¡¨² i ¢®®¡¹¥ ­¥ ¬¥­¿¥²±¿. ² «®
¡»²¼, ®¡¹¥¥ ª®«¨·¥±²¢® ®¯¥° ¶¨© ®·¨±²ª¨ ¨ ³±² ­®¢ª¨ ¡¨²®¢ ° ¢­®
bX
lg nc j
i=0

1 1
nk < nX
2i
2i = 2n:
i=0

¥¬ ± ¬»¬ ³¢¥«¨·¥­¨¥ ¤¢®¨·­®£® ±·¥²·¨ª  ®² 0 ¤® n ²°¥¡³¥² ¢
µ³¤¸¥¬ ±«³· ¥ O(n) ®¯¥° ¶¨©, ¯°¨·¥¬ ª®­±² ­²  ­¥ § ¢¨±¨² ®² k
(¨ ° ¢­  2); ³·¥²­³¾ ±²®¨¬®±²¼ ª ¦¤®© ®¯¥° ¶¨¨ ¬®¦­® ±·¨² ²¼
° ¢­®© O(n)=n = O(1) (ª®­±² ­²  ®¯¿²¼ ¦¥ ­¥ § ¢¨±¨² ®² k).
¯° ¦­¥­¨¿
18.1-1

°¥¤¯®«®¦¨¬, ·²® ¬» ° §°¥¸¨«¨ ­¥ ²®«¼ª® ®¯¥° ¶¨¾

Multipop, ­® ¨ Multipush, ¤®¡ ¢«¿¾¹³¾ ª ±²¥ª³ ¯°®¨§¢®«¼­®¥

ª®«¨·¥±²¢® ½«¥¬¥­²®¢. ®¦­® «¨ ²¥¯¥°¼ ±·¨² ²¼ ³·¥²­³¾ ±²®¨¬®±²¼ ª ¦¤®© ®¯¥° ¶¨¨ ° ¢­®© O(1)?
18.1-2 ¯°¥¤¥«¨¬ ¤«¿ k-¡¨²®¢®£® ¤¢®¨·­®£® ±·¥²·¨ª  ®¯¥° ¶¨¾
Decrement (¢»·¨² ­¨¥ ¥¤¨­¨¶» ¯® ¬®¤³«¾ 2k ). ®ª ¦¨²¥, ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¨§ n ®¯¥° ¶¨© Increment ¨ Decrement ¢ µ³¤¸¥¬
±«³· ¥ ²°¥¡³¥² ¢°¥¬¥­¨ (nk).
18.1-3  ±±¬®²°¨¬ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ®¯¥° ¶¨©, ¢ ª®²®°®© ±²®¨¬®±²¼ ®¯¥° ¶¨¨ ­®¬¥° i ° ¢­  i, ¥±«¨ i ¿¢«¿¥²±¿ ±²¥¯¥­¼¾ ¤¢®©ª¨,
¨ 1 ¢ ¯°®²¨¢­®¬ ±«³· ¥. ¶¥­¨²¥ ±°¥¤­¾¾ ±²®¨¬®±²¼ ®¤­®© ®¯¥° ¶¨¨ ¢ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¨§ n ®¯¥° ¶¨©.

18.2. ¥²®¤ ¯°¥¤®¯« ²»
°¨ ¯°®¢¥¤¥­¨¨  ¬®°²¨§ ¶¨®­­®£®  ­ «¨§  ¯® ¬¥²®¤³ ¯°¥¤®¯« ²» (accounting method) ª ¦¤®© ®¯¥° ¶¨¨ ¯°¨±¢ ¨¢ ¥²±¿ ±¢®¿

¥²®¤ ¯°¥¤®¯« ²»

363

³·¥²­ ¿ ±²®¨¬®±²¼, ¯°¨·¥¬ ½²¨ ±²®¨¬®±²¨ ¬®£³² ¡»²¼ ª ª ¡®«¼¸¥, ² ª ¨ ¬¥­¼¸¥ °¥ «¼­»µ. ±«¨ ³·¥²­ ¿ ±²®¨¬®±²¼ ¯°¥¢®±µ®¤¨²
°¥ «¼­³¾, ° §­®±²¼ ° ±±¬ ²°¨¢ ¥²±¿ ª ª °¥§¥°¢ (credit), ª®²®°»©
±·¨² ¥²±¿ ±¢¿§ ­­»¬ ± ª ª¨¬-²® ®¡º¥ª²®¬ ±²°³ª²³°» ¤ ­­»µ ¨
° ±±¬ ²°¨¢ ¥²±¿ ª ª ¯°¥¤®¯« ²  §  ¡³¤³¹³¾ ®¡° ¡®²ª³ ½²®£® ®¡º¥ª² .   ±·¥² ½²®£® °¥§¥°¢  ª®¬¯¥­±¨°³¥²±¿ ° §­¨¶  ¬¥¦¤³ ³·¥²­®© ¨ °¥ «¼­®© ±²®¨¬®±²¼¾ ¤«¿ ²¥µ ®¯¥° ¶¨©, ³ ª®²®°»µ ³·¥²­ ¿
±²®¨¬®±²¼ ­¨¦¥ °¥ «¼­®©.
» ¤®«¦­» ¢»¡¨° ²¼ ³·¥²­»¥ ±²®¨¬®±²¨ ² ª, ·²®¡» ´ ª²¨·¥±ª ¿ ±²®¨¬®±²¼ ­¥ ¯°¥¢®±µ®¤¨«  ±³¬¬» ³·¥²­»µ ±²®¨¬®±²¥©, ²®
¥±²¼ ·²®¡» °¥§¥°¢ ®±² ¢ «±¿ ­¥®²°¨¶ ²¥«¼­»¬ ¢ «¾¡®© ¬®¬¥­²
° ¡®²».
¯¥° ¶¨¨ ±® ±²¥ª®¬
°®¨««¾±²°¨°³¥¬ ¬¥²®¤ ¯°¥¤®¯« ²» ­  ³¦¥ ¨§¢¥±²­®¬ ¯°¨¬¥°¥
±® ±²¥ª®¬.  ¯®¬­¨¬, ·²® °¥ «¼­»¥ ±²®¨¬®±²¨ ®¯¥° ¶¨© ±® ±²¥ª®¬
¬» ±·¨² ¥¬ ² ª¨¬¨:
Push
1;
Pop
1;
Multipop min(s; k);
£¤¥ k | ª®«¨·¥±²¢® ½«¥¬¥­²®¢, ³¤ «¿¥¬»µ ¨§ ±²¥ª , s | ° §¬¥°
±²¥ª . °¨±¢®¨¬ ½²¨¬ ®¯¥° ¶¨¿¬ ² ª¨¥ ³·¥²­»¥ ±²®¨¬®±²¨:
Push
2;
Pop
0;
Multipop 0:
 ­ ¸¥¬ ¯°¨¬¥°¥ ³·¥²­»¥ ±²®¨¬®±²¨ ¢±¥µ ®¯¥° ¶¨© ¯®±²®¿­­»;
¢®§¬®¦­» ±«³· ¨, ª®£¤  ½²¨ ±²®¨¬®±²¨ ­¥¯®±²®¿­­» ¨ ¤ ¦¥ ¨¬¥¾²
° §«¨·­»¥  ±¨¬¯²®²¨ª¨ ¤«¿ ° §­»µ ®¯¥° ¶¨©.
®ª ¦¥¬ ²¥¯¥°¼, ·²® ¢»¡° ­­»¥ ­ ¬¨ ³·¥²­»¥ ±²®¨¬®±²¨ ¯®§¢®«¿¾² ¯®«­®±²¼¾ ¯®ª°»²¼ °¥ «¼­³¾ ±²®¨¬®±²¼ ®¯¥° ¶¨© ±® ±²¥ª®¬. ³¤¥¬ ±·¨² ²¼, ·²® ¥¤¨­¨¶¥© ±²®¨¬®±²¨ ®¯¥° ¶¨© ¿¢«¿¥²±¿
¤®«« °. ®±¯®«¼§³¥¬±¿  ­ «®£¨¥© ¬¥¦¤³ ±²¥ª®¬ ¨ ±²®¯ª®© ² °¥«®ª
(±¬. ° §¤. 11.1). ¥°¢®­ · «¼­® ­¨ ®¤­®© ² °¥«ª¨ ¢ ±²®¯ª¥ ­¥² (¬»
­ ·¨­ ¥¬ ± ¯³±²®£® ±²¥ª ). ®£¤  ¬» ¤®¡ ¢«¿¥¬ ² °¥«ª³ ª ±²®¯ª¥,
¬» ¤®«¦­» § ¯« ²¨²¼ 1 ¤®«« ° §  ®¯¥° ¶¨¾ Push (½²® ¥¥ °¥ «¼­ ¿
¶¥­ ). ¤¨­ ¤®«« ° ®±² ¥²±¿ ³ ­ ± ¢ °¥§¥°¢¥, ¢¥¤¼ ³·¥²­ ¿ ¶¥­  ®¯¥° ¶¨¨ Push ° ¢­  ¤¢³¬ ¤®«« ° ¬. ³¤¥¬ ¢±¿ª¨© ° § ª« ±²¼ ½²®²
°¥§¥°¢­»© ¤®«« ° ­  ±®®²¢¥²±²¢³¾¹³¾ ² °¥«ª³. ®£¤  ¢ ª ¦¤»©
¬®¬¥­² ­  ª ¦¤®© ² °¥«ª¥ ¢ ­ ¸¥© ±²®¯ª¥ ¡³¤¥² «¥¦ ²¼ ¯® ¤®«« °®¢®© ¡³¬ ¦ª¥.
®«« °, «¥¦ ¹¨© ­  ² °¥«ª¥, | ½²® ¯°¥¤®¯« ²  §  ³¤ «¥­¨¥ ² °¥«ª¨ ¨§ ±²®¯ª¨. ®£¤  ¬» ¯°®¨§¢®¤¨¬ ®¯¥° ¶¨¾ Pop, ¬» §  ­¥¥
­¨·¥£® ¤®¯®«­¨²¥«¼­® ­¥ ¯« ²¨¬ (³·¥²­ ¿ ±²®¨¬®±²¼ Pop ° ¢­ 

364

« ¢  18 ¬®°²¨§ ¶¨®­­»©  ­ «¨§

­³«¾),   ° ±¯« ·¨¢ ¥¬±¿ §  ³¤ «¥­¨¥ ² °¥«ª¨ «¥¦ ¹¨¬ ­  ­¥© °¥§¥°¢­»¬ ¤®«« °®¬. ®·­® ² ª ¦¥ ¬» ¨¬¥¥¬ ¢®§¬®¦­®±²¼ ®¡º¿¢¨²¼
®¯¥° ¶¨¾ Multipop ¡¥±¯« ²­®©: ¥±«¨ ­ ¤® ³¤ «¨²¼ k ² °¥«®ª, § 
³¤ «¥­¨¥ ª ¦¤®© ¨§ ­¨µ ¬» ° ±¯« ²¨¬±¿ «¥¦ ¹¨¬ ­  ­¥© ¤®«« °®¬. ² «® ¡»²¼, ¨§¡»²®·­ ¿ ¯« ² , ª®²®°³¾ ¬» ¡¥°¥¬ §  ®¯¥° ¶¨¾ Push, ¯®ª°»¢ ¥² ° ±µ®¤» ­  ®¯¥° ¶¨¨ Pop ¨ Multipop.
(±²®¨¬®±²¼ «¾¡®© ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¨§ n ®¯¥° ¶¨© Push, Pop ¨
Multipop ­¥ ¯°¥¢®±µ®¤¨² ±³¬¬ °­®© ³·¥²­®© ±²®¨¬®±²¨).
¢®¨·­»© ±·¥²·¨ª
¥¸¨¬ ² ª¨¬ ¦¥ ±¯®±®¡®¬ § ¤ ·³ ® ¤¢®¨·­®¬ ±·¥²·¨ª¥.  ¬ ­ ¤® ¯°®¢¥±²¨  ¬®°²¨§ ¶¨®­­»©  ­ «¨§ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¨§ n ®¯¥° ¶¨© Increment (¢ ¨±µ®¤­®¬ ±®±²®¿­¨¨ ¢ ±·¥²·¨ª¥ § ¯¨± ­ ­³«¼).
» ³¦¥ ®²¬¥· «¨, ·²® ¢°¥¬¿ ° ¡®²» ½²®© ®¯¥° ¶¨¨ ¯°®¯®°¶¨®­ «¼­® ±³¬¬ °­®¬³ ª®«¨·¥±²¢³ ³±² ­®¢®ª ¨ ®·¨±²®ª ¡¨²®¢. ³¤¥¬
±·¨² ²¼, ·²® ª ¦¤ ¿ ³±² ­®¢ª  ¨«¨ ®·¨±²ª  ±²®¨² 1 ¤®«« °.
±² ­®¢¨¬ ² ª¨¥ ³·¥²­»¥ ±²®¨¬®±²¨: 2 ¤®«« °  §  ³±² ­®¢ª³ ¡¨² , 0 §  ®·¨±²ª³. °¨ ª ¦¤®© ³±² ­®¢ª¥ ¡¨²  ®¤­¨¬ ¨§ ¤¢³µ ¤®«« °®¢ ³·¥²­®© ¶¥­» ¡³¤¥¬ ° ±¯« ·¨¢ ²¼±¿ §  °¥ «¼­»¥ § ²° ²» ­ 
½²³ ³±² ­®¢ª³,   ¤®«« °, ®±² ¾¹¨©±¿ ¢ °¥§¥°¢¥, ¡³¤¥¬ ¯°¨ª°¥¯«¿²¼ ª ³±² ­®¢«¥­­®¬³ ¡¨²³. ®±ª®«¼ª³ ¯¥°¢®­ · «¼­® ¢±¥ ¡¨²»
¡»«¨ ­³«¥¢»¬¨, ¢ ª ¦¤»© ¬®¬¥­² ª ª ¦¤®¬³ ­¥­³«¥¢®¬³ ¡¨²³ ¡³¤¥² ¯°¨ª°¥¯«¥­ °¥§¥°¢­»© ¤®«« °. ² «® ¡»²¼, §  ®·¨±²ª³ «¾¡®£® ¡¨²  ­¨·¥£® ¯« ²¨²¼ ­ ¬ ­¥ ¯°¨¤¥²±¿: ¬» ° ±¯« ²¨¬±¿ §  ­¥¥
¤®«« °®¢®© ¡³¬ ¦ª®©, ¯°¨ª°¥¯«¥­­®© ª ½²®¬³ ¡¨²³ ¢ ¬®¬¥­² ¥£®
³±² ­®¢ª¨.
¥¯¥°¼ «¥£ª® ®¯°¥¤¥«¨²¼ ³·¥²­³¾ ±²®¨¬®±²¼ ®¯¥° ¶¨¨ Increment: ¯®±ª®«¼ª³ ª ¦¤ ¿ ² ª ¿ ®¯¥° ¶¨¿ ²°¥¡³¥² ­¥ ¡®«¥¥ ®¤­®© ³±² ­®¢ª¨ ¡¨² , ¥¥ ³·¥²­³¾ ±²®¨¬®±²¼ ¬®¦­® ±·¨² ²¼ ° ¢­®©
2 ¤®«« ° ¬. «¥¤®¢ ²¥«¼­®, ´ ª²¨·¥±ª ¿ ±²®¨¬®±²¼ n ¯®±«¥¤®¢ ²¥«¼­»µ ®¯¥° ¶¨© Increment, ­ ·¨­ ¾¹¨µ±¿ ± ­³«¿, ¥±²¼ O(n),
¯®±ª®«¼ª³ ®­  ­¥ ¯°¥¢®±µ®¤¨² ±³¬¬» ³·¥²­»µ ±²®¨¬®±²¥©.
¯° ¦­¥­¨¿
18.2-1 °¥¤¯®«®¦¨¬, ·²® ¬» ° ¡®² ¥¬ ±® ±²¥ª®¬, ¬ ª±¨¬ «¼­»©
° §¬¥° ª®²®°®£® ° ¢¥­ k, ¯°¨·¥¬ ¯®±«¥ ª ¦¤»µ k ®¯¥° ¶¨© ¤¥« ¥²±¿ °¥§¥°¢­ ¿ ª®¯¨¿ ±²¥ª . ®ª ¦¨²¥, ·²® ±³¬¬ °­ ¿ ±²®¨¬®±²¼
n ®¯¥° ¶¨© ±® ±²¥ª®¬ (¢ª«¾· ¿ °¥§¥°¢­®¥ ª®¯¨°®¢ ­¨¥) ¥±²¼ O(n),
¢»¡° ¢ ¯®¤µ®¤¿¹¨¥ ³·¥²­»¥ ±²®¨¬®±²¨.
18.2-2
²».

¤¥« ©²¥ ³¯° ¦­¥­¨¥ 18.1-3 ± ¯®¬®¹¼¾ ¬¥²®¤  ¯°¥¤®¯« -

¥²®¤ ¯®²¥­¶¨ «®¢

365

18.2-3 ®¡ ¢¨¬ ª ±¨±²¥¬¥ ®¯¥° ¶¨© ± ¤¢®¨·­»¬ ±·¥²·¨ª®¬ ®¯¥° ¶¨¾ Reset (®·¨±²¨²¼ ¢±¥ ¡¨²»). ¥ «¨§³©²¥ ±·¥²·¨ª ­  ¡ §¥
¢¥ª²®°  ¡¨²®¢ ² ª¨¬ ®¡° §®¬, ·²®¡» ±²®¨¬®±²¼ ¯®±«¥¤®¢ ²¥«¼­®±²¨ n ®¯¥° ¶¨© Increment ¨ Reset, ¯°¨¬¥­¥­­»µ ª ±·¥²·¨ª³, ¢
ª®²®°®¬ ¯¥°¢®­ · «¼­® ­ µ®¤¨«±¿ ­³«¼, ¡»«  ° ¢­  O(n), ¯°¨·¥¬
ª®­±² ­²  ­¥ ¤®«¦­  § ¢¨±¥±²¼ ®² k | ·¨±«  ¡¨²®¢ ¢ ±·¥²·¨ª¥.
(ª § ­¨¥: µ° ­¨²¥ ­®¬¥° ±² °¸¥£® ­¥­³«¥¢®£® ¡¨² ).

18.3. ¥²®¤ ¯®²¥­¶¨ «®¢
¥²®¤ ¯®²¥­¶¨ «®¢ (potential method) ¿¢«¿¥²±¿ ®¡®¡¹¥­¨¥¬ ¬¥²®¤  ¯°¥¤®¯« ²»: §¤¥±¼ °¥§¥°¢ ­¥ ° ±¯°¥¤¥«¿¥²±¿ ¬¥¦¤³ ®²¤¥«¼­»¬¨ ½«¥¬¥­² ¬¨ ±²°³ª²³°» ¤ ­­»µ (­ ¯°¨¬¥°, ®²¤¥«¼­»¬¨ ¡¨² ¬¨
¤¢®¨·­®£® ±·¥²·¨ª ),   ¿¢«¿¥²±¿ ´³­ª¶¨¥© ±®±²®¿­¨¿ ±²°³ª²³°»
¤ ­­»µ ¢ ¶¥«®¬. ²  ´³­ª¶¨¿ ­ §»¢ ¥²±¿ À¯®²¥­¶¨ «¼­®© ½­¥°£¨¥©Á, ¨«¨ À¯®²¥­¶¨ «®¬Á.
¡¹ ¿ ±µ¥¬  ¬¥²®¤  ¯®²¥­¶¨ «®¢ ² ª®¢ . ³±²¼ ­ ¤ ±²°³ª²³°®©
¤ ­­»µ ¯°¥¤±²®¨² ¯°®¨§¢¥±²¨ n ®¯¥° ¶¨©, ¨ ¯³±²¼ Di | ±®±²®¿­¨¥
±²°³ª²³°» ¤ ­­»µ ¯®±«¥ i-© ®¯¥° ¶¨¨ (¢ · ±²­®±²¨, D0 | ¨±µ®¤­®¥
±®±²®¿­¨¥). ®²¥­¶¨ « (potential) ¯°¥¤±² ¢«¿¥² ±®¡®© ´³­ª¶¨¾ 
¨§ ¬­®¦¥±²¢  ¢®§¬®¦­»µ ±®±²®¿­¨© ±²°³ª²³°» ¤ ­­»µ ¢® ¬­®¦¥±²¢® ¤¥©±²¢¨²¥«¼­»µ ·¨±¥«; ½²  ´³­ª¶¨¿ ­ §»¢ ¥²±¿ ¥¹¥ ¯®²¥­¶¨ «¼­®© ´³­ª¶¨¥© (potential function). ³±²¼ ci | °¥ «¼­ ¿ ±²®¨¬®±²¼ i-© ®¯¥° ¶¨¨. ·¥²­®© ±²®¨¬®±²¼¾ (amortized cost) i-© ®¯¥° ¶¨¨ ®¡º¿¢¨¬ ·¨±«®

c = ci + (Di) ; (Di;1);
bi

(18.1)

². ¥. ±³¬¬³ °¥ «¼­®© ±²®¨¬®±²¨ ®¯¥° ¶¨¨ ¯«¾± ¯°¨° ¹¥­¨¥ ¯®²¥­¶¨ «  ¢ °¥§³«¼² ²¥ ¢»¯®«­¥­¨¿ ½²®© ®¯¥° ¶¨¨. ®£¤  ±³¬¬ °­ ¿
³·¥²­ ¿ ±²®¨¬®±²¼ ¢±¥µ ®¯¥° ¶¨© ° ¢­ 
n
X
i=1

c=
bi

n
X
i=1

ci + (Dn) ; (D0):

(18.2)

±«¨ ­ ¬ ³¤ «®±¼ ¯°¨¤³¬ ²¼ ´³­ª¶¨¾ , ¤«¿ ª®²®°®© (Dn ) >
(D0), ²® ±³¬¬ °­ ¿ ³·¥²­ ¿ ±²®¨¬®±²¼ ¤ ±² ¢¥°µ­¾¾ ®¶¥­ª³ ¤«¿
°¥ «¼­®© ±²®¨¬®±²¨ ¯®±«¥¤®¢ ²¥«¼­®±²¨ n ®¯¥° ¶¨©. ¥ ®£° ­¨·¨¢ ¿ ®¡¹­®±²¨, ¬®¦­® ±·¨² ²¼, ·²® (D0) = 0 (±¬. ³¯°. 18.3-1).
®¢®°¿ ­¥´®°¬ «¼­®, ¥±«¨ ° §­®±²¼ ¯®²¥­¶¨ «®¢ (Di) ; (Di;1)
¯®«®¦¨²¥«¼­ , ²® ³·¥²­ ¿ ±²®¨¬®±²¼ i-© ®¯¥° ¶¨¨ ¢ª«¾· ¥² ¢ ±¥¡¿
°¥§¥°¢ (À¯°¥¤®¯« ²³Á §  ¡³¤³¹¨¥ ®¯¥° ¶¨¨); ¥±«¨ ¦¥ ½²  ° §­®±²¼
®²°¨¶ ²¥«¼­ , ²® ³·¥²­ ¿ ±²®¨¬®±²¼ i-© ®¯¥° ¶¨¨ ¬¥­¼¸¥ °¥ «¼­®©, ¨ ° §­¨¶  ¯®ª°»¢ ¥²±¿ §  ±·¥² ­ ª®¯«¥­­®£® ª ½²®¬³ ¬®¬¥­²³
¯®²¥­¶¨ « .

366

« ¢  18 ¬®°²¨§ ¶¨®­­»©  ­ «¨§

·¥²­»¥ ±²®¨¬®±²¨ (¨ ²¥¬ ± ¬»¬ ®¶¥­ª¨ ­  °¥ «¼­³¾ ±²®¨¬®±²¼), ° ±±·¨² ­­»¥ ± ¯®¬®¹¼¾ ¬¥²®¤  ¯®²¥­¶¨ «®¢, § ¢¨±¿² ®²
¢»¡®°  ¯®²¥­¶¨ «¼­®© ´³­ª¶¨¨,   ± ¬ ½²®² ¢»¡®° ¿¢«¿¥²±¿ ¤¥«®¬
²¢®°·¥±ª¨¬.
¯¥° ¶¨¨ ±® ±²¥ª®¬
°®¨««¾±²°¨°³¥¬ ¬¥²®¤ ¯®²¥­¶¨ «®¢ ­  ¯°¨¬¥°¥ §­ ª®¬®© ­ ¬
§ ¤ ·¨ ® ±²¥ª¥ ± ®¯¥° ¶¨¿¬¨ Push, Pop ¨ Multipop.  ª ·¥±²¢¥
¯®²¥­¶¨ «¼­®© ´³­ª¶¨¨  ¢®§¼¬¥¬ ª®«¨·¥±²¢® ½«¥¬¥­²®¢ ¢ ±²¥ª¥.
®±ª®«¼ª³ ¬» ­ ·¨­ ¥¬ ± ¯³±²®£® ±²¥ª , ¨¬¥¥¬
(Di ) > 0 = (D0):
² «® ¡»²¼, ±³¬¬  ³·¥²­»µ ±²®¨¬®±²¥© ®¶¥­¨¢ ¥² ±¢¥°µ³ °¥ «¼­³¾ ±²®¨¬®±²¼ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ®¯¥° ¶¨©.
 ©¤¥¬ ²¥¯¥°¼ ³·¥²­»¥ ±²®¨¬®±²¨ ¨­¤¨¢¨¤³ «¼­»µ ®¯¥° ¶¨©.
 ª ª ª ®¯¥° ¶¨¿ Push ¨¬¥¥² °¥ «¼­³¾ ±²®¨¬®±²¼ 1 ¨ ª ²®¬³ ¦¥
³¢¥«¨·¨¢ ¥² ¯®²¥­¶¨ « ­  1, ¥¥ ³·¥²­ ¿ ±²®¨¬®±²¼ ° ¢­  1 + 1 = 2;
®¯¥° ¶¨¿ Multipop, ³¤ «¿¾¹ ¿ ¨§ ±²¥ª  m ½«¥¬¥­²®¢, ¨¬¥¥² ±²®¨¬®±²¼ m, ­® ³¬¥­¼¸ ¥² ¯®²¥­¶¨ « ­  m, ² ª ·²® ¥¥ ³·¥²­ ¿ ±²®¨¬®±²¼ ° ¢­  m ; m = 0; ²®·­® ² ª ¦¥ ° ¢­  ­³«¾ ¨ ³·¥²­ ¿
±²®¨¬®±²¼ ®¯¥° ¶¨¨ Pop. ®«¼ ±ª®°® ³·¥²­ ¿ ±²®¨¬®±²¼ ª ¦¤®©
®¯¥° ¶¨¨ ­¥ ¯°¥¢®±µ®¤¨² 2, ±²®¨¬®±²¼ ¯®±«¥¤®¢ ²¥«¼­®±²¨ n ®¯¥° ¶¨©, ­ ·¨­ ¾¹¨µ±¿ ± ¯³±²®£® ±²¥ª , ¥±²¼ O(n).
¢®¨·­»© ±·¥²·¨ª
°® ­ «¨§¨°³¥¬ ± ¯®¬®¹¼¾ ¬¥²®¤  ¯®²¥­¶¨ «®¢ ¤¢®¨·­»©
±·¥²·¨ª.  ª ·¥±²¢¥ ¯®²¥­¶¨ «¼­®© ´³­ª¶¨¨ ¢®§¼¬¥¬ ª®«¨·¥±²¢®
¥¤¨­¨¶ ¢ ±·¥²·¨ª¥.
 ©¤¥¬ ³·¥²­³¾ ±²®¨¬®±²¼ ®¯¥° ¶¨¨ Increment. ³±²¼ bi |
ª®«¨·¥±²¢® ¥¤¨­¨¶ ¢ ±·¥²·¨ª¥ ¯®±«¥ i-© ®¯¥° ¶¨¨, ¨ ¯³±²¼ i-¿ ®¯¥° ¶¨¿ Increment ®·¨¹ ¥² ti ¡¨²®¢; ²®£¤  bi 6 bi;1 ; ti + 1 (ª°®¬¥
®·¨±²ª¨ ¡¨²®¢, Increment ¬®¦¥² ¥¹¥ ³±² ­®¢¨²¼ ¢ ¥¤¨­¨¶³ ­¥
¡®«¥¥ ®¤­®£® ¡¨² ). ² «® ¡»²¼, °¥ «¼­ ¿ ±²®¨¬®±²¼ i-£® Increment'  ­¥ ¯°¥¢®±µ®¤¨² ti + 1,   ¥£® ³·¥²­ ¿ ±²®¨¬®±²¼ ¥±²¼

c 6 (ti + 1) + (bi ; bi;1) 6 2:
±«¨ ®²±·¥² ­ ·¨­ ¥²±¿ ± ­³«¿, ²® (D0) = 0, ² ª ·²® (Di) >
(D0) ¤«¿ ¢±¥µ i, ±³¬¬  ³·¥²­»µ ±²®¨¬®±²¥© ®¶¥­¨¢ ¥² ±¢¥°µ³
±³¬¬³ °¥ «¼­»µ ±²®¨¬®±²¥©, ¨ ±³¬¬ °­ ¿ ±²®¨¬®±²¼ n ®¯¥° ¶¨©
Increment ¥±²¼ O(n) ± ª®­±² ­²®© (¤¢®©ª®©), ­¥ § ¢¨±¿¹¥© ®² k
bi

(° §¬¥°  ±·¥²·¨ª ).

¥²®¤ ¯®²¥­¶¨ «®¢

367

¥²®¤ ¯®²¥­¶¨ «®¢ ¯®§¢®«¿¥² ° §®¡° ²¼±¿ ¨ ±® ±«³· ¥¬, ª®£¤ 
®²±·¥² ­ ·¨­ ¥²±¿ ­¥ ± ­³«¿.  ½²®¬ ±«³· ¥ ¨§ (18.2) ¢»²¥ª ¥², ·²®
n
X
i=1

ci =

n
X
i=1

c ; (Dn ) + (D0);
bi

(18.3)

®²ª³¤ , ¯°¨­¨¬ ¿ ¢® ¢­¨¬ ­¨¥, ·²® bci 6 2 ¤«¿ ¢±¥µ i, ¯®«³· ¥¬, ·²®
n
X
i=1

ci 6 2n ; bn + b0:

®±ª®«¼ª³ b0 6 k, ¤«¿ ¤®±² ²®·­® ¤«¨­­»µ ¯®±«¥¤®¢ ²¥«¼­®±²¥©
®¯¥° ¶¨© (n = 
(k) ®¯¥° ¶¨© Increment) °¥ «¼­ ¿ ±²®¨¬®±²¼ ®¶¥­¨¢ ¥²±¿ ª ª O(n), ¯°¨·¥¬ ª®­±² ­²  ¢ O-§ ¯¨±¨ ­¥ § ¢¨±¨² ­¨
®² k, ­¨ ®² ­ · «¼­®£® §­ ·¥­¨¿ ±·¥²·¨ª .
¯° ¦­¥­¨¿
18.3-1 ³±²¼ ¯®²¥­¶¨ «¼­ ¿ ´³­ª¶¨¿  ² ª®¢ , ·²® (Di) >
(D0) ¤«¿ ¢±¥µ i, ­® (D0) 6= 0. ®ª ¦¨²¥, ·²® ±³¹¥±²¢³¥² ¯®²¥­¶¨ «¼­ ¿ ´³­ª¶¨¿ 0, ¤«¿ ª®²®°®© 0(D0) = 0, 0(Di ) > 0 ¤«¿
¢±¥µ i, ¨ ³·¥²­»¥ ±²®¨¬®±²¨, ° ±±·¨² ­­»¥ ± ¯®¬®¹¼¾ ´³­ª¶¨¨ 0,
±®¢¯ ¤ ¾² ± ³·¥²­»¬¨ ±²®¨¬®±²¿¬¨, ° ±±·¨² ­­»¬¨ ± ¯®¬®¹¼¾ .
18.3-2 ¤¥« ©²¥ ³¯° ¦­¥­¨¥ 18-1.3 ± ¯®¬®¹¼¾ ¬¥²®¤  ¯®²¥­¶¨ «®¢.
18.3-3 ³±²¼ ­ ¸  ±²°³ª²³°  ¤ ­­»µ | ¤¢®¨·­ ¿ ª³·  ± ®¯¥° ¶¨¿¬¨ Insert ¨ Extract-Min, ° ¡®² ¾¹¨¬¨ §  ¢°¥¬¿ O(lg n) ¢
µ³¤¸¥¬ ±«³· ¥, £¤¥ n | ª®«¨·¥±²¢® ½«¥¬¥­²®¢. °¨¤³¬ ©²¥ ¯®²¥­¶¨ «¼­³¾ ´³­ª¶¨¾ , ¤«¿ ª®²®°®© ³·¥²­ ¿ ±²®¨¬®±²¼ ®¯¥° ¶¨¨
Insert ¥±²¼ O(lg n), ³·¥²­ ¿ ±²®¨¬®±²¼ ®¯¥° ¶¨¨ Extract-Min
¥±²¼ O(1), ¨ ±³¬¬  ³·¥²­»µ ±²®¨¬®±²¥© ¯®±«¥¤®¢ ²¥«¼­®±²¨ ®¯¥° ¶¨© ®¶¥­¨¢ ¥² ±¢¥°µ³ °¥ «¼­³¾ ±²®¨¬®±²¼ ¯®±«¥¤®¢ ²¥«¼­®±²¨
®¯¥° ¶¨©.
³±²¼ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¨§ n ®¯¥° ¶¨© Push, Pop ¨
Multipop ¯°¨¬¥­¿¥²±¿ ª ±²¥ª³, ±®¤¥°¦ ¹¥¬³ s0 ½«¥¬¥­²®¢, ¨ ¯°¨¢®¤¨² ª ±²¥ª³, ±®¤¥°¦ ¹¥¬³ sn ½«¥¬¥­²®¢.  ª®¢  ±³¬¬ °­ ¿ ´ ª²¨·¥±ª ¿ ±²®¨¬®±²¼ ½²¨µ ®¯¥° ¶¨©?
18.3-5 ³±²¼ ¢ ­ · «¼­®¬ ±®±²®¿­¨¨ ¤¢®¨·­»© ±·¥²·¨ª ±®¤¥°¦¨² b ¥¤¨­¨¶, ¨ ¯³±²¼ n = 
(b). ®ª ¦¨²¥, ·²® ±²®¨¬®±²¼ n ®¯¥° ¶¨© Increment ¥±²¼ O(n) ± ª®­±² ­²®©, ­¥ § ¢¨±¿¹¥© ®² b.
18.3-4

18.3-6  ª °¥ «¨§®¢ ²¼ ®·¥°¥¤¼ ­  ¡ §¥ ¤¢³µ ±²¥ª®¢ (³¯° ¦­¥­¨¥ 11.1-6) ² ª¨¬ ®¡° §®¬, ·²®¡» ³·¥²­ ¿ ±²®¨¬®±²¼ ®¯¥° ¶¨© Enqueue ¨ Dequeue ¡»«  O(1)?

368

« ¢  18 ¬®°²¨§ ¶¨®­­»©  ­ «¨§

18.4. ¨­ ¬¨·¥±ª¨¥ ² ¡«¨¶»
°¨ ° ¡®²¥ ± ² ¡«¨¶¥© ¯¥°¥¬¥­­®£® ° §¬¥°  ¡»¢ ¥² ¦¥« ²¥«¼­®
§ ¯° ¸¨¢ ²¼ ¯ ¬¿²¼ ¡«®ª ¬¨: ª®£¤  ¢ ² ¡«¨¶¥ ­¥² ¬¥±²  ¤«¿ ­®¢®£® ½«¥¬¥­² , ¬» § ¯° ¸¨¢ ¥¬ ¬¥±²® ¤«¿ ² ¡«¨¶» ¡®«¼¸¥£® ° §¬¥°  ¨ ª®¯¨°³¥¬ § ¯¨±¨ ¨§ ±² °®© ² ¡«¨¶» ¢ ­®¢³¾. °¨ ½²®¬ ­®¢»©
° §¬¥° ² ¡«¨¶» ¢»¡¨° ¥²±¿ ± § ¯ ±®¬, ·²®¡» ­¥ ¯°¨¸«®±¼ ­¥¬¥¤«¥­­® ° ±¸¨°¿²¼ ¥¥ ¥¹¥ ° §.  ¯°®²¨¢, ¥±«¨ ¯°¨ ³¤ «¥­¨¨ § ¯¨±¥©
² ¡«¨¶  ±² ­®¢¨²±¿ ¯®·²¨ ¯³±²®©, ²® ¨¬¥¥² ±¬»±« ±ª®¯¨°®¢ ²¼
¥¥ ®±² ²®ª ¢ ² ¡«¨¶³ ¬¥­¼¸¥£® ° §¬¥°  ¨ ®±¢®¡®¤¨²¼ ¯ ¬¿²¼, § ­¿²³¾ ±² °®© ² ¡«¨¶¥©.  ½²®¬ ° §¤¥«¥ ¬» ¯®ª ¦¥¬, ª ª ¬®¦­®
¤¨­ ¬¨·¥±ª¨ ° ±¸¨°¿²¼ ¨ ±¦¨¬ ²¼ ² ¡«¨¶», ¥±«¨ ¬» µ®²¨¬, ·²®¡» ³·¥²­ ¿ ±²®¨¬®±²¼ ®¯¥° ¶¨© ¤®¡ ¢«¥­¨¿ ¨ ³¤ «¥­¨¿ § ¯¨±¥© ª
² ¡«¨¶¥ ¡»«  O(1), (µ®²¿ °¥ «¼­ ¿ ±²®¨¬®±²¼ ¤®¡ ¢«¥­¨© ¨«¨ ³¤ «¥­¨©, ²°¥¡³¾¹¨µ ° ±¸¨°¥­¨¿ ¨«¨ ±¦ ²¨¿ ² ¡«¨¶», ¬®¦¥² ¡»²¼
¢¥«¨ª ). °¨ ½²®¬ ¬» ¡³¤¥¬ ±«¥¤¨²¼, ·²®¡» ª®½´´¨¶¨¥­² § ¯®«­¥­¨¿ ² ¡«¨¶» (®²­®¸¥­¨¥ ·¨±«  ¨±¯®«¼§®¢ ­­»µ ¿·¥¥ª ª ®¡¹¥¬³
° §¬¥°³) ¡»« ­¥ ±«¨¸ª®¬ ¬ «.
³¤¥¬ ±·¨² ²¼, ·²® ¤¨­ ¬¨·¥±ª ¿ ² ¡«¨¶  ¯®¤¤¥°¦¨¢ ¥² ®¯¥° ¶¨¨ Table-Insert (¤®¡ ¢¨²¼ ª ² ¡«¨¶¥) ¨ Table-Delete (³¤ «¨²¼ ¨§ ² ¡«¨¶»). °¨ ¤®¡ ¢«¥­¨¨ § ¯¨±¨ ª ² ¡«¨¶¥ ¬» § ­¨¬ ¥¬ ¢ ² ¡«¨¶¥ ®¤­³ ¿·¥©ª³ (slot), ¯°¨ ³¤ «¥­¨¨ § ¯¨±¨ ®¤­  ¿·¥©ª 
®±¢®¡®¦¤ ¥²±¿.  ª ª®­ª°¥²­® °¥ «¨§®¢ ­» ± ¬  ² ¡«¨¶  ¨ ½²¨
®¯¥° ¶¨¨, ­ ± ¢ ¤ ­­»© ¬®¬¥­² ­¥ ¨­²¥°¥±³¥²: ½²® ¬®¦¥² ¡»²¼
±²¥ª (° §¤¥« 11.1), ª³·  (° §¤¥« 7.1), µ¥¸-² ¡«¨¶  (£« ¢  12), ¨«¨,
­ ª®­¥¶, ¬ ±±¨¢ ¨«¨ ­ ¡®° ¬ ±±¨¢®¢ (° §¤¥« 11.3).
 ª ¬» ³¦¥ £®¢®°¨«¨ (±¬. ² ª¦¥ £« ¢³ 12 ® µ¥¸¨°®¢ ­¨¨), ¬¥­­®, ª®½´´¨¶¨¥­²®¬ § ¯®«­¥­¨¿ (load factor) ² ¡«¨¶» T ­ §®¢¥¬
·¨±«® (T ), ° ¢­®¥ ®²­®¸¥­¨¾ ·¨±«  § ¯®«­¥­­»µ ¿·¥¥ª ª ° §¬¥°³ ² ¡«¨¶» (®¡¹¥¬³ ·¨±«³ ¿·¥¥ª), ¥±«¨ §­ ¬¥­ ²¥«¼ ®²«¨·¥­ ®²
­³«¿. «¿ ¢»°®¦¤¥­­®© ² ¡«¨¶» (­¥ ±®¤¥°¦ ¹¥© ­¨ ®¤­®© ¿·¥©ª¨) ª®½´´¨¶¨¥­² § ¯®«­¥­¨¿ ¬» ±·¨² ¥¬ ° ¢­»¬ ¥¤¨­¨¶¥. ±«¨
®¯°¥¤¥«¥­­»© ² ª¨¬ ®¡° §®¬ ª®½´´¨¶¨¥­² § ¯®«­¥­¨¿ ®£° ­¨·¥­
±­¨§³ ¯®«®¦¨²¥«¼­»¬ ·¨±«®¬, ²® ¤®«¿ ±¢®¡®¤­»µ ¿·¥¥ª ¢ ² ¡«¨¶¥
®£° ­¨·¥­  ±¢¥°µ³ ·¨±«®¬, ¬¥­¼¸¨¬ ¥¤¨­¨¶».
18.4.1.  ±¸¨°¥­¨¥ ² ¡«¨¶»
«¿ ­ · «  ° ±±¬®²°¨¬ ¤¨­ ¬¨·¥±ª³¾ ² ¡«¨¶³, ¢ ª®²®°³¾ ¬®¦­® ¤®¡ ¢«¿²¼ § ¯¨±¨,   ­¥«¼§¿ ³¤ «¿²¼.  ¬¿²¼ ¤«¿ ² ¡«¨¶» ¢»¤¥«¿¥²±¿ ¢ ¢¨¤¥ ¬ ±±¨¢  ¿·¥¥ª.  ¡«¨¶  § ¯®«­¥­ , ª®£¤  ¢ ­¥© ­¥²
±¢®¡®¤­»µ ¿·¥¥ª (¨­»¬¨ ±«®¢ ¬¨, ª®£¤  ª®½´´¨¶¨¥­² § ¯®«­¥­¨¿

¨­ ¬¨·¥±ª¨¥ ² ¡«¨¶»

369

° ¢¥­ 1)1. ³¤¥¬ ±·¨² ²¼, ·²® ­ ¸  ®¯¥° ¶¨®­­ ¿ ±¨±²¥¬ , ª ª ¨
¡®«¼¸¨­±²¢® ±®¢°¥¬¥­­»µ, ±­ ¡¦¥­  ¯®¤±¨±²¥¬®© ³¯° ¢«¥­¨¿ ¯ ¬¿²¼¾, ¯®§¢®«¿¾¹¥© ¯°¨ ­¥®¡µ®¤¨¬®±²¨ ¢»¤¥«¿²¼ ­®¢»¥ ¡«®ª¨ ¯ ¬¿²¨ ¨ ®±¢®¡®¦¤ ²¼ § ­¿²»¥. ¬¥¿ ½²® ¢ ¢¨¤³, ¯°¨ ¯®¯»²ª¥ ¤®¡ ¢¨²¼ § ¯¨±¼ ª § ¯®«­¥­­®© ² ¡«¨¶¥ ¬» ¡³¤¥¬ ¯°¥¤¢ °¨²¥«¼­®
° ±¸¨°¿²¼ (expand) ² ¡«¨¶³ ±«¥¤³¾¹¨¬ ®¡° §®¬: ¢»¤¥«¨¬ ¯ ¬¿²¼
¯®¤ ² ¡«¨¶³ ³¢¥«¨·¥­­®£® ° §¬¥° , ±ª®¯¨°³¥¬ ¨¬¥¾¹¨¥±¿ § ¯¨±¨
¨§ ±² °®© ² ¡«¨¶» ¢ ­®¢³¾, ¯®±«¥ ·¥£® ¤®¡ ¢¨¬ § ¯¨±¼ ³¦¥ ª ­®¢®©
² ¡«¨¶¥.
 ª ¯®ª §»¢ ¥² ®¯»², ° §³¬­® ³¢¥«¨·¨¢ ²¼ ² ¡«¨¶³ ¢¤¢®¥ ¢ ¬®¬¥­² ¯¥°¥¯®«­¥­¨¿. ±«¨ ¬» ²®«¼ª® ¤®¡ ¢«¿¥¬ § ¯¨±¨ ª ² ¡«¨¶¥,
²® ¯°¨ ² ª®© ±²° ²¥£¨¨ ª®½´´¨¶¨¥­² § ¯®«­¥­¨¿ ­¥ ¬®¦¥² ±² ²¼
¬¥­¼¸¥ 1=2 (¥±«¨ ®­ ­¥ ¡»« ² ª¨¬ ¢ ± ¬®¬ ­ · «¥), ². ¥. ¯³±²»¥
¿·¥©ª¨ ­¥ ¡³¤³² § ­¨¬ ²¼ ¡®«¥¥ ¯®«®¢¨­» ² ¡«¨¶».
®² ª ª ¢»£«¿¤¨²  «£®°¨²¬ Table-Insert, ®±­®¢ ­­»© ­  ½²¨µ
¯°¨­¶¨¯ µ (table[T ] {³ª § ²¥«¼ ­  ¡«®ª ¯ ¬¿²¨, ¢ ª®²®°®¬ ° §¬¥¹¥­  ² ¡«¨¶  T , num[T ] | ª®«¨·¥±²¢® § ¯¨±¥© ¢ ² ¡«¨¶¥, size[T ] |
° §¬¥° ² ¡«¨¶», ². ¥. ª®«¨·¥±²¢® ¿·¥¥ª; ¯¥°¢®­ · «¼­® size[T ] =
num[T ] = 0):
Table-Insert (T; x)
1 if size[T ] = 0
2
then ¢»¤¥«¨²¼ ¡«®ª table[T ] ± ®¤­®© ¿·¥©ª®©
3
size[T ] 1
4 if num[T ] = size[T ]
5
then ¢»¤¥«¨²¼ ¡«®ª ¯ ¬¿²¨ new-table ± 2  size[T ] ¿·¥©ª ¬¨
6
±ª®¯¨°®¢ ²¼ ¢±¥ § ¯¨±¨ ¨§ table[T ] ¢ new-table
7
®±¢®¡®¤¨²¼ ¯ ¬¿²¼, § ­¿²³¾ table[T ]
8
table[T ] new-table
9
size[T ] 2  size[T ]
10 § ¯¨± ²¼ x ¢ table[T ]
11 num[T ] num[T ] + 1
°® ­ «¨§¨°³¥¬ ¢°¥¬¿ ° ¡®²» ½²®£®  «£®°¨²¬ . ®¡±²¢¥­­® § ¯¨±¼ ¢ ² ¡«¨¶³ ¯°®¨±µ®¤¨² ¢ ­¥¬ ²®«¼ª® ¢ ±²°®ª µ 6 ¨ 10. ²®¨¬®±²¼ ®¯¥° ¶¨¨ À§ ¯¨± ²¼ ½«¥¬¥­² ¢ ² ¡«¨¶³Á ¯°¨¬¥¬ §  ¥¤¨­¨¶³.
³¤¥¬ ±·¨² ²¼, ·²® ¢°¥¬¿ ° ¡®²» ¢±¥© ¯°®¶¥¤³°» Table-Insert
¯°®¯®°¶¨®­ «¼­® ª®«¨·¥±²¢³ ®¯¥° ¶¨© À§ ¯¨± ²¼ ¢ ² ¡«¨¶³Á; ²¥¬
± ¬»¬ ¬» ¯®¤° §³¬¥¢ ¥¬, ·²® § ²° ²» ­  ¢»¤¥«¥­¨¥ ¯ ¬¿²¨ ¯®¤
² ¡«¨¶³ ± ®¤­®© ¿·¥©ª®© (±²°®ª  2) | ¢¥«¨·¨­  ®£° ­¨·¥­­ ¿, ¨
·²® § ²° ²» ­  ¢»¤¥«¥­¨¥ ¨ ®±¢®¡®¦¤¥­¨¥ ¯ ¬¿²¨ ¢ ±²°®ª µ 5
¨ 7 | ¢¥«¨·¨­  ­¥ ¡®«¼¸¥£® ¯®°¿¤ª , ·¥¬ § ²° ²» ­  ¯¥°¥¯¨±»¢ 1  ­¥ª®²®°»µ ¯°¨«®¦¥­¨¿µ (­ ¯°¨¬¥°, ¢ µ¥¸-² ¡«¨¶ µ ± ®²ª°»²®©  ¤°¥± ¶¨¥©) ° §³¬­® ±·¨² ²¼ ² ¡«¨¶³ § ¯®«­¥­­®© ³¦¥ ¢ ²®² ¬®¬¥­², ª®£¤  ª®½´´¨¶¨¥­²§ ¯®«­¥­¨¿
¯°¥¢»¸ ¥² ­¥ª®²®°³¾ ª®­±² ­²³, ¬¥­¼¸³¾ ¥¤¨­¨¶» (±¬. ³¯°. 18-4.2).

370

« ¢  18 ¬®°²¨§ ¶¨®­­»©  ­ «¨§

­¨¥ ¨§ ®¤­®© ² ¡«¨¶» ¢ ¤°³£³¾ (±²°®ª  6).
³±²¼ ²¥¯¥°¼ ¬» ¯°¨¬¥­¨«¨ n ®¯¥° ¶¨© Table-Insert ª ² ¡«¨¶¥, ­¥ ±®¤¥°¦ ¹¥© ¯¥°¢®­ · «¼­® ­¨ ®¤­®© ¿·¥©ª¨.  ª®¢  ±²®¨¬®±²¼ i-© ®¯¥° ¶¨¨, ¯®±«¥ ª®²®°®© ¢ ² ¡«¨¶¥ ¡³¤¥² i ½«¥¬¥­²®¢?
¡®§­ ·¨¬ ½²³ ±²®¨¬®±²¼ ·¥°¥§ ci . ±«¨ ¢ ² ¡«¨¶¥ ¥±²¼ ¬¥±²® (¨«¨
¥±«¨ i = 1), ²® ci = 1 (¬» § ¯¨±»¢ ¥¬ ­®¢»© ½«¥¬¥­² ¢ ² ¡«¨¶³ ®¤¨­
° § ¢ ±²°®ª¥ 10. ±«¨ ¦¥ ¬¥±²  ¢ ² ¡«¨¶¥ ­¥² ¨ ¤®¡ ¢«¥­¨¥ § ¯¨±¨
ª ² ¡«¨¶¥ ±®¯°®¢®¦¤ ¥²±¿ ° ±¸¨°¥­¨¥¬ ² ¡«¨¶», ²® ci = i: ®¤­ 
¥¤¨­¨¶  ±²®¨¬®±²¨ ¨¤¥² ­  § ¯¨±¼ ­®¢®£® ½«¥¬¥­²  ¢ ° ±¸¨°¥­­³¾
² ¡«¨¶³ (±²°®ª  10), ¨ ¥¹¥ i ; 1 ¥¤¨­¨¶  ¯®©¤¥² ­  ª®¯¨°®¢ ­¨¥
±² °®© ² ¡«¨¶» ¢ ­®¢³¾ (±²°®ª  6). ² «® ¡»²¼, ci 6 n ¯°¨ ¢±¥µ i,
¨ £°³¡ ¿ ®¶¥­ª  ±²®¨¬®±²¨ n ®¯¥° ¶¨© Table-Insert ¥±²¼ O(n2).
®¦­®, ®¤­ ª®, ½²³ ®¶¥­ª³ ³«³·¸¨²¼, ¥±«¨ ¯°®±«¥¤¨²¼, ±ª®«¼ · ±²® ¯°®¨±µ®¤¨² ° ±¸¨°¥­¨¥ ² ¡«¨¶».  ± ¬®¬ ¤¥«¥, ° ±¸¨°¥­¨¥
¯°®¨±µ®¤¨² ²®«¼ª® ¢ ²®¬ ±«³· ¥, ª®£¤  i ; 1 ¿¢«¿¥²±¿ ±²¥¯¥­¼¾
¤¢®©ª¨, ² ª ·²®
n
X
i=1

ci 6 n +

bX
lg nc
j =0

2j < n + 2n = 3n:

² «® ¡»²¼, ±²®¨¬®±²¼ n ®¯¥° ¶¨© Table-Insert ­¥ ¯°¥¢®±µ®¤¨² 3n, ¨ ³·¥²­³¾ ±²®¨¬®±²¼ ª ¦¤®© ² ª®© ®¯¥° ¶¨¨ ¬®¦­® ±·¨² ²¼ ° ¢­®© 3.
®­¿²¼, ®²ª³¤  ¡¥°¥²±¿ ª®½´´¨¶¨¥­² 3, ¬®¦­® ± ¯®¬®¹¼¾ ¬¥²®¤  ¯°¥¤®¯« ²». ¬¥­­®, ¯°¨ ¢»¯®«­¥­¨¨ ª ¦¤®© ®¯¥° ¶¨¨ TableInsert(T; x) ¡³¤¥¬ ¢­®±¨²¼ ¯® 3 ¤®«« ° , ¯°¨ ½²®¬ ®¤¨­ ¤®«« ° ­¥¬¥¤«¥­­® ¨§° ±µ®¤³¥¬ ­  ®¯« ²³ ®¯¥° ¶¨¨ À§ ¯¨± ²¼ x ¢ table[T ]Á ¢
±²°®ª¥ 10, ¥¹¥ ®¤¨­ ¤®«« ° ¯°¨ª°¥¯¨¬ ª ½«¥¬¥­²³ x,   ®±² ¢¸¨©±¿ ®²¤ ¤¨¬ ®¤­®¬³ ¨§ ½«¥¬¥­²®¢, ³¦¥ § ¯¨± ­­»µ ¢ ² ¡«¨¶³ (¨§
²¥µ, ·²® ¥¹¥ ­¥ ¯®«³·¨«¨ ±¢®¥£® ¤®«« ° ) ²¨¬¨ ¤®«« ° ¬¨ ¡³¤¥²
®¯« ·¨¢ ²¼±¿ ¯¥°¥­®± § ¯¨±¥© ¨§ ±² °®© ² ¡«¨¶» ¢ ° ±¸¨°¥­­³¾.
°¨ ½²®¬ ¢±¿ª¨© ° §, ª®£¤  ² ¡«¨¶³ ­¥®¡µ®¤¨¬® ° ±¸¨°¿²¼, ª ¦¤»© ¨§ ¥¥ ½«¥¬¥­²®¢ ¡³¤¥² ¨¬¥²¼ ¯® ¤®«« °³.  ± ¬®¬ ¤¥«¥, ¯³±²¼
¯°¨ ¯°¥¤»¤³¹¥¬ ° ±¸¨°¥­¨¨ ² ¡«¨¶  ¨¬¥«  ° §¬¥° m ¨ ¡»«  ° ±¸¨°¥­  ¤® 2m.  ²¥µ ¯®° ¬» ¤®¡ ¢¨«¨ m ½«¥¬¥­²®¢, ¯°¨ ½²®¬ ¨
¤®¡ ¢«¥­­»¥ ½«¥¬¥­²», ¨ ª ¦¤»© ¨§ m ±² °»µ ½«¥¬¥­²®¢ ¯®«³·¨«¨
¯® ¤®«« °³.  ª¨¬ ®¡° §®¬, ±«¥¤³¾¹¥¥ ° ±¸¨°¥­¨¥ ² ¡«¨¶» ³¦¥
®¯« ·¥­®.
®¦­® ¯°® ­ «¨§¨°®¢ ²¼  «£®°¨²¬ Table-Insert ¨ ± ¯®¬®¹¼¾
¬¥²®¤  ¯®²¥­¶¨ «®¢. ²®¡» ½²® ±¤¥« ²¼, ­ ¤® ¯°¨¤³¬ ²¼ ² ª³¾
¯®²¥­¶¨ «¼­³¾ ´³­ª¶¨¾, ª®²®° ¿ ° ¢­  ­³«¾ ±° §³ ¯®±«¥ ° ±¸¨°¥­¨¿ ² ¡«¨¶» ¨ ­ ° ±² ¥² ¯® ¬¥°¥ ° ±¸¨°¥­¨¿ ² ¡«¨¶» (±² ­®¢¿±¼ ° ¢­®© ° §¬¥°³ ² ¡«¨¶» ¢ ²®² ¬®¬¥­², ª®£¤  ±¢®¡®¤­»µ ¿·¥¥ª
­¥ ®±² ¥²±¿). ²¨¬ ³±«®¢¨¿¬ ³¤®¢«¥²¢®°¿¥², ­ ¯°¨¬¥°, ´³­ª¶¨¿
(T ) = 2  num[T ] ; size[T ]:
(18.4)

¨­ ¬¨·¥±ª¨¥ ² ¡«¨¶»

371

 · «¼­®¥ §­ ·¥­¨¥ ¯®²¥­¶¨ «  ° ¢­® ­³«¾, ¨ ¯®±ª®«¼ª³ ¢ «¾¡®©
¬®¬¥­² ­¥ ¬¥­¥¥ ¯®«®¢¨­» ² ¡«¨¶» § ¯®«­¥­®, §­ ·¥­¨¥ (T ) ¢±¥£¤  ­¥®²°¨¶ ²¥«¼­®. ² «® ¡»²¼, ±³¬¬  ³·¥²­»µ ±²®¨¬®±²¥© ®¯¥° ¶¨© Table-Insert (®¯°¥¤¥«¥­­»µ ¯® ¬¥²®¤³ ¯®²¥­¶¨ «®¢ ª ª
´ ª²¨·¥±ª ¿ ±²®¨¬®±²¼ ¯«¾± ¨§¬¥­¥­¨¥ ¯®²¥­¶¨ « ) ®¶¥­¨¢ ¥²
±¢¥°µ³ ±³¬¬ °­³¾ ´ ª²¨·¥±ª³¾ ±²®¨¬®±²¼.
 ©¤¥¬ ³·¥²­»¥ ±²®¨¬®±²¨. «¿ ½²®£® ®¡®§­ ·¨¬ ·¥°¥§ sizei ,
numi ¨ i ° §¬¥°, ª®«¨·¥±²¢® § ¯¨±¥© ¨ ¯®²¥­¶¨ « ² ¡«¨¶» ¯®±«¥
i-© ®¯¥° ¶¨¨ Table-Insert. ±«¨ ½²  ®¯¥° ¶¨¿ ­¥ ±®¯°®¢®¦¤ « ±¼
° ±¸¨°¥­¨¥¬ ² ¡«¨¶», ²® sizei = sizei;1 , numi = numi;1 +1 ¨ ci = 1,
®²ª³¤ 
ci = ci + i ; i;1 = 3:
b
±«¨ ¦¥ i-¿ ®¯¥° ¶¨¨ Table-Insert ±®¯°®¢®¦¤ « ±¼ ° ±¸¨°¥­¨¥¬
² ¡«¨¶», ²® sizei =2 = sizei;1 = numi;1 ¨ ci = numi , ®²ª³¤  ®¯¿²¼² ª¨

c = ci + i ; i;1 =
= numi + (2numi ; sizei ) ; (2numi;1 ; sizei;1 ) =
= numi + (2numi ; (2numi ; 2)) ; (2(numi ; 1) ; (numi ; 1)) =
= numi + 2 ; (numi ; 1) = 3:
bi

  °¨±. 18.3 ¨§®¡° ¦¥­  § ¢¨±¨¬®±²¼ ¢¥«¨·¨­ numi , sizei ¨ i ®² i.
¡° ²¨²¥ ¢­¨¬ ­¨¥, ª ª ­ ª ¯«¨¢ ¥²±¿ ¯®²¥­¶¨ « ª ¬®¬¥­²³ ° ±¸¨°¥­¨¿ ² ¡«¨¶».
18.4.2.  ±¸¨°¥­¨¥ ¨ ±®ª° ¹¥­¨¥ ² ¡«¨¶»
¥¯¥°¼ § ©¬¥¬±¿ ®¯¥° ¶¨¥© Table-Delete (³¤ «¨²¼ ¨§ ² ¡«¨¶»). ®¬¨¬® ³¤ «¥­¨¿ ­¥­³¦­®© § ¯¨±¨ ¨§ ² ¡«¨¶», ¦¥« ²¥«¼­®
±®ª° ²¨²¼ (contract) ² ¡«¨¶³, ª ª ²®«¼ª® ª®½´´¨¶¨¥­² § ¯®«­¥­¨¿
±² ­¥² ±«¨¸ª®¬ ­¨§®ª. ¡¹ ¿ ±²° ²¥£¨¿ ²³² ²  ¦¥, ·²® ¨ ¯°¨ ° ±¸¨°¥­¨¨ ² ¡«¨¶»: ª ª ²®«¼ª® ·¨±«® § ¯¨±¥© ¯ ¤ ¥² ­¨¦¥ ­¥ª®²®°®£® ¯°¥¤¥« , ¬» ¢»¤¥«¿¥¬ ¯ ¬¿²¼ ¯®¤ ­®¢³¾ ² ¡«¨¶³ ¬¥­¼¸¥£®
° §¬¥° , ª®¯¨°³¥¬ ¢ ¬¥­¼¸³¾ ² ¡«¨¶» ¢±¥ § ¯¨±¨ ¨§ ¡®«¼¸¥©, ¯®±«¥ ·¥£® ¢®§¢° ¹ ¥¬ ®¯¥° ¶¨®­­®© ±¨±²¥¬¥ ¯ ¬¿²¼, § ­¨¬ ¢¸³¾±¿
±² °®© ² ¡«¨¶¥©. » ¯®±²°®¨¬  «£®°¨²¬ Table-Delete ±® ±«¥¤³¾¹¨¬¨ ±¢®©±²¢ ¬¨:
 ª®½´´¨¶¨¥­² § ¯®«­¥­¨¿ ®£° ­¨·¥­ ±­¨§³ ¯®«®¦¨²¥«¼­®© ª®­±² ­²®©,
 ³·¥²­ ¿ ±²®¨¬®±²¼ ®¯¥° ¶¨© Table-Insert ¨ Table-Delete
¥±²¼ O(1).
°¨ ½²®¬ ¬» ¯®-¯°¥¦­¥¬³ ¡³¤¥¬ ±·¨² ²¼, ·²® ±²®¨¬®±²¼  «£®°¨²¬  ®¯°¥¤¥«¿¥²±¿ ª®«¨·¥±²¢®¬ ®¯¥° ¶¨© À§ ¯¨± ²¼ ¢ ² ¡«¨¶³Á
(±²°®ª¨ 6 ¨ 10  «£®°¨²¬  Table-Insert) ¨ ¯°®²¨¢®¯®«®¦­»µ ¥©

372

« ¢  18 ¬®°²¨§ ¶¨®­­»©  ­ «¨§

 §¬¥° ² ¡«¨¶» (sizei ), ·¨±«® § ¯¨±¥© (numi ) ¨ ¯®²¥­¶¨ « (i =
2  numi ; sizei ) ª ª ´³­ª¶¨¿ ®² ·¨±«  ®¯¥° ¶¨© Table-Insert, ®¡®§­ ·¥­­®£® ¡³ª¢®© i. ° ´¨ª num | ±¯«®¸­ ¿ ²®­ª ¿ «¨­¨¿, £° ´¨ª size | ±¯«®¸­ ¿
¦¨°­ ¿ «¨­¨¿, £° ´¨ª  | ¯³­ª²¨°. ¥¯®±°¥¤±²¢¥­­® ¯¥°¥¤ ° ±¸¨°¥­¨¥¬ ² ¡«¨¶»  ¢®§° ±² ¥² ¤® numi , ·²®¡» ®¯« ²¨²¼ ½²® ° ±¸¨°¥­¨¥. ° §³ ¯®±«¥
° ±¸¨°¥­¨¿ ¯®²¥­¶¨ « ¯ ¤ ¥² ¤® ­³«¿, ­® ²³² ¦¥ ¨ ¢®§° ±² ¥² ¤® 2 (§  ±·¥²
¤®¡ ¢«¥­¨¿ § ¯¨±¨ ¯®±«¥ ° ±¸¨°¥­¨¿).
¨±. 18.3

®¯¥° ¶¨© À³¡° ²¼ ¨§ ² ¡«¨¶»Á; ±²®¨¬®±²¼ ª ¦¤®© ¨§ ½²¨µ ½«¥¬¥­² °­»µ ®¯¥° ¶¨© ¯°¨¬¥¬ §  ¥¤¨­¨¶³.
¥°¢®¥, ·²® ¯°¨µ®¤¨² ¢ £®«®¢³, | ³¤¢ ¨¢ ²¼ ° §¬¥° ² ¡«¨¶»
¢±¿ª¨© ° §, ª®£¤  ­ ¤® ¤®¡ ¢¨²¼ § ¯¨±¼ ª § ¯®«­¥­­®© ² ¡«¨¶¥, ¨
±®ª° ¹ ²¼ ° §¬¥° ² ¡«¨¶» ¢¤¢®¥ ¢±¿ª¨© ° §, ª®£¤  ¢ °¥§³«¼² ²¥
³¤ «¥­¨¿ § ¯¨±¨ ª®½´´¨¶¨¥­² § ¯®«­¥­¨¿ ¯ ¤ ¥² ­¨¦¥ 1=2. °¨
² ª®© ±²° ²¥£¨¨ ª®½´´¨¶¨¥­² § ¯®«­¥­¨¿ ­¨ª®£¤  ­¥ ®¯³±²¨²±¿
­¨¦¥ 1=2, ­®, ª ±®¦ «¥­¨¾, ±²®¨¬®±²¨ ®¯¥° ¶¨© ®ª §»¢ ¾²±¿ ±«¨¸ª®¬ ¢¥«¨ª¨.  ± ¬®¬ ¤¥«¥, ¯³±²¼ n | ­ ²³° «¼­®¥ ·¨±«®, ¿¢«¿¾¹¥¥±¿ ±²¥¯¥­¼¾ ¤¢®©ª¨. °¥¤¯®«®¦¨¬, ·²® ±­ · «  ¬» ¤®¡ ¢¨«¨
ª ¯³±²®© (­¥ ±®¤¥°¦ ¹¥© ¿·¥¥ª) ² ¡«¨¶¥ n=2 + 1 § ¯¨±¥©,   § ²¥¬
¯°®¢¥«¨ ¥¹¥ n=2 ; 1 ®¯¥° ¶¨¾ ¢ ² ª®© ¯®±«¥¤®¢ ²¥«¼­®±²¨: ¤¢ 
³¤ «¥­¨¿, § ²¥¬ ¤¢  ¤®¡ ¢«¥­¨¿, § ²¥¬ ®¯¿²¼ ¤¢  ³¤ «¥­¨¿, ®¯¿²¼
¤¢  ¤®¡ ¢«¥­¨¿, ¨ ². ¤. ®±«¥ n=2 + 1 ¤®¡ ¢«¥­¨© ° §¬¥° ² ¡«¨¶»
±² ­¥² ° ¢­»¬ n (¨ § ¯®«­¥­® ¡³¤¥² ·³²¼ ¡®«¼¸¥ ¯®«®¢¨­» ¿·¥¥ª);
¯®±«¥ ¤¢³µ ³¤ «¥­¨© ¥£® ¯°¨¤¥²±¿ ±®ª° ²¨²¼ ¤® n=2; ¯®±«¥ ±«¥¤³¾¹¨µ ¤¢³µ ¤®¡ ¢«¥­¨© ° §¬¥° ®¯¿²¼ ¢®§° ±²¥² ¤® n, ¯®±«¥ ¤¢³µ
³¤ «¥­¨© | ±®ª° ²¨²±¿ ¤® n=2, ¨ ². ¤. ²®¨¬®±²¼ ª ¦¤®£® ±®ª° ¹¥­¨¿ ¨ ° ±¸¨°¥­¨¿ ¥±²¼ (n), ¨ ª®«¨·¥±²¢® ±®ª° ¹¥­¨© ¨ ° ±¸¨°¥­¨© ² ª¦¥ ¥±²¼ (n), ² ª ·²® ±²®¨¬®±²¼ n ®¯¥° ¶¨© ¥±²¼ (n2 ),
  ±°¥¤­¿¿ ±²®¨¬®±²¼ ¢ ° ±·¥²¥ ­  ®¤­³ ®¯¥° ¶¨¾ ®ª §»¢ ¥²±¿ ° ¢­®© (n).
°¨·¨­  ­¥³¤ ·¨ ¯®­¿²­ : ¨±²° ²¨¢ ¢¥±¼ °¥§¥°¢ ­  ®¯« ²³ ° ±¸¨°¥­¨¿ ² ¡«¨¶», ¬» ²³² ¦¥ ¢»­³¦¤¥­» ¥¥ ±®ª° ¹ ²¼, ­¥ ³±¯¥¢

¨­ ¬¨·¥±ª¨¥ ² ¡«¨¶»

373

­ ª®¯¨²¼ ±°¥¤±²¢  ­  ®¯« ²³ ¡³¤³¹¥£® ±®ª° ¹¥­¨¿.   ¦¥ ¨±²®°¨¿ ¨ ± ° ±¸¨°¥­¨¥¬ ² ¡«¨¶»: ¬» ¢»­³¦¤¥­» ¯°¥¤¯°¨­¨¬ ²¼ ¥£®
±° §³ ¯®±«¥ ±®ª° ¹¥­¨¿, ­¥ ³±¯¥¢ ­ ª®¯¨²¼ ±°¥¤±²¢  §  ±·¥² ¤®¡ ¢«¥­¨¿ § ¯¨±¥© ¢ ² ¡«¨¶³ ¯®±²®¿­­®£® ° §¬¥° .
¥«  ¯®©¤³² «³·¸¥, ¥±«¨ ¬» ° §°¥¸¨¬ ª®½´´¨¶¨¥­²³ § ¯®«­¥­¨¿ ®¯³±ª ²¼±¿ ­¨¦¥ 1=2 [¢¢¥¤¿ £¨±²¥°¥§¨± ¢ ­ ¸  «£®°¨²¬, ª ª
±ª § «¨ ¡» ´¨§¨ª¨]. ¬¥­­®, ¬» ¯®-¯°¥¦­¥¬³ ³¤¢ ¨¢ ¥¬ ° §¬¥°
² ¡«¨¶» ¯°¨ ¯®¯»²ª¥ ¤®¡ ¢¨²¼ § ¯¨±¼ ª § ¯®«­¥­­®© ² ¡«¨¶¥,  
¢®² ±®ª° ¹¥­¨¥ ² ¡«¨¶» ¢¤¢®¥ ¬» ¯°¥¤¯°¨­¨¬ ¥¬ ²®«¼ª® ²®£¤ ,
ª®£¤  ª®½´´¨¶¨¥­² § ¯®«­¥­¨¿ ¯ ¤ ¥² ­¨¦¥ 1=4.  ª¨¬ ®¡° §®¬,
ª®½´´¨¶¨¥­² § ¯®«­¥­¨¿ ¢±¥£¤  ¡³¤¥² ¡®«¼¸¥ ¨«¨ ° ¢¥­ 1=4. °³£¨¬¨ ±«®¢ ¬¨, ¬» ±·¨² ¥¬ 50% ®¯²¨¬ «¼­»¬ ª®½´´¨¶¨¥­²®¬ § ¯®«­¥­¨¿ ² ¡«¨¶», ¨ ¢®§¢° ¹ ¥¬±¿ ª ² ª®© ±¨²³ ¶¨¨, ª ª ²®«¼ª®
ª®½´´¨¶¨¥­² § ¯®«­¥­¨¿ ®²ª«®­¨²±¿ ®² ®¯²¨¬ «¼­®£® ¢ ¤¢  ° § 
(¢ «¾¡³¾ ±²®°®­³).
» ­¥ ¡³¤¥¬ ¢»¯¨±»¢ ²¼ ¯±¥¢¤®ª®¤ ¤«¿  «£®°¨²¬  TableDelete | ®­  ­ «®£¨·¥­ ª®¤³ ¤«¿ Table-Insert. ²¬¥²¨¬ ²®«¼ª®,
·²® ¯°¨ ³¤ «¥­¨¨ ¨§ ² ¡«¨¶» ¯®±«¥¤­¥© § ¯¨±¨ ° §³¬­® ¯®«­®±²¼¾
®±¢®¡®¦¤ ²¼ ¯ ¬¿²¼, § ­¨¬ ¥¬³¾ ¿·¥©ª ¬¨ ² ¡«¨¶». ¨¦¥ ¬» ¡³¤¥¬ ±·¨² ²¼, ·²® ¢  «£®°¨²¬¥ Table-Delete ½²® ¯°¥¤³±¬®²°¥­®,
¨­»¬¨ ±«®¢ ¬¨, ·²® size[T ] = 0, ª ª ²®«¼ª® num[T ] = 0.
«¿ ®¶¥­ª¨ ±²®¨¬®±²¨ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¨§ n ®¯¥° ¶¨© TableInsert ¨ Table-Delete, ¯°¨¬¥­¥­­»µ ª ¯³±²®© ² ¡«¨¶¥, ¬» ¢®±¯®«¼§³¥¬±¿ ¬¥²®¤®¬ ¯®²¥­¶¨ «®¢. ®²¥­¶¨ «¼­ ¿ ´³­ª¶¨¿ ¡³¤¥²
° ¢­  ­³«¾, ª®£¤  ª®½´´¨¶¨¥­² § ¯®«­¥­¨¿ ®¯²¨¬ «¥­ (° ¢¥­ 1=2)
| ² ª ¡³¤¥² ±° §³ ¯®±«¥ ±®ª° ¹¥­¨¿ ¨«¨ ° ±¸¨°¥­¨¿. ®²¥­¶¨ «
¢®§° ±² ¥² ¯® ¬¥°¥ ²®£®, ª ª ª®½´´¨¶¨¥­² § ¯®«­¥­¨¿ ¯°¨¡«¨¦ ¥²±¿ ª 1 ¨«¨ 1=4.  ¯®¬­¨¬, ·²® ª®½´´¨¶¨¥­² § ¯®«­¥­¨¿ (T )
° ¢¥­ num[T ]=size[T ], ¥±«¨ size[T ] 6= 0, ¨ ° ¢¥­ 1, ¥±«¨ size[T ] (¨ ²¥¬
± ¬»¬ num[T ]) ° ¢­® ­³«¾.  ¸¨¬ ²°¥¡®¢ ­¨¿¬ ³¤®¢«¥²¢®°¿¥² ² ª ¿ ¯®²¥­¶¨ «¼­ ¿ ´³­ª¶¨¿:
(T ) =

(

2  num[T ] ; size[T ]; ¥±«¨ [T ] 6 1=2;
size[T ]=2 ; num[T ]; ¥±«¨ [T ] > 1=2:

(18.5)

 ¬¥²¨¬, ·²® (T ) = 0 ¯°¨ (T ) = 1=2 (¯® «¾¡®© ¨§ ¤¢³µ ´®°¬³«),
·²® ¯®²¥­¶¨ « ¯³±²®© ² ¡«¨¶» ° ¢¥­ ­³«¾ ¨ ·²® ¯®²¥­¶¨ « ¢±¥£¤ 
­¥®²°¨¶ ²¥«¥­. ±«¨ ª®½´´¨¶¨¥­² § ¯®«­¥­¨¿ ° ¢¥­ 1 ¨«¨ 1=4, ²®
[T ] = num[T ], ² ª ·²® ­ ª®¯«¥­­®£® ¯®²¥­¶¨ «  ¤®±² ²®·­® ¤«¿
®¯« ²» ° ±¸¨°¥­¨¿ ¨«¨ ±®ª° ¹¥­¨¿ ² ¡«¨¶».   °¨±. 18.4 ¨§®¡° ¦¥­®, ª ª ¬¥­¿¥²±¿ ¯®²¥­¶¨ « ¢ ¯°®¶¥±±¥ ¢»¯®«­¥­¨¿ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ®¯¥° ¶¨© Table-Insert ¨ Table-Delete.
 ©¤¥¬ ³·¥²­»¥ ±²®¨¬®±²¨ ®¯¥° ¶¨© ¯°¨ ² ª®¬ ¯®²¥­¶¨ «¥ .
±«¨ ®¯¥° ¶¨¿ Table-Insert ¨«¨ Table-Delete ­¥ ±®¯°®¢®¦¤ ¥²±¿ ° ±¸¨°¥­¨¥¬ ¨«¨ ±®ª° ¹¥­¨¥¬ ² ¡«¨¶», ²® ¨§¬¥­¥­¨¥ ¯®²¥­¶¨ «  ­¥ ¯°¥¢®±µ®¤¨² 2 (size ­¥ ¬¥­¿¥²±¿, num ¬¥­¿¥²±¿ ­  1), ² ª

374

« ¢  18 ¬®°²¨§ ¶¨®­­»©  ­ «¨§

 §¬¥° ² ¡«¨¶»
( (sizei ), ·¨±«® § ¯¨±¥© (numi ) ¨ ¯®²¥­¶¨ «
i = 2  numi ; sizei ; ¥±«¨ i > 1=2;
sizei =2 ; numi ; ¥±«¨ i < 1=2;
ª ª ´³­ª¶¨¿ ®² ·¨±«  ®¯¥° ¶¨© Table-Insert ¨ Table-Delete, ®¡®§­ ·¥­­®£® ¡³ª¢®© i. ° ´¨ª num | ±¯«®¸­ ¿ ²®­ª ¿ «¨­¨¿, £° ´¨ª size | ±¯«®¸­ ¿
¦¨°­ ¿ «¨­¨¿, £° ´¨ª  | ¯³­ª²¨°. ¥¯®±°¥¤±²¢¥­­® ¯¥°¥¤ ° ±¸¨°¥­¨¥¬ ¨«¨
±®ª° ¹¥­¨¥¬ ² ¡«¨¶» ¯®²¥­¶¨ « ° ¢¥­ ª®«¨·¥±²¢³ § ¯¨±¥©.
¨±. 18.4

·²® ³·¥²­ ¿ ±²®¨¬®±²¼ ­¥ ¯°¥¢®±µ®¤¨² 3.  ±«³· ¥ ° ±¸¨°¥­¨¿ ¨«¨
±¦ ²¨¿ ² ¡«¨¶» ³·¥²­ ¿ ±²®¨¬®±²¼ ®ª §»¢ ¥²±¿ ° ¢­®© 1, ² ª ª ª
¨§¬¥­¥­¨¿ ¢ ¯®²¥­¶¨ «¥ ª®¬¯¥­±¨°³¾² § ²° ²» ­  ª®¯¨°®¢ ­¨¥.
 ®¡¹¥¬ ¨ ¶¥«®¬, ³·¥²­ ¿ ±²®¨¬®±²¼ ª ¦¤®© ¨§ ®¯¥° ¶¨©
¥±²¼ O(1), ² ª ·²® ´ ª²¨·¥±ª ¿ ±²®¨¬®±²¼ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¨§
n ®¯¥° ¶¨© ¥±²¼ O(n).
¯° ¦­¥­¨¿
18.4-1 ¡º¿±­¨²¥, ¯®·¥¬³ ¤«¿ ±«³· ¿ i;1 < i 6 1=2 ³·¥²­ ¿
±²®¨¬®±²¼ ®¯¥° ¶¨¨ Table-Insert ° ¢­  ­³«¾.
18.4-2 ®·¥¬³ ¤¨­ ¬¨·¥±ª³¾ µ¥¸-² ¡«¨¶³ ± ®²ª°»²®©  ¤°¥± ¶¨¥© ° §³¬­® ±·¨² ²¼ § ¯®«­¥­­®© (¨ ° ±¸¨°¿²¼) ¥¹¥ ¤® ²®£®, ª ª
ª®½´´¨¶¨¥­² § ¯®«­¥­¨¿ ±² ­¥² ° ¢­»¬ ¥¤¨­¨¶¥?  ª § ¯°®£° ¬¬¨°®¢ ²¼ ¤®¡ ¢«¥­¨¥ § ¯¨±¨ ¢ ² ª³¾ ² ¡«¨¶³, ·²®¡» ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ³·¥²­®© ±²®¨¬®±²¨ ¤®¡ ¢«¥­¨¿ ¡»«  O(1)? ®·¥¬³ ­¥«¼§¿ £ ° ­²¨°®¢ ²¼, ·²® ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ °¥ «¼­®©
±²®¨¬®±²¨ ª ¦¤®£® ¤®¡ ¢«¥­¨¿ ¡³¤¥² O(1)?
18.4-3 ®ª ¦¨²¥, ·²® ³·¥²­ ¿ ±²®¨¬®±²¼ (®²­®±¨²¥«¼­® ¯®²¥­¶¨ «  (18.5)) ®¯¥° ¶¨¨ Table-Delete, ¯°¨¬¥­¥­­®© ª ¤¨­ ¬¨·¥±ª®© ² ¡«¨¶¥ ± ª®½´´¨¶¨¥­²®¬ § ¯®«­¥­¨¿ > 1=2, ­¥ ¯°¥¢®±µ®¤¨²
­¥ª®²®°®© ª®­±² ­²».

 ¤ ·¨ ª £« ¢¥ 18

375

18.4-4  ±±¬®²°¨¬ ² ª³¾ °¥ «¨§ ¶¨¾ ®¯¥° ¶¨¨ Table-Delete:
¥±«¨ ¢ °¥§³«¼² ²¥ ³¤ «¥­¨¿ ½«¥¬¥­²  ª®½´´¨¶¨¥­² § ¯®«­¥­¨¿ ¯ ¤ ¥² ­¨¦¥ 1=3, ²® ¬» ±®ª° ¹ ¥¬ ² ¡«¨¶³ ­  ²°¥²¼ ¥¥ ° §¬¥° .
®«¼§³¿±¼ ¯®²¥­¶¨ «®¬
(T ) = j2  num[T ] ; size[T ]j;
¯®ª ¦¨²¥, ·²® ¯°¨ ½²®¬ ³·¥²­ ¿ ±²®¨¬®±²¼ ®¯¥° ¶¨¨ TableDelete ®£° ­¨·¥­ .

 ¤ ·¨
18-1 ¢®¨·­»© ±·¥²·¨ª ± ®¡° ²­»¬ ¯®°¿¤ª®¬ ¡¨²®¢
 £« ¢¥ 32 ¬» ° ±±ª ¦¥¬ ® ¢ ¦­®¬  «£®°¨²¬¥, ­ §»¢ ¥¬®¬ ¡»±²°»¬ ¯°¥®¡° §®¢ ­¨¥¬ ³°¼¥. ²®²  «£®°¨²¬ ­ ·¨­ ¥²±¿ ± ®¡° ¹¥­¨¿ ¡¨²®¢ ¨­¤¥ª±  (bit-reversal permutation) ³ ¬ ±±¨¢  A[0 : :n ;
1], £¤¥ n = 2k (k | ­ ²³° «¼­®¥ ·¨±«®). ¬¥­­®, ª ¦¤®¥ A[a] § ¬¥­¿¥²±¿ ­  A[revk (a)], £¤¥ revk (a) ¯®«³· ¥²±¿, ¥±«¨ ¯°¥¤±² ¢¨²¼
·¨±«® a ¢ ¢¨¤¥ ¯®±«¥¤®¢ ²¥«¼­®±²¨ k ¡¨²®¢,   § ²¥¬ P
­ ¯¨± ²¼ ½²¨
;1 a 2i , ²®
¡¨²» ¢ ®¡° ²­®¬ ¯®°¿¤ª¥. ­»¬¨ ±«®¢ ¬¨, ¥±«¨ a = ki=0
i
revk (a) =

k;1
X
i=0

ak;i;1 2i:

°¨¬¥°: rev4 (3) = 12, ¯®±ª®«¼ª³ 3 ¢ ¤¢®¨·­®© § ¯¨±¨ ¥±²¼ 0011,  
1100 | ¤¢®¨·­ ¿ § ¯¨±¼ ·¨±«  12.
 . ¥£ª® ¢»·¨±«¨²¼ revk (a) §  ¢°¥¬¿ (k).  ª ¯°®¨§¢¥±²¨ ®¯¥° ¶¨¾ ®¡° ¹¥­¨¿ ¡¨²®¢ ¨­¤¥ª±  ¢ ¬ ±±¨¢¥ ¤«¨­®© n = 2k § 
¢°¥¬¿ O(nk)?
²®¡» ¢»¯®«­¿²¼ ®¡° ¹¥­¨¥ ¡¨²®¢ ¨­¤¥ª±  ¡»±²°¥¥, ¬®¦­® ¯°¨¬¥­¨²¼  ¬®°²¨§ ¶¨®­­»©  ­ «¨§ ª ¯°®¶¥¤³°¥ ¯°¨¡ ¢«¥­¨¿ ¥¤¨­¨¶» ­ ®¡®°®², ª®²®° ¿ ¤ ¥² revk (a +1) ¯® ¤ ­­®¬³ revk (a). »¤¥«¨¬
¬ ±±¨¢ ¡¨²®¢ ¤«¨­®© k ¤«¿ µ° ­¥­¨¿ ±·¥²·¨ª  ± ®¡° ¹¥­­»¬ ¯®°¿¤ª®¬ ¡¨²®¢.  ¬ ­³¦­® ° §° ¡®² ²¼ ¯°®¶¥¤³°³ Bit-ReversedIncrement, ¯¥°¥¢®¤¿¹³¾ revk (a) ¢ revk (a) + 1. ±«¨, ­ ¯°¨¬¥°,
k = 4 ¨ ¯¥°¢®­ · «¼­® ¢ ±·¥²·¨ª¥ ± ®¡° ¹¥­­»¬ ¯®°¿¤ª®¬ ¡¨²®¢ ¡»«® § ¯¨± ­® 0000, ²® ¢ °¥§³«¼² ²¥ ¯®±«¥¤®¢ ²¥«¼­»µ ¢»§®¢®¢ ¯°®¶¥¤³°» Bit-Reversed-Increment §­ ·¥­¨¿ ±·¥²·¨ª  ¡³¤³² ° ¢­»
0000; 1000; 0100; 1100; 0010; 1010; : : : = 0; 8; 4; 12; 2; 10; : : : :
¡. ³±²¼ ª®¬¯¼¾²¥° ³¬¥¥² §  ¥¤¨­¨·­®¥ ¢°¥¬¿ ¯°®¢®¤¨²¼ ± k¡¨²­»¬¨ ±«®¢ ¬¨ ² ª¨¥ ®¯¥° ¶¨¨, ª ª ±¤¢¨£ ­  ¯°®¨§¢®«¼­®¥

376

« ¢  18 ¬®°²¨§ ¶¨®­­»©  ­ «¨§

ª®«¨·¥±²¢® ¡¨²®¢, «®£¨·¥±ª¨¥  ¨  ¨ ². ¤.  ª ­³¦­® °¥ «¨§®¢ ²¼ ¯°®¶¥¤³°³ Bit-Reversed-Increment, ·²®¡» ®¡° ¹¥­¨¥
¡¨²®¢ ¨­¤¥ª±  ³ ¬ ±±¨¢  ¤«¨­®© n = 2k § ­¨¬ «® O(n) ¢°¥¬¥­¨?
¢. ³±²¼ §  ¥¤¨­¨·­®¥ ¢°¥¬¿ k-¡¨²­®¥ ±«®¢® ¬®¦­® ±¤¢¨­³²¼ «¨¸¼
­  ®¤¨­ ¡¨². ®¦­® «¨ ¢ ½²®¬ ±«³· ¥ ¯°®¢¥±²¨ ®¡° ¹¥­¨¥ ¡¨²®¢
¨­¤¥ª±  §  ¢°¥¬¿ O(n)?
18-2 ¨­ ¬¨·¥±ª¨© ¤¢®¨·­»© ¯®¨±ª
²®¡» ±®ª° ²¨²¼ ¢°¥¬¿ ­  ¤®¡ ¢«¥­¨¥ ½«¥¬¥­²  ª ®²±®°²¨°®¢ ­­®¬³ ¬ ±±¨¢³, ¬®¦­® ¯®±²³¯¨²¼ ² ª.  ±¯°¥¤¥«¨¬ ½«¥¬¥­²»
®²±®°²¨°®¢ ­­®£® ¬ ±±¨¢  ¤«¨­» n ¯® k = dlog2 ne ¬ ±±¨¢ ¬
A0; A1; : : :; Ak ±«¥¤³¾¹¨¬ ®¡° §®¬: ¥±«¨ hnPk;1 ; nk;2 ; : : :; n0i | ¤¢®;1 n 2i ), ²® ¬ ±±¨¢ A
·¥­¼ ¯³- ¨·­®¥ ¯°¥¤±² ¢«¥­¨¥ ·¨±«  n (². ¥. n = ki=0
i
i
² ­®!
¯³±², ¥±«¨ ni = 0, ¨ ±®¤¥°¦¨² 2i ½«¥¬¥­²®¢, ¥±«¨ ni = 1; ¢ ½²®¬
¯®±«¥¤­¥¬ ±«³· ¥ ¬ ±±¨¢ Ai ®²±®°²¨°®¢ ­.   ° ±¯°¥¤¥«¥­¨¥ n ½«¥¬¥­²®¢ ¯® ¬ ±±¨¢ ¬ A0 ; : : :; An ­¨ª ª¨µ ³±«®¢¨© ­¥ ­ ª« ¤»¢ ¥²±¿.
 . ¥ «¨§³©²¥ ¤«¿ ½²®© ±²°³ª²³°» ¤ ­­»µ ®¯¥° ¶¨¾ Search (¨±ª ²¼).  ª®¢® ¥¥ ¢°¥¬¿ ° ¡®²» ¢ µ³¤¸¥¬ ±«³· ¥?
¡. ¥ «¨§³©²¥ ®¯¥° ¶¨¾ Insert (¤®¡ ¢¨²¼ ½«¥¬¥­²). ¶¥­¨²¥ ¥¥
±²®¨¬®±²¼ ¢ µ³¤¸¥¬ ±«³· ¥ ¨ ³·¥²­³¾ ±²®¨¬®±²¼ (¥±«¨ ¢®§¬®¦­» ²®«¼ª® ¤®¡ ¢«¥­¨¿, ­® ­¥ ³¤ «¥­¨¿).
¢.  ª °¥ «¨§®¢ ²¼ ®¯¥° ¶¨¾ Delete (³¤ «¨²¼)?
18-3 ¡ « ­±¨°®¢ ­­»¥ ¯® ¢¥±³ ¤¥°¥¢¼¿
³±²¼ x | ³§¥« ¤¢®¨·­®£® ¤¥°¥¢ ; ·¥°¥§ size[x] ®¡®§­ ·¨¬ ·¨±«® «¨±²¼¥¢ ¢ ¯®¤¤¥°¥¢¥ ± ¢¥°¸¨­®© ¢ x. ³±²¼ ·¨±«®  ³¤®¢«¥²¢®°¿¥² ­¥° ¢¥­±²¢³ 1=2 6  < 1. ³¤¥¬ £®¢®°¨²¼, ·²® ³§¥« x
-±¡ « ­±¨°®¢ ­ (-balanced), ¥±«¨
size[left[x]] 6   size[x]

¨

size[right[x]] 6   size[x]:
¢®¨·­®¥ ¤¥°¥¢® ­ §»¢ ¥²±¿ -±¡ « ­±¨°®¢ ­­»¬, ¥±«¨ ¢±¥ ¥£® ³§«», ª°®¬¥ «¨±²¼¥¢, -±¡ « ­±¨°®¢ ­». ®¤µ®¤ ª ±¡ « ­±¨°®¢ ­­»¬
¤¥°¥¢¼¿¬, ® ª®²®°®¬ ¨¤¥² °¥·¼ ­¨¦¥, ¡»« ¯°¥¤«®¦¥­ .  °£¥§¥
(G. Varghese).
 . ³±²¼ x | ³§¥« ¤¢®¨·­®£® ¤¥°¥¢  ¯®¨±ª . ¡º¿±­¨²¥, ª ª
¯¥°¥±²°®¨²¼ ¯®¤¤¥°¥¢® ± ª®°­¥¬ ¢ x, ·²®¡» ®­® ±² «® 1=2±¡ « ­±¨°®¢ ­­»¬ (± ¬®¥ ±¨«¼­®¥ ²°¥¡®¢ ­¨¥ ±¡ « ­±¨°®¢ ­­®±²¨)  ¸  «£®°¨²¬ ¤®«¦¥­ ° ¡®² ²¼ §  ¢°¥¬¿ (size[x]) ¨
¯®«¼§®¢ ²¼±¿ ¤®¯®«­¨²¥«¼­®© ¯ ¬¿²¼¾ ®¡º¥¬  O(size[x]).
¡. ®ª ¦¨²¥, ·²® ¯®¨±ª ¢ -±¡ « ­±¨°®¢ ­­®¬ ¤¢®¨·­®¬ ¤¥°¥¢¥ ±
n ³§« ¬¨ ²°¥¡³¥² ¢ µ³¤¸¥¬ ±«³· ¥ ¢°¥¬¥­¨ O(log n).

 ¬¥· ­¨¿ ª £« ¢¥ 18

377

 «¥¥ ¡³¤¥¬ ±·¨² ²¼, ·²®  > 1=2. ³¤¥¬ ±·¨² ²¼, ·²® ¯®±«¥ ¢»¯®«­¥­¨¿ ®¯¥° ¶¨© Insert ¨ Delete (°¥ «¨§®¢ ­­»µ ±² ­¤ °²­»¬
®¡° §®¬), ¯°®¨§¢®¤¨²±¿ ¡ « ­±¨°®¢ª : ¥±«¨ ª ª®©-²® ³§¥« ¤¥°¥¢ 
¯¥°¥±² « ¡»²¼ -±¡ « ­±¨°®¢ ­­»¬, ¢»¡¨° ¥²±¿ ¡«¨¦ ©¸¨© ª ª®°­¾ ¨§ ² ª¨µ ³§«®¢ ¨ ±®®²¢¥²±²¢³¾¹¥¥ ¯®¤¤¥°¥¢® ¯¥°¥±²° ¨¢ ¥²±¿
¢ 1=2-±¡ « ­±¨°®¢ ­­®¥ (±¬. ¯³­ª²  ).
°® ­ «¨§¨°³¥¬ ½²³ ±µ¥¬³ ¡ « ­±¨°®¢ª¨ ± ¯®¬®¹¼¾ ¬¥²®¤  ¯®²¥­¶¨ «®¢.  ª ®¡»·­®, ¯®²¥­¶¨ « ¡³¤¥² ²¥¬ ¡®«¼¸¥, ·¥¬ ¤ «¼¸¥
¤¥°¥¢® ®² ±¡ « ­±¨°®¢ ­­®£®. ³±²¼ x | ³§¥« ¢ ¤¢®¨·­®¬ ¤¥°¥¢¥ T ;
¯®«®¦¨¬
(x) = jsize[left[x]] ; size[right[x]j
¨ ®¯°¥¤¥«¨¬ ¯®²¥­¶¨ « (T ) ¯® ´®°¬³«¥
(T ) = c

X

(x);

x2T :(x)>2

£¤¥ c | ¤®±² ²®·­® ¡®«¼¸ ¿ ¯®«®¦¨²¥«¼­ ¿ ª®­±² ­² , § ¢¨±¿¹ ¿
®² .
¢. ®ª ¦¨²¥, ·²® ¯®²¥­¶¨ « ¤¢®¨·­®£® ¤¥°¥¢  ¢±¥£¤  ­¥®²°¨¶ ²¥«¥­ ¨ ·²® ¯®²¥­¶¨ « 1=2-±¡ « ­±¨°®¢ ­­®£® ¤¥°¥¢  ° ¢¥­ ­³«¾.
£. ³¤¥¬ ±·¨² ²¼, ·²® ±²®¨¬®±²¼ ¯¥°¥±²°®©ª¨ ¤¥°¥¢  ± m ¢¥°¸¨­ ¬¨ ¢ 1=2-±¡ « ­±¨°®¢ ­­®¥ ° ¢­  m (­ ¯®¬­¨¬, ·²® ·¨±«®
®¯¥° ¶¨© ¥±²¼ O(m)).  ª®¢  ¤®«¦­  ¡»²¼ ¢¥«¨·¨­  c ¤«¿ ¤ ­­®£® , ·²®¡» ³·¥²­ ¿ ±²®¨¬®±²¼ ¯¥°¥±²°®©ª¨ ¯®¤¤¥°¥¢ , ­¥
¿¢«¿¾¹¥£®±¿ -±¡ « ­±¨°®¢ ­­»¬, ¡»«  O(1)?
¤. ®ª ¦¨²¥, ·²® ³·¥²­ ¿ ±²®¨¬®±²¼ ³¤ «¥­¨¿ ¨«¨ ¢±² ¢ª¨ ½«¥¬¥­²  ¢ -±¡ « ­±¨°®¢ ­­®¥ ¤¥°¥¢® ± n ¢¥°¸¨­ ¬¨ ¥±²¼ O(log n).

 ¬¥· ­¨¿
¥²®¤ £°³¯¯¨°®¢ª¨ ¢  ¬®°²¨§ ¶¨®­­®¬  ­ «¨§¥ ®¯¨± ­ ³ µ®,
®¯ª°®´²  ¨ «¼¬ ­  [4].  °¼¿­ [189] ° ±±¬ ²°¨¢ ¥² ¬¥²®¤» ¯°¥¤®¯« ²» ¨ ¯®²¥­¶¨ «®¢ ¨ ¯°¨¢®¤¨² ­¥ª®²®°»¥ ¯°¨«®¦¥­¨¿. ®£« ±­®  °¼¿­³, ¬¥²®¤ ¯°¥¤®¯« ²» ¢®±µ®¤¨² ª ° ¡®² ¬ ¬­®£¨µ  ¢²®°®¢, ¢ ²®¬ ·¨±«¥ ° ³­  (M. R. Brown),  °¼¿­  (R. E. Tarjan),
 ¤«±²®­  (S. Huddleston) ¨ ¥«¼µ®°­  (K. Mehlhorn), ¢ ²® ¢°¥¬¿
ª ª ¬¥²®¤ ¯®²¥­¶¨ «®¢ ¨§®¡°¥²¥­ «¥ ²®°®¬ (D. D. Sleator). ¥°¬¨­ À ¬®°²¨§ ¶¨®­­»©  ­ «¨§Á ¢¢¥¤¥­ «¥ ²®°®¬ ¨  °¼¿­®¬.

V

®«¥¥ ±«®¦­»¥ ±²°³ª²³°» ¤ ­­»µ

¢¥¤¥­¨¥
 ª ¨ ¢ · ±²¨ III, ¢ ½²®© · ±²¨ ¬» ° ±±¬®²°¨¬ ±²°³ª²³°» ¤ ­­»µ, ª®²®°»¥ µ° ­¿² ¨§¬¥­¿¾¹¨¥±¿ ¬­®¦¥±²¢  | ­® ¨µ  ­ «¨§
¡³¤¥² ­¥±ª®«¼ª® ¡®«¥¥ ±«®¦­»¬.  · ±²­®±²¨, ¢ ¤¢³µ £« ¢ µ ¬»
¯°¨¬¥­¿¥¬ ²¥µ­¨ª³  ¬®°²¨§ ¶¨®­­®£®  ­ «¨§  (£« ¢  18).
 £« ¢¥ 19 ¬» ° ±±¬ ²°¨¢ ¥¬ -¤¥°¥¢¼¿ | ±¡ « ­±¨°®¢ ­­»¥
¤¥°¥¢¼¿ ®¯°¥¤¥«¥­­®£® ¢¨¤ , ³¤®¡­»¥ ¤«¿ µ° ­¥­¨¿ ¨­´®°¬ ¶¨¨
­  ¤¨±ª µ. ¯¥¶¨´¨ª  ¤¨±ª®¢ ¢ ²®¬, ·²® ¢ ¦­® ­¥ ±²®«¼ª® ¢°¥¬¿
¢»·¨±«¥­¨©, ±ª®«¼ª® ·¨±«® ®¯¥° ¶¨© ·²¥­¨¿/§ ¯¨±¨ ¡«®ª®¢. ¨±«®
² ª¨µ ®¯¥° ¶¨© ¯°®¯®°¶¨®­ «¼­® ¢»±®²¥ ¤¥°¥¢ , ¨ ¯®²®¬³ ¢»±®²³
-¤¥°¥¢¼¥¢ ¢ ¦­® ¯®¤¤¥°¦¨¢ ²¼ ­¥¡®«¼¸®©.
 £« ¢ µ 20 ¨ 21 ¬» ° ±±¬ ²°¨¢ ¥¬ ° §«¨·­»¥ °¥ «¨§ ¶¨¨ ±«¨¢ ¥¬»µ ª³· | ±²°³ª²³°» ¤ ­­»µ, ª®²®° ¿ ¯®¤¤¥°¦¨¢ ¥² ®¯¥° ¶¨¨
¤®¡ ¢«¥­¨¿ ½«¥¬¥­²  (Insert), ®²»±ª ­¨¿ ¬¨­¨¬³¬  (Minimum),
³¤ «¥­¨¿ ¬¨­¨¬ «¼­®£® ½«¥¬¥­²  (Extract-Min) ¨ ®¡º¥¤¨­¥­¨¿
(Union) ¤¢³µ ª³·. ®¬¨¬® ½²¨µ ®¯¥° ¶¨©, ¬®£³² ¡»²¼ ½´´¥ª²¨¢­® °¥ «¨§®¢ ­» ² ª¦¥ ®¯¥° ¶¨¨ ³¤ «¥­¨¿ ½«¥¬¥­²  ¨ ³¬¥­¼¸¥­¨¿
¥£® ª«¾· .
¨­®¬¨ «¼­»¥ ª³·¨ (£« ¢  20) ¢»¯®«­¿¾² ª ¦¤³¾ ®¯¥° ¶¨¾ (¢
µ³¤¸¥¬ ±«³· ¥) §  ¢°¥¬¿ O(lg n), £¤¥ n | ·¨±«® ½«¥¬¥­²®¢ ¢ ª³·¥
(¨«¨ ¢ ¤¢³µ ±«¨¢ ¥¬»µ ª³· µ). µ ¯°¥¨¬³¹¥±²¢® (¯® ±° ¢­¥­¨¾ ±
¤¢®¨·­»¬¨ ª³· ¬¨) ±®±²®¨² ¢ ¢®§¬®¦­®±²¨ ¡»±²°®£® ±«¨¿­¨¿ ¤¢³µ
ª³· (¤«¿ ¤¢®¨·­»µ ª³· ½²® ²°¥¡³¥² ¢°¥¬¥­¨ (n)).
¨¡®­ ··¨¥¢» ª³·¨ (£« ¢  21) ¥¹¥ ¡®«¥¥ ½´´¥ª²¨¢­» (¯® ª° ©­¥© ¬¥°¥ ²¥®°¥²¨·¥±ª¨: ¨¬¥¾² «³·¸³¾  ±¨¬¯²®²¨ª³). ° ¢¤ ,
§¤¥±¼ °¥·¼ ¨¤¥² ³¦¥ ®¡ ³·¥²­®© ±²®¨¬®±²¨ ®¯¥° ¶¨©. ¯¥° ¶¨¨
Insert, Minimum ¨ Union ¨¬¥¥² ³·¥²­³¾ (  ² ª¦¥ ´ ª²¨·¥±ª³¾) ±²®¨¬®±²¼ O(1). ¯¥° ¶¨¨ Extract-Min ¨ Delete ¨¬¥¾²
³·¥²­³¾ ±²®¨¬®±²¼ O(lg n).  ¨¡®«¥¥ ±³¹¥±²¢¥­­  ¢®§¬®¦­®±²¼
¡»±²°® ¢»¯®«­¿²¼ ®¯¥° ¶¨¾ Decrease-Key (¥¥ ³·¥²­ ¿ ±²®¨¬®±²¼ ¥±²¼ O(1)). ¬¥­­® ¡« £®¤ °¿ ½²®¬³ ¬­®£¨¥ (­  ±¥£®¤­¿¸­¨©

380

 ±²¼ V ®«¥¥ ±«®¦­»¥ ±²°³ª²³°» ¤ ­­»µ

¤¥­¼) À°¥ª®°¤­®Á ¡»±²°»¥  «£®°¨²¬» ®¡° ¡®²ª¨ £° ´®¢ ¨±¯®«¼§³¾² ´¨¡®­ ··¨¥¢» ª³·¨.
 ª®­¥¶, ¢ £« ¢¥ 22 ¬» ° ±±¬ ²°¨¢ ¥¬ ±²°³ª²³°» ¤ ­­»µ ¤«¿
µ° ­¥­¨¿ ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ¬­®¦¥±²¢ (®²­®¸¥­¨© ½ª¢¨¢ «¥­²­®±²¨). » ¨¬¥¥¬ ¢ ¢¨¤³ ±«¥¤³¾¹¥¥: ¨¬¥¥²±¿ ­¥ª®²®°®¥ ª®­¥·­®¥
¬­®¦¥±²¢®, ° §¡¨²®¥ ­  ª« ±±».  ­ · «¼­»© ¬®¬¥­² ª ¦¤»©
ª« ±± ±®¤¥°¦¨² ¯® ®¤­®¬³ ½«¥¬¥­²³; § ²¥¬ ¨µ ¬®¦­® ¯®¯ °­® ®¡º¥¤¨­¿²¼.  «¾¡®© ¬®¬¥­² ®¤¨­ ¨§ ½«¥¬¥­²®¢ ª« ±±  ±·¨² ¥²±¿ ¥£®
¯°¥¤±² ¢¨²¥«¥¬; ®¯¥° ¶¨¿ Find-Set(x) ¤ ¥² ¯°¥¤±² ¢¨²¥«¼ ª« ±± ,
±®¤¥°¦ ¹¥£® x, ®¯¥° ¶¨¿ Union(x; y ) ®¡º¥¤¨­¿¥² ¤¢  ª« ±± . ª §»¢ ¥²±¿, ·²® ¢¥±¼¬  ¯°®±²®¥ ¯°¥¤±² ¢«¥­¨¥ ½²®© ¨­´®°¬ ¶¨¨ ¢
¢¨¤¥ ª®°­¥¢®£® ¤¥°¥¢  ¢¥±¼¬  ½´´¥ª²¨¢­®: ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¨§
m ®¯¥° ¶¨© ²°¥¡³¥² ¢°¥¬¥­¨ O(m(m; n)), £¤¥ (m; n) | ¨±ª«¾·¨²¥«¼­® ¬¥¤«¥­­® ° ±²³¹ ¿ ´³­ª¶¨¿. ° ¢¤ , ¤®ª § ²¼ ½²³ ®¶¥­ª³
¢¥±¼¬  ­¥¯°®±²® (­¥±¬®²°¿ ­  ¯°®±²®²³ ± ¬®© ±²°³ª²³°» ¤ ­­»µ),
¨ ¬» ®£° ­¨·¨¬±¿ ¤®ª § ²¥«¼±²¢® ·³²¼ ¬¥­¥¥ ±¨«¼­®© ®¶¥­ª¨.
 §³¬¥¥²±¿, ½²®² ° §¤¥« ª­¨£¨ ­¨ª ª ­¥ ¯°¥²¥­¤³¥² ­  ¯®«­®²³ | ¬­®¦¥±²¢® ¨­²¥°¥±­»µ ±²°³ª²³° ¤ ­­»µ ¢ ­¥£® ­¥ ¢®¸«¨.
ª ¦¥¬ ­¥ª®²®°»¥ ¨§ ­¨µ:
 ²°³ª²³°  ¤ ­­»µ, ¯®¤¤¥°¦¨¢ ¾¹ ¿ ®¯¥° ¶¨¨ ®²»±ª ­¨¿ ¬¨­¨¬³¬ , ¬ ª±¨¬³¬ , ¤®¡ ¢«¥­¨¿ ¨ ³¤ «¥­¨¿ ½«¥¬¥­² , ¯®¨±ª ,
³¤ «¥­¨¿ ¬¨­¨¬ «¼­®£® ¨ ¬ ª±¨¬ «¼­®£® ½«¥¬¥­²®¢, ¯®¨±ª ¯°¥¤»¤³¹¥£® ¨ ±«¥¤³¾¹¥£® ½«¥¬¥­²®¢ §  ¢°¥¬¿ O(lg lg n) ¢ µ³¤¸¥¬
±«³· ¥ | ¢ ¯°¥¤¯®«®¦¥­¨¨, ·²® ¢±¥ ª«¾·¨ ¿¢«¿¾²±¿ ¶¥«»¬¨
·¨±« ¬¨ ®² 1 ¤® n (¢ ­ ¬¤¥ ® ± [194]).
 ¨­ ¬¨·¥±ª¨¥ ¤¥°¥¢¼¿ (dynamic trees), ª®²®°»¥ ¯°¥¤«®¦¨«¨
«¥ ²®° ¨  °¼¿­ [177] (±¬. ² ª¦¥  °¼¿­ [188]). ²  ±²°³ª²³°  ¤ ­­»µ µ° ­¨² «¥± ¨§ ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ª®°­¥¢»µ ¤¥°¥¢¼¥¢.
 ¦¤®¥ °¥¡°® ª ¦¤®£® ¤¥°¥¢  ¨¬¥¥² ­¥ª®²®°»© ¢¥¹¥±²¢¥­­³¾
±²®¨¬®±²¼. ®¦­® ¨±ª ²¼ °®¤¨²¥«¥©, ª®°­¨, ±²®¨¬®±²¨ °¥¡¥°,
  ² ª¦¥ ¬¨­¨¬ «¼­³¾ ±²®¨¬®±²¼ °¥¡°  ­  ¯³²¨ ®² ¤ ­­®© ¢¥°¸¨­» ª ª®°­¾. ®¦­® ³¤ «¿²¼ °¥¡° , ¬¥­¿²¼ ±²®¨¬®±²¨ °¥¡¥°
­  ¯³²¨ ª ª®°­¾, ¯°¨¢¨¢ ²¼ ª®°¥­¼ ¤¥°¥¢  ª ¤°³£®¬³ ¤¥°¥¢³,  
² ª¦¥ ¤¥« ²¼ § ¤ ­­³¾ ¢¥°¸¨­³ ª®°­¥¬ ¤¥°¥¢ , ¢ ª®²®°®¬ ®­ 
­ µ®¤¨²±¿. ±¥ ½²¨ ®¯¥° ¶¨¨ ¬®¦­® °¥ «¨§®¢ ²¼ ± ³·¥²­®© ±²®¨¬®±²¼¾ O(lg n); ¡®«¥¥ ±«®¦­ ¿ °¥ «¨§ ¶¨¿ £ ° ­²¨°³¥² ¢°¥¬¿
° ¡®²» O(lg n) ¨ ¢ µ³¤¸¥¬ ±«³· ¥.
  ±¸¨°¿¾¹¨¥±¿ ¤¥°¥¢¼¿ (splay trees) ² ª¦¥ ¯°¥¤«®¦¨«¨
«¥ ²®° ¨  °¼¿­ [178] (±¬. ² ª¦¥  °¼¿­ [188]). ­¨ ¯°¥¤±² ¢«¿¾² ±®¡®© ¤¢®¨·­»¥ ¤¥°¥¢¼¿ ± ®¡»·­»¬¨ ¤«¿ ¤¥°¥¢¼¥¢ ¯®¨±ª 
®¯¥° ¶¨¿¬¨; ¨µ ³·¥²­ ¿ ±²®¨¬®±²¼ ±®±² ¢«¿¥² O(lg n) (§  ±·¥²
²®£®, ·²® ¢°¥¬¿ ®² ¢°¥¬¥­¨ ¤¥°¥¢® ¯®¤¢¥°£ ¥²±¿ ¡ « ­±¨°®¢ª¥).  ±¸¨°¿¾¹¨¥±¿ ¤¥°¥¢¼¿ ¬®¦­® ¯°¨¬¥­¨²¼ ¯°¨ °¥ «¨§ ¶¨¨
¤¨­ ¬¨·¥±ª¨µ ¤¥°¥¢¼¥¢.
 ²°³ª²³°» ¤ ­­»µ ± ±®µ° ­¥­¨¥¬ ¯°¥¤»¤³¹¨µ ¢¥°±¨© (persis-

 ±²¼ V ®«¥¥ ±«®¦­»¥ ±²°³ª²³°» ¤ ­­»µ

381

tent data structures) ¯®§¢®«¿¾² ¯®«³· ²¼ ¨­´®°¬ ¶¨¾ ® ¯°¥¤»¤³¹¨µ ±®±²®¿­¨¿µ (¢¥°±¨¿µ ±®¤¥°¦¨¬®£®) ±²°³ª²³°»,   ¨­®£¤ 
¨ ¬¥­¿²¼ ¯°¥¤»¤³¹¨¥ ¢¥°±¨¨. ¡¹³¾ ¬¥²®¤¨ª³ ±®µ° ­¥­¨¿ ¯°¥¤»¤³¹¨µ ¢¥°±¨© ±¯¨±®·­®© ±²°³ª²³°» ¤ ­­»µ (± ­¥¡®«¼¸¨¬¨
¯®²¥°¿¬¨ ¯® ¢°¥¬¥­¨ ¨ ¯ ¬¿²¨) ¯°¥¤«®¦¨«¨ °¨±ª®««,  °­ ª,
«¥ ²®° ¨  °¼¿­ [59].  ¯®¬­¨¬, ·²® ¢ § ¤ ·¥ 14-1 ¯®¤®¡­ ¿
±²°³ª²³°  ±²°®¨« ±¼ ¤«¿ ¤¨­ ¬¨·¥±ª®£® ¬­®¦¥±²¢ .

19

-¤¥°¥¢¼¿

 ½²®© £« ¢¥ ¬» ° ±±¬®²°¨¬ ®¤¨­ ¨§ ¢¨¤®¢ ±¡ « ­±¨°®¢ ­­»µ ¤¥°¥¢¼¥¢, ¯°¨ ª®²®°®¬ ®¡¥±¯¥·¨¢ ¥²±¿ ½´´¥ª²¨¢­®¥ µ° ­¥­¨¥ ¨­´®°¬ ¶¨¨ ­  ¬ £­¨²­»µ ¤¨±ª µ ¨ ¤°³£¨µ ³±²°®©±²¢ µ ± ¯°¿¬»¬ ¤®±²³¯®¬ | -¤¥°¥¢¼¿.
-¤¥°¥¢¼¿ ¯®µ®¦¨ ­  ª° ±­®-·¥°­»¥ ¤¥°¥¢¼¿; ° §­¨¶  ¢ ²®¬, ·²®
¢ -¤¥°¥¢¥ ¢¥°¸¨­  ¬®¦¥² ¨¬¥²¼ ¬­®£® ¤¥²¥©, ­  ¯° ª²¨ª¥ ¤® ²»±¿·¨ (¢ § ¢¨±¨¬®±²¨ ®² µ ° ª²¥°¨±²¨ª ¨±¯®«¼§³¥¬®£® ¤¨±ª ). « £®¤ °¿ ½²®¬³ ª®­±² ­²  ¢ ®¶¥­ª¥ O(log n) ¤«¿ ¢»±®²» ¤¥°¥¢  ±³¹¥±²¢¥­­® ¬¥­¼¸¥, ·¥¬ ¤«¿ ·¥°­®-ª° ±­»µ ¤¥°¥¢¼¥¢.
 ª ¨ ·¥°­®-ª° ±­»¥ ¤¥°¥¢¼¿, -¤¥°¥¢¼¿ ¯®§¢®«¿¾² °¥ «¨§®¢ ²¼
¬­®£¨¥ ®¯¥° ¶¨¨ ± ¬­®¦¥±²¢ ¬¨ ° §¬¥°  n §  ¢°¥¬¿ O(log n).
°¨¬¥° -¤¥°¥¢  ¯®ª § ­ ­  °¨±. 19.1. ¥°¸¨­  x, µ° ­¿¹ ¿
n[x] ½«¥¬¥­²®¢, ¨¬¥¥² n[x]+1 ¤¥²¥©. ° ­¿¹¨¥±¿ ¢ x ª«¾·¨ ±«³¦ ²
£° ­¨¶ ¬¨, ° §¤¥«¿¾¹¨¬¨ ¢±¥µ ¥¥ ¯®²®¬ª®¢ ­  n[x] + 1 £°³¯¯; § 
ª ¦¤³¾ £°³¯¯³ ®²¢¥· ¥² ®¤¨­ ¨§ ¤¥²¥© x. °¨ ¯®¨±ª¥ ¢ -¤¥°¥¢¥
¬» ±° ¢­¨¢ ¥¬ ¨±ª®¬»© ª«¾· ± n[x] ª«¾· ¬¨, µ° ­¿¹¨¬¨±¿ ¢ x, ¨
¯® °¥§³«¼² ² ¬ ±° ¢­¥­¨¿ ¢»¡¨° ¥¬ ®¤¨­ ¨§ n[x] + 1 ¯³²¥©.
®·­®¥ ®¯°¥¤¥«¥­¨¥ -¤¥°¥¢  ¨ «®£ °¨´¬¨·¥±ª ¿ (®² ·¨±«  ¢¥°¸¨­) ®¶¥­ª  ¥£® ¢»±®²» ¯°¨¢®¤¿²±¿ ¢ ° §¤¥«¥ 19.1.  ° §¤¥«¥ 19.2
®¯¨± ­» ®¯¥° ¶¨¨ ¯®¨±ª  ¨ ¤®¡ ¢«¥­¨¿ ½«¥¬¥­²  ¢ ¤¥°¥¢®; ³¤ «¥­¨¥ ®¡±³¦¤ ¥²±¿ ¢ 19.3. ® ¯°¥¦¤¥ ­ ¤® ®¡º¿±­¨²¼, ¢ ·¥¬ ®²«¨·¨¥
¬ £­¨²­»µ ¤¨±ª®¢ ®² ®¯¥° ²¨¢­®© ¯ ¬¿²¨, ¤¥« ¾¹¥¥ ¢»£®¤­»¬
¨±¯®«¼§®¢ ­¨¥ -¤¥°¥¢¼¥¢.

¨±. 19.1 -¤¥°¥¢® ±  ­£«¨©±ª¨¬¨ ±®£« ±­»¬¨ ¢ ª ·¥±²¢¥ ª«¾·¥©. ­³²°¥­­¿¿
¢¥°¸¨­  x ± n[x] ª«¾· ¬¨ ¨¬¥¥² n[x] + 1 ¤¥²¥©. ±¥ «¨±²¼¿ ¨¬¥¾² ®¤­³ ¨ ²³ ¦¥
£«³¡¨­³. ¢¥²«»¥ ¢¥°¸¨­» ¯°®±¬®²°¥­» ¢ ¯°®¶¥±±¥ ¯®¨±ª  ¡³ª¢» R.

« ¢  19 -¤¥°¥¢¼¿

¨±. 19.2

383

¨±ª®¢®¤

²°³ª²³°» ¤ ­­»µ ­  ¤¨±ª¥
®¬¯¼¾²¥° ¨±¯®«¼§³¥² ° §­»¥ ¢¨¤» ¯ ¬¿²¨. ¯¥° ²¨¢­ ¿ ¯ ¬¿²¼ (main memory) ¯°¥¤±² ¢«¿¥² ±®¡®© ¬¨ª°®±µ¥¬», ª ¦¤ ¿ ¨§
ª®²®°»µ ¢¬¥¹ ¥² ¬¨««¨®­» ¡¨²®¢. ¥­  ² ª®© ¯ ¬¿²¨ (¢ ° ±·¥²¥
­  ¡¨²) ¢»¸¥, ·¥¬ ¤«¿ ¢²®°¨·­®© ¯ ¬¿²¨ (secondary storage).
¨¯¨·­»© ª®¬¯¼¾²¥° ¨±¯®«¼§³¥² ¢ ª ·¥±²¢¥ ¢²®°¨·­®© ¯ ¬¿²¨
¦¥±²ª¨© ¤¨±ª, ®¡º¥¬ ª®²®°®£® ¬®¦¥² ­  ­¥±ª®«¼ª® ¯®°¿¤ª®¢ ¯°¥¢®±µ®¤¨²¼ ®¡º¥¬ ®¯¥° ²¨¢­®© ¯ ¬¿²¨.
 £­¨²­ ¿ £®«®¢ª  (±¬. °¨±. 19.2) § ¯¨±»¢ ¥² ¨ ·¨² ¥² ¤ ­­»¥
­  ¬ £­¨²­®¬ ±«®¥ ¢° ¹ ¾¹¥£®±¿ ¤¨±ª . »· £ ¬®¦¥² ¯¥°¥¬¥±²¨²¼ ¥¥ ¢¤®«¼ ° ¤¨³±  ¤¨±ª . ®±«¥ ½²®£® £®«®¢ª  ·¨² ¥²/¯¨¸¥²
¤ ­­»¥ ­  ®¤­®© ¨§ ¤®°®¦¥ª (tracks) ¤¨±ª . ¡»·­® ª ¦¤ ¿ ¤®°®¦ª  ¤¥«¨²±¿ ­  ®¯°¥¤¥«¥­­®¥ ·¨±«® ° ¢­»µ ¯® ° §¬¥°³ ±¥ª²®°®¢
(ª ¦¤»© ¬®¦¥² § ­¨¬ ²¼ ­¥±ª®«¼ª® ª¨«®¡ ©²®¢). ¡»·­® § ¯¨±»¢ ¾² ¨«¨ ±·¨²»¢ ¾² ±¥ª²®° ¶¥«¨ª®¬. °¥¬¿ ¤®±²³¯  (access time),
ª®²®°®¥ ²°¥¡³¥²±¿ ·²®¡» ¯®¤¢¥±²¨ £®«®¢ª³ ª ­³¦­®¬³ ¬¥±²³ ¤¨±ª , ¬®¦¥² ¡»²¼ ¤®±² ²®·­® ¡®«¼¸¨¬ (¤® 20 ¬¨««¨±¥ª³­¤); ¢ ®¯¥° ²¨¢­®© ¯ ¬¿²¨ ² ª®© § ¤¥°¦ª¨ ­¥², ¯®²®¬³ ·²® ­¥² ¬¥µ ­¨·¥±ª®£®
¯¥°¥¬¥¹¥­¨¿.  ª ²®«¼ª® £®«®¢ª  ¤¨±ª  ³¦¥ ³±² ­®¢«¥­ , § ¯¨±¼
¨«¨ ·²¥­¨¥ ¤¨±ª  ¯°®¨±µ®¤¨² ¤®¢®«¼­® ¡»±²°®.  ±²® ¯®«³· ¥²±¿,
·²® ®¡° ¡®²ª  ¯°®·¨² ­­®£® § ­¨¬ ¥² ¬¥­¼¸¥ ¢°¥¬¥­¨, ·¥¬ ¯®¨±ª ­³¦­®£® ±¥ª²®° . ®½²®¬³, ®¶¥­¨¢ ¿ ª ·¥±²¢®  «£®°¨²¬  ¬»
¡³¤¥¬ ³·¨²»¢ ²¼ ¤¢  ¯ ° ¬¥²° :
 ·¨±«® ®¡° ¹¥­¨© ª ¤¨±ª³, ¨
 ¢°¥¬¿ ¢»·¨±«¥­¨© (¢°¥¬¿ ° ¡®²» ¯°®¶¥±±®° ).
²°®£® £®¢®°¿, ¢°¥¬¿ ¤®±²³¯  § ¢¨±¨² ®² ¯®«®¦¥­¨¿ £®«®¢ª¨ ®²­®±¨²¥«¼­® ­³¦­®£® ±¥ª²®° . ® ¬» ­¥ ®¡° ¹ ¥¬ ­  ½²® ¢­¨¬ ­¨¿
¨ ³·¨²»¢ ¥¬ «¨¸¼ ·¨±«® ®¡° ¹¥­¨© ª ¤¨±ª³ (². ¥. ·¨±«® ±¥ª²®°®¢,
ª®²®°»¥ ­³¦­® ±·¨² ²¼ ¨«¨ § ¯¨± ²¼).
«£®°¨²¬», ° ¡®² ¾¹¨¥ ± -¤¥°¥¢¼¿¬¨, µ° ­¿² ¢ ®¯¥° ²¨¢­®©

384

« ¢  19 -¤¥°¥¢¼¿

-¤¥°¥¢® ¢»±®²» 2 ±®¤¥°¦¨² ¡®«¥¥ ¬¨««¨ °¤  ª«¾·¥©.  ¦¤ ¿ ¢¥°¸¨­  ±®¤¥°¦¨² 1000 ª«¾·¥©. ±¥£® ¨¬¥¥²±¿ 1001 ¢¥°¸¨­  ­  £«³¡¨­¥ 1 ¨ ¡®«¥¥
¬¨««¨®­  «¨±²¼¥¢ ­  £«³¡¨­¥ 2.  ª ¦¤®© ¢¥°¸¨­¥ x § ¯¨± ­® ·¨±«® n[x] ª«¾·¥©
¢ ­¥©.
¨±. 19.3

¯ ¬¿²¨ «¨¸¼ ­¥¡®«¼¸³¾ · ±²¼ ¢±¥© ¨­´®°¬ ¶¨¨ (´¨ª±¨°®¢ ­­®¥
·¨±«® ±¥ª²®°®¢), ¨ ¯®½²®¬³ ¥¥ ° §¬¥° ­¥ ®£° ­¨·¨¢ ¥²±¿ ° §¬¥°®¬
¤®±²³¯­®© ¯ ¬¿²¨.
» ° ±±¬ ²°¨¢ ¥¬ ¤¨±ª ª ª ¡®«¼¸®© ³· ±²®ª ¯ ¬¿²¨, ° ¡®²  ±
ª®²®°»¬ ¯°®¨±µ®¤¨² ±«¥¤³¾¹¨¬ ®¡° §®¬: ¯¥°¥¤ ²¥¬ ª ª ° ¡®² ²¼
± ®¡º¥ª²®¬ x, ¬» ¤®«¦­» ¢»¯®«­¨²¼ ±¯¥¶¨ «¼­³¾ ®¯¥° ¶¨¾ DiskRead(x) (·²¥­¨¥ ± ¤¨±ª ). ®±«¥ ¢­¥±¥­¨¿ ¨§¬¥­¥­¨© ¢ ­ ¸ ®¡º¥ª² x, ¬» ¢»¯®«­¿¥¬ ®¯¥° ¶¨¾ Disk-Write(x) (§ ¯¨±¼ ­  ¤¨±ª):
1 :::
2 x ³ª § ²¥«¼ ­  ª ª®©-²® ®¡º¥ª²
3 Disk-Read(x)
4 ®¯¥° ¶¨¨, ª®²®°»¥ ¨±¯®«¼§³¾² ¨/¨«¨ ¨§¬¥­¿¾²
¯®«¿ ®¡º¥ª² , ­  ª®²®°»© ³ª §»¢ ¥² x.
5 Disk-Write(x)
. ¥ ­³¦­®, ¥±«¨
. ¯®«¿ ®¡º¥ª²  ­¥ ¨§¬¥­¨«¨±¼.
6 ®¯¥° ¶¨¨, ª®²®°»¥ ¯®«¼§³¾²±¿ ¯®«¿¬¨ ³ª § ²¥«¿ x,
­® ­¥ ¬¥­¿¾² ¨µ.
7 :::
°¥¬¿ ° ¡®²» ¯°®£° ¬¬» ¢ ®±­®¢­®¬ ®¯°¥¤¥«¿¥²±¿ ª®«¨·¥±²¢®¬
®¯¥° ¶¨© Disk-Read ¨ Disk-Write, ² ª ·²® ¨¬¥¥¥² ±¬»±« ·¨² ²¼/§ ¯¨±»¢ ²¼ ¢®§¬®¦­® ¡®«¼¸¥ ¨­´®°¬ ¶¨¨ §  ° § ¨ ±¤¥« ²¼
² ª, ·²®¡» ¢¥°¸¨­  -¤¥°¥¢  § ¯®«­¿«  ¯®«­®±²¼¾ ®¤¨­ ±¥ª²®°
¤¨±ª .  ª¨¬ ®¡° §®¬, ±²¥¯¥­¼ ¢¥²¢«¥­¨¿ (·¨±«® ¤¥²¥© ¢¥°¸¨­»)
®¯°¥¤¥«¿¥²±¿ ° §¬¥°®¬ ±¥ª²®° .
¨¯¨·­ ¿ ±²¥¯¥­¼ ¢¥²¢«¥­¨¿ -¤¥°¥¢¼¥¢ ­ µ®¤¨²±¿ ¬¥¦¤³ 50 ¨
2000 (¢ § ¢¨±¨¬®±²¨ ®² ° §¬¥°  ½«¥¬¥­² ). ¢¥«¨·¥­¨¥ ±²¥¯¥­¨ ¢¥²¢«¥­¨¿ °¥§ª® ±®ª° ¹ ¥² ¢»±®²³ ¤¥°¥¢ , ¨ ²¥¬ ± ¬»¬ ·¨±«® ®¡° ¹¥­¨© ª ¤¨±ª³, ¯°¨ ¯®¨±ª¥.   °¨±. 19.3 ¯®ª § ­® -¤¥°¥¢® ±²¥¯¥­¨ 1001 ¨ ¢»±®²» 2, µ° ­¿¹¥¥ ¡®«¥¥ ¬¨««¨ °¤  ª«¾·¥©. ·¨²»¢ ¿,
·²® ª®°¥­¼ ¬®¦­® ¯®±²®¿­­® µ° ­¨²¼ ¢ ®¯¥° ²¨¢­®© ¯ ¬¿²¨, ¤®±² ²®·­® ¤¢³µ ®¡° ¹¥­¨© ª ¤¨±ª³, ¯°¨ ¯®¨±ª¥ ­³¦­®£® ª«¾· !

¯°¥¤¥«¥­¨¥ -¤¥°¥¢ 

385

19.1. ¯°¥¤¥«¥­¨¥ -¤¥°¥¢ 
 ª ¨ ° ­¼¸¥, ¤«¿ ¯°®±²®²» ¬» ±·¨² ¥¬, ·²® ¤®¯®«­¨²¥«¼­ ¿
¨­´®°¬ ¶¨¿, ±¢¿§ ­­ ¿ ± ª«¾·®¬, µ° ­¨²±¿ ¢ ²®© ¦¥ ¢¥°¸¨­¥ ¤¥°¥¢ . (  ¯° ª²¨ª¥ ½²® ­¥ ¢±¥£¤  ³¤®¡­®, ¨ ¢ °¥ «¼­®¬  «£®°¨²¬¥
¢¥°¸¨­  ¬®¦¥² ±®¤¥°¦ ²¼ «¨¸¼ ±±»«ª³ ­  ±¥ª²®°, £¤¥ µ° ­¨²±¿
½²  ¤®¯®«­¨²¥«¼­ ¿ ¨­´®°¬ ¶¨¿.) » ±·¨² ¥¬, ·²® ¯°¨ ¯¥°¥¬¥¹¥­¨¿µ ª«¾·  ¤®¯®«­¨²¥«¼­ ¿ ¨­´®°¬ ¶¨¿ (¨«¨ ±±»«ª  ­  ­¥¥)
¯¥°¥¬¥¹ ¥²±¿ ¢¬¥±²¥ ± ­¨¬. ¥¬ ± ¬»¬ ½«¥¬¥­²®¬ -¤¥°¥¢  ¡³¤¥²
ª«¾· ¢¬¥±²¥ ±® ±¢¿§ ­­®© ± ­¨¬ ¨­´®°¬ ¶¨¥©.
 ¯°¨­¶¨¯¥ ¬» ¬®£«¨ ¡» ¨±¯®«¼§®¢ ²¼ ¤°³£³¾ · ±²® ¢±²°¥· ¾¹³¾±¿ ®°£ ­¨§ ¶¨¾ -¤¥°¥¢¼¥¢: ¯®¬¥¹ ²¼ ±®¯³²±²¢³¾¹³¾ ¨­´®°¬ ¶¨¾ ¢ «¨±²¼¿µ (£¤¥ ¡®«¼¸¥ ¬¥±² , ² ª ª ª ­¥ ­ ¤® µ° ­¨²¼
ª«¾·¨),   ¢® ¢­³²°¥­­¨µ ¢¥°¸¨­ µ µ° ­¨²¼ ²®«¼ª® ª«¾·¨ ¨ ³ª § ²¥«¨ ­  ¤¥²¥©, ½ª®­®¬¿ ¬¥±²® (¨ ¯®«³· ¿ ¢®§¬®¦­®±²¼ ³¢¥«¨·¨²¼
±²¥¯¥­¼ ¢¥²¢«¥­¨¿ ¯°¨ ²®¬ ¦¥ ° §¬¥°¥ ±¥ª²®° ).
² ª, -¤¥°¥¢®¬ (B-tree) ­ §®¢¥¬ ª®°­¥¢®¥ ¤¥°¥¢®, ³±²°®¥­­®¥
±«¥¤³¾¹¨¬ ®¡° §®¬:
1.  ¦¤ ¿ ¢¥°¸¨­  x ±®¤¥°¦¨² ¯®«¿, ¢ ª®²®°»µ µ° ­¿²±¿:
 ). ª®«¨·¥±²¢® n[x] ª«¾·¥©, µ° ­¿¹¨µ±¿ ¢ ­¥©;
¡). ± ¬¨ ª«¾·¨ key1 [x] 6 key2 [x] 6 : : : 6 keyn[x] [x] (¢ ­¥³¡»¢ ¾¹¥¬ ¯®°¿¤ª¥)
¢). ¡³«¥¢±ª®¥ §­ ·¥­¨¥ leaf[x], ¨±²¨­­®¥, ª®£¤  ¢¥°¸¨­  µ ¿¢«¿¥²±¿ «¨±²®¬.
2. ±«¨ µ | ¢­³²°¥­­¿¿ ¢¥°¸¨­ , ²® ®­  ² ª¦¥ ±®¤¥°¦¨² n[x] + 1
³ª § ²¥«¼ c1[x]; c2[x]; : : :; cn[x]+1[x] ­  ¥¥ ¤¥²¥©.  «¨±²¼¥¢ ¤¥²¥©
­¥², ¨ ½²¨ ¯®«¿ ¤«¿ ­¨µ ­¥ ®¯°¥¤¥«¥­».
3. «¾·¨ keyi [x] ±«³¦ ² £° ­¨¶ ¬¨, ° §¤¥«¿¾¹¨¬¨ §­ ·¥­¨¿
ª«¾·¥© ¢ ¯®¤¤¥°¥¢¼¿µ:
k1 6 key1[x] 6 k2 6 key2[x] 6    6 keyn[x] [x] 6 kn[x]+1 ;
£¤¥ ki | «¾¡®© ¨§ ª«¾·¥©, µ° ­¿¹¨µ±¿ ¢ ¯®¤¤¥°¥¢¥ ± ª®°­¥¬
±i[x].
4. ±¥ «¨±²¼¿ ­ µ®¤¿²±¿ ­  ®¤­®© ¨ ²®© ¦¥ £«³¡¨­¥ (° ¢­®© ¢»±®²¥ h ¤¥°¥¢ ).
5. ¨±«® ª«¾·¥©, µ° ­¿¹¨µ±¿ ¢ ®¤­®© ¢¥°¸¨­¥, ®£° ­¨·¥­® ±¢¥°µ³
¨ ±­¨§³; £° ­¨¶» § ¤ ¾²±¿ ¥¤¨­»¬ ¤«¿ ¢±¥£® ¤¥°¥¢  ·¨±«®¬ t >
2, ª®²®°®¥ ­ §»¢ ¥²±¿ ¬¨­¨¬ «¼­®© ±²¥¯¥­¼¾ (minimum degree)
-¤¥°¥¢ . ¬¥­­®:
 ).  ¦¤ ¿ ¢¥°¸¨­ , ª°®¬¥ ª®°­¿, ±®¤¥°¦¨² ¯® ¬¥­¼¸¥© ¬¥°¥
t ; 1 ª«¾·.  ª¨¬ ®¡° §®¬, ¢­³²°¥­­¨¥ ¢¥°¸¨­» (ª°®¬¥ ª®°­¿) ¨¬¥¾² ­¥ ¬¥­¥¥ t ¤¥²¥©. ±«¨ ¤¥°¥¢® ­¥¯³±²®, ²® ¢ ª®°­¥
¤®«¦¥­ µ° ­¨²¼±¿ µ®²¿ ¡» ®¤¨­ ª«¾·.

386

« ¢  19 -¤¥°¥¢¼¿

 ¢¥°¸¨­¥ µ° ­¨²±¿ ­¥ ¡®«¥¥ 2t ; 1 ª«¾·¥©. «¥¤®¢ ²¥«¼­®, ¢­³²°¥­­¿¿ ¢¥°¸¨­  ¨¬¥¥² ­¥ ¡®«¥¥ 2t ¤¥²¥©. ¥°¸¨­³,
µ° ­¿¹³¾ °®¢­® 2t ; 1 ª«¾·¥©, ­ §®¢¥¬ ¯®«­®© (full).
 ¯°®±²¥©¸¥¬ ±«³· ¥ t = 2, ²®£¤  ³ ª ¦¤®© ¢­³²°¥­­¥© ¢¥°¸¨­»
2, 3 ¨«¨ 4 °¥¡¥­ª , ¨ ¬» ¯®«³· ¥¬ ² ª ­ §»¢ ¥¬®¥ 2-3-4 ¤¥°¥¢® (2-34 tree). ( ª ¬» ³¦¥ £®¢®°¨«¨, ¤«¿ ½´´¥ª²¨¢­®© ° ¡®²» ± ¤¨±ª®¬
­  ¯° ª²¨ª¥ t ­ ¤® ¡° ²¼ £®° §¤® ¡®«¼¸¨¬.)
¡).

»±®²  -¤¥°¥¢ 
¨±«® ®¡° ¹¥­¨© ª ¤¨±ª³ ¤«¿ ¡®«¼¸¨­±²¢  ®¯¥° ¶¨© ¯°®¯®°¶¨®­ «¼­® ¢»±®²¥ -¤¥°¥¢ . ¶¥­¨¬ ±¢¥°µ³ ½²³ ¢»±®²³.
¥®°¥¬  19.1. «¿ ¢±¿ª®£® -¤¥°¥¢   ¢»±®²» h ¨ ¬¨­¨¬ «¼­®©
±²¥¯¥­¨ t > 2, µ° ­¿¹¥£® n > 1 ª«¾·¥©, ¢»¯®«­¥­® ­¥° ¢¥­±²¢®
h 6 logt n +2 1 :
®ª § ²¥«¼±²¢®. ³±²¼ ¢»±®²  -¤¥°¥¢  ° ¢­  § ¤ ­­®¬³ ·¨±«³
h.  ¨¬¥­¼¸¥¥ ·¨±«® ¢¥°¸¨­ ¢ ¤¥°¥¢¥ ¡³¤¥², ¥±«¨ ±²¥¯¥­¼ ª ¦¤®©
¢¥°¸¨­» ¬¨­¨¬ «¼­ , ²® ¥±²¼ ³ ª®°­¿ 2 °¥¡¥­ª ,   ³ ¢­³²°¥­­¨µ
¢¥°¸¨­ ¯® t ¤¥²¥©.  ½²®¬ ±«³· ¥ ­  £«³¡¨­¥ 1 ¬» ¨¬¥¥¬ 2 ¢¥°¸¨­», ­  £«³¡¨­¥ 2 ¨¬¥¥¬ 2t ¢¥°¸¨­, ­  £«³¡¨­¥ 3 ¨¬¥¥¬ 2t2 ¢¥°¸¨­,
: : : , ­  £«³¡¨­¥ h ¨¬¥¥¬ 2th;1 ¢¥°¸¨­. °¨ ½²®¬ ¢ ª®°­¥ µ° ­¨²±¿ ®¤¨­ ª«¾·,   ¢® ¢±¥µ ®±² «¼­»µ ¢¥°¸¨­ µ ¯® t ; 1 ª«¾·¥©. ( 
°¨±. 19.4 ¯®ª § ­® ² ª®¥ ¤¥°¥¢® ¯°¨ h = 3.)  ª¨¬ ®¡° §®¬, ¯®«³· ¥¬ ­¥° ¢¥­±²¢®:

n > 1 + (t ; 1)

h
X
i=1

2ti;1 = 1 + 2(t ; 1)



th ; 1  = 2th ; 1;
t;1

®²ª³¤  ±«¥¤³¥² ³²¢¥°¦¤¥­¨¥ ²¥®°¥¬».
 ª ¨ ¤«¿ ª° ±­®-·¥°­»µ ¤¥°¥¢¼¥¢, ¢»±®²  -¤¥°¥¢  ± n ¢¥°¸¨­ ¬¨ ¥±²¼ O(log n), ­® ®±­®¢ ­¨¥ «®£ °¨´¬  ¤«¿ -¤¥°¥¢¼¥¢ £®° §¤®
¡®«¼¸¥, ·²® ¯°¨¬¥°­® ¢ lg t ° § ±®ª° ¹ ¥² ª®«¨·¥±²¢® ®¡° ¹¥­¨©
ª ¤¨±ª³.
¯° ¦­¥­¨¿
19.1-1 ®·¥¬³ ¢ ®¯°¥¤¥«¥­¨¨ -¤¥°¥¢  ²°¥¡®¢ ­¨¥ t > 2 ±³¹¥±²¢¥­­®?
19.1-2 °¨ ª ª¨µ t ¤¥°¥¢® ­  °¨±. 19.1 ¬®¦­® ° ±±¬ ²°¨¢ ²¼ ª ª
-¤¥°¥¢® ¬¨­¨¬ «¼­®© ±²¥¯¥­¨ t?

±­®¢­»¥ ®¯¥° ¶¨¨ ± -¤¥°¥¢¼¿¬¨

387

-¤¥°¥¢® ¢»±®²» 3 ±®¤¥°¦¨² ¬¨­¨¬ «¼­® ¢®§¬®¦­®¥ ·¨±«® ª«¾·¥©.
­³²°¨ ª ¦¤®© ¢¥°¸¨­» x § ¯¨± ­® ·¨±«® n[x] ª«¾·¥© ¢ ­¥©.
¨±. 19.4

19.1-3  ©²¨ ¢±¥ -¤¥°¥¢¼¿ ¬¨­¨¬ «¼­®© ±²¥¯¥­¨ 2, ¯°¥¤±² ¢«¿¾¹¨¥ ¬­®¦¥±²¢® f1; 2; 3; 4; 5g
19.1-4  ©²¨ ²®·­³¾ ¢¥°µ­¾¾ ®¶¥­ª³ ¤«¿ ·¨±«  ª«¾·¥©, µ° ­¿¹¨µ±¿ ¢ -¤¥°¥¢¥ ¢»±®²» h ¨ ¬¨­¨¬ «¼­®© ±²¥¯¥­¨ t.
19.1-5 ¯¨± ²¼ ±²°³ª²³°³ ¤ ­­»µ, ª®²®° ¿ ¯®«³·¨²±¿, ¥±«¨ ¢
ª° ±­®-·¥°­®¬ ¤¥°¥¢¥ ª ¦¤³¾ ·¥°­³¾ ¢¥°¸¨­³ ±®¥¤¨­¨²¼ ± ¥¥
ª° ±­»¬¨ ¤¥²¼¬¨,   ¨µ ¤¥²¥© ±¤¥« ²¼ ¤¥²¼¬¨ ½²®© ·¥°­®© ¢¥°¸¨­».

19.2. ±­®¢­»¥ ®¯¥° ¶¨¨ ± -¤¥°¥¢¼¿¬¨
 ½²®¬ ° §¤¥«¥ ¬» ¯®¤°®¡­® ° ±±¬®²°¨¬ ®¯¥° ¶¨¨ B-TreeSearch (¯®¨±ª), B-Tree-Create (±®§¤ ­¨¥ -¤¥°¥¢ ) ¨ B-TreeInsert (¤®¡ ¢«¥­¨¥ ½«¥¬¥­² ). » ±·¨² ¥¬, ·²®:

 ®°¥­¼ -¤¥°¥¢  ¢±¥£¤  ­ µ®¤¨²±¿ ¢ ®¯¥° ²¨¢­®© ¯ ¬¿²¨, ². ¥.

®¯¥° ¶¨¿ Disk-Read ¤«¿ ª®°­¿ ­¨ª®£¤  ­¥ ²°¥¡³¥²±¿; ®¤­ ª®
¢±¿ª¨© ° §, ª®£¤  ¬» ¨§¬¥­¿¥¬ ª®°¥­¼, ¬» ¤®«¦­» ¥£® ±®µ° ­¿²¼ ­  ¤¨±ª¥.
 ±¥ ¢¥°¸¨­», ¯¥°¥¤ ¢ ¥¬»¥ ª ª ¯ ° ¬¥²°», ³¦¥ ±·¨² ­» ± ¤¨±ª .
 ¸¨ ¯°®¶¥¤³°» ®¡° ¡ ²»¢ ¾² ¤¥°¥¢® §  ®¤¨­ ¯°®µ®¤ ®² ª®°­¿ ª
«¨±²¼¿¬.
®¨±ª ¢ -¤¥°¥¢¥
®¨±ª ¢ -¤¥°¥¢¥ ¯®µ®¦ ­  ¯®¨±ª ¢ ¤¢®¨·­®¬ ¤¥°¥¢¥.  §­¨¶ 
¢ ²®¬, ·²® ¢ ª ¦¤®© ¢¥°¸¨­¥ x ¬» ¢»¡¨° ¥¬ ®¤¨­ ¢ °¨ ­² ¨§

388

« ¢  19 -¤¥°¥¢¼¿

(n[x] + 1),   ­¥ ¨§ ¤¢³µ.
 ª ¨ ¯°®¶¥¤³°  Tree-Search (¤«¿ ¤¢®¨·­»µ ¤¥°¥¢¼¥¢), °¥ª³°±¨¢­®© ¯°®¶¥¤³°  B-Tree-Search ¯®«³· ¥² ­  ¢µ®¤ ³ª § ²¥«¼ x
­  ª®°¥­¼ ¯®¤¤¥°¥¢  ¨ ª«¾· k, ª®²®°»© ¬» ¨¹¥¬ ¢ ½²®¬ ¯®¤¤¥°¥¢¥.
«¿ ¯®¨±ª  ª«¾·  k ¢ -¤¥°¥¢¥ T ±«¥¤³¥² ±ª®¬ ­¤®¢ ²¼ B-TreeSearch(root(T ); k), £¤¥ root(T ) ³ª §»¢ ¥² ­  ª®°¥­¼. ±«¨ ¯°®¶¥¤³°  ®¡­ °³¦¨¢ ¥² ª«¾· k ¢ ¤¥°¥¢¥, ®­  ¢®§¢° ¹ ¥² ¯ °³ (y; i),
£¤¥ y | ¢¥°¸¨­ , i | ¯®°¿¤ª®¢»© ­®¬¥° ³ª § ²¥«¿, ¤«¿ ª®²®°®£®
keyi [y ] = k.  ¯°®²¨¢­®¬ ±«³· ¥ ¯°®¶¥¤³°  ¢®§¢° ¹ ¥² ª®­±² ­²³
nil.
B-Tree-Search (x; k)
1 i 1
2 while i 6 n[x] and k > keyi [x]
3
do i i + 1
4 if i 6 n[x] and k = keyi [x]
5 then return (x; i)
6 if leaf[x]
7 then return nil
8 else Disk-Read(ci [x])
9
return B-Tree-Search(ci[x]; k)
 ±²°®ª µ 1-3 ¨¹¥²±¿ ­ ¨¬¥­¼¸¥¥ i, ¤«¿ ª®²®°®£® k 6 keyi [x];
¥±«¨ ² ª®£® ­¥², ²® ¢ i ¯®¬¥¹ ¥²±¿ n[x]+1 («¨­¥©­»© ¯®¨±ª). ±«¨
­³¦­»© ª«¾· ­ ©¤¥­, ° ¡®²  ¯°¥ª° ¹ ¥²±¿ (±²°®ª¨ 4{5).  ²¥¬
(±²°®ª¨ 6{7) ¯°®£° ¬¬  «¨¡® ®±² ­ ¢«¨¢ ¥²±¿, ¥±«¨ ¯®¨±ª § ¢¥°¸¨«±¿ ¡¥§°¥§³«¼² ²­® (x | «¨±²), «¨¡® °¥ª³°±¨¢­® ¢»§»¢ ¥² ±¥¡¿,
¯°¥¤¢ °¨²¥«¼­® ±·¨² ¢ ± ¤¨±ª  ª®°¥­¼ ­³¦­®£® ¯®¤¤¥°¥¢  (±²°®ª¨
8{9).
  °¨±. 19.1 ¯®ª § ­  ° ¡®²  ½²®© ¯°®£° ¬¬». ¢¥²«»¥ ¢¥°¸¨­»
¯°®±¬®²°¥­» ¯°¨ ¯®¨±ª¥ ¡³ª¢» R.
 ª ¨ ¯°®¶¥¤³°  Tree-Search, ­ ¸  ¯°®£° ¬¬  ¯°®±¬ ²°¨¢ ¥²
¢¥°¸¨­» ¤¥°¥¢  ®² ª®°­¿ ª «¨±²³. ®½²®¬³ ·¨±«® ®¡° ¹¥­¨© ª ¤¨±ª³ ¥±²¼ (h) = (logt n), £¤¥ h | ¢»±®²  ¤¥°¥¢ ,   n | ª®«¨·¥±²¢®
ª«¾·¥©.  ª ª ª n[x] 6 2t, ²® ¶¨ª« while ¢ ±²°®ª µ 2{3 ¯®¢²®°¿¥²±¿
O(t) ° §, ¨ ¢°¥¬¿ ¢»·¨±«¥­¨© ° ¢­® O(th) = O(t logt n).
®§¤ ­¨¥ ¯³±²®£® -¤¥°¥¢ 
°¨ ° ¡®²¥ ± -¤¥°¥¢®¬ T , ¬» ±­ · «  ±®§¤ ¥¬ ± ¯®¬®¹¼¾ ¯°®¶¥¤³°» B-Tree-Create ¯³±²®¥ ¤¥°¥¢®,   § ²¥¬ § ¯¨±»¢ ¥¬ ¢ ­¥£®
¤ ­­»¥ ± ¯®¬®¹¼¾ ¯°®¶¥¤³°» B-Tree-Insert. ¡¥ ½²¨ ¯°®¶¥¤³°»
¨±¯®«¼§³¾² ¯®¤¯°®£° ¬¬³ Allocate-Node, ª®²®° ¿ ­ µ®¤¨² ¬¥±²® ­  ¤¨±ª¥ ¤«¿ ­®¢®© ¢¥°¸¨­». » ±·¨² ¥¬, ·²® ¯®¤¯°®£° ¬¬ 
Allocate-Node ²°¥¡³¥² ¢°¥¬¥­¨ O(1) ¨ ­¥ ¨±¯®«¼§³¥² ®¯¥° ¶¨¾
Disk-Read.

±­®¢­»¥ ®¯¥° ¶¨¨ ± -¤¥°¥¢¼¿¬¨

389

 §¡¨¥­¨¥ ¢¥°¸¨­» ¤¥°¥¢  ¬¨­¨¬ «¼­®© ±²¥¯¥­¨ t = 4. ¥«¨¬ ¢¥°¸¨­³ y ­  ¤¢¥: y ¨ z . «¾·-¬¥¤¨ ­  S ¢¥°¸¨­» y ¯¥°¥µ®¤¨² ª ¥¥ °®¤¨²¥«¾ x.
¨±. 19.5

B-Tree-Create (T )
1 x Allocate-Node ()
2 leaf[x] true

3 n[x] 0
4 Disk-Write(x)
5 root[T ] x
°®¶¥¤³°  B-Tree-Create ²°¥¡³¥² ®¤­®£® ®¡° ¹¥­¨¿ ª ¤¨±ª³,
¢°¥¬¿ ° ¡®²» | O(1).
 §¡¨¥­¨¥ ¢¥°¸¨­» -¤¥°¥¢  ­  ¤¢¥
®¡ ¢«¥­¨¥ ½«¥¬¥­²  ¢ -¤¥°¥¢® | §­ ·¨²¥«¼­® ¡®«¥¥ ±«®¦­ ¿ ®¯¥° ¶¨¿, ·¥¬ ¤®¡ ¢«¥­¨¥ ½«¥¬¥­²  ¢ ¤¢®¨·­®¥ ¤¥°¥¢® ¯®¨±ª .
«¾·¥¢»¬ ¬¥±²®¬ ¿¢«¿¥²±¿ ° §¡¨¥­¨¥ (splitting) ¯®«­®© (± 2t ; 1
ª«¾· ¬¨) ¢¥°¸¨­» y ­  ¤¢¥ ¢¥°¸¨­», ¨¬¥¾¹¨¥ ¯® t ; 1 ½«¥¬¥­²®¢ ¢
ª ¦¤®©. °¨ ½²®¬ ª«¾·-¬¥¤¨ ­  (median key) keyt [y ] ®²¯° ¢«¿¥²±¿
ª °®¤¨²¥«¾ x ¢¥°¸¨­» y ¨ ±² ­®¢¨²±¿ ° §¤¥«¨²¥«¥¬ ¤¢³µ ¯®«³·¥­­»µ ¢¥°¸¨­. ²® ¢®§¬®¦­®, ¥±«¨ ¢¥°¸¨­  x ­¥¯®«­ . ±«¨ y
| ª®°¥­¼, ¯°®¶¥¤³°  ° ¡®² ¥²  ­ «®£¨·­®.  ½²®¬ ±«³· ¥ ¢»±®² 
¤¥°¥¢  ³¢¥«¨·¨¢ ¥²±¿ ­  ¥¤¨­¨¶³.  ª®¢ ¬¥µ ­¨§¬ °®±²  -¤¥°¥¢ .
°®¶¥¤³°  B-Tree-Split-Child ¤¥«¨² ¢¥°¸¨­³ y ­  ¤¢¥ ¨ ¬¥­¿¥² ±®®²¢¥²±²¢³¾¹¨¬ ®¡° §®¬ ¥¥ °®¤¨²¥«¿ x.   °¨±. 19.5 ¯®ª § ­®, ª ª ½²® ¯°®¨±µ®¤¨². «¾·-¬¥¤¨ ­  S ¢¥°¸¨­» y ¯¥°¥µ®¤¨²
ª ¥¥ °®¤¨²¥«¾ x,   ¡®«¼¸¨¥ S ½«¥¬¥­²» ¯¥°¥¯¨±»¢ ¾²±¿ ¢ ­®¢®£® °¥¡¥­ª  z ¢¥°¸¨­» x. µ®¤­»¬¨ ¤ ­­»¬¨ ¯°®¶¥¤³°» ¿¢«¿¾²±¿
­¥¯®«­ ¿ ¢­³²°¥­­¿¿ ¢¥°¸¨­  x, ·¨±«® i ¨ ¯®«­ ¿ ¢¥°¸¨­³ y , ¤«¿
ª®²®°»µ y = ci [x]. » ±·¨² ¥¬, ·²® ¢¥°¸¨­» x ¨ y ³¦¥ ­ µ®¤¿²±¿
¢ ®¯¥° ²¨¢­®© ¯ ¬¿²¨.

390

« ¢  19 -¤¥°¥¢¼¿

B-Tree-Split-Child (x; i; y )
1 z Allocate-Node ()

2 leaf[z ] leaf[y ]
3 n[z ] t ; 1
4 for j 1 to t ; 1
5
do keyj [z ] keyj +t [y ]
6 if not leaf[y ]
7
then for j 1 to t
8
do cj [z ] cj +t [y ]
9 n[y ] t ; 1
10 for j n[x] + 1 downto i + 1
11
do cj +1 [x] cj [x]
12 ci+1 [x] z
13 for j n[x] downto i
14
do keyj +1 [x] keyj [x]
15 keyi [x] keyt [y ]
16 n[x] n[x] + 1
17 Disk-Write(y )
18 Disk-Write(z )
19 Disk-Write(x)
¥°¸¨­  y ¨¬¥«  2t ¤¥²¥©; ¯®±«¥ ¯°¥®¡° §®¢ ­¨¿ ¢ ­¥© ®±² «®±¼
t ­ ¨¬¥­¼¸¨µ ¨§ ­¨µ,   ®±² «¼­»¥ t ±² «¨ ¤¥²¼¬¨ ­®¢®© ¢¥°¸¨­» z,
ª®²®° ¿ ¢ ±¢®¾ ®·¥°¥¤¼ ±² «  °¥¡¥­ª®¬ ¢¥°¸¨­» x. «¾·-¬¥¤¨ ­ 
¢¥°¸¨­» y ¤®¡ ¢«¥­ ª ¢¥°¸¨­¥ x ¨ ±² « ° §¤¥«¨²¥«¥¬ ¬¥¦¤³ ¢¥°¸¨­®© y ¨ ±«¥¤³¾¹¥© §  ­¥© ¢¥°¸¨­®© z .
²°®ª¨ 1{8 ´®°¬¨°³¾² ¢¥°¸¨­³ z ¨ ¯¥°¥¤ ¾² ¥© ¤¥²¥©. ²°®ª  9 ¬¥­¿¥² ¢¥°¸¨­³ y .  ª®­¥¶, ±²°®ª¨ 10{16 ¢­®±¿² ±®®²¢¥²±²¢³¾¹¨¥ ¨§¬¥­¥­¨¿ ¢ ¢¥°¸¨­³ x. ²°®ª¨ 17{19 ±®µ° ­¿¾² ¨§¬¥­¥­¨¿
­  ¤¨±ª¥. °¥¬¿ ° ¡®²» ¶¨ª«®¢ (±²°®ª¨ 4{5 ¨ 7{8) ° ¢­® (t). («¿
®±² «¼­»µ ¶¨ª«®¢ ²°¥¡³¥²±¿ ­¥ ¡®«¼¸¥ t ¸ £®¢).
®¡ ¢«¥­¨¥ ½«¥¬¥­²  ¢ -¤¥°¥¢®
°®¶¥¤³°  B-Tree-Insert ¤®¡ ¢«¿¥² ½«¥¬¥­² k ¢ -¤¥°¥¢® T ,
¯°®©¤¿ ®¤¨­ ° § ®² ª®°­¿ ª «¨±²³.   ½²® ²°¥¡³¥²±¿ ¢°¥¬¿ O(th) =
O(t logt n) ¨ O(h) ®¡° ¹¥­¨© ª ¤¨±ª³, ¥±«¨ ¢»±®²  ¤¥°¥¢  h. ® µ®¤³ ¤¥«  ¬» ± ¯®¬®¹¼¾ ¯°®¶¥¤³°» B-Tree-Split ° §¤¥«¿¥¬ ¢±²°¥· ¾¹¨¥±¿ ­ ¬ ¯®«­»¥ ¢¥°¸¨­», ¨±¯®«¼§³¿ ² ª®¥ ­ ¡«¾¤¥­¨¥: ¥±«¨
¯®«­ ¿ ¢¥°¸¨­  ¨¬¥¥² ­¥¯®«­®£® °®¤¨²¥«¿, ²® ¥¥ ¬®¦­® ° §¤¥«¨²¼,
² ª ª ª ¢ °®¤¨²¥«¥ ¥±²¼ ¬¥±²® ¤«¿ ¤®¯®«­¨²¥«¼­®£® ª«¾· .  ª®­¶¥
ª®­¶®¢ ¬» ®ª §»¢ ¥¬±¿ ¢ ­¥¯®«­®¬ «¨±²¥, ª³¤  ¨ ¤®¡ ¢«¿¥¬ ­®¢»©
½«¥¬¥­².

±­®¢­»¥ ®¯¥° ¶¨¨ ± -¤¥°¥¢¼¿¬¨

391

¨±. 19.6. ®°¥­¼ r -¤¥°¥¢  (± t = 4) ¿¢«¿¥²±¿ ¯®«­®© ¢¥°¸¨­®©. ­
¤¥«¨²±¿ ­  ¤¢¥ ¯®«®¢¨­»; ¯°¨ ½²®¬ ±®§¤ ¥²±¿ ­®¢»© ª®°¥­¼ s, ¤¥²¼¬¨ ª®²®°®£® ±² ­®¢¿²±¿ ½²¨ ¢¥°¸¨­». ®¢»© ª®°¥­¼ s ±®¤¥°¦¨² ª«¾·-¬¥¤¨ ­³ ±² °®£®
ª®°­¿. »±®²  -¤¥°¥¢  ³¢¥«¨·¨« ±¼ ­  ¥¤¨­¨¶³.
¨±. 19.6

B-Tree-Insert (T; k)

1 r root[T ]
2 if n[r] = 2t ; 1
3
then s Allocate-Node()
4
root[T ] s
5
leaf[s] false
6
n[s] 0
7
c1[s] r
8
B-Tree-Split-Child(s; 1; r)
9
B-Tree-Insert-Nonfull (s; k)
10
else B-Tree-Insert-Nonfull (r; k)
²°®ª¨ 3{9 ®²­®±¿²±¿ ª ±«³· ¾ ¤®¡ ¢«¥­¨¿ ¢ ¤¥°¥¢® ± ¯®«­»¬
ª®°­¥¬ (¯°¨¬¥° ­  °¨±. 19.6). ¬¥­­® ¢ ½²®¬ ±«³· ¥ ³¢¥«¨·¨¢ ¥²±¿
¢»±®²  -¤¥°¥¢ . ²¬¥²¨¬, ·²® ²®·ª®© °®±²  -¤¥°¥¢  ¿¢«¿¥²±¿
ª®°¥­¼ (  ­¥ «¨±², ª ª ¢ ¤¢®¨·­»µ ¤¥°¥¢¼¿µ ¯®¨±ª ).
¤¥« ¢ ª®°¥­¼ ­¥¯®«­»¬ (¥±«¨ ®­ ­¥ ¡»« ² ª®¢»¬ ± ± ¬®£® ­ · « ), ¬» ¢»§»¢ ¥¬ ¯°®¶¥¤³°³ B-Tree-Insert-Nonfull(x; k), ª®²®° ¿ ¤®¡ ¢«¿¥² ½«¥¬¥­² k ¢ ¯®¤¤¥°¥¢® ± ª®°­¥¬ ¢ ­¥¯®«­®© ¢¥°¸¨­¥ x. ²  ¯°®¶¥¤³°  °¥ª³°±¨¢­® ¢»§»¢ ¥² ±¥¡¿, ¯°¨ ­¥®¡µ®¤¨¬®±²¨
(¥±«¨ ¢¥°¸¨­  ®ª § « ±¼ ¯®«­®©) ¢»¯®«­¨¢ ° §¤¥«¥­¨¥.

392

« ¢  19 -¤¥°¥¢¼¿

B-Tree-Insert-Nonfull (x; k)

1 i n[x]
2 if leaf[x]
3
then while i > 1 and k < keyi [x]
4
do keyi+1 [x] keyi [x]
5
i i;1
6
keyi+1 [x] k
7
n[x] n[x] + 1
8
Disk-Write(x)
9
else while i > 1 and k < keyi [x]
10
do i i ; 1
11
i i+1
12
Disk-Read(ci [x])
13
if n[ci [x]] = 2t ; 1
14
then B-Tree-Split-Child (x; i; ci[x])
15
if k > keyi [x]
16
then i i + 1
17
B-Tree-Insert-Nonfull (ci[x]; k)
²  ¯°®¶¥¤³°  ° ¡®² ¥² ±«¥¤³¾¹¨¬ ®¡° §®¬. ±«¨ ¢¥°¸¨­  x |
«¨±², ²® ª«¾· k ¢ ­¥£® ¤®¡ ¢«¿¥²±¿ (±²°®ª¨ 3{8; ­ ¯®¬­¨¬, ·²® ¢¥°¸¨­  x ¯°¥¤¯®« £ ¥²±¿ ­¥¯®«­®©).  ¯°®²¨¢­®¬ ±«³· ¥ ­ ¬ ­³¦­® ¤®¡ ¢¨²¼ k ª ¯®¤¤¥°¥¢³, ª®°¥­¼ ª®²®°®£® ¿¢«¿¥²±¿ °¥¡¥­ª®¬ x.
 ±²°®ª µ 9{11 ¬» ­ µ®¤¨¬ ­³¦­®£® °¥¡¥­ª  ¢¥°¸¨­» x. ±«¨
½²®² °¥¡¥­®ª ®ª §»¢ ¥²±¿ ¯®«­®© ¢¥°¸¨­®© (±²°®ª  13), ²® ¢ ±²°®ª¥ 14 ®­ ° §¤¥«¿¥²±¿ ­  ¤¢¥ ­¥¯®«­»µ ¢¥°¸¨­», ¨ ¢ ±²°®ª µ 15{16
®¯°¥¤¥«¿¥²±¿, ¢ ª ª®¥ ¨§ ­®¢»µ ¯®¤¤¥°¥¢¼¥¢ ±«¥¤³¥² ¤®¡ ¢¨²¼ k.
( ¬¥²¨¬, ·²® ¯®±«¥ ¨§¬¥­¥­¨¿ i ¢ ±²°®ª¥ 16 ­¥² ­¥®¡µ®¤¨¬®±²¨
®¡° ¹ ²¼±¿ ª ¤¨±ª³ | ¢­®¢¼ ±®§¤ ­­ ¿ ¢¥°¸¨­ , ª ª®²®°®© ¬»
®¡° ²¨¬±¿ ¢ ±²°®ª¥ 17, ³¦¥ ­ µ®¤¨²±¿ ¢ ®¯¥° ²¨¢­®© ¯ ¬¿²¨.)  ª¨¬ ®¡° §®¬, ¬» §­ ¥¬, ·²® ¢¥°¸¨­  ci [x] | ­¥¯®«­ ¿, ¨ ¢ ±²°®ª¥ 17
¤®¡ ¢«¿¥¬ ª«¾· k ¢ ±®®²¢¥²±²¢³¾¹¥¥ ¯®¤¤¥°¥¢® ± ¯®¬®¹¼¾ °¥ª³°±¨¢­®£® ¢»§®¢  ¯°®¶¥¤³°» B-Tree-Insert-Nonfull.   °¨±. 19.7
¯®ª § ­» ° §­»¥ ±«³· ¨ ¤®¡ ¢«¥­¨¿ ½«¥¬¥­²  ¢ -¤¥°¥¢®.
°®¶¥¤³°  B-Tree-Insert-Nonfull ¨±¯®«¼§³¥² O(1) ®¯¥° ¶¨©
Disk-Read ¨ Disk-Write (¥±«¨ ­¥ ±·¨² ²¼ °¥ª³°±¨¢­®£® ¢»§®¢ ). «¥¤®¢ ²¥«¼­®, ¤«¿ -¤¥°¥¢  ¢»±®²» h ¯°®¶¥¤³°  B-TreeInsert ®¡° ¹ ¥²±¿ ª ¤¨±ª³ O(h) ° §. °¥¬¿ ¢»·¨±«¥­¨© ¥±²¼
O(th) = O(t logt h).  ¯°®¶¥¤³°¥ B-Tree-Insert-Nonfull °¥ª³°±¨¢­»© ¢»§®¢ ¿¢«¿¥²±¿ ¯®±«¥¤­¨¬ ®¯¥° ²®°®¬ (tail recursion), ¨ ¯®½²®¬³ ¬» ¬®£«¨ ¡» § ¬¥­¨²¼ °¥ª³°±¨¾ ¶¨ª«®¬. ²±¾¤  ¢¨¤­®, ·²®
·¨±«® ±¥ª²®°®¢, ª®²®°»¥ ­¥®¡µ®¤¨¬® ¤¥°¦ ²¼ ¢ ®¯¥° ²¨¢­®© ¯ ¬¿²¨, ¥±²¼ O(1).

±­®¢­»¥ ®¯¥° ¶¨¨ ± -¤¥°¥¢¼¿¬¨

393

®¡ ¢«¥­¨¥ ½«¥¬¥­²  ¢ -¤¥°¥¢®, ¤«¿ ª®²®°®£® t = 3, (¢¥°¸¨­  ±®¤¥°¦¨² ¤® 5 ª«¾·¥©). ¢¥²«»¥ ¢¥°¸¨­» ¡»«¨ ¨§¬¥­¥­» ¯°¨ ¤®¡ ¢«¥­¨¨. ( )
 · «¼­®¥ ¤¥°¥¢®. (¡) ®¡ ¢¨«¨ ¡³ª¢³ B (¢ ­¥¯®«­»© «¨±²). (¢) ®¡ ¢«¥­¨¥ Q
¯°¨¢®¤¨² ª ° §¤¥«³ ¢¥°¸¨­» RSTUV ­  RS ¨ UV , ¡³ª¢  T ¯¥°¥¸«  ¢ ª®°¥­¼,
¯®±«¥ ·¥£® ¡³ª¢³ Q ¤®¡ ¢¨«¨ ª ¢¥°¸¨­¥ RS . (£)  ¯°¥¤»¤³¹¥¥ ¤¥°¥¢® ¤®¡ ¢¨«¨ L: ª®°¥­¼ ¡»« ¯®«­®© ¢¥°¸¨­®©, ¯®½²®¬³ ¥£® ¯°¨¸«®±¼ ° §¤¥«¨²¼ ­  ¤¢¥ ¨
¢»±®²  ¤¥°¥¢  ³¢¥«¨·¨« ±¼ ­  ¥¤¨­¨¶³. ³ª¢³ L ¢±² ¢¨«¨ ¢ «¨±² JK . (¤)  ¯°¥¤»¤³¹¥¥ ¤¥°¥¢® ¤®¡ ¢¨«¨ F . ¥°¸¨­³ ABCDE ° §¤¥«¨«¨ ­  ¤¢¥ ¨ ¢ ¯®«®¢¨­ª³
DE ¤®¡ ¢¨«¨ F .
¨±. 19.7

394

« ¢  19 -¤¥°¥¢¼¿

¯° ¦­¥­¨¿
19.2-1

°®±«¥¤¨²¼, §  ¤®¡ ¢«¥­¨¥¬ ¢ ¯³±²®¥ -¤¥°¥¢® ½«¥¬¥­²®¢

F; S; Q; K; C; L; H; T; V; W; M; R; N; P; A; B; X; Y; D; Z; E
¢ ³ª § ­­®¬ ¯®°¿¤ª¥ (­ °¨±®¢ ²¼ ²®«¼ª® ±®±²®¿­¨¿ ¤¥°¥¢  ¯¥°¥¤
° §¤¥«¥­¨¥¬ ª ª®©-²® ¨§ ¢¥°¸¨­,   ² ª¦¥ ¯®±«¥¤­¥¥ ±®±²®¿­¨¥)
19.2-2 »¿±­¨²¼, ¨±¯®«­¿¾²±¿ «¨ «¨¸­¨¥ ®¯¥° ¶¨¨ Disk-Read
¨«¨ Disk-Write ¯°¨ ¢»§®¢¥ ¯°®¶¥¤³°» B-Tree-Insert. (¨¸­¿¿
®¯¥° ¶¨¿ Disk-Read ·¨² ¥² ±¥ª²®°, ³¦¥ § £°³¦¥­­»© ¢ ®¯¥° ²¨¢­³¾ ¯ ¬¿²¼. ¨¸­¿¿ ®¯¥° ¶¨¿ Disk-Write ±®µ° ­¿¥² ­  ¤¨±ª¥ ­¥
¨§¬¥­¨¢¸¨©±¿ ±¥ª²®°.)
19.2-3  ª ­ ©²¨ ¬¨­¨¬ «¼­»© ½«¥¬¥­² ¢ -¤¥°¥¢¥?  ª ­ ©²¨
½«¥¬¥­² -¤¥°¥¢ , ¯°¥¤¸¥±²¢³¾¹¨© ¤ ­­®¬³ ½«¥¬¥­²³?
19.2-4? «¾·¨ 1; 2; : : :; n ¤®¡ ¢«¿¾² ¯® ®¤­®¬³ ¢ ¯³±²®¥ -¤¥°¥¢®
¬¨­¨¬ «¼­®© ±²¥¯¥­¨ 2. ª®«¼ª® ¢¥°¸¨­ ³ ¯®«³·¥­­®£® -¤¥°¥¢ ?
19.2-5  ª ª ª ³ «¨±²¼¥¢ ­¥² ³ª § ²¥«¥© ­  ¤¥²¥©, ²® ¢ ­¨µ ¬®¦¥² ¯®¬¥±²¨²¼±¿ ¡®«¼¸¥ ª«¾·¥©, ·¥¬ ¢® ¢­³²°¥­­¨¥ ¢¥°¸¨­».  ª
¡³¤³² ¢»£«¿¤¥²¼ ¯°®¶¥¤³°» ±®§¤ ­¨¿ -¤¥°¥¢  ¨ ¤®¡ ¢«¥­¨¿ ¢ ­¥£®
½«¥¬¥­² , ¨±¯®«¼§³¾¹¨¥ ½²® ®¡±²®¿²¥«¼±²¢®?
19.2-6  ¬¥­¨¬ ¢ ¯°®¶¥¤³°¥ B-Tree-Search «¨­¥©­»© ¯®¨±ª ¤¢®¨·­»¬. ®ª § ²¼, ·²® ²®£¤  ¢°¥¬¿ ¢»·¨±«¥­¨© ¤«¿ ½²®© ¯°®¶¥¤³°»
±² ­¥² ° ¢­»¬ O(log n) (ª®­±² ­²  ­¥ § ¢¨±¨² ®² t!).
19.2-7 °¥¤¯®«®¦¨¬, ·²® ¬» ¬®¦¥¬ ± ¬¨ ¢»¡° ²¼ ° §¬¥° ±¥ª²®° , ¯°¨·¥¬ ¢°¥¬¿ ·²¥­¨¿ ±¥ª²®° , ¢¬¥¹ ¾¹¥£® ¢¥°¸¨­³ -¤¥°¥¢ 
±²¥¯¥­¨ t, ¡³¤¥² a + bt, £¤¥ a ¨ b | ­¥ª®²®°»¥ ª®­±² ­²».  ª ±«¥¤³¥² ¢»¡° ²¼ t, ·²®¡» ³¬¥­¼¸¨²¼ ¢°¥¬¿ ¯®¨±ª  ¢ -¤¥°¥¢¥? ¶¥­¨²¥
®¯²¨¬ «¼­®¥ §­ ·¥­¨¥ t ¢ ±«³· ¥ a = 30 ¬¨««¨±¥ª³­¤, b = 40 ¬¨ª°®±¥ª³­¤.

19.3. ¤ «¥­¨¥ ½«¥¬¥­²  ¨§ -¤¥°¥¢ 
¤ «¥­¨¥ ½«¥¬¥­²  ¨§ -¤¥°¥¢  (¯°®¶¥¤³°  B-Tree-Delete)
¯°®¨±µ®¤¨²  ­ «®£¨·­® ¤®¡ ¢«¥­¨¾, µ®²¿ ­¥¬­®£® ±«®¦­¥¥. » ­¥
¡³¤¥¬ ¯°¨¢®¤¨²¼ ¯°®¶¥¤³°³ ³¤ «¥­¨¿ ¯®«­®±²¼¾,   ®¡º¿±­¨¬, ª ª
®­  ° ¡®² ¥².
³±²¼ ­³¦­® ³¤ «¨²¼ ª«¾· k ¨§ ¯®¤¤¥°¥¢  ± ª®°­¥¬ ¢ ¢¥°¸¨­¥ x.  ¸  ¯°®¶¥¤³°  ¡³¤¥² ³±²°®¥­  ² ª, ·²® ¯°¨ ª ¦¤®¬ ¥¥ °¥ª³°±¨¢­®¬ ¢»§®¢¥ ¢¥°¸¨­  x ±®¤¥°¦¨² ¯® ¬¥­¼¸¥© ¬¥°¥ t ª«¾·¥©,

¤ «¥­¨¥ ½«¥¬¥­²  ¨§ -¤¥°¥¢ 

395

£¤¥ t | ¬¨­¨¬ «¼­ ¿ ±²¥¯¥­¼ -¤¥°¥¢ . ® ¯° ¢¨« ¬ ¢¥°¸¨­  ¤¥°¥¢  ¤®«¦­  ±®¤¥°¦ ²¼ ­¥ ¬¥­¼¸¥ t ; 1 ª«¾· , ² ª ·²® ¢ ­ ¸¥¬
±«³· ¥ ¨¬¥¥²±¿ § ¯ ±­®© ª«¾·. ²®² ¯°¨¥¬ (±«¥¤¨²¼, ·²®¡» § ¯ ±­®© ª«¾· ¢±¥£¤  ¡»«) ¯®§¢®«¿¥² ³¤ «¨²¼ ½«¥¬¥­², ¯°®©¤¿ -¤¥°¥¢®
®¤¨­ ° § ®² ª®°­¿ ª «¨±²³ ¨ ­¥ ¤¥« ¿ ¸ £®¢ ¢ ®¡° ²­®¬ ­ ¯° ¢«¥­¨¨ (± ¥¤¨­±²¢¥­­»¬ ¨±ª«¾·¥­¨¥¬, ª®²®°®¥ ¬» ¥£® ° §¡¥°¥¬
¯®§¦¥).
®£®¢®°¨¬±¿, ·²® ¥±«¨ ¢ °¥§³«¼² ²¥ ³¤ «¥­¨¿ ª®°¥­¼ ¤¥°¥¢  ±² «
¯³±²»¬, ²® ®­ ³¤ «¿¥²±¿, ¨ ¥£® ¥¤¨­±²¢¥­­»© °¥¡¥­®ª ±² ­®¢¨²±¿
­®¢»¬ ª®°­¥¬, ¯°¨ ½²®¬ ¢»±®²  -¤¥°¥¢  ³¬¥­¼¸ ¥²±¿ ­  ¥¤¨­¨¶³,
¨ ª®°¥­¼ ³¦¥ ­¥ ¯³±² (¥±«¨ ²®«¼ª® ¢±¥ ¤¥°¥¢® ­¥ ¯³±²®).
  °¨±. 19.8 ¯®ª § ­» ° §­»¥ ±«³· ¨ ³¤ «¥­¨¿ ½«¥¬¥­²  ¨§ ¤¥°¥¢ .
1. ±«¨ ª«¾· k ­ µ®¤¨²±¿ ¢ ¢¥°¸¨­¥ x, ¿¢«¿¾¹¥©±¿ «¨±²®¬, ²®
³¤ «¿¥¬ k ¨§ x.
2. c«¨ ª«¾· k ­ µ®¤¨²±¿ ¢® ¢­³²°¥­­¥© ¢¥°¸¨­¥ x, ²® ¤¥« ¥¬
±«¥¤³¾¹¥¥:
 ). ±«¨ °¥¡¥­®ª y ¢¥°¸¨­» x, ¯°¥¤¸¥±²¢³¾¹¨© k, ±®¤¥°¦¨²
­¥ ¬¥­¥¥ t ½«¥¬¥­²®¢, ²® ­ µ®¤¨¬ ª«¾· k0, ­¥¯®±°¥¤±²¢¥­­® ¯°¥¤¸¥±²¢³¾¹¨© ª«¾·³ k. ²®² ª«¾· ­ µ®¤¨²±¿ ¢ «¨±²¥
¯®¤¤¥°¥¢  ± ª®°­¥¬ ¢ y .  ©²¨ ¥£® ¬®¦­® §  ®¤¨­ ¯°®±¬®²°
¯®¤¤¥°¥¢  ®² ª®°­¿ ª «¨±²³. ¥ª³°±¨¢­® ¢»§»¢ ¥¬ ¯°®¶¥¤³°³: ³¤ «¿¥¬ k0 .  ¬¥­¿¥¬ ¢ x ª«¾· k ­  k0.
¡). ±«¨ °¥¡¥­®ª z , ±«¥¤³¾¹¨© §  k, ±®¤¥°¦¨² ­¥ ¬¥­¥¥ t ½«¥¬¥­²®¢, ¯®±²³¯ ¥¬  ­ «®£¨·­®.
¢). ±«¨ ¨ y , ¨ z ±®¤¥°¦ ² ¯® t ; 1 ½«¥¬¥­²³, ±®¥¤¨­¿¥¬ ¢¥°¸¨­³ y , ª«¾· k, ¢¥°¸¨­³ z , ¯®¬¥¹ ¿ ¢±¥ ½²® ¢ ¢¥°¸¨­³ y ,
ª®²®° ¿ ²¥¯¥°¼ ±®¤¥°¦¨² 2t ; 1 ª«¾·. ²¨° ¥¬ z ¨ ¢»ª¨¤»¢ ¥¬ ¨§ x ª«¾· k ¨ ³ª § ²¥«¼ ­  z . ¥ª³°±¨¢­® ³¤ «¿¥¬ k
¨§ y .
3. ±«¨ x | ¢­³²°¥­­¿¿ ¢¥°¸¨­ , ­® ª«¾·  k ¢ ­¥© ­¥², ­ ©¤¥¬
±°¥¤¨ ¤¥²¥© ¢¥°¸¨­» x ª®°¥­¼ ci[x] ¯®¤¤¥°¥¢ , £¤¥ ¤®«¦¥­ «¥¦ ²¼ ª«¾· k (¥±«¨ ½²®² ª«¾· ¢®®¡¹¥ ¥±²¼). ±«¨ ci [x] ±®¤¥°¦¨²
­¥ ¬¥­¥¥ t ª«¾·¥©, ¬®¦­® °¥ª³°±¨¢­® ³¤ «¨²¼ k ¨§ ¯®¤¤¥°¥¢ .
±«¨ ¦¥ ci [x] ±®¤¥°¦¨² ¢±¥£® t ; 1 ½«¥¬¥­², ²® ¯°¥¤¢ °¨²¥«¼­®
±¤¥« ¥¬ ¸ £ 3  ¨«¨ 3¡.
 ). ³±²¼ ¢¥°¸¨­  ci [x] ±®¤¥°¦¨² t ; 1 ½«¥¬¥­², ­® ®¤¨­ ¨§
¥¥ ±®±¥¤¥© (­ ¯°¨¬¥°, ¯° ¢»©) ±®¤¥°¦¨² ¯® ª° ©­¥© ¬¥°¥ t ½«¥¬¥­²®¢. (¤¥±¼ ±®±¥¤®¬ ¬» ­ §»¢ ¥¬ ² ª®£® °¥¡¥­ª 
¢¥°¸¨­» x, ª®²®°»© ®²¤¥«¥­ ®² ci [x] °®¢­® ®¤­¨¬ ª«¾·®¬° §¤¥«¨²¥«¥¬.) ®£¤  ¤®¡ ¢¨¬ °¥¡¥­ª³ ci [x] ½«¥¬¥­² ¥£® °®¤¨²¥«¿ x,   °®¤¨²¥«¾ ¯¥°¥¤ ¤¨¬ «¥¢»© ½«¥¬¥­² ½²®£® ±®±¥¤ .
°¨ ½²®¬ ± ¬»© «¥¢»© °¥¡¥­®ª ±®±¥¤  ±² ­¥² ± ¬»¬ ¯° ¢»¬
°¥¡¥­ª®¬ ¢¥°¸¨­» ci [x].

396

« ¢  19 -¤¥°¥¢¼¿

­ · «¼­®¥ ¤¥°¥¢®
F ³¤ «¥­ : ±«³· © 1
M ³¤ «¥­ : ±«³· © 2 
G ³¤ «¥­ : ±«³· © 2¡

¨±. 19.8 ¤ «¥­¨¥ ½«¥¬¥­²  ¨§ -¤¥°¥¢ . «¿ ½²®£® -¤¥°¥¢  ¬¨­¨¬ «¼­ ¿
±²¥¯¥­¼ ° ¢­  3, ². ¥. ¢¥°¸¨­  ±®¤¥°¦¨² ­¥ ¬¥­¥¥ 2 ½«¥¬¥­²®¢. ¢¥²«»¥ ¢¥°¸¨­» ¡»«¨ ¨§¬¥­¥­» ¯°¨ ³¤ «¥­¨¨. ( ) -¤¥°¥¢® °¨±³­ª  19.7 (e). (¡) «³· © 1: ³¤ «¥­¨¥ ¡³ª¢» F ¨§ «¨±² . (¢) ¤ «¥­¨¥ ¡³ª¢» M . ²® ±«³· © 2 :
¡³ª¢ -¯°¥¤¸¥±²¢¥­­¨¶  L ¯¥°¥¸«  ­  ¥¥ ¬¥±²®. (£) ¤ «¥­¨¥ ¡³ª¢» G. ²®
±«³· © 2¢: ±­ · «  G ®²¯° ¢¨«¨ ¢­¨§, £¤¥ ®¡° §®¢ «±¿ «¨±² DEGJK , ¨§ ª®²®°®£® G ¨ ³¤ «¨«¨ (±«³· © 1). (¤) ¤ «¥­¨¥ ¡³ª¢» D. ²® ±«³· © 3¡: ¬» ­¥
¬®¦¥¬ °¥ª³°±¨¢­® ®¡° ¡®² ²¼ ¢¥°¸¨­³ CL, ¢ ª®²®°®© ¢±¥£® ¤¢  ½«¥¬¥­² , ¯®½²®¬³ ±¯³±ª ¥¬ ¢­¨§ P ¨ ¯®«³· ¥¬ ¢¥°¸¨­³ CLPTX . ®±«¥ ½²®£® ³¤ «¿¥¬ D
¨§ «¨±²  (±«³· © 1). (e0 ) ®±«¥ ³¤ «¥­¨¿ D ª®°¥­¼ ±² « ¯³±²»¬ ¨ ¬» ³¤ «¨«¨
¥£®. »±®²  ¤¥°¥¢  ³¬¥­¼¸¨« ±¼ ­  ¥¤¨­¨¶³. (¥) ¤ «¨«¨ B . ²® ±«³· © 3 :
C ±¯³±²¨«¨ ­  ¬¥±²® B ,   E ¯®¤­¿«¨ ­  ¬¥±²® C .

 ¤ ·¨ ª £« ¢¥ 19

397

D ³¤ «¥­ : ±«³· © 3¡

³¬¥­¼¸¥­¨¥ ¢»±®²» ¤¥°¥¢ 
B ³¤ «¥­ : ±«³· © 3 

³±²¼ ®¡  ±®±¥¤  ¢¥°¸¨­» ci [x] ±®¤¥°¦ ² ¯® t ; 1 ½«¥¬¥­²³.
®£¤  ®¡º¥¤¨­¨¬ ¢¥°¸¨­³ ci [x] ± ®¤­¨¬ ¨§ ±®±¥¤¥© (ª ª ¢
±«³· ¥ 2¢). °¨ ½²®¬ ª«¾·, ° §¤¥«¿¢¸¨© ¨µ ¢ ¢¥°¸¨­¥ x,
±² ­¥² ª«¾·®¬-¬¥¤¨ ­®© ­®¢®© ¢¥°¸¨­».
¯¨± ­­ ¿ ¯°®¶¥¤³°  ²°¥¡³¥² ¡®«¥¥ ®¤­®£® ¯°®µ®¤  ²®«¼ª® ¢
±«³· ¿µ 2  ¨ 2¡ (ª®£¤  ®­  § ¬¥­¿¥² ³¤ «¿¥¬»© ½«¥¬¥­² ¥£® ¯°¥¤¸¥±²¢¥­­¨ª®¬ ¨«¨ ¯®±«¥¤®¢ ²¥«¥¬).  ¬¥²¨¬, ·²® ½²® ¯°®¨±µ®¤¨²,
²®«¼ª® ¥±«¨ ²°¥¡³¥²±¿ ³¤ «¨²¼ ½«¥¬¥­² ¨§ ¢­³²°¥­­¥© ¢¥°¸¨­».
®«¼¸¨­±²¢® ¢¥°¸¨­ -¤¥°¥¢  | «¨±²¼¿, ² ª ·²® ½²¨ ±«³· ¨ ¡³¤³² °¥¤ª¨¬¨.
®²¿ ¯°®¶¥¤³°  ¢»£«¿¤¨² § ¯³² ­­®, ®­  ²°¥¡³¥² ¢±¥£® O(h)
®¡° ¹¥­¨© ª ¤¨±ª³ ¤«¿ -¤¥°¥¢  ¢»±®²» h. (¥¦¤³ ¤¢³¬¿ °¥ª³°±¨¢­»¬¨ ¢»§®¢ ¬¨ ¢»¯®«­¿¥²±¿ O(1) ª®¬ ­¤ Disk-Read ¨ DiskWrite). »·¨±«¥­¨¿ ²°¥¡³¾² ¢°¥¬¥­¨ O(th) = O(t logt h).
¡).

¯° ¦­¥­¨¿
19.3-1 ®ª § ²¼ °¥§³«¼² ² ³¤ «¥­¨¿ ¢¥°¸¨­ C , P ¨ V (¢ ³ª § ­­®¬ ¯®°¿¤ª¥) ¨§ ¤¥°¥¢  °¨±. 19.8 (f).
19.3-2

 ¯¨± ²¼ ¯°®¶¥¤³°³ B-Tree-Delete.

 ¤ ·¨
19-1 ²¥ª¨ ­  ¤¨±ª¥
°¥¤±² ¢¨¬ ±¥¡¥, ·²® ¬» µ®²¨¬ °¥ «¨§®¢ ²¼ ±²¥ª ­  ¬ ¸¨­¥ ±
­¥¡®«¼¸®© ®¯¥° ²¨¢­®© ¯ ¬¿²¼¾ ¨ ¡®«¼¸¨¬ ¦¥±²ª¨¬ ¤¨±ª®¬ (±²¥ª

398

« ¢  19 -¤¥°¥¢¼¿

­¥ ¯®¬¥¹ ¥²±¿ ¢ ®¯¥° ²¨¢­³¾ ¯ ¬¿²¼, ¨ ¤®«¦¥­ ¯® ¡®«¼¸¥© · ±²¨
µ° ­¨²¼±¿ ­  ¤¨±ª¥).
°¨ ¯°®±²¥©¸¥© (­® ­¥½´´¥ª²¨¢­®©) °¥ «¨§ ¶¨¨ ±²¥ª  ­  ¤¨±ª¥
µ° ­¨²±¿ ¢±¥, ª°®¬¥ ¯¥°¥¬¥­­®© p (³ª § ²¥«¼ ±²¥ª ), ª®²®° ¿ ®¯°¥¤¥«¿¥² ¬¥±²® ¢¥°¸¨­» ±²¥ª  ­  ¤¨±ª¥ ² ª¨¬ ®¡° §®¬: ¢¥°¸¨­®©
¡³¤¥² (p mod m)-»© ½«¥¬¥­² bp=mc-£® ±¥ª²®°  ¤¨±ª  (m | ° §¬¥°
±¥ª²®° ).
²®¡» ¤®¡ ¢¨²¼ ½«¥¬¥­² ¢ ±²¥ª, ¬» ·¨² ¥¬ ±®®²¢¥²±²¢³¾¹¨©
±¥ª²®°, ­  ­³¦­®¥ ¬¥±²® ¯®¬¥¹ ¥¬ ­®¢»© ½«¥¬¥­², ³¢¥«¨·¨¢ ¥¬
§­ ·¥­¨¿ ³ª § ²¥«¿ ­  ¥¤¨­¨¶³ ¨ ±­®¢  § ¯¨±»¢ ¥¬ ±¥ª²®° ­  ¤¨±ª.
­ «®£¨·­® °¥ «¨§³¥²±¿ ®¯¥° ¶¨¿ ³¤ «¥­¨¿ ½«¥¬¥­²  ¨§ ±²¥ª . (»
·¨² ¥¬ ±¥ª²®° ± ¤¨±ª  ¨ ³¬¥­¼¸ ¥¬ ­  ¥¤¨­¨¶³ §­ ·¥­¨¥ ³ª § ²¥«¿.
 ª ª ª ±¥ª²®° ­¥ ¬¥­¿«±¿, ²® § ¯¨±»¢ ²¼ ¥£® ­  ¤¨±ª ­¥ ­³¦­®.)
³¤¥¬ ³·¨²»¢ ²¼ ª®«¨·¥±²¢® ®¡° ¹¥­¨© ª ¤¨±ª³,   ² ª¦¥ ¢°¥¬¿ ¢»·¨±«¥­¨©, ¯°¨ ¯®¤±·¥²¥ ª®²®°®£® ª ¦¤®¥ ®¡° ¹¥­¨¥ ª ¤¨±ª³
±·¨² ¥²±¿ ²°¥¡³¾¹¨¬ (m) ¥¤¨­¨¶ ¢°¥¬¥­¨.
 . ª®«¼ª® ®¡° ¹¥­¨© ª ¤¨±ª³ ²°¥¡³¥²±¿ ¢ µ³¤¸¥¬ ±«³· ¥ ¤«¿ n
®¯¥° ¶¨© ±® ±²¥ª®¬ ¯°¨ ½²®© °¥ «¨§ ¶¨¨? ¥¬³ ° ¢­® ®¡¹¥¥
¢°¥¬¿? (¤¥±¼ ¨ ¤ «¥¥ ²°¥¡³¥²±¿ ®²¢¥² ¢ ²¥°¬¨­ µ m ¨ n.)
 ±±¬®²°¨¬ ¤°³£³¾ °¥ «¨§ ¶¨¾ ±²¥ª , ¯°¨ ª®²®°®© ®¤¨­ ±¥ª²®°
¶¥«¨ª®¬ µ° ­¨²±¿ ¢ ¯ ¬¿²¨. (°®¬¥ ²®£®, ­ ¬ ²°¥¡³¥²±¿ ¯®¬­¨²¼
­®¬¥° µ° ­¨¬®£® ±¥ª²®° .) ® ¬¥°¥ ­¥®¡µ®¤¨¬®±²¨ ¬» ¡³¤¥¬ ¢®§¢° ¹ ²¼ ½²®² ±¥ª²®° ­  ¤¨±ª ¨ ±·¨²»¢ ²¼ ­®¢»©. ±«¨ ­³¦­»©
±¥ª²®° ³¦¥ ­ µ®¤¨²±¿ ¢ ¯ ¬¿²¨, ²® ®¡° ¹ ²¼±¿ ª ¤¨±ª³ ­¥ ­³¦­®.
¡. ª®«¼ª® ®¡° ¹¥­¨© ª ¤¨±ª³ ²°¥¡³¥²±¿ ¤«¿ ¤®¡ ¢«¥­¨¿ n ½«¥¬¥­²®¢ ¢ ±²¥ª (¢ µ³¤¸¥¬ ±«³· ¥)? ¥¬³ ° ¢­® ¢°¥¬¿ ¢»·¨±«¥­¨©?
¢. ª®«¼ª® ®¡° ¹¥­¨© ª ¤¨±ª³ ²°¥¡³¥²±¿ ¢ µ³¤¸¥¬ ±«³· ¥ ¤«¿
n ®¯¥° ¶¨© ±® ±²¥ª®¬? ¥¬³ ° ¢­® ¢°¥¬¿ ¢»·¨±«¥­¨©?
³¹¥±²¢³¥² ¡®«¥¥ ½´´¥ª²¨¢­ ¿ °¥ «¨§ ¶¨¿, ¯°¨ ª®²®°®© ¢ ®¯¥° ²¨¢­®© ¯ ¬¿²¨ µ° ­¿²±¿ ¤¢  ±¥ª²®°  (¨ ¥¹¥ ­¥±ª®«¼ª® ·¨±¥«).
£.  ª ±¤¥« ²¼ ² ª, ·²®¡» ª ¦¤ ¿ ®¯¥° ¶¨¿ ²°¥¡®¢ «  (¯°¨  ¬®°²¨§ ¶¨®­­®¬  ­ «¨§¥) O(1=m) ®¡° ¹¥­¨© ª ¤¨±ª³ ¨ ¢°¥¬¥­¨ O(1)?
19-2 ¡º¥¤¨­¥­¨¥ ¨ ° §¤¥«¥­¨¥ 2-3-4 ¤¥°¥¢¼¥¢
¯¥° ¶¨¿ ®¡º¥¤¨­¥­¨¿ (join) ¯®«³· ¥² ­  ¢µ®¤¥ ¤¢  ¬­®¦¥±²¢ 
S 0 ¨ S 00 ¨ ½«¥¬¥­² x, ¤«¿ ª®²®°»µ key[x0] < key[x] < key[x00 ] ¯°¨
¢±¥µ x0 2 S 0 ¨ x00 2 S 00 . ¥ °¥§³«¼² ²®¬ ¿¢«¿¥²±¿ ¬­®¦¥±²¢®
S = S 0 [ fxg [ S 00.  §¤¥«¥­¨¥ (split) | ®¯¥° ¶¨¿, ®¡° ²­ ¿ ®¡º¥¤¨­¥­¨¾. ­  ¯®«³· ¥² ­  ¢µ®¤¥ ¬­®¦¥±²¢® S ¨ ½«¥¬¥­² x 2 S ¨
±®§¤ ¥² ¤¢  ¤°³£¨µ ¬­®¦¥±²¢  S 0 ¨ S 00 , ±®±²®¿¹¨µ ±®®²¢¥²±²¢¥­­®
¨§ ¬¥­¼¸¨µ ¨ ¨§ ¡®«¼¸¨µ x ½«¥¬¥­²®¢ ¬­®¦¥±²¢  S .  ½²®© § ¤ ·¥
²°¥¡³¥²±¿ °¥ «¨§®¢ ²¼ ½²¨ ®¯¥° ¶¨¨ ¤«¿ 2-3-4 ¤¥°¥¢¼¥¢. «¿ ³¤®¡±²¢  ¡³¤¥¬ ±·¨² ²¼, ·²® ½«¥¬¥­²» ±®±²®¿² ²®«¼ª® ¨§ ª«¾·¥©, ¨ ¢±¥

 ¬¥· ­¨¿ ª £« ¢¥ 19

399

ª«¾·¨ ° §«¨·­».
 . ³¤¥¬ µ° ­¨²¼ ¢ ª ¦¤®© ¢¥°¸¨­¥ x 2-3-4 ¤¥°¥¢  ¯®«¥ height[x],
µ° ­¿¹¥¥ ¢»±®²³ ¯®¤¤¥°¥¢  ± ª®°­¥¬ ¢ x. ®ª § ²¼, ·²® ½²³ ¨­´®°¬ ¶¨¾ ¬®¦­® ¯®¤¤¥°¦¨¢ ²¼, ­¥ ³µ³¤¸ ¿  ±¨¬¯²®²¨ª³ ¢°¥¬¥­¨ ¯®¨±ª , ¤®¡ ¢«¥­¨¿ ¨ ³¤ «¥­¨¿.
¡. ¥ «¨§®¢ ²¼ ®¯¥° ¶¨¾ ®¡º¥¤¨­¥­¨¿ ¤¥°¥¢¼¥¢ T 0 ¨ T 00, ° §¤¥«¥­­»µ ª«¾·®¬ k. °¥¬¿ ° ¡®²» ¤®«¦­® ¡»²¼ O(jh0 ; h00 j),
£¤¥ h0 ; h00 | ¢»±®²» ¤¥°¥¢¼¥¢.
¢. ³±²¼ p | ¯³²¼ ¢ 2-3-4 ¤¥°¥¢¥ T ®² ª®°­¿ ª § ¤ ­­®¬³
ª«¾·³ k.  ±±¬®²°¨¬ ¤¢  ¬­®¦¥±²¢  ª«¾·¥© ¨§ T : ¬¥­¼¸¨¥ k
(¬­®¦¥±²¢® S 0) ¨ ¡®«¼¸¨¥ k (¬­®¦¥±²¢® S 00 ). ®ª § ²¼, ·²®
S 0 ° §¡¨¢ ¥²±¿ ­  ¤¥°¥¢¼¿ T00 ; T10 ; : : :; Tm0 , ° §¤¥«¥­­»¥ ª«¾· ¬¨
k10 ; k20 ; : : :; km0 (¤«¿ ¢±¥µ y 2 Ti0;1 ¨ z 2 Ti0 ¢»¯®«­¥­® y < ki0 < z
¯°¨ i = 1; 2; : : :; m.  ª ±¢¿§ ­» ¢»±®²» ¤¥°¥¢¼¥¢ Ti0;1 ¨ Ti0?  
ª ª¨¥ · ±²¨ ¯³²¼ p ¤¥«¨² S 00 ?
£. ¥ «¨§®¢ ²¼ ®¯¥° ¶¨¾ ° §¤¥«¥­¨¿. «¿ ½²®£® ±«¥¤³¥² ®¡º¥¤¨­¨²¼ ª«¾·¨ ¨§ S 0 ¢ 2-3-4 ¤¥°¥¢® T 0 ¨ ª«¾·¨ ¨§ S 00 ¢ ¤¥°¥¢® T 00 .
«¿ ¤¥°¥¢  ± n ª«¾· ¬¨ ¢°¥¬¿ ° ¡®²» ½²®© ®¯¥° ¶¨¨ ¤®«¦­®
¡»²¼ O(log n). (ª § ­¨¥: ¯°¨ ±«®¦¥­¨¨ ±²®¨¬®±²¥© ®¯¥° ¶¨©
®¡º¥¤¨­¥­¨¿ ¯°®¨±µ®¤¨² ±®ª° ¹¥­¨¥.)

 ¬¥· ­¨¿
¡ « ­±¨°®¢ ­­»¥ ¤¥°¥¢¼¿ ¨ -¤¥°¥¢¼¥¢ ®¡±³¦¤ ¾²±¿ ¢
­³² [123], µ®, ®¯ª°®´² ¨ «¼¬ ­ [4] ¨ ¥¤¦¢¨ª [175]. ®¤°®¡­»© ®¡§®° -¤¥°¥¢¼¥¢ ¤ ­ ¢ ®¬¥° [48]. ¨¡ ± ¨ ¥¤¦¢¨ª [93]
° ±±¬®²°¥«¨ ¢§ ¨¬®±¢¿§¨ ¬¥¦¤³ ° §­»¬¨ ¢¨¤ ¬¨ ±¡ « ­±¨°®¢ ­­»µ ¤¥°¥¢¼¥¢, ¢ª«¾· ¿ ª° ±­®-·¥°­»¥ ¨ 2-3-4 ¤¥°¥¢¼¿.
 1970 £®¤³ ®¯ª°®´² (J. E. Hopcroft) ¯°¥¤«®¦¨« ¯®­¿²¨¥ 2-3
¤¥°¥¢¼¥¢, ª®²®°»¥ ¿¢¨«¨±¼ ¯°¥¤¸¥±²¢¥­­¨ª ¬¨ -¤¥°¥¢¼¥¢ ¨ 2-34 ¤¥°¥¢¼¥¢.  ½²¨µ ¤¥°¥¢¼¿µ ª ¦¤ ¿ ¢­³²°¥­­¿¿ ¢¥°¸¨­  ¨¬¥¥² 2
¨«¨ 3 ¤¥²¥©. -¤¥°¥¢¼¿ ¡»«¨ ®¯°¥¤¥«¥­»  ©¥°®¬ ¨  ª°¥©²®¬
¢ 1972 £®¤³ [18].  ¨µ ° ¡®²¥ ­¥ ®¡º¿±­¥­ ¢»¡®° ­ §¢ ­¨¿.

µ° ­¨²¼
µ° ­¿¹¥¥
|
½²®
­¥¯«®µ®!

20

¨­®¬¨ «¼­»¥ ª³·¨

 ½²®© £« ¢¥ ¨ ¢ £« ¢¥ 21 ° ±±¬ ²°¨¢ ¾²±¿ ±²°³ª²³°» ¤ ­­»µ,
¨§¢¥±²­»¥ ª ª ±«¨¢ ¥¬»¥ ª³·¨ (mergeable heaps).  ª ¿ ±²°³ª²³°  µ° ­¨² ­¥±ª®«¼ª® ¬­®¦¥±²¢ (ª³·), ½«¥¬¥­²» ª®²®°»µ ­ §»¢ ¾²
¢¥°¸¨­ ¬¨.  ¦¤ ¿ ¢¥°¸¨­  ±®¤¥°¦¨² ¯®«¥ key (ª«¾·), ¢ ª®²®°®¬
µ° ­¨²±¿ ­¥ª®²®°®¥ ·¨±«®; ª°®¬¥ ²®£®, ¢ ¢¥°¸¨­¥ ¬®¦¥² µ° ­¨²¼±¿ ­¥ª®²®° ¿ ¨­´®°¬ ¶¨¿, ±®¯°®¢®¦¤ ¾¹ ¿ ½²® ·¨±«®. «¨¢ ¥¬»¥
ª³·¨ ¯®§¢®«¿¾² ¢»¯®«­¿²¼ ±«¥¤³¾¹¨¥ ¯¿²¼ ®¯¥° ¶¨©:
Make-Heap() ±®§¤ ¥² ¨ ¢®§¢° ¹ ¥² ­®¢³¾ ª³·³, ­¥ ±®¤¥°¦ ¹³¾
½«¥¬¥­²®¢;
Insert(H; x) ¤®¡ ¢«¿¥² ½«¥¬¥­² (¢¥°¸¨­³) x ¢ ª³·³ H (¯®«¥ key
½«¥¬¥­²  x ¤®«¦­® ¡»²¼ § ¯®«­¥­® § ° ­¥¥);
Minimum(H ) ¢®§¢° ¹ ¥² ³ª § ²¥«¼ ­  ½«¥¬¥­² ª³·¨ H ± ¬¨­¨¬ «¼­»¬ ª«¾·®¬;
Extract-Min(H ) ¨§»¬ ¥² ½«¥¬¥­² ± ¬¨­¨¬ «¼­»¬ ª«¾·®¬ ¨§ ª³·¨ H ¨ ¢®§¢° ¹ ¥² ³ª § ²¥«¼ ­  ¨§º¿²»© ½«¥¬¥­²;
Union(H1; H2) ®¡º¥¤¨­¿¥² ª³·¨ H1 ¨ H2 , ²® ¥±²¼ ±®§¤ ¥² ¨ ¢®§¢° ¹ ¥² ­®¢³¾ ª³·³, ±®¤¥°¦ ¹³¾ ¢±¥ ½«¥¬¥­²» ª³· H1 ¨ H2 .  ¬¨
ª³·¨ H1 ¨ H2 ¯°¨ ½²®¬ ¨±·¥§ ¾².
²°³ª²³°» ¤ ­­»µ, ®¯¨±»¢ ¥¬»¥ ¢ ½²®© ¨ ±«¥¤³¾¹¥© £« ¢ µ, ¯®¤¤¥°¦¨¢ ¾² ¥¹¥ ¤¢¥ ®¯¥° ¶¨¨:
Decrease-Key(H; x; k) ³¬¥­¼¸ ¥² ª«¾· ¢¥°¸¨­» x ª³·¨ H , ¯°¨±¢ ¨¢ ¿ ¥¬³ ­®¢®¥ §­ ·¥­¨¥ k (¯°¥¤¯®« £ ¥²±¿, ·²® ­®¢®¥ §­ ·¥­¨¥ ­¥ ¯°¥¢®±µ®¤¨² ±² °®£®);
Delete(H; x) ³¤ «¿¥² ½«¥¬¥­² (¢¥°¸¨­³) x ¨§ ª³·¨ H .
 ª ¢¨¤­® ¨§ ² ¡«¨¶» 20.1, ¥±«¨ ¬» ­¥ ­³¦¤ ¥¬±¿ ¢ ®¯¥° ¶¨¨
Union, ²® (¤¢®¨·­»¥) ª³·¨, ± ¯®¬®¹¼¾ ª®²®°»µ ¬» ±®°²¨°®¢ «¨
¬ ±±¨¢ ¢ £« ¢¥ 7, ¢¥±¼¬  ½´´¥ª²¨¢­». «¿ ­¨µ ¢±¥ ®¯¥° ¶¨¨, ª°®¬¥
®¯¥° ¶¨¨ Union, ¢»¯®«­¿¾²±¿ §  ¢°¥¬¿ O(lg n) ¢ µ³¤¸¥¬ ±«³· ¥ ( 
­¥ª®²®°»¥ ¨§ ®¯¥° ¶¨© | ¥¹¥ ¡»±²°¥¥). ® ¤«¿ ¢»¯®«­¥­¨¿ ®¯¥° ¶¨¨ Union ­ ¬ ¯°¨µ®¤¨²±¿ ¯°¨¯¨±»¢ ²¼ ®¤¨­ ¬ ±±¨¢ ª ¤°³£®¬³ ¨
§ ²¥¬ ¢»¯®«­¿²¼ ¯°®¶¥¤³°³ Heapify, ·²® ²°¥¡³¥² ¢°¥¬¥­¨ (n).
 ½²®© £« ¢¥ ¬» ° ±±ª ¦¥¬ ® À¡¨­®¬¨ «¼­»µ ª³· µÁ (¢²®°®©
±²®«¡¥¶ ² ¡«¨¶»). ¡° ²¨²¥ ¢­¨¬ ­¨¥, ·²® ®¡º¥¤¨­¥­¨¥ ¤¢³µ ¡¨-

¨­®¬¨ «¼­»¥ ¤¥°¥¢¼¿ ¨ ¡¨­®¬¨ «¼­»¥ ª³·¨

401

¢®¨·­»¥ ª³·¨ ¨­®¬¨ «¼­»¥ ª³·¨ ¨¡®­ ··¨¥¢» ª³·¨
(¢ µ³¤¸¥¬ ±«³· ¥) (¢ µ³¤¸¥¬ ±«³· ¥)
(¢ ±°¥¤­¥¬)
Make-Heap
(1)
(1)
(1)
Insert
(lg n)
O(lg n)
(1)
Minimum
(1)
O(lg n)
(1)
Extract-Min
(lg n)
(lg n)
O(lg n)
Union
(n)
O(lg n)
(1)
Decrease-Key
(lg n)
(lg n)
(1)
Delete
(lg n)
(lg n)
O(lg n)
°®¶¥¤³° 

°¥¬¿ ¢»¯®«­¥­¨¿ ° §«¨·­»µ ®¯¥° ¶¨© ¤«¿ ²°¥µ ¢¨¤®¢ ±«¨¢ ¥¬»µ
ª³· (n | ®¡¹¥¥ ·¨±«® ½«¥¬¥­²®¢ ¢ ª³· µ ­  ¬®¬¥­² ®¯¥° ¶¨¨).
¨±. 20.1

­®¬¨ «¼­»µ ª³·, ±®¤¥°¦ ¹¨µ ¢ ±³¬¬¥ n ½«¥¬¥­²®¢, ²°¥¡³¥² ¢±¥£®
«¨¸¼ O(lg n) ®¯¥° ¶¨©.
 £« ¢¥ 21 ¬» ° ±±¬ ²°¨¢ ¥¬ À´¨¡®­ ··¨¥¢» ª³·¨Á, ª®²®°»¥ ¥¹¥
¡®«¥¥ ½´´¥ª²¨¢­» (²°¥²¨© ±²®«¡¥¶). ²¬¥²¨¬, ¢¯°®·¥¬, ·²® ½²®
³«³·¸¥­¨¥ ¤®±²¨£ ¥²±¿ «¨¸¼ ¤«¿ ³·¥²­®© ±²®¨¬®±²¨ ®¯¥° ¶¨© ¯°¨
 ¬®°²¨§ ¶¨®­­®¬  ­ «¨§¥.
 ­ ¸¨µ ¯°®¶¥¤³° µ ¬» ­¥ § ­¨¬ ¥¬±¿ ¢»¤¥«¥­¨¥¬ ¨ ®±¢®¡®¦¤¥­¨¥¬ ¯ ¬¿²¨ ¤«¿ ½«¥¬¥­²®¢ ª³·.
±¥ ²°¨ ¢¨¤  ª³·, ³ª § ­­»µ ¢ ² ¡«¨¶¥, ­¥ ¯®§¢®«¿¾² ½´´¥ª²¨¢­® °¥ «¨§®¢ ²¼ ¯®¨±ª ½«¥¬¥­²  ± ¤ ­­»¬ ª«¾·®¬ (Search).
®½²®¬³ ¯°®¶¥¤³°» Decrease-Key ¨ Delete ¯®«³· ¾² ¢ ª ·¥±²¢¥ ¯ ° ¬¥²°  ­¥ ª«¾· ¢¥°¸¨­»,   ³ª § ²¥«¼ ­  ­¥¥ (¢® ¬­®£¨µ
±«³· ¿µ ½²® ²°¥¡®¢ ­¨¥ ­¥ ±®§¤ ¥² ¯°®¡«¥¬).
 ° §¤¥«¥ 20.1 ®¯°¥¤¥«¿¾²±¿ ¡¨­®¬¨ «¼­»¥ ¤¥°¥¢¼¿ ¨ ª³·¨.  ¬
¦¥ ®¯¨±»¢ ¥²±¿ ¯°¥¤±² ¢«¥­¨¥ ¡¨­®¬¨ «¼­»µ ª³· ¢ ¯°®£° ¬¬¥. 
° §¤¥«¥ 20.2 ¯®ª § ­®, ª ª °¥ «¨§®¢ ²¼ ¢±¥ ¯¥°¥·¨±«¥­­»¥ ®¯¥° ¶¨¨ §  ³ª § ­­®¥ ¢ ² ¡«¨¶¥ 20.1 ¢°¥¬¿.

20.1. ¨­®¬¨ «¼­»¥ ¤¥°¥¢¼¿ ¨ ¡¨­®¬¨ «¼­»¥ ª³·¨
¨­®¬¨ «¼­ ¿ ª³·  ±®±²®¨² ¨§ ­¥±ª®«¼ª¨µ ¡¨­®¬¨ «¼­»µ ¤¥°¥¢¼¥¢.
20.1.1. ¨­®¬¨ «¼­»¥ ¤¥°¥¢¼¿
¨­®¬¨ «¼­»¥ ¤¥°¥¢¼¿¬¨ (binomial trees) ­ §»¢ ¾²±¿ ³¯®°¿¤®·¥­­»¥ (¢ ±¬»±«¥ ° §¤¥«  5.2.2) ¤¥°¥¢¼¿ B0 ; B1; B2; : : : , ®¯°¥¤¥«¿¥¬»¥ ¨­¤³ª²¨¢­®.
¥°¥¢® B0 ±®±²®¨² ¨§ ¥¤¨­±²¢¥­­®© ¢¥°¸¨­» (°¨±. 20.2 ). ¥°¥¢®
Bk ±ª«¥¥­® ¨§ ¤¢³µ ½ª§¥¬¯«¿°®¢ ¤¥°¥¢  Bk;1 : ª®°¥­¼ ®¤­®£® ¨§
­¨µ ®¡º¿¢«¥­ ± ¬»¬ «¥¢»¬ ¯®²®¬ª®¬ ª®°­¿ ¤°³£®£®.   °¨±. 20.2¡
¯®ª § ­» ¡¨­®¬¨ «¼­»¥ ¤¥°¥¢¼¿ B0 {B4 .

402

« ¢  20 ¨­®¬¨ «¼­»¥ ª³·¨

depth = £«³¡¨­ 

( ) ¥ª³°±¨¢­®¥ ®¯°¥¤¥«¥­¨¥ ¡¨­®¬¨ «¼­®£® ¤¥°¥¢  Bk (²°¥³£®«¼­¨ª¨ | ¯®¤¤¥°¥¢¼¿ ± ¢»¤¥«¥­­»¬ ª®°­¥¬). (¡) ¥°¥¢¼¿ B0 {B4 . ¨´°» ³ª §»¢ ¾²
£«³¡¨­³ ¢¥°¸¨­ ¢ ¤¥°¥¢¥ B4 . (¢) °³£®¥ ¯°¥¤±² ¢«¥­¨¥ ¤¥°¥¢  Bk .
¨±. 20.2

¥¬¬  20.1 (¢®©±²¢  ¡¨­®¬¨ «¼­»µ ¤¥°¥¢¼¥¢). ¥°¥¢® Bk
1. ±®¤¥°¦¨² 2k ¢¥°¸¨­;
2. ¨¬¥¥² ¢»±®²³ k;
3. ¨¬¥¥² Cki ¢¥°¸¨­ £«³¡¨­» i;
4. ¨¬¥¥² ª®°¥­¼, ¿¢«¿¾¹¨©±¿ ¢¥°¸¨­®© ±²¥¯¥­¨ k; ¢±¥ ®±² «¼­»¥ ¢¥°¸¨­» ¨¬¥¾² ¬¥­¼¸³¾ ±²¥¯¥­¼; ¤¥²¨ ª®°­¿ ¿¢«¿¾²±¿
ª®°­¿¬¨ ¯®¤¤¥°¥¢¼¥¢ Bk;1 ; Bk;2 ; : : :; B1 ; B0 (±«¥¢  ­ ¯° ¢®).
®ª § ²¥«¼±²¢®. ¯°®¢®¤¨²±¿ ¨­¤³ª¶¨¥© ¯® k. «¿ B0 ¢±¥ ®·¥¢¨¤­®. ³±²¼ ³²¢¥°¦¤¥­¨¥ ¢¥°­® ¤«¿ Bk;1 . ®£¤ :
1. ¥°¥¢® Bk ±®±²®¨² ¨§ ¤¢³µ ª®¯¨© Bk;1 ¨ ¯®²®¬³ ±®¤¥°¦¨²
2k;1 + 2k;1 = 2k ¢¥°¸¨­.
2. °¨ ±®¥¤¨­¥­¨¨ ¤¢³µ ª®¯¨© ®¯¨± ­­»¬ ±¯®±®¡®¬ ¢»±®²  ³¢¥«¨·¨¢ ¥²±¿ ­  1.
3. ³±²¼ D(k; i) | ·¨±«® ¢¥°¸¨­ £«³¡¨­» i ¢ ¤¥°¥¢¥ Bk . ® ¯®±²°®¥­¨¾ ¤¥°¥¢  Bk (±¬. °¨±. 20.2 ) ¨¬¥¥² ¬¥±²® ° ¢¥­±²¢®

D(k; i) = D(k ; 1; i) + D(k ; 1; i ; 1) = Cki ;1 + Cki;;11 = Cki :

¨­®¬¨ «¼­»¥ ¤¥°¥¢¼¿ ¨ ¡¨­®¬¨ «¼­»¥ ª³·¨

403

(» ¢®±¯®«¼§®¢ «¨±¼ ¨­¤³ª²¨¢­»¬ ¯°¥¤¯®«®¦¥­¨¥¬ ¨ ³¯°. 6.1-7.)
4. ® ¯°¥¤¯®«®¦¥­¨¾ ¨­¤³ª¶¨¨ ¢±¥ ¢¥°¸¨­» ¢ Bk;1 ¨¬¥¾² ±²¥¯¥­¼ ­¥ ¡®«¼¸¥ k ; 1, ² ª ·²® ª®°¥­¼ ¤¥°¥¢  Bk ¡³¤¥² ¢ ­¥¬ ¥¤¨­±²¢¥­­®© ¢¥°¸¨­®© ±²¥¯¥­¨ k.  ¯° ¢®¬ ¨§ ±ª«¥¨¢ ¥¬»µ ¤¥°¥¢¼¥¢
¤¥²¨ ª®°­¿ ¡»«¨ ¢¥°¸¨­ ¬¨ ¤¥°¥¢¼¥¢ Bk;2 ; Bk;3 ; : : :; B1 ; B0, ²¥¯¥°¼ ª ­¨¬ ¤®¡ ¢¨«®±¼ ±«¥¢  ¥¹¥ ¤¥°¥¢® Bk;1 .
«¥¤±²¢¨¥ 20.2.  ª±¨¬ «¼­ ¿ ±²¥¯¥­¼ ¢¥°¸¨­» ¢ ¡¨­®¬¨ «¼­®¬
¤¥°¥¢¥ ± n ¢¥°¸¨­ ¬¨ ° ¢­  lg n.
®ª § ²¥«¼±²¢®. ±¯®«¼§³¥¬ ³²¢¥°¦¤¥­¨¿ 1 ¨ 4 «¥¬¬» 20.1.
 §¢ ­¨¥ À¡¨­®¬¨ «¼­®¥ ¤¥°¥¢®Á ±¢¿§ ­® ± ³²¢¥°¦¤¥­¨¥¬ 3 «¥¬¬» 20.1 (·¨±«® Cki ­ §»¢ ¾² ¡¨­®¬¨ «¼­»¬ ª®½´´¨¶¨¥­²®¬). ¬.
² ª¦¥ ³¯°. 20.1-3.
20.1.2. ¨­®¬¨ «¼­»¥ ª³·¨
¨­®¬¨ «¼­ ¿ ª³·  (binomial heap) | ½²® ­ ¡®° H ¡¨­®¬¨ «¼­»µ ¤¥°¥¢¼¥¢, ¢ ¢¥°¸¨­ µ ª®²®°»µ § ¯¨± ­» ª«¾·¨ (·¨±« ) ¨, ¢®§¬®¦­®, ¤®¯®«­¨²¥«¼­ ¿ ¨­´®°¬ ¶¨¿. °¨ ½²®¬ ¤®«¦­» ¡»²¼ ¢»¯®«­¥­» ² ª¨¥ ±¢®©±²¢  ¡¨­®¬¨ «¼­®© ª³·¨ (binomial-heap properties):
1.  ¦¤®¥ ¤¥°¥¢® ¢ H ³¯®°¿¤®·¥­® ¢ ±¬»±«¥ ª³· (is heap-ordered),
². ¥. ª«¾· ª ¦¤®© ¢¥°¸¨­» ­¥ ¬¥­¼¸¥, ·¥¬ ª«¾· ¥¥ °®¤¨²¥«¿.
2.  H ­¥² ¤¢³µ ¡¨­®¬¨ «¼­»µ ¤¥°¥¢¼¥¢ ®¤­®£® ° §¬¥°  (± ®¤¨­ ª®¢®© ±²¥¯¥­¼¾ ª®°­¿).
¥°¢®¥ ±¢®©±²¢® £ ° ­²¨°³¥², ·²® ª®°¥­¼ ª ¦¤®£® ¨§ ¤¥°¥¢¼¥¢
¨¬¥¥² ­ ¨¬¥­¼¸¨© ª«¾· ±°¥¤¨ ¥£® ¢¥°¸¨­.
§ ¢²®°®£® ±¢®©±²¢  ±«¥¤³¥², ·²® ±³¬¬ °­®¥ ª®«¨·¥±²¢® ¢¥°¸¨­
¢ ¡¨­®¬¨ «¼­®© ª³·¥ H ®¤­®§­ ·­® ®¯°¥¤¥«¿¥² ° §¬¥°» ¢µ®¤¿¹¨µ
¢ ­¥¥ ¤¥°¥¢¼¥¢.  ± ¬®¬ ¤¥«¥, ®¡¹¥¥ ·¨±«® ¢¥°¸¨­, ° ¢­®¥ n, ¥±²¼
±³¬¬  ° §¬¥°®¢ ®²¤¥«¼­»µ ¤¥°¥¢¼¥¢, ª®²®°»¥ ±³²¼ ° §«¨·­»¥ ±²¥¯¥­¨ ¤¢®©ª¨,   ² ª®¥ ¯°¥¤±² ¢«¥­¨¥ ¥¤¨­±²¢¥­­® (¤¢®¨·­ ¿ ±¨±²¥¬  ±·¨±«¥­¨¿). ²±¾¤  ¢»²¥ª ¥² ² ª¦¥, ·²® ª³·  ± n ½«¥¬¥­² ¬¨
±®±²®¨² ¨§ ­¥ ¡®«¥¥ ·¥¬ blg nc + 1 ¡¨­®¬¨ «¼­»µ ¤¥°¥¢¼¥¢.
  °¨±. 20.3  ¯®ª § ­  ¡¨­®¬¨ «¼­ ¿ ª³·  H ± 13 ¢¥°¸¨­ ¬¨.
 ¤¢®¨·­®© ±¨±²¥¬¥ 13 § ¯¨±»¢ ¥²±¿ ª ª 1101 (13 = 8 + 4 + 1), ¨
H c®±²®¨² ¨§ ¡¨­®¬¨ «¼­»µ ¤¥°¥¢¼¥¢ B3 , B2 ¨ B0 (± ª®«¨·¥±²¢®¬
¢¥°¸¨­ 8, 4 ¨ 1).
°¥¤±² ¢«¥­¨¥ ¡¨­®¬¨ «¼­»µ ª³· ¢ ¯°®£° ¬¬¥
 ª ¯®ª § ­® ­  °¨±. 20.3¡, ª ¦¤®¥ ¡¨­®¬¨ «¼­®¥ ¤¥°¥¢® ¢ ¡¨­®¬¨ «¼­®© ª³·¥ µ° ­¨²±¿ ¢ ¯°¥¤±² ¢«¥­¨¨ À«¥¢»© °¥¡¥­®ª, ¯° ¢»©
±®±¥¤Á (±¬. ° §¤. 11.4).  ¦¤ ¿ ¢¥°¸¨­  ¨¬¥¥² ¯®«¥ key (ª«¾·),  

404

« ¢  20 ¨­®¬¨ «¼­»¥ ª³·¨

¨±. 20.3 ¨­®¬¨ «¼­ ¿ ª³·  H ± n = 13 ¢¥°¸¨­ ¬¨. ( ) ³·  ±®±²®¨² ¨§
¡¨­®¬¨ «¼­»µ ¤¥°¥¢¼¥¢ B0 , B2 ¨ B3 , ¨¬¥¾¹¨µ ±®®²¢¥²±²¢¥­­® 1, 4 ¨ 8 ¢¥°¸¨­
(¢±¥£® 13 ¢¥°¸¨­). «¾· ª ¦¤®© ¢¥°¸¨­» ­¥ ¬¥­¼¸¥, ·¥¬ ª«¾· ¥¥ °®¤¨²¥«¿.
®°­¨ ¤¥°¥¢¼¥¢ ±¢¿§ ­» ¢ ª®°­¥¢®© ±¯¨±®ª ¢ ¯®°¿¤ª¥ ¢®§° ±² ­¨¿ ±²¥¯¥­¨.
(¡) °¥¤±² ¢«¥­¨¥ ª³·¨ ¢ ¯°®£° ¬¬¥.  ¦¤®¥ ¡¨­®¬¨ «¼­®¥ ¤¥°¥¢® µ° ­¨²±¿
¢ ¯°¥¤±² ¢«¥­¨¨ À«¥¢»© °¥¡¥­®ª, ¯° ¢»© ±®±¥¤Á, ¨ ¢ ª ¦¤®© ¢¥°¸¨­¥ µ° ­¨²±¿
¥¥ ±²¥¯¥­¼ (degree ).

² ª¦¥ µ° ­¨² ¤®¯®«­¨²¥«¼­³¾ ¨­´®°¬ ¶¨¾. °®¬¥ ²®£®, ª ¦¤ ¿
¢¥°¸¨­  x µ° ­¨² ³ª § ²¥«¨ p[x] (°®¤¨²¥«¼), child[x] (± ¬»© «¥¢»©
¨§ ¤¥²¥©) ¨ sibling[x] (À±«¥¤³¾¹¨© ¯® ±² °¸¨­±²¢³ ¡° ²Á). ±«¨ x
| ª®°¥­¼, ²® p[x] = nil; ¥±«¨ x ­¥ ¨¬¥¥² ¤¥²¥©, ²® child[x] = nil,
  ¥±«¨ x ¿¢«¿¥²±¿ ± ¬»¬ ¯° ¢»¬ °¥¡¥­ª®¬ ±¢®¥£® °®¤¨²¥«¿, ²®
sibling[x] = nil.  ¦¤ ¿ ¢¥°¸¨­  x ±®¤¥°¦¨² ² ª¦¥ ¯®«¥ degree[x]
¢ ª®²®°®¬ µ° ­¨²±¿ ±²¥¯¥­¼ (·¨±«® ¤¥²¥©) ¢¥°¸¨­» x.
  °¨±. 20.3 ¯®ª § ­® ² ª¦¥, ·²® ª®°­¨ ¡¨­®¬¨ «¼­»µ ¤¥°¥¢¼¥¢,
±®±² ¢«¿¾¹¨µ ¡¨­®¬¨ «¼­³¾ ª³·³, ±¢¿§ ­» ¢ ±¯¨±®ª, ­ §»¢ ¥¬»©
ª®°­¥¢»¬ ±¯¨±ª®¬ (root list) ¢ ¯®°¿¤ª¥ ¢®§° ±² ­¨¿ ±²¥¯¥­¥©.  ª
¬» ¢¨¤¥«¨, ¢ ª³·¥ ± n ¢¥°¸¨­ ¬¨ ±²¥¯¥­¨ ª®°­¥¢»µ ¢¥°¸¨­ ®¡° §³¾² ¯®¤¬­®¦¥±²¢® ¬­®¦¥±²¢  f0; 1; : : :; blg ncg.
«¿ ¯®±²°®¥­¨¿ ª®°­¥¢®£® ±¯¨±ª  ¨±¯®«¼§³¥²±¿ ¯®«¥ sibling : ¤«¿
ª®°­¥¢®© ¢¥°¸¨­» ®­® ³ª §»¢ ¥² ­  ±«¥¤³¾¹¨© ½«¥¬¥­² ª®°­¥¢®£®
±¯¨±ª  (¨ ±®¤¥°¦¨² nil ¤«¿ ¯®±«¥¤­¥£® ª®°­¿ ¢ ª®°­¥¢®¬ ±¯¨±ª¥).

¯¥° ¶¨¨ ± ¡¨­®¬¨ «¼­»¬¨ ª³· ¬¨

405

¨­®¬¨ «¼­®¥ ¤¥°¥¢® B4 ± ¢¥°¸¨­ ¬¨, ¯°®­³¬¥°®¢ ­­»¬¨ ¢ ¯®°¿¤ª¥
À«¥¢®¥ ¯®¤¤¥°¥¢®, : : : , ¯° ¢®¥ ¯®¤¤¥°¥¢®, ¢¥°¸¨­ Á; ­®¬¥°  § ¯¨± ­» ¢ ¤¢®¨·­®© ±¨±²¥¬¥.
¨±. 20.4

®±²³¯ ª ¡¨­®¬¨ «¼­®© ª³·¥ H ®±³¹¥±²¢«¿¥²±¿ ± ¯®¬®¹¼¾ ¯®«¿
head[H ] | ³ª § ²¥«¿ ­  ¯¥°¢»© ª®°¥­¼ ¢ ª®°­¥¢®¬ ±¯¨±ª¥ ª³·¨ H .
±«¨ ª³·  H ¯³±² , ²® head[H ] = nil.
¯° ¦­¥­¨¿
20.1-1 ³±²¼ x | ¢¥°¸¨­  ®¤­®£® ¨§ ¡¨­®¬¨ «¼­»µ ¤¥°¥¢¼¥¢ ¢
¡¨­®¬¨ «¼­®© ª³·¥, ¯°¨·¥¬ sibling[x] 6= nil.  ª ±®®²­®±¿²±¿ §­ ·¥­¨¿ degree[sibling[x]] ¨ degree[x]? (²¢¥² § ¢¨±¨² ®² ²®£®, ¿¢«¿¥²±¿
«¨ x ª®°­¥¬.)
20.1-2 ³±²¼ x | ­¥ª®°­¥¢ ¿ ¢¥°¸¨­  ¡¨­®¬¨ «¼­®£® ¤¥°¥¢ .
° ¢­¨²¼ degree[p[x]] ¨ degree[x].
20.1-3  ±¯®«®¦¨¬ ¢¥°¸¨­» ¡¨­®¬¨ «¼­®£® ¤¥°¥¢  Bk ¢ ² ª®¬
¯®°¿¤ª¥, ·²®¡» ª ¦¤ ¿ ¢¥°¸¨­  ±«¥¤®¢ «  §  ±¢®¨¬¨ ¯®²®¬ª ¬¨.
°¨ ½²®¬ ±­ · «  ¨¤³² ¯®²®¬ª¨ ¥¥ «¥¢®£® °¥¡¥­ª , § ²¥¬ ± ¬ ½²®²
°¥¡¥­®ª, § ²¥¬ ¯®²®¬ª¨ ±«¥¤³¾¹¥£® °¥¡¥­ª , ®­ ± ¬ ¨ ². ¤. (postorder walk). °®­³¬¥°³¥¬ ¢¥°¸¨­», § ¯¨± ¢ ­®¬¥°  ¢ ¤¢®¨·­®© ±¨±²¥¬¥ ±·¨±«¥­¨¿ (°¨±. 20.4). ®ª ¦¨²¥, ·²® £«³¡¨­  ¢¥°¸¨­» ®¯°¥¤¥«¿¥²±¿ ·¨±«®¬ ¥¤¨­¨¶ (ª®°¥­¼ ¨¬¥¥² ®¤­¨ ¥¤¨­¨¶», ¥£® ¤¥²¨ ­ 
®¤­³ ¥¤¨­¨¶³ ¬¥­¼¸¥ ¨ ². ¤.),   ±²¥¯¥­¼ ¢¥°¸¨­» ° ¢­¿¥²±¿ ·¨±«³
¥¤¨­¨¶ ³ ¯° ¢®£® ª° ¿ ¤¢®¨·­®© § ¯¨±¨. ª®«¼ª® ¨¬¥¥²±¿ ¤¢®¨·­»µ ±²°®ª ¤«¨­» k, ±®¤¥°¦ ¹¨µ °®¢­® j ¥¤¨­¨¶, ¨ £¤¥ ­ µ®¤¿²±¿
±®®²¢¥²±²¢³¾¹¨¥ ¨¬ ¢¥°¸¨­»?

20.2. ¯¥° ¶¨¨ ± ¡¨­®¬¨ «¼­»¬¨ ª³· ¬¨
 ½²®¬ ° §¤¥«¥ ¯°¨¢¥¤¥­» °¥ «¨§ ¶¨¨ ®¯¥° ¶¨© ± ¡¨­®¬¨ «¼­»¬¨ ª³· ¬¨. °¥¬¿ ° ¡®²» ½²¨µ ®¯¥° ¶¨© ³ª § ­® ¢ ² ¡«¨¶¥ 20.1.
» ¤®ª ¦¥¬ ²®«¼ª® ¢¥°µ­¨¥ ®¶¥­ª¨, ®±² ¢«¿¿ ­¨¦­¨¥ ¢ ª ·¥±²¢¥
³¯°. 20.2-10.
®§¤ ­¨¥ ­®¢®© ª³·¨
°®¶¥¤³°  Make-Binomial-Heap ±®§¤ ¥² ¨ ¢®§¢° ¹ ¥² ®¡º¥ª² H , ¤«¿ ª®²®°®£® head[H ] = nil (¢°¥¬¿ ° ¡®²» (1)).

406

« ¢  20 ¨­®¬¨ «¼­»¥ ª³·¨

®¨±ª ¬¨­¨¬ «¼­®£® ª«¾· 
°®¶¥¤³°  Binomial-Heap-Minimum ¢®§¢° ¹ ¥² ³ª § ²¥«¼ ­ 
¢¥°¸¨­³ ± ¬¨­¨¬ «¼­»¬ ª«¾·®¬ ¢ ¡¨­®¬¨ «¼­®© ª³·¥ H , ±®±²®¿¹¥© ¨§ n ¢¥°¸¨­. » ¨±¯®«¼§³¥¬ ±¯¥¶¨ «¼­®¥ §­ ·¥­¨¥ 1, ª®²®°®¥
¡®«¼¸¥ ¢±¥µ §­ ·¥­¨© ª«¾·¥© (±¬. ³¯°. 20.2-5).
Binomial-Heap-Minimum(H )
1 y nil
2 x head[H ]
3 min 1
4 while x 6= nil
5
do if key[x] < min
6
then min key[x]
7
y x
8
x sibling[x]
9 return y
 ¡¨­®¬¨ «¼­»µ ¤¥°¥¢¼¿µ ­ ¨¬¥­¼¸¨¥ ½«¥¬¥­²» ±²®¿² ¢ ª®°­¿µ, ² ª ·²® ¤®±² ²®·­® ¢»¡° ²¼ ¬¨­¨¬ «¼­»© ½«¥¬¥­² ª®°­¥¢®£®
±¯¨±ª . °®¶¥¤³°  Binomial-Heap-Minimum ¯°®±¬ ²°¨¢ ¥² ½²®²
±¯¨±®ª, µ° ­¿ ¢ ¯¥°¥¬¥­­®© min ¬¨­¨¬ «¼­®¥ ¨§ ¯°®±¬®²°¥­­»µ
§­ ·¥­¨©,   ¢ ¯¥°¥¬¥­­®© y | ¢¥°¸¨­³, £¤¥ ®­® ¤®±²¨£ ¥²±¿.
 ¯°¨¬¥°, ¤«¿ ª³·¨ °¨±. 20.3 ¯°®¶¥¤³°  Binomial-HeapMinimum ¢®§¢° ¹ ¥² ³ª § ²¥«¼ ­  ¢¥°¸¨­³ ± ª«¾·®¬ 1.
«¨­  ª®°­¥¢®£® ±¯¨±ª  ­¥ ¯°¥¢®±µ®¤¨² blg nc +1, ¯®½²®¬³ ¢°¥¬¿
° ¡®²» ¯°®¶¥¤³°» Binomial-Heap-Minimum ¥±²¼ O(lg n).
20.2.1. ¡º¥¤¨­¥­¨¥ ¤¢³µ ª³·
¯¥° ¶¨¿ Binomial-Heap-Union, ±®¥¤¨­¿¾¹ ¿ ¤¢¥ ¡¨­®¬¨ «¼­»¥ ª³·¨ ¢ ®¤­³, ¨±¯®«¼§³¥²±¿ ¢ ª ·¥±²¢¥ ¯®¤¯°®£° ¬¬» ¡®«¼¸¨­±²¢®¬ ®±² «¼­»µ ®¯¥° ¶¨©.
[¤¥¿ ¯°®±² : ¯³±²¼ ¥±²¼ ¤¢¥ ¡¨­®¬¨ «¼­»¥ ª³·¨ ± m ¨ n ½«¥¬¥­² ¬¨.  §¬¥°» ¤¥°¥¢¼¥¢ ¢ ­¨µ ±®®²¢¥²±²¢³¾² ±« £ ¥¬»¬ ¢ ° §«®¦¥­¨¿µ ·¨±¥« m ¨ n ¢ ±³¬¬³ ±²¥¯¥­¥© ¤¢®©ª¨. °¨ ±«®¦¥­¨¨ ±²®«¡¨ª®¬ ¢ ¤¢®¨·­®© ±¨±²¥¬¥ ¯°®¨±µ®¤¿² ¯¥°¥­®±», ª®²®°»¥ ±®®²¢¥²±²¢³¾² ±«¨¿­¨¿¬ ¤¢³µ ¡¨­®¬¨ «¼­»µ ¤¥°¥¢¼¥¢ Bk;1 ¢ ¤¥°¥¢® Bk .
 ¤® ²®«¼ª® ¯®±¬®²°¥²¼, ¢ ª ª®¬ ¨§ ±«¨¢ ¥¬»µ ¤¥°¥¢¼¥¢ ª®°¥­¼
¬¥­¼¸¥, ¨ ±·¨² ²¼ ¥£® ¢¥°µ­¨¬.]
¯¨¸¥¬ ®¯¥° ¶¨¾ ®¡º¥¤¨­¥­¨¿ ¯®¤°®¡­®.  ·­¥¬ ±® ¢±¯®¬®£ ²¥«¼­®© ®¯¥° ¶¨¨ Binomial-Link, ª®²®° ¿ ±®¥¤¨­¿¥² ¤¢  ¡¨­®¬¨ «¼­»µ ¤¥°¥¢  ®¤­®£® ° §¬¥°  (Bk;1 ), ª®°­¿¬¨ ª®²®°»µ ¿¢«¿¾²±¿
¢¥°¸¨­» y ¨ z , ¤¥« ¿ ¢¥°¸¨­³ z °®¤¨²¥«¥¬ ¢¥°¸¨­» y ¨ ª®°­¥¬
¤¥°¥¢  Bk .

¯¥° ¶¨¨ ± ¡¨­®¬¨ «¼­»¬¨ ª³· ¬¨

Binomial-Link(y; z )

407

1 p[y ] z
2 sibling[y ] child[z ]
3 child[z ] y
4 degree[z ] degree[z ] + 1
°¥¬¿ ° ¡®²» ½²®© ¯°®¶¥¤³°» | O(1) (³¤ ·­»¬ ®¡° §®¬ ®ª §»¢ ¥²±¿, ·²® ¢¥°¸¨­³ y ­ ¤® ¤®¡ ¢¨²¼ ¢ ­ · «® ±¯¨±ª  ¤¥²¥© ¢¥°¸¨­» z , ·²® «¥£ª® ±¤¥« ²¼ ¢ ¯°¥¤±² ¢«¥­¨¨ À«¥¢»© °¥¡¥­®ª, ¯° ¢»©
±®±¥¤Á).
¥¯¥°¼ ­ ¯¨¸¥¬ ¯°®¶¥¤³°³ Binomial-Heap-Union, ª®²®° ¿
®¡º¥¤¨­¿¥² ¡¨­®¬¨ «¼­»¥ ª³·¨ H1 ¨ H2 (± ¬¨ ª³·¨ ¯°¨ ½²®¬
¨±·¥§ ¾²). ®¬¨¬® ¯°®¶¥¤³°» Binomial-Link, ­ ¬ ¯®­ ¤®¡¨²±¿
¯°®¶¥¤³°  Binomial-Heap-Merge, ª®²®° ¿ ±«¨¢ ¥² ª®°­¥¢»¥
±¯¨±ª¨ ª³· H1 ¨ H2 ¢ ¥¤¨­»© ±¯¨±®ª, ¢¥°¸¨­» ¢ ª®²®°®¬ ¨¤³² ¢
¯®°¿¤ª¥ ¢®§° ±² ­¨¿ ±²¥¯¥­¥©. (²  ¯°®¶¥¤³°   ­ «®£¨·­  ¯°®¶¥¤³°¥ Merge ¨§ ° §¤¥«  1.3.1, ¨ ¥¥ ¬» ®±² ¢«¿¥¬ ·¨² ²¥«¾ ¢
ª ·¥±²¢¥ ³¯°. 20.2-2.)
Binomial-Heap-Union(H1; H2)
1 H Make-Binomial-Heap()
2 head[H ] Binomial-Heap-Merge (H1; H2)
3 ®±¢®¡®¤¨²¼ ¯ ¬¿²¼, § ­¿²³¾ ¯®¤ H1 ¨ H2
(±®µ° ­¨¢ ±¯¨±ª¨, ­  ª®²®°»¥ ³ª §»¢ ¾² H1 ¨ H2)
4 if head[H ] = nil
5
then return H
6 prev-x nil
7 x head[H ]
8 next-x sibling[x]
9 while next-x =
6 nil
10
do if (degree[x] 6= degree[next-x]) or
(sibling[next-x] =
6 nil
and degree[sibling[next-x]] = degree[x])
11
then prev-x x
. «³· ¨ 1 ¨ 2
12
x next-x
. «³· ¨ 1 ¨ 2
13
else if key[x] 6 key[next-x]
14
then sibling[x] sibling[next-x] . «³· © 3
15
Binomial-Link(next-x; x) . «³· © 3
16
else if prev-x = nil
. «³· © 4
17
then head[H ] next-x . «³· © 4
18
else sibling[prev-x] next-x . «³· © 4
19
Binomial-Link(x; next-x) . «³· © 4
20
x next-x
. «³· © 4
21
next-x sibling[x]
22 return H

408

« ¢  20 ¨­®¬¨ «¼­»¥ ª³·¨

  °¨±³­ª¥ 20.5 ¯®ª § ­ ¯°¨¬¥° ®¡º¥¤¨­¥­¨¿ ¤¢³µ ª³·, ¢ ª®²®°®¬
¢±²°¥· ¾²±¿ ¢±¥ ·¥²»°¥ ±«³· ¿, ¯°¥¤³±¬®²°¥­­»¥ ¢ ²¥ª±²¥ ¯°®¶¥¤³°».
 ¡®²  ¯°®¶¥¤³°» Binomial-Heap-Union ­ ·¨­ ¥²±¿ ± ±®¥¤¨­¥­¨¿ ª®°­¥¢»µ ±¯¨±ª®¢ ª³· H1 ¨ H2 ¢ ¥¤¨­»© ±¯¨±®ª H , ¢ ª®²®°®¬
ª®°­¥¢»¥ ¢¥°¸¨­» ¨¤³² ¢ ¯®°¿¤ª¥ ¢®§° ±² ­¨¿ ¨µ ±²¥¯¥­¥© (¢»§®¢
Binomial-Heap-Merge).
 ¯®«³·¨¢¸¥¬±¿ ±¯¨±ª¥ ¬®¦¥² ¡»²¼ ¤® ¤¢³µ ¢¥°¸¨­ ®¤¨­ ª®¢®©
±²¥¯¥­¨. ®½²®¬³ ¬» ­ ·¨­ ¥¬ ±®¥¤¨­¿²¼ ¤¥°¥¢¼¿ ° ¢­®© ±²¥¯¥­¨ ±
¯®¬®¹¼¾ ¯°®¶¥¤³°» Binomial-Link ¨ ¤¥« ¥¬ ½²® ¤® ²¥µ ¯®°, ¯®ª 
¤¥°¥¢¼¥¢ ®¤¨­ ª®¢®© ±²¥¯¥­¨ ­¥ ®±² ­¥²±¿. ²®² ¯°®¶¥±± ±®®²¢¥²±²¢³¥² ±«®¦¥­¨¾ ±²®«¡¨ª®¬, ¨ ¢°¥¬¿ ¥£® ° ¡®²» ¯°®¯®°¶¨®­ «¼­®
·¨±«³ ª®°­¥¢»µ ¢¥°¸¨­.
¯¨¸¥¬ ° ¡®²³ ¯°®¶¥¤³°» ¡®«¥¥ ¯®¤°®¡­®. ­ · «  (±²°®ª¨ 1{
3) ¯°®¨±µ®¤¨² ±«¨¿­¨¥ ª®°­¥¢»µ ±¯¨±ª®¢ ¡¨­®¬¨ «¼­»µ ª³· H1 ¨
H2 ¢ ®¤¨­ ª®°­¥¢®© ±¯¨±®ª H . °®¶¥¤³°  Binomial-Heap-Merge
­  ª ¦¤®¬ ¸ £¥ ±¢®¥© ° ¡®²» ±° ¢­¨¢ ¥² ­ · «  ±¯¨±ª®¢ H1 ¨ H2
¨ ¢¥°¸¨­³ ± ¬¥­¼¸¥© ±²¥¯¥­¼¾ ¤®¡ ¢«¿¥² ¢ ª®­¥¶ ±¯¨±ª  H . °¨
½²®¬ ¯®°¿¤®ª ±®µ° ­¿¥²±¿, ² ª ·²® ¢ ±¯¨±ª¥ H ±²¥¯¥­¨ ª®°­¥¢»µ
¢¥°¸¨­ ¨¤³² ¢ ­¥³¡»¢ ¾¹¥¬ ¯®°¿¤ª¥. °®¶¥¤³°  Binomial-HeapMerge ²°¥¡³¥² ¢°¥¬¥­¨ O(m), £¤¥ m | ±³¬¬ °­ ¿ ¤«¨­  ±¯¨±ª®¢
H1 ¨ H2 .
±«¨ ª³·¨ H1 ¨ H2 ¯³±²», ¡³¤¥² ¢®§¢° ¹¥­  ¯³±² ¿ ª³·  (±²°®ª¨
4{5).  «¥¥ ¬» ¯°¥¤¯®« £ ¥¬, ·²® ±¯¨±®ª H ±®¤¥°¦¨² µ®²¿ ¡» ®¤­³
¢¥°¸¨­³.
 ¶¨ª«¥ ¨±¯®«¼§³¾²±¿ ²°¨ ³ª § ²¥«¿:
 x ³ª §»¢ ¥² ­  ²¥ª³¹³¾ ª®°­¥¢³¾ ¢¥°¸¨­³;
 prev-x ³ª §»¢ ¥² ­  ¯°¥¤¸¥±²¢³¾¹³¾ ¢¥°¸¨­³ (sibling[prev-x] =
x);
 next-x ³ª §»¢ ¥² ­  ¢¥°¸¨­³, ±«¥¤³¾¹³¾ §  x ¢ ±¯¨±ª¥
(sibling[x] = next-x).
§­ · «¼­® ¢ ±¯¨±ª¥ H ¬®¦¥² ¡»²¼ ­¥ ¡®«¥¥ ¤¢³µ ¢¥°¸¨­ ¤ ­­®© ±²¥¯¥­¨, ² ª ª ª ª ¦¤ ¿ ¨§ ¡¨­®¬¨ «¼­»µ ª³· H1 ¨ H2 ±®¤¥°¦¨² ­¥ ¡®«¥¥ ®¤­®© ¢¥°¸¨­» ¤ ­­®© ±²¥¯¥­¨. ®±ª®«¼ª³ ±²¥¯¥­¨
­¥ ³¡»¢ ¾², ¢¥°¸¨­» ®¤¨­ ª®¢®© ±²¥¯¥­¨ ¡³¤³² ±®±¥¤­¨¬¨.
°¨ ±«®¦¥­¨¨ ¤¢®¨·­»µ ·¨±¥« ±²®«¡¨ª®¬ ¢ ®¤­®¬ ° §°¿¤¥ ¬®¦¥²
¡»²¼ ²°¨ ¥¤¨­¨¶» (¤¢¥ ¢ ±« £ ¥¬»µ ¨ ®¤­  §  ±·¥² ¯¥°¥­®± ). ®
 ­ «®£¨·­»¬ ¯°¨·¨­ ¬ ¢ µ®¤¥ ¢»¯®«­¥­¨¿ ¯°®¶¥¤³°» BinomialHeap-Union ¢ ±¯¨±ª¥ H ¬®£³² ®ª § ²¼±¿ ²°¨ ¢¥°¸¨­» ®¤¨­ ª®¢®©
±²¥¯¥­¨.
®½²®¬³, ¢¨¤¿ ¢ ±²°®ª¥ 10 ¤¢¥ ±®±¥¤­¨¥ ¢¥°¸¨­» ®¤¨­ ª®¢®©
±²¥¯¥­¨, ¬» ¯°®¢¥°¿¥¬, ­¥ ¨¤¥² «¨ §  ­¨¬¨ ¥¹¥ ®¤­  ¢¥°¸¨­  ²®©
¦¥ ±²¥¯¥­¨.
 ¬¥²¨¬, ·²® ¢ ­ · «¥ ª ¦¤®© ¨²¥° ¶¨¨ ¶¨ª«  while (±²°®ª¨ 9{
21) ­¨ ®¤¨­ ¨§ ³ª § ²¥«¥© x ¨ next-x ­¥ ° ¢¥­ nil.

¯¥° ¶¨¨ ± ¡¨­®¬¨ «¼­»¬¨ ª³· ¬¨

409

¨±. 20.5 ±¯®«­¥­¨¥ ¯°®¶¥¤³°» Binomial-Heap-Union. ( ) ¨­®¬¨ «¼­»¥
ª³·¨ H1 ¨ H2 . (¡) ³·  H , ¢®§­¨ª ¾¹ ¿ ¯®±«¥ ¢»¯®«­¥­¨¿ Binomial-HeapMerge(H1 ; H2 ); ¢ ¯¥°¥¬¥­­®© x ­ µ®¤¨²±¿ ¯¥°¢»© ª®°¥­¼ ¨§ ±¯¨±ª . ¡¥ ¢¥°¸¨­» x ¨ next-x ¨¬¥¾² ±²¥¯¥­¼ 0, ¯°¨·¥¬ key[x] < key[next-x] (±«³· © 3). (¢) ®±«¥ ±¢¿§»¢ ­¨¿ ¢¥°¸¨­ (Binomial-Link) x ±² ­®¢¨²±¿ ¯¥°¢»¬ ¨§ ²°¥µ ª®°­¥©
®¤¨­ ª®¢®© ±²¥¯¥­¨ (±«³· © 2) (£) ª § ²¥«¨ ¯°®¤¢¨­³²» ¢¯¥°¥¤ ­  ®¤­³ ¯®§¨¶¨¾ ¢¤®«¼ ª®°­¥¢®£® ±¯¨±ª , x ¿¢«¿¥²±¿ ¯¥°¢»¬ ¨§ ¤¢³µ ª®°­¥© ®¤¨­ ª®¢®©
±²¥¯¥­¨ (±«³· © 4). (¤) ®±«¥ ±¢¿§»¢ ­¨¿ ¢¥°¸¨­ ¢®§­¨ª ¥² ±«³· © 3. (¥) ¹¥
®¤­® ±¢¿§»¢ ­¨¥ ¯°¨¢®¤¨² ª ±«³· ¾ 1 (±²¥¯¥­¼ ¢¥°¸¨­» x ° ¢­  3,   ±²¥¯¥­¼
next-x ° ¢­  4). °®¤¢¨¦¥­¨¥ ³ª § ²¥«¥© ¯°¨¢¥¤¥² ª ¢»µ®¤³ ¨§ ¶¨ª« , ² ª ª ª
next-x ±² ­¥² ° ¢­»¬ nil.

410

« ¢  20 ¨­®¬¨ «¼­»¥ ª³·¨

«³· © 1, ¨§®¡° ¦¥­­»© ­  °¨±³­ª¥ 20.6 , ¢®§­¨ª ¥², ª®£¤ 
degree[x] 6= degree[next-x], ². ¥. ª®£¤  x ¿¢«¿¥²±¿ ª®°­¥¬ ¤¥°¥¢  Bk ,  
next-x | ª®°­¥¬ ¤¥°¥¢  Bl ¤«¿ ­¥ª®²®°®£® l > k.  ­­®¬³ ±«³· ¾
±®®²¢¥²±²¢³¾² ±²°®ª¨ 11{12.  ½²®¬ ±«³· ¥ ¬» ¯°®±²® ¯°®¤¢¨£ ¥¬ ³ª § ²¥«¨ ­  ®¤­³ ¯®§¨¶¨¾ (®¡­®¢«¥­¨¥ ³ª § ²¥«¿ next-x ¡³¤¥²
¢»¯®«­¥­® ¢ ±²°®ª¥ 21).
«³· © 2, ¨§®¡° ¦¥­­»© ­  °¨±³­ª¥ 20.6¡, ¢®§­¨ª ¥², ª®£¤  ¢¥°¸¨­  x ¿¢«¿¥²±¿ ¯¥°¢®© ±°¥¤¨ ²°¥µ ª®°­¥¢»µ ¢¥°¸¨­ ®¤¨­ ª®¢®©
±²¥¯¥­¨ (degree[x] = degree[next-x] = degree[sibling[next-x]]).  ¢ ½²®¬
±«³· ¥ ¬» ¯°®¤¢¨£ ¥¬ ³ª § ²¥«¨ ¢¤®«¼ ±¯¨±ª .
 ±²°®ª¥ 10 ¬» ¯°®¢¥°¿¥¬, ¨¬¥¥² «¨ ¬¥±²® ®¤¨­ ¨§ ±«³· ¥¢
1 ¨«¨ 2, ¨ ¢ ±²°®ª µ 11{12 ¢»¯®«­¿¥¬ ¯°®¤¢¨¦¥­¨¥ ³ª § ²¥«¥©.
 ±«³· ¿µ 3 ¨ 4 §  ¢¥°¸¨­®© x ±«¥¤³¥² °®¢­® ®¤­  ¢¥°¸¨­  ²®©
¦¥ ±²¥¯¥­¨: degree[x] = degree[next-x] 6= degree[sibling[next-x]]. ²®
¬®¦¥² ¯°®¨§®©²¨ ¯®±«¥ ®¡° ¡®²ª¨ «¾¡®£® ¨§ ±«³· ¥¢ 1{4, ­® ¯®±«¥
±«³· ¿ 2 ¯°®¨§®©¤¥² ­ ¢¥°­¿ª . » ±¢¿§»¢ ¥¬ ¢¥°¸¨­» x ¨ next-x;
ª ª ¿ ¨§ ­¨µ ®±² ¥²±¿ ª®°­¥¬, § ¢¨±¨² ®² ²®£®, ª ª ±®®²­®±¿²±¿
ª«¾·¨ ¢ ½²¨µ ¤¢³µ ¢¥°¸¨­ µ.
 ±«³· ¥ 3 (°¨±. 20.6¢) key[x] 6 key[next-x], ¯®½²®¬³ ¢¥°¸¨­ 
next-x ¯®¤¢¥¸¨¢ ¥²±¿ ª ¢¥°¸¨­¥ x. ²°®ª  14 ³¤ «¿¥² ¢¥°¸¨­³

¯¥° ¶¨¨ ± ¡¨­®¬¨ «¼­»¬¨ ª³· ¬¨

411

¥²»°¥ ±«³· ¿ ¢ ¯°®¶¥¤³°¥ Binomial-Heap-Union.   ¢±¥µ °¨±³­ª µ ¢¥°¸¨­  x | ª®°¥­¼ ¤¥°¥¢  Bk ¨ l > k. ( ) «³· © 1: degree[x] 6=
degree[next-x]. ª § ²¥«¨ ¯°®¤¢¨£ ¾²±¿ ­  ®¤­³ ¯®§¨¶¨¾. (¡) «³· © 2:
degree[x] = degree[next-x] = degree[sibling[next-x]].  ¢ ½²®¬ ±«³· ¥ ³ª § ²¥«¨
¯°®¤¢¨£ ¾²±¿, ¨ ¯°¨ ±«¥¤³¾¹¥© ¨²¥° ¶¨¨ ¶¨ª«  ¢®§­¨ª­¥² ±«³· © 3 ¨«¨ 4.
(¢) «³· © 3: degree[x] = degree[next-x] 6= degree[sibling[next-x]], ¨ key[x] 6
key[next-x]. » ³¤ «¿¥¬ ¢¥°¸¨­³ next-x ¨§ ª®°­¥¢®£® ±¯¨±ª  ¨ ¯®¤¢¥¸¨¢ ¥¬
¥¥ ª ¢¥°¸¨­¥ x, ¯®«³· ¿ ¤¥°¥¢® Bk+1 . (£) «³· © 4: degree[x] = degree[next-x] 6=
degree[sibling[next-x]], ¨ key[next-x] < key[x]. » ³¤ «¿¥¬ ¢¥°¸¨­³ x ¨§ ª®°­¥¢®£®
±¯¨±ª  ¨ ¯®¤¢¥¸¨¢ ¥¬ ¥¥ ª ¢¥°¸¨­¥ next-x, ®¯¿²¼-² ª¨ ¯®«³· ¿ ¤¥°¥¢® Bk+1 .
¨±. 20.6

412

« ¢  20 ¨­®¬¨ «¼­»¥ ª³·¨

next-x ¨§ ª®°­¥¢®£® ±¯¨±ª ,   ±²°®ª  15 ¤¥« ¥² ¢¥°¸¨­³ next-x «¥¢»¬ °¥¡¥­ª®¬ ¢¥°¸¨­» x.
 ±«³· ¥ 4 (°¨±. 20.6£) ¬¥­¼¸¨© ª«¾· ¨¬¥¥² ¢¥°¸¨­  next-x, ¯®½²®¬³ ¢¥°¸¨­  x ¯®¤¢¥¸¨¢ ¥²±¿ ª ¢¥°¸¨­¥ next-x. ²°®ª¨ 16{18
³¤ «¿¾² ¢¥°¸¨­³ x ¨§ ª®°­¥¢®£® ±¯¨±ª ; ¢ ¦­® ° §«¨· ²¼, ¿¢«¿¥²±¿ «¨ ¢¥°¸¨­  x ¯¥°¢®© ¢ ±¯¨±ª¥ (±²°®ª  17) ¨«¨ ­¥² (±²°®ª  18).
²°®ª  19 ¤¥« ¥² ¢¥°¸¨­³ x «¥¢»¬ °¥¡¥­ª®¬ ¢¥°¸¨­» next-x,  
±²°®ª  20 ®¡­®¢«¿¥² x ¤«¿ ±«¥¤³¾¹¥© ¨²¥° ¶¨¨.
 ±«³· ¿µ 3 ¨ 4 ®¡° §®¢ «®±¼ ­®¢®¥ Bk+1 -¤¥°¥¢®, ­  ª®²®°®¥ ³ª §»¢ ¥² x.   ­¨¬ ¬®¦¥² ­ µ®¤¨²¼±¿ ®² ­³«¿ ¤® ¤¢³µ ¤¥°¥¢¼¥¢ ² ª®£® ¦¥ ° §¬¥° .   ±«¥¤³¾¹¥© ¨²¥° ¶¨¨ ¶¨ª«  ½²® ¯°¨¢¥¤¥² ª
±«³· ¿¬ 1, 3{4 ¨ 2 ±®®²¢¥²±²¢¥­­®.
°¥¬¿ ° ¡®²» ¯°®¶¥¤³°» Binomial-Heap-Union ¥±²¼ O(lg n),
£¤¥ n | ±³¬¬ °­®¥ ·¨±«® ¢¥°¸¨­ ¢ ª³· µ H1 ¨ H2 : ¢ ± ¬®¬ ¤¥«¥, ° §¬¥°» ª®°­¥¢»µ ±¯¨±ª®¢ ¢ ª³· µ H1 ¨ H2 ±³²¼ O(lg n) (ª®«¨·¥±²¢® ½«¥¬¥­²®¢ ¢ ®¡¥¨µ ª³· µ ­¥ ¡®«¼¸¥ n), ¨ ¯®±«¥ ±«¨¿­¨¿
¢ ±¯¨±ª¥ H ¡³¤¥² O(lg n) ½«¥¬¥­²®¢.  ¢°¥¬¿ ° ¡®²» ¯°®¶¥¤³°»
Binomial-Merge, ¨ ·¨±«® ¨²¥° ¶¨© ¶¨ª«  ¢ ±²°®ª µ 9{21 ¯°®¯®°¶¨®­ «¼­® ­ · «¼­®© ¤«¨­¥ ±¯¨±ª  H .  ¦¤ ¿ ¨²¥° ¶¨¿ ²°¥¡³¥²
¢°¥¬¥­¨ O(1), ² ª ·²® ®¡¹¥¥ ¢°¥¬¿ ¤¥©±²¢¨²¥«¼­® ¥±²¼ O(lg n).

®¡ ¢«¥­¨¥ ¢¥°¸¨­»
«¥¤³¾¹ ¿ ¯°®¶¥¤³°  ¤®¡ ¢«¿¥² ½«¥¬¥­² x ¢ ¡¨­®¬¨ «¼­³¾ ª³·³ H . °¥¤¯®« £ ¥²±¿, ·²® ½«¥¬¥­² x ³¦¥ ° §¬¥¹¥­ ¢ ¯ ¬¿²¨, ¨
¯®«¥ ª«¾·  key[x] § ¯®«­¥­®.
Binomial-Heap-Insert (H; x)
1 H 0 Make-Binomial-Heap()
2 p[x] nil
3 child[x] nil
4 sibling[x] nil
5 degree[x] 0
6 head[H 0] x
7 H Binomial-Heap-Union(H; H 0)
¤¥¿ ¯°®±² : §  ¢°¥¬¿ O(1) ¬» ±®§¤ ¥¬ ¡¨­®¬¨ «¼­³¾ ª³·³ H 0 ¨§
®¤­®© ¢¥°¸¨­» x ¨ §  ¢°¥¬¿ O(lg n) ®¡º¥¤¨­¿¥¬ ¥¥ ± ¡¨­®¬¨ «¼­®© ª³·¥© H , ±®±²®¿¹¥© ¨§ n ¢¥°¸¨­. (®±«¥ ½²®£® ¯ ¬¿²¼, ¢°¥¬¥­­® ®²¢¥¤¥­­ ¿ ¤«¿ H 0, ®±¢®¡®¦¤ ¥²±¿). ¥ «¨§ ¶¨¿ ¯°®¶¥¤³°»
Binomial-Heap-Insert ¡¥§ ±±»«ª¨ ­  Binomial-Heap-Union ±®±² ¢«¿¥² ³¯°. 20.2-8.

¯¥° ¶¨¨ ± ¡¨­®¬¨ «¼­»¬¨ ª³· ¬¨

413

¤ «¥­¨¥ ¢¥°¸¨­» ± ¬¨­¨¬ «¼­»¬ ª«¾·®¬
«¥¤³¾¹ ¿ ¯°®¶¥¤³°  ¨§»¬ ¥² ¨§ ¡¨­®¬¨ «¼­®© ª³·¨ H ¢¥°¸¨­³ ± ¬¨­¨¬ «¼­»¬ ª«¾·®¬ ¨ ¢®§¢° ¹ ¥² ³ª § ²¥«¼ ­  ¨§º¿²³¾
¢¥°¸¨­³. ®±ª®«¼ª³ ¬¨­¨¬ «¼­»© ½«¥¬¥­² ­ µ®¤¨²±¿ ¢ ª®°­¥¢®¬
±¯¨±ª¥, ­ ©²¨ ¥£® «¥£ª®; ¯®±«¥ ¥£® ³¤ «¥­¨¿ ±®®²¢¥²±²¢³¾¹¥¥ ¤¥°¥¢® ° ±±»¯ ¥²±¿ ¢ ­ ¡®° ¡¨­®¬¨ «¼­»µ ¤¥°¥¢¼¥¢ ¬¥­¼¸¥£® ° §¬¥° ,
ª®²®°»© ­ ¤® ®¡º¥¤¨­¨²¼ ± ®±² ¢¸¥©±¿ · ±²¼¾ ª³·¨.
Binomial-Heap-Extract-Min(H )
1 ¢ ª®°­¥¢®¬ ±¯¨±ª¥ H ­ ©²¨ ¢¥°¸¨­³ x ± ¬¨­¨¬ «¼­»¬
ª«¾·®¬ ¨ ³¤ «¨²¼ x ¨§ ª®°­¥¢®£® ±¯¨±ª 
2 H 0 Make-Binomial-Heap()
3 ®¡° ²¨²¼ ¯®°¿¤®ª ¢ ±¯¨±ª¥ ¤¥²¥© ¢¥°¸¨­» x
¨ ¯®¬¥±²¨²¼ ¢ head[H 0] ³ª § ²¥«¼ ­  ­ · «®
¯®«³·¨¢¸¥£®±¿ ±¯¨±ª 
4 H Binomial-Heap-Union(H; H 0)
5 return x
 ¡®²  ¯°®¶¥¤³°» ¯®ª § ­  ­  °¨±³­ª¥ 20.7. ±¥ ¤¥©±²¢¨¿ ¢»¯®«­¿¾²±¿ §  ¢°¥¬¿ O(lg n), ² ª ·²® ®¡¹¥¥ ¢°¥¬¿ ° ¡®²» ¯°®¶¥¤³°» Binomial-Heap-Extract-Min ¥±²¼ O(log n).
¬¥­¼¸¥­¨¥ ª«¾· 
«¥¤³¾¹ ¿ ¯°®¶¥¤³°  ³¬¥­¼¸ ¥² ª«¾· ½«¥¬¥­²  x ¡¨­®¬¨ «¼­®© ª³·¨ H , ¯°¨±¢ ¨¢ ¿ ¥¬³ ­®¢®¥ §­ ·¥­¨¥ k (¥±«¨ k ¡®«¼¸¥, ·¥¬
²¥ª³¹¥¥ §­ ·¥­¨¥ ª«¾· , ¢»¤ ¥²±¿ ±®®¡¹¥­¨¥ ®¡ ®¸¨¡ª¥).
Binomial-Heap-Decrease-Key (H; x; k)
1 if k > key[x]
2
then error À­®¢®¥ §­ ·¥­¨¥ ª«¾·  ¡®«¼¸¥ ²¥ª³¹¥£®Á
3 key[x] k
4 y x
5 z p[y ]
6 while z 6= nil and key[y ] < key[z ]
7
do ®¡¬¥­ key[y ] $ key[z ]
8
. (¢¬¥±²¥ ± ¤®¯®«­¨²¥«¼­®© ¨­´®°¬ ¶¨¥©).
9
y z
10
z p[y ]
 ¤ ­­®© ¯°®¶¥¤³°¥ ¨±¯®«¼§³¥²±¿ ²®² ¦¥ ¯°¨¥¬, ·²® ¨ ¢ £« ¢¥ 7: ¢¥°¸¨­ , ª«¾· ª®²®°®© ¡»« ³¬¥­¼¸¥­, À¢±¯«»¢ ¥²Á ­ ¢¥°µ
(°¨±. 20.8).
®±«¥ ¯°®¢¥°ª¨ ª®°°¥ª²­®±²¨ ¢µ®¤­»µ ¤ ­­»µ (±²°®ª¨ 1{2) ¢
¢¥°¸¨­¥ x ¬¥­¿¥²±¿ §­ ·¥­¨¥ ª«¾· . ®±«¥ ±²°®ª 4 ¨ 5 ¯¥°¥¬¥­-

414

« ¢  20 ¨­®¬¨ «¼­»¥ ª³·¨

 ¡®²  ¯°®¶¥¤³°» Binomial-Heap-Extract-Min. ( ) ±µ®¤­ ¿ ¡¨­®¬¨ «¼­ ¿ ª³·  H . (¡) ®°­¥¢ ¿ ¢¥°¸¨­  x, ¨¬¥¾¹ ¿ ¬¨­¨¬ «¼­»© ª«¾·,
³¤ «¥­  ¨§ ª®°­¥¢®£® ±¯¨±ª  H . ­  ¡»«  ª®°­¥¬ Bk -¤¥°¥¢ ,   ¥¥ ¤¥²¨ ¡»«¨
ª®°­¿¬¨ Bk;1 -, Bk;2 -, : : : , B0 -¤¥°¥¢¼¥¢. (¢) ¡° ¹ ¿ ¯®°¿¤®ª, ¬» ±®¡¨° ¥¬ ¯®²®¬ª®¢ ¢¥°¸¨­» x ¢ ¡¨­®¬¨ «¼­³¾ ª³·³ H 0 . (£) ¥§³«¼² ² ±®¥¤¨­¥­¨¿ ª³· H
¨ H 0.
¨±. 20.7

¯¥° ¶¨¨ ± ¡¨­®¬¨ «¼­»¬¨ ª³· ¬¨

415

 ¡®²  ¯°®¶¥¤³°» Binomial-Heap-Decrease-Key. ( ) ¥°¥¤ ­ · «®¬ ¶¨ª«  (ª«¾· ¢¥°¸¨­» y ¡»« ³¬¥­¼¸¥­ ¨ ±² « ¬¥­¼¸¥ ª«¾·  °®¤¨²¥«¼±ª®©
¢¥°¸¨­» z ). (¡) ¥°¥¤ ¢²®°®© ¨²¥° ¶¨¥© ¶¨ª« . °®¨§®¸¥« ®¡¬¥­ ª«¾· ¬¨,
³ª § ²¥«¨ y ¨ z ¯°®¤¢¨­³²» ¢¢¥°µ, ­® ±¢®©±²¢® ¯®°¿¤ª  ¯®ª  ­ °³¸¥­®. (¢) ®±«¥ ±«¥¤³¾¹¥£® ®¡¬¥­  ¨ ±¤¢¨£  ³ª § ²¥«¥© y ¨ z ¢¢¥°µ ±¢®©±²¢® ³¯®°¿¤®·¥­­®±²¨ ¢»¯®«­¥­®, ¨ ¶¨ª« ¯°¥ª° ¹ ¥²±¿.
¨±. 20.8

­ ¿ y ±®¤¥°¦¨² ¥¤¨­±²¢¥­­³¾ ¢¥°¸¨­³, ¢ ª®²®°®© ª«¾· ¬®¦¥²
¡»²¼ ¬¥­¼¸¥ ª«¾·¥© ¯°¥¤ª®¢,   z | ¥¥ °®¤¨²¥«¿.  ·¨­ ¥²±¿ ¶¨ª«:
¥±«¨ key[y ] > key[z ] ¨«¨ ¥±«¨ ¢¥°¸¨­  y ¿¢«¿¥²±¿ ª®°­¥¢®©, ²® ¤¥°¥¢® ³¯®°¿¤®·¥­®.  ¯°®²¨¢­®¬ ±«³· ¥ ¬» ¬¥­¿¥¬ ¬¥±² ¬¨ ±®¤¥°¦¨¬®¥ ¢¥°¸¨­ y ¨ z , ²¥¬ ± ¬»¬ ±¤¢¨£ ¿ ¬¥±²® ­ °³¸¥­¨¿ ¢¢¥°µ
¯® ¤¥°¥¢³, ·²® ®²° ¦¥­® ¢ ±²°®ª µ 9{10.
°®¶¥¤³°  Binomial-Heap-Decrease-Key ¢»¯®«­¿¥²±¿ §  ¢°¥¬¿ O(lg n), ¯®±ª®«¼ª³ £«³¡¨­  ¢¥°¸¨­» x ¥±²¼ O(lg n) (³²¢¥°¦¤¥­¨¥ 2 «¥¬¬» 20.1),   ¯°¨ ª ¦¤®© ¨²¥° ¶¨¨ ¶¨ª«  while ¬» ¯®¤­¨¬ ¥¬±¿ ¢¢¥°µ.
¤ «¥­¨¥ ¢¥°¸¨­»
¤ «¥­¨¥ ¢¥°¸¨­» ±¢®¤¨²±¿ ª ¤¢³¬ ¯°¥¤»¤³¹¨¬ ®¯¥° ¶¨¿¬: ¬»
³¬¥­¼¸ ¥¬ ª«¾· ¤® ;1 (±¯¥¶¨ «¼­®¥ §­ ·¥­¨¥, ¯°® ª®²®°®¥ ¬»
¯°¥¤¯®« £ ¥¬, ·²® ®­® ¬¥­¼¸¥ ¢±¥µ ª«¾·¥©),   § ²¥¬ ³¤ «¿¥¬ ¢¥°-

416

« ¢  20 ¨­®¬¨ «¼­»¥ ª³·¨

¸¨­³ ± ¬¨­¨¬ «¼­»¬ ª«¾·®¬.
 ¯°®¶¥±±¥ ¢»¯®«­¥­¨¿ ¯°®¶¥¤³°» Binomial-Heap-DecreaseKey ±¯¥¶¨ «¼­®¥ §­ ·¥­¨¥ ;1 (¥¤¨­±²¢¥­­®¥ ¢ ª³·¥) ¢±¯«»¢ ¥²
¢¢¥°µ, ®²ª³¤  ¨ ³¤ «¿¥²±¿ ¯°®¶¥¤³°®© Binomial-Heap-ExtractMin.
Binomial-Heap-Delete (H; x)
1 Binomial-Heap-Decrease-Key(H; x; ;1)
2 Binomial-Heap-Extract-Min(H )
( ³¯°. 20.2-6 ¯°¥¤« £ ¥²±¿ ¯¥°¥¯¨± ²¼ ¯°®¶¥¤³°³ BinomialHeap-Delete ¡¥§ ¨±¯®«¼§®¢ ­¨¿ ¤®¯®«­¨²¥«¼­®£® §­ ·¥­¨¿ ;1.)
°®¶¥¤³°  Binomial-Heap-Delete ¢»¯®«­¿¥²±¿ §  ¢°¥¬¿ O(lg n).
¯° ¦­¥­¨¿
20.2-1 ¡º¿±­¨²¥, ¯®·¥¬³ ±«¨¿­¨¥ ¤¢®¨·­»µ ª³· ¢ ±¬»±«¥ £« ¢» 7 ²°¥¡³¥² ¢°¥¬¥­¨ (n).
20.2-2  ¯¨¸¨²¥ ¯°®¶¥¤³°³ Binomial-Heap-Merge.
20.2-3  °¨±³©²¥ ¡¨­®¬¨ «¼­³¾ ª³·³, ª®²®° ¿ ¯®«³· ¥²±¿ ¯°¨
¤®¡ ¢«¥­¨¨ ¢¥°¸¨­» ± ª«¾·®¬ 24 ª ª³·¥ °¨±. 20.7£.
20.2-4  °¨±³©²¥ ¡¨­®¬¨ «¼­³¾ ª³·³, ª®²®° ¿ ¯®«³· ¥²±¿ ¯°¨
³¤ «¥­¨¨ ª«¾·  28 ¨§ ª³·¨ °¨±. 20.8¢.
20.2-5 ®·¥¬³ ¯°®¶¥¤³°  Binomial-Heap-Minimum ­¥ £®¤¨²±¿,
¥±«¨ ­¥ª®²®°»¥ ¨§ ª«¾·¥© ¨¬¥¾² §­ ·¥­¨¥ 1?  ª ±¤¥« ²¼ ¥¥ ¯°¨£®¤­®© ¨ ¤«¿ ½²®£® ±«³· ¿?
20.2-6 ¥ ¯®«¼§³¿±¼ ±¯¥¶¨ «¼­»¬ §­ ·¥­¨¥¬ ;1, ¯¥°¥¯¨¸¨²¥
¯°®¶¥¤³°³ Binomial-Heap-Delete. (¶¥­ª  O(log n) ¤«¿ ¢°¥¬¥­¨ ° ¡®²» ¤®«¦­  ±®µ° ­¨²¼±¿.)
20.2-7  ·¥¬ ±®±²®¨² ³¯®¬¨­ ¢¸ ¿±¿ ±¢¿§¼ ¬¥¦¤³ ±®¥¤¨­¥­¨¥¬
¡¨­®¬¨ «¼­»µ ª³· ¨ ±«®¦¥­¨¥¬ ¤¢®¨·­»µ ·¨±¥«? ¡º¿±­¨²¥ ±¢¿§¼
¬¥¦¤³ ¤®¡ ¢«¥­¨¥¬ ¢¥°¸¨­» ¢ ¡¨­®¬¨ «¼­³¾ ª³·³ ¨ ¯°¨¡ ¢«¥­¨¥¬
¥¤¨­¨¶» ª ¤¢®¨·­®¬³ ·¨±«³.
20.2-8 ¬¥¿ ¢ ¢¨¤³ ±®®²¢¥²±²¢¨¥, ³¯®¬¿­³²®¥ ¢ ³¯°. 20.2-7, ¯¥°¥¯¨¸¨²¥ ¯°®¶¥¤³°³ Binomial-Heap-Insert ² ª, ·²®¡» ®­  ¤®¡ ¢«¿«  ¢¥°¸¨­³ ¢ ¡¨­®¬¨ «¼­³¾ ª³·³ ­¥¯®±°¥¤±²¢¥­­®,   ­¥ ¢»§»¢ «  Binomial-Heap-Union.
20.2-9 ®ª ¦¨²¥, ·²® ¥±«¨ ° ±¯®« £ ²¼ ¢¥°¸¨­» ¢ ª®°­¥¢»µ
±¯¨±ª µ ¢ ¯®°¿¤ª¥ ³¬¥­¼¸¥­¨¿ (  ­¥ ³¢¥«¨·¥­¨¿) ±²¥¯¥­¥©, ²® ¯®-

 ¤ ·¨ ª £« ¢¥ 20

417

¯°¥¦­¥¬³ ¢±¥ ®¯¥° ¶¨¨ ­ ¤ ¡¨­®¬¨ «¼­»¬¨ ª³· ¬¨ ¬®¦­® °¥ «¨§®¢ ²¼ ± ²¥¬¨ ¦¥  ±¨¬¯²®²¨·¥±ª¨¬¨ ®¶¥­ª ¬¨.
20.2-10 ®ª ¦¨²¥, ·²® ¢°¥¬¿ ° ¡®²» ¯°®¶¥¤³° Binomial-HeapExtract-Min, Binomial-Heap-Decrease-Key ¨ BinomialHeap-Delete ¢ µ³¤¸¥¬ ±«³· ¥ ­  ¢µ®¤ µ ° §¬¥°  n ¥±²¼ 
(lg n).
¡º¿±­¨²¥, ¯®·¥¬³ ¢°¥¬¿ ¢»¯®«­¥­¨¿ ¯°®¶¥¤³° BinomialHeap-Insert ¨ Binomial-Heap-Minimum ¢ µ³¤¸¥¬ ±«³· ¥ ±®±² 1
¢«¿¥² 
(lg n) (±¬. § ¤. 2-5),   ­¥ 
(lg n).

 ¤ ·¨
20-1 2-3-4-ª³·¨
 £« ¢¥ 19 ° ±±¬ ²°¨¢ «¨±¼ 2-3-4-¤¥°¥¢¼¿, ¢ ª®²®°»µ ª ¦¤ ¿ ¢¥°¸¨­ , ­¥ ¿¢«¿¾¹ ¿±¿ ª®°­¥¬ ¨«¨ «¨±²®¬, ¨¬¥¥² ¤¢³µ, ²°¥µ ¨«¨ ·¥²»°¥µ ¤¥²¥©, ¨ ¢±¥ «¨±²¼¿ ° ±¯®« £ ¾²±¿ ­  ®¤¨­ ª®¢®© £«³¡¨­¥.
¯°¥¤¥«¨¬ 2-3-4-ª³·¨ (2-3-4 heaps), ­ ¤ ª®²®°»¬¨ ¬®¦­® ¯°®¨§¢®¤¨²¼ ®¯¥° ¶¨¨, ¯°¥¤³±¬®²°¥­­»¥ ¤«¿ ±«¨¢ ¥¬»µ ª³·.
 ª ¿ ª³·  ¯®«³· ¥²±¿, ¥±«¨ ¢ ª ¦¤®¬ «¨±²¥ § ¯¨± ²¼ ª«¾·,   ¢
ª ¦¤®© ¢­³²°¥­­¥© ¢¥°¸¨­¥ µ° ­¨²¼ ­ ¨¬¥­¼¸¥¥ §­ ·¥­¨¥ ª«¾·¥©
¢ «¨±²¼¿µ, ¿¢«¿¾¹¨µ±¿ ¯®²®¬ª ¬¨ ½²®© ¢¥°¸¨­». ­ ·¥­¨¿ ª«¾·¥©
¢ «¨±²¼¿µ ¬®£³² ¡»²¼ «¾¡»¬¨ (²°¥¡®¢ ­¨¿ ³¯®°¿¤®·¥­­®±²¨ ­¥²).
 ª®°­¥ µ° ­¨²±¿ ¢»±®²  ¤¥°¥¢ .
°¨¤³¬ ©²¥ ±¯®±®¡ °¥ «¨§ ¶¨¨ ¯¥°¥·¨±«¥­­»µ ­¨¦¥ ®¯¥° ¶¨©
­ ¤ 2-3-4-ª³· ¬¨ §  ¢°¥¬¿ O(lg n), £¤¥ n | ·¨±«® ½«¥¬¥­²®¢ 2-3-4ª³·¨. ¯¥° ¶¨¿ Union ¢ ¯³­ª²¥ ¥ ¤®«¦­  ¢»¯®«­¿²¼±¿ §  ¢°¥¬¿
O(lg n), £¤¥ n | ±³¬¬ °­®¥ ·¨±«® ½«¥¬¥­²®¢ ¢ ¤¢³µ ®¡º¥¤¨­¿¥¬»µ
ª³· µ.
 . Minimum ¢®§¢° ¹ ¥² ³ª § ²¥«¼ ­  «¨±² ± ­ ¨¬¥­¼¸¨¬ ª«¾·®¬.
¡. Decrease-Key ³¬¥­¼¸ ¥² ª«¾· § ¤ ­­®£® «¨±²  x, ¯°¨±¢ ¨¢ ¿
ª«¾·³ § ¤ ­­®¥ §­ ·¥­¨¥ k 6 key[x].
¢. Insert ¤®¡ ¢«¿¥² «¨±² x ± ª«¾·®¬ k.
£. Delete ³¤ «¿¥² § ¤ ­­»© «¨±² x.
¤. Extract-Min ¨§»¬ ¥² «¨±² ± ­ ¨¬¥­¼¸¨¬ ª«¾·®¬.
¥. Union ®¡º¥¤¨­¿¥² ¤¢¥ 2-3-4-ª³·¨ ¢ ®¤­³ (¨±µ®¤­»¥ ª³·¨ ¯°®¯ ¤ ¾²).
20-2 ®¨±ª ¬¨­¨¬ «¼­®£® ¯®ª°»¢ ¾¹¥£® ¤¥°¥¢  ± ¨±¯®«¼§®¢ ­¨¥¬ ±«¨¢ ¥¬»µ ª³·
 £« ¢¥ 24 ¯°¨¢®¤¿²±¿ ¤¢   «£®°¨²¬  ¯®±²°®¥­¨¿ ¬¨­¨¬ «¼­®£® ¯®ª°»¢ ¾¹¥£® ¤¥°¥¢  ¤«¿ ­¥®°¨¥­²¨°®¢ ­­®£® £° ´ . ¥©· ±
¬» ³ª ¦¥¬ ¥¹¥ ®¤¨­ ±¯®±®¡ °¥¸¥­¨¿ ½²®© § ¤ ·¨, ¨±¯®«¼§³¾¹¨©
±«¨¢ ¥¬»¥ ª³·¨.

418

« ¢  20 ¨­®¬¨ «¼­»¥ ª³·¨

³±²¼ G = (V; E ) | ±¢¿§­»© ­¥®°¨¥­²¨°®¢ ­­»© £° ´, a w : E !
| ¢¥±®¢ ¿ ´³­ª¶¨¿, ±² ¢¿¹ ¿ ¢ ±®®²¢¥²±²¢¨¥ ª ¦¤®¬³ °¥¡°³
(u; v ) ¥£® ¢¥± w(u; v ). » µ®²¨¬ ­ ©²¨ ¬¨­¨¬ «¼­®¥ ¯®ª°»¢ ¾¹¥¥ ¤¥°¥¢® £° ´  G, ². ¥.  ¶¨ª«¨·¥±ª®¥ ¬­®¦¥±²¢® T  E , ª®²®°®¥ ±®¥¤¨­¿¥²
¢±¥ ¢¥°¸¨­» £° ´ , ¤«¿ ª®²®°®£® ±³¬¬ °­»© ¢¥±
P
w(T ) =
w(u; v) ¬¨­¨¬ «¥­.
(u;v)2T
«¥¤³¾¹ ¿ ¯°®£° ¬¬  (¥¥ ª®°°¥ª²­®±²¼ ¤®ª §»¢ ¥²±¿ ± ¨±¯®«¼§®¢ ­¨¥¬ ¬¥²®¤®¢ ° §¤¥«  24.1) ±²°®¨² ¬¨­¨¬ «¼­®¥ ¯®ª°»¢ ¾¹¥¥
¤¥°¥¢® T . °®£° ¬¬  µ° ­¨² ° §¡¨¥­¨¥ fVig ¬­®¦¥±²¢  ¢¥°¸¨­ V ,
¨ ¤«¿ ª ¦¤®£® ¨§ ¬­®¦¥±²¢ Vi µ° ­¨² ­¥ª®²®°®¥ ¬­®¦¥±²¢®
R

Ei  f(u; v ) : u 2 Vi ¨«¨ v 2 Vi g
°¥¡¥°, ¨­¶¨¤¥­²­»µ ¢¥°¸¨­ ¬ ¨§ Vi.
MST-Mergeable-Heap (G)
1 T ;
2 for (¤«¿) ª ¦¤®© ¢¥°¸¨­» vi 2 V [G]
3
do Vi fvi g
4
Ei f(vi ; v) 2 E [G]g

5 while (¯®ª ) ¨¬¥¥²±¿ ¡®«¥¥ ®¤­®£® ¬­®¦¥±²¢  Vi
6
do ¢»¡° ²¼ «¾¡®¥ ¬­®¦¥±²¢® Vi
7
¨§º¿²¼ ¨§ Ei °¥¡°® (u; v ), ¨¬¥¾¹¥¥ ¬¨­¨¬ «¼­»© ¢¥±
8
(¡³¤¥¬ ±·¨² ²¼, ·²® u 2 Vi ¨ v 2 Vj )
9
if i 6= j
10
then T T [ f(u; v )g
11
Vi Vi [ Vj , (Vj ¯°®¯ ¤ ¥²)
12
Ei Ei [ Ej
¯¨¸¨²¥, ª ª °¥ «¨§®¢ ²¼ ½²®²  «£®°¨²¬ ± ¯®¬®¹¼¾ ®¯¥° ¶¨©
±® ±«¨¢ ¥¬»¬¨ ª³· ¬¨, ¯¥°¥·¨±«¥­­»µ ¢ ² ¡«¨¶¥ 20.1. ¶¥­¨²¥
¢°¥¬¿ ° ¡®²»  «£®°¨²¬ , ¥±«¨ ¢ ª ·¥±²¢¥ ±«¨¢ ¥¬»µ ª³· ¨±¯®«¼§³¾²±¿ ¡¨­®¬¨ «¼­»¥ ª³·¨.

 ¬¥· ­¨¿
¨­®¬¨ «¼­»¥ ª³·¨ ¡»«¨ ¢¢¥¤¥­» ¢ 1978 £®¤³ ¨««¥¬¨­®¬ [196].
®¤°®¡­® ¨µ ±¢®©±²¢  ¨§³· « ° ³­ [36,37].

21

¨¡®­ ··¨¥¢» ª³·¨

 £« ¢¥ 20 ¬» ¨§³· «¨ ¡¨­®¬¨ «¼­»¥ ª³·¨, ± ¯®¬®¹¼¾ ª®²®°»µ
¬®¦­® °¥ «¨§®¢ ²¼ §  ¢°¥¬¿ O(lg n) (¢ µ³¤¸¥¬ ±«³· ¥) ®¯¥° ¶¨¨
Insert, Minimum, Extract-Min, Union,   ² ª¦¥ Decrease-Key
¨ Delete. (²°³ª²³°» ¤ ­­»µ, ¯®¤¤¥°¦¨¢ ¾¹¨¥ ¯¥°¢»¥ ·¥²»°¥
¨§ ¯¥°¥·¨±«¥­­»µ ®¯¥° ¶¨©, ­ §»¢ ¾²±¿ À±«¨¢ ¥¬»¬¨ ª³· ¬¨Á.) 
½²®© £« ¢¥ ¬» ° ±±¬ ²°¨¢ ¥¬ ´¨¡®­ ··¨¥¢» ª³·¨, ª®²®°»¥ ¯®¤¤¥°¦¨¢ ¾² ²¥ ¦¥ ¸¥±²¼ ®¯¥° ¶¨©, ­® ¡®«¥¥ ½´´¥ª²¨¢­®: ®¯¥° ¶¨¨,
­¥ ²°¥¡³¾¹¨¥ ³¤ «¥­¨¿ ½«¥¬¥­²®¢, ¨¬¥¾² ³·¥²­³¾ ±²®¨¬®±²¼ O(1).
¥®°¥²¨·¥±ª¨ ´¨¡®­ ··¨¥¢» ª³·¨ ®±®¡¥­­® ¯®«¥§­», ¥±«¨ ·¨±«®
®¯¥° ¶¨© Extract-Min ¨ Delete ¬ «® ¯® ±° ¢­¥­¨¾ ± ®±² «¼­»¬¨ ®¯¥° ¶¨¿¬¨.  ª ¿ ±¨²³ ¶¨¿ ¢®§­¨ª ¥² ¢® ¬­®£¨µ ¯°¨«®¦¥­¨¿µ.  ¯°¨¬¥°,  «£®°¨²¬, ®¡° ¡ ²»¢ ¾¹¨© £° ´, ¬®¦¥² ¢»§»¢ ²¼
¯°®¶¥¤³°³ Decrease-Key ¤«¿ ª ¦¤®£® °¥¡°  £° ´ . «¿ ¯«®²­»µ
£° ´®¢, ¨¬¥¾¹¨µ ¬­®£® °¥¡¥°, ¯¥°¥µ®¤ ®² O(lg n) ª O(1) ¢ ®¶¥­ª¥ ¢°¥¬¥­¨ ° ¡®²» ¤«¿ ®¯¥° ¶¨¨ Decrease-Key ¬®¦¥² ¯°¨¢¥±²¨
ª § ¬¥²­®¬³ ³¬¥­¼¸¥­¨¾ ®¡¹¥£® ¢°¥¬¥­¨ ° ¡®²».  ¨¡®«¥¥ ¡»±²°»¥ ¨§¢¥±²­»¥  «£®°¨²¬» ¤«¿ § ¤ · ¯®±²°®¥­¨¿ ¬¨­¨¬ «¼­®£®
¯®ª°»¢ ¾¹¥£® ¤¥°¥¢  (£« ¢  24) ¨«¨ ¯®¨±ª  ª° ²· ©¸¨µ ¯³²¥© ¨§
®¤­®© ¢¥°¸¨­» (£« ¢  25) ±³¹¥±²¢¥­­® ¨±¯®«¼§³¾² ´¨¡®­ ··¨¥¢»
ª³·¨.
 ±®¦ «¥­¨¾, ±ª°»²»¥ ª®­±² ­²» ¢  ±¨¬¯²®²¨·¥±ª®© § ¯¨±¨ ¢¥«¨ª¨, ¨ ¨±¯®«¼§®¢ ­¨¥ ´¨¡®­ ··¨¥¢»µ ª³· °¥¤ª® ®ª §»¢ ¥²±¿ ¶¥«¥±®®¡° §­»¬: ®¡»·­»¥ ¤¢®¨·­»¥ (¨«¨ k-¨·­»¥) ª³·¨ ­  ¯° ª²¨ª¥
½´´¥ª²¨¢­¥¥.  ¯° ª²¨·¥±ª®© ²®·ª¨ §°¥­¨¿ ¡»«® ¡» ®·¥­¼ ¦¥« ²¥«¼­® ¯°¨¤³¬ ²¼ ±²°³ª²³°³ ¤ ­­»µ ± ²¥¬¨ ¦¥  ±¨¬¯²®²¨·¥±ª¨¬¨
®¶¥­ª ¬¨, ­® ± ¬¥­¼¸¨¬¨ ª®­±² ­² ¬¨.
±¯®«¼§³¿ ¡¨­®¬¨ «¼­»¥ ª³·¨ ¤«¿ µ° ­¥­¨¿ ­ ¡®°  ¬­®¦¥±²¢,
¬» µ° ­¨«¨ ª ¦¤®¥ ¨§ ¬­®¦¥±²¢ ­ ¡®°  ¢ ­¥±ª®«¼ª¨µ ¡¨­®¬¨ «¼­»µ ¤¥°¥¢¼¿µ, ±¢¿§ ­­»µ ¢ ±¯¨±®ª. ¥©· ± ¬» ¡³¤¥¬ ¯®±²³¯ ²¼
 ­ «®£¨·­»¬ ®¡° §®¬, ¨±¯®«¼§³¿ ´¨¡®­ ··¨¥¢» ¤¥°¥¢¼¿ (ª®²®°»¥
¬» ¢±ª®°¥ ®¯°¥¤¥«¨¬) ¢¬¥±²® ¡¨­®¬¨ «¼­»µ.
±«¨ ¬» ­¨ª®£¤  ­¥ ¢»¯®«­¿¥¬ ®¯¥° ¶¨¨ Decrease-Key ¨
Delete, ²® ¢®§­¨ª ¾¹¨¥ ´¨¡®­ ··¨¥¢» ¤¥°¥¢¼¿ ¡³¤³² ¨¬¥²¼ ²³
¦¥ ±²°³ª²³°³, ·²® ¨ ¡¨­®¬¨ «¼­»¥ ¤¥°¥¢¼¿. ® ¢ ®¡¹¥¬ ±«³· ¥

420

« ¢  21 ¨¡®­ ··¨¥¢» ª³·¨

´¨¡®­ ··¨¥¢» ¤¥°¥¢¼¿ ®¡« ¤ ¾² ¡®«¼¸¥© £¨¡ª®±²¼¾, ·¥¬ ¡¨­®¬¨ «¼­»¥ (¨§ ­¨µ ¬®¦­® ³¤ «¿²¼ ­¥ª®²®°»¥ ¢¥°¸¨­», ®²ª« ¤»¢ ¿
¯¥°¥±²°®©ª³ ¤¥°¥¢  ¤® ³¤®¡­®£® ±«³· ¿).
 ª ¨ ¤¨­ ¬¨·¥±ª¨¥ ² ¡«¨¶» ° §¤¥«  18.4, ´¨¡®­ ··¨¥¢» ª³·¨
¿¢«¿¾²±¿ ¯°¨¬¥°®¬ ±²°³ª²³°» ¤ ­­»µ, ° §° ¡®² ­­®© ± ³·¥²®¬
 ¬®°²¨§ ¶¨®­­®£®  ­ «¨§  (±¬. £«. 18, ®±®¡¥­­® ° §¤. 18.3 ® ¬¥²®¤¥
¯®²¥­¶¨ « ).
» ¯°¥¤¯®« £ ¥¬, ·²® ¢» ¯°®·«¨ ¯°¥¤»¤³¹³¾ £« ¢³ (® ¡¨­®¬¨ «¼­»µ ª³· µ).  ¬ ¡»«  ¯°¨¢¥¤¥­  ² ¡«¨¶  (°¨±. 20.1), £¤¥ ³ª § ­» ®¶¥­ª¨ ¢°¥¬¥­¨ ° ¡®²» ° §«¨·­»µ ®¯¥° ¶¨© ± ¡¨­®¬¨ «¼­»¬¨
¨ ´¨¡®­ ··¨¥¢»¬¨ ª³· ¬¨.
 ª ¨ ¡¨­®¬¨ «¼­»¥ ª³·¨, ´¨¡®­ ··¨¥¢» ª³·¨ ­¥ ®¡¥±¯¥·¨¢ ¾²
½´´¥ª²¨¢­®£® ¢»¯®«­¥­¨¿ ¯®¨±ª  (Search). ®½²®¬³ ¯¥°¥¤ ¢ ¿
¢¥°¸¨­³ ¢ ª ·¥±²¢¥ ¯ ° ¬¥²° , ¬» ³ª §»¢ ¥¬ ­¥ ª«¾· ¢¥°¸¨­»,  
³ª § ²¥«¼ ­  ­¥¥.
 ° §¤¥«¥ 21.1 ¬» ®¯°¥¤¥«¨¬ ´¨¡®­ ··¨¥¢» ª³·¨, ®¡±³¤¨¬ ¨µ
¯°¥¤±² ¢«¥­¨¥ ¢ ¯°®£° ¬¬¥ ¨ ¢¢¥¤¥¬ ¯®²¥­¶¨ «¼­³¾ ´³­ª¶¨¾. 
° §¤¥«¥ 21.2 ¬» ¯®ª ¦¥¬, ª ª °¥ «¨§®¢ ²¼ ®¯¥° ¶¨¨, ¯°¨±³¹¨¥
±«¨¢ ¥¬»¬ ª³· ¬, ± ®¶¥­ª ¬¨ ³·¥²­®© ±²®¨¬®±²¨, ³ª § ­­»¬¨ ¢
² ¡«¨¶¥ (°¨±. 20.1). ±² ¢¸¨¥±¿ ¤¢¥ ®¯¥° ¶¨¨ (Decrease-Key ¨
Delete) ®¯¨± ­» ¢ ° §¤¥«¥ 21.3.  ª®­¥¶, ¢ ° §¤¥«¥ 21.4 ¬» ¤®ª §»¢ ¥¬ «¥¬¬³, ¨±¯®«¼§®¢ ­­³¾ ¯°¨  ­ «¨§¥ ¯®±²°®¥­­»µ ¯°®¶¥¤³°.

21.1. ²°®¥­¨¥ ´¨¡®­ ··¨¥¢®© ª³·¨
°¨ ¨±¯®«¼§®¢ ­¨¨ ´¨¡®­ ··¨¥¢»µ ª³· ¤«¿ µ° ­¥­¨¿ ­ ¡®° 
¬­®¦¥±²¢ ª ¦¤®¥ ¬­®¦¥±²¢® § ­¨¬ ¥² ­¥±ª®«¼ª® ¤¥°¥¢¼¥¢, ª®°­¨
ª®²®°»µ ±¢¿§ ­» ¢ ±¯¨±®ª.  ª®© ª®­£«®¬¥° ² ¬» ¡³¤¥¬ ­ §»¢ ²¼
´¨¡®­ ··¨¥¢®© ª³·¥© (Fibonacci heap).  ª¨¬ ®¡° §®¬, ª ¦¤ ¿ ´¨¡®­ ··¨¥¢  ª³·  ±®±²®¨² ¨§ ­¥±ª®«¼ª¨µ ¤¥°¥¢¼¥¢; ¤«¿ ª ¦¤®£® µ° ­¨¬®£® ¬­®¦¥±²¢  ®²¢®¤¨²±¿ ±¢®¿ ª³· .
 ª ¦¤®¬ ¨§ ¤¥°¥¢¼¥¢, ¢µ®¤¿¹¨µ ¢ ª³·³, ¢»¯®«­¥­® ² ª®¥ ±¢®©±²¢®: ª«¾· ª ¦¤®© ¢¥°¸¨­» ­¥ ¡®«¼¸¥ ª«¾·¥© ¥¥ ¤¥²¥©. ¥°¥¢¼¿,
®¤­ ª®, ¡®«¥¥ ­¥ ®¡¿§ ­» ¡»²¼ ¡¨­®¬¨ «¼­»¬¨. °¨¬¥° ´¨¡®­ ··¨¥¢®© ª³·¨ ¯°¨¢¥¤¥­ ­  °¨±. 21.1 .
 ¡¨­®¬¨ «¼­»µ ¤¥°¥¢¼¿µ ­  ¤¥²¿µ «¾¡®© ¢¥°¸¨­» ´¨ª±¨°®¢ ­
¯®°¿¤®ª; ¢ ´¨¡®­ ··¨¥¢»µ ¤¥°¥¢¼¿µ ² ª®£® ¯®°¿¤ª  ­¥² (¤¥²¨ «¾¡®© ¢¥°¸¨­» ±¢¿§ ­» ¢ ª°³£®¢®© ¤¢³±²®°®­­¨© ±¯¨±®ª, ­® ¯®°¿¤®ª
¢ ­¥¬ ­¥±³¹¥±²¢¥­).  ª ¯®ª § ­® ­  °¨±. 21.1¡, ª ¦¤ ¿ ¢¥°¸¨­  x
±®¤¥°¦¨² ³ª § ²¥«¼ p[x] ­  ±¢®¥£® °®¤¨²¥«¿ ¨ ³ª § ²¥«¼ child[x] ­ 
ª ª®£®-­¨¡³¤¼ ¨§ ±¢®¨µ ¤¥²¥©.
¥²¨ ¢¥°¸¨­» x ±¢¿§ ­» ¢ ¤¢³±²®°®­­¨© ¶¨ª«¨·¥±ª¨© ±¯¨±®ª,
­ §»¢ ¥¬»© ±¯¨±ª®¬ ¤¥²¥© (child list) ¢¥°¸¨­» x.  ¦¤ ¿ ¢¥°¸¨-

²°®¥­¨¥ ´¨¡®­ ··¨¥¢®© ª³·¨

421

( ) ¨¡®­ ··¨¥¢  ª³· , ±®¤¥°¦ ¹ ¿ 5 ¤¥°¥¢¼¥¢ ¨ 14 ¢¥°¸¨­. ³­ª²¨°­®© «¨­¨¥© ¯®ª § ­ ª®°­¥¢®© ±¯¨±®ª. ¨­¨¬ «¼­ ¿ ¢¥°¸¨­  ±®¤¥°¦¨²
ª«¾· 3. °¨ ®²¬¥·¥­­»¥ ¢¥°¸¨­» ¢»¤¥«¥­» ·¥°­»¬ ¶¢¥²®¬. ®²¥­¶¨ « ½²®©
ª³·¨ ° ¢¥­ 5 + 2  3 = 11. (¡)   ¦¥ ª³·  ¢¬¥±²¥ ±® ±²°¥«ª ¬¨, ¯®ª §»¢ ¾¹¨¬¨
§­ ·¥­¨¿ ¯®«¥© p (±²°¥«ª¨ ¢¢¥°µ), child (±²°¥«ª¨ ¢­¨§) ¨ left ¨ right (±²°¥«ª¨ ¢
±²®°®­»).   ®±² «¼­»µ °¨±³­ª µ ½²®© £« ¢» ² ª¨¥ ±²°¥«ª¨ ®¯³¹¥­», ² ª ª ª
®­¨ ¢®±±² ­ ¢«¨¢ ¾²±¿ ®¤­®§­ ·­®.
¨±. 21.1

­  y ½²®£® ±¯¨±ª  ¨¬¥¥² ¯®«¿ left[y ] ¨ right[y ], ³ª §»¢ ¾¹¨¥ ­  ¥¥
±®±¥¤¥© ¢ ±¯¨±ª¥ («¥¢®£® ¨ ¯° ¢®£®). ±«¨ ¢¥°¸¨­  y ¿¢«¿¥²±¿ ¥¤¨­±²¢¥­­»¬ °¥¡¥­ª®¬ ±¢®¥£® °®¤¨²¥«¿, ²® left[y ] = right[y ] = y .
¢³±²®°®­­¨¥ ¶¨ª«¨·¥±ª¨¥ ±¯¨±ª¨ (±¬. ° §¤. 11.2) ³¤®¡­» ¯®
¤¢³¬ ¯°¨·¨­ ¬. ®-¯¥°¢»µ, ¨§ ² ª®£® ±¯¨±ª  ¬®¦­® ³¤ «¨²¼ «¾¡³¾ ¢¥°¸¨­³ §  ¢°¥¬¿ O(1). ®-¢²®°»µ, ¤¢  ² ª¨µ ±¯¨±ª  ¬®¦­®
±®¥¤¨­¨²¼ ¢ ®¤¨­ §  ¢°¥¬¿ O(1).
®¬¨¬® ³ª § ­­®© ¨­´®°¬ ¶¨¨, ª ¦¤ ¿ ¢¥°¸¨­  ¨¬¥¥² ¯®«¥
degree[x], £¤¥ µ° ­¨²±¿ ¥¥ ±²¥¯¥­¼ (·¨±«® ¤¥²¥©),   ² ª¦¥ ¯®«¥
mark[x].  ½²®¬ ¯®«¥ µ° ­¨²±¿ ¡³«¥¢±ª®¥ §­ ·¥­¨¥. ¬»±« ¥£® ² ª®¢: mark[x] ¨±²¨­­®, ¥±«¨ ¢¥°¸¨­  x ¯®²¥°¿«  °¥¡¥­ª  ¯®±«¥ ²®£®,
ª ª ®­  ¢ ¯®±«¥¤­¨© ° § ±¤¥« « ±¼ ·¼¨¬-«¨¡® ¯®²®¬ª®¬. » ®¡º¿±­¨¬ ¯®§¦¥, ª ª ¨ ª®£¤  ½²® ¯®«¥ ¨±¯®«¼§³¥²±¿.
®°­¨ ¤¥°¥¢¼¥¢, ±®±² ¢«¿¾¹¨µ ´¨¡®­ ··¨¥¢³ ª³·³, ±¢¿§ ­» ±
¯®¬®¹¼¾ ³ª § ²¥«¥© left ¨ right ¢ ¤¢³±²®°®­­¨© ¶¨ª«¨·¥±ª¨© ±¯¨±®ª, ­ §»¢ ¥¬»© ª®°­¥¢»¬ ±¯¨±ª®¬ (root list).
®±²³¯ ª ´¨¡®­ ··¨¥¢®© ª³·¥ H ®±³¹¥±²¢«¿¥²±¿ ± ¯®¬®¹¼¾
 ²°¨¡³²  min[H ], ª®²®°»© ³ª §»¢ ¥² ­  ¢¥°¸¨­³ ª®°­¥¢®£® ±¯¨±ª  ± ¬¨­¨¬ «¼­»¬ ª«¾·®¬. ²  ¢¥°¸¨­  ­ §»¢ ¥²±¿ ¬¨­¨¬ «¼­®©
¢¥°¸¨­®© (minimum node) ª³·¨. ¥ ª«¾· ¡³¤¥² ¬¨­¨¬ «¼­»¬ ª«¾·®¬ ¢ ª³·¥, ¯®±ª®«¼ª³ ¬¨­¨¬ «¼­»© ª«¾· ´¨¡®­ ··¨¥¢  ¤¥°¥¢  ­ µ®¤¨²±¿ ¢ ¥£® ª®°­¥. ®°¿¤®ª ¢¥°¸¨­ ¢ ª®°­¥¢®¬ ±¯¨±ª¥ §­ ·¥­¨¿

422

« ¢  21 ¨¡®­ ··¨¥¢» ª³·¨

­¥ ¨¬¥¥². ±«¨ ´¨¡®­ ··¨¥¢  ª³·  H ¯³±² , ²® min[H ] = nil.
 ª®­¥¶,  ²°¨¡³² n[H ] ±®¤¥°¦¨² ·¨±«® ¢¥°¸¨­ ¢ ª³·¥ H .
®²¥­¶¨ «
°¨  ­ «¨§¥ ³·¥²­®© ±²®¨¬®±²¨ ®¯¥° ¶¨© ¬» ¨±¯®«¼§³¥¬ ¬¥²®¤
¯®²¥­¶¨ «  (° §¤¥« 18.3). ³±²¼ t(H ) | ·¨±«® ¤¥°¥¢¼¥¢ ¢ ª®°­¥¢®¬
±¯¨±ª¥ ª³·¨ H ,   m(H ) | ª®«¨·¥±²¢® ®²¬¥·¥­­»µ ¢¥°¸¨­. ®²¥­¶¨ « ®¯°¥¤¥«¿¥²±¿ ´®°¬³«®©
(H ) = t(H ) + 2m(H ):
(21.1)
 ¯°¨¬¥°, ¯®²¥­¶¨ « ª³·¨ °¨±. 21.1 ° ¢¥­ 5 + 2  3 = 11.  ª ¦¤»©
¬®¬¥­² ¢°¥¬¥­¨ ¢ ¯ ¬¿²¨ µ° ­¨²±¿ ­¥±ª®«¼ª® ª³·; ®¡¹¨© ¯®²¥­¶¨ « ¯® ®¯°¥¤¥«¥­¨¾ ° ¢¥­ ±³¬¬¥ ¯®²¥­¶¨ «®¢ ¢±¥µ ½²¨µ ª³·.  ¤ «¼­¥©¸¥¬ ¬» ¢»¡¥°¥¬ À¥¤¨­¨¶³ ¨§¬¥°¥­¨¿ ¯®²¥­¶¨ « Á ² ª, ·²®¡»
¥¤¨­¨·­®£® ¨§¬¥­¥­¨¿ ¯®²¥­¶¨ «  µ¢ ² «® ¤«¿ ®¯« ²» O(1) ®¯¥° ¶¨© (´®°¬ «¼­® £®¢®°¿, ¬» ³¬­®¦¨¬ ¯®²¥­¶¨ « ­  ¯®¤µ®¤¿¹³¾
ª®­±² ­²³).
 ­ · «¼­®¬ ±®±²®¿­¨¨ ­¥² ­¨ ®¤­®© ª³·¨, ¨ ¯®²¥­¶¨ « ° ¢¥­ 0.
 ª ¨ ¯®«®¦¥­® (±¬. ° §¤. 18.3), ¯®²¥­¶¨ « ¢±¥£¤  ­¥®²°¨¶ ²¥«¥­.
 ª±¨¬ «¼­ ¿ ±²¥¯¥­¼
» ¡³¤¥¬ ¯°¥¤¯®« £ ²¼ ¨§¢¥±²­®© ­¥ª®²®°³¾ ¢¥°µ­¾¾ £° ­¨¶³ D(n) ¤«¿ ±²¥¯¥­¥© ¢¥°¸¨­ ¢ ª³· µ, ª®²®°»¥ ¬®£³² ¯®¿¢¨²¼±¿
¯°¨ ¢»¯®«­¥­¨¨ ­ ¸¨µ ¯°®¶¥¤³°. (°£³¬¥­²®¬ ´³­ª¶¨¨ D ¿¢«¿¥²±¿ ®¡¹¥¥ ·¨±«® ¢±¥µ ¢¥°¸¨­ ¢ ª³·¥, ®¡®§­ · ¥¬®¥ ·¥°¥§ n.) ±«¨
¬» ¨±¯®«¼§³¥¬ ²®«¼ª® ®¯¥° ¶¨¨, ¯°¥¤³±¬®²°¥­­»¥ ¤«¿ ±«¨¢ ¥¬»µ
ª³·, ²® ¬®¦­® ¯®«®¦¨²¼ D(n) = blg nc (³¯°. 21.2-3).  ° §¤¥«¥ 21.3
¬» ¤®ª ¦¥¬ (¤«¿ ®¡¹¥£® ±«³· ¿, ª®£¤  ° §°¥¸¥­» ² ª¦¥ ®¯¥° ¶¨¨
Decrease-Key ¨ Delete), ·²® D(n) = O(lg n).

21.2. ¯¥° ¶¨¨, ¯°¥¤³±¬®²°¥­­»¥ ¤«¿ ±«¨¢ ¥¬»µ ª³·
«¿ ­ · «  ¬» ¡³¤¥¬ ° ±±¬ ²°¨¢ ²¼ «¨¸¼ ®¯¥° ¶¨¨ MakeHeap, Insert, Minimum, Extract-Min ¨ Union, ¯°¥¤³±¬®²°¥­-

­»¥ ¤«¿ ±«¨¢ ¥¬»µ ª³·.  ½²®¬ ±«³· ¥ ª³·¨ ¡³¤³² ¯°¥¤±² ¢«¿²¼
±®¡®© ­ ¡®° À­¥³¯®°¿¤®·¥­­»µ ¡¨­®¬¨ «¼­»µ ¤¥°¥¢¼¥¢Á, ª®°­¨ ª®²®°»µ ±¢¿§ ­» ¢ ¶¨ª«¨·¥±ª¨© ±¯¨±®ª.
¥³¯®°¿¤®·¥­­®¥ ¡¨­®¬¨ «¼­®¥ ¤¥°¥¢® (unordered binomial tree)
¯®«³· ¥²±¿ ¨§ ³¯®°¿¤®·¥­­®£®, ¥±«¨ ¬» ¯¥°¥±² ¥¬ ®¡° ¹ ²¼ ¢­¨¬ ­¨¥ ­  ¯®°¿¤®ª ±°¥¤¨ ¢¥°¸¨­, ¨¬¥¾¹¨µ ®¡¹¥£® °®¤¨²¥«¿. °³£¨¬¨ ±«®¢ ¬¨, ­¥³¯®°¿¤®·¥­­®¥ ¡¨­®¬¨ «¼­®¥ ¤¥°¥¢® U0 ±®±²®¨² ¨§ ¥¤¨­±²¢¥­­®© ¢¥°¸¨­»,   ­¥³¯®°¿¤®·¥­­®¥ ¡¨­®¬¨ «¼­®¥

¯¥° ¶¨¨, ¯°¥¤³±¬®²°¥­­»¥ ¤«¿ ±«¨¢ ¥¬»µ ª³·

423

¤¥°¥¢® Uk ¯®«³· ¥²±¿ ¨§ ¤¢³µ ½ª§¥¬¯«¿°®¢ ¤¥°¥¢¼¥¢ Uk;1 , ¥±«¨
ª®°¥­¼ ®¤­®£® ¤®¡ ¢¨²¼ ª ·¨±«³ ¤¥²¥© ª®°­¿ ¤°³£®£®. ( ª¨¬
®¡° §®¬, ¤¥²¨ ª®°­¿ ¢ ¤¥°¥¢¥ Uk ¿¢«¿¾²±¿ ¢¥°¸¨­ ¬¨ ¤¥°¥¢¼¥¢
U0; U1; : : :; Uk;1.) ¥¬¬  20.1 ®±² ¥²±¿ ¢¥°­®© ¨ ¤«¿ ­¥³¯®°¿¤®·¥­­»µ ¡¨­®¬¨ «¼­»µ ¤¥°¥¢¼¥¢ (­ ¤® ²®«¼ª® ¨±ª«¾·¨²¼ ¢ ±¢®©±²¢¥ 4
³¯®¬¨­ ­¨¥ ® ¯®°¿¤ª¥).
 · ±²­®±²¨, ±²¥¯¥­¨ ¢±¥µ ¢¥°¸¨­ ¢ ´¨¡®­ ··¨¥¢®© ª³·¥ ° §¬¥°  n, ±®±² ¢«¥­­®© ¨§ ­¥³¯®°¿¤®·¥­­»µ ¡¨­®¬¨ «¼­»µ ¤¥°¥¢¼¥¢,
®£° ­¨·¥­» ¢¥«¨·¨­®© D(n) = lg n.
 ®²«¨·¨¥ ®² ¡¨­®¬¨ «¼­»µ ª³·, ²¥¯¥°¼ ±°¥¤¨ ¢µ®¤¿¹¨µ ¢ ª³·³
¤¥°¥¢¼¥¢ ¬®¦¥² ¡»²¼ ­¥±ª®«¼ª® ¤¥°¥¢¼¥¢ ± ®¤­®© ¨ ²®© ¦¥ ±²¥¯¥­¼¾ ª®°­¿. µ Àª®­±®«¨¤ ¶¨¿Á ®²ª« ¤»¢ ¥²±¿ ¤® ¬®¬¥­²  ¢»¯®«­¥­¨¿ ®¯¥° ¶¨¨ Extract-Min, ª®£¤  ¤¥°¥¢¼¿ ± ª®°­¿¬¨ ®¤¨­ ª®¢®©
±²¥¯¥­¨ ®¡º¥¤¨­¿¾²±¿.
®§¤ ­¨¥ ­®¢®© ´¨¡®­ ··¨¥¢®© ª³·¨
°®¶¥¤³°  Make-Fib-Heap ±®§¤ ¥² ¨ ¢®§¢° ¹ ¥² ®¡º¥ª² H , ¤«¿
ª®²®°®£® n[H ] = 0 ¨ min[H ] = nil: ª®°­¥¢®© ±¯¨±®ª ½²®© ª³·¨ ¯³±².
°¨ ½²®¬ t(H ) = 0 ¨ m(H ) = 0, ² ª ·²® ¯®²¥­¶¨ « ª³·¨ ° ¢¥­ 0,
  ±³¬¬ °­»© ¯®²¥­¶¨ « ­¥ ¬¥­¿¥²±¿. ·¥²­ ¿ ±²®¨¬®±²¼ ®¯¥° ¶¨¨
Make-Fib-Heap ° ¢­  ¥¥ ´ ª²¨·¥±ª®© ±²®¨¬®±²¨ O(1).
®¡ ¢«¥­¨¥ ¢¥°¸¨­»
«¥¤³¾¹ ¿ ¯°®¶¥¤³°  ¤®¡ ¢«¿¥² ¢¥°¸¨­³ x ¢ ´¨¡®­ ··¨¥¢³ ª³·³ H (¯°¥¤¯®« £ ¥¬, ·²® ¢¥°¸¨­  x ³¦¥ ° §¬¥¹¥­  ¢ ¯ ¬¿²¨ ¨
¯®«¥ ª«¾·  key[x] § ¯®«­¥­®).
Fib-Heap-Insert (H; x)
1 degree[x] 0
2 p[x] nil
3 child[x] nil
4 left[x] x
5 right[x] x
6 mark[x] false
7 ±®¥¤¨­¨²¼ ¯®«³·¥­­»© ª®°­¥¢®© ±¯¨±®ª
(±®±²®¿¹¨© ¨§ ¢¥°¸¨­» x) ± ª®°­¥¢»¬ ±¯¨±ª®¬ ª³·¨ H
8 if min[H ] = nil or key[x] < key[min[H ]]
9
then min[H ] x
10 n[H ] n[H ] + 1
²°®ª¨ 1{6 ´®°¬¨°³¾² ¶¨ª«¨·¥±ª¨© ±¯¨±®ª ¨§ ¥¤¨­±²¢¥­­®© ¢¥°¸¨­» x, ¨ ¢ ±²°®ª¥ 7 ½²  ¢¥°¸¨­  ¤®¡ ¢«¿¥²±¿ (§  ¢°¥¬¿ O(1))
ª ª®°­¥¢®¬³ ±¯¨±ª³ ª³·¨ H , ¢ ª®²®°®© ¯®¿¢«¿¥²±¿ ­®¢®¥ ®¤­®-

424

« ¢  21 ¨¡®­ ··¨¥¢» ª³·¨

®¡ ¢«¥­¨¥ ¢¥°¸¨­». ( ) ¨¡®­ ··¨¥¢  ª³·  H . (¡)   ¦¥ ª³·  H
¯®±«¥ ¤®¡ ¢«¥­¨¿ ¢¥°¸¨­» ± ª«¾·®¬ 21. (²³ ¢¥°¸¨­³ ±¤¥« «¨ ®¤­®½«¥¬¥­²­»¬
¤¥°¥¢®¬,   § ²¥¬ ¤®¡ ¢¨«¨ ¢ ª®°­¥¢®© ±¯¨±®ª ±«¥¢  ®² ¬¨­¨¬ «¼­®© ¢¥°¸¨­»,
ª®²®° ¿ ¢ ¤ ­­®¬ ±«³· ¥ ®±² « ±¼ ¬¨­¨¬ «¼­®©.)
¨±. 21.2

½«¥¬¥­²­®¥ ¤¥°¥¢®. ¥°¸¨­  x ­¥ ¨¬¥¥² ¯®²®¬ª®¢ ¨ ­¥ ®²¬¥·¥­ .
 ±²°®ª µ 8{9 ®¡­®¢«¿¥²±¿ (¥±«¨ ­¥®¡µ®¤¨¬®) ³ª § ²¥«¼ ­  ¬¨­¨¬ «¼­³¾ ¢¥°¸¨­³.  ª®­¥¶, ±²°®ª  10 ³¢¥«¨·¨¢ ¥² §­ ·¥­¨¥ n[H ].
  °¨±. 21.2 ¯®ª § ­® ¤®¡ ¢«¥­¨¥ ¢¥°¸¨­» ± ª«¾·®¬ 21 ¢ ´¨¡®­ ··¨¥¢³ ª³·³ °¨±. 21.1.
 ®²«¨·¨¥ ®² ¯°®¶¥¤³°» Binomial-Heap-Insert, ¯°®¶¥¤³° 
Fib-Heap-Insert ­¥ ¯»² ¥²±¿ ±®¥¤¨­¿²¼ ¤¥°¥¢¼¿ ± ®¤¨­ ª®¢®© ±²¥¯¥­¼¾ ¢¥°¸¨­». ±«¨ ¢»¯®«­¨²¼ ¯®¤°¿¤ k ®¯¥° ¶¨© Fib-HeapInsert, ²® ¢ ª®°­¥¢®© ±¯¨±®ª ¡³¤³² ¤®¡ ¢«¥­» k ¤¥°¥¢¼¥¢ ¯® ®¤­®©
¢¥°¸¨­¥ ¢ ª ¦¤®¬.
 ©¤¥¬ ³·¥²­³¾ ±²®¨¬®±²¼ ®¯¥° ¶¨¨ Fib-Heap-Insert. ¥ ´ ª²¨·¥±ª ¿ ±²®¨¬®±²¼ ¥±²¼| O(1), ¨ ³¢¥«¨·¥­¨¥ ¯®²¥­¶¨ «  ² ª¦¥
¥±²¼ O(1) (¢ ª®°­¥¢®© ±¯¨±®ª ¤®¡ ¢¨« ±¼ ®¤­  ¢¥°¸¨­ ).  ª¨¬
®¡° §®¬, ³·¥²­ ¿ ±²®¨¬®±²¼ ±®±² ¢«¿¥² O(1).
®¨±ª ¬¨­¨¬ «¼­®© ¢¥°¸¨­»
ª § ²¥«¼ ­  ­¥¥ µ° ­¨²±¿ ¢ min[H ], ² ª ·²® ´ ª²¨·¥±ª ¿ ±²®¨¬®±²¼ ½²®© ®¯¥° ¶¨¨ ¥±²¼ O(1). ®²¥­¶¨ « ¯°¨ ½²®¬ ­¥ ¬¥­¿¥²±¿,
² ª ·²® ¨ ³·¥²­ ¿ ±²®¨¬®±²¼ ¥±²¼ O(1).
®¥¤¨­¥­¨¥ ¤¢³µ ´¨¡®­ ··¨¥¢»µ ª³·
«¥¤³¾¹ ¿ ¯°®¶¥¤³°  ¨§ ¤¢³µ ´¨¡®­ ··¨¥¢»µ ª³· H1 ¨ H2 , ¤¥« ¥² ®¤­³ (¯°¨ ½²®¬ ¨±µ®¤­»¥ ª³·¨ ¨±·¥§ ¾²).

¯¥° ¶¨¨, ¯°¥¤³±¬®²°¥­­»¥ ¤«¿ ±«¨¢ ¥¬»µ ª³·

425

Fib-Heap-Union(H1; H2)
1 H Make-Fib-Heap()

2 min[H ] min[H1 ]
3 ±®¥¤¨­¨²¼ ª®°­¥¢®© ±¯¨±®ª H2 c ª®°­¥¢»¬ ±¯¨±ª®¬ H
4 if (min[H1] = nil) or (min[H2] 6= nil and min[H2] < min[H1 ])
5 then min[H ] min[H2]
6 n[H ] n[H1 ] + n[H2]
7 ®±¢®¡®¤¨²¼ ¯ ¬¿²¼, § ­¿²³¾ ¯®¤ § £®«®¢ª¨ ®¡º¥ª²®¢ H1 ¨ H2
8 return H
²°®ª¨ 1{3 ®¡º¥¤¨­¿¾² ª®°­¥¢»¥ ±¯¨±ª¨ ª³· H1 ¨ H2 ¢ ª®°­¥¢®©
±¯¨±®ª ­®¢®© ª³·¨ H . ²°®ª¨ 2, 4 ¨ 5 § ¯®«­¿¾² min[H ],   ±²°®ª  6 ³±² ­ ¢«¨¢ ¥² n[H ] ° ¢­»¬ ±³¬¬ °­®¬³ ª®«¨·¥±²¢³ ¢¥°¸¨­.
¡º¥ª²» H1 ¨ H2 ®±¢®¡®¦¤ ¾²±¿ ¢ ±²°®ª¥ 7,   ±²°®ª  8 ¢®§¢° ¹ ¥² °¥§³«¼²¨°³¾¹³¾ ´¨¡®­ ··¨¥¢³ ª³·³ H . ²¬¥²¨¬, ·²® (ª ª
¨ ¢ ¯°®¶¥¤³°¥ Fib-Heap-Insert) ±®¥¤¨­¥­¨¿ ¤¥°¥¢¼¥¢ ­¥ ¯°®¨±µ®¤¨². ®²¥­¶¨ « ­¥ ¬¥­¿¥²±¿ (®¡¹¥¥ ·¨±«® ¢¥°¸¨­ ¢ ª®°­¥¢»µ ±¯¨±ª µ ¨ ®¡¹¥¥ ·¨±«® ¯®¬¥·¥­­»µ ¢¥°¸¨­ ®±² ¥²±¿ ²¥¬ ¦¥). ®½²®¬³
³·¥²­ ¿ ±²®¨¬®±²¼ ®¯¥° ¶¨¨ Fib-Heap-Union ° ¢­  ¥¥ ´ ª²¨·¥±ª®© ±²®¨¬®±²¨, ². ¥. O(1).
§º¿²¨¥ ¬¨­¨¬ «¼­®© ¢¥°¸¨­»
¬¥­­® ¯°¨ ½²®© ®¯¥° ¶¨¨ ¯°®¨±µ®¤¨² ¯°¥®¡° §®¢ ­¨¥ ±²°³ª²³°» ª³·¨ (° §­»¥ ¤¥°¥¢¼¿ ±®¥¤¨­¿¾²±¿ ¢ ®¤­®), ¯®½²®¬³ ®­  ±³¹¥±²¢¥­­® ±«®¦­¥¥ ¯°¥¤»¤³¹¨µ ®¯¥° ¶¨© ½²®£® ° §¤¥« . « ­ ¤¥©±²¢¨© ² ª®¢: ¯®±«¥ ¨§º¿²¨¿ ¬¨­¨¬ «¼­®© ¢¥°¸¨­» ²® ¤¥°¥¢®, £¤¥
®­  ¡»«  ª®°­¥¬, ° ±±»¯ ¥²±¿ ¢ ­ ¡®° ±¢®¨µ ¯®¤¤¥°¥¢¼¥¢, ª®²®°»¥ ¤®¡ ¢«¿¾²±¿ ª ª®°­¥¢®¬³ ±¯¨±ª³.  ²¥¬ § ¯³±ª ¥²±¿ ¯°®¶¥¤³°  Consolidate, ±®¥¤¨­¿¾¹ ¿ ¤¥°¥¢¼¿, ¯®±«¥ ·¥£® ¢ ª®°­¥¢®¬
±¯¨±ª¥ ®±² ¥²±¿ ­¥ ¡®«¥¥ ®¤­®£® ¤¥°¥¢  ª ¦¤®© ±²¥¯¥­¨.
» ±·¨² ¥¬, ·²® ¯°¨ ³¤ «¥­¨¨ ¢¥°¸¨­» ¨§ ±¢¿§ ­­®£® ±¯¨±ª 
(±²°®ª  6) ¯®«¿ left ¨ right ½²®© ¢¥°¸¨­» ®±² ¾²±¿ ­¥¨§¬¥­­»¬¨
(­® ¯®«¿ ¥¥ ±®±¥¤¥©, ª®²®°»¥ ³ª §»¢ «¨ ­  ½²³ ¢¥°¸¨­³, ®¡­®¢«¿¾²±¿).

426

« ¢  21 ¨¡®­ ··¨¥¢» ª³·¨

Fib-Heap-Extract-Min(H )

1 z min[H ]
2 if z 6= nil
3
then for (¤«¿) ª ¦¤®£® °¥¡¥­ª  x ¢¥°¸¨­» z
4
do ¤®¡ ¢¨²¼ x ¢ ª®°­¥¢®© ±¯¨±®ª H
5
p[x] nil
6
³¤ «¨²¼ z ¨§ ª®°­¥¢®£® ±¯¨±ª  H
7
if z = right[z ]
8
then min[H ] nil
9
else min[H ] right[z ]
10
Consolidate(H )
11
n[H ] n[H ] ; 1
12 return z
°®¶¥¤³°  Fib-Heap-Extract-Min ¯¥°¥¬¥¹ ¥² ¢±¥µ ¤¥²¥© ³¤ «¿¥¬®© (¬¨­¨¬ «¼­®©) ¢¥°¸¨­» ¢ ª®°­¥¢®© ±¯¨±®ª ª³·¨ H ,   ± ¬³
¬¨­¨¬ «¼­³¾ ¢¥°¸¨­³ ³¤ «¿¥² ¨§ ª®°­¥¢®£® ±¯¨±ª .  ²¥¬ ¯°®¨§¢®¤¨²±¿ ³¯«®²­¥­¨¥ ª®°­¥¢®£® ±¯¨±ª  ± ¯®¬®¹¼¾ ¯°®¶¥¤³°» Consolidate.
 ±²°®ª¥ 1 ³ª § ²¥«¼ ­  ¬¨­¨¬ «¼­³¾ ¢¥°¸¨­³ ±®µ° ­¿¥²±¿ ¢ ¯¥°¥¬¥­­®© z (½²®² ³ª § ²¥«¼ ¢®§¢° ¹ ¥²±¿ ¯°®¶¥¤³°®© ¢ ±²°®ª¥ 12).
±«¨ z = nil, ¨±µ®¤­ ¿ ª³·  ¯³±² , ¨ ° ¡®²  § ª ­·¨¢ ¥²±¿.  ¯°®²¨¢­®¬ ±«³· ¥ ¬» ³¤ «¿¥¬ z ¨§ ª®°­¥¢®£® ±¯¨±ª  H (±²°®ª  6),
¯°¥¤¢ °¨²¥«¼­® ¯®¬¥±²¨¢ ¢ ­¥£® ¢±¥µ ¤¥²¥© ¢¥°¸¨­» z (±²°®ª¨
3{5). ±«¨ ¯®±«¥ ½²®£® z = right[z ], ²® ¢¥°¸¨­  z ­¥ ²®«¼ª® ¡»« 
¥¤¨­±²¢¥­­®© ¢¥°¸¨­®© ¢ ª®°­¥¢®¬ ±¯¨±ª¥, ­® ¨ ­¥ ¨¬¥«  ¯®²®¬ª®¢, ² ª ·²® ²¥¯¥°¼ ®±² ¥²±¿ «¨¸¼ ±¤¥« ²¼ ª³·³ ¯³±²®© (±²°®ª  8)
¨ ¢®§¢° ²¨²¼ z .  ¯°®²¨¢­®¬ ±«³· ¥ ¬» ¬¥­¿¥¬ §­ ·¥­¨¥ ³ª § ²¥«¿
min[H ] ² ª, ·²®¡» ®­ ³ª §»¢ « ­  ª ª³¾-«¨¡® ¢¥°¸¨­³ ª®°­¥¢®£®
±¯¨±ª , ®²«¨·­³¾ ®² z (¢ ¤ ­­®¬ ±«³· ¥ | ­  ¢¥°¸¨­³ right[z ]).
  °¨±. 21.3¡ ¯®ª § ­® ±®±²®¿­¨¥ ª³·¨ °¨±. 21.3  ¯®±«¥ ¢»¯®«­¥­¨¿
±²°®ª¨ 9.
±² ¥²±¿ ¢»§¢ ²¼ ¯°®¶¥¤³°³ Consolidate (® ª®²®°®© ¬» £®¢®°¨¬ ¤ «¼¸¥) ¤«¿ ³¯«®²­¥­¨¿ (consolidating) ª³·¨. ¯«®²­¥­¨¥ ¯°®¨±µ®¤¨² §  ±·¥² ²®£®, ·²® ¤¢  ¤¥°¥¢  ± ¢¥°¸¨­ ¬¨ ®¤¨­ ª®¢®© ±²¥¯¥­¨ ±®¥¤¨­¿¾²±¿ ¢ ®¤­® (¥£® ¢¥°¸¨­  ¡³¤¥² ¨¬¥²¼ ­  ¥¤¨­¨¶³
¡®«¼¸³¾ ±²¥¯¥­¼). ²  ®¯¥° ¶¨¿ (¯°®¶¥¤³°  Fib-Heap-Link) ¯°®¨§¢®¤¨²±¿ ¤® ²¥µ ¯®°, ¯®ª  ¢ ª®°­¥¢®¬ ±¯¨±ª¥ ­¥ ®±² ­¥²±¿ ¢¥°¸¨­
®¤¨­ ª®¢®© ±²¥¯¥­¨.
°¨ ±®¥¤¨­¥­¨¨ ¤¢³µ ¢¥°¸¨­ ± ¯®¬®¹¼¾ ®¯¥° ¶¨¨ Fib-HeapLink ¢¥°¸¨­  ± ¡®«¼¸¨¬ ª«¾·®¬ (­ §®¢¥¬ ¥¥ y ) ±² ­®¢¨²±¿
°¥¡¥­ª®¬ ¢¥°¸¨­» ± ¬¥­¼¸¨¬ ª«¾·®¬ (­ §®¢¥¬ ¥¥ x). °¨ ½²®¬
degree[x] ³¢¥«¨·¨¢ ¥²±¿,   ¢¥°¸¨­  y ¯¥°¥±² ¥² ¡»²¼ ®²¬¥·¥­­®©
(¥±«¨ ¡»«  ² ª®¢®©).
°®¶¥¤³°  Consolidate ¨±¯®«¼§³¥² ¢±¯®¬®£ ²¥«¼­»© ¬ ±±¨¢

¯¥° ¶¨¨, ¯°¥¤³±¬®²°¥­­»¥ ¤«¿ ±«¨¢ ¥¬»µ ª³·

427

A[0 : :D(n[H ])]. ®§¨¶¨¿ ± ­®¬¥°®¬ i ¢ ½²®¬ ¬ ±±¨¢¥ ¯°¥¤­ §­ ·¥­ 
¤«¿ µ° ­¥­¨¿ ³ª § ²¥«¿ ­  ª®°¥­¼ ´¨¡®­ ··¨¥¢  ¤¥°¥¢  ±²¥¯¥­¨ i.

­ · «¥ ¬ ±±¨¢ ¯³±² (¢±¥ ¥£® ¿·¥©ª¨ ±®¤¥°¦ ² nil). ®±²¥¯¥­­® ¢
­¥£® ¯¥°¥¯¨±»¢ ¾²±¿ ¢¥°¸¨­» ¨§ ª®°­¥¢®£® ±¯¨±ª . ±«¨ ¯°¨ ½²®¬
®ª §»¢ ¥²±¿, ·²® ¿·¥©ª  ¤«¿ ¢¥°¸¨­» ­³¦­®© ±²¥¯¥­¨ ³¦¥ § ­¿² , ²® ³ ­ ± ¥±²¼ ¤¢  ¤¥°¥¢  ½²®© ±²¥¯¥­¨, ®­¨ ®¡º¥¤¨­¿¾²±¿, ¨ ¬»
¯»² ¥¬±¿ § ¯¨± ²¼ ®¡º¥¤¨­¥­­®¥ ¤¥°¥¢® ¢ ±«¥¤³¾¹³¾ ¿·¥©ª³ ¬ ±±¨¢  A. ±«¨ ¨ ®­  § ­¿² , ²® ¬» ±­®¢  ¯°®¨§¢®¤¨¬ ®¯¥° ¶¨¾ ®¡º¥¤¨­¥­¨¿, ¯®«³· ¥¬ ¤¥°¥¢® ¥¹¥ ­  ¥¤¨­¨¶³ ¡®«¼¸¥© ±²¥¯¥­¨ ¨ ². ¤.
Consolidate(H )
1 for i 0 to D(n[H ])
2
do A[i] nil
3 for (¤«¿) ª ¦¤®© ¢¥°¸¨­» w ª®°­¥¢®£® ±¯¨±ª  ª³·¨ H
4
do x w
5
d degree[x]
6
while A[d] 6= nil
7
do y A[d]
8
if key[x] > key[y ]
9
then ®¡¬¥­ x $ y
10
Fib-Heap-Link(H; y; x)
11
A[d] nil
12
d d+1
13
A[d] x
14 min[H ] nil
15 for i 0 to D(n[H ])
16
do if A[i] 6= nil
17
then ¤®¡ ¢¨²¼ A[i] ¢ ª®°­¥¢®© ±¯¨±®ª H
18
if min[H ] = nil or key[A[i]] < key[min[H ]]
19
then min[H ] A[i]
Fib-Heap-Link(H; y; x)

1 ³¤ «¨²¼ y ¨§ ª®°­¥¢®£® ±¯¨±ª  ª³·¨ H
2 ¢ª«¾·¨²¼ y ¢ ±¯¨±®ª ¤¥²¥© ¢¥°¸¨­» x, ³¢¥«¨·¨¢ degree[x]
3 mark[y ] false
¯¨¸¥¬ ° ¡®²³ ¯°®¶¥¤³°» Consolidate ¡®«¥¥ ¯®¤°®¡­®. 
±²°®ª µ 1{2 ¬ ±±¨¢ A § ¯®«­¿¥²±¿ §­ ·¥­¨¿¬¨ nil.  ¶¨ª«¥ for
(±²°®ª¨ 3{13) ¬» ¯¥°¥¡¨° ¥¬ ¢±¥ ª®°­¥¢»¥ ¢¥°¸¨­» w.  ¦¤³¾
¨§ ­¨µ ¬» ¤®¡ ¢«¿¥¬ ª ¬ ±±¨¢³ A (±®¥¤¨­¿¿ ¥¥ ± ¨¬¥¾¹¨¬¨±¿ ² ¬
¢¥°¸¨­ ¬¨, ¥±«¨ ­³¦­®). ¡° ¡®²ª  ª ¦¤®© ¨§ ª®°­¥¢»µ ¢¥°¸¨­ w
¬®¦¥² ¯®²°¥¡®¢ ²¼ ­¥±ª®«¼ª¨µ ®¯¥° ¶¨© Fib-Heap-Link ¨ § ª ­·¨¢ ¥²±¿ ±®§¤ ­¨¥¬ ¤¥°¥¢ , ª®°­¥¢ ¿ ¢¥°¸¨­  x ª®²®°®£® ¬®¦¥²
±®¢¯ ¤ ²¼,   ¬®¦¥² ¨ ­¥ ±®¢¯ ¤ ²¼ ± w, ­® ¢ «¾¡®¬ ±«³· ¥ ½²® ¤¥°¥¢® ±®¤¥°¦¨² ¢¥°¸¨­³ w. ®±«¥ ½²®£® ½«¥¬¥­² ¬ ±±¨¢  A[degree[x]]
³±² ­ ¢«¨¢ ¥²±¿ ² ª¨¬ ®¡° §®¬, ·²®¡» ®­ ³ª §»¢ « ­  x.  ¯°®¶¥±-

428

« ¢  21 ¨¡®­ ··¨¥¢» ª³·¨

 ¡®²  ¯°®¶¥¤³°» Fib-Heap-Extract-Min. ( ) ¨¡®­ ··¨¥¢  ª³·  H . (¡) ¨­¨¬ «¼­ ¿ ¢¥°¸¨­  z ³¤ «¥­  ¨§ ª®°­¥¢®£® ±¯¨±ª ; ¥¥ ¯®²®¬ª¨
¢ª«¾·¥­» ¢ ª®°­¥¢®© ±¯¨±®ª. (¢){(¤)  ±±¨¢ A ¨ ¤¥°¥¢¼¿ ¯®±«¥ ª ¦¤®© ¨§ ¯¥°¢»µ ²°¥µ ¨²¥° ¶¨© ¶¨ª«  for (±²°®ª¨ 3{13 ¯°®¶¥¤³°» Consolidate). ®°­¥¢®©
±¯¨±®ª ¯°®±¬ ²°¨¢ ¥²±¿ ±«¥¢  ­ ¯° ¢® ¯® ª°³£³, ­ ·¨­ ¿ ± min[H ]. (¥)-(§) «¥¤³¾¹ ¿ ¨²¥° ¶¨¿ ¶¨ª«  for. ¨±. (¥) ¯®ª §»¢ ¥² ±®±²®¿­¨¥ ¯®±«¥ ¯¥°¢®£® ¨±¯®«­¥­¨¿ ²¥«  ¶¨ª«  while: ¢¥°¸¨­  ± ª«¾·®¬ 23 ¯®¤¢¥¸¥­  ª ¢¥°¸¨­¥ ± ª«¾·®¬ 7,
­  ª®²®°³¾ ²¥¯¥°¼ ³ª §»¢ ¥² x.  ²¥¬ ¢¥°¸¨­  ± ª«¾·®¬ 17 ¯®¤¢¥¸¨¢ ¥²±¿ ª
ª ¢¥°¸¨­¥ ± ª«¾·®¬ 7 (¦),   ¯®²®¬ ¨ ¢¥°¸¨­  ± ª«¾·®¬ 24 ¯®¤¢¥¸¨¢ ¥²±¿ ª
¢¥°¸¨­¥ ± ª«¾·®¬ 7 (§). ®±ª®«¼ª³ ¿·¥©ª  A[3] ¡»«  ±¢®¡®¤­®©, ¶¨ª« for § ¢¥°¸ ¥²±¿ ¨ A[3] ³ª §»¢ ¥² ­  ª®°¥­¼ ¯®«³·¥­­®£® ¤¥°¥¢ . (¨)-(«) ®±²®¿­¨¿
¯®±«¥ ª ¦¤®© ¨§ ±«¥¤³¾¹¨µ ·¥²»°¥µ ¨²¥° ¶¨© ¶¨ª«  while. (¬) ¨¡®­ ··¨¥¢ 
ª³·  H ¯®±«¥ ¯°¥®¡° §®¢ ­¨¿ ¬ ±±¨¢  A ¢ ª®°­¥¢®© ±¯¨±®ª ¨ ³±² ­®¢ª¨ ­®¢®£®
§­ ·¥­¨¿ ³ª § ²¥«¿ min[H ].
¨±. 21.3

¯¥° ¶¨¨, ¯°¥¤³±¬®²°¥­­»¥ ¤«¿ ±«¨¢ ¥¬»µ ª³·

429

±¥ ½²¨µ ¯°¥®¡° §®¢ ­¨© ¢¥°¸¨­  w ®±² ¥²±¿ ¯®²®¬ª®¬ ¢¥°¸¨­» x.
­¢ °¨ ­² ¶¨ª«  while (±²°®ª¨ 6{12) ² ª®¢: Àd = degree[x]; ®±² «®±¼ ¤®¡ ¢¨²¼ ¤¥°¥¢® ± ª®°­¥¬ ¢ x ª ¬­®¦¥±²¢³, ¯°¥¤±² ¢«¥­­®¬³
¬ ±±¨¢®¬ AÁ. ±«¨ ¯°¨ ½²®¬ A[d] = nil, ²® ¬» ¢»¯®«­¿¥¬ ½²³ ®¯¥° ¶¨¾ (¤®¡ ¢«¥­¨¥) ¢ ±²°®ª¥ 13. ±«¨ ¦¥ A[d] 6= nil, ²® ¬» ¨¬¥¥¬
¤¢  ¤¥°¥¢  ±²¥¯¥­¨ d ± ª®°­¿¬¨ ¢ x ¨ y = A[d], ¨ ¢ ±²°®ª µ 8{10
±®¥¤¨­¿¥¬ ¨µ ¢ ®¤­® ¤¥°¥¢® ± ª®°­¥¬ ¢ x (®¤­®¢°¥¬¥­­® ®·¨¹ ¿
¿·¥©ª³ A[d] ¨ ±®µ° ­¿¿ ¨­¢ °¨ ­²).
 §«¨·­»¥ ±² ¤¨¨ ½²®£® ¯°®¶¥±±  ¯®ª § ­» ­  °¨±. 21.3.
®±«¥ ½²®£® ®±² ¥²±¿ ¯°¥®¡° §®¢ ²¼ ¬ ±±¨¢ A ¢ ª®°­¥¢®© ±¯¨±®ª:
¢ ±²°®ª¥ 14 ¬» ±®§¤ ¥¬ ¯³±²®© ±¯¨±®ª,   ¢ ¶¨ª«¥ ¢ ±²°®ª µ 15{19
¤®¡ ¢«¿¥¬ ¢ ­¥£® ¯® ®·¥°¥¤¨ ¢±¥ ¢¥°¸¨­», ¨¬¥¾¹¨¥±¿ ¢ ¬ ±±¨¢¥ A.
¥§³«¼² ² ¯®ª § ­ ­  °¨±. 21.3¬.
  ½²®¬ ¯°®¶¥±± ³¯«®²­¥­¨¿ § ª ­·¨¢ ¥²±¿, ¨ ³¯° ¢«¥­¨¥ ¢®§¢° ¹ ¥²±¿ ¢ ¯°®¶¥¤³°³ Fib-Heap-Extract-Min, ª®²®° ¿ ³¬¥­¼¸ ¥² n[H ] ­  1 ¨ ¢®§¢° ¹ ¥² ³ª § ²¥«¼ ­  ¨§º¿²³¾ ¢¥°¸¨­³ z
(±²°®ª¨ 11{12).
 ¬¥²¨¬, ·²® ¥±«¨ ¯¥°¥¤ ¢»¯®«­¥­¨¥¬ ®¯¥° ¶¨¨ Fib-HeapExtract-Min ¢±¥ ¤¥°¥¢¼¿ ¢ H ¡»«¨ ­¥³¯®°¿¤®·¥­­»¬¨ ¡¨­®¬¨ «¼­»¬¨ ¤¥°¥¢¼¿¬¨, ²® ¨ ¯®±«¥ ¢»¯®«­¥­¨¿ ®¯¥° ¶¨¨ H ¡³¤¥² ±®±²®¿²¼ ¨§ ­¥³¯®°¿¤®·¥­­»µ ¡¨­®¬¨ «¼­»µ ¤¥°¥¢¼¥¢.  ± ¬®¬ ¤¥«¥,
±®¥¤¨­¥­¨¥ ¤¢³µ ­¥³¯®°¿¤®·¥­­»µ ¡¨­®¬¨ «¼­»µ ¤¥°¥¢¼¥¢ ± ®¤¨­ -

430

« ¢  21 ¨¡®­ ··¨¥¢» ª³·¨

ª®¢»¬¨ ±²¥¯¥­¿¬¨ ª®°­¿ (¯°®¶¥¤³°  Fib-Heap-Link) ¤ ¥² (­¥³¯®°¿¤®·¥­­®¥) ¡¨­®¬¨ «¼­®¥ ¤¥°¥¢® (±²¥¯¥­¼ ¥£® ª®°­¿ ­  ¥¤¨­¨¶³
¡®«¼¸¥).
 ¬ ®±² «®±¼ ¯®ª § ²¼, ·²® ³·¥²­ ¿ ±²®¨¬®±²¼ ¨§º¿²¨¿ ¬¨­¨¬ «¼­®© ¢¥°¸¨­» ¨§ n-½«¥¬¥­²­®© ´¨¡®­ ··¨¥¢®© ª³·¨ ¥±²¼
O(D(n)). ®±¬®²°¨¬, ª ª¨¥ ®¯¥° ¶¨¨ ­ ¬ ¯°¨¸«®±¼ ¢»¯®«­¨²¼.
°¥¦¤¥ ¢±¥£® ­³¦­® O(D(n)) ¤¥©±²¢¨©, ·²®¡» ¯®¬¥±²¨²¼ ¢±¥µ ¯®²®¬ª®¢ ³¤ «¿¥¬®© ¢¥°¸¨­» z ¢ ª®°­¥¢®© ±¯¨±®ª.  · «¼­»© ¨ ª®­¥·­»© ½² ¯» ° ¡®²» ¯°®¶¥¤³°» Consolidate (±²°®ª¨ 1{2 ¨ 15{
19) ² ª¦¥ ²°¥¡³¥² ¢°¥¬¥­¨ O(D(n)). ±² ¥²±¿ ³·¥±²¼ ¢ª« ¤ ¶¨ª« 
for, ° ±¯®«®¦¥­­®£® ¢ ±²°®ª µ 3{13. ²® ·¨±«® ®¶¥­¨¢ ¥²±¿ ±¢¥°µ³ ª ª O(D(n)) (° §¬¥° ¬ ±±¨¢  A) ¯«¾± ª®­±² ­² , ³¬­®¦¥­­ ¿
­  ·¨±«® ®¡° ¹¥­¨© ª ¯°®¶¥¤³°¥ Fib-Heap-Link. ® ¯°¨ ª ¦¤®¬
² ª®¬ ®¡° ¹¥­¨¨ ¤¢  ¤¥°¥¢  ±«¨¢ ¾²±¿, ·²® ¯°¨¢®¤¨² ¢ ¨²®£¥ ª
³¬¥­¼¸¥­¨¾ ¤«¨­» ª®°­¥¢®£® ±¯¨±ª  ­  1 ¨ ª ³¬¥­¼¸¥­¨¾ ¯®²¥­¶¨ «  ¯® ª° ©­¥© ¬¥°¥ ­  1 (·¨±«® ®²¬¥·¥­­»µ ¢¥°¸¨­ ¬®¦¥²
³¬¥­¼¸¨²¼±¿, ­® ­¥ ³¢¥«¨·¨²¼±¿).  ª ·²® ³¬­®¦¨¢ ¯®²¥­¶¨ « ­ 
¯®¤µ®¤¿¹³¾ ª®­±² ­²³, ¬» ¬®¦¥¬ ±·¨² ²¼, ·²® ³·¥²­ ¿ ±²®¨¬®±²¼
®¯¥° ¶¨¨ ³¤ «¥­¨¿ ¥±²¼ O(D(n)).
°³£¨¬¨ ±«®¢ ¬¨, ®¯¥° ¶¨¨ ±¢¿§»¢ ­¨¿ ¤¥°¥¢¼¥¢ ®¤¨­ ª®¢®©
±²¥¯¥­¨ (ª®²®°»µ ¬®¦¥² ¡»²¼ ¬­®£®, ¥±«¨ ª®°­¥¢®© ±¯¨±®ª ¤«¨­­»©) ®¯« ·¨¢ ¾²±¿ ª ª ° § §  ±·¥² ³¬¥­¼¸¥­¨¿ ¤«¨­» ª®°­¥¢®£®
±¯¨±ª !
¯° ¦­¥­¨¿
21.2-1  °¨±³©²¥ ´¨¡®­ ··¨¥¢³ ª³·³, ª®²®° ¿ ¯®«³·¨²±¿ ¢ °¥§³«¼² ²¥ ¨§º¿²¨¿ ¬¨­¨¬ «¼­®© ¢¥°¸¨­» (± ¯®¬®¹¼¾ ¯°®¶¥¤³°»
Fib-Heap-Extract-Min) ¨§ ª³·¨ °¨±. 21.3¬.
21.2-2 ®ª ¦¨²¥, ·²® «¥¬¬  20.1 ®±² ¥²±¿ ¢¥°­®© ¤«¿ ­¥³¯®°¿¤®·¥­­»µ ¡¨­®¬¨ «¼­»µ ¤¥°¥¢¼¥¢, ¥±«¨ ±¢®©±²¢® 4 § ¬¥­¨²¼ ­  ±¢®©±²¢® 40: ª®°¥­¼ ­¥³¯®°¿¤®·¥­­®£® ¡¨­®¬¨ «¼­®£® ¤¥°¥¢  Uk ¨¬¥¥²
±²¥¯¥­¼ k, ª®²®° ¿ ¿¢«¿¥²±¿ ¬ ª±¨¬ «¼­®© ±²¥¯¥­¼¾ ¢¥°¸¨­» ¢ ¤¥°¥¢¥; ¤¥²¨ ª®°­¿ ¿¢«¿¾²±¿ ¢¥°¸¨­ ¬¨ ¤¥°¥¢¼¥¢ U0; U1; : : :; Uk;1 (¢
­¥ª®²®°®¬ ¯®°¿¤ª¥).
21.2-3 ®ª ¦¨²¥, ·²® ¥±«¨ ¢»¯®«­¿¾²±¿ «¨¸¼ ®¯¥° ¶¨¨, ®¯¨± ­­»¥ ¢ ° §¤¥«¥ 21.2, ²® ¢ ª³·¥ ± n ¢¥°¸¨­ ¬¨ ¢±¥ ¢¥°¸¨­» ¨¬¥¾²
±²¥¯¥­¼ ­¥ ¡®«¼¸¥ blg nc.
21.2-4 °®´¥±±®° ¯°¨¤³¬ « ­®¢³¾ ±²°³ª²³°³ ¤ ­­»µ, ®±­®¢ ­­³¾ ­  ´¨¡®­ ··¨¥¢»µ ª³· µ: ®¯¥° ¶¨¨ ¢»¯®«­¿¾²±¿ ª ª ®¯¨± ­®
¢ ° §¤¥«¥ 21.2, ­® ²®«¼ª® ¯®±«¥ ¤®¡ ¢«¥­¨¿ ¢¥°¸¨­» ¨ ±®¥¤¨­¥­¨¿
¤¢³µ ª³· ±° §³ ¦¥ ¯°®¨§¢®¤¨²±¿ ³¯«®²­¥­¨¥ ª®°­¥¢®£® ±¯¨±ª .  ª®¢® ¢°¥¬¿ ¢»¯®«­¥­¨¿ ° §«¨·­»µ ®¯¥° ¶¨© ­ ¤ ² ª¨¬¨ ª³· ¬¨ ¢

¬¥­¼¸¥­¨¥ ª«¾·  ¨ ³¤ «¥­¨¥ ¢¥°¸¨­»

431

µ³¤¸¥¬ ±«³· ¥? ³¤¥² «¨ ² ª ¿ ±²°³ª²³°  ¤ ­­»µ ·¥¬-²® ­®¢»¬?
21.2-5 ³¤¥¬ ±·¨² ²¼, ·²® ª«¾·¨ ¬®¦­® ²®«¼ª® ±° ¢­¨¢ ²¼ (¨µ
¢­³²°¥­­¿¿ ±²°³ª²³°  ­ ¬ ­¥¤®±²³¯­ ). ®¦­® «¨ ²®£¤  °¥ «¨§®¢ ²¼ ®¯¥° ¶¨¨ ­ ¤ ±«¨¢ ¥¬»¬¨ ª³· ¬¨ ² ª, ·²®¡» ª ¦¤ ¿ ¨§ ­¨µ
¨¬¥«  ³·¥²­³¾ ±²®¨¬®±²¼ O(1)? (ª § ­¨¥: ¨±¯®«¼§³©²¥ ®¶¥­ª¨ ¤«¿
¢°¥¬¥­¨ ±®°²¨°®¢ª¨.)

21.3. ¬¥­¼¸¥­¨¥ ª«¾·  ¨ ³¤ «¥­¨¥ ¢¥°¸¨­»
 ½²®¬ ° §¤¥«¥ ¬» ¯®ª ¦¥¬, ª ª °¥ «¨§®¢ ²¼ ®¯¥° ¶¨¾ ³¬¥­¼¸¥­¨¿ ª«¾·  § ¤ ­­®© ¢¥°¸¨­» ± ³·¥²­®© ±²®¨¬®±²¼¾ O(1),   ² ª¦¥
®¯¥° ¶¨¾ ³¤ «¥­¨¿ ¢¥°¸¨­» ¨§ ´¨¡®­ ··¨¥¢®© ª³·¨ ± ³·¥²­®© ±²®¨¬®±²¼¾ O(D(n)) (£¤¥ n | ·¨±«® ¢¥°¸¨­ ¢ ª³·¥),   D(n) | ®¶¥­ª 
¤«¿ ¬ ª±¨¬ «¼­®© ±²¥¯¥­¨ ¢¥°¸¨­».
®±«¥ ½²¨µ ®¯¥° ¶¨© ¢µ®¤¿¹¨¥ ¢ ª³·³ ¤¥°¥¢¼¿ ¯¥°¥±² ¾² ¡»²¼
¡¨­®¬¨ «¼­»¬¨, ­® ­¥ ±«¨¸ª®¬ ¤ «¥ª® ®²ª«®­¿¾²±¿ ®² ­¨µ, ² ª
·²® ¬ ª±¨¬ «¼­ ¿ ±²¥¯¥­¼ ¢¥°¸¨­» ®±² ¥²±¿ ° ¢­®© O(lg n).  ª¨¬
®¡° §®¬, ®¯¥° ¶¨¨ Fib-Heap-Extract-Min ¨ Fib-Heap-Delete
¨¬¥¾² ³·¥²­³¾ ±²®¨¬®±²¼ O(lg n).
¬¥­¼¸¥­¨¥ ª«¾· 
 ±«¥¤³¾¹¥© ¯°®¶¥¤³°¥ ³¬¥­¼¸¥­¨¿ ª«¾·  (Fib-HeapDecrease-Key) ¬» ¯°¥¤¯®« £ ¥¬, ·²® ¯®±«¥ ¨§º¿²¨¿ ¢¥°¸¨­» ¨§
±¯¨±ª  ±±»«ª  ­  ¢¥°¸¨­³-°¥¡¥­ª  ­¥ ¬¥­¿¥²±¿ (² ª ·²® ¯°®¶¥¤³° 
Cut ¢»°¥§ ¥² ¶¥«®¥ ¯®¤¤¥°¥¢®, ±¬. ­¨¦¥)
Fib-Heap-Decrease-Key (H; x; k)
1 if k > key[x]
2 then error À­®¢®¥ §­ ·¥­¨¥ ª«¾·  ¡®«¼¸¥ ±² °®£®Á
3 key[x] k
4 y p[x]
5 if y 6= nil and key[x] < key[y ]
6 then Cut(H; x; y )
7
Cascading-Cut(H; y )
8 if key[x] < key[min[H ]]
9 then min[H ] x

432

« ¢  21 ¨¡®­ ··¨¥¢» ª³·¨

Cut(H; x; y )

1
2
3
4

³¤ «¨²¼ x ¨§ ±¯¨±ª  ¤¥²¥© ¢¥°¸¨­» y , ³¬¥­¼¸¨¢ degree[y ] ­  1
¤®¡ ¢¨²¼ x ¢ ª®°­¥¢®© ±¯¨±®ª ª³·¨ H
p[x] nil
mark[x] false

Cascading-Cut(H; y )

1 z p[y ]
2 if z 6= nil
3 then if mark[y ] = false
4
then mark[y ] true
5
else Cut(H; y; z )
6
Cascading-Cut(H; z )
°®¶¥¤³°  Fib-Heap-Decrease-Key ° ¡®² ¥² ² ª. ­ · « 
(±²°®ª¨ 1{3) ¯°®¢¥°¿¥²±¿, ¤¥©±²¢¨²¥«¼­® «¨ ­®¢®¥ §­ ·¥­¨¥ ª«¾· 
¬¥­¼¸¥ ±² °®£®. ±«¨ ¤ , ²® ±² °®¥ §­ ·¥­¨¥ § ¬¥­¿¥²±¿ ­  ­®¢®¥. ®§¬®¦­®, ­®¢®¥ §­ ·¥­¨¥ ¯®-¯°¥¦­¥¬³ ¡®«¼¸¥ §­ ·¥­¨¿ ¢
¢¥°¸¨­¥-°®¤¨²¥«¥, ²®£¤  ¢±¥ ¢ ¯®°¿¤ª¥. ±«¨ ¦¥ ­¥², ²® ¢ ±²°®ª µ
6{7 ¯®¤¤¥°¥¢® ± ª®°­¥¬ x ¢»°¥§ ¥²±¿ ¨ ¯¥°¥­®±¨²±¿ ¢ ª®°­¥¢®©
±¯¨±®ª ± ¯®¬®¹¼¾ ¯°®¶¥¤³° Àª ±ª ¤­®£® ¢»°¥§ ­¨¿Á.
¤¥¿ ²³² ¯°®±² : ¬» ­¥ µ®²¨¬ ¯®§¢®«¿²¼ ¢¥°¸¨­¥ ¢±¯«»¢ ²¼ ¤®
ª®°­¿ (­ ¯®¬­¨¬: ­ ¬ ­³¦­  ®¶¥­ª  O(1) ¤«¿ ³·¥²­®© ±²®¨¬®±²¨).
°¨µ®¤¨²±¿ ¥¥ ¢»°¥§ ²¼ ¶¥«¨ª®¬ ¨ ¯®¬¥¹ ²¼ ¢ ª®°­¥¢®© ±¯¨±®ª.
² ½²®£® ° ±²¥² ¯®²¥­¶¨ «, ­® ¢±¥£® ­  O(1), ² ª ·²® ½²® ­¥ ±²° ¸­®. ® ¬» ¤®«¦­» ±«¥¤¨²¼ §  ±²°³ª²³°®© ¤¥°¥¢ , ¯®±ª®«¼ª³ µ®²¨¬
¨¬¥²¼ «®£ °¨´¬¨·¥±ª³¾ ®¶¥­ª³ ­  ¬ ª±¨¬ «¼­³¾ ±²¥¯¥­¼ ¢¥°¸¨­» (D(n) = O(lg n)).  ¡¥£ ¿ ¢¯¥°¥¤, ®²¬¥²¨¬, ·²® ¢»±®²  ¤¥°¥¢ 
­¥ ®¡¿§ ­  ¡»²¼ «®£ °¨´¬¨·¥±ª®© (±¬. ³¯°. 21.4-1).
» ¡³¤¥¬ ±«¥¤¨²¼, ·²®¡» ³ ®¤­®© ¨ ²®© ¦¥ ¢¥°¸¨­», ­¥ ¢µ®¤¿¹¥© ¢ ª®°­¥¢®© ±¯¨±®ª, ­¥ ³¤ «¿«®±¼ ­¥±ª®«¼ª® ¤¥²¥©. «¿ ½²®£®
¨±¯®«¼§³¾²±¿ ¯®¬¥²ª¨ (¯®«¥ mark ): ¯®±«¥ ³¤ «¥­¨¿ °¥¡¥­ª  (¯¥°¥­¥±¥­¨¿ ¥£® ¢ ª®°­¥¢®© ±¯¨±®ª ± ¯®¬®¹¼¾ ¯°®¶¥¤³°» Cut) ¢¥°¸¨­ 
¤¥« ¥²±¿ ®²¬¥·¥­­®©, ¥±«¨ ®­  ° ­¥¥ ­¥ ¡»«  ®²¬¥·¥­­®© ¨ ­¥ ¡»« 
ª®°­¥¬ (±²°®ª¨ 3{4 ¯°®¶¥¤³°» Cascading-Cut). ±«¨ ¦¥ ¢¥°¸¨­ , ³ ª®²®°®© ³¤ «¥­ °¥¡¥­®ª, ³¦¥ ¡»«  ®²¬¥·¥­­®©, ²® ®­  ± ¬ 
¯¥°¥­®±¨²±¿ ¢ ª®°­¥¢®© ±¯¨±®ª,   ¤«¿ ¥¥ °®¤¨²¥«¿ ¯®¢²®°¿¥²±¿ ² 
¦¥ ¯°®¶¥¤³° .
®±«¥ ¢»¯®«­¥­¨¿ ®¯¥° ¶¨© ¢»°¥§ ­¨¿ ®±² ¥²±¿ ²®«¼ª® ±ª®°°¥ª²¨°®¢ ²¼  ²°¨¡³² min[H ].  ¬¥²¨¬, ·²® ¬¨­¨¬ «¼­®© ¬®¦¥² ¡»²¼
«¨¡® ¢¥°¸¨­  ± ³¬¥­¼¸¥­­»¬ ª«¾·®¬, «¨¡® ¯°¥¦­¿¿ ¬¨­¨¬ «¼­ ¿
¢¥°¸¨­ .
 ª¨¬ ®¡° §®¬, ¦¨§­¥­­»© ¶¨ª« ¢¥°¸¨­» ¢»£«¿¤¨² ² ª. ­ · «  ®­  ¤®¡ ¢«¿¥²±¿ ¢ ¤¥°¥¢®, ¯®¯ ¤ ¿ ¢ ¥£® ª®°­¥¢®© ±¯¨±®ª.
°¨ ¢»¯®«­¥­¨¨ ®¯¥° ¶¨¨ Consolidate ¤¥°¥¢¼¿ ¢ ª®°­¥¢®¬ ±¯¨±-

¬¥­¼¸¥­¨¥ ª«¾·  ¨ ³¤ «¥­¨¥ ¢¥°¸¨­»

433

ª¥ ®¡º¥¤¨­¿¾²±¿. °¨ ½²®¬ ¢¥°¸¨­  ¬®¦¥² «¨¡® ®±² ²¼±¿ ¢ ª®°­¥¢®¬ ±¯¨±ª¥, ¯°¨®¡°¥²¿ ­®¢®£® °¥¡¥­ª  (¥±«¨ ¥¥ ª«¾· ¬¥­¼¸¥
ª«¾·  ¤°³£®© ¢¥°¸¨­», ± ª®²®°®© ®­  ®¡º¥¤¨­¿¥²±¿), «¨¡® ±² ²¼
°¥¡¥­ª®¬ ¤°³£®© ¢¥°¸¨­» ª®°­¥¢®£® ±¯¨±ª . ¥°¸¨­  ª®°­¥¢®£®
±¯¨±ª  ¬®¦¥² ­¥ ²®«¼ª® ¯°¨®¡°¥² ²¼ ¤¥²¥©, ­® ¨ ²¥°¿²¼ ¨µ (¯°®¶¥¤³°  Cut); ®²¬¥²¨¬, ·²® ¯°¨ ½²®¬ ®­  ­¥ ±² ­®¢¨²±¿ ¯®¬¥·¥­­®©
(±²°®ª  4 ¯°®¶¥¤³°» Cascading-Cut ¢»¯®«­¿¥²±¿, «¨¸¼ ¥±«¨ ¢»¯®«­¥­® ³±«®¢¨¥ ¢ ±²°®ª¥ 2).
 ª ª®©-²® ¬®¬¥­² ¢¥°¸¨­  ¨±ª«¾· ¥²±¿ ¨§ ª®°­¥¢®£® ±¯¨±ª ,
±² ­®¢¿±¼ °¥¡¥­ª®¬ ¤°³£®© ¢¥°¸¨­» ¯°¨ ¢»¯®«­¥­¨¨ ¯°®¶¥¤³°»
Consolidate. °¨ ½²®¬ ¥¥ ¯®¬¥²ª  (¥±«¨ ®­  ¡»« ) ³¤ «¿¥²±¿
(±²°®ª  3 ¯°®¶¥¤³°» Fib-Link).  ½²®£® ¬®¬¥­²  ­®¢»µ ¤¥²¥© ³
­¥¥ ­¥ ¯°¨¡ ¢«¿¥²±¿, ­® ¬®¦¥² ¡»²¼ ³¤ «¥­ ®¤¨­ °¥¡¥­®ª, ®²·¥£®
®­  ±² ­¥² ¯®¬¥·¥­­®©. °¨ ³¤ «¥­¨¨ ¢²®°®£® °¥¡¥­ª  ¢¥°¸¨­ 
¢­®¢¼ ¯¥°¥¬¥¹ ¥²±¿ ¢ ª®°­¥¢®© ±¯¨±®ª, ±² ­®¢¿±¼ ­¥¯®¬¥·¥­­®©.
°³£®© ±¯®±®¡ ¢¥°­³²¼±¿ ¢ ª®°­¥¢®© ±¯¨±®ª | ®ª § ²¼±¿ °¥¡¥­ª®¬
¨§»¬ ¥¬®© ¢¥°¸¨­» ¯°¨ ®¯¥° ¶¨¨ Fib-Heap-Extract-Min (¯°¨
½²®¬ ¯®¬¥²ª  ­¥ ¬¥­¿¥²±¿).
®±«¥ ¢®§¢° ¹¥­¨¿ ¢ ª®°­¥¢®© ±¯¨±®ª ª ¢¥°¸¨­¥ ¢­®¢¼ ¬®£³²
¤®¡ ¢«¿²¼±¿ ¤¥²¨ (¯°¨ ®¯¥° ¶¨¨ Consolidate). ¥²¨ ¬®£³² ¨ ³¤ «¿²¼±¿ (®¯¥° ¶¨¿ Cut).  ª ª®©-²® ¬®¬¥­² ¢¥°¸¨­  ±­®¢  ¬®¦¥²
®ª § ²¼±¿ °¥¡¥­ª®¬ ¤°³£®© ¢¥°¸¨­» ª®°­¥¢®£® ±¯¨±ª , ¨ ² ª ¤ «¥¥
| ¤® ²¥µ ¯®°, ¯®ª  ½²  ¢¥°¸¨­  ­¥ ¡³¤¥² ¨§º¿²  ¨§ ¤¥°¥¢  (¨«¨ ­¥
¡³¤¥² ³¬¥­¼¸¥­ ª«¾·).
  °¨±. 21.4 ¯®ª § ­» ¤¢¥ ®¯¥° ¶¨¨ Fib-Heap-Decrease-Key,
¯¥°¢ ¿ ¨§ ª®²®°»µ ­¥ ¢»§»¢ ¥² ¶¥¯®·ª¨ ®¯¥° ¶¨© Cut,   ¢²®° ¿
¢»§»¢ ¥².
®ª ¦¥¬, ·²® ³·¥²­ ¿ ±²®¨¬®±²¼ ®¯¥° ¶¨¨ Fib-HeapDecrease-Key ±®±² ¢«¿¥² O(1).  ·­¥¬ ± ®¯°¥¤¥«¥­¨¿ ´ ª²¨·¥±ª®© ±²®¨¬®±²¨. °®¶¥¤³°» Fib-Heap-Decrease-Key, Cut
¨ Cascading-Cut ­¥ ±®¤¥°¦ ² ¶¨ª«®¢, ² ª ·²® ¢°¥¬¿ ° ¡®²»
¯°®¯®°¶¨®­ «¼­® ¤«¨­¥ ¶¥¯®·ª¨ °¥ª³°±¨¢­»µ ¢»§®¢®¢ (ª®²®°³¾
¬» ®¡®§­ ·¨¬ ·¥°¥§ c).
 ª ¯°¨ ½²®¬ ¬¥­¿¥²±¿ ¯®²¥­¶¨ «? ¥¯®·ª  °¥ª³°±¨¢­»µ ¢»§®¢®¢ ±®®²¢¥²±²¢³¥² ¶¥¯®·ª¥ ¯®¬¥·¥­­»µ ¢¥°¸¨­ ¢ ¤¥°¥¢¥, ª ¦¤ ¿
¨§ ª®²®°»µ ¿¢«¿¥²±¿ °¥¡¥­ª®¬ ±«¥¤³¾¹¥©. ²¨ ¢¥°¸¨­» ¯¥°¥¬¥¹ ¾²±¿ ¢ ª®°­¥¢®© ±¯¨±®ª ¨ ±² ­®¢¿²±¿ ­¥¯®¬¥·¥­­»¬¨.  ª¨¬
®¡° §®¬, ¯®²¥­¶¨ « ³¢¥«¨·¨¢ ¥²±¿ ¯°¨¬¥°­® ­  c §  ±·¥² ³¢¥«¨·¥­¨¿ ·¨±«  ¢¥°¸¨­ ¢ ª®°­¥¢®¬ ±¯¨±ª¥, ­® ¨ ³¬¥­¼¸ ¥²±¿ ¯°¨¬¥°­®
­  2c §  ±·¥² ²®£®, ·²® ³¬¥­¼¸ ¥²±¿ ·¨±«® ¯®¬¥·¥­­»µ ¢¥°¸¨­.
(° ¢¤ , ¬®¦¥² ¯®¿¢¨²¼±¿ ­®¢ ¿ ¯®¬¥·¥­­ ¿ ¢¥°¸¨­ , ­® ½²  ¯®¯° ¢ª  ¨¬¥¥² ¯®°¿¤®ª O(1).)  ¨²®£¥ ¯®²¥­¶¨ « ³¬¥­¼¸ ¥²±¿ ­ 
c + O(1). (¥¯¥°¼ ¿±­®, ¯®·¥¬³ ¯°¨ ®¯°¥¤¥«¥­¨¨ ¯®²¥­¶¨ «  ·¨±«®
¯®¬¥·¥­­»µ ¢¥°¸¨­ ³·¨²»¢ «®±¼ ±® ¢¤¢®¥ ¡®«¼¸¨¬ ¢¥±®¬, ·¥¬ ·¨±«® ¢¥°¸¨­ ¢ ª®°­¥¢®¬ ±¯¨±ª¥!)
¬­®¦ ¿ ¯®²¥­¶¨ « ­  ¤®±² ²®·­³¾ ª®­±² ­²³ (¢»¡¨° ¿ ¡®«¼-

434

« ¢  21 ¨¡®­ ··¨¥¢» ª³·¨

¢  ¢»§®¢  ¯°®¶¥¤³°» Fib-Heap-Decrease-Key. ( ) ±µ®¤­ ¿ ´¨¡®­ ··¨¥¢  ª³· . (¡) «¾· 46 ³¬¥­¼¸ ¥²±¿ ¤® 15, ±®®²¢¥²±²¢³¾¹ ¿ ¢¥°¸¨­ 
±² ­®¢¨²±¿ ª®°­¥¢®©,   ¥¥ °®¤¨²¥«¼ (± ª«¾·®¬ 24) | ®²¬¥·¥­­»¬. (¢){(¤) «¾·
35 ³¬¥­¼¸ ¥²±¿ ¤® 5; ¢¥°¸¨­  ±² «  ª®°­¥¢®© (¢). ¥ °®¤¨²¥«¼ (± ª«¾·®¬ 26)
¡»« ®²¬¥·¥­, ² ª ·²® ¥£® ¯°¨µ®¤¨²±¿ ² ª¦¥ ¯¥°¥­¥±²¨ ¢ ª®°­¥¢®© ±¯¨±®ª (£);
§ ²¥¬ ²® ¦¥ ± ¬®¥ ¯°®¨±µ®¤¨² ¨ ± ª«¾·®¬ 24.   ½²®¬ ª ±ª ¤ ¢»°¥§ ­¨© § ª ­·¨¢ ¥²±¿, ² ª ª ª ¢¥°¸¨­  ± ª«¾·®¬ 7 | ª®°­¥¢ ¿. (±«¨ ¡» ®­  ­¥ ¡»« 
ª®°­¥¢®©, ²® ®­  ±² «  ¡» ®²¬¥·¥­­®©, ¨ ª ±ª ¤ ¢±¥ ° ¢­® § ª®­·¨«±¿ ¡».)
®±«¥ ½²®£® ®±² ¥²±¿ ¯¥°¥­¥±²¨ ³ª § ²¥«¼ min[H ] ­  ­®¢³¾ ¬¨­¨¬ «¼­³¾ ¢¥°¸¨­³ (¤).
¨±. 21.4

¸³¾ À¥¤¨­¨¶³ ° ¡®²»Á), ¬®¦­® ±·¨² ²¼, ·²® ³¬¥­¼¸¥­¨¥ ¯®²¥­¶¨ «  ª®¬¯¥­±¨°³¥² ´ ª²¨·¥±ª³¾ ±²®¨¬®±²¼ ¶¥¯®·ª¨ °¥ª³°±¨¢­»µ ¢»§®¢®¢, ² ª ·²® ³·¥²­ ¿ ±²®¨¬®±²¼ ®¯¥° ¶¨¨ Fib-HeapDecrease-Key ¥±²¼ O(1).
¤ «¥­¨¥ ¢¥°¸¨­»
²  ®¯¥° ¶¨¿ ±¢®¤¨²±¿ ª ¤¢³¬ ° ±±¬®²°¥­­»¬ ° ­¥¥ (¬» ±·¨² ¥¬, ·²® ª«¾· ;1 ¬¥­¼¸¥ ¢±¥µ ª«¾·¥© ª³·¨).
Fib-Heap-Delete (H; x)
1 Fib-Heap-Decrease-Key (H; x; ;1)
2 Fib-Heap-Extract-Min(H )
­ «®£¨·­»¬ ®¡° §®¬ ¬» ¯®±²³¯ «¨ ¨ ± ¡¨­®¬¨ «¼­»¬¨ ¤¥°¥¢¼¿¬¨. ­ · «  ¢¥°¸¨­  x ¤¥« ¥²±¿ ¬¨­¨¬ «¼­®©,   § ²¥¬ ³¤ «¿¥²±¿. ·¥²­ ¿ ±²®¨¬®±²¼ ² ª¨µ ¤¥©±²¢¨© ° ¢­  ±³¬¬¥ ³·¥²­®© ±²®-

¶¥­ª  ¬ ª±¨¬ «¼­®© ±²¥¯¥­¨

435

¨¬®±²¨ ®¯¥° ¶¨¨ Fib-Heap-Decrease-Key (ª®²®° ¿ ¥±²¼ O(1)) ¨
®¯¥° ¶¨¨ Fib-Heap-Extract-Min (ª®²®° ¿ ¥±²¼ O(D(n))).
¯° ¦­¥­¨¿
21.3-1  ª¨¬ ®¡° §®¬ ¬®¦¥² ¯®¿¢¨²¼±¿ ¯®¬¥·¥­­ ¿ ¢¥°¸¨­  ¢
ª®°­¥¢®¬ ±¯¨±ª¥?
21.3-2 ®ª ¦¨²¥ ®¶¥­ª³ O(1) ¤«¿ ³·¥²­®© ±²®¨¬®±²¨ ®¯¥° ¶¨¨ Fib-Heap-Decrease-Key, ¨±¯®«¼§³¿ ¬¥²®¤ £°³¯¯¨°®¢ª¨ (° §¤¥« 18.1).

21.4. ¶¥­ª  ¬ ª±¨¬ «¼­®© ±²¥¯¥­¨
«¿ ¯®«³·¥­¨¿ ®¡¥¹ ­­»µ ®¶¥­®ª O(lg n) ¤«¿ ³·¥²­®© ±²®¨¬®±²¨ ®¯¥° ¶¨© Fib-Heap-Extract-Min ¨ Fib-Heap-Delete ®±² «®±¼ ¯®ª § ²¼, ·²® ¬ ª±¨¬ «¼­ ¿ ±²¥¯¥­¼ D(n), ª®²®°³¾ ¬®¦¥²
¨¬¥²¼ ª ª ¿-«¨¡® ¢¥°¸¨­  ¢ ´¨¡®­ ··¨¥¢®© ª³·¥ ± n ¢¥°¸¨­ ¬¨,
­¥ ¯°¥¢®±µ®¤¨² O(lg n).
 ª ¯®ª §»¢ ¥² ³¯° ¦­¥­¨¥ 21.2-3, ¥±«¨ ¢±¥ ¤¥°¥¢¼¿ ¢ ´¨¡®­ ··¨¥¢®© ª³·¥ ¿¢«¿¾²±¿ ­¥³¯®°¿¤®·¥­­»¬¨ ¡¨­®¬¨ «¼­»¬¨ ¤¥°¥¢¼¿¬¨, ²® D(n) = blg nc. ® ®¯¥° ¶¨¨ ¢»°¥§ ­¨¿, ª®²®°»¥ ¯°®¨±µ®¤¿²
¢® ¢°¥¬¿ ¨±¯®«­¥­¨¿ ¯°®¶¥¤³°» Fib-Heap-Decrease-Key, ¯°¨¢®¤¿² ª ²®¬³, ·²® ¤¥°¥¢¼¿ ¢ ´¨¡®­ ··¨¥¢®© ª³·¥ ¡®«¥¥ ­¥ ¿¢«¿¾²±¿
¡¨­®¬¨ «¼­»¬¨. » ¯®ª ¦¥¬, ·²® ²¥¬ ­¥ ¬¥­¥¥ ¯°¨ ¢»¯®«­¥­¨¨
®¯¨± ­­»µ ®¯¥° ¶¨© ®±² ¥²±¿ ¢ ±¨«¥ ®¶¥­ª  D(n) = Op(lg2 n). ®·­¥¥, ¬» ³±² ­®¢¨¬, ·²® D(n) 6 blog' nc, £¤¥ ' = (1 + 5)=2.
«¿ ª ¦¤®© ¢¥°¸¨­» ´¨¡®­ ··¨¥¢®© ª³·¨ ·¥°¥§ size(x) ®¡®§­ ·¨¬ ·¨±«® ¢¥°¸¨­ ¢ ¯®¤¤¥°¥¢¥ ± ª®°­¥¬ x, ±·¨² ¿ ± ¬³ ¢¥°¸¨­³ x.
(¥°¸¨­  x ­¥ ®¡¿§ ­  ¡»²¼ ª®°­¥¢®© ¢¥°¸¨­®© ª³·¨.) » ¯®ª ¦¥¬, ·²® ¢¥«¨·¨­  size(x) ½ª±¯®­¥­¶¨ «¼­® § ¢¨±¨² ®² degree[x].
( ¯®¬­¨¬, ·²® ¯®«¥ degree[x] ¯®¤¤¥°¦¨¢ ¥²±¿ ° ¢­»¬ ±²¥¯¥­¨
¢¥°¸¨­» x.)
¥¬¬  21.1. ³±²¼ x | ¯°®¨§¢®«¼­ ¿ ¢¥°¸¨­  ´¨¡®­ ··¨¥¢®© ª³·¨, ¨ ¯³±²¼ degree[x] = k. ®£¤  ±²¥¯¥­¨ k ¤¥²¥© ¢¥°¸¨­» x ­¥
¬¥­¼¸¥ 0; 0; 1; 2; 3; : : :; k ; 2, ¥±«¨ ¨µ ° ±¯®«®¦¨²¼ ¢ ­ ¤«¥¦ ¹¥¬
¯®°¿¤ª¥.
®ª § ²¥«¼±²¢®. «¿ ¢¥°¸¨­, ­¥ ¢µ®¤¿¹¨µ ¢ ª®°­¥¢®© ±¯¨±®ª,
®¯°¥¤¥«¨¬ À¬®¤¨´¨¶¨°®¢ ­­³¾ ±²¥¯¥­¼Á, ª®²®° ¿ ­  ¥¤¨­¨¶³ ¡®«¼¸¥ °¥ «¼­®© ±²¥¯¥­¨ ¤«¿ ¯®¬¥·¥­­»µ (¨ ±®¢¯ ¤ ¥² ± ­¥© ¤«¿ ­¥¯®¬¥·¥­­»µ). ¬»±« ½²®£® ² ª®©: ¯®±ª®«¼ª³ ¯°¨ ³¤ «¥­¨¨ °¥¡¥­ª  ³
¢¥°¸¨­» ¤¥« ¥²±¿ ¯®¬¥²ª , ²® ¥¥ ¬®¤¨´¨¶¨°®¢ ­­ ¿ ±²¥¯¥­¼ ­¥ ¬¥­¿¥²±¿,   ¤®¡ ¢«¥­¨¥ ¤¥²¥© ¢®§¬®¦­® ²®«¼ª® ¤«¿ ¢¥°¸¨­ ¢ ª®°­¥¢®¬

436

« ¢  21 ¨¡®­ ··¨¥¢» ª³·¨

±¯¨±ª¥.  ª¨¬ ®¡° §®¬, ¬®¤¨´¨¶¨°®¢ ­­ ¿ ±²¥¯¥­¼ ¥±²¼ ±²¥¯¥­¼ ­ 
¬®¬¥­² (¯®±«¥¤­¥£®) ¢»¡»²¨¿ ¢¥°¸¨­» ¨§ ª®°­¥¢®£® ±¯¨±ª .
®±ª®«¼ª³ ¬®¤¨´¨¶¨°®¢ ­­ ¿ ±²¥¯¥­¼ ®²«¨· ¥²±¿ ®² °¥ «¼­®©
­¥ ¡®«¥¥ ·¥¬ ­  1, ¤®±² ²®·­® ¤®ª § ²¼, ·²® ³ ¢¥°¸¨­» (°¥ «¼­®©) ±²¥¯¥­¨ k ¤¥²¨ ¨¬¥¾² ¬®¤¨´¨¶¨°®¢ ­­³¾ ±²¥¯¥­¼ ­¥ ¬¥­¥¥
0; 1; 2; : : :; k ; 1. ±­®, ·²® ½²® ±¢®©±²¢® ±®µ° ­¿¥²±¿ ¯°¨ ³¤ «¥­¨¨
®¤­®£® ¨§ ¤¥²¥©. °®¬¥ ²®£®, ®­® ±®µ° ­¿¥²±¿ ¯°¨ ¤®¡ ¢«¥­¨¨ ª
¢¥°¸¨­¥ ±²¥¯¥­¨ k ¤°³£®© ¢¥°¸¨­» ±²¥¯¥­¨ k (¯°¨ ¯®¤·¨­¥­¨¨
®¤­®© ¢¥°¸¨­» ª®°­¥¢®£® ±¯¨±ª  ¤°³£®© ¯¥°¢ ¿ ¤¥« ¥²±¿ ­¥¯®¬¥·¥­­®©, ² ª ·²® ¥¥ °¥ «¼­ ¿ ±²¥¯¥­¼ ° ¢­  ¬®¤¨´¨¶¨°®¢ ­­®©).
¥¯¥°¼ ®¶¥­¨¬ ·¨±«® ¯®²®¬ª®¢ ¤«¿ ¢¥°¸¨­» ±²¥¯¥­¨ k, ¨±¯®«¼§³¿
·¨±«  ¨¡®­ ··¨.  ¯®¬­¨¬, ·²® k-¥ ·¨±«® ¨¡®­ ··¨ Fk ®¯°¥¤¥«¿¥²±¿ ² ª:
8
>
¥±«¨ k = 0,
< 0
Fk = > 1
¥±«¨ k = 1,
:
Fk;1 + Fk;2 ¥±«¨ k > 2.
¥¬¬  21.2.
k
X
Fk+2 = 1 + Fi
i=0

¤«¿ «¾¡®£® k > 0.
P
®ª § ²¥«¼±²¢®. °¨ k = 0 ½²® ¢¥°­®: 1 + 0i=0 Fi = 1 + F0 =
1 + 0 = 1 = F2 .
P ;1
 ±±³¦¤ ¿ ¯® ¨­¤³ª¶¨¨, ¯°¥¤¯®« £ ¥¬, ·²® Fk+1 = 1 + ki=0
Fi .
®£¤ 

Fk+2 = Fk + Fk+1 = Fk + 1 +

kX
;1
i=0

!

Fi = 1 +

k
X
i=0

Fi :

¥¯¥°¼ ¬» ³¦¥ ¬®¦¥¬ ®¶¥­¨²¼ ·¨±«® ¢¥°¸¨­ ¢ ¯®¤¤¥°¥¢¥, ¥±«¨
¨§¢¥±²­ 
±²¥¯¥­¼ ¥£® ª®°­¿.  ¯®¬­¨¬, ·²® Fk+2 > 'k , £¤¥ ' = (1+
p
5)=2 = 1:61803 : : : | À§®«®²®¥ ±¥·¥­¨¥Á (2.14). (²® ­¥° ¢¥­±²¢®
¤®ª § ­® ¢ ³¯°. 2.2-8.)
¥¬¬  21.3. ³±²¼ x | ¢¥°¸¨­  ´¨¡®­ ··¨¥¢®© ª³·¨, ¨¬¥¾¹ ¿
±²¥¯¥­¼ k ¨«¨ ¡®«¼¸¥. ®£¤  size(x) > Fk+2 > 'k , £¤¥ ' = (1 +
p
5)=2.
®ª § ²¥«¼±²¢®. ® «¥¬¬¥ 21.1 ¢¥°¸¨­  x ¨¬¥¥² ±°¥¤¨ ±¢®¨µ ¤¥²¥© ¢¥°¸¨­» ±²¥¯¥­¨ ­¥ ¬¥­¥¥ 0; 0; 1; 2; 3; : : :; k ; 2.  ±±³¦¤ ¿ ¯®
¨­¤³ª¶¨¨, ¬» ¬®¦¥¬ ±·¨² ²¼, ·²® ¤«¿ ¤¥²¥© ¤®ª §»¢ ¥¬®¥ ³²¢¥°¦¤¥­¨¥ ¢¥°­®. (°¨ k = 0 ·¨±«® Fk+2 ° ¢­® 1 ¨ ®¶¥­ª  ®·¥¢¨¤­ .)

 ¤ ·¨ ª £« ¢¥ 21

437

ª« ¤»¢ ¿ ·¨±«® ¢¥°¸¨­ ¢ ¯®¤¤¥°¥¢¼¿µ ¨ ¯°¨¡ ¢«¿¿ ± ¬³ ¢¥°¸¨­³ x, ¯®«³· ¥¬, ·²®
size(x) > (F2 + F2 + F3 + F4 + : : : + Fk ) + 1 =
= (F0 + F1 + F2 + : : : + Fk ) + 1 = Fk+2
(¬» ¨±¯®«¼§³¥¬ ° ¢¥­±²¢® F0 + F1 = F2 ¨ «¥¬¬³ 21.2).
«¥¤±²¢¨¥ 21.4.  ª±¨¬ «¼­ ¿ ±²¥¯¥­¼ D(n) ª ª®©-«¨¡® ¢¥°¸¨­»
¢ ´¨¡®­ ··¨¥¢®© ª³·¥ ± n ¢¥°¸¨­ ¬¨ ¥±²¼ O(lg n).
®ª § ²¥«¼±²¢®. ³±²¼ x | ¯°®¨§¢®«¼­ ¿ ¢¥°¸¨­  ² ª®© ª³·¨ ¨
¯³±²¼ k = degree[x]. ® «¥¬¬¥ 21.3 ¨¬¥¥¬ n > size(x) > 'k , ®±² ¥²±¿
¢§¿²¼ «®£ °¨´¬ ¯® ®±­®¢ ­¨¾ '.
¯° ¦­¥­¨¿
21.4-1 °®´¥±±®° ³²¢¥°¦¤ ¥², ·²® ¢»±®²  ´¨¡®­ ··¨¥¢®© ª³·¨
¨§ n ½«¥¬¥­²®¢ ­¥ ¯°¥¢»¸ ¥² O(lg n). ®ª ¦¨²¥, ·²® ®­ ®¸¨¡ ¥²±¿ ¨ ·²® ±³¹¥±²¢³¥² ¯®±«¥¤®¢ ²¥«¼­®±²¼ ®¯¥° ¶¨© ° ±±¬®²°¥­­»µ
­ ¬¨ ²¨¯®¢, ª®²®° ¿ ¯°¨¢®¤¨² ª ª³·¥, ±®±²®¿¹¥© °®¢­® ¨§ ®¤­®£®
¤¥°¥¢ , ¿¢«¿¾¹¥£®±¿ «¨­¥©­®© ¶¥¯¼¾ ¨§ n ¢¥°¸¨­.
21.4-2 §¬¥­¨¬ ¯° ¢¨«  ¨ ¡³¤¥¬ ±·¨² ²¼, ·²® ¢¥°¸¨­  ¯¥°¥¬¥¹ ¥²±¿ ¢ ª®°­¥¢®© ±¯¨±®ª, ª®£¤  ®­  ¯®²¥°¿«  k ±¢®¨µ ¯®²®¬ª®¢,
£¤¥ k | ­¥ª®²®° ¿ ª®­±² ­²  (¤® ±¨µ ¯®° ¬» ±·¨² «¨, ·²® k = 2).
°¨ ª ª¨µ §­ ·¥­¨¿µ k ¬®¦­® ³²¢¥°¦¤ ²¼, ·²® D(n) = O(lg n)?

 ¤ ·¨
21-1 °³£®© ±¯®±®¡ ³¤ «¥­¨¿ ½«¥¬¥­² 
°®´¥±±®° ¯°¥¤«®¦¨« ±«¥¤³¾¹¨© ¢ °¨ ­² ¯°®¶¥¤³°» Fib-HeapDelete, ³²¢¥°¦¤ ¿, ·²® ­®¢ ¿ ¯°®¶¥¤³°  ° ¡®² ¥² ¡»±²°¥¥ ¢ ²®¬
±«³· ¥, ª®£¤  ³¤ «¿¥¬ ¿ ¢¥°¸¨­  | ­¥ ¬¨­¨¬ «¼­ ¿.
New-Delete (H; x)
1 if x = min[H ]
2 then Fib-Heap-Extract-Min(H )
3 else y p[x]
4
if y 6= nil
5
then Cut(H; x; y )
6
Cascading-Cut(H; y )
7
¤®¡ ¢¨²¼ ¤¥²¥© ¢¥°¸¨­» x ¢ ª®°­¥¢®© ±¯¨±®ª ª³·¨ H
8
³¤ «¨²¼ x ¨§ ª®°­¥¢®£® ±¯¨±ª  ª³·¨ H

438

« ¢  21 ¨¡®­ ··¨¥¢» ª³·¨

a. °®´¥±±®° £®¢®°¨², ·²® ¤ ­­ ¿ ¯°®¶¥¤³°  ° ¡®² ¥² ¡»±²°®, ¯®±ª®«¼ª³ ´ ª²¨·¥±ª®¥ ¢°¥¬¿ ¨±¯®«­¥­¨¿ ±²°®ª¨ 7 ¥±²¼ O(1).  ª®¥ ®¡±²®¿²¥«¼±²¢® ®­ ³¯³±ª ¥² ¨§ ¢¨¤³?
¡. ¶¥­¨²¥ ±¢¥°µ³ ¢°¥¬¿ ¢»¯®«­¥­¨¿ ¯°®¶¥¤³°» New-Delete ¤«¿
±«³· ¿ x 6= min[H ] ¢ ²¥°¬¨­ µ degree[x] ¨ ·¨±«  c ¢»§®¢®¢ ¯°®¶¥¤³°» Cascading-Cut.
¢. ³±²¼ H 0 | ´¨¡®­ ··¨¥¢  ª³· , ¯®«³· ¾¹ ¿±¿ ¢ °¥§³«¼² ²¥
¢»¯®«­¥­¨¿ ¯°®¶¥¤³°» New-Delete(H; x). °¥¤¯®« £ ¿, ·²®
¢¥°¸¨­  x ­¥ ¿¢«¿¥²±¿ ª®°­¥¬, ®¶¥­¨²¥ ¯®²¥­¶¨ « ª³·¨ H 0 ¢
²¥°¬¨­ µ ¢¥«¨·¨­ degree[x], c, t[H ] (·¨±«® ¤¥°¥¢¼¥¢ ¢ ª®°­¥¢®¬
±¯¨±ª¥) ¨ m[H ] (·¨±«® ®²¬¥·¥­­»µ ¢¥°¸¨­).
£. ®«³·¨²¥ ®¶¥­ª³ ¤«¿ ³·¥²­®© ±²®¨¬®±²¨ ¢»¯®«­¥­¨¿ NewDelete ¤«¿ ±«³· ¿ x 6= min[H ]. ³¤¥² «¨ ®­  «³·¸¥ ¯°¥¦­¥©?
21-2 ®¯®«­¨²¥«¼­»¥ ®¯¥° ¶¨¨ ­ ¤ ´¨¡®­ ··¨¥¢»¬¨ ª³· ¬¨
» µ®²¨¬ °¥ «¨§®¢ ²¼ ¥¹¥ ¤¢¥ ®¯¥° ¶¨¨, ­¥ ¬¥­¿¿ ³·¥²­®© ±²®¨¬®±²¨ ° ­¥¥ ° ±±¬®²°¥­­»µ ®¯¥° ¶¨©.
 . °¨¤³¬ ©²¥ ½´´¥ª²¨¢­³¾ °¥ «¨§ ¶¨¾ ®¯¥° ¶¨¨ Fib-HeapChange-Key(H; x; k) ª®²®° ¿ ¯°¨±¢ ¨¢ ¥² ª«¾·³ ¢¥°¸¨­» x
­®¢®¥ §­ ·¥­¨¥ k. ¶¥­¨²¥ ³·¥²­³¾ ±²®¨¬®±²¼ ½²®© ®¯¥° ¶¨¨
(¯°¨ ¢ ¸¥© °¥ «¨§ ¶¨¨) ¤«¿ ±«³· ¥¢ k < key[x], k = key[x],
k > key[x].
¡. °¨¤³¬ ©²¥ ½´´¥ª²¨¢­³¾ °¥ «¨§ ¶¨¾ ®¯¥° ¶¨¨ Fib-HeapPrune(H; r) ª®²®° ¿ ³¤ «¿¥² min(r; n[H ]) ¢¥°¸¨­ ¨§ H (¢±¥ ° ¢­® ª ª¨µ). ¶¥­¨²¥ ³·¥²­³¾ ±²®¨¬®±²¼ ½²®© ®¯¥° ¶¨¨ (¤«¿ ¢ ¸¥© °¥ «¨§ ¶¨¨). (ª § ­¨¥: ¬®¦¥² ¯®²°¥¡®¢ ²¼±¿ ¨§¬¥­¥­¨¥
±²°³ª²³°» ¤ ­­»µ ¨ ¯®²¥­¶¨ «¼­®© ´³­ª¶¨¨.)

 ¬¥· ­¨¿
¨¡®­ ··¨¥¢» ª³·¨ ¢¢¥«¨ °¥¤¬ ­ ¨  °¼¿­ [75].  ¨µ ±² ²¼¥
®¯¨± ­» ² ª¦¥ ¯°¨«®¦¥­¨¿ ´¨¡®­ ··¨¥¢»µ ª³· ª § ¤ · ¬ ® ª° ²· ©¸¨µ ¯³²¿µ ¨§ ®¤­®© ¢¥°¸¨­», ® ª° ²· ©¸¨µ ¯³²¿µ ¤«¿ ¢±¥µ
¯ ° ¢¥°¸¨­, ® ¯ °®±®·¥² ­¨¿µ ± ¢¥± ¬¨ ¨ ® ¬¨­¨¬ «¼­®¬ ¯®ª°»¢ ¾¹¥¬ ¤¥°¥¢¥.
¯®±«¥¤±²¢¨¨ °¨±ª®««,  °­ ª, «¥ ²®° ¨  °¼¿­ ° §° ¡®² «¨ ±²°³ª²³°³ ¤ ­­»µ, ­ §»¢ ¥¬³¾ Àrelaxed heapsÁ, ª ª § ¬¥­³
¤«¿ ´¨¡®­ ··¨¥¢»µ ª³·. ±²¼ ¤¢¥ ° §­®¢¨¤­®±²¨ ² ª®© ±²°³ª²³°» ¤ ­­»µ. ¤­  ¨§ ­¨µ ¤ ¥² ²¥ ¦¥ ®¶¥­ª¨ ³·¥²­®© ±²®¨¬®±²¨,
·²® ¨ ´¨¡®­ ··¨¥¢» ª³·¨. °³£ ¿ ¯®§¢®«¿¥² ¢»¯®«­¿²¼ ®¯¥° ¶¨¾
Decrease-Key §  ¢°¥¬¿ O(1) ¢ µ³¤¸¥¬ ±«³· ¥ (­¥ ³·¥²­®¥),   ®¯¥° ¶¨¨ Extract-Min ¨ Delete | §  ¢°¥¬¿ O(lg n) ¢ µ³¤¸¥¬ ±«³· ¥. ²  ±²°³ª²³°  ¤ ­­»µ ¨¬¥¥² ² ª¦¥ ­¥ª®²®°»¥ ¯°¥¨¬³¹¥±²¢ 

 ¬¥· ­¨¿ ª £« ¢¥ 21

439

(¯® ±° ¢­¥­¨¾ ± ´¨¡®­ ··¨¥¢»¬¨ ª³· ¬¨) ¯°¨ ¨±¯®«¼§®¢ ­¨¨ ¢ ¯ ° ««¥«¼­»µ  «£®°¨²¬ µ.

22

¨±²¥¬» ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ¬­®¦¥±²¢

 ­¥ª®²®°»µ ¯°¨«®¦¥­¨¿µ ¯®«¥§­  ±«¥¤³¾¹ ¿ ±²°³ª²³°  ¤ ­­»µ:
n ½«¥¬¥­²®¢ ° §¡¨²» ¢ ®¡º¥¤¨­¥­¨¥ ­¥¯³±²»µ ­¥¯¥°¥±¥ª ¾¹¨µ±¿
¬­®¦¥±²¢, ¯°¨·¥¬ ¯®¤¤¥°¦¨¢ ¾²±¿ ®¯¥° ¶¨¨ À®¡º¥¤¨­¥­¨¥Á (¤¢ 
¤ ­­»µ ¬­®¦¥±²¢  § ¬¥­¿¾²±¿ ­  ¨µ ®¡º¥¤¨­¥­¨¥) ¨ À­ ©²¨ ¬­®¦¥±²¢®Á (¯® ¤ ­­®¬³ ½«¥¬¥­²³ ¢»¿±­¨²¼, ¢ ª ª®¬ ¨§ ¬­®¦¥±²¢ ®­
«¥¦¨²).  ½²®© £« ¢¥ ° ±±ª § ­®, ª ª ¬®¦­® °¥ «¨§®¢ ²¼ ² ª³¾
±²°³ª²³°³ ¤ ­­»µ.
 ° §¤¥«¥ 22.1 ¬» ¤ ¥¬ ²®·­®¥ ®¯°¥¤¥«¥­¨¥ ¨­²¥°¥±³¾¹¥© ­ ±
±²°³ª²³°» ¤ ­­»µ ¨ ¯°¨¢®¤¨¬ ¯°®±²®© ¯°¨¬¥° ¥¥ ¯°¨¬¥­¥­¨¿. 
° §¤¥«¥ 22.2 ®¡±³¦¤ ¥²±¿ ¯°®±²¥©¸ ¿ °¥ «¨§ ¶¨¿ ± ¯®¬®¹¼¾ ±¯¨±ª®¢.  §¤¥« 22.3 ¯®±¢¿¹¥­ ¡®«¥¥ ½´´¥ª²¨¢­®© °¥ «¨§ ¶¨¨ ± ¯®¬®¹¼¾ «¥± . «¿ ­¥¥ ¢°¥¬¿ ¢»¯®«­¥­¨¿ m ®¯¥° ¶¨© ­¥¬­®£® ¯°¥¢®±µ®¤¨² O(m) | ­ ±²®«¼ª® ­¥¬­®£®, ·²® ¤«¿ ¢±¥µ ¯° ª²¨·¥±ª¨µ ¶¥«¥©
¬®¦­® ±·¨² ²¼, ·²® ¢°¥¬¿ ¢»¯®«­¥­¨¿ m ®¯¥° ¶¨© ¥±²¼ O(m).
®«¥¥ ²®·­®, ¢°¥¬¿ ¢»¯®«­¥­¨¿ m ®¯¥° ¶¨© ­¥ ¯°¥¢®±µ®¤¨²
C (m)m, £¤¥ C (m) ° ±²¥² ± °®±²®¬ m, ­® ®·¥­¼ ¬¥¤«¥­­®: ª®½´´¨¶¨¥­² C (m) ¬®¦­® ®¶¥­¨²¼ ±¢¥°µ³ ± ¯®¬®¹¼¾ ² ª ­ §»¢ ¥¬®©
À®¡° ²­®© ´³­ª¶¨¨ ªª¥°¬ ­ Á. ¯°¥¤¥«¥­¨¥ ®¡° ²­®© ´³­ª¶¨¨
ªª¥°¬ ­  ¤ ¥²±¿ ¢ ° §¤¥«¥ 22.4.  ¬ ¦¥ ¤®ª §»¢ ¥²±¿ ¡®«¥¥ ±« ¡ ¿ (¨ ¡®«¥¥ ¯°®±²® ¤®ª §»¢ ¥¬ ¿) ¢¥°µ­¿¿ ®¶¥­ª  ¢°¥¬¥­¨ ° ¡®²».

22.1. ¯¥° ¶¨¨ ± ­¥¯¥°¥±¥ª ¾¹¨¬¨±¿ ¬­®¦¥±²¢ ¬¨
¨±²¥¬  ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ¬­®¦¥±²¢ (disjoint-set data structure) ¥±²¼ ­ ¡®° ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ­¥¯³±²»µ ¬­®¦¥±²¢, ¢ ª ¦¤®¬
¨§ ª®²®°»µ § ´¨ª±¨°®¢ ­ ®¤¨­ ¨§ ½«¥¬¥­²®¢ | ¯°¥¤±² ¢¨²¥«¼
(representative). °¨ ½²®¬ ¤®«¦­» ¯®¤¤¥°¦¨¢ ²¼±¿ ±«¥¤³¾¹¨¥ ®¯¥° ¶¨¨:
Make-Set(x) (À±®§¤ ²¼ ¬­®¦¥±²¢®Á). ®§¤ ¥² ­®¢®¥ ¬­®¦¥±²¢®,
¥¤¨­±²¢¥­­»¬ ½«¥¬¥­²®¬ (¨ ²¥¬ ± ¬»¬ ¯°¥¤±² ¢¨²¥«¥¬) ª®²®°®£® ¿¢«¿¥²±¿ x. ®±ª®«¼ª³ ¬­®¦¥±²¢  ­¥ ¤®«¦­» ¯¥°¥±¥ª ²¼±¿,
²°¥¡³¥²±¿, ·²®¡» ½«¥¬¥­² x ­¥ «¥¦ « ­¨ ¢ ®¤­®¬ ¨§ ³¦¥ ¨¬¥¾¹¨µ±¿ ¬­®¦¥±²¢.

¯¥° ¶¨¨ ± ­¥¯¥°¥±¥ª ¾¹¨¬¨±¿ ¬­®¦¥±²¢ ¬¨

441

Find-Set(x) (À­ ©²¨ ¬­®¦¥±²¢®Á). ®§¢° ¹ ¥² ³ª § ²¥«¼ ­  ¯°¥¤-

±² ¢¨²¥«¼ (¥¤¨­±²¢¥­­®£®) ¬­®¦¥±²¢ , ±®¤¥°¦ ¹¥£® ½«¥¬¥­² x.
Union(x; y ) (À®¡º¥¤¨­¥­¨¥Á). °¨¬¥­¨¬ , ¥±«¨ ½«¥¬¥­²» x ¨ y ±®¤¥°¦ ²±¿ ¢ ° §«¨·­»µ ¬­®¦¥±²¢ µ Sx ¨ Sy , ¨ § ¬¥­¿¥² ½²¨ ¬­®¦¥±²¢  ­  ®¡º¥¤¨­¥­¨¥ Sx [ Sy ; ¯°¨ ½²®¬ ¢»¡¨° ¥²±¿ ­¥ª®²®°»©
¯°¥¤±² ¢¨²¥«¼ ¤«¿ Sx [ Sy .  ¬¨ ¬­®¦¥±²¢  Sx ¨ Sy ¯°¨ ½²®¬
³¤ «¿¾²±¿.
 ­¥ª®²®°»µ ¯°¨«®¦¥­¨¿µ ¢»¡®° ¯°¥¤±² ¢¨²¥«¿ ¢ ¬­®¦¥±²¢¥
¤®«¦¥­ ¯®¤·¨­¿²¼±¿ ª ª¨¬-²® ¯° ¢¨« ¬ (­ ¯°¨¬¥°, ½«¥¬¥­²» ¬®£³² ¡»²¼ ³¯®°¿¤®·¥­» ¨ ¯°¥¤±² ¢¨²¥«¥¬ ¿¢«¿¥²±¿ ­ ¨¬¥­¼¸¨© ½«¥¬¥­² ¬­®¦¥±²¢ ).  «¾¡®¬ ±«³· ¥ ±³¹¥±²¢¥­­®, ·²® ¯°¥¤±² ¢¨²¥«¼
¬­®¦¥±²¢  ­¥ ¬¥­¿¥²±¿, ¯®ª  ± ¬® ¬­®¦¥±²¢® ®±² ¥²±¿ ­¥¨§¬¥­­»¬.
 ½²®© £« ¢¥ ¬» ®¶¥­¨¬ ¢°¥¬¿ ° ¡®²» ®¯¥° ¶¨© ­ ¤ ±¨±²¥¬ ¬¨
­¥¯¥°¥±¥ª ¾¹¨µ±¿ ¬­®¦¥±²¢.  ° ¬¥²° ¬¨ ¡³¤³² ·¨±«® ®¯¥° ¶¨©
Make-Set (²® ¥±²¼ ®¡¹¥¥ ·¨±«® ½«¥¬¥­²®¢ ¢® ¢±¥µ ¬­®¦¥±²¢ µ),
ª®²®°®¥ ¬» ®¡®§­ ·¨¬ ·¥°¥§ n,   ² ª¦¥ ±³¬¬ °­®¥ ·¨±«® ®¯¥° ¶¨©
Union, Make-Set ¨ Find-Set, ª®²®°®¥ ¬» ®¡®§­ ·¨¬ ·¥°¥§ m.
°¥¦¤¥ ¢±¥£® § ¬¥²¨¬, ·²® (¯® ®¯°¥¤¥«¥­¨¾) m > n,   ² ª¦¥ ·²®
·¨±«® ®¯¥° ¶¨© Union ­¥ ¯°¥¢®±µ®¤¨² n ; 1 (¯®±«¥ ª ¦¤®© ¨§ ­¨µ
ª®«¨·¥±²¢® ¬­®¦¥±²¢ ³¬¥­¼¸ ¥²±¿ ­  ¥¤¨­¨¶³).
°¨¬¥° ¨±¯®«¼§®¢ ­¨¿ ±¨±²¥¬ ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ¬­®¦¥±²¢
°¨¬¥­¨¬ ±¨±²¥¬» ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ¬­®¦¥±²¢ ª § ¤ ·¥ ® ±¢¿§­»µ ª®¬¯®­¥­² µ ­¥®°¨¥­²¨°®¢ ­­®£® £° ´  (±¬. ° §¤¥« 5.4; ¯°¨¬¥° £° ´  ± ·¥²»°¼¬¿ ±¢¿§­»¬¨ ª®¬¯®­¥­² ¬¨ ¤ ­ ­  °¨±. 22.1 ).
«£®°¨²¬ Connected-Components (±¢¿§­»¥ ª®¬¯®­¥­²»),
¯°¨¢¥¤¥­­»© ­¨¦¥, ° §¡¨¢ ¥² ¬­®¦¥±²¢® ¢¥°¸¨­ £° ´  ­  ­¥¯¥°¥±¥ª ¾¹¨¥±¿ ¬­®¦¥±²¢ , ±®®²¢¥²±²¢³¾¹¨¥ ±¢¿§­»¬ ª®¬¯®­¥­² ¬;
¯®±«¥ ½²®£® ¬®¦­® ± ¯®¬®¹¼¾ ¯°®¶¥¤³°» Same-Component ¢»¿±­¨²¼, «¥¦ ² «¨ ¤¢¥ ¤ ­­»¥ ¢¥°¸¨­» ¢ ®¤­®© ª®¬¯®­¥­²¥. ±«¨
£° ´ § ¤ ­ § ° ­¥¥ (À°¥¦¨¬ o-lineÁ), ¡»±²°¥¥ ­ ©²¨ ¥£® ±¢¿§­»¥
ª®¬¯®­¥­²» ± ¯®¬®¹¼¾ ¯®¨±ª  ¢ £«³¡¨­³ (³¯° ¦­¥­¨¥ 23.3-9); ®¤­ ª® ¥±«¨ £° ´ ±²°®¨²±¿ ¯®±²¥¯¥­­® ¨ ¢ «¾¡®© ¬®¬¥­² ­ ¤® ³¬¥²¼
®²¢¥· ²¼ ­  ¢®¯°®±, ª ª®¢» ¥£® ±¢¿§­»¥ ª®¬¯®­¥­²» (À°¥¦¨¬
on-lineÁ), ²® ¬®¦¥² ®ª § ²¼±¿ ¢»£®¤­¥¥ ¯°¨¬¥­¨²¼ ­ ¸  «£®°¨²¬,
  ­¥ ¯°®¢®¤¨²¼ § ­®¢® ¯®¨±ª ¢ £«³¡¨­³ ¯®±«¥ ¤®¡ ¢«¥­¨¿ ª ¦¤®£®
¨§ °¥¡¥°.
¨¦¥ E [G] ¨ V [G] ®¡®§­ · ¾² ¬­®¦¥±²¢  ±®®²¢¥²±²¢¥­­® °¥¡¥°
¨ ¢¥°¸¨­ £° ´  G.
Connected-Components(G)
1 for (¤«¿) ª ¦¤®© ¢¥°¸¨­» v\in V[G]
2
do Make-Set(v)
3 for (¤«¿) ª ¦¤®£® °¥¡°  (u,v) \in E[G]
4
do if Find-Set(u)\ne Find-Set(v)
5
then Union(u,v)

442

« ¢  22 ¨±²¥¬» ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ¬­®¦¥±²¢

¨±. 22.1 (· ±²¼ (¡) ¿ ¤ ¦¥ ¡-¬ ­ °¨±®¢ «)
®¡° ¡®² ­­®¥ °¥¡°®
¢­ · «¥
(b; d)
(e; g )
(a; c)
(h; i)
(a; b)
(e; f )
(b; c)

f ag
f ag
f ag
fa; cg
fa; cg
fa; b; c; dg
fa; b; c; dg
fa; b; c; dg

­¥¯¥°¥±¥ª ¾¹¨¥±¿ ¬­®¦¥±²¢ 

fbg fcg fdg
fb; dg fcg
fb; dg fcg
fb; dg
fb; dg

feg
feg
fe; gg
fe; gg
fe; gg
fe; gg
fe; f; gg
fe; f; gg

ff g fgg fhg
ff g fgg fhg
ff g
fhg
ff g
fhg
ff g
fh; ig
ff g
fh; ig
fh; ig
fh; ig

fig
fig
fig
fig

fj g
fj g
fj g
fj g
fj g
fj g
fj g
fj g

22.1  ) ° ´, ±®±²®¿¹¨© ¨§ ·¥²»°¥µ ±¢¿§­»µ ª®¬¯®­¥­²: fa; b; c; dg,
fe; f; gg, fh; ig ¨ fj g. ¡) ®±«¥¤®¢ ²¥«¼­»¥ ±®±²®¿­¨¿ ±¨±²¥¬» ­¥¯¥°¥±¥ª ¾¹¨µ¨±. 22.1

±¿ ¬­®¦¥±²¢ ¢ ¯°®¶¥±±¥ ° ¡®²»  «£®°¨²¬  Connected-Components.
Same-Component(u,v)
1 if Find-Set(u)=Find-Set(v)
2
then return true
3
else return false

«£®°¨²¬ Connected-Components ° ¡®² ¥² ² ª. ­ · «  ª ¦¤ ¿ ¢¥°¸¨­  ° ±±¬ ²°¨¢ ¥²±¿ ª ª ®¤­®½«¥¬¥­²­®¥ ¯®¤¬­®¦¥±²¢®.  «¥¥ ¤«¿ ª ¦¤®£® °¥¡°  £° ´  ¬» ®¡º¥¤¨­¿¥¬ ¯®¤¬­®¦¥±²¢ , ¢ ª®²®°»¥ ¯®¯ «¨ ª®­¶» ½²®£® °¥¡°  (°¨±. 22.1¡). ®£¤  ¢±¥
°¥¡°  ®¡° ¡®² ­», ¬­®¦¥±²¢® ¢¥°¸¨­ ° §¡¨¢ ¥²±¿ ­  ±¢¿§­»¥ ª®¬¯®­¥­²» (³¯°. 22.1-2). ¥¯¥°¼ ¯°®¶¥¤³°  Same-Component ®¯°¥¤¥«¿¥², «¥¦ ² «¨ ¤¢¥ ¤ ­­»¥ ¢¥°¸¨­» ¢ ®¤­®© ±¢¿§­®© ª®¬¯®­¥­²¥,
¤¢ ¦¤» ¢»§¢ ¢ ¯°®¶¥¤³°³ Find-Set.
¯° ¦­¥­¨¿
22.1-1
«¥¤³¿ ®¡° §¶³ °¨±. 22.1, ®¯¨¸¨²¥ ¢»¯®«­¥­¨¥  «£®°¨²¬ 
Connected-Components ¤«¿ £° ´  G, ³ ª®²®°®£® V [G] =
fa; b; c; d; e; f; g; h; i; j; kg ¨ E [G] = f (d; i); (f; k); (g; i); (b; g); (a; h); (i; j); (d; k); (b; j); (d; f );
¥¡°  ®¡° ¡ ²»¢ ¾²±¿ ¢ ²®¬ ¯®°¿¤ª¥, ¢ ª®²®°®¬ ®­¨ ¢»¯¨± ­».
22.1-2
®ª ¦¨²¥, ·²®  «£®°¨²¬ Connected-Components ¤¥©±²¢¨²¥«¼­® ­ µ®¤¨² ±¢¿§­»¥ ª®¬¯®­¥­²» £° ´ .
22.1-3
«£®°¨²¬ Connected-Components ¯°¨¬¥­¨«¨ ª £° ´³ ± v ¢¥°¸¨­ ¬¨ ¨ e °¥¡° ¬¨, ±®±²®¿¹¥¬³ ¨§ k ±¢¿§­»µ ª®¬¯®­¥­². ª®«¼ª®
¯°¨ ½²®¬ ¡»«® ¢»§®¢®¢ ¯°®¶¥¤³° Find-Set ¨ Union?

¥ «¨§ ¶¨¿ ± ¯®¬®¹¼¾ ±¯¨±ª®¢

443

¨±. 22.2
®¤¯¨±¼:
 ) °¥¤±² ¢«¥­¨¥ ¤¢³µ ¬­®¦¥±²¢ ± ¯®¬®¹¼¾ ±¯¨±ª®¢. °¥¤±² ¢¨²¥«¥¬ ¬­®¦¥±²¢  fb; c; e; hg ¿¢«¿¥²±¿ ½«¥¬¥­² c, ¯°¥¤±² ¢¨²¥«¥¬
fd; f; gg ¿¢«¿¥²±¿ f .  ¦¤»© ®¡º¥ª² ¢ ±¯¨±ª¥ ±®¤¥°¦¨² ½«¥¬¥­²
¬­®¦¥±²¢ , ³ª § ²¥«¼ ­  ±«¥¤³¾¹¨© ½«¥¬¥­² ¨ ³ª § ²¥«¼ ­  ¯°¥¤±² ¢¨²¥«¿ (²® ¥±²¼ ­  ­ · «® ±¯¨±ª ). ¡) ¥§³«¼² ² ¢»¯®«­¥­¨¿
®¯¥° ¶¨¨ Union(e; g ). °¥¤±² ¢¨²¥«¼ ®¡º¥¤¨­¥­¨¿ ¬­®¦¥±²¢ ¥±²¼
f.

22.2. ¥ «¨§ ¶¨¿ ± ¯®¬®¹¼¾ ±¯¨±ª®¢
 ¬»© ¯°®±²®© ¢ °¨ ­² °¥ «¨§ ¶¨¨ ±¨±²¥¬» ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ¬­®¦¥±²¢ µ° ­¨² ª ¦¤®¥ ¬­®¦¥±²¢® ¢ ¢¨¤¥ ±¯¨±ª . °¨ ½²®¬
¯°¥¤±² ¢¨²¥«¥¬ ¬­®¦¥±²¢  ±·¨² ¥²±¿ ¯¥°¢»© ½«¥¬¥­² ±¯¨±ª , ¨
ª ¦¤»© ½«¥¬¥­² ±¯¨±ª  ±®¤¥°¦¨² ±±»«ª¨ ­  ±«¥¤³¾¹¨© ½«¥¬¥­²
±¯¨±ª  ¨ ­  ¯¥°¢»© ½«¥¬¥­² ±¯¨±ª  (ª®²®°»© ±·¨² ¥²±¿ ¯°¥¤±² ¢¨²¥«¥¬ ±¯¨±ª ). «¿ ª ¦¤®£® ±¯¨±ª  ¬» µ° ­¨¬ ³ª § ²¥«¨ ­  ¥£®
¯¥°¢»© ¨ ¯®±«¥¤­¨© ½«¥¬¥­²» (¢²®°®© ¨§ ­¨µ ­³¦¥­ ¯°¨ ¤®¡ ¢«¥­¨¨ ½«¥¬¥­²®¢ ¢ ª®­¥¶ ±¯¨±ª ). ®°¿¤®ª ½«¥¬¥­²®¢ ¢ ±¯¨±ª¥ ¬®¦¥²
¡»²¼ «¾¡»¬.   °¨±. 22.2 (a) ¨§®¡° ¦¥­» ¤¢  ¯°¥¤±² ¢«¥­­»µ ² ª¨¬ ®¡° §®¬ ¬­®¦¥±²¢ .
°¨ ² ª®© °¥ «¨§ ¶¨¨ ®¯¥° ¶¨¨ Make-Set ¨ Find-Set ²°¥¡³¾² ¢°¥¬¥­¨ O(1): Make-Set ±®§¤ ¥² ±¯¨±®ª ¨§ ®¤­®£® ½«¥¬¥­² ,  
Find-Set ¢®§¢° ¹ ¥² ³ª § ²¥«¼ ­  ­ · «® ±¯¨±ª .
°®±²¥©¸ ¿ °¥ «¨§ ¶¨¿ ®¡º¥¤¨­¥­¨¿
°¨ ¥±²¥±²¢¥­­®© °¥ «¨§ ¶¨¨ ®¯¥° ¶¨¿ Union ®ª §»¢ ¥²±¿ ¤®°®£®±²®¿¹¥©. »¯®«­¿¿ Union(x; y ), ¬» ¤®¡ ¢«¿¥¬ ±¯¨±®ª, ±®¤¥°¦ ¹¨© x, ª ª®­¶³ ±¯¨±ª , ±®¤¥°¦ ¹¥£® y (°¨±. 22.2 b). °¥¤±² ¢¨²¥«¥¬ ­®¢®£® ¬­®¦¥±²¢  ¯°¨ ½²®¬ ¡³¤¥² ­ · «® ­®¢®£® ±¯¨±ª , ²®
¥±²¼ ¯°¥¤±² ¢¨²¥«¼ ¬­®¦¥±²¢ , ±®¤¥°¦ ¹¥£® y . °¨ ½²®¬ ­³¦­®
¥¹¥ ³±² ­®¢¨²¼ ¯° ¢¨«¼­»¥ ³ª § ²¥«¨ ­  ­ · «® ±¯¨±ª  ¤«¿ ¢±¥µ
¡»¢¸¨µ ½«¥¬¥­²®¢ ¬­®¦¥±²¢ , ±®¤¥°¦ ¹¥£® x, ¨ ¢°¥¬¿ ­  ¢»¯®«­¥­¨¥ ½²®© ®¯¥° ¶¨¨ «¨­¥©­® § ¢¨±¨² ®² ° §¬¥°  ³ª § ­­®£® ¬­®¦¥±²¢ .
¥£ª® ¯°¨¢¥±²¨ ¯°¨¬¥°, ¢ ª®²®°®¬ ¢°¥¬¿ ¢»¯®«­¥­¨¿ ª¢ ¤° ²¨·­® § ¢¨±¨² ®² ·¨±«  ®¯¥° ¶¨© (°¨±. 22.3). ³±²¼ ¤ ­» n ½«¥¬¥­²®¢ x1 ; x2; : : :; xn . »¯®«­¨¬ ®¯¥° ¶¨¨ Make-Set(xi ) ¤«¿ ¢±¥µ i =
1; 2; : : :; n,   § ²¥¬ n ; 1 ®¯¥° ¶¨© Union(x1; x2), Union(x2; x3), : : : ,
Union(xn;1 ; xn). ®±ª®«¼ª³ ±²®¨¬®±²¼ ®¯¥° ¶¨¨ Union(xi; xi+1)
¯°®¯®°¶¨®­ «¼­  i, ±³¬¬ °­ ¿ ±²®¨¬®±²¼ ¢»¯®«­¥­¨¿ 2n ; 1 ®¯¥-

444

« ¢  22 ¨±²¥¬» ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ¬­®¦¥±²¢

¯¥° ¶¨¿

¨±«® § ²°®­³²»µ ®¡º¥ª²®¢
Make-set(x1 )
1
Make-set(x2 )
1
..
..
.
.
Make-set(xn )
1
Union(x1; x2)
1
Union(x2; x3)
2
Union(x3; x4)
3
..
..
.
.
Union(xn;1 ; xn)
n;1
¨±. 22.2

22.3 °¥¬¿ ¢»¯®«­¥­¨¿ ª¢ ¤° ²¨·­® § ¢¨±¨² ®² ·¨±«  ®¯¥° ¶¨©.

° ¶¨© ¡³¤¥² ¯°®¯®°¶¨®­ «¼­ 

n+

nX
;1
i=1

i = (n2 ):

¥±®¢ ¿ ½¢°¨±²¨ª 
°®±²¥©¸ ¿ °¥ «¨§ ¶¨¿ ®¯¥° ¶¨¨ Union ° ¡®² ¥² ¬¥¤«¥­­® ¨§§  ²®£®, ·²® ¯°¨ ¤®¡ ¢«¥­¨¨ ¤«¨­­®£® ±¯¨±ª  ª ª®°®²ª®¬³ ¯°¨µ®¤¨²±¿ ¯°¨±¢ ¨¢ ²¼ ­®¢»¥ §­ ·¥­¨¿ ¡®«¼¸®¬³ ª®«¨·¥±²¢³ ³ª § ²¥«¥©. ¥«  ¯®©¤³² «³·¸¥, ¥±«¨ ¯®±²³¯¨²¼ ² ª: µ° ­¨²¼ ¢¬¥±²¥
± ª ¦¤»¬ ±¯¨±ª®¬ ¨­´®°¬ ¶¨¾ ® ·¨±«¥ ½«¥¬¥­²®¢ ¢ ­¥¬,   ¯°¨
¢»¯®«­¥­¨¨ ®¯¥° ¶¨¨ Union ¤®¡ ¢«¿²¼ ¡®«¥¥ ª®°®²ª¨© ±¯¨±®ª ¢
ª®­¥¶ ¡®«¥¥ ¤«¨­­®£® (¥±«¨ ¤«¨­» ° ¢­», ¯®°¿¤®ª ¬®¦¥² ¡»²¼ «¾¡»¬).  ª®© ¯°¨¥¬ ­ §»¢ ¥²±¿ ¢¥±®¢®© ½¢°¨±²¨ª®© (weighted-union
heuristic). ±«¨ ®¡º¥¤¨­¿¥¬»¥ ¬­®¦¥±²¢  ±®¤¥°¦ ² ¯°¨¬¥°­® ¯®°®¢­³ ½«¥¬¥­²®¢, ²® ¡®«¼¸®£® ¢»¨£°»¸  ­¥ ¡³¤¥², ­® ¢ ¶¥«®¬, ª ª
¯®ª §»¢ ¥² ±«¥¤³¾¹ ¿ ²¥®°¥¬ , ¬» ¤®¡¨¢ ¥¬±¿ ½ª®­®¬¨¨.
¥®°¥¬  22-1
°¥¤¯®«®¦¨¬, ·²® ±¨±²¥¬  ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ¬­®¦¥±²¢ °¥ «¨§®¢ ­  ± ¯®¬®¹¼¾ ±¯¨±ª®¢,   ¢ ®¯¥° ¶¨¨ Union ¨±¯®«¼§®¢ ­  ¢¥±®¢ ¿ ½¢°¨±²¨ª . ®£¤  ±²®¨¬®±²¼ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¨§ m ®¯¥° ¶¨© Make-Set, Union ¨ Find-Set, ±°¥¤¨ ª®²®°»µ n ®¯¥° ¶¨©
Make-Set, ¥±²¼ O(m+n lg n) (¯®¤° §³¬¥¢ ¥²±¿, ·²® ¯¥°¢®­ · «¼­®
±¨±²¥¬  ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ¬­®¦¥±²¢ ¡»«  ¯³±² ).
®ª § ²¥«¼±²¢®.
²®¨¬®±²¼ ª ¦¤®© ¨§ ®¯¥° ¶¨© Make-Set ¨ Find-Set,   ² ª¦¥
±²®¨¬®±²¼ ±° ¢­¥­¨¿ ° §¬¥°®¢, ±®¥¤¨­¥­¨¿ ±¯¨±ª®¢ ¨ ®¡­®¢«¥­¨¿
§ ¯¨±¨ ® ° §¬¥°¥ ¬­®¦¥±²¢  (¢±¥ ½²¨ ¤¥©±²¢¨¿ ¢»¯®«­¿¾²±¿ ¯°¨
®¯¥° ¶¨¨ Union), ¥±²¼ O(1), ² ª ·²® ±³¬¬ °­ ¿ ±²®¨¬®±²¼ ³ª § ­­»µ ¤¥©±²¢¨© ¥±²¼ O(m).
±² ¥²±¿ ®¶¥­¨²¼ ±²®¨¬®±²¼ ®¡­®¢«¥­¨¿ ³ª § ²¥«¥© ­  ­ · «®
±¯¨±ª . «¿ ½²®£® ¬» § ´¨ª±¨°³¥¬ ®¤¨­ ¨§ ½«¥¬¥­²®¢ (®¡®§­ ·¨¬

¥ «¨§ ¶¨¿ ± ¯®¬®¹¼¾ ±¯¨±ª®¢

445

¥£® x) ¨ ¯°®±«¥¤¨¬, ±ª®«¼ª® ° § ³ ­¥£® ½²®² ³ª § ²¥«¼ ¬¥­¿«±¿.
¥±®¢ ¿ ½¢°¨±²¨ª  £ ° ­²¨°³¥², ·²® ¯°¥¤±² ¢¨²¥«¼ ¬¥­¿¥²±¿,
«¨¸¼ ¥±«¨ x ¢µ®¤¨² ¢ ¬¥­¼¸¥¥ ¨§ ®¡º¥¤¨­¿¥¬»µ ¬­®¦¥±²¢.  ½²®¬
±«³· ¥ ·¨±«® ½«¥¬¥­²®¢ ¢ ¬­®¦¥±²¢¥, ±®¤¥°¦ ¹¥¬ x, ¢®§° ±² ¥² ¯®
ª° ©­¥© ¬¥°¥ ¢¤¢®¥. ®±ª®«¼ª³ ®ª®­· ²¥«¼­»© ° §¬¥° ¬­®¦¥±²¢ ,
±®¤¥°¦ ¹¥£® x, ­¥ ¯°¥¢®±µ®¤¨² n, ª®«¨·¥±²¢® ² ª¨µ ³¤¢®¥­¨© ­¥
¯°¥¢®±µ®¤¨² dlg ne. ¡¹¥¥ ª®«¨·¥±²¢® ½«¥¬¥­²®¢ ° ¢­® n, ² ª ·²®
±³¬¬ °­ ¿ ±²®¨¬®±²¼ ®¡­®¢«¥­¨¿ ³ª § ²¥«¥© ­  ­ · «® ±¯¨±ª  ¥±²¼
O(n lg n),   ®¡¹¥¥ ·¨±«® ®¯¥° ¶¨© ¥±²¼ O(m) + O(n lg n).
¯° ¦­¥­¨¿
22.2-1
 ¯¨¸¨²¥ ¯°®¶¥¤³°» Make-Set, Find-Set ¨ Union, ¨±¯®«¼§³¿
°¥ «¨§ ¶¨¾ ± ¯®¬®¹¼¾ ±¯¨±ª®¢ ¨ ¢¥±®¢³¾ ½¢°¨±²¨ª³. ·¨² ©²¥,
·²® ª ¦¤»© ½«¥¬¥­² x ¨¬¥¥² ¯®«¿ rep[x] (³ª § ²¥«¼ ­  ¯°¥¤±² ¢¨²¥«¿),   ² ª¦¥ last[x] (³ª § ²¥«¼ ­  ¯®±«¥¤­¨© ½«¥¬¥­² ±¯¨±ª )
¨ size[x] (·¨±«® ½«¥¬¥­²®¢); ¤¢  ¯®±«¥¤­¨µ ¯®«¿ ¢ ¦­» ²®«¼ª® ¤«¿
½«¥¬¥­² , ¿¢«¿¾¹¥£®±¿ ¯°¥¤±² ¢¨²¥«¥¬ ¬­®¦¥±²¢ .
22.2-2
§®¡° §¨²¥ ±¯¨±ª¨, ¯®«³· ¾¹¨¥±¿ ¢ °¥§³«¼² ²¥ ° ¡®²» ¯°¨¢¥¤¥­­®© ­¨¦¥ ¯°®£° ¬¬», ¨ ®¡º¿±­¨²¥, ª ª®© ®²¢¥² ¤ ¤³² ¢»§®¢» Find-Set (¥±«¨ ¨±¯®«¼§³¥²±¿ ¯°¥¤±² ¢«¥­¨¥ ¢ ¢¨¤¥ ±¯¨±ª®¢ ¨
¢¥±®¢ ¿ ½¢°¨±²¨ª ).
1
2
3
4
5
6
7
8
9
10
11

for i \gets 1 to 16
do Make-Set(x_i)
for i \gets 1 to 15 by 2
do Union(x_i, x_{i+1})
for i \gets 1 to 13 by 4
do Union(x_i, x_{i+2})
Union(x_1, x_5)
Union(x_{11}, x_{13})
Union(x_1, x_{10})
Find-Set(x_2)
Find-Set(x_9)

22.2-3
®ª ¦¨²¥, ·²® ¯°¨ °¥ «¨§ ¶¨¨ ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ¬­®¦¥±²¢ ±
¯®¬®¹¼¾ ±¯¨±ª®¢ ± ¢¥±®¢®© ½¢°¨±²¨ª®© ³·¥²­³¾ ±²®¨¬®±²¼ ®¯¥° ¶¨© Make-Set ¨ Find-Set ¬®¦­® ±·¨² ²¼ ° ¢­®© O(1),   ³·¥²­³¾
±²®¨¬®±²¼ Union ¬®¦­® ±·¨² ²¼ ° ¢­®© O(lg n).
22.2-4
ª ¦¨²¥ ²®·­³¾  ±¨¬¯²®²¨·¥±ª³¾ ®¶¥­ª³ ±²®¨¬®±²¨ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ®¯¥° ¶¨© °¨±. 22.3 (¥±«¨ ¨±¯®«¼§³¾²±¿ ±¯¨±ª¨ ¨ ¢¥±®¢ ¿
½¢°¨±²¨ª ).
22.3 ¥± ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ¬­®¦¥±²¢
«¿ ±¨±²¥¬» ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ¬­®¦¥±²¢ ±³¹¥±²¢³¥² ¡®«¥¥ ½´´¥ª²¨¢­ ¿ °¥ «¨§ ¶¨¿ (¯® ±° ¢­¥­¨¾ ± ° ±±¬®²°¥­­»¬¨). ¬¥­­®,

446

« ¢  22 ¨±²¥¬» ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ¬­®¦¥±²¢

¨±. 22.4
¨±. 22.3 ¨±. 22.4. ¥± ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ¬­®¦¥±²¢.  ) ¥°¥¢¼¿, ¯°¥¤±² ¢«¿¾¹¨¥ ¬­®¦¥±²¢  °¨±. 22.2. °¥¤±² ¢¨²¥«¿¬¨ ¬­®¦¥±²¢ ¿¢«¿¾²±¿ ½«¥¬¥­²» c ¨
f . ¡) ¥§³«¼² ² ®¯¥° ¶¨¨ Union(e; g).

¯°¥¤±² ¢¨¬ ª ¦¤®¥ ¬­®¦¥±²¢® ª®°­¥¢»¬ ¤¥°¥¢®¬, ¢ ª®²®°®¬ ¢¥°¸¨­ ¬¨ ¿¢«¿¾²±¿ ½«¥¬¥­²» ¬­®¦¥±²¢ ,   ª®°¥­¼ ¿¢«¿¥²±¿ ¯°¥¤±² ¢¨²¥«¥¬. ®«³· ¥²±¿ «¥± ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ¬­®¦¥±²¢ (disjoint-set
forest).  ª ¢¨¤­® ¨§ °¨±³­ª  (±¬. °¨±. 22.4 (a)), ª ¦¤ ¿ ¢¥°¸¨­  ³ª §»¢ ¥² ­  ±¢®¥£® °®¤¨²¥«¿,   ª®°¥­¼ ³ª §»¢ ¥² ± ¬ ­  ±¥¡¿. °¨ ­ ¨¢­®¬ ¯°®£° ¬¬¨°®¢ ­¨¨ ®¯¥° ¶¨© Find-Set ¨ Union
² ª ¿ °¥ «¨§ ¶¨¿ ¡³¤¥² ­¨·³²¼ ­¥ «³·¸¥ ±¯¨±®·­®©; ¥±«¨, ®¤­ ª®
¨±¯®«¼§®¢ ²¼ ½¢°¨±²¨ª¨ À®¡º¥¤¨­¥­¨¿ ¯® ° ­£³Á ¨ À±¦ ²¨¿ ¯³²¥©Á,
²® ¯®«³·¨²±¿ ± ¬ ¿ ¡»±²° ¿ (¨§ ¨§¢¥±²­»µ ¢ ­ ±²®¿¹¥¥ ¢°¥¬¿) °¥ «¨§ ¶¨¿ ±¨±²¥¬» ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ¬­®¦¥±²¢.
 ¨¢­»¥ °¥ «¨§ ¶¨¨ ®¯¥° ¶¨© ¢»£«¿¤¿² ² ª: Make-Set ±®§¤ ¥² ¤¥°¥¢® ± ¥¤¨­±²¢¥­­®© ¢¥°¸¨­®©, Find-Set(x) ±®±²®¨² ¢ ²®¬,
·²® ¬» ¨¤¥¬ ®² x ¯® ±²°¥«ª ¬ (³ª §»¢ ¾¹¨¬ ­  °®¤¨²¥«¿), ¯®ª 
­¥ ¤®©¤¥¬ ¤® ª®°­¿ (¯³²¼, ª®²®°»© ¬» ¯°¨ ½²®¬ ¯°®µ®¤¨¬, ­ §»¢ ¥²±¿ ¯³²¼ ¯®¨±ª , ¯®- ­£«¨©±ª¨ nd path),   Union ±®±²®¨² ¢
²®¬, ·²® ¬» § ±² ¢«¿¥¬ ª®°¥­¼ ®¤­®£® ¨§ ¤¥°¥¢¼¥¢ ³ª §»¢ ²¼ ­¥
­  ± ¬®£® ±¥¡¿,   ­  ª®°¥­¼ ¤°³£®£® ¤¥°¥¢  (°¨±. 22.4¡).
¢¥ ½¢°¨±²¨ª¨
®ª  ·²® ¡®«¼¸¨µ ¯°¥¨¬³¹¥±²¢ (¯® ±° ¢­¥­¨¾ ±® ±¯¨±®·­®© °¥ «¨§ ¶¨¥©) ­¥ ¢¨¤­®: ­ ¯°¨¬¥°, ¢ °¥§³«¼² ²¥ n ; 1 ®¯¥° ¶¨¨ Union
¬®¦¥² ¯®«³·¨²¼±¿ ¤¥°¥¢®, ¿¢«¿¾¹¥¥±¿ ¶¥¯®·ª®© n ¢¥°¸¨­. ¯¨¸¥¬
¤¢¥ ½¢°¨±²¨ª¨, ¯®§¢®«¿¾¹¨µ ¤®¡¨²¼±¿ ¯®·²¨ «¨­¥©­®© ®¶¥­ª¨ ¢°¥¬¥­¨.
¥°¢ ¿ ½¢°¨±²¨ª , ­ §»¢ ¥¬ ¿ ®¡º¥¤¨­¥­¨¥¬ ¯® ° ­£³ (union by
rank), ­ ¯®¬¨­ ¥² ¢¥±®¢³¾ ½¢°¨±²¨ª³ ¢ ±¯¨±®·­®© °¥ «¨§ ¶¨¨: ¬»
®¡º¥¤¨­¿¥¬ ¤¥°¥¢¼¿ ­¥ ª ª ¯®¯ «®,   ² ª, ·²®¡» ª®°¥­¼ À¬¥­¼¸¥£®Á
¤¥°¥¢  ³ª §»¢ « ­  ª®°¥­¼ À¡®«¼¸¥£®Á. »¡®° À¡®«¼¸¥£®Á ®¯°¥¤¥«¿¥²±¿ ­¥ ° §¬¥°®¬ ¤¥°¥¢ ,   ±¯¥¶¨ «¼­»¬ ¯ ° ¬¥²°®¬ {° ­£®¬
(rank) ¥£® ª®°­¿.  ­£ ®¯°¥¤¥«¥­ ¤«¿ ª ¦¤®© ¢¥°¸¨­» x ¤¥°¥¢  ¨
¢ ¯¥°¢®¬ ¯°¨¡«¨¦¥­¨¨ ¬®¦¥² ° ±±¬ ²°¨¢ ²¼±¿ ª ª £°³¡ ¿ ®¶¥­ª 
«®£ °¨´¬  ·¨±«  ¢¥°¸¨­ ¢ ¯®¤¤¥°¥¢¥ ± ª®°­¥¬ ¢ x. ®·­®¥ ®¯°¥¤¥«¥­¨¥ ° ­£  ¡³¤¥² ¤ ­® ¢ ±«¥¤³¾¹¥¬ ° §¤¥«¥.
²®° ¿ ½¢°¨±²¨ª , ¯°¨¬¥­¿¥¬ ¿ ¢ ®¯¥° ¶¨¨ Find-Set, ­ §»¢ ¥²±¿ ±¦ ²¨¥¬ ¯³²¥© (path compression). ­  § ª«¾· ¥²±¿ ¢ ±«¥¤³¾¹¥¬: ¯®±«¥ ²®£®, ª ª ¯³²¼ ¯®¨±ª  ®² ¢¥°¸¨­» ª ª®°­¾ ¯°®©¤¥­,
¤¥°¥¢® ¯¥°¥±²° ¨¢ ¥²±¿: ¢ ª ¦¤®© ¨§ ¢¥°¸¨­ ¯³²¨ ³ª § ²¥«¼ ³±² ­ ¢«¨¢ ¥²±¿ ­¥¯®±°¥¤±²¢¥­­® ­  ª®°¥­¼ (°¨±. 22.5). °¨ ½²®¬ ° ­£¨
®±² ¾²±¿ ¯°¥¦­¨¬¨.

¥ «¨§ ¶¨¿ ± ¯®¬®¹¼¾ ±¯¨±ª®¢

447

¨±. 22.5
¦ ²¨¥ ¯³²¥© ¢ ¯°®¶¥±±¥ ®¯¥° ¶¨¨ Find-Set.  ) ¥°¥¢® ¯¥°¥¤ ¢»¯®«­¥­¨¥¬ ®¯¥° ¶¨¨ Find-Set(a). °¥³£®«¼­¨ª ¬¨ ®¡®§­ ·¥­» ¯®¤¤¥°¥¢¼¿ ±
ª®°­¿¬¨ ¢ ¨§®¡° ¦¥­­»µ ¢¥°¸¨­ µ. ¡) ®±«¥ ¨±¯®«­¥­¨¿ Find-Set(a).
¨±. 22.4

22.2.1. °®£° ¬¬»
°¨¢®¤¨¬»¥ ­¨¦¥ ¯°®£° ¬¬» ®¯¥° ¶¨© Make-Set, Find-Set ¨
Union ¢ª«¾· ¾² ¢ ±¥¡¿ ¨­¤³ª²¨¢­®¥ ®¯°¥¤¥«¥­¨¥ ° ­£ , ­® ¤«¿

³¤®¡±²¢  ¬» ¯¥°¥±ª ¦¥¬ ¥£® ±«®¢¥±­®. °¨ ±®§¤ ­¨¨ ¬­®¦¥±²¢  ±
¯®¬®¹¼¾ Make-Set ¥¤¨­±²¢¥­­®© ¢¥°¸¨­¥ ¤¥°¥¢  ¯°¨±¢ ¨¢ ¥²±¿
° ­£ 0. ¯¥° ¶¨¿ Find-Set (±® ±¦ ²¨¥¬ ¯³²¥©) ­¥ ¬¥­¿¥² ° ­£®¢.
°¨ ¢»¯®«­¥­¨¨ ®¯¥° ¶¨¨ Union ± ¤¥°¥¢¼¿¬¨, ° ­£¨ ª®°­¥© ª®²®°»µ ° §«¨·­», ¯°®¢®¤¨²±¿ ­®¢ ¿ ±²°¥«ª  ®² ª®°­¿ ¬¥­¼¸¥£® ° ­£ 
ª ª®°­¾ ¡®«¼¸¥£® ° ­£ ,   ° ­£¨ ®¯¿²¼-² ª¨ ­¥ ¬¥­¿¾²±¿. ±«¨, ­ ª®­¥¶, ®¯¥° ¶¨¿ Union ¯°®¢®¤¨²±¿ ± ¤¥°¥¢¼¿¬¨, ° ­£¨ ª®°­¥© ª®²®°»µ ° ¢­», ²® ®² ®¤­®£® ¨§ ª®°­¥© (¢±¥ ° ¢­®, ª ª®£®) ¯°®¢®¤¨²±¿ ±²°¥«ª  ª ¤°³£®¬³, ¨ ¯°¨ ½²®¬ ° ­£ ª®°­¿ ®¡º¥¤¨­¥­­®£® ¤¥°¥¢ 
³¢¥«¨·¨¢ ¥²±¿ ­  ¥¤¨­¨¶³ (®±² «¼­»¥ ° ­£¨ ­¥ ¬¥­¿¾²±¿). ¥£ª®
¢¨¤¥²¼, ·²® ®¯°¥¤¥«¥­­»© ² ª¨¬ ®¡° §®¬ ° ­£ ¢¥°¸¨­» ¿¢«¿¥²±¿
¢¥°µ­¥© ®¶¥­ª®© ¤«¿ ¢»±®²» ¯®¤¤¥°¥¢  ± ª®°­¥¬ ¢ ½²®© ¢¥°¸¨­¥.
¨¦¥ p[x] ®¡®§­ · ¥² °®¤¨²¥«¿ ¢¥°¸¨­» x,   rank[x] | ¥¥ ° ­£;
¯ ° ¬¥²° ¬¨ ¯°®¶¥¤³°» Link, ¢»§»¢ ¥¬®© ¨§ ¯°®¶¥¤³°» Union,
¿¢«¿¾²±¿ ª®°­¨ ¤¢³µ ¤¥°¥¢¼¥¢.
Make-Set(x)
1 p[x] \gets x
2 rank[x] \gets 0
Union(x,y)
1 Link(Find-Set(x),Find-Set(y))
Link(x,y)
1 if rank[x] > rank[y]
2
then p[y] \gets x
3
else p[x] \gets y
4
if rank[x]=rank[y]
5
then rank[y] \gets rank[y]+1
Find-Set(x)
1 if x \ne p[x]
2
then p[x] \gets Find-Set(p[x])
3 return p[x]

¥ª³°±¨¢­ ¿ ¯°®¶¥¤³°  Find-Set ° ¡®² ¥² ¢ ¤¢  ¯°®µ®¤ : ±­ · «  ®­  ¨¤¥² ª ª®°­¾ ¤¥°¥¢ ,   § ²¥¬ ¯°®µ®¤¨² ½²®² ¯³²¼ ¢ ®¡° ²­®¬
¯®°¿¤ª¥, À¯¥°¥¢®¤¿ ±²°¥«ª¨Á ³ ¢±²°¥· ¾¹¨µ±¿ ¢¥°¸¨­ ­  ª®°¥­¼

448

« ¢  22 ¨±²¥¬» ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ¬­®¦¥±²¢

¤¥°¥¢ . ±«¨ x | ­¥ ª®°¥­¼, ²® Find-Set ¢»§»¢ ¥² ± ¬³ ±¥¡¿, ­®
³¦¥ ± ¯ ° ¬¥²°®¬ | °®¤¨²¥«¥¬ x, ¯®±«¥ ·¥£® ¤¥« ¥² °®¤¨²¥«¥¬ x
ª®°¥­¼ ¤¥°¥¢ , ­ ©¤¥­­»© ½²¨¬ ­®¢»¬ ¢»§®¢®¬ Find-Set (±²°®ª  2). ±«¨ ¦¥ x | ª®°¥­¼, ²® ±²°®ª  2 ­¥ ¨±¯®«­¿¥²±¿, ¨ ±° §³
¢®§¢° ¹ ¥²±¿ ³ª § ²¥«¼ ­  x.
²® ¤ ¾² ½¢°¨±²¨ª¨
 ¦¥ ¡³¤³·¨ ¯°¨¬¥­¥­­»¬¨ ¯® ®²¤¥«¼­®±²¨, ®¡º¥¤¨­¥­¨¥ ¯®
° ­£³ ¨ ±¦ ²¨¥ ¯³²¥© ¤ ¾² ¢»¨£°»¸ ¢® ¢°¥¬¥­¨. ±«¨ ¯°¨¬¥­¨²¼
®¡º¥¤¨­¥­¨¥ ¯® ° ­£³ ¡¥§ ±¦ ²¨¿ ¯³²¥©, ²® ®¶¥­ª  ¢°¥¬¥­¨ ° ¡®²»
¡³¤¥² ¯°¨¬¥°­® ² ª®© ¦¥, ª ª ¯°¨ ±¯¨±®·­®© °¥ «¨§ ¶¨¨ ± ¢¥±®¢®©
½¢°¨±²¨ª®©,   ¨¬¥­­® O(m lg n) (m | ®¡¹¥¥ ª®«¨·¥±²¢® ®¯¥° ¶¨©,
n {ª®«¨·¥±²¢® ®¯¥° ¶¨© Make-Set (³¯°. 22.4-3). ²  ®¶¥­ª  ­¥³«³·¸ ¥¬  (³¯°. 22.3-3). ±«¨ ¯°¨¬¥­¨²¼ ±¦ ²¨¥ ¯³²¥© ¡¥§ ®¡º¥¤¨­¥­¨¿ ¯® ° ­£³, ²® ¢°¥¬¿ ¨±¯®«­¥­¨¿ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ®¯¥° ¶¨©, ¢ª«¾· ¾¹¥© n ®¯¥° ¶¨© Make-Set ¨ f ®¯¥° ¶¨© Find-Set,
¥±²¼ (¢ µ³¤¸¥¬ ±«³· ¥) (f log1+f=n n) ¯°¨ f > n ¨ (n + f lg n) ¯°¨
f < n (½²¨ ®¶¥­ª¨ ¬» ¤®ª §»¢ ²¼ ­¥ ¡³¤¥¬).
¹¥ ¡®«¼¸ ¿ ½ª®­®¬¨¿ ¯®«³·¨²±¿, ¥±«¨ ¯°¨¬¥­¨²¼ ®¡¥ ½¢°¨±²¨ª¨ ±®¢¬¥±²­®. °¨ ½²®¬ ¢°¥¬¿ ° ¡®²» ¢ µ³¤¸¥¬ ±«³· ¥ ¥±²¼
O(m(m; n)), £¤¥  | ·°¥§¢»· ©­® ¬¥¤«¥­­® ° ±²³¹ ¿ À®¡° ²­ ¿
´³­ª¶¨¿ ªª¥°¬ ­ Á, ®¯°¥¤¥«¿¥¬ ¿ ­¨¦¥ ¢ ° §¤¥«¥ 22.4.  «¾¡»µ
¬»±«¨¬»µ ¯°¨«®¦¥­¨¿µ ¢»¯®«­¥­® ­¥° ¢¥­±²¢® (m; n) 6 4, ² ª
·²® ­  ¯° ª²¨ª¥ ¬®¦­® ±·¨² ²¼ ¢°¥¬¿ ° ¡®²» «¨­¥©­»¬ ¯® m. 
° §¤. 22.4 ¬» ¤®ª ¦¥¬ ·³²¼ ¡®«¥¥ ±« ¡³¾ ®¶¥­ª³ O(m lg n).
¯° ¦­¥­¨¿
22.3-1
¤¥« ©²¥ ³¯° ¦­¥­¨¥ 22.2-2, ¯®«¼§³¿±¼ °¥ «¨§ ¶¨¥© ± ¯®¬®¹¼¾
«¥±  ±® ±¦ ²¨¥¬ ¯³²¥© ¨ ®¡º¥¤¨­¥­¨¥¬ ¯® ° ­£ ¬.
22.3-2
 ¯¨¸¨²¥ ­¥°¥ª³°±¨¢­»© ¢ °¨ ­² ¯°®¶¥¤³°» Find-Set.
22.3-3
°¨¢¥¤¨²¥ ¯°¨¬¥° ¯®±«¥¤®¢ ²¥«¼­®±²¨ m ®¯¥° ¶¨© Make-Set,
Union ¨ Find-Set (¢ ²®¬ ·¨±«¥ n ®¯¥° ¶¨© Make-Set, ¤«¿ ª®²®°®© ¢°¥¬¿ ° ¡®²» (¯°¨ ¨±¯®«¼§®¢ ­¨¨ ®¡º¥¤¨­¥­¨¿ ¯® ° ­£³ ¡¥§
±¦ ²¨¿ ¯³²¥©) ¡³¤¥² 
(m lg n).
22.3-4*
 ±±¬®²°¨¬ ¯®±«¥¤®¢ ²¥«¼­®±²¼ m ®¯¥° ¶¨© Make-Set, Link ¨
Find-Set, ¢ ª®²®°®© ¢±¥ ®¯¥° ¶¨¨ Find-Set ¨¤³² ¯®±«¥ ¢±¥µ ®¯¥° ¶¨© Link. ®ª ¦¨²¥, ·²® ¯°¨ ¨±¯®«¼§®¢ ­¨¨ ®¡º¥¤¨­¥­¨¿ ¯® ° ­£ ¬ ±® ±¦ ²¨¥¬ ¯³²¥© ¢°¥¬¿ ° ¡®²» ½²®© ¯®±«¥¤®¢ ²¥«¼­®±²¨ ®¯¥° ¶¨© ¥±²¼ O(m). ²® ¡³¤¥², ¥±«¨ ¯®«¼§®¢ ²¼±¿ ²®«¼ª® ±¦ ²¨¥¬
¯³²¥©?
22.4* ¡º¥¤¨­¥­¨¥ ¯® ° ­£ ¬ ±® ±¦ ²¨¥¬ ¯³²¥©:  ­ «¨§
 ½²®¬ ° §¤¥«¥ ¬» ¤ ¤¨¬ ®¯°¥¤¥«¥­¨¥ À®¡° ²­®© ´³­ª¶¨¨ ªª¥°¬ ­ Á (m; n), ¢µ®¤¿¹¥© ¢ ®¶¥­ª³ O(m(m; n)) ¤«¿ ±²®¨¬®±²¨
m ®¯¥° ¶¨© ± ±¨±²¥¬®© ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ¬­®¦¥±²¢, °¥ «¨§®¢ ­-

¥ «¨§ ¶¨¿ ± ¯®¬®¹¼¾ ±¯¨±ª®¢
¨±. 22.5

449

22.6. ­ ·¥­¨¿ A(i; j ) ¤«¿ ¬ «»µ i ¨ j .

¥°¥¢®¤»: row | ±²°®ª , column | ±²®«¡¥¶
¨±. 22.7. ®±² ´³­ª¶¨¨ ªª¥°¬ ­ .  ² ¡«¨¶¥ §­ ·¥­¨© (°¨±. 22.6)
±®¥¤¨­¥­» ° ¢­»¥ ·¨±« .  ±¸² ¡ ¯® £®°¨§®­² «¨ ±®¡«¾±²¨ ­¥¢®§¬®¦­® (¨§-§ 
®·¥­¼ ¡»±²°®£® °®±² ).
¨±. 22.6

­®© ± ¯®¬®¹¼¾ «¥±  ± ®¡º¥¤¨­¥­¨¥¬ ¯® ° ­£ ¬ ¨ ±¦ ²¨¥¬ ¯³²¥©
(§¤¥±¼ n | ·¨±«® ®¯¥° ¶¨© Make-Set). ²³ ®¶¥­ª³ ¬» ¤®ª §»¢ ²¼
­¥ ¡³¤¥¬, ®£° ­¨·¨¢¸¨±¼ ¡®«¥¥ ±« ¡®© ®¶¥­ª®© O(m lg n).
³­ª¶¨¿ ªª¥°¬ ­  ¨ ®¡° ²­ ¿ ª ­¥©
³­ª¶¨¥© ªª¥°¬ ­  (Ackermann's function) ­ §»¢ ¥²±¿ ´³­ª¶¨¿ A(i; j ) ¤¢³µ ¶¥«»µ ¯®«®¦¨²¥«¼­»µ ¯¥°¥¬¥­­»µ, ®¯°¥¤¥«¥­­ ¿
² ª:

A(1; j ) = 2j ;
¥±«¨ j > 1;
A(i; 1) = A(i ; 1; 2)
¥±«¨ i > 2;
A(i; j ) = A(i ; 1; A(i; j ; 1))
¥±«¨ i; j > 2.
­ ·¥­¨¿ A(i; j ) ¤«¿ ¬ «»µ i ¨ j ¨§®¡° ¦¥­» ­  °¨±. 22.6.

 ² ¡«¨¶¥ §­ ·¥­¨© ´³­ª¶¨¨ ªª¥°¬ ­  ª ¦¤ ¿ ±«¥¤³¾¹ ¿
±²°®ª  ¥±²¼ ¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¼ ¯°¥¤»¤³¹¥© (­ ·¨­ ¾¹ ¿±¿
±® ¢²®°®£® ·«¥­ ); ®²±¾¤  ±«¥¤³¥², ·²® A(i; j ) ³¢¥«¨·¨¢ ¥²±¿ ¯°¨
³¢¥«¨·¥- ­¨¨ i ¨«¨ j . ²  ´³­ª¶¨¿ ° ±²¥² ®·¥­¼ ¡»±²°®: ³¦¥ ¯¥°¢ ¿ ±²°®ª  ¢ ² ¡«¨¶¥ ¥¥ §­ ·¥­¨© ° ±²¥² ½ª±¯®­¥­¶¨ «¼­®,   ª ¦¤ ¿ ¯®±«¥¤³¾¹ ¿ ±²°®ª  ¥±²¼ (¢¥±¼¬  °¥¤ª ¿) ¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¼ ¯°¥¤»¤³¹¥©. ¬¥­­®, ¢ k + 1-®© ±²°®ª¥ ² ¡«¨¶» § ¯¨± ­ 
¯®±«¥¤®- ¢ ²¥«¼­®±²¼, ª ¦¤»© ±«¥¤³¾¹¨© ·«¥­ ª®²®°®© ¯®«³· ¥²±¿
¨§ ¯°¥¤»- ¤³¹¥£® ¯°¨¬¥­¥­¨¥¬ ´³­ª¶¨¨, § ¯¨± ­­®© ¢ k-®© ±²°®ª¥.  · ±²­®±²¨, ¢® ¢²®°®© ±²°®ª¥ ª ¦¤»© ±«¥¤³¾¹¨© ·«¥­ ¥±²¼
¤¢®©ª , ¢®§¢¥¤¥­­ ¿ ¢ ±²¥¯¥­¼ ¯°¥¤»¤³¹¥£® ·«¥­ .
§ ¨¬®®²­®¸¥­¨¿ ¬¥¦¤³ ° §«¨·­»¬¨ ±²°®ª ¬¨ ² ¡«¨¶» §­ ·¥­¨© ´³­ª¶¨¨ ªª¥°¬ ­  ±µ¥¬ ²¨·¥±ª¨ ¨§®¡° ¦¥­» ­  °¨±. 22.7.
¯°¥¤¥«¨¬, ­ ª®­¥¶, ®¡° ²­³¾ ´³­ª¶¨¾ ªª¥°¬ ­  (m; n).
²°®£® £®¢®°¿,  ­¥ ¿¢«¿¥²±¿ ®¡° ²­®© ª ´³­ª¶¨¨ ªª¥°¬ ­  A
(²¥¬ ¡®«¥¥ ·²® ¯®±«¥¤­¿¿ ¨¬¥¥² ¤¢   °£³¬¥­² ), ­® ¬®¦­® ±ª § ²¼,
·²® ´³­ª¶¨¿  ° ±²¥² ±²®«¼ ¦¥ ¬¥¤«¥­­®, ±ª®«¼ ¡»±²°® ° ±²¥²
A. (¥² «¨ ®¯°¥¤¥«¥­¨¿  ±³¹¥±²¢¥­­» ¤«¿ ¤®ª § ²¥«¼±²¢  ®¶¥­ª¨
O(m(m; n)), ª®²®°®¥ ¢»µ®¤¨² §  ° ¬ª¨ ­ ¸¥© ª­¨£¨.) ² ª, ¯°¨
m > n > 1 ¯®« £ ¥¬:

(m; n) = min f i > 1 : A(i; bm=nc) > lg n g :
¥£ª® ¢¨¤¥²¼, ·²® ¯°¨ ´¨ª±¨°®¢ ­­®¬ n ´³­ª¶¨¿ (m; n) ¬®­®²®­­® ³¡»¢ ¥² ± °®±²®¬ m. ²® ±®£« ±³¥²±¿ ± (­¥ ¤®ª §»¢ ¥¬»¬

450

« ¢  22 ¨±²¥¬» ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ¬­®¦¥±²¢

­ ¬¨) ³²¢¥°¦¤¥­¨¥¬ ® ²®¬, ·²® ±²®¨¬®±²¼ m ®¯¥° ¶¨© ± ­¥¯¥°¥±¥ª ¾¹¨¬¨±¿ ¬­®¦¥±²¢ ¬¨, ¢ª«¾· ¾¹¨µ n ®¯¥° ¶¨© Make-Set,
¥±²¼ (m(m; n)).  ± ¬®¬ ¤¥«¥, ½²  ®¶¥­ª  £®¢®°¨², ·²® ±²®¨¬®±²¼
¢ ° ±·¥²¥ ­  ®¤­³ ®¯¥° ¶¨¾ ¥±²¼ (m; n). ±«¨ n ´¨ª±¨°®¢ ­®,   m
° ±²¥², ²® ¨§-§  ±¦ ²¨¿ ¯³²¥© ¤¥°¥¢¼¿ ± ª ¦¤»¬ ¸ £®¬ ¢±¥ ¡®«¥¥
À³¯°®¹ ¾²±¿Á (¢±¥ ¡®«¼¸¥ ±² ­®¢¨²±¿ ¢¥°¸¨­, ­ ¯°¿¬³¾ ±¢¿§ ­­»µ ± ª®°­¥¬), ² ª ·²® ±²®¨¬®±²¼ ®¯¥° ¶¨¨ ¯ ¤ ¥².
® ¢±¥µ ¯° ª²¨·¥±ª¨µ ¯°¨«®¦¥­¨¿µ ¬®¦­® ±·¨² ²¼, ·²®
(m; n) 6 4.  ± ¬®¬ ¤¥«¥, ¯®±ª®«¼ª³ ´³­ª¶¨¿ ªª¥°¬ ­  ¿¢«¿¥²±¿
¢®§° ±² ¾¹¥© ¯® ª ¦¤®¬³ ¯¥°¥¬¥­­®¬³ ¨ m > n, ¨¬¥¥¬

A(4; bm=nc) > A(4; 1) = A(3; 2) = 2

2)

:
2::

17;

·²® ¬­®£® ¡®«¼¸¥ ·¨±«   ²®¬®¢ ¢ ­ ¡«¾¤ ¥¬®© · ±²¨ ±¥«¥­­®©
( 1080). ®½²®¬³ ¤«¿ ¢±¥µ ¢±²°¥· ¾¹¨µ±¿ ­  ¯° ª²¨ª¥ §­ ·¥­¨©
n ¨¬¥¥¬ A(4; bm=nc) > lg n ¨ (m; n) 6 4.
» ­¥ ¤®ª §»¢ ¥¬ ®¶¥­ª¨, ±¢¿§ ­­®© ± ´³­ª¶¨¥© ªª¥°¬ ­ ,  
®£° ­¨·¨¢ ¥¬±¿ ¡®«¥¥ ±« ¡®© ®¶¥­ª®© O(m lg n). ±¯®¬­¨¬ ®¯°¥¤¥«¥­¨¥ ´³­ª¶¨¨ lg (±. ??). ® ®¯°¥¤¥«¥­¨¾, lg 1 = 0 ¨

	
lg n = min i : lg
lg
:
:
:
lg
n
6
1
| {z }
i ° §

¤«¿ n > 1. ¥° ¢¥­±²¢®
¢ ®¯°¥¤¥«¥­¨¨ ´³­ª¶¨¨ lg ¬®¦­® ¯¥°¥¯¨)
2
::
± ²¼ ² ª: n 6 22: j (j | ·¨±«® ¤¢®¥ª ¢ ´®°¬³«¥).
¶¥­ª  O(m lg n), ª®²®°³¾ ¬» ¤®ª ¦¥¬ ­¨¦¥, ±« ¡¥¥, ·¥¬ ±´®°¬³«¨°®¢ ­­ ¿ ¡¥§ ¤®ª § ²¥«¼±²¢  ®¶¥­ª  O(m(m; n)), ­® ± ¯° ª²¨·¥±ª®© ²®·ª¨ §°¥­¨¿ ° §­¨¶  ­¥¢¥«¨ª .  ± ¬®¬ ¤¥«¥, lg 22 =
lg 265536 = 5, ² ª ·²® ¢® ¢±¥µ ¯° ª²¨·¥±ª¨µ ¢®¯°®± µ ¬®¦­® ±·¨² ²¼, ·²® lg n 6 5 | ¢°¿¤ «¨ ­ ¬ ¢±²°¥²¨²±¿ ¬­®¦¥±²¢®, ¢ ª®²®°®¬ ¡®«¥¥ 265536 ½«¥¬¥­²®¢.
¢®©±²¢  ° ­£®¢
²®¡» ¤®ª § ²¼ ®¶¥­ª³ O(m lg n) ¤«¿ ¢°¥¬¥­¨ ° ¡®²» ± ±¨±²¥¬®© ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ¬­®¦¥±²¢, ­ ¬ ¯®­ ¤®¡¿²±¿ ­¥ª®²®°»¥
±¢®©±²¢  ° ­£®¢.  ¯®¬­¨¬, ·²® ¬» ° ¡®² ¥¬ ± ±¨±²¥¬®© ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ¬­®¦¥±²¢, °¥ «¨§®¢ ­­®© ± ¯®¬®¹¼¾ «¥± , ± ®¡º¥¤¨­¥­¨¥¬ ¯® ° ­£ ¬ ¨ ±¦ ²¨¥¬ ¯³²¥© (±¬. ° §¤. 22.3); ·¥°¥§ m ®¡®§­ ·¥­®
±³¬¬ °­®¥ ·¨±«® ®¯¥° ¶¨© Make-Set, Find-Set ¨ Union,   ·¥°¥§
n | ·¨±«® ®¯¥° ¶¨© Make-Set.
¥¬¬  22.2
«¿ ¢±¿ª®© ¢¥°¸¨­» x, ª°®¬¥ ª®°­¿, rank[x] < rank[p[x]] (­ ¯®¬­¨¬, ·²® ¤«¿ ª®°­¿ p[x] = x). °¨ ±®§¤ ­¨¨ ¬­®¦¥±²¢  fxg ¨¬¥¥¬
rank[x] = 0, ¤ «¥¥ rank[x] ¬®¦¥² ²®«¼ª® ¢®§° ±² ²¼ ¨ ¯¥°¥±² ¥²
¬¥­¿²¼±¿, ª®£¤  x ¯¥°¥±² ¥² ¡»²¼ ª®°­¥¬ ¢ ±¢®¥¬ ¤¥°¥¢¥.
16

¥ «¨§ ¶¨¿ ± ¯®¬®¹¼¾ ±¯¨±ª®¢

451

®ª § ²¥«¼±²¢®. ±¥ ½²® ­¥¯®±°¥¤±²¢¥­­® ±«¥¤³¥² ¨§ ®¯¨± ­¨¿
¯°®¶¥¤³° Make-Set, Union ¨ Find-Set ¢ ° §¤¥«¥ 22.3. ®¤°®¡­®±²¨ ¬» ®±² ¢«¿¥¬ ·¨² ²¥«¾ (³¯°. 22.4-1).
³±²¼ x | ¢¥°¸¨­  ®¤­®£® ¨§ ­ ¸¨µ ¤¥°¥¢¼¥¢. ¨±«® ¢¥°¸¨­ ¢
¯®¤¤¥°¥¢¥ ± ª®°­¥¬ x (¢ª«¾· ¿ ± ¬³ x) ­ §®¢¥¬ ¥¥ ° §¬¥°®¬ (size)
¨ ®¡®§­ ·¨¬ size(x).
¥¬¬  22.3
±«¨ x | ª®°¥­¼ ®¤­®£® ¨§ ¤¥°¥¢¼¥¢, ²® size(x) > 2rank[x].
®ª § ²¥«¼±²¢®.
®±² ²®·­® ¯°®¢¥°¨²¼, ·²® ª ¦¤ ¿ ¨§ ®¯¥° ¶¨© Make-Set,
Find-Set ¨ Link ±®µ° ­¿¥² ¨±²¨­­®±²¼ ³²¢¥°¦¤¥­¨¿ Àsize(x) >
2rank[x] ¤«¿ ¢±¥µ ª®°­¥© xÁ. ¯¥° ¶¨¿ Find-Set ­¥ ¬¥­¿¥² ­¨ ° §¬¥°®¢ ª®°­¥©, ­¨ ° ­£®¢ ª ª¨µ ¡» ²® ­¨ ¡»«® ¢¥°¸¨­. ¯¥° ¶¨¿
Make-Set(x) ² ª¦¥ ­¥ ­ °³¸ ¥² ³²¢¥°¦¤¥­¨¿ «¥¬¬»: ­¥ ¬¥­¿¿
° ­£®¢ ¨ ° §¬¥°®¢ ³¦¥ ±³¹¥±²¢³¾¹¨µ ¤¥°¥¢¼¥¢, ®­  ±®§¤ ¥² ­®¢®¥
¤¥°¥¢® ± ¥¤¨­±²¢¥­­®© ¢¥°¸¨­®©, ¤«¿ ª®²®°®© ­¥° ¢¥­±²¢® ®·¥¢¨¤­»¬ ®¡° §®¬ ¢»¯®«­¥­®.
 ±±¬®²°¨¬ ®¯¥° ¶¨¾ Link(x; y ) (­¥ ®£° ­¨·¨¢ ¿ ®¡¹­®±²¨,
¬®¦­® ±·¨² ²¼, ·²® rank[x] 6 rank[y ]).  °¥§³«¼² ²¥ ½²®© ®¯¥° ¶¨¨ ° ­£ ¨«¨ ° §¬¥° ¬®¦¥² ¨§¬¥­¨²¼±¿ ²®«¼ª® ³ ¢¥°¸¨­» y . ±«¨
rank[x] < rank[y], ²® ° §¬¥° y ³¢¥«¨·¨¢ ¥²±¿,   ° ­£ ­¥ ¬¥­¿¥²±¿, ² ª ·²® ­¥° ¢¥­±²¢® size(y ) > 2rank[y] , ®±² ¥²±¿ ¢¥°­»¬. ±«¨
¦¥ rank[x] = rank[y ], ²®, ®¡®§­ · ¿ ·¥°¥§ size0 [y ] ¨ rank0 [y ] ° §¬¥°
¨ ° ­£ y ¯®±«¥ ®¯¥° ¶¨¨ Link, ¨¬¥¥¬ size0[y ] = size[x] + size[y ] ¨
rank0[y ] = rank[y ] + 1. ²±¾¤ 

size0 [y ] = size[x] + size[y ] > 2rank[x] + 2rank[y] = 2rank[y]+1 = 2rank0[y] :
¥¬¬  22.4
¨±«® ¢¥°¸¨­ ° ­£  r ­¥ ¯°¥¢®±µ®¤¨² n=2r (¤«¿ «¾¡®£® ¶¥«®£®
r > 0).
®ª § ²¥«¼±²¢®.
 ´¨ª±¨°³¥¬ ·¨±«® r. ±¿ª¨© ° §, ª®£¤  ª ª®©-«¨¡® ¢¥°¸¨­¥ y
¯°¨±¢ ¨¢ ¥²±¿ ° ­£ r (¢ ±²°®ª¥ 2 ¯°®¶¥¤³°» Make-Set ¨«¨ ¢ ±²°®ª¥ 5 ¯°®¶¥¤³°» Link), ¡³¤¥¬ ¯°¨¢¥¸¨¢ ²¼ ¬¥²ª³ ª® ¢±¥¬ ¢¥°¸¨­ ¬
¯®¤¤¥°¥¢  ± ¢¥°¸¨­®© y . ®±ª®«¼ª³ ¢¥°¸¨­  y ¢ ½²®² ¬®¬¥­² ¿¢«¿¥²±¿ ª®°­¥¬ ®¤­®£® ¨§ ¤¥°¥¢¼¥¢, «¥¬¬  22.3 ¯®ª §»¢ ¥², ·²® ·¨±«®
¯®¬¥· ¥¬»µ ¢¥°¸¨­ ­¥ ¬¥­¼¸¥ 2r .  ¸¨ ¯°®¶¥¤³°» ³±²°®¥­» ² ª,
·²® ª ¦¤ ¿ ¢¥°¸¨­  ¡³¤¥² ¯®¬¥·¥­  ­¥ ¡®«¥¥ ®¤­®£® ° § . ² «®
¡»²¼,
n > (·¨±«® ¬¥²®ª) > 2r  (·¨±«® ¢¥°¸¨­ ° ­£  r),
®²ª³¤  ¢±¥ ¨ ±«¥¤³¥².
«¥¤±²¢¨¥ 22.5
 ­£ «¾¡®© ¢¥°¸¨­» ­¥ ¯°¥¢®±µ®¤¨² blg nc.
®ª § ²¥«¼±²¢®.

452

« ¢  22 ¨±²¥¬» ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ¬­®¦¥±²¢

¬. «¥¬¬³ 22.3 ¨«¨ 22.4
®ª § ²¥«¼±²¢® ®¶¥­ª¨ ¤«¿ ¢°¥¬¥­¨ ° ¡®²»
°¨ ¤®ª § ²¥«¼±²¢¥ ®¶¥­ª¨ ­ ¬ ¡³¤¥² ³¤®¡­¥¥ ° ¡®² ²¼ ± ®¯¥° ¶¨¥© Link,   ­¥ Union. ³±²¼ ¤ ­  ¯®±«¥¤®¢ ²¥«¼­®±²¼ S1, ±®±²®¿¹ ¿ ¨§ m1 ®¯¥° ¶¨© Make-Set, Find-Set ¨ Union.  ¬¥­¨¬ ª ¦¤³¾ ®¯¥° ¶¨¾ Union ­  ¤¢¥ ®¯¥° ¶¨¨ Find-Set ¨ ®¤­³ ®¯¥° ¶¨¾
Link; ¯®«³·¨²±¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼ S2 ¨§ m2 ®¯¥° ¶¨© Make-Set,
Find-Set ¨ Link.
¥¬¬  22.6
±«¨ ±²®¨¬®±²¼ ¢»¯®«­¥­¨¿ ¯®±«¥¤®¢ ²¥«¼­®±²¨ S2 ¢ µ³¤¸¥¬
±«³· ¥ ¥±²¼ O(m2 lg n), ²® ±²®¨¬®±²¼ ¢»¯®«­¥­¨¿ ¯®±«¥¤®¢ ²¥«¼­®±²¨ S1 ¢ µ³¤¸¥¬ ±«³· ¥ ¥±²¼ O(m1 lg n), £¤¥ n | ·¨±«® ®¯¥° ¶¨©
Make-Set.
®ª § ²¥«¼±²¢®.
¥¬¥¤«¥­­® ±«¥¤³¥² ¨§ ®·¥¢¨¤­®£® ­¥° ¢¥­±²¢  m1 6 m2 6 3m1.
¥®°¥¬  22.7
°¥¤¯®«®¦¨¬, ·²® ­ ¤ ±¨±²¥¬®© ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ¬­®¦¥±²¢
(¯¥°¢®­ · «¼­® ¯³±²®©) ¯°®¨§¢¥«¨ m ®¯¥° ¶¨© Make-Set, FindSet ¨ Link, ¨§ ª®²®°»µ n ®¯¥° ¶¨© ¡»«¨ ®¯¥° ¶¨¿¬¨ Make-Set.
®£¤  ¯°¨ ¨±¯®«¼§®¢ ­¨¨ °¥ «¨§ ¶¨¨ ± ¯®¬®¹¼¾ «¥±  ±® ±¦ ²¨¥¬
¯³²¥© ¨ ®¡º¥¤¨­¥­¨¥¬ ¯® ° ­£ ¬ ®¡¹ ¿ ±²®¨¬®±²¼ ½²®© ¯®±«¥¤®¢ ²¥«¼­®±²¨ ®¯¥° ¶¨© ¥±²¼ O(m lg n).
®ª § ²¥«¼±²¢®.
²®¨¬®±²¼ ª ¦¤®© ¨§ ®¯¥° ¶¨© Make-Set ¨ Link ¥±²¼, ®·¥¢¨¤­®, O(1),   ¨µ ±³¬¬ °­ ¿ ±²®¨¬®±²¼ ¥±²¼ ²¥¬ ± ¬»¬ O(m).  ©¬¥¬±¿ ®¯¥° ¶¨¿¬¨ Find-Set. ·¥¢¨¤­®, ±²®¨¬®±²¼ ®¯¥° ¶¨¨ FindSet(x) ¯°®¯®°¶¨®­ «¼­  ¤«¨­¥ ¯³²¨ ¯®¨±ª  ®² x ª ª®°­¾ (¤® ±¦ ²¨¿). ² «® ¡»²¼, ­ ¬ ­ ¤® ®¶¥­¨²¼ ±³¬¬ °­³¾ ¤«¨­³ ¯³²¥© ¯®¨±ª , ¢®§­¨ª ¢¸¨µ ¢ ¯°®¶¥±±¥ ¢»¯®«­¥­¨¿ ¢±¥µ ®¯¥° ¶¨© Find-Set ¨
¤®ª § ²¼, ·²® ®­  ¥±²¼ O(m lg n).
 ¯°®¶¥±±¥ ¢»¯®«­¥­¨¿ ª ¦¤®© ¨§ ®¯¥° ¶¨© Find-Set ¬» ¤¢¨£ ¥¬±¿ ¢¢¥°µ ¯® ®¤­®¬³ ¨§ ¤¥°¥¢¼¥¢, § ª ­·¨¢ ¿ ¯®¨±ª ¢ ¥£® ª®°­¥.
 ¬¥²¨¬, ·²® ­  ª ¦¤®¬ ¸ £¥ ° ­£ ¢¥°¸¨­» ±²°®£® ¢®§° ±² ¥²:
¥±«¨ u | ¢¥°¸¨­ , ¢±²°¥²¨¢¸ ¿±¿ ­  ¯³²¨ ¯®¨±ª ,   v | ±«¥¤³¾¹ ¿ ¢¥°¸¨­ , ²® ¥±²¼ v = p[u], ²® rank[v ] > rank[u]. ¥°¸¨­ 
u ¬®¦¥² ­¥®¤­®ª° ²­® ¢±²°¥· ²¼±¿ ¢ ¯³²¿µ ¯®¨±ª  ¯°¨ ¢»¯®«­¥­¨¨ ° ±±¬ ²°¨¢ ¥¬®© ¢ ²¥®°¥¬¥ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ®¯¥° ¶¨©. °¨
½²®¬ §  ­¥© ¬®£³² (¨ ±ª®°¥¥ ¢±¥£® ¡³¤³²) ¨¤²¨ ° §­»¥ ¢¥°¸¨­»: ¥±«¨ ¢ ­¥ª®²®°»© ¬®¬¥­² §  u ±«¥¤®¢ «  ¢¥°¸¨­  v , ª®²®° ¿ ­¥ ¡»« 
ª®°­¥¢®©, ²® ¯®±«¥ ±¦ ²¨¿ ¯³²¥© §  u ¡³¤¥² ±«¥¤®¢ ²¼ ³¦¥ ­¥ v ,  
ª®°¥­¼ ¤¥°¥¢  (­  ¬®¬¥­² ¯¥°¢®£® ¯®¨±ª ), ²® ¥±²¼ ¢¥°¸¨­  ¡®«¼¸¥£® ° ­£ , ·¥¬ v . (²® ¯°®±²®¥ ­ ¡«¾¤¥­¨¥ ¨£° ¥² ª ¤ «¼­¥©¸¥¬
ª«¾·¥¢³¾ °®«¼.)
 ¡«¾¤ ¿ §  °®±²®¬ ° ­£  ¯°¨ ¯¥°¥µ®¤¥ ®² ¢¥°¸¨­» ª ¥¥ °®¤¨²¥«¾, ¬» ®²¤¥«¼­® ®¶¥­¨²¼ ª®«¨·¥±²¢® ¸ £®¢, ¯°¨ ª®²®°»µ ° ­£
±¨«¼­® ° ±²¥², ¨ ª®«¨·¥±²¢® ¸ £®¢, ª®£¤  ®­ ° ±²¥² ­¥ ±¨«¼­®. »-

¥ «¨§ ¶¨¿ ± ¯®¬®¹¼¾ ±¯¨±ª®¢

453

¡¥°¥¬ ¢ ª ·¥±²¢¥ £° ­¨¶» ­¥ª®²®°³¾ ´³­ª¶¨¾  (k), ®¯°¥¤¥«¥­­³¾
¤«¿ ­¥®²°¨¶ ²¥«¼­»µ ¶¥«»µ k. » ¯°¥¤¯®« £ ¥¬, ·²® ´³­ª¶¨¿
 ¿¢«¿¥²±¿ ¬®­®²®­­® ¢®§° ±² ¾¹¥© ¨ ·²® (k) > k ¯°¨ ¢±¥µ k.
³¤¥¬ £®¢®°¨²¼, ·²® ¯°¨ ¯¥°¥µ®¤¥ ®² ¢¥°¸¨­» u ª ¥¥ °®¤¨²¥«¾
v = p[u] ° ­£ ±¨«¼­® ° ±²¥², ¥±«¨ rank[v ] >  (rank[u]). °¨ ½²®¬
¬» ¨±ª«¾· ¥¬ ¨§ ° ±±¬®²°¥­¨¿ ±«³· ©, ª®£¤  v ¿¢«¿¥²±¿ ª®°­¥¬
| ² ª®© ±«³· © ¢±²°¥· ¥²±¿ ¯® ° §³ ¯°¨ ¢»¯®«­¥­¨¨ ª ¦¤®© ®¯¥° ¶¨¨ Find-Set, ¨ ¯®²®¬³ ®¡¹¥¥ ·¨±«® ² ª¨µ ±¨²³ ¶¨© ¥±²¼ O(m).
 ·­¥¬ ± ®¶¥­ª¨ ·¨±«  ¸ £®¢, ¯°¨ ª®²®°»µ ° ­£ ­¥ ±¨«¼­®
° ±²¥², ¨ ±£°³¯¯¨°³¥¬ ¨µ ¯® ¢¥°¸¨­ ¬, ¨§ ª®²®°»µ ½²®² ¸ £ ¤¥« ¥²±¿. «¿ ¢¥°¸¨­» ° ­£  k ° ­£¨ ¥¥ ¯°¥¤ª  ¬®£³² ¬¥­¿²¼±¿ ®²
k + 1 ¤® (k) (¯®±«¥ ½²®£® ° ­£ ° ±²¥² ±¨«¼­®). ­ ·¨², ·¨±«® ² ª¨µ ¸ £®¢ (¨§ ¤ ­­®© ¢¥°¸¨­» ° ­£  k) § ¢¥¤®¬® ­¥ ¡®«¼¸¥  (k),
¯®±ª®«¼ª³, ª ª ¬» £®¢®°¨«¨, ª ¦¤»© ­®¢»© ¸ £ ¢¥¤¥² ¢ ¢¥°¸¨­³ ¡®«¼¸¥£® ° ­£ , ·¥¬ ¯°¥¤»¤³¹¨©. ®±ª®«¼ª³ ¢¥°¸¨­ ° ­£  k
­¥ ¡®«¥¥ n=2k , ²® ®¡¹¥¥ ·¨±«® ¸ £®¢, ¯°¨ ª®²®°»µ ° ­£ ­¥ ±¨«¼­®
° ±²¥², ­¥ ¯°¥¢®±µ®¤¨²
X n (k)
k
k 2
P

±«¨ ¢»¡° ²¼ ´³­ª¶¨¾  ² ª, ·²®¡» °¿¤  (k)=2k ±µ®¤¨«±¿, ²®
®¡¹¥¥ ·¨±«® ¸ £®¢ ² ª®£® °®¤  ¥±²¼ O(n).
°¥¦¤¥ ·¥¬ ¢»¡° ²¼ ´³­ª¶¨¾  , ®¡º¿±­¨¬, ª ª ®¶¥­¨²¼ ·¨±«®
¸ £®¢, ¯°¨ ª®²®°»µ ° ­£ ±¨«¼­® ° ±²¥².  ª¨¥ ¸ £¨ ¬» ±£°³¯¯¨°³¥¬ ­¥ ¯® ¢¥°¸¨­ ¬,   ¯® ¯³²¿¬: ­  ª ¦¤®¬ ¯³²¨ ¯®¨±ª  ² ª¨µ
¸ £®¢ ¬ «®, ² ª ª ª ° ­£ ­¥ ¬®¦¥² ¬­®£®ª° ²­® ±¨«¼­® ° ±²¨ (®­
¬¥­¿¥²±¿ ¢±¥£® «¨¸¼ ®² 0 ¤® lg n).  ª¨¬ ®¡° §®¬, ­  ª ¦¤®¬ ¯³²¨ ·¨±«® ¸ £®¢, ¯°¨ ª®²®°®¬ ° ­£ ±¨«¼­® ° ±²¥², ­¥ ¯°¥¢®±µ®¤¨²
·¨±«  ¨²¥° ¶¨© ´³­ª¶¨¨  , ª®²®°»¥ ­³¦­® ±¤¥« ²¼, ·²®¡» ¤®©²¨
®² 0 ¤® lg n.
®²¥«®±¼ ¡» ¯®«®¦¨²¼  (k) = 2k : ²®£¤  ·¨±«® ¨²¥° ¶¨© ¡³¤¥²
¯°¨¬¥°­® ° ¢­® lg n.  ±®¦ «¥­¨¾, ²®£¤  ­ ¯¨± ­­»© ¢»¸¥ °¿¤
° ±µ®¤¨²±¿. °¨¤¥²±¿ ¢§¿²¼ ­¥¬­®£® P
¬¥­¼¸³¾ ´³­ª¶¨¾.
 ¯°¨P
k
k
k
k
¬¥°, ¯®«®¦¨¬  (k) = d1;9 e, ²®£¤  °¿¤ d1;9 e=2 6 (1;9 +1)=2k
±µ®¤¨²±¿.  ¤°³£®© ±²®°®­», ·¨±«® ¨²¥° ¶¨© ´³­ª¶¨¨  , ª®²®°»¥
­³¦­® ±¤¥« ²¼, ·²®¡» ®² 0 ¤®©²¨ ¤® ª ª®£®-²® ·¨±« , ¢®§° ±²¥²
(¯® ±° ¢­¥­¨¾ ± ´³­ª¶¨¥© k 7! 2k ) ­¥ ¡®«¥¥ ·¥¬ ¢¤¢®¥, ¯®±ª®«¼ª³
((k)) > 2k , ¨ ¯®²®¬³ ¥±²¼ O(lg n). ² ª, ·¨±«® ¸ £®¢ ² ª®£®
°®¤  ¤«¿ ¢±¥µ m ®¯¥° ¶¨© ¥±²¼ O(m lg n).
ª« ¤»¢ ¿ ¢¬¥±²¥ ¤¥©±²¢¨¿ ¢±¥µ ¢¨¤®¢ (®¯¥° ¶¨¨ Make-Set ¨
Link, ¯®±«¥¤­¨¥ ¸ £¨ ¢ ª ¦¤®¬ ¯³²¨, ¸ £¨, ­  ª®²®°»µ ° ­£ ­¥
±¨«¼­® ° ±²¥², ¨ ¸ £¨, ­  ª®²®°»µ ° ­£ ±¨«¼­® ° ±²¥²), ¯®«³· ¥¬ ®¡¹³¾ ®¶¥­ª³ O(n) + O(m lg n) = O(m lg n) (­ ¯®¬­¨¬, ·²®
m > n, ² ª ª ª m | ®¡¹¥¥ ·¨±«® ®¯¥° ¶¨©,   n | ·¨±«® ®¯¥° ¶¨©
textscMake-Set), ·²® ¨ ²°¥¡®¢ «®±¼ ¤®ª § ²¼.
[ ¬¥· ­¨¥. ®ª § ²¥«¼±²¢® ½²®© ²¥®°¥¬» ±«¥£ª  ¨§¬¥­¥­® ¯®

454

« ¢  22 ¨±²¥¬» ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ¬­®¦¥±²¢

±° ¢­¥­¨¾ ±  ­£«¨©±ª¨¬ ®°¨£¨­ «®¬: ¢ ¯®±«¥¤­¥¬ ¨±¯®«¼§³¥²±¿ ´³­ª¶¨¿  (k), ° ¢­ ¿ ­ ¨¬¥­¼¸¥¬³ ·«¥­³ ¯®±«¥¤®¢ ²¥«¼­®±²¨
1; 2; 4; 16; 65536; : : : , ¡®«¼¸¥¬³ k (ª ¦¤»© ·«¥­ ¯®±«¥¤®¢ ²¥«¼­®±²¨
¥±²¼ ¤¢®©ª  ¢ ±²¥¯¥­¨ ¯°¥¤»¤³¹¥£® ·«¥­ ). ®£¤  ­  ª ¦¤®¬ ¯³²¨ ¡³¤¥²
­¥ ¡®«¥¥ lg n ¸ £®¢, ­  ª®²®°»µ ° ­£ ±¨«¼­® ° ±²¥²,  
P
°¿¤  (k)=2k ±µ®¤¨²±¿, ­® ¨¬¥¥² ¤®±² ²®·­® ¬¥¤«¥­­® ° ±²³¹¨¥
· ±²¨·­»¥ ±³¬¬».]
§ ¤®ª § ­­®© ²¥®°¥¬» ¨ «¥¬¬» 22.6 ­¥¬¥¤«¥­­® ¢»²¥ª ¥²
«¥¤±²¢¨¥ 22.8
°¥¤¯®«®¦¨¬, ·²® ­ ¤ ±¨±²¥¬®© ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ¬­®¦¥±²¢
(¨§­ · «¼­® ¯³±²®©) ¯°®¨§¢¥«¨ m ®¯¥° ¶¨© Make-Set, Find-Set ¨
Union, n ¨§ ª®²®°»µ | Make-Set. ®£¤  ¯°¨ ¨±¯®«¼§®¢ ­¨¨ °¥ «¨§ ¶¨¨ ± ¯®¬®¹¼¾ «¥±  ±® ±¦ ²¨¥¬ ¯³²¥© ¨ ®¡º¥¤¨­¥­¨¥¬ ¯® ° ­£ ¬ ±²®¨¬®±²¼ ½²®© ¯®±«¥¤®¢ ²¥«¼­®±²¨ ®¯¥° ¶¨© ¥±²¼ O(m lg n).
¯° ¦­¥­¨¿
22.4-1
®ª ¦¨²¥ «¥¬¬³ 22.2.
22.4-2
ª®«¼ª® ¡¨²®¢ ­³¦­®, ·²®¡» µ° ­¨²¼ size[x] ¤«¿ ³§«  x? ®² ¦¥
¢®¯°®± ¤«¿ rank[x].
22.4-3
®«¼§³¿±¼ «¥¬¬®© 22.2 ¨ ±«¥¤±²¢¨¥¬ 22.5, ¤®ª ¦¨²¥, ·²® ±²®¨¬®±²¼ m ®¯¥° ¶¨© ± «¥±®¬ ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ¬­®¦¥±²¢ ± ¨±¯®«¼§®¢ ­¨¥¬ ®¡º¥¤¨­¥­¨¿ ¯® ° ­£ ¬, ­® ¡¥§ ±¦ ²¨¿ ¯³²¥©, ¥±²¼
O(m lg n), £¤¥ n, ª ª ®¡»·­®, ®¡®§­ · ¥² ª®«¨·¥±²¢® ®¯¥° ¶¨©
Make-Set.
22.4-4*
¡º¿±­¨²¥, ¯®·¥¬³ ¯®±«¥¤­¨¥ ¸ £¨ ¯³²¥© ²°¥¡®¢ «¨ ¢ ­ ¸¥¬
° ±±³¦¤¥­¨¨ ®±®¡®£® ° ±±¬®²°¥­¨¿ (  ­  ª« ±±¨´¨¶¨°®¢ «¨±¼ ¢
§ ¢¨±¨¬®±²¨ ®² °®±²  ° ­£ , ª ª ¢±¥ ®±² «¼­»¥): ¯°¨¢¥¤¨²¥ ¯°¨¬¥° ±¨²³ ¶¨¨, ¢ ª®²®°®© ­¥ª®²®° ¿ ¢¥°¸¨­  x ¢µ®¤¨² 
(m) ° §
¢ ¯³²¼ ¯®¨±ª  ¤«¿ ®¯¥° ¶¨¨ Find-Set, ¯°¨·¥¬ ¯°¨ ¢»µ®¤¥ ¨§ ­¥¥
° ­£ ° ±²¥² ­¥ ±¨«¼­®. ( ª ¢¨¤­® ¨§ ¤®ª § ²¥«¼±²¢ , ½²® ¢®§¬®¦­®
«¨¸¼ ¥±«¨ ®­  ¯® ¡®«¼¸¥© · ±²¨ ¿¢«¿¥²±¿ ¯°¥¤¯®±«¥¤­¥© ¢¥°¸¨­®©
¯³²¨.)
 ¤ ·¨
22-1 ®¨±ª ¬¨­¨¬³¬  ¢ °¥¦¨¬¥ o-line.
 ¤ ·  ® ¯®¨±ª¥ ¬¨­¨¬³¬  ¢ °¥¦¨¬¥ o-line (o-line minimum
problem) ±®±²®¨² ¢ ±«¥¤³¾¹¥¬. ³±²¼ ¨¬¥¥²±¿ ¤¨­ ¬¨·¥±ª®¥ ¬­®¦¥±²¢® T , ¯®¤¤¥°¦¨¢ ¾¹¥¥ ®¯¥° ¶¨¨ Insert(x) (¤®¡ ¢¨²¼ ½«¥¬¥­²
x) ¨ Extract-Min (³¤ «¨²¼ ¬¨­¨¬ «¼­»© ½«¥¬¥­²). ¥°¢®­ · «¼­® ¬­®¦¥±²¢® T ¯³±²®, § ²¥¬ ¢»¯®«­¿¥²±¿ ­¥ª®²®° ¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¨§ n ®¯¥° ¶¨© Insert ¨ m ®¯¥° ¶¨© Extract-Min, ¯°¨·¥¬ ®¯¥° ¶¨¨ Insert ¤®¡ ¢«¿¾² ¢ ¬­®¦¥±²¢® ¯® ®¤­®¬³ ° §³ ¢±¥
­ ²³° «¼­»¥ ·¨±«  ®² 1 ¤® n (­¥ ®¡¿§ ²¥«¼­® ¢ ¯®°¿¤ª¥ ¢®§° ±² ­¨¿). °¥¡³¥²±¿ ¯® ¤ ­­®© ¯®±«¥¤®¢ ²¥«¼­®±²¨ ®¯¥° ¶¨© In-

¥ «¨§ ¶¨¿ ± ¯®¬®¹¼¾ ±¯¨±ª®¢

455

sert(x) ¨ Extract-Min ±®§¤ ²¼ ¬ ±±¨¢ extracted[1::m], ¢ ª®²®-

°®¬ extracted[i] | ·¨±«®, ¢®§¢° ¹ ¥¬®¥ i-®© ¯® ±·¥²³ ®¯¥° ¶¨¥©
Extract-Min.
®¢®°¿ ® À°¥¦¨¬¥ o-lineÁ, ¨¬¥¾² ¢ ¢¨¤³, ·²® ®² ­ ± ²°¥¡³¥²±¿
¤ ²¼ ®²¢¥² ¯®±«¥ ²®£®, ª ª ¬» §­ ¥¬ ¢±¾ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ª®¬ ­¤ (¢ ¯°®²¨¢®¯®«®¦­®±²¼ ½²®¬³, ¢ °¥¦¨¬¥ Àon-lineÁ ®² ­ ± ²°¥¡®¢ «®±¼ ¡» ¤ ¢ ²¼ ®²¢¥² ­¥¬¥¤«¥­­® ¯® ¯®±²³¯«¥­¨¨ ®·¥°¥¤­®©
ª®¬ ­¤», ­¥ ¤®¦¨¤ ¿±¼ ±«¥¤³¾¹¥©).
( ) ³±²¼ ª®¬ ­¤» ¯®±²³¯ «¨ ¢ ² ª®© ¯®±«¥¤®¢ ²¥«¼­®±²¨ (¬» ¯¨¸¥¬ E ¢¬¥±²® Extract-Min ¨ i ¢¬¥±²® Insert(i)):
4; 8; E; 3; E; 9; 2; 6; E; E; E; 1; 7; E; 5:

 ª ¢»£«¿¤¨² ¬ ±±¨¢ extracted?
«£®°¨²¬ ¤«¿ °¥¸¥­¨¿ § ¤ ·¨ ® ¬¨­¨¬³¬¥ ¢ °¥¦¨¬¥ o-line ¬®¦¥² ¢»£«¿¤¥²¼ ±«¥¤³¾¹¨¬ ®¡° §®¬. ³±²¼ S | ¤ ­­ ¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ª®¬ ­¤. °¥¤±² ¢¨¬ ¥¥ ¢ ¢¨¤¥
I1 ; E; I2; E; I3; : : :; Im ; E; Im+1;
£¤¥ ª ¦¤®¥ E ®¡®§­ · ¥² ®¯¥° ¶¨¾ Extract-Min,   ª ¦¤®¥ Ij ®¡®§­ · ¥² ¯®±«¥¤®¢ ²¥«¼­®±²¼ ®¯¥° ¶¨© Insert (¢®§¬®¦­®, ¯³±²³¾).
«¿ ª ¦¤®© ¯®±«¥¤®¢ ²¥«¼­®±²¨ Ij ±®§¤ ¤¨¬ ¬­®¦¥±²¢® Kj , ±®±²®¿¹¥¥ ¨§ ·¨±¥«, ¤®¡ ¢«¿¥¬»µ ¢ T ¯°¨ ®¯¥° ¶¨¿µ Insert ¨§ ¯®±«¥¤®¢ ²¥«¼­®±²¨ Ij .  ²¥¯¥°¼ ±¤¥« ¥¬ ¢®² ·²®:
Off-Line-Minimum(m,n)
1 for i \gets 1 to n
2
do ­ ©²¨ ² ª®¥ $j$, ·²® $i\in K_j$
3
if j \ne m+1
4
then extracted[j] \gets i
5
l \gets (­ ¨¬¥­¼¸¥¥ ·¨±«®, ¡®«¼¸¥¥ $j$,
¤«¿ ª®²®°®£® ±³¹¥±²¢³¥² ¬­®¦¥±²¢® $K_l$)
6
K_l\gets K_l\cup K_j (¬­®¦¥±²¢® $K_j$ ¨±·¥§ ¥²)
7 return extracted

(¡) ®ª ¦¨²¥, ·²®  «£®°¨²¬ Off-Line-Minimum ¯° ¢¨«¼­® § ¯®«­¿¥² ¬ ±±¨¢ extracted.
(¢) ¥ «¨§³©²¥  «£®°¨²¬ Off-Line-Minimum ± ¯®¬®¹¼¾ ±¨±²¥¬»
­¥¯¥°¥±¥ª ¾¹¨µ±¿ ¬­®¦¥±²¢.  ©²¥ ¤®±² ²®·­® ²®·­³¾ ®¶¥­ª³
¢°¥¬¥­¨ ° ¡®²» ¢ µ³¤¸¥¬ ±«³· ¥.
22-2 ¯°¥¤¥«¥­¨¥ £«³¡¨­»
 § ¤ ·¥ ®¯°¥¤¥«¥­¨¿ £«³¡¨­» (depth-determination problem) ²°¥¡³¥²±¿ °¥ «¨§®¢ ²¼ «¥± F , ±®±²®¿¹¨© ¨§ ª®°­¥¢»µ ¤¥°¥¢¼¥¢ Ti , ¯®¤¤¥°¦¨¢ ¾¹¨© ±«¥¤³¾¹¨¥ ²°¨ ®¯¥° ¶¨¨:
Make-Tree(v ) ®§¤ ¥² ­®¢®¥ ¤¥°¥¢® ± ¥¤¨­±²¢¥­­®© ¢¥°¸¨­®© v .

456

« ¢  22 ¨±²¥¬» ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ¬­®¦¥±²¢

Find-Depth(v ) ®§¢° ¹ ¥² £«³¡¨­³ (° ±±²®¿­¨¥ ¤® ª®°­¿) ¢¥°¸¨-

­» v .
Graft(r; v ) (À¯°¨¢¨¢ª Á). ¥°¸¨­  r ¤®«¦­  ¡»²¼ ª®°­¥¬ ®¤­®£® ¨§ ¤¥°¥¢¼¥¢, ¢¥°¸¨­  v ¤®«¦­  ¯°¨­ ¤«¥¦ ²¼ ª ª ª®¬³-²®
¤°³£®¬³ ¤¥°¥¢³; ¤¥°¥¢® ± ª®°­¥¬ r À¯°¨¢¨¢ ¥²±¿Á ª ¤¥°¥¢³, ±®¤¥°¦ ¹¥¬³ v , ¯°¨ ½²®¬ v ±² ­®¢¨²±¿ °®¤¨²¥«¥¬ r.
( ) ³±²¼ ¬» °¥ «¨§®¢ «¨ ½²³ ±²°³ª²³°³ ¤ ­­»µ ±«¥¤³¾¹¨¬ ®¡° §®¬. ¥°¥¢¼¿ ¯°¥¤±² ¢«¿¾²±¿ ª ª ¢ «¥±¥ ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ¬­®¦¥±²¢ (p[v ] | °®¤¨²¥«¼ ¢¥°¸¨­» v , ¥±«¨ v | ­¥ ª®°¥­¼, ¨
p[v ] = v, ¥±«¨ v | ª®°¥­¼), ¯°®¶¥¤³°  Graft(r; v) ±®±²®¨² ¢
¯°¨±¢ ¨¢ ­¨¨ p[r] v , ¯°®¶¥¤³°  Make-Tree ­ ¯¨± ­  ®·¥¢¨¤­»¬ ®¡° §®¬, ¨, ­ ª®­¥¶, ¤«¿ ­ µ®¦¤¥­¨¿ £«³¡¨­» (FindDepth(v )) ¬» ¨¤¥¬ ¨§ v ¢ ª®°¥­¼ ¨ ¯®¤±·¨²»¢ ¥¬ ¤«¨­³ ¯³²¨.
®ª ¦¨²¥, ·²® ¯°¨ ½²®¬ ±²®¨¬®±²¼ m ®¯¥° ¶¨© Make-Tree,
Graft ¨ Find-Depth ¢ µ³¤¸¥¬ ±«³· ¥ ¥±²¼ (m2).
«£®°¨²¬ ¬®¦­® ³±ª®°¨²¼, ¥±«¨ ¢®±¯®«¼§®¢ ²¼±¿ ®¡º¥¤¨­¥­¨¥¬
¯® ° ­£ ¬ ¨ ±¦ ²¨¥¬ ¯³²¥©.  ¬¥²¨¬, ·²® ±²°³ª²³°  ¤¥°¥¢ , ­³¦­®£® ¤«¿ ±¦ ²¨¿ ¯³²¥©, ­¥ ®¡¿§ ­  ±®®²¢¥²±²¢®¢ ²¼ ±²°³ª²³°¥ ¨±µ®¤­®£® ¤¥°¥¢  | ¢ ¦­® «¨¸¼, ·²®¡» ¬®¦­® ¡»«® ¢®±±² ­ ¢«¨¢ ²¼
¨­´®°¬ ¶¨¾ ® £«³¡¨­¥ (°¥¡°® ­®¢®£® ¤¥°¥¢  ¤®«¦­® µ° ­¨²¼ ¨­´®°¬ ¶¨¾ ® ° §­¨¶¥ £«³¡¨­ ª®­¶®¢ °¥¡°  ¢ ±² °®¬ ¤¥°¥¢¥).
(¡) ¥ «¨§³©²¥ ®¯¥° ¶¨¾ Make-Tree.
(¢) ¥ «¨§³©²¥ ®¯¥° ¶¨¾ Find-Depth.  ¸  «£®°¨²¬ ¤®«¦¥­ ¨±¯®«¼§®¢ ²¼ ±¦ ²¨¥ ¯³²¥©,   ¥£® ¢°¥¬¿ ° ¡®²» ¤®«¦­® ¡»²¼ ¯°®¯®°¶¨®­ «¼­® ¤«¨­¥ ¯³²¨ ¯®¨±ª .
(£) ¥ «¨§³©²¥ ®¯¥° ¶¨¾ Graft (¤¥©±²¢³©²¥ ¯®  ­ «®£¨¨ ±  «£®°¨²¬ ¬¨ Union ¨ Link; ª®°¥­¼ ¢ ±²°®¨¬®¬ ¤¥°¥¢¥ ­¥ ®¡¿§ ­
¡»²¼ ª®°­¥¬ ¢ ±² °®¬ ±¬»±«¥).
(¤)  ©²¥ ²®·­³¾ ®¶¥­ª³ ­  ±²®¨¬®±²¼ ¯®±«¥¤®¢ ²¥«¼­®±²¨ m ®¯¥° ¶¨© Make-Tree, Graft ¨ Find-Depth, n ¨§ ª®²®°»µ | ®¯¥° ¶¨¨ Make-Tree (¤«¿ µ³¤¸¥£® ±«³· ¿).
22-3 «£®°¨²¬  °¼¿­  ¤«¿ ­ µ®¦¤¥­¨¿ ­ ¨¬¥­¼¸¥£® ®¡¹¥£®
¯°¥¤ª  ¢ °¥¦¨¬¥ o-line.
 ¨¬¥­¼¸¨© ®¡¹¨© ¯°¥¤®ª (least common ancestor, ±®ª° ¹¥­­®
LCA) ¢¥°¸¨­ u ¨ v ª®°­¥¢®£® ¤¥°¥¢  T ¥±²¼, ¯® ®¯°¥¤¥«¥­¨¾, ¢¥°¸¨­  ­ ¨¡®«¼¸¥© £«³¡¨­» ±°¥¤¨ ¢¥°¸¨­, ¿¢«¿¾¹¨µ±¿ ¯°¥¤ª ¬¨
ª ª u, ² ª ¨ v .  ¤ ·  ® ­ µ®¦¤¥­¨¨ ­ ¨¬¥­¼¸¨µ ®¡¹¨µ ¯°¥¤ª 
¢ °¥¦¨¬¥ o-line (o-line least-common-ancestors problem) ±®±²®¨² ¢ ±«¥¤³¾¹¥¬.  ­® ª®°­¥¢®¥ ¤¥°¥¢® T ¨ ­¥ª®²®°®¥ ¬­®¦¥±²¢®
P ­¥³¯®°¿¤®·¥­­»µ ¯ ° ¥£® ¢¥°¸¨­. °¥¡³¥²±¿ ¤«¿ ª ¦¤®© ¯ °»
¢¥°¸¨­ (u; v ) 2 P ­ ©²¨ ¨µ ­ ¨¬¥­¼¸¥£® ®¡¹¥£® ¯°¥¤ª .
¨¦¥ ¯°¨¢¥¤¥­  «£®°¨²¬ LCA, °¥¸ ¾¹¨© ½²³ § ¤ ·³ (­ ¨¬¥­¼¸¨¥ ®¡¹¨¥ ¯°¥¤ª¨ ¢±¥µ ¯ ° (u; v ) 2 P ¡³¤³² ­ ¯¥· ² ­» ¢ °¥§³«¼² ²¥ ¢»§®¢  LCA(root[T ]); ¢­ · «¥ ¢±¥ ¢¥°¸¨­» ¤¥°¥¢  | ¡¥«»¥).

¥ «¨§ ¶¨¿ ± ¯®¬®¹¼¾ ±¯¨±ª®¢

457

LCA(u)
1 Make-Set(u)
2 ancestor[Find-Set(u)] \gets u
3 for (¤«¿) ª ¦¤®£® $v$, ¿¢«¿¾¹¥£®±¿ °¥¡\"^^a5­ª®¬ $u$
4
do LCA(v)
5
Union(u,v)
6
ancestor[Find-Set(u)] \gets u
7 ¯®ª° ±¨²¼ u ¢ ·\"^^a5°­»© ¶¢¥²
8 for (¤«¿) ª ¦¤®© ¢¥°¸¨­» v ² ª®©, ·²® $(u,v)\in P$
9
do if ¢¥°¸¨­  v ·\"^^a5°­ ¿
10
then print (`` ¨¬¥­¼¸¨© ®¡¹¨© ¯°¥¤®ª '' $u$ `` ¨ '' $v$
`` ¥±²¼ '' ancestor[Find-Set(v)]

( ) ®ª ¦¨²¥, ·²® ±²°®ª  10 ¨±¯®«­¿¥²±¿ ¢ ²®·­®±²¨ ®¤¨­ ° § ¤«¿
ª ¦¤®© ¯ °» (u; v ) 2 P .
(¡) ®ª ¦¨²¥, ·²® ¢ °¥§³«¼² ²¥ ¢»§®¢  LCA(root[T ]) ª ¦¤»© ¨§
¯®±«¥¤³¾¹¨µ ¢»§®¢®¢ LCA(u) ¯°®¨±µ®¤¨² ¢ ²®² ¬®¬¥­², ª®£¤ 
ª®«¨·¥±²¢® ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ¬­®¦¥±²¢ ° ¢­® £«³¡¨­¥ ¢¥°¸¨­» u ¢ ¤¥°¥¢¥ T .
(¢) ®ª ¦¨²¥, ·²® ¢ °¥§³«¼² ²¥ ¢»§®¢  LCA(ª®°¥­¼[T ]) ¡³¤³² ­ ¯¥· ² ­» ­ ¨¬¥­¼¸¨¥ ®¡¹¨¥ ¯°¥¤ª¨ ¤«¿ ¢±¥µ ¯ ° (u; v ) 2 P .
(£) ¶¥­¨²¥ ¢°¥¬¿ ° ¡®²»  «£®°¨²¬  LCA ¢ ¯°¥¤¯®«®¦¥­¨¨, ·²®
±¨±²¥¬  ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ¬­®¦¥±²¢ °¥ «¨§®¢ ­  ± ¯®¬®¹¼¾
«¥±  ± ®¡º¥¤¨­¥­¨¥¬ ¯® ° ­£ ¬ ¨ ±¦ ²¨¥¬ ¯³²¥©.
 ¬¥· ­¨¿
­®£¨¥ ¢ ¦­»¥ °¥§³«¼² ²» ® ±¨±²¥¬ µ ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ¬­®¦¥±²¢ ¢ ²®© ¨«¨ ¨­®© ¬¥°¥ ¯°¨­ ¤«¥¦ ²  °¼¿­³.  · ±²­®±²¨,
¨¬¥­­® ®­ ³±² ­®¢¨« ®¶¥­ª³ O(m(m; n)) [186, 188]. ®«¥¥ ±« ¡ ¿
®¶¥­ª  O(m lg n) ¡»«  ° ­¥¥ ¯®«³·¥­  ®¯ª°®´²®¬ ¨ «¼¬ ­®¬
[4, 103].  ° ¡®²¥ [190]  °¼¿­ ¨ ¢ ­ ¥³¢¥­ ®¡±³¦¤ ¾² ° §«¨·­»¥ ¢ °¨ ­²» ±¦ ²¨¿ ¯³²¥©, ¢ ²®¬ ·¨±«¥  «£®°¨²¬», ° ¡®² ¾¹¨¥
À§  ®¤¨­ ¯°®µ®¤Á (¨­®£¤  ®­¨ ° ¡®² ¾² ¡»±²°¥¥ À¤¢³µ¯°®µ®¤­»µÁ).
 ¡®¢ ¨  °¼¿­ [76] ¯®ª § «¨, ·²® ¢ ­¥ª®²®°»µ ¯°¨«®¦¥­¨¿µ ®¯¥° ¶¨¨ ± ­¥¯¥°¥±¥ª ¾¹¨¬¨±¿ ¬­®¦¥±²¢ ¬¨ ¬®¦­® ¢»¯®«­¨²¼ §  ¢°¥¬¿
O(m).
 ° ¡®²¥ [187]  °¼¿­ ¯®ª § «, ·²® ¯°¨ ­¥ª®²®°»µ ¤®¯®«­¨²¥«¼­»µ ³±«®¢¨¿µ ±²®¨¬®±²¼ ®¯¥° ¶¨© ± ­¥¯¥°¥±¥ª ¾¹¨¬¨±¿ ¬­®¦¥±²¢ ¬¨ ­¥ ¬®¦¥² ¡»²¼ ­¨¦¥, ·¥¬ O(m(m; n)), ª ª³¾ °¥ «¨§ ¶¨¾
¬» ¡» ­¨ ¨§¡° «¨. °¥¤¬ ­ ¨  ª± [74] ¯®ª § «¨, ·²®, ª°®¬¥ ²®£®,
¢ µ³¤¸¥¬ ±«³· ¥ ½²¨ ®¯¥° ¶¨¨ ²°¥¡³¾² ®¡° ¹¥­¨¿ ª 
(m(m; n))
±«®¢ ¬ ¤«¨­®¾ ¢ lg n ¡¨²®¢.

23

«£®°¨²¬» ­  £° ´ µ

¢¥¤¥­¨¥
° ´» ¢±²°¥· ¾²±¿ ¢ ±®²­¿µ ° §­»µ § ¤ ·, ¨  «£®°¨²¬» ®¡° ¡®²ª¨ £° ´®¢ ®·¥­¼ ¢ ¦­».  ½²®© · ±²¨ ª­¨£¨ ¬» ° ±±¬®²°¨¬
­¥±ª®«¼ª® ®±­®¢­»µ  «£®°¨²¬®¢ ®¡° ¡®²ª¨ £° ´®¢.
 £« ¢¥ 23 ° ±±¬ ²°¨¢ ¾²±¿ ±¯®±®¡» ¯°¥¤±² ¢«¥­¨¿ £° ´  ¢ ¯°®£° ¬¬¥,   ² ª¦¥ ° §«¨·­»¥ ¢ °¨ ­²» ®¡µ®¤  £° ´  (¯®¨±ª ¢ ¸¨°¨­³ ¨ ¢ £«³¡¨­³). °¨¢®¤¿²±¿ ¤¢  ¯°¨¬¥­¥­¨¿ ¯®¨±ª  ¢ £«³¡¨­³:
²®¯®«®£¨·¥±ª ¿ ±®°²¨°®¢ª  ®°¨¥­²¨°®¢ ­­®£® £° ´  ¡¥§ ¶¨ª«®¢ ¨
° §«®¦¥­¨¥ ®°¨¥­²¨°®¢ ­­®£® £° ´  ¢ ±³¬¬³ ±¨«¼­® ±¢¿§­»µ ª®¬¯®­¥­².
 £« ¢¥ 24 ° ±±¬ ²°¨¢ ¥²±¿ § ¤ ·  ® ¯®ª°»¢ ¾¹¥¬ ¤¥°¥¢¥ (­ ¡®°¥ °¥¡¥°, ±¢¿§»¢ ¾¹¥¬ ¢±¥ ¢¥°¸¨­» £° ´ ) ¬¨­¨¬ «¼­®£® ¢¥± .
(» ¯°¥¤¯®« £ ¥¬, ·²® ª ¦¤®¥ °¥¡°® £° ´  ¨¬¥¥² ­¥ª®²®°»© ¯®«®¦¨²¥«¼­»© ¢¥±.) «¿ ½²®© § ¤ ·¨ ¯°¨¬¥­¨¬» ¦ ¤­»¥  «£®°¨²¬»
(±¬. £« ¢³ 18).
 £« ¢ µ 25 ¨ 26 ° ±±¬ ²°¨¢ ¥²±¿ § ¤ ·  ® ª° ²· ©¸¨µ ¯³²¿µ.
­®¢¼ ª ¦¤®¬³ °¥¡°³ ¯°¨¯¨± ­® ­¥ª®²®°®¥ ·¨±«®, ­® ²¥¯¥°¼ ®­®
­ §»¢ ¥²±¿ ¤«¨­®© °¥¡° . °¥¡³¥²±¿ ­ ©²¨ ª° ²· ©¸¨¥ ¯³²¨ ¨§
®¤­®© ¢¥°¸¨­» ¢® ¢±¥ ®±² «¼­»¥ (£« ¢  25) ¨«¨ ª° ²· ©¸¨¥ ¯³²¨
¨§ ª ¦¤®© ¢¥°¸¨­» ¢ ª ¦¤³¾ (£« ¢  26).
 ª®­¥¶, ¢ £« ¢¥ 27 ° ±¬ ²°¨¢ ¥²±¿ § ¤ ·¥ ® ¬ ª±¨¬ «¼­®¬ ¯®²®ª¥ ¢¥¹¥±²¢  ·¥°¥§ ±¥²¼ ²°³¡ ®£° ­¨·¥­­®© ¯°®¯³±ª­®© ±¯®±®¡­®±²¨.  ¦¤®¥ °¥¡°® ° ±±¬ ²°¨¢ ¥²±¿ ª ª ²°³¡  ­¥ª®²®°®© ¯°®¯³±ª­®© ±¯®±®¡®±²¨.  ­¥ª®²®°®© ¢¥°¸¨­¥ ­ µ®¤¨²±¿ ¨±²®·­¨ª ¢¥¹¥±²¢ ,   ¢ ¤°³£®© | ¯®²°¥¡¨²¥«¼. ¯° ¸¨¢ ¥²±¿, ª ª®© ¯®²®ª
¢¥¹¥±²¢  ¬®¦­® ¯¥°¥¤ ¢ ²¼ ®² ¨±²®·­¨ª  ª ¯®²°¥¡¨²¥«¾, ­¥ ¯°¥¢»¸ ¿ ¯°®¯³±ª­®© ±¯®±®¡­®±²¨ ²°³¡. ²  § ¤ ·  ¢ ¦­ , ¯®±ª®«¼ª³
ª ­¥© ±¢®¤¨²±¿ ¬­®£¨¥ ¨­²¥°¥±­»¥ § ¤ ·¨.
» ¡³¤¥¬ ®¶¥­¨¢ ²¼ ¢°¥¬¿ ®¡° ¡®²ª¨ § ¤ ­­®£® £° ´  G =
(V; E ) ¢ § ¢¨±¨¬®±²¨ ®² ·¨±«  ¥£® ¢¥°¸¨­ (jV j) ¨ °¥¡¥° (jE j); ¬»
¡³¤¥¬ ¤«¿ ª° ²ª®±²¨ ¯¨± ²¼ V ¨ E ¢¬¥±²® jV j ¨ jE j.  ¯°®£° ¬¬ µ
¬­®¦¥±²¢® ¢¥°¸¨­ £° ´ G ¬» ¡³¤¥¬ ®¡®§­ · ²¼ V [G],   ¬­®¦¥±²¢®
°¥¡¥° | E [G].

±­®¢­»¥  «£®°¨²¬» ­  £° ´ µ

459

23.1. ±­®¢­»¥  «£®°¨²¬» ­  £° ´ µ
 ½²®© £« ¢¥ ®¯¨± ­» ®±­®¢­»¥ ±¯®±®¡» ¯°¥¤±² ¢«¥­¨¿ £° ´®¢ ¨
 «£®°¨²¬» ®¡µ®¤  £° ´®¢. ¡µ®¤¿ £° ´, ¬» ¤¢¨£ ¥¬±¿ ¯® °¥¡° ¬
¨ ¯°®µ®¤¨¬ ¢±¥ ¢¥°¸¨­». °¨ ½²®¬ ­ ª ¯«¨¢ ¥²±¿ ¤®¢®«¼­® ¬­®£®
¨­´®°¬ ¶¨¨, ª®²®° ¿ ¯®«¥§­  ¤«¿ ¤ «¼­¥©¸¥© ®¡° ¡®²ª¨ £° ´ ,
² ª ·²® ®¡µ®¤ £° ´  ¢µ®¤¨² ª ª ±®±² ¢­ ¿ · ±²¼ ¢® ¬­®£¨¥  «£®°¨²¬».
 ° §¤¥«¥ 23.1 ®¡±³¦¤ ¾²±¿ ¤¢  ®±­®¢­»µ ±¯®±®¡  ¯°¥¤±² ¢«¥­¨¿ £° ´  ¢ ¯ ¬¿²¨ ª®¬¯¼¾²¥°  | ± ¯®¬®¹¼¾ ±¯¨±ª®¢ ±¬¥¦­»µ
¢¥°¸¨­ ¨ ± ¯®¬®¹¼¾ ¬ ²°¨¶» ±¬¥¦­®±²¨.  §¤¥« 23.2 ®¯¨±»¢ ¥²  «£®°¨²¬ ¯®¨±ª  ¢ ¸¨°¨­³ ¨ ±®®²¢¥²±²¢³¾¹¥¥ ½²®¬³  «£®°¨²¬³ ¤¥°¥¢®.  ° §¤¥«¥ 23.3 ° ±±¬ ²°¨¢ ¥²±¿ ¤°³£®© ¯®°¿¤®ª ®¡µ®¤  ¢¥°¸¨­ ¨ ¤®ª §»¢ ¾²±¿ ±¢®©±²¢  ±®®²¢¥²±²¢³¾¹¥£®  «£®°¨²¬ 
(­ §»¢ ¥¬®£® ¯®¨±ª®¬ ¢ £«³¡¨­³).  ° §¤¥«¥ 23.4 ¬» ¨±¯®«¼§³¥¬
° §° ¡®² ­­»¥ ¬¥²®¤» ¤«¿ °¥¸¥­¨¿ § ¤ ·¨ ® ²®¯®«®£¨·¥±ª®© ±®°²¨°®¢ª¥ ®°¨¥­²¨°®¢ ­­®£® £° ´  ¡¥§ ¶¨ª«®¢. °³£®¥ ¯°¨¬¥­¥­¨¥
¯®¨±ª  ¢ £«³¡¨­³ (®²»±ª ­¨¿ ±¨«¼­® ±¢¿§­»µ ª®¬¯®­¥­² ®°¨¥­²¨°®¢ ­­®£® £° ´ ) ®¯¨± ­® ¢ ° §¤¥«¥ 23.5.
23.1.1. °¥¤±² ¢«¥­¨¥ £° ´®¢
±²¼ ¤¢  ±² ­¤ °²­»µ ±¯®±®¡  ¯°¥¤±² ¢¨²¼ £° ´ G = (V; E )
| ª ª ­ ¡®° ±¯¨±ª®¢ ±¬¥¦­»µ ¢¥°¸¨­ ¨«¨ ª ª ¬ ²°¨¶³ ±¬¥¦­®±²¨. ¥°¢»© ®¡»·­® ¯°¥¤¯®·²¨²¥«¼­¥¥, ¨¡® ¤ ¥² ¡®«¥¥ ª®¬¯ ª²­®¥
¯°¥¤±² ¢«¥­¨¥ ¤«¿ ° §°¥¦¥­­»µ (sparse) £° ´®¢ | ²¥µ, ³ ª®²®°»µ
jE j ¬­®£® ¬¥­¼¸¥ jV j2. ®«¼¸¨­±²¢® ¨§¤ £ ¥¬»µ ­ ¬¨  «£®°¨²¬®¢
¨±¯®«¼§³¾² ¨¬¥­­® ½²® ¯°¥¤±² ¢«¥­¨¥. ¤­ ª® ¢ ­¥ª®²®°»µ ±¨²³ ¶¨¿µ ³¤®¡­¥¥ ¯®«¼§®¢ ²¼±¿ ¬ ²°¨¶¥© ±¬¥¦­®±²¨ | ­ ¯°¨¬¥°, ¤«¿
¯«®²­»µ (dense) £° ´®¢, ³ ª®²®°»µ jE j ±° ¢­¨¬® ± jV j2 .  ²°¨¶ 
±¬¥¦­®±²¨ ¯®§¢®«¿¥² ¡»±²°® ®¯°¥¤¥«¨²¼, ±®¥¤¨­¥­» «¨ ¤¢¥ ¤ ­­»¥
¢¥°¸¨­» °¥¡°®¬. ¢   «£®°¨²¬  ®²»±ª ­¨¿ ª° ²· ©¸¨µ ¯³²¥© ¤«¿
¢±¥µ ¯ ° ¢¥°¸¨­, ®¯¨± ­­»¥ ¢ £« ¢¥ 26, ¨±¯®«¼§³¾² ¯°¥¤±² ¢«¥­¨¥
£° ´  ± ¯®¬®¹¼¾ ¬ ²°¨¶» ±¬¥¦­®±²¨.
°¥¤±² ¢«¥­¨¥ £° ´  G = (V; E ) ¢ ¢¨¤¥ ±¯¨±ª®¢ ±¬¥¦­»µ ¢¥°¸¨­ (adjancency-list representation) ¨±¯®«¼§³¥² ¬ ±±¨¢ Adj ¨§ jV j
±¯¨±ª®¢ | ¯® ®¤­®¬³ ­  ¢¥°¸¨­³. «¿ ª ¦¤®© ¢¥°¸¨­» u 2 V
±¯¨±®ª ±¬¥¦­»µ ¢¥°¸¨­ Adj [u] ±®¤¥°¦¨² ¢ ¯°®¨§¢®«¼­®¬ ¯®°¿¤ª¥
(³ª § ²¥«¨ ­ ) ¢±¥ ±¬¥¦­»¥ ± ­¥© ¢¥°¸¨­» (¢±¥ ¢¥°¸¨­» v , ¤«¿
ª®²®°»µ (u; v ) 2 E ).
  °¨±. 23.1 (b) ¯®ª § ­® ¯°¥¤±² ¢«¥­¨¥ ­¥®°¨¥­²¨°®¢ ­­®£®
£° ´  °¨±. 23.1 (a) ± ¯®¬®¹¼¾ ±¯¨±ª®¢ ±¬¥¦­»µ ¢¥°¸¨­. ­ «®£¨·­®¥ ¯°¥¤±² ¢«¥­¨¥ ¤«¿ ®°¨¥­²¨°®¢ ­­®£® £° ´  °¨±. 23.2 (a)
¨§®¡° ¦¥­® ­  °¨±. 23.2 (b).

460

« ¢  23 «£®°¨²¬» ­  £° ´ µ

23.1 ¢  ¯°¥¤±² ¢«¥­¨¿ ­¥®°¨¥­²¨°®¢ ­­®£® £° ´ . (a) ¥®°¨¥­²¨°®¢ ­­»© £° ´ G ± 5 ¢¥°¸¨­ ¬¨ ¨ 7 °¥¡° ¬¨. (b) °¥¤±² ¢«¥­¨¥ ½²®£® £° ´ 
± ¯®¬®¹¼¾ ±¯¨±ª®¢ ±¬¥¦­»µ ¢¥°¸¨­. (c) °¥¤±² ¢«¥­¨¥ ½²®£® £° ´  ¢ ¢¨¤¥
¬ ²°¨¶» ±¬¥¦­®±²¨.
¨±. 23.1

23.2 ¢  ¯°¥¤±² ¢«¥­¨¿ ®°¨¥­²¨°®¢ ­­®£® £° ´ . (a) °¨¥­²¨°®¢ ­­»© £° ´ G ± 6 ¢¥°¸¨­ ¬¨ ¨ 8 °¥¡° ¬¨. (b) °¥¤±² ¢«¥­¨¥ ½²®£® £° ´ 
± ¯®¬®¹¼¾ ±¯¨±ª®¢ ±¬¥¦­»µ ¢¥°¸¨­. (c) °¥¤±² ¢«¥­¨¥ ½²®£® £° ´  ¢ ¢¨¤¥
¬ ²°¨¶» ±¬¥¦­®±²¨.
¨±. 23.2

«¿ ®°¨¥­²¨°®¢ ­­®£® £° ´  ±³¬¬  ¤«¨­ ¢±¥µ ±¯¨±ª®¢ ±¬¥¦­»µ ¢¥°¸¨­ ° ¢­  ®¡¹¥¬³ ·¨±«³ °¥¡¥°: °¥¡°³ (u; v ) ±®®²¢¥²±²¢³¥² ½«¥¬¥­² v ±¯¨±ª  Adj [u]. «¿ ­¥®°¨¥­²¨°®¢ ­­®£® £° ´  ½² 
±³¬¬  ° ¢­  ³¤¢®¥­­®¬³ ·¨±«³ °¥¡¥°, ² ª ª ª °¥¡°® (u; v ) ¯®°®¦¤ ¥² ½«¥¬¥­² ¢ ±¯¨±ª¥ ±¬¥¦­»µ ¢¥°¸¨­ ª ª ¤«¿ ¢¥°¸¨­» u,
² ª ¨ ¤«¿ v .  ®¡®¨µ ±«³· ¿µ ª®«¨·¥±²¢® ²°¥¡³¥¬®© ¯ ¬¿²¨ ¥±²¼
O(max(V; E )) = O(V + E ).
¯¨±ª¨ ±¬¥¦­»µ ¢¥°¸¨­ ³¤®¡­» ¤«¿ µ° ­¥­¨¿ £° ´®¢ ± ¢¥± ¬¨
(weighted graphs), ¢ ª®²®°»µ ª ¦¤®¬³ °¥¡°³ ¯°¨¯¨± ­ ­¥ª®²®°»©
¢¥¹¥±²¢¥­­»© ¢¥± (weight), ²® ¥±²¼ § ¤ ­  ¢¥±®¢ ¿ ´³­ª¶¨¿ (weight
function) w : E ! R.  ½²®¬ ±«³· ¥ ³¤®¡­® µ° ­¨²¼ ¢¥± w(u; v )
°¥¡°  (u; v ) 2 E ¢¬¥±²¥ ± ¢¥°¸¨­®© v ¢ ±¯¨±ª¥ ¢¥°¸¨­, ±¬¥¦­»µ
± u. ®¤®¡­»¬ ®¡° §®¬ ¬®¦­® µ° ­¨²¼ ¨ ¤°³£³¾ ¨­´®°¬ ¶¨¾,
±¢¿§ ­­³¾ ± £° ´®¬.
¥¤®±² ²®ª ½²®£® ¯°¥¤±² ¢«¥­¨¿ ² ª®¢: ¥±«¨ ¬» µ®²¨¬ ³§­ ²¼,
¥±²¼ «¨ ¢ £° ´¥ °¥¡°® ¨§ u ¢ v , ¯°¨µ®¤¨²±¿ ¯°®±¬ ²°¨¢ ²¼ ¢¥±¼ ±¯¨±®ª Adj [u] ¢ ¯®¨±ª µ v . ²®£® ¬®¦­® ¨§¡¥¦ ²¼, ¯°¥¤±² ¢¨¢ £° ´ ¢
¢¨¤¥ ¬ ²°¨¶» ±¬¥¦­®±²¨ | ­® ²®£¤  ¯®²°¥¡³¥²±¿ ¡®«¼¸¥ ¯ ¬¿²¨.
°¨ ¨±¯®«¼§®¢ ­¨¨ ¬ ²°¨¶» ±¬¥¦­®±²¨ ¬» ­³¬¥°³¥¬ ¢¥°¸¨­»
£° ´  (V; E ) ·¨±« ¬¨ 1; 2; : : : ; jV j ¨ ° ±±¬ ²°¨¢ ¥¬ ¬ ²°¨¶³ A =
(aij ) ° §¬¥°  jV j  jV j, ¤«¿ ª®²®°®©

aij =



1; ¥±«¨ (i; j ) 2 E ,
0 ¢ ¯°®²¨¢­®¬ ±«³· ¥

  °¨±. 23.1 (c) ¨ 23.2 (c) ¯®ª § ­» ¬ ²°¨¶» ±¬¥¦­®±²¨ ­¥®°¨¥­²¨°®¢ ­­®£® ¨ ®°¨¥­²¨°®¢ ­­®£® £° ´®¢ °¨±. 23.1 (a) ¨ 23.2 (a)
±®®²¢¥²±²¢¥­­®.  ²°¨¶  ±¬¥¦­®±²¨ ²°¥¡³¥² (V 2 ) ¯ ¬¿²¨ ­¥§ ¢¨±¨¬® ®² ª®«¨·¥±²¢  °¥¡¥° ¢ £° ´¥.
«¿ ­¥®°¨¥­²¨°®¢ ­­®£® £° ´  ¬ ²°¨¶  ±¬¥¦­®±²¨ ±¨¬¬¥²°¨·­  ®²­®±¨²¥«¼­® £« ¢­®© ¤¨ £®­ «¨ (ª ª ­  °¨±. 3.1(c)), ¯®±ª®«¼ª³
(u; v ) ¨ (v; u) | ½²® ®¤­® ¨ ²® ¦¥ °¥¡°®. °³£¨¬¨ ±«®¢ ¬¨, ¬ ²°¨¶  ±¬¥¦­®±²¨ ­¥®°¨¥­²¨°®¢ ­­®£® £° ´  ±®¢¯ ¤ ¥² ±® ±¢®¥©
²° ­±¯®­¨°®¢ ­­®© (transpose). (° ­±¯®­¨°®¢ ­¨¥¬ ­ §»¢ ¥²±¿
¯¥°¥µ®¤ ®² ¬ ²°¨¶» A = (aij ) ª ¬ ²°¨¶¥ AT = (aTij ), ¤«¿ ª®²®°®© aTij = aji . « £®¤ °¿ ±¨¬¬¥²°¨¨ ¤®±² ²®·­® µ° ­¨²¼ ²®«¼ª®

±­®¢­»¥  «£®°¨²¬» ­  £° ´ µ

461

·¨±«  ­  £« ¢­®© ¤¨ £®­ «¨ ¨ ¢»¸¥ ­¥¥, ²¥¬ ± ¬»¬ ¬» ±®ª° ¹ ¥¬
²°¥¡³¥¬³¾ ¯ ¬¿²¼ ¯®·²¨ ¢¤¢®¥.
 ª ¨ ¤«¿ ±¯¨±ª®¢ ±¬¥¦­»µ ¢¥°¸¨­, µ° ­¥­¨¥ ¢¥±®¢ ­¥ ±®±² ¢«¿¥² ¯°®¡«¥¬»: ¢¥± w(u; v ) °¥¡°  (u; v ) ¬®¦­® µ° ­¨²¼ ¢ ¬ ²°¨¶¥
­  ¯¥°¥±¥·¥­¨¨ u-²®© ±²°®ª¨ ¨ v -£® ±²®«¡¶ . «¿ ®²±³²±²¢³¾¹¨µ
°¥¡¥° ¬®¦­® § ¯¨± ²¼ ±¯¥¶¨ «¼­®¥ §­ ·¥­¨¥ NIL (¢ ­¥ª®²®°»µ § ¤ · µ ¢¬¥±²® ½²®£® ¯¨¸³² 0 ¨«¨ 1).
«¿ ­¥¡®«¼¸¨µ £° ´®¢, ª®£¤  ¬¥±²  ¢ ¯ ¬¿²¨ ¤®±² ²®·­®, ¬ ²°¨¶  ±¬¥¦­®±²¨ ¡»¢ ¥² ³¤®¡­¥¥ | ± ­¥© · ±²® ¯°®¹¥ ° ¡®² ²¼.
°®¬¥ ²®£®, ¥±«¨ ­¥ ­ ¤® µ° ­¨²¼ ¢¥± , ²® ½«¥¬¥­²» ¬¥²°¨¶»
±¬¥¦­®±²¨ ¯°¥¤±² ¢«¿¾² ±®¡®© ¡¨²», ¨ ¨µ ¬®¦­® ° §¬¥¹ ²¼ ¯®
­¥±ª®«¼ª³ ¢ ®¤­®¬ ¬ ¸¨­­®¬ ±«®¢¥, ·²® ¤ ¥² § ¬¥²­³¾ ½ª®­®¬¨¾
¯ ¬¿²¨.
¯° ¦­¥­¨¿
23.1-1
° ´ µ° ­¨²±¿ ¢ ¢¨¤¥ ±¯¨±ª®¢ ±¬¥¦­®±²¨. ª®«¼ª® ®¯¥° ¶¨©
­³¦­®, ·²®¡» ­ ©²¨ ·¨±«® ¢»µ®¤¿¹¨µ ¨§ ¤ ­­®© ¢¥°¸¨­» °¥¡¥°?
·¨±«® ¢µ®¤¿¹¨µ ¢ ¤ ­­³¾ ¢¥°¸¨­³ °¥¡¥°?
23.1-2
ª ¦¨²¥ ¯°¥¤±² ¢«¥­¨¥ ¢ ¢¨¤¥ ±¯¨±ª®¢ ±¬¥¦­®±²¨ ¨ ¬ ²°¨¶³
±¬¥¦­®±²¨ ¤«¿ £° ´ , ¿¢«¿¾¹¥£®±¿ ¯®«­»¬ ¤¢®¨·­»¬ ¤¥°¥¢®¬ ±
7 ¢¥°¸¨­ ¬¨ (¯°®­³¬¥°®¢ ­­»¬¨ ®² 1 ¤® 7 ª ª ¯°¨ ±®°²¨°®¢ª¥ ±
¯®¬®¹¼¾ ª³·¨ ¢ £« ¢¥ 7).
23.1-3
²® ¯°®¨§®©¤¥² ± ¬ ²°¨¶¥© ±¬¥¦­®±²¨ ®°¨¥­²¨°®¢ ­­®£® £° ´ , ¥±«¨ ®¡° ²¨²¼ ­ ¯° ¢«¥­¨¿ ±²°¥«®ª ­  ¢±¥µ ¥£® °¥¡° µ, § ¬¥­¨¢ ª ¦¤®¥ °¥¡°® (u; v ) ­  °¥¡°® (v; u)?  ª ®¡° ²¨²¼ ­ ¯° «¥­¨¿
±²°¥«®ª, ¥±«¨ £° ´ µ° ­¨²±¿ ¢ ´®°¬¥ ±¯¨±ª®¢ ±¬¥¦­®±²¨? ¶¥­¨²¥
²°¥¡³¥¬®¥ ¤«¿ ½²®£® ·¨±«® ®¯¥° ¶¨©.
23.1-4
³«¼²¨£° ´ G = (V; E ) ¯°¥¤±² ¢«¥­ ¢ ¢¨¤¥ ±¯¨±ª®¢ ±¬¥¦­»µ
¢¥°¸¨­.  ª §  ¢°¥¬¿ O(V + E ) ¯°¥®¡° §®¢ ²¼ ¥£® ¢ ®¡»·­»© ­¥®°¨¥­²¨°®¢ ­­»© £° ´ G0 = (V; E 0), § ¬¥­¨¢ ª° ²­»¥ °¥¡°  ­ 
®¡»·­»¥ ¨ ³¤ «¨¢ °¥¡° -¶¨ª«»?
23.1-5
¢ ¤° ²®¬ (square) ®°¨¥­²¨°®¢ ­­®£® £° ´  G = (V; E ) ­ §»¢ ¥²±¿ £° ´ G2 = (V; E 2), ¯®±²°®¥­­»© ² ª: (u; w) 2 E 2, ¥±«¨ ±³¹¥±²¢³¥² ¢¥°¸¨­  v 2 V , ¤«¿ ª®²®°®© (u; v ) 2 E ¨ (v; w) 2 E (¤¢¥ ¢¥°¸¨­» ±®¥¤¨­¿¾²±¿ °¥¡°®¬, ¥±«¨ ° ­¼¸¥ ¡»« ¯³²¼ ¨§ ¤¢³µ °¥¡¥°).
 ª ¯°¥®¡° §®¢ ²¼ G ¢ G2 , ¥±«¨ £° ´ µ° ­¨²±¿ ¢ ¢¨¤¥ ±¯¨±ª®¢
±¬¥¦­»µ ¢¥°¸¨­? ª ª ¬ ²°¨¶  ±¬¥¦­®±²¨? ¶¥­¨²¥ ¢°¥¬¿ ° ¡®²» ¢ ¸¨µ  «£®°¨²¬®¢.
23.1-6
®·²¨ «¾¡®©  «£®°¨²¬, ¨±¯®«¼§³¾¹¨© ¬ ²°¨¶» ±¬¥¦­®±²¨, ²°¥¡³¥² ¢°¥¬¥­¨ (V 2 ) (¯°®±²® ­  ·²¥­¨¥ ½²®© ¬ ²°¨¶»), ­® ¡»¢ ¾²
¨ ¨±ª«¾·¥­¨¿. ®ª ¦¨²¥, ·²® §  ¢°¥¬¿ O(V ) ¯® ¬ ²°¨¶¥ ±¬¥¦­®-

462

« ¢  23 «£®°¨²¬» ­  £° ´ µ

±²¨ ¬®¦­® ¢»¿±­¨²¼, ±®¤¥°¦¨² «¨ ®°¨¥­²¨°®¢ ­­»© £° ´ À±²®ªÁ
(sink) | ¢¥°¸¨­³, ¢ ª®²®°³¾ ¢¥¤³² °¥¡°  ¨§ ¢±¥µ ¤°³£¨µ ¢¥°¸¨­ ¨
¨§ ª®²®°®© ­¥ ¢»µ®¤¨² ­¨ ®¤­®£® °¥¡° .
23.1-7
 §®¢¥¬ ¬ ²°¨¶¥© ¨­¶¨¤¥­²­®±²¨ (incidence matrix) ®°¨¥­²¨°®¢ ­­®£® £° ´  G = (E; V ) ¬ ²°¨¶³ B = (bij ) ° §¬¥°  jV j  jE j,
¢ ª®²®°®©
8
>
<

;1; ¥±«¨ °¥¡°® j ¢»µ®¤¨² ¨§ ¢¥°¸¨­» i,
bij = > 1; ¥±«¨ °¥¡°® j ¢µ®¤¨² ¢ ¢¥°¸¨­³ i,
:

0 ¢ ®±² «¼­»µ ±«³· ¿µ.

 ª®¢ ±¬»±« ½«¥¬¥­²®¢ ¬ ²°¨¶» BB T ? (¤¥±¼ B T | ²° ­±¯®­¨°®¢ ­­ ¿ ¬ ²°¨¶ .)
23.1.2. ®¨±ª ¢ ¸¨°¨­³
®¨±ª ¢ ¸¨°¨­³ (breadth-rst search) | ®¤¨­ ¨§ ¡ §¨±­»µ  «£®°¨²¬®¢, ±®±² ¢«¿¾¹¨© ®±­®¢³ ¬­®£¨µ ¤°³£¨µ.  ¯°¨¬¥°,  «£®°¨²¬
¥©ª±²°» ¯®¨±ª  ª° ²· ©¸¨µ ¯³²¥© ¨§ ®¤­®© ¢¥°¸¨­» (£« ¢  25) ¨
 «£®°¨²¬ °¨¬  ¯®¨±ª  ¬¨­¨¬ «¼­®£® ¯®ª°»¢ ¾¹¥£® ¤¥°¥¢  (° §¤¥« 24.2) ¬®£³² ° ±±¬ ²°¨¢ ²¼±¿ ª ª ®¡®¡¹¥­¨¿ ¯®¨±ª  ¢ ¸¨°¨­³.
³±²¼ § ¤ ­ £° ´ G = (V; E ) ¨ ´¨ª±¨°®¢ ­  ­ · «¼­ ¿ ¢¥°¸¨­ 
(source vertex) s. «£®°¨²¬ ¯®¨±ª  ¢ ¸¨°¨­³ ¯¥°¥·¨±«¨¥² ¢±¥ ¤®±²¨¦¨¬»¥ ¨§ s (¥±«¨ ¨¤²¨ ¯® °¥¡° ¬) ¢¥°¸¨­» ¢ ¯®°¿¤ª¥ ¢®§° ±² ­¨¿ ° ±±²®¿­¨¿ ®² s.  ±±²®¿­¨¥¬ ±·¨² ¥²±¿ ¤«¨­  ¬¨­¨¬ «¼­®£®
¯³²¨ ¨§ ­ · «¼­®© ¢¥°¸¨­».  ¯°®¶¥±±¥ ¯®¨±ª  ¨§ £° ´  ¢»¤¥«¿¥²±¿ · ±²¼, ­ §»¢ ¥¬ ¿ À¤¥°¥¢®¬ ¯®¨±ª  ¢ ¸¨°¨­³Á ± ª®°­¥¬ s. ­ 
±®¤¥°¦¨² ¢±¥ ¤®±²¨¦¨¬»¥ ¨§ s ¢¥°¸¨­» (¨ ²®«¼ª® ¨µ). «¿ ª ¦¤®©
¨§ ­¨µ ¯³²¼ ¨§ ª®°­¿ ¢ ¤¥°¥¢¥ ¯®¨±ª  ¡³¤¥² ®¤­¨¬ ¨§ ª° ²· ©¸¨µ
¯³²¥© (¨§ ­ · «¼­®© ¢¥°¸¨­») ¢ £° ´¥. «£®°¨²¬ ¯°¨¬¥­¨¬ ¨ ª
®°¨¥­²¨°®¢ ­­»¬, ¨ ª ­¥®°¨¥­²¨°®¢ ­­»¬ £° ´ ¬.
 §¢ ­¨¥ ®¡º¿±­¿¥²±¿ ²¥¬, ·²® ¢ ¯°®¶¥±±¥ ¯®¨±ª  ¬» ¨¤¥¬
¢¸¨°¼,   ­¥ ¢£«³¡¼ (±­ · «  ¯°®±¬ ²°¨¢ ¥¬ ¢±¥ ±®±¥¤­¨¥ ¢¥°¸¨­», § ²¥¬ ±®±¥¤¥© ±®±¥¤¥© ¨ ².¤.).
«¿ ­ £«¿¤­®±²¨ ¬» ¡³¤¥¬ ±·¨² ²¼, ·²® ¢ ¯°®¶¥±±¥ ° ¡®²»  «£®°¨²¬  ¢¥°¸¨­» £° ´  ¬®£³² ¡»²¼ ¡¥«»¬¨, ±¥°»¬¨ ¨ ·¥°­»¬¨.
­ · «¥ ®­¨ ¢±¥ ¡¥«»¥, ­® ¢ µ®¤¥ ° ¡®²»  «£®°¨²¬  ¡¥« ¿ ¢¥°¸¨­ 
¬®¦¥² ±² ²¼ ±¥°®©,   ±¥° ¿ | ·¥°­®© (­® ­¥ ­ ®¡®°®²). ®¢±²°¥· ¢ ­®¢³¾ ¢¥°¸¨­³,  «£®°¨²¬ ¯®¨±ª  ª° ±¨² ¥¥, ² ª ·²® ®ª° ¸¥­­»¥ (±¥°»¥ ¨«¨ ·¥°­»¥) ¢¥°¸¨­» | ½²® ¢ ²®·­®±²¨ ²¥, ª®²®°»¥
³¦¥ ®¡­ °³¦¥­».  §«¨·¨¥ ¬¥¦¤³ ±¥°»¬¨ ¨ ·¥°­»¬¨ ¢¥°¸¨­ ¬¨
¨±¯®«¼§³¥²±¿  «£®°¨²¬®¬ ¤«¿ ³¯° ¢«¥­¨¿ ¯®°¿¤ª®¬ ®¡µ®¤ : ±¥°»¥
¢¥°¸¨­» ®¡° §³¾² À«¨­¨¾ ´°®­² Á,   ·¥°­»¥ | À²»«Á. ®«¥¥ ²®·­®, ¯®¤¤¥°¦¨¢ ¥²±¿ ² ª®¥ ±¢®©±²¢®: ¥±«¨ (u; v ) 2 E ¨ u ·¥°­ ¿,

±­®¢­»¥  «£®°¨²¬» ­  £° ´ µ

463

²® v | ±¥° ¿ ¨«¨ ·¥°­ ¿ ¢¥°¸¨­ .  ª¨¬ ®¡° §®¬, ²®«¼ª® ±¥°»¥
¢¥°¸¨­» ¬®£³² ¨¬¥²¼ ±¬¥¦­»¥ ­¥®¡­ °³¦¥­­»¥ ¢¥°¸¨­».
­ · «¥ ¤¥°¥¢® ¯®¨±ª  ±®±²®¨² ²®«¼ª® ¨§ ª®°­¿ | ­ · «¼­®©
¢¥°¸¨­» s.  ª ²®«¼ª®  «£®°¨²¬ ®¡­ °³¦¨¢ ¥² ­®¢³¾ ¡¥«³¾ ¢¥°¸¨­³ v , ±¬¥¦­³¾ c ° ­¥¥ ­ ©¤¥­­®© ¢¥°¸¨­®© u, ¢¥°¸¨­  v (¢¬¥±²¥
± °¥¡°®¬ (u; v )) ¤®¡ ¢«¿¥²±¿ ª ¤¥°¥¢³ ¯®¨±ª , ±² ­®¢¿±¼ °¥¡¥­ª®¬
(child) ¢¥°¸¨­» u,   u ±² ­®¢¨²±¿ °®¤¨²¥«¥¬ (parent) v .  ¦¤ ¿
¢¥°¸¨­  ®¡­ °³¦¨¢ ¥²±¿ ²®«¼ª® ®¤­ ¦¤», ² ª ·²® ¤¢³µ °®¤¨²¥«¥© ³ ­¥¥ ¡»²¼ ­¥ ¬®¦¥². ®­¿²¨¿ ¯°¥¤ª  (ancestor) ¨ ¯®²®¬ª 
(descendant) ®¯°¥¤¥«¿¾²±¿ ª ª ®¡»·­® (¯®²®¬ª¨ | ½²® ¤¥²¨, ¤¥²¨
¤¥²¥©, ¨ ².¤.). ¢¨£ ¿±¼ ®² ¢¥°¸¨­» ª ª®°­¾, ¬» ¯°®µ®¤¨¬ ¢±¥µ ¥¥
¯°¥¤ª®¢.
°¨¢¥¤¥­­ ¿ ­¨¦¥ ¯°®¶¥¤³°  BFS (breadth-rst search | ¯®¨±ª
¢ ¸¨°¨­³) ¨±¯®«¼§³¥² ¯°¥¤±² ¢«¥­¨¥ £° ´  G = (V; E ) ±¯¨±ª ¬¨
±¬¥¦­»µ ¢¥°¸¨­. «¿ ª ¦¤®© ¢¥°¸¨­» u £° ´  ¤®¯®«­¨²¥«¼­®
µ° ­¿²±¿ ¥¥ ¶¢¥² color[u] ¨ ¥¥ ¯°¥¤¸¥±²¢¥­­¨ª  [u]. ±«¨ ¯°¥¤¸¥±²¢¥­­¨ª  ­¥² (­ ¯°¨¬¥°, ¥±«¨ u = s ¨«¨ u ¥¹¥ ­¥ ®¡­ °³¦¥­ ),
[u] = nil. °®¬¥ ²®£®, ° ±±²®¿­¨¥ ®² s ¤® u § ¯¨±»¢ ¥²±¿ ¢ ¬ ±±¨¢
d[u]. °®¶¥¤³°  ¨±¯®«¼§³¥² ² ª¦¥ ®·¥°¥¤¼ Q (FIFO, ° §¤¥« 11.1)
¤«¿ µ° ­¥­¨¿ ¬­®¦¥±²¢  ±¥°»µ ¢¥°¸¨­.
BFS$(G,s)$
1 for (¤«¿) ¢±¥µ ¢¥°¸¨­ $u\in V[G]-\{s\}$
2
do $color[u] \leftarrow$ 
3
$d[u] \leftarrow \infty$
4
$\pi [u] \leftarrow$ NIL
5 $color[s] \leftarrow$ 
6 $d[s] \leftarrow 0$
7 $\pi [s] \leftarrow$ NILL
8 $Q\leftarrow \{s\}$
9 while $Q\ne \emptyset$
10 do $u\leftarrow head[Q]$
11
for (¤«¿) ¢±¥µ $v\in Adj[u]$
12
do if $color[v]=$ 
13
then $color[v]\leftarrow$ 
14
$d[v]\leftarrow d[u]+1$
15
$\pi[v]\leftarrow u$
16
Enqueue($Q,v$)
17
Dequeue($Q$)
18
$color[u]\leftarrow$ 
  °¨±.~23.3 ¯°¨¢¥¤\"^^a5­ ¯°¨¬¥° ¨±¯®«­¥­¨¿ ¯°®¶¥¤³°»
\textsc{BFS}.

464

« ¢  23 «£®°¨²¬» ­  £° ´ µ
\begin{figure}
\caption{
23.3
±¯®«­¥­¨¥ ¯°®¶¥¤³°» \textsc{BFS} ¤«¿ ­¥®°¨¥­²¨°®¢ ­­®£®
£° ´ . \"^^a5¡°  ´®°¬¨°³¥¬®£® ¤¥°¥¢  ¯®ª § ­» ±¥°»¬¨.
­³²°¨ ª ¦¤®© ¢¥°¸¨­» $u$ ³ª § ­® §­ ·¥­¨¥ $d[u]$.
®ª § ­® ±®±²®¿­¨¥ ®·¥°¥¤¨ $Q$ ¯¥°¥¤ ª ¦¤»¬ ¯®¢²®°¥­¨¥¬
¶¨ª«  ¢ ±²°®ª µ 9--18. ¿¤®¬ ± ½«¥¬¥­² ¬¨ ®·¥°¥¤¨ ¯®ª § ­» ° ±±²®¿­¨¿
®² ª®°­¿.
}
\end{figure}
 ±²°®ª µ 1--4 ¢±¥ ¢¥°¸¨­» ±² ­®¢¿²±¿ ¡¥«»¬¨, ¢±¥ §­ ·¥­¨¿ $d$
¡¥±ª®­¥·­»¬¨, ¨ °®¤¨²¥«¥¬ ¢±¥µ ¢¥°¸¨­ ®¡º¿¢«¿¥²±¿ \textsc{nil}.
²°®ª¨ 5--8 ª° ±¿² ¢¥°¸¨­³ $s$ ¢ ±¥°»© ¶¢¥² ¨ ¢»¯®«­¿¾²
±¢¿§ ­­»¥ ± ½²¨¬ ¤¥©±²¢¨¿: ¢ ±²°®ª¥ 6 ° ±±²®¿­¨¥ $d[s]$
®¡º¿¢«¿¥²±¿ ° ¢­»¬ $0$,   ¢ ±²°®ª¥ $7$ £®¢®°¨²±¿, ·²® °®¤¨²¥«¿ ³
$s$ ­¥².  ª®­¥¶, ¢ ±²°®ª¥ $8$ ¢¥°¸¨­  $s$ ¯®¬¥¹ ¥²±¿ ¢ ®·¥°¥¤¼
$Q$, ¨ ± ½²®£® ¬®¬¥­²  ®·¥°¥¤¼ ¡³¤¥² ±®¤¥°¦ ²¼ ¢±¥ ±¥°»¥ ¢¥°¸¨­»
¨ ²®«¼ª® ¨µ.
±­®¢­®© ¶¨ª« ¯°®£° ¬¬» (±²°®ª¨ 9--18) ¢»¯®«­¿¥²±¿, ¯®ª  ®·¥°¥¤¼
­¥¯³±² , ²® ¥±²¼ ±³¹¥±²¢³¾² ±¥°»¥ ¢¥°¸¨­» (¢¥°¸¨­», ª®²®°»¥ ³¦¥
®¡­ °³¦¥­», ­® ±¯¨±ª¨ ±¬¥¦­®±²¨ ª®²®°»µ ¥¹¥ ­¥ ¯°®±¬®²°¥­»). 
±²°®ª¥ 10 ¯¥°¢ ¿ ² ª ¿ ¢¥°¸¨­  ¯®¬¥¹ ¥²±¿ ¢ $u$. ¨ª«
\textbf{for} ¢ ±²°®ª µ 11--16 ¯°®±¬ ²°¨¢ ¥² ¢±¥ ±¬¥¦­»¥ ± ­¥©
¢¥°¸¨­». ¡­ °³¦¨¢ ±°¥¤¨ ­¨µ ¡¥«³¾ ¢¥°¸¨­³, ¬» ¤¥« ¥¬ ¥\"^^a5 ±¥°®©
(±²°®ª  13), ®¡º¿¢«¿¥¬ $u$ ¥\"^^a5 °®¤¨²¥«¥¬ (±²°®ª  15) ¨
³±² ­ ¢«¨¢ ¥¬ ° ±±²®¿­¨¥ ° ¢­»¬ $d[u]+1$ (±²°®ª  14).  ª®­¥¶,
½²  ¢¥°¸¨­  ¤®¡ ¢«¿¥²±¿ ¢ µ¢®±² ®·¥°¥¤¨ $Q$ (±²°®ª  16). ®±«¥
½²®£® ³¦¥ ¬®¦­® ³¤ «¨²¼ ¢¥°¸¨­³ $u$ ¨§ ®·¥°¥¤¨ $Q$, ¯¥°¥ª° ±¨¢
½²³ ¢¥°¸¨­³ ¢ ·\"^^a5°­»© ¶¢¥² (±²°®ª¨ 17--18).
­ «¨§
 ·­\"^^a5¬ ± ¡®«¥¥ ¯°®±²®£® --- ®¶¥­¨¬ ¢°¥¬¿ ° ¡®²» ®¯¨± ­­®©
¯°®¶¥¤³°».  ¯°®¶¥±±¥ ° ¡®²» ¢¥°¸¨­» ²®«¼ª® ²¥¬­¥¾², ² ª ·²®
ª ¦¤ ¿ ¢¥°¸¨­  ª« ¤\"^^a5²±¿ ¢ ®·¥°¥¤¼ ­¥ ¡®«¥¥ ®¤­®£® ° § 
(¡« £®¤ °¿ ¯°®¢¥°ª¥ ¢ ±²°®ª¥ 12). «¥¤®¢ ²¥«¼­®, ¨ ¢»­³²¼ ¥\"^^a5
¬®¦­® ²®«¼ª® ®¤¨­ ° §.  ¦¤ ¿ ®¯¥° ¶¨¿ ± ®·¥°¥¤¼¾ ²°¥¡³¥² $O(1)$
¸ £®¢, ² ª ·²® ¢±¥£® ­  ®¯¥° ¶¨¨ ± ®·¥°¥¤¼¾ ³µ®¤¨² ¢°¥¬¿ $O(V)$.
¥¯¥°¼ § ¬¥²¨¬, ·²® ±¯¨±®ª ±¬¥¦­»µ ¢¥°¸¨­ ¯°®±¬ ²°¨¢ ¥²±¿, «¨¸¼
ª®£¤  ¢¥°¸¨­  ¨§¢«¥ª ¥²±¿ ¨§ ®·¥°¥¤¨, ²® ¥±²¼ ­¥ ¡®«¥¥ ®¤­®£®
° § . ³¬¬  ¤«¨­ ¢±¥µ ½²¨µ ±¯¨±ª®¢ ° ¢­  $|E|$, ¨ ¢±¥£® ­  ¨µ
®¡° ¡®²ª³ ³©¤¥² ¢°¥¬¿ $O(E)$. ­¨¶¨ «¨§ ¶¨¿ ²°¥¡³¥² $O(V)$
¸ £®¢, ² ª ·²® ¢±¥£® ¯®«³· ¥²±¿ $O(V+E)$. ¥¬ ± ¬»¬ ¢°¥¬¿ ° ¡®²»

±­®¢­»¥  «£®°¨²¬» ­  £° ´ µ

465

¯°®¶¥¤³°» \textsc{BFS} ¯°®¯®°¶¨®­ «¼­® ° §¬¥°³ ¯°¥¤±² ¢«¥­¨¿
£° ´  $G$ ¢ ¢¨¤¥ ±¯¨±ª®¢ ±¬¥¦­»µ ¢¥°¸¨­.
° ²· ©¸¨¥ ¯³²¨.
 ª ¬» £®¢®°¨«¨, ¯®¨±ª ¢ ¸¨°¨­³ ­ µ®¤¨² ° ±±²®¿­¨¿ ®² ­ · «¼­®©
¢¥°¸¨­» $s$ ¤® ª ¦¤®© ¨§ ¤®±²¨¦¨¬»µ ¢¥°¸¨­ £° ´  $G=(V,E)$. ®¤
° ±±²®¿­¨¥¬ ¬» ¯®­¨¬ ¥¬ \emph{¤«¨­³ ª° ²· ©¸¥£® ¯³²¨}
(shortest-path distance): $\delta (s,v)$ ®¯°¥¤¥«¿¥²±¿ ª ª
¬¨­¨¬ «¼­ ¿ ¤«¨­  ¯³²¨, ¢¥¤³¹¥£® ¨§ $s$ ¢ $v$. («¨­  ¯³²¨ --½²® ·¨±«® °\"^^a5¡¥° ¢ ­\"^^a5¬.) ±«¨ ¯³²¥© ­¥² ¢®®¡¹¥, ° ±±²®¿­¨¥
¡¥±ª®­¥·­®. ³²¨ ¤«¨­» $\delta (s,v)$ ¨§ $s$ ¢ $v$ ­ §»¢ ¾²±¿
\emph{ª° ²· ©¸¨¬¨ ¯³²¿¬¨}; ¨µ ¬®¦¥² ¡»²¼ ­¥±ª®«¼ª®. ( £« ¢ µ 25
¨ 26 ¬» ° ±±¬®²°¨¬ ¡®«¥¥ ®¡¹¥¥ ¯®­¿²¨¥ ª° ²· ©¸¥£® ¯³²¨,
³·¨²»¢ ¾¹¥¥ ¢¥±  °\"^^a5¡¥°: ¤«¨­  ¯³²¨ ¥±²¼ ±³¬¬  ¢¥±®¢. ¥©· ± ¢±¥
¢¥±  ° ¢­» ¥¤¨­¨¶¥, ² ª ·²® ¤«¨­  ¥±²¼ ·¨±«® °\"^^a5¡¥°.)
®ª ¦¥¬ ­¥±ª®«¼ª® ±¢®©±²¢ ®¯°¥¤¥«\"^^a5­­®£® ² ª¨¬ ±¯®±®¡®¬
° ±±²®¿­¨¿.
¥¬¬  23.1
³±²¼ $s$ --- ¯°®¨§¢®«¼­ ¿ ¢¥°¸¨­  £° ´  (®°¨¥­²¨°®¢ ­­®£® ¨«¨
­¥²),   $(u,v)$ --- ¥£® °¥¡°®. ®£¤  $$ \delta (s,v)\le \delta
(s,u)+1.$$
®ª § ²¥«¼±²¢®.
±«¨ $u$ ¤®±²¨¦¨¬  §  $k$ ¸ £®¢ ¨§ $s$, ²® ¨ $v$ ¤®±²¨¦¨¬  ­¥
¡®«¥¥ ·¥¬ §  $k+1$ ¸ £®¢ (¯°®©¤\"^^a5¬ ¯® °¥¡°³ $(u,v)$), ¯®½²®¬³
­¥° ¢¥­±²¢® ¢»¯®«­¥­®. ±«¨ ¦¥ $u$ ­¥¤®±²¨¦¨¬  ¨§ $s$, ²®
$\delta (s,u)=\infty$ ¨ ­¥° ¢¥­±²¢® ²°¨¢¨ «¼­®.
% ª®­¥¶ ¤®ª § ²¥«¼±²¢ 
%
%
%
%

¤ «¥¥ ²¥ª±² ¯¥°¥¯¨± ­, ¨ ¤ ¦¥ ´®°¬³«¨°®¢ª¨ «¥¬¬ ¨§¬¥­¥­»
(± ±®µ° ­¥­¨¥¬ ¨§ ®¡¹¥£® ·¨±«  ¤«¿ ¯®±«¥¤³¾¹¥© ­³¬¥° ¶¨¨
- ­¥¢®§¬®¦­® ¡»«® ®±² ¢«¿²¼ ² ª®¥ ¤«¨­­®¥ ¨ § ¯³² ­­®¥
° ±±³¦¤¥­¨¥ ¯® ² ª®¬³ ¯°®±²®¬³ ¯®¢®¤³...

¥¬¬  23.2
±«¨ $\delta($s$,$v$)>0$, ²® ±³¹¥±²¢³¥² ¢¥°¸¨­  $u$, ¤® ª®²®°®©
° ±±²®¿­¨¥ ­  ¥¤¨­¨¶³ ¬¥­¼¸¥ ($\delta(s,v)=\delta(s,u)+1$) ¨ ¤«¿
ª®²®°®© $v$ ¿¢«¿¥²±¿ ±¬¥¦­®© ¢¥°¸¨­®©.

466

« ¢  23 «£®°¨²¬» ­  £° ´ µ
®ª § ²¥«¼±²¢®.  ±±¬®²°¨¬ ª° ²· ©¸¨© ¯³²¼ ¨§ $s$ ¢ $v$. ­
¡³¤¥² ¨¬¥²¼ ¤«¨­³ $\delta(s,v)$. ®§¼¬\"^^a5¬ ¢¥°¸¨­³ $u$, «¥¦ ¹³¾ ­ 
½²®¬ ¯³²¨ ­¥¯®±°¥¤±²¢¥­­® ¯¥°¥¤ $v$.  ¬ ­ ¤® ³¡¥¤¨²¼±¿, ·²® ¤®
­¥\"^^a5 ° ±±²®¿­¨¥ ­  ¥¤¨­¨¶³ ¬¥­¼¸¥.  ± ¬®¬ ¤¥«¥, ³ ­ ± ¥±²¼
¢¥¤³¹¨© ¢ ­¥\"^^a5 ¯³²¼ ¤«¨­» $\delta(s,v)-1$ (®²¡°®±¨¬ ¯®±«¥¤­¥¥
°¥¡°®),   ¡®«¥¥ ª®°®²ª®£® ¯³²¨ ¡»²¼ ­¥ ¬®¦¥² ¯® ¯°¥¤»¤³¹¥©
«¥¬¬¥.
% ª®­¥¶ ¤®ª § ²¥«¼±²¢ 
 ³±«®¢¨¿µ «¥¬¬» ¤«¿ ­ µ®¦¤¥­¨¿ ª° ²· ©¸¥£® ¯³²¨ ¨§ $s$ ¢ $v$
¤®±² ²®·­® ­ ©²¨ ª° ²· ©¸¨© ¯³²¼ ¨§ $s$ ¢ $u$ ¨ ¤®¡ ¢¨²¼ ª ­¥¬³
°¥¡°® $(u,v)$.
\medskip
¥¯¥°¼ ¬» ¬®¦¥¬ ¤®ª § ²¼, ·²® ¯®¨±ª ¢ ¸¨°¨­³ ¯° ¢¨«¼­® ¢»·¨±«¿¥²
¤«¨­» ª° ²· ©¸¨µ ¯³²¥©.
 ¡®²  ¯°®¶¥¤³°» \textsc{BFS} ¤¥«¨²±¿ ­  ­ · «¼­»© ½² ¯
(±²°®ª¨ 1--8) ¨ ¯®¢²®°¥­¨¿ ¶¨ª«  ¢ ±²°®ª µ 9--18.  ± ¡³¤¥²
¨­²¥°¥±®¢ ²¼ ±®±²®¿­¨¥ ¯¥°¥¬¥­­»µ ¯®±«¥ ­¥±ª®«¼ª¨µ ² ª¨µ
¯®¢²®°¥­¨©.
¥¬¬  23.3
«¿ ¢±¿ª®£® ¶¥«®£® ­¥®²°¨¶ ²¥«¼­®£® $k$ ±³¹¥±²¢³¥² ¬®¬¥­²
¯®±«¥ ­¥±ª®«¼ª¨µ ¯®¢²®°¥­¨© ²¥«  ¶¨ª«  (±²°®ª¨ 10--18),
ª®£¤  ¢»¯®«­¥­» ±«¥¤³¾¹¨¥ ³²¢¥°¦¤¥­¨¿:
\begin{itemize}
\item
¢¥°¸¨­», ¤«¿ ª®²®°»µ ° ±±²®¿­¨¥ ®² ­ · «¼­®© ¬¥­¼¸¥ $k$ --- ·\"^^a5°­»¥,
° ¢­® $k$ --- ±¥°»¥, ¡®«¼¸¥ $k$ --- ¡¥«»¥;
\item
¢ ®·¥°¥¤¨ $Q$ ­ µ®¤¿²±¿ ±¥°»¥ ¢¥°¸¨­» ¨ ²®«¼ª® ®­¨;
\item
¢ ¬ ±±¨¢¥ $d$ µ° ­¿²±¿ ¯° ¢¨«¼­»¥ §­ ·¥­¨¿ ° ±±²®¿­¨¿ ®² ­ · «¼­®©
¢¥°¸¨­» ¤«¿ ·\"^^a5°­»µ ¨ ±¥°»µ ¢¥°¸¨­, ¨ ¡¥±ª®­¥·­»¥ §­ ·¥­¨¿ ¤«¿
¡¥«»µ;
\item
¥±«¨ $v$ --- ±¥° ¿ ¨«¨ ·\"^^a5°­ ¿ ¢¥°¸¨­ , ²®
$\delta(s,\pi(v))=\delta(s,v)-1$ ¨ ¢ £° ´¥ ¥±²¼ °¥¡°®
$(v,\pi[v])$; ¤«¿ ¡¥«»µ ¢¥°¸¨­ §­ ·¥­¨¥ $\pi$ ¥±²¼ \textsc{nil}.
\end{itemize}

±­®¢­»¥  «£®°¨²¬» ­  £° ´ µ

467

®ª § ²¥«¼±²¢®.
­¤³ª¶¨¿ ¯® $k$.
®±«¥ ¢»¯®«­¥­¨¿ ±²°®ª 1--8 ¢±¥ ¯³­ª²» «¥¬¬» ¢»¯®«­¥­» ¤«¿
$k=0$: ­  ° ±±²®¿­¨¨ $k$ ­ µ®¤¨²±¿ ¥¤¨­±²¢¥­­ ¿ ¢¥°¸¨­ 
(­ · «¼­ ¿), ®­  ±¥° ¿, ®±² «¼­»¥ ¡¥«»¥, ±¥° ¿ ¢¥°¸¨­  «¥¦¨² ¢
®·¥°¥¤¨, ¤«¿ ¡¥«»µ ¢¥°¸¨­ $d$ ¡¥±ª®­¥·­® ¨ $\pi$ ° ¢­®
\textsc{nil},   ¤«¿ ±¥°®© ¢¥°¸¨­» §­ ·¥­¨¿ $d$ ¨ $\pi$
¯° ¢¨«¼­».
³±²¼ ²¥¯¥°¼ ¤«¿ ­¥ª®²®°®£® $k$ ³²¢¥°¦¤¥­¨¥ «¥¬¬» ¢»¯®«­¥­®, ¨
¯®±«¥ ­¥±ª®«¼ª¨µ ¨²¥° ¶¨© ¶¨ª«  ¢±\"^^a5 ² ª, ª ª ­ ¯¨± ­® ¢ «¥¬¬¥.
²® ¡³¤¥² ¯°®¨±µ®¤¨²¼ ¯®±«¥ ½²®£®? § ®·¥°¥¤¨ ¡³¤³² § ¡¨° ²¼±¿
«¥¦ ¹¨¥ ¢ ­¥© ¢¥°¸¨­», ª®²®°»¥ ¬» ¡³¤¥¬ ­ §»¢ ²¼
\textit{¯°®±¬ ²°¨¢ ¥¬»¬¨}. «¿ ±¬¥¦­»µ ± ­¨¬¨ ¡¥«»µ ¢¥°¸¨­ ¡³¤³²
¢»¯®«­¿²¼±¿ ±²°®ª¨ 13--16; ¢ ±²°®ª¥ 16 ®­¨ ¤®¡ ¢«¿¾²±¿ ¢ ª®­¥¶
®·¥°¥¤¨, ¨ ¯®²®¬³ ¬» ¡³¤¥¬ ­ §»¢ ²¼ ¨µ \emph{¤®¡ ¢«¿¥¬»¬¨}. 
ª ª®©-²® ¬®¬¥­² ®·¥°¥¤¨ ¡³¤³² ¨§º¿²» ¢±¥ ­ µ®¤¨¢¸¨¥±¿ ² ¬
¨§­ · «¼­® ¢¥°¸¨­», ²® ¥±²¼ ¢±¥ ¢¥°¸¨­», ­ µ®¤¿¹¨¥±¿ ­ 
° ±±²®¿­¨¨ $k$, ¨ ®±² ­³²±¿ ²®«¼ª® ¢­®¢¼ ¤®¡ ¢«¥­­»¥.
(¡° ²¨²¥ ¢­¨¬ ­¨¥, ·²® §¤¥±¼ ±³¹¥±²¢¥­­® ¨±¯®«¼§³¥²±¿
¯° ¢¨«® ° ¡®²» ®·¥°¥¤¨: ¯¥°¢»¬ ¯°¨¸\"^^a5« --- ¯¥°¢»¬ ³¸\"^^a5«.)
 ½²®² ¬®¬¥­² ¬» ¬»±«¥­­® ¯°¥°¢\"^^a5¬ ¢»¯®«­¥­¨¥ ¯°®¶¥¤³°» ¨
³¡¥¤¨¬±¿, ·²® ¢»¯®«­¥­» ¢±¥ ³±«®¢¨¿ «¥¬¬» ¤«¿ ­  ¥¤¨­¨¶³
¡®«¼¸¥£® §­ ·¥­¨¿ $k$.
°®±¬ ²°¨¢ ¥¬»¥ ¢¥°¸¨­» --- ½²® ¢¥°¸¨­», ª®²®°»¥ ¡»«¨ ¢ ®·¥°¥¤¨;
¯® ¯°¥¤¯®«®¦¥­¨¾ ®­¨ ­ µ®¤¿²±¿ ­  ° ±±²®¿­¨¨ $k$.
®¡ ¢«¿¥¬»¥ ¢¥°¸¨­» ­ µ®¤¿²±¿ ­  ° ±±²®¿­¨¨ $k+1$.  ± ¬®¬ ¤¥«¥,
®­¨ ¿¢«¿¾²±¿ ±¬¥¦­»¬¨ ± ¯°®±¬ ²°¨¢ ¥¬»¬¨ ¢¥°¸¨­ ¬¨, ­ µ®¤¿¹¨¬¨±¿
­  ° ±±²®¿­¨¨ $k$, ¨ ¯®²®¬³ ¯® «¥¬¬¥ 23.1 ° ±±²®¿­¨¥ ¡³¤¥² ­¥
¡®«¼¸¥ $k+1$.  ¤°³£®© ±²®°®­», ¤®¡ ¢«¿¾²±¿ ²®«¼ª® ¡¥«»¥
¢¥°¸¨­», ¨ ¯®²®¬³ ¯® ¯°¥¤¯®«®¦¥­¨¾ ¨­¤³ª¶¨¨ ° ±±²®¿­¨¥ ¤® ­¨µ
¡®«¼¸¥ $k$.
³¤³² ¤®¡ ¢«¥­» ¢±¥ ¢¥°¸¨­», ­ µ®¤¿¹¨¥±¿ ­  ° ±±²®¿­¨¨ $k+1$. 
± ¬®¬ ¤¥«¥, ¥±«¨ ¢¥°¸¨­  $v$ ­ µ®¤¨²±¿ ­  ° ±±²®¿­¨¨ $k+1$, ²®
¯® «¥¬¬¥ 23.2 ±³¹¥±²¢³¥² ¢¥°¸¨­  $u$ ­  ° ±±²®¿­¨¨ $k$, ¤«¿
ª®²®°®© ®­  ±¬¥¦­ ¿. ¥°¸¨­  $u$ ¤®«¦­  ¡»²¼ ±°¥¤¨
¯°®±¬ ²°¨¢ ¥¬»µ, ¨ ¢® ¢°¥¬¿ ¥\"^^a5 ®¡° ¡®²ª¨ ¢¥°¸¨­  $v$ ¡³¤¥²
¤®¡ ¢«¥­ .  ¤® ²®«¼ª® ¨¬¥²¼ ¢ ¢¨¤³, ·²® ¢¥°¸¨­ $u$ ¬®¦¥² ¡»²¼
­¥±ª®«¼ª® --- ­® ½²® ­¥ ¬¥¸ ¥² ¤¥«³, ² ª ª ª ¢® ¢°¥¬¿ ¯°®±¬®²° 
¯¥°¢®© ¨§ ­¨µ ¢¥°¸¨­  $v$ ¡³¤¥² ¤®¡ ¢«¥­  (¯®±«¥ ·¥£® ®­  ¡³¤¥²
±¥°®© ¨ ³±«®¢¨¥ ¢ ±²°®ª¥ 12 ¡³¤¥² «®¦­®, ² ª ·²® ¢²®°®© ° § ¥\"^^a5

468

« ¢  23 «£®°¨²¬» ­  £° ´ µ
­¥ ¤®¡ ¢¿²).
®½²®¬³ ¢ ª®­¶¥ ° ±±¬ ²°¨¢ ¬®£® ­ ¬¨ ½² ¯  ¢ ®·¥°¥¤¨ ¡³¤³² ¢±¥
¢¥°¸¨­», ­ µ®¤¿¹¨¥±¿ ­  ° ±±²®¿­¨¨ $k+1$. ®±ª®«¼ª³ ¯°¨
¤®¡ ¢«¥­¨¨ ®­¨ ¤¥« ¾²±¿ ±¥°»¬¨,   ¯®±«¥ ¯°®±¬®²°  ¢¥°¸¨­ 
¤¥« ¥²±¿ ·\"^^a5°­®©, ²® ³±«®¢¨¥ ® ¶¢¥² µ ¡³¤¥² ¢»¯®«­¥­®.
²°®ª¨ 14 ¨ 15 ®¡¥±¯¥·¨¢ ¾² ¢»¯®«­¥­¨¥ ¯³­ª²®¢ «¥¬¬» ®
° ±±²®¿­¨¨ ¨ ® ¬ ±±¨¢¥ $\pi$, ·²® § ¢¥°¸ ¥² ¤®ª § ²¥«¼±²¢®.
¥¯¥°¼ ¤«¿ ¤®ª § ²¥«¼±²¢  ¯° ¢¨«¼­®±²¨ ¯°®¶¥¤³°» \textsc{BFS}
¤®±² ²®·­® ¢§¿²¼ ¡®«¼¸®¥ $k$ (¡®«¼¸¥ ¬ ª±¨¬ «¼­®£®
° ±±²®¿­¨¿ ®² ­ · «¼­®© ¢¥°¸¨­» ¤® ¢±¥µ ¢¥°¸¨­ £° ´ ). ®£¤ 
¢¥°¸¨­ ­  ° ±±²®¿­¨¨ $k$ (±¥°»µ, ®­¨ ¦¥ ¢¥°¸¨­» ¢ ®·¥°¥¤¨) ­¥
¡³¤¥²,  «£®°¨²¬ § ¢¥°¸¨² ° ¡®²³ ¨ ¢±¥ ¬ ±±¨¢» ¡³¤³² § ¯®«­¥­»
¯° ¢¨«¼­®. » ¤®ª § «¨ ² ª³¾ ²¥®°¥¬³:
¥®°¥¬  23.4 («£®°¨²¬ \textsc{BFS} ¯° ¢¨«¥­)
 ¡®² ¿ ­  £° ´¥ $G=(V,E)$ (®°¨¥­²¨°®¢ ­­®¬ ¨«¨
­¥®°¨¥­²¨°®¢ ­­®¬) ± ­ · «¼­®© ¢¥°¸¨­®© $s$, ¯°®¶¥¤³° 
\textsc{BFS} ®¡­ °³¦¨² (±¤¥« ¥² ·\"^^a5°­»¬¨) ¢±¥ ¤®±²¨¦¨¬»¥ ¨§ $s$
¢¥°¸¨­», ¨ ¤«¿ ¢±¥µ $v\in V$ ¡³¤¥² ¢»¯®«­¥­® ° ¢¥­±²¢®
$d[v]=\delta (s,v)$. °®¬¥ ²®£®, ¤«¿ «¾¡®© ¢¥°¸¨­» $v\ne s$,
¤®±²¨¦¨¬®© ¨§ $s$, ®¤¨­ ¨§ ª° ²· ©¸¨µ ¯³²¥© ¨§ $s$ ¢ $v$ ¬®¦­®
¯®«³·¨²¼ ¤®¡ ¢«¥­¨¥¬ °¥¡°  $(\pi [v],v)$ ª («¾¡®¬³) ª° ²· ©¸¥¬³
¯³²¨ ¨§ $s$ ¢ $\pi [v]$. «¿ ­¥¤®±²¨¦¨¬®© ¨§ $s$ ¢¥°¸¨­»
§­ ·¥­¨¥ $\pi[s]$ ° ¢­® \textsc{nil}.
% ª®­¥¶ ¤®ª § ²¥«¼±²¢ 
¥°¥¢¼¿ ¯®¨±ª  ¢ ¸¨°¨­³.
 µ®¤¥ ° ¡®²» ¯°®¶¥¤³°» \textsc{BFS} ¢»¤¥«¿¥²±¿
­¥ª®²®°»© ¯®¤£° ´ --- ¤¥°¥¢® ¯®¨±ª  ¢ ¸¨°¨­³,
§ ¤ ¢ ¥¬®¥ ¯®«¿¬¨ $\pi[v]$. ®«¥¥ ´®°¬ «¼­®, ¯°¨¬¥­¨¬ ¯°®¶¥¤³°³
\textsc{BFS} ª £° ´³ $G=(V,E)$ ± ­ · «¼­®© ¢¥°¸¨­®© $s$.
 ±±¬®²°¨¬ ¯®¤£° ´, ¢¥°¸¨­ ¬¨ ª®²®°®£® ¿¢«¿¾²±¿ ¤®±²¨¦¨¬»¥ ¨§
$s$ ¢¥°¸¨­»,   °\"^^a5¡° ¬¨ ¿¢«¿¾²±¿ °\"^^a5¡°  $(\pi[v],v)$ ¤«¿
¢±¥µ ¤®±²¨¦¨¬»µ $v$, ª°®¬¥ $s$.
¥¬¬  23.5.
®±²°®¥­­»© ² ª¨¬ ®¡° §®¬ ¯®¤£° ´ £° ´  $G$ ¯°¥¤±² ¢«¿¥² ±®¡®©
¤¥°¥¢®, ¢ ª®²®°®¬ ¤«¿ ª ¦¤®© ¢¥°¸¨­» $v$ ¨¬¥¥²±¿ ¥¤¨­±²¢¥­­»©
¯°®±²®© ¯³²¼ ¨§ $s$ ¢ $v$. ²®² ¯³²¼ ¡³¤¥² ª° ²· ©¸¨¬ ¯³²\"^^a5¬ ¨§

±­®¢­»¥  «£®°¨²¬» ­  £° ´ µ

469

$s$ ¢ $v$ ¢ £° ´¥ $G$.
®ª § ²¥«¼±²¢®.
³¹¥±²¢®¢ ­¨¥ ¯³²¨ ¨§ $s$ ¢ $v$ (ª ª ¨ ²®, ·²® ®­ ¡³¤¥²
ª° ²· ©¸¨¬) ±«¥¤³¥² ¨§ ²¥®°¥¬» 23.4 (¨­¤³ª¶¨¿ ¯® ° ±±²®¿­¨¾
®² $s$ ¤® $v$). ®½²®¬³ £° ´ ±¢¿§¥­. ®±ª®«¼ª³ ·¨±«®
°\"^^a5¡¥° ¢ ­\"^^a5¬ ­  ¥¤¨­¨¶³ ¬¥­¼¸¥ ·¨±«  ¢¥°¸¨­, ²® ®­
¿¢«¿¥²±¿ ¤¥°¥¢®¬ (²¥®°¥¬  5.2).
% ª®­¥¶ ¤®ª § ²¥«¼±²¢ 
²® ¤¥°¥¢® ­ §»¢ ¥²±¿ \emph{¯®¤£° ´®¬ ¯°¥¤¸¥±²¢®¢ ­¨¿}
(predecessor subgraph),   ² ª¦¥ \emph{¤¥°¥¢®¬ ¯®¨±ª  ¢ ¸¨°¨­³}
(breadth-first tree) ¤«¿ ¤ ­­®£® £° ´  ¨ ¤ ­­®© ­ · «¼­®©
¢¥°¸¨­». ( ¬¥²¨¬, ·²® ¯®±²°®¥­­®¥ ¤¥°¥¢® § ¢¨±¨² ®² ²®£®, ¢
ª ª®¬ ¯®°¿¤ª¥ ¯°®±¬ ²°¨¢ ¾²±¿ ¢¥°¸¨­» ¢ ±¯¨±ª µ ±¬¥¦­»µ ¢¥°¸¨­.)
±«¨ §­ ·¥­¨¿ ¢ ¬ ±±¨¢¥ $\pi$ ³¦¥ ¢»·¨±«¥­» ± ¯®¬®¹¼¾
¯°®¶¥¤³°» \textsc{BFS}, ²® ª° ©²· ©¸¨¥ ¯³²¨ ¨§ $s$ «¥£ª® ­ ©²¨:
¨µ ¯¥· ² ¥² ¯°®¶¥¤³°  \textsc{Print-Path}
\begin{verbatim}
Print-Path$(G,s,v)$
1 if $v=s$
2
then ­ ¯¥· ² ²¼ $s$
3
else if $\pi[v]=NIL$
4
then ­ ¯¥· ² ²¼ "¯³²¨ ¨§ $s$ ¢ $v$ ­¥²"
5
else Print-Path$(G,s,\pi[v])$
6
­ ¯¥· ² ²¼ $v$

°¥¬¿ ¢»¯®«­¥­¨¿ ¯°®¯®°¶¨®­ «¼­® ¤«¨­¥ ¯¥· ² ¥¬®£® ¯³²¨
(ª ¦¤»© °¥ª³°±¨¢­»© ¢»§®¢ ³¬¥­¼¸ ¥² ° ±±²®¿­¨¥ ®² s ­  ¥¤¨­¨¶³).
¯° ¦­¥­¨¿
23.2-1
²® ¤ ±² ¯®¨±ª ¢ ¸¨°¨­³ ¤«¿ ®°¨¥­²¨°®¢ ­­®£® £° ´ 
°¨±. 23.2 (a) ¨ ¢¥°¸¨­» 3 ¢ ª ·¥±²¢¥ ­ · «¼­®©?
23.2-2
²® ¤ ±² ¯®¨±ª ¢ ¸¨°¨­³ ¤«¿ ­¥®°¨¥­²¨°®¢ ­­®£® £° ´ 
°¨±. 23.3 ¨ ¢¥°¸¨­» u ¢ ª ·¥±²¢¥ ­ · «¼­®©?
23.2-3
ª®«¼ª® ¢°¥¬¥­¨ ¡³¤¥² ° ¡®² ²¼ ¯°®¶¥¤³°  BFS, ¥±«¨ £° ´

470

« ¢  23 «£®°¨²¬» ­  £° ´ µ

¯°¥¤±² ¢«¥­ ¢ ¢¨¤¥ ¬ ²°¨¶» ±¬¥¦­®±²¨ (¨ ¯°®¶¥¤³°  ±®®²¢¥²±²¢¥­­® ¨§¬¥­¥­ )?
23.2-4
®ª ¦¨²¥, ·²® ¯°¨ ¯®¨±ª¥ ¢ ¸¨°¨­³ §­ ·¥­¨¥ d[u], ¤ ¢ ¥¬®¥
 «£®°¨²¬®¬, ­¥ ¨§¬¥­¨²±¿, ¥±«¨ ¯¥°¥±² ¢¨²¼ ½«¥¬¥­²» ¢ ª ¦¤®¬
±¯¨±ª¥ ±¬¥¦­»µ ¢¥°¸¨­.
23.2-5
°¨¢¥¤¨²¥ ¯°¨¬¥° ®°¨¥­²¨°®¢ ­­®£® £° ´  G = (V; E ), ­ · «¼­®© ¢¥°¸¨­» s 2 V ¨ ­¥ª®²®°®£® ¬­®¦¥±²¢  °¥¡¥° E  E , ¤«¿
ª®²®°»µ ¤«¿ ª ¦¤®© ¤®±²¨¦¨¬®© ¨§ s ¢¥°¸¨­» v 2 V ±³¹¥±²¢³¥²
¥¤¨­±²¢¥­­»© ¯³²¼ ¨§ s ¢ v , ¯°®µ®¤¿¹¨© ¯® °¥¡° ¬ ¨§ E , ¨ ½²®²
¯³²¼ ¿¢«¿¥²±¿ ª° ²· ©¸¨¬ ¢ G, ­® ¬­®¦¥±²¢® °¥¡¥° E ­¥ ±®¢¯ ¤ ¥² ± ¤¥°¥¢®¬ ¯®¨±ª  ¢ ¸¨°¨­³, ¤ ¢ ¥¬»¬ ± ¯®¬®¹¼¾ ¯°®¶¥¤³°»
BFS, ª ª ­¨ ¯¥°¥±² ¢«¿© ½«¥¬¥­²» ¢ ª ¦¤®¬ ¨§ ±¯¨±ª®¢ ±¬¥¦­»µ
¢¥°¸¨­.
23.2-6
°¨¤³¬ ©²¥ ½´´¥ª²¨¢­»©  «£®°¨²¬, ¢»¿±­¿¾¹¨©, ¿¢«¿¥²±¿ «¨
¤ ­­»© ­¥®°¨¥­²¨°®¢ ­­»© £° ´ ¤¢³¤®«¼­»¬.
23.2-7*
¨ ¬¥²° (diameter) ¤¥°¥¢  T = (V; E ) ®¯°¥¤¥«¿¥²±¿ ª ª
max  (u; v )
u;v2V
(²® ¥±²¼ ª ª ¬ ª±¨¬ «¼­ ¿ ¤«¨­  ª° ²· ©¸¥£® ¯³²¨ ¬¥¦¤³ ¤¢³¬¿ ¢¥°¸¨­ ¬¨). °¨¤³¬ ©²¥ ½´´¥ª²¨¢­»©  «£®°¨²¬ ¢»·¨±«¥­¨¿
¤¨ ¬¥²°  ¤¥°¥¢ , ¨ ®¶¥­¨²¥ ¢°¥¬¿ ¥£® ° ¡®²».
23.2-8
³±²¼ G = (V; E ) { ­¥®°¨¥­²¨°®¢ ­­»© £° ´. °¨¤³¬ ©²¥  «£®°¨²¬, ®²»±ª¨¢ ¾¹¨© §  ¢°¥¬¿ O(V + E ) ¯³²¼ ¢ £° ´¥, ª®²®°»©
¯°®µ®¤¨² ª ¦¤®¥ °¥¡°® °®¢­® ¯® ®¤­®¬³ ° §³ ¢ ª ¦¤³¾ ±²®°®­³.
 ª ­ ©²¨ ¢»µ®¤ ¨§ « ¡¨°¨­² , ¨¬¥¿ ± ±®¡®© ¡®«¼¸®© § ¯ ± ®¤¨­ ª®¢»µ ¬®­¥²?
23.1.3. ®¨±ª ¢ £«³¡¨­³
²° ²¥£¨¿ ¯®¨±ª  ¢ £«³¡¨­³ ² ª®¢ : ¨¤²¨ À¢£«³¡¼Á, ¯®ª  ½²® ¢®§¬®¦­® (¥±²¼ ­¥¯°®©¤¥­­»¥ °¥¡° ), ¨ ¢®§¢° ¹ ²¼±¿ ¨ ¨±ª ²¼ ¤°³£®©
¯³²¼, ª®£¤  ² ª¨µ °¥¡¥° ­¥².  ª ¤¥« ¥²±¿, ¯®ª  ­¥ ®¡­ °³¦¥­» ¢±¥
¢¥°¸¨­», ¤®±²¨¦¨¬»¥ ¨§ ¨±µ®¤­®©. ±«¨ ¯®±«¥ ½²®£® ®±² ¾²±¿ ­¥®¡­ °³¦¥­­»¥ ¢¥°¸¨­», ¬®¦­® ¢»¡° ²¼ ®¤­³ ¨§ ­¨µ ¨ ¯®¢²®°¿²¼
¯°®¶¥±±, ¨ ¤¥« ²¼ ² ª ¤® ²¥µ ¯®°, ¯®ª  ¬» ­¥ ®¡­ °³¦¨¬ ¢±¥ ¢¥°¸¨­» £° ´ .
 ª ¨ ¯°¨ ¯®¨±ª¥ ¢ ¸¨°¨­³, ®¡­ °³¦¨¢ (¢¯¥°¢»¥) ¢¥°¸¨­³ v ,
±¬¥¦­³¾ ± u, ¬» ®²¬¥· ¥¬ ½²® ±®¡»²¨¥, ¯®¬¥¹ ¿ ¢ ¯®«¥  [v ] §­ ·¥­¨¥ u. ®«³· ¥²±¿ ¤¥°¥¢® | ¨«¨ ­¥±ª®«¼ª® ¤¥°¥¢¼¥¢, ¥±«¨ ¯®-

±­®¢­»¥  «£®°¨²¬» ­  £° ´ µ

471

¨±ª ¯®¢²®°¿¥²±¿ ¨§ ­¥±ª®«¼ª¨µ ¢¥°¸¨­. ®¢®°¿ ¤ «¼¸¥ ® ¯®¨±ª¥ ¢
£«³¡¨­³, ¬» ¢±¥£¤  ¯°¥¤¯®« £ ¥¬, ·²® ² ª ¨ ¤¥« ¥²±¿ (¯®¨±ª ¯®¢²®°¿¥²±¿). » ¯®«³· ¥¬ ¯®¤£° ´ ¯°¥¤¸¥±²¢®¢ ­¨¿ (predecessor
subgraph), ®¯°¥¤¥«¥­­»© ² ª: G = (V; E), £¤¥

E = f( [v]; v) : v 2 V and[v ] 6= NILg
®¤£° ´ ¯°¥¤¸¥±²¢®¢ ­¨¿ ¯°¥¤±² ¢«¿¥² ±®¡®© «¥± ¯®¨±ª  ¢ £«³¡¨­³ (depth-rst forest), ±®±²®¿¹¨© ¨§ ¤¥°¥¢¼¥¢ ¯®¨±ª  ¢ £«³¡¨­³
(deep-rst trees).
«£®°¨²¬ ¯®¨±ª  ¢ £«³¡¨­³ ² ª¦¥ ¨±¯®«¼§³¥² ¶¢¥²  ¢¥°¸¨­.  ¦¤ ¿ ¨§ ¢¥°¸¨­ ¢­ · «¥ ¡¥« ¿. ³¤³·¨ ®¡­ °³¦¥­­®© (discovered),
®­  ±² ­®¢¨²±¿ ±¥°®©; ®­  ±² ­¥² ·¥°­®©, ª®£¤  ¡³¤¥² ¯®«­®±²¼¾
®¡° ¡®² ­ , ²® ¥±²¼ ª®£¤  ±¯¨±®ª ±¬¥¦­»µ ± ­¥© ¢¥°¸¨­ ¡³¤¥² ¯°®±¬®²°¥­.  ¦¤ ¿ ¢¥°¸¨­  ¯®¯ ¤ ¥² °®¢­® ¢ ®¤­® ¤¥°¥¢® ¯®¨±ª  ¢
£«³¡¨­³, ² ª ·²® ½²¨ ¤¥°¥¢¼¿ ­¥ ¯¥°¥±¥ª ¾²±¿.
®¬¨¬® ½²®£®, ¯®¨±ª ¢ £«³¡¨­³ ±² ¢¨² ­  ¢¥°¸¨­ µ ¬¥²ª¨ ¢°¥¬¥­¨ (timestamps).  ¦¤ ¿ ¢¥°¸¨­  ¨¬¥¥² ¤¢¥ ¬¥²ª¨: ¢ d[v ] § ¯¨± ­®, ª®£¤  ½²  ¢¥°¸¨­  ¡»«  ®¡­ °³¦¥­  (¨ ±¤¥« ­  ±¥°®©),   ¢ f [v ]
| ª®£¤  ¡»«  § ª®­·¥­  ®¡° ¡®²ª  ±¯¨±ª  ±¬¥¦­»µ ± v ¢¥°¸¨­ (¨
v ±² «  ·¥°­®©).
²¨ ¬¥²ª¨ ¢°¥¬¥­¨ ¨±¯®«¼§³¾²±¿ ¢® ¬­®£¨µ  «£®°¨²¬ µ ­  £° ´ µ ¨ ¯®«¥§­» ¤«¿  ­ «¨§  ±¢®©±²¢ ¯®¨±ª  ¢ £«³¡¨­³.
 ¯°¨¢®¤¨¬®© ¤ «¥¥ ¯°®¶¥¤³°¥ DFS (Depth-First Search | ¯®¨±ª
¢ £«³¡¨­³) ¬¥²ª¨ ¢°¥¬¥­¨ d[v ] ¨ f [v ] ¿¢«¿¾²±¿ ¶¥«»¬¨ ·¨±« ¬¨ ®²
1 ¤® 2jV j; ¤«¿ «¾¡®© ¢¥°¸¨­» u ¢»¯®«­¥­® ­¥° ¢¥­±²¢®

d[u] < f [u]
(23:1)
¥°¸¨­  u ¡³¤¥² ¡¥«®© ¤® ¬®¬¥­²  d[u], ±¥°®© ¬¥¦¤³ d[u] ¨ f [u]
¨ ·¥°­®© ¯®±«¥ f [u].

±µ®¤­»© £° ´ ¬®¦¥² ¡»²¼ ®°¨¥­²¨°®¢ ­­»¬ ¨«¨ ­¥®°¨¥­²¨°®¢ ­­»¬. ¥°¥¬¥­­ ¿ time | £«®¡ «¼­ ¿ ¯¥°¥¬¥­­ ¿ ²¥ª³¹¥£®
¢°¥¬¥­¨, ¨±¯®«¼§³¥¬®£® ¤«¿ ¯®¬¥²®ª.
DFS$(G)$
1
2
3
4
5
6
7

for (¤«¿) ¢±¥µ ¢¥°¸¨­ $u\in V[G]$
\hspace{1cm} do $color[u]\leftarrow$ ¡¥«»©
\hspace{2cm} $\pi[u]\leftarrow NIL$
$time\leftarrow 0$
for (¤«¿) ¢±¥µ ¢¥°¹¨­
$u\in V[G]$
\hspace{1cm} do if $color[u]=$ ¡¥«»©
\hspace{2cm} then DFS-Visit$(u)$

DFS-Visit(u)
1 $color[u]\leftarrow$ ¡¥«»© // ¢¥°¸¨­  $u$ ¡»«  ¡¥«®©

472

« ¢  23 «£®°¨²¬» ­  £° ´ µ

23.4 ±¯®«­¥­¨¥  «£®°¨²¬  DFS ¤«¿ ®°¨¥­²¨°®¢ ­­®£® £° ´ . ®±«¥ ¯°®±¬®²°  ª ¦¤®¥ °¥¡°® ±² ­®¢¨²±¿ «¨¡® ±¥°»¬ (¥±«¨ ®­® ¢ª«¾· ¥²±¿ ¢
¤¥°¥¢® ¯®¨±ª ) ¨«¨ ¯³­ª²¨°­»¬ (®¡° ²­»¥ °¥¡°  ¯®¬¥·¥­» ¡³ª¢®© B (back),
¯¥°¥ª°¥±²­»¥ | ¡³ª¢®© C (cross), ¯°¿¬»¥ | ¡³ª¢®© F (forward)).  ª ¦¤®©
¢¥°¸¨­» ¯®ª § ­» ¢°¥¬¥­  ­ · «  ¨ ª®­¶  ®¡° ¡®²ª¨.
¨±. 23.3

2
3
4
5
6
7
8

$d[u]\leftarrow time\leftarrow time+1$
\textsc{for} (¤«¿) ¢±¥µ $v\in Adj[u]$ // ®¡° ¡®² ²¼ °¥¡°® $(u,v)$
\hspace{1cm} \textsc{do if} $color[v]=$ ¡¥«»©
\hspace{2cm} \textsc{then} $\pi[v]\leftarrow u$
\hspace{3cm} DFS-Visit$(v)$
$color[u]\leftarrow$ ·\"^^a5°­»© //¢¥°¸¨­  ®¡° ¡®² ­ , ¤¥« ¥¬ ¥\"^^a5 ·¥°­
$f[u]\leftarrow time\leftarrow time+1$

  °¨±. 23.4 ¯®ª § ­  ° ¡®²  ¯°®¶¥¤³°» DFS ­  £° ´¥ °¨±. 23.2.
 ±²°®ª µ 1-3 ¢±¥ ¢¥°¸¨­» ª° ±¿²±¿ ¢ ¡¥«»© ¶¢¥²; ¢ ¯®«¥  ¯®¬¥¹ ¥²±¿ nil.  ±²°®ª¥ 4 ³±² ¢«¨¢ ¥²±¿ ­ · «¼­®¥ (­³«¥¢®¥) ¢°¥¬¿. 
±²°®ª µ 5{7 ¢»§»¢ ¥²±¿ ¯°®¶¥¤³°  DFS-Visit ¤«¿ ¢±¥µ ¢¥°¸¨­ (ª®²®°»¥ ®±² «¨±¼ ¡¥«»¬¨ ª ¬®¬¥­²³ ¢»§®¢  | ¯°¥¤»¤³¹¨¥ ¢»§®¢»
¯°®¶¥¤³°» ¬®£«¨ ±¤¥« ²¼ ¨µ ·¥°­»¬¨). ²¨ ¢¥°¸¨­» ±² ­®¢¿²±¿
ª®°­¿¬¨ ¤¥°¥¢¼¥¢ ¯®¨±ª  ¢ £«³¡¨­³.
 ¬®¬¥­² ¢»§®¢  DFS-Visit(u) ¢¥°¸¨­  u | ¡¥« ¿.  ±²°®ª¥ 1
®­  ±² ­®¢¨²±¿ ±¥°®©.  ±²°®ª¥ 2 ¢°¥¬¿ ¥¥ ®¡­ °³¦¥­¨¿ § ­®±¨²±¿
¢ d[u] (¤® ½²®£® ±·¥²·¨ª ¢°¥¬¥­¨ ³¢¥«¨·¨¢ ¥²±¿ ­  1).  ±²°®ª µ
3-7 ¯°®±¬ ²°¨¢ ¾²±¿ ±¬¥¦­»¥ ± u ¢¥°¸¨­»; ¯°®¶¥¤³°  DFS-Visit
¢»§»¢ ¥²±¿ ¤«¿ ²¥µ ¨§ ­¨µ, ª®²®°»¥ ®ª §»¢ ¾²±¿ ¡¥«»¬¨ ª ¬®¬¥­²³ ¢»§®¢ . ®±«¥ ¯°®±¬®²°  ¢±¥µ ±¬¥¦­»µ ± u ¢¥°¸¨­ ¬» ¤¥« ¥¬
¢¥°¸¨­³ u ·¥°­®© ¨ § ¯¨±»¢ ¥¬ ¢ f [u] ¢°¥¬¿ ½²®£® ±®¡»²¨¿.
®¤±·¨² ¥¬ ®¡¹¥¥ ·¨±«® ®¯¥° ¶¨© ¯°¨ ¢»¯®«­¥­¨¨ ¯°®¶¥¤³°»
DFS. ¨ª«» ¢ ±²°®ª µ 1{3 ¨ 5{7 ²°¥¡³¾² (V ) ¢°¥¬¥­¨ (¯®¬¨¬® ¢»§®¢®¢ DFS-Visit). °®¶¥¤³°  DFS-Visit ¢»§»¢ ¥²±¿ °®¢­®
®¤¨­ ° § ¤«¿ ª ¦¤®© ¢¥°¸¨­» (¥© ¯¥°¥¤ ¥²±¿ ¡¥« ¿ ¢¥°¸¨­ , ¨ ®­ 
±° §³ ¦¥ ¤¥« ¥² ¥¥ ±¥°®©). ® ¢°¥¬¿ ¢»¯®«­¥­¨¿ DFS-Visit(v ) ¶¨ª«
¢ ±²°®ª µ 3{6 ¢»¯®«­¿¥²±¿ jAdj [v ]j ° §. ®±ª®«¼ª³
X

v2V

jAdj [v]j = (E );

¢°¥¬¿ ¢»¯®«­¥­¨¿ ±²°®ª 3{6 ¯°®¶¥¤³°» DFS-Visit ±®±² ¢«¿¥²
(E ).  ±³¬¬¥ ¯®«³· ¥²±¿ ¢°¥¬¿ (V + E ).
¢®©±²¢  ¯®¨±ª  ¢ £«³¡¨­³.
°¥¦¤¥ ¢±¥£® ®²¬¥²¨¬, ·²® ¯®¤£° ´ ¯°¥¤¸¥±²¢®¢ ­¨¿ (±®±² ¢«¥­­»© ¨§ ¤¥°¥¢¼¥¢ ¯®¨±ª  ¢ £«³¡¨­³) ¢ ²®·­®±²¨ ±®®²¢¥²±²¢³¥² ±²°³ª²³°¥ °¥ª³°±¨¢­»µ ¢»§®¢®¢ ¯°®¶¥¤³°» DFS-Visit. ¬¥­­®, u =  [v ] ²®£¤  ¨ ²®«¼ª® ²®£¤ , ª®£¤  ¯°®¨§®¸¥« ¢»§®¢ DFSVisit(v ) ¢® ¢°¥¬¿ ¯°®±¬®²°  ±¯¨±ª  ±¬¥¦­»µ ± u ¢¥°¸¨­.

±­®¢­»¥  «£®°¨²¬» ­  £° ´ µ

473

23.5 ¢®©±²¢  ¯®¨±ª  ¢ £«³¡¨­³. (a) ¥§³«¼² ² ¯®¨±ª  (¢ ®¡®§­ ·¥­¨¿µ °¨±. 23.4). (b) °®¬¥¦³²ª¨ ¬¥¦¤³ ®¡­ °³¦¥­¨¥¬ ¨ ®ª®­· ­¨¥¬ ®¡° ¡®²ª¨
¤«¿ ª ¦¤®© ¨§ ¢¥°¸¨­, ¨§®¡° ¦¥­­»¥ ¢ ¢¨¤¥ ¯°¿¬®³£®«¼­¨ª®¢. ²°¥«ª¨ ³ª §»¢ ¾² ±²°³ª²³°³ ¤¥°¥¢¼¥¢ ¯®±¨ª  ¢ £«³¡¨­³. (c) ²¬¥·¥­» °¥¡°  ¨±µ®¤­®£®
£° ´  ± ³ª § ­¨¥¬ ¨µ ²¨¯®¢ (°¥¡°  ¤¥°¥¢  ¨ ¯°¿¬»¥ °¥¡°  ¢¥¤³² ¢­¨§, ®¡° ²­»¥
¢¥¤³² ¢¢¥°µ).
¨±. 23.4

°³£®¥ ¢ ¦­®¥ ±¢®©±²¢® ±®±²®¨² ¢ ²®¬, ·²® ¢°¥¬¥­  ®¡­ °³¦¥­¨¿ ¨ ®ª®­· ­¨¿ ®¡° ¡®²ª¨ ®¡° §³¾² ¯° ¢¨«¼­³¾ ±ª®¡®·­³¾
±²°³ª²³°³ (parenthesis structure). ¡®§­ · ¿ ®¡­ °³¦¥­¨¥ ¢¥°¸¨­» u ®²ª°»¢ ¾¹¨©±¿ ±ª®¡ª®© ± ¯®¬¥²ª®© u,   ®ª®­· ­¨¥ ¥¥ ®¡° ¡®²ª¨ | § ª°»¢ ¾¹¥©±¿ ± ²®© ¦¥ ¯®¬¥²ª®©, ²® ¯¥°¥·¥­¼ ±®¡»²¨©
¡³¤¥² ¯° ¢¨«¼­® ¯®±²°®¥­­»¬ ¢»° ¦¥­¨¥¬ ¢ ²®¬ ±¬»±«¥ (±ª®¡ª¨
± ®¤¨­ ª®¢»¬¨ ¯®¬¥²ª ¬¨ ±·¨² ¥¬ ¯ °­»¬¨).  ¯°¨¬¥°, ¯®¨±ª³
¢ £«³¡¨­³ ­  °¨±. 23.5 (a) ±®®²¢¥²±²¢³¥² ° ±±² ­®¢ª  ±ª®¡®ª, ¨§®¡° ¦¥­­ ¿ ­  °¨±³­ª¥ 23.5(b).
²®¡» ¤®ª § ²¼ ½²¨ ¨ ¤°³£¨¥ ±¢®©±²¢ , ¬» ¤®«¦­» ° ±±³¦¤ ²¼
¯® ¨­¤³ª¶¨¨. °¨ ½²®¬, ¤®ª §»¢ ¿ ²°¥¡³¥¬®¥ ±¢®©±²¢® °¥ª³°±¨¢­®© ¯°®¶¥¤³°» DFS-Visit, ¬» ¯°¥¤¯®« £ ¥¬, ·²® °¥ª³°±¨¢­»¥ ¢»§®¢» ½²®© ¯°®¶¥¤³°» ®¡« ¤ ¾² ¢»¡° ­­»¬ ±¢®©±²¢®¬.
¡¥¤¨¬±¿ ¢­ · «¥, ·²® ¢»§®¢ DFS-Visit(u) ¤«¿ ¡¥«®© ¢¥°¸¨­» u
¤¥« ¥² ·¥°­®© ½²³ ¢¥°¸¨­³ ¨ ¢±¥ ¡¥«»¥ ¢¥°¸¨­», ¤®±²³¯­»¥ ¨§ ­¥¥
¯® ¡¥«»¬ ¯³²¿¬ (¢ ª®²®°»µ ¢±¥ ¯°®¬¥¦³²®·­»¥ ¢¥°¸¨­» ² ª¦¥
¡¥«»¥), ¨ ®±² ¢«¿¥² ±¥°»¥ ¨ ·¥°­»¥ ¢¥°¸¨­» ¡¥§ ¨§¬¥­¥­¨©.
 ± ¬®¬ ¤¥«¥, °¥ª³°±¨¢­»¥ ¢»§®¢» ¢ ±²°®ª¥ 6 ¢»¯®«­¿¾²±¿ «¨¸¼
¤«¿ ¡¥«»µ ¢¥°¸¨­, ¿¢«¿¾¹¨µ±¿ ±¬¥¦­»¬¨ ± u. ±«¨ ª ª ¿-²® ¢¥°¸¨­  w ¡»«  § ª° ¸¥­  ¢ µ®¤¥ ½²¨µ ¢»§®¢®¢, ²® (¯® ¨­¤³ª²¨¢­®¬³
¯°¥¤¯®«®¦¥­¨¾) ®­  ¡»«  ¤®±²³¯­  ¯® ¡¥«®¬³ ¯³²¨ ¨§ ®¤­®© ¨§
¡¥«»µ ¢¥°¸¨­, ±¬¥¦­»µ ± u, ¨ ¯®²®¬³ ¤®±²³¯­  ¯® ¡¥«®¬³ ¯³²¨ ¨§
u.
 ¯°®²¨¢, ¥±«¨ ¢¥°¸¨­  w ¤®±²³¯­  ¯® ¡¥«®¬³ ¯³²¨ ¨§ u, ²®
½²®² ®­  ¤®±²³¯­  ¯® ¡¥«®¬³ ¯³²¨ ¨§ ª ª®©-²® ¡¥«®© ¢¥°¸¨­» v ,
±¬¥¦­®© ± u (¯®±¬®²°¨¬ ­  ¯¥°¢»© ¸ £ ¯³²¨). ³¤¥¬ ±·¨² ²¼, ·²®
v | ¯¥°¢ ¿ ¨§ ² ª¨µ ¢¥°¸¨­ (¢ ¯®°¿¤ª¥ ¯°®±¬®²°  ¢ ±²°®ª¥ 3).
 ½²®¬ ±«³· ¥ ¢±¥ ¢¥°¸¨­» ¡¥«®£® ¯³²¨ ¨§ v ¢ w ®±² ­³²±¿ ¡¥«»¬¨ ª ¬®¬¥­²³ ¢»§®¢  DFS-Visit(v ), ¯®±ª®«¼ª³ ®­¨ ­¥¤®±²³¯­» ¯®
¡¥«»¬ ¯³²¿¬ ¨§ ¯°¥¤¸¥±²¢³¾¹¨µ v ¢¥°¸¨­ (¨­ ·¥ w ¡»«  ¡» ² ª¦¥ ¤®±²³¯­ ). ® ¨­¤³ª²¨¢­®¬³ ¯°¥¤¯®«®¦¥­¨¾ w ±² ­¥² ·¥°­®©
¯®±«¥ ¢»§®¢  DFS-Visit(v ).
°®¬¥ ²®£®, ± ¬  ¢¥°¸¨­  u ±² ­¥² ±­ · «  ±¥°®©,   ¯®²®¬
·¥°­®©. ( ¬¥²¨¬, ·²® ¬» ¬®£«¨ ¡» ±° §³ ±¤¥« ²¼ ¥¥ ·¥°­®©, ¯®±ª®«¼ª³ ¯°®£° ¬¬  ­¨ª ª ­¥ ° §«¨· ¥² ±¥°»¥ ¨ ·¥°­»¥ ¢¥°¸¨­»,
®¤­ ª® ½²® ° §«¨·¨¥ ­ ¬ ¯°¨£®¤¨²±¿ ¢ ¤ «¼­¥©¸¥¬.)
±­® ² ª¦¥, ·²® ¶¢¥²  ±¥°»µ ¨ ·¥°­»µ ¢¥°¸¨­ ®±² ¾²±¿ ¡¥§
¨§¬¥­¥­¨© (¯®±ª®«¼ª³ ½²® ¢¥°­® ¤«¿ °¥ª³°±¨¢­»µ ¢»§®¢®¢ ¯® ¨­¤³ª²¨¢­®¬³ ¯°¥¤¯®«®¦¥­¨¾).

474

« ¢  23 «£®°¨²¬» ­  £° ´ µ

­ «®£¨·­»¥ ° ±±³¦¤¥­¨¿ ¯® ¨­¤³ª¶¨¨ ¯®§¢®«¿¾² ³±² ­®¢¨²¼,
·²® ¢»§®¢ DFS-Visit(u) ¬¥­¿¥² ¯®«¿  [v ] ¤«¿ ¢±¥µ ®ª° ¸¨¢ ¥¬»µ
¢¥°¸¨­ v , ®²«¨·­»µ ®² u, ²¥¬ ± ¬»¬ ´®°¬¨°³¿ ¨§ ­¨µ ¤¥°¥¢® ± ª®°­¥¬ ¢ u,   ² ª¦¥ ¤®¡ ¢«¿¥² ª ®¯¨± ­­®¬³ ¢»¸¥ ¯°®²®ª®«³ ¨§ ±ª®¡®ª
± ¯®¬¥²ª ¬¨ ¯° ¢¨«¼­®¥ ±ª®¡®·­®¥ ¢»° ¦¥­¨¥, ¢­¥¸­¨¥ ±ª®¡ª¨ ª®²®°®£® ¨¬¥¾² ¯®¬¥²ª³ u,   ¢­³²°¨ ­ µ®¤¿²±¿ ±ª®¡ª¨ ± ¯®¬¥²ª ¬¨,
±®®²¢¥²±²¢³¾¹¨¬¨ ®ª° ¸¨¢ ¥¬»¬ ¢¥°¸¨­ ¬.
®¤¢®¤¿ ¨²®£¨, ¬®¦­® ±´®°¬³«¨°®¢ ²¼ ² ª¨¥ ³²¢¥°¦¤¥­¨¿:
¥®°¥¬  23.6 (® ±ª®¡®·­®© ±²°³ª²³°¥).
°¨ ¯®¨±ª¥ ¢ £«³¡¨­³ ¢ ®°¨¥­²¨°®¢ ­­®¬ ¨«¨ ­¥®°¨¥­²¨°®¢ ­­®¬ £° ´¥ G = (V; E ) ¤«¿ «¾¡»µ ¤¢³µ ¢¥°¸¨­ u ¨ v ¢»¯®«­¿¥²±¿
°®¢­® ®¤­® ¨§ ±«¥¤³¾¹¨µ ²°¥µ ³²¢¥°¦¤¥­¨©:
®²°¥§ª¨ [d[u]; f [u]] ¨ [d[v ]; f [v ]] ­¥ ¯¥°¥±¥ª ¾²±¿;
®²°¥§®ª [d[u]; f [u]] ¶¥«¨ª®¬ ±®¤¥°¦¨²±¿ ¢­³²°¨ ®²°¥§ª  [d[v ]; f [v ]]
¨ u | ¯®²®¬®ª v ¢ ¤¥°¥¢¥ ¯®¨±ª  ¢ £«³¡¨­³;
®²°¥§®ª [d[v ]; f [v ]] ¶¥«¨ª®¬ ±®¤¥°¦¨²±¿ ¢­³²°¨ ®²°¥§ª  [d[u]; f [u]]
¨ v | ¯®²®¬®ª u ¢ ¤¥°¥¢¥ ¯®¨±ª  ¢ £«³¡¨­³;
«¥¤±²¢¨¥ 23.7 (¢«®¦¥­¨¥ ¨­²¥°¢ «®¢ ¤«¿ ¯®²®¬ª®¢)
¥°¸¨­  v ¿¢«¿¥²±¿ (®²«¨·­»¬ ®² u) ¯®²®¬ª®¬ ¢¥°¸¨­» u ¢ «¥±¥
¯®¨±ª  ¢ £«³¡¨­³ ¤«¿ (®°¨¥­²¨°®¢ ­­®£® ¨«¨ ­¥®°¨¥­²¨°®¢ ­­®£®)
£° ´  G, ¥±«¨ ¨ ²®«¼ª® ¥±«¨ d[u] < d[v ] < f [v ] < f [u]
¥®°¥¬  23.8 (® ¡¥«®¬ ¯³²¨)
¥°¸¨­  v ¿¢«¿¥²±¿ ¯®²®¬ª®¬ ¢¥°¸¨­» u ¢ «¥±¥ ¯®¨±ª  ¢ £«³¡¨­³
(¤«¿ ®°¨¥­²¨°®¢ ­­®£® ¨«¨ ­¥®°¨¥­²¨°®¢ ­­®£® £° ´  G = (V; E ))
¢ ²®¬ ¨ ²®«¼ª® ²®¬ ±«³· ¥, ¥±«¨ ¢ ¬®¬¥­² ¢°¥¬¥­¨ d[u], ª®£¤  ¢¥°¸¨­  u ®¡­ °³¦¥­ , ±³¹¥±²¢³¥² ¯³²¼ ¨§ u ¢ v , ±®±²®¿¹¨© ²®«¼ª®
¨§ ¡¥«»µ ¢¥°¸¨­.
« ±±¨´¨ª ¶¨¿ °¥¡¥°.
¥¡°  £° ´  ¤¥«¿²±¿ ­  ­¥±ª®«¼ª® ª ²¥£®°¨© ¢ § ¢¨±¨¬®±²¨ ®²
¨µ °®«¨ ¯°¨ ¯®¨±ª¥ ± £«³¡¨­³. ²  ª« ±±¨´¨ª ¶¨¿ ®ª §»¢ ¥²±¿ ¯®«¥§­®© ¢ ° §«¨·­»µ § ¤ · µ.  ¯°¨¬¥°, ª ª ¬» ³¢¨¤¨¬ ¢ ±«¥¤³¾¹¥¬ ° §¤¥«¥, ®°¨¥­²¨°®¢ ­­»© £° ´ ­¥ ¨¬¥¥² ¶¨ª«®¢ ²®£¤  ¨
²®«¼ª® ²®£¤ , ª®£¤  ¯®¨±ª ¢ £«³¡¨­³ ­¥ ­ µ®¤¨² ¢ ­¥¬ À®¡° ²­»µÁ
°¥¡¥° («¥¬¬  23.10).
² ª, ¯³±²¼ ¬» ¯°®¢¥«¨ ¯®¨±ª ¢ £«³¡¨­³ ­  £° ´¥ G ¨ ¯®«³·¨«¨
«¥± G .
1. ¥¡°  ¤¥°¥¢  (tree edges) | ½²® °¥¡°  £° ´  G . (¥¡°® (u; v )
¡³¤¥² °¥¡°®¬ ¤¥°¥¢ , ¥±«¨ ¢¥°¸¨­  v ¡»«  ®¡­ °³¦¥­  ¯°¨ ®¡° ¡®²ª¥ ½²®£® °¥¡° .)
2. ¡° ²­»¥ °¥¡°  (back edges) | ½²® °¥¡°  (u; v ), ±®¥¤¨­¿¾¹¨¥ ¢¥°¸¨­³ u ±® ¥¥ ¯°¥¤ª®¬ v ¢ ¤¥°¥¢¥ ¯®¨±ª  ¢ £«³¡¨­³. (¥¡° ¶¨ª«», ¢®§¬®¦­»¥ ¢ ®°¨¥­²¨°®¢ ­­»µ £° ´ µ, ±·¨² ¾²±¿ ®¡° ²­»¬¨ °¥¡° ¬¨.)
3. °¿¬»¥ °¥¡°  (forward edges) ±®¥¤¨­¿¾² ¢¥°¸¨­³ ± ¥¥ ¯®²®¬ª®¬, ­® ­¥ ¢µ®¤¿² ¢ ¤¥°¥¢® ¯®¨±ª  ¢ £«³¡¨­³.

±­®¢­»¥  «£®°¨²¬» ­  £° ´ µ

475

4. ¥°¥ª°¥±²­»¥ °¥¡°  (cross edges) | ¢±¥ ®±² «¼­»¥ °¥¡°  £° ´ . ­¨ ¬®£³² ±®¥¤¨­¿²¼ ¤¢¥ ¢¥°¸¨­» ®¤­®£® ¤¥°¥¢  ¯®¨±ª  ¢ £«³¡¨­³, ¥±«¨ ­¨ ®¤­  ¨§ ½²¨µ ¢¥°¸¨­ ­¥ ¿¢«¿¥²±¿ ¯°¥¤ª®¬ ¤°³£®©, ¨«¨
¦¥ ¢¥°¸¨­» ¨§ ° §­»µ ¤¥°¥¢¼¥¢.
  °¨±³­ª µ 23.4 ¨ 23.5 °¥¡°  ¯®¬¥·¥­» ¢ ±®®²¢¥²±²¢¨¨ ±® ±¢®¨¬
²¨¯®¬. ¨±. 23.5(c) ¯®ª §»¢ ¥² £° ´ °¨±. 23.5(a), ­ °¨±®¢ ­­»©
² ª, ·²®¡» ¯°¿¬»¥ °¥¡°  ¨ °¥¡°  ¤¥°¥¢¼¥¢ ¢¥«¨ ¢­¨§,   ®¡° ²­»¥
{ ¢¢¥°µ.
«£®°¨²¬ DFS ¬®¦¥² ¡»²¼ ¤®¯®«­¥­ ª« ±±¨´¨ª ¶¨¥© °¥¡¥° ¯®
¨µ ²¨¯ ¬. ¤¥¿ §¤¥±¼ ¢ ²®¬, ·²® ²¨¯ °¥¡°  (u; v ) ¬®¦­® ®¯°¥¤¥«¨²¼ ¯® ¶¢¥²³ ¢¥°¸¨­» v ¢ ²®² ¬®¬¥­², ª®£¤  °¥¡°® ¯¥°¢»© ° §
¨±±«¥¤³¥²±¿ (¯° ¢¤ , ¯°¿¬»¥ ¨ ¯¥°¥ª°¥±²­»¥ °¥¡°  ¯°¨ ½²®¬ ­¥
° §«¨· ¾²±¿): ¡¥«»© ¶¢¥² ®§­ · ¥² °¥¡°® ¤¥°¥¢ , ±¥°»© | ®¡° ²­®¥ °¥¡°®, ·¥°­»© | ¯°¿¬®¥ ¨«¨ ¯¥°¥ª°¥±²­®¥ °¥¡°®.
²®¡» ³¡¥¤¨²¼±¿ ¢ ½²®¬, ­ ¤® § ¬¥²¨²¼, ·²® ª ¬®¬¥­²³ ¢»§®¢ 
DFS-Visit(v ) ±¥°»¬¨ ¿¢«¿¾²±¿ ¢¥°¸¨­» ­  ¯³²¨ ®² ª®°­¿ ¤¥°¥¢  ª ¢¥°¸¨­¥ v ¨ ²®«¼ª® ®­¨ (¨­¤³ª¶¨¿ ¯® £«³¡¨­¥ ¢«®¦¥­­®±²¨
¢»§®¢ ). ²®¡» ®²«¨·¨²¼ ¯°¿¬»¥ °¥¡°  ®² ¯¥°¥ª°¥±²­»µ, ¬®¦­®
¢®±¯®«¼§®¢ ²¼±¿ ¯®«¥¬ d: °¥¡°® (u; v ) ®ª §»¢ ¥²±¿ ¯°¿¬»¬, ¥±«¨
d[u] < d[v ], ¨ ¯¥°¥ª°¥±²­»¬, ¥±«¨ d[u] > d[v ] (³¯°. 23.3-4).
¥®°¨¥­²¨°®¢ ­­»© ²°¥¡³¥² ®±®¡®£® ° ±±¬®²°¥­¨¿, ² ª ª ª ®¤­® ¨ ²® ¦¥ °¥¡°® (u; v ) = (v; u) ®¡° ¡ ²»¢ ¥±¿ ¤¢ ¦¤», ± ¤°³µ ª®­¶®¢, ¨ ¬®¦¥² ¯®¯ ±²¼ ¢ ° §­»¥ ª ²¥£®°¨¨. » ¡³¤¥¬ ®²­®±¨²¼ ¥£®
¢ ²®© ª ²¥£®°¨¨, ª®²®° ¿ ±²®¨² ° ­¼¸¥ ¢ ­ ¸¥¬ ¯¥°¥·­¥ ·¥²»°¥µ
ª ²¥£®°¨©. ®² ¦¥ ± ¬»© °¥§³«¼² ² ¯®«³·¨²±¿, ¥±«¨ ¬» ¡³¤¥¬ ±·¨² ²¼, ·²® ²¨¯ °¥¡°  ®¯°¥¤¥«¿¥²±¿ ¯°¨ ¥£® ¯¥°¢®© ®¡° ¡®²ª¥ ¨ ­¥
¬¥­¿¥²±¿ ¯°¨ ¢²®°®©.
ª §»¢ ¥²±¿, ·²® ¯°¨ ² ª¨µ ±®£« ¸¥­¨¿µ ¯°¿¬»µ ¨ ¯¥°¥ª°¥±²­»µ °¥¡¥° ¢ ­¥®°¨¥­²¨°®¢ ­­®¬ £° ´¥ ­¥ ¡³¤¥².
¥®°¥¬  23.9
°¨ ¯®¨±ª¥ ¢ £«³¡¨­³ ¢ ­¥®°¨¥­²¨°®¢ ­­®¬ £° ´¥ G «¾¡®¥ °¥¡°®
®ª §»¢ ¥²±¿ «¨¡® ¯°¿¬»¬, «¨¡® ®¡° ²­»¬.
®ª § ²¥«¼±²¢®.
³±²¼ (u; v ) | ¯°®¨§¢®«¼­®¥ °¥¡°® £° ´  G, ¨ ¯³±²¼, ­ ¯°¨¬¥°,
d[u] < d[v ]. ®£¤  ¢¥°¸¨­  v ¤®«¦­  ¡»²¼ ®¡­ °³¦¥­  ¨ ®¡° ¡®² ­  ¯°¥¦¤¥, ·¥¬ § ª®­·¨²±¿ ®¡° ¡®²ª  ¢¥°¸¨­» u, ² ª ª ª v ±®¤¥°¦¨²±¿ ¢ ±¯¨±ª¥ ±¬¥¦­»µ ± u ¢¥°¸¨­. ±«¨ °¥¡°® (u; v ) ¯¥°¢»©
° § ®¡° ¡ ²»¢ ¥²±¿ ¢ ­ ¯° ¢«¥­¨¨ ®² u ª v , ²® (u; v ) ±² ­®¢¨²±¿
°¥¡°®¬ ¤¥°¥¢ . ±«¨ ¦¥ ®­® ¯¥°¢»© ° § ®¡° ¡ ²»¢ ¥²±¿ ¢ ­ ¯° ¢«¥­¨¨ ®² v ª u, ²® ®­® ±² ­®¢¨²±¿ ®¡° ²­»¬ °¥¡°®¬ (ª®£¤  ®­®
¨±±«¥¤³¥²±¿, ¢¥°¸¨­  u | ±¥° ¿).
²  ²¥®°¥¬  ¡³¤¥² ­¥ ° § ¨±¯®«¼§®¢ ­  ¢ ±«¥¤³¾¹¨µ ° §¤¥« µ.
¯° ¦­¥­¨¿.
23.3-1
 °¨±³©²¥ ² ¡«¨¶³ 3  3, ±²°®ª¨ ¨ ±²®«¡¶» ª®²®°®© ®²¬¥·¥­»
ª ª ¡¥«»©, ±¥°»© ¨ ·¥°­»©.  ª ¦¤®© ª«¥²ª¥ (i; j ) ¯®¬¥²¼²¥,

476

« ¢  23 «£®°¨²¬» ­  £° ´ µ
¨±. 23.5

23.6 °¨¥­²¨°®¢ ­­»© £° ´ ¤«¿ ³¯°. 23.3-2 ¨ 23.3-3.

¬®¦¥² «¨ ¢ ¯°®¶¥±±¥ ¯®¨±ª  ¢ £«³¡¨­³ ­  ®°¨¥­²¨°®¢ ­­®¬ £° ´¥
­ ©²¨±¼ °¥¡°® ¨§ ¢¥°¸¨­» ¶¢¥²  i ¢ ¢¥°¸¨­³ ¶¢¥²  j , ¨ ª ª®£®
²¨¯  ¬®¦¥² ¡»²¼ ² ª®¥ °¥¡°®. ¤¥« ©²¥  ­ «®£¨·­³¾ ² ¡«¨¶³ ¤«¿
­¥®°¨¥­²¨°®¢ ­­»µ £° ´®¢.
23.3-2
°¨¬¥­¨²¥  «£®°¨²¬ ¯®¨±ª  ¢ £«³¡¨­³ ¤«¿ £° ´  °¨±. 23.6. ·¨² ©²¥, ·²® ¶¨ª« for ¢ ±²°®ª µ 5-7 ¯°®¶¥¤³°» DFS ¯¥°¥¡¨° ¥² ¢¥°¸¨­» ¢  «´ ¢¨²­®¬ ¯®°¿¤ª¥, ¨ ·²® ¢ ±¯¨±ª µ ±¬¥¦­»µ ¢¥°¸¨­ ®­¨
²®¦¥ ¨¤³² ¯®  «´ ¢¨²³.  ©¤¨²¥ ¢°¥¬¿ ®¡­ °³¦¥­¨¿ ¨ ®ª®­· ­¨¿
®¡° ¡®²ª¨ ª ¦¤®© ¢¥°¸¨­». ª ¦¨²¥ ²¨¯» ¢±¥µ °¥¡¥°.
23.3-3
 ¯¨¸¨²¥ ¢»° ¦¥­¨¥ ¨§ ±ª®¡®ª, ±®®²¢¥²±²¢³¾¹¥¥ ¯®¨±ª³ ¢ £«³¡¨­³ ¢ ¯°¥¤»¤³¹¥¬ ³¯° ¦­¥­¨¨.
23.3-4
®ª ¦¨²¥, ·²® °¥¡°® (u; v ) ¿¢«¿¥²±¿
a. °¥¡°®¬ ¤¥°¥¢  ¨«¨ ¯°¿¬»¬ °¥¡°®¬, ¥±«¨ ¨ ²®«¼ª® ¥±«¨ d[u] <
d[v] < f [v ] < f [u];
b. ®¡° ²­»¬ °¥¡°®¬, ¥±«¨ ¨ ²®«¼ª® ¥±«¨ d[v ] < d[u] < f [u] < f [v ];
c. ¯¥°¥ª°¥±²­»¬ °¥¡°®¬, ¥±«¨ ¨ ²®«¼ª® ¥±«¨ d[v ] < f [v ] < d[u] <
f [u].
23.3-5
®ª ¦¨²¥ ·²® ¤«¿ ­¥®°¨¥­²¨°®¢ ­­»µ £° ´®¢ ¢±¥ ° ¢­®, ®¯°¥¤¥«¿¥¬ «¨ ¬» ¥£® ²¨¯ ª ª ¯¥°¢»© ¨§ ·¥²»°¥µ ¢®§¬®¦­»µ ¢ ¯¥°¥·­¥,
¨«¨ ª ª ¥£® ²¨¯ ¯°¨ ¯¥°¢®© ®¡° ¡®²ª¥.
23.3-6
®±²°®©²¥ ª®­²°¯°¨¬¥° ª ² ª®© £¨¯®²¥§¥: ¥±«¨ ¢ ®°¨¥­²¨°®¢ ­­®¬ £° ´¥ G ±³¹¥±²¢³¥² ¯³²¼ ¨§ u ¢ v , ¨ ¥±«¨ d[u] < d[v ] ¯°¨ ¯®¨±ª¥
¢ £«³¡¨­³ ­  ½²®¬ £° ´¥, ²® v | ¯®²®¬®ª u ¢ ¯®±²°®¥­­®¬ «¥±³
¯®¨±ª  ¢ £«³¡¨­³.
23.3-7
®¤¨´¨¶¨°³©²¥  «£®°¨²¬ ¯®¨±ª  ¢ £«³¡¨­³ ² ª, ·²®¡» ®­ ¯¥· ² « ª ¦¤®¥ °¥¡°® ®°¨¥­²¨°®¢ ­­®£® £° ´  ¢¬¥±²¥ ± ¥£® ²¨¯®¬.
 ª¨¥ ¨§¬¥­¥­¨¿ ­³¦­» ¤«¿ ­¥®°¨¥­²¨°®¢ ­­®£® £° ´ ?
23.3-8
¡º¿±­¨²¥, ª ª ¢¥°¸¨­  ¬®¦¥² ®ª § ²¼±¿ ¥¤¨­±²¢¥­­®© ¢ ¤¥°¥¢¥ ¯®¨±ª  ¢ £«³¡¨­³, ¤ ¦¥ ¥±«¨ ³ ­¥¥ ¥±²¼ ª ª ¢µ®¤¿¹¨¥, ² ª ¨
¨±µ®¤¿¹¨¥ °¥¡° .
23.3-9
®ª ¦¨²¥, ·²® ± ¯®¬®¹¼¾ ¯®¨±ª  ¢ £«³¡¨­³ ¬®¦­® ­ ©²¨ ±¢¿§­»¥ ª®¬¯®­¥­²» ­¥®°¨¥­²¨°®¢ ­­®£® £° ´ , ¨ ·²® «¥± ¯®¨±ª  ¢
£«³¡¨­³ ¡³¤¥² ±®¤¥°¦ ²¼ ±²®«¼ª® ¦¥ ¤¥°¥¢¼¥¢, ±ª®«¼ª® ¥±²¼ ±¢¿§­»µ ª®¬¯®­¥­². «¿ ½²®£® ¨§¬¥­¨²¥  «£®°¨²¬ ¯®¨±ª  ² ª, ·²®¡»
ª ¦¤®© ¢¥°¸¨­¥ v ®­ ¯°¨±¢ ¨¢ « ­®¬¥° ®² 1 ¤® k (k | ·¨±«® ±¢¿§-

±­®¢­»¥  «£®°¨²¬» ­  £° ´ µ

477

¥°¥¢®¤» ­ §»¢ ­¨©: undershorts { ²°³±», pants { ¸² ­», belt {
°¥¬¥­¼, shirt { °³¡ ¸ª , tie { £ «±²³ª, jacket { ¯¨¤¦ ª, socks {
­®±ª¨, shoes { ¡®²¨­ª¨, watch { · ±».
¨±. 23.6 23.7 (a) °®´¥±±®° ²®¯®«®£¨·¥±ª¨ ±®°²¨°³¥² ±¢®¾ ®¤¥¦¤³ ¯® ³²° ¬.
¥¡°® (u; v) ®§­ · ¥², ·²® u ¤®«¦­® ¡»²¼ ­ ¤¥²® ¤® v. ¿¤®¬ ± ¢¥°¸¨­ ¬¨ ¯®ª § ­» ¢°¥¬¥­  ­ · «  ¨ ª®­¶  ®¡° ¡®²ª¨ ¯°¨ ¯®¨±ª¥ ¢ £«³¡¨­³. (b) ° ´ ²®¯®«®£¨·¥±ª¨ ®²±®°²¨°®¢ ­ (¢¥°¸¨­» ° ±¯®«®¦¥­» ¢ ¯®°¿¤ª¥ ³¡»¢ ­¨¿ ¢°¥¬¥­¨
®ª®­· ­¨¿ ®¡° ¡®²ª¨). ±¥ °¥¡°  ¨¤³² ±«¥¢ ® ­ ¯° ¢®.

­»µ ª®¬¯®­¥­²), ³ª §»¢ ¾¹¨©, ¢ ª ª®© ±¢¿§­®© ª®¬¯®­¥­²¥ ­ µ®¤¨²±¿ v .
23.3-10*
®¢®°¿², ·²® ®°¨¥­²¨°®¢ ­­»© £° ´ G = (V; E ) ®¡« ¤ ¥² ±¢®©±²¢®¬ ¥¤¨­±²¢¥­­®±²¨ ¯³²¨ (is singly connected), ¥±«¨ ¢ ­¥¬ ­¥
±³¹¥±²¢³¥² ¤¢³µ ° §­»µ ¯°®±²»µ ¯³²¥©, ¨¬¥¾¹¨µ ®¡¹¥¥ ­ · «® ¨
®¡¹¨© ª®­¥¶. ®±²°®©²¥ ½´´¥ª²¨¢­»©  «£®°¨²¬, ®¯°¥¤¥«¿¾¹¨©,
®¡« ¤ ¥² «¨ £° ´ ½²¨¬ ±¢®©±²¢®¬.
23.1.4. ®¯®«®£¨·¥±ª ¿ ±®°²¨°®¢ª 
³±²¼ ¨¬¥¥²±¿ ®°¨­¥²¨°®¢ ­­»© £° ´ ¡¥§ ¶¨ª«®¢ (directed
acyclic graph; ½²®  ­£«¨©±ª®¥ ­ §¢ ­¨¥ ¨­®£¤  ±®ª° ¹ ¾² ¤®
\dag").  ¤ ·  ® ²®¯®«®£¨·¥±ª®© ±®°²¨°®¢ª¥ (topological sort)
½²®£® £° ´  ±®±²®¨² ¢ ±«¥¤³¾¹¥¬: ­ ¤® ³ª § ²¼ ² ª®© «¨­¥©­»©
¯®°¿¤®ª ­  ¥£® ¢¥°¸¨­ µ, ·²® «¾¡®¥ °¥¡°® ¢¥¤¥² ®² ¬¥­¼¸¥©
¢¥°¸¨­» ª ¡®«¼¸¥© (¢ ±¬»±«¥ ½²®£® ¯®°¿¤ª ). ·¥¢¨¤­®, ·²®
¥±«¨ ¢ £° ´¥ ¥±²¼ ¶¨ª«», ² ª®£® ¯®°¿¤ª  ­¥ ±³¹¥±²¢³¥². ®¦­®
±´®°¬³«¨°®¢ ²¼ § ¤ ·³ ® ²®¯®«®£¨·¥±ª®© ±®°²¨°®¢ª¥ ¨ ² ª: ° ±¯®«®¦¨²¼ ¢¥°¸¨­» £° ´  ­  £®°¨§®­² «¼­®© ¯°¿¬®© ² ª, ·²®¡»
¢±¥ °¥¡°  ¸«¨ ±«¥¢  ­ ¯° ¢®. («®¢® À±®°²¨°®¢ª Á­¥ ¤®«¦­® ¢¢®¤¨²¼ ¢ § ¡«³¦¤¥­¨¥: ½²  § ¤ ·  ¢¥±¼¬  ®²«¨· ¥²±¿ ®² ®¡»·­®©
§ ¤ ·¨ ±®°²¨°®¢ª¨, ®¯¨± ­­®© ¢ · ±²¨ II.)
®² ¯°¨¬¥° ±¨²³ ¶¨¨, ¢ ª®²®°®© ¢®§­¨ª ¥² ² ª ¿ § ¤ · .  ±±¥¿­­»© ¯°®´¥±±®° ®¤¥¢ ¥²±¿ ¯® ³²° ¬, ¯°¨·¥¬ ª ª¨¥-²® ¢¥¹¨ ®¡¿§ ²¥«¼­® ­ ¤® ­ ¤¥¢ ²¼ ¤® ª ª¨µ-²® ¤°³£¨µ (­ ¯°°¨¬¥°, ­®±ª¨ |
¤® ¡ ¸¬ ª®¢); ¢ ¤°³£¨µ ±«³· ¿µ ½²® ¢±¥ ° ¢­® (­®±ª¨ ¨ ¸² ­», ­ ¯°¨¬¥°).   °¨±. 23.7 (a) ²°¥¡³¥¬»¥ ±®®²­®¸¥­¨¿ ¯®ª § ­» ¢ ¢¨¤¥
®°¨¥­²¨°®¢ ­­®£® £° ´ : °¥¡°® (u; v ) ®§­ · ¥², ·²® ¯°¥¤¬¥² u ¤®«¦¥­ ¡»²¼ ­ ¤¥² ¤® v . ®¯®«®£¨·¥±ª ¿ ±®°²¨°®¢ª  ½²®£® £° ´ , ²¥¬
± ¬»¬, ®¯¨±»¢ ¥² ¢®§¬®¦­»© ¯®°¿¤®ª ®¤¥¢ ­¨¿. ¤¨­ ¨§ ² ª¨µ
¯®°¿¤ª®¢ ¯®ª § ­ ­  °¨±. 23.7 (b) (­ ¤® ®¤¥¢ ²¼±¿ ±«¥¢  ­ ¯° ¢®).
«¥¤³¾¹¨© ¯°®±²®©  «£®°¨²¬ ²®¯®«®£¨·¥±ª¨ ±®°²¨°³¥² ®°¨¥­²¨°®¢ ­­»©  ¶¨ª«¨·¥±ª¨© £° ´.
Topological-Sort($G$)

478

« ¢  23 «£®°¨²¬» ­  £° ´ µ
1 »§¢ ²¼ DFS($G$), ¯°¨ ½²®¬,
2 § ¢¥°¸ ¿ ®¡° ¡®²ª³ ¢¥°¸¨­» (\textsc{DFS-Visit}, ±²°®ª  8),
¤®¡ ¢«¿²¼ ¥\"^^a5 ¢ ­ · «® ±¯¨±ª 
3 ¢¥°­³²¼ ¯®±²°®¥­­»© ±¯¨±®ª ¢¥°¸¨­

  °¨±³­ª¥ 23.7 (b) ¯®ª § ­ °¥§³«¼² ² ¯°¨¬¥­¥­¨¿ ² ª®£®  «£®°¨²¬ : §­ ·¥­¨¿ f [v ] ³¡»¢ ¾² ±«¥¢  ­ ¯° ¢®.
®¯®«®£¨·¥±ª ¿ ±®°²¨°®¢ª  ¢»¯®«­¿¥²±¿ §  ¢°¥¬¿ (V + E ), ¯®²®¬³ ·²® ±²®«¼ª® ¢°¥¬¥­¨ § ­¨¬ ¥² ¯®¨±ª ¢ £«³¡¨­³,   ¤®¡ ¢¨²¼
ª ¦¤³¾ ¨§ jV j ¢¥°¸¨­ ª ±¯¨±ª³ ¬®¦­® §  ¢°¥¬¿ O(1).
° ¢¨«¼­®±²¼ ½²®£®  «£®°¨²¬  ¤®ª §»¢ ¥²±¿ ± ¯®¬®¹¼¾ ² ª®©
«¥¬¬»:
¥¬¬  23.10
°¨¥­²¨°®¢ ­­»© £° ´ ­¥ ¨¬¥¥² ¶¨ª«®¢ ²®£¤  ¨ ²®«¼ª® ²®£¤ ,
ª®£¤  ¯®¨±ª ¢ £«³¡¨­³ ­¥ ­ µ®¤¨² ¢ ­¥¬ ®¡° ²­»µ °¥¡¥°.
®ª § ²¥«¼±²¢®.
): ¡° ²­® °¥¡°® ±®¥¤¨­¿¥² ¯®²®¬ª  ± ¯°¥¤ª®¬ ¨ ¯®²®¬³ § ¬»ª ¥² ¶¨ª«, ®¡° §®¢ ­­»© °¥¡° ¬¨ ¤¥°¥¢ .
(: ³±²¼ ¢ £° ´¥ ¨¬¥¥²±¿ ¶¨ª« c. ®ª ¦¥¬, ·²® ¢ ½²®¬ ±«³· ¥
¯®¨±ª ¢ £«³¡¨­³ ®¡¿§ ²¥«¼­® ­ ©¤¥² ®¡° ²­®¥ °¥¡°®. °¥¤¨ ¢¥°¸¨­
¶¨ª«  ¢»¡¥°¥¬ ¢¥°¸¨­³ v , ª®²®° ¿ ¡³¤¥² ®¡­ °³¦¥­  ¯¥°¢®©, ¨
¯³±²¼ (u; v ) | ¢¥¤³¹¥¥ ¢ ­¥¥ °¥¡°® ¶¨ª« . ®£¤  ¢ ¬®¬¥­² ¢°¥¬¥­¨
d[v] ¨§ v ¢ u ¢¥¤¥² ¯³²¼ ¨§ ¡¥«»µ ¢¥°¸¨­. ® ²¥®°¥¬¥ ® ¡¥«®¬ ¯³²¨
u ±² ­¥² ¯®²®¬ª®¬ v ¢ «¥±¥ ¯®¨±ª  ¢ £«³¡¨­³, ¯®½²®¬³ (u; v ) ¡³¤¥²
®¡° ²­»¬ °¥¡°®¬.
¥®°¥¬  23.11
°®¶¥¤³°  Topological-Sort(G) ¯° ¢¨«¼­® ¢»¯®«­¿¥² ²®¯®«®£¨·¥±ª³¾ ±®°²¨°®¢ª³ ®°¨¥­²¨°®¢ ­­®£® £° ´  G ¡¥§ ¶¨ª«®¢.
®ª § ²¥«¼±²¢®.
³¦­® ¤®ª § ²¼, ·²® ¤«¿ «¾¡®£® °¥¡°  (u; v ) ¢»¯®«­¥­® ­¥° ¢¥­±²¢® f [v ] < f [u].  ¬®¬¥­² ®¡° ¡®²ª¨ ½²®£® °¥¡°  ¢¥°¸¨­  v ­¥
¬®¦¥² ¡»²¼ ±¥°®© (½²® ®§­ · «® ¡», ·²® ®­  ¿¢«¿¥²±¿ ¯°¥¤ª®¬ u ¨
(u; v ) ¿¢«¿¥²±¿ ®¡° ²­»¬ °¥¡°®¬, ·²® ¯°®²¨¢®°¥·¨² «¥¬¬¥ 23.10).
®½²®¬³ v ¢ ½²®² ¬®¬¥­² ¤®«¦­  ¡»²¼ ¡¥«®© ¨«¨ ·¥°­®©. ±«¨ v
| ¡¥« ¿, ²® ®­  ±² ­®¢¨²±¿ °¥¡¥­ª®¬ u, ² ª ·²® f [v ] < f [u]. ±«¨
®­  ³¦¥ ·¥°­ ¿, ²® ²¥¬ ¡®«¥¥ f [v ] < f [u].
¯° ¦­¥­¨¿
23.4-1
 ª ª®¬ ¯®°¿¤ª¥ ° ±¯®«®¦¨² ¢¥°¸¨­» £° ´  °¨±. 23.8  «£®°¨²¬
Topological-Sort? (®°¿¤®ª ¯°®±¬®²°  ¢¥°¸¨­  «´ ¢¨²­»©.)
23.4-2
¥§³«¼² ² ° ¡®²»  «£®°¨²¬  Topological-Sort § ¢¨±¨² ®² ¯®°¿¤ª  ¯°®±¬®²°  ¢¥°¸¨­. ®ª ¦¨²¥, ·²® ° §«¨·­»¥ ³¯®°¿¤®·¥­¨¿
±¯¨±ª®¢ ±¬¥¦­»µ ¢¥°¸¨­ ¬®£³² ¯°¨¢¥±²¨ ª ®¤­®¬³ ¨ ²®¬³ ¦¥ °¥§³«¼² ²³.
23.4-3

±­®¢­»¥  «£®°¨²¬» ­  £° ´ µ

479

¨±. 23.7 23.9 (a) °¨¥­²¨°®¢ ­­»© £° ´ G ¨ ¥£® ±¨«¼­® ±¢¿§­»¥ ª®¬¯®­¥­²» (¯®ª § ­» ±¥°»¬). (b) ° ­±¯®­¨°®¢ ­­»© £° ´ GT . ®ª § ­® ¤¥°¥¢®
¯®¨±ª  ¢ £«³¡¨­³, ¢»·¨±«¿¥¬®¥ ¢ ±²°®ª¥ 3 ¯°®¶¥¤³°» Strongly-ConnectedComponents ¥¡°  ¤¥°¥¢  ®¡¢¥¤¥­» ±¥°»¬. ¥°¸¨­» b; c;g; h, ¿¢«¿¾¹¨¥±¿ ª®°­¿¬¨ ¤¥°¥¢¼¥¢ ¯®¨±ª  ¢ £«³¡¨­³ (¤«¿ £° ´  GT ), ¢»¤¥«¥­» ·¥°­»¬. (c) ¶¨ª«¨·¥±ª¨© £° ´, ª®²®°»© ¯®«³·¨²±¿, ¥±«¨ ±²¿­³²¼ ª ¦¤³¾ ±¨«¼­® ±¢¿§­³¾ ª®¬¯®­¥­²³ £° ´  G ¢ ²®·ª³.

°¨¤³¬ ©²¥  «£®°¨²¬, ®¯°¥¤¥«¿¾¹¨©, ¨¬¥¥²±¿ «¨ ¢ ¤ ­­®¬ ­¥®°¨¥­²¨°®¢ ­­®¬ £° ´¥ G = (V; E ) ¶¨ª«. ®¦­® «¨ ±¤¥« ²¼ ½²® § 
¢°¥¬¿ O(V ) (± ª®­±² ­²®©, ­¥ § ¢¨±¿¹¥© ®² jE j)?
23.4-4
¥°­® «¨, ·²® ¤«¿ ®°¨¥­²¨°®¢ ­­®£® £° ´  ± ¶¨ª« ¬¨  «£®°¨²¬
Topological-Sort ­ µ®¤¨² ¯®°¿¤®ª, ¯°¨ ª®²®°®¬ ·¨±«® À¯«®µ¨µÁ
°¥¡¥° (¨¤³¹¨µ ¢ ­¥¯° ¢¨«¼­®¬ ­ ¯° ¢«¥­¨¨) ¡³¤¥² ¬¨­¨¬ «¼­®?
23.4-5
°³£®© ±¯®±®¡ ²®¯®«®£¨·¥±ª®© ±®°²¨°®¢ª¨ ±®±²®¨² ¢ ²®¬, ·²®¡»
¯®±«¥¤®¢ ²¥«¼­® ­ µ®¤¨²¼ ¢¥°¸¨­» ± ¢µ®¤¿¹¥© ±²¥¯¥­¼¾ 0, ¯¥· ² ²¼ ¨µ ¨ ³¤ «¿²¼ ¨§ £° ´  ¢¬¥±²¥ ±® ¢±¥¬¨ ¢»µ®¤¿¹¨¬¨ ¨§ ­¨µ
°¥¡° ¬¨.  ª °¥ «¨§®¢ ²¼ ½²³ ¨¤¥¾, ·²®¡» ¢°¥¬¿ ¢»¯®«­¥­¨¿ ±®±² ¢¨«® O(V + E )? ²® ¯°®¨§®©¤¥², ¥±«¨ ¢ ¨±µ®¤­®¬ £° ´¥ ¥±²¼
¶¨ª«»?
23.5 ¨«¼­® ±¢¿§­»¥ ª®¬¯®­¥­²».
23.1.5. ¨«¼­® ±¢¿§­»¥ ª®¬¯®­¥­²»
« ±±¨·¥±ª®¥ ¯°¨¬¥­¥­¨¥ ¯®¨±ª  ¢ £«³¡¨­³ | § ¤ ·  ® ° §«®¦¥­¨¨ £° ´  ­  ±¨«¼­® ±¢¿§­»¥ ª®¬¯®­¥­²». » ¯®ª ¦¥¬, ª ª ½²®
¬®¦­® ±¤¥« ²¼, ¤¢ ¦¤» ¢»¯®«­¨¢ ¯®¨±ª ¢ £«³¡¨­³.
­®£¨¥  «£®°¨²¬», ° ¡®² ¾¹¨¥ ­  ®°¨¥­²¨°®¢ ­­»µ £° ´ µ,
­ ·¨­ ¾² ± ®²»±ª ­¨¿ ±¨«¼­® ±¢¿§­»µ ª®¬¯®­¥­²: ¯®±«¥ ½²®£® § ¤ ·  °¥¸ ¥²±¿ ®²¤¥«¼­® ¤«¿ ª ¦¤®© ª®¬¯®­¥­²»,   ¯®²®¬ °¥¸¥­¨¿ ª®¬¡¨­¨°³¾²±¿ ¢ ±®®²¢¥±²¢¨¨ ±® ±¢¿§¿¬¨ ¬¥¦¤³ ª®¬¯®­¥­² ¬¨. ²¨ ±¢¿§¨ ¬®¦­® ¯°¥¤±² ¢«¿²¼ ¢ ¢¨¤¥ ² ª ­ §»¢ ¥¬®£® À£° ´ 
ª®¬¯®­¥­²Á (³¯°. 23.5-4).
±¯®¬­¨¬ (£« ¢  5), ·²® ±¨«¼­® ±¢¿§­®© ª®¬¯®­¥­²®© ®°¨¥­²¨°®¢ ­­®£® £° ´  G = (V; E ) ­ §»¢ ¥²±¿ ¬ ª±¨¬ «¼­®¥ ¬­®¦¥±²¢®
¢¥°¸¨­ U  V ± ² ª¨¬ ±¢®©±²¢®¬: «¾¡»¥ ¤¢¥ ¢¥°¸¨­» u ¨ v ¨§ U
¤®±²¨¦¨¬» ¤°³£ ¨§ ¤°³£  (u v ¨ v u).
°¨¬¥° £° ´  ± ¢»¤¥«¥­­»¬¨ ±¨«¼­® ±¢¿§­»¬¨ ª®¬¯®­¥­² ¬¨
¯®ª § ­ ­  °¨±. 23.9.
«£®°¨²¬ ¯®¨±ª  ±¨«¼­® ±¢¿§­»µ ª®¬¯®­¥­² £° ´  G = (V; E )
¡³¤¥² ¨±¯®«¼§®¢ ²¼ À²° ­±¯®­¨°®¢ ­­»©Á £° ´ GT = (V; E T )
(³¯°. 23.1-3), ¯®«³· ¥¬»© ¨§ ¨±µ®¤­®£® ®¡° ¹¥­¨¥¬ ±²°¥«®ª ­ 
°¥¡° µ: E T = f(u; v ) : (v; u) 2 E g.  ª®© £° ´ ¬®¦­® ¯®±²°®¨²¼
§  ¢°¥¬¿ O(V + E ) (¬» ±·¨² ¥¬, ·²® ¨±µ®¤­»© ¨ ²° ­±¯®­¨°®¢ ­-

480

« ¢  23 «£®°¨²¬» ­  £° ´ µ

­»© £° ´» § ¤ ­» ± ¯®¬®¹¼¾ ±¯¨±ª®¢ ±¬¥¦­»µ ¢¥°¸¨­). ¥£ª®
¯®­¿²¼, ·²® G ¨ GT ¨¬¥¾² ®¤­¨ ¨ ²¥ ¦¥ ±¨«¼­® ±¢¿§­»¥ ª®¬¯®­¥­²» (¯®±ª®«¼ª³ v ¤®±²¨¦¨¬® ¨§ u ¢ GT , ¥±«¨ ¨ ²®«¼ª® ¥±«¨ u
¤®±²¨¦¨¬® ¨§ v ¢ GT ).   °¨±³­ª¥ 23.9 (b) ¯®ª § ­ ²°¥§³«¼² ²
²° ­±¯®­¨°®¢ ­¨¿ £° ´  °¨±. 23.9 (a).
«¥¤³¾¹¨©  «£®°¨²¬ ­ µ®¤¨² ±¨«¼­® ±¢¿§­»¥ ª®¬¯®­¥­²» ®°¨¥­²¨°®¢ ­­®£® £° ´  G = (V; E ), ¨±¯®«¼§³¿ ¤¢  ¯®¨±ª  ¢ £«³¡¨­³
| ¤«¿ G ¨ ¤«¿ GT ; ¢°¥¬¿ ° ¡®²» ¥±²¼ O(V + E ).
Strongly-Connected-Components($G$)
1 ± ¯®¬®¹¼¾ DFS($G$) ­ ©²¨ ¢°¥¬¿ ®ª®­· ­¨¿ ®¡° ¡®²ª¨ $f[u]$ ¤«¿
ª ¦¤®© ¢¥°¸¨­» $u$
2 ¯®±²°®¨²¼ $G^T$
3 ¢»§¢ ²¼ DFS($G^T$), ¯°¨ ½²®¬ ¢ ¥£® ¢­¥¸­¥¬ ¶¨ª«¥ ¯¥°¥¡¨° ²¼ ¢¥°¸¨­» ¢
¯®°¿¤ª¥ ³¡»¢ ­¨¿ ¢¥«¨·­» $f[u]$ (¢»·¨±«¥­­®© ¢ ±²°®ª¥ 1)
4 ±¨«¼­® ±¢¿§­»¬¨ ª®¬¯®­¥­² ¬¨ ¡³¤³² ¤¥°¥¢¼¿ ¯®¨±ª , ¯®±²°®¥­­»¥
­  ¸ £¥ 3.

 ¯¥°¢®£® ¢§£«¿¤  ½²®²  «£®°¨²¬ ª ¦¥²±¿ ­¥±ª®«¼ª® § £ ¤®·­»¬. £®  ­ «¨§ ¬» ­ ·­¥¬ ± ¤¢³µ ¯®«¥§­»µ ­ ¡«¾¤¥­¨©, ®²­®±¿¹¨µ±¿ ª ¯°®¨§¢®«¼­®¬³ ®°¨¥­²¨°®¢ ­­®¬³ £° ´³.
¥¬¬  23.12
±«¨ ¤¢¥ ¢¥°¸¨­» ¯°¨­ ¤«¥¦ ² ®¤­®© ±¨«¼­® ±¢¿§­®© ª®¬¯®­¥­²¥, ­¨ª ª®© ¯³²¼ ¬¥¦¤³ ­¨¬¨ ­¥ ¢»µ®¤¨² §  ¯°¥¤¥«» ½²®© ª®¬¯®­¥­²».
®ª § ²¥«¼±²¢®.
³±²¼ ¢¥°¸¨­  w «¥¦¨² ­  ¯³²¨ ¨§ u ¨ v , ¨ ¢¥°¸¨­» u ¨ v
¯°¨­ ¤«¥¦ ² ®¤­®© ±¨«¼­® ±¢¿§­®© ª®¬¯®­¥­²¥. ®£¤  u w, w
v ¨ v u, ®²ª³¤  ¢±¥ ¨ ±«¥¤³¥².
¥®°¥¬  23.13
 ¯°®¶¥±±¥ ¯®¨±ª  ¢ £«³¡¨­³ ¢¥°¸¨­» ®¤­®© ±¨«¼­® ±¢¿§­®© ª®¬¯®­¥­²» ¯®¯ ¤ ¾² ¢ ®¤­® ¨ ²® ¦¥ ¤¥°¥¢®.
®ª § ²¥«¼±²¢®.
«¿ ¯°®¨§¢®«¼­®© ±¨«¼­® ±¢¿§­®© ª®¬¯®­¥­²» ° ±±¬®²°¨¬ ¥¥
¢¥°¸¨­³, ®¡­ °³¦¥­­³¾ ¯¥°¢®© (®¡®§­ ·¨¬ ¥¥ r).  ½²®² ¬®¬¥­²
¢±¥ ®±² «¼­»¥ ¢¥°¸¨­» ª®¬¯®­¥­²» ¥¹¥ ¡¥«»¥ ¨ ¯®²®¬³ ¤®±²³¯­»
¨§ r ¯® ¡¥«»¬ ¯³²¿¬ (¢¥¤³¹¨¥ ¢ ­¨µ ¯³²¨ ­¥ ¢»µ®¤¿² §  ¯°¥¤¥«»
ª®¬¯®­¥­²» ¯® «¥¬¬¥ 23.12). ®½²®¬³ ¯® ²¥®°¥¬¥ ® ¡¥«®¬ ¯³²¨ ®­¨
¡³¤³² § ª° ¸¥­» ¯°¨ ¢»§®¢¥ DFS-Visit(r) ¨ ¢®©¤³² ¢ ²® ¦¥ ¤¥°¥¢®
¯®¨±ª .
®§¢° ¹ ¿±¼ ª  ­ «¨§³  «£®°¨²¬  Strongly-ConnectedComponents, ¤®£®¢®°¨¬±¿, ·²® d[u] ¨ f [u] ¡³¤³² ®¡®§­ · ²¼
¢°¥¬¿ ®¡­ °³¦¥­¨¿ ¨ ¢°¥¬¿ ®ª®­· ­¨¿ ®¡° ¡®²ª¨ ¢¥°¸¨­» v ,
­ ©¤¥­­»¥ ¢ ±²°®ª¥ 1  «£®°¨²¬ ,   § ¯¨±¼ u v ¡³¤¥² ®§­ · ²¼
±³¹¥±²¢®¢ ­¨¥ ¯³²¨ ¢ G (  ­¥ ¢ GT ).
«¿ ª ¦¤®© ¢¥°¸¨­» u £° ´  ®¯°¥¤¥«¨¬ ¥¥ ¯°¥¤¸¥±²¢¥­­¨ª 
(forefather) '(u) ª ª ²³ ¨§ ¢¥°¸¨­ w, ¤®±²¨¦¨¬»µ ¨§ u, ¤«¿ ª®²®°®©

±­®¢­»¥  «£®°¨²¬» ­  £° ´ µ

481

®¡° ¡®²ª  ¡»«  § ¢¥°¸¥­  ¯®§¤­¥¥ ¢±¥µ:
'(u) = ² ª ¿ ¢¥°¸¨­  w, ·²® u w ¨ f [w] ¬ ª±¨¬ «¼­®
°¨ ½²®¬ ¢¯®«­¥ ¬®¦¥² ®ª § ²¼±¿, ·²® '(u) = u.
 ª ª ª «¾¡ ¿ ¢¥°¸¨­  u ¤®±²¨¦¨¬  ± ¬  ¨§ ±¥¡¿,
f [u] 6 f ['(u)]
(23:2)
®ª ¦¥¬ ²¥¯¥°¼, ·²® '('(u)) = '(u).  ± ¬®¬ ¤¥«¥, ¤«¿ «¾¡»µ
¤¢³µ ¢¥°¸¨­ u; v 2 V
u v ) f ['(v)] 6 f ['(u)];
(23:3)
¯®²®¬³ ·²® fw : v wg  fw : u wg ¨ ¯°¥¤¸¥±²¢¥­­¨ª «¾¡®©
¢¥°¸¨­» ¨¬¥¥² ¬ ª±¨¬ «¼­®¥ ¢°¥¬¿ § ¢¥°¸¥­¨¿ ®¡° ¡®²ª¨ ±°¥¤¨
¢±¥µ ¤®±²¨¦¨¬»µ ¨§ ­¥¥ ¢¥°¸¨­. ®±ª®«¼ª³ ¢¥°¸¨­  '(u) ¤®±²¨¦¨¬  ¨§ u, ¨§ ´®°¬³«» (23.3) ¯®«³· ¥¬, ·²® f ['('(u))] 6 f ['(u)].
°®¬¥ ²®£®, ¨§ ­¥° ¢¥­±²¢  (23.2) ¨¬¥¥¬ f ['(u)] 6 f ['('(u))]. «¥¤®¢ ²¥«¼­® f ['('(u))] = f ['(u)] ¨ '('(u)) = '(u), ² ª ª ª ¤¢¥ ¢¥°¸¨­» ± ®¤­¨¬ ¢°¥¬¥­¥¬ § ¢¥°¸¥­¨¿ ®¡° ¡®²ª¨.
 ª ¬» ³¢¨¤¨¬, ¢ ª ¦¤®© ±¨«¼­® ±¢¿§­®© ª®¬¯®­¥­²¥ ¥±²¼ ¢¥°¸¨­ , ¿¢«¿¾¹ ¿±¿ ¯°¥¤¸¥±²¢¥­­¨ª®¬ ¢±¥µ ¢¥°¸¨­ ½²®© ª®¬¯®­¥­²». °¨ ¯®¨±ª¥ ¢ £«³¡¨­³ ¢ G ½²  ¢¥°¸¨­  ®¡­ °³¦¨¢ ¥²±¿ ¯¥°¢®©
¨ ®ª §»¢ ¥²±¿ ®¡° ¡®² ­­®© ¯®±«¥¤­¥© (±°¥¤¨ ¢¥°¸¨­ ½²®© ª®¬¯®­¥­²»). °¨ ¯®¨±ª¥ ¢ GT ®­  ±² ­®¢¨²±¿ ª®°­¥¬ ¤¥°¥¢  ¯®¨±ª  ¢
£«³¡¨­³.  ¢ ©²¥ ¤®ª ¦¥¬ ½²¨ ±¢®©±²¢ .
¨ª±¨°³¥¬ ­¥ª®²®°³¾ ±¨«¼­® ±¢¿§­³¾ ª®¬¯®­¥­²³ S .  ±±¬®²°¨¬ ¢¥°¸¨­³ v ½²®© ª®¬¯®­¥­²», ª®²®° ¿ ®¡­ °³¦¨¢ ¥²±¿ (¯°¨
¯®¨±ª¥ ¢ £«³¡¨­³) ¯¥°¢®©, ²® ¥±²¼ ¨¬¥¥² ¬¨­¨¬ «¼­®¥ §­ ·¥­¨¥ d[v ]
±°¥¤¨ ¢±¥µ v 2 S . §³·¨¬ ±¨²³ ¶¨¾, ª®²®° ¿ ¨¬¥¥² ¬¥±²® ­¥¯®±°¥¤±²¢¥­­® ¯¥°¥¤ ¢»§®¢®¬ DFS-Visit(V ).
1.  ½²®² ¬®¬¥­² ¢±¥ ¢¥°¸¨­» ¨§ S ¡¥«»¥. (±«¨ ½²® ­¥ ² ª,
¢¥°¸¨­  v ­¥ ¿¢«¿¥²±¿ ¯¥°¢®© ®¡­ °³¦¥­­®© ¢¥°¸¨­®© ¨§ S .)
2. ±¥ ¢¥°¸¨­» ª®¬¯®­¥­²» S ¤®±²¨¦¨¬» ¨§ v ¯® ¡¥«»¬ ¯³²¿¬.
( ± ¬®¬ ¤¥«¥, ¯® «¥¬¬¥ 23.12 ¯³²¨ ­¥ ¢»µ®¤¿² §  ¯°¥¤¥«» S .)
3. ¨ ®¤­  ±¥° ¿ ¢¥°¸¨­  ­¥ ¤®±²¨¦¨¬  ¨§ v . ( ± ¬®¬ ¤¥«¥,
¢ ¬®¬¥­² ¢»§®¢  DFS-Visit(v ) ±¥°»¥ ¢¥°¸¨­» ®¡° §³¾² ¯³²¼ ¨§
ª®°­¿ ¤¥°¥¢  ¯®¨±ª  ¢ v , ¯®½²®¬³ v ¤®±²¨¦¨¬  ¨§ «¾¡®© ±¥°®©
¢¥°¸¨­». ±«¨ ¡» ­¥ª®²®° ¿ ±¥° ¿ ¢¥°¸¨­  ¡»«  ¤®±²¨¦¨¬  ¨§ v ,
²® ®­  «¥¦ «  ¡» ¢ ®¤­®© ª®¬¯®­¥­²¥ ± v ,   ¢±¥ ² ª¨¥ ¢¥°¸¨­»
¡¥«»¥.)
4. ¾¡ ¿ ¡¥« ¿ ¢¥°¸¨­  w, ¤®±²¨¦¨¬ ¿ ¨§ v , ¤®±²¨¦¨¬  ¯® ¡¥«®¬³ ¯³²¨. ( ± ¬®¬ ¤¥«¥, ­  ¯³²¨ ¨§ v ¢ w ­¥ ¬®¦¥² ¡»²¼ ±¥°»µ
¢¥°¸¨­, ¯®½²®¬³ ¢±¥ ¢¥°¸¨­» ½²®£® ¯³²¨ ¨«¨ ¡¥«»¥, ¨¨«¨ ·¥°­»¥.
 ¤°³£®© ±²®°®­», ¯°¨ ¯®¨±ª¥ ¢ £«³¡¨­³ ­¨ª®£¤  ­¥ ¢®§­¨ª ¥² °¥¡°  ¨§ ·¥°­®© ¢¥°¸¨­» ¢ ¡¥«³¾, ¯®½²®¬³ ­  ½²®¬ ¯³²¨ ­¥ ¬®¦¥²
¡»²¼ ·¥°­»µ ¢¥°¸¨­.)

482

« ¢  23 «£®°¨²¬» ­  £° ´ µ

5. ±¥ ¢¥°¸¨­» ª®¬¯®­¥­²» S ¡³¤³² § ª° ¸¥­» ¯°¨ ¢»§®¢¥

DFS-Visit(v ) ¨ ¡³¤³² ¯®²®¬ª ¬¨ v ¢ ¤¥°¥¢¥ ¯®¨±ª . («¥¤³¥² ¨§

²¥®°¥¬» ® ¡¥«®¬ ¯³²¨.)
6. ±¥ ¢¥°¸¨­», ¤®±²¨¦¨¬»¥ ¨§ v , ¨¬¥¾² ¬¥­¼¸¥¥ ¢°¥¬¿ § ¢¥°¸¥­¨¿ ®¡° ¡®²ª¨, ·¥¬ ± ¬  v . ( ± ¬®¬ ¤¥«¥, ¤«¿ ·¥°­»µ ¢¥°¸¨­
½²® ®·¥¢¨¤­®, ² ª ª ª ®­¨ ³¦¥ ¡»«¨ ®¡° ¡®² ­» ª ¬®¬¥­²³ ­ · «  ®¡° ¡®²ª¨ v . «¿ ¡¥«»µ ½²® ²®¦¥ ¢¥°­®, ¯®±ª®«¼ª³ ®­¨ ¡³¤³²
®¡° ¡®² ­» ¢ µ®¤¥ ¢»§®¢  DFS-Visit(v ) ¤® ®ª®­· ­¨¿ ®¡° ¡®²ª¨
v.)
7. ¥°¸¨­  v ¿¢«¿¥²±¿ ±®¡±²¢¥­­»¬ ¯°¥¤¸¥±²¢¥­­¨ª®¬: '(v ) =
v. (°³£ ¿ ´®°¬³«¨°®¢ª  ¯°¥¤»¤³¹¥£® ³²¢¥°¦¤¥­¨¿.)
8. ¥°¸¨­  v ¿¢«¿¥²±¿ ¯°¥¤¸¥±²¢¥­­¨ª®¬ «¾¡®© ¢¥°¸¨­» u ª®¬¯®­¥­²» S . ( ± ¬®¬ ¤¥«¥, ¨§ u ¤®±²¨¦¨¬» ²¥ ¦¥ ¢¥°¸¨­», ·²® ¨§
v, ¨ ¯®²®¬³ ¢¥°¸¨­  ± ¬ ª±¨¬ «¼­»¬ ¢°¥¬¥­¥¬ § ¢¥°¸¥­¨¿ ¡³¤¥²
²®© ¦¥ ± ¬®©).
» ¢¨¤¨¬, ·²® ¢ ª ¦¤®© ±¨«¼­® ±¢¿§­®© ª®¬¯®­¥­²¥ ¥±²¼ ¢¥°¸¨­ , ª®²®° ¿ ®¡­ °³¦¨¢ ¥²±¿ ¯¥°¢®©, § ¢¥°¸ ¥² ®¡° ¡ ²»¢ ²¼±¿
¯®±«¥¤­¥© ¨ ¿¢«¿¥²±¿ ¯°¥¤¸¥±²¢¥­¨ª®¬ ¢±¥µ ¢¥°¸¨­ ½²®© ª®¬¯®­¥­²».
 ª¨¬ ®¡° §®¬, ¬» ¤®ª § «¨ ±«¥¤³¾¹¨¥ ³²¢¥°¦¤¥­¨¿:
¥®°¥¬  23.14
 ®°¨¥­²¨°®¢ ­­®¬ £° ´¥ G = (V; E ) ¯°¥¤¸¥±²¢¥­­¨ª '(u) «¾¡®© ¢¥°¸¨­» u 2 V ®ª §»¢ ¥²±¿ ¥¥ ¯°¥¤ª®¬ ¢ ¤¥°¥¢¥ ¯®¨±ª  ¢
£«³¡¨­³.
«¥¤±²¢¨¥ 23.15
°¨ «¾¡®¬ ¯®¨±ª¥ ¢ £«³¡¨­³ ­  ®°¨¥­²¨°®¢ ­­®¬ £° ´¥ G =
(V; E ) ¢¥°¸¨­» u ¨ '(u) «¥¦ ² ¢ ®¤­®© ±¨«¼­® ±¢¿§­®© ª®¬¯®­¥­²¥
¤«¿ «¾¡®© u 2 V .
¥®°¥¬  23.16
 ®°¨¥­²¨°®¢ ­­®¬ £° ´¥ G = (V; E ) ¤¢¥ ¢¥°¸¨­» «¥¦ ² ¢ ®¤­®©
±¨«¼­® ±¢¿§­®© ª®¬¯®­¥­²¥ ²®£¤  ¨ ²®«¼ª® ²®£¤ , ª®£¤  ®­¨ ¨¬¥¾²
®¡¹¥£® ¯°¥¤¸¥±²¢¥­­¨ª  ¯°¨ ¯®¨±ª¥ ¢ £«³¡¨­³.
² ª, § ¤ ·  ® ­ µ®¦¤¥­¨¨ ±¨«¼­® ±¢¿§­»µ ª®¬¯®­¥­² ±¢¥« ±¼
ª § ¤¥·¥ ®²»±ª ­¨¿ ¯°¥¤¸¥±²¢¥­­¨ª®¢ ¢±¥µ ¢¥°¸¨­ £° ´ . ¬¥­­® ¤«¿ ½²®£® ¨±¯®«¼§³¥²±¿ ¯®¨±ª ¢ £«³¡¨­³ ¢ ±²°®ª¥ 3  «£®°¨²¬ 
Strongly-Connected-Components.
²®¡» ¯®­¿²¼, ª ª ½²® ¤¥« ¥²±¿, ° ±±¬®²°¨¬ ±­ · «  ¢¥°¸¨­³ r
± ¬ ª±¨¬ «¼­»¬ §­ ·¥­¨¥¬ f [v ] ±°¥¤¨ ¢±¥µ ¢¥°¸¨­ £° ´  G. (®¢®°¿ ® §­ ·¥­¨¿µ f [v ], ¬» ¨¬¥¥¬ ¢ ¢¨¤³ §­ ·¥­¨¿, ¢»·¨±«¥­­»¥ ¢
±²°®ª¥ 1  «£®°¨²¬ .) ²® ¢¥°¸¨­  ¡³¤¥² ¯°¥¤¸¥±²¢¥­­¨ª®¬ «¾¡®©
¢¥°¸¨­», ¨§ ª®²®°®© ®­  ¤®±²¨¦¨¬  (­¨ ®¤­  ¢¥°¸¨­  £° ´  ­¥
¨¬¥¥² ¡®«¼¸¥£® §­ ·¥­¨¿ f [v ]).  ª¨¬ ®¡° §®¬, ®¤­³ ±¨«¼­® ±¢¿§­³¾ ª®¬¯®­¥­²³ ¬» ­ ¸«¨ | ½²® ¢¥°¸¨­», ¨§ ª®²®°»µ ¤®±²¨¦¨¬ 
r. °³£¨¬¨ ±«®¢ ¬¨, ½²® ¢¥°¸¨­», ¤®±²¨¦¨¬»¥ ¨§ v ¢ ²° ­±¯®­¨°®¢ ­­®¬ £° ´¥.
²¡°®±¨¢ ¢±¥ ¢¥°¸¨­» ­ ©¤¥­­®© ª®¬¯®­¥­²», ¢®§¼¬¥¬ ±°¥¤¨

±­®¢­»¥  «£®°¨²¬» ­  £° ´ µ

483

®±² ¢¸¨µ±¿ ¢¥°¸¨­³ r0 ± ¬ ª±¨¬ «¼­»¬ §­ ·¥­¨¥¬ f [v ]. ¾¡ ¿
®±² ¢¸ ¿±¿ ¢¥°¸¨­  u, ¨§ ª®²®°®© ¤®±²¨¦¨¬  r0, ¡³¤¥² ¨¬¥²¼ r0
±¢®¨¬ ¯°¥¤¸¥±²¢¥­­¨ª®¬ (­¨ ®¤­  ¨§ ®²¡°®¸¥­­»µ ¢¥°¸¨­ ­¥ ¤®±²¨¦¨¬  ¨§ u, ¨­ ·¥ ¨ r ¡»«  ¡» ¤®±²¨¦¨¬  ¨§ u ¨ ¢¥°¸¨­  u
¯®¯ «  ¡» ¢ ·¨±«® ®²¡°®¸¥­­»µ).  ª¨¬ ®¡° §®¬ ¬» ­ ©¤¥¬ ¢²®°³¾ ±¨«¼­® ±¢¿§­³¾ ª®¬¯®­¥­²³ | ¢ ­¥¥ ¢µ®¤¿² ²¥ ¨§ ®±² ¢¸¨µ±¿ ¢¥°¸¨­, ¨§ ª®²®°»µ ¤®±²¨¦¨¬  ¢¥°¸¨­  r0 (¤°³£¨¬¨ ±«®¢ ¬¨,
²¥ ¨§ ®±² ¢¸¨µ±¿, ª®²®°»¥ ¤®±²¨¦¨¬» ¨§ r0 ¢ ²° ­±¯®­¨°®¢ ­­®¬
£° ´¥).
¥¯¥°¼ ¯®­¿²¥­ ±¬»±« ±²°®ª¨ 3  «£®°¨²¬  StronglyConnected-Components: ¯®¨±ª ¢ £«³¡¨­³ ¢ ²° ­±¯®­¨°®¢ ­­®¬ £° ´¥ ¯®®·¥°¥¤­® À®²±« ¨¢ ¥²Á ±¨«¼­® ±¢¿§­»¥ ª®¬¯®­¥­²».
ª ¦¥¬ ²® ¦¥ ± ¬®¥ ¡®«¥¥ ´®°¬ «¼­®:
¥®°¥¬  23.17
«£®°¨²¬ Strongly-Connected-Components ¯° ¢¨«¼­® ­ µ®¤¨² ±¨«¼­® ±¢¿§­»¥ ª®¬¯®­¥­²» ®°¨¥­²¨°®¢ ­­®£® £° ´ .
®ª § ²¥«¼±²¢®.
 ±²°®ª¥ 3  «£®°¨²¬  ¯°®¨±µ®¤¨² ¢»§®¢  «£®°¨²¬  DFS ­ 
²° ­±¯®­¨°®¢ ­­®¬ £° ´¥. ²®²  «£®°¨²¬ ¯°®±¬ ²°¨¢ ¥² ¢¥°¸¨­» ¢ ¯®°¿¤ª¥ ³¡»¢ ­¨¿ ¯ ° ¬¥²°  f [v ], ¢»·¨±«¥­­®£® ¢ ±²°®ª¥ 1.
°¨ ½²®¬ ±²°®¿²±¿ ¤¥°¥¢¼¿ ¯®¨±ª , ¯°® ª®²®°»¥ ¬» µ®²¨¬ ¤®ª § ²¼, ·²® ®­¨ ¡³¤³² ±¨«¼­® ±¢¿§­»¬¨ ª®¬¯®­¥­² ¬¨.
  ª ¦¤®¬ ¸ £¥ ¶¨ª«  ° ±±¬ ²°¨¢ ¥²±¿ ®·¥°¥¤­ ¿ (¢ ¯®°¿¤ª¥
³¡»¢ ­¨¿ ¯ ° ¬¥²°  f ) ¢¥°¸¨­  v . ¥°¸¨­» ³¦¥ ¯®±²°®¥­­»µ ¤¥°¥¢¼¥¢ ¯®¨±ª  ¢ ½²®² ¬®¬¥­² ·¥°­»¥,   ®±² «¼­»¥ ¢¥°¸¨­» | ¡¥«»¥. ( ¬¥²¨¬, ·²® ¯°¨ ½²®¬ ¢±¿ª ¿ ¢¥°¸¨­ , ¤®±²¨¦¨¬ ¿ ¢ £° ´¥
GT ¨§ ·¥°­®©, ± ¬  ¡³¤¥² ·¥°­®©.)
±«¨ ®·¥°¥¤­ ¿ ¢¥°¸¨­  u ®ª §»¢ ¥²±¿ ·¥°­®©, ²®  «£®°¨²¬
DFS ­¥ ¤¥« ¥² ­¨·¥£®. ±«¨ ¦¥ ®­  ¡¥« ¿, ²® ¢»§®¢ ¯°®¶¥¤³°»
DFS-Visit(u) ¢ ±²°®ª¥ 7  «£®°¨²¬  DFS ±¤¥« ¥² ¥¥ ¨ ¢±¥ ¤®±²¨¦¨¬»¥ ¨§ ­¥¥ ¢ £° ´¥ GT ¢¥°¸¨­» ·¥°­»¬¨. » ¤®«¦­» ¯®ª § ²¼,
·²® ½²¨ ¢¥°¸¨­» ®¡° §³¾² ±¨«¼­® ±¢¿§­³¾ ª®¬¯®­¥­²³.
±«¨ ª ª ¿-²® ¡¥« ¿ ¢¥°¸¨­  v ¤®±²¨¦¨¬  ¨§ u ¢ £° ´¥ GT , ²®
u ¡³¤¥² ¯°¥¤¸¥±²¢¥­­¨ª®¬ v, ¯®±ª®«¼ª³ u ¤®±²¨¦¨¬  ¨§ v ¢ G,
­¨ª ª¨¥ ·¥°­»¥ ¢¥°¸¨­» ­¥ ¤®±²¨¦¨¬» ¨§ v ¢ G ¨ u ¨¬¥¥² ¬ ª±¨¬ «¼­®¥ §­ ·¥­¨¥ ¯ ° ¬¥²°  f ±°¥¤¨ ¢±¥µ ¡¥«»µ ¢¥°¸¨­.  ¤°³£®© ±²®°®­», ¥±«¨ ¡¥« ¿ ¢¥°¸¨­  v ­¥ ¤®±²¨¦¨¬  ¨§ u ¢ £° ´¥
GT , ²® ®­  ­¥ ¬®¦¥² ¨¬¥²¼ u ±¢®¨¬ ¯°¥¤¸¥±²¢¥­­¨ª®¬. ¥°­»¥
¢¥°¸¨­» ² ª¦¥ ­¥ ¬®£³² ¨¬¥²¼ u ±¢®¨¬ ¯°¥¤¸¥±²¢¥­­¨ª®¬ (¨µ
¯°¥¤¸¥±²¢¥­­¨ª¨ ­ ©¤¥­» ­  ¯°¥¤»¤³¹¨µ ¸ £ µ). ®½²®¬³ ¬­®¦¥±²¢® ¡¥«»µ ¢¥°¸¨­, ¤®±²¨¦¨¬»µ ¨§ u ¢ £° ´¥ GT , ±®¢¯ ¤ ¥² ±
¬­®¦¥±²¢®¬ ¢¥°¸¨­, ¨¬¥¾¹¨µ u ±¢®¨¬ ¯°¥¤¸¥±²¢¥­­¨ª®¬, ²® ¥±²¼
¿¢«¿¥²±¿ ±¨«¼­® ±¢¿§­®© ª®¬¯®­¥­²®©.
¯° ¦­¥­¨¿
23.5-1
 ª ¬®¦¥² ¨§¬¥­¨²±¿ ª®«¨·¥±²¢® ±¨«¼­® ±¢¿§­»µ ª®¬¯®­¥­² £° -

484

« ¢  23 «£®°¨²¬» ­  £° ´ µ

´  ¯°¨ ¤®¡ ¢«¥­¨¨ ª ­¥¬³ ®¤­®£® °¥¡° ?
23.5-2
°¨¬¥­²¥  «£®°¨²¬ Strongly-Connected-Components ª £° ´³ °¨±. 23.6.  ©¤¨²¥ ¢°¥¬¥­  § ¢¥°¸¥­¨¿, ¢»·¨±«¿¥¬»¥ ¢ ±²°®ª¥
1, ¨ «¥±, ±®§¤ ¢ ¥¬»© ±²°®ª®© 7. ·¨² ©²¥, ·²® ¶¨ª« ¢ ±²°®ª µ 5-7
 «£®°¨²¬  DFS ¯¥°¥¡¨° ¥² ¢¥°¸¨­» ¢  «´ ¢¨²­®¬ ¯®°¿¤ª¥ ¨ ·²®
±¯¨±ª¨ ±¬¥¦­»µ ¢¥°¸¨­ ² ª¦¥ ³¯®°¿¤®·¥­» ¯®  «´ ¬¨²³.
23.5-3
°®´¥±±®° °¥¸¨«, ·²®  «£®°¨²¬ ¯®¨±ª  ±¨«¼­® ±¢¿§­»µ ª®¬¯®­¥­² ¬®¦­® ³¯°®±²¨²¼, ¥±«¨ ¨±¯®«¼§®¢ ²¼ ¨±µ®¤­»© (  ­¥ ²° ­±¯®­¨°®¢ ­­®»©) £° ´ ¯°¨ ¢²®°®¬ ¯®¨±ª¥, ­® ¢¥°¸¨­» ±®°²¨°®¢ ²¼
¢ ¯®°¿¤ª¥ ³¢¥«¨·¥­¨¿ ¢°¥¬¥­ § ¢¥°¸¥­¨¿. ° ¢ «¨ ®­?
23.5-4
³±²¼ G | ®°¨¥­²¨°®¢ ­­»© £° ´. ±«¨ ±²¿­³²¼ ª ¦¤³¾ ¥£®
±¨«¼­® ±¢¿§­³¾ ª®¬¯®­¥­²³ ¢ ²®·ª³, ¨ ¯®±«¥ ½²®£® ®²®¦¤¥±²¢¨²¼
°¥¡°  ± ®¤¨­ ª®¢»¬¨ ­ · « ¬¨ ¨ ª®­¶ ¬¨, ¯®«³·¨²±¿ £° ´ ª®¬¯®­¥­² (component graph) GSCC = (V SCC ; E SCC ). °³£¨¬¨ ±«®¢ ¬¨,
½«¥¬¥­² ¬¨ V SCC ¿¢«¿¾²±¿ ±¨«¼­® ±¢¿§­»¥ ª®¬¯®­¥­²» G, ¨ E SCC
±®¤¥°¦¨² °¥¡°® (u; v ) ¢ ²®¬ ¨ ²®«¼ª® ¢ ²®¬ ±«³· ¥, ¥±«¨ ¢ G ¥±²¼
®°¨¥­²¨°®¢ ­­®¥ °¥¡°®, ­ · «® ª®²®°®£® ¯°¨­ ¤«¥¦¨² u,   ª®­¥¶
| v (±¬. ¯°¨¬¥° ­  °¨±. 23.9 (c)). ®ª ¦¨²¥, ·²® £° ´ ª®¬¯®­¥­²
­¥ ¨¬¥¥² ¶¨ª«®¢.
23.5-5
®±²°®©²¥  «£®°¨²¬, ­ µ®¤¿¹¨© §  ¢°¥¬¿ O(E + V ) £° ´ ª®¬¯®­¥­² ¤ ­­®£® ®°¨¥­²¨°®¢ ­­®£® £° ´ . ( ±²°®¨¬®¬ £° ´¥ «¾¡»¥
¤¢¥ ¢¥°¸¨­» ¤®«¦­» ¡»²¼ ±®¥¤¨­¥­» ­¥ ¡®«¥¥ ·¥¬ ®¤­¨¬ °¥¡°®¬.)
23.5-6
 ­ ®°¨¥­²¨°®¢ ­­»© £° ´ G = (V; E ).  ª ¯®±²°®¨²¼ ª ª ¬®¦­® ¬¥­¼¸¨© £° ´ G0 = (V; E 0), ª®²®°»© ¨¬¥« ¡» ²¥ ¦¥ ± ¬»¥ ±¨«¼­®
±¢¿§­»¥ ª®¬¯®­¥­²» ¨ ²®² ¦¥ £° ´ ª®¬¯®­¥­²? ®±²°®©²¥ ½´´¥ª²¨¢­»©  «£®°¨²¬ °¥¸¥­¨¿ ½²®© § ¤ ·¨.
23.5-7
°¨¥­²¨°®¢ ­­»© £° ´ ­ §»¢ ¥²±¿ G = (V; E ) ­ §»¢ ¥²±¿ ¯®«³±¢¿§­»¬ (semiconnected), ¥±«¨ ¤«¿ «¾¡»µ ¤¢³µ ¥£® ¢¥°¸¨­ u ¨ v
«¨¡® v ¤®±²¨¦¨¬  ¨§ u, «¨¡® u ¤®±²¨¦¨¬  ¨§ v . °¨¤³¬ ©²¥ ½´´¥ª²¨¢­»©  «£®°¨²¬, ®¯°¥¤¥«¿¾¹¨©, ¡³¤¥² «¨ £° ´ ¯®«³±¢¿§­»¬.
 ª®¢® ¢°¥¬¿ ¥£® ° ¡®²»?
 ¤ ·¨
23-1 « ±±¨´¨ª ¶¨¿ °¥¡¥° ¯°¨ ¯®¨±ª¥ ¢ ¸¨°¨­³
« ±±¨´¨¶¨°³¿ °¥¡°  £° ´  ¯® ²¨¯ ¬, ¬» ¨±µ®¤¨«¨ ¨§ ¤¥°¥¢  ¯®¨±ª  ¢ £«³¡¨­³. ­ «®£¨·­ ¿ ª« ±±¨´¨ª ¨¿ ¢®§¬®¦­® ¨ ¤«¿ ¤¥°¥¢ 
¯®¨±ª  ¢ ¸¨°¨­³ (¤«¿ °¥¡¥°, ¤®±²¨¦¨¬»µ ¨§ ­ · «¼­®© ¢¥°¸¨­»).
a. ®ª ¦¨²¥ ±«¥¤³¾¹¨¥ ±¢®©±²¢  ¤«¿ ±«³· ¿ ¯®¨±ª  ¢ ¸¨°¨­³ ¢
­¥®°¨¥­²¨°®¢ ­­®¬ £° ´¥:
1. ¥ ¡»¢ ¥² ¯°¿¬»µ ¨ ®¡° ²­»µ °¥¡¥°.
2. ±«¨ (u; v ) | °¥¡°® ¤¥°¥¢ , ²® d[v ] = d[u] + 1.

±­®¢­»¥  «£®°¨²¬» ­  £° ´ µ

485

23.10 ®·ª¨ ° §¤¥« , ¬®±²» ¨ ¤¢³±¢¿§­»¥ ª®¬¯®­¥­²» ±¢¿§­®£® ­¥®°¨¥­²¨°®¢ ­­®£® £° ´  (§ ¤ ·  23-2). ®·ª¨ ° §¤¥«  ¨ ¬®±²» | ²¥¬­®-±¥°»¥,
¤¢³±¢¿§­»¥ ª®¬¯®­¥­²» | ­ ¡®°» °¥¡¥° ¢ ¯°¥¤¥« µ ®¤­®© ±¥°®© ®¡« ±²¨ (¢­³²°¨ ª®²®°®© ³ª § ­® bcc).
¨±. 23.8

3. ±«¨ (u; v ) | ¯¥°¥ª°¥±²­®¥ °¥¡°®, ²® d[v ] = d[u] ¨«¨ d[v ] =

d[u] + 1.

b. ®ª ¦¨²¥ ±«¥¤³¾¹¨¥ ±¢®©±²¢  ¤«¿ ±«³· ¿ ¯®¨±ª  ¢ ¸¨°¨­³ ¢
®°¨¥­²¨°®¢ ­­®¬ £° ´¥:
1. ¥ ¡»¢ ¥² ¯°¿¬»µ °¥¡¥°.
2. ±«¨ (u; v ) { °¥¡°® ¤¥°¥¢ , ²® d[v ] = d[u] + 1.
3. ±«¨ (u; v ) { ¯¥°¥ª°¥±²­®¥ °¥¡°®, ²® d[v ] 6 d[u] + 1.
4. ±«¨ (u; v ) { ®¡° ²­®¥ °¥¡°®, ²® 0 6 d[v ] < d[u].
23-2 ®·ª¨ ° §¤¥« , ¬®±²» ¨ ¤¢³±¢¿§­»¥ ª®¬¯®­¥­²»
³±²¼ G = (V; E ) { ±¢¿§­»© ­¥®°¨¥­²¨°®¢ ­­»© £° ´. ®·ª 
° §¤¥«  (articulation point) £° ´  G | ½²® ¢¥°¸¨­ , ¯°¨ ³¤ «¥­¨¨
ª®²®°®© £° ´ G ¯¥°¥±² ¥² ¡»²¼ ±¢¿§­»¬. ®±² (bridge) | ½²®
°¥¡°® ±  ­ «®£¨·­»¬ ±¢®©±²¢®¬. ¢³±¢¿§­ ¿ ª®¬¯®­¥­²  (biconnected component) | ½²® ¬ ª±¨¬ «¼­»© ­ ¡®° °¥¡¥°, «¾¡»¥ ¤¢ 
°¥¡°  ª®²®°®£® ¯°¨­ ¤«¥¦ ² ®¡¹¥¬³ ¯°®±²®¬³ ¶¨ª«³ (±¬. ¯°¨¬¥° ­  °¨±. 23.10). ®·ª¨ ° §¤¥« , ¬®±²» ¨ ¤¢³±¢¿§­»¥ ª®¬¯®­¥­²»
¬®¦­® ­ ©²¨ ± ¯®¬®¹¼¾ ¯®¨±ª  ¢ £«³¡¨­³.
³±²¼ G = (V; E) | ¤¥°¥¢® ¯®¨±ª  ¢ £«³¡¨­³ ¢ £° ´¥ G.
a. ®ª ¦¨²¥, ·²® ª®°¥­¼ G ¿¢«¿¥²±¿ ²®·ª®© ° §¤¥« , ¥±«¨ ¨
²®«¼ª® ¥±«¨ ³ ­¥£® ¡®«¥¥ ®¤­®£® ±»­  ¢ G .
b. ³±²¼ v | ®²«¨·­ ¿ ®² ª®°­¿ ¢¥°¸¨­  G . ®ª ¦¨²¥, ·²® v
| ²®·ª  ° §¤¥«  G, ¥±«¨ ¨ ²®«¼ª® ¥±«¨ ­¥ ±³¹¥±²¢³¥² ®¡° ²­®£®
°¥¡°  (u; w), ¤«¿ ª®²®°®£® u | ¯®²®¬®ª v ¨ w | ¯°¥¤®ª v ¢ G ,
®²«¨·­»© ®² w.
c. ³±²¼ low [v ] | ¬¨­¨¬ «¼­®¥ ·¨±«® ±°¥¤¨ d[v ] ¨ ·¨±¥« d[w] ¤«¿
¢±¥µ w, ¤«¿ ª®²®°»µ ¨¬¥¥²±¿ ®¡° ²­®¥ °¥¡°® (u; w) ¤«¿ ­¥ª®²®°®©
¢¥°¸¨­» u, ¿¢«¿¾¹¥©±¿ ¯®²®¬ª®¬ v . ®ª ¦¨²¥, ª ª ¬®¦­® ¢»·¨±«¨²¼ low [v ] ¤«¿ ¢±¥µ v 2 V §  ¢°¥¬¿ O(V ).
d.  ª ­ ©²¨ ¢±¥ ²®·ª¨ ° §¤¥«  §  ¢°¥¬¿ O(E )?
e. ®ª ¦¨²¥, ·²® °¥¡°® £° ´  G ¿¢«¿¥²±¿ ¬®±²®¬ ¢ ²®¬ ¨ ²®«¼ª®
²®¬ ±«³· ¥, ª®£¤  ®­® ­¥ ¢µ®¤¨² ­¨ ¢ ª ª®© ¯°®±²®© ¶¨ª«.
f.  ª ­ ©²¨ ¢±¥ ¬®±²» £° ´  G §  ¢°¥¬¿ O(E )?
g. ®ª ¦¨²¥, ·²® ¤¢³±¢¿§­»¥ ª®¬¯®­¥­²» £° ´  ±®±² ¢«¿¾² ° §¡¨¥­¨¥ ¬­®¦¥±²¢  ¢±¥µ °¥¡¥° £° ´ , ­¥ ¿¢«¿¾¹¨µ±¿ ¬®±² ¬¨.
h. °¨¤³¬ ©²¥  «£®°¨²¬, ª®²®°»© §  ¢°¥¬¿ O(E ) ¯®¬¥· ¥² ª ¦¤®¥ °¥¡°® e £° ´  G ­¥ª®²®°»¬ ¶¥«»¬ ·¨±«®¬ bcc [e], ¯°¨ ½²®¬
¬¥²ª¨ ¤¢³µ °¥¡¥° ±®¢¯ ¤ ¾², ¥±«¨ ¨ ²®«¼ª® ¥±«¨ °¥¡°  ¯°¨­ ¤«¥¦ ² ®¤­®© ¤¢³±¢¿§­®© ª®¬¯®­¥­²¥.
23-3 ©«¥°®¢ ¶¨ª«
©«¥°®¢»¬ ¶¨ª«®¬ (Euler tour) ±¢¿§­®£® ®°¨¥­²¨°®¢ ­­®£® £° -

486

« ¢  23 «£®°¨²¬» ­  £° ´ µ

´  G = (V; E ) ­ §»¢ ¥²±¿ ¶¨ª«, ¯°®µ®¤¿¹¨© ¯® ª ¦¤®¬³ °¥¡°³ G
°®¢­® ®¤¨­ ° § (¢ ®¤­®© ¨ ²®© ¦¥ ¢¥°¸¨­¥ ¬®¦­® ¡»¢ ²¼ ¬­®£®ª° ²­®).
a. ®ª ¦¨²¥, ·²® ¢ G ¥±²¼ ½©«¥°®¢ ¶¨ª« ²®£¤  ¨ ²®«¼ª® ²®£¤ ,
ª®£¤  ¢µ®¤¿¹ ¿ ±²¥¯¥­¼ ª ¦¤®© ¢¥°¸¨­» ° ¢­  ¥¥ ¨±µ®¤¿¹¥© ±²¥¯¥­¨.
b. °¨¤³¬ ©²¥  «£®°¨²¬, ª®²®°»© §  ¢°¥¬¿ O(E ) ­ µ®¤¨² ¢ £° ´¥ ½©«¥°®¢ ¶¨ª« (¥±«¨ ² ª®¢®© ¨¬¥¥²±¿). (ª § ­¨¥: ®¡º¥¤¨­¿©²¥
¶¨ª«», ³ ª®²®°»µ ­¥² ®¡¹¨µ °¥¡¥°.)
 ¬¥· ­¨¿
°¥ª° ±­»¥ °³ª®¢®¤±²¢  ¯®  «£®°¨²¬ ¬ ­  £° ´ µ ­ ¯¨± «¨
¢¥­ [65] ¨  °¼¿­ [188].
®¨±ª ¢ ¸¨°¨­³ ° ±±¬®²°¥« ³° [150] ¯°¨ ¨§³·¥­¨¨ ¯³²¥© ¢ « ¡¨°¨­² µ. ¨ [134] ­¥§ ¢¨±¨¬® ®²ª°»« ²®² ¦¥  «£®°¨²¬ ¯°¨¬¥­¨²¥«¼­® ª ±®¥¤¨­¥­¨¿¬ ª®­² ª²®¢ ¢ ½«¥ª²°®­­»µ ±µ¥¬ µ.
®¯ª°®´² ¨  °¼¿­ [102] ³ª § «¨ ­  ¯®«¼§³ ¯°¥¤±² ¢«¥­¨¿ ¢ ¢¨¤¥ ±¯¨±ª®¢ ±¬¥¦­»µ ¢¥°¸¨­ ¤«¿ °¥¤ª¨µ £° ´®¢ ¨ ®¡­ °³¦¨«¨ ¢ ¦­®±²¼ ¯®¨±ª  ¢ £«³¡¨­³ ¤«¿ ¯®±²°®¥­¨¿  «£®°¨²¬®¢ ­  £° ´ µ.  ¬
¯® ±¥¡¥ ¯®¨±ª ¢ £«³¡¨­³ ­ · « ¨±¯®«¼§®¢ ²¼±¿ ­¥§ ¤®«£® ¤® 1960 £®¤ , ¢ ¯°¥¢³¾ ®·¥°¥¤¼ ¢ ¯°®£° ¬¬ µ, ±¢¿§ ­­»µ ± À¨±ª³±±²¢¥­­»¬
¨­²¥««¥ª²®¬Á.
 °¼¿­ [185] ¯°¨¤³¬ «  «£®°¨²¬ ¯®¨±ª  ±¨«¼­® ±¢¿§­»µ ª®¬¯®­¥­² §  «¨­¥©­®¥ ¢°¥¬¿. «£®°¨²¬ ° §¤¥«  23.5 ¢§¿² ¨§ ª­¨£¨
µ®, ®¯ª°®´²  ¨ «¼¬ ­  [5], ª®²®°»¥ ±±»« ¾²±¿ ­  ®± ° ¾
(S.R. Kosaraju) ¨  °¨°  (M. Sharir). ­³² [121] ¯¥°¢»¬ ¯®±²°®¨«
 «£®°¨²¬ ²®¯®«¨£¨·¥±ª®© ±®°²¨°®¢ª¨ §  «¨­¥©­®¥ ¢°¥¬¿.

24

¨­¨¬ «¼­»¥ ¯®ª°»¢ ¾¹¨¥ ¤¥°¥¢¼¿

³±²¼ ¤ ­» n ª®­² ª²®¢ ­  ¯¥· ²­®© ¯« ²¥, ª®²®°»¥ ¬» µ®²¨¬
½«¥ª²°¨·¥±ª¨ ±®¥¤¨­¨²¼. «¿ ½²®£® ¤®±² ²®·­® ¨±¯®«¼§®¢ ²¼ n ; 1
¯°®¢®¤®¢, ª ¦¤»© ¨§ ª®²®°»µ ±®¥¤¨­¿¥² ¤¢  ª®­² ª² . °¨ ½²®¬
¬» ®¡»·­® ±²°¥¬¨¬±¿ ±¤¥« ²¼ ±³¬¬ °­³¾ ¤«¨­³ ¯°®¢®¤®¢ ª ª
¬®¦­® ¬¥­¼¸¥.
¯°®¹ ¿ ±¨²³ ¶¨¾, ¬®¦­® ±´®°¬³«¨°®¢ ²¼ § ¤ ·³ ² ª. ³±²¼
¨¬¥¥²±¿ ±¢¿§­»© ­¥®°¨¥­²¨°®¢ ­­»© £° ´ G = (V; E ), ¢ ª®²®°®¬
V | ¬­®¦¥±²¢® ª®­² ª²®¢,   E | ¬­®¦¥±²¢® ¨µ ¢®§¬®¦­»µ ¯®¯ °­»µ ±®¥¤¨­¥­¨©. «¿ ª ¦¤®®£® °¥¡°  £° ´  (u; v ) § ¤ ­ ¢¥±
w(u; v ) (¤«¨­  ¯°®¢®¤ , ­¥®¡µ®¤¨¬®£® ¤«¿ ±®¥¤¨­¥­¨¿ u ¨ v ).  ¤ ·  ±®±²®¨² ¢ ­ µ®¦¤¥­¨¨ ¯®¤¬­®¦¥±²¢  T  E; ±¢¿§»¢ ¾¹¥£® ¢±¥
¢¥°¸¨­», ¤«¿ ª®²®°®£® ±³¬¬ °­»© ¢¥±

w(T ) =

X

(u;v)2T

w(u; v )

¬¨­¨¬ «¥­.  ª®¥ ¯®¤¬­®¦¥±²¢® T ¡³¤¥² ¤¥°¥¢®¬ (¯®±ª®«¼ª³ ­¥
¨¬¥¥² ¶¨ª«®¢: ¢ «¾¡®¬ ¶¨ª«¥ ®¤¨­ ¨§ ¯°®¢®¤®¢ ¬®¦­® ³¤ «¨²¼,
­¥ ­ °³¸ ¿ ±¢¿§­®±²¨). ¢¿§­»© ¯®¤£° ´ £° ´  G, ¿¢«¿¾¹¨©±¿ ¤¥°¥¢®¬ ¨ ±®¤¥°¦ ¹¨© ¢±¥ ¥£® ¢¥°¸¨­», ­ §»¢ ¾² ¯®ª°»¢ ¾¹¨¬ ¤¥°¥¢®¬ (spanning tree) ½²®£® £° ´ . (­®£¤  ¨±¯®«¼§³¾²
²¥°¬¨­ À®±²®¢­®¥ ¤¥°¥¢®Á; ¤«¿ ª° ²ª®±²¨ ¬» ¡³¤¥¬ £®¢®°¨²¼ ¯°®±²® À®±²®¢Á. )
 ½²®© £« ¢¥ ¬» ° ±±¬ ²°¨¢ ¥¬ § ¤ ·³ ® ¬¨­¨¬ «¼­®¬ ¯®ª°»¢ ¾¹¥¬ ¤¥°¥¢¥ (minimum-spanning-tree problem). (¤¥±¼ ±«®¢® À¬¨­¨¬ «¼­®¥Á ®§­ · ¥² À¨¬¥¾¹¥¥ ¬¨­¨¬ «¼­® ¢®§¬®¦­»© ¢¥±Á.)
  °¨±³­ª¥ 24.1 ¯°¨¢¥¤¥­ ¯°¨¬¥° ±¢¿§­®£® £° ´  ¨ ¥£® ¬¨­¨¬ «¼­®£® ®±²®¢ .
[®§¢° ¹ ¿±¼ ª ¯°¨¬¥°³ ± ¯°®¢®¤­¨ª ¬¨ ­  ¯¥· ²­®© ¯« ²¥, ®¡º¿±­¨¬, ¯®·¥¬³ § ¤ ·  ® ¬¨­¨¬ «¼­®¬ ¤¥°¥¢¥ ¿¢«¿¥²±¿ ³¯°®¹¥­¨¥¬
°¥ «¼­®© ±¨²³ ¶¨¨.  ± ¬®¬ ¤¥«¥, ¥±«¨ ±®¥¤¨­¿¥¬»¥ ª®­² ª²» ­ µ®¤¿²±¿ ¢ ¢¥°¸¨­ µ ¥¤¨­¨·­®£® ª¢ ¤° ² , ° §°¥¸ ¥²±¿ ±®¥¤¨­¿²¼
¥£® «¾¡»¥ ¢¥°¸¨­» ¨ ¢¥± ±®¥¤¨­¥­¨¿ ° ¢¥­ ¥£® ¤«¨­¥, ²® ¬¨­¨¬ «¼­®¥ ¯®ª°»¢ ¾¹¥¥ ¤¥°¥¢® ¡³¤¥² ±®±²®¿²¼ ¨§ ²°¥µ ±²®°®­ ª¢ ¤° ² . ¥¦¤³ ²¥¬ ¢±¥ ¥£® ·¥²»°¥ ¢¥°¸¨­» ¬®¦­® ½«¥ª²°¨·¥±ª¨

488

« ¢  24 ¨­¨¬ «¼­»¥ ¯®ª°»¢ ¾¹¨¥ ¤¥°¥¢¼¿

24.1 ¨­¨¬ «¼­®¥ ¯®ª°»¢ ¾¹¥¥ ¤¥°¥¢®.   ª ¦¤®¬ °¥¡°¥ £° ´ 
³ª § ­ ¢¥±. »¤¥«¥­» °¥¡°  ¬¨­¨¬ «¼­®£® ¯®ª°»¢ ¾¹¥£® ¤¥°¥¢  (±³¬¬ °­»©
¢¥± 37).  ª®¥ ¤¥°¥¢® ­¥ ¥¤¨­±²¢¥­­®: § ¬¥­¿¿ °¥¡°® (b; c) °¥¡°®¬ (a; h); ¯®«³· ¥¬ ¤°³£®¥ ¤¥°¥¢® ²®£® ¦¥ ¢¥±  37.
¨±. 24.1

±®¥¤¨­¨²¼
p ¤¢³¬¿ ¯¥°¥±¥ª ¾¹¨¬¨±¿ ¤¨ £®­ «¿¬¨ (±³¬¬ °­ ¿ ¤«¨­  2 2 < 3) ¨ ¤ ¦¥ ¥¹¥ ª®°®·¥ (¢¢¥¤¿ ¤¢¥ ¯°®¬¥¦³²®·­»¥ ²®·ª¨,
¢ ª®²®°»µ ¯°®¢®¤­¨ª¨ ±µ®¤¿²±¿ ¯®¤ ³£«®¬ 120.).]
 ½²®© £« ¢¥ ¬» ° ±±¬®²°¨¬ ¤¢  ±¯®±®¡  °¥¸¥­¨¿ § ¤ ·¨ ® ¬¨­¨¬ «¼­®¬ ¯®ª°»¢ ¾¹¥¬ ¤¥°¥¢¥:  «£®°¨²¬» °³±ª «  ¨ °¨¬ .
 ¦¤»© ¨µ ­¨µ «¥£ª® °¥ «¨§®¢ ²¼ ± ¢°¥¬¥­¥¬ ° ¡®²» O(E lg V ),
¨±¯®«¼§³¿ ®¡»·­»¥ ¤¢®¨·­»¥ ª³·¨. °¨¬¥­¨¢ ´¨¡®­ ··¨¥¢» ª³·¨,
¬®¦­® ±®ª° ²¨²¼ ¢°¥¬¿ ° ¡®²»  «£®°¨²¬  °¨¬  ¤® O(E + V lg V )
(·²® ¬¥­¼¸¥ E + lg V , ¥±«¨ jV j ¬­®£® ¬¥­¼¸¥ jE j).
¡   «£®°¨²¬  (°³±ª «  ¨ °¨¬ ) ±«¥¤³¾² À¦ ¤­®©Á ±²° ²¥£¨¨: ­  ª ¦¤®¬ ¸ £¥ ¢»¡¨° ¥²±¿ À«®ª «¼­® ­ ¨«³·¸¨©Á ¢ °¨ ­².
¥ ¤«¿ ¢±¥µ § ¤ · ² ª®© ¢»¡®° ¯°¨¢¥¤¥² ª ®¯²¨¬ «¼­®¬³ °¥¸¥­¨¾,
­® ¤«¿ § ¤ ·¨ ® ¯®ª°»¢ ¾¹¥¬ ¤¥°¥¢¥ ½²® ² ª. (» ®¡±³¦¤ «¨ ½²®
¢ £« ¢¥ 17; § ¤ ·  ® ¯®ª°»¢ ¾¹¥¬ ¤¥°¥¢¥ ¿¢«¿¥²±¿ ¯°¥¢®±µ®¤­®©
¨««¾±²° ¶¨¥© ¢¢¥¤¥­­»µ ² ¬ ¯®­¿²¨©.)
 ° §¤¥«¥ 24.1 ®¯¨± ­  ®¡¹ ¿ ±µ¥¬   «£®°¨²¬  ¯®±²°®¥­¨¿ ¬¨­¨¬ «¼­®£® ®±²®¢  (¤®¡ ¢«¥­¨¥ °¥¡¥° ®¤­®£® §  ¤°³£¨¬).  ° §¤¥«¥ 24.2 ³ª § ­» ¤¢¥ ª®­ª°¥²­»µ °¥ «¨§ ¶¨¨ ®¡¹¥© ±µ¥¬». ¥°¢»©
 «£®°¨²¬, ¢®±µ®¤¿¹¨© ª °³±ª «³,  ­ «®£¨·¥­  «£®°¨²¬³ ¯®¨±ª  ±¢¿§­»µ ª®¬¯®­¥­² ¨§ ° §¤¥«  22.1. °³£®© ( «£®°¨²¬ °¨¬ )
 ­ «®£¨·¥­  «£®°¨²¬³ ¥©ª±²°» ¯®¨±ª  ª° ²· ©¸¨µ ¯³²¥© (° §¤¥« 25.2).

24.1. ®±²°®¥­¨¥ ¬¨­¨¬ «¼­®£® ®±²®¢ 
² ª, ¯³±²¼ ¤ ­ ±¢¿§­»© ­¥®°¨¥­²¨°®¢ ­­»© £° ´  G = (V; E )
¨ ¢¥±®¢ ¿ ´³­ª¶¨¥© w : E ! R. » µ®²¨¬ ­ ©²¨ ¬¨­¨¬ «¼­®¥
¯®ª°»¢ ¾¹¥¥ ¤¥°¥¢® (®±²®¢), ±«¥¤³¿ ¦ ¤­®© ±²° ²¥£¨¨.
¡¹ ¿ ±µ¥¬  ¢±¥µ ­ ¸¨µ  «£®°¨²¬®¢ ¡³¤¥² ² ª®¢ . ±ª®¬»©
®±²®¢ ±²°®¨²±¿ ¯®±²¥¯¥­­®: ª ¨§­ · «¼­® ¯³±²®¬³ ¬­®¦¥±²¢³ A
­  ª ¦¤®¬ ¸ £¥ ¤®¡ ¢«¿¥²±¿ ®¤­® °¥¡°®. ­®¦¥±²¢® A ¢±¥£¤ 
¿¢«¿¥²±¿ ¯®¤¬­®¦¥±²¢®¬ ­¥ª®²®°®£® ¬¨­¨¬ «¼­®£® ®±²®¢ . ¥¡°®
(u; v ); ¤®¡ ¢«¿¥¬®¥ ­  ®·¥°¥¤­®¬ ¸ £¥, ¢»¡¨° ¥²±¿ ² ª, ·²®¡» ­¥
­ °³¸¨²¼ ½²®£® ±¢®©±²¢ : A [f(u; v )g ²®¦¥ ¤®«¦­® ¡»²¼ ¯®¤¬­®¦¥±²¢®¬ ¬¨­¨¬ «¼­®£® ®±²®¢ . » ­ §»¢ ¥¬ ² ª®¥ °¥¡°® ¡¥§®¯ ±­»¬
°¥¡°®¬ (safe edge) ¤«¿ A.
\textsc{Generic-MST} $(G,w)$
1 $A \leftarrow \emptyset$
2 {\bf while} $A$ ­¥ ¿¢«¿¥²±¿ ®±²®¢®¬

®±²°®¥­¨¥ ¬¨­¨¬ «¼­®£® ®±²®¢ 

489

24.2 ¢  ¨§®¡° ¦¥­¨¿ ®¤­®£® ¨ ²®£® ¦¥ ° §°¥§  £° ´  ± °¨±³­ª  24.1.
(a) ¥°¸¨­» ¬­®¦¥±²¢  S ¨§®¡° ¦¥­» ¡¥«»¬ ¶¢¥²®¬, ¥£® ¤®¯®«­¥­¨¿ V n S |
·¥°­»¬. ¥¡° , ¯¥°¥±¥ª ¾¹¨¥ ° §°¥§, ±®¥¤¨­¿¾² ¡¥«»¥ ¢¥°¸¨­» ± ·¥°­»¬¨.
¤¨­±²¢¥­­®¥ «¥£ª®¥ °¥¡°®, ¯¥°¥±¥ª ¾¹¥¥ ° §°¥§ | °¥¡°® (d; c): ­®¦¥±²¢® A
±®±²®¨² ¨§ ¢»¤¥«¥­­»µ ±¥°»¬ ¶¢¥²®¬ ¢»¤¥«¥­®.  §°¥§ (S; V n S ) ±®£« ±®¢ ­
± A (­¨ ®¤­® °¥¡°® ¨§ A ­¥ ¯¥°¥±¥ª ¥² ° §°¥§). (b) ¥°¸¨­» ¬­®¦¥±²¢  S
¨§®¡° ¦¥­» ±«¥¢ , ¢¥°¸¨­» V n S | ±¯° ¢ . ¥¡°® ¯¥°¥±¥ª ¥² ° §°¥§, ¥±«¨ ®­®
¯¥°¥±¥ª ¥² ¢¥°²¨ª «¼­³¾ ¯°¿¬³¾.
¨±. 24.2

3
{\bf do} ­ ©²¨ ¡¥§®¯ ±­®¥ °¥¡°® $(u,v)$ ¤«¿ $A$
4
$A \leftarrow A \cup \{(u,v)\}$
5 {\bf return} $A$

® ®¯°¥¤¥«¥­¨¾ ¡¥§®¯ ±­®£® °¥¡°  ¶¨ª« ­¥ ­ °³¸ ¥²±¿ ±¢®©±²¢  ÀA ¿¢«¿¥²±¿ ¯®¤¬­®¦¥±²¢®¬ ­¥ª®²®°®£® ¬¨­¨¬ «¼­®£® ®±²®¢ Á (¤«¿ ¯³±²®£® ¬­®¦¥±²¢  ½²® ±¢®©±²¢®, ®·¥¢¨¤­®, ¢»¯®«­¥­®),
² ª ·²® ¢ ±²°®ª¥ 5  «£®°¨²¬ ¢»¤ ¥² ¬¨­¨¬ «¼­»© ®±²®¢. ®­¥·­®, £« ¢­»© ¢®¯°®± ¢ ²®¬, ª ª ¨±ª ²¼ ¡¥§®¯ ±­®¥ °¥¡°® ¢ ±²°®ª¥ 3.
 ª®¥ °¥¡°® ±³¹¥±²¢³¥² (¥±«¨ A ¿¢«¿¥²±¿ ¯®¤¬­®¦¥±²¢®¬ ¬¨­¨¬ «¼­®£® ®±²®¢ , ²® «¾¡®¥ °¥¡°® ½²®£® ®±²®¢ , ­¥ ¢µ®¤¿¹¥¥ ¢ A,
¿¢«¿¥²±¿ ¡¥§®¯ ±­»¬).
 ¬¥²¨¬, ·²® ¬­®¦¥±²¢® A ­¥ ¬®¦¥² ±®¤¥°¦ ²¼ ¶¨ª«®¢ (¯®±ª®«¼ª³ ¿¢«¿¥²±¿ · ±²¼¾ ¬¨­¨¬ «¼­®£® ®±²®¢ ). ®½²®¬³ ¤®¡ ¢«¿¥¬®¥ ¢ ±²°®ª¥ 4 °¥¡°® ±®¥¤¨­¿¥² ° §«¨·­»¥ ª®¬¯®­¥­²» £° ´ 
GA = (V; A), ¨ ± ª ¦¤®© ¨²¥° ¶¨¥© ¶¨ª«  ·¨±«® ª®¬¯®­¥­² ³¬¥­¼¸ ¥²±¿ ­  1. ­ · «¥ ª ¦¤ ¿ ²®·ª  ¯°¥¤±² ¢«¿¥² ±®¡®© ®²¤¥«¼­³¾
ª®¬¯®­¥­²³; ¢ ª®­¶¥ ¢¥±¼ ®±²®¢ | ®¤­  ª®¬¯®­¥­² , ² ª ·²® ¶¨ª«
¯®¢²®°¿¥²±¿ jV j ; 1 ° §.
 ®±² ¢¸¥©±¿ · ±²¨ ½²®£® ° §¤¥«  ¬» ¯°¨¢¥¤¥¬ ¯° ¢¨«® ®²»±ª ­¨¿ ¡¥§®¯ ±­»µ °¥¡¥° (²¥®°¥¬  24.1).  ±«¥¤³¾¹¥¬ ° §¤¥«¥ ¡³¤³²
®¯¨± ­» ¤¢   «£®°¨²¬ , ¨±¯®«¼§³¾¹¨µ ½²® ¯° ¢¨«® ¤«¿ ½´´¥ª²¨¢­®£® ¯®¨±ª  ¡¥§®¯ ±­»µ °¥¡¥°.
 ·­¥¬ ± ®¯°¥¤¥«¥­¨©.  §°¥§®¬ (cut) (S; V n S ) ­¥®°¨¥­²¨°®¢ ­­®£® £° ´  G = (V; E ) ­ §»¢ ¥²±¿ ° §¡¨¥­¨¥ ¬­®¦¥±²¢  ¥£® ¢¥°¸¨­ ­  ¤¢  ¯®¤¬­®¦¥±²¢  (°¨±. 24.2).
®¢®°¿², ·²® °¥¡°® (u; v ) 2 E ¯¥°¥±¥ª ¥² (crosses) ° §°¥§ (S; V n
S ), ¥±«¨ ®¤¨­ ¨§ ¥£® ª®­¶®¢ «¥¦¨² ¢ S;   ¤°³£®© | ¢ V n S:  §°¥§
±®£« ±®¢ ­ ± ¬­®¦¥±²¢®¬ °¥¡¥° A (respects the set A), ¥±«¨ ­¨ ®¤­®
°¥¡°® ¨§ A ­¥ ¯¥°¥±¥ª ¥² ½²®² ° §°¥§. °¥¤¨ ¯¥°¥±¥ª ¾¹¨µ ° §°¥§ °¥¡¥° ¢»¤¥«¿¾² °¥¡°  ­ ¨¬¥­¼¸¥£® ¢¥±  (±°¥¤¨ ¯¥°¥±¥ª ¾¹¨µ
½²®² ° §°¥§), ­ §»¢ ¿ ¨µ «¥£ª¨¬¨ (light edges).
¥®°¥¬  24.1
³±²¼ G = (V; E ) | ±¢¿§­»© ­¥®°¨¥­²¨°®¢ ­­»© £° ´, ­  ¬­®¦¥±²¢¥ ¢¥°¸¨­ ª®²®°®£® ®¯°¥¤¥«¥­  ¢¥¹¥±²¢¥­­ ¿ ´³­ª¶¨¿ w.
³±²¼ A | ¬­®¦¥±²¢® °¥¡¥°, ¿¢«¿¾¹¥¥±¿ ¯®¤¬­®¦¥±²¢®¬ ­¥ª®²®°®£® ¬¨­¨¬ «¼­®£® ®±²®¢  £° ´  G. ³±²¼ (S; V n S ) | ° §°¥§
£° ´  G, ±®£« ±®¢ ­­»© ± A,   (u; v ) | «¥£ª®¥ °¥¡°® ¤«¿ ½²®£®

490

« ¢  24 ¨­¨¬ «¼­»¥ ¯®ª°»¢ ¾¹¨¥ ¤¥°¥¢¼¿
¨±. 24.3 24.3 (ª ¤®ª § ²¥«¼±²¢³ ²¥®°¥¬» 24.1). ¥°¸¨­» S | ·
¥°­»¥, ¢¥°¸¨­» V n S | ¡¥«»¥. §®¡° ¦¥­» ²®«¼ª® °¥¡°  ¬¨­¨¬ «¼­®£® ®±²®¢  (­ §®¢¥¬
¥£® T ). ¥¡°  ¬­®¦¥±²¢  A ¢»¤¥«¥­» ±¥°»¬ ¶¢¥²®¬; (u; v) | «¥£ª®¥ °¥¡°®, ¯¥°¥±¥ª ¾¹¥¥ ° §°¥§ (S; V n S ); (x;y) | °¥¡°® ¥¤¨­±²¢¥­­®£® ¯³²¨ p ®² u ª v ¢
T.

° §°¥§ . ®£¤  °¥¡°® (u; v ) ¿¢«¿¥²±¿ ¡¥§®¯ ±­»¬ ¤«¿ A:
®ª § ²¥«¼±²¢®
³±²¼ T | ¬¨­¨¬ «¼­»© ®±²®¢, ±®¤¥°¦ ¹¨© A. °¥¤¯®«®¦¨¬,
·²® T ­¥ ±®¤¥°¦¨² °¥¡°  (u; v ); ¯®±ª®«¼ª³ ¢ ¯°®²¨¢­®¬ ±«³· ¥ ¤®ª §»¢ ¥¬®¥ ³²¢¥°¦¤¥­¨¥ ®·¥¢¨¤­®. ®ª ¦¥¬, ·²® ¢ ½²®¬ ±«³· ¥ ±³¹¥±²¢³¥² ¤°³£®© ¬¨­¨¬ «¼­»© ®±²®¢ T 0, ±®¤¥°¦ ¹¨© °¥¡°® (u; v ),
² ª ·²® ½²® °¥¡°® ¿¢«¿¥²±¿ ¡¥§®¯ ±­»¬.
±²®¢ T ±¢¿§¥­ ¨ ¯®²®¬³ ±®¤¥°¦¨² ­¥ª®²®°»© ¯³²¼ p ¨§ u ¢ v
(°¨±. 24.3). ®±ª®«¼ª³ ¢¥°¸¨­» u ¨ v ¯°¨­ ¤«¥¦ ² ° §­»¬ · ±²¿¬
° §°¥§  (S; V n S ), ¢ ¯³²¨ p ¥±²¼ ¯® ª° ©­¥© ¬¥°¥ ®¤­® °¥¡°® (x; y ),
¯¥°¥±¥ª ¾¹¥¥ ° §°¥§. ²® °¥¡°® ­¥ «¥¦¨² ¢ A, ² ª ª ª ° §°¥§
±®£« ±®¢ ­ ± A. ¤ «¥­¨¥ ¨§ ¤¥°¥¢  T °¥¡°  (x; y ) ° §¡¨¢ ¥² ¥£®
­  ¤¢¥ ª®¬¯®­¥­²». ®¡ ¢«¥­¨¥ (u; v ) ®¡º¥¤¨­¿¥² ½²¨ ª®¬¯®­¥­²»
¢ ­®¢»© ®±²®¢ T 0 = T n f(x; y )g [ f(u; v )g:
®ª ¦¥¬, ·²® T 0 | ¬¨­¨¬ «¼­»© ®±²®¢. ®±ª®«¼ª³ (u; v ) |
«¥£ª®¥ °¥¡°®, ¯¥°¥±¥ª ¾¹¥¥ ° §°¥§ (S; V n S ), ¨§º¿²®¥ ¨§ T °¥¡°®
(x; y ) ¨¬¥¥² ­¥ ¬¥­¼¸¨© ¢¥±, ·¥¬ ¤®¡ ¢«¥­­®¥ ¢¬¥±²® ­¥£® °¥¡°®
(u; v ), ² ª ·²® ¢±¥ ®±²®¢  ¬®£ ²®«¼ª® ³¬¥­¼¸¨²¼±¿. ® ®±²®¢ ¡»«
¬¨­¨¬ «¼­»¬, §­ ·¨², ¢¥± ¥£® ®±² «±¿ ¯°¥¦­¨¬, ¨ ­®¢»© ®±²®¢ T 0
¡³¤¥² ¤°³£¨¬ ¬¨­¨¬ «¼­»¬ ®±²®¢®¬ (²®£® ¦¥ ¢¥± ). ®½²®¬³ °¥¡°® (u; v ), ±®¤¥°¦ ¹¥¥±¿ ¢ T 0, ¿¢«¿¥²±¿ ¡¥§®¯ ±­»¬.
«¥¤³¾¹¥¥ ±«¥¤±²¢¨¥ ²¥®°¥¬» 24.1 ¡³¤¥² ¨±¯®«¼§®¢ ­® ¢ ° §¤¥«¥ 24.2.
«¥¤±²¢¨¥ 24.2
³±²¼ G = (V; E ) | ±¢¿§­»© ­¥®°¨¥­²¨°®¢ ­­»© £° ´ ¨ ­  ¬­®¦¥±²¢¥ E ®¯°¥¤¥«¥­  ¢¥¹¥±²¢¥­­ ¿ ´³­ª¶¨¿ w. ³±²¼ A | ¬­®¦¥±²¢® °¥¡¥° £° ´ , ¿¢«¿¾¹¥¥±¿ ¯®¤¬­®¦¥±²¢®¬ ­¥ª®²®°®£® ¬¨­¨¬ «¼­®£® ®±²®¢ .  ±±¬®²°¨¬ «¥± GA = (V; A). ³±²¼ ¤¥°¥¢® C
| ®¤­  ¨§ ±¢¿§­»µ ª®¬¯®­¥­² «¥±  GA = (V; A).  ±±¬®²°¨¬ ¢±¥
°¥¡°  £° ´ , ±®¥¤¨­¿¹¨¥ ¢¥°¸¨­» ¨§ C ± ¢¥°¸¨­ ¬¨ ­¥ ¨§ C , ¨
¢®§¼¬¥¬ ±°¥¤¨ ­¨µ °¥¡°® ­ ¨¬¥­¼¸¥£® ¢¥± . ®£¤  ½²® °¥¡°® ¡¥§®¯ ±­® ¤«¿ A:
®ª § ²¥«¼±²¢®
®·¥¢¨¤­®: ° §°¥§ (C; V nC ) ±®£« ±®¢ ­ ± A,   °¥¡°® (u; v ) | «¥£ª®¥
°¥¡°® ¤«¿ ½²®£® ° §°¥§ .
¯° ¦­¥­¨¿
24.1-1
³±²¼ (u; v ) | °¥¡°® ¬¨­¨¬ «¼­®£® ¢¥±  ¢ £° ´¥ G: ®ª ¦¨²¥,
·²® (u; v ) ¯°¨­ ¤«¥¦¨² ­¥ª®²®°®¬³ ¬¨­¨¬ «¼­®¬³ ®±²®¢³ ½²®£®
£° ´ .

®±²°®¥­¨¥ ¬¨­¨¬ «¼­®£® ®±²®¢ 

491

24.1-2
°®´¥±±®° ³²¢¥°¦¤ ¥², ·²® ¢¥°­® ±«¥¤³¾¹¥¥ ®¡° ¹¥­¨¥ ²¥®°¥¬» 24.1. ³±²¼ G = (V; E ) | ±¢¿§­»© ­¥®°¨¥­²¨°®¢ ­­»© £° ´,
¨ ­  ¬­®¦¥±²¢¥ E ®¯°¥¤¥«¥­  ¢¥¹¥±²¢¥­­ ¿ ´³­ª¶¨¿ w. ³±²¼ A
| ¯®¤¬­®¦¥±²¢® E , ¿¢«¿¾¹¥¥±¿ ¯®¤¬­®¦¥±²¢®¬ ­¥ª®²®°®£® ¬¨­¨¬ «¼­®£® ®±²®¢  G. ³±²¼ (S; V n S ) | «¾¡®© ° §°¥§ G, ±®£« ±®¢ ­­»© ± A,   (u; v ) | ¡¥§®¯ ±­®¥ °¥¡°® ¤«¿ A, ¯¥°¥±¥ª ¾¹¥¥ (S; V n S ).
®£¤  °¥¡°® (u; v ) ¿¢«¿¥²±¿ «¥£ª¨¬ °¥¡°®¬, ¯¥°¥±¥ª ¾¹¨¬ ½²®²
° §°¥§. ®±²°®©²¥ ª®­²°¯°¨¬¥° ª ³²¢¥°¦¤¥­¨¾ ¯°®´¥±±®° .
24.1-3
®ª ¦¨²¥, ·²® ¥±«¨ °¥¡°® (u; v ) ±®¤¥°¦¨²±¿ ¢ ­¥ª®²®°®¬ ¬¨­¨¬ «¼­®¬ ®±²®¢¥, ²® ±³¹¥±²¢³¥² ­¥ª®²®°»© ° §°¥§ £° ´ , ¤«¿ ª®²®°®£® ®­® ¿¢«¿¥²±¿ «¥£ª¨¬ °¥¡°®¬, ¯¥°¥±¥ª ¾¹¨¬ ½²®² ° §°¥§.
24.1-4
 ±±¬®²°¨¬ ¬­®¦¥±²¢® ¢±¥µ °¥¡¥°, ª®²®°»¥ ¿¢«¿¾²±¿ «¥£ª¨¬¨
°¥¡° ¬¨ ¢±¥¢®§¬®¦­»µ ° §°¥§®¢ £° ´ . °¨¢¥¤¨²¥ ¯°®±²®© ¯°¨¬¥°, ª®£¤  ½²® ¬­®¦¥±²¢® ­¥ ¿¢«¿¥²±¿ ¬¨­¨¬ «¼­»¬ ®±²®¢®¬.
24.1-5
³±²¼ e | °¥¡°® ¬ ª±¨¬ «¼­®£® ¢¥±  ¢ ­¥ª®²®°®¬ ¶¨ª«¥ £° ´ 
G = (V; E ). ®ª ¦¨²¥, ·²® ±³¹¥±²¢³¥² ¬¨­¨¬ «¼­»© ®±²®¢ £° ´ 
G = (V; E n feg), ª®²®°»© ¿¢«¿¥²±¿ ² ª¦¥ ¬¨­¨¬ «¼­»¬ ®±²®¢®¬
£° ´  G.
24.1-6
®ª ¦¨²¥, ·²® ¥±«¨ ¤«¿ «¾¡®£® ° §°¥§  £° ´  ±³¹¥±²¢³¥² ¥¤¨­±²¢¥­­®¥ «¥£ª®¥ °¥¡°®, ¯¥°¥±¥ª ¾¹¥¥ ½²®² ° §°¥§, ²® ¢ £° ´¥ ¥±²¼
²®«¼ª® ®¤¨­ ¬¨­¨¬ «¼­»© ®±²®¢. ®ª ¦¨²¥, ·²® ®¡° ²­®¥ ³²¢¥°¦¤¥­¨¥ ­¥¢¥°­®.
24.1-7
¡º¿±­¨²¥, ¯®·¥¬³ ¢ £° ´¥ ± ¯®«®¦¨²¥«¼­»¬¨ ¢¥± ¬¨ °¥¡¥° «¾¡®¥ ¯®¤¬­®¦¥±²¢® °¥¡¥°, ±¢¿§»¢ ¾¹¥¥ ¢±¥ ¢¥°¸¨­» ¨ ®¡« ¤ ¾¹¥¥
¬¨­¨¬ «¼­»¬ ±³¬¬ °­»¬ ¢¥±®¬ (±°¥¤¨ ² ª¨µ ¯®¤¬­®¦¥±²¢), ¿¢«¿¥²±¿ ¤¥°¥¢®¬. °¨¢¥¤¨²¥ ¯°¨¬¥°, ¯®ª §»¢ ¾¹¨©, ·²® ½²® § ª«¾·¥­¨¥ ¯¥°¥±² ¥² ¡»²¼ ¢¥°­»¬, ¥±«¨ ¢¥±  °¥¡¥° ¬®£³² ¡»²¼ ®²°¨¶ ²¥«¼­»¬¨.
24.1-8
³±²¼ T | ¬¨­¨¬ «¼­»© ®±²®¢ £° ´  G. ®±² ¢¨¬ ³¯®°¿¤®·¥­­»© ±¯¨±®ª ¢¥±®¢ ¢±¥µ °¥¡¥° ®±²®¢  T . ®ª ¦¨²¥, ·²® ¤«¿ «¾¡®£®
¤°³£®£® ¬¨­¨¬ «¼­®£® ®±²®¢  ¯®«³·¨²±¿ ²®² ¦¥ ± ¬»© ±¯¨±®ª.
24.1-9
³±²¼ T | ¬¨­¨¬ «¼­»© ®±²®¢ £° ´  G = (V; E ). ³±²¼ V 0 |
¯®¤¬­®¦¥±²¢® V . ¥°¥§ T 0 ®¡®§­ ·¨¬ ¯®¤£° ´ T , ¯®°®¦¤¥­­»© V 0 ,
  ·¥°¥§ G0 | ¯®¤£° ´ G, ¯®°®¦¤¥­­»© V 0 . ®ª ¦¨²¥, ·²® ¥±«¨ T 0
±¢¿§¥­, ²® T 0 | ¬¨­¨¬ «¼­»© ®±²®¢ G0.

492

« ¢  24 ¨­¨¬ «¼­»¥ ¯®ª°»¢ ¾¹¨¥ ¤¥°¥¢¼¿

24.2. «£®°¨²¬» °³±ª «  ¨ °¨¬ 
¡  ½²¨µ  «£®°¨²¬  ±«¥¤³¾² ®¯¨± ­­®© ±µ¥¬¥, ­® ¯®-° §­®¬³ ¢»¡¨° ¾² ¡¥§®¯ ±­®¥ °¥¡°®.   «£®°¨²¬¥ °³±ª «  ¬­®¦¥±²¢® °¥¡¥°
A ¯°¥¤±² ¢«¿¥² ±®¡®© «¥±, ±®±²®¿¹¨© ¨§ ­¥±ª®«¼ª¨µ ±¢¿§­»µ ª®¬¯®­¥­² (¤¥°¥¢¼¥¢). ®¡ ¢«¿¥²±¿ °¥¡°® ¬¨­¨¬ «¼­®£® ¢¥±  ±°¥¤¨
¢±¥µ °¥¡¥°, ª®­¶» ª®²®°»µ «¥¦ ² ¢ ° §­»µ ª®¬¯®­¥­² µ.
  «£®°¨²¬¥ °¨¬¥ ¬­®¦¥±²¢® A ¯°¥¤±² ¢«¿¥² ±®¡®© ®¤­® ¤¥°¥¢®, ¥§®¯ ±­®¥ °¥¡°®, ¤®¡ ¢«¿¥¬®¥ ª A; ¢»¡¨° ¥²±¿ ª ª °¥¡°®
­ ¨¬¥­¼¸¥£® ¢¥± , ±®¥¤¨­¿¾¹¥¥ ½²® ³¦¥ ¯®±²°®¥­­®¥ ¤¥°¥¢® ± ­¥ª®²®°®© ­®¢®© ¢¥°¸¨­®©.
«£®°¨²¬ °³±ª « 
 «¾¡®© ¬®¬¥­² ° ¡®²»  «£®°¨²¬  °³±ª «  ¬­®¦¥±²¢® A ¢»¡° ­­»µ °¥¡¥° (· ±²¼ ¡³¤³¹¥£® ®±²®¢ ) ­¥ ±®¤¥°¦¨² ¶¨ª«®¢. ­®
±®¥¤¨­¿¥² ¢¥°¸¨­» £° ´  ¢ ­¥±ª®«¼ª® ±¢¿§­»µ ª®¬¯®­¥­², ª ¦¤ ¿
¨§ ª®²®°»µ ¿¢«¿¥²±¿ ¤¥°¥¢®¬. °¥¤¨ ¢±¥µ °¥°¥, ±®¥¤¨­¿¾¹¨µ ¢¥°¸¨­» ¨§ ° §­»µ ª®¬¯®­¥­², ¡¥°¥²±¿ °¥¡°® ­ ¨¬¥­¼¸¥£® ¢¥± .  ¤®
¯°®¢¥°¨²¼, ·²® ®­® ¿¢«¿¥²±¿ ¡¥§®¯ ±­»¬.
³±²¼ (u; v ) | ² ª®¥ °¥¡°®, ±®¥¤¨­¿¾¹¥¥ ¢¥°¸¨­» ¨§ ª®¬¯®­¥­²
C1 ¨ C2. ²® °¥¡°® ¿¢«¿¥²±¿ «¥£ª¨¬ °¥¡°®¬ ¤«¿ ° §°¥§  C1; V n C1, ¨
¬®¦­® ¢®±¯®«¼§®¢ ²¼±¿ ²¥®°¥¬®© 24.1 (¨«¨ ¯°¿¬® ±«¥¤±²¢¨¥¬ 24.2).
¥ «¨§ ¶¨¿  «£®°¨²¬  °³±ª «  ­ ¯®¬¨­ ¥²  «£®°¨²¬ ¢»·¨±«¥­¨¿ ±¢¿§­»µ ª®¬¯®­¥­² (° §¤. 22.1) ¨ ¨±¯®«¼§³¥² ±²°³ª²³°» ¤ ­­»µ ¤«¿ ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ¬­®¦¥±²¢ (£«. 22), «¥¬¥­² ¬¨ ¬­®¦¥±²¢ ¿¢«¿¾²±¿ ¢¥°¸¨­» £° ´ .  ¯®¬­¨¬, ·²® Find-Set(u) ¢®§¢° ¹ ¥² ¯°¥¤±² ¢¨²¥«¿ ¬­®¦¥±²¢ , ±®¤¥°¦ ¹¥£® ½«¥¬¥­² u: ¢¥
¢¥°¸¨­» u ¨ v ¯°¨­ ¤«¥¦ ² ®¤­®¬³ ¬­®¦¥±²¢³ (ª®¬¯®­¥­²¥), ¥±«¨
Find-Set(u) = Find-Set(v ). ¡º¥¤¨­¥­¨¥ ¤¥°¥¢¼¥¢ ¢»¯®«­¿¥²±¿
¯°®¶¥¤³°®© Union.
\textsc{MST-Kruskal}$(G,w)$
1 $A \leftarrow \emptyset$
2 {\bf for} $v\in V[G]$
3
{\bf do} \textsc{Make-Set}$(v)$
4 ³¯®°¿¤®·¨²¼ °\"^^a5¡°  $E$ ¯® ¢¥± ¬
5 {\bf for} $(u,v)\in E$ (¢ ¯®°¿¤ª¥ ¢®§° ±² ­¨¿ ¢¥± )
6
{\bf do if} \textsc{Find-Set}$(u) \noteq$ \textsc{Find-Set}$(v)$
7
{\bf then} $A \leftarrow A \cup \{(u,v)\}$
8
\textsc{Union} $(u,v)$
9 {\bf return} $A$

  °¨±³­ª¥ 24.4 ¯®ª §  ° ¡®²   «£®°¨²¬ . ­ · «  (±²°®ª¨ 1{3)
¬­®¦¥±²¢® A ¯³±²®, ¨ ¥±²¼ jV j ¤¥°¥¢¼¥¢, ª ¦¤®¥ ¨§ ª®²®°»µ ±®¤¥°¦¨² ¯® ®¤­®© ¢¥°¸¨­¥.  ±²°®ª¥ 4 °¥¡°  ¨§ E ³¯®°¿¤®·¨¢ ¾²±¿
¯® ­¥³¡»¢ ­¨¾ ¢¥± .  ¶¨ª«¥ (±²°®ª¨ 5{8) ¬» ¯°®¢¥°¿¥¬, «¥¦ ²

«£®°¨²¬» °³±ª «  ¨ °¨¬ 

493

24.4  ¡®²   «£®°¨²¬  °³±ª «  ­  £° ´¥ °¨±. 24.1. ¥¡°  ° ±²³¹¥£® «¥±  (A) ¢»¤¥«¥­» ±¥°»¬ ¶¢¥²®¬. ¥¡°  ° ±±¬ ²°¨¢ ¾²±¿ ¢ ¯®°¿¤ª¥ ­¥³¡»¢ ­¨¿ ¢¥±®¢ (²¥ª³¹¥¥ °¥¡°® ¯®ª § ­® ±²°¥«ª®©). ±«¨ °¥¡°® ±®¥¤¨­¿¥² ¤¢ 
° §«¨·­»µ ¤¥°¥¢ , ®­® ¤®¡ ¢«¿¥²±¿ ª «¥±³,   ¤¥°¥¢¼¿ ±«¨¢ ¾²±¿.
¨±. 24.4

«¨ ª®­¶» °¥¡°  ¢ ®¤­®¬ ¤¥°¥¢¥. ±«¨ ¤ , ²® °¥¡°® ­¥«¼§¿ ¤®¡ ¢¨²¼ ª «¥±³ (­¥ ±®§¤ ¢ ¿ ¶¨ª« ), ¨ ®­® ®²¡° ±»¢ ¥²±¿. ±«¨ ­¥², ²®
°¥¡°® ¤®¡ ¢«¿¥²±¿ ª A (±²°®ª  7), ¨ ¤¢  ±®¥¤¨­¥­­»µ ¨¬ ¤¥°¥¢ 
®¡º¥¤¨­¿¾²±¿ ¢ ®¤­® (±²°®ª  8).
®¤±·¨² ¥¬ ¢°¥¬¿ ° ¡®²»  «£®°¨²¬  °³±ª « . ³¤¥¬ ±·¨² ²¼,
·²® ¤«¿ µ° ­¥­¨¿ ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ¬­®¦¥±²¢ ¨±¯®«¼§³¥²±¿ ¬¥²®¤
° §¤¥«  22.3 (± ®¡º¥¤¨­¥­¨¥¬ ¯® ° ­£³ ¨ ±¦ ²¨¥¬ ¯³²¥© | ± ¬»©
¡»±²°»© ¨§ ¨§¢¥±²­»µ). ­¨¶¨ «¨§ ¶¨¿ § ­¨¬ ¥² ¢°¥¬¿ O(V ), ³¯®°¿¤®·¥­¨¥ °¥¡¥° ¢ ±²°®ª¥ 4 | O(E lg E ):  «¥¥ ¯°®¨§¢®¤¨²±¿ O(E )
®¯¥° ¶¨©, ¢ ±®¢®ª³¯­®±²¨ § ­¨¬ ¾¹¨µ ¢°¥¬¿ O(E(E; V )); £¤¥ 
| ´³­ª¶¨¿, ®¡° ²­ ¿ ª ´³­ª¶¨¨ ªª¥°¬ ­  (±¬. ° §¤¥« 22.4). ®±ª®«¼ª³ (E; V ) = o(lg E ); ®¡¹¥¥ ¢°¥¬¿ ° ¡®²»  «£®°¨²¬  °³±ª «  ±®±² ¢«¿¥² O(E lg E ) (®±­®¢­®¥ ¢°¥¬¿ ³µ®¤¨² ­  ±®°²¨°®¢ª³).
«£®°¨²¬ °¨¬ 
 ª ¨  «£®°¨²¬ °³±ª « ,  «£®°¨²¬ °¨¬  ±«¥¤³¥² ®¡¹¥© ±µ¥¬¥  «£®°¨²¬  ¯®±²°®¥­¨¿ ¬¨­¨¬ «¼­®£® ®±²®¢  ¨§ ° §¤¥«  24.1.
­ ¯®µ®¦ ­   «£®°¨²¬ ¥©ª±²°» ¯®¨±ª  ª° ²· ©¸¥£® ¯³²¨ ¢ £° ´¥ (° §¤¥« 25.2).  ½²®¬  «£®°¨²¬¥ ° ±²³¹ ¿ · ±²¼ ®±²®¢  ¯°¥¤±² ¢«¿¥² ±®¡®© ¤¥°¥¢® (¬­®¦¥±²¢® °¥¡¥° ª®²®°®£® ¥±²¼ A).  ª
¯®ª § ­® ­  °¨±. 24.5, ´®°¬¨°®¢ ­¨¥ ¤¥°¥¢  ­ ·¨­ ¥²±¿ ± ¯°®¨§¢®«¼­®© ª®°­¥¢®© ¢¥°¸¨­» r.   ª ¦¤®¬ ¸ £¥ ¤®¡ ¢«¿¥²±¿ °¥¡°®
­ ¨¬¥­¼¸¥£® ¢¥±  ±°¥¤¨ °¥¡¥° ±®¥¤¨­¿¾¹¨µ ¢¥°¸¨­» ½²®£® ¤¥°¥¢ 
± ¢¥°¸¨­ ¬¨ ­¥ ¨§ ¤¥°¥¢ . ® ±«¥¤±²¢¨¾ 24.2 ² ª¨¥ °¥¡°  ¿¢«¿¾²±¿
¡¥§®¯ ±­»¬¨ ¤«¿ A, ² ª ·²® ¢ °¥§³«¼² ²¥ ¯®«³· ¥²±¿ ¬¨­¨¬ «¼­»©
®±²®¢.
°¨ °¥ «¨§ ¶¨¨ ¢ ¦­® ¡»±²°® ¢»¡¨° ²¼ «¥£ª®¥ °¥¡°®. «£®°¨²¬
¯®«³· ¥² ­  ¢µ®¤ ±¢¿§­»© £° ´ G ¨ ª®°¥­¼ r ¬¨­¨¬ «¼­®£® ¯®ª°»¢ ¾¹¥£® ¤¥°¥¢ .  µ®¤¥  «£®°¨²¬  ¢±¥ ¢¥°¸¨­», ¥¹¥ ­¥ ¯®¯ ¢¸¨¥ ¢
¤¥°¥¢®, µ° ­¿²±¿ ¢ ®·¥°¥¤¨ ± ¯°¨®°¨²¥² ¬¨. °¨®°¨²¥² ¢¥°¸¨­» v
®¯°¥¤¥«¿¥²±¿ §­ ·¥­¨¥¬ key [v ], ª®²®°®¥ ° ¢­® ¬¨­¨¬ «¼­®¬³ ¢¥±³
°¥¡¥°, ±®¥¤¨­¿¾¹¨µ v c ¢¥°¸¨­ ¬¨ ¤¥°¥¢  A. (±«¨ ² ª¨µ °¥¡¥°
­¥², ¯®« £ ¥¬ key [v ] = 1:) ®«¥  [v ] ¤«¿ ¢¥°¸¨­ ¤¥°¥¢  ³ª §»¢ ¥²
­  °®¤¨²¥«¿,   ¤«¿ ¢¥°¸¨­» v 2 Q ³ª §»¢ ¥² ­  ¢¥°¸¨­³ ¤¥°¥¢ ,
¢ ª®²®°³¾ ¢¥¤¥² °¥¡°® ¢¥±  key[v ] (®¤­® ¨§ ² ª¨µ °¥¡¥°, ¥±«¨ ¨µ
­¥±ª®«¼ª®). » ­¥ µ° ­¨¬ ¬­®¦¥±²¢® A ¢¥°¸¨­ ±²°®¨¬®£® ¤¥°¥¢ 
¿¢­®; ¥£® ¬®¦­® ¢®±±² ­®¢¨²¼ ª ª
A = f(v; [v ]) : v 2 V n frg n Qg:
 ª®­¥¶ ° ¡®²»  «£®°¨²¬  ®·¥°¥¤¼ Q ¯³±² , ¨ ¬­®¦¥±²¢®
A = f(v; [v]) : v 2 V n frgg:

494

« ¢  24 ¨­¨¬ «¼­»¥ ¯®ª°»¢ ¾¹¨¥ ¤¥°¥¢¼¿

24.5  ¡®²   «£®°¨²¬  °¨¬  ­  £° ´¥ °¨±. 24.1 ± ª®°­¥¢®© ¢¥°¸¨­®© a ¥¡° , ¢µ®¤¿¹¨¥ ¢ ¤¥°¥¢® A. ¢»¤¥«¥­» ±¥°»¬; ¢¥°¸¨­» ¤¥°¥¢  | ·¥°­»¬.
  ª ¦¤®¬ ¸ £¥ ª A ¤®¡ ¢«¿¥²±¿ °¥¡°®, ¯¥°¥±¥ª ¾¹¥¥ ° §°¥§ ¬¥¦¤³ ¤¥°¥¢®¬
¨ ¥£® ¤®¯®«­¥­¨¥¬.  ¯°¨¬¥°, ­  ¢²®°®¬ ¸ £¥ ¬®¦­® ¡»«® ¡» ¤®¡ ¢¨²¼ «¾¡®¥
¨§ °¥¡¥° (b; c) ¨ (a; h):
¨±. 24.5

¥±²¼ ¬­®¦¥±²¢® ¢¥°¸¨­ ¯®ª°»¢ ¾¹¥£® ¤¥°¥¢ .
\textsc{MST-Prim}$(G,W,r)$
1 $Q \leftarrow V[G]$
2 {\bf for} $u\in Q$
3
{\bf do} $key[u] \gets \infty$
4 $key[r] \gets 0$
5 $\pi[r] \gets \textsc{nil}$
6 {\bf while} $Q \noteq \emptyset$
7
{\bf do} $u \leftarrow \textsc{Extract-Min}(Q)$
8
{\bf for} $v\in Adj[u]$
9
{\bf do if} $v\in Q$ ¨ $w(u,v)<key[v]$
10
{\bf then} $\pi(v) \leftarrow u$
11
$key(v) \leftarrow w(u,v)$

  °¨±. 24.5 ¯®ª § ­  ° ¡®²   «£®°¨²¬  °¨¬ . ®±«¥ ¨±¯®«­¥­¨¿ ±²°®ª 1{5 ¨ ¯¥°¢®£® ¯°®µ®¤  ¶¨ª«  ¢ ±²°®ª µ 6 ; ;11 ¤¥°¥¢®
±®±²®¨² ¨§ ¥¤¨­±²¢¥­­®© ¢¥°¸¨­» r, ¢±¥ ®±² «¼­»¥ ¢¥°¸¨­» ­ µ®¤¿²±¿ ¢ ®·¥°¥¤¨, ¨ §­ ·¥­¨¥ key[v ] ¤«¿ ­¨µ ° ¢­® ¤«¨­¥ °¥¡°  ¨§ r ¢
v ¨«¨ +1, ¥±«¨ ² ª®£® °¥¡°  ­¥² (¢ ¯¥°¢®¬ ±«³· ¥  [v ] = r.  ª¨¬
®¡° §®¬, ¢»¯®«­¥­ ®¯¨± ­­»© ¢»¸¥ ¨­¢ °¨ ­² (¤¥°¥¢® ¥±²¼ · ±²¼
­¥ª®²®°®£® ®±²®¢ , ¤«¿ ¢¥°¸¨­ ¤¥°¥¢  ¯®«¥  ³ª §»¢ ¥² ­  °®¤¨²¥«¿,   ¤«¿ ®±² «¼­»µ ¢¥°¸¨­ ­  À¡«¨¦ ©¸³¾Á ¢¥°¸¨­³ ¤¥°¥¢  |
¢¥± °¥¡°  ¤® ­¥¥ µ° ­¨²±¿ ¢ keu[v ].
°¥¬¿ ° ¡®²»  «£®°¨²¬  °¨¬  § ¢¨±¨² ®² ²®£®, ª ª ° ¢«¨§®¢ ­  ®·¥°¥¤¼ Q: ±«¨ ¨±¯®«¼§®¢ ²¼ ¤¢®¨·­³¾ ª³·³ (£« ¢  7), ¨­¨¶¨ «¨§ ¶¨¾ ¢ ±²°®ª µ 1{4 ¬®¦­® ¢»¯®«­¨²¼ ± ¯®¬®¹¼¾ ¯°®¶¥¤³°» Build-Heap §  ¢°¥¬¿ O(V ).  «¥¥ ¶¨ª« ¢»¯®«­¿¥²±¿ jV j ° §,
¨ ª ¦¤ ¿ ®¯¥° ¶¨¿ Extract-Min § ­¨¬ ¥² ¢°¥¬¿ O(lg V ), ¢±¥£®
O(V lg V ). ¨ª« for ¢ ±²°®ª µ 8{11 ¢»¯®«­¿¥²±¿ ¢ ®¡¹¥© ±«®¦­®±²¨
O(E ) ° §, ¯®±ª®«¼ª³ ±³¬¬  ±²¥¯¥­¥© ¢¥°¸¨­ £° ´  ° ¢­  2jE j. °®¢¥°ª³ ¯°¨­ ¤«¥¦­®±²¨ ¢ ±²°®ª¥ 9 ¢­³²°¨ ¶¨ª«  for ¬®¦­® °¥ «¨§®¢ ²¼ §  ¢°¥¬¿ O(1), ¥±«¨ µ° ­¨²¼ ±®±²®¿­¨¥ ®·¥°¥¤¨ ¥¹¥ ¨ ª ª ¡¨²®¢»© ¢¥ª²®° ° §¬¥°  jV j. °¨±¢ ¨¢ ­¨¥ ¢ ±²°®ª¥ 11 ¯®¤° §³¬¥¢ ¥²
¢»¯®«­¥­¨¥ ®¯¥° ¶¨¨ ³¬¥­¼¸¥­¨¿ ª«¾·  (Decrease-Key), ª®²®° ¿ ¤«¿ ¤¢®¨·­®© ª³·¨ ¬®¦¥² ¡»²¼ ¢»¯®«­¥­  §  ¢°¥¬¿ O(lg V ):
 ª¨¬ ®¡° §®¬, ¢±¥£® ¯®«³· ¥¬ O(V lg V + E lg V ) = O(E lg V ) |
²  ¦¥ ± ¬ ¿ ®¶¥­ª , ·²® ¡»«  ¤«¿  «£®°¨²¬  °³±ª « .
¤­ ª® ½²  ®¶¥­ª  ¬®¦¥² ¡»²¼ ³«³·¸¥­ , ¥±«¨ ¨±¯®«¼§®¢ ²¼
¢  «£®°¨²¬¥ °¨¬  ´¨¡®­ ··¨¥¢» ª³·¨.  ª ¬» ¢¨¤¥«¨ ¢ £« ¢¥ 21, ± ¯®¬®¹¼¾ ´¨¡¡®­ ·¨¥¢®© ª³·¨ ¬®¦­® ¢»¯®«­¿²¼ ®¯¥° ¶¨¾

«£®°¨²¬» °³±ª «  ¨ °¨¬ 

495

Extract-Min §  ³·¥²­®¥ ¢°¥¬¿ O(lg V );   ®¯¥° ¶¨¾ DecreaseKey | §  (³·¥²­®¥) ¢°¥¬¿ O(1). ( ± ¨­²¥°¥±³¥² ¨¬¥­­® ±³¬-

¬ °­®¥ ¢°¥¬¿ ¢»¯®«­¥­¨¿ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ®¯¥° ¶¨©, ² ª ·²®
 ¬®°²¨§¨°®¢ ­­»©  ­ «¨§ ²³² ¢ ± ¬»© ° §.) ®½²®¬³ ¯°¨ ¨±¯®«¼§®¢ ­¨¨ ´¨¡®­ ··¨¥¢»µ ª³· ¤«¿ °¥ «¨§ ¶¨¨ ®·¥°¥¤¨ ¢°¥¬¿ ° ¡®²»
 «£®°¨²¬  °¨¬  ±®±² ¢¨² O(E + V lg V ).
¯° ¦­¥­¨¿
24.2-1
«¿ ®¤­®£® ¨ ²®£® ¦¥ £° ´  G  «£®°¨²¬ °³±ª «  ¬®¦¥² ¤ ¢ ²¼
° §­»¥ °¥§³«¼² ²» (¥±«¨ ¯®-° §­®¬³ ³¯®°¿¤®·¨²¼ °¥¡°  ®¤¨­ ª®¢®£® ¢¥± ). ®ª ¦¨²¥, ·²® ¤«¿ ª ¦¤®£® ¬¨­¨¬ «¼­®£® ®±²®¢  T
£° ´  G ±³¹¥±²¢³¥² ³¯®°¿¤®·¥­¨¥ °¥¡¥° £° ´  G, ¯°¨ ª®²®°®¬
 «£®°¨²¬ °³±ª «  ¤ ±² ª ª ° § T:
24.2-2
° ´ (V; E ) § ¤ ­ ¬ ²°¨¶¥© ±¬¥¦­®±²¨. ®±²°®©²¥ ¯°®±²³¾ °¥ «¨§ ¶¨¾  «£®°¨²¬  °¨¬ , ¢°¥¬¿ ° ¡®²» ª®²®°®© ¥±²¼ O(V 2 ):
24.2-3
¬¥¥²±¿ «¨ ¢»¨£°»¸ ¯°¨ ¯¥°¥µ®¤¥ ®² ¤¢®¨·­»µ ª³· ª ´¨¡®­ ··¨¥¢»¬ ¤«¿ ° §°¥¦¥­­®£® £° ´  G = (V; E ) ¤«¿ ª®²®°®£®
jE j = (V )? ¤«¿ ¯«®²­®£® £° ´¥, £¤¥ jE j = (V 2)? °¨ ª ª®¬
±®®²­®¸¥­¨¨ ¬¥¦¤³ jE j ¨ jV j ¯¥°¥µ®¤ ª ´¨¡®­ ··¨¥¢»¬ ª³· ¬ ¯°¨¢®¤¨² ª  ±¨¬¯²®²·¥±ª®¬³ ³«³·¸¥­¨¾ ½´´¥ª²¨¢­®±²¨?
24.2-4
³±²¼ ¢¥±  °¥¡¥° £° ´  G = (V; E ) | ¶¥«»¥ ·¨±«  ¢ ¨­²¥°¢ «¥ ®²
1 ¤® jV j.  ª®© ±ª®°®±²¨ ° ¡®²»  «£®°¨²¬  °³±ª «  ¬®¦­® ¤®¡¨²¼±¿?  ¥±«¨ ¢¥±  | ¶¥«»¥ ·¨±«  ®² 1 ¤® W (£¤¥ W | ­¥ª®²®° ¿
ª®­±² ­² )?
24.2-5
³±²¼ ¢¥±  °¥¡¥° £° ´  G = (V; E ) | ¶¥«»¥ ·¨±«  ¢ ¨­²¥°¢ «¥
®² 1 ¤® jV j.  ª®© ±ª®°®±²¨ ° ¡®²»  «£®°¨²¬  °¨¬  ¬®¦­® ¤®¡¨²¼±¿?  ¥±«¨ ¢¥±  | ¶¥«»¥ ·¨±«  ®² 1 ¤® W (£¤¥ W | ­¥ª®²®° ¿
ª®­±² ­² )?
24.2-6
ª ¦¨²¥ ½´´¥ª²¨¢­»©  «£®°¨²¬ ¤«¿ ² ª®© § ¤ ·¨: ¤«¿ ¤ ­­®£®
£° ´  G ¨ ¢¥±®¢®© ´³­ª¶¨¥© w ­ ©²¨ ­ ¨«³·¸¥¥ ¯®ª°»¢ ¾¹¥¥
¤¥°¥¢®, ¥±«¨ ª°¨²¥°¨¥¬ Àª ·¥±²¢ Á ¤¥°¥¢  ±·¨² ²¼ ­¥ ±³¬¬³ ¢¥±®¢,
  ¢¥± ± ¬®£® ²¿¦¥«®£® °¥¡° .
24.2-7*
³±²¼ ¨§¢¥±²­®, ·²® ¢¥±  °¥¡¥° £° ´  | ­¥§ ¢¨±¨¬»¥ ±«³· ©­»¥
·¨±« , ° ¢­®¬¥°­® ° ±¯°¥¤¥«¥­­»¥ ­  ¯®«³¨­²¥°¢ «¥ [0; 1).  ª ½²®
¨±¯®«¼§®¢ ²¼ ¤«¿ ³±ª®°¥­¨¿ ° ¡®²» ®¤­®£® ¨§  «£®°¨²¬®¢ (°³±ª «  ¨«¨ °¨¬ )?
24.2-8*
³±²¼ ¬¨­¨¬ «¼­»© ®±²®¢ £° ´  G ³¦¥ ¯®±²°®¥­.  ª ¡»±²°®
¬®¦­® ­ ©²¨ ­®¢»© ¬¨­¨¬ «¼­»© ®±²®¢, ¥±«¨ ¤®¡ ¢¨²¼ ª £° ´³ G
­®¢³¾ ¢¥°¸¨­³ ¨ ¨­¶¨¤¥­²­»¥ ¥© °¥¡° ?

496

« ¢  24 ¨­¨¬ «¼­»¥ ¯®ª°»¢ ¾¹¨¥ ¤¥°¥¢¼¿

 ¤ ·¨
24-1 ²®°®© ¯® ¢¥«¨·¨­¥ ®±²®¢
³±²¼ G = (V; E ) | ­¥®°¨¥­²¨°®¢ ­­»© ±¢¿§­»© £° ´ ± ¢¥±®¢®© ´³­ª¶¨¥© w : E ! R, ¨ ¯³±²¼ jE j > jV j (·¨±«® °¥¡¥° ¡®«¼¸¥
¬¨­¨¬ «¼­® ¢®§¬®¦­®£®). ¯®°¿¤®·¨¬ ¢±¥ ¯®ª°»¢ ¾¹¨¥ ¤¥°¥¢¼¿
¢ ¯®°¿¤ª¥ ­¥³¡»¢ ­¨¿ ¢¥±®¢; ­ ± ¡³¤¥² ¨­²¥°¥±®¢ ²¼ ¢²®°®¥ ¯® ¢¥«¨·¨­¥ ¢ ½²®¬ ¯®°¿¤ª¥. (³¤¥¬ ±·¨² ²¼ ¤«¿ ¯°®±²®²», ·²® ¢±¥ ¤¥°¥¢¼¿ ¢ ½²®¬ ±¯¨±ª¥ ¨¬¥¾² ° §«¨·­»¥ ±³¬¬» ¢¥±®¢.)
a. ³±²¼ T | ¬¨­¨¬ «¼­®¥ ¯®ª°»¢ ¾¹¥¥ ¤¥°¥¢® £° ´  G: ®ª ¦¨²¥, ·²® ¢²®°®¥ ¯® ¢¥«¨·¨­¥ ¤¥°¥¢® ¯®«³· ¥²±¿ ¨§ T § ¬¥­®©
­¥ª®²®°®£® °¥¡°  (u; v ) 2 T ­  ¤°³£®¥ °¥¡°® (x; y ) 2= T .
b. ³±²¼ T | ¯®ª°»¢ ¾¹¥¥ ¤¥°¥¢® £° ´  G. «¿ «¾¡»µ ¤¢³µ
¢¥°¸¨­ u; v 2 V ·¥°¥§ max[u; v ] ®¡®§­ ·¨¬ °¥¡°® ¬ ª±¨¬ «¼­®£®
¢¥±  ­  ¥¤¨­±²¢¥­­®¬ ¯³²¨, ±®¥¤¨­¿¾¹¥¬ u ¨ v ¢ T . ª ¦¨²¥  «£®°¨²¬ ± ¢°¥¬¥­¥¬ ° ¡®²» O(V 2), ª®²®°»© ª®²®°»© ¤«¿ «¾¡®£®
§ ¤ ­­®£® T ­ µ®¤¨² max[u; v ] ¤«¿ ¢±¥µ ¯ ° ¢¥°¸¨­ u; v 2 V .
c. ª ¦¨²¥ ½´´¥ª²¨¢­»©  «£®°¨²¬ ¯®¨±ª  ¢²®°®£® ¯® ¢¥«¨·¨­¥
¯®ª°»¢ ¾¹¥£® ¤¥°¥¢ .
24-2 ¨­¨¬ «¼­»© ®±²®¢ ¢ ° §°¥¦¥­­®¬ £° ´¥
«¿ ®·¥­¼ ° §°¥¦¥­­®£® ±¢¿§­®£® £° ´  G = (V; E ) ¢°¥¬¿ ° ¡®²» O(E + V lg V )  «£®°¨²¬  °¨¬  (± ´¨¡®­ ··¨¥¢»¬¨ ª³· ¬¨)
¬®¦­® ¥¹¥ ±®ª° ²¨²¼, ¥±«¨ ¯°¥¤¢ °¨²¥«¼­® ¯°¥®¡° §®¢ ²¼ £° ´ G,
³¬¥­¼¸¨¢ ·¨±«® ¥£® ¢¥°¸¨­. ¯¨± ­­ ¿ ­¨¦¥ ¯°®¶¥¤³°  ¯°¥®¡° §®¢ ­¨¿ MST-Reduce ¯®«³· ¥² ­  ¢µ®¤ £° ´ G ± ¢¥±®¢®© ´³­ª¶¨¥© ¨ ¢®§¢° ¹ ¥² À±¦ ²³¾Á¢¥°±¨¾ G0 £° ´  G, ®¤­®¢°¥¬¥­­® ¤®¡ ¢«¿¿ °¥¡°  ª ¡³¤³¹¥¬³ ®±²®¢³. ²  ¯°®¶¥¤³°  ¨±¯®«¼§³¥² ¬ ±±¨¢
orig[u; v ]; ¢ ­ · «¼­»© ¬®¬¥­² orig[u; v ] = (u; v ).
¤¥¿ ¯°®±² : ¥±«¨ ¤«¿ ­¥ª®²®°®© ¢¥°¸¨­» ¢§¿²¼ ª° ²· ©¸¥¥ °¥¡°®, ¨§ ­¥¥ ¢»µ®¤¿¹¥¥, ²® ¬®¦­® ¨±ª ²¼ ¬¨­¨¬ «¼­»© ®±²®¢ ±°¥¤¨
®±²®¢®¢, ¢ª«¾· ¾¹¨µ ½²® °¥¡°® |   ½²  § ¤ ·  ±¢®¤¨²±¿ ª § ¤ ·¥
¯®¨±ª  ®±²®¢  ¤«¿ ¬¥­¼¸¥£® £° ´  (± ®²®¦¤¥±²¢«¥­­»¬¨ ¢¥°¸¨­ ¬¨). ¥¡° , ¯® ª®²®°»¬ ¯°®¢¥¤¥­  ±ª«¥©ª , ¯®¬¥¹ ¾²±¿ ¢ T ,  
¤«¿ ª ¦¤®£® °¥¡°  (u; v ), ±®¥¤¨­¿¾¹¥£® ¢¥°¸¨­» ­®¢®£® £° ´ ,
µ° ­¨²±¿ w[u; v ] | ²® °¥¡°® ¨±µ®¤­®£® £° ´ , ¨§ ª®²®°®£® ®­®
¯°®¨§®¸«® (¥±«¨ ² ª¨µ ¡»«® ­¥±ª®«¼ª®, ²® ¡¥°¥²±¿ ª° ²· ©¸¥¥).
\textsc{MST-Reduce} (G,T)
1 {\bf for} $v\in V[G]$
2
{\bf do} $mark[v] \leftarrow \textsc{false}$
3
\textsc{Make-Set(v)}
4 {\bf for} $u\in V[G]$
5
{\bf do if} $mark[u] = \textsc{false}$
6
{\bf then} ¢»¡° ²¼ $v\in Adj[u]$ ± ­ ¨¬¥­¼¸¨¬ $w[u,v]$
7
\textsc{Union(u,v)}
8
$T \leftarrow T\cup \{orig[u,v]\}$
9
$mark[u] \leftarrow $mark[v] \leftarrow

«£®°¨²¬» °³±ª «  ¨ °¨¬ 

10
11
12
13
14
15
16
17
18
19
20
21
22
23

497

\textsc{true}$
$V[G'] \leftarrow \{\textsc{Find-Set(v)} : v\in V[G] \}$
$E[G'] \leftarrow \emptyset$
{\bf for} $(x,y)\in E[G]$
{\bf do} $u \leftarrow \textsc{Find-Set(x)}$
$v \leftarrow \textsc{Find-Set(y)}$
{\bf if} $(u,v)\notin E[G']$
{\bf then} $E[G'] \leftarrow E[G']\cup\{(u,v)\}$
$orig[u,v] \leftarrow orig[x,y]$
$w[u,v] \leftarrow w[x,y]$
{\bf else if} $w[x,y] < w[u,v]$
{\bf then} $orig[u,v] \leftarrow orig[x,y]$
$w[u,v] \leftarrow w[x,y]$
¯®±²°®¨²¼ ±¯¨±ª¨ ±¬¥¦­»µ ¢¥°¸¨­ $Adj$ ¤«¿ $G'$
{\bf return} $G'$ ¨ $T$

a. ³±²¼ T | ¬­®¦¥±²¢® °¥¡¥°, ¢®§¢° ¹¥­­®¥ ¯°®¶¥¤³°®© MSTReduce,   T 0 | ¬¨­¨¬ «¼­»© ®±²®¢ £° ´  G0 , ¢®§¢° ¹¥­­®£® ½²®©
¯°®¶¥¤³°®©. ®ª ¦¨²¥, ·²® T [ forig [x; y ] : (x; y ) 2 T 0g | ¬¨­¨¬ «¼­»© ®±²®¢ £° ´  G:
b. ®ª ¦¨²¥, ·²® jV [G0]j 6 jV j=2:
c. ®ª ¦¨²¥, ª ª °¥ «¨§®¢ ²¼ ¯°®¶¥¤³°³ MST-Reduce ² ª, ·²®¡» ®­  ¨±¯®«­¿« ±¼ §  ¢°¥¬¿ O(E ): (ª § ­¨¥. ±¯®«¼§³©²¥ ­¥±«®¦­»¥ ±²°³ª²³°» ¤ ­­»µ.)
d. ³±²¼ ¬» ¯®¤¢¥°£«¨ £° ´ k-ª° ²­®© ®¡° ¡®²ª¥ ± ¯®¬®¹¼¾
¯°®¶¥¤³°» MST-Reduce (¢»µ®¤ ®¤­®£® ¸ £  ¿¢«¿¥²±¿ ¢µ®¤®¬ ±«¥¤³¾¹¥£®). ¡º¿±­¨²¥, ¯®·¥¬³ ·²® ®¡¹¥¥ ¢°¥¬¿ ¢»¯®«­¥­¨¿ ¢±¥µ
k ¨²¥° ¶¨© ±®±² ¢«¿¥² O(kE ).
e. ³±²¼ ¯®±«¥ k ¯°¨¬¥­¥­¨© ¯°®¶¥¤³°» MST-Reduce ¬» ¢®±¯®«¼§®¢ «¨±¼  «£®°¨²¬®¬ °¨¬  ¤«¿ ±¦ ²®£® £° ´ . °¨ ½²®¬
¬®¦­® ¢»¡° ²¼ k ² ª, ·²®¡» ®¡¹¥¥ ¢°¥¬¿ ° ¡®²» ±®±² ¢¨«®
O(E lg lg V ). ®·¥¬³?  ª®© ¢»¡®°  ±¨¬¯²®²¨·¥±ª¨ ¬¨­¨¬¨§¨°³¥² ®¡¹¥¥ ¢°¥¬¿ ° ¡®²». ®·¥¬³?
f. °¨ ª ª®¬ ±®®²­®¸¥­¨¨ jE j ¨ jV j  «£®°¨²¬ °¨¬  ± ¯°¥¤¢ °¨²¥«¼­»¬ ±¦ ²¨¥¬ ½´´¥ª²¨¢­¥¥  «£®°¨²¬  °¨¬  ¡¥§ ² ª®£®
±¦ ²¨¿?
 ¬¥· ­¨¿
­¨£   °¼¿­  [188] ±®¤¥°¦¨² ®¡§®° § ¤ ·, ±¢¿§ ­­»µ ± ¬¨­¨¬ «¼­»¬¨ ¯®ª°»¢ ¾¹¨¬¨ ¤¥°¥¢¼¿¬¨, ¨ ¤ «¼­¥©¸³¾ ¨­´®°¬ ¶¨¾
® ­¨µ. ±²®°¨¾ § ¤ ·¨ ® ¬¨­¨¬ «¼­®¬ ¯®ª°»¢ ¾¹¥¬ ¤¥°¥¢¥ ®¯¨± «¨ °½µ¥¬ ¨ ¥«« [92].
 ª ³ª §»¢ ¥²  °¼¿­, ¢¯¥°¢»¥  «£®°¨²¬ ¯®±²°®¥­¨¿ ¬¨­¨¬ «¼­®£® ®±²®¢  ¯®¿¢¨«±¿ ¢ ±² ²¼¥ ®°³¢ª¨ (O.Bor_uvka). «£®°¨²¬
°³±ª «  ®¯³¡«¨ª®¢ ­ ¢ ¥£® ±² ²¼¥ 1956 £®¤  [131]. «£®°¨²¬, ¨§¢¥±²­»© ª ª  «£®°¨²¬ °¨¬ , ¤¥©±²¢¨²¥«¼­® ¨§®¡°¥²¥­ ¨¬ ¨ ®¯¨± ­ ¢ [163], ­® ° ­¥¥ ¥£® ­ ¸¥« °­¨ª (V.Jarnik, 1930).

498

« ¢  24 ¨­¨¬ «¼­»¥ ¯®ª°»¢ ¾¹¨¥ ¤¥°¥¢¼¿

®§¬®¦­®±²¼ ¨±¯®«¼§®¢ ­¨¿ ¦ ¤­»µ  «£®°¨²¬®¢ ±¢¿§ ­  ± ²¥¬,
·²® °¥¡°  £° ´  ®¡° §³¾² ¬ ²°®¨¤, ¥±«¨ ­¥§ ¢¨±¨¬»¬¨ ±·¨² ²¼
¬­®¦¥±²¢  °¥¡¥° ¡¥§ ¶¨ª«®¢ (° §¤¥« 17.4).
 ¨¡®«¥¥ ¡»±²°»¬ ¨§ ¨§¢¥±²­»µ ¢ ­ ±²®¿¹¨© ¬®¬¥­²  «£®°¨²¬®¢ ¯®¨±ª  ¬¨­¨¬ «¼­®£® ®±²®¢  (¤«¿ ±«³· ¿ jE j = 
(V lg V )) ¿¢«¿¥²±¿  «£®°¨²¬ °¨¬ , °¥ «¨§®¢ ­­»© ± ¯®¬®¹¼¾ ´¨¡®­ ··¨¥¢®©
ª³·¨. «¿ ¡®«¥¥ ° §°¥¦¥­­»µ £° ´®¢ °¥¤¬ ­ ¨  °¼¿­ [75] ¯°¨¢®¤¿²  «£®°¨²¬, ¢°¥¬¿ ° ¡®²» ª®²®°®£® ±®±² ¢«¿¥² O(E (jE j; jV j));
£¤¥  (jE j; jV j) = minfi : lg(i) jV j 6 jE j=jV jg. ®±ª®«¼ª³ jE j > jV j,
¢°¥¬¿ ° ¡®²» ½²®£®  «£®°¨²¬  ¥±²¼ O(E lg V ).

25

° ²· ©¸¨¥ ¯³²¨ ¨§ ®¤­®© ¢¥°¸¨­»

¥°¥¤ ­ ¬¨ | ª °²   ¢²®¬®¡¨«¼­»µ ¤®°®£  ± ®¡®§­ ·¥­­»¬¨
° ±±²®¿­¨¿¬¨; ª ª ¢»¡° ²¼ ª° ²· ©¸¨© ¬ °¸°³² ®² ¨ª £® ¤®
®±²®­ ?
®¦­®, ª®­¥·­®, ¯¥°¥¡° ²¼ ¢±¥ ¢®§¬®¦­»¥ ¬ °¸°³²», ¯®¤±·¨² ²¼ ¤«¿ ª ¦¤®£® ¨§ ­¨µ ¤«¨­³ ¨ ¢»¡° ²¼ ­ ¨¬¥­¼¸³¾. ® ¤ ¦¥
¥±«¨ ­¥ ¯°¨­¨¬ ²¼ ¢® ¢­¨¬ ­¨¥ ¬ °¸°³²», ±®¤¥°¦ ¹¨¥ ¶¨ª«», ¯°¨
² ª®¬ ¯®¤µ®¤¥ ¯°¨¤¥²±¿ ¯¥°¥¡¨° ²¼ ¬¨««¨®­» § ¢¥¤®¬® ­¥£®¤­»µ
¢ °¨ ­²®¢ (¢°¿¤ «¨ ±²®¨² ¥µ ²¼ ¨§ ®±²®­  ¢ ¨ª £® ·¥°¥§ ¼¾±²®­, «¥¦ ¹¨© ­  ²»±¿·³ ¬¨«¼ ¢ ±²®°®­¥).
 ½²®© ¨ ±«¥¤³¾¹¥© £« ¢ µ ¬» ° ±±ª §»¢ ¥¬ ® ²®¬, ª ª ¬®¦­® ½´´¥ª²¨¢­® °¥¸ ²¼ ² ª¨¥ § ¤ ·¨.  § ¤ ·¥ ® ª° ²· ©¸¥¬ ¯³²¨ (shortest-paths problem) ­ ¬ ¤ ­ ®°¨¥­²¨°®¢ ­­»© ¢§¢¥¸¥­­»©
£° ´ G = (V; E ) ± ¢¥¹¥±²¢¥­­®© ¢¥±®¢®© ´³­ª¶¨¥© w : E ! R. ¥±®¬ (weight) ¯³²¨ p = hv0 ; v1; : : :; vk i ­ §»¢ ¥²±¿ ±³¬¬  ¢¥±®¢ °¥¡¥°,
¢µ®¤¿¹¨µ ¢ ½²®² ¯³²¼:

w(p) =

k
X
i=1

w(vi;1; vi ):

¥± ª° ²· ©¸¥£® ¯³²¨ (shortest-path weight) ¨§ u ¢ v ° ¢¥­, ¯®
®¯°¥¤¥«¥­¨¾,

(u; v) =

(

minfw(p) : u p v g; ¥±«¨ ±³¹¥±²¢³¥² ¯³²¼ ¨§ u ¢ v ;
1
¨­ ·¥.

° ²· ©¸¨© ¯³²¼ (shortest path) ¨§ u ¢ v | ½²® «¾¡®© ¯³²¼ p ¨§ u
¢ v , ¤«¿ ª®²®°®£® w(p) =  (u; v ).
 ­ ¸¥¬ ¯°¨¬¥°¥ ± ¨ª £® ¨ ®±²®­®¬ ¬®¦­® ° ±±¬ ²°¨¢ ²¼
ª °²³ ¤®°®£ ª ª £° ´, ¢¥°¸¨­ ¬¨ ª®²®°®£® ¿¢«¿¾²±¿ ¯¥°¥ª°¥±²ª¨,
  °¥¡° ¬¨ | ³· ±²ª¨ ¤®°®£ ¬¥¦¤³ ­¨¬¨. ¥± °¥¡°  | ½²® ¤«¨­ 
³· ±²ª  ¤®°®£¨, ¨ ­ ¸  § ¤ ·  ¬®¦¥² ±®±²®¿²¼ ¢ ®²»±ª ­¨¨ ª° ²· ©¸¥£® ¯³²¨ ¬¥¦¤³ ¤ ­­»¬ ¯¥°¥ª°¥±²ª®¬ ¢ ¨ª £® ¨ ¤ ­­»¬
¯¥°¥ª°¥±²ª®¬ ¢ ®±²®­¥.
¥±  ­¥ ®¡¿§ ­» ¡»²¼ ° ±±²®¿­¨¿¬¨: ¢¥± ¬¨ ¬®£³² ¡»²¼ ¢°¥¬¥­ , ±²®¨¬®±²¨, ¸²° ´», ³¡»²ª¨, : : : | ª®°®·¥ £®¢®°¿, «¾¡ ¿

500

« ¢  25 ° ²· ©¸¨¥ ¯³²¨ ¨§ ®¤­®© ¢¥°¸¨­»

¢¥«¨·¨­ , ª®²®°³¾ ¬» µ®²¨¬ ¬¨­¨¬¨§¨°®¢ ²¼ ¨ ª®²®° ¿ ®¡« ¤ ¥²
±¢®©±²¢®¬  ¤¤¨²¨¢­®±²¨.
«£®°¨²¬ ¯®¨±ª  ¢ ¸¨°¨­³ ­  £° ´ µ (¡¥§ ¢¥±®¢®© ´³­ª¶¨¨),
ª®²®°»© ¬» ° ±±¬ ²°¨¢ «¨ ¢ ° §¤. 23.2, ¬®¦­® ° ±±¬ ²°¨¢ ²¼ ª ª
°¥¸¥­¨¥ § ¤ ·¨ ® ª° ²· ©¸¥¬ ¯³²¨ ¢ · ±²­®¬ ±«³· ¥, ª®£¤  ¢¥±
ª ¦¤®£® °¥¡°  ° ¢¥­ ¥¤¨­¨¶¥. ­®£¨¥ ¨¤¥¨, ±¢¿§ ­­»¥ ± ¯®¨±ª®¬
¢ ¸¨°¨­³, ¡³¤³² ¯®«¥§­» ¨ ¤«¿ ®¡¹¥£® ±«³· ¿, ¯®½²®¬³ ±®¢¥²³¥¬
¢ ¬ ¥¹¥ ° § ¯°®±¬®²°¥²¼ ° §¤. 23.2, ¯°¥¦¤¥ ·¥¬ ·¨² ²¼ ¤ «¼¸¥.
 °¨ ­²» § ¤ ·¨ ® ª° ²· ©¸¥¬ ¯³²¨
 ½²®© £« ¢¥ ¬» ° ±±¬ ²°¨¢ ¥¬ ²®«¼ª® § ¤ ·³ ® ª° ²· ©¸¨µ
¯³²¿µ ¨§ ®¤­®© ¢¥°¸¨­» (single-source shortest-path problem): ¤ ­
¢§¢¥¸¥­­»© £° ´ G = (V; E ) ¨ ­ · «¼­ ¿ ¢¥°¸¨­  v (source vertex);
²°¥¡³¥²±¿ ­ ©²¨ ª° ²· ©¸¨¥ ¯³²¨ ¨§ s ¢® ¢±¥ ¢¥°¸¨­» v 2 V .
«£®°¨²¬, °¥¸ ¾¹¨© ½²³ § ¤ ·³, ¯°¨£®¤¥­ ¨ ¤«¿ ¬­®£¨µ ¤°³£¨µ
§ ¤ ·, ­ ¯°¨¬¥°:
° ²· ©¸¨¥ ¯³²¨ ¢ ®¤­³ ¢¥°¸¨­³: ¤ ­  ª®­¥·­ ¿ ¢¥°¸¨­  t (destination vertex), ²°¥¡³¥²±¿ ­ ©²¨ ª° ²· ©¸¨¥ ¯³²¨ ¢ t ¨§ ¢±¥µ
¢¥°¸¨­ v 2 V . ( ± ¬®¬ ¤¥«¥, ¥±«¨ ®¡° ²¨²¼ ¢±¥ ±²°¥«ª¨ ­ 
°¥¡° µ, ½²  § ¤ ·  ±¢¥¤¥²±¿ ª § ¤ ·¥ ® ª° ²· ©¸¨µ ¯³²¿µ ¨§
®¤­®© ¢¥°¸¨­».)
° ²· ©¸¨© ¯³²¼ ¬¥¦¤³ ¤ ­­®© ¯ °®© ¢¥°¸¨­: ¤ ­» ¢¥°¸¨­» u
¨ v , ­ ©²¨ ª° ²· ©¸¨© ¯³²¼ ¨§ u ¢ v .  §³¬¥¥²±¿, ¥±«¨ ¬»
­ ©¤¥¬ ¢±¥ ª° ²· ©¸¨¥ ¯³²¨ ¨§ u, ²® ²¥¬ ± ¬»¬ °¥¸¨¬ ¨ ½²³
§ ¤ ·³; ª ª ­¨ ±²° ­­®, ¡®«¥¥ ¡»±²°®£® ±¯®±®¡  (ª®²®°»© ¡»
¨±¯®«¼§®¢ « ²®² ´ ª², ·²® ­ ± ¨­²¥°¥±³¥² ¯³²¼ «¨¸¼ ¢ ®¤­³
¢¥°¸¨­³) ­¥ ­ ©¤¥­®.
° ²· ©¸¨¥ ¯³²¨ ¤«¿ ¢±¥µ ¯ ° ¢¥°¸¨­: ¤«¿ ª ¦¤®© ¯ °» ¢¥°¸¨­
u ¨ v ­ ©²¨ ª° ²· ©¸¨© ¯³²¼ ¨§ u ¢ v . ®¦­® °¥¸¨²¼ ½²³ § ¤ ·³, ­ µ®¤¿ ª° ²· ©¸¨¥ ¯³²¨ ¨§ ¤ ­­®© ¢¥°¸¨­» ¤«¿ ¢±¥µ ¢¥°¸¨­ ¯® ®·¥°¥¤¨. (²®, ¯° ¢¤ , ­¥ ®¯²¨¬ «¼­»© ±¯®±®¡ | ¡®«¥¥
½´´¥ª²¨¢­»¥ ¯®¤µ®¤» ¬» ° ±±¬®²°¨¬ ¢ ±«¥¤³¾¹¥© £« ¢¥.)
¥¡°  ®²°¨¶ ²¥«¼­®£® ¢¥± 
 ­¥ª®²®°»µ ¯°¨«®¦¥­¨¿µ ¢¥±  °¥¡¥° ¬®£³² ¡»²¼ ®²°¨¶ ²¥«¼­»¬¨. °¨ ½²®¬ ¢ ¦­®, ¥±²¼ «¨ ¶¨ª«» ®²°¨¶ ²¥«¼­®£® ¢¥± . ±«¨
¨§ ¢¥°¸¨­» ¨§ s ¬®¦­® ¤®¡° ²¼±¿ ¤® ¶¨ª«  ®²°¨¶ ²¥«¼­®£® ¢¥± ,
²® ¯®²®¬ ¬®¦­® ®¡µ®¤¨²¼ ½²®² ¶¨ª« ±ª®«¼ ³£®¤­® ¤®«£®, ¨ ¢¥± ¡³¤¥² ¢±¥ ³¬¥­¼¸ ²¼±¿, ² ª ·²® ¤«¿ ¢¥°¸¨­ ½²®£® ¶¨ª«  ª° ²· ©¸¨µ
¯³²¥© ­¥ ±³¹¥±²¢³¥² (°¨±. 25.1).  ² ª®¬ ±«³· ¥ ¬» ¡³¤¥¬ ±·¨² ²¼,
·²® ¢¥± ª° ²· ©¸¥£® ¯³²¨ ¥±²¼ ;1.
±«¨ ¦¥ ¶¨ª«®¢ ®²°¨¶ ²¥«¼­®£® ¢¥±  ­¥², ²® «¾¡®© ¶¨ª« ¬®¦­®
¢»¡°®±¨²¼, ­¥ ³¤«¨­¿¿ ¯³²¨. ³²¥© ¡¥§ ¶¨ª«®¢ ª®­¥·­®¥ ·¨±«®, ² ª
·²® ¢¥± ª° ²· ©¸¥£® ¯³²¨ ª®°°¥ª²­® ®¯°¥¤¥«¥­.
® ¬­®£¨µ § ¤ · µ ­¥² ¶¨ª«®¢ ®²°¨¶ ²¥«¼­®£® ¢¥±  ­¥ ¬®¦¥²
¡»²¼ ³¦¥ ¯®²®¬³, ·²® ¢¥±  ¢±¥µ °¥¡¥° ­¥®²°¨¶ ²¥«¼­». ( ª®¢
­ ¸ ¯°¨¬¥° ± ª °²®©  ¢²®¤®°®£). ¥ª®²®°»¥  «£®°¨²¬» ¤«¿ ¯®-

« ¢  25 ° ²· ©¸¨¥ ¯³²¨ ¨§ ®¤­®© ¢¥°¸¨­»

501

25.1 °¨¥­²¨°®¢ ­­»© £° ´ ± °¥¡° ¬¨ ®²°¨¶ ²¥«¼­®£® ¢¥± .  ª ¦¤®© ¢¥°¸¨­» ³ª § ­ ¢¥± ª° ²· ©¸¥£® ¯³²¨ ¨§ s ¢ ½²³ ¢¥°¸¨­³. ®±ª®«¼ª³
¢¥°¸¨­» e ¨ f ®¡° §³¾² ¶¨ª« ®²°¨¶ ²¥«¼­®£® ¢¥± , ¤®±²¨¦¨¬»© ¨§ ¢¥°¸¨­»
s, ¢¥±  ª° ²· ©¸¨µ ¯³²¥© ¢ ª ¦¤³¾ ¨§ ½²¨µ ¢¥°¸¨­ ° ¢­» ;1. ¤¥« ¢ ­¥±ª®«¼ª® ¶¨ª«®¢, ¬®¦­® ¯®©²¨ ¢ g, ² ª ·²® ¢¥± ª° ²· ©¸¥£® ¯³²¨ ¢ g ² ª¦¥
° ¢¥­ ;1. ¥°¸¨­» h, i ¨ j ­¥¤®±²¨¦¨¬» ¨§ s, ² ª ·²® (µ®²¼ ®­¨ ¨ «¥¦ ² ­ 
¶¨ª«¥ ®²°¨¶ ²¥«¼­®£® ¢¥± ), ¢¥± ª° ²· ©¸¥£® ¯³²¨ ¢ ½²¨ ¢¥°¸¨­» ¥±²¼ 1.
¨±. 25.1

¨±ª  ª° ²· ©¸¨µ ¯³²¥© (­ ¯°¨¬¥°,  «£®°¨²¬ ¥©ª±²°») ¨±¯®«¼§³¾² ½²® ¨ ¯°¨¬¥­¨¬» «¨¸¼ ¤«¿ £° ´®¢ ± ­¥®²°¨¶ ²¥«¼­»¬¨ ¢¥± ¬¨. °³£¨¥ (­ ¯°¨¬¥°,  «£®°¨²¬ ¥««¬ ­ -®°¤ ) ¤®¯³±ª ¾²
°¥¡°  ®²°¨¶ ²¥«¼­®£® ¢¥±  ¨ ¤ ¦¥ ¤ ¾² ¢¥°­»© °¥§³«¼² ², ¥±«¨
¨§ ¨±µ®¤­®© ¢¥°¸¨­» ­¥«¼§¿ ¤®©²¨ ¤® ¶¨ª«  ®²°¨¶ ²¥«¼­®£® ¢¥± .
¡»·­®  «£®°¨²¬ ±®®¡¹ ¥², ¥±«¨ ² ª®© ¶¨ª« ®²°¨¶ ²¥«¼­®£® ¢¥± 
®¡­ °³¦¥­.
°¥¤±² ¢«¥­¨¥ ª° ²· ©¸¨µ ¯³²¥© ¢  «£®°¨²¬¥
 ±²® ²°¥¡³¥²±¿ ­¥ ¯°®±²® ¯®¤±·¨² ²¼ ¢¥±  ª° ²· ©¸¨µ ¯³²¥©,
­® ¨ ­ ©²¨ ± ¬¨ ½²¨ ¯³²¨. » ¡³¤¥¬ ¨±¯®«¼§®¢ ²¼ ¤«¿ ¨µ ¯°¥¤±² ¢«¥­¨¿ ²®² ¦¥ ¯°¨¥¬, ·²® ¨ ¢ ¤¥°¥¢¼¿µ ¯®¨±ª  ¢ ¸¨°¨­³ ¢ ° §¤. 23.2.
¬¥­­®, ¯³±²¼ G = (V; E ) | § ¤ ­­»© £° ´. «¿ ª ¦¤®© ¢¥°¸¨­»
v 2 V ¬» ¡³¤¥¬ ¯®¬­¨²¼ ¥¥ ¯°¥¤¸¥±²¢¥­­¨ª  (predecessor) [v ].
°¥¤¸¥±²¢¥­­¨ª ¢¥°¸¨­» | ½²® «¨¡® ¤°³£ ¿ ¢¥°¸¨­  (³ª § ²¥«¼
­  ­¥¥), «¨¡® nil. ® § ¢¥°¸¥­¨¨ ° ¡®²»  «£®°¨²¬®¢, ° ±±¬ ²°¨¢ ¥¬»µ ¢ ½²®© £« ¢¥, ¶¥¯®·ª  ¯°¥¤¸¥±²¢¥­­¨ª®¢, ­ ·¨­ ¾¹ ¿±¿ ±
¯°®¨§¢®«¼­®© ¢¥°¸¨­» v , ¡³¤¥² ¯°¥¤±² ¢«¿²¼ ±®¡®© ª° ²· ©¸¨©
¯³²¼ ¨§ s ¢ v (¢ ®¡° ²­®¬ ¯®°¿¤ª¥), ² ª ·²®, ¥±«¨  [v ] 6= nil, ¯°®¶¥¤³°  Print-Path(G; s; v ) ¨§ ° §¤. 23.2 ­ ¯¥· ² ¥² ª° ²· ©¸¨©
¯³²¼ ¨§ s ¢ v .
 ¯°®¶¥±±¥ ° ¡®²»  «£®°¨²¬®¢ ¶¥¯®·ª¨, ¯®«³· ¥¬»¥ ¨²¥° ¶¨¿¬¨  , ­¥ ®¡¿§ ²¥«¼­® ¡³¤³² ª° ²· ©¸¨¬¨ ¯³²¿¬¨, ­® ¢±¥ ° ¢­®
¬®¦­® ° ±±¬®²°¥²¼ ®°¨¥­²¨°®¢ ­­»© ¯®¤£° ´ ¯°¥¤¸¥±²¢®¢ ­¨¿
(predecessor subgraph) G = (V ; E ), ®¯°¥¤¥«¥­­»© ² ª: ¢¥°¸¨­»
G | ½²® ²¥ ¢¥°¸¨­» G, ³ ª®²®°»µ ¯°¥¤¸¥±²¢¥­­¨ª ®²«¨·¥­ ®²
nil, ¯«¾± ¨±µ®¤­ ¿ ¢¥°¸¨­ :

V = f v 2 V :  [v] 6= nil g [ fsg:
¥¡°  G | ½²® ±²°¥«ª¨, ³ª §»¢ ¾¹¨¥ ¨§  [v ] =
6 nil ¢ v:
E = f ( [v ]; v) 2 E : v 2 V n fsg g:
» ¤®ª ¦¥¬, ·²® ¯® ®ª®­· ­¨¨ ° ¡®²» ­ ¸¨µ  «£®°¨²¬®¢ £° ´

G ¡³¤¥² À¤¥°¥¢®¬ ª° ²· ©¸¨µ ¯³²¥©Á | ¤¥°¥¢®¬ ± ª®°­¥¬ s, ±®¤¥°¦ ¹¨¬ ª° ²· ©¸¨¥ ¯³²¨ ¨§ s ¢® ¢±¥ ¤®±²¨¦¨¬»¥ ¨§ s ¢¥°¸¨­».

¥°¥¢¼¿ ª° ²· ©¸¨µ ¯³²¥©  ­ «®£¨·­» ¤¥°¥¢¼¿¬ ¯®¨±ª  ¢ ¸¨°¨­³
¨§ ° §¤. 23.2, ± ²®© ° §­¨¶¥©, ·²® ­  ±¥© ° § ª° ²· ©¸¨¬¨ ®¡º¿¢«¿¾²±¿ ¯³²¨ ± ­ ¨¬¥­¼¸¨¬ ¢¥±®¬,   ­¥ ­ ¨¬¥­¼¸¨¬ ·¨±«®¬ °¥¡¥°.

502

« ¢  25 ° ²· ©¸¨¥ ¯³²¨ ¨§ ®¤­®© ¢¥°¸¨­»

25.2 ( ) §¢¥¸¥­­»© ®°¨¥­²¨°®¢ ­­»© £° ´; ¢ ¢¥°¸¨­ µ ³ª § ­»
¢¥±  ª° ²· ©¸¨µ ¯³²¥© ¨§ s. (¡) ¥°»¥ °¥¡°  ®¡° §³¾² ¤¥°¥¢® ª° ²· ©¸¨µ
¯³²¥© ± ª®°­¥¬ s. (¢) °³£®¥ ¤¥°¥¢® ª° ²· ©¸¨µ ¯³²¥© ± ²¥¬ ¦¥ ª®°­¥¬.
¨±. 25.2

®·­®¥ ®¯°¥¤¥«¥­¨¥ ¢»£«¿¤¨² ² ª. ³±²¼ G = (V; E ) | ¢§¢¥¸¥­­»©
®°¨¥­²¨°®¢ ­­»© £° ´ ± ¢¥±®¢®© ´³­ª¶¨¥© w : E ! R. °¥¤¯®«®¦¨¬, ·²® G ­¥ ¨¬¥¥² ¶¨ª«®¢ ®²°¨¶ ²¥«¼­®£® ¢¥± , ¤®±²¨¦¨¬»µ
¨§ ¨±µ®¤­®© ¢¥°¸¨­» s, ² ª ·²® ¢±¥ ª° ²· ©¸¨¥ ¯³²¨ ¨§ s ª®°°¥ª²­® ®¯°¥¤¥«¥­». ® ®¯°¥¤¥«¥­¨¾, ¤¥°¥¢® ª° ²· ©¸¨µ ¯³²¥©
(shorted-paths tree) ± ª®°­¥¬ ¢ s ¥±²¼ ®°¨¥­²¨°®¢ ­­»© ¯®¤£° ´
G0 = (V 0; E 0), £¤¥ V 0  V ¨ E 0  E , ¤«¿ ª®²®°®£®:
1. V 0 | ¬­®¦¥±²¢® ¢¥°¸¨­, ¤®±²¨¦¨¬»µ ¨§ ¢¥°¸¨­» v ;
2. G0 ¿¢«¿¥²±¿ ¤¥°¥¢®¬ ± ª®°­¥¬ s;
3. ¤«¿ ª ¦¤®£® v 2 V 0 ¯³²¼ ¨§ s ¢ v ¢ £° ´¥ G0 ¿¢«¿¥²±¿ ª° ²· ©¸¨¬ ¯³²¥¬ ¨§ s ¢ v ¢ £° ´¥ G.
¨ ª° ²· ©¸¨¥ ¯³²¨, ­¨ ¤¥°¥¢¼¿ ª° ²· ©¸¨µ ¯³²¥© ­¥ ®¡¿§ ­»
¡»²¼ ¥¤¨­±²¢¥­­»¬¨.   °¨±. 25.2 ¨§®¡° ¦¥­ ¢§¢¥¸¥­­»© ®°¨¥­²¨°®¢ ­­»© £° ´ ¨ ¤¢  ° §«¨·­»µ ¤¥°¥¢  ª° ²· ©¸¨µ ¯³²¥© ± ®¡¹¨¬ ª®°­¥¬.
« ­ £« ¢»
±¥  «£®°¨²¬» ¤«¿ ¯®¨±ª  ª° ²· ©¸¨µ ¯³²¥©, ° ±±¬ ²°¨¢ ¥¬»¥
¢ ½²®© £« ¢¥, ®±­®¢ ­» ­  ²¥µ­¨ª¥, ¨§¢¥±²­®© ¯®¤ ­ §¢ ­¨¥¬ °¥« ª± ¶¨¿ (relaxation).  ° §¤. 25.1 ¬» ° ±±¬ ²°¨¢ ¥¬ ®¡¹¨¥ ±¢®©±²¢ 
ª° ²· ©¸¨µ ¯³²¥©,   § ²¥¬ ¤®ª §»¢ ¥¬ °¿¤ ¢ ¦­»µ ´ ª²®¢ ¯°®
°¥« ª± ¶¨¾. «£®°¨²¬ ¥©ª±²°», °¥¸ ¾¹¨© § ¤ ·³ ® ª° ²· ©¸¨µ
¯³²¿µ ¨§ ®¤­®© ¢¥°¸¨­» ¤«¿ ±«³· ¿ ­¥®²°¨¶ ²¥«¼­»µ ¢¥±®¢, ° §®¡° ­ ¢ ° §¤. 25.2.  §¤. 25.3 ¯®±¢¿¹¥­  «£®°¨²¬³ ¥««¬ ­ -®°¤ ,
¯°¨¬¥­¨¬®¬³ ¨ ¢ ²®¬ ±«³· ¥, ª®£¤  °¥¡°  ¬®£³² ¨¬¥²¼ ®²°¨¶ ²¥«¼­»© ¢¥±. (±«¨ £° ´ ±®¤¥°¦¨² ¶¨ª« ®²°¨¶ ²¥«¼­®£® ¢¥± , ¤®±²¨¦¨¬»© ¨§ ¨±µ®¤­®© ¢¥°¸¨­»,  «£®°¨²¬ ¥««¬ ­ -®°¤  ±®®¡¹ ¥²
®¡ ½²®¬.)  ° §¤. 25.4 ° ±±¬ ²°¨¢ ¥²±¿  «£®°¨²¬ ¤«¿ ­ µ®¦¤¥­¨¿
ª° ²· ©¸¨µ ¯³²¥© ¢  ¶¨ª«¨·¥±ª¨µ £° ´ µ, ° ¡®² ¾¹¨© §  «¨­¥©­®¥ ¢°¥¬¿.  ª®­¥¶, ¢ ° §¤. 25.5 ¬» ¯®ª §»¢ ¥¬, ª ª ¯°¨¬¥­¨²¼
 «£®°¨²¬ ¥««¬ ­ -®°¤  ª °¥¸¥­¨¾ ®¤­®£® ±¯¥¶¨ «¼­®£® ±«³· ¿
§ ¤ ·¨ «¨­¥©­®£® ¯°®£° ¬¬¨°®¢ ­¨¿.
°¨ ° ¡®²¥ ± ±¨¬¢®« ¬¨ 1 ¨ ;1 ¬» ¡³¤¥¬ ¯°¨¤¥°¦¨¢ ²¼±¿
±«¥¤³¾¹¨µ ±®£« ¸¥­¨©. ±«¨ a 6= ;1, ²® ¡³¤¥¬ ±·¨² ²¼, ·²® a +
1 = 1 + a = 1;  ­ «®£¨·­®, ¥±«¨ a 6= 1, ²® a +(;1) = (;1)+ a =
;1.

° ²· ©¸¨¥ ¯³²¨ ¨ °¥« ª± ¶¨¿

503

25.1. ° ²· ©¸¨¥ ¯³²¨ ¨ °¥« ª± ¶¨¿
 ½²®¬ ° §¤¥«¥ ®¯¨±»¢ ¾²±¿ ±¢®©±²¢  ª° ²· ©¸¨µ ¯³²¥© ¨ ®¡º¿±­¿¥²±¿ ®¡¹¨© ¯°¨¥¬, ¨±¯®«¼§³¥¬»© ¢±¥¬¨  «£®°¨²¬ ¬¨ ½²®© £« ¢» ¨ ­ §»¢ ¥¬»© À°¥« ª± ¶¨¥©Á. ­ ±®±²®¨², £°³¡® £®¢®°¿, ¢ ¯®±²¥¯¥­­®¬ ³²®·­¥­¨¨ ¢¥°µ­¥© ®¶¥­ª¨ ­  ¢¥± ª° ²· ©¸¥£® ¯³²¨ ¢
¤ ­­³¾ ¢¥°¸¨­³ | ¯®ª  ­¥° ¢¥­±²¢® ­¥ ¯°¥¢° ²¨²±¿ ¢ ° ¢¥­±²¢®.
°¨ ¯¥°¢®¬ ·²¥­¨¨ ¢» ¬®¦¥²¥ ° §®¡° ²¼ ²®«¼ª® ´®°¬³«¨°®¢ª¨
°¥§³«¼² ²®¢ (®¡° ²¨²¥ ®±®¡®¥ ¢­¨¬ ­¨¥ ­  «¥¬¬³ 25.7; «¥¬¬» 25.8
¨ 25.9 ¯°¨ ¯¥°¢®¬ ·²¥­¨¨ ¬®¦­® ¯°®¯³±²¨²¼), ¯®±«¥ ·¥£® ¯¥°¥©²¨
ª  «£®°¨²¬ ¬ ° §¤. 25.2 ¨ 25.3.
¢®©±²¢® ®¯²¨¬ «¼­®±²¨ ¤«¿ ¯®¤§ ¤ ·
¾¡ ¿ · ±²¼ ª° ²· ©¸¥£® ¯³²¨ ± ¬  ¥±²¼ ª° ²· ©¸¨© ¯³²¼. ²®
§­ ·¨², ·²® § ¤ ·  ® ª° ²· ©¸¨µ ¯³²¿µ ®¡« ¤ ¥² ±¢®©±²¢®¬ ®¯²¨¬ «¼­®±²¨ ¤«¿ ¯®¤§ ¤ · | ¯°¨§­ ª ²®£®, ·²® ª ­¥© ¬®¦¥² ¡»²¼
¯°¨¬¥­¨¬® ¤¨­ ¬¨·¥±ª®¥ ¯°®£° ¬¬¨°®¢ ­¨¥ (£« ¢  16) ¨«¨ ¦ ¤­»©  «£®°¨²¬ (£« ¢  17).  ¤¥©±²¢¨²¥«¼­®,  «£®°¨²¬ ¥©ª±²°»
¿¢«¿¥²±¿ ¦ ¤­»¬  «£®°¨²¬®¬,    «£®°¨²¬ «®©¤ -®°¸®««  ¤«¿
­ µ®¦¤¥­¨¿ ª° ²· ©¸¨µ ¯³²¥© ¬¥¦¤³ ¢±¥¬¨ ¯ ° ¬¨ ¢¥°¸¨­ (£« ¢  26) ®±­®¢ ­ ­  ¤¨­ ¬¨·¥±ª®¬ ¯°®£° ¬¬¨°®¢ ­¨¨. «¥¤³¾¹ ¿
«¥¬¬  ¨ ¥¥ ±«¥¤±²¢¨¥ ³²®·­¿¾², ¢ ·¥¬ ª®­ª°¥²­® ±®±²®¨² ±¢®©±²¢®
®¯²¨¬ «¼­®±²¨ ¤«¿ ¯®¤§ ¤ · ¢ § ¤ ·¥ ® ª° ²· ©¸¨µ ¯³²¿µ.
¥¬¬  25.1 (²°¥§ª¨ ª° ²· ©¸¨µ ¯³²¥© ¿¢«¿¾²±¿ ª° ²· ©¸¨¬¨)
³±²¼ G = (V; E ) | ¢§¢¥¸¥­­»© ®°¨¥­²¨°®¢ ­­»© £° ´ ± ¢¥±®¢®© ´³­ª¶¨¥© w : E ! R. ±«¨ p = hv1 ; v2; : : :; vk i | ª° ²· ©¸¨©
¯³²¼ ¨§ v1 ¢ vk ¨ 1 6 i 6 j 6 k, ²® pij = hvi ; vi+1 ; : : :; vj i ¥±²¼
ª° ²· ©¸¨© ¯³²¼ ¨§ vi ¢ vj .
®ª § ²¥«¼±²¢®
±«¨ ¯³²¼ pij ­¥ ª° ²· ©¸¨©, ²®, § ¬¥­¿¿ ¢ ¯³²¨ p ³· ±²®ª ®²
vi ¤® vj ­  ¡®«¥¥ ª®°®²ª¨© ¯³²¼ ¨§ vi ¢ vj , ¬» ³¬¥­¼¸¨¬ ¢¥± ¯³²¨
¨§ p1 ¢ pk | ¯°®²¨¢®°¥·¨¥. (¤¥±¼ À¡®«¥¥ ª®°®²ª¨©Á ®§­ · ¥² À±
¬¥­¼¸¨¬ ¢¥±®¬Á.)
«¥¤±²¢¨¥ ¨§ ¤®ª § ­­®© «¥¬¬» ®¡®¡¹ ¥² «¥¬¬³ 23.1.
«¥¤±²¢¨¥ 25.2
³±²¼ G = (V; E ) | ¢§¢¥¸¥­­»© ®°¨¥­²¨°®¢ ­­»© £° ´ ± ¢¥±®¢®© ´³­ª¶¨¥© w : E ! R.  ±±¬¬®²°¨¬ ª° ²· ©¸¨© ¯³²¼
p ¨§ s
p0
¢ v . ³±²¼ u ! v | ¯®±«¥¤­¥¥ °¥¡°® ½²®£® ¯³²¨ (p ¥±²¼ s u ! v ).
®£¤   (s; v ) =  (s; u) + w(u; v ).
®ª § ²¥«¼±²¢®
® «¥¬¬¥ 25.1 ¯³²¼ p0 ¿¢«¿¥²±¿ ª° ²· ©¸¨¬, ² ª ·²®  (s; v ) =
w(p0) + w(u; v) =  (s; u) + w(u; v ).
«¥¤³¾¹ ¿ «¥¬¬  ¯°®±² , ­® ¯®«¥§­ .
¥¬¬  25.3 ³±²¼ G = (V; E ) | ¢§¢¥¸¥­­»© ®°¨¥­²¨°®¢ ­­»©

504

« ¢  25 ° ²· ©¸¨¥ ¯³²¨ ¨§ ®¤­®© ¢¥°¸¨­»

25.3 ¥« ª± ¶¨¿ °¥¡°  (u; v).  ¢¥°¸¨­ µ ³ª § ­» ®¶¥­ª¨ ª° ²· ©¸¥£® ¯³²¨. ( ) ®±ª®«¼ª³ ¯¥°¥¤ °¥« ª± ¶¨¥© ¡»«® d[v] > d[u]+w(u;v), ¢ °¥§³«¼² ²¥
°¥« ª± ¶¨¨ d[v] ³¬¥­¼¸ ¥²±¿. (¡) ¦¥ ¤® °¥« ª± ¶¨¨ ¨¬¥¥¬ d[v] 6 d[u]+ w(u;v).
¥« ª± ¶¨¿ ­¨·¥£® ­¥ ¬¥­¿¥².
¨±. 25.3

£° ´ ± ¢¥±®¢®© ´³­ª¶¨¥© w : E ! R; ¯³±²¼ s 2 V . ®£¤  ¤«¿ ¢±¿ª®£®
°¥¡°  (u; v ) 2 E ¨¬¥¥¬  (s; v ) 6  (s; u) + w(u; v ).
®ª § ²¥«¼±²¢®.
¥± ª° ²· ©¸¥£® ¯³²¨ ¨§ s ¢ v ­¥ ¯°¥¢®±µ®¤¨² ¢¥±  «¾¡®£® ¯³²¨
¨§ s ¢ v , ¢ ²®¬ ·¨±«¥ ¨ ¯°®µ®¤¿¹¥£® ­  ¯®±«¥¤­¥¬ ¸ £¥ ·¥°¥§ u.
¥« ª± ¶¨¿
¥µ­¨ª  °¥« ª± ¶¨¨, ª®²®° ¿ ³¦¥ ³¯®¬¨­ « ±¼ ¢»¸¥, ±®±²®¨² ¢
±«¥¤³¾¹¥¬. «¿ ª ¦¤®£® °¥¡°  v 2 V ¬» µ° ­¨¬ ­¥ª®²®°®¥ ·¨±«® d[v ], ¿¢«¿¾¹¥¥±¿ ¢¥°µ­¥© ®¶¥­ª®© ¢¥±  ª° ²· ©¸¥£® ¯³²¨ ¨§ s
¢ v ; ¤«¿ ª° ²ª®±²¨ ¬» ¡³¤¥¬ ­ §»¢ ²¼ ¥£® ¯°®±²® ®¶¥­ª®© ª° ²· ©¸¥£® ¯³²¨ (shortest-path estimate).  · «¼­®¥ §­ ·¥­¨¥ ®¶¥­ª¨
ª° ²· ©¸¥£® ¯³²¨ (¨ ¯°¥¤¸¥±²¢¥­­¨ª®¢) ¤ ¥²±¿ ±«¥¤³¾¹¥© ¯°®¶¥¤³°®©:
Initialize-Single-Source(G,s)
1 for (¤«¿) ¢±¥µ ¢¥°¸¨­ v \in V[G]
2
do d[v] \gets \infty
3
\pi[v] \gets \text{\sc nil}
4 d[s] \gets 0

­»¬¨ ±«®¢ ¬¨, ¯¥°¢®­ · «¼­®  [v ] = nil ¤«¿ ¢±¥µ v ; ¯°¨ ½²®¬
d[s] = 0 ¨ d[v ] = 1 ¤«¿ ®±² «¼­»µ ¢¥°¸¨­ v .
¥« ª± ¶¨¿ °¥¡°  (u; v ) 2 E ±®±²®¨² ¢ ±«¥¤³¾¹¥¬: §­ ·¥­¨¥ d[v ]
³¬¥­¼¸ ¥²±¿ ¤® d[u] + w(u; v ) (¥±«¨ ¢²®°®¥ §­ ·¥­¨¥ ¬¥­¼¸¥ ¯¥°¢®£®): ¯°¨ ½²®¬ d[v ] ®±² ¥²±¿ ¢¥°µ­¥© ®¶¥­ª®© ¢ ±¨«³ «¥¬¬» 25.3.
» µ®²¨¬, ·²®¡»  [v ] ³ª §»¢ «¨ ­  ¯³²¼, ¨±¯®«¼§®¢ ­­»© ¯°¨ ¯®«³·¥­¨¨ ½²®© ¢¥°µ­¥© ®¶¥­ª¨, ¯®½²®¬³ ®¤­®¢°¥¬¥­­® ¬» ¬¥­¿¥¬
§­ ·¥­¨¥  [v ]:
Relax(u,v,w)
1 if d[v] > d[u] + w(u,v)
2
then d[v] \gets d[u] + w(u,v)
3
\pi[v] \gets u

  °¨±. 25.3 ¯°¨¢¥¤¥­» ¤¢  ¯°¨¬¥°  °¥« ª± ¶¨¨: ¢ ®¤­®¬ ±«³· ¥
®¶¥­ª  ª° ²· ©¸¥£® ¯³²¨ ³¬¥­¼¸ ¥²±¿, ¢ ¤°³£®¬ ­¨·¥£® ­¥ ¯°®¨±µ®¤¨².
«£®°¨²¬», ®¯¨±»¢ ¥¬»¥ ¢ ½²®© £« ¢¥, ³±²°®¥­» ² ª: ®­¨ ¢»§»¢ ¾² ¯°®¶¥¤³°³ Initialize-Single-Source,   § ²¥¬ ¯°®¨§¢®¤¿²
°¥« ª± ¶¨¾ °¥¡¥°.  §­»¥  «£®°¨²¬» ®²«¨· ¾²±¿ ¯®°¿¤ª®¬, ¢ ª®²®°®¬ °¥¡°  ¯®¤¢¥°£ ¾²±¿ °¥« ª± ¶¨¨.   «£®°¨²¬¥ ¥©ª±²°» ¨
 «£®°¨²¬¥ ¤«¿  ¶¨ª«¨·¥±ª¨µ £° ´®¢ ª ¦¤®¥ °¥¡°® ¯®¤¢¥°£ ¥²±¿

° ²· ©¸¨¥ ¯³²¨ ¨ °¥« ª± ¶¨¿

505

°¥« ª± ¶¨¨ «¨¸¼ ¥¤¨­®¦¤».   «£®°¨²¬¥ ¥««¬ ­ -®°¤  °¥¡° 
¯®¤¢¥°£ ¾²±¿ °¥« ª± ¶¨¨ ¯® ­¥±ª®«¼ª³ ° §.
¢®©±²¢  °¥« ª± ¶¨¨
¥¬¬», ¤®ª §»¢ ¥¬»¥ ¢ ½²®¬ ¨ ±«¥¤³¾¹¥¬ ° §¤¥« µ, ¡³¤³² ¨±¯®«¼§®¢ ­» ¯°¨ ¤®ª § ²¥«¼±²¢¥ ¯° ¢¨«¼­®±²¨  «£®°¨²¬®¢ ¯®¨±ª 
ª° ²· ©¸¨µ ¯³²¥©.
«¥¤³¾¹ ¿ «¥¬¬  ®·¥¢¨¤­ .
¥¬¬  25.4
³±²¼ G = (V; E ) | ¢§¢¥¸¥­­»© ®°¨¥­²¨°®¢ ­­»© £° ´ ± ¢¥±®¢®© ´³­ª¶¨¥© w : E ! R, ¨ ¯³±²¼ (u; v ) 2 E . ®£¤  ±° §³ ¦¥ ¯®±«¥
°¥« ª± ¶¨¨ ½²®£® °¥¡°  (¢»§®¢  Relax(u; v; w)) ¢»¯®«­¿¥²±¿ ­¥° ¢¥­±²¢® d[v ] 6 d[u] + w(u; v ).
¥¬¬  25.5
³±²¼ G = (V; E ) | ¢§¢¥¸¥­­»© ®°¨¥­²¨°®¢ ­­»© £° ´ ± ¢¥±®¢®© ´³­ª¶¨¥© w; ¯³±²¼ s 2 V | ­ · «¼­ ¿ ¢¥°¸¨­ . ®£¤  ¯®±«¥ ¢»¯®«­¥­¨¿ ¯°®¶¥¤³°» Initialize-Single-Source(G; s),   § ²¥¬ ¯°®¨§¢®«¼­®© ¯®±«¥¤®¢ ²¥«¼­®±²¨ ®¯¥° ¶¨© °¥« ª± ¶¨¨ °¥¡¥°,
¤«¿ ª ¦¤®© ¢¥°¸¨­» v 2 V ¢»¯®«­¥­® ­¥° ¢¥­±²¢® d[v ] >  (s; v ).
±«¨ ¯°¨ ½²®¬ ¤«¿ ª ª®©-²® ¨§ ¢¥°¸¨­ v ½²® ­¥° ¢¥­±²¢® ®¡° ¹ ¥²±¿ ¢ ° ¢¥­±²¢®, ²® ° ¢¥­±²¢® d[v ] =  (s; v ) ®±² ­¥²±¿ ¢¥°­»¬ ¨ ¢
¤ «¼­¥©¸¥¬ (¯°¨ ¯®±«¥¤³¾¹¨µ °¥« ª± ¶¨¿µ °¥¡¥°).
®ª § ²¥«¼±²¢®
 ± ¬®¬ ¤¥«¥, ¯®±«¥ ¨­¨¶¨ «¨§ ¶¨¨ §­ ·¥­¨¿ d[v ] ¡¥±ª®­¥·­»
¯°¨ v 6= s (¨ ¯®²®¬³ ¿¢«¿¾²±¿ ®¶¥­ª®© ±¢¥°µ³ ¤«¿ ·¥£® ³£®¤­®),
  d[s] = 0 (·²® ²®¦¥ ¯° ¢¨«¼­®).  ¯°®¶¥±±¥ °¥« ª± ¶¨¨ §­ ·¥­¨¥
d[v] ®±² ¥²±¿ ¢¥°µ­¥© ®¶¥­ª®© ¤«¿  (s; v ), ¯®±ª®«¼ª³

(s; v ) 6  (s; u) + w(u; v ) 6 d[u] + w(u; v )
(¯¥°¢®¥ ­¥° ¢¥­±²¢® | ¯® «¥¬¬¥ 25.3).
²®°®¥ ³²¢¥°¦¤¥­¨¥ «¥¬¬»: ¯®±ª®«¼ª³ ¢ ¯°®¶¥±±¥ °¥« ª± ¶¨¨
§­ ·¥­¨¿ d ¬®£³² ²®«¼ª® ³¬¥­¼¸ ¾²±¿,   ¯®±«¥ ¤®±²¨¦¥­¨¿ ° ¢¥­±²¢  d[v ] =  (s; v ) ¤ «¼¸¥ ³¬¥­¼¸ ²¼±¿ ­¥ª³¤ .
«¥¤±²¢¨¥ 25.6
³±²¼ G = (V; E ) | ¢§¢¥¸¥­­»© ®°¨¥­²¨°®¢ ­­»© £° ´ ± ¢¥±®¢®© ´³­ª¶¨¥© w ¨ ¨±µ®¤­®© ¢¥°¸¨­®© s. ³±²¼ ¢¥°¸¨­  v 2 V
­¥¤®±²¨¦¨¬  ¨§ s. ®£¤  ¯®±«¥ ¨±¯®«­¥­¨¿ ¯°®¶¥¤³°» InitializeSingle-Source(G; s) ¨ «¾¡®© ¯®±«¥¤®¢ ²¥«¼­®±²¨ °¥« ª± ¶¨© °¥¡¥° §­ ·¥­¨¥ d[v ] ¡³¤¥² ®±² ¢ ²¼±¿ ¡¥±ª®­¥·­»¬ (¨ ° ¢­»¬  (s; v )).
«¥¤³¾¹ ¿ «¥¬¬  ¨£° ¥² ®±­®¢­³¾ °®«¼ ¯°¨ ¤®ª § ²¥«¼±²¢¥
¯° ¢¨«¼­®±²¨  «£®°¨²¬®¢ ¯®¨±ª  ª° ²· ©¸¨µ ¯³²¥©.
¥¬¬  25.7
³±²¼ G = (V; E ) | ¢§¢¥¸¥­­»© ®°¨¥­²¨°®¢ ­­»© £° ´ ± ¢¥±®¢®© ´³­ª¶¨¥© w ¨ ¨±µ®¤­®© ¢¥°¸¨­®© s. ³±²¼ s u ! v | ª° ²· ©¸¨© ¯³²¼ ± ¯®±«¥¤­¨¬ °¥¡°®¬ (u; v ) °¥¤¯®«®¦¨¬, ·²® ¡»« 
¨±¯®«­¥­  ¯°®¶¥¤³°  Initialize-Single-Source(G; s),   § ²¥¬ |

506

« ¢  25 ° ²· ©¸¨¥ ¯³²¨ ¨§ ®¤­®© ¢¥°¸¨­»

¯®±«¥¤®¢ ²¥«¼­®±²¼ °¥« ª± ¶¨© ­¥ª®²®°»µ °¥¡¥°, ¢ª«¾· ¾¹ ¿ °¥« ª± ¶¨¾ °¥¡°  (u; v ). ±«¨ ¢ ª ª®©-²® ¬®¬¥­² ¤® °¥« ª± ¶¨¨ °¥¡° 
(u; v ) ¢»¯®«­¿«®±¼ ° ¢¥­±²¢® d[u] =  (s; u), ²® ¢ «¾¡®© ¬®¬¥­² ¯®±«¥ °¥« ª± ¶¨¨ (u; v ) ¡³¤¥² ¢»¯®«­¥­® ° ¢¥­±²¢® d[v ] =  (s; v ).
®ª § ²¥«¼±²¢®
 ± ¬®¬ ¤¥«¥, ° ¢¥­±²¢® d[u] =  (s; u) ±®µ° ­¨²±¿ ¤® ¬®¬¥­² 
°¥« ª± ¶¨¨ °¥¡°  (u; v ) (ª ª, ¢¯°®·¥¬, ¨ ¤® «¾¡®£® ¤ «¼­¥©¸¥£®
¬®¬¥­² , ±¬. «¥¬¬³ 25.5). ®½²®¬³ ±° §³ ¯®±«¥ °¥« ª± ¶¨¨ °¥¡° 
(u; v ) ¨¬¥¥¬
d[v] 6 d[u] + w(u; v) =  (s; u) + w(u; v ) =  (s; v)
(¯®±«¥¤­¥¥ ° ¢¥­±²¢® | ¯® ±«¥¤±²¢¨¾ 25.2). ®±ª®«¼ª³, ± ¤°³£®©
±²®°®­», d[v ] >  (s; v ) ¯® «¥¬¬¥ 25.5, ¯®«³· ¥¬, ·²® d[v ] =  (s; v )
±° §³ ¯®±«¥ °¥« ª± ¶¨¨ (  §­ ·¨², ¨ ¯®§¦¥).
¥°¥¢¼¿ ª° ²· ©¸¨µ ¯³²¥©
®±¬®²°¨¬, ·²® ¯°®¨±µ®¤¨² ¯°¨ ­ ¸¨µ ®¯¥° ¶¨¿µ ± ¯®¤£° ´®¬
¯°¥¤¸¥±²¢®¢ ­¨¿ G .
¥¬¬  25.8
³±²¼ G = (V; E ) | ¢§¢¥¸¥­­»© ®°¨¥­²¨°®¢ ­­»© £° ´ ± ¢¥±®¢®© ´³­ª¶¨¥© w ¨ ¨±µ®¤­®© ¢¥°¸¨­®© s, ¯°¨·¥¬ ¢ £° ´¥ G ­¥² ¶¨ª«®¢ ®²°¨¶ ²¥«¼­®£® ¢¥± , ¤®±²¨¦¨¬»µ ¨§ s. ®£¤  ¯®±«¥ ®¯¥° ¶¨¨
Initialize-Single-Source(G; s), §  ª®²®°®© ±«¥¤³¥² ¯°®¨§¢®«¼­ ¿
¯®±«¥¤®¢ ²¥«¼­®±²¼ °¥« ª± ¶¨© °¥¡¥°, ¯®¤£° ´ ¯°¥¤¸¥±²¢¥­­¨ª®¢
G ¿¢«¿¥²±¿ ¤¥°¥¢®¬ ± ª®°­¥¬ s.
®ª § ²¥«¼±²¢®
 ¯®¬­¨¬, ·²® ¢¥°¸¨­ ¬¨ £° ´  G ¿¢«¿¾²±¿ ²¥ ¢¥°¸¨­» v 2
V , ¤«¿ ª®²®°»µ [v ] 6= nil,   ² ª¦¥ ¢¥°¸¨­  s. °³£¨¬¨ ±«®¢ ¬¨,
¢ ­¥£® ¢µ®¤¿² ²¥ ¢¥°¸¨­» v , ¤«¿ ª®²®°»µ d[v ] ª®­¥·­® (·²®¡» ³¡¥¤¨²¼±¿ ¢ ½²®¬, ¤®±² ²®·­® ¯®±¬®²°¥²¼ ­  ¯°®¶¥¤³°³ °¥« ª± ¶¨¨:
¯°¨ ³¬¥­¼¸¥­¨¨ d[v ] ¯°®¨±µ®¤¨² ¯°¨±¢ ¨¢ ­¨¥ ¯¥°¥¬¥­­®©  [v ]).
«¿ ª ¦¤®© ¢¥°¸¨­» v £° ´  G ¢ ½²®² £° ´ ¢ª«¾· ¥²±¿ °¥¡°® ±
­ · «®¬  [v ] ¨ ª®­¶®¬ v . ® ¯®±²°®¥­¨¾ ½²® °¥¡°® ¿¢«¿¥²±¿ °¥¡°®¬
¨±µ®¤­®£® £° ´  G.
° §³ ¯®±«¥ ¨­¨¶¨ «¨§ ¶¨¨ £° ´ G ±®±²®¨² ²®«¼ª® ¨§ ­ · «¼­®© ¢¥°¸¨­» ¨ ²¥¬ ± ¬»¬ ¿¢«¿¥²±¿ ¤¥°¥¢®¬. » ¡³¤¥¬ ¤®ª §»¢ ²¼
¯® ¨­¤³ª¶¨¨, ·²® ®­ ®±² ¥²±¿ ¤¥°¥¢®¬ ¯®±«¥ ¢»¯®«­¥­¨¿ ¯°®¨§¢®«¼­®© ¯®±«¥¤®¢ ²¥«¼­®±²¨ ®¯¥° ¶¨© °¥« ª± ¶¨¨.
®£¤  ¢ ­¥¬ ¯®¿¢«¿¾²±¿ ­®¢»¥ ¢¥°¸¨­»? ²® ¯°®¨±µ®¤¨² ¯°¨
¢»¯®«­¥­¨¨ ®¯¥° ¶¨¨ °¥« ª± ¶¨¨ °¥¡°  (u; v ), ¤® ª®²®°®© d[v ] ¡»«® ¡¥±ª®­¥·­»¬ (  ±² «® ª®­¥·­»¬ | ¯®±«¥ °¥« ª± ¶¨¨ «¾¡®£® °¥¡°  (x; y ) §­ ·¥­¨¥ d[y ] ®¡¿§ ²¥«¼­® ª®­¥·­®).  ½²®² ¬®¬¥­²  [v ]
±² ­®¢¨²±¿ ° ¢­»¬ u, ²® ¥±²¼ ª ¤¥°¥¢³ G ¤®¡ ¢«¿¥²±¿ «¨±². °¨
½²®¬ ®­® ®±² ¥²±¿ ¤¥°¥¢®¬.
±² ¥²±¿ ¯°®¢¥°¨²¼, ·²® £° ´ G ®±² ¥²±¿ ¤¥°¥¢®¬ ¨ ¢ ²®¬ ±«³· ¥, ª®£¤  ¯°¨ °¥« ª± ¶¨¨ °¥¡°  (u; v ) §­ ·¥­¨¥ d[v ] ³¬¥­¼¸ ¥²±¿ ®² ®¤­®£® ª®­¥·­®£® §­ ·¥­¨¿ ¤® ¤°³£®£®.  ¢ ©²¥ ¯®±¬®²°¨¬,

° ²· ©¸¨¥ ¯³²¨ ¨ °¥« ª± ¶¨¿

507

¨±.25.4 : ½±ª¨§ ±¬. ­  ¯®«¿µ ª­¨£¨
25.4. «®µ®© ±«³· ©: °¥« ª± ¶¨¿ °¥¡°  (u; v), £¤¥ ¢¥°¸¨­  u ¿¢«¿¥²±¿
¯®²®¬ª®¬ v ¢ ¤¥°¥¢¥ ¯°¥¤¸¥±²¢®¢ ­¨¿. ±«¨ ² ª®¥ ¯°®¨¢µ®¤¨², ¢®§­¨ª ¥² ¶¨ª«,
¨¬¥¾¹¨© ®²°¨¶ ²¥«¼­³¾ ±³¬¬³ ¢¥±®¢.
¨±. 25.4

·²® ¯°®¨±µ®¤¨² ± G ¯°¨ °¥« ª± ¶¨¨ ² ª®£® °¥¡°  (u; v ). ®¤¤¥°¥¢® ± ª®°­¥¬ ¢ v ®²°¥§ ¥²±¿ (®² ¯°¥¦­¥£® °®¤¨²¥«¿ ¢¥°¸¨­» v ) ¨
¯°¨¢¨¢ ¥²±¿ ª ¢¥°¸¨­¥ u ( [v ] ±² ­®¢¨²±¿ ° ¢­»¬ u). ²® ¬®¦¥²
­ °³¸¨²¼ ±²°³ª²³°³ ¤¥°¥¢  ²®«¼ª® ¢ ²®¬ ±«³· ¥, ¥±«¨ ¢¥°¸¨­  u
¡»«  ¯®²®¬ª®¬ ¢¥°¸¨­» v , ²® ¥±²¼ «¥¦ «  ¢ ¯®¤¤¥°¥¢¥ ± ª®°­¥¬ v
(¯°¨ ½²®¬ ®¡° §³¥²±¿ ¶¨ª«, ±¬. °¨±. 25.4)
 ¬ ®±² ¥²±¿ ³¡¥¤¨²¼±¿, ·²® ² ª®£® ¯°®¨§®©²¨ ­¥ ¬®¦¥². °®¢¥°¨¬, ·²® ¢ ½²®¬ ±«³· ¥ ®¡° §³¾¹¨©±¿ ¶¨ª« (®² v ª u ¢ ¤¥°¥¢¥
¯°¥¤¸¥±²¢®¢ ­¨¿,   § ²¥¬ ¯® °¥¡°³ (u; v )) ¨¬¥¥² ®²°¨¶ ²¥«¼­³¾
±³¬¬³ ¢¥±®¢.
®±ª®«¼ª³ °¥¡°® (u; v ) ¯®¤¢¥°£«®±¼ °¥« ª± ¶¨¨, ¤® ¥¥ ¢»¯®«­¥­¨¿
¨¬¥«® ¬¥±²® ­¥° ¢¥­±²¢® d[u] + w(u; v ) < d[v ], ¨«¨ (d[u] ; d[v ]) +
w(u; v ) < 0. » ±¥©· ± ¯®ª ¦¥¬, ·²® ¢¥± ¯³²¨ ®² v ¢ u ¢ £° ´¥ G ­¥
¯°¥¢®±µ®¤¨² d[u] ; d[v ], ¨ ²¥¬ ± ¬»¬ ­ ©¤¥¬ ¶¨ª« ®²°¨¶ ²¥«¼­®£®
¢¥±  ¢ £° ´¥ G, ¤®±²¨¦¨¬»© ¨§ s, ª®²®°®£® ¯® ¯°¥¤¯®«®¦¥­¨¾ ­¥
±³¹¥±²¢³¥².
² ª, ¯®·¥¬³ ¦¥ ¢¥± ¯³²¨ ¢ G ®² ¢¥°¸¨­» v ª ¢¥°¸¨­¥ u ­¥
¯°¥¢®±µ®¤¨² ° §­¨¶» §­ ·¥­¨© ´³­ª¶¨¨ d ¢ ª®­¶¥ ¨ ­ · «¥ ¯³²¨?
·¥¢¨¤­®, ¤®±² ²®·­® ¯°®¢¥°¨²¼ ½²® ¤«¿ ®¤­®£® °¥¡° , ²® ¥±²¼
¯°®¢¥°¨²¼, ·²® ¥±«¨ °¥¡°® (p; q ) ¢ ª ª®©-²® ¬®¬¥­² ¢µ®¤¨² ¢ G ,
²® ¢ ½²®² ¬®¬¥­²
w(p; q) 6 d[q] ; d[p]
(25:1)
²® ¥±²¼ d[q ] > d[p] + w(p; q ). ¥¯®±°¥¤±²¢¥­­® ¯®±«¥ °¥« ª± ¶¨¨
°¥¡°  (p; q ) ½²® ­¥° ¢¥­±²¢® ®¡° ¹ ¥²±¿ ¢ ° ¢¥­±²¢®.  ²¥¬ ¢¥«¨·¨­» d[p] ¨ d[q ] ¬®£³² ³¬¥­¼¸ ²¼±¿. ±«¨ ³¬¥­¼¸ ¥²±¿ d[p], ²® ­¥° ¢¥­±²¢® ­¥ ­ °³¸ ¥²±¿. ±«¨ ³¬¥­¼¸ ¥²±¿ d[q ], ½²® §­ ·¨², ·²®
¯°®¨±µ®¤¨² °¥« ª± ¶¨¿ °¥¡° , ¢¥¤³¹¥£® ¢ q , ¯°¨ ½²®¬ ¬¥­¿¥²±¿ ¨
[q] ¨ ¤«¿ ­®¢®£® °¥¡°  ([q]; q) ¢»¯®«­¥­® ­¥° ¢¥­±²¢® (25.1). ²®
° ±±³¦¤¥­¨¥ § ¢¥°¸ ¥² ¤®ª § ²¥«¼±²¢® «¥¬¬» 25.8
³±²¼ ¢ °¥§³«¼² ²¥ ¯®±«¥¤®¢ ²¥«¼­®±²¨ °¥« ª± ¶¨© ¬» ¤®¡¨«¨±¼
²®£®, ·²® d[v ] =  (s; v ) ¤«¿ ¢±¥µ ¢¥°¸¨­ v . ®ª ¦¥¬, ·²® ¢ ½²®¬
±«³· ¥ £° ´ G ¿¢«¿¥²±¿ ¤¥°¥¢®¬ ª° ²· ©¸¨µ ¯³²¥©.
¥¬¬  25.9
³±²¼ G = (V; E ) | ¢§¢¥¸¥­­»© ®°¨¥­²¨°®¢ ­­»© £° ´ ± ¢¥±®¢®© ´³­ª¶¨¥© w ¨ ¨±µ®¤­®© ¢¥°¸¨­®© s, ¯°¨·¥¬ ¢ £° ´¥ G ­¥²
¶¨ª«®¢ ®²°¨¶ ²¥«¼­®£® ¢¥± , ¤®±²¨¦¨¬»µ ¨§ s. °¥¤¯®«®¦¨¬, ·²®
¯®±«¥ ®¯¥° ¶¨¨ Initialize-Single-Source(G; s), §  ª®²®°®© ±«¥¤³¥² ­¥ª®²®° ¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼ °¥« ª± ¶¨© °¥¡¥°, ®ª § «®±¼, ·²®
d[v] = (s; v ) ¤«¿ ¢±¥µ v 2 V . ®£¤  ¯®¤£° ´ ¯°¥¤¸¥±²¢®¢ ­¨¿ G
¿¢«¿¥²±¿ ¤¥°¥¢®¬ ª° ²· ©¸¨µ ¯³²¥©.

508

« ¢  25 ° ²· ©¸¨¥ ¯³²¨ ¨§ ®¤­®© ¢¥°¸¨­»

®ª § ²¥«¼±²¢®
®£« ±­® ®¯°¥¤¥«¥­¨¾, ­ ¬ ­ ¤® ¯°®¢¥°¨²¼, ·²® V [G ] ±®¢¯ ¤ ¥² ±® ¬­®¦¥±²¢®¬ ¢¥°¸¨­ £° ´  G, ¤®±²¨¦¨¬»µ ¨§ s, ·²® G |
¤¥°¥¢® ± ª®°­¥¬ s, ¨ ·²® ¯³²¨ ¢ G ¨§ s ¢ ¥£® ¢¥°¸¨­» ¿¢«¿¾²±¿
ª° ²· ©¸¨¬¨ ¯³²¿¬¨ ¢ G.
²®°®¥ ¨§ ½²¨µ ³²¢¥°¦¤¥­¨© ¥±²¼ «¥¬¬  25.8; ¨§ ­¥¥ ¦¥ ±«¥¤³¥², ·²® ¢±¥ ¢¥°¸¨­» G ¤®±²¨¦¨¬» ¨§ s (¤ ¦¥ ¢ ¯®¤£° ´¥ G );
®¡° ²­®, ¥±«¨ ¢¥°¸¨­  v 6= s ¤®±²¨¦¨¬  ¢ £° ´¥ G ¨§ s, ²®
d[v] = (s; v) < 1, ² ª ·²® ¨¬¥«  ¬¥±²® °¥« ª± ¶¨¿ °¥¡°  ± ª®­¶®¬
v ¨ [v] 6= nil, ²® ¥±²¼ v 2 V [G ]. ²¨¬ ¤®ª § ­® ¯¥°¢®¥ ³²¢¥°¦¤¥­¨¥.
®ª ¦¥¬ ²°¥²¼¥ ³²¢¥°¦¤¥­¨¥. ¥° ¢¥­±²¢® (25.1) £ ° ­²¨°³¥²,
·²® ¤«¨­  ¯³²¨ ®² s ¤® v ¢ ¤¥°¥¢¥ G ­¥ ¯°¥¢®±µ®¤¨² d[v ] ; d[s] =
d[v] = (s; v), ² ª ·²® ¯³±²¼ ½²®² | ª° ²· ©¸¨©.
¯° ¦­¥­¨¿
25.1-1 ª ¦¨²¥ ¥¹¥ ¤¢  ¤¥°¥¢  ª° ²· ©¸¨µ ¯³²¥© ¤«¿ £° ´ 
°¨±. 25.2.
25-1.2 °¨¢¥¤¨²¥ ¯°¨¬¥° ¢§¢¥¸¥­­®£® ®°¨¥­²¨°®¢ ­­®£® £° ´ 
G = (V; E ) ± ¨±µ®¤­®© ¢¥°¸¨­®© s, ®¡« ¤ ¾¹¥£® ±«¥¤³¾¹¨¬ ±¢®©±²¢®¬: ¤«¿ ª ¦¤®£® °¥¡°  (u; v ) 2 E ±³¹¥±²¢³¥² ª ª ¤¥°¥¢® ª° ²· ©¸¨µ ¯³²¥© ± ª®°­¥¬ s, ±®¤¥°¦ ¹¥¥ °¥¡°® (u; v ), ² ª ¨ ¤¥°¥¢®
ª° ²· ©¸¨µ ¯³²¥© ± ª®°­¥¬ s, ³ª § ­­®£® °¥¡°  ­¥ ±®¤¥°¦ ¹¥¥.
25-1.3 ¡¥¤¨²¥±¼, ·²® ¤®ª § ²¥«¼±²¢® «¥¬¬» 25.3 ¯°®µ®¤¨² ¨ ¤«¿
²®£® ±«³· ¿, ª®£¤  ¢¥±  ¯³²¥© ° ¢­» 1 ¨«¨ ;1.
25-1.4 ³±²¼ G = (V; E ) | ¢§¢¥¸¥­­»© ®°¨¥­²¨°®¢ ­­»©
£° ´ ± ¨±µ®¤­®© ¢¥°¸¨­®© s. °¥¤¯®«®¦¨¬, ·²® ¯®±«¥ ®¯¥° ¶¨¨
Initialize-Single-Source(G; s), §  ª®²®°®© ±«¥¤³¥² ­¥ª®²®° ¿
¯®±«¥¤®¢ ²¥«¼­®±²¼ °¥« ª± ¶¨© °¥¡¥°, ®ª § «®±¼, ·²®  [s] 6= nil.
®ª ¦¨²¥, ·²® G ±®¤¥°¦¨² ¶¨ª« ®²°¨¶ ²¥«¼­®£® ¢¥± .
25-1.5 ³±²¼ G = (V; E ) | ¢§¢¥¸¥­­»© ®°¨¥­²¨°®¢ ­­»© £° ´, ¢
ª®²®°®¬ ¢¥±  ¢±¥µ °¥¡¥° ­¥®²°¨¶ ²¥«¼­». »¡¥°¥¬ ¨±µ®¤­³¾ ¢¥°¸¨­³ s 2 V ,   ¤«¿ ª ¦¤®© v 2 V n fsg ¢»¡¥°¥¬ ¢¥°¸¨­³  [v ] 2 V
² ª¨¬ ®¡° §®¬, ·²®¡»  [v ] ¡»«  ¯°¥¤¸¥±²¢¥­­¨ª®¬ v ­  ­¥ª®²®°®¬ ª° ²· ©¸¥¬ ¯³²¨ ¨§ s ¢ v ; ¥±«¨ v ­¥¤®±²¨¦¨¬  ¨§ s, ¯®«®¦¨¬
 [v ] = nil. °¨¢¥¤¨²¥ ¯°¨¬¥° £° ´  G ¨ ´³­ª¶¨¨  , ³¤®¢«¥²¢®°¿¾¹¨µ ¯°¨¢¥¤¥­­»¬ ¢»¸¥ ³±«®¢¨¿¬, ¤«¿ ª®²®°»µ ¯®¤£° ´ G ,
¯®±²°®¥­­»© ¯® ´³­ª¶¨¨  , ±®¤¥°¦¨² ¶¨ª«» (¢ ±¨«³ «¥¬¬» 25.8,
¨­¨¶¨ «¨§ ¶¨¿ ± ¯®±«¥¤®¢ ²¥«¼­®±²¼¾ °¥« ª± ¶¨© ² ª®© ´³­ª¶¨¨
 ¤ ²¼ ­¥ ¬®¦¥²).
25-1.6 ³±²¼ G = (V; E ) | ¢§¢¥¸¥­­»© ®°¨¥­²¨°®¢ ­­»© £° ´
± ­ · «¼­®© ¢¥°¸¨­®© s, ­¥ ¨¬¥¾¹¨© ¶¨ª«®¢ ®²°¨¶ ²¥«¼­®£® ¢¥± , ¤®±²¨¦¨¬»µ ¨§ s. ®ª ¦¨²¥, ·²® ¯®±«¥ ®¯¥° ¶¨¨ InitializeSingle-Source(G; s), §  ª®²®°®© ±«¥¤³¥² ¯°®¨§¢®«¼­ ¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼ °¥« ª± ¶¨© °¥¡¥°, ¢±¿ª ¿ ¢¥°¸¨­  v 2 V [G ] ¤®±²¨¦¨¬ 
¨§ s ¢ £° ´¥ G .
25-1.7 ³±²¼ G = (V; E ) | ¢§¢¥¸¥­­»© ®°¨¥­²¨°®¢ ­­»© £° ´

° ²· ©¸¨¥ ¯³²¨ ¨ °¥« ª± ¶¨¿

509

¨±. 25.5
¨±. 25.5 ¨±. 25.5. «£®°¨²¬ ¥©ª±²°». ±µ®¤­ ¿ ¢¥°¸¨­  | ª° ©­¿¿ «¥¢ ¿.
¶¥­ª¨ ª° ²· ©¸¥£® ¯³²¨ ³ª § ­» ¢ ¢¥°¸¨­ µ. ¥°»¬ ¶¢¥²®¬ ¢»¤¥«¥­» °¥¡° 
(u; v), ¤«¿ ª®²®°»µ [v] = u. ¥°­»¥ ¢¥°¸¨­» «¥¦ ² ¢ ¬­®¦¥±²¢¥ S , ®±² «¼­»¥
­ µ®¤¿²±¿ ¢ ®·¥°¥¤¨ Q = V n S . ( ) ¥°¥¤ ¯¥°¢®© ¨²¥° ¶¨¥© ¶¨ª«  while. ¥° ¿
¢¥°¸¨­  ¨¬¥¥² ¬¨­¨¬ «¼­®¥ §­ ·¥­¨¥ d ¨ ¢»¡¨° ¥²±¿ ¢ ª ·¥±²¢¥ ¢¥°¸¨­» u ¢
±²°®ª¥ 5 (¡{¥) ®±«¥¤®¢ ²¥«¼­»¥ ±®±²®¿­¨¿ ¯®±«¥ ª ¦¤®© ¨²¥° ¶¨¨ ¶¨ª«  while.
¥° ¿ ¢¥°¸¨­  ¢»¡¨° ¥²±¿ ¢ ª ·¥±²¢¥ ¢¥°¸¨­» u ¯°¨ ±«¥¤³¾¹¥© ¨²¥° ¶¨¨.
­ ·¥­¨¿ d ¨  ­  °¨±³­ª¥ (¥) | ®ª®­· ²¥«¼­»¥.

± ­ · «¼­®© ¢¥°¸¨­®© s, ­¥ ±®¤¥°¦ ¹¨© ¶¨ª«®¢ ®²°¨¶ ²¥«¼­®£®
¢¥± . ®ª ¦¨²¥, ·²® ¬®¦­® ¯°®¢¥±²¨ ®¯¥° ¶¨¾ Initialize-SingleSource(G; s),   § ²¥¬ jV j; 1 °¥« ª± ¶¨© °¥¡¥° ² ª¨¬ ®¡° §®¬, ·²®
¢ °¥§³«¼² ²¥ ° ¢¥­±²¢® d[v ] =  (s; v ) ¡³¤¥² ¢»¯®«­¿²¼±¿ ¤«¿ ¢±¥µ
v 2 V.
25-1.8 ³±²¼ G = (V; E ) | ¢§¢¥¸¥­­»© ®°¨¥­²¨°®¢ ­­»© £° ´ ±
­ · «¼­®© ¢¥°¸¨­®© s. °¥¤¯®«®¦¨¬, ·²® ¨§ ¢¥°¸¨­» s ¤®±²¨¦¨¬
¶¨ª« ®²°¨¶ ²¥«¼­®£® ¢¥± . ®ª ¦¨²¥, ·²® ±³¹¥±²¢³¥² ¡¥±ª®­¥·­ ¿
¯®±«¥¤®¢ ²¥«¼­®±²¼ °¥« ª± ¶¨©, ¯®±«¥ ª ¦¤®© ¨§ ª®²®°»µ ´³­ª¶¨¿
d ¬¥­¿¥²±¿.
«£®°¨²¬ ¥©ª±²°» °¥¸ ¥² § ¤ ·³ ® ª° ²· ©¸¨µ ¯³²¿µ ¨§ ®¤­®© ¢¥°¸¨­» ¤«¿ ¢§¢¥¸¥­­®£® ®°¨¥­²¨°®¢ ­­®£® £° ´  G = (V; E )
± ¨±µ®¤­®© ¢¥°¸¨­®© s, ¢ ª®²®°®¬ ¢¥±  ¢±¥µ °¥¡¥° ­¥®²°¨¶ ²¥«¼­».
(w(u; v ) > 0 ¤«¿ ¢±¥µ (u; v ) 2 E ).  ½²®¬ ° §¤¥«¥ ¬» ° ±±¬ ²°¨¢ ¥¬
²®«¼ª® ² ª¨¥ £° ´».
 ¯°®¶¥±±¥ ° ¡®²»  «£®°¨²¬  ¥©ª±²°» ¯®¤¤¥°¦¨¢ ¥²±¿ ¬­®¦¥±²¢® S  V , ±®±²®¿¹¥¥ ¨§ ¢¥°¸¨­ v , ¤«¿ ª®²®°»µ  (s; v ) ³¦¥ ­ ©¤¥­® (²® ¥±²¼ d[v ] =  (s; v )). «£®°¨²¬ ¢»¡¨° ¥² ¢¥°¸¨­³ u 2 V n S ±
­ ¨¬¥­¼¸¨¬ d[u], ¤®¡ ¢«¿¥² u ª ¬­®¦¥±²¢³ S ¨ ¯°®¨§¢®¤¨² °¥« ª± ¶¨¾ ¢±¥µ °¥¡¥°, ¢»µ®¤¿¹¨µ ¨§ u, ¯®±«¥ ·¥£® ¶¨ª« ¯®¢²®°¿¥²±¿.
¥°¸¨­», ­¥ «¥¦ ¹¨¥ ¢ S , µ° ­¿²±¿ ¢ ®·¥°¥¤¨ ± ¯°¨®°¨²¥² ¬¨ Q,
®¯°¥¤¥«¿¥¬»¬¨ §­ ·¥­¨¿¬¨ ´³­ª¶¨¨ d. °¥¤¯®« £ ¥²±¿, ·²® £° ´
§ ¤ ­ ± ¯®¬®¹¼¾ ±¯¨±ª®¢ ±¬¥¦­»µ ¢¥°¸¨­.
Dijkstra(G,w,s)
1 Initialize-Single-Source(G,s)
2 S \gets \emptyset
3 Q \gets V[G]
4 while Q \ne \emptyset
5
do u \gets Extract-Min(Q)
6
S \gets S \cup \{u\}
7
for (¤«¿) ¢±¥µ ¢¥°¸¨­ v\in Adj[u]
8
do Relax(u,v,w)

 ¡®²   «£®°¨²¬  ¥©ª±²°» ¯®ª § ­  ­  °¨±. 25.5.  ±²°®ª¥ 1
¨­¨¶¨ «¨§¨°³¾²±¿ d ¨  ,   ¢ ±²°®ª µ 2 ¨ 3 ¨­¨¶¨ «¨§¨°³¾²±¿ ¬­®¦¥±²¢® S (ª ª ¯³±²®¥) ¨ ®·¥°¥¤¼ Q = V n S = V . °¨ ª ¦¤®¬
¨±¯®«­¥­¨¨ ¶¨ª«  ¢ ±²°®ª µ 4{8 ¨§ ®·¥°¥¤¨ Q = V n S ¨§»¬ ¥²±¿

510

« ¢  25 ° ²· ©¸¨¥ ¯³²¨ ¨§ ®¤­®© ¢¥°¸¨­»

¢ ½²®¬ ±«³· ¥ ª °²¨­ª  ®±² « ±¼ ²®© ¦¥, ­® ¯®¤¯¨±¼ ¯¥°¥¯¨± ­ 
25.6  ¯³²¨ ®² s ¤® u ¢»¤¥«¥­  · ±²¼ (s{x), ¯°®µ®¤¿¹ ¿ ¶¥«¨ª®¬
¢­³²°¨ S , ¨ ¯¥°¢ ¿ ¢¥°¸¨­  y, «¥¦ ¹ ¿ ¢­¥ S (¢®§¬®¦­®, x = s ¨«¨ y = u).
¨±. 25.6

¢¥°¸¨­  u ± ­ ¨¬¥­¼¸¨¬ §­ ·¥­¨¥¬ d[u]; ®­  ¤®¡ ¢«¿¥²±¿ ª ¬­®¦¥±²¢³ S (¢ ¯¥°¢»© ° § ¨¬¥¥¬ u = s).  ±²°®ª µ 7{8 ª ¦¤®¥ °¥¡°®
(u; v ), ¢»µ®¤¿¹¥¥ ¨§ u, ¯®¤¢¥°£ ¥²±¿ °¥« ª± ¶¨¨ (¯°¨ ½²®¬ ¬®£³²
¨§¬¥­¨²¼±¿ ®¶¥­ª  d[v ] ¨ ¯°¥¤¸¥±²¢¥­­¨ª  [v ]).  ¬¥²¨¬, ·²® ¢
¶¨ª«¥ ­®¢»¥ ¢¥°¸¨­» ¢ ®·¥°¥¤¼ Q ­¥ ¤®¡ ¢«¿¾²±¿ ¨ ·²® ª ¦¤ ¿
¢¥°¸¨­ , ³¤ «¿¥¬ ¿ ¨§ Q, ¤®¡ ¢«¿¥²±¿ ª ¬­®¦¥±²¢³ S «¨¸¼ ®¤­ ¦¤». «¥¤®¢ ²¥«¼­®, ·¨±«® ¨²¥° ¶¨© ¶¨ª«  while ° ¢­® jV j.
®±ª®«¼ª³  «£®°¨²¬ ¥©ª±²°» ¢±¿ª¨© ° § ¢»¡¨° ¥² ¤«¿ ®¡° ¡®²ª¨ ¢¥°¸¨­» ± ­ ¨¬¥­¼¸¥© ®¶¥­ª®© ª° ²· ©¸¥£® ¯³²¨, ¬®¦­®
±ª § ²¼, ·²® ®­ ®²­®±¨²±¿ ª ¦ ¤­»¬  «£®°¨²¬ ¬ (£«. 17). ®ª ¦¥¬, ·²® ¢ ¤ ­­®¬ ±«³· ¥ ¦ ¤­ ¿ ±²° ²¥£¨¿ ¤ ¥² ¯° ¢¨«¼­»© °¥§³«¼² ².
¥®°¥¬  25.10 (° ¢¨«¼­®±²¼  «£®°¨²¬  ¥©ª±²°»)
³±²¼ G = (V; E ) | ¢§¢¥¸¥­­»© ®°¨¥­²¨°®¢ ­­»© £° ´ ± ­¥®²°¨¶ ²¥«¼­®© ¢¥±®¢®© ´³­ª¶¨¥© w : E ! R ¨ ¨±µ®¤­®© ¢¥°¸¨­®© s.
®£¤  ¯®±«¥ ¯°¨¬¥­¥­¨¿  «£®°¨²¬  ¥©ª±²°» ª ½²®¬³ £° ´³ ¤«¿
¢±¥µ ¢¥°¸¨­ u 2 V ¡³¤³² ¢»¯®«­¿²¼±¿ ° ¢¥­±²¢  d[u] =  (s; u).
®ª § ²¥«¼±²¢®
°®¢¥°¨¬, ·²® ¯®±«¥ «¾¡®£® ·¨±«  ¨²¥° ¶¨© ¶¨ª«  textbfwhile
¢»¯®«­¥­® ±«¥¤³¾¹¥¥ ±¢®©±²¢®:
(a) ¤«¿ ¢¥°¸¨­ v 2 S §­ ·¥­¨¥ d[v ] ° ¢­®  (s; v ), ¯°¨·¥¬ ±³¹¥±²¢³¥² ¯³²¼ ¨§ s ¢ v ¢¥±   (s; v ), ¯°®µ®¤¿¹¨© ²®«¼ª® ¯® ¢¥°¸¨­ ¬
¨§ S ;
(b) ¤«¿ ¢¥°¸¨­ v 2 Q = V n S §­ ·¥­¨¥ d[v ] ° ¢­® ­ ¨¬¥­¼¸¥¬³
¢¥±³ ¯³²¨ ¨§ s ¢ v , ¥±«¨ ³·¨²»¢ ²¼ ²®«¼ª® ²¥ ¯³²¨, ¢ ª®²®°»µ ¢±¥
¢¥°¸¨­», ª°®¬¥ ¯®±«¥¤­¥© (v ), «¥¦ ² ¢ S (¥±«¨ ² ª¨µ ¯³²¥© ­¥²,
d[v] = 1).
®±«¥ ¯¥°¢®© ¨²¥° ¶¨¨ ¶¨ª«  (ª®£¤  ¢ S «¥¦¨² ²®«¼ª® ¢¥°¸¨­ 
s ¨ ²®«¼ª® ·²® ¯°®¢¥¤¥­» °¥« ª± ¶¨¨ ¢±¥µ °¥¡¥°, ¢¥¤³¹¨µ ¨§ s)
½²® ±¢®©±²¢® ¢»¯®«­¥­®. °®¢¥°¨¬, ·²® ®­® ­¥ ­ °³¸¨²±¿ ¨ ­ 
±«¥¤³¾¹¨µ ¨²¥° ¶¨¿µ.
³±²¼ u | ¢¥°¸¨­  Q ± ¬¨­¨¬ «¼­»¬ §­ ·¥­¨¥¬ d[u]. ±«¨
d[u] = 1, ²® ­¥ ±³¹¥±²¢³¥² ¯³²¨, ¢ ª®²®°®¬ ¢±¥ ¢¥°¸¨­», ª°®¬¥ ¯®±«¥¤­¥©, «¥¦ ² ¢ S . ­ ·¨², ¨§ S ¢®®¡¹¥ ­¥«¼§¿ ­¨ª ª ¢»©²¨
(®¡®°¢ ¢ ¯³²¼ ¢ ¬®¬¥­² ¢»µ®¤ , ¬» ¯®«³·¨«¨ ¡» ¯³²¼ ± ³ª § ­­»¬
±¢®©±²¢®¬). ³±²¼ ²¥¯¥°¼ d[u] ª®­¥·­®. ®£¤  ±³¹¥±²¢³¥² ¯³²¼ ¨§
s ¢ u ¢¥±  d[u], ¯°®µ®¤¿¹¨© ¯® ¢¥°¸¨­ ¬ S ¤® ¯®±«¥¤­¥£® ¬®¬¥­² 
(¤® ¢¥°¸¨­» u). ®ª ¦¥¬, ·²® ®­ ¡³¤¥² ª° ²· ©¸¨¬. (¥¬ ± ¬»¬
¢¥°¸¨­³ u ¬®¦­® ¤®¡ ¢¨²¼ ¢ S , ­¥ ­ °³¸ ¿ ³²¢¥°¦¤¥­¨¿ (a).)
³±²¼ ¥±²¼ ª ª®©-²® ¤°³£®© ¯³²¼ ¨§ s ¢ u (°¨±. 25.6). ®±¬®²°¨¬
­  ¯¥°¢³¾ ¢¥°¸¨­³ ½²®£® ¯³²¨, «¥¦ ¹³¾ ¢­¥ S ; ®¡®§­ ·¨¬ ¥¥ y

° ²· ©¸¨¥ ¯³²¨ ¨ °¥« ª± ¶¨¿

511

(¢®§¬®¦­®, y = u).  ±²¼ ¯³²¨ ®² s ¤® y ¯°®µ®¤¨² ¯® S ¤® ¯®±«¥¤­¥£® ¬®¬¥­² , ¯®½²®¬³ ¢¥± ½²®© · ±²¨ ­¥ ¬¥­¼¸¥ d[y ] (¯® ¯°¥¤¯®«®¦¥­¨¾ (a)). ±² «®±¼ § ¬¥²¨²¼, ·²® ¢¥± ¢±¥£® ¯³²¨ ­¥ ¬¥­¼¸¥ ¢¥± 
¥£® · ±²¨ (¢¥±  °¥¡¥° ­¥®²°¨¶ ²¥«¼­») ¨ ·²® d[y ] 6 d[u], ¯®±ª®«¼ª³
¢ Q ¢¥°¸¨­  u ¨¬¥«  ­ ¨¬¥­¼¸¥¥ §­ ·¥­¨¥ d[u].
² ª, ³±«®¢¨¥ (a) ®±² ­¥²±¿ ¢¥°­»¬ ¯®±«¥ ¤®¡ ¢«¥­¨¿ u ª S .
±² ¥²±¿ ¯°®¢¥°¨²¼ ³±«®¢¨¥ (b). ®±ª®«¼ª³ S ³¢¥«¨·¨«®±¼ ¨ ±² «®
° ¢­»¬ S 0 = S [ fug, ¯³²¥©, ­¥ ¢»µ®¤¿¹¨µ ¨§ S ¤® ¯®±«¥¤­¥£® ¬®¬¥­² , ±² «® ¡®«¼¸¥, ¨ ¤«¿ ±®¡«¾¤¥­¨¿ ³±«®¢¨¿ (b) §­ ·¥­¨¿ d[v ]
¤«¿ v 2 Q ­ ¤® ³¬¥­¼¸ ²¼. ²® ¨ ¤¥« ¥²±¿ ¢ ¯°®¶¥±±¥ °¥« ª± ¶¨¨.
°¨ °¥« ª± ¶¨¨ °¥¡°  (u; v ) §­ ·¥­¨¥ d[v ] ±² ­®¢¨²±¿ ° ¢­»¬

d0 [v ] = min(d[v ]; d[u]+ w(u; v))
(25:2)
» §­ ¥¬, ·²® d[v ] ¥±²¼ ¢¥± ­¥ª®²®°®£® ¯³²¨, ª®²®°»© ¢¥¤¥² ¨§ s
¢ v , ®±² ¢ ¿±¼ ¤® ¯®±«¥¤­¥£® ¸ £  ¢ S . ²®°®© ·«¥­ d[u] + w(u; v )
¥±²¼ ¢¥± ­¥ª®²®°®£® ¯³²¨, ª®²®°»© ¢¥¤¥² ¨§ s ¢ u (®±² ¢ ¿±¼ ¤®
¯®±«¥¤­¥£® ¸ £  ¢ S ),   § ²¥¬ ¨¤¥² ¯® °¥¡°³ (u; v ).  ª¨¬ ®¡° §®¬
±³¹¥±²¢³¥² ¯³²¼ ¨§ s ¢ v , ª®²®°»© ¤® ¯®±«¥¤­¥£® ¸ £  ®±² ¥²±¿ ¢
S 0 ¨ ¨¬¥¥² ¢¥± d0[v ]. ®ª ¦¥¬, ·²® «¾¡®© ¯³²¼ p ¨§ s ¢ v , ª®²®°»© ¤®
¯®±«¥¤­¥£® ¸ £  ®±² ¥²±¿ ¢ S 0, ¨¬¥¥² ¢¥± ­¥ ¬¥­¼¸¥ d0[v ].  ± ¬®¬
¤¥«¥, ¥±«¨ x 2 S 0 | ¥£® ¯°¥¤¯®±«¥¤­¿¿ ¢¥°¸¨­ , ²® «¨¡® x 2 S , ¨
²®£¤  ¢¥± ¯³²¨ p ­¥ ¬¥­¼¸¥ d[v ] ¯® ¨­¤³ª²¨¢­®¬³ ¯°¥¤¯®«®¦¥­¨¾
(a), «¨¡® x = u, ¨ ²®£¤  ¢¥± ¯³²¨ p ­¥ ¬¥­¼¸¥ d[u] + w(u; v ).

» ¤®ª § «¨, ·²® ³±«®¢¨¿ (a) ¨ (b) ®±² ¾²±¿ ¢¥°­»¬¨ ¯®±«¥ «¾¡®£® ·¨±«  ¨²¥° ¶¨©. ­ ·¨², ®­¨ ¢¥°­» ¨ ¯®±«¥ ¢»µ®¤  ¨§ ¶¨ª« ;
¢ ½²®² ¬®¬¥­² S = V ¨ ¯®²®¬³ d[u] =  (s; u) ¤«¿ «¾¡®© ¢¥°¸¨­»
v 2 V.
§ ¤®ª § ­­®© ²¥®°¥¬» ¨ «¥¬¬» 25.9 ­¥¬¥¤«¥­­® ¢»²¥ª ¥²
«¥¤±²¢¨¥ 25.11
³±²¼ G = (V; E ) | ¢§¢¥¸¥­­»© ®°¨¥­²¨°®¢ ­­»© £° ´ ± ­¥®²°¨¶ ²¥«¼­®© ¢¥±®¢®© ´³­ª¶¨¥© w ¨ ¨±µ®¤­®© ¢¥°¸¨­®© s. ®£¤ 
¯®±«¥ ¯°¨¬¥­¥­¨¿  «£®°¨²¬  ¥©ª±²°» ª ½²®¬³ £° ´³ ¯®¤£° ´
¯°¥¤¸¥±²¢¥­­¨ª®¢ G ¡³¤¥² ¤¥°¥¢®¬ ª° ²· ©¸¨µ ¯³²¥© ± ª®°­¥¬
¢ s.
°¥¬¿ ° ¡®²»  «£®°¨²¬  ¥©ª±²°»
­ · «  ¯°¥¤¯®«®¦¨¬, ·²® ®·¥°¥¤¼ ± ¯°¨®°¨²¥² ¬¨ Q = V n S
°¥ «¨§®¢ ­  ª ª ¬ ±±¨¢. °¨ ½²®¬ ±²®¨¬®±²¼ ®¯¥° ¶¨¨ ExtractMin ¥±²¼ O(V ); ¯®±ª®«¼ª³  «£®°¨²¬ ¤¥« ¥² V ² ª¨µ ®¯¥° ¶¨©, ±³¬¬ °­ ¿ ±²®¨¬®±²¼ ¢±¥µ ³¤ «¥­¨© ¨§ ®·¥°¥¤¨ ¥±²¼ O(V 2 ). ²® ¦¥ ¤®
±²®¨¬®±²¨ ®±² «¼­»µ ®¯¥° ¶¨©, ²® ª ¦¤ ¿ ¢¥°¸¨­  v 2 V ¤®¡ ¢«¿¥²±¿ ª ¬­®¦¥±²¢³ S ²®«¼ª® ®¤¨­ ° §, ¨ ª ¦¤®¥ °¥¡°® ¨§ Adj [v ]
®¡° ¡ ²»¢ ¥²±¿ ²®¦¥ ®¤¨­ ° §. ¡¹¥¥ ª®«¨·¥±²¢® ½«¥¬¥­²®¢ ¢®
¢±¥µ ±¯¨±ª µ ±¬¥¦­»µ ¢¥°¸¨­ ¥±²¼ jE j; ±²®¨¬®±²¼ ª ¦¤®© °¥« ª± ¶¨¨ ¥±²¼ O(1). ®½²®¬³ ±²®¨¬®±²¼ ¯°®·¨µ ®¯¥° ¶¨© ¥±²¼ O(E ),
  ®¡¹ ¿ ±²®¨¬®±²¼  «£®°¨²¬  ¥±²¼ O(V 2 + E ).

512

« ¢  25 ° ²· ©¸¨¥ ¯³²¨ ¨§ ®¤­®© ¢¥°¸¨­»

±«¨ £° ´ ¿¢«¿¥²±¿ ° §°¥¦¥­­»¬, ¨¬¥¥² ±¬»±« °¥ «¨§®¢ ²¼ ®·¥°¥¤¼ ± ¯®¬®¹¼¾ (¤¢®¨·­®©) ª³·¨ (° §¤¥« 7.5). ®«³· ¥¬»©  «£®°¨²¬ ­ §»¢ ¾² ¨­®£¤  ¬®¤¨´¨¶¨°®¢ ­­»¬  «£®°¨²¬®¬ ¥©ª±²°»
(modied Dijkstra algorithm). ²®¨¬®±²¼ ®¯¥° ¶¨¨ Extract-Min
¯°¨ ² ª®© °¥ «¨§ ¶¨¨ ®·¥°¥¤¨ ¥±²¼ O(lg V ),   ±²®¨¬®±²¼ ¯®±²°®¥­¨¿ ª³·¨ (±²°®ª  3) ¥±²¼ O(V ). °¨±¢ ¨¢ ­¨¥ d[v ] d[u] + w(u; v )
¯°¨ °¥« ª± ¶¨¨ °¥¡°  °¥ «¨§³¥²±¿ ± ¯®¬®¹¼¾ ¢»§®¢  ¯°®¶¥¤³°»
Decrease-Key(Q; v; d[u] + w(u; v )), ¨¬¥¾¹¥£® ±²®¨¬®±²¼ O(lg V )
(±¬. ³¯° ¦­¥­¨¥ 7.5-4). ®«¨·¥±²¢® ² ª¨µ ¢»§®¢®¢ ­¥ ¯°¥¢®±µ®¤¨² jE j, ² ª ·²® ®¡¹ ¿ ±²®¨¬®±²¼ ¬®¤¨´¨¶¨°®¢ ­­®£®  «£®°¨²¬ 
¥©ª±²°» ¥±²¼ O((V + E ) lg V ) (¥±«¨ ¢±¥ ¢¥°¸¨­» ¤®±²¨¦¨¬» ¨§
¨±µ®¤­®©, ²® £° ´ ±¢¿§¥­, jE j > jV j; 1 ¨ ¯®±«¥¤­¾¾ ®¶¥­ª³ ¬®¦­®
¯¥°¥¯¨± ²¼ ª ª O(E lg V )).
±«¨ °¥ «¨§®¢ ²¼ ®·¥°¥¤¼ Q ¢ ¢¨¤¥ ´¨¡®­ ··¨¥¢®© ª³·¨ (±¬. £« ¢³ 21), ²® ¬®¦­® ¤®¡¨²¼±¿ ±²®¨¬®±²¨ O(V lg V + E ): ¢ ± ¬®¬ ¤¥«¥,
¯°¨ ½²®¬ ³·¥²­ ¿ ±²®¨¬®±²¼ ª ¦¤®© ¨§ jV j ®¯¥° ¶¨© ExtractMin ¡³¤¥² O(lg V ),   ³·¥²­ ¿ ±²®¨¬®±²¼ ª ¦¤®© ¨§ jE j ®¯¥° ¶¨©
Decrease-Key ¡³¤¥² O(1). ±² ²¨, ª³·¨ ¨¡®­ ··¨ ¡»«¨ ¨§®¡°¥²¥­» ¨¬¥­­® ¢ ±¢¿§¨ ± ¬®¤¨´¨¶¨°®¢ ­­»¬  «£®°¨²¬®¬ ¥©ª±²°»:
¯®±ª®«¼ª³ ¯°¨ ¥£® ¨±¯®«­¥­¨¨ ¬®¦¥² ¯®²°¥¡®¢ ²¼±¿ £®° §¤® ¡®«¼¸¥ ¢»§®¢®¢ ¯°®¶¥¤³°» Decrease-Key, ·¥¬ Extract-Min, µ®²¥«®±¼ ±­¨§¨²¼ ±²®¨¬®±²¼ Decrease-Key.
«£®°¨²¬ ¥©ª±²°» ­ ¯®¬¨­ ¥² ª ª  «£®°¨²¬ ¯®¨±ª  ¢ ¸¨°¨­³ (° §¤. 23.2), ² ª ¨  «£®°¨²¬ °¨¬  ­ µ®¦¤¥­¨¿ ¬¨­¨¬ «¼­®£®
¯®ª°»¢ ¾¹¥£® ¤¥°¥¢  (° §¤. 24.2). ®«¼ ¬­®¦¥±²¢  S ¢  «£®°¨²¬¥
¥©ª±²°»  ­ «®£¨·­  °®«¨ ¬­®¦¥±²¢  ·¥°­»µ ¢¥°¸¨­ ¯°¨ ¯®¨±ª¥
¢ ¸¨°¨­³. µ®¤±²¢®  «£®°¨²¬®¢ ¥©ª±²°» ¨ °¨¬  ¢ ²®¬, ·²® ®­¨
®¡  ¯®«¼§³¾²±¿ ®·¥°¥¤¼¾ ± ¯°¨®°¨²¥² ¬¨ ¯°¨ °¥ «¨§ ¶¨¨ ¦ ¤­®©
±²° ²¥£¨¨.
¯° ¦­¥­¨¿
25.2-1
°¨¬¥­¨²¥  «£®°¨²¬ ¥©ª±²°» ª £° ´³ ­  °¨±. 25.2, ¢»¡° ¢ § 
¨±µ®¤­³¾ ±­ · «  ¢¥°¸¨­³ s,   § ²¥¬ ¢¥°¸¨­³ y . «¥¤³¿ ®¡° §¶³
°¨±. 25.5, ¯®ª ¦¨²¥ µ®¤ ¨±¯®«­¥­¨¿  «£®°¨²¬ .
25-2.2
°¨¢¥¤¨²¥ ¯°¨¬¥° £° ´  (± ®²°¨¶ ²¥«¼­»¬¨ ¢¥± ¬¨ °¥¡¥°), ¤«¿
ª®²®°®£®  «£®°¨²¬ ¥©ª±²°» ¤ ¥² ­¥¢¥°­»© ®²¢¥². ¤¥ ¢ ¤®ª § ²¥«¼±²¢¥ ²¥®°¥¬» 25.10 ¨±¯®«¼§³¥²±¿ ­¥®²°¨¶ ²¥«¼­®±²¼ ¢¥±®¢®©
´³­ª¶¨¨?
25-2.3
±«¨ § ¬¥­¨²¼ ±²°®ª³ 4 ¢  «£®°¨²¬¥ ¥©ª±²°» ­ 
4 while |Q| >1

²® ·¨±«® ¨²¥° ¶¨© ¶¨ª«  while ³¬¥­¼¸¨²±¿ ­  1. ³¤¥² «¨ ¨§¬¥­¥­­»© ² ª¨¬ ®¡° §®¬  «£®°¨²¬ ¯° ¢¨«¼­»¬?
25-2.4

«£®°¨²¬ ¥««¬ ­ -®°¤ 

513

³±²¼ ± ª ¦¤»¬ °¥¡°®¬ ®°¨¥­²¨°®¢ ­­®£® £° ´  G = (V; E )
 ±±®¶¨¨°®¢ ­® ¤¥©±²¢¨²¥«¼­®¥ ·¨±«® r(u; v ), ¯°¨·¥¬ 0 6 r(u; v ) 6 1.
³¤¥¬ ¨­²¥°¯°¥²¨°®¢ ²¼ r(u; v ) ª ª À­ ¤¥¦­®±²¼Á | ¢¥°®¿²­®±²¼
²®£®, ·²® ±¨£­ « ³±¯¥¸­® ¯°®©¤¥² ¯® ª ­ «³ ¨§ u ¢ v . ·¨² ¿, ·²®
±®¡»²¨¿ ¯°®µ®¦¤¥­¨¿ ±¨£­ «  ¯® ° §«¨·­»¬ ª ­ « ¬ ­¥§ ¢¨±¨¬»,
¯°¥¤«®¦¨²¥  «£®°¨²¬ ¤«¿ ­ µ®¦¤¥­¨¿ ­ ¨¡®«¥¥ ­ ¤¥¦­®£® ¯³²¨
¬¥¦¤³ ¤¢³¬¿ ¤ ­­»¬¨ ¢¥°¸¨­ ¬¨.
25-2.5
³±²¼ G = (V; E ) | ¢§¢¥¸¥­­»© ®°¨¥­²¨°®¢ ­­»© £° ´ ± ¢¥±®¢®© ´³­ª¶¨¥© w : E ! f0; 1; : : :; W ; 1g, £¤¥ W > 0 | ¶¥«®¥ ·¨±«®. ®¤¨´¨¶¨°³©²¥ ¤«¿ ¤ ­­®£® ±«³· ¿  «£®°¨²¬ ¥©ª±²°» ² ª,
·²®¡» ®­ ¨±ª « ª° ²· ©¸¨¥ ¯³²¨ ¨§ ¤ ­­®© ¢¥°¸¨­» §  ¢°¥¬¿
O(WV + E ).
25-2.6
±®¢¥°¸¥­±²¢³©²¥ °¥¸¥­¨¥ ¯°¥¤»¤³¹¥£® ³¯° ¦­¥­¨¿, ±¤¥« ¢
¢°¥¬¿ ° ¡®²»  «£®°¨²¬  ° ¢­»¬ O((V +E ) lg W ). (ª § ­¨¥: ±ª®«¼ª® ° §«¨·­»µ ®¶¥­®ª ª° ²· ©¸¥£® ¯³²¨ ¤«¿ ¢¥°¸¨­ ¨§ V n S ¬®¦¥²
¢±²°¥²¨²¼±¿ ®¤­®¢°¥¬¥­­®?)

25.2. «£®°¨²¬ ¥««¬ ­ -®°¤ 
«£®°¨²¬ ¥««¬ ­ -®°¤  (Bellman-Ford algorithm) °¥¸ ¥² § ¤ ·³ ® ª° ²· ©¸¨µ ¯³²¿µ ¨§ ®¤­®© ¢¥°¸¨­» ¤«¿ ±«³· ¿, ª®£¤  ¢¥± ¬ °¥¡¥° ° §°¥¸¥­® ¡»²¼ ®²°¨¶ ²¥«¼­»¬¨. ²®²  «£®°¨²¬ ¢®§¢° ¹ ¥² §­ ·¥­¨¥ true, ¥±«¨ ¢ £° ´¥ ­¥² ¶¨ª«  ®²°¨¶ ²¥«¼­®£® ¢¥± , ¤®±²¨¦¨¬®£® ¨§ ¨±µ®¤­®© ¢¥°¸¨­», ¨ false, ¥±«¨ ² ª®¢®© ¶¨ª«
¨¬¥¥²±¿.  ¯¥°¢®¬ ±«³· ¥  «£®°¨²¬ ­ µ®¤¨² ª° ²· ©¸¨¥ ¯³²¨ ¨
¨µ ¢¥± ; ¢® ¢²®°®¬ ±«³· ¥ § ¤ ·  ª° ²· ©¸¨µ ¯³²¥© (¯® ª° ©­¥©
¬¥°¥ ¤«¿ ­¥ª®²®°»µ ¢¥°¸¨­) ­¥ ±³¹¥±²¢³¥².
®¤®¡­®  «£®°¨²¬³ ¥©ª±²°»,  «£®°¨²¬ ¥««¬ ­ -®°¤  ¯°®¨§¢®¤¨² °¥« ª± ¶¨¾ °¥¡¥°, ¯®ª  ¢±¥ §­ ·¥­¨¿ d[v ] ­¥ ±° ¢­¿¾²±¿ ±
(s; v ) (¥±«¨ ¢±¥  (s; v) ®¯°¥¤¥«¥­»).
Bellman-Ford(G,w,s)
1 Initialize-Single-Source(G,s)
2 for i \gets 1 to |V[G]|-1
3
do for (¤«¿) ª ¦¤®£® °¥¡°  (u,v) \in E[G]
4
do Relax(u,v,w)
5 for (¤«¿) ª ¦¤®£® °¥¡°  (u,v) \in E[G]
6
do if d[v]>d[u]+w(u,v)
7
then return \textsc{false}
8 return \textsc{true}

  °¨±. 25.7 ¯®ª § ­  ° ¡®²   «£®°¨²¬  ¥««¬ ­ -®°¤  ¤«¿
£° ´  ± ¯¿²¼¾ ¢¥°¸¨­ ¬¨. ®±«¥ ¨­¨¶¨ «¨§ ¶¨¨ (±²°®ª  1)  «£®°¨²¬ jV j ; 1 ° § ¤¥« ¥² ®¤­® ¨ ²® ¦¥: ¯¥°¥¡¨° ¥² ¯® ° §³ ¢±¥

514

« ¢  25 ° ²· ©¸¨¥ ¯³²¨ ¨§ ®¤­®© ¢¥°¸¨­»

25.7 «£®°¨²¬ ¥««¬ ­ -®°¤ . ±µ®¤­ ¿ ¢¥°¸¨­  | ª° ©­¿¿ «¥¢ ¿
(z ). ¶¥­ª¨ ª° ²· ©¸¥£® ¯³²¨ ³ª § ­» ¢ ¢¥°¸¨­ µ. ¥°»¬ ¶¢¥²®¬ ¢»¤¥«¥­»
°¥¡°  (u; v), ¤«¿ ª®²®°»µ [v] = u.  ¤ ­­®¬ ¯°¨¬¥°¥ ¯°¨ ª ¦¤®© ¨²¥° ¶¨¨
¶¨ª«  ¢ ±²°®ª µ 2{4 °¥¡°  ¯®¤¢¥°£ ¾²±¿ °¥« ª± ¶¨¨ ¢ «¥ª±¨ª®£° ´¨·¥±ª®¬
¯®°¿¤ª¥: (u; v), (u; x), (u; y), (v; u), (x; v), (x; y), (y; v), (y; z ), (z;u), (z; x). ( )
¥°¥¤ ¯¥°¢»¬ ®¡µ®¤®¬ °¥¡¥°. (¡{¤) ®±«¥¤®¢ ²¥«¼­»¥ ±®±²®¿­¨¿ ¯®±«¥ ª ¦¤®©
®¡° ¡®²ª¨ ¢±¥µ °¥¡¥°. ­ ·¥­¨¿ d ­  °¨±³­ª¥ (¤) | ®ª®­· ²¥«¼­»¥.  ¤ ­­®¬
±«³· ¥  «£®°¨²¬ ¥««¬ ­ -®°¤  ¢®§¢° ¹ ¥² §­ ·¥­¨¥ true.
¨±. 25.7

°¥¡°  £° ´  ¨ ¯®¤¢¥°£ ¥² ª ¦¤®¥ ¨§ ­¨µ °¥« ª± ¶¨¨ (±²°®ª¨ 2{4).
®±«¥ ½²®£®  «£®°¨²¬ ¯°®¢¥°¿¥², ­¥² «¨ ¶¨ª«  ®²°¨¶ ²¥«¼­®£® ¢¥± , ¤®±²¨¦¨¬®£® ¨§ ­ · «¼­®© ¢¥°¸¨­» s (±²°®ª¨ 5{8; ¢±ª®°¥ ¬»
³¢¨¤¨¬, ¯®·¥¬³ ½²  ¯°®¢¥°ª  ¯®§¢®«¿¥² ¢»¿¢¨²¼ ² ª®© ¶¨ª«).
°¥¬¿ ° ¡®²»  «£®°¨²¬  ¥««¬ ­ -®°¤  ¥±²¼ O(V E ), ¯®±ª®«¼ª³ ®¡¹¥¥ ·¨±«® °¥« ª± ¶¨© ¥±²¼ O(V E ), ±²®¨¬®±²¼ ¨­¨¶¨ «¨§ ¶¨¨
¢ ±²°®ª¥ 1 ¥±²¼ O(V ),   ±²®¨¬®±²¼ ¶¨ª«  ¢ ±²°®ª µ 5{8 ¥±²¼ O(E ).
®ª ¦¥¬, ·²®  «£®°¨²¬ ¥««¬ ­ -®°¤  ° ¡®² ¥² ¯° ¢¨«¼­®.
¥¬¬  25.12
³±²¼ G = (V; E ) | ¢§¢¥¸¥­­»© ®°¨¥­²¨°®¢ ­­»© £° ´ ± ¢¥±®¢®© ´³­ª¶¨¥© w ¨ ¨±µ®¤­®© ¢¥°¸¨­®© s, ­¥ ±®¤¥°¦ ¹¨© ¶¨ª«®¢
®²°¨¶ ²¥«¼­®£® ¢¥± , ¤®±²¨¦¨¬»µ ¨§ s. ®£¤  ¯® ®ª®­· ­¨¨ ° ¡®²» ¯°®¶¥¤³°» Bellman-Ford ° ¢¥­±²¢® d[v ] =  (s; v ) ¡³¤¥² ¢»¯®«­¿²¼±¿ ¤«¿ ¢±¥µ ¢¥°¸¨­ v , ¤®±²¨¦¨¬»µ ¨§ s.
®ª § ²¥«¼±²¢® ³±²¼ p = hs = v0; v1; : : :; vk = v i | ª° ²· ©¸¨©
¯³²¼ ¨§ s ¢ v . ®¦­® ±·¨² ²¼, ·²® ½²®² ¯³²¼ ­¥ ±®¤¥°¦¨² ¶¨ª«®¢ (®­¨ ²®«¼ª® ³¢¥«¨·¨¢ ¾² ¢¥± ¯® ¯°¥¤¯®«®¦¥­¨¾), ¯®½²®¬³
k 6 jV j ; 1. ®ª ¦¥¬ ¨­¤³ª¶¨¥© ¯® i, ·²® ¯®±«¥ i-®© ¨²¥° ¶¨¨
¶¨ª«  (¢ ±²°®ª µ 2{4) ¡³¤¥² ¢»¯®«­¥­® ° ¢¥­±²¢® d[vi] =  (s; vi):
¯®±ª®«¼ª³ ¢±¥£® ¤¥« ¥²±¿ jV j ; 1 ¨²¥° ¶¨©, «¥¬¬  ¡³¤¥² ±«¥¤®¢ ²¼
¨§ ½²®£® ³²¢¥°¦¤¥­¨¿ ¨ «¥¬¬» 25.5.
°¨ i = 0 ½²® ®·¥¢¨¤­®, ² ª ª ª d[s] =  (s; s) = 0 ¯°¨ ¢µ®¤¥
¢ ¶¨ª«. ³±²¼ ¯®±«¥ i ; 1-®© ¨²¥° ¶¨¨ ¡»«® d[vi;1] =  (s; vi;1).
°¨ i-®© ¨²¥° ¶¨¨ ¯°®¨§®©¤¥² °¥« ª± ¶¨¿ °¥¡°  (vi;1 ; vi), ¯®±«¥
·¥£® ¯® «¥¬¬¥ 25.7 ³±² ­®¢¨²±¿ ° ¢¥­±²¢® d[vi] =  (s; vi ). (°³£¨¥
°¥« ª± ¶¨¨ ¬®£³² ² ª¦¥ ³¬¥­¼¸ ²¼ d[vi], ­® ­¥ ¬®£³² ±¤¥« ²¼ ¥£®
¬¥­¼¸¥  (s; vi).)
«¥¤±²¢¨¥ 25.13
³±²¼ G = (V; E ) | ¢§¢¥¸¥­­»© ®°¨¥­²¨°®¢ ­­»© £° ´ ± ¢¥±®¢®© ´³­ª¶¨¥© w ¨ ¨±µ®¤­®© ¢¥°¸¨­®© s. ®£¤  ¢¥°¸¨­  v 2 V
¤®±²¨¦¨¬  ¨§ s ¢ ²®¬ ¨ ²®«¼ª® ²®¬ ±«³· ¥, ª®£¤  ¯® ®ª®­· ­¨¨
° ¡®²» ¯°®¶¥¤³°» Bellman-Ford, ¯°¨¬¥­¥­­®© ª ½²®¬³ £° ´³,
®ª §»¢ ¥²±¿, ·²® d[v ] < 1.
®ª § ²¥«¼±²¢® ®±² ¢«¿¥²±¿ ·¨² ²¥«¾ (³¯°. 25.3-2).
¥®°¥¬  25.14 (° ¢¨«¼­®±²¼  «£®°¨²¬  ¥««¬ ­ -®°¤ )
³±²¼ G = (V; E ) | ¢§¢¥¸¥­­»© ®°¨¥­²¨°®¢ ­­»© £° ´ ± ¢¥±®¢®© ´³­ª¶¨¥© w ¨ ¨±µ®¤­®© ¢¥°¸¨­®© s. ±«¨ ¯°®¶¥¤³°  Bellman-

«£®°¨²¬ ¥««¬ ­ -®°¤ 

515

Ford, ¯°¨¬¥­¥­­ ¿ ª ½²®¬³ £° ´³, ¢®§¢° ¹ ¥² §­ ·¥­¨¥ true, ²®

¢ °¥§³«¼² ²¥ ¥¥ ° ¡®²» ¤«¿ ¢±¥µ v 2 V ¡³¤³² ¢»¯®«­¥­» ° ¢¥­±²¢  d[v ] =  (s; v ) ¨ ¯®¤£° ´ ¯°¥¤¸¥±²¢¥­­¨ª®¢ G ¡³¤¥² ¤¥°¥¢®¬
ª° ²· ©¸¨µ ¯³²¥© ± ª®°­¥¬ s. ±«¨ ¦¥ ¯°®¶¥¤³°  Bellman-Ford
¢®§¢° ¹ ¥² §­ ·¥­¨¥ false, ²® ¢ £° ´¥ ¥±²¼ ¶¨ª« ®²°¨¶ ²¥«¼­®£®
¢¥± , ¤®±²¨¦¨¬»© ¨§ ¢¥°¸¨­» s.
®ª § ²¥«¼±²¢® ±«¨ ¶¨ª«  ®²°¨¶ ²¥«¼­®£® ¢¥± , ¤®±²¨¦¨¬®£® ¨§ ¢¥°¸¨­» s, ¢ £° ´¥ ­¥², ²® ¢ °¥§³«¼² ²¥ ° ¡®²» ¯°®¶¥¤³°» Bellman-Ford ¡³¤¥¬ ¨¬¥²¼ d[v ] =  (s; v ) ¤«¿ ¢±¥µ v 2 V
(«¥¬¬  25.12 ¨ ±«¥¤±²¢¨¥ 25.13); ±«¥¤®¢ ²¥«¼­®, £° ´ G ¡³¤¥² ¤¥°¥¢®¬ ª° ²· ©¸¨µ ¯³²¥© ± ¢¥°¸¨­®© s («¥¬¬  25.9). ®«¼ ±ª®°®
d[v] = (s; v) ¤«¿ ¢±¥µ v 2 V , ¨§ «¥¬¬» 25.3 ±«¥¤³¥², ·²® ¤«¿ ¢±¿ª®£® °¥¡°  (u; v ) ¢»¯®«­¥­® ­¥° ¢¥­±²¢® d[v ] 6 d[u] + w(u; v ). ­ ·¨²,
­¨ ®¤­® ¨§ ³±«®¢¨© ¢ ±²°®ª¥ 6  «£®°¨²¬  ¢»¯®«­¥­® ­¥ ¡³¤¥², ¨
 «£®°¨²¬ ¢®§¢° ²¨² §­ ·¥­¨¥ true.
³±²¼ ²¥¯¥°¼ ¢ £° ´¥ ¥±²¼ ¶¨ª« ®²°¨¶ ²¥«¼­®£® ¢¥± 
hv0; v1; : : :; vk = v0i, ¤®±²¨¦¨¬»© ¨§ ¨±µ®¤­®© ¢¥°¸¨­»; ­ ¬ ­ ¤®
¯®ª § ²¼, ·²®  «£®°¨²¬ ¢®§¢° ²¨² §­ ·¥­¨¥ false.  ± ¬®¬ ¤¥«¥,
¥±«¨ d[vi] 6 d[vi;1 ] + w(vi;1 ; vi) ¤«¿P¢±¥µ i = 1; 2; : : :; k, ²®, ±ª« ¤»¢ ¿ ½²¨
k ­¥° ¢¥­±²¢ ¨ ±®ª° ¹ ¿ d[vi] ¢ ®¡¥¨µ · ±²¿µ, ¯®«³·¨¬
P
0 6 ki=1 w(vi;1 ; vi), ·²® ¯°®²¨¢®°¥·¨² ¢»¡®°³ ¶¨ª« . ­ ·¨²,
¤«¿ ­¥ª®²®°®£® i ¨¬¥¥¬ d[vi ] > d[vi;1] + w(vi;1 ; vi), ¨  «£®°¨²¬
¢®§¢° ¹ ¥² §­ ·¥­¨¥ false.
¯° ¦­¥­¨¿
25.3-1 °¨¬¥­¨²¥  «£®°¨²¬ ¥««¬ ­ -®°¤  ª ®°¨¥­²¨°®¢ ­­®¬³ £° ´³ °¨±. 25.7, ¢»¡° ¢ y ¢ ª ·¥±²¢¥ ¨±µ®¤­®© ¢¥°¸¨­». ¥¡° 
®¡° ¡ ²»¢ ©²¥ ¢ «¥ª±¨ª®£° ´¨·¥±ª®¬ ¯®°¿¤ª¥; ¨§®¡° §¨²¥ ½² ¯»
¢»¯®«­¥­¨¿  «£®°¨²¬  ª ª ­  °¨±. 25.7.  ¬¥­¨²¥ ¢¥± °¥¡°  (y; v )
­  4 ¨ ¯°®¤¥« ©²¥ ²® ¦¥ ± ¬®¥, ¢»¡° ¢ ¨±µ®¤­®© ¢¥°¸¨­®© z .
25.3-2 ®ª ¦¨²¥ ±«¥¤±²¢¨¥ 25.13.
25-3.3 ³±²¼ ¢® ¢§¢¥¸¥­­®¬ ®°¨¥­²¨°®¢ ­­®¬ £° ´¥ ­¥² ¶¨ª«®¢
®²°¨¶ ²¥«¼­®£® ¢¥± . ¯°¥¤¥«¨¬ ·¨±«® m ±«¥¤³¾¹¨¬ ®¡° §®¬: ¤«¿
ª ¦¤®© ¯ °» ¢¥°¸¨­ u; v 2 V , ¤«¿ ª®²®°®© ±³¹¥±²¢³¥² ¯³²¼ ¨§ u
¢ v , ­ ©¤¥¬ ¬¨­¨¬ «¼­®¥ ª®«¨·¥±²¢® °¥¡¥° ¢ ¯³²¿µ ¬¨­¨¬ «¼­®£® ¢¥± , ¨¤³¹¨µ ¨§ u ¢ v ; § ²¥¬ ¢®§¼¬¥¬ ¬ ª±¨¬³¬ ½²¨µ ·¨±¥« ¯®
¢±¥¬ ² ª¨¬ ¯ ° ¬ | ½²® ¨ ¥±²¼ m. ®ª ¦¨²¥, ·²® ¢  «£®°¨²¬¥
¥««¬ ­ -®°¤  ¤®±² ²®·­® ¢»¯®«­¿²¼ ¶¨ª« ¢ ±²°®ª µ 2{4 m ° §.
25.3-4 ®¤¨´¨¶¨°³©²¥  «£®°¨²¬ ¥««¬ ­ -®°¤  ² ª¨¬ ®¡° §®¬, ·²®¡» ¨ ¤«¿ ¢¥°¸¨­ v , ³ ª®²®°»µ  (s; v ) = ;1 (ª ª ¬» ¯®¬­¨¬, ² ª®¥ ¡»¢ ¥² ²®£¤  ¨ ²®«¼ª® ²®£¤ , ª®£¤  ±³¹¥±²¢³¥² ¯³²¼
¨§ s ¢ v , § ¤¥¢ ¾¹¨© ¶¨ª« ®²°¨¶ ²¥«¼­®£® ¢¥± ), ¯®±«¥ ¨±¯®«­¥­¨¿
 «£®°¨²¬  ¡»«® ³±² ­®¢«¥­® ¯° ¢¨«¼­®¥ §­ ·¥­¨¥ d[v ] =  (s; v ) =
;1.
25.3-5 ³±²¼ G = (V; E ) | ¢§¢¥¸¥­­»© ®°¨¥­²¨°®¢ ­­»© £° ´.
 §° ¡®² ©²¥  «£®°¨²¬, ° ¡®² ¾¹¨© §  ¢°¥¬¿ O(V E ) ¨ ­ µ®¤¿¹¨©
¤«¿ ª ¦¤®© ¢¥°¸¨­» v 2 V §­ ·¥­¨¥   (v ) = minu2V f (u; v )g. (

516

« ¢  25 ° ²· ©¸¨¥ ¯³²¨ ¨§ ®¤­®© ¢¥°¸¨­»

£° ´¥ ¬®£³² ¡»²¼ °¥¡°  ± ®²°¨¶ ²¥«¼­»¬ ¢¥±®¬.)
25-3.6 ³±²¼ ¢§¢¥¸¥­­»© ®°¨¥­²¨°®¢ ­­»© £° ´ G = (V; E ) ¨¬¥¥² ¶¨ª« ®²°¨¶ ²¥«¼­®£® ¢¥± .  §° ¡®² ©²¥  «£®°¨²¬, ¯¥· ² ¾¹¨© ¢¥°¸¨­» ² ª®£® ¶¨ª«  (µ®²¿ ¡» ®¤­®£®).

25.3. ° ²· ©¸¨¥ ¯³²¨ ¢  ¶¨ª«¨·¥±ª®¬ ®°¨¥­²¨°®¢ ­­®¬ £° ´¥
  ¶¨ª«¨·¥±ª®¬ ®°¨¥­²¨°®¢ ­­®¬ £° ´¥ G = (V; E ) ª° ²· ©¸¨¥ ¯³²¨ ¨§ ®¤­®© ¢¥°¸¨­» ¬®¦­® ­ ©²¨ §  ¢°¥¬¿ O(V + E ), ¥±«¨
¯°®¢®¤¨²¼ °¥« ª± ¶¨¾ °¥¡¥° ¢ ¯®°¿¤ª¥, § ¤ ­­®¬ ²®¯®«®£¨·¥±ª¨¬
³¯®°¿¤®·¥­¨¥¬ ¢¥°¸¨­.  ¬¥²¨¬, ·²® ¢  ¶¨ª«¨·¥±ª®¬ ®°¨¥­²¨°®¢ ­­®¬ £° ´¥ ª° ²· ©¸¨¥ ¯³²¨ ¢±¥£¤  ®¯°¥¤¥«¥­», ¯®±ª®«¼ª³ ¶¨ª«®¢ ®²°¨¶ ²¥«¼­®£® ¢¥±  (¨ ¢®®¡¹¥ ¶¨ª«®¢) ­¥².
 ° §¤¥«¥ 23.4 ¬» ° ±±¬ ²°¨¢ «¨  «£®°¨²¬ ²®¯®«®£¨·¥±ª®© ±®°²¨°®¢ª¨ ¢¥°¸¨­  ¶¨ª«¨·¥±ª®£® £° ´ . ­ ° ±¯®« £ ¥² ¨µ ¢ ² ª®¬ ¯®°¿¤ª¥, ·²®¡» ¢±¥ °¥¡°  £° ´  ¢¥«¨ ®² À¬¥­¼¸¨µÁ ¢¥°¸¨­ ª
À¡®«¼¸¨¬Á (¢ ±¬»±«¥ ½²®£® ¯®°¿¤ª ). ®±«¥ ½²®£® ¬» ¯°®±¬ ²°¨¢ ¥¬ ¢¥°¸¨­» ¢ ½²®¬ ¯®°¿¤ª¥ ¨ ¤«¿ ª ¦¤®© ¢¥°¸¨­» ¯®¤¢¥°£ ¥¬
°¥« ª± ¶¨¨ ¢±¥ ¢»µ®¤¿¹¨¥ ¨§ ­¥¥ °¥¡° .
Dag-Shortest-Paths(G,w,s)
1 ²®¯®«®£¨·¥±ª¨ ®²±®°²¨°®¢ ²¼ ¢¥°¸¨­» G
2 Initialize-Single-Source(G,s)
3 for (¤«¿) ¢±¥µ ¢¥°¸¨­ u (¢ ­ ©¤¥­­®¬ ¯®°¿¤ª¥)
4
do for (¤«¿) ¢±¥µ ¢¥°¸¨­ v \in Adj[u]
5
do Relax(u,v,w)

°¨¬¥° ° ¡®²» ½²®£®  «£®°¨²¬  ¯°¨¢¥¤¥­ ­  °¨±. 25.8.
¶¥­¨¬ ¢°¥¬¿ ° ¡®²»  «£®°¨²¬  Dag-Shortest-Paths.  ª ¬»
¢¨¤¥«¨ ¢ ° §¤. 23.4, ±²®¨¬®±²¼ ²®¯®«®£¨·¥±ª®© ±®°²¨°®¢ª¨ (±²°®ª  1) ¥±²¼ (V + E ),   ±²®¨¬®±²¼ ¨­¨¶¨ «¨§ ¶¨¨ ¢ ±²°®ª¥ 2 ¥±²¼
O(V ).  ¶¨ª«¥ ¢ ±²°®ª µ 3{5 ª ¦¤®¥ °¥¡°® ®¡° ¡ ²»¢ ¥²±¿, ª ª ¨
¢  «£®°¨²¬¥ ¥©ª±²°», °®¢­® ®¤¨­ ° §, ­®, ¢ ®²«¨·¨¥ ®²  «£®°¨²¬  ¥©ª±²°», ±²®¨¬®±²¼ ² ª®© ®¡° ¡®²ª¨ ¥±²¼ O(1). ² «® ¡»²¼,
­ ¸  «£®°¨²¬ ¢»¯®«­¿¥²±¿ §  ¢°¥¬¿ (V + E ), ¯°®¯®°¶¨®­ «¼­®¥
¨±. 25.8 (¢ ®°¨£¨­ «¥ ¢ ¯®¤¯¨±¨ ¡»«  ®¯¥· ²ª : v , ²®£¤  ª ª ­ ¤® u).
25.8. «£®°¨²¬ ¤«¿ ¯®¨±ª  ª° ²· ©¸¨µ ¯³²¥© ¢  ¶¨ª«¨·¥±ª®¬ ®°¨¥­²¨°®¢ ­­®¬ £° ´¥. ¥°¸¨­» ²®¯®«®£¨·¥±ª¨ ®²±®°²¨°®¢ ­» (­  °¨±³­ª¥ ±«¥¢ 
­ ¯° ¢®). ±µ®¤­ ¿ ¢¥°¸¨­  | s.  ¢¥°¸¨­ µ § ¯¨± ­» §­ ·¥­¨¿ ´³­ª¶¨¨ d;
¤«¿ ±¥°»µ °¥¡¥° (u; v) ¨¬¥¥¬ [v] = u. ( ) ¥°¥¤ ¯¥°¢®© ¨²¥° ¶¨¥© ¶¨ª«  ¢
±²°®ª µ 3{5. (¡{¦) ®±«¥¤®¢ ²¥«¼­»¥ ±®±²®¿­¨¿ ¯®±«¥ ª ¦¤®© ¨²¥° ¶¨¨ ¶¨ª« 
¢ ±²°®ª µ 3{5.   ª ¦¤®¬ ¨§ ½²¨µ °¨±³­ª®¢ ¯°¨¡ ¢«¿¥²±¿ ¯® ®¤­®© ·¥°­®© ¢¥°¸¨­¥ (ª®²®° ¿ ¡»«  ¢¥°¸¨­®© u ¢® ¢°¥¬¿ ±®®²¢¥²±²¢³¾¹¥© ¨²¥° ¶¨¨ ¶¨ª« ).
­ ·¥­¨¿ d ­  °¨±³­ª¥ (¦) | ®ª®­· ²¥«¼­»¥.
¨±. 25.8

° ²· ©¸¨¥ ¯³²¨ ¢  ¶¨ª«¨·¥±ª®¬ ®°¨¥­²¨°®¢ ­­®¬ £° ´¥

517

®¡º¥¬³ ¯ ¬¿²¨, ­¥®¡µ®¤¨¬®¬³ ­  ¯°¥¤±² ¢«¥­¨¥ £° ´  ± ¯®¬®¹¼¾
±¯¨±ª®¢ ±¬¥¦­»µ ¢¥°¸¨­.
®ª ¦¥¬, ·²®  «£®°¨²¬ Dag-Shortest-Paths ¯° ¢¨«¥­.
¥®°¥¬  25.15
³±²¼ ¢§¢¥¸¥­­»© ®°¨¥­²¨°®¢ ­­»© £° ´ G = (V; E ) ± ¨±µ®¤­®© ¢¥°¸¨­®© s ­¥ ±®¤¥°¦¨² ¶¨ª«®¢. ®£¤  ¯® ®ª®­· ­¨¨ ° ¡®²»
¯°®¶¥¤³°» Dag-Shortest-Paths ¤«¿ ¢±¥µ v 2 V ¡³¤³² ¢»¯®«­¥­» ° ¢¥­±²¢  d[v ] =  (s; v ),   ¯®¤£° ´ ¯°¥¤¸¥±²¢¥­­¨ª®¢ G ¡³¤¥²
¤¥°¥¢®¬ ª° ²· ©¸¨µ ¯³²¥©.
®ª § ²¥«¼±²¢®
®£« ±­® «¥¬¬¥ 25.9, ¤®±² ²®·­® ¤®ª § ²¼ ° ¢¥­±²¢  d[v ] =
(s; v ). ±«¨ ¢¥°¸¨­  v ­¥¤®±²¨¦¨¬  ¨§ s, ²® d[v ] =  (s; v ) = 1
¯® ±«¥¤±²¢¨¾ 25.6. ³±²¼ ²¥¯¥°¼ ¢¥°¸¨­  v ¤®±²¨¦¨¬  ¨§ s ¨
p = hs = v0; v1; : : :; vk = vi | ª° ²· ©¸¨© ¯³²¼. ®±«¥ ²®¯®«®£¨·¥±ª®© ±®°²¨°®¢ª¨ ¢¥°¸¨­» ½²®£® ¯³²¨ ° ±¯®«®¦¥­» ª ª ° § ¢ ³ª § ­­®¬ ¯®°¿¤ª¥, ² ª ·²® °¥¡°®, (v0; v1) ¯®¤¢¥°£ «®±¼ °¥« ª± ¶¨¨ ¤®
°¥¡°  (v1; v2), ª®²®°®¥ ¯°¥¤¸¥±²¢®¢ «® °¥¡°³ (v2; v3) ¨ ².¤. ­¤³ª¶¨¿ ¯® i ± ¨±¯®«¼§®¢ ­¨¥¬ «¥¬¬» 25.7 (ª ª ¢ ¤®ª § ²¥«¼±²¢¥ ª®°°¥ª²­®±²¨  «£®°¨²¬  ¥««¬ ­ -®°¤ ) ¯®ª §»¢ ¥² ²¥¯¥°¼, ·²®
d[vi] =  (s; vi) ¤«¿ ¢±¥µ i, ·²® ¨ ²°¥¡®¢ «®±¼ ¤®ª § ²¼.
­²¥°¥±­®¥ ¯°¨«®¦¥­¨¥ ®¯¨± ­­®£®  «£®°¨²¬  | ­ µ®¦¤¥­¨¥
ª°¨²¨·¥±ª¨µ ¯³²¥© ¢ ±¬»±«¥ ² ª ­ §»¢ ¥¬®© À²¥µ­®«®£¨¨ PERTÁ
(program evaluation and review technique).  ½²®¬ ¯°¨«®¦¥­¨¨ ª ¦¤®¥ °¥¡°®  ¶¨ª«¨·¥±ª®£® ®°¨¥­²¨°®¢ ­­®£® £° ´  ®¡®§­ · ¥²
ª ª®¥-²® ¤¥«®,   ¢¥± °¥¡°  ¥±²¼ ¢°¥¬¿, ­¥®¡µ®¤¨¬®¥ ­  ¥£® ¢»¯®«­¥­¨¥. ±«¨ ¨¬¥¾²±¿ °¥¡°  (u; v ) ¨ (v; x), ²® ° ¡®² , ±®®²¢¥²±²¢³¾¹ ¿
°¥¡°³ (u; v ), ¤®«¦­  ¡»²¼ ¢»¯®«­¥­  ¤® ­ · «  ° ¡®²», ±®®²¢¥²±²¢³¾¹¥© °¥¡°³ (v; x). °¨²¨·¥±ª¨© ¯³²¼ (critical path) | ½²®
¤«¨­­¥©¸¨© ¯³²¼ ¢ £° ´¥; ¥£® ¢¥± ° ¢¥­ ¢°¥¬¥­¨, ª®²®°®¥ ¡³¤¥²
§ ²° ·¥­® ­  ¢»¯®«­¥­¨¥ ¢±¥µ ° ¡®², ¥±«¨ ¬» ¯® ¬ ª±¨¬³¬³ ¨±¯®«¼§³¥¬ ¢®§¬®¦­®±²¼ ¢»¯®«­¿²¼ ­¥ª®²®°»¥ ° ¡®²» ¯ ° ««¥«¼­®.
²®¡» ­ ©²¨ ª°¨²¨·¥±ª¨© ¯³²¼, ¬®¦­® ¯®¬¥­¿²¼ §­ ª ³ ¢±¥µ ¢¥±®¢
­  ¯°®²¨¢®¯®«®¦­»© ¨ § ¯³±²¨²¼  «£®°¨²¬ Dag-Shortest-Paths.
¯° ¦­¥­¨¿
25-4.1 °¨¬¥­¨²¥  «£®°¨²¬ Dag-Shortest-Paths ª £° ´³
°¨±. 25.8, ¢»¡° ¢ ¢¥°¸¨­³ r ¢ ª ·¥±²¢¥ ¨±µ®¤­®©.
25-4.2 ®ª ¦¨²¥, ·²®  «£®°¨²¬ Dag-Shortest-Paths ®±² ­¥²±¿
¯° ¢¨«¼­»¬, ¥±«¨ ®¡° ¡ ²»¢ ²¼ ²®«¼ª® ¯¥°¢»¥ jV j ; 1 ¢¥°¸¨­.
25-4.3  § ¤ ·¥ ® ¯« ­¨°®¢ ­¨¨ ° ¡®² ¯® ²¥µ­®«®£¨¨ PERT ¬®¦­® °¨±®¢ ²¼ £° ´ ¨­ ·¥, ±·¨² ¿, ·²® ° ¡®²» ±®®²¢¥²±²¢³¾² ­¥
°¥¡° ¬,   ¢¥°¸¨­ ¬ £° ´ . °¨ ½²®¬ ª ¦¤®© ¢¥°¸¨­¥ ¯°¨±¢®¥­
¢¥± (²°¥¡³¥¬®¥ ¢°¥¬¿),   ±²°¥«ª¨ ³ª §»¢ ¾² ®¯°¥¤¥«¿«¨ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ° ¡®² (°¥¡°® (u; v ) ²°¥¡³¥² § ¢¥°¸¨²¼ ° ¡®²³ u ¤® ­ · «  ° ¡®²» v ). ®¤¨´¨¶¨°³©²¥  «£®°¨²¬ Dag-Shortest-Paths
² ª, ·²®¡» ®­ §  «¨­¥©­®¥ ¢°¥¬¿ ­ µ®¤¨« ¢  ¶¨ª«¨·¥±ª®¬ ®°¨¥­²¨°®¢ ­­®¬ £° ´¥ ¯³²¼ ± ¬ ª±¨¬ «¼­®© ±³¬¬®© ¢¥±®¢ ¢¥°¸¨­.

518

« ¢  25 ° ²· ©¸¨¥ ¯³²¨ ¨§ ®¤­®© ¢¥°¸¨­»

25-4.4  §° ¡®² ©²¥ ½´´¥ª²¨¢­»©  «£®°¨²¬, ¯®¤±·¨²»¢ ¾¹¨©
®¡¹¥¥ ·¨±«® ¯³²¥© ¢  ¶¨ª«¨·¥±ª®¬ ®°¨¥­²¨°®¢ ­­®¬ £° ´¥, ¨ ®¶¥­¨²¥ ¢°¥¬¿ ¥£® ° ¡®²».

25.4. £° ­¨·¥­¨¿ ­  ° §­®±²¨ ¨ ª° ²· ©¸¨¥ ¯³²¨
¡¹ ¿ § ¤ ·  «¨­¥©­®£® ¯°®£° ¬¬¨°®¢ ­¨¿ ±®±²®¨² ¢ ®²»±ª ­¨¨ ½ª±²°¥¬³¬  «¨­¥©­®© ´³­ª¶¨¨ ­  ¬­®¦¥±²¢¥, § ¤ ­­®¬ ±¨±²¥¬®© «¨­¥©­»µ ­¥° ¢¥­±²¢.  ½²®¬ ° §¤¥«¥ ¬» ° ±±¬®²°¨¬ ±¯¥¶¨ «¼­»© ±«³· © § ¤ ·¨ «¨­¥©­®£® ¯°®£° ¬¬¨°®¢ ­¨¿, ±¢®¤¿¹¨©±¿ ª
­ µ®¦¤¥­¨¾ ª° ²· ©¸¨µ ¯³²¥© ¨§ ®¤­®© ¢¥°¸¨­».  ª¨¬ ®¡° §®¬,
° ±±¬ ²°¨¢ ¥¬»© · ±²­»© ±«³· © § ¤ ·¨ «¨­¥©­®£® ¯°®£° ¬¬¨°®¢ ­¨¿ ¬®¦¥² ¡»²¼ °¥¸¥­ ± ¯®¬®¹¼¾  «£®°¨²¬  ¥««¬ ­ -®°¤ .
¨­¥©­®¥ ¯°®£° ¬¬¨°®¢ ­¨¥
¡¹ ¿ § ¤ ·  «¨­¥©­®£® ¯°®£° ¬¬¨°®¢ ­¨¿ (linear-programming
problem) ±®±²®¨² ¢ ±«¥¤³¾¹¥¬.  ­» m  n-¬ ²°¨¶  A, m-¢¥ª²®°
b ¨ n-¢¥ª²®° c. °¥¡³¥²±¿ ­ ©²¨ n-¢¥ª²®° x, ¿¢«¿¾¹¨©±¿
²®·ª®©
P
¬ ª±¨¬³¬  ¶¥«¥¢®© ´³­ª¶¨¨ (objective function) ni=1 ci xi ­  ¬­®¦¥±²¢¥, § ¤ ­­®¬ m ­¥° ¢¥­±²¢ ¬¨, ª®²®°»¥ ¬» ¬®¦¥¬ § ¯¨± ²¼
ª ª Ax 6 b.
 ¤ ·¨ «¨­¥©­®£® ¯°®£° ¬¬¨°®¢ ­¨¿ · ±²® ¢®§­¨ª ¾² ¢ ¯°¨«®¦¥­¨¿µ, ¯®½²®¬³ ¨¬¨ ¬­®£® § ­¨¬ «¨±¼.   ¯° ª²¨ª¥ § ¤ ·¨ «¨­¥©­®£® ¯°®£° ¬¬¨°®¢ ­¨¿ ¡»±²°® °¥¸ ¾²±¿ ± ¯®¬®¹¼¾
±¨¬¯«¥ª±-¬¥²®¤  (simplex algorithm). ¨¬¯«¥ª±-¬¥²®¤ ®±­®¢ ­ ­ 
¯°®±¬®²°¥ ¢¥°¸¨­ ¬­®£®£° ­­¨ª , § ¤ ¢ ¥¬®£® ­¥° ¢¥­±²¢ ¬¨®£° ­¨·¥­¨¿¬¨ Ax 6 b, ¯°¨ ª®²®°®¬ §­ ·¥­¨¥ ¶¥«¥¢®© ´³­ª¶¨¨
³¢¥«¨·¨¢ ¥²±¿. (¨¬¯«¥ª±-¬¥²®¤ ¯®¤°®¡­® ®¯¨± ­ ¢ ª­¨£¥  ­¶¨£  [53].)
®¦­®, ®¤­ ª®, ¯®±²°®¨²¼ ¯®±«¥¤®¢ ²¥«¼­®±²¼ § ¤ · «¨­¥©­®£®
¯°®£° ¬¬¨°®¢ ­¨¿, ¤«¿ ª®²®°®© ±¨¬¯«¥ª±-¬¥²®¤ ¡³¤¥² ²°¥¡®¢ ²¼
½ª±¯®­¥­¶¨ «¼­®£® (®² ° §¬¥°  ¢µ®¤ ) ¢°¥¬¥­¨. ¥²®¤ ½««¨¯±®¨¤®¢ (ellipsoid algorithm) °¥¸ ¥² «¾¡³¾ § ¤ ·³ «¨­¥©­®£® ¯°®£° ¬¬¨°®¢ ­¨¿ §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿, ­® ­  ¯° ª²¨ª¥ ° ¡®² ¥² ¬¥¤«¥­­®. ³¹¥±²¢³¥² ² ª¦¥ ¯®«¨­®¬¨ «¼­»©  «£®°¨²¬  °¬ °ª ° 
(Karmarkar's algoritm), ±° ¢­¨¬»© ¯® ¯° ª²¨·¥±ª®© ½´´¥ª²¨¢­®±²¨ ± ±¨¬¯«¥ª±-¬¥²®¤®¬.
» ­¥ ¡³¤¥¬ § ­¨¬ ²¼±¿  «£®°¨²¬ ¬¨ ¤«¿ °¥¸¥­¨¿ ®¡¹¨µ § ¤ ·
«¨­¥©­®£® ¯°®£° ¬¬¨°®¢ ­¨¿ (·²® ²°¥¡®¢ «® ¡» ¡®«¼¸¥£® §­ ª®¬±²¢  ± «¨­¥©­®©  «£¥¡°®©, ·¥¬ ®±² «¼­®© ¬ ²¥°¨ « ª­¨£¨),   ±¤¥« ¥¬ ²®«¼ª® ¤¢  § ¬¥· ­¨¿. ®-¯¥°¢»µ, ¥±«¨ § ¤ ·³ ¬®¦­® ±¢¥±²¨ ª
§ ¤ ·¥ «¨­¥©­®£® ¯°®£° ¬¬¨°®¢ ­¨¿ ± ¨±µ®¤­»¬¨ ¤ ­­»¬¨ ¯®«¨­®¬¨ «¼­®£® ° §¬¥° , ²® ½²  § ¤ ·  § ¢¥¤®¬® ¬®¦¥² ¡»²¼ °¥¸¥­ 
± ¯®¬®¹¼¾ ¯®«¨­®¬¨ «¼­®£®  «£®°¨²¬ . ®-¢²®°»µ, ¤«¿ ¬­®£¨µ
±¯¥¶¨ «¼­»µ § ¤ · «¨­¥©­®£® ¯°®£° ¬¬¨°®¢ ­¨¿ ±³¹¥±²¢³¾²  «-

£° ­¨·¥­¨¿ ­  ° §­®±²¨ ¨ ª° ²· ©¸¨¥ ¯³²¨

519

£®°¨²¬», ¯°¨¢®¤¿¹¨¥ ª ¶¥«¨ ¡»±²°¥¥, ·¥¬  «£®°¨²¬» ¤«¿ ®¡¹¥£®
±«³· ¿. ¤¨­ ¯°¨¬¥° ² ª®£® °®¤  ¤®±² ¢«¿¥² § ¤ · , ° §¡¨° ¥¬ ¿
¢ ½²®¬ ° §¤¥«¥; ¤°³£¨¥ ¯°¨¬¥°» | ±¢®¤¿¹¨¥±¿ ª § ¤ · ¬ «¨­¥©­®£® ¯°®£° ¬¬¨°®¢ ­¨¿ § ¤ ·  ® ª° ²· ©¸¥¬ ¯³²¨ ¬¥¦¤³ ¤ ­­®©
¯ °®© ¢¥°¸¨­ (³¯° ¦­¥­¨¥ 25.5-4) ¨ § ¤ ·  ® ¬ ª±¨¬ «¼­®¬ ¯®²®ª¥
(³¯° ¦­¥­¨¥ 27.1-8).
 ­¥ª®²®°»µ ±«³· ¿µ ¶¥«¥¢ ¿ ´³­ª¶¨¿ ­ ± ­¥ ¨­²¥°¥±³¥²,   ²°¥¡³¥²±¿ ­ ©²¨ µ®²¿ ¡» ®¤­® ¤®¯³±²¨¬®¥ °¥¸¥­¨¥ (feasible solution),
²® ¥±²¼ °¥¸¥­¨¥ ±¨±²¥¬» ­¥° ¢¥­±²¢ Ax 6 b (¨«¨ ¤®ª § ²¼, ·²®
² ª®¢»µ ­¥²). » § ©¬¥¬±¿ ¨¬¥­­® § ¤ ·¥© ² ª®£® ²¨¯ .
¨±²¥¬» ®£° ­¨·¥­¨© ­  ° §­®±²¨
¨±²¥¬  ®£° ­¨·¥­¨© ­  ° §­®±²¨ (system of dierence constraints) | ½²® ±¨±²¥¬  «¨­¥©­»µ ­¥° ¢¥­±²¢ Ax 6 b, ¤«¿ ª®²®°®©
¢ ª ¦¤®© ±²°®ª¥ ¬ ²°¨¶» A ¯°¨±³²±²¢³¾² °®¢­® ¤¢  ­¥­³«¥¢»µ
½«¥¬¥­² , ®¤¨­ ¨§ ª®²®°»µ ° ¢¥­ 1,   ¤°³£®© ;1. ­»¬¨ ±«®¢ ¬¨,
¢±¥ ­¥° ¢¥­±²¢  ¨¬¥¾² ¢¨¤

xi ; xj 6 bk ;
£¤¥ 1 6 i; j 6 n ¨ 1 6 k 6 m.

 ¯°¨¬¥°, § ¤ ·  ­ µ®¦¤¥­¨¿ 5-¢¥ª²®°  x = (xi ), ³¤®¢«¥²¢®°¿¾¹¥£® ³±«®¢¨¾
0
0 1
1 ;1 0 0 0 1
0
0
1
0 0 0 ;1C
B 1
B;1C
B
C x1
B C
1
0
0
;
1
B 0
CB C B 1 C
x
B
2C B
1 0 0C
5C
B;1 0
CB
C
C6B
x
;
B
CB
B
3
C B 4 C
0
1
0
B;1 0
CB
C
B
C @x4 A B C
0 ;1 1 0 C x
B 0
B;1C
@
A
@ A
5
0 0 ;1 0 1
;3
0 0 0 ;1 1
;3
° ¢­®±¨«¼­  ±¨±²¥¬¥ «¨­¥©­»µ ­¥° ¢¥­±²¢
x1 ; x2 6 0;
x1 ; x5 6 ;1;
x2 ; x5 6 1;
x3 ; x1 6 5;
(25:4)
x4 ; x1 6 4;
x4 ; x3 6 ;1;
x5 ; x3 6 ;3;
x5 ; x4 6 ;3:
¤­® ¨§ °¥¸¥­¨© ½²®© ±¨±²¥¬» ¥±²¼ x = (;5; ;3; 0; ;1; ;4). ±«¨
ª® ¢±¥¬ ª®¬¯®­¥­² ¬ ¢¥ª²®°  x ¯°¨¡ ¢¨²¼ ®¤­® ¨ ²® ¦¥ ·¨±«®,
¯®«³·¨²±¿ ¤°³£®¥ °¥¸¥­¨¥:

520

« ¢  25 ° ²· ©¸¨¥ ¯³²¨ ¨§ ®¤­®© ¢¥°¸¨­»

° ´ ®£° ­¨·¥­¨©, ±®®²¢¥²±²¢³¾¹¨© ±¨±²¥¬¥ (25.4).  ª ¦¤®© ¢¥°¸¨­¥ vi ­ ¯¨± ­® ·¨±«® (v0 ; vi ). ¥ª²®° x = (;5; ;3; 0; ;1; ;4) ¿¢«¿¥²±¿ ®¤­¨¬
¨§ °¥¸¥­¨© ±¨±²¥¬» (25.4).
¨±. 25.9

¥¬¬  25.16
±«¨ x = (x1; : : :; xn) | °¥¸¥­¨¥ ±¨±²¥¬» ®£° ­¨·¥­¨© ­  ° §­®±²¨ ¨ d | ª®­±² ­² , ²® x0 = (x1 + d; : : :; xn + d) | °¥¸¥­¨¥ ²®©
¦¥ ±¨±²¥¬».
¨±²¥¬» ®£° ­¨·¥­¨© ­  ° §­®±²¨ ¢®§­¨ª ¾² ¢® ¬­®£¨µ ¯°¨«®¦¥­¨¿µ.  ¯°¨¬¥°, xi ¬®£³² ¡»²¼ ±°®ª ¬¨ ­ · «  ° §«¨·­»µ ° ¡®²
¯°¨ ±²°®¨²¥«¼±²¢¥ ¤®¬ . ±«¨ x1 | ±°®ª ­ · «  °»²¼¿ ª®²«®¢ ­ 
¯®¤ ´³­¤ ¬¥­²,   x2 | ±°®ª ­ · «  § «¨¢ª¨ ´³­¤ ¬¥­² , ¨ ¥±«¨
°»²¼¥ ª®²«®¢ ­  § ­¨¬ ¥² 3 ¤­¿, ²® x1 ; x2 6 ;3.
° ´» ®£° ­¨·¥­¨©
±«¨ ±¨±²¥¬  ®£° ­¨·¥­¨© ­  ° §­®±²¨ ¯°¥¤±² ¢«¥­  ¢ ¢¨¤¥
Ax 6 b, £¤¥ A | m  n-¬ ²°¨¶ , ³¤®¡­® ° ±±¬®²°¥²¼ ®°¨¥­²¨°®¢ ­­»© £° ´, ¤«¿ ª®²®°®£® A ¡³¤¥² ¬ ²°¨¶¥© ¨­¶¨¤¥­²­®±²¨ (±¬. ³¯° ¦­¥­¨¥ 23.1-7). ®·­¥¥ £®¢®°¿, ¬» ±¤¥« ¥¬ ­¥ ±®¢±¥¬ ½²®,   ±¢¿¦¥¬ ± ±¨±²¥¬®© ¢§¢¥¸¥­­»© ®°¨¥­²¨°®¢ ­­»© £° ´
G = (V; E ), ¢ ª®²®°®¬ V = fv0; v1; : : :; vn g (¯® ®¤­®© ¢¥°¸¨­¥
­  ª ¦¤®¥ ­¥¨§¢¥±²­®¥ ¯«¾± ¢¥°¸¨­  v0),   ª ¦¤®¬³ ­¥° ¢¥­±²¢³
xj ; xi 6 bk ±®®²¢¥²±²¢³¥² °¥¡°® (vi; vj ) ± ¢¥±®¬ bk (­¥±ª®«¼ª® ­¥° ¢¥­±²¢ ± ®¤¨­ ª®¢®© «¥¢®© · ±²¼¾ ¬®¦­® § ¬¥­¨²¼ ®¤­¨¬, ¢§¿¢
¬¨­¨¬³¬ ¨µ ¯° ¢»µ · ±²¥©). °®¬¥ ²®£®, ¢ £° ´¥ ¨¬¥¾²±¿ n °¥¡¥°
(v0; v1); (v0; v2); : : :; (v0; vn) (ª ¦¤®¥ | ¢¥±  0).   °¨±. 25.9 ¨§®¡° ¦¥­ £° ´, ±®®²¢¥²±²¢³¾¹¨© ±¨±²¥¬¥ (25.4).
«¥¤³¾¹ ¿ ²¥®°¥¬  ¯®ª §»¢ ¥², ·²® °¥¸¥­¨¿ ±¨±²¥¬ ° §­®±²­»µ ®£° ­¨·¥­¨© ¬®¦­® ­ µ®¤¨²¼ ± ¯®¬®¹¼¾  «£®°¨²¬®¢ ¯®¨±ª 
ª° ²· ©¸¨µ ¯³²¥©.
¥®°¥¬  25.17
³±²¼ G = (V; E ) | £° ´, ±®®²¢¥²±²¢³¾¹¨© ±¨±²¥¬¥ ° §­®±²­»µ ®£° ­¨·¥­¨© ± n ­¥¨§¢¥±²­»¬¨. ±«¨ ®­ ­¥ ±®¤¥°¦¨² ¶¨ª«®¢
®²°¨¶ ²¥«¼­®£® ¢¥± , ²® ¢¥ª²®°

x = ((v0; v1); (v0; v2); : : :; (v0; vn))
(25:5)
¿¢«¿¥²±¿ °¥¸¥­¨¥¬ ±¨±²¥¬». ±«¨ G ±®¤¥°¦¨² ¶¨ª« ®²°¨¶ ²¥«¼­®-

£® ¢¥± , ²® ±¨±²¥¬  ° §­®±²­»µ ®£° ­¨·¥­¨© ­¥±®¢¬¥±²­ .
®ª § ²¥«¼±²¢®
±«¨ ¶¨ª«  ®²°¨¶ ²¥«¼­®£® ¢¥±  ­¥², ²® ¢±¥  (v0; vj ) ¿¢¿«¾²±¿
(ª®­¥·­»¬¨) ·¨±« ¬¨ ¨ «¥¬¬  25.3 £ ° ­²¨°³¥², ·²® ·¨±«  xi ³¤®¢«¥²¢®°¿¾² ¢±¥¬ ­¥° ¢¥­±²¢ ¬.
±«¨ ¶¨ª« ®²°¨¶ ²¥«¼­®£® ¢¥±  ¥±²¼, ²® ®­ ­¥ ±®¤¥°¦¨² ¢¥°¸¨­» v0, ¯®±ª®«¼ª³ ­¨ ®¤­® °¥¡°® ¢ ½²³ ¢¥°¸¨­³ ­¥ ¢µ®¤¨², ² ª ·²®
¢±¥ °¥¡°  ¶¨ª«  ±®®²¢¥²±²¢³¾² ª ª¨¬-²® ­¥° ¢¥­±²¢ ¬ ±¨±²¥¬».
ª« ¤»¢ ¿ ­¥° ¢¥­±²¢ , ±®®²¢¥²±²¢³¾¹¨¥ °¥¡° ¬ ¶¨ª« , ¯®«³·¨¬

£° ­¨·¥­¨¿ ­  ° §­®±²¨ ¨ ª° ²· ©¸¨¥ ¯³²¨

521

(¯®±ª®«¼ª³ «¥¢»¥ · ±²¨ ­¥° ¢¥­±²¢ ¶¨ª«  ±®ª° ¹ ¾²±¿) ­¥° ¢¥­±²¢® ¢¨¤  0 6 b, £¤¥ b < 0 | ¢¥± ¶¨ª« . «¥¤®¢ ²¥«¼­®, ±¨±²¥¬ 
­¥±®¢¬¥±²­ .
¥¸¥­¨¥ ±¨±²¥¬ ®£° ­¨·¥­¨© ­  ° §­®±²¨
¥®°¥¬  25.17 ¯®ª §»¢ ¥², ·²® ­ ©²¨ µ®²¿ ¡» ®¤­® °¥¸¥­¨¥
±¨±²¥¬» ®£° ­¨·¥­¨© ­  ° §­®±²¨ ¬®¦­® ± ¯®¬®¹¼¾  «£®°¨²¬ 
¥««¬ ­ -®°¤ .  ¬¥²¨¬, ·²® ¶¨ª« ®²°¨¶ ²¥«¼­®£® ¢¥± , ¥±«¨ ®­
¥±²¼, ®¡¿§ ²¥«¼­® ¤®±²¨¦¨¬ ¨§ ¢¥°¸¨­» v0 (¯®±ª®«¼ª³ ¨§ v0 ¨¤³²
±²°¥«ª¨ ¢® ¢±¥ ®±² «¼­»¥ ¢¥°¸¨­»), ² ª ·²® ±¨±²¥¬  ­¥±®¢¬¥±²­ 
²®£¤  ¨ ²®«¼ª® ²®£¤ , ª®£¤   «£®°¨²¬ ¥««¬ ­ -®°¤  ¢®§¢° ¹ ¥²
§­ ·¥­¨¥ false.
¨±²¥¬  m ° §­®±²­»µ ®£° ­¨·¥­¨© ± n ­¥¨§¢¥±²­»¬¨ ¯®°®¦¤ ¥² £° ´ ± n + 1 ¢¥°¸¨­®© ¨ ­¥ ¡®«¥¥ ·¥¬ n + m °¥¡° ¬¨. ®½²®¬³
­ ©²¨ µ®²¿ ¡» ®¤­® °¥¸¥­¨¥ ¬®¦­® §  ¢°¥¬¿ O((n + 1)(n + m)) =
O(n2 + mn).  ³¯° ¦­¥­¨¨ 25.5-5 ¬» ¯®¯°®±¨¬ ¢ ± ¤®ª § ²¼, ·²®
¬®¦­® ¬®¤¨´¨¶¨°®¢ ²¼ ½²®²  «£®°¨²¬ ² ª¨¬ ®¡° §®¬, ·²®¡» ®­
­ µ®¤¨« °¥¸¥­¨¥ ¨«¨ ³±² ­ ¢«¨¢ « ­¥±®¢¬¥±²­®±²¼ ±¨±²¥¬» §  ¢°¥¬¿ O(mn).
¯° ¦­¥­¨¿
25.5-1  ©¤¨²¥ µ®²¿ ¡» ®¤­® °¥¸¥­¨¥ ¨«¨ ³±² ­®¢¨²¥ ­¥±®¢¬¥±²­®±²¼ ±«¥¤³¾¹¥© ±¨±²¥¬» ­¥° ¢¥­±²¢:

x1 ; x2 6 1;
x1 ; x4 6 ;4;
x2 ; x3 6 2;
x2 ; x5 6 7;
x2 ; x6 6 5;
x3 ; x6 6 10;
x4 ; x2 6 2;
x5 ; x1 6 ;1;
x5 ; x4 6 3;
x6 ; x3 6 ;8:
25.5-2 ® ¦¥ § ¤ ­¨¥, ·²® ¢ ¯°¥¤»¤³¹¥¬ ³¯° ¦­¥­¨¨, ¤«¿ ±¨±²¥-

522

« ¢  25 ° ²· ©¸¨¥ ¯³²¨ ¨§ ®¤­®© ¢¥°¸¨­»

¬»

x1 ; x2 6 4;
x1 ; x5 6 5;
x2 ; x4 6 ;6;
x3 ; x2 6 1;
x4 ; x1 6 3;
x4 ; x3 6 5;
x4 ; x5 6 10;
x5 ; x3 6 ;4;
x5 ; x4 6 ;8:

25.5-3 ®¦¥² «¨ ¢ £° ´¥ ®£° ­¨·¥­¨© ª° ²· ©¸¨© ¯³²¼ ¨§ v0 ¢
ª ª³¾-²® ¢¥°¸¨­³ ¨¬¥²¼ ¯®«®¦¨²¥«¼­»© ¢¥±?
25.5-4 ¢¥¤¨²¥ § ¤ ·³ ® ª° ²· ©¸¥¬ ¯³²¨ ¬¥¦¤³ ¯ °®© ¢¥°¸¨­
ª § ¤ ·¥ «¨­¥©­®£® ¯°®£° ¬¬¨°®¢ ­¨¿.
25.5-5 ®¤¨´¨¶¨°³©²¥  «£®°¨²¬ ¥««¬ ­ -®°¤  ² ª¨¬ ®¡° §®¬, ·²®¡» ¯°¨ °¥¸¥­¨¨ ±¨±²¥¬» m ®£° ­¨·¥­¨© ­  ° §­®±²¨ ± n
­¥¨§¢¥±²­»¬¨ ®­ ° ¡®² « §  ¢°¥¬¿ O(mn).
25.5-6  ª ± ¯®¬®¹¼¾  «£®°¨²¬ ,  ­ «®£¨·­®£®  «£®°¨²¬³
¥««¬ ­ -®°¤ , °¥¸¨²¼ ±¨±²¥¬³ ®£° ­¨·¥­¨© ­  ° §­®±²¨, ¯®«¼§³¿±¼ £° ´®¬ ®£° ­¨·¥­¨© ¡¥§ ¤®¯®«­¨²¥«¼­®© ¢¥°¸¨­» v0 ?
25.5-7* ®ª ¦¨²¥, ·²® °¥¸¥­¨¥ ±¨±²¥¬» ° §­®±²­»µ ®£° ­¨·¥­¨© ± n ­¥¨§¢¥±²­»¬¨, ­ µ®¤¨¬®¥  «£®°¨²¬®¬ ¥««¬ ­ -®°¤ ,
¨¬¥¥² (±°¥¤¨ ¢±¥µ °¥¸¥­¨© ½²®© ±¨±²¥¬», ¢ ª®²®°»µ ¢±¥ ¯¥°¥¬¥­­»¥ ­¥¯®«®¦¨²¥«¼­») ¬ ª±¨¬ «¼­®¥ §­ ·¥­¨¥ ±³¬¬» x1 + x2 + : : : +
xn .
25.5-8* ®ª ¦¨²¥, ·²® °¥¸¥­¨¥ ±¨±²¥¬» ° §­®±²­»µ ®£° ­¨·¥­¨© Ax 6 b ± n ­¥¨§¢¥±²­»¬¨, ­ µ®¤¨¬®¥  «£®°¨²¬®¬
¥««¬ ­ -®°¤ , ¨¬¥¥² ¬¨­¨¬ «¼­® ¢®§¬®¦­®¥ §­ ·¥­¨¥ ¢¥«¨·¨­» maxfxi g ; minfxi g ±°¥¤¨ ¢±¥µ ®¥¹¥­¨© ½²®© ±¨±²¥¬». ¥¬
¯®«¥§­® ½²® ®¡±²®¿²¥«¼±²¢® ¯°¨ ¯« ­¨°®¢ ­¨¨ ±²°®¨²¥«¼±²¢ ?
25.5-9  ±±¬®²°¨¬ ±¨±²¥¬³ ­¥° ¢¥­±²¢, ¢ ª®²®°®© ª ¦¤®¥ ­¥° ¢¥­±²¢® ¿¢«¿¥²±¿ «¨¡® ®£° ­¨·¥­¨¥¬ ­  ° §­®±²¨, «¨¡® ­¥° ¢¥­±²¢®¬ ¢¨¤  xi 6 a, «¨¡® ­¥° ¢¥­±²¢®¬ ¢¨¤  xj > a. ®¤¨´¨¶¨°³©²¥
 «£®°¨²¬ ¥««¬ ­ -®°¤  ² ª¨¬ ®¡° §®¬, ·²®¡» ®­ ­ µ®¤¨« µ®²¿
¡» ®¤­® °¥¸¥­¨¥ ¨«¨ ³±² ­ ¢«¨¢ « ­¥±®¢¬¥±²­®±²¼ ² ª¨µ ±¨±²¥¬.
25.5-10 ³±²¼ ª ±¨±²¥¬¥ ®£° ­¨·¥­¨© ­  ° §­®±²¨ ¤®¡ ¢«¥­® ­¥ª®²®°®¥ ª®«¨·¥±²¢® ³° ¢­¥­¨© ¢¨¤  xi = xj + bk . ®¤¨´¨¶¨°³©²¥
 «£®°¨²¬ ¥««¬ ­ -®°¤  ² ª¨¬ ®¡° §®¬, ·²®¡» ®­ ¬®£ ­ µ®¤¨²¼
°¥¸¥­¨¿ ² ª¨µ ±¨±²¥¬.
25.5-11  §° ¡®² ©²¥ ½´´¥ª²¨¢­»©  «£®°¨²¬ ¤«¿ ­ µ®¦¤¥­¨¿
°¥¸¥­¨¿ ±¨±²¥¬» ®£° ­¨·¥­¨© ­  ° §­®±²¨, ¢ ª®²®°®¬ ¢±¥ ­¥¨§¢¥±²­»¥ ¿¢«¿¾²±¿ ¶¥«»¬¨ ·¨±« ¬¨ (ª®­±² ­²» ¢ ®£° ­¨·¥­¨¿µ ­¥
®¡¿§ ­» ¡»²¼ ¶¥«»¬¨, ­® ¨µ ¬®¦­® § ¬¥­¨²¼ ­  ¨µ ¶¥«»¥ · ±²¨).

£° ­¨·¥­¨¿ ­  ° §­®±²¨ ¨ ª° ²· ©¸¨¥ ¯³²¨

523

25.5-12*  §° ¡®² ©²¥ ½´´¥ª²¨¢­»©  «£®°¨²¬ ¤«¿ ­ µ®¦¤¥­¨¿
°¥¸¥­¨¿ ±¨±²¥¬» ®£° ­¨·¥­¨© ­  ° §­®±²¨, ¥±«¨ ¢±¥ ¯¥°¥¬¥­­»¥
° §¡¨²» ­  ¤¢¥ £°³¯¯»: ¶¥«»¥ (¤«¿ ª®²®°»µ ¤®¯³±²¨¬» ²®«¼ª®
¶¥«»¥ §­ ·¥­¨¿) ¨ ¢¥¹¥±²¢¥­­»¥ (¤«¿ ª®²®°»µ ² ª®£® ®£° ­¨·¥­¨¿
­¥²).
 ¤ ·¨
25-1 ®¤¨´¨ª ¶¨¿  «£®°¨²¬  ¥««¬ ­ -®°¤  ¯® ¥­³
»¡¥°¥¬ ¯®°¿¤®ª, ¢ ª®²®°®¬ ®¡° ¡ ²»¢ ¾²±¿ °¥¡°  ¢  «£®°¨²¬¥
¥««¬ ­ -®°¤ , ±«¥¤³¾¹¨¬ ®¡° §®¬. °®­³¬¥°³¥¬ ª ª¨¬-«¨¡®
®¡° §®¬ ¢¥°¸¨­» £° ´  ¨ ° §®¡¼¥¬ ¬­®¦¥±²¢® E ¢¥°¸¨­ £° ´ 
­  ¤¢  ¯®¤¬­®¦¥±²¢ : Ef , ±®±²®¿¹¥¥ ¨§ ±²°¥«®ª, ¨¤³¹¨µ ¨§ ¢¥°¸¨­» ± ¬¥­¼¸¨¬ ­®¬¥°®¬ ¢ ¢¥°¸¨­³ ± ¡®«¼¸¨¬ ­®¬¥°®¬, ¨ Eb ,
±®±²®¿¹¥¥ ¨§ ±²°¥«®ª, ¨¤³¹¨µ ¨§ ¢¥°¸¨­» ± ¡®«¼¸¨¬ ­®¬¥°®¬ ¢
¢¥°¸¨­³ ± ¬¥­¼¸¨¬ ­®¬¥°®¬. ³±²¼ Gf = (V; Ef ) ¨ Gb = (V; Eb)
(·¥°¥§ V ®¡®§­ ·¥­® ¬­®¦¥±²¢® ¢¥°¸¨­ £° ´ ).  ·­¥¬ ± ² ª®£®
®·¥¢¨¤­®£® ­ ¡«¾¤¥­¨¿:
( ) ®ª ¦¨²¥, ·²® £° ´» Gf ¨ Gb  ¶¨ª«¨·­», ¯°¨·¥¬ ° ±¯®«®¦¥­¨¥ ¢¥°¸¨­ ¢ ¯®°¿¤ª¥ ¢®§° ±² ­¨¿ (³¡»¢ ­¨¿) ­®¬¥°®¢ § ¤ ¥²
²®¯®«®£¨·¥±ª®¥ ³¯®°¿¤®·¥­¨¥ ­  £° ´¥ Gf (Gb ).
³¤¥¬ ²¥¯¥°¼ ¯°®¢®¤¨²¼ °¥« ª± ¶¨¾ °¥¡¥° ¯°¨ ª ¦¤®© ¨²¥° ¶¨¨ ¶¨ª«  ¢  «£®°¨²¬¥ ¥««¬ ­ -®°¤  ¢ ±«¥¤³¾¹¥¬ ¯®°¿¤ª¥: ±­ · «  ¯¥°¥¡¨° ¥¬ ¢¥°¸¨­» ¢ ¯®°¿¤ª¥ ¢®§° ±² ­¨¿ ­®¬¥°®¢ ¨ ¤«¿
ª ¦¤®© ¢¥°¸¨­» ¯®¤¢¥°£ ¥¬ °¥« ª± ¶¨¨ ¢±¥ ¢»µ®¤¿¹¨¥ ¨§ ­¥¥ °¥¡°  £° ´  Ef ; § ²¥¬ ¯¥°¥¡¨° ¥¬ ¢±¥ ¢¥°¸¨­» ¢ ¯®°¿¤ª¥ ³¡»¢ ­¨¿
­®¬¥°®¢ ¨ ¤«¿ ª ¦¤®© ¢¥°¸¨­» ¯®¤¢¥°£ ¥¬ °¥« ª± ¶¨¨ ¢±¥ ¢»µ®¤¿¹¨¥ ¨§ ­¥¥ °¥¡°  £° ´  Eb.
(¡) ³±²¼ G ­¥ ±®¤¥°¦¨² ¶¨ª«®¢ ®²°¨¶ ²¥«¼­®£® ¢¥± , ¤®±²¨¦¨¬»µ ¨§ ¢¥°¸¨­» s; ¤®ª ¦¨²¥, ·²® ¯®±«¥ djV j=2e ¨²¥° ¶¨© ¶¨ª« 
° ¢¥­±²¢  d[v ] =  (s; v ) ¡³¤³² ¢»¯®«­¿²¼±¿ ¤«¿ ¢±¥µ v 2 V .
(¢) ¶¥­¨²¥ ¢°¥¬¿ ° ¡®²» ®¯¨± ­­®© ¬®¤¨´¨ª ¶¨¨  «£®°¨²¬ 
¥««¬ ­ -®°¤ .
25-2 «®¦¥­­»¥ ¿¹¨ª¨
³¤¥¬ £®¢®°¨²¼, ·²® d-¬¥°­»© ¿¹¨ª ° §¬¥°®¢ (x1; x2; : : :; xd)
¢ª« ¤»¢ ¥²±¿ (nests) ¢ ¿¹¨ª ° §¬¥°®¢ (y1; y2 ; : : :; yd ), ¥±«¨ ³ ¬­®¦¥±²¢  f 1; 2; : : :; d g ±³¹¥±²¢³¥² ² ª ¿ ¯¥°¥±² ­®¢ª   , ·²® x(1) <
y1 ; x(2) < y2 ; : : :; x(d) < yd .
( ) ®ª ¦¨²¥, ·²® ®²­®¸¥­¨¥ À¢ª« ¤»¢ ²¼±¿Á ²° ­§¨²¨¢­®.
(¡) ¯¨¸¨²¥ ½´´¥ª²¨¢­»© ±¯®±®¡ ¯°®¢¥°¨²¼, ¢ª« ¤»¢ ¥²±¿ «¨
®¤¨­ d-¬¥°­»© ¿¹¨ª ¢ ¤°³£®©.
(¢)  ­» n ° §«¨·­»µ d-¬¥°­»µ ¿¹¨ª®¢. °¥¡³¥²±¿ ³§­ ²¼, ª ª®¥ ¬ ª±¨¬ «¼­®¥ ·¨±«® ¨§ ­¨µ ¬®¦­® ¯®±«¥¤®¢ ²¥«¼­® ¢«®¦¨²¼
¤°³£ ¢ ¤°³£  (¯¥°¢»© ¢® ¢²®°®©, ¢²®°®© ¢ ²°¥²¨© ¨ ².¤.). ª ¦¨²¥
½´´¥ª²¨¢­»©  «£®°¨²¬ ¤«¿ °¥¸¥­¨¿ ½²®© § ¤ ·¨ ¨ ®¶¥­¨²¥ ¢°¥¬¿
¥£® ° ¡®²».
25-3 °¡¨²° ¦­»¥ ®¯¥° ¶¨¨
°¡¨²° ¦­»¬¨ ®¯¥° ¶¨¿¬¨ (arbitrage) ­ §»¢ ¥²±¿ ±«¥¤³¾¹¨©

524

« ¢  25 ° ²· ©¸¨¥ ¯³²¨ ¨§ ®¤­®© ¢¥°¸¨­»

±¯®±®¡ ¨§¢«¥ª ²¼ ¯°¨¡»«¼ ¨§ ­¥±®£« ±®¢ ­­®±²¨ ª³°±®¢ ®¡¬¥­  ¢ «¾². °¥¤¯®«®¦¨¬, ·²® ®¤¨­ ¤®«« ° ¬®¦­® ®¡¬¥­¿²¼ ­  0;7 ´³­²  ±²¥°«¨­£®¢, ®¤¨­ ´³­² ±²¥°«¨­£®¢ | ­  9;5 ´° ­ª®¢, ¨ ®¤¨­
´° ­ª | ­  0;16 ¤®«« ° . ®£¤ , ®¡¬¥­¨¢ ¿ 1 ¤®«« ° ¢ ³ª § ­­®©
¯®±«¥¤®¢ ²¥«¼­®±²¨, ¢ °¥§³«¼² ²¥ ¬®¦­® ¯®«³·¨²¼ 1;064 ¤®«« °  ¨
²¥¬ ± ¬»¬ ®±² ²¼±¿ ± ¯°¨¡»«¼¾ 6;4%.
³±²¼ ¨¬¥¾²±¿ n ¢ «¾² (¯°®­³¬¥°®¢ ­­»µ ®² 1 ¤® n) ¨ ¬ ±±¨¢
R[1::n; 1::n], ¢ ª®²®°®¬ § ¯¨± ­» ª³°±» ®¡¬¥­  (¥¤¨­¨¶³ ¢ «¾²» i
¬®¦­® ®¡¬¥­¿²¼ ­  R[i; j ] ¥¤¨­¨¶ ¢ «¾²» j ).
( )  §° ¡®² ©²¥ ½´´¥ª²¨¢­»©  «£®°¨²¬, ¯®§¢®«¿¾¹¨© ¢»¿±­¨²¼, ±³¹¥±²¢³¥² «¨ ² ª ¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼ (i1; i2; : : :; ik ), ·²®
R[i1; i2]  R[i2; i3]      R[ik;1; ik ]  R[ik; i1] > 1:
¶¥­¨²¥ ¢°¥¬¿ ° ¡®²» ¢ ¸¥£®  «£®°¨²¬ .
(¡)  §° ¡®² ©²¥ ½´´¥ª²¨¢­»©  «£®°¨²¬, ¯¥· ² ¾¹¨© ² ª³¾
¯®±«¥¤®¢ ²¥«¼­®±²¼, ¥±«¨ ®­  ±³¹¥±²¢³¥². ¶¥­¨²¥ ¢°¥¬¿ ¥£® ° ¡®²».
25-4 «£®°¨²¬  ¡®³ ­ µ®¦¤¥­¨¿ ª° ²· ©¸¨µ ¯³²¥© ± ¯®¬®¹¼¾
¬ ±¸² ¡¨°®¢ ­¨¿
³±²¼ ­ ¬ ¤ ­ ¢§¢¥¸¥­­»© ®°¨¥­²¨°®¢ ­­»© £° ´ G = (V; E ),
¢ ª®²®°®¬ ¢¥±  ¢±¥µ °¥¡¥° ¿¢«¿¾²±¿ ¶¥«»¬¨ ­¥®²°¨¶ ²¥«¼­»¬¨
·¨±« ¬¨, ­¥ ¯°¥¢®±µ®¤¿¹¨¬¨ W . ®ª ¦¥¬, ª ª ¬®¦­® ­ ©²¨ ª° ²· ©¸¨¥ ¯³²¨ ¨§ ®¤­®© ¢¥°¸¨­» §  ¢°¥¬¿ O(E lg W ).
³±²¼ k = dlg(W + 1)e | ª®«¨·¥±²¢® ¡¨²®¢ ¢ ¤¢®¨·­®¬ ¯°¥¤±² ¢«¥­¨¨ ·¨±«  W . «¿ i = 1; 2; : : :; k ¯®«®¦¨¬
wi (u; v) = bw(u; v )=2k;ic (¨­»¬¨ ±«®¢ ¬¨, wi(u; v) ¯®«³· ¥²±¿ ¨§
w(u; v) ®²¡° ±»¢ ­¨¥¬ k ; i ¬« ¤¸¨µ ¡¨²®¢ ¢ ¤¢®¨·­®¬ ¯°¥¤±² ¢«¥­¨¨ ·¨±«  w(u; v )).  ¯°¨¬¥°, ¥±«¨ k = 5 ¨ w(u; v ) = 25 = h11001i,
²® w3 (u; v ) = h110i = 6.  · ±²­®±²¨, w1 ¯°¨­¨¬ ¥² ²®«¼ª®
§­ ·¥­¨¿ 0 ¨ 1, ®¯°¥¤¥«¿¥¬»¥ ±² °¸¨¬ ° §°¿¤®¬,   wk = w.
³±²¼ i (u; v ) | ¢¥± ª° ²· ©¸¥£® ¯³²¨ ¨§ u ¢ v ®²­®±¨²¥«¼­®
¢¥±®¢®© ´³­ª¶¨¨ wi (¢ · ±²­®±²¨, k (u; v ) =  (u; v )). «£®°¨²¬, ®
ª®²®°®¬ ¯®©¤¥² °¥·¼ ¢ ½²®© § ¤ ·¥, ­ ©¤¥² ±­ · «  ¢±¥ 1 (s; v ) (s |
¨±µ®¤­ ¿ ¢¥°¸¨­ ), § ²¥¬ ¢±¥ 2 (s; v ), ¨ ² ª ¤ «¥¥, ¯®ª  ­¥ ¤®©¤¥²
¤® k (s; v ) =  (s; v ).  «¥¥ ¬» ¯®« £ ¥¬, ·²® jE j > jV j ; 1; ª ª ¬»
³¢¨¤¨¬, ±²®¨¬®±²¼ ­ µ®¦¤¥­¨¿ i ¯°¨ ¨§¢¥±²­®¬ i;1 ¥±²¼ O(E ),
² ª ·²®  «£®°¨²¬ ¡³¤¥² ° ¡®² ²¼ §  ¢°¥¬¿ O(kE ) = O(E lg W ).
 ª®© ¯« ­ °¥¸¥­¨¿ § ¤ ·¨ | § ¬¥­  ¨±µ®¤­»µ ¤ ­­»µ ¨µ ¤¢®¨·­»¬¨ ¯°¨¡«¨¦¥­¨¿¬¨ ± ¯®±«¥¤®¢ ²¥«¼­»¬ ³²®·­¥­¨¥¬ | ­ §»¢ ¥²±¿ ¬ ±¸² ¡¨°®¢ ­¨¥¬ (scaling)
( ) ³±²¼  (s; v ) 6 jE j ¤«¿ ¢±¥µ ¢¥°¸¨­ v 2 V (¯°¥¤¯®« £ ¥²±¿,
·²® jE j > jV j ; 1 ¨ ¢¥±  ¿¢«¿¾²±¿ ¶¥«»¬¨ ­¥®²°¨¶ ²¥«¼­»¬¨ ·¨±« ¬¨). ®ª ¦¨²¥, ·²® ¬®¦­® ­ ©²¨  (s; v ) ¤«¿ ¢±¥µ v 2 V §  ¢°¥¬¿
O(E ).
(¡) ®ª ¦¨²¥, ·²® ¬®¦­® ¯®¤±·¨² ²¼ 1 (s; v ) ¤«¿ ¢±¥µ v 2 V § 
¢°¥¬¿ O(E ).

£° ­¨·¥­¨¿ ­  ° §­®±²¨ ¨ ª° ²· ©¸¨¥ ¯³²¨

525

¥¯¥°¼ § ©¬¥¬±¿ ¢»·¨±«¥­¨¥¬ i ¨±µ®¤¿ ¨§ i;1 .
(¢) ®ª ¦¨²¥, ·²® (¯°¨ i = 2; 3; : : :; k) «¨¡® wi (u; v ) = 2wi;1 (u; v ),
«¨¡® wi(u; v ) = 2wi;1 (u; v ) + 1. »¢¥¤¨²¥ ®²±¾¤ , ·²®
2i;1 (u; v ) 6 i (u; v ) 6 2i;1 (u; v ) + jV j ; 1
¤«¿ ¢±¥µ v 2 V .
(£) «¿ i = 2; 3; : : :; k ¨ (u; v ) 2 E ¯®«®¦¨¬

w^i(u; v) = wi (u; v) + 2i;1 (s; u) ; 2i;1(s; v):
®ª ¦¨²¥, ·²® w^i (u; v ) > 0.
(¤) ³±²¼ ^i (s; v ) | ¢¥± ª° ²· ©¸¥£® ¯³²¨ ®²­®±¨²¥«¼­® ¢¥±®¢®©
´³­ª¶¨¨ w^i . ®ª ¦¨²¥, ·²®
i (s; v) = ^i (s; v ) + 2i;1(s; v )
¨ ·²® ^i (s; v ) 6 jE j.
(¥) ¡º¿±­¨²¥, ª ª §  ¢°¥¬¿ O(E ) ¢»·¨±«¨²¼ ¢±¥ §­ ·¥­¨¿
i (s; v ), §­ ¿ i;1 (s; v).  ª ¢»·¨±«¨²¼  (s; v ) (¤«¿ ¢±¥µ v 2 V ) § 
¢°¥¬¿ O(E lg W )?
25-5 «£®°¨²¬  °¯  ¤«¿ ®²»±ª ­¨¿ ¶¨ª«  ± ¬¨­¨¬ «¼­»¬ ±°¥¤­¨¬ ¢¥±®¬
³±²¼ G = (V; E ) | ®°¨¥­²¨°®¢ ­­»© £° ´ ± ¢¥±®¢®© ´³­ª¶¨¥©
w : E ! R, ¨ ¯³±²¼ n = jV j. °¥¤­¨¬ ¢¥±®¬ (mean weight) ¶¨ª« 
c = he1; e2; : : :; ek i, £¤¥ ej | °¥¡°  £° ´ , ­ §®¢¥¬ ·¨±«®

(c) = k1

k
X
i=1

w(ei ):

³±²¼  = minc (c), £¤¥ c ¯°®¡¥£ ¥² ¢±¥ (®°¨¥­²¨°®¢ ­­»¥) ¶¨ª«».  ½²®© § ¤ ·¥ ¬» ®¯¨¸¥¬ ½´´¥ª²¨¢­»©  «£®°¨²¬ ¤«¿ ¢»·¨±«¥­¨¿  .
¥ ®£° ­¨·¨¢ ¿ ®¡¹­®±²¨, ¡³¤¥¬ ±·¨² ²¼, ·²® ª ¦¤ ¿ ¢¥°¸¨­ 
v 2 V ¤®±²¨¦¨¬  ¨§ ­¥ª®²®°®© ¢¥°¸¨­» s. ¥°¥§  (s; v) ®¡®§­ ·¨¬
¢¥± ª° ²· ©¸¥£® ¯³²¨ ¨§ s ¢ v ; ¯³±²¼ k (s; v ) | ¢¥± ª° ²· ©¸¥£®
¯³²¨ ¨§ s ¢ v , ±®±²®¿¹¥£® ¢ ²®·­®±²¨ ¨§ k °¥¡¥° (¥±«¨ ² ª®£® ¯³²¨
­¥², ¯®« £ ¥¬ k (s; v ) = 1).
( ) ³±²¼  = 0. ®ª ¦¨²¥, ·²® G ­¥ ±®¤¥°¦¨² ¶¨ª«®¢ ®²°¨¶ ²¥«¼­®£® ¢¥±  ¨ ·²®  (s; v ) = min06k6n;1 k (s; v ) ¤«¿ ¢±¥µ v 2 V .
(¡) ³±²¼  = 0. ®ª ¦¨²¥, ·²®
max n (s; v ) ; k (s; v ) > 0
06k6n;1

n;k

¤«¿ «¾¡®© ¢¥°¸¨­» v 2 V (ª § ­¨¥: ¢®±¯®«¼§³©²¥±¼ ¤¢³¬¿ ³²¢¥°¦¤¥­¨¿¬¨ ¯°¥¤»¤³¹¥£® ¯³­ª² .)

526

« ¢  25 ° ²· ©¸¨¥ ¯³²¨ ¨§ ®¤­®© ¢¥°¸¨­»

(¢) ³±²¼ u ¨ v | ¤¢¥ ¢¥°¸¨­», «¥¦ ¹¨¥ ­  ¶¨ª«¥ ­³«¥¢®£® ¢¥± .
³±²¼ ¢¥± ³· ±²ª  ½²®£® ¶¨ª«  ®² u ¤® v ° ¢¥­ x. ®ª ¦¨²¥, ·²®
(s; v ) = (s; u) + x (ª § ­¨¥: ¢¥± ³· ±²ª  ®² v ¤® u ° ¢¥­ ;x).
(£) ³±²¼  = 0. ®ª ¦¨²¥, ·²® ±³¹¥±²¢³¥² ¢¥°¸¨­  v , «¥¦ ¹ ¿
­  ¶¨ª«¥ ± ¬¨­¨¬ «¼­»¬ ±°¥¤­¨¬ ¢¥±®¬, ² ª ¿, ·²®
max n (s; v ) ; k (s; v ) = 0
06k6n;1

n;k

(ª § ­¨¥: ¯®ª ¦¨²¥, ·²® ª° ²· ©¸¨© ¯³²¼ ®² s ¤® ¢¥°¸¨­», «¥¦ ¹¥© ­  ¶¨ª«¥ ± ­³«¥¢»¬ ¢¥±®¬, ¬®¦­® ¯°®¤®«¦¨²¼ ¢¤®«¼ ½²®£®
¶¨ª«  ² ª, ·²® ®­ ®±² ­¥²±¿ ª° ²· ©¸¨¬.)
(¤) ³±²¼  = 0. ®ª ¦¨²¥, ·²®
min max n (s; v ) ; k (s; v ) = 0:
v2V 06k6n;1

n;k

(¥) ®ª ¦¨²¥, ·²®

n (s; v ) ; k (s; v)
 = min
max
v2V 06k6n;1
n;k
(ª § ­¨¥: ¥±«¨ ¯°¨¡ ¢¨²¼ ª®­±² ­²³ t ª ¢¥± ¬ ¢±¥µ °¥¡¥°, ²® 
³¢¥«¨·¨²±¿ ­  t.)
(¦)  §° ¡®² ©²¥  «£®°¨²¬, ¢»·¨±«¿¾¹¨©  §  ¢°¥¬¿ O(V E ).
 ¬¥· ­¨¿
«£®°¨²¬ ¥©ª±²°» [55] ¯®¿¢¨«±¿ ¢ 1959 £®¤³ (¡¥§ ³¯®¬¨­ ­¨¿
®·¥°¥¤¥© ± ¯°¨®°¨²¥² ¬¨). «£®°¨²¬ ¥««¬ ­ -®°¤  ®±­®¢ ­ ­ 
¤¢³µ ®²¤¥«¼­»µ  «£®°¨²¬ µ, ¨§®¡°¥²¥­­»µ ¥««¬ ­®¬ [22] ¨ ®°¤®¬ [71]. ¢¿§¼ ª° ²· ©¸¨µ ¯³²¥© ± ®£° ­¨·¥­¨¿¬¨ ­  ° §­®±²¨
®¯¨± ­  ¥««¬ ­®¬. «£®°¨²¬ ¤«¿ ¯®¨±ª  ª° ²· ©¸¨µ ¯³²¥© ¢
 ¶¨ª«¨·¥±ª®¬ ®°¨¥­²¨°®¢ ­­®¬ £° ´¥ §  «¨­¥©­®¥ ¢°¥¬¿ ®¯¨± ­
®³«¥°®¬ [132] (ª ª Á´®«¼ª«®°­»©Á).
±«¨ ¢¥±  °¥¡¥° | ­¥¡®«¼¸¨¥ ¶¥«»¥ ·¨±« , ²® ¤«¿ ­ µ®¦¤¥­¨¿
ª° ²· ©¸¨µ ¯³²¥© ¨§ ®¤­®© ¢¥°¸¨­» ¬®¦­® ¯°¨¬¥­¨²¼ ¨ ¡®«¥¥
½´´¥ª²¨¢­»¥ ¬¥²®¤». µ³¤¦ , ¥«¼µ®°­, °«¨­ p¨  °¼¿­ [6] ®¯¨±»¢ ¾²  «£®°¨²¬, ° ¡®² ¾¹¨© §  ¢°¥¬¿ O(E + V lg W ) ¢ ¯°¥¤¯®«®¦¥­¨¨, ·²® ¢¥±  | ¶¥«»¥ ­¥®²°¨¶ ²¥«¼­»¥ ·¨±« , ­¥ ¯°¥¢®±µ®¤¿¹¨¥ W . ­¨ ¦¥ ¯°¨¢®¤¿² ¯°®±²®©  «£®°¨²¬, ° ¡®² ¾¹¨© §  ¢°¥¬¿
O(E + V lg W ). «¿ ±«³· ¿, ª®£¤  ¢¥±  ¬®£³² ¡»²¼ ®²°¨¶ ²¥«¼­»¬¨
(¶¥«»¬¨) ·¨±« ¬¨,p ¥±²¼  «£®°¨²¬  ¡®³ ¨  °¼¿­  [77], ° ¡®² ¾¹¨© §  ¢°¥¬¿ O( V E lg(V W )), £¤¥ W | ¬ ª±¨¬³¬  ¡±®«¾²­»µ
¢¥«¨·¨­ ¢¥±®¢.
®°®¸¨© ®¡§®° ° §«¨·­»µ  «£®°¨²¬®¢, ±¢¿§ ­­»µ ± «¨­¥©­»¬
¯°®£° ¬¬¨°®¢ ­¨¥¬ (¢ · ±²­®±²¨, ±¨¬¯«¥ª±-¬¥²®¤  ¨ ¬¥²®¤  ½««¨¯±®¨¤®¢), ¤ ¾²  ¯ ¤¨¬¨²°¨³ ¨ ² ©£«¨¶ [154]. ¨¬¯«¥ª±-¬¥²®¤
¡»« ¨§®¡°¥²¥­  ­¶¨£®¬ (G. Dantzig) ¢ 1947 £®¤³, ¨ ° §«¨·­»¥

£° ­¨·¥­¨¿ ­  ° §­®±²¨ ¨ ª° ²· ©¸¨¥ ¯³²¨

527

¢ °¨ ­²» ½²®£® ¬¥²®¤  ¤® ±¨µ ¯®° ®±² ¾²±¿ ­ ¨¡®«¥¥ ¯®¯³«¿°­»¬¨ ±¯®±®¡ ¬¨ °¥¸¥­¨¿ § ¤ · «¨­¥©­®£® ¯°®£° ¬¬¨°®¢ ­¨¿. ¥²®¤ ½««¨¯±®¨¤®¢ ¯°¥¤«®¦¨« .. ·¨¿­, ®±­®¢»¢ ¿±¼ ­  ° ¡®² µ
.. ®° , .. ¤¨­  ¨ .. ¥¬¨°®¢±ª®£®.  °¬ °ª ° ®¯¨±»¢ ¥² ±¢®©  «£®°¨²¬ ¢ [115].

26

° ²· ©¸¨¥ ¯³²¨ ¤«¿ ¢±¥µ ¯ ° ¢¥°¸¨­

 ½²®© £« ¢¥ ¬» § ©¬¥¬±¿ § ¤ ·¥© ® ­ µ®¦¤¥­¨¨ ª° ²· ©¸¨µ ¯³²¥© ¤«¿ ¢±¥µ ¯ ° ¢¥°¸¨­ £° ´ .  ¡«¨¶  ° ±±²®¿­¨© ¬¥¦¤³ ¢±¥¢®§¬®¦­»¬¨ ¯ ° ¬¨ £®°®¤®¢ ¢  ²« ±¥ ¤®°®£ ¯®«³· ¥²±¿ ¢ °¥§³«¼² ²¥
°¥¸¥­¨¿ ¨¬¥­­® ² ª®© § ¤ ·¨.  ª ¨ ¢ £« ¢¥ 25, ¡³¤¥¬ ° ±±¬ ²°¨¢ ²¼ ®°¨¥­²¨°®¢ ­­»© ¢§¢¥¸¥­­»© £° ´ G = (V; E ) ± ¢¥¹¥±²¢¥­­®© ¢¥±®¢®© ´³­ª¶¨¥© w : E ! R. «¿ ª ¦¤®© ¯ °» ¢¥°¸¨­
u; v 2 V ¬» ¤®«¦­» ­ ©²¨ ª° ²· ©¸¨© ¯³²¼ u ¢ v , ²®·­¥¥, ¯³²¼
­ ¨¬¥­¼¸¥© ¤«¨­» (¤«¨­  ¯³²¨ ®¯°¥¤¥«¿¥²±¿ ª ª ±³¬¬  ¢¥±®¢ ¢±¥µ
¥£® °¥¡¥°).  ª¨¬ ®¡° §®¬, ®²¢¥²®¬ ¢ § ¤ ·¥ ® ª° ²· ©¸¨µ ¯³²¿µ ¬®¦­® ±·¨² ²¼ ² ¡«¨¶³, ¢ ª®²®°®© ­  ¯¥°¥±¥·¥­¨¨ ±²°®ª¨ u ¨
±²®«¡¶  v ª®²®°®© ­ µ®¤¨²±¿ ¢¥± ª° ²· ©¸¥£® ¯³²¨ ¨§ u ¢ v (¤®¯®«­¥­­³¾ ­¥ª®²®°®© ¨­´®°¬ ¶¨¥© ® ± ¬¨µ ½²¨µ ¯³²¿µ, ±¬. ­¨¦¥).
 §³¬¥¥²±¿, ¬®¦­® °¥¸¨²¼ ½²³ § ¤ ·³, ¥±«¨ jV j ° § ¯°¨¬¥­¨²¼
 «£®°¨²¬ ¤«¿ ¯®¨±ª  ª° ²· ©¸¨µ ¯³²¥© ¨§ ®¤­®© ¢¥°¸¨­» (ª® ¢±¥¬
¢¥°¸¨­ ¬ £° ´  ¯® ®·¥°¥¤¨). ±«¨ ¢±¥ °¥¡°  £° ´  ¨¬¥¾² ­¥®²°¨¶ ²¥«¼­»¥ ¢¥± , ²® ° §³¬­® ¨±¯®«¼§®¢ ²¼  «£®°¨²¬ ¥©ª±²°»; ¯°¨
¯°®±²®© °¥ «¨§ ¶¨¨ ®·¥°¥¤¨ ± ¯°¨®°¨²¥² ¬¨ ± ¯®¬®¹¼¾ ¬ ±±¨¢ 
®¡¹¥¥ ¢°¥¬¿ ° ¡®²»  «£®°¨²¬  ±®±² ¢¨² O(V 3 + V E ) = O(V 3 ).
±«¨ ®·¥°¥¤¼ °¥ «¨§®¢ ²¼ ± ¯®¬®¹¼¾ ¤¢®¨·­®© ª³·¨, ²® ®¡¹ ¿
±²®¨¬®±²¼ ±®±² ¢¨² O(V E lg V ), ·²® ¤ ¥² ¢»¨£°»¸ ¤«¿ ° §°¥¦¥­­»µ £° ´®¢. ¡¥ ½²¨ ®¶¥­ª¨ ¬®¦­® ³«³·¸¨²¼, ¨±¯®«¼§®¢ ¢ ´¨¡®­ ··¨¥¢» ª³·¨, ¤«¿ ª®²®°»µ ®¡¹¥¥ ¢°¥¬¿ ° ¡®²»  «£®°¨²¬  ¥±²¼
 «£®°¨²¬  ¡³¤¥² O(V 2 lg V + V E ).
±«¨ ¢ £° ´¥ ¥±²¼ °¥¡°  ± ®²°¨¶ ²¥«¼­»¬¨ ¢¥± ¬¨, ²®  «£®°¨²¬
¥©ª±²°» ¯°¨¬¥­¨²¼ ­¥«¼§¿. ±«¨ ¢¬¥±²® ­¥£® ¨±¯®«¼§®¢ ²¼ ¡®«¥¥
¬¥¤«¥­­»©  «£®°¨²¬ ¥««¬ ­ -®°¤ , ¢»¯®«­¿¿ ¥£® ¤«¿ ª ¦¤®©
¢¥°¸¨­» £° ´ , ®¡¹¥¥ ¢°¥¬¿ ° ¡®²» ±®±² ¢¨² O(V 2 E ) | ¤«¿ ¯«®²­»µ £° ´ µ ½²® ¡³¤¥² O(V 4 ). «£®°¨²¬», ®¯¨± ­­»¥ ­¨¦¥, ° ¡®² ¾² ¡»±²°¥¥. °®¬¥ ²®£®, ¢ ½²®© £« ¢¥ ¬» ³±² ­®¢¨¬ ±¢¿§¼ ¬¥¦¤³
§ ¤ ·¥© ® ­ µ®¦¤¥­¨¨ ª° ²· ©¸¨µ ¯³²¥© ¤«¿ ¢±¥µ ¯ ° ¢¥°¸¨­ £° ´  ¨ ³¬­®¦¥­¨¥¬ ¬ ²°¨¶,   ² ª¦¥ ¨±±«¥¤³¥¬ ¥¥  «£¥¡° ¨·¥±ª³¾
±²°³ª²³°³.
 ¡®«¼¸¨­±²¢¥  «£®°¨²¬®¢ ½²®© £« ¢» £° ´» ¯°¥¤±² ¢«¿¾²±¿
¬ ²°¨¶ ¬¨ ±¬¥¦­®±²¨. ±ª«¾·¥­¨¥¬ ¿¢«¿¥²±¿  «£®°¨²¬ ¦®­±®-

« ¢  26 ° ²· ©¸¨¥ ¯³²¨ ¤«¿ ¢±¥µ ¯ ° ¢¥°¸¨­

529

­  ¤«¿ ° §°¥¦¥­­»µ £° ´®¢, ª®²®°»© (ª ª ¨  «£®°¨²¬» ¯®¨±ª 
¨§ ®¤­®© ¢¥°¸¨­») ¨±¯®«¼§³¥² ±¯¨±ª¨ ±¬¥¦­®±²¨. ±²¥±²¢¥­­® ±®·¥² ²¼ ±¢¥¤¥­¨¿ ® ­ «¨·¨¨ °¥¡°  ¨ ® ¥£® ¢¥±¥ ¢ ®¤­®© ¬ ²°¨¶¥,
¯®« £ ¿ ¢¥±  ®²±³²±²¢³¾¹¨µ °¥¡¥° ¡¥±ª®­¥·­»¬¨.
 ª¨¬ ®¡° §®¬, ¯°¨ ®¡° ¡®²ª¥ ¢§¢¥¸¥­­®£® ®°¨¥­²¨°®¢ ­­®£®
£° ´  G = (V; E )  «£®°¨²¬³ ¤ ¥²±¿ ¬ ²°¨¶  W = (wij ), £¤¥
8
<

0
¥±«¨ i = j ,
wij = : ¢¥± (®°¨¥­²¨°®¢ ­­®£®) °¥¡°  (i; j ) ¥±«¨ i 6= j ¨ (i; j ) 2 E ,
1
¥±«¨ i 6= j ¨ (i; j ) 62 E .
(26:1)
¥¡°  ¬®£³² ¨¬¥²¼ ®²°¨¶ ²¥«¼­»© ¢¥±. » ¡³¤¥¬, ®¤­ ª®, ¯°¥¤¯®« £ ²¼, ·²® ¶¨ª«®¢ ®²°¨¶ ²¥«¼­®£® ¢¥±  ¢ £° ´¥ ­¥².
°¥¤±² ¢«¥­­»¥ ¢ ¤ ­­®© £« ¢¥  «£®°¨²¬» ­ µ®¦¤¥­¨¿ ª° ²· ©¸¨µ ¯³²¥© ¤«¿ ¢±¥µ ¯ ° ¢¥°¸¨­ ¡³¤³² ¢»·¨±«¿²¼ ¬ ²°¨¶³ D = (dij )
° §¬¥°®¬ n  n, ½«¥¬¥­² dij ª®²®°®© ±®¤¥°¦¨² ¢¥± ª° ²· ©¸¥£® ¯³²¨ ¨§ ¢¥°¸¨­» i ¢ ¢¥°¸¨­³ j , ²® ¥±²¼ ° ¢¥­  (i; j ) ¢ ®¡®§­ ·¥­¨¿µ
¯°¥¤»¤³¹¥© £« ¢».
¥¸¥­¨¥ § ¤ ·¨ ® ª° ²· ©¸¨µ ¯³²¿µ ¤«¿ ¢±¥µ ¯ ° ¢¥°¸¨­ ¤®«¦­® ¢ª«¾· ²¼ ¢ ±¥¡¿ ­¥ ²®«¼ª® ¢¥±  ª° ²· ©¸¨µ ¯³²¥©, ­® ¨ ¬ ²°¨¶³ ¯°¥¤¸¥±²¢®¢ ­¨¿ (predecessor matrix)  = (ij ), ¢ ª®²®°®© ij
¿¢«¿¥²±¿ ¢¥°¸¨­®©, ¯°¥¤¸¥±²¢³¾¹¥© j ­  ®¤­®¬ ¨§ ª° ²· ©¸¨µ
¯³²¥© ¨§ i ¢ j . (¬» ¯®« £ ¥¬ ij = nil, ¥±«¨ i = j ¨«¨ ¯³²¥© ¨§ i
¢ j ­¥ ±³¹¥±²¢³¥²). «¿ ª ¦¤®© ¢¥°¸¨­» i 2 V ¬®¦­® ®¯°¥¤¥«¨²¼
¯®¤£° ´ ¯°¥¤¸¥±²¢®¢ ­¨¿ (predecessor subgraph) G;i = (V;i; E;i),
£¤¥
V;i = fj 2 V : ij 6= nilg [ fig;
¨
E;i = f(ij ; j ) : j 2 V;i ¨ ij 6= nilg:
» ¡³¤¥¬ ²°¥¡®¢ ²¼, ·²®¡» ¤«¿ ª ¦¤®£® i ¯®¤£° ´ ¯°¥¤¸¥±²¢®¢ ­¨¿ G;i ¡»« ¤¥°¥¢®¬ ª° ²· ©¸¨µ ¯³²¥© ¨§ ¢¥°¸¨­» i (¢ ±¬»±«¥
£« ¢» 25).  ½²®¬ ±«³· ¥ ±«¥¤³¾¹ ¿ ¯°®¶¥¤³°  ¯¥· ² ¥² ª° ²· ©¸¨© ¯³²¼ ¨§ ¢¥°¸¨­» i ¢ ¢¥°¸¨­³ j .

{\sc Print-All-Pairs-Shortest-Path}$(\Pi,i,j)$\\
1 if $i=j$
2 then print $i$
3 else if $\pi_{ij}=\mbox{\sc nil}$
4
then print ``³²¨ ¨§'' $i$ ``¢'' $j$ ``­¥²''
5
else {\sc Print-All-Pairs-Shortest-Path}$(\Pi,i,\pi_{ij})$
6
print $j$

» ­¥ ¡³¤¥¬ ¯®¤°®¡­® £®¢®°¨²¼ ® ¯®±²°®¥­¨¨ ¬ ²°¨¶» ¯°¥¤¸¥±²¢®¢ ­¨¿ (¥¥ ±¢®©±²¢ ¬ ¯®±¢¿¹¥­® ­¥±ª®«¼ª® ³¯° ¦­¥­¨©).
« ­ £« ¢»

530

« ¢  26 ° ²· ©¸¨¥ ¯³²¨ ¤«¿ ¢±¥µ ¯ ° ¢¥°¸¨­

 ° §¤¥«¥ 26.1 ° ±±¬ ²°¨¢ ¥²±¿  «£®°¨²¬ °¥¸¥­¨¿ § ¤ ·¨ ®
ª° ²· ©¸¨µ ° ±±²®¿­¨¿µ ¤«¿ ¢±¥µ ¯ ° ¢¥°¸¨­, ¢ ®±­®¢¥ ª®²®°®£® «¥¦¨² ³¬­®¦¥­¨¥ ¬ ²°¨¶. °¥¬¿ ° ¡®²» ½²®£®  «£®°¨²¬  |
(V 3 lg V ); ®­ ¢»·¨±«¿¥² ±²¥¯¥­¼ ¬ ²°¨¶», ¬­®£®ª° ²­® ¢®§¢®¤¿
¥¥ ¢ ª¢ ¤° ².
®«¥¥ ¡»±²°»© (O(V 3 ))  «£®°¨²¬ «®©¤ {®°¸®«« , ² ª¦¥ ¨±¯®«¼§³¾¹¨© ²¥µ­¨ª³ ¤¨­ ¬¨·¥±ª®£® ¯°®£° ¬¬¨°®¢ ­¨¿, ¨§« £ ¥²±¿ ¢ ° §¤¥«¥ 26.2.  ½²®¬ ¦¥ ° §¤¥«¥ ° ±±¬ ²°¨¢ ¥²±¿ § ¤ ·  ®
²° ­§¨²¨¢­®¬ § ¬»ª ­¨¨ ®°¨¥­²¨°®¢ ­­®£® £° ´ , ª®²®° ¿ ®ª §»¢ ¥²±¿ ²¥±­® ±¢¿§ ­­®© ± § ¤ ·¥© ­ µ®¦¤¥­¨¿ ª° ²· ©¸¨µ ¯³²¥©
¤«¿ ¢±¥µ ¯ ° ¢¥°¸¨­.
 ° §¤¥«¥ 26.3 ¨§« £ ¥²±¿  «£®°¨²¬ ¦®­±®­ .  ®²«¨·¨¥ ®² ¤°³£¨µ  «£®°¨²¬®¢ ½²®© £« ¢», ®­ ¨±¯®«¼§³¥² ¢ ±¢®¥© ° ¡®²¥ ±¯¨±ª¨
±¬¥¦­»µ ¢¥°¸¨­,   ­¥ ¬ ²°¨¶³ ±¬¥¦­®±²¨. °¥¬¿ ° ¡®²» ½²®£®
 «£®°¨²¬  ¥±²¼ O(V 2 lg V + V E ); ² ª¨¬ ®¡° §®¬, ®­ ½´´¥ª²¨¢¥­
¤«¿ ° §°¥¦¥­­»µ £° ´®¢.
 ¯®±«¥¤­¥¬ ° §¤¥«¥ (26.4) ¬» ¨±±«¥¤³¥¬  «£¥¡° ¨·¥±ª³¾ ±²°³ª²³°³ (§ ¬ª­³²®¥ ¯®«³ª®«¼¶®), ¯®§¢®«¿¾¹³¾ ¯°¨¬¥­¨²¼  «£®°¨²¬»
­ µ®¦¤¥­¨¿ ª° ²· ©¸¨µ ¯³²¥© ¤«¿ °¥¸¥­¨¿ ¤°³£¨µ § ¤ · ± £° ´ ¬¨, ¢ ª®²®°»µ ² ª¦¥ ²°¥¡³¥²±¿ ®¯°¥¤¥«¨²¼ ·²®-«¨¡® ¤«¿ ¢±¥µ ¯ °
¢¥°¸¨­.
±¾¤³ ¢ ½²®© £« ¢¥ ¬» ° ±±¬ ²°¨¢ ¥¬ £° ´ G = (V; E ) ± n ,
¢¥°¸¨­ ¬¨, ² ª ·²® jV j = n. » ¡³¤¥¬ ®¡®§­ · ²¼ ¬ ²°¨¶» ¡®«¼¸¨¬¨ ¡³ª¢ ¬¨ (­ ¯°¨¬¥°, W ¨«¨ D)   ®²¤¥«¼­»¥ ½«¥¬¥­²» ¬ ²°¨¶ ±®®²¢¥²±²¢³¾¹¨¬¨ ¬ «¥­¼ª¨¬¨ ¡³ª¢ ¬¨ (wij ; dij ). °®¬¥ ²®£®, ¬» ¡³¤¥¬ ¨±¯®«¼§®¢ ²¼ ¢¥°µ­¨© ¨­¤¥ª± ¢ ±ª®¡ª µ (­ ¯°®¤®¡¨¥
D(m) = (d(ijm))), °®«¼ ª®²®°®£® ¡³¤¥²  ­ «®£¨·­  ±²¥¯¥­¨ ¬ ²°¨¶»
(±¬. ­¨¦¥).  ª®­¥¶, ° §¬¥° n ª¢ ¤° ²­®© n  n-¬ ²°¨¶» A ¬»
¡³¤¥¬ ¨­®£¤  § ¯¨±»¢ ²¼ ª ª rows[A] (rows | ±²°®ª¨).
26.1 ° ²· ©¸¨¥ ¯³²¨ ¨ ³¬­®¦¥­¨¥ ¬ ²°¨¶
 ½²®¬ ° §¤¥«¥ ¬» ° ±±¬®²°¨¬  «£®°¨²¬ ¤¨­ ¬¨·¥±ª®£® ¯°®£° ¬¬¨°®¢ ­¨¿ °¥¸¥­¨¿ § ¤ ·¨ ­ µ®¦¤¥­¨¿ ª° ²· ©¸¨µ ¯³²¥©
¤«¿ ¢±¥µ ¯ ° ¢¥°¸¨­ ®°¨¥­²¨°®¢ ­­®£® £° ´  G = (V; E ).   ª ¦¤®¬ ¸ £¥ ®­ ¡³¤¥² ¯®·²¨ ·²® ³¬­®¦ ²¼ ¬ ²°¨¶» | ²®«¼ª® ­¥
¢¯®«­¥ ®¡»·­»¬ ®¡° §®¬. ­ · «  ¬» ¯®±²°®¨¬  «£®°¨²¬ ±® ±«®¦­®±²¼¾ (¢°¥¬¥­¥¬ ° ¡®²») (V 4 ),   § ²¥¬ ³«³·¸¨¬ ¥£®, ¯®«³·¨¢
®¶¥­ª³ (V 3 lg V ).  ¸¥ ¨§«®¦¥­¨¥ ¡³¤¥² ±«¥¤®¢ ²¼ ±µ¥¬¥  «£®°¨²¬  ¤¨­ ¬¨·¥±ª®£® ¯°®£° ¬¬¨°®¢ ­¨¿ (£« ¢  16)
²°³ª²³°  ª° ²· ©¸¥£® ¯³²¨
¡¥¤¨¬±¿, ·²® · ±²¨ °¥¸¥­¨¿ ¿¢«¿¾¥²±¿ °¥¸¥­¨¿¬¨  ­ «®£¨·­»µ ¯®¤§ ¤ ·.  ­ ¸¥¬ ±«³· ¥ ½²® ®§­ · ¥², ·²® ®²°¥§ª¨ ª° ²· ©¸¥£® ¯³²¨ ± ¬¨ ¿¢«¿¾²±¿ ª° ²· ©¸¨¬¨ ¯³²¿¬¨ ¬¥¦¤³ ±®®²¢¥²±²¢³¾¹¨¬¨ ¢¥°¸¨­ ¬¨ («¥¬¬  25.1).
¥ª³°±¨¢­ ¿ ´®°¬³«  ¤«¿ ¤«¨­» ª° ²· ©¸¥£® ¯³²¨
³±²¼ d(ijm) ®¡®§­ · ¥² ¬¨­¨¬ «¼­»© ¢¥± ¯³²¨ ¨§ ¢¥°¸¨­» i ¢

« ¢  26 ° ²· ©¸¨¥ ¯³²¨ ¤«¿ ¢±¥µ ¯ ° ¢¥°¸¨­

531

¢¥°¸¨­³ j , ¥±«¨ ° ±±¬ ²°¨¢ ²¼ ¯³²¨ ± ­¥ ¡®«¥¥ ·¥¬ m °¥¡° ¬¨.
°¨ m = 0 ¤®¯³±²¨¬» «¨¸¼ À¯³²¨Á ¢®¢±¥ ¡¥§ °¥¡¥°, ²® ¥±²¼

i = j,
(0)
dij = 01 ¥±«¨
¥±«¨ i 6= j .
±«¨ ¦¥ m > 1, ²® ¬¨­¨¬³¬ d(ijm) ¤®±²¨£ ¥²±¿ «¨¡® ­  ¯³²¨ ¨§ ­¥
¡®«¥¥ ·¥¬ m ; 1 °¥¡°  (¨ ²®£¤  ° ¢¥­ d(ijm;1) ), «¨¡® ¦¥ ­  ¯³²¨ ¨§
m °¥¡¥°.  ¯®±«¥¤­¥¬ ±«³· ¥ ½²®² ¯³²¼ ¬®¦­® ° §¡¨²¼ ­  ­ · «¼­»© ®²°¥§®ª ¨§ m ; 1 °¥¡¥°, ¢¥¤³¹¨© ¨§ ­ · «¼­®© ¢¥°¸¨­» i ¢
­¥ª®²®°³¾ ¢¥°¸¨­³ k, ¨ ­  ¯®±«¥¤­¥¥ °¥¡°® (k; j ). » ¯°¨µ®¤¨¬ ª
´®°¬³«¥
(m;1) + w g) =
d(ijm) = min(d(ijm;1); 1min
f
d
kj
6k6n ik
(m;1)
= 1min
6k6nfdik + wkj g

(®±«¥¤­¥¥ ° ¢¥­±²¢® ¨±¯®«¼§³¥² ° ¢¥­±²¢® wjj = 0.)
±«¨ £° ´ ­¥ ±®¤¥°¦¨² ¶¨ª«®¢ ± ®²°¨¶ ²¥«¼­»¬¨ ¢¥± ¬¨, ª° ²· ©¸¨© ¯³²¼ ¬®¦­® ¢»¡° ²¼ ¡¥§ ¶¨ª«®¢; ² ª®© ¯³²¼ ±®¤¥°¦¨² ­¥
¡®«¥¥ n ; 1 °¥¡¥°. «¥¤®¢ ²¥«¼­®,

(i; j ) = d(ijn;1) = d(ijn) = d(ijn+1) =   :

(26:3)

»·¨±«¥­¨¥ ª° ²· ©¸¨µ ¯³²¥© À±­¨§³ ¢¢¥°µÁ
® § ¤ ­­®© ¬ ²°¨¶¥ ¢¥±®¢ W = (wij ) ¬» ¡³¤¥¬ ¯®±«¥¤®¢ ²¥«¼­®
¢»·¨±«¿²¼ ¬ ²°¨¶» D(1); D(2); : : : ; D(n;1), £¤¥ D(m) = (d(ijm)).  ª
¬» ¢¨¤¥«¨, ¯®±«¥¤­¿¿ ¬ ²°¨¶  D(n;1) ¡³¤¥² ±®¤¥°¦ ²¼ ¢¥±  ª° ²· ©¸¨µ ¯³²¥©.  ¬¥²¨¬, ·²® ¬ ²°¨¶  D(1) (¢¥±  ¯³²¥© ¨§ ®¤­®£®
°¥¡° ) ±®¢¯ ¤ ¥² ± W .
 £  «£®°¨²¬  ±®±²®¨² ¢ ¢»·¨±«¥­¨¨ D(m) ¯® D(m;1) ¨ W .

{\sc Extend-Shortest-Paths}$(D,W)$\\
\verb|1 |$n \leftarrow rows[D]$\\
\verb|2 |¯³±²¼ $D'=(d'_{ij})$ --- $n\times n$-¬ ²°¨¶ 
\verb|3 |for $i \leftarrow 1$ to $n$\\
\verb|4
|do for $j \leftarrow 1$ to $n$\\
\verb|5
|do $d'_{ij} \leftarrow \infty$\\
\verb|6
|for $k \leftarrow 1$ to $n$\\
\verb|7
|do $d'_{ij} \leftarrow \min(d'_{ij},\,d_{ik}+w_{k
\verb|8 |return $D'$\\

²  ¯°®¶¥¤³°  ¢»·¨±«¿¥² ¬ ²°¨¶³ D0 ¢ ±®®²¢¥²±²¢¨¨ ± ´®°¬³«®© (26.2) ¯°¨ ½²®¬ °®«¼ ¬ ²°¨¶ D ¨ D0 ¨£° ¾² ¬ ²°¨¶» D(m;1 )
¨ D(m) . °®¶¥¤³°  ±®¤¥°¦¨² ²°¨ ¢«®¦¥­­»µ ¶¨ª« , ² ª ·²® ¢°¥¬¿
¥¥ ° ¡®²» ¥±²¼ (n3 ).

532

« ¢  26 ° ²· ©¸¨¥ ¯³²¨ ¤«¿ ¢±¥µ ¯ ° ¢¥°¸¨­

²®¡» ³¢¨¤¥²¼  ­ «®£¨¾ ½²®© ¯°®¶¥¤³°» ± ¯°®¶¥±±®¬ ³¬­®¦¥­¨¿ ¬ ²°¨¶, § ¯¨¸¥¬ ¯°®¶¥¤³°³ ³¬­®¦¥­¨¿ ¬ ²°¨¶ A ¨ B ° §¬¥°®¬ n  n ¯® ´®°¬³«¥

cij =

n
X
k=1

aik  bkj

(26:4)

{\sc Matrix-Multiply}$(A,B)$\\
\verb|1 |$n \leftarrow rows[A]$\\
\verb|2 |¯³±²¼ $C=(c_{ij})$ --- $n\times n$-¬ ²°¨¶ 
\verb|3 |for $i \leftarrow 1$ to $n$\\
\verb|4
|do for $j \leftarrow 1$ to $n$\\
\verb|5
|do $c_{ij} \leftarrow 0$\\
\verb|6
|for $k \leftarrow 1$ to $n$\\
\verb|7
|do $c_{ij} \leftarrow c_{ij}+a_{ik}\cdot
b_{kj}$\\
\verb|8 |return $C$

¨¤­®, ·²® ½²  ¯°®¶¥¤³°  ¯®«³· ¥²±¿ ¨§ ¯°¥¤»¤³¹¥© § ¬¥­ ¬¨

d(m;1) ! a;
w ! b;
d(m) ! c;
min ! +;
+ ! 
°¨ ½²®¬ ±¨¬¢®«³ 1, ¿¢«¿¾¹¥¬³±¿ ­¥©²° «¼­»¬ ½«¥¬¥­²®¬ ¤«¿
®¯¥° ¶¨¨ min (¢ ²®¬ ±¬»±«¥, ·²® min(1; a) = a, ±®®²¢¥²±²¢³¥²
·¨±«® 0, ¿¢«¿¾¹¥¥±¿ ­¥©²° «¼­»¬ ½«¥¬¥­²®¢ ¤«¿ ®¯¥° ¶¨¨ + (0 +
a = a).
 ²®·ª¨ §°¥­¨¿ ½²®©  ­ «®£¨¨, ¬» ª ª ¡» ¢»·¨±«¿¥¬ À¯°®¨§¢¥¤¥­¨¥Á n ; 1 ½ª§¥¬¯«¿°®¢ ¬ ²°¨¶» W ± ¯®¬®¹¼¾ ¯®±«¥¤®¢ ²¥«¼­»µ
³¬­®¦¥­¨©:

D(1)
D(2)
D(3)
D(n;1)

= D(0)  W
= D(1)  W
= D(2)  W
..
.
= D(n;2)  W

= W,
= W 2,
= W 3,
= W n;1 .

¥§³«¼² ² ½²¨µ À³¬­®¦¥­¨©Á, ¬ ²°¨¶  D(n;1) = W n;1 ±®¤¥°¦¨²
¢¥±  ª° ²· ©¸¨µ ¯³²¥©. ´®°¬¨¬ ®¯¨± ­­®¥ ¢»·¨±«¥­¨¥ ¢ ¢¨¤¥
¯°®¶¥¤³°» (± ¢°¥¬¥­¥¬ ° ¡®²» (n4 )):
{\sc Slow-All-Paths-Shortest-Paths}$(W)$\\
\verb|1 |$n \leftarrow rows[W]$\\

« ¢  26 ° ²· ©¸¨¥ ¯³²¨ ¤«¿ ¢±¥µ ¯ ° ¢¥°¸¨­
0

3 8 1
B 1 0 1 1
B
D(1) = B
0 1
B 1 4
@ 2 1 ;5 0
01 1 1 6
0 3 ;3 2
B 3 0 ;4 1
B
0 5
D(3) = B
B 7 4
@ 2 ;1 ;5 0
8 5 1 6
0

;4
7

1
1

0
;4
;1
11
;2
0

1
C
C
C
C
A
1
C
C
C
C
A

0

533

0
3

3
B
0
B
D(2) = B
1
4
B
@ 2 ;1
0 8 1
0 1
B 3 0
B
D(4) = B
B 7 4
@ 2 ;1
8 5

8
;4
0
;5
1
;3
;4
0
;5
1

2
1
5
0
6
2
1
5
0
6

;4

1

7 C
C
11 C
C
;2 A
0 1
;4
;1 C
C
3 C
C
;2 A
0

(m)
¨±. 26.1 26.1 °¨¥­²¨°®¢ ­­»© £° ´ G ¨ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¬ ²°¨¶ D
.
®¦­® ³¡¥¤¨²¼±¿, ·²® ¬ ²°¨¶  D(5) = D(4)  W (  §­ ·¨², ¨ ¢±¥ ¯®±«¥¤³¾¹¨¥)
¡³¤¥² ° ¢­  D(4) .

\verb|2 |$D^{(1)} \leftarrow W$\\
\verb|3 |for $m \leftarrow 2$ to $n-1$\\
\verb|4
|do $D^{(m)} \leftarrow \mbox{\sc Extend-Shortest-Paths}(D^{(m-1
)$\\
\verb|5 |return $D^{(n-1)}$\\

  °¨±. 26.1 ¯®ª § ­ ¯°¨¬¥° £° ´  ¨ ±®®²¢¥²±²¢³¾¹¨µ ¥¬³ ¬ ²°¨¶ D(m) .
®«¥¥ ¡»±²°»© ±¯®±®¡
 ¬¥²¨¬, ·²® ¬» ¢»·¨±«¿¥¬ ¢±¥ ¬ ²°¨¶» D(m), µ®²¿ ­ ± ¨­²¥°¥±³¥² «¨¸¼ ¬ ²°¨¶  D(n;1) ¨«¨ «¾¡ ¿ ¨§ ±«¥¤³¾¹¨µ §  ­¥© (¯°¨
®²±³²±²¢¨¨ ¶¨ª«®¢ ± ®²°¨¶ ²¥«¼­»¬¨ ¢¥± ¬¨ ¢±¥ ®­¨ ° ¢­»). °®¤®«¦¨¬  ­ «®£¨¾ ± ³¬­®¦¥­¨¥¬: ±²¥¯¥­¼ ·¨±«  a ¬®¦­® ¢»·¨±«¨²¼
¡»±²°¥¥, ¥±«¨ ­¥ ¤®¬­®¦ ²¼ ¢±¥ ¢°¥¬¿ ­  a,   ¢®§¢®¤¨²¼ ¢ ª¢ ¤° ²
(² ª®© ¬¥²®¤ § ¢¥¤®¬® ¯°¨¬¥­¨¬, ¥±«¨ ¯®ª § ²¥«¼ ±²¥¯¥­¨ ¥±²¼
2; 4; 8; : : : ).
­ «®£¨·­»¬ ®¡° §®¬ ¬» ¬» ¬®¦¥¬ ®¯°¥¤¥«¨²¼ D(n;1) , ¢»¯®«­¨¢ ¢±¥£® dlg(n ; 1)e ³¬­®¦¥­¨© ¬ ²°¨¶, ¢»·¨±«¿¿ ¬ ²°¨¶» ¢ ¯®±«¥¤®¢ ²¥«¼­®±²¨
D(1)
= W
(2)
D
= W2
= W  W,
(4)
D
= W4
= W 2  W 2,
D(8)
= W8
= W 4  W 4,
²® ²¥µ ¯®°, ¯®ª  ¯®ª § ²¥«¼ ±²¥¯¥­¨ ±² ­¥² ¡®«¼¸¨¬ ¨«¨ ° ¢­»¬

n ; 1 (¯°¨ ½²®¬ ®­ ¡³¤¥² ° ¢¥­ 2dlg(n;1)e, ª ª «¥£ª® ¢¨¤¥²¼).

¥ «¨§³¥¬ ½²®² ¬¥²®¤ ¯®¢²®°­®£® ¢®§¢¥¤¥­¨¿ ¢ ª¢ ¤° ² (repeated squaring) ¢ ¢¨¤¥ ¯°®¶¥¤³°»:
{\sc Faster-All-Pairs-Shortest-Paths}$(W)$\\

534

« ¢  26 ° ²· ©¸¨¥ ¯³²¨ ¤«¿ ¢±¥µ ¯ ° ¢¥°¸¨­

26.2 §¢¥¸¥­­»© ®°¨¥­²¨°®¢ ­­»© £° ´, ¨±¯®«¼§³¥¬»© ¢ ³¯°. 26.11, 26.2-1 ¨ 26.3-1.
¨±. 26.2

\verb|1 |$n \leftarrow rows[W]$\\
\verb|2 |$D^{(1)} \leftarrow W$\\
\verb|3 |$m \leftarrow 1$\\
\verb|4 |while $n-1 > m$\\
\verb|5
|do $D^{(2m)} \leftarrow \mbox{\sc Extend-Shortest-Paths}(D^{(
D^{(m)})$\\
\verb|6
|$m \leftarrow 2m$\\
\verb|7 |return $D^{(m)}$

  ª ¦¤®¬ ¸ £¥ ¶¨ª«  while ¢ ±²°®ª µ 4-6 ¢»·¨±«¿¥²±¿ D(2m) =
(D(m))2 ¨ §­ ·¥­¨¥ m ³¤¢ ¨¢ ¥²±¿, ¯®ª  m ­¥ ±² ­¥² ¡®«¼¸¨¬ ¨«¨
° ¢­»¬ n ; 1.
°¥¬¿ ° ¡®²» ² ª®© ¯°®¶¥¤³°» ±®±² ¢«¿¥² (n3 lg n), ².ª. ¢±¥£®
¢»¯®«­¿¥²±¿ dlg(n ; 1)e À³¬­®¦¥­¨©Á ¬ ²°¨¶, ª ¦¤®¥ ¨§ ª®²®°»µ
²°¥¡³¥² (n3 ) ¤¥©±²¢¨©. «£®°¨²¬ ¤®¢®«¼­® ¯°®±², ¨ ¬®¦­® ­ ¤¥¿²¼±¿, ·²® ª®­±² ­² , ±ª°»² ¿ ¢ -®¡®§­ ·¥­¨, ¡³¤¥² ­¥¡®«¼¸®©.
[ ¬¥²¨¬, ·²® ¬» ­¥¿¢­® ¨±¯®«¼§®¢ «¨  ±±®¶¨ ²¨¢­®±²¼ ­ ¸¥£® À³¬­®¦¥­¨¿Á ¬ ²°¨¶, ¯¥°¥µ®¤¿ ª ¤°³£®¬³ ±¯®±®¡³ ¢»·¨±«¥­¨¿
±²¥¯¥­¥©. ¥ ¬®¦­® ¯°®¢¥°¨²¼ ¯®  ­ «®£¨¨ ± ¤®ª § ²¥«¼±²¢®¬  ±±®¶¨ ²¨¢­®±²¨ ¤«¿ ®¡»·­®£® ³¬­®¦¥­¨¿ | «¨¡® § ¬¥­¨²¼ ±±»«ª³
­   ±±®¶¨ ²¨¢­®±²¼ ¯°¿¬»¬ ¤®ª § ²¥«¼±²¢®¬ ²®£®, ·²® D(2m) ¥±²¼
¯°®¨§¢¥¤¥­¨¥ D(m) ­  D(m) , ª®²®°®¥ «¥£ª® ¯°®¢¥±²¨, ° ±±¬ ²°¨¢ ¿
¤¢¥ ¯®«®¢¨­» ¯³²¨ ¤«¨­» 2m.]
¯° ¦­¥­¨¿
26.1-1 °®±«¥¤¨²¥ §  ¨±¯®«­¥­¨¥¬  «£®°¨²¬®¢ Slow-All-PairsShortest-Paths ¨ Faster-All-Pairs-Shortest-Paths ­  £° ´¥
°¨±. 26.2. »·¨±«¨²¥ ¢±¥ ¢®§­¨ª ¾¹¨¥ ¯°¨ ½²®¬ ¬ ²°¨¶».
26.1-2 ¤¥ ¨±¯®«¼§³¥²±¿, ·²® wii = 0 ¯°¨ ¢±¥µ i?
26.1-3 ²® ±®®²¢¥²±²¢³¥² ¬ ²°¨¶¥
0
1
0 1 1 ::: 1
B 1 0 1 ::: 1 C
B
C
C
D(0) = B
B 1 1 0 ::: 1 C
B ..
.. .. . . . .. C
@ .
. .
. A
1 1 1 ::: 0
¥±«¨ ¯°®¤®«¦¨²¼  ­ «®£¨¾ ± ®¡»·­»¬ ³¬­®¦¥­¨¥¬ ¬ ²°¨¶?
26.1-4 °¥¤±² ¢¼²¥ § ¤ ·³ ¯®¨±ª  ª° ²· ©¸¨µ ¯³²¥© ¨§ ®¤­®©
¢¥°¸¨­» ª ª § ¤ ·³ ®²»±ª ­¨¿ ¯°®¨§¢¥¤¥­¨© ¨ ¢¥ª²®° .  ª ¢
½²¨µ ²¥°¬¨­ µ ¢»£«¿¤¨²  «£®°¨²¬ ¥««¬ ­ -®°¤  (±¬. ° §¤¥«
25.3)?
26.1-5 °¨¤³¬ ©²¥  «£®°¨²¬ ¢»·¨±«¥­¨¿ ¬ ²°¨¶» ¯°¥¤¸¥±²¢®¢ ­¨¿  ¯® ³¦¥ ¨¬¥¾¹¥©±¿ ¬ ²°¨¶¥ D ¢¥±®¢ ª° ²· ©¸¨µ ¯³²¥© § 

«£®°¨²¬ «®©¤ -®°¸®«« 

535

¢°¥¬¿ O(n3).
26.1-6  ¤°³£®© ±²®°®­», ¬ ²°¨¶» ¯°¥¤¸¥±²¢®¢ ­¨¿ ¬®£³² ¢»·¨±«¿²¼±¿ ¯ ° ««¥«¼­® ± ¢»·¨±«¥­¨¥¬ ¢¥±®¢. ³¤¥¬ ¡° ²¼ ¢ ª ·¥±²¢¥ ij(m) ¯°¥¤¸¥±²¢³¾¹³¾ j ¢¥°¸¨­³ ­  ª ª®¬-­¨¡³¤¼ ª° ²· ©¸¥¬ ¯³²¨ ¨§ i ¢ j , ±®±²®¿¹¥¬ ­¥ ¡®«¥¥ ·¥¬ ¨§ m °¥¡¥°. §¬¥­¨²¥ ¯°®¶¥¤³°» Extend-Shortest-Paths ¨ Slow-All-PairsShortest-Paths ² ª, ·²®¡» ®­¨ ¢ ¤®¯®«­¥­¨¥ ª D(1), D(2) , : : : ,
D(n;1) ¢»·¨±«¿«¨ ¥¹¥ ¨ ¬ ²°¨¶» (1), (2), : : : , (n;1) .
26.1-7 °®¶¥¤³°  Faster-All-Pairs-Shortest-Paths (¢ ¥¥ ­»­¥¸­¥¬ ¢¨¤¥) ¨±¯®«¼§³¥² dlg(n ; 1)e ¬ ²°¨¶ (¬ ±±¨¢®¢) ° §¬¥°®¬
n  n. ¡¹¨© ®¡º¥¬ ¯ ¬¿²¨, ² ª¨¬ ®¡° §®¬, ±®±² ¢«¿¥² (n2 lg n).
§¬¥­¨²¥ ¥¥ ² ª, ·²®¡» ¨±¯®«¼§®¢ ²¼ ¢±¥£® ¤¢  ¬ ±±¨¢  ° §¬¥°®¬
n  n (²¥¬ ± ¬»¬ ³¬¥­¼¸¨¢ ®¡º¥¬ ¯ ¬¿²¨ ¤® (n2)).
26.7-8 §¬¥­¨²¥  «£®°¨²¬ Faster-All-Pairs-Shortest-Paths
² ª, ·²®¡» ®­ ®¡­ °³¦¨¢ « ­ «¨·¨¥ ¢ £° ´¥ ¶¨ª«  ± ®²°¨¶ ²¥«¼­»¬ ¢¥±®¬.
26.1-9 °¨¤³¬ ©²¥ ½´´¥ª²¨¢­»©  «£®°¨²¬ ®¯°¥¤¥«¥­¨¿ ¬¨­¨¬ «¼­®£® ·¨±«  °¥¡¥° ¢ ¶¨ª«¥ ®²°¨¶ ²¥«¼­®£® ¢¥±  (¤«¿ ¤ ­­®£®
£° ´ ; ¯°¥¤¯®« £ ¥²±¿, ·²® ² ª®© ¶¨ª« ±³¹¥±²¢³¥²).

26.1. «£®°¨²¬ «®©¤ -®°¸®«« 
 ½²®¬ ° §¤¥«¥ ¬» ° ±±¬®²°¨¬ ¤°³£®© ±¯®±®¡ °¥¸¥­¨¿ § ¤ ·¨
® ª° ²· ©¸¨µ ¯³²¿µ ¤«¿ ¢±¥µ ¯ ° ¢¥°¸¨­ ®°¨¥­²¨°®¢ ­­®£® ¢§¢¥¸¥­­®£® £° ´ , ² ª¦¥ ®±­®¢ ­­»© ­  ²¥µ­¨ª¥ ¤¨­ ¬¨·¥±ª®£® ¯°®£° ¬¬¨°®¢ ­¨¿. ²®² ±¯®±®¡ ( «£®°¨²¬ «®©¤ {®°¸®«« ) ° ¡®² ¥² §  ¢°¥¬¿ (V 3 ). » ¯®-¯°¥¦­¥¬³ ¤®¯³±ª ¥¬ °¥¡°  ± ®²°¨¶ ²¥«¼­»¬ ¢¥±®¬, ­® § ¯°¥¹ ¥¬ ¶¨ª«» ®²°¨¶ ²¥«¼­®£® ¢¥± .
°®¬¥ ²®£®, ¬» ° ±±¬®²°¨¬  «£®°¨²¬ ­ µ®¦¤¥­¨¿ ²° ­§¨²¨¢­®£® § ¬»ª ­¨¿ £° ´ , ®±­®¢ ­­»© ­  ²®© ¦¥ ¨¤¥¥.
²°®¥­¨¥ ª° ²· ©¸¥£® ¯³²¨
«£®°¨²¬» ¯°¥¤»¤³¹¥£® ° §¤¥«  ¢»¤¥«¿«¨ ¯®±«¥¤­¥¥ °¥¡°® ¯³²¨. «£®°¨²¬ «®©¤ {®°¸ ««  ¤¥©±²¢³¥² ¨­ ·¥: ¤«¿ ­¥£® ¢ ¦­®,
ª ª¨¥ ¢¥°¸¨­» ¨±¯®«¼§³¾²±¿ ¢ ª ·¥±²¢¥ ¯°®¬¥¦³²®·­»µ, ¨ ®±®¡³¾
°®«¼ ¨£° ¾² ¯°®¬¥¦³²®·­»¥ ¢¥°¸¨­» ± ¬ ª±¨¬ «¼­»¬ ­®¬¥°®¬
(¢ ­¥ª®²®°®© ­³¬¥° ¶¨¨ ¢¥°¸¨­). °®¬¥¦³²®·­®© (intermediate)
¢¥°¸¨­®© ¯°®±²®£® ¯³²¨ p = hv1 ; v2; : : : vl i ¡³¤¥¬ ­ §»¢ ²¼ «¾¡³¾
¨§ ¢¥°¸¨­ v2 ; v3; : : : ; vl;1.
³¤¥¬ ±·¨² ²¼, ·²® ¢¥°¸¨­ ¬¨ £° ´  G ¿¢«¿¾²±¿ ·¨±« 
1; 2; : : : ; n.  ±±¬®²°¨¬ ¯°®¨§¢®«¼­®¥ k 6 n. «¿ ¤ ­­®© ¯ °»
¢¥°¸¨­ i; j 2 V ° ±±¬®²°¨¬ ¢±¥ ¯³²¨ ¨§ i ¢ j , ³ ª®²®°»µ ¢±¥
¯°®¬¥¦³²®·­»¥ ¢¥°¸¨­» ¯°¨­ ¤«¥¦ ² ¬­®¦¥±²¢³ f1; 2; : : : ; kg.
³±²¼ p | ¯³²¼ ¬¨­¨¬ «¼­®£® ¢¥±  ±°¥¤¨ ¢±¥µ ² ª¨µ ¯³²¥©. ­
¡³¤¥² ¯°®±²»¬, ² ª ª ª ¢ £° ´¥ ­¥² ¶¨ª«®¢ ± ®²°¨¶ ²¥«¼­»¬

536

« ¢  26 ° ²· ©¸¨¥ ¯³²¨ ¤«¿ ¢±¥µ ¯ ° ¢¥°¸¨­

¢¥±®¬.  ª ­ ©²¨ ¢¥± ½²®£® ¯³²¨, §­ ¿ ¢¥±  ¢±¥µ ² ª¨µ ¯³²¥© (¤«¿
¢±¥µ ¯ ° ¢¥°¸¨­) ¤«¿ ¬¥­¼¸¨µ k?
«¿ ¯³²¨ p ¥±²¼ ¤¢¥ ¢®§¬®¦­®±²¨.
±«¨ k ­¥ ¢µ®¤¨² ¢ p, ¢±¥ ¯°®¬¥¦³²®·­»¥ ¢¥°¸¨­» ¯³²¨ p ±®¤¥°¦ ²±¿ ¢ ¬­®¦¥±²¢¥ f1; 2; : : : ; k ; 1g. ®£¤  ¯³²¼ p ¿¢«¿¥²±¿ ª° ²· ©¸¨¬ ¯³²¥¬ ¨§ i ¢ j , ¯°®¬¥¦³²®·­»¥ ¢¥°¸¨­» ª®²®°®£® ¯°¨­ ¤«¥¦ ² ¬­®¦¥±²¢³ f1; 2; : : : ; k ; 1g.
±«¨ k ¿¢«¿¥²±¿ ¯°®¬¥¦³²®·­®© ¢¥°¸¨­®© ¯³²¨ p, ®­  ° §¡¨¢ ¥²
¥£® ­  ¤¢  ³· ±²ª  p1 ¨ p2 (¢¥°¸¨­  k ¢±²°¥· ¥²±¿ «¨¸¼ ®¤­ ¦¤»,
² ª ª ª p | ¯°®±²®© ¯³²¼), ±¬. °¨±. 26.3. ® «¥¬¬¥ 25.1 ¯³²¼ p1
¡³¤¥² ª° ²· ©¸¨¬ ¯³²¥¬ ¨§ i ¢ k ± ¯°®¬¥¦³²®·­»¬¨ ¢¥°¸¨­ ¬¨ ¨§
¬­®¦¥±²¢  f1; 2; : : : ; k ; 1g. ³²¼ p2 ¿¢«¿¥²±¿ ª° ²· ©¸¨¬ ¯³²¥¬ ¨§
k ¢ j ± ¯°®¬¥¦³²®·­»¬¨ ¢¥°¸¨­ ¬¨ ¨§ ¬­®¦¥±²¢  f1; 2; : : : ; k ; 1g.
¥ª³°¥­²­ ¿ ´®°¬³«  ¤«¿ ¤«¨­ ª° ²· ©¸¨µ ¯³²¥©
²¨ ° ±±³¦¤¥­¨¿ ¯®§¢®«¿¾² ­ ¯¨± ²¼ ¤°³£³¾ (¯® ±° ¢­¥­¨¾ ±
¯°¨¢¥¤¥­­®© ¢ ° §¤¥«¥ 26.1) °¥ª³°¥­²­³¾ ´®°¬³«³ ¤«¿ ¤«¨­ ª° ²· ©¸¨µ ¯³²¥©. ¡®§­ ·¨¬ ·¥°¥§ d(ijk) ¢¥± ª° ²· ©¸¥£® ¯³²¨ ¨§ ¢¥°¸¨­» i ¢ ¢¥°¸¨­³ j ± ¯°®¬¥¦³²®·­»¬¨ ¢¥°¸¨­ ¬¨ ¨§ ¬­®¦¥±²¢ 
f1; 2; : : : ; kg. °¨ k = 0 ¯°®¬¥¦³²®·­»µ ¢¥°¸¨­ ­¥² ¢®¢±¥, ¯®½²®¬³
d(0)
ij = wij .  ®¡¹¥¬ ±«³· ¥

d(ijk) =

(

wij

min(d(ijk;1); d(ikk;1) + d(kjk;1) )

¥±«¨ k = 0,
¥±«¨ k > 1.

(26:5)

 ²°¨¶  D(n) = (d(ijn)) ±®¤¥°¦¨² ¨±ª®¬®¥ °¥¸¥­¨¥. °³£¨¬¨ ±«®¢ ¬¨, d(ijn) =  (i; j ) ¤«¿ ¢±¥µ i; j 2 V , ¯®±ª®«¼ª³ ° §°¥¸¥­» «¾¡»¥
¯°®¬¥¦³²®·­»¥ ¢¥°¸¨­».
»·¨±«¥­¨¥ ª° ²· ©¸¨µ ¯³²¥© ±­¨§³ ¢¢¥°µ
 ¯¨¸¥¬ ¯°®¶¥¤³°³, ª®²®° ¿ ¢»·¨±«¿¥² ¢¥±  ª° ²· ©¸¨µ ¯³²¥©,
¯®±«¥¤®¢ ²¥«¼­® ­ µ®¤¿ §­ ·¥­¨¿ d(ijk) ¤«¿ k = 1; 2; : : : ; n. ¥ ¢µ®¤¬
¿¢«¿¥²±¿ ¬ ²°¨¶  W ° §¬¥°®¬ n  n (¢¥±  °¥¡¥° £° ´ ), °¥§³«¼² ²®¬ ¿¢«¿¥²±¿ ¬ ²°¨¶  D(n) ¢¥±®¢ ª° ²· ©¸¨µ ¯³²¥©.
{\sc Floyd-Warshall}$(W)$\\
\verb|1 |$n \leftarrow rows[W]$\\
\verb|2 |$D^{(0)} \leftarrow W$\\
\verb|3 |for $k \leftarrow 1$ to $n$\\
\verb|4
|do for $i \leftarrow 1$ to $n$\\
\verb|5
|do for $j \leftarrow 1$ to $n$\\
\verb|6
|$d^{(k)}_{ij} \leftarrow \min(d^{(k-1)}_{ij},
d^{(k-1)}_{ik}+d^{(k-1)}_{kj})$\\
\verb|7 |return $D^{(n)}$

  °¨±³­ª¥ 26.4 ¯®ª § ­ ®°¨¥­²¨°®¢ ­­»© ° ´ ¨ ¬ ²°¨¶» D(k) ,
¢»·¨±«¿¥¬»¥ ½²¨¬  «£®°¨²¬®¬.

«£®°¨²¬ «®©¤ -®°¸®«« 

0

3 8 1
B 1 0 1 1
B
0 1
D(0) = B
B 1 4
@ 2 1 ;5 0
0 1 1 1 6
0 3 8 1
B 1 0 1 1
B
D(1) = B
0 1
B 1 4
@ 2
5 ;5 0
1 1 1 6
0
0 3 8 4
B 1 0 1 1
B
0 5
D(2) = B
B 1 4
@ 2
5 ;5 0
1
1
1 6
0
0 3 8 4
B 1 0
1 1
B
(3)
1
4
0 5
D =B
B
@ 2 ;1 ;5 0
1 1 1 6
0
0 3 ;1 4
B 3 0 ;4 1
B
0 5
D(4) = B
B 7 4
@ 2 ;1 ;5 0
1 6
0 8 5
0 1 ;3 2
B 3 0 ;4 1
B
(5)
D =B
0 5
B 7 4
@ 2 ;1 ;5 0
8 5 1 6
0

537

;4
7

1
1

0
;4
7

1
;2
0

;4

1

0

C
C
C
C
A

B
(0) = B

1

0

C
C
C
C
A

B
(1) = B

1

0

7 C
C
11 C
C
;2 A
0 1
;4
7 C
C
11 C
C
;2 A
0 1
;4
;1 C
C
3 C
C
;2 A
0 1
;4
;1 C
C
3 C
C
;2 A
0

B
B
@

B
B
@

B

B
(2) = B
B
@
0
B

B
(3) = B
B
@
0
B

B
(4) = B
B
@
0
B

B
(5) = B
B
@

nil 1 1
nil nil nil
nil 3 nil
4 nil 4
nil nil nil
nil 1 1
nil nil nil
nil 3 nil

4

1

nil nil
nil 1
nil nil
nil 3

4

1

nil nil
nil 1
nil nil
nil 3

4

3

nil nil
nil 1
4 nil

4
4
4

3
3
3
nil 3
4 nil
4 3
4 3
4 3

1
2

nil

2

nil nil
nil nil
5 nil
nil 1

2

2

nil nil

4 nil
nil 5
1 2
nil 2
nil 2
4 nil
nil 5
1 2
nil 2
nil 2
4 nil
nil 5
4 2
4 2
nil 2
4 nil
4 5
4 5
4 2
nil 2
4 nil
4 5

1

nil

C
C
C
C
A
1
C
C
C
C
A

1
2
2
1

1

1
2
2
1

1

1
1
1
1

1

1
1
1
1

1

nil

nil

nil

nil

26.4  ²°¨¶» (k) ¨ D(k) , ¢»·¨±«¿¥¬»¥  «£®°¨²¬®¬ «®©¤ {
®°¸®««  ¤«¿ £° ´  °¨±. 26.1.
¨±. 26.3

1

C
C
C
C
A

C
C
C
C
A

C
C
C
C
A

C
C
C
C
A

538

« ¢  26 ° ²· ©¸¨¥ ¯³²¨ ¤«¿ ¢±¥µ ¯ ° ¢¥°¸¨­

«£®°¨²¬ «®©¤ -®°¸®««  ±®¤¥°¦¨² ²°¨ ¢«®¦¥­­»µ ¶¨ª« 
(±²°®ª¨ 3{6); ¢°¥¬¿ ¥£® ° ¡®²» ¥±²¼ (n3 ). ®­±² ­² , ±ª°»² ¿ ¢
-®¡®§­ ·¥­¨¨, ­¥¢¥«¨ª , ¯®±ª®«¼ª³  «£®°¨²¬ ¯°®±² ¨ ­¥ ¨±¯®«¼§³¥² ±«®¦­»µ ±²°³ª²³° ¤ ­­»µ, ² ª ·²® ®­ ¯°¨¬¥­¨¬ ¤«¿ ¤®±² ²®·­®
¡®«¼¸¨µ £° ´®¢.
®±²°®¥­¨¥ ª° ²· ©¸¨µ ¯³²¥©
®¬¨¬® ¢¥±®¢ ª° ²· ©¸¨µ ¯³²¥©, ­ ± ¨­²¥°¥±³¾² ¨ ± ¬¨ ¯³²¨.
¤¨­ ¨§ ±¯®±®¡®¢ ¨µ ¯®±²°®¥­¨¿ ² ª®¢: ¢»·¨±«¨» ¢»·¨±«¥­¨¨ ¬ ²°¨¶³ D ¨µ ¢¥±®¢, ¬®¦­® § ²¥¬ ¯®±²°®¨²¼ ¯® ­¥© ¬ ²°¨¶³ ¯°¥¤¸¥±²¢®¢ ­¨¿  §  ¢°¥¬¿ O(n3) ¢°¥¬¥­¨ (³¯°. 26.1-5).  ²¥¬ ¯°¨ ¯®¬®¹¨ ´³­ª¶¨¨ Print-All-Pairs-Shortest-Path ¬®¦­® ­ ¯¥· ² ²¼
ª° ²· ©¸¨© ¯³²¼ ¤«¿ «¾¡®© ¯ °» ¢¥°¸¨­.
°³£®© ±¯®±®¡ ±®±²®¨² ¢ ²®¬, ·²®¡» ¢»·¨±«¿²¼ ¬ ²°¨¶³ ¯°¥¤¸¥±²¢®¢ ­¨¿ ¯ ° ««¥«¼­® ± ¨±¯®«­¥­¨¥¬  «£®°¨²¬  «®©¤ {
®°¸®«« . °¨ ½²®¬ ¬» ¢»·¨±«¿¥¬ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¬ ²°¨¶
(0); (1); : : : ; (n), £¤¥  = (n) ,   ij(k) ®¯°¥¤¥«¿¥²±¿ ª ª ¢¥°¸¨­ ,
¯°¥¤¸¥±²¢³¾¹ ¿ ¢¥°¸¨­¥ j ­  ª° ²· ©¸¥¬ ¯³²¨ ¨§ ¢¥°¸¨­»
i ¢ ¢¥°¸¨­³ j ± ¯°®¬¥¦³²®·­»¬¨ ¢¥°¸¨­ ¬¨ ¨§ ¬­®¦¥±²¢ 
f1; 2; : : : ; kg.
 ¯¨¸¥¬ °¥ª³°¥­²­³¾ ´®°¬³«³ ¤«¿ ij(k). ±«¨ k = 0, ²® ¯°®¬¥¦³²®·­»µ ¢¥°¸¨­ ­¥², ¯®½²®¬³

ij(0) =



nil ¥±«¨ i = j ¨«¨ wij = 1,

i

¥±«¨ i 6= j ¨ wij < 1.

(26:6)

³±²¼ ²¥¯¥°¼ k > 1. ±«¨ ª° ²· ©¸¨© ¯³²¨ ¨§ i ¢ j ¯°®µ®¤¨²
·¥°¥§ ¢¥°¸¨­³ k, ²® ¯°¥¤¯®±«¥¤­¥© ¥£® ¢¥°¸¨­®© ¡³¤¥² ²  ¦¥ ± ¬ ¿
¢¥°¸¨­ , ª®²®° ¿ ¡³¤¥² ¯°¥¤¯®±«¥¤­¥© ­  ª° ²· ©¸¥¬ ¯³²¨ ¨§ k ¢ j
± ¯°®¬¥¦³²®·­»¬¨ ¢¥°¸¨­ ¬¨ ¨§ ¬­®¦¥±²¢  f1; 2; : : : ; k ; 1g. ±«¨
¦¥ ¯³²¼ ­¥ ¯°®µ®¤¨² ·¥°¥§ k, ²® ®­ ±®¢¯ ¤ ¥² ± ª° ²· ©¸¨¬ ¯³²¥¬
¨§ i ¢ j ± ¯°®¬¥¦³²®·­»¬¨ ¢¥°¸¨­ ¬¨ ¨§ ¬­®¦¥±²¢  f1; 2; : : : ; k ;
1g.  ª¨¬ ®¡° §®¬,

ij(k) =

(

ij(k;1) ¥±«¨ d(ijk;1) 6 d(ikk;1) + d(kjk;1),
kj(k;1) ¥±«¨ d(ijk;1) > d(ikk;1) + d(kjk;1).

(26:7)

»·¨±«¥­¨¿ ¯® ½²¨¬ ´®°¬³« ¬ «¥£ª® ¤®¡ ¢¨²¼ ª  «£®°¨²¬³
«®©¤ {®°¸®««  (³¯°. 26.2-3).   °¨±. 26.4 ¯®ª § ­  ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¬ ²°¨¶ (k) , ¯®«³· ¾¹ ¿±¿ ¢ ¯°®¶¥±±¥ ¢»·¨±«¥­¨©. 
²®¬ ¦¥ ³¯° ¦­¥­¨¨ ¯°¥¤« £ ¥²±¿ ¤®ª § ²¼, ·²® ¯®¤£° ´ ¯°¥¤¸¥±²¢®¢ ­¨¿ G;i ¿¢«¿¥²±¿ ¤¥°¥¢®¬ ª° ²· ©¸¨µ ¯³²¥© ¨§ ¢¥°¸¨­» i.
°³£®© ±¯®±®¡ ¯®±²°®¥­¨¿ ª° ²· ©¸¨µ ¯³²¥© ³ª § ­ ¢ ³¯°. 26.2-6.
° ­§¨²¨¢­®¥ § ¬»ª ­¨¥ ®°¨¥­²¨°®¢ ­­®£® £° ´ 
 ¤ ·  ® ²° ­§¨²¨¢­®¬ § ¬»ª ­¨¨ ±®±²®¨² ¢ ±«¥¤³¾¹¥¬.  ­
®°¨¥­²¨°®¢ ­­»© £° ´ G = (V; E ) ± ¢¥°¸¨­ ¬¨ 1; 2; : : : ; n. °¥¡³¥²±¿ ®¯°¥¤¥«¨²¼ ¤«¿ «¾¡®© ¯ °» ¥£® ¢¥°¸¨­ i; j 2 V , ±³¹¥±²¢³¥²

«£®°¨²¬ «®©¤ -®°¸®«« 

539

«¨ ¢ £° ´¥ ¯³²¼ ¨§ ¢¥°¸¨­» i ¢ ¢¥°¸¨­³ j . ° ­§¨²¨¢­»¬ § ¬»ª ­¨¥¬ ®°¨¥­²¨°®¢ ­­®£® £° ´  G ­ §»¢ ¥²±¿ £° ´ G = (V; E ),
£¤¥
E  = f(i; j ) : ¢ £° ´¥ G ±³¹¥±²¢³¥² ¯³²¼ ¨§ i ¢ j g:
° ­§¨²¨¢­®¥ § ¬»ª ­¨¥ £° ´  ¬®¦­® ¢»·¨±«¨²¼ §  ¢°¥¬¿
(n3 ) ¯°¨ ¯®¬®¹¨  «£®°¨²¬  «®©¤ {®°¸®«« , ±·¨² ¿, ·²® ¢±¥
°¥¡°  £° ´  ¨¬¥¾² ¢¥± 1: ¥±«¨ ±³¹¥±²¢³¥² ¯³²¼ ¨§ ¢¥°¸¨­» i ¢
¢¥°¸¨­³ j , ²® dij ¡³¤¥² ¬¥­¼¥¸ n, ¢ ¯°®²¨¢­®¬ ±«³· ¥ dij = 1.
  ¯° ª²¨ª¥ ¡®«¥¥ ¢»£®¤­® (¢ ±¬»±«¥ ¢°¥¬¥­¨ ¨ ¯ ¬¿²¨) ¯®«¼§®¢ ²¼±¿ ­¥±ª®«¼ª® ¤°³£¨¬ ±¯®±®¡®¬ ¢»·¨±«¥­¨¿ ²° ­§¨²¨¢­®£® § ¬»ª ­¨¿ §  ¢°¥¬¿ (n3 ).  ¬¥­¨¬ ¢  «£®°¨²¬¥ «®©¤ {®°¸®«« 
 °¨´¬¥²¨·¥±ª¨¥ ®¯¥° ¶¨¨ min ¨ + ­  «®£¨·¥±ª¨¥ ®¯¥° ¶¨¨ _ ¨ ^.
°³£¨¬¨ ±«®¢ ¬¨, ¯®«®¦¨¬ t(ijk) ° ¢­»¬ 1, ¥±«¨ ¢ £° ´¥ G ±³¹¥±²¢³¥² ¯³²¼ ¨§ i ¢ j ± ¯°®¬¥¦³²®·­»¬¨ ¢¥°¸¨­ ¬¨ ¨§ ¬­®¦¥±²¢ 
f1; 2; : : : ; kg, ¨ ° ¢­»¬ 0, ¥±«¨ ² ª®£® ¯³²¨ ­¥². ¥¡°® (i; j ) ¯°¨­ ¤«¥¦¨² ²° ­§¨²¨¢­®¬³ § ¬»ª ­¨¾ G ²®£¤  ¨ ²®«¼ª® ²®£¤ , ª®£¤ 
t(ijn) = 1. ®  ­ «®£¨¨ ± ´®°¬³«®© (26.5) ­ ¯¨¸¥¬ ±®®²­®¸¥­¨¿ ¤«¿
t(ijk) :

i 6= j ¨ (i; j ) 62 E ,
(0)
tij = 01 ¥±«¨
¥±«¨ i = j ¨«¨ (i; j ) 2 E ,
¨ (¯°¨ k > 1)

t(ijk) = t(ijk;1) _ (t(ikk;1) ^ t(kjk;1)):

(26:8)
±­®¢ ­­»© ­  ½²®¬ ±®®²­®¸¥­¨¨  «£®°¨²¬ ¯®±«¥¤®¢ ²¥«¼­® ¢»·¨±«¿¥² ¬ ²°¨¶» T (k) = (t(ijk) ) ¤«¿ k = 1; 2; : : : ; n:
{\sc Transitive-Clusure}$(G)$\\
\verb|1 |$n \leftarrow |V[G]|$\\
\verb|2 |for $i\leftarrow 1$ to $n$\\
\verb|3
|do for $j\leftarrow 1$ to $n$\\
\verb|4
|do if $i=j$ or $(i,j)\in E[G]$\\
\verb|5
|then $t^{(0)}_{ij} \leftarrow 1$\\
\verb|6
|else $t^{(0)}_{ij} \leftarrow 0$\\
\verb|7 |for $k\leftarrow 1$ to $n$\\
\verb|8
|do for $i\leftarrow 1$ to $n$\\
\verb|9
|do for $j\leftarrow 1$ to $n$\\
\verb|10
|do $t^{(k)}_{ij}\leftarrow t^{(k-1)}_{ij}\vee
(t^{(k-1)}_{ik}\wedge t^{(k-1)}_{kj})$\\
\verb|11 |return $T^{(n)}$

  °¨±. 26.5 ¯°¨¢¥¤¥­ ¯°¨¬¥° £° ´  ¨ ¬ ²°¨¶ T (k), ¢»·¨±«¥­­»µ
¯°®¶¥¤³°®© Transitive-Clusure.
°¥¬¿ ° ¡®²» ¯°®¶¥¤³°» Transitive-Clusure ±®±² ¢«¿¥²
(n3 ), ª ª ¨ ³  «£®°¨²¬  «®©¤ {®°¸®«« . ¤­ ª® ­  ¬­®£¨µ
ª®¬¯¼¾²¥° µ «®£¨·¥±ª¨¥ ®¯¥° ¶¨¨ ¢»¯®«­¿¾²±¿ ¡»±²°¥¥, ·¥¬

540

« ¢  26 ° ²· ©¸¨¥ ¯³²¨ ¤«¿ ¢±¥µ ¯ ° ¢¥°¸¨­
0
B

T (0) = B
@
0
B

T (3) = B
@

1
0
0
1
1
0
0
1

0
1
1
0
0
1
1
1

0
1
1
1
0
1
1
1

0
1
0
1
0
1
1
1

1

0

C
C
A

T (1) = B
@

1

0

C
C
A

T (4) = B
@

B

B

1
0
0
1
1
1
1
1

0
1
1
0
0
1
1
1

0
1
1
1
0
1
1
1

0
1
0
1
0
1
1
1

1

0

C
C
A

T (2) = B
@

1

B

1
0
0
1

0
1
1
0

C
C
A

26.5 °¨¥­²¨°®¢ ­­»© £° ´ ¨ ¬ ²°¨¶» T (k) , ¢»·¨±«¥­­»¥  «£®°¨²¬®¬ ¯®±²°®¥­¨¿ ²° ­§¨²¨¢­®£® § ¬»ª ­¨¿.
¨±. 26.4

 °¨´¬¥²¨·¥±ª¨¥ ®¯¥° ¶¨¨ ± ¶¥«»¬¨ ·¨±« ¬¨, ¯®½²®¬³ ¯°®¶¥¤³° 
Transitive-Clusure ½´´¥ª²¨¢­¥¥  «£®°¨²¬  «®©¤ -®°¸®«« .
°®¬¥ ²®£®, ¨±¯®«¼§®¢ ­¨¥ ¡³«¥¢±ª¨µ ¯¥°¥¬¥­­»µ ¢¬¥±²® ¶¥«»µ
±®ª° ¹ ¥² ®¡º¥¬ ¨±¯®«¼§³¥¬®© ¯ ¬¿²¨.
 ° §¤¥«¥ 26.4 ¬» ³¢¨¤¨¬, ·²®  ­ «®£¨¿ ¬¥¦¤³  «£®°¨²¬ ¬¨
«®©¤ {®°¸®««  ¨ ¯®±²°®¥­¨¥¬ ²° ­§¨²¨¢­®£® § ¬»ª ­¨¿ ­¥
±«³· ©­ : ®¡   «£®°¨²¬  ®±­®¢ ­» ­   «£¥¡° ¨·¥±ª®© ±²°³ª²³°¥,
­ §»¢ ¥¬®© À§ ¬ª­³²®¥ ¯®«³ª®«¼¶®Á.
¯° ¦­¥­¨¿
26.2-1 ±¯®«­¨²¥  «£®°¨²¬ «®©¤ -®°¸®««  ¤«¿ ¢§¢¥¸¥­­®£®
®°¨¥­²¨°®¢ ­­®£® £° ´  °¨±. 26.2, ­ ©¤¿ ¢±¥ ¬ ²°¨¶» D(k) .
26.2-2  ¯°¨¢¥¤¥­­®¬ ­ ¬¨ ¢¨¤¥  «£®°¨²¬ «®©¤ -®°¸®««  ²°¥¡³¥² (n3 ) ¯ ¬¿²¨ ¤«¿ µ° ­¥­¨¿ ¬ ²°¨¶ D(k) = (d(ijk)). ®­¥·­®,
¬®¦­® ±½ª®­®¬¨²¼ ¬¥±²®, ¥±«¨ µ° ­¨²¼ ²®«¼ª® ¤¢¥ ±®±¥¤­¨¥ ¬ ²°¨¶». ª §»¢ ¥²±¿, ¬®¦­® ¯®©²¨ ¥¹¥ ¤ «¼¸¥: ¤®ª §¨²¥, ·²® ¥±«¨
¢ ¯°®¶¥¤³°¥ Floyd-Warshall ³¡° ²¼ ¢¥°µ­¨¥ ¨­¤¥ª±», ²® ®­  ¯®¯°¥¦­¥¬³ ¡³¤¥² ¢»·¨±«¿²¼ ¢¥±  ª° ²· ©¸¨µ ¯³²¥©.
{\sc Floyd-Warshall'}$(W)$\\
\verb|1 |$n \leftarrow rows[W]$\\
\verb|2 |$D \leftarrow W$\\
\verb|3 |for $k \leftarrow 1$ to $n$\\
\verb|4
|do for $i \leftarrow 1$ to $n$\\
\verb|5
|do for $j \leftarrow 1$ to $n$\\
\verb|6
|$d_{ij} \leftarrow \min(d_{ij},
d_{ik}+d_{kj})$\\
\verb|7 |return $D$

¥¬ ± ¬»¬ ¬» ±®ª° ²¨«¨ ®¡º¥¬ ²°¥¡³¥¬®© ¯ ¬¿²¨ ¤® (n2 ).
26.2-3 ®¡ ¢¼²¥ ¢ ¯°®¶¥¤³°³ Floyd-Warshall ¢»·¨±«¥­¨¥ ¬ ²°¨¶ ¯°¥¤¸¥±²¢®¢ ­¨¿ (k) ¯® ´®°¬³« ¬ (26.6) ¨ (26.7). ®ª ¦¨²¥,
·²® ¤«¿ «¾¡®© ¢¥°¸¨­» i 2 V ¯®¤£° ´ ¯°¥¤¸¥±²¢®¢ ­¨¿ G;i ¿¢«¿¥²±¿ ¤¥°¥¢®¬ ª° ²· ©¸¨µ ¯³²¥© ¨§ ¢¥°¸¨­» i.
26.2-4 ³¤¥² «¨ ¯° ¢¨«¼­® ¢»·¨±«¥­  ¬ ²°¨¶  ¯°¥¤¸¥±²¢®¢ ­¨¿

0
1
1
1

0
1
1
1

1
C
C
A

«£®°¨²¬ «®©¤ -®°¸®«« 

541

, ¥±«¨ ¨§¬¥­¨²¼ ´®°¬³«³ (26.7) ² ª:

ij(k) =

(

ij(k;1) ¥±«¨ d(ijk;1) < d(ikk;1) + d(kjk;1),
kj(k;1) ¥±«¨ d(ijk;1) > d(ikk;1) + d(kjk;1).

26.2-5  ª ¬®¦­® ¨±¯®«¼§®¢ ²¼ °¥§³«¼² ² ° ¡®²»  «£®°¨²¬
«®©¤ {®°¸®«« , ·²®¡» ³§­ ²¼, ¥±²¼ «¨ ¢ £° ´¥ ¶¨ª« ®²°¨¶ ²¥«¼­®£® ¢¥± ?
26.2-6 ¹¥ ®¤¨­ ±¯®±®¡ ¯®±²°®¥­¨¿ ª° ²· ©¸¨µ ¯³²¥© ¢  «£®°¨²¬¥ «®©¤ -®°¸®««  ² ª®¢. ³±²¼ '(ijk) (i; j; k = 1; 2; : : : ; n) ¥±²¼
¯°®¬¥¦³²®·­ ¿ ¢¥°¸¨­  ± ¬ ª±¨¬ «¼­»¬ ­®¬¥°®¬ ­  ª° ²· ©¸¥¬ ¯³²¨ ¨§ i ¢ j ± ¯°®¬¥¦³²®·­»¬¨ ¢¥°¸¨­ ¬¨ ¨§ ¬­®¦¥±²¢ 
f1; 2; : : : ; kg.  ¯¨¸¨²¥ °¥ª³°¥­²­®¥ ±®®²­®¸¥­¨¥ ¤«¿ '(ijk) ¨ ¤®¯®­¨²¥ ¯°®¶¥¤³°³ Floyd-Warshall ¢»·¨±«¥­¨¥¬ §­ ·¥­¨© '(ijk) .
 ª®­¥¶, ¨§¬¥­¨²¥ ´³­ª¶¨¾ Print-All-Pairs-ShortestPaths
² ª, ·²®¡» ¢µ®¤®¬ ¤«¿ ­¥¥ ±«³¦¨«  ¬ ²°¨¶   = ('(ijn)). ¡º¿±­¨²¥
 ­ «®£¨¾ ¬¥¦¤³ ¬ ²°¨¶¥©  ¨ ² ¡«¨¶¥© s ¢ § ¤ ·¨ ®¡ ®¯²¨¬ «¼­®©
° ±±² ­®¢ª¥ ±ª®¡®ª ¢ ¯°®¨§¢¥¤¥­¨¨ ¬ ²°¨¶ (° §¤¥« 16.1).
26.2-7 °¨¤³¬ ©²¥  «£®°¨²¬ ¢»·¨±«¥­¨¿ ²° ­§¨²¨¢­®£® § ¬»ª ­¨¿ ®°¨¥­²¨°®¢ ­­®£® £° ´  G = (V; E ) ± ¢°¥¬¥­¥¬ ° ¡®²»
O(V E ).
26.2-8 °¥¤¯®«®¦¨¬, ·²® ²° ­§¨²¨¢­®¥ § ¬»ª ­¨¥ ®°¨¥­²¨°®¢ ­­®£®  ¶¨ª«¨·¥±ª®£® £° ´  ¬®¦¥² ¡»²¼ ¯®±²°®¥­® §  ¢°¥¬¿
f (V; E ), £¤¥ f (V; E ) = 
(V + E ) ¨ f | ¬®­®²®­­® ¢®§° ±² ¾¹ ¿
´³­ª¶¨¿. ®ª ¦¨²¥, ·²® ²®£¤  ²° ­§¨²¨¢­®¥ § ¬»ª ­¨¥ ¯°®¨§¢®«¼­®£® ®°¨¥­²¨°®¢ ­­®£® £° ´  ¬®¦¥² ¡»²¼ ¯®±²°®¥­® §  ¢°¥¬¿
O(f (V; E )).
«£®°¨²¬ ¦®­±®­  ¤«¿ ° §°¥¦¥­­»µ £° ´®¢
«£®°¨²¬ ¦®­±®­  ­ µ®¤¨² ª° ²· ©¸¨¥ ¯³²¨ ¤«¿ ¢±¥µ ¯ ° ¢¥°¸¨­ §  ¢°¥¬¿ O(V 2 lg V + V E ), ¨ ¯®½²®¬³ ¤«¿ ¤®±² ²®·­® ° §°¥¦¥­­»µ £° ´®¢ ½´´¥ª²¨¢­¥¥ ¯®¢²®°­®£® ¢®§¢¥¤¥­¨¿ ¢ ª¢ ¤° ² ¬ ²°¨¶» ±¬¥¦­®±²¨ £° ´  ¨  «£®°¨²¬  «®©¤ -®°¸®«« .
«£®°¨²¬ ¦®­±®­  «¨¡® ¢®§¢° ¹ ¥² ¬ ²°¨¶³ ¢¥±®¢ ª° ²· ©¸¨µ ¯³²¥©, «¨¡® ±®®¡¹ ¥², ·²® ¢ £° ´¥ ¨¬¥¥²±¿ ¶¨ª« ®²°¨¶ ²¥«¼­®£® ¢¥± . ²®²  «£®°¨²¬ ±®¤¥°¦¨² ¢»§®¢» ®¯¨± ­­»µ ¢ £« ¢¥ 25
 «£®°¨²¬®¢ ¥©ª±²°» ¨ ¥««¬ ­ -®°¤ .
«£®°¨²¬ ¦®­±®­  ®±­®¢ ­ ­  ¨¤¥¥ ¨§¬¥­¥­¨¿ ¢¥±®¢ (reweighting). ±«¨ ¢¥±  ¢±¥µ °¥¡¥° £° ´  ­¥®²°¨¶ ²¥«¼­», ²® ¬®¦­® ­ ©²¨
ª° ²· ©¸¨¥ ¯³²¨ ¬¥¦¤³ ¢±¥¬¨ ¯ ° ¬¨ ¢¥°¸¨­, ¯°¨¬¥­¨¢  «£®°¨²¬
¥©ª±²°» ª ª ¦¤®© ¢¥°¸¨­¥. ±¯®«¼§³¿ ´¨¡®­ ··¨¥¢» ª³·¨, ¬»
¬®¦¥¬ ±¤¥« ²¼ ½²® §  ¢°¥¬¿ O(V 2 lg V + V E ). ±«¨ ¦¥ ¢ £° ´¥ ¨¬¥¾²±¿ °¥¡°  ± ®²°¨¶ ²¥«¼­»¬ ¢¥±®¬, ²® ¬®¦­® ¯®¯»² ²¼±¿ ±¢¥±²¨
§ ¤ ·³ ª ±«³· ¾ ­¥®²°¨¶ ²¥«¼­»µ ¢¥±®¢, ¨§¬¥­¨¢ ¢¥±®¢³¾ ´³­ª¶¨¾. °¨ ½²®¬ ¤®«¦­» ¢»¯®«­¿²¼±¿ ² ª¨¥ ±¢®©±²¢ :
1. ° ²· ©¸¨¥ ¯³²¨ ­¥ ¨§¬¥­¨«¨±¼: ¤«¿ «¾¡®© ¯ °» ¢¥°¸¨­ u; v 2

542

« ¢  26 ° ²· ©¸¨¥ ¯³²¨ ¤«¿ ¢±¥µ ¯ ° ¢¥°¸¨­

V , ª° ²· ©¸¨© ¯³²¼ ¨§ u ¢ v ± ²®·ª¨ §°¥­¨¿ ¢¥±®¢®© ´³­ª¶¨¥© w ¿¢«¿¥²±¿ ² ª¦¥ ª° ²· ©¸¨¬ ¯³²¥¬ ± ²®·ª¨ §°¥­¨¿ w^ ¨

­ ®¡®°®².
2. ±¥ ­®¢»¥ ¢¥±  w^ (u; v ) ­¥®²°¨¶ ²¥«¼­».
 ª ¬» ³¢¨¤¨¬, ­®¢ ¿ ¢¥±®¢ ¿ ´³­ª¶¨¿ w^ ± ² ª¨¬¨ ±¢®©±²¢ ¬¨
¬®¦¥² ¡»²¼ ¯®±²°®¥­  §  ¢°¥¬¿ O(V E ).
° ²· ©¸¨¥ ¯³²¨ ±®µ° ­¿¾²±¿
«¥¤³¾¹ ¿ «¥¬¬  ³ª §»¢ ¥² ¯°®±²®© ®¡¹¨© ±¯®±®¡ ¨§¬¥­¨²¼ ¢¥±®¢³¾ ´³­ª¶¨¾, ­¥ ¬¥­¿¿ ª° ²· ©¸¨µ ¯³²¥©.  ¥¥ ´®°¬³«¨°®¢ª¥
¤«¨­» ª° ²· ©¸¨µ ¯³²¥© ± ¢¥±®¢»¬¨ ´³­ª¶¨¿¬¨ w ¨ w^ ®¡®§­ · ¾²±¿ ·¥°¥§  ¨ ^ ±®®²¢¥²±²¢¥­­®.
¥¬¬  26.1 (§¬¥­¥­¨¥ ¢¥±®¢ ­¥ ¬¥­¿¥² ª° ²· ©¸¨µ ¯³²¥©)
³±²¼ G = (V; E ) | ¢§¢¥¸¥­­»© ®°¨¥­²¨°®¢ ­­»© £° ´ ± ¢¥±®¢®© ´³­ª¶¨¥© w : E ! R. ³±²¼ h : V ! R | ¯°®¨§¢®«¼­ ¿
´³­ª¶¨¿ ± ¢¥¹¥±²¢¥­­»¬¨ §­ ·¥­¨¿¬¨, ®¯°¥¤¥«¥­­ ¿ ­  ¢¥°¸¨­ µ
£° ´ .  ±±¬®²°¨¬ ­®¢³¾ ¢¥±®¢³¾ ´³­ª¶¨¾

w^ (u; v ) = w(u; v ) + h(u) ; h(v):
(26:9)
®£¤  (a) ¯°®¨§¢®«¼­»© ¯³²¼ p = hv0 ; v1; : : : ; vk i ¿¢«¿¥²±¿ ª° ²· ©¸¨¬ ®²­®±¨²¥«¼­® w ²®£¤  ¨ ²®«¼ª® ²®£¤ , ª®£¤  ®­ ¡³¤¥²²
ª° ²· ©¸¨¬ ®²­®±¨²¥«¼­® w^; (b) £° ´ G ±®¤¥°¦¨² ¶¨ª« ± ®²°¨¶ ²¥«¼­»¬ w-¢¥±®¬ ²®£¤  ¨ ²®«¼ª® ²®£¤ , ª®£¤  ®­ ±®¤¥°¦¨² ¶¨ª« ±
®²°¨¶ ²¥«¼­»¬ w^ -¢¥±®¬.
®ª § ²¥«¼±²¢®. ¡  ³²¢¥°¦¤¥­¨¿ «¥¬¬» ±«¥¤³¾² ¨§ ° ¢¥­±²¢ 

w^ (p) = w(p) + h(v0) ; h(vk ):

(26:10)

 ± ¬®¬ ¤¥«¥, ¨§ ­¥£® ±«¥¤³¥², ·²® ¤«¿ ¯³²¥© ± ´¨ª±¨°®¢ ­­»¬¨
­ · «®¬ ¨ ª®­¶®¬ ° §­¨¶  ¬¥¦¤³ ±² °»¬ ¨ ­®¢»¬ ¢¥±®¬ ¯®±²®¿­­ 
(²¥¬ ± ¬»¬ ®¤¨­ ¨ ²®² ¦¥ ¯³²¼ ¡³¤¥² ª° ²· ©¸¨¬). °®¬¥ ²®£®,
¢¨¤­®, ·²® ¤«¿ ¶¨ª«®¢ ±³¬¬ °­»© ¢¥± ¢ ±² °®¬ ¨ ­®¢®¬ ±¬»±«¥
®¤¨­ ª®¢, ² ª ª ª ° §­¨¶  h(v0 ) ; h(vk ) ®¡° ¹ ¥²±¿ ¢ 0.
 ¢¥­±²¢® (26.10) ¯°®¢¥°¨²¼ «¥£ª®. «¿ ª ¦¤®£® °¥¡°  ¯³²¨ ¨¬¥¥¬
w^(vi ; vi+1) = w(vi; vi+1) + h(vi) ; h(vi+1 ):
±«¨ ¬» ²¥¯¥°¼ ±«®¦¨¬ ½²¨ ° ¢¥­±²¢  ¤«¿ ¢±¥µ °¥¡¥°, ²® ¯°®¬¥¦³²®·­»¥ ·«¥­» ±®ª° ²¿²±¿, ¨ ¯®«³·¨²±¿ ° ¢¥­±²¢® (26.10).
 ª ¯®«³·¨²¼ ­¥®²°¨¶ ²¥«¼­»¥ ¢¥± ?
¥¯¥°¼ ­ ¤® ¯®¤®¡° ²¼ ´³­ª¶¨¾ h ² ª, ·²® ¡» ¨§¬¥­¥­­»¥ ¢¥± 
w^(u; v ) ¡»«¨ ­¥®²°¨¶ ²¥«¼­». ²® ¬®¦­® ±¤¥« ²¼ ±«¥¤³¾¹¨¬ ®¡° §®¬. ® ¤ ­­®¬³ ®°¨¥­²¨°®¢ ­­®¬³ ¢§¢¥¸¥­­®¬³ £° ´³ G = (V; E )
± ¢¥±®¢®© ´³­ª¶¨¥© w ¯®±²°®¨¬ ­®¢»© £° ´ G0 = (V 0; E 0) ± ®¤­®© ¤®¯®«­¨²¥«¼­®© ¢¥°¸¨­®© s (¤°³£¨¬¨ ±«®¢ ¬¨, V 0 = V [ fsg),
¨§ ª®²®°®© ¨¤³² °¥¡°  ­³«¥¢®£® ¢¥±  ¢® ¢±¥ ¢¥°¸¨­» £° ´  V

«£®°¨²¬ «®©¤ -®°¸®«« 

543

(E 0 = E [ f(s; v ) : v 2 V g ¨ w(s; v ) = 0 ¤«¿ ¢±¥µ v 2 V ).  ¬¥²¨¬, ·²® ¢¥°¸¨­  s ¬®¦¥² ¡»²¼ «¨¸¼ ­ · «¼­®© ¢¥°¸¨­®© ¢ ¯³²¨
(¢µ®¤¿¹¨µ ¢ s °¥¡¥° ­¥²). ·¥¢¨¤­®, ·²® ­®¢»© £° ´ G0 ±®¤¥°¦¨²
¶¨ª« ®²°¨¶ ²¥«¼­®£® ¢¥±  ²®£¤  ¨ ²®«¼ª® ²®£¤ , ² ª®© ¶¨ª« ¥±²¼
¢ ¨±µ®¤­®¬ £° ´¥ G.
  °¨±. 26.6 (a) ¯®ª § ­ £° ´ G0, ±®®²¢¥²±²¢³¾¹¨© £° ´³ G
°¨±. 26.1.
°¥¤¯®«®¦¨¬ ²¥¯¥°¼, ·²® £° ´ G (  ¯®²®¬³ ¨ G0 ) ­¥ ±®¤¥°¦¨²
¶¨ª«  ®²°¨¶ ²¥«¼­®£® ¢¥± . ®«®¦¨¬ h(v ) =  (s; v ) ¤«¿ 8v 2 V 0 .
®£« ±­® «¥¬¬¥ 25.3, ¤«¿ ¢±¥µ °¥¡¥° (u; v ) 2 E 0 ¢»¯®«­¥­® ­¥° ¢¥­±²¢® h(v ) 6 h(u) + w(u; v ), ª®²®°®¥ ¬®¦­® ¯¥°¥¯¨± ²¼ ª ª
w(u; v)+ h(u) ; h(v ) > 0. °³£¨¬¨ ±«®¢ ¬¨, ­®¢ ¿ ¢¥±®¢ ¿ ´³­ª¶¨¿,
®¯°¥¤¥«¥­­ ¿ ´®°¬³«®© (26.9), ­¥®²°¨¶ ²¥«¼­ .   °¨±. 26.6(b) ¯®ª § ­» ­®¢»¥ ¢¥±  °¥¡¥° £° ´  G0 °¨±. 26.6(a).
»·¨±«¥­¨¥ ª° ²· ©¸¨µ ¯³²¥©
 ª ¬» ¢¨¤¨¬, ®²»±ª ­¨¥ ª° ²· ©¸¨µ ¯³²¥© ¤«¿ ¯°®¨§¢®«¼­®£®
£° ´  ¡¥§ ¶¨ª«®¢ ®²°¨¶ ²¥«¼­®£® ¢¥±  ¬®¦­® ±¤¥« ²¼ ¢ ¤¢  ¯°¨¥¬ :
±­ · «  ¬» ¨¹¥¬ ª° ²· ©¸¨¥ ¯³²¨ ¨§ ®¤­®© ¢¥°¸¨­» s (¤«¿ ·¥£®
£®¤¨²±¿  «£®°¨²¬ ¥««¬ ­ {®°¤ ),   ¯®±«¥ ½²®£® ¨§¬¥­¿¥¬ ¢¥±  ¨ ¯®«³· ¥¬ £° ´ ± ­¥®²°¨¶ ²¥«¼­»¬¨ ¢¥± ¬¨, ¢ ª®²®°®¬ ¨¹¥¬
ª° ²· ©¸¨¥ ¯³²¨ ± ¯®¬®¹¼¾  «£®°¨²¬  ¥©ª±²°», ¯°¨¬¥­¥­­®£®
¯®±«¥¤®¢ ²¥«¼­® ª® ¢±¥¬ ¢¥°¸¨­ ¬.
 ¯¨¸¥¬ ±®®²¢¥²±²¢³¾¹³¾ ¯°®¶¥¤³°³. » ±·¨² ¥¬, ·²® £° ´
§ ¤ ­ ± ¯®¬®¹¼¾ ±¯¨±ª®¢ ±¬¥¦­»µ ¢¥°¸¨­. °®¶¥¤³°  ¢®§¢° ¹ ¥² ¬ ²°¨¶³ D = (dij ) ° §¬¥°  jV j  jV j, £¤¥ dij = ij , ¨«¨ ¦¥ ±®®¡¹ ¥² ® ­ «¨·¨¨ ¢ £° ´¥ ¶¨ª«®¢ ± ®²°¨¶ ²¥«¼­»¬¨ ¢¥± ¬¨. (»
¯°¥¤¯®« £ ¥¬, ·²® ¢¥°¸¨­» £° ´  G ¯°®­³¬¥°®¢ ­» ®² 1 ¤® jV j.)
{\sc Johnson}$(G)$\\
\verb|1 |±®§¤ ²¼ £° ´ $G'$, ¤«¿ ª®²®°®£® $V[G']=V[G]\cup\{s\}$ ¨\\
\verb|
|$E[G']=E[G]\cup\{(s,v):\ v\in V[G]\}$\\
\verb|2 |if {\sc Bellmann-Ford}$(G',w,s)=${\sc false}\\
\verb|3
|then print ``¨¬¥¥²±¿ ¶¨ª« ®²°¨¶ ²¥«¼­®£® ¢¥± ''\\
\verb|4
|else for (¤«¿) ª ¦¤®© ¢¥°¸¨­» $v\in V[G']$\\
\verb|5
|do $h(v)\leftarrow\delta(s,v)$,\\
\verb|
|(§­ ·¥­¨¥ $\delta(s,v)$ ¢»·¨±«¥­®  «£®°¨²¬®¬
¥««¬ ­ --®°¤ )\\
\verb|6
|for (¤«¿) ª ¦¤®£® °¥¡°  $(u,v)\in E[G']$\\
\verb|7
|do $\hat w(u,v)\leftarrow w(u,v)+h(u)-h(v)$\\
\verb|8
|for (¤«¿) ª ¦¤®© ¢¥°¸¨­» $u\in V[G]$\\
\verb|9
|do {\sc Dijkstra}$(G,\hat w,u)$\\
\verb|
|(¢»·¨±«¥­¨¥ $\hat\delta(u,v)$
¤«¿ ¢±¥µ $v\in V[G])$\\
\verb|10
|for (¤«¿) ª ¦¤®© ¢¥°¸¨­» $v\in V[G]$\\
\verb|11
|do $d_{uv}\leftarrow\hat\delta(u,v)+h(v)-h(u)$\\
\verb|12 |return $D$

544

« ¢  26 ° ²· ©¸¨¥ ¯³²¨ ¤«¿ ¢±¥µ ¯ ° ¢¥°¸¨­
¨±. 26.5

26.6 «£®°¨²¬  ¦®­±®­  ¢ ¯°¨¬¥­¥­¨¨ ª £° ´³ °¨±. 26.1. (a) ° ´

G0 ± ¨±µ®¤­®© ¢¥±®¢®© ´³­ª¶¨© w. ±¯®¬®£ ²¥«¼­ ¿ ¢¥°¸¨­  s | ·¥°­ ¿. ­³²°¨ ª ¦¤®© ¢¥°¸¨­» v § ¯¨± ­® §­ ·¥­¨¥ h(v) = (s; v). (b)  ¦¤®¬³ °¥¡°³
(u; v) ¯°¨¯¨± ­ ­®¢»© ¢¥± w^(u; v) = w(u;v)+ h(u) ; h(v). (c){(g) ¥§³«¼² ²» ° ¡®²»  «£®°¨²¬  ¥©ª±²°» ¤«¿ ¢±¥µ ¢¥°¸¨­ £° ´  G ± ¢¥±®¢®© ´³­ª¶¨tq w^ . 
ª ¦¤®¬ ±«³· ¥ ­ · «¼­ ¿ ¢¥°¸¨­  ¢»¤¥«¥­  ·¥°­»¬. ­³²°¨ ª ¦¤®© ¢¥°¸¨­»
§ ¯¨± ­» ¢¥«¨·¨­» ^(u; v)=(u; v). ¥± ª° ²· ©¸¥£® ¯³²¨ duv = (u; v) ° ¢¥­
^(u; v) + h(v) ; h(u).

²  ¯°®¶¥¤³°  ±«¥¤³¥² ®¯¨± ­­®© ±µ¥¬¥.  ±²°®ª¥ 1 ´®°¬¨°³¥²±¿
£° ´ G0 , § ²¥¬ ¢ ±²°®ª¥ 2 ª ­¥¬³ ¯°¨¬¥­¿¥²±¿  «£®°¨²¬ ¥««¬ ­ ®°¤  (¯°¨ ½²®¬ ¨±¯®«¼§³¥²±¿ ¢¥±®¢ ¿ ´³­ª¶¨¿ w). ±«¨ ¢ G0 ( 
§­ ·¨², ¨ ¢ G) ¥±²¼ ¶¨ª« ®²°¨¶ ²¥«¼­®£® ¢¥± , ²® ®¡ ½²®¬ ±®®¡¹ ¥²±¿ ¢ ±²°®ª¥ 3. ²°®ª¨ 4{11 ¢»¯®«­¿¾²±¿, ¥±«¨ ¢ £° ´¥ ² ª®£® ¶¨ª«  ­¥².  ±²°®ª µ 4{5 ¢»·¨±«¿¾²±¿ §­ ·¥­¨¿ ´³­ª¶¨¨ h(v )
¤«¿ ¢±¥µ ¢¥°¸¨­ v 2 V 0 (¢¥±  ª° ²· ©¸¨µ ¯³²¥©  (s; v ), ­ ©¤¥­­»¥
 «£®°¨²¬®¬ ¥««¬ ­ -®°¤ ).  ±²°®ª µ 6{7 ¢»·¨±«¿¾²±¿ ­®¢»¥
¢¥±  °¥¡¥°.  ±²°®ª µ 8{11 ¤«¿ ª ¦¤®© ¢¥°¸¨­» u 2 V [G] ¢»§»¢ ¥²±¿  «£®°¨²¬ ¥©ª±²°» ¨ ®¯°¥¤¥«¿¾²±¿ ¢¥±  ª° ²· ©¸¨µ ¯³²¥©
^(u; v) ¨§ ½²®© ¢¥°¸¨­»,   § ²¥¬ ®­¨ ¯¥°¥±·¨²»¢ ¾²±¿ ¢ (u; v) ¯®
´®°¬³«¥ (26.10), ¨ ®²¢¥² ¯®¬¥¹ ¥²±¿ ¢ ¬ ±±¨¢¥ D.
  °¨±. 26.6 ¯®ª § ­ ¯°¨¬¥° ¢»¯®«­¥­¨¿  «£®°¨²¬  ¦®­±®­ .
¥²°³¤­® ¯®¤±·¨² ²¼, ·²® ¢°¥¬¿ ° ¡®²»  «£®°¨²¬  ¦®­±®­ 
±®±² ¢¨² O(V 2 lg V + V E ), ¥±«¨² ¨±¯®«¼§®¢ ²¼ ´¨¡®­ ··¨¥¢³ ª³·¨
¤«¿ µ° ­¥­¨¿ ®·¥°¥¤¨ ± ¯°¨®°¨²¥² ¬¨ ¢ ¢  «£®°¨²¬¥ ¥©ª±²°».
°¨ ¡®«¥¥ ¯°®±²®© °¥ «¨§ ¶¨¨ ®·¥°¥¤¨ ¢ ¢¨¤¥ ¤¢®¨·­®© ª³·¨ ®¡¹¥¥ ¢°¥¬¿ ° ¡®²» ±®±² ¢¨² O(V E lg V ), ·²® ¬¥­¼¸¥, ·¥¬ ®¶¥­ª 
O(V 3) ¤«¿  «£®°¨²¬  «®©¤ -®°¸®«« , ¥±«¨ ²®«¼ª® £° ´ ¤®±² ²®·­® ° §°¥¦¥­.
¯° ¦­¥­¨¿
26.3-1 °¨¬¥­¨²¥  «£®°¨²¬ ¦®­±®­  ª £° ´³ °¨±. 26.2, ­ ©¤¿
§­ ·¥­¨¿ h ¨ w^.
26.3-2  ª¨¬ ®¡° §®¬ ¨±¯®«¼§³¥²±¿ ¢±¯®¬®£ ²¥«¼­ ¿ ¢¥°¸¨­  ¢
¢  «£®°¨²¬¥ ¦®­±®­ ?
26.3-3 °¨¬¥­¨¬  «£®°¨²¬ ¦®­±®­  ª £° ´³, ¢ ª®²®°®¬ ¨±µ®¤­ ¿ ¢¥±®¢ ¿ ´³­ª¶¨¿ ± ¬  ­¥®²°¨¶ ²¥«¼­ . ²® ¬®¦­® ±ª § ²¼ ®
­®¢®© ¢¥±®¢®© ´³­ª¶¨¨ ¢ ½²®¬ ±«³· ¥?
26.4*  ¬ª­³²»¥ ¯®«³ª®«¼¶ : ®¡¹ ¿ ±µ¥¬  ¤«¿ § ¤ · ® ¯³²¿µ
 ½²®¬ ° §¤¥«¥ ¬» ¢¢¥¤¥¬ ¯®­¿²¨¿ § ¬ª­³²®£® ¯®«³ª®«¼¶  ¨ ¤ ¤¨¬ ®¡¹³¾ ±µ¥¬³ °¥¸¥­¨¿ § ¤ · ® ¯³²¿µ ¢ ®°¨¥­²¨°®¢ ­­»µ £° ´ µ. °¨ ½²®¬  «£®°¨²¬ «®©¤ {®°¸®««  ¨  «£®°¨²¬ ¯®±²°®¥­¨¿ ²° ­§¨²¨¢­®£® § ¬»ª ­¨¿ £° ´  ®ª ¦³²±¿ · ±²­»¬¨ ±«³· ¿¬¨ ½²®© ®¡¹¥© ±µ¥¬».
¯°¥¤¥«¥­¨¥ § ¬ª­³²®£® ¯®«³ª®«¼¶ 
 ¬ª­³²»¬ ¯®«³ª®«¼¶®¬ (S; ; ; 0; 1) (¯®- ­£«¨©±ª¨ closed
semiring) ­ §»¢ ¥²±¿ ¬­®¦¥±²¢® S ± ®¯°¥¤¥«¥­­»¬¨ ­  ­¥¬ ¡¨-

«£®°¨²¬ «®©¤ -®°¸®«« 

545

­ °­»¬¨ ®¯¥° ¶¨¿¬¨ ±«®¦¥­¨¿  ¨ ³¬­®¦¥­¨¿  (¢  ­£«¨©±ª®¬
®°¨£¨­ «¥ ¨±¯®«¼§³¾²±¿ ²¥°¬¨­» summary ¨ extension),   ² ª¦¥
½«¥¬¥­² ¬¨ 0; 1 2 S , ¤«¿ ª®²®°®£® ¢»¯®«­¥­» ² ª¨¥ ±¢®©±²¢ :
1. (S; ; 0) ¿¢«¿¥²±¿ ¬®­®¨¤®¬ (monoid):
 S § ¬ª­³²® (is closed) ®²­®±¨²¥«¼­® , ²® ¥±²¼ a  b 2 S ¤«¿
¢±¥µ a; b 2 S ;
 ®¯¥° ¶¨¿   ±±®¶¨ ²¨¢­  (is associative): a  (b  c) = (a  b)  c
¤«¿ ¢±¥µ a; b; c 2 S ;
 0 | ­¥©²° «¼­»© ½«¥¬¥­² (is an identity) ¤«¿ , ²® ¥±²¼ a  0 =
0  a = a ¤«¿ ¢±¥µ a 2 S ;
(S; ; 1) ² ª¦¥ ¿¢«¿¥²±¿ ¬®­®¨¤®¬;
2. «¥¬¥­² 0 |  ­­³«¿²®° (annihilator): a  0 = 0  a = 0 ¤«¿ ¢±¥µ
a 2 S;
3. ¯¥° ¶¨¿  ª®¬¬³² ²¨¢­  (is commutative): a  b = b  a ¤«¿
¢±¥µ a; b 2 S .
4. ¯¥° ¶¨¿  ¨¤¥¬¯®²¥­²­  (is idempotent): a  a = a;
5. ¯¥° ¶¨¿  ¤¨±²°¨¡³²¨¢­  ®²­®±¨²¥«¼­®  (distributes over
): a  (b  c) = (a  b)  (a  c) ¨ (b  c)  a = (b  a)  (c  a) ¤«¿
¢±¥µ a; b; c.
6. ®¦­® ¯°®¤®«¦¨²¼ ®¯¥° ¶¨¾  ­  ¡¥±ª®­¥·­»¥ ¯®±«¥¤®¢ ²¥«¼­®±²¨, § ¤ · ¤«¿ «¾¡®© ¯®±«¥¤®¢ ²¥«¼­®±²¨ a1; a2; a3; : : : ½«¥¬¥­²®¢ S ¥¥ ±³¬¬³ a1  a2  a3    2 S . °¨ ½²®¬ ­³«¨ (½«¥¬¥­²» 0)
¢ ¡¥±ª®­¥·­®© ±³¬¬¥ ¬®¦­® ¢»ª¨¤»¢ ²¼; ¥±«¨ ¯°¨ ½²®¬ ®­  ¯°¥¢° ¹ ¥²±¿ ª®­¥·­³¾, ²® ¤®«¦­  ±®¢¯ ¤ ²¼ ± ±³¬¬®© ¢ ¯°¥¦­¥¬
±¬»±«¥.
7. ¯¥° ¶¨¿ ¡¥±ª®­¥·­®£® ±³¬¬¨°®¢ ­¨¿ ®¡« ¤ ¥² ±¢®©±²¢ ¬¨
 ±±®¶¨ ²¨¢­®±²¨, ª®¬¬³² ²¨¢­®±²¨ ¨ ¨¤¥¬¯®²¥­²­®±²¨. (¥¬ ± ¬»¬, ¢ «¾¡®© ¡¥±ª®­¥·­®© ±³¬¬¥ ¬®¦­® ¯°®¨§¢®«¼­® ¬¥­¿²¼ ¯®°¿¤®ª ±« £ ¥¬»µ ¨ ³¤ «¿²¼ ¯®¢²®°¿¾¹¨¥±¿ ½«¥¬¥­²», ¡¥§ ¨§¬¥­¥­¨¿
°¥§³«¼² ² .)
8. ¯¥° ¶¨¿  ¤¨±²°¨¡³²¨¢­  ®²­®±¨²¥«¼­® ¡¥±ª®­¥·­»µ ±³¬¬:
a  (b1  b2  b3  : : : ) = (a  b1)  (a  b2)  (a  b3)  : : : ¨ (a1 
a2  a3     )  b = (a1  b)  (a2  b)  (a3  b)     .
±·¨±«¥­¨¥ ¯³²¥© ¢ ®°¨¥­²¨°®¢ ­­»µ £° ´ µ
 ¬ª­³²»¥ ¯®«³ª®«¼¶ , ­¥±¬®²°¿ ­  ±²®«¼  ¡±²° ª²­®¥ ®¯°¥¤¥«¥­¨¥, ²¥±­® ±¢¿§ ­» ± ¯³²¿¬¨ ¢ ®°¨¥­²¨°®¢ ­­»µ £° ´ µ.  ±±¬®²°¨¬ ®°¨¥­²¨°®¢ ­­»© £° ´ G = (V; E ) ± § ¤ ­­®© ­  ­¥¬ ´³­ª¶¨¥© ° §¬¥²ª¨ (labeling function)  : V  V ! S . » ¡³¤¥¬ ±·¨² ²¼,
·²® ½²  ´³­ª¶¨¿ § ¤ ­  ­¥ ²®«¼ª® ­  °¥¡° µ, ­® ¨ ­  «¾¡»µ ¯ ° µ ¢¥°¸¨­, ¯®« £ ¿, ·²® ¤«¿ ¯ ° (u; v ), ­¥ ¿¢«¿¾¹¨µ±¿ °¥¡° ¬¨,
§­ ·¥­¨¥ (u; v ) ° ¢­® 0, ² ª ·²® ¯® ±³¹¥±²¢³ ´³­ª¶¨¿ § ¤ ¥²±¿
¬¥²ª ¬¨ ­  °¥¡° µ (labels of edges)
¯°¥¤¥«¨¬ ²¥¯¥°¼ ¯®­¿²¨¥ ¬¥²ª¨ ¯³²¨ (path label). ¬¥­­®, ¤«¿
«¾¡®£® ¯³²¨ p = hv1 ; v2; : : : ; vk i ¬» ¡³¤¥¬ ­ §»¢ ²¼ ¥£® ¬¥²ª®© (p)

546

« ¢  26 ° ²· ©¸¨¥ ¯³²¨ ¤«¿ ¢±¥µ ¯ ° ¢¥°¸¨­

¯°®¨§¢¥¤¥­¨¥
(p) = (v1; v2)  (v2; v3)      (vk;1 ; vk ):
¤¨­¨·­»© ½«¥¬¥­² 1 ¤«¿ ³¬­®¦¥­¨¿ ¡³¤¥² ¬¥²ª®© ¯³±²®£® ¯³²¨
(¤«¨­» 0). ±«¨ ¯³²¼ p ­¥ ¿¢«¿¥²±¿ ¯³²¥¬ ¢ £° ´¥ (²® ¥±²¼ ¯°¨
­¥ª®²®°®¬ i ¯ °  (vi ; vi+1 ) ­¥ ¿¢«¿¥²±¿ °¥¡°®¬), ²® ¢ ¢»° ¦¥­¨¨
¤«¿ (p) ®¤¨­ ¨§ ¬­®¦¨²¥«¥© ¨ ¯®²®¬³ ¢±¥ ¯°®¨§¢¥¤¥­¨¥ (±¬. ¯³­ª²
2 ®¯°¥¤¥«¥­¨¿ § ¬ª­³²®£® ¯®«³ª®«¼¶ ) ° ¢­» 0.
» ¡³¤¥¬ ¨««¾±²°¨°®¢ ²¼ ¯°¨¬¥­¥­¨¥ § ¬ª­³²»µ ¯®«³ª®«¥¶ ­ 
¯°¨¬¥°¥ § ¤ ·¨ ® ª° ²· ©¸¨µ ¯³²¿µ (¤«¿ ±«³· ¿ ­¥®²°¨¶ ²¥«¼­»µ
¢¥±®¢).  ª ·¥±²¢¥ S ¢®§¼¬¥¬ ¬­®¦¥±²¢® S = R>0 [ f1g (¬­®¦¥±²¢® ­¥®²°¨¶ ²¥«¼­»µ ¢¥¹¥±²¢¥­­»µ ·¨±¥« ± ¤®¡ ¢«¥­­®© (¯«¾±)
¡¥±ª®­¥·­®±²¼¾). ®£¤  ¢¥±  ¢±¥µ °¥¡¥° ¡³¤³² ½«¥¬¥­² ¬¨ S . ¯¥° ¶¨¥© À³¬­®¦¥­¨¿À ¡³¤¥² ®¡»·­®¥ ±«®¦¥­¨¥; ·²®¡» ­¥ § ¯³² ²¼±¿, ®²­»­¥ ¬» ¡³¤¥¬ ¡° ²¼ ¢ ª ¢»·ª¨ ±«®¢  À¯°®¨§¢¥¤¥­¨¥Á, À±³¬¬ Á ¨ ².¯., ¥±«¨ ®­¨ ®²­®±¿²±¿ ª ®¯¥° ¨¿¬ ¢ ¯®«³ª®«¼¶¥. ®£¤ 
À¯°®¨§¢¥¤¥­¨¥¬Á ¬¥²®ª ­  °¥¡° µ ¢¤®«¼ ¯³²¨ ¡³¤¥² ±³¬¬  ¢¥±®¢
°¥¡¥°, ²® ¥±²¼ ¢¥± ¯³²¨. À¤¨­¨¶¥©Á ¯®«³ª®«¼¶  ¡³¤¥² ­¥©²° «¼­»© ½«¥¬¥­² ®²­®±¨²¥«¼­® ±«®¦¥­¨¿, ²® ¥±²¼ 0: ¬®¦­® ­ ¯¨± ²¼
1 = 0. ¥²ª  ¯³±²®£® ¯³²¨ (®¡®§­ ·¨¬ ¥£® ") ¡³¤¥² ° ¢­  ­³«¾:
(") = w(") = 0 = 1.
®§¢° ¹ ¿±¼ ª ®¡¹¥© ±¨²³ ¶¨¨, ®¯°¥¤¥«¨¬ ±®¥¤¨­¥­¨¥, ¨«¨ ª®­ª ²¥­ ¶¨¾ (concatenation) ¤¢³µ ¯³²¥© p1 = hv1; v2; : : : ; vk i ¨ p2 =
hvk ; vk+1; : : : ; vli ª ª ¯³²¼
p1  p2 = hv1; v2; : : : ; vk ; vk+1 ; : : : ; vli;
(±®¥¤¨­¥­¨¥ ¨¬¥¥² ±¬»±«, ¥±«¨ ª®­¥¶ ¯¥°¢®£® ¯³²¨ ±®¢¯ ¤ ¥² ± ­ · «®¬ ¢²®°®£®). ±±®¶¨ ²¨¢­®±²¼ À³¬­®¦¥­¨¿Á £ ° ­²¨°³¥² ­ ¬,
·²® ¬¥²ª  ±®¥¤¨­¥­¨¿ ¯³²¥© ° ¢­  À¯°®¨§¢¥¤¥­¨¾Á ¨µ ¬¥²®ª:
(p1  p2 ) = (v1; v2)  (v2; v3)      (vk;1; vk )
(vk; vk+1)  (vk+1; vk+2)      (vl;1; vl)
= ((v1; v2)  (v2; v3)      (vk;1 ; vk ))
:
((vk ; vk+1 )  (vk+1; vk+2 )      (vl;1; vl))
= (p1)  (p2)
 ª ¬» ³¢¨¤¨¬, ° §«¨·­»¥ § ¤ ·¨ ® ¯³²¿µ ¬®£³² ° ±±¬ ²°¨¢ ²¼±¿ ª ª · ±²­»¥ ±«³· ¨ ² ª®© ®¡¹¥© § ¤ ·¨.  ­® § ¬ª­³²®¥
¯®«³ª®«¼¶® ¨ £° ´ ± ¬¥²ª ¬¨ ­  °¥° µ; ­ ©²¨ (¤«¿ ¢±¥µ ¯ ° ¢¥°¸¨­
i; j 2 V ) ±³¬¬» ¬¥²®ª ¯® ¢±¥¬ ¢®§¬®¦­»¬ ¯³²¿¬ ¨§ i ¢ j :

lij =

O

ipj

(p):

(26:11)

²  À±³¬¬ Á ¬®¦¥² ¡»²¼ ¡¥±ª®­¥·­®© (¯³²¥© ¨§ i ¢ j ¬®¦¥² ¡»²¼
¡¥±ª®­¥·­® ¬­®£®). °¨ ¥¥ ¢»·¨±«¥­¨¨ ¬®¦­® ¢ª«¾· ²¼ ¨ ¯³²¨,

«£®°¨²¬ «®©¤ -®°¸®«« 

547

¨±. 26.6 26.7 ³¬¬³ ¬¥²®ª ¯³²¥© p1  p2 ¨ p1  p3 ¬®¦­® § ¯¨± ²¼ ª ª ((p1 ) 
(p2 ))  ((p1 )  (p3 )). ® ±¢®©±²¢³ ¤¨±²°¨¡³²¨¢­®±²¨ ½²® ¢»° ¦¥­¨¥ ° ¢­®
(p1 )  ((p2 )  (p3 )).
¨±. 26.7 26.8 « £®¤ °¿ ¶¨ª«³ c ¨¬¥¥²±¿ ¡¥±ª®­¥·­® ¬­®£® ¯³²¥© ¨§ ¢¥°¸¨­»
v ¢ ¢¥°¸¨­³ x,   ¨¬¥­­®, p1  p2 , p1  c  p2 , p1  c  c  p2 ¨ ².¤.

¯°®µ®¤¿¹¨¥ ¯® ®²±³²±²¢³¾¹¨¬ ¢ £° ´¥ °¥¡° ¬: ª ª ¬» ¤®£®¢®°¨«¨±¼, ¬¥²ª¨ ² ª¨µ °¥¡¥° ° ¢­» 0, ¯®½²®¬³ ¨ ¬¥²ª¨ ½²¨µ ¯³²¥©
° ¢­» 0 ¨ ¯® ­ ¸¥¬³ ¯°¥¤¯®«®¦¥­¨¾ (±¢®©±²¢® 6) ­  À±³¬¬³Á ² ª¨¥
¯³²¨ ­¥ ¢«¨¿¾². ®¬¬³² ²¨¢­®±²¼ ¨  ±±®¶¨ ²¨¢­®±²¼ ®¯¥° ²®°  
(±¢®©±²¢® 7) ¯®§¢®«¿¾² ­ ¬ ­¥ ³ª §»¢ ²¼ ¯®°¿¤®ª ¯³²¥© ¯°¨ ±³¬¬¨°®¢ ­¨¨.
¥°­¥¬±¿ ª ­ ¸¥¬³ ¯°¨¬¥°³, ¢ ª®²®°®¬ ½«¥¬¥­² ¬¨ S ¡»«¨ ­¥®²°¨¶ ²¥«¼­»¥ ¤¥©±²¢¨²¥«¼­»¥ ·¨±«  ¨ ±¨¬¢®« 1,   À³¬­®¦¥­¨¥¬Á ¡»«® ®¡»·­®¥ ±«®¦¥­¨¥. ±«¨ ¬» ²¥¯¥°¼ ®¯°¥¤¥«¨¬ À±«®¦¥­¨¥Á
ª ª ¢§¿²¨¥ ¬¨­¨¬³¬  (²®·­¥¥, ²®·­®© ­¨¦­¥© £° ­¨, ² ª ª ª ¬»
¤®«¦­» ®¯°¥¤¥«¨²¼ ¥£® ¨ ¤«¿ ¡¥±ª®­¥·­»µ ¯®±«¥¤®¢ ²¥«¼­®±²¥©),
²® ¯®«³·¨¬ § ¬ª­³²®¥ ¯®«³ª®«¼¶® (±¢®©±²¢  1{8 «¥£ª® ¯°®¢¥°¨²¼).
²¬¥²¨¬, ·²® ½«¥¬¥­² 0=1 ¿¢«¿¥²±¿ ­¥©²° «¼­»¬ ½«¥¬¥­²®¬ ¤«¿
À±«®¦¥­¨¿Á: min(a; 1) = a.
±«¨ ±·¨² ²¼ ¬¥²ª®© °¥¡°  ¥£® ¢¥±, ²® ¬¥²ª®© ¯³²¨ ¡³¤¥² ² ª¦¥
¥£® ¢¥± (±³¬¬  ¢¥±®¢ °¥¡¥°),   ³° ¢­¥­¨¥ (26.11) ®¯°¥¤¥«¿¥² lij ª ª
²®·­³¾ ­¨¦­¾¾ £° ­¼ ¢¥±®¢ ¢±¥µ ¯³²¥© ¨§ i ¢ j .
®­¿²¨¥ ¯®«³ª®«¼¶  ¯®§¢®«¿¥² ¢»¯®«­¿²¼  «£¥¡° ¨·¥±ª¨¥ ¯°¥®¡° §®¢ ­¨¿ ± ¬¥²ª ¬¨ ¯³²¥©. °¨¬¥° ² ª®£® °®¤  ¯°¨¢¥¤¥­ ­ 
°¨±. 26.7.
 ¡®«¥¥ ±«®¦­»µ ±«³· ¿µ ·¨±«® ¯³²¥© ¬®¦¥² ¡»²¼ ¡¥±ª®­¥·­®.
 ª®© ¯°¨¬¥° ¯°¨¢¥¤¥­ ­  °¨±. 26.8. ¤¥±¼ (±·¨² ¥¬, ·²® ¤°³£¨µ
¯³²¥© ¨§ u ¢ x ­¥²) ´®°¬³«  (26.11) ¯°¨¢®¤¨² ª À±³¬¬¥Á

(p1)  (p2)  (p1)  (c)  (p2)  (p1)  (c)  (c)  (p2)  : : : =
;

= (p1)  1  (c)  (c)  (c)  : : :  (p2)

«¿ ª° ²ª®© § ¯¨±¨ ² ª®© À±³¬¬»Á ¢¢¥¤¥¬ ±«¥¤³¾¹¥¥ ®¯°¥¤¥«¥­¨¥.
³±²¼ a | ¯°®¨§¢®«¼­»© ½«¥¬¥­² § ¬ª­³²®£® ¯®«³ª®«¼¶  S .  ¬»ª ­¨¥¬ (closure) ½«¥¬¥­²  a ­ §®¢¥¬ ¢»° ¦¥­¨¥
a = 1  a  (a  a)  (a  a  a)  : : :

®£¤  ¯°¥¤»¤³¹¥¥ ¢»° ¦¥­¨¥ (¤«¿ °¨±. 26.8) ¬®¦­® § ¯¨± ²¼ ª ª
(p1)  ((c))  (p2).
 ­ ¸¥¬ ¯°¨¬¥°¥ ¯®«³ª®«¼¶  (±®®²¢¥²±²¢³¾¹¥£® § ¤ ·¥ ® ª° ²· ©¸¨µ ¯³²¿µ) ¨¬¥¥¬ a = minfkajk = 0; 1; 2; : : : g = 0 ¤«¿ «¾¡®£®
½«¥¬¥­²  a > 0. ²® ¨ ­¥ ³¤¨¢¨²¥«¼­®: ¥±«¨ ¶¨ª« ¨¬¥¥² ­¥®²°¨¶ ²¥«¼­»© ¢¥±, ²® ¨¤²¨ ¯® ­¥¬³ ­¥² ±¬»±« .

548

« ¢  26 ° ²· ©¸¨¥ ¯³²¨ ¤«¿ ¢±¥µ ¯ ° ¢¥°¸¨­

°¨¬¥°» § ¬ª­³²»µ ¯®«³ª®«¥¶
¤¨­ ² ª®© ¯°¨¬¥° ¬» ³¦¥ ° ±¬®²°¥«¨: ¯®«³ª®«¼¶® S1 = fR>0 [
f1g; min; +; 1; 0g. » ¬®¦¥¬ ° ±¸¨°¨²¼ ½²® ¯®«³ª®«¼¶®, ° §°¥¸¨¢ ®²°¨¶ ²¥«¼­»¥ ½«¥¬¥­²»,   ² ª¦¥ ½«¥¬¥­² ;1. ®«³·¨²±¿
¯®«³ª®«¼¶® S2 = fR [ f+1g [ f;1g; min; +; +1; 0g (³¯°. 26.4-3).
²® ¯®«³ª®«¼¶® ¬®¦­® ¨±¯®«¼§®¢ ²¼ ¯°¨ ¤®ª § ²¥«¼±²¢¥ ¯° ¢¨«¼­®±²¨  «£®°¨²¬  «®©¤ {®°¸ ««  ¤«¿ ±«³· ¿ ®²°¨¶¶¶ ²¥«¼­»µ
¢¥±®¢. ²¬¥²¨¬, ·²® ²¥¯¥°¼

0;¥±«¨ a > 0,

a = ;1;¥±«¨ a < 0.
²®°®© ±«³· © (a < 0) £®¢®°¨² ­ ¬, ·²® ¶¨ª« ®²°¨¶ ²¥«¼­®£® ¢¥± 
¬®¦­® ¯°®µ®¤¨²¼ ¬­®£®ª° ²­®, ¨ ¢¥±  ¡³¤³² ±²°¥¬¨²¼±¿ ª ;1.
 ¤ ·¥ ® ²° ­§¨²¨¢­®¬ § ¬»ª ­¨¨ ±®®²¢¥²±²¢³¥² § ¬ª­³²®¥ ¯®«³ª®«¼¶® S3 = (f0; 1g; _; ^; 0; 1). °¨ ½²®¬ ¢±¥ °¥¡°  ¨±µ®¤­®£® £° ´  ¨¬¥¾² ¯®¬¥²ª³ 1 (  ®²±³²±²¢³¾¹¨¬ ±®®²¢¥²±²¢³¥² §­ ·¥­¨¥
0 = 0, ª ª ¬» £®¢®°¨«¨).  ½²®¬ ¯®«³ª®«¼¶¥ §­ ·¥­¨¥ lij , ¢»·¨±«¥­­®¥ ¯® ´®°¬³«¥ (26.11), ° ¢­® 1, ¥±«¨ ¯ °  (i; j ) ¯°¨­ ¤«¥¦¨²
²° ­§¨²¨¢­®¬³ § ¬»ª ­¨¾ (²® ¥±²¼ ¥±²¼ ¯³²¼ ¨§ i ¢ j ), ¨ ° ¢­® 0
¢ ¯°®²¨¢­®¬ ±«³· ¥. ²¬¥²¨¬, ·²® ¤«¿ ½²®£® ª®«¼¶  1 = 0 = 1.
¨­ ¬¨·¥±ª®¥ ¯°®£° ¬¬¨°®¢ ­¨¥ ¨ ±³¬¬  ¬¥²®ª ¯® ¯³²¿¬
®ª ¦¥¬, ª ª ¬®¦­® ¢»·¨±«¨²¼ ¢»° ¦¥­¨¥ (26.11) ± ¯®¬®¹¼¾
 «£®°¨²¬ ,  ­ «®£¨·­®£®  «£®°¨²¬³ «®©¤ {®°¸ ««  ¨  «£®°¨²¬³ ¢»·¨±«¥­¨¿ ²° ­§¨²¨¢­®£® § ¬»ª ­¨¿.
 ¯®¬­¨¬, ·²® ­ ¬ ¤ ­® § ¬ª­³²®¥ ¯®«³ª®«¼¶® S ¨ ®°¨¥­²¨°®¢ ­­»© £° ´ (G; V ), °¥¡°  ª®²®°®£® ¯®¬¥·¥­» ½«¥¬¥­² ¬¨ S . »
µ®²¨¬ ¤«¿ ª ¦¤®© ¯ °» ¢¥°¸¨­ i; j ¢»·¨±«¨²¼ À±³¬¬³Á (¢ ±¬»±«¥
¯®«³ª®«¼¶ )
M
lij = (p)
£¤¥ À±³¬¬¨°®¢ ­¨¥Á ¯°®¨±µ®¤¨² ¯® ¢±¥¬ ¯³²¿¬ ¨§ i ¢ j ,   (p) ¥±²¼
¬¥²ª  ¯³²¨ p, ²® ¥±²¼ À¯°®¨§¢¥¤¥­¨¥Á ¬¥²®ª ­  ¥£® °¥¡° µ.
 ±±¬®²°¨¬ ¢¥«¨·¨­³ lij(k) , ª®²®° ¿ ¯®«³·¨²±¿, ¥±«¨ ®£° ­¨·¨²¼
±³¬¬¨°®¢ ­¨¥ ²®«¼ª® ²¥¬¨ ¯³²¿¬¨, ¢ ª®²®°»µ ¢±¥ ¯°®¬¥¦³²®·­»¥
¢¥°¸¨­» «¥¦ ² ¢ ¬­®¦¥±²¢¥ f1; 2; : : : ; kg. «¿ lij(k) ¬®¦­® ­ ¯¨± ²¼
°¥ª³°¥­²­®¥ ±®®²­®¸¥­¨¥:
(k;1))  l(k;1)):
lij(k) = lij(k;1)  (lik(k;1)  (lkk
kj

(26:12)
²® ´®°¬³«  ­ ¯®¬¨­ ¥² °¥ª³°¥­²­»¥ ±®®²­®¸¥­¨¿ (26.5) ¨ (26.8);
(k;1)), ±®®²¢¥²±²¢³¾° §­¨¶  ¢ ²®¬, ·²® ¢ ­¥© ¥±²¼ À¬­®¦¨²¥«¼Á (lkk
¹¨© À±³¬¬¥Á¬¥²®ª ¢±¥µ ¶¨ª«®¢, ­ ·¨­ ¾¹¨µ±¿ ¨ ª®­· ¾¹¨µ±¿ ¢ k.
(®·¥¬³ ­¥ ¡»«® ² ª®£® ¬­®¦¨²¥«¿ ¢  «£®°¨²¬¥ «®©¤ {®°¸ «« 
± ­¥®²°¨¶ ²¥«¼­»¬¨ ¢¥± ¬¨ ¨ ¢  «£®°¨²¬¥ ¢»·¨±«¥­¨¿ ²° ­§¨²¨¢­®£® § ¬»ª ­¨¿? ¥«® ¢ ²®¬, ·²® ¢ ®¡®¨µ ±«³· µ a = 1 ¨ ¯®½²®¬³
½²®² À¬­®¦¨²¥«¼Á ¬®¦­® ¡»«® ®¯³±²¨²¼.)

«£®°¨²¬ «®©¤ -®°¸®«« 

549

 · «¼­»¥ §­ ·¥­¨¿ ¤«¿ °¥ª³°°¥­²­®£® ±®®²­®¸¥­¨¿ (26.12) ² ª®¢»:

i 6= j ,
(0)
lij = 1 (i; j )(i; j ) ¥±«¨
¥±«¨ i = j:
 ± ¬®¬ ¤¥«¥, ¯³²¼ ¨§ ®¤­®£® °¥¡°  ¨¬¥¥² ¬¥²ª³, ° ¢­³¾ ¬¥²ª³
½²®£® °¥¡° ,   ¯³±²®© ¯³²¼ ¨¬¥¥² ¬¥²ª³ 1 ¢ ±®®²¢¥²±²¢¨¨ ± ­ ¸¨¬
±®£« ¸¥­¨¥¬; ½²®² ¯³²¼ ­ ¤® ³·¥±²¼ ¯°¨ i = j .
» ¯°¨µ®¤¨¬ ª  «£®°¨²¬³, ¨±¯®«¼§³¾¹¥¬³ ¬¥²®¤ ¤¨­ ¬¨·¥±ª®£® ¯°®£° ¬¬¨°®¢ ­¨¿ ¤«¿ ¯®±«¥¤®¢ ²¥«¼­®£® ®²»±ª ­¨¿ ¢¥«¨·¨­
lij(k) ¯°¨ k = 0; 1; 2 : : : ; n; ¥£® ®²¢¥²®¬ ¿¢«¿¥²±¿ ¬ ²°¨¶  L(n) = (lij(n))
(±®®²¢¥²±²¢³¾¹ ¿ À±³¬¬¨°®¢ ­¨¾Á ¯® ¢±¥¬ ¯³²¿¬ ¡¥§ ®£° ­¨·¥­¨©
­  ¯°®¬¥¦³²®·­»¥ ¢¥°¸¨­»).

{\sc Compute-Summaries}$(\lambda,V)$\\
\verb|1 |$n\leftarrow|V|$\\
\verb|2 |for $i\leftarrow1$ to $n$\\
\verb|3
|do for $j\leftarrow1$ to $n$\\
\verb|4
|do if $i=j$\\
\verb|5
|then $l^{(0)}_{ij}\leftarrow\bar1\oplus\lambda(i,j
\verb|6
|else $l^{(0)}_{ij}\leftarrow\lambda(i,j)$\\
\verb|7 |for $k\leftarrow1$ to $n$\\
\verb|8
|do for $i\leftarrow1$ to $n$\\
\verb|9
|do for $j\leftarrow1$ to $n$\\
\verb|10
|do $l^{(k)}_{ij}=l^{(k-1)}_{ij}\oplus(l^{(k-1)}_{
odot(l^{(k-1)}_{kk})^{\ast}\odot l^{(k-1)}_{kj})$\\
\verb|11 |return $L^{(n)}$

°¥¬¿ ° ¡®²» ¤ ­­®£®  «£®°¨²¬  § ¢¨±¨² ®² ¢°¥¬¥­¨ ¢»¯®«­¥­¨¿ ®¯¥° ¶¨© ,  ¨ . ¡®§­ ·¨¢ ¢°¥¬¿ ¢»¯®«­¥­¨¿ ®¯¥° ¶¨© ·¥°¥§ T , T , T , ®¡¹¥¥ ¢°¥¬¿ ° ¡®²»  «£®°¨²¬  ComputeSummaries ¬®¦­® § ¯¨± ²¼ ª ª (n3 )(T + T + T )), ·²® ¯°¥¢° ¹ ¥²±¿ ¢ (n3 ), ¥±«¨ ¢°¥¬¿ ¢»¯®«­¥­¨¿ «¾¡®© ¨§ ²°¥µ ®¯¥° ¶¨©
±®±² ¢«¿¥² O(1).
¯° ¦­¥­¨¿
26.4-1 °®¢¥°¼²¥, ·²® S1 = (R>0 [ f1g; min; +; 1; 0) ¨ S3 =
(f0; 1g; _; ^; 0; 1g) ¿¢«¿¾²±¿ § ¬ª­³²»¬¨ ¯®«³ª®«¼¶ ¬¨.
26.4-2 °®¢¥°¼²¥, ·²® S2 = (R [ f;1; +1g; min; +; +1; 0) ¿¢«¿¥²±¿ § ª­³²»¬ ¯®«³ª®«¼¶®¬. ¥¬³ ° ¢­® §­ ·¥­¨¥ a + (;1) ¤«¿
a 2 R? ²® ¬®¦­® ±ª § ²¼ ® §­ ·¥­¨¨ (;1) + (+1)?
26.4-3  ¯¨¸¨²¥  «£®°¨²¬ Compute-Summaries ¤«¿ ±«³· ¿
§ ¬ª­³²®£® ¯®«³ª®«¼¶  S2,  ­ «®£¨·­»©  «£®°¨²¬³ «®©¤ ®°¸®«« . ¥¬³ ¤®«¦­® ¡»²¼ ° ¢­® §­ ·¥­¨¥ ;1 + 1, ·²®¡»
 «£®°¨²¬ ¯° ¢¨«¼­® ¨±ª ¤ ¤«¨­» ª° ²· ©¸¨µ ¯³²¥©?
26.4-4 ¢«¿¥²±¿ «¨ S4 = (R; +; ; 0; 1) § ¬ª­³²»¬ ¯®«³ª®«¼¶®¬?
(®·­¥¥ ±«¥¤®¢ «® ¡» ±¯°®±¨²¼ ² ª: ¬®¦­® «¨ ¥£® ¯°¥¢° ²¨²¼ ¢ § ¬ª­³²®¥ ¯®«³ª®«¼¶®, ®¯°¥¤¥«¨¢ ª ª¨¬-«¨¡® ®¡° §®¬ ±³¬¬³ «¾¡®£®
¡¥±ª®­¥·­®£® °¿¤ ?)

550

« ¢  26 ° ²· ©¸¨¥ ¯³²¨ ¤«¿ ¢±¥µ ¯ ° ¢¥°¸¨­

26.4-5 ®¦¥¬ «¨ ¬» ®¡®¡¹¨²¼ ­  ±«³· © ¯°®¨¢§®«¼­®£® § ¬ª­³²®£® ¯®«³ª®«¼¶   «£®°¨²¬ ¥©ª±²°»? «£®°¨²¬ ¥««¬ ­ -®°¤ ?
°®¶¥¤³°³ Faster-All-Pairs-Shortest-Paths?
26.4-6
» µ®²¨¬ ³§­ ²¼, ª ª®© ­ ¨¡®«¥¥ ²¿¦¥«»© £°³§®¢¨ª ¬®¦¥² ¯°®¥µ ²¼ ¨§ ®°¾­¨­  ¢ °®±²®ª¢ ¸¨­®, ¨¬¥¿ ª °²³ ¤®°®£ ¬¥¦¤³
½²¨¬¨ ±¥« ¬¨, ¢ ª®²®°®© ¤«¿ ª ¦¤®© ¤®°®£¨ ³ª § ­ ¬ ª±¨¬ «¼­®
¢®§¬®¦­»© ¢¥± £°³§®¢¨ª . ®±²°®©²¥  «£®°¨²¬ ¤«¿ °¥¸¥­¨¿ ½²®©
§ ¤ ·¨, ¨±¯®«¼§³¾¹¨© ¯®¤µ®¤¿¹¥¥ § ¬ª­³²®¥ ¯®«³ª®«¼¶®.
 ¤ ·¨
26-1 ° ­§¨²¨¢­®¥ § ¬»ª ­¨¥ ° ±²³¹¥£® £° ´ 
» µ®²¨¬ ¢»·¨±«¿²¼ ²° ­§¨²¨¢­®¥ § ¬»ª ­¨¥ ®°¨¥­²¨°®¢ ­­®£® £° ´  G = (V; E ), ¬­®¦¥±²¢® °¥¡¥° ª®²®°®£® ° ±²¥². °³£¨¬¨
±«®¢ ¬¨, ¬» µ®²¨¬ ®¡­®¢«¿²¼ ²° ­§¨²¨¢­®¥ § ¬»ª ­¨¥ ¯®±«¥ ¤®¡ ¢«¥­¨¿ ¢ £° ´ ¥¹¥ ®¤­®£® °¥¡° . » ±·¨² ¥¬, ·²® ¨§­ · «¼­® £° ´
G ­¥ ¨¬¥« °¥¡¥° ¢®¢±¥. ° ­§¨²¨¢­®¥ § ¬»ª ­¨¥ ¤®«¦­® µ° ­¨²¼±¿
¢ ¡³«¥¢®© ¬ ²°¨¶¥.
a. ®ª ¦¨²¥, ª ª §  ¢°¥¬¿ O(V 2 ) ¬®¦­® ¯°®¨§¢¥±²¨ ®¡­®¢«¥­¨¥
²° ­§¨²¨¢­®£® § ¬»ª ­¨¿ ¯®±«¥ ¤®¡ ¢«¥­¨¿ ¢ £° ´ G ­®¢®£® °¥¡° .
b. ®ª ¦¨²¥, ·²® «¾¡®©  «£®°¨²¬ ®¡­®¢«¥­¨¿ ²° ­§¨²¨¢­®£® § ¬»ª ­¨¿ (µ° ­¿¹¨© ¥£® ¢ ¡³«¥¢®© ¬ ²°¨¶¥) ¬®¦¥² ¯®²°¥¡®¢ ²¼
¢°¥¬¥­¨ O(V 2 ) ¯®±«¥ ¤®¡ ¢«¥­¨¿ ®¤­®£® °¥¡° .
c. ®±²°®©²¥  «£®°¨²¬ ®¡­®¢«¥­¨¿ ²° ­§¨²¨¢­®£® § ¬»ª ­¨¿
£° ´  ¯®±«¥ ¤®¡ ¢«¥­¨¿ °¥¡¥°, ¤«¿ ª®²®°®£® ±³¬¬ °­®¥ ¢°¥¬¿ ° ¡®²» ¯°¨ ¤®¡ ¢«¥­¨¨ «¾¡®© ¯®±«¥¤®¢ ²¥«¼­®±²¨ °¥¡¥° ­¥ ¯°¥¢®±µ®¤¨² O(V 3).
26-2 ° ²· ©¸¨¥ ¯³²¨ ¢ "-¯«®²­»µ £° ´ µ
° ´ G = (V; E ) ­ §»¢ ¥²±¿ "-¯«®²­»¬, ¥±«¨ jE j = (V 1+" ) ¤«¿
­¥ª®²®°®© ª®­±² ­²» ", «¥¦ ¹¥© ¢ ¤¨ ¯ §®­¥ 0 < " 6 1. ±¯®«¼§®¢ ­¨¥ d-¨·­»µ ª³· (c¬. § ¤ ·³ 7-2) ¢  «£®°¨²¬¥ ¯®¨±ª  ª° ²· ©¸¨µ
¯³²¥© ­  "-¯«®²­»µ £° ´ µ ¯®§¢®«¿¥² ¨§¡ ¢¨²¼±¿ ®² ¨±¯®«¼§®¢ ­¨¿
´¨¡®­ ··¨¥¢»µ ª³· (¤®¢®«¼­® ±«®¦­®© ±²°³ª²³°» ¤ ­­»µ), ±®µ° ­¨¢ ²³ ¦¥  ±¨¬¯²®²¨·¥±ª³¾ ®¶¥­ª³ ¢°¥¬¥­¨ ° ¡®²».
a. ¯°¥¤¥«¨²¥  ±¨¬¯²®²¨ª³ ¢°¥¬¥­¨ ° ¡®²» ¯°®¶¥¤³° Insert,
Extract-Min ¨ Decrease-Key ª ª ´³­ª¶¨¾ ®² d ¨ n (§¤¥±¼ n
| ·¨±«® ½«¥¬¥­²®¢ d-¨·­®© ª³·¨). ²® ¯®«³· ¥²±¿ ¯°¨ d = (n ),
£¤¥ 0 <  6 1 | ­¥ª®²®° ¿ ª®­±² ­² . ° ¢­¨²¥ ½²¨ ¢°¥¬¥­  ±
³·¥²­»¬¨ ¢°¥¬¥­ ¬¨ ½²¨µ ®¯¥° ¶¨© ¤«¿ ´¨¡®­­ ·¨¥¢»µ ª³·.
b. °¨¤³¬ ©²¥ ±¯®±®¡ ¢»·¨±«¨²¼ ª° ²· ©¸¨¥ ¯³²¨ ¨§ ®¤­®© ¢¥°¸¨­» ¢ "-¯«®²­®¬ ®°¨¥­²¨°®¢ ­­®¬ £° ´¥ G = (V; E ) ¡¥§ °¥¡¥°
®²°¨¶ ²¥«¼­®£® ¢¥±  §  ¢°¥¬¿ O(E ). (ª § ­¨¥: ¢»¡¥°¨²¥ ¯®¤µ®¤¿¹¥¥ d ª ª ´³­ª¶¨¾ ".)
c. ®ª ¦¨²¥, ·²® ¬®¦­® ¢»·¨±«¨²¼ ª° ²· ©¸¨¥ ¯³²¨ ¤«¿ ¢±¥µ
¯ ° ¢¥°¸¨­ ¢ "-¯«®²­®¬ ®°¨¥­²¨°®¢ ­­®¬ £° ´¥ G = (V; E ) ¡¥§
°¥¡¥° ®²°¨¶¨²¥«¼­®£® ¢¥±  §  ¢°¥¬¿ O(V E ).

«£®°¨²¬ «®©¤ -®°¸®«« 

551

d. ®ª ¦¨²¥, ·²® §  ¢°¥¬¿ O(V E ) ¬®¦­® ¢»·¨±«¨²¼ ª° ²· ©¸¨¥ ¯³²¨ ¤«¿ ¢±¥µ ¯ ° ¢¥°¸¨­ ¢ "-¯«®²­®¬ ®°¨¥­²¨°®¢ ­­®¬ £° ´¥
G = (V; E ), ª®²®°»© ¬®¦¥² ¨¬¥²¼ °¥¡°  ®²°¨¶ ²¥«¼­®£® ¢¥± , ­®
­¥ ±®¤¥°¦¨² ¶¨ª«®¢ ®²°¨¶ ²¥«¼­®£® ¢¥± .
26-3 ¨­¨¬ «¼­»© ®±²®¢ ¨ § ¬ª­³²®¥ ¯®«³ª®«¼¶®
³±²¼ G = (V; E ) | ±¢¿§­»© ­¥®°¨¥­²¨°®¢ ­­»© £° ´ ± ¢¥±®¢®©
´³­ª¶¨© w : E ! R, ¢¥°¸¨­ ¬¨ ª®²®°®£® ¿¢«¿¾²±¿ ·¨±«  ®² 1 ¤®
n. °¥¤¯®«®¦¨¬, ·²® ¢¥±  w(i; j ) ¢±¥µ °¥¡¥° ° §«¨·­». ³±²¼ T |
¥¤¨­±²¢¥­­»© (±¬. ³¯°. 24.1-6) ¬¨­¨¬ «¼­»© ®±²®¢ £° ´  G.  £±
(B.M.Maggs) ¨ ..«®²ª¨­ ¯°¥¤«®¦¨«¨ ¨±¯®«¼§®¢ ²¼ § ¬ª­³²®¥
¯®«³ª®«¼¶® ¤«¿ ®²»±ª ­¨¿ ¬¨­¨¬ «¼­®£® ¯®ª°»¢ ¾¹¥£® ¤¥°¥¢ .
«¿ ª ¦¤®© ¯ °» ¢¥°¸¨­ ®¯°¥¤¥«¨¬ ¬¨­¨¬ ª±­»© ¢¥± (minimax
weight) mij ¢§¿¢ ¬¨­¨¬³¬ ¯® ¢±¥¬ ¯³²¿¬ ¬ ª±¨¬³¬®¢ ¢¥±®¢ °¥¡¥°
­  ª ¦¤®¬ ¯³²¨.
a. ®ª ¦¨²¥, ·²® S = (R [ f;1; 1g; min; max; 1; ;1) ¿¢«¿¥²±¿
§ ¬ª­³²»¬ ¯®«³ª®«¼¶®¬.
 ª¨¬ ®¡° §®¬, ¬» ¬®¦¥¬ ¨±¯®«¼§®¢ ²¼ ¯°®¶¥¤³°³ ComputeSummaries ¤«¿ ¢»·¨±«¥­¨¿ ¬¨­¨¬ ª±­»µ ¢¥±®¢ mij ¢ £° ´¥ G.
¡®§­ ·¨¬ ·¥°¥§ m(ijk) ¬¨­¨¬ ª±­»© ¢¥± ¤«¿ ¢±¥µ ¯³²¥© ¨§ i ¢ j
± ¯°®¬¥¦³²®·­»¬¨ ¢¥°¸¨­ ¬¨ ¨§ ¬­®¦¥±²¢  f1; 2;   ; kg.
b.  ¯¨¸¨²¥ °¥ª³°°¥­²­³¾ ´®°¬³«³ ¤«¿ m(ijk) ¯°¨ k > 0.
c. ³±²¼ Tm = f(i; j ) 2 E : w(i; j ) = mij g. ®ª ¦¨²¥, ·²® °¥¡° 
¨§ Tm ®¡° §³¾² ¯®ª°»¢ ¾¹¥¥ ¤¥°¥¢® ¤«¿ £° ´  G.
d. ®ª ¦¨²¥, ·²® ½²® ¯®ª°»¢ ¾¹¥¥ ¤¥°¥¢® ¡³¤¥² ¬¨­¨¬ «¼­»¬. (ª § ­¨¥. ®±¬®²°¨²¥, ·²® ¯°®¨±µ®¤¨² ¯°¨ ¤®¡ ¢«¥­¨¨ °¥¡°  (i; j ) ¢ T ¨ ®¤­®¢°¥¬¥­­®¬ ³¤ «¥­¨¨ ¨§ T ª ª®£®-­¨¡³¤¼ °¥¡° ,
«¥¦ ¹¥£® ­  ¯³²¨ ¨§ i ¢ j . ®±¬®²°¨²¥ ² ª¦¥, ·²® ¯°®¨±µ®¤¨² ¯°¨
§ ¬¥­¥ °¥¡°  (i; j ) ¨§ T ­  ¤°³£®¥ °¥¡°®.)
 ¬¥· ­¨¿
®³«¥° [132] ¯®¤°®¡­® ° ±±¬ ²°¨¢ ¥² § ¤ ·³ ­ µ®¦¤¥­¨¿ ª° ²· ©¸¨µ ¯³²¥© ¤«¿ ¢±¥µ ¯ ° ¢¥°¸¨­, µ®²¿ ¨ ­¥ ¢»¤¥«¿¥² ®²¤¥«¼­®
±«³· © ° §°¥¦¥­­»µ £° ´®¢ (¯°¨ ½²®¬ ±¢¿§¼ § ¤ ·¨ ® ª° ²· ©¸¨µ
¯³²¿µ ± ³¬­®¦¥­¨¥¬ ¬ ²°¨¶ ®²­®±¨²±¿ ª ´®«¼ª«®°³). «£®°¨²¬
«®©¤ {®°¸®««  ®¯¨± ­ ¢ ° ¡®²¥ «®©¤  [68], ª®²®°»© ®¯¨° ¥²±¿ °¥§³«¼² ² ®°¸®««  [198] (® ²° ­§¨²¨¢­»¬ § ¬»ª ­¨¨ ¡³«¥¢»µ
¬ ²°¨¶). ®­¿²¨¥ § ¬ª­³²®£® ¯®«³ª®«¼¶  ¯®¿¢¨«®±¼ ¢ ª­¨£¥ µ®,
®¯ª®´²  ¨ «¼¬ ­  [4]. «£®°¨²¬ ¦®­±®­  ¢§¿² ¨§ [114].

27

 ª±¨¬ «¼­»© ¯®²®ª

 ±±¬®²°¨¬ ®°¨¥­²¨°®¢ ­­»© £° ´. ³¤¥¬ ° ±±¬ ²°¨¢ ²¼ ¥£® ª ª
±¥²¼ ²°³¡, ¯® ª®²®°»¬ ­¥ª®²®°®¥ ¢¥¹¥±²¢® ¤¢¨¦¥²±¿ ®² ¨±²®ª 
(£¤¥ ®­® ¯°®¨§¢®¤¨²±¿ ± ­¥ª®²®°®© ¯®±²®¿­­®© ±ª®°®±²¼¾) ª ±²®ª³ (£¤¥ ®­® ¯®²°¥¡«¿¥²±¿ | ± ²®© ¦¥ ±ª®°®±²¼¾). ¬¥±²® ¯®²®ª®¢
¢¥¹¥±²¢  ¬®¦­® ° ±±¬ ²°¨¢ ²¼ ¤¢¨¦¥­¨¥ ²®ª  ¯® ¯°®¢®¤ ¬, ¤¥² «¥© ¯® ª®­¢¥©¥°³, ¨­´®°¬ ¶¨¨ ¯® «¨­¨¿¬ ±¢¿§¨ ¨«¨ ²®¢ °®¢ ®²
¯°®¨§¢®¤¨²¥«¿ ª ¯®²°¥¡¨²¥«¾.
 ª ¨ ¢ § ¤ ·¥ ® ª° ²· ©¸¨µ ¯³²¿µ, ­  ª ¦¤®¬ °¥¡°¥ £° ´  ¬»
¯¨¸¥¬ ·¨±«®. ® ¥±«¨ ² ¬ ½²® ·¨±«® ®§­ · «® ¤«¨­³ ¯³²¨, ²® ²¥¯¥°¼
½²® ±ª®°¥¥ ¸¨°¨­  ¤®°®£¨, ¨«¨ ¯°®¯³±ª­ ¿ ±¯®±®¡­®±²¼ ²°³¡» |
¬ ª±¨¬ «¼­ ¿ ±ª®°®±²¼ ¯®²®ª  ¢ ½²®© ²°³¡¥.  ¯°¨¬¥°, ®­  ¬®¦¥²
¡»²¼ 200 «¨²°®¢ ¢ · ±, ¨«¨ 20  ¬¯¥° (¥±«¨ °¥·¼ ¨¤¥² ®¡ ½«¥ª²°¨·¥±²¢¥).
» ±·¨² ¥¬, ·²® ¢ ¢¥°¸¨­ µ ¢¥¹¥±²¢® ­¥ ­ ª ¯«¨¢ ¥²±¿ |
±ª®«¼ª® ¯°¨µ®¤¨², ±²®«¼ª® ¨ ³µ®¤¨² (¥±«¨ ¢¥°¸¨­  ­¥ ¿¢«¿¥²±¿
¨±²®ª®¬ ¨«¨ ±²®ª®¬). ²® ±¢®©±²¢® ­ §»¢ ¥²±¿ À§ ª®­®¬ ±®µ° ­¥­¨¿ ¯®²®ª Á (ow conservation). «¿ ½«¥ª²°¨·¥±ª®£® ²®ª  ½²® ±¢®©±²¢® ­ §»¢ ¥²±¿ ¯¥°¢»¬ ¯° ¢¨«®¬ ¨°µ£®´ .
 ¤ ·  ® ¬ ª±¨¬ «¼­®¬ ¯®²®ª¥ ¤«¿ ¤ ­­®© ±¥²¨ ±®±²®¨² ¢ ±«¥¤³¾¹¥¬: ­ ©²¨ ¬ ª±¨¬ «¼­® ¢®§¬®¦­³¾ ±ª®°®±²¼ ¯°®¨§¢®¤±²¢  (¨
¯®²°¥¡«¥­¨¿) ¢¥¹¥±²¢ , ¯°¨ ª®²®°®© ¥£® ¥¹¥ ¬®¦­® ¤®±² ¢¨²¼ ®²
¨±²®ª  ª ±²®ª³ ¯°¨ ¤ ­­»µ ¯°®¯³±ª­»µ ±¯®±®¡­®±²¿µ ²°³¡.  ½²®©
£« ¢¥ ¯®±«¥ ²®·­®© ´®°¬³«¨°®¢ª¨ ½²®© § ¤ ·¨ (° §¤¥« 27.1) ®¯¨± ­» ¤¢  ¬¥²®¤  ¥¥ °¥¸¥­¨¿.  ° §¤¥«¥ 27.2 ° §®¡° ­ ª« ±±¨·¥±ª¨© ¬¥²®¤ ®°¤ { «ª¥°±®­ . £® ¨±¯®«¼§®¢ ­¨¥ ¤«¿ ¯®¨±ª ¬ ª±¨¬ «¼­®£® ¯ °®±®·¥² ­¨¿ ¢ ¤¢³¤®«¼­®¬ ­¥®°¨¥­²¨°®¢ ­­®¬ £° ´¥ ®¯¨± ­® ¢ ° §¤¥«¥ 27.3.  §¤¥« 27.4 ¨§« £ ¥² ±µ¥¬³ À¯°®² «ª¨¢ ­¨¿ ¯°¥¤¯®²®ª Á ª®²®° ¿ ¨±¯®«¼§³¥²±¿ ¢® ¬­®£¨µ ±®¢°¥¬¥­­»µ
 «£®°¨²¬ µ ¤«¿ °¥¸¥­¨¿ § ¤ · ® ¯®²®ª µ ¢ ±¥²¿µ. ¤¨­ ¨§ ² ª¨µ
 «£®°¨²¬®¢ ®¯¨± ­ ¢ ° §¤¥«¥ 27.5. ®²¿ ®­ ¨ ­¥ ± ¬»© ¡»±²°»© ¨§
¨§¢¥±²­»µ (¢°¥¬¿ ° ¡®²» O(V 3 )), ­® ®­ ¨±¯®«¼§³¥² ²¥ ¦¥ ¨¤¥¨, ·²®
¨ ± ¬»¥ ¡»±²°»¥  «£®°¨²¬», ¨ ¤®±² ²®·­® ½´´¥ª²¨¢¥­ ­  ¯° ª²¨ª¥.

®²®ª¨ ¢ ±¥²¿µ

553

27.1. ®²®ª¨ ¢ ±¥²¿µ
 ½²®¬ ° §¤¥«¥ ¬» ¤ ¤¨¬ ²®·­®¥ ®¯°¥¤¥«¥­¨¥ ±¥²¥© ¨ ¯®²®ª®¢ ¢
­¨µ, ®¡±³¤¨¬ ¨µ ±¢®©±²¢ , ±´®°¬³«¨°³¥¬ § ¤ ·³ ® ¬ ª±¨¬ «¼­®¬
¯®²®ª¥ ¨ ¢¢¥¤¥¬ ­¥ª®²®°»¥ ¯®«¥§­»¥ ®¡®§­ ·¥­¨¿.
¥²¨ ¨ ¯®²®ª¨
H §®¢¥¬ ±¥²¼¾ (ow network) ®°¨¥­²¨°®¢ ­­»© £° ´ G = (V; E ),
ª ¦¤®¬³ °¥¡°³ (u; v ) 2 E ª®²®°®£® ¯®±² ¢«¥­® ¢ ±®®²¢¥²±²¢¨¥ ·¨±«® c(u; v ) > 0, ­ §»¢ ¥¬®¥ ¯°®¯³±ª­®© ±¯®±®¡­®±²¼¾ (capacity)
°¥¡° .  ±«³· ¥ (u; v ) 2= E ¬» ¯®« £ ¥¬ c(u; v ) = 0.  £° ´¥ ¢»¤¥«¥­» ¤¢¥ ¢¥°¸¨­»: ¨±²®ª (source) s ¨ ±²®ª (sink) t. «¿ ³¤®¡±²¢ 
¬» ¯°¥¤¯®«£ ¥¬, ·²® ¢ £° ´¥ ­¥² À¡¥±¯®«¥§­»µÁ ¢¥°¸¨­ (ª ¦¤ ¿
¢¥°¸¨­  v 2 V «¥¦¨² ­  ª ª®¬-²® ¯³²¨ s v t ¨§ ¨±²®ª  ¢
±²®ª). ( ² ª®¬ ±«³· ¥ £° ´ ±¢¿§¥­ ¨ jE j > jV j ; 1.) °¨¬¥° ±¥²¨
¯®ª § ­ ­  °¨±.27.1.
¥¯¥°¼ ¤ ¤¨¬ ®¯°¥¤¥«¥­¨¥ ¯®²®ª . ³±²¼ ¤ ­  ±¥²¼ G = (V; E ),
¯°®¯³±ª­ ¿ ±¯®±®¡­®±²¼ ª®²®°®© § ¤ ¥²±¿ ´³­ª¶¨¥© c. ¥²¼ ¨¬¥¥²
¨±²®ª s ¨ ±²®ª t. ®²®ª®¬ (ow) ¢ ±¥²¨ G ­ §®¢¥¬ ´³­ª¶¨¾ f :
V  V ! R, ³¤®¢«¥²¢®°¿¾¹³¾ ²°¥¬ ±¢®©±²¢ ¬:
£° ­¨·¥­¨¥, ±¢¿§ ­­®¥ ± ¯°®¯³±ª­®© ±¯®±®¡­®±²¼¾ (capacity
constraint): f (u; v ) 6 c(u; v ). ¤«¿ ¢±¥µ u; v ¨§ V .
®±®±¨¬¬¥²°¨·­®±²¼ (skew symmetry): f (u; v ) = ;f (v; u) ¤«¿
¢±¥µ u; v ¨§ V .
®µ° ­¥­¨¥ ¯®²®ª  (ow conservation):
X
f (u; v ) = 0:
v2V

¤«¿ ¢±¥µ u ¨§ V ; fs; tg.
¥«¨·¨­  f (u; v ) ¬®¦¥² ¡»²¼ ª ª ¯®«®¦¨²¥«¼­®©, ² ª ¨ ®²°¨¶ ²¥«¼­®©. ­  ®¯°¥¤¥«¿¥², ±ª®«¼ª® ¢¥¹¥±²¢  ¤¢¨¦¥²±¿ ¨§ ¢¥°¸¨­»
u ¢ ¢¥°¸¨­³ v (®²°¨¶ ²¥«¼­»¥ §­ ·¥­¨¿ ±®®²¢¥²±²¢³¾² ¤¢¨¦¥­¨¾
¢ ®¡° ²­³¾ ±²®°®­³).
¥«¨·¨­  (value) ¯®²®ª  f ®¯°¥¤¥«¿¥²±¿ ª ª ±³¬¬ 
X
f (s; v):
(27:1)
v2V

(±ª« ¤»¢ ¥¬ ¯®²®ª¨ ¯® ¢±¥¬ °¥¡° ¬, ¢»µ®¤¿¹¨¬ ¨§ ¨±²®ª ). ­ 
®¡®§­ · ¥²±¿ jf j (­¥ ±¯³² ©²¥ ±  ¡±®«¾²­®© ¢¥«¨·¨­®© ·¨±« !).  ¤ ·  ® ¬ ª±¨¬ «¼­®¬ ¯®²®ª¥ (maximum-ow problem) ±®±²®¨² ¢
±«¥¤³¾¹¥¬: ¤«¿ ¤ ­­®© ±¥²¨ G ± ¨±²®ª®¬ s ¨ ±²®ª®¬ t ­ ©²¨ ¯®²®ª
¬ ª±¨¬ «¼­®© ¢¥«¨·¨­».
®¿±­¨¬ ±¬»±« ²°¥µ ­ ¸¨µ ±¢®©±²¢. ¥°¢®¥ ®§­ · ¥², ·²® ¯®²®ª
¨§ ®¤­®© ¢¥°¸¨­» ¢ ¤°³£³¾ ­¥ ¯°¥¢»¸ ¥² ¯°®¯³±ª­®© ±¯®±®¡­®±²¨ °¥¡° . ²®°®¥ ¯°¥¤±² ¢«¿¥² ±®¡®© ±®£« ¸¥­¨¥ ® ²®¬, ·²® ®²°¨¶ ²¥«¼­»¥ ·¨±«  ±®®²¢¥²±²¢³¾² ¯®²®ª³ ¢ ®¡° ²­³¾ ±²®°®­³. §

554

« ¢  27  ª±¨¬ «¼­»© ¯®²®ª
¨±. 27.1 27.1. ( ) ¥²¼ G = (V; E ), ®¯¨±»¢ ¾¹¨¥ ¢®§¬®¦­®±²¨ ¯¥°¥¢®§®ª ¯°®¤³ª¶¨¨ ´¨°¬» À«¥­®¢»¥ «¨±²¼¿Á. ±²®ª s | ´ ¡°¨ª  ¢  ­ª³¢¥°¥, ±²®ª t |
±ª« ¤ ¢ ¨­­¨¯¥£¥.   ª ¦¤®¬ °¥¡°¥ ­ ¯¨± ­® ¬ ª±¨¬ «¼­®¥ ·¨±«® ¿¹¨ª®¢,
ª®²®°»¥ ¬®¦­® ®²¯° ¢¨²¼ ¢ ¤¥­¼. (b) °¨¬¥° ¯®²®ª  f ¢ ±¥²¨ G ¢¥«¨·¨­»
19. ®ª § ­» ²®«¼ª® ¯®«®¦¨²¥«¼­»¥ §­ ·¥­¨¿ f (u; v) > 0 (¯®±«¥ ª®±®© ·¥°²»
±²®¨² ¯°®¯³±ª­ ¿ ±¯®±®¡­®±²¼ c(u;v).

­¥£® ±«¥¤³¥² ² ª¦¥, ·²® f (u; u) = 0 ¤«¿ «¾¡®© ¢¥°¸¨­» u (¯®«®¦¨¬ u = v ). °¥²¼¥ ±¢®©±²¢® ®§­ · ¥², ·²® ¤«¿ «¾¡®© ¢¥°¸¨­»
u (ª°®¬¥ ±²®ª  ¨ ¨±²®ª ) ±³¬¬  ¯®²®ª®¢ ¢® ¢±¥ ¤°³£¨¥ ¢¥°¸¨­»
° ¢­  ­³«¾. ·¨²»¢ ¿ ª®±®±¨¬¬¥²°¨·­®±²¼, ½²® ±¢®©±²¢® ¬®¦­®
¯¥°¥¯¨± ²¼ ª ª
X
f (u; v) = 0
u2V

(²¥¯¥°¼ ¯¥°¥¬¥­­ ¿ ±³¬¬¨°®¢ ­¨¿ ®¡®§­ ·¥­  u) ¨ ¯°®·¥±²¼ ² ª:
À±³¬¬  ¢±¥µ ¯®²®ª®¢ ¨§ ¤°³£¨µ ¢¥°¸¨­ ° ¢­  ­³«¾Á.
 ¬¥²¨¬ ² ª¦¥, ·²® ¥±«¨ ¢¥°¸¨­» u ¨ v ­¥ ±®¥¤¨­¥­» °¥¡°®¬,
²® ¯®²®ª ¬¥¦¤³ ­¨¬¨, ²® ¥±²¼ f (u; v ), ° ¢¥­ ­³«¾. ¥©±²¢¨²¥«¼­®,
¥±«¨ (u; v ) 2= E ¨ (v; u) 2= E , ²® c(u; v ) = c(v; u) = 0. ®£¤  ¨§ ¯¥°¢®£®
±¢®©±²¢  ±«¥¤³¥², ·²® f (u; v ) 6 0 ¨ f (v; u) 6 0. ±¯®¬¨­ ¿, ·²®
f (u; v ) = ;f (v; u) (ª®±®±¨¬¬¥²°¨·­®±²¼), ¬» ¢¨¤¨¬, ·²® f (u; v) =
f (v; u) = 0.
 §¤¥«¨¬ ¢¥¹¥±²¢®, ¯®±²³¯ ¾¹¥¥ ¢ ¤ ­­³¾ ¢¥°¸¨­³ v ¨ ¢¥¹¥±²¢®, ¨§ ­¥¥ ¢»µ®¤¿¹¥¥ (²® ¥±²¼ ¯®«®¦¨²¥«¼­»¥ ¨ ®²°¨¶ ²¥«¼­»¥
§­ ·¥­¨¿ f (u; v )). ³¬¬³
X

u2V
f (u;v)>0

f (u; v ):

(27:2)

­ §®¢¥¬ ¢µ®¤¿¹¨¬ (¢ ¢¥°¸¨­³ v ) ¯®²®ª®¬. »µ®¤¿¹¨© ¯®²®ª ®¯°¥¤¥«¿¥²±¿ ±¨¬¬¥²°¨·­®. ¥¯¥°¼ § ª®­ ±®µ° ­¥­¨¿ ¯®²®ª  ¬®¦­®
±´®°¬³«¨°®¢ ²¼ ² ª: ¤«¿ «¾¡®© ¢¥°¸¨­», ª°®¬¥ ¨±²®ª  ¨ ±²®ª ,
¢µ®¤¿¹¨© ¯®²®ª ° ¢¥­ ¨±µ®¤¿¹¥¬³.
°¨¬¥° ±¥²¨
 ±±¬®²°¨¬ ¯°¨¬¥° ­  °¨±. 27.1 ( ). ®¬¯ ­¨¿ À«¥­®¢»¥ «¨±²¼¿Á ¯°®¨§¢®¤¨² µ®ªª¥©­»¥ ¸ ©¡» ­  ´ ¡°¨ª¥ ¢  ­ª³¢¥°¥ (¨±²®ª
s) ¨ ±ª« ¤¨°³¥² ¨µ ¢ ¨­­¨¯¥£¥ (±²®ª t). ­   °¥­¤³¥² ¬¥±²® ¢
£°³§®¢¨ª µ ¤°³£®© ´¨°¬», ¨ ¬¥±²® ½²® ®£° ­¨·¥­®: ¨§ £®°®¤  u
¢ £®°®¤ v ¬®¦­® ¤®±² ¢¨²¼ ­¥ ¡®«¥¥ c(u; v ) ¿¹¨ª®¢ ¢ ¤¥­¼. £° ­¨·¥­¨¿ c(u; v ) ¯®ª § ­» ­  °¨±³­ª¥.  ¤ ·  ±®±²®¨² ¢ ²®¬, ·²®¡»
¯¥°¥¢®§¨²¼ ¬ ª±¨¬ «¼­® ¢®§¬®¦­®¥ ª®«¨·¥±²¢® ¸ ©¡ ¨§  ­ª³¢¥° 
¢ ¨­­¨¯¥£ ¥¦¥¤­¥¢­®. °¨ ½²®¬ ¯³²¼ ¬®¦¥² § ­¨¬ ²¼ ­¥±ª®«¼ª®
¤­¥©, ¨ ¿¹¨ª¨ ¬®£³² ¦¤ ²¼ ®²¯° ¢ª¨ ¢ ¯°®¬¥¦³²®·­»µ ¯³­ª² µ,
­® ­¥®¡µ®¤¨¬®, ·²®¡» ¤«¿ ª ¦¤®£® ¯³­ª²  ·¨±«® ¥¦¥¤­¥¢­® ¯°¨¡»¢ ¾¹¨µ ¿¹¨ª®¢ ¡»«® ° ¢­® ·¨±«³ ³¢®§¨¬»µ (¨­ ·¥ ¿¹¨ª®¢ ­¥

®²®ª¨ ¢ ±¥²¿µ

555

27.2 ®ª° ¹¥­¨¥. (a) ¥°¸¨­» v1 ¨ v2 . ¤¥±¼ c(v1 ; v2 ) = 10 ¨
c(v2 ; v1 ) = 4. (b) ¦¥¤­¥¢­® 8 ¿¹¨ª®¢ ¯¥°¥¢®§¿² ¨§ v1 ¢ v2 . (c) ®¡ ¢¨«¨ ¢±²°¥·­»¥ ¯¥°¥¢®§ª¨ 3 ¿¹¨ª®¢ ¢ ¤¥­¼ ¨§ v2 ¢ v1 . (d) ®ª° ²¨«¨ ¯°®²¨¢®¯®«®¦­»¥
¨±. 27.2

¯®²®ª¨ | ®±² «®±¼ 5 ¿¹¨ª®¢ ¢ ¤¥­¼. (¥) ®¡ ¢¨«¨ ¯¥°¥¢®§ª³ ¥¹¥ 7 ¿¹¨ª®¢ ¢
¤¥­¼ ¨§ v2 ¢ v1 .
¨±. 27.3 27.3  ¤ ·  ® ¬ ª±¨¬ «¼­®¬ ¯®²®ª  ¤«¿ ­¥±ª®«¼ª¨µ ¨±²®ª®¢ ¨ ±²®ª®¢
±¢®¤¨²±¿ ª ®¡»·­®©. (a) ¥²¼ ± ¯¿²¼¾ ¨±²®ª ¬¨ S = fs1 ; s2 ; s3 ; s4 ; s5 g ¨ ²°¥¬¿
±²®ª ¬¨ T = ft1 ; t2 ; t3 g. (b) ®®®²¢¥²±²¢³¾¹ ¿ ±¥²¼ ± ®¤­¨¬ ¨±²®ª®¬ ¨ ®¤­¨¬
±²®ª®¬; ¤®¡ ¢«¥­­»¥ °¥¡°  ¨¬¥¾² ¡¥±ª®­¥·­³¾ ¯°®¯³±ª­³¾ ±¯®±®¡­®±²¼.

µ¢ ²¨² ¨«¨ ®­¨ ¡³¤³² ­ ª ¯«¨¢ ²¼±¿). ¥¬ ± ¬»¬ ¢»¯®«­¥­® ±¢®©±²¢® ±®µ° ­¥­¨¿ ¯®²®ª . ¥«¨·¨­®© ¯®²®ª  ¡³¤¥² ·¨±«® ¸ ©¡, ¥¦¥¤­¥¢­® ®²£°³¦ ¥¬»µ ¨§  ­ª³¢¥° , ¨ ­ ± ¨­²¥°¥±³¥² ¯®²®ª ¬ ª±¨¬ «¼­®© ¢¥«¨·¨­».
¤¨­ ¨§ ¢®§¬®¦­»µ ¯®²®ª®¢ ¯®ª § ­ ­  °¨±.27.1(b). § ¢¥°¸¨­» u ¢ ¢¥°¸¨­³ v ¢ ¤¥­¼ ®²¯° ¢«¿¥²±¿ f (u; v ) ¿¹¨ª®¢; ¥±«¨ f (u; v )
° ¢­® 0, ¿¹¨ª¨ ­¥ ®²¯° ¢«¿¾²±¿; ®²°¨¶ ²¥«¼­»¥ §­ ·¥­¨¿ f (u; v )
±®®²¢¥²±²¢³¾² ¿¹¨ª ¬, ¯°¨¡»¢ ¾¹¨¬ ¢ u ¨§ v .
­¨¬ ²¥«¼­»© ·¨² ²¥«¼ ¬®£ ³¦¥ § ¬¥²¨²¼, ·²® °¥ «¼­ ¿ ±¨²³ ¶¨¿ ­¥ ¢¯®«­¥ ®¯¨±»¢ ¥²±¿ ­ ¸¥© ¬®¤¥«¼¾. ¬¥­­®, ­ ¸  ¬®¤¥«¼
­¥ ³·¨²»¢ ¥² ¢±²°¥·­»¥ ¯¥°¥¢®§ª¨. ±«¨ ¨§ ¢¥°¸¨­» v1 ¢ v2 ¥¦¥¤­¥¢­® ¢¥§³² ¢®±¥¬¼ ¿¹¨ª®¢,   ¨§ v2 ¢ v1 ¥¦¥¤­¥¢­® ¢¥§³² ²°¨
¿¹¨ª , ·¥¬³ ¤®«¦­» ¡»²¼ ° ¢­» f (v1 ; v2) ¨ f (v2; v1)? ( ¯®¬­¨¬,
·²® ½²¨ ¢¥«¨·¨­» ¤®«¦­» ¡»²¼ ¯°®²¨¢®¯®«®¦­».) » ¯®« £ ¥¬
f (v1 ; v2) = 8 ; 3 = 5,   f (v2; v1) = ;5. ¥ ¦¥ §­ ·¥­¨¿ ´³­ª¶¨¨
f ±®®²¢¥²±²¢³¾² ¥¦¥¤­¥¢­»¬ ¯¥°¥¢®§ª ¬ ¯¿²¨ ¿¹¨ª®¢ ¨§ v1 ¢ v2,
² ª ·²® ¢ ­ ¸¥© ¬®¤¥«¨ ¢±²°¥·­»¥ ¯¥°¥¢®§ª¨  ¢²®¬ ²¨·¥±ª¨ ±®ª° ¹ ¾²±¿. ¯°®·¥¬, ¨ ¢ °¥ «¼­®±²¨ ¢±²°¥·­»¥ ¯¥°¥¢®§ª¨ ° §³¬­®
À±®ª° ²¨²¼Á ¤°³£ ± ¤°³£®¬, (½ª®­®¬¨ª  ¤®«¦­  ¡»²¼ ½ª®­®¬­®©),
¯°¨ ½²®¬ ¬¥±²  ­  £°³§®¢¨ª µ ¯®­ ¤®¡¨²±¿ ²®«¼ª® ¬¥­¼¸¥.
H  °¨±. 27.2 ¯®ª § ­ ¯°¨¬¥° ±®ª° ¹¥­¨¿ ¯®²®ª®¢ ¬¥¦¤³ ¢¥°¸¨­ ¬¨ v1 ¨ v2 (27.2 (a)). ­ · «  ¨§ v1 ¢ v2 ¢®§¨«¨ ¥¦¥¤­¥¢­® 8
¿¹¨ª®¢ (27.2 (b)).  ²¥¬ ±² «¨ ¢®§¨²¼ 3 ¿¹¨ª  ¢ ®¡° ²­®¬ ­ ¯° ¢«¥­¨¨ (27.2 (c)), ¯®ª  ­¥ ¤®£ ¤ «¨±¼ ¢¬¥±²® ½²®£® ³¬¥­¼¸¨²¼ ·¨±«® ¯¥°¥¢®§¨¬»µ ¢ ®¡° ²­³¾ ±²®°®­³ ¿¹¨ª®¢ ­  3 (27.2 (d)). ²¨
¤¢¥ ° §«¨·­»¥ (¢ ¦¨§­¨) ±¨²³ ¶¨¨ ±®®²¢¥²±²¢³¾² ®¤­®© ¨ ²®© ¦¥
´³­ª¶¨¨ f : ¢ ®¡®¨µ ±«³· ¿µ f (v1; v2) = 5,   f (v2; v1) = ;5. ±«¨
²¥¯¥°¼ °³ª®¢®¤±²¢® ²°¥¡³¥² ­ · ²¼ ¯¥°¥¢®§ª¨ ¤®¯®«­¨²¥«¼­»µ 7
¿¹¨ª®¢ ¢ ¤¥­¼ ¨§ v2 ¢ v1 , ²® ­³¦­® ¯°¥¦¤¥ ¢±¥£® ®²¬¥­¨²¼ ¯¥°¥¢®§ª¨ 5 ¿¹¨ª®¢ ¢ ®¡° ²­³¾ ±²®°®­³, ¯®±«¥ ·¥£® ­ §­ ·¨²¼ ¯¥°¥¢®§ª³
¤®¯®«­¨²¥«¼­»µ 2 ¿¹¨ª®¢ (27.2 (e)). ¥¬ ± ¬»¬ ²°¥¡®¢ ­¨¥ ¡³¤¥²
¢»¯®«­¥­® (­¥±¬®²°¿ ­  ²®, ª±² ²¨, ·²® ¢ £°³§®¢¨ª µ ¨§ v2 ¢ v1
¥±²¼ ¬¥±²  ²®«¼ª® ­  4 ¿¹¨ª .
¥²¨ ± ­¥±ª®«¼ª¨¬¨ ¨±²®ª ¬¨ ¨ ±²®ª ¬¨
®¦­® ° ±±¬ ²°¨¢ ²¼ § ¤ ·³ ® ¬ ª±¨¬ «¼­®¬ ¯®²®ª¥ ¤«¿ ±«³-

556

« ¢  27  ª±¨¬ «¼­»© ¯®²®ª

· ¿ ­¥±ª®«¼ª¨µ ¨±²®ª®¢ ¨ ±²®ª®¢. ®¬¯ ­¨¿ À«¥­®¢»¥ «¨±²¼¿Á
¬®¦¥² ¨¬¥²¼ m ´ ¡°¨ª fs1 ; s2; : : :sm g ¨ n ±ª« ¤®¢ ft1 ; t2; : : :; tn g
(°¨±. 27.3 ( )). H® ½²® ­¥ ³±«®¦­¿¥² ¤¥« , ¯®²®¬³ ·²® ² ª®© ¢ °¨ ­² ¯°®¡«¥¬» ¬®¦­® ±¢¥±²¨ ª ®¡»·­®¬³. H  °¨±. 27.3 (b) ¯®ª § ­ 
½ª¢¨¢ «¥­²­ ¿ ±¥²¼ ± ®¤­¨¬ ¨±²®ª®¬ ¨ ®¤­¨¬ ±²®ª®¬. » ¤®¡ ¢¨«¨
®¡¹¨© ¨±²®ª (supersource) s, ¨§ ª®²®°®£® ¢¥¤³² °¥¡°  ¡¥±ª®­¥·­®©
¯°®¯³±ª­®© ±¯®±®¡­®±²¨ ¢® ¢±¥ ¯°¥¦­¨¥ ¨±²®ª¨ (c(s; si) = 1 ¯°¨
¢±¥µ i = 1; 2; : : :; m). ­ «®£¨·­»¬ ®¡° §®¬ ¨§ ¢±¥µ ¯°¥¦­¨µ ±²®ª®¢ ¯°®¢¥¤¥­» °¥¡°  ¢ ®¡¹¨© ±²®ª (supersink) t. ¥£ª® ¢¨¤¥²¼, ·²®
ª ¦¤»© ¯®²®ª ¢ ±¥²¨ (a) ±®®²¢¥²±²¢³¥² ¯®²®ª³ ¢ ±¥²¨ (b) ¨ ­ ®¡®°®² (´®°¬ «¼­®¥ ¤®ª § ²¥«¼±²¢® ®±² ¢«¿¥²±¿ ·¨² ²¥«¾ ¢ ª ·¥±²¢¥
³¯°. 27.1-3)
¡®§­ ·¥­¨¿
» ¡³¤¥¬ ¨±¯®«¼§®¢ ²¼ ±«¥¤³¾¹¥¥ ±®£« ¸¥­¨¥: ¥±«¨ ¢ ¢»° ¦¥­¨¨ ­  ¬¥±²¥ ¢¥°¸¨­» ±²®¨² ¬­®¦¥±²¢® ¢¥°¸¨­, ²® ¨¬¥¥²±¿ ¢ ¢¨¤³
±³¬¬  ¯® ¢±¥¬ ½«¥¬¥­² ¬ ½²®£® ¬­®¦¥±²¢  (­¥¿¢­®¥ ±³¬¬¨°®¢ ­¨¥,
inplicit summary notation). ²® ®²­®±¨²±¿ ¨ ª ±«³· ¾ ­¥±ª®«¼ª¨µ
¯¥°¥¬¥­­»µ. H ¯°¨¬¥°, ¥±«¨ X ¨ Y | ¬­®¦¥±²¢  ¢¥°¸¨­, ²®

f (X; Y ) =

XX

x2X y2Y

f (x; y ):

 ½²¨µ ®¡®§­ ·¥­¨¿µ § ª®­ ±®µ° ­¥­¨¿ ¯®²®ª  § ¯¨¸¥²±¿ ª ª
f (u; V ) = 0 ¤«¿ ¢±¥µ u 2 V ; fs; tg. °®¬¥ ²®£®, ¢ ­¥¿¢­»µ
±³¬¬ µ ¬» ®¯³±ª ¥¬ ´¨£³°­»¥ ±ª®¡ª¨ (­ ¯°¨¬¥°, ¢ ° ¢¥­±²¢¥
f (s; V n s) = f (s; V ) ±¨¬¢®« V n s ®¡®§­ · ¥² V n fsg.
®² ­¥±ª®«¼ª® ¯®«¥§­»µ ±¢®©±²¢ ² ª¨µ ±³¬¬ (¤®ª § ²¥«¼±²¢® ¬»
®±² ¢«¿¥¬ ·¨² ²¥«¾ ª ª ³¯°. 27.1-4):
¥¬¬  27.1
³±²¼ f | ¯®²®ª ¢ ±¥²¨ G = (V; E ). ®£¤  ¤«¿ «¾¡®£® X  V
¢»¯®«­¥­®
f (X; X ) = 0:
«¿ «¾¡»µ X; Y  V ¢»¯®«­¥­®

f (X; Y ) = ;f (Y; X ):
«¿ «¾¡»µ X; Y; Z  V ¨§ X \ Y = ; ±«¥¤³¥²
f (X [ Y; Z ) = f (X; Z ) + f (Y; Z )
¨

f (Z; X [ Y ) = f (Z; X ) + f (Z; Y ):

«¿ ¯°¨¬¥°  ¤®ª ¦¥¬ ± ¨±¯®«¼§®¢ ­¨¥¬ ² ª¨µ ®¡®§­ ·¥­¨©, ·²®
¢¥«¨·¨­  ¯®²®ª  ° ¢­  ±³¬¬¥ ¯®²®ª®¢ ¨§ ¢±¥µ ¢¥°¸¨­ ¢ ±²®ª:

jf j = f (V; t):

(27:3)

®²®ª¨ ¢ ±¥²¿µ

557

­²³¨²¨¢­® ½²® ¿±­® (ª³¤  ¦ ¥¬³ ¥¹¥ ¤¥¢ ²¼±¿), ­® ¬®¦­® ¯°®¢¥±²¨ ¨ ´®°¬ «¼­®¥ ° ±±³¦¤¥­¨¥. ®² ®­®:
® ®¯°¥¤¥«¥­¨¾,
jf j = f (s; V )
°¨¬¥­¿¿ «¥¬¬³ 27.1, ¨¬¥¥¬

f (s; V ) = f (V; V ) ; f (V n s; V ) = f (V; V n s) = f (V; t) + f (V; V n s n t):
® § ª®­³ ±®µ° ­¥­¨¿ ¯®²®ª  ¢²®°®¥ ±« £ ¥¬®¥ ° ¢­® 0, ¨ ®±² ¥²±¿

f (V; t).

¡®¡¹¥­¨¥ «¥¬¬» 27.1 ¡³¤¥² ¤®ª § ­® ­¨¦¥ («¥¬¬  27.5)
¯° ¦­¥­¨¿
27.1-1
«¥¤³¿ ®¡° §¶³ °¨±. 27.2, ¨§®¡° §¨²¥ ¤¢¥ ¢¥°¸¨­» u ¨ v , ¤«¿
ª®²®°»µ c(u; v ) = 5, c(v; u) = 8, ¨§ u ¢ v ¯¥°¥±»« ¾²±¿ 3 ¥¤¨­¨¶»,
  ¨§ v ¢ u | 4. ¥¬³ ° ¢¥­ ¯®²®ª ¨§ u ¢ v ?
27.1-2
°®¢¥°¼²¥, ·²® ´³­ª¶¨¿ f °¨±.27.1 (b) ¤¥©±²¢¨²¥«¼­® ¿¢«¿¥²±¿
¯®²®ª®¬.
27.1-3
 ª ¯°¨±¯®±®¡¨²¼ ®¯°¥¤¥«¥­¨¥ ¯®²®ª  ¤«¿ ±«³· ¿ ­¥±ª®«¼ª¨µ
¨±²®ª®¢ ¨ ±²®ª®¢? ®ª ¦¨²¥, ·²® § ¤ ·  ® ¬ ª±¨¬ «¼­®¬ ¯®²®ª¥ ¤«¿ ² ª®£® ±«³· ¿ ±¢®¤¨²±¿ ª ®¡»·­®© ± ¯®¬®¹¼¾ ®¯¨± ­­®£®
­ ¬¨ ¯°¨¥¬ .
27.1-4
®ª ¦¨²¥ «¥¬¬³ 27.1.
27.1-5
«¿ ±¥²¨ G = (V; E ) ¨ ¯®²®ª  f ­  °¨±.27.1 (b), ³ª ¦¨²¥ ¯°¨¬¥°
¯®¤¬­®¦¥±²¢ X; Y  V , ¤«¿ ª®²®°»µ f (X; Y ) = ;f (V n X; Y ,  
² ª¦¥ ¯®¤¬­®¦¥±²¢ X; Y  V , ¤«¿ ª®²®°»µ f (X; Y ) 6= ;f (V n X; Y .
27.1-6
³±²¼ ¨¬¥¥²±¿ ±¥²¼ G = (V; E ) ¨ ¤¢  ¯®²®ª  f1 ¨ f2 ­  ­¥©.
 ±±¬®²°¨¬ ¨µ ±³¬¬³ (´³­ª¶¨¾ ¨§ V  V ¢ R):
(f1 + f2 )(u; v ) = f1 (u; v ) + f2(u; v )

(27:4)

 ª¨¬ ²°¥¡®¢ ­¨¿¬ ¨§ ®¯°¥¤¥«¥­¨¿ ¯®²®ª  ®­  ³¤®¢«¥²¢®°¿¥² ®¡¿§ ²¥«¼­®,   ª ª¨¬ ¬®¦¥² ­¥ ³¤®¢«¥²¢®°¿²¼?
27.1-7
®²®ª f ¬®¦­® ³¬­®¦¨²¼ ­  ¢¥¹¥±²¢¥­­®¥ ·¨±«® , ¯®«³·¨¢
´³­ª¶¨¾
(f )(u; v ) =   f (u; v )
®ª ¦¨²¥, ·²® ¤«¿ «¾¡®© ±¥²¨ ¬­®¦¥±²¢® ¯®²®ª®¢ ¢»¯³ª«®. ²®
§­ ·¨², ·²® ¥±«¨ f1 ¨ f2 | ¯®²®ª¨, ²® ±³¬¬  f1 + (1 ; )f2 ¯°¨
0 6  6 1 ²®¦¥ ¿¢«¿¥²±¿ ¯®²®ª®¬.
27.1-8

558

« ¢  27  ª±¨¬ «¼­»© ¯®²®ª

´®°¬³«¨°³©²¥ § ¤ ·³ ® ¬ ª±¨¬ «¼­®¬ ¯®²®ª¥ ª ª § ¤ ·³ «¨­¥©­®£® ¯°®£° ¬¬¨°®¢ ­¨¿.
27.1-9
 ±±¬®²°¨¬ ±¥²¼ ± ­¥±ª®«¼ª¨¬¨ ¢¥¹¥±²¢ ¬¨ (multicommodity
ow network) ¢ ª®²®°®© ¨¬¥¾²±¿ ¯®²®ª¨ p ¢¥¹¥±²¢, ¤«¿ ª ¦¤®£®
¨§ ª®²®°»µ ¥±²¼ ±¢®© ¨±²®ª ¨ ±¢®© ±²®ª. «¿ ª ¦¤®£® ¢¥¹¥±²¢ 
¥±²¼ ±¢®© § ª®­ ±®µ° ­¥­¨¿ ¯®²®ª ,   ¯°®¯³±ª­ ¿ ±¯®±®¡­®±²¼ ®¤­  ­  ¢±¥µ (±³¬¬  ¯®²®ª®¢ ¢±¥µ ¢¥¹¥±²¢ ¨§ u ¢ v ­¥ ¤®«¦­  ¯°¥¢»¸ ²¼ c(u; v ). «¿ ª ¦¤®£® ¢¥¹¥±²¢  ¨¬¥¥²±¿ ±¢®¿ ¢¥«¨·¨­  ¯®²®ª ; ±ª« ¤»¢ ¿ ½²¨ ¢¥«¨·¨­», ¯®«³·¨¬ ±³¬¬ °­³¾ ¢¥«¨·¨­³ (total
ow value) ¯®²®ª . ®ª ¦¨²¥, ·²® ¯®²®ª ¬ ª±¨¬ «¼­®© ±³¬¬ °­®©
¢¥«¨·¨­» ¬®¦­® ­ ©²¨ §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿, ¯°¥¤±² ¢¨¢ ½²³
§ ¤ ·³ ª ª § ¤ ·³ «¨­¥©­®£® ¯°®£° ¬¬¨°®¢ ­¨¿. (¾¡ ¿ § ¤ · 
«¨­¥©­®£® ¯°®£° ¬¬¨°®¢ ­¨¿ ° §°¥¸¨¬  §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿: ½²®² ´ ª² ¬» ³¯®¬¨­ «¨ ¢ ° §¤¥«¥ 25.5.)

27.2. ¥²®¤ ®°¤ { «ª¥°±®­ 
 ½²®¬ ° §¤¥«¥ ¬» ° ±±¬®²°¨¬ ¬¥²®¤ ®°¤ { «ª¥°±®­  ®²»±ª ­¨¿ ¬ ª±¨¬ «¼­®£® ¯®²®ª . » £®¢®°¨¬ ® ¬¥²®¤¥,   ­¥ ®¡  «£®°¨²¬¥, ¯®±ª®«¼ª³ ¥±²¼ ­¥±ª®«¼ª®  «£®°¨²¬®¢, ¥£® °¥ «¨§³¾¹¨µ ¨
®²«¨· ¾¹¨µ±¿ ¢°¥¬¥­¥¬ ° ¡®²». ¤­  ¨§ ² ª¨µ °¥ «¨§ ¶¨© ¯°¨¢¥¤¥­  ¢ ª®­¶¥ ° §¤¥« . «¾·¥¢³¾ °®«¼ ¢ ¬¥²®¤¥ ®¤ { «ª¥°±®­ 
¨£° ¾² ²°¨ ¯®­¿²¨¿: ®±² ²®·­»¥ ±¥²¨, ¤®¯®«­¿¾¹¨¥ ¯³²¨ ¨ ° §°¥§». ±­®¢­ ¿ ²¥®°¥¬  | ²¥®°¥¬  27.7 ® ¬ ª±¨¬ «¼­®¬ ¯®²®ª¥ ¨
¬¨­¨¬ «¼­®¬ ° §°¥§¥.
®¨±ª ¬ ª±¨¬ «¼­®£® ¯®²®ª  ¬¥²®¤®¬ ®°¤ { «ª¥°±®­  ¯°®¢®¤¨²±¿ ¯®±«¥¤®¢ ²¥«¼­®. ­ · «¥ ¯®²®ª ­³«¥¢®© (¨ ¢¥«¨·¨­  ¥£®
° ¢­  ­³«¾).   ª ¦¤®¬ ¸ £¥ ¬» ³¢¥«¨·¨¢ ¥¬ §­ ·¥­¨¥ ¯®²®ª .
«¿ ½²®£® ¬» ­ µ®¤¨¬ À¤®¯®«­¿¾¹¨© ¯³²¼Á, ¯® ª®²®°®¬³ ¬®¦­®
¯°®¯³±²¨²¼ ¥¹¥ ­¥¬­®£® ¢¥¹¥±²¢ , ¨ ¨±¯®«¼§³¥¬ ¥£® ¤«¿ ³¢¥«¨·¥­¨¿ ¯®²®ª . ²®² ¸ £ ¯®¢²®°¿¥²±¿, ¯®ª  ¥±²¼ ¤®¯®«­¿¾¹¨¥ ¯³²¨.
 ª ¯®ª ¦¥² ²¥®°¥¬  ® ¬ ª±¨¬ «¼­®¬ ¯®²®ª¥ ¨ ¬¨­¨¬ «¼­®¬ ° §°¥§¥, ¯®«³·¥­­»© ¯®²®ª ¡³¤¥² ¬ ª±¨¬ «¼­»¬.  ¯¨¸¥¬ ½²®² ¯« ­
± ¯®¬®¹¼¾ ¯±¥¢¤®ª®¤ :
Ford-Fulkerson-Method($G,s,t$)
1 ¯®«®¦¨²¼ ¯®²®ª $f$ ° ¢­»¬ $0$
2 while (¯®ª ) ±³¹¥±²¢³¥² ¤®¯®«­¿¾¹¨© ¯³²¼ $p$
3 do ¤®¯®«­¨²¼ $f$ ¢¤®«¼ $p$
4 return $f$

¥²®¤ ®°¤ { «ª¥°±®­ 

559

±² ²®·­»¥ ±¥²¨
³±²¼ ¤ ­  ±¥²¼ ¨ ¯®²®ª ¢ ­¥©. ¥´®°¬ «¼­® £®¢®°¿, ®±² ²®·­ ¿
±¥²¼ ±®±²®¨² ¨§ ²¥µ °¥¡¥°, ¯®²®ª ¯® ª®²®°»¬ ¬®¦­® ³¢¥«¨·¨²¼.
²°®£®¥ ®¯°¥¤¥«¥­¨¥ ² ª®¢®: ¯³±²¼ G = (V; E ) | ±¥²¼ ± ¨±²®ª®¬ s
¨ ±²®ª®¬ t. ³±²¼ f | ¯®²®ª ¢ ½²®© ±¥²¨. «¿ «¾¡®© ¯ °» ¢¥°¸¨­
u ¨ v. ° ±±¬®²°¨¬ ®±² ²®·­³¾ ¯°®¯³±ª­³¾ ±¯®±®¡­®±²¼ (residual
capacity) ¨§ u ¢ v , ®¯°¥¤¥«¿¥¬³¾ ª ª

cf (u; v ) = c(u; v) ; f (u; v):

(27:5)

­  ®¯°¥¤¥«¿¥², ±ª®«¼ª® ¥¹¥ ¯®²®ª  ¬®¦­® ­ ¯° ¢¨²¼ ¨§ u ¢ v .
H ¯°¨¬¥°, ¥±«¨ c(u; v ) = 16,   f (u; v ) = 11 ²® ¬» ¬®¦¥¬ ¯¥°¥±« ²¼ ¥¹¥ cf (u; v ) = 5 ¥¤¨­¨¶ ¯® °¥¡°³ (u; v ). ±² ²®·­ ¿ ¯°®¯³±ª­ ¿ ±¯®±®¡­®±²¼ cf (u; v ) ¬®¦¥² ¯°¥¢®±µ®¤¨²¼ c(u; v ), ¥±«¨ ¢ ¤ ­­»©
¬®¬¥­² ¯®²®ª f (u; v ) ®²°¨¶ ²¥«¥­. H ¯°¨¬¥°, ¥±«¨ c(u; v ) = 16,  
f (u; v) = ;4, ²® cf (u; v) = 20.  ± ¬®¬ ¤¥«¥, ¬» ¬®¦¥¬ ³¢¥«¨·¨²¼
¯®²®ª ­  4, ®²¬¥­¨¢ ¢±²°¥·­»© ¯®²®ª, ¨ ¥¹¥ ®²¯° ¢¨²¼ 16 ¥¤¨­¨¶,
­¥ ¯°¥¢»¸ ¿ ¯°®¯³±ª­®© ±¯®±®¡­®±²¨ °¥¡°  (u; v ).
¥²¼ Gf = (V; Ef , £¤¥

Ef = f(u; v ) 2 V  V : cf (u; v) > 0g
­ §®¢¥¬ ®±² ²®·­®© ±¥²¼¾ (residual network) ±¥²¨ G, ¯®°®¦¤¥­­®© ¯®²®ª®¬ f . ¥ °¥¡° , ­ §»¢ ¥¬»¥ ®±² ²®·­»¬¨
°¥¡° ¬¨ (residual edges) ¤®¯³±ª ¾² ¯®«®¦¨²¥«¼­»© ¯®²®ª. H 
°¨±. 27.4 (a) ¨§®¡° ¦¥­ ¯®²®ª f ¢ ±¥²¨ G (¢§¿²»© ± °¨±. 27.1 (b)),
  ­  °¨±. 27.4 (b) ¨§®¡° ¦¥­  ®±² ²®·­ ¿ ±¥²¼ Gf .
 ¬¥²¨¬, ·²® ®±² ²®·­®¥ °¥¡°® (u; v ) ­¥ ®¡¿§ ­® ¡»²¼ °¥¡°®¬
±¥²¨ G. ­»¬¨ ±«®¢ ¬¨, ¬®¦¥² ®ª § ²¼±¿, ·²® Ef 6 E . ¥¡¥° (v1 ; s)
¨ v2; v3) ­  °¨±. 27.4 (b) ­¥ ¡»«® ¢ ¨±µ®¤­®© ±¥²¨.  ª®¥ °¥¡°® ¨§
u ¢ v ¯®¿¢«¿¥²±¿, ª®£¤  f (u; v) < 0, ²® ¥±²¼ ª®£¤  ¨¬¥¥²±¿ ¨¬¥¥²±¿
¯®²®ª ¢¥¹¥±²¢  ¢ ®¡° ²­®¬ ­ ¯° ¢«¥­¨¨ (¯® °¥¡°³ (v; u)) | ¢¥¤¼
½²®² ¯®²®ª ¬®¦­® ³¬¥­¼¸¨²¼.  ª¨¬ ®¡° §®¬, ¥±«¨ °¥¡°® (u; v )
¯°¨­ ¤«¥¦¨² ®±² ²®·­®© ±¥²¨, ²® µ®²¿ ¡» ®¤­® ¨§ °¥¡¥° (u; v ) ¨
(v; u) ¡»«® ¢ ¨±µ®¤­®© ±¥²¨. ®«³· ¥¬ ®¶¥­ª³

jEf j 6 2jE j:
±² ²®·­ ¿ ±¥²¼ Gf ¿¢«¿¥²±¿ ±¥²¼¾ ± ¯°®¯³±ª­»¬¨ ±¯®±®¡­®±²¿¬¨ cf . «¥¤³¾¹ ¿ «¥¬¬  ¯®ª §»¢ ¥², ª ª ±®®²­®±¿²±¿ ¯®²®ª¨
¢ ¨±µ®¤­®© ¨ ¢ ®±² ²®·­®© ±¥²¿µ.
¥¬¬  27.2
³±²¼ G = (V; E ) | ±¥²¼ ± ¨±²®ª®¬ s ¨ ±²®ª®¬ t,   f | ¯®²®ª
¢ ­¥©. ³±²¼ Gf | ®±² ²®·­ ¿ ±¥²¼ ±¥²¨ G, ¯®°®¦¤¥­­ ¿ ¯®²®ª®¬
f . ³±²¼ f 0 | ¯®²®ª ¢ Gf . ®£¤  ±³¬¬  f + f 0 , ®¯°¥¤¥«¥­­ ¿ ª ª ¢
(27.4), ¿¢«¿¥²±¿ ¯®²®ª®¬ ¢ ±¥²¨ G ¢¥«¨·¨­» jf + f 0 j = jf j + jf 0 j.
®ª § ²¥«¼±²¢®

560

« ¢  27  ª±¨¬ «¼­»© ¯®²®ª

­ · «  ¤®ª ¦¥¬, ·²® f + f 0 ¡³¤¥² ¯®²®ª®¬. °®¢¥°¨¬ ª®±®±¨¬¬¥²°¨·­®±²¼. «¿ ¢±¥µ u; v 2 V ¢»¯®«­¥­®
(f + f 0 )(u; v ) = f (u; v ) + f 0 (u; v ) =
= ;f (v; u) ; f 0 (v; u) =
= ;(f (v; u) + f 0 (v; u)) =
= ;(f + f 0 )(v; u):
°®¢¥°¨¬ ³±«®¢¨¥, ±¢¿§ ­­®¥ ± ®£° ­¨·¥­­®© ¯°®¯³±ª­®© ±¯®±®¡­®±²¼¾.  ¬¥²¨¬, ·²® f 0(u; v ) 6 cf (u; v ) ¤«¿ ¢±¥µ u; v 2 V , ¯®½²®¬³
(f + f 0 )(u; v ) = f (u; v )+ f 0(u; v ) 6 f (u; v )+(c(u; v ) ; f (u; v)) = c(u; v ):
°®¢¥°¨¬ § ª®­ ±®µ° ­¥­¨¿ ¯®²®ª . «¿ ¢±¥µ u 2 V n fs; tg ¢»¯®«­¥­® ° ¢¥­±²¢® (f + f 0 )(u; V ) = f (u; V ) + f 0 (u; V ) = f (u; V ) +
f 0(u; V ) = 0 + 0 = 0:
 ª®­¥¶, ­ ©¤¥¬ ¢¥«¨·¨­³ ±³¬¬ °­®£® ¯®²®ª : jf + f 0 j = (f +
f 0)(s; V ) = f (s; V ) + f 0 (s; V ) = jf j + jf 0j:
®¯®«­¿¾¹¨¥ ¯³²¨
³±²¼ f | ¯®²®ª ¢ ±¥²¨ G = (V; E ). H §®¢¥¬ ¤®¯®«­¿¾¹¨¬
¯³²¥¬ (augmenting path) ¯°®±²®© ¯³²¼ ¨§ ¨±²®ª  s ¢ ±²®ª t ¢ ®±² ²®·­®© ±¥²¨ Gf . § ®¯°¥¤¥«¥­¨¿ ®±² ²®·­®© ±¥²¨ ¢»²¥ª ¥², ·²®
¯® ¢±¥¬ °¥¡° ¬ (u; v ) ¤®¯®«­¿¾¹¥£® ¯³²¨ ¬®¦­® ¯¥°¥±« ²¼ ¥¹¥
±ª®«¼ª®-²® ¢¥¹¥±²¢ , ­¥ ¯°¥¢»±¨¢ ¯°®¯³±ª­³¾ ±¯®±®¡­®±²¼ °¥¡° .
H  °¨±. 27.4 (b) ¤®¯®«­¿¾¹¨© ¯³²¼ ¢»¤¥«¥­ ±¥°»¬ ¶¢¥²®¬. ®
­¥¬³ ¬®¦­® ®²¯° ¢¨²¼ ¥¹¥ 4 ¥¤¨­¨¶» ¯®²®ª , ² ª ª ª ­ ¨¬¥­¼¸ ¿ ®±² ²®·­ ¿ ¯°®¯³±ª­ ¿ ±¯®±®¡­®±²¼ °¥¡¥° ½²®£® ¯³²¨ ° ¢­ 
c(v2; v3) = 4. ¥«¨·¨­³ ­ ¨¡®«¼¸¥£® ¯®²®ª , ª®²®°»© ¬®¦­® ¯¥°¥±« ²¼ ¯® ¤®¯®«­¿¾¹¥¬³ ¯³²¨ p, ­ §®¢¥¬ ®±² ²®·­®© ¯°®¯³±ª­®©
±¯®±®¡­®±²¼¾ (residual capacity) ¯³²¨ p:

cf (p) = minfcf (u; v ) : (u; v ) 2 pg
ª § ­­®¥ ³²®·­¿¥²±¿ ¢ ±«¥¤³¾¹¥© «¥¬¬¥ (¤®ª § ²¥«¼±²¢® ¬»
®±² ¢«¿¥¬ ·¨² ²¥«¾ ¢ ª ·¥±²¢¥ ³¯°. 27.2-3).
¥¬¬  27.3
³±²¼ f | ¯®²®ª ¢ ±¥²¨ G = (V; E ) ¨ p | ¤®¯®«­¿¾¹¨© ¯³²¼ ¢
Gf . ¯°¥¤¥«¨¬ ´³­ª¶¨¾ fp : V  V ! R ² ª:
8
>
<

cf (p); ¥±«¨ (u; v) 2 p
fp(u; v ) = > ;cf (p); ¥±«¨ (v; u) 2 p
:

0 ¢ ®±² «¼­»µ ±«³· ¿µ.

®£¤  fp | ¯®²®ª ¢ ±¥²¨ Gf ¨ jfpj = cf (p) > 0.

(27:6)

¥²®¤ ®°¤ { «ª¥°±®­ 

561

27.4 (a) ®²®ª f ¢ ±¥²¨ G (ª ª ­  °¨±. 27.1). (b) ±² ²®·­ ¿ ±¥²¼ Gf .
»¤¥«¥­ ¤®¯®«­¿¾¹¨© ¯³²¼ p. £® ®±² ²®·­ ¿ ¯°®¯³±ª­ ¿ ±¯®±®¡­®±²¼ cf (p)
° ¢­  c(v2 ; v3 ) = 4. (c) ¥§³«¼² ² ¤®¡ ¢«¥­¨¿ ¯®²®ª  ¢¥«¨·¨­» 4, ¯°®µ®¤¿¹¥£®
¢¤®«¼ ¯³²¨ p. (d) ±² ²®·­ ¿ ±¥²¼, ¯®°®¦¤¥­­ ¿ ¯®²®ª®¬ °¨±. (c).
¨±. 27.4

27.5  §°¥§ (S; T ) ¢ ±¥²¨ °¨±. 27.1 (b). ¤¥±¼ S = fs; v1 ; v2 g (·¥°­»¥
¢¥°¸¨­») ¨ T = fv3 ; v4 ; tg (¡¥«»¥ ¢¥°¸¨­»). °¨ ½²®¬ f (S; T ) = 19 (¯®²®ª ·¥°¥§
° §°¥§) ¨ c(S; T ) = 26 (¯°®¯³±ª­ ¿ ±¯®±®¡­®±²¼)

¨±. 27.5

¥¯¥°¼ ¢¨¤­®, ·²® ¥±«¨ ¤®¡ ¢¨²¼ ¯®²®ª fp ª ¯®²®ª³ f , ¯®«³·¨²±¿ ¯®²®ª ¢ ±¥²¨ G ± ¡®«¼¸¨¬ §­ ·¥­¨¥¬. H  °¨±. 27.4 (c) ¨§®¡° ¦¥­ °¥§³«¼² ² ¤®¡ ¢«¥­¨¿ ¯®²®ª  fp (°¨±. 27.4 (b)) ª ¯®²®ª³ f
(°¨±. 27.4 (a)). ´®°¬³«¨°³¥¬ ½²® ¥¹¥ ° §:
«¥¤±²¢¨¥ 27.4
³±²¼ f | ¯®²®ª ¢ ±¥²¨ G = (V; E ),   p | ¤®¯®«­¿¾¹¨© ¯³²¼ ¢
±¥²¨ Gf , § ¤ ­­»© ° ¢¥­±²¢®¬ (27.6). ®£¤  ´³­ª¶¨¿ f 0 = f + fp
¿¢«¿¥²±¿ ¯®²®ª®¬ ¢ ±¥²¨ G ¢¥«¨·¨­» jf 0 j = jf j + jfp j > jf j.
®ª § ²¥«¼±²¢®
²¢¥°¦¤¥­¨¥ ¢»²¥ª ¥² ¨§ «¥¬¬ 27.2 ¨ 27.3.
 §°¥§» ¢ ±¥²¿µ
¥²®¤ ®°¤ { «ª¥°±®­  ¤®¡ ¢«¿¥² ¯®±«¥¤®¢ ²¥«¼­® ¯®²®ª¨ ¯®
¤®¯®«­¿¾¹¨¬ ¯³²¿¬, ¯®ª  ­¥ ¯®«³·¨²±¿ ¬ ª±¨¬ «¼­»© ¯®²®ª.  ª
¬» ¢±ª®°¥ ³¢¨¤¨¬ (²¥®°¥¬  ® ¬ ª±¨¬ «¼­®¬ ¯®²®ª¥ ¨ ¬¨­¨¬ «¼­®¬ ° §°¥§¥), ¢¥«¨·¨­  ¯®²®ª  ¬ ª±¨¬ «¼­  ¢ ²®¬ ¨ ²®«¼ª® ¢ ²®¬
±«³· ¥, ª®£¤  ®±² ²®·­ ¿ ±¥²¼ ­¥ ±®¤¥°¦¨² ¤®¯®«­¿¾¹¨µ ¯³²¥©.
«¿ ¤®ª § ²¥«¼±²¢  ­ ¬ ¯®­ ¤®¡¨²±¿ ¯®­¿²¨¥ ° §°¥§  ±¥²¨.
H §®¢¥¬ ° §°¥§®¬ (cut) ±¥²¨ G = (V; E ) ° §¡¨¥­¨¥ ¬­®¦¥±²¢  V
­  ¤¢¥ · ±²¨ S ¨ T = V n S , ¤«¿ ª®²®°»µ s 2 S ¨ t 2 T . (®¤®¡­ ¿ ¯°®¶¥¤³°  ¤¥« « ±¼ ¤«¿ ¬¨­¨¬ «¼­®£® ¯®ª°»¢ ¾¹¥£® ¤¥°¥¢  ¢
£« ¢¥ 24, ­® ²¥¯¥°¼ £° ´ ®°¨¥­²¨°®¢ ­ ¨, ª°®¬¥ ²®£®, ¬» ²°¥¡³¥¬,
·²®¡» s 2 S , t 2 T .) °®¯³±ª­®© ±¯®±®¡­®±²¼¾ ° §°¥§  (capacity
of the cut) (S; T ) ­ §»¢ ¾² ±³¬¬³ c(S; T ). °®¬¥ ²®£®, ¤«¿ § ¤ ­­®£® ¯®²®ª  f ¢¥«¨·¨­  ¯®²®ª  ·¥°¥§ ° §°¥§ (S; T ) ®¯°¥¤¥«¿¥²±¿
ª ª ±³¬¬  f (S; T ).
H  °¨±. 27.5 ¨§®¡° ¦¥­ ° §°¥§ (fs; v1; v2g; fv3; v4; tg) ±¥²¨
°¨±. 27.1 (b). ®²®ª ·¥°¥§ ½²®² ° §°¥§ ° ¢¥­
f (v1; v2) + f (v2; v3) + f (v2; v; 4) = 12 + (;4) + 11 = 19;
  ¯°®¯³±ª­ ¿ ±¯®±®¡­®±²¼ ° §°¥§  ° ¢­ 
c(v1; v3) + c(v2; v4) = 12 + 14 = 26:
 ª ¢¨¤­®, ¯®²®ª ·¥°¥§ ° §°¥§, ¢ ®²«¨·¨¥ ®² ¯°®¯³±ª­®© ±¯®±®¡­®±²¨ ° §°¥§ , ¬®¦¥² ¢ª«¾· ²¼ ¨ ®²°¨¶ ²¥«¼­»¥ ±« £ ¥¬»¥.
«¥¤³¾¹ ¿ «¥¬¬  ³²¢¥°¦¤ ¥², ·²® ¢¥«¨·¨­» ¯®²®ª®¢ ·¥°¥§ ¢±¥
° §°¥§» ®¤¨­ ª®¢» (¨ ° ¢­» ¢¥«¨·¨­¥ ¯®²®ª ).

562

« ¢  27  ª±¨¬ «¼­»© ¯®²®ª

¥¬¬  27.5
³±²¼ f | ¯®²®ª ¢ ±¥²¨ G ± ¨±²®ª®¬ s ¨ ±²®ª®¬ t,   (S; T ) |
° §°¥§ ±¥²¨ G. ®£¤  ¯®²®ª ·¥°¥§ ° §°¥§ (S; T ) ° ¢¥­ f (S; T ) = jf j.
®ª § ²¥«¼±²¢® ­®£®ª° ²­® ¨±¯®«¼§³¿ «¥¬¬³ 27.1, ¯®«³· ¥¬
f (S; T ) = f (S; V ) ; f (S; S ) =
= f (S; V ) =
= f (s; V ) + f (S n s; V ) =
= f (s; V ) =
= jf j
®ª § ­­®¥ ¢»¸¥ ° ¢¥­±²¢® (27.3) (¢¥«¨·¨­  ¯®²®ª  ° ¢­  ¯®²®ª³ ¢ ±²®ª) ­¥¬¥¤«¥­­® ±«¥¤³¥² ¨§ ½²®© «¥¬¬».
«¥¤±²¢¨¥ 27.6
­ ·¥­¨¥ «¾¡®£® ¯®²®ª  f ¢ ±¥²¨ G ¬¥­¼¸¥ ¨«¨ ° ¢­® ¯°®¯³±ª­®© ±¯®±®¡­®±²¨ «¾¡®£® ° §°¥§  ±¥²¨ G.
®ª § ²¥«¼±²¢®
³±²¼ (S; T ) | ¯°®¨§¢®«¼­»© ° §°¥§ ±¥²¨ G.  ±¨«³ 27.5 ¨ ®£° ­¨·¥­¨© ­  ¯®²®ª¨ ¯® °¥¡° ¬
jf j = f (S; T ) =
XX
=
f (u; v ) 6

6

u2S v2T

XX

u2S v2T

c(u; v) =

= c(S; T ):
¥¯¥°¼ ¤®ª ¦¥¬ ®±­®¢­³¾ ²¥®°¥¬³ ½²®£® ° §¤¥«  (max-ow mincut theorem).
¥®°¥¬  27.7 (® ¬ ª±¨¬ «¼­®¬ ¯®²®ª¥ ¨ ¬¨­¨¬ «¼­®¬ ° §°¥§¥)
³±²¼ f | ¯®²®ª ¢ ±¥²¨ G = (V; E ). ®£¤  ±«¥¤³¾¹¨¥ ³²¢¥°¦¤¥­¨¿ ° ¢­®±¨«¼­»:
1. ®²®ª f ¬ ª±¨¬ «¥­ (¿¢«¿¥²±¿ ¯®²®ª®¬ ¬ ª±¨¬ «¼­®© ¢¥«¨·¨­») ¢ ±¥²¨ G.
2. ±² ²®·­ ¿ ±¥²¼ Gf ­¥ ±®¤¥°¦¨² ¤®¯®«­¿¾¹¨µ ¯³²¥©.
3. «¿ ­¥ª®²®°®£® ° §°¥§  (S; T ) ±¥²¨ G ¢»¯®«­¥­® ° ¢¥­±²¢®
jf j = c(S; T ). ( ½²®¬ ±«³· ¥, ª ª ¯®ª §»¢ ¥² ±«¥¤±²¢¨¥ 27.6, ° §°¥§ ¿¢«¿¥²±¿ ¬¨­¨¬ «¼­»¬, ²® ¥±²¼ ¨¬¥¥² ¬¨­¨¬ «¼­® ¢®§¬®¦­³¾
¯°®¯³±ª­³¾ ±¯®±®¡­®±²¼.)
®ª § ²¥«¼±²¢®
(1) ) (2)
 ±±³¦¤ ¿ ®² ¯°®²¨¢­®£®, ¤®¯³±²¨¬, ·²® ¯®²®ª f ¬ ª±¨¬ «¥­, ­®
Gf ±®¤¥°¦¨² ¤®¯®«­¿¾¹¨© ¯³²¼ p.  ±±¬®²°¨¬ ±³¬¬³ f + fp , £¤¥
fp § ¤ ¥²±¿ ° ¢¥­±²¢®¬ (27.6). ® ±«¥¤±²¢¨¾ 27.4 ½²  ±³¬¬  ¿¢«¿¥²±¿ ¯®²®ª®¬ ¢ G, ¢¥«¨·¨­  ª®²®°®£® ¡®«¼¸¥ jf j, ·²® ¯°®²¨¢®°¥·¨²
¬ ª±¨¬ «¼­®±²¨ f .

¥²®¤ ®°¤ { «ª¥°±®­ 

563

(2) ) (3)
³±²¼ ¢ ±¥²¨ Gf ­¥² ¯³²¨ ¨§ ¨±²®ª  s ¢ ±²®ª t.  ±±¬®²°¨¬
¬­®¦¥±²¢®

S = fv 2 V j ¢ Gf ±³¹¥±²¢³¥² ¯³²¼ ¨§ s ¢ v g:
®«®¦¨¬ T = V n S . ·¥¢¨¤­®, ·²® s 2 S ,   t 2 T , ² ª ª ª ¢ Gf
­¥² ¯³²¨ ¨§ s ¢ t. ®½²®¬³ ¯ °  (S; T ) | ° §°¥§. H¨ ¤«¿ ª ª¨µ
u 2 S ¨ v 2 T °¥¡°® (u; v) ­¥ ¯°¨­ ¤«¥¦¨² Ef (¢ ¯°®²¨¢­®¬ ±«³· ¥
¢¥°¸¨­  v ¯®¯ «  ¡» ¢ S ). ®½²®¬³ f (u; v ) = c(u; v ). ® «¥¬¬¥ 27.5
jf j = f (S; T ) = c(S; T ).
(3) ) (1)
«¿ «¾¡®£® ° §°¥§  (S; T ) ¢»¯®«­¥­® jf j 6 c(S; T ) (±«¥¤±²¢¨¥
27.6). ®½²®¬³ ¨§ ° ¢¥­±²¢  jf j = c(S; T ) ±«¥¤³¥², ·²® ¯®²®ª f ¬ ª-

±¨¬ «¥­.
¡¹ ¿ ±µ¥¬   «£®°¨²¬  ®°¤ { «ª¥°±®­ 
¥©±²¢³¿ ¯® ¬¥²®¤³ ®°¤ { «ª¥°±®­ , ­  ª ¦¤®¬ ¸ £¥ ¬» ¢¨¡¨° ¥¬ ¯°®¨§¢®«¼­»© ¤®¯®«­¿¾¹¨© ¯³²¼ p ¨ ³¢¥«¨·¨¢ ¥¬ ¯®²®ª f ,
¤®¡ ¢«¿¿ ¯®²®ª ¢¥«¨·¨­» cf (p) ¯® ¯³²¨ p. °¨¢®¤¨¬»© ­¨¦¥  «£®°¨²¬ ¨±¯®«¼§³¥² ¬ ±±¨¢ f [u; v ] ¤«¿ µ° ­¥­¨¿ ²¥ª³¹¨µ §­ ·¥­¨¿ ¯®²®ª . » ±·¨² ¥¬, ·²® ´³­ª¶¨¿ c(u; v ) ¢»·¨±«¿¥²±¿ §  ¢°¥¬¿ O(1),
¯°¨ ½²®¬ c(u; v ) = 0 ¥±«¨ (u; v ) 2= E . (°¨ ¥±²¥±²¢¥­­®© °¥ «¨§ ¶¨¨
§­ ·¥­¨¥ ±(u; v ) µ° ­¨²±¿ °¿¤®¬ ± °¥¡° ¬¨ ¢ ±¯¨±ª µ ¨±µ®¤¿¹¨µ
°¥¡¥°.)
 ±²°®ª¥ 5 ¢¥«¨·¨­  cf (u; v ) ¯®­¨¬ ¥²±¿ ¢ ±®®²¢¥²±²¢¨¨ ± ´®°¬³«®© (27.5). ¨¬¢®« cf (p) ®¡®§­ · ¥² «®ª «¼­³¾ ¯¥°¥¬¥­­³¾, ¢
ª®²®°³¾ ¯®¬¥¹ ¥²±¿ ®±² ²®·­ ¿ ¯°®¯³±ª­ ¿ ±¯®±®¡­®±²¼ ¯³²¨ p.
Ford-Fulkerson($G,s,t$)
1 for (¤«¿) ª ¦¤®£® °¥¡°  $(u,v)$ ¨§ $E[G]$
2
do $f[u,v]\leftarrow 0$
3
$f[v,u]\leftarrow 0$
4 while (¯®ª ) ¢ ®±² ²®·­®© ±¥²¨ $G_f$ ±³¹¥±²¢³¥² ¯³²¼ $p$ ¨§ $s$ ¢ $t$
5
do $c_f(p)\leftarrow\min\{c_f(u,v)|(u,v) \textrm{ ¢µ®¤¨² ¢ } p\}$
6
for (¤«¿) ª ¦¤®£® °¥¡°  $(u,v)$ ¯³²¨ $p$
7
do $f[u,v]\leftarrow f[u,v]+c_f(p)$
8
$f[v,u]\leftarrow -f[u,v]$

°®¶¥¤³°  Ford-Fulkerson ±«¥¤³¥² ®¯¨± ­­®© ¢»¸¥ ±µ¥¬¥
(Ford-Fulkerson-Method). ²°®ª¨ 1{3 § ¤ ¾² ¯¥°¢®­ · «¼­®¥
§­ ·¥­¨¥ ¯®²®ª ; ¶¨ª« ¢ ±²°®ª µ 4{8 ­  ª ¦¤®¬ ¸ £¥ ­ µ®¤¨² ¤®¯®«­¿¾¹¨© ¯³²¼ p ¢ Gf ¨ ³¢¥«¨·¨¢ ¥² ¯®²®ª f . ±«¨ ¤®¯®«­¿¾¹¥£®
¯³²¨ ­¥², ­ ©¤¥­­»© ¯®²®ª ¬ ª±¨¬ «¥­. °¨¬¥° ° ¡®²» ¯°®£° ¬¬» ¨§®¡° ¦¥­ ­  °¨±.27.6.

564

« ¢  27  ª±¨¬ «¼­»© ¯®²®ª

27.6  ¡®²  ¯°®¶¥¤³°» Ford-Fulkerson. (a){(d)  £¨ ¢»¯®«­¥­¨¿
¶¨ª« . «¥¢  ¨§®¡° ¦¥­  ®±² ²®·­ ¿ ±¥²¼ Gf (¤®¯®«­¿¾¹¨© ¯³²¼ p ¢»¤¥«¥­
±¥°»¬), ±¯° ¢  ¯®ª § ­ ³¢¥«¨·¥­­»© ¯®²®ª. ­ · «¥ (a) °®«¼ ®±² ²®·­®© ±¥²¨
¨£° ¥² ¨±µ®¤­ ¿ ±¥²¼ G. (e) ±² ²®·­ ¿ ±¥²¼ ¡®«¥¥ ­¥ ±®¤¥°¦¨² ¤®¯®«­¿¾¹¥£®
¯³²¨; ¯®²®ª ¬ ª±¨¬ «¥­.
¨±. 27.6

­ «¨§  «£®°¨²¬  ®°¤ { «ª¥°±®­ 
°¥¬¿ ° ¡®²» ¯°®¶¥¤³°» Ford-Fulkerson § ¢¨±¨² ®² ²®£®, ª ª
¨¹¥²±¿ ¯³²¼ p (±²°®ª  4).  ¯°¨­¶¨¯¥  «£®°¨²¬ ¬®¦¥² ¢®®¡¹¥ ­¥
®±² ­®¢¨²¼±¿, ¥±«¨ §­ ·¥­¨¥ ¯®²®ª  ¡³¤¥² ° ±²¨ ¢±¥ ¡®«¥¥ ¬¥«ª¨¬¨ ¸ £ ¬¨, ² ª ¨ ­¥ ¤®±²¨£­³¢ ¬ ª±¨¬³¬ . ¤­ ª® ¥±«¨ ¢»¡¨° ²¼
¤®¯®«­¿¾¹¨© ¯³²¼ ¯°¨ ¯®¬®¹¨ ¯®¨±ª  ¢ ¸¨°¨­³ (° §¤¥« 23.2), ²®
 «£®°¨²¬ ° ¡®² ¥² ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿. °¥¦¤¥ ·¥¬ ¤®ª § ²¼
½²®, ¬» ³±² ­®¢¨¬ ¯°®±²³¾ ¢¥°µ­¾¾ ®¶¥­ª³ ¤«¿ ±«³· ¿ ¶¥«»µ ¯°®¯³±ª­»µ ±¯®±®¡­®±²¥©. (²®² ±«³· © · ±²® ¢±²°¥· ¥²±¿ ­  ¯° ª²¨ª¥. «³· © ° ¶¨®­ «¼­»µ ¯°®¯³±ª­»µ ±¯®±®¡­®±²¥© ±¢®¤¨²±¿ ª
­¥¬³ ³¬­®¦¥­¨¥¬ ­  ·¨±«®.)
«¿ ³ª § ­­®£® ±«³· ¿ (¯°®¯³±ª­»¥ ±¯®±®¡­®±²¨ | ¶¥«»¥ ·¨±« ), ¯°®¶¥¤³°  Ford-Fulkerson ¢»¯®«­¿¥²±¿ §  ¢°¥¬¿ O(E jf j),
£¤¥ f  | ¬ ª±¨¬ «¼­»© ¯®²®ª.  ± ¬®¬ ¤¥«¥, ¢»¯®«­¥­¨¥ ±²°®ª 1-3
²°¥¡³¥² ¢°¥¬¥­¨ (E ). ¨ª« ¢ ±²°®ª µ 4{8 ¢»¯®«­¿¥²±¿ ­¥ ¡®«¥¥
jf j ° §, ² ª ª ª ¯®±«¥ ª ¦¤®£® ¢»¯®«­¥­¨¿ ¢¥«¨·¨­  ¯®²®ª  ³¢¥«¨·¨¢ ¥²±¿ ¯® ª° ©­¥© ¬¥°¥ ­  ¥¤¨­¨¶³. ±² «®±¼ ®¶¥­¨²¼ ¢°¥¬¿
®¤­®£® ¸ £ , ª®²®°®¥ § ¢¨±¨² ®² ²®£®, ª ª ¬» µ° ­¨¬ ¤ ­­»¥ ®
¯®²®ª¥.  ±±¬®²°¨¬ ®°¨¥­²¨°®¢ ­­»© £° ´ G0 = (V; E 0), ¢ ª®²®°®¬
E 0 = f(u; v)j(u; v) 2 E ¨«¨ (v; u) 2 E g;
¨ ¡³¤¥¬ µ° ­¨²¼ ¯®²®ª¨ ¨ ¯°®¯³±ª­»¥ ±¯®±®¡­®±²¨ °¿¤®¬ ± ±®®²¢¥²±²¢³¾¹¨¬¨ °¥¡° ¬¨ (°¥¡°  ±¥²¨ G ¢µ®¤¿² ¨ ¢ £° ´ G0 , ² ª ·²®
¯°®¯³±ª­»¥ ±¯®±®¡­®±²¨ ¥±²¼ £¤¥ µ° ­¨²¼). ±² ²®·­ ¿ ±¥²¼ (¤«¿
²¥ª³¹¥£® ¯®²®ª ) ±®±²®¨² ¨§ ²¥µ °¥¡¥° (u; v ) £° ´  G0 , ¤«¿ ª®²®°»µ c(u; v ) ; f [u; v ] 6= 0. ®¨±ª ¤®¯®«­¿¾¹¥£® ¯³²¨ ¢ ®±² ²®·­®©
±¥²¨ (¢ £«³¡¨­³ ¨«¨ ¢ ¸¨°¨­³ | ¯®ª  ½²® ¢±¥ ° ¢­®) § ©¬¥² ¢°¥¬¿
O(E ) = O(E 0). ®½²®¬³ ¢°¥¬¿ ° ¡®²» ¯°®¶¥¤³°» ¡³¤¥² O(E jf j).
§ ¤®ª § ­­®© ®¶¥­ª¨ ±«¥¤³¥², ·²® ¯°¨ ­¥¡®«¼¸®¬ §­ ·¥­¨¨ jf j
¨ ¶¥«»µ ¯°®¯³±ª­»µ ±¯®±®¡­®±²¿µ ¢°¥¬¿ ° ¡®²» ¯°®¶¥¤³°» FordFulkerson ­¥¢¥«¨ª®. H® ¯°¨ ¡®«¼¸®¬ jf  j ¢°¥¬¿ ° ¡®²»  «£®°¨²¬  ¬®¦¥² ¡»²¼ ¢¥«¨ª® ¤ ¦¥ ¤«¿ ¯°®±²®© ±¥²¨, ª ª ¯®ª §»¢ ¥² ¯°¨¬¥° °¨±. 27.7. ­ ·¥­¨¥ ¬ ª±¨¬ «¼­®£® ¯®²®ª  ¢ ½²®© ±¥²¨ ° ¢­®
2; 000; 000 (¥±«¨ ¨±¯®«¼§®¢ ²¼ °¥¡° , ¨¤³¹¨¥ ±«¥¢  ­ ¯° ¢®). ±«¨,
ª ª ¯®ª § ­® ­  °¨±. 27.7 (a) ¨ 27.7 (b), ­  ·¥²­»µ ¸ £ µ ¡³¤¥²
¢»¡¨° ²¼±¿ ¤®¯®«­¿¾¹¨© ¯³²¼ s ! v ! u ! t,   ­  ­¥·¥²­»µ |
s ! u ! v ! t, ²® ¯®²°¥¡³¥²±¿ 2; 000; 000 ¸ £®¢, ·²®¡» ­ ©²¨
¬ ª±¨¬ «¼­»© ¯®²®ª.
®¦­® ¯®«³·¨²¼ «³·¸³¾ ®¶¥­ª³ ¢°¥¬¥­¨ ° ¡®²» ¯°®¶¥¤³°»

¥²®¤ ®°¤ { «ª¥°±®­ 

565

27.7 (a) ¥²¼, ¤«¿ ª®²®°®© ¯°®¶¥¤³°  Ford-Fulkerson ²°¥¡³¥² ¢°¥¬¥­¨ (E jf  j), £¤¥ f  | ¬ ª±¨¬ «¼­»© ¯®²®ª ¢¥«¨·¨­» jf j = 2 000 000. »¤¥«¥­ ¤®¯®«­¿¾¹¨© ¯³²¼ ± ¯°®¯³±ª­®© ±¯®±®¡­®±²¼¾ 1. (b) ®«³·¥­­ ¿ ®±² ²®·­ ¿ ±¥²¼. »¤¥«¥­ ¤®¯®«­¿¾¹¨© ¯³²¼ ± ²®© ¦¥ ¯°®¯³±ª­®© ±¯®±®¡­®±²¼¾. (c)
®«³·¥­­ ¿ ®±² ²®·­ ¿ ±¥²¼.
¨±. 27.7

Ford-Fulkerson, ¥±«¨ ¯°¥¤¯®«®¦¨²¼, ·²® ¢ ±²°®ª¥ 4 ¨±¯®«¼§³-

¥²±¿ ¯®¨±ª ¢ ¸¨°¨­³.  ½²®¬ ±«³· ¥ ¯³²¼ p ¡³¤¥² ª° ²· ©¸¨¬ ¨§
¤®¯®«­¿¾¹¨µ ¯³²¥© (¤«¨­³ ª ¦¤®£® °¥¡°  ±·¨² ¥¬ ° ¢­®© ¥¤¨­¨¶¥). ²  °¥ «¨§ ¶¨¿ ¬¥²®¤  ®°¤ { «ª¥°±®­  ­ §»¢ ¥²±¿  «£®°¨²¬®¬ ¤¬®­¤± { °¯ . ®ª ¦¥¬, ·²® ¢°¥¬¿ ° ¡®²»  «£®°¨²¬ 
¤¬®­¤± { °¯  ° ¢­® O(V E 2).
¡®§­ ·¨¬ ¤«¨­³ ª° ²· ©¸¥£® ¯³²¨ ¢ Gf ¬¥¦¤³ ¢¥°¸¨­ ¬¨ u ¨
v ·¥°¥§ f (u; v)).
¥¬¬  27.8
 ±±¬®²°¨¬ ° ¡®²³  «£®°¨²¬  ¤¬®­¤± { °¯  ­  ±¥²¨ G =
(V; E ) ± ¨±²®ª®¬ s ¨ ±²®ª®¬ t. «¿ «¾¡®© ¢¥°¸¨­» v ¨§ V n fs; tg
° ±±²®¿­¨¥ f (s; v ) ¢ ®±² ²®·­®© ±¥²¨ ¬¥¦¤³ ¨±²®ª®¬ ¨ ¢¥°¸¨­®©
v 2 V n fs; tg ¬®­®²®­­® ­¥³¡»¢ ¥² ­  ª ¦¤®¬ ¸ £¥ ¶¨ª« .
®ª § ²¥«¼±²¢®
°¥¤¯®«®¦¨¬ ¯°®²¨¢­®¥: ¯³±²¼ ¯®±«¥ ³¢¥«¨·¥­¨¿ ¯®²®ª  f
(¢¤®«¼ ¤®¯®«­¿¾¹¥£® ¯³²¨) ° ±±²®¿­¨¥ f (s; v ) ®² ¨±²®ª  s ¤®
­¥ª®²®°®© ¢¥°¸¨­» v ¨§ V n fs; tg ³¬¥­¼¸¨«®±¼. ¡®§­ ·¨¢ ³¢¥«¨·¥­­»© ¯®²®ª ·¥°¥§ f 0 , ¯®«³· ¥¬, ·²®
f0 (s; v ) < f (s; v ):
°¥¤¨ ¢¥°¸¨­ v ± ² ª¨¬ ±¢®©±²¢®¬ ¢»¡¥°¥¬ ¡«¨¦ ©¸³¾ (¢ ±¬»±«¥
±¥²¨ G0f ) ª ¨±²®ª³.  ½²®¬ ±«³· ¥

¨§ f0 (s; u) < f0 (s; v ) ±«¥¤³¥² f (s; u) 6 f0 (s; u)
(27:7)
¤«¿ ¢±¥µ u 2 V n fs; tg.
®§¼¬¥¬ ª° ²· ©¸¨© ¯³²¼ p0 ¨§ s ¢ v ¢ ±¥²¨ G0f ¨ ° ±±¬®²°¨¬
¢¥°¸¨­³ u, ­¥¯®±°¥¤±²¢¥­­® ¯°¥¤¸¥±²¢³¾¹³¾ ¢¥°¸¨­¥ v ¢ ½²®¬
¯³²¨ (s u ! v ).
®£« ±­® ±«¥¤±²¢¨¾ 25.2, f0 (s; u) = f0 (s; v ) ; 1. «¥¤®¢ ²¥«¼­®,
¯® ¯°¥¤¯®«®¦¥­¨¾ (27.7)
f (s; u) 6 f0 (s; u):
®¦¥² «¨ °¥¡°® (u; v ) ¢µ®¤¨²¼ ¢ Ef (½²® §­ ·¨², ·²® f [u; v ] <
c(u; v )). ®£¤  ¯® «¥¬¬¥ 25.3 ¤®«¦­® ¡»²¼
f (s; v ) 6 f (s; u) + 1 6
6 f0 (s; u) + 1 =
= f0 (s; v );

566

« ¢  27  ª±¨¬ «¼­»© ¯®²®ª

·²® ¯°®²¨¢®°¥·¨² ­ · «¼­®¬³ ¯°¥¤¯®«®¦¥­¨¾.
«¥¤®¢ ²¥«¼­®, (u; v ) 2= Ef . H® °¥¡°® (u; v ) ¯°¨­ ¤«¥¦¨² Ef0 , ¯®½²®¬³ ¤®¯®«­¿¾¹¨© ¯³²¼ p, ¯°¥¢° ²¨¢¸¨© ±¥²¼ Gf ¢ ±¥²¼ G0f , ±®¤¥°¦ « °¥¡°® (v; u).  ª ª ª ¯³²¼ p ¡»« ª° ²· ©¸¨¬ ¯³²¥¬ ¨§ s ¢
t ¢ ±¥²¨ Gf , ²® «¾¡®© ¥£® ¯®¤¯³²¼ ² ª¦¥ ¡»« ª° ²· ©¸¨¬ («¥¬¬ 
25.1), ¯®½²®¬³ f (s; u) = f (s; v ) + 1. ²±¾¤  ±«¥¤³¥², ·²®
f (s; v) = f (s; u) ; 1 6
6 f0 (s; u) ; 1 =
= f0 (s; v ) ; 2 <
< f0 (s; v );
·²® ¯°®²¨¢®°¥·¨² ­ · «¼­®¬³ ¯°¥¤¯®«®¦¥­¨¾.
¥®°¥¬  27.9
«£®°¨²¬ ¤¬®­¤± { °¯  ­  ±¥²¨ G = (V; E ) ¢»¯®«­¿¥²±¿ § 
O(V E ) ¸ £®¢.
®ª § ²¥«¼±²¢®
 ª ¦¤®¬ ¤®¯®«­¿¾¹¥¬ ¯³²¨ ®²¬¥²¨¬ °¥¡°  ¬¨­¨¬ «¼­®© ¯°®¯³±ª­®© ±¯®±®¡­®±²¨, ª®²®°»¥ ¡³¤¥¬ ­ §»¢ ²¼ ª°¨²¨·¥±ª¨¬¨ (critical) (¤«¿ ¤ ­­®£® ¸ £ ).  ¬¥²¨¬, ·²® ª°¨²¨·¥±ª¨¥ °¥¡°  ¨±·¥§ ¾² ¯°¨ ¯¥°¥µ®¤¥ ª ±«¥¤³¾¹¥© ®±² ²®·­®© ±¥²¨.
®ª ¦¥¬, ·²® ¤«¿ ®¤­® ¨ ²® ¦¥ °¥¡°® ¬®¦¥² ¡»²¼ ª°¨²¨·¥±ª¨¬
­¥ ¡®«¥¥ O(V ) ° §. ®±ª®«¼ª³ ¢±¥ °¥¡°  ¢±¥µ ®±² ²®·­»µ ±¥²¥© ±®®²¢¥²±²¢³¾² °¥¡° ¬ £° ´  (¢®§¬®¦­®, ¢ ®¡° ²­®¬ ­ ¯° ¢«¥­¨¨),
¨µ ·¨±«® ­¥ ¯°¥¢®±µ®¤¨² 2E , ² ª ·²® ®¡¹¥¥ ·¨±«® ¸ £®¢ ¤¥©±²¢¨²¥«¼­® ¥±²¼ O(EV ).
² ª, ¯®±¬®²°¨¬, ±ª®«¼ª® ° § §  ¢°¥¬¿ ° ¡®²»  «£®°¨²¬ 
¤¬®­¤± { °¯  °¥¡°® (u; v ) ¬®¦¥² ¡»²¼ ª°¨²¨·¥±ª¨¬. ±«¨
°¥¡°® ¡»«® ª°¨²¨·¥±ª¨¬, ®­® ¨±·¥§ ¥², ¨ ¬®¦¥² ¯®¿¢¨²¼±¿ ¢­®¢¼
«¨¸¼ ¯®±«¥ ²®£®, ª ª ¯®²®ª ¨§ u ¢ v ³¬¥­¼¸¨²±¿. ²® ¬®¦¥²
¯°®¨§®©²¨ ²®«¼ª® ¥±«¨ °¥¡°® (v; u) ¢®©¤¥² ¢ ¤®¯®«­¿¾¹¨© ¯³²¼.
 ª¨¬ ®¡° §®¬, ¢®§­¨ª ¥² ¯®±«¥¤®¢ ²¥«¼­®±²¼ ±¨²³ ¶¨©:
(u; v ) ¢µ®¤¨² ¢ ¤®¯®«­¿¾¹¨© ¯³²¼ (¨ ª°¨²¨·¥±ª®¥ ¢ ­¥¬);
(v; u) ¢µ®¤¨² ¢ ¤®¯®«­¿¾¹¨© ¯³²¼ (­¥ ®¡¿§ ²¥«¼­® ª°¨²¨·¥±ª®¥);
(u; v ) ¢µ®¤¨² ¢ ¤®¯®«­¿¾¹¨© ¯³²¼ (¨ ª°¨²¨·¥±ª®¥ ¢ ­¥¬);
(v; u) ¢µ®¤¨² ¢ ¤®¯®«­¿¾¹¨© ¯³²¼ (­¥ ®¡¿§ ²¥«¼­® ª°¨²¨·¥±ª®¥);
¨ ² ª ¤ «¥¥. ®ª ¦¥¬, ·²® ·¨±«® ² ª¨µ ±¨²³ ¶¨© ¥±²¼ O(V ). «¿
½²®£® ¯°®±«¥¤¨¬, ª ª ¬¥­¿¾²±¿ ° ±±²®¿­¨¿ ®² ¨±²®ª  ¤® ¢¥°¸¨­
u ¨ v ¢ ®±² ²®·­»µ ±¥²¿µ.  ª ¬» §­ ¥¬ («¥¬¬  27.8), ½²¨ ¤¢¥
¢¥«¨·¨­» ¬®£³² ²®«¼ª® ¢®§° ±² ²¼. °¨ ½²®¬ ²® ®¤­ , ²® ¤°³£ ¿
¢»°»¢ ¥²±¿ ¢¯¥°¥¤ ­  1 (¯®±ª®«¼ª³ ®­¨ ±®±¥¤±²¢³¾² ¢ ª° ²· ©¸¥¬
¯³²¨, «¥¬¬  25.1).  ¬¥²¨¬, ·²® ¯°¨ ¯¥°¥µ®¤¥ ®² ¯¥°¢®© ±¨²³ ¶¨¨
ª® ¢²®°®© ° ±±²®¿­¨¥ ®² ¨±²®ª  ¤® u ³¢¥«¨·¨²±¿ ¯® ª° ©­¥© ¬¥°¥ ­  2 (®­® ¡»«® ¬¥­¼¸¥ ° ±±²®¿­¨¿ ¤® v ,   ±² «® ¡®«¼¸¥). °¨
¯¥°¥µ®¤¥ ®² ¢²®°®© ±²°®ª¨ ª ²°¥²¼¥© ° ±±²®¿­¨¥ ®² ¨±²®ª  ¤® v
³¢¥«¨·¨²±¿ ¯® ª° ©­¥© ¬¥°¥ ­  2 ¨ ² ª ¤ «¥¥.

¥²®¤ ®°¤ { «ª¥°±®­ 

567

 ¬¥²¨¬, ·²® ° ±±²®¿­¨¿ ®£° ­¨·¥­» ±¢¥°µ³ §­ ·¥­¨¥¬ V (ª° ²· ©¸¨© ¯³²¼ ­¥ ¯°®µ®¤¨² ¤¢ ¦¤» ·¥°¥§ ®¤­³ ¢¥°¸¨­³), ² ª ·²®
®¡¹¥¥ ·¨±«® ² ª¨µ ·¥°¥¤®¢ ­¨© ¥±²¼ O(V ), ª ª ¬» ¨ ®¡¥¹ «¨.
®¤±·¨² ¥¬ ²¥¯¥°¼ ®¡¹¥¥ ¢°¥¬¿ ° ¡®²»  «£®°¨²¬  ¤¬®­¤± {
 °¯ .  ¦¤ ¿ ¨²¥° ¶¨¿ ²°¥¡³¥² ¢°¥¬¥­¨ O(E ), ¨µ ¡³¤¥² O(V E ),
¯®½²®¬³ ¢±¥£® ¡³¤¥² O(V E 2).
 ° §¤¥«¥ 27.4 ¬» ° ±±ª ¦¥¬ ® ¤°³£®¬ ¯®¤µ®¤¥ ª ¯®¨±ª³ ¬ ª±¨¬ «¼­®£® ¯®²®ª , ª®²®°»© ¯®§¢®«¿¥² ±¤¥« ²¼ ½²® §  O(V 2E ). £®
³±®¢¥°¸¥­±²¢®¢ ­¨¥ ¯®§¢®«¿¥² ¥¹¥ ³¬¥­¼¸¨²¼ ¢°¥¬¿ ° ¡®²», ¯®«³·¨¢ ®¶¥­ª³ O(V 3) (° §¤¥« 27.5).
¯° ¦­¥­¨¿
27.2-1
H ©¤¨²¥ ¯®²®ª ·¥°¥§ ° §°¥§ (fs; v2; v4g; fv1; v3; tg) ­  °¨±. 27.1 b).
¥¬³ ° ¢­  ¯°®¯³±ª­ ¿ ±¯®±®¡­®±²¼ ½²®£® ° §°¥§ ?
27.2-2
°®±«¥¤¨²¥ §  ¢»¯®«­¥­¨¥¬ «£®°¨²¬  ¤¬®­¤± { °¯  ¤«¿ ±¥²¨
°¨±. 27.1 (a).
27.2-3
ª ¦¨²¥ ¬¨­¨¬ «¼­»© ° §°¥§ ­  °¨±. 27.6, ±®®²¢¥²±²¢³¾¹¨© ­ °¨±®¢ ­­®¬³ ¬ ª±¨¬ «¼­®¬³ ¯®²®ª³.  ª ª¨µ ±«³· ¿µ ¤®¯®«­¿¾¹¨© ¯³²¼ ³¬¥­¼¸ « ¯®²®ª, ¨¤³¹¨© ¢ ®¡° ²­®¬ ­ ¯° ¢«¥­¨¨?
27.2-4
®ª ¦¨²¥, ·²® ¤«¿ «¾¡»µ ¢¥°¸¨­ u ¨ v , «¾¡®£® ¯®²®ª  f ¨ ¯°®¯³±ª­®© ±¯®±®¡­®±²¨ c ¢»¯®«­¥­® cf (u; v )+cf (v; u) = c(u; v )+c(v; u).
27.2-5
±¯®¬­¨¬ ª®­±²°³ª¶¨¾ ¨§ ° §¤¥«  27.1, ± ¯®¬®¹¼¾ ª®²®°®© ±¥²¼
± ­¥±ª®«¼ª¨¬¨ ¨±²®ª ¬¨ ¨ ±²®ª ¬¨ ±¢®¤¨²±¿ ª ®¡»·­®©. ®ª ¦¨²¥, ·²® ¥±«¨ ¯°®¯³±ª­ ¿ ±¯®±®¡­®±²¼ «¾¡®£® °¥¡°  ¨±µ®¤­®© ±¥²¨
¡»«  ª®­¥·­®©, ²® ¢ ¯®«³·¨¢¸¥©±¿ ±¥²¨ ¢¥«¨·¨­  «¾¡®£® ¯®²®ª 
ª®­¥·­ .
27.2-6
 ±±¬®²°¨¬ ±¥²¼ ± ­¥±ª®«¼ª¨¬¨ ¨±²®ª ¬¨ ¨ ±²®ª ¬¨, ¢ ª®²®°®©
ª ¦¤»© ¨±²®ª si ¯°®¨§¢®¤¨² °®¢­® pi ¥¤¨­¨¶ ¯®²®ª ,   ª ¦¤»©
±²®ª tj ¯®²°¥¡«¿¥²
°®¢­® qj ¥¤¨­¨¶, ².¥. f (si ; V ) = pi ¨ f (V; tj ) = qj .
P
P
°¨ ½²®¬ i pi = j qj .  ª ³§­ ²¼, ¢®§¬®¦¥­ «¨ ¯®²®ª ± ² ª¨¬¨
®£° ­¨·¥­¨¿¬¨, ±¢¥¤¿ ½²³ § ¤ ·³ ª § ¤ ·¥ ® ¬ ª±¨¬ «¼­®¬ ¯®²®ª¥?
27.2-7
®ª ¦¨²¥ «¥¬¬³ 27.3.
27.2-8
®ª ¦¨²¥, ·²® ¯°¨ ¯®¨±ª¥ ¬ ª±¨¬ «¼­®£® ¯®²®ª  ¢ ±¥²¨ G =
(V; E ) ¤®±² ²®·­® ±¤¥« ²¼ jE j ¸ £®¢, ¥±«¨ ²®«¼ª® ¯° ¢¨«¼­® ¢»¡° ²¼ ¤®¯®«­¿¾¹¨¥ ¯³²¨ ­  ª ¦¤®¬ ¸ £¥. (ª § ­¨¥. ·¨² ¿, ·²®
¬ ª±¨¬ «¼­»© ¯®²®ª ¨§¢¥±²¥­, ¯®ª ¦¨²¥, ª ª ±«¥¤³¥² ¢»¡¨° ²¼
¯³²¨.)
27.2-9
H §®¢¥¬ § ¯ ±®¬ ±¢¿§­®±²¨ (edge connectivity) ­¥®°¨¥­²¨°®¢ ­-

568

« ¢  27  ª±¨¬ «¼­»© ¯®²®ª

­®£® £° ´  ¬¨­¨¬ «¼­®¥ ·¨±«® °¥¡¥°, ª®²®°®¥ ­¥®¡µ®¤¨¬® ³¤ «¨²¼, ·²®¡» ±¤¥« ²¼ £° ´ ­¥±¢¿§­»¬. H ¯°¨¬¥°, ±¢¿§­®±²¼ ¤¥°¥¢ 
° ¢­  ¥¤¨­¨¶¥,   ±¢¿§­®±²¼ ¶¨ª«  ° ¢­  2.
 ª ³§­ ²¼ ±¢¿§­®±²¼ £° ´  ± ¯®¬®¹¼¾ ¯°®£° ¬¬» ¯®¨±ª  ¬ ª±¨¬ «¼­®£® ¯®²®ª ? ¥ ±«¥¤³¥² ¯°¨¬¥­¿²¼ ­¥ ¡®«¥¥ ·¥¬ ª jV j ±¥²¿¬,
ª ¦¤ ¿ ¨§ ª®²®°»µ ±®¤¥°¦¨² O(V ) ¢¥°¸¨­ ¨ O(E ) °¥¡¥°.
27.2-10
°¥¤¯®«®¦¨¬, ·²® ¤«¿ ª ¦¤®£® °¥¡°  (u; v ) ±¥²¨ ®¡° ²­®¥
¥¬³ °¥¡°® (v; u) ² ª¦¥ ¢µ®¤¨² ¢ ±¥²¼ ®ª ¦¨²¥, ·²®  «£®°¨²¬
¤¬®­¤± { °¯  ²°¥¡³¥² ­¥ ¡®«¥¥ jV j  jE j=4 ¨²¥° ¶¨©. (ª § ­¨¥:
¤«¿ ª ¦¤®£® °¥¡°  (u; v ) ¯°®±«¥¤¨²¥, ª ª ¬¥­¿¾²±¿  (s; u) ¨  (v; t)
¬¥¦¤³ ²¥¬¨ ¬®¬¥­² ¬¨, ª®£¤  °¥¡°® (u; v ) ª°¨²¨·¥±ª®¥.)

27.3.  ª±¨¬ «¼­®¥ ¯ °®±®·¥² ­¨¥ ¢ ¤¢³¤®«¼­®¬ £° ´¥
H¥ª®²®°»¥ ª®¬¡¨­ ²®°­»¥ § ¤ ·¨ (­ ¯°¨¬¥°, § ¤ ·  ® ±¥²¨ ±
­¥±ª®«¼ª¨¬¨ ¨±²®ª ¬¨ ¨ ±²®ª ¬¨ ¨§ ° §¤¥«  27.1) ±¢®¤¿²±¿ ª ° §®¡° ­­®© ­ ¬¨ § ¤ ·¥ ® ¬ ª±¨¬ «¼­®¬ ¯®²®ª¥. °³£®© ¯°¨¬¥° ² ª®£® °®¤  | § ¤ ·  ® ¬ ª±¨¬ «¼­®¬ ¯ °®±®·¥² ­¨¨ ¢ ¤¢³¤®«¼­®¬
£° ´¥ (±¬. ° §¤¥« 5.4).  ½²®¬ ° §¤¥«¥ ¯®ª ¦¥¬, ª ª ± ¯®¬®¹¼¾
¬¥²®¤  ®°¤ - «ª¥°±®­  ¬®¦­® °¥¸¨²¼ ½²³ § ¤ ·³ ¤«¿ £° ´ 
G = (V; E ) §  ¢°¥¬¿ O(V E ).
 ¤ ·  ® ¬ ª±¨¬ «¼­®¬ ¯ °®±®·¥² ­¨¨
³±²¼ G = (V; E ) | ­¥®°¨¥­²¨°®¢ ­­»© £° ´.  °®±®·¥² ­¨¥¬
(matching) ­ §®¢¥¬ ¬­®¦¥±²¢® °¥¡¥° M  E , ­¥ ¨¬¥¾¹¨µ ®¡¹¨µ
ª®­¶®¢ (ª ¦¤ ¿ ¢¥°¸¨­  v 2 V ¿¢«¿¥²±¿ ª®­¶®¬ ¬ ª±¨¬³¬ ®¤­®£®
°¥¡°  ¨§ M ). ³¤¥¬ £®¢®°¨²¼, ·²® ¢¥°¸¨­  v 2 V ¢µ®¤¨² ¢ ¯ °®±®·¥² ­¨¥ M (is matched), ¥±«¨ ¢ M ¥±²¼ °¥¡°® ± ª®­¶®¬ v ; ¢
¯°®²¨¢­®¬ ±«³· ¥ v ±¢®¡®¤­  (is unmatched).  ª±¨¬ «¼­®¥ ¯ °®±®·¥² ­¨¥ (maximum matching) | ½²® ¯ °®±®·¥² ­¨¥ M , ±®¤¥°¦ ¹¥¥ ¬ ª±¨¬ «¼­® ¢®§¬®¦­®¥ ·¨±«® °¥¡¥° (jM j > jM 0j ¤«¿ «¾¡®£®
¯ °®±®·¥² ­¨¿ M 0 ). °¨¬¥° ¯ °®±®·¥² ­¨¿ ¯°¨¢¥¤¥­ ­  °¨±. 27.8.
 ½²®¬ ° §¤¥«¥ ¬» ¡³¤¥¬ ° ±±¬ ²°¨¢ ²¼ ¯ °®±®·¥² ­¨¿ «¨¸¼ ¢
¤¢³¤®«¼­»µ £° ´ µ. » ¯°¥¤¯®« £ ¥¬, ·²® ¬­®¦¥±²¢® V ° §¡¨²®
­  ¤¢  ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ¯®¤¬­®¦¥±²¢  L ¨ R, ¨ «¾¡®¥ °¥¡°® ¨§
E ±®¥¤¨­¿¥² ­¥ª®²®°³¾ ¢¥°¸¨­³ ¨§ L ± ­¥ª®²®°®© ¢¥°¸¨­®© ¨§ R.
«¿ § ¤ ·¨ ® ¬ ª±¨¬ «¼­®¬ ¯ °®±®·¥² ­¨¨ ¢ ¤¢³¤®«¼­®¬ £° ´¥
¥±²¼ ­¥±ª®«¼ª® ¬¥² ´®°. ®² ­ ¨¡®«¥¥ ¨§¢¥±²­ ¿: L | ¦¥­¨µ¨,
R | ­¥¢¥±²», ­ «¨·¨¥ °¥¡°  (u; v ) ®§­ · ¥², ·²® u ¨ v ±®£« ±­»
±² ²¼ ±³¯°³£ ¬¨.  ª±¨¬ «¼­®¥ ¯ °®±®·¥² ­¨¥ ¤®±² ¢«¿¥² ³
27.8 ¢³¤®«¼­»© £° ´. ­®¦¥±²¢® ¢¥°¸¨­ ° §¡¨²® ­  ¤¢¥ · ±²¨ L ¨
R. ( )  °®±®·¥² ­¨¥ ¨§ ¤¢³µ °¥¡¥°. (b)  ª±¨¬ «¼­®¥ ¯ °®±®·¥² ­¨¥ ±®±²®¨²
¨±. 27.8
a

¨§ ²°¥µ ½«¥¬¥­²®¢.

 ª±¨¬ «¼­®¥ ¯ °®±®·¥² ­¨¥ ¢ ¤¢³¤®«¼­®¬ £° ´¥

569

¨±. 27.9 27.9 ¥²¼, ±®®²¢¥²±²¢³¾¹ ¿ ¤¢³¤®«¼­®¬³ £° ´³. (a) ¢³¤®«¼­»©
£° ´ °¨±. 27.8. »¤¥«¥­­»¥ °¥¡°  ®¡° §³¾² ¬ ª±¨¬ «¼­®¥ ¯ °®±®·¥² ­¨¥. (b)
®®²¢¥²±²¢³¾¹ ¿ ±¥²¼ G0 ¨ ¬ ª±¨¬ «¼­»© ¯®²®ª ¢ ­¥©. °®¯³±ª­ ¿ ±¯®±®¡­®±²¼ «¾¡®£® °¥¡°  ° ¢­  ¥¤¨­¨¶¥; ¯®²®ª ¯® ¢»¤¥«¥­­»¬ °¥¡° ¬ ° ¢¥­ ¥¤¨­¨¶¥, ¯® ®±² «¼­»¬ | ­³«¾. »¤¥«¥­­»¥ °¥¡° , ±®¥¤¨­¿¾¹¨¥ ¢¥°¸¨­» ¨§ L ±
¢¥°¸¨­ ¬¨ ¨§ R, ±®®²¢¥²±²¢³¾² ¬ ª±¨¬ «¼­®¬³ ¯ °®±®·¥² ­¨¾ ¢ ¤¢³¤®«¼­®¬
£° ´¥.

¡®«¼¸¥ ¢±¥£® ° ¡®²».
®¨±ª ¬ ª±¨¬ «¼­®£® ¯ °®±®·¥² ­¨¿ ¢ ¤¢³¤®«¼­®¬ £° ´¥
» ¡³¤¥¬ ¨±¯®«¼§®¢ ²¼ ¬¥²®¤ ®°¤ { «ª¥°±®­  ¤«¿ ¯®¨±ª 
¬ ª±¨¬ «¼­®£® ¯ °®±®·¥² ­¨¿ ¢ ¤¢³¤®«¼­®¬ £° ´¥ G = (V; E ) § 
¯®«¨­®¬¨ «¼­®¥ ®² jV j ¨ jE j ¢°¥¬¿. «¿ ½²®£® ° ±±¬®²°¨¬ ±¥²¼
G0 = (V 0; E 0), ±®®²¢¥²±²¢³¾¹³¾ ¤¢³¤®«¼­®¬³ £° ´³ G (°¨±. 27.9).
²  ±¥²¼ ±²°®¨²±¿ ² ª: ¤®¡ ¢¿«¿¾²±¿ ¤¢¥ ­®¢»¥ ¢¥°¸¨­», ª®²®°»¥ ¡³¤³² ¨±²®ª®¬ (s) ¨ ±²®ª®¬ (t): V 0 = V [ fs; tg. ­®¦¥±²¢®
(­ ¯° ¢«¥­­»µ) °¥¡¥° ±¥²¨ G0 ² ª®¢®:
E 0 =f(s; u)ju 2 Lg [
[ f(u; v)ju 2 L; v 2 R; (u; v) 2 E g [
f(v; t)jv 2 Rg:
(­ ¯®¬­¨¬, ·²® ·¥°¥§ L ¨ R ®¡®§­ · ¾²±¿ ¤®«¨ £° ´ ). ³¤¥¬ ±·¨² ²¼, ·²® ¯°®¯³±ª­ ¿ ±¯®±®¡­®±²¼ ª ¦¤®£® °¥¡°  ° ¢­  ¥¤¨­¨¶¥.
«¥¤³¾¹ ¿ «¥¬¬  ³±² ­ ¢«¨¢ ¥² ±®®²¢¥²±²¢¨¥ ¬¥¦¤³ ¯®²®ª ¬¨
¢ G0 ¨ ¯ °®±®·¥² ­¨¿¬¨ ¢ G | ­® ¯°¥¦¤¥ ¤ ¤¨¬ ¥¹¥ ®¤­® ®¯°¥¤¥«¥­¨¥.
®²®ª f ¢ ±¥²¨ G = (V; E ) ­ §»¢ ¥²±¿ ¶¥«®·¨±«¥­­»¬ (integervalued), ¥±«¨ ¢±¥ §­ ·¥­¨¿ f (u; v ) | ¶¥«»¥.
¥¬¬  27.10
³±²¼ G = (V; E ) | ¤¢³¤®«¼­»© £° ´ ± ¤®«¿¬¨ L ¨ R, ¨ G0 =
(V 0 ; E 0) | ±®®²¢¥²±²¢³¾¹ ¿ ±¥²¼. ³±²¼ M | ¯ °®±®·¥² ­¨¥ ¢
G. ®£¤  ±³¹¥±²¢³¥² ¶¥«®·¨±«¥­­»© ¯®²®ª ¢ G0 ±® §­ ·¥­¨¥¬ jf j =
jM j. ¡° ²­®, ¥±«¨ f | ¶¥«®·¨±«¥­­»© ¯®²®ª ¢ G0, ²® ¢ G0 ­ ©¤¥²±¿
¯ °®±®·¥² ­¨¥ ¨§ jf j ½«¥¬¥­²®¢.
®ª § ²¥«¼±²¢®
­ · «  ¤®ª ¦¥¬, ·²® ¯ °®±®·¥² ­¨¥ ¯®°®¦¤ ¥² ¯®²®ª, § ¤ ¢
¯®²®ª f ±«¥¤³¾¹¨¬ ®¡° §®¬. ±«¨ (u; v ) 2 M , ²® f (s; u) = f (u; v ) =
f (v; t) = 1 ¨ f (u; s) = f (v; u) = f (t; v ) = ;1. «¿ ¢±¥µ ®±² «¼­»µ
°¥¡¥° (u; v ) 2 E 0 ¯®«®¦¨¬ f (u; v ) = 0. H¥´®°¬ «¼­® £®¢®°¿, ª ¦¤®¥
°¥¡°® (u; v ) 2 M ±®®²¢¥²±²¢³¥² ¥¤¨­¨·­®¬³ ¯®²®ª³ ¯® ¯³²¨ s !
u ! v ! t. H¨ª ª¨¥ ¤¢  ² ª¨µ ¯³²¨ ­¥ ±®¤¥°¦ ² ®¡¹¨µ ¢¥°¸¨­
(ª°®¬¥ ¨±²®ª  ¨ ±²®ª ) ¨«¨ °¥¡¥°.
²®¡» ¯°®¢¥°¨²¼, ·²® f ¿¢«¿¥²±¿ ¯®²®ª®¬, ¤®±² ²®·­® § ¬¥²¨²¼, ·²® f ¯°¥¤±² ¢¨¬ ¢ ¢¨¤¥ ±³¬¬» ¯®²®ª®¢ ¯® ½²¨¬ ¯³²¿¬. ®²®ª ·¥°¥§ ° §°¥§ (L [fsg; R [ftg) ° ¢¥­ jM j, ¯®½²®¬³ ¯® «¥¬¬¥ 27.5
§­ ·¥­¨¥ ¯®²®ª  jf j ° ¢­® jM j.

570

« ¢  27  ª±¨¬ «¼­»© ¯®²®ª

®ª ¦¥¬ ®¡° ²­®¥. ³±²¼ jf j | ¶¥«®·¨±«¥­­»© ¯®²®ª ¢ G0; ¥£®
§­ ·¥­¨¿ ¬®£³² ¡»²¼ ° ¢­» 0 ¨«¨ 1, ² ª ª ª ¯°®¯³±ª­ ¿ ±¯®±®¡­®±²¼ °¥¡¥° ®£° ­¨·¥­  ¥¤¨­¨¶¥©. ¯°¥¤¥«¨¬

M = f(u; v)ju 2 L; v 2 R; f (u; v) = 1g:
®ª ¦¥¬, ·²® M | ¯ °®±®·¥² ­¨¥.  ± ¬®¬ ¤¥«¥, ¨§ ®¤­®© ¢¥°¸¨­» u ­¥ ¬®£³² ¢»µ®¤¨²¼ ¤¢  °¥¡°  (u; v 0) ¨ (u; v 00 ), ¯® ª®²®°»¬
¯®²®ª ° ¢¥­ 1, ² ª ª ª ¢µ®¤¿¹¨© ¢ u ¯®²®ª ­¥ ¯°¥¢®±µ®¤¨² 1. ®
 ­ «®£¨·­»¬ ¯°¨·¨­ ¬ ¢ «¾¡³¾ ¢¥°¸¨­³ v ¢µ®¤¨² ­¥ ¡®«¥¥ ®¤­®£®

°¥¡°  ± ¥¤¨­¨·­»¬ ¯®²®ª®¬.
²®¡» ³¡¥¤¨²¼±¿, ·²® jM j = jf j, § ¬¥²¨¬, ·²® jM j ¥±²¼ ¯®²®ª
·¥°¥§ ° §°¥§ (L [ fsg; R [ ftg (¯® ª ¦¤®¬³ °¥¡°³ ¨¤¥² ¯®²®¬ 1,  
·¨±«® °¥¡¥° ¥±²¼ M ).
¥¬¬  ±¢®¤¨² § ¤ ·³ ® ¬ ª±¨¬ «¼­®¬ ¯ °®±®·¥² ­¨¨ ª § ¤ ·¥
® ¬ ª±¨¬ «¼­®¬ ¶¥«®·¨±«¥­­®¬ ¯®²®ª¥. °¥¡®¢ ­¨¿ ¶¥«®·¨±«¥­­®±²¨ ³ ­ ± ° ­¼¸¥ ­¥ ¡»«®, ­® ®ª §»¢ ¥²±¿, ·²® ¬¥²®¤ ®°¤ {
 «ª¥°±®­  ¢±¥£¤  ¤ ¥² ¶¥«®·¨±«¥­­»© ¬ ª±¨¬ «¼­»© ¯®²®ª, ¥±«¨
²®«¼ª® ¯°®¯³±ª­»¥ ±¯®±®¡­®±²¨ ¢±¥µ °¥¡¥° ¶¥«»¥, ² ª ·²® ±¯¥¶¨ «¼­® § ¡®²¨²±¿ ® ¶¥«®·¨±«¥­­®±²¨ ­¥ ­ ¤®.
¥®°¥¬  27.11 (¥®°¥¬  ® ¶¥«®·¨±«¥­­®¬ ¯®²®ª¥)
±«¨ ¯°®¯³±ª­»¥ ±¯®±®¡­®±²¨ ¢±¥µ °¥¡¥° | ¶¥«»¥ ·¨±« , ²® ¬ ª±¨¬ «¼­»© ¯®²®ª, ­ ©¤¥­­»©  «£®°¨²¬®¬ ®°¤ { «ª¥°±®­ , ¡³¤¥² ¶¥«®·¨±«¥­­»¬.
®ª § ²¥«¼±²¢®
  ª ¦¤®¬ ¸ £¥ (¯°¨ ª ¦¤®¬ ¤®¡ ¢«¥­¨¨ ¯®²®ª  ¯® ¤®¯®«­¿¾¹¥¬³ ¯³²¨) ¯®²®ª ®±² ¥²±¿ ¶¥«®·¨±«¥­­»¬. (®¤°®¡­®¥ ¤®ª § ²¥«¼±²¢® ¬» ®±² ¢«¿¥¬ ·¨² ²¥«¾ ¢ ª ·¥±²¢¥ ³¯°.27.3-2.)
«¥¤±²¢¨¥ 27.12
¨±«® °¥¡¥° ¢ ¬ ª±¨¬ «¼­®¬ ¯ °®±®·¥² ­¨¿ M ¢ ¤¢³¤®«¼­®¬
£° ´¥ G ° ¢­® §­ ·¥­¨¾ ¬ ª±¨¬ «¼­®£® ¯®²®ª  ¢ ±¥²¨ G0.
®ª § ²¥«¼±²¢®
® ²¥®°¥¬¥ 27.11 ¬®¦­® § ¬¥­¨²¼ ±«®¢  À¬ ª±¨¬ «¼­®£® ¯®²®ª Á
­  À¬ ª±¨¬ «¼­®£® ¶¥«®·¨±«¥­­®£® ¯®²®ª Á, ¯®±«¥ ·¥£® ±®±« ²¼±¿
­  «¥¬¬³ 27.10.
 ª¨¬ ®¡° §®¬, ·²®¡» ­ ©²¨ ¬ ª±¨¬ «¼­®¥ ¯ °®±®·¥² ­¨¥ ¢
¤¢³¤®«¼­®¬ £° ´¥ G, ­ ¬ ¤®±² ²®·­® ¯°¨¬¥­¨²¼ ¬¥²®¤ ®°¤ {
 «ª¥°±®­  ¨ ­ ©²¨ ¬ ª±¨¬ «¼­»© ¯®²®ª ¢ ±®®²¢¥±²¢³¾¹¥© ±¥²¨
G0. ¶¥­¨¬ ¢°¥¬¿ ° ¡®²» ² ª®£®  «£®°¨²¬ . ¨ª ª®¥ ¯ °®±®·¥² ­¨¥ ¢ ¤¢³¤®«¼­®¬ £° ´¥ ­¥ ¬®¦¥² ±®¤¥°¦ ²¼ ¡®«¥¥ min(L; R) =
O(V ) °¥¡¥°, ¯®½²®¬³ §­ ·¥­¨¥ ¬ ª±¨¬ «¼­®£® ¯®²®ª  ¢ G0 ° ¢­®
O(V ). «¥¤®¢ ²¥«¼­®, ¢°¥¬¿ ° ¡®²»  «£®°¨²¬  ®°¤ { «ª¥°±®­ 
° ¢­® O(V E ) (±¬.  ­ «¨§  «£®°¨²¬  ®°¤ { «ª¥°±®­  ¢ ° §¤¥«¥
27.2).
¯° ¦­¥­¨¿
27.3-1

«£®°¨²¬ ¯°®² «ª¨¢ ­¨¿ ¯°¥¤¯®²®ª 

571

°¨¬¥­¨²¥  «£®°¨²¬ ®°¤ - «ª¥°±®­  ª ±¥²¨ °¨±³­ª  27.9(b).
 ª ¡³¤³² ¢»£«¿¤¥²¼ ®±² ²®·­»¥ ±¥²¨ ¯®±«¥ ª ¦¤®£® ¸ £ ? (°®­³¬¥°³©²¥ ¢¥°¸¨­» ±¢¥°µ³ ¢­¨§ ®²¤¥«¼­® ¢ L ¨ ¢ R; ­  ª ¦¤®¬ ¸ £¥ ¢»¡¨° ©²¥ ­ ¨¬¥­¼¸¨© ¢ ±¬»±«¥ «¥ª±¨ª®£° ´¨·¥±ª®£® ¯®°¿¤ª 
¤®¯®«­¿¾¹¨© ¯³²¼.)
27.3-2
®ª ¦¨²¥ ²¥®°¥¬³ 27.11.
27.3-3 ³±²¼ G = (V; E ) | ¤¢³¤®«¼­»© £° ´ ¨ G0 | ±®²¢¥²±²¢³¾¹ ¿ ±¥²¼. ¶¥­¨²¼ ±¢¥°µ³ ¤«¨­³ «¾¡®£® ¤®¯®«­¿¾¹¥£® ¯³²¨ ¢ G0,
­ ©¤¥­­®£® ¯°¨ ° ¡®²¥ ¯°®¶¥¤³°» Ford{Fulkerson.
27.3-4*
®«­»¬ (±®¢¥°¸¥­­»¬) ¯ °®±®·¥² ­¨¥¬ (perfect matching) ­ §»¢ ¥²±¿ ¯ °®±®·¥² ­¨¥, ¢ ª®²®°®¥ ¢µ®¤¿² ¢±¥ ¢¥°¸¨­». ³±²¼
G = (V; E ) | ­¥®°¨¥­²¨°®¢ ­­»© ¤¢³¤®«¼­»© £° ´, ¢ ª®²®°®¬
¤®«¨ L ¨ R ¨¬¥¾² ¯®°®¢­³ ½«¥¬¥­²®¢. «¿ ª ¦¤®£® X  V ®¯°¥¤¥«¨¬ ¬­®¦¥±²¢® ±®±¥¤¥© (neighborhood of) X ´®°¬³«®©

N (X ) = fy 2 V j(x; y) 2 E ¤«¿ ­¥ª®²®°®£® x 2 X;
(±®±¥¤¿¬¨ ¿¢«¿¾²±¿ ¢¥°¸¨­», ±®¥¤¨­¥­­»¥ °¥¡°®¬ ± ­¥ª®²®°»¬
½«¥¬¥­²®¬ ¬­®¦¥±²¢  X ). ®ª ¦¨²¥ ²¥®°¥¬³ ®««  (Hall's theorem): ¯®«­®¥ ¯ °®±®·¥² ­¨¥ ±³¹¥±²¢³¥² ²®£¤  ¨ ²®«¼ª® ²®£¤ , ª®£¤  ¤«¿ «¾¡®£® A  L ¢»¯®«­¥­® jAj 6 jN (A)j.
27.3-5*
H §®¢¥¬ ¤¢³¤®«¼­»© £° ´ G = (V; E ) ± ¤®«¿¬¨ L ¨ R d°¥£³«¿°­»¬ (d-regular), ¥±«¨ ±²¥¯¥­¼ ª ¦¤®© ¢¥°¸¨­» v 2 V ° ¢­ 
d. ( ¬¥²¨¬, ·²® ¢ ² ª®¬ ±«³· ¥ jLj = jRj.) ®ª ¦¨²¥, ·²® ¤«¿
d-°¥£³«¿°­®£® £° ´  ¢±¥£¤  ±³¹¥±²¢³¥² ¯®«­®¥ ¯ °®±®·¥² ­¨¥.

27.4. «£®°¨²¬ ¯°®² «ª¨¢ ­¨¿ ¯°¥¤¯®²®ª 
 ½²®¬ ° §¤¥«¥ ¬» ¨§« £ ¥¬ ¬¥²®¤ À¯°®² «ª¨¢ ­¨¿ ¯°¥¤¯®²®ª Á.
H ¨¡®«¥¥ ¡»±²°»¥ ¨§ ¨§¢¥±²­»µ  «£®°¨²¬®¢ ¤«¿ § ¤ ·¨ ® ¬ ª±¨¬ «¼­®¬ ¯®²®ª¥ ¨±¯®«¼§³¾² ¨¬¥­­® ¥£®. ­ ¯°¨¬¥­¨¬ ¨ ª ¤°³£¨¬
§ ¤ · ¬, ­ ¯°¨¬¥° ª § ¤ ·¥ ® ¯®²®ª  ­ ¨¬¥­¼¸¥© ±²®¨¬®±²¨. 
½²®¬ ° §¤¥«¥, ±«¥¤³¿ ®«¼¤¡¥°£³, ¬» ®¯¨¸¥¬ À®¡¹¨©Á ¬¥²®¤ ¯°®² «ª¨¢ ­¨¿ ¯°¥¤¯®²®ª . ¦¥ ¯°®±²¥©¸ ¿ ¥£® °¥ «¨§ ¶¨¿ ²°¥¡³¥²
¢±¥£® «¨¸¼ O(V 2 E ) ¸ £®¢ ¨ ®¯¥°¥¦ ¥²  «£®°¨²¬ ¤¬®­¤± - °¯ 
(O(V E 2)).  ° §¤¥«¥ 27.5 ¬» ¯®ª ¦¥¬, ª ª ³«³·¸¨²¼ ®¶¥­ª³ ¤®
O(V 3).
 ®²«¨·¨¥ ®²  «£®°¨²¬  ¤¬®­¤± - °¯ , ¬» ­¥ ¯°®±¬ ²°¨¢ ¥¬
¢±¾ ¢±¾ ®±² ²®·­³¾ ±¥²¼ ­  ª ¦¤®¬ ¸ £¥,   ¤¥©±²¢³¥¬ «®ª «¼­®
¢ ®ª°¥±²­®±²¨ ®¤­®© ¢¥°¸¨­». °®¬¥ ²®£®, ¬» ­¥ ²°¥¡³¥¬, ¢»¯®«­¥­¨¿ § ª®­  ±®µ° ­¥­¨¿ ¯®²®ª  ¢ ¯°®¶¥±±¥ ° ¡®²»  «£®°¨²¬ ,
¤®¢®«¼±²¢³¿±¼ ¢»¯®«­¥­¨¥¬ ±¢®©±²¢ ¯°¥¤¯®²®ª . » ¡³¤¥¬ ­ §»-

572

« ¢  27  ª±¨¬ «¼­»© ¯®²®ª

¢ ²¼ ¯°¥¤¯®²®ª®¬ (preow) ´³­ª¶¨¾ f : V  V ! R, ª®²®° ¿
ª®±®±¨¬¬¥²°¨·­ , ³¤®¢«¥²¢®°¿¥² ®£° ­¨·¥­¨¿¬, ±¢¿§ ­­»¬ ± ¯°®¯³±ª­»¬¨ ±¯®±®¡­®±²¿¬¨,   ² ª¦¥ ² ª®¬³ ¨ ®±« ¡«¥­­®¬³ § ª®­³
±®µ° ­¥­¨¿: f (V; u) > 0 ¤«¿ ¢±¥µ ¢¥°¸¨­ u 2 V nfsg.  ª¨¬ ®¡° §®¬,
¢ ª ¦¤®© ¢¥°¸¨­¥ u (ª°®¬¥ ¨±²®ª ) ¥±²¼ ­¥ª®²®°»© ­¥®²°¨¶ ²¥«¼­»© ¨§¡»²®ª (excess ow)

e(u) = f (V; u):

(27:8)

¥°¸¨­³ (®²«¨·­³¾ ®² ¨±²®ª  ¨ ±²®ª ) ± ¯®«®¦¨²¥«¼­»¬ ¨§¡»²ª®¬ ­ §®¢¥¬ ¯¥°¥¯®«­¥­­®© (overowing). (®«¼§³¿±¼ ¬¥² ´®°®©
­¥´²¥¯°®¢®¤ , ¬®¦­® ±ª § ²¼, ·²® ¯°¨µ®¤¿¹³¾ ­¥´²¼ ­¥ ³±¯¥¢ ¾²
®²ª ·¨¢ ²¼, ¨ ¨§¡»²®ª ­¥´²¨ ±«¨¢ ¥²±¿.)
 ½²®¬ ° §¤¥«¥ ¬» ®¡º¿±­¨¬ ¨¤¥¾ ¬¥²®¤  ¨ ®¯¨¸¥¬ ¤¢¥ ®±­®¢­»¥ ®¯¥° ¶¨¨: À¯°®² «ª¨¢ ­¨¥Á ¯°¥¤¯®²®ª  ¨ À¯®¤º¥¬Á ¢¥°¸¨­».
®±«¥ ½²®£® ¤®ª ¦¥¬ ¯° ¢¨«¼­®±²¼ ®¡¹¥£®  «£®°¨²¬  ¯°®² «ª¨¢ ­¨¿ ¯°¥¤¯®²®ª  ¨ ®¶¥­¨¬ ¢°¥¬¿ ¥£® ° ¡®²».
®²¨¢¨°®¢ª 
 ¬¥²®¤¥ ®°¤ { «ª¥°±®­  ¬» ¢ ª ¦¤»© ¬®¬¥­² ¨¬¥¥¬ ¤¥«® ±
¯®²®ª®¬ ¦¨¤ª®±²¨ ¯® ²°³¡ ¬ ®² ¨±²®ª  ª ±²®ª³; ­  ª ¦¤®¬ ¸ £¥
¬» ³¢¥«¨·¨¢ ¥¬ ½²®² ¯®²®ª, ­ µ®¤¿ ¤®¯®«­¿¾¹¨© ¯³²¼. ¨¤ª®±²¼
­¨ª³¤  ­¥ ¯°®«¨¢ ¥²±¿ ¯® ¤®°®£¥.
  «£®°¨²¬ µ ¯°®² «ª¨¢ ­¨¿ ¯°¥¤¯®²®ª  ¨§¡»²®ª ¦¨¤ª®±²¨ ¢
ª ¦¤®© ¢¥°¸¨­¥ (¬¥±²¥ ±®¥¤¨­¥­¨¿ ²°³¡) ±«¨¢ ¥²±¿. °®¬¥ ²®£®,
¢ ¦­³¾ °®«¼ ¨£° ¥² ¶¥«®·¨±«¥­­»© ¯ ° ¬¥²°, ª®²®°»© ¡³¤¥² ­ §»¢ ²¼±¿ ¢»±®²®© ¢¥°¸¨­» | ¬» ¡³¤¥¬ ¢®®¡° ¦ ²¼, ·²® ¢ ¯°®¶¥±±¥ ° ¡®²»  «£®°¨²¬  ¢¥°¸¨­  ¬®¦¥² ¯®¤­¨¬ ²¼±¿ ¢¢¥°µ. »±®² 
¢¥°¸¨­» ®¯°¥¤¥«¿¥², ª³¤  ¬» ±² ° ¥¬±¿ ­ ¯° ¢¨²¼ ¨§¡»²®ª ¦¨¤ª®±²¨: µ®²¿ (¯®«®¦¨²¥«¼­»©) ¯®²®ª ¦¨¤ª®±²¨ ¬®¦¥² ¨¤²¨ ¨ ±­¨§³
¢¢¥°µ, ³¢¥«¨·¨¢ ²¼ ¥£® ¢ ² ª®© ±¨²³ ¶¨¨ ­¥«¼§¿. (®¤°®¡­®±²¨ ±¬.
­¨¦¥.)
»±®²  ¨±²®ª  ¢±¥£¤  ° ¢­  jV j,   ±²®ª  | ­³«¾. ±¥ ®±² «¼­»¥ ¢¥°¸¨­» ¨§­ · «¼­® ­ µ®¤¿²±¿ ­  ¢»±®²¥ 0, ¨ ±® ¢°¥¬¥­¥¬
¯®¤­¨¬ ¾²±¿. «¿ ­ · «  ¬» ®²¯° ¢«¿¥¬ ¨§ ¨±²®ª  ¢­¨§ ±²®«¼ª®
¦¨¤ª®±²¨, ±ª®«¼ª® ­ ¬ ¯®§¢®«¿¾² ¯°®¯³±ª­»¥ ±¯®±®¡­®±²¨ ¢»µ®¤¿¹¨µ ¨§ ¨±²®ª  ²°³¡ (½²® ª®«¨·¥±²¢® ° ¢­® ¯°®¯³±ª­®© ±¯®±®¡­®±²¨ ° §°¥§  (s; V n s)). ®§­¨ª ¾¹¨© (¢ ±®±¥¤­¨µ ± ¨±²®ª®¬ ¢¥°¸¨­ µ) ¨§¡»²®ª ¦¨¤ª®±²¨ ±¯¥°¢  ¯°®±²® ¢»«¨¢ ¥²±¿, ­® § ²¥¬ ®­
¡³¤¥² ­ ¯° ¢«¥­ ¤ «¼¸¥.
 ±±¬ ²°¨¢ ¿ ª ª³¾-«¨¡® ¢¥°¸¨­³ u ¢ µ®¤¥ ° ¡®²»  «£®°¨²¬ ,
¬» ¬®¦¥¬ ®¡­ °³¦¨²¼, ·²® ¢ ­¥© ¥±²¼ ¨§¡»²®ª ¦¨¤ª®±²¨, ­® ·²®
¢±¥ ²°³¡», ¯® ª®²®°»¬ ¥¹¥ ¬®¦­® ®²¯° ¢¨²¼ ¦¨¤ª®±²¼ ¨§ u ª³¤ ²® (¢±¥ ­¥­ ±»¹¥­­»¥ ²°³¡») ¢¥¤³² ¢ ¢¥°¸¨­» ²®© ¦¥ ¨«¨ ¡®«¼¸¥© ¢»±®²».  ½²®¬ ±«³· ¥ ¬» ¬®¦¥¬ ¢»¯®«­¨²¼ ¤°³£³¾ ®¯¥° ¶¨¾, ­ §»¢ ¥¬³¾ À¯®¤º¥¬®¬Á ¢¥°¸¨­» u. ®±«¥ ½²®£® ¢¥°¸¨­  u
±² ­®¢¨²±¿ ­  ¥¤¨­¨¶³ ¢»¸¥ ± ¬®£® ­¨§ª®£® ¨§ ²¥µ ¥¥ ±®±¥¤¥©, ¢

«£®°¨²¬ ¯°®² «ª¨¢ ­¨¿ ¯°¥¤¯®²®ª 

573

ª®²®°®£® ¢¥¤¥² ­¥­ ±»¹¥­­ ¿ ²°³¡  | ¤°³£¨¬¨ ±«®¢ ¬¨, ¬» ¯®¤­¨¬ ¥¬ u °®¢­® ­ ±²®«¼ª®, ·²®¡» ¯®¿¢¨« ±¼ ­¥­ ±»¹¥­­ ¿ ²°³¡ ,
¢¥¤³¹ ¿ ¢­¨§.
 ª®­¶¥ ª®­¶®¢ ¬» ¤®¡¼¥¬±¿ ²®£®, ·²® ¢ ±²®ª ¯°¨µ®¤¨² ¬ ª±¨¬ «¼­® ¢®§¬®¦­®¥ ª®«¨·¥±²¢® ¦¨¤ª®±²¨ (¤«¿ ¤ ­­»µ ¯°®¯³±ª­»µ
±¯®±®¡­®±²¥© ²°³¡). °¨ ½²®¬ ¯°¥¤¯®²®ª ¬®¦¥² ¥¹¥ ­¥ ¡»²¼ ¯®²®ª®¬ (¨§¡»²®ª ¦¨¤ª®±²¨ ±«¨¢ ¥²±¿). °®¤®«¦ ¿ ¯®¤º¥¬ ¢¥°¸¨­
(ª®²®°»¥ ¬®£³² ±² ²¼ ¢»¸¥ ¨±²®ª ), ¬» ¯®±²¥¯¥­­® ®²¯° ¢¨¬ ¨§¡»²®ª ®¡° ²­® ¢ ¨±²®ª (·²® ®§­ · ¥² ±®ª° ¹¥­¨¥ ¯®²®ª  ¦¨¤ª®±²¨
®² ¨±²®ª ) | ¨ ¯°¥¢° ²¨¬ ¯°¥¤¯®²®ª ¢ ¯®²®ª (ª®²®°»© ®ª ¦¥²±¿
¬ ª±¨¬ «¼­»¬).
±­®¢­»¥ ®¯¥° ¶¨¨
² ª,  «£®°¨²¬ ¯°®² «ª¨¢ ­¨¿ ¯°¥¤¯®²®ª  ¨±¯®«¼§³¥² ¤¢¥
®±­®¢­»¥ ®¯¥° ¶¨¨: ¯°®² «ª¨¢ ­¨¥ ¯®²®ª  ¨§ ¢¥°¸¨­» ¢ ±®±¥¤­¾¾ ¨ ¯®¤º¥¬ ¢¥°¸¨­».  ¤¨¬ ²®·­»¥ ®¯°¥¤¥«¥­¨¿.
³±²¼ G = (V; E ) | ±¥²¼ ± ¨±²®ª®¬ s ¨ ±²®ª®¬ t,   f | ¯°¥¤¯®²®ª
¢ G. ³­ª¶¨¿ h : V ! N ­ §»¢ ¥²±¿ ¢»±®²­®© ´³­ª¶¨¥© (height
function) ¤«¿ ¯°¥¤¯®²®ª  f , ¥±«¨ h(s) = jV j, h(t) = 0 ¨
h(u) 6 h(v ) + 1
¤«¿ «¾¡®£® ®±² ²®·­®£® °¥¡°  (u; v ) 2 Ef . «¥¤³¾¹ ¿ «¥¬¬  ¤ ¥²
®·¥¢¨¤­³¾ ¯¥°¥´®°¬³«¨°®¢ª³ ½²®£® ³±«®¢¨¿:
¥¬¬  27.13
³±²¼ f | ¯°¥¤¯®²®ª ¢ ±¥²¨ G = (V; E ) ¨ h | ¢»±®²­ ¿ ´³­ª¶¨¿.
®£¤  ¥±«¨ ¤«¿ ¢¥°¸¨­ u; v 2 V , ¢»¯®«­¥­® h(u) > h(v ) + 1, ²®
®±² ²®·­ ¿ ±¥²¼ ­¥ ±®¤¥°¦¨² °¥¡°  (u; v ) (À¯® ª°³²® ¨¤³¹¨¬ ¢­¨§
²°³¡ ¬ ¨¤¥² ¬ ª±¨¬ «¼­® ¢®§¬®¦­»© ¯®²®ªÁ.)
¥¯¥°¼ ®¯°¥¤¥«¨¬ ®±­®¢­»¥ ®¯¥° ¶¨¨.
°®¶¥¤³°  Push(u; v ) ¯°¨¬¥­¨¬ , ¥±«¨ ¢¥°¸¨­  u ¯¥°¥¯®«­¥­ 
(²® ¥±²¼ cf (u; v ) > 0) ¨ ¥±«¨ h(u) = h(v )+1. °¨ ½²®¬ ¯®²®ª ¨§ ¢¥°¸¨­» u ¢ ¥¥ ±®±¥¤  v ° ±²¥² | ¥£® ³¢¥«¨·¥­¨¥ ®£° ­¨·¥­® ¨§¡»²ª®¬ ¦¨¤ª®±²¨ ¢ u ¨ ®±² ²®·­®© ¯°®¯³±ª­®© ±¯®±®¡­®±²¼¾ °¥¡° 
(u; v ).
\textsc{Push}($u,v$)
1 $\triangleright$ ¤ ­®: ¢¥°¸¨­  $u$ ¯¥°¥¯®«­¥­ ,
$c_f(u,v)>0$ ¨ $h(u)=h(v)+1$.
2 $\triangleright$ ­ ¤®: ¯°®²®«ª­³²¼
$d_f(u,v)=\min(e[u],c_f(u,v)$ ¥¤¨­¨¶ ¯®²®ª  ¨§ $u$ ¢
3 $d_f(u,v)\leftarrow\min(e[u],c_f(u,v)$
4 $f[u,v]\leftarrow f[u,v]+d_f(u,v)$
5 $f[v,u]\leftarrow -f[u,v]$
6
$e[u]\leftarrow e[u]-d_f(u,v)$
7
$e[v]\leftarrow e[v]+d_f(u,v)$

$v$.

» ¯°¥¤¯®« £ ¥¬, ·²® ¨§¡»²®ª ¢ ¢¥°¸¨­¥ ° ¢¥­ e[u] > 0, ¨
·²® ®±² ²®·­ ¿ ¯°®¯³±ª­ ¿ ±¯®±®¡­®±²¼ °¥¡°  (u; v ) ² ª¦¥ ¯®«®¦¨-

574

« ¢  27  ª±¨¬ «¼­»© ¯®²®ª

²¥«¼­ . ®½²®¬³ ¬» ¬®¦¥¬ ­ ¯° ¢¨²¼ min(e[u]; cf (u; v )) > 0 ¥¤¨­¨¶
¯®²®ª  ¨§ u ¢ v (¬» ¢»·¨±«¿¥¬ ½²³ ¢¥«¨·¨­³ ¢ ±²°®ª¥ 3), ­¥ ¯°¥¢»±¨¢ ¯°®¯³±ª­®© ±¯®±®¡­®±²¨ ¨ ­¥ ±¤¥« ¢ ¨§¡»²®ª ®²°¨¶ ²¥«¼­»¬.
«¥¤®¢ ²¥«¼­®, ¥±«¨ ´³­ª¶¨¿ f ®±² ­¥²±¿ ¯°¥¤¯®²®ª®¬ (¥±«¨ ®­ ¨¬
¡»« ). » ¨§¬¥­¿¥¬ f ¢ ±²°®ª µ 4-5 ¨ e ¢ ±²°®ª µ 6-7.
±«®¢¨¥ h(u) = h(v ) + 1 £ ° ­²¨°³¥², ·²® ¬» ­ ¯° ¢«¿¥¬ ¤®¯®«­¨²¥«¼­»© ¯®²®ª «¨¸¼ ¯® °¥¡° ¬, ¨¤³¹¨¬ ¢­¨§ ± ¥¤¨­¨·­®©
° §­¨¶¥© ¢»±®². ¯°®·¥¬, ¡®«¥¥ ª°³²»¥ °¥¡°  ³¦¥ ­ ±»¹¥­» ¨
² ª («¥¬¬  27.13)
¯¥° ¶¨¿ Push ­ §»¢ ¥²±¿ ¯°®² «ª¨¢ ­¨¥¬ ¨§ ¢¥°¸¨­» u ¢ ¢¥°¸¨­³ v (¯°¨¬¥­¥­­»¬ ª ¢¥°¸¨­¥ u). °®² «ª¨¢ ­¨¥ ­ §»¢ ¥²±¿ ­ ±»¹ ¾¹¨¬ (saturating), ¥±«¨ ¢ °¥§³«¼² ²¥ °¥¡°® (u; v ) ±² ­®¢¨²±¿
­ ±»¹¥­­»¬ (saturated), ²® ¥±²¼ ¥±«¨ cf (u; v ) ®¡° ¹ ¥²±¿ ¢ ­³«¼
(°¥¡°® ¨±·¥§ ¥² ¨§ ®±² ²®·­®© ±¥²¨); ¢ ¯°®²¨¢­®¬ ±«³· ¥ ¯°®² «ª¨¢ ­¨¥ ±·¨² ¾² ­¥­ ±»¹ ¾¹¨¬ (nonsaturating).
°®¶¥¤³°  Lift(u) ¯®¤­¨¬ ¥² ¯¥°¥¯®«­¥­­³¾ ¢¥°¸¨­³ u ­  ¬ ª±¨¬ «¼­³¾ ¢»±®²³, ª®²®° ¿ ¤®¯³±²¨¬  ¯® ®¯°¥¤¥«¥­¨¾ ¢»±®²­®©
´³­ª¶¨¨. ®±¬®²°¨¬ ­  ±®®²­®¸¥­¨¥ ¢»±®² ¢¥°¸¨­» ¨ ¥¥ ±®±¥¤¥©
¢ ®±² ²®·­®© ±¥²¨. ® ®¯°¥¤¥«¥­¨¾ ¢»±®²­®© ´³­ª¶¨¨ ¢»±®²  ¢¥°¸¨­» ¯°¥¢®±µ®¤¨² ¢»±®²³ ±®±¥¤  ¢ ®±² ²®·­®© ±¥²¨ ­¥ ¡®«¥¥ ·¥¬ ­ 
1. ±«¨ ¥±²¼ ±®±¥¤, ª®²®°»© ­  ¥¤¨­¨¶³ ­¨¦¥, ²® ¬®¦­® ¢»¯®«­¨²¼
¯°®² «ª¨¢ ­¨¥ (­® ­¥«¼§¿ ¢»¯®«­¨²¼ ¯®¤º¥¬). ±«¨ ¢±¥ ±®±¥¤¨ ­¥
­¨¦¥, ²® ¯°®² «ª¨¢ ­¨¥ ¢»¯®«­¨²¼ ­¥«¼§¿,   ¯®¤º¥¬ | ¬®¦­®,
¯®±«¥ ·¥£® ¢®§¬®¦­® ¯°®² «ª¨¢ ­¨¥. ®² ª ª ¢»£«¿¤¨² ¯°®¶¥¤³° 
¯®¤º¥¬  (lifting):
\textsc{Lift}($u$)
1 $\triangleright$ ¤ ­®: ¢¥°¸¨­  $u$ ¯¥°¥¯®«­¥­ ; ¤«¿ «¾¡®£®
°¥¡°  $(u,v)\in E_f$ ¢»¯®«­¥­® ­¥° ¢¥­±²¢® $h(u)\le h(v)$.
2 $\triangleright$ ­ ¤®: ³¢¥«¨·¨²¼ $h[u]$, ¯®¤£®²®¢«¿¿ ¯°®² «ª¨¢ ­¨¥
¨§ ¢¥°¸¨­» $u$
3
$h[u]\leftarrow 1+\min\{h[v]|(u,v)\ in E_f\}$

 ¬¥²¨¬, ·²® ¥±«¨ ¢¥°¸¨­  u ¯¥°¥¯®«­¥­ , ²® ¢ Ef ­ ©¤¥²±¿ ¯®
ª° ©­¥© ¬¥°¥ ®¤­® °¥¡°®, ¢»µ®¤¿¹¥¥ ¨§ u (¬¨­¨¬³¬ ¢ ±²°®ª¥ 3
¡¥°¥²±¿ ¯® ­¥¯³±²®¬³ ¬­®¦¥±²¢³). ²®¡» ¤®ª § ²¼ ½²®, ¢±¯®¬­¨¬,
·²® f [V; u] = e[u] > 0, ¯®½²®¬³ ±³¹¥±²¢³¥² ¯® ª° ©­¥© ¬¥°¥ ®¤­ 
² ª ¿ ¢¥°¸¨­  v , ¤«¿ ª®²®°®© f (v; u) > 0. ®«³· ¥¬

cf (u; v ) = c(u; v) ; f [u; v ] = c(u; v ) + f [v; u] > 0;
  ½²® ®§­ · ¥², ·²® (u; v ) 2 Ef . (±«¨ ¢ ¢¥°¸¨­¥ ¦¨¤ª®±²¼ ¢»-

«¨¢ ¥²±¿, ²® ®­  ®²ª³¤ -²® ¯°¨µ®¤¨², ¨ ¥±²¼ °¥§¥°¢, ±®±²®¿¹¨© ¢
³¬¥­¼¸¥­¨¨ ½²®£® ¯°¨µ®¤ .)
¡¹ ¿ ±µ¥¬   «£®°¨²¬ 
«£®°¨²¬ ­ ·¨­ ¥²±¿ ± ¢»§®¢  Initialize-Preflow, § ¤ ¾¹¥£®

«£®°¨²¬ ¯°®² «ª¨¢ ­¨¿ ¯°¥¤¯®²®ª 

575

­ · «¼­»© ¯°¥¤¯®²®ª:

8
>
<

c(u; v ) ¥±«¨ u = s;
f [u; v] = > ;c(v; u) ¥±«¨ v = s;
:

0 ¢ ®±² «¼­»µ ±«³· ¿µ.

(27:9)

\textsc{Initialize-Preflow}($G,s$)
1 for (¤«¿) ª ¦¤®© ¢¥°¸¨­» $u\in V[G]$
2
do $h[u]\leftarrow 0$
$e[u]\leftarrow 0$
4 for (¤«¿) ª ¦¤®£® °¥¡°  $(u,v)\in E[G]$
5
do $f[u,v]\leftarrow 0$
6
$f[v,u]\leftarrow 0$
7
$h[s]\leftarrow |V[G]|$
8 for (¤«¿) ª ¦¤®© ¢¥°¸¨­» $u\in Adj[s]$
9
do $f[s,u]\leftarrow c(s,u)$
10
$f[u,s]\leftarrow -c(s,u)$
11
$e[u]\leftarrow c(s,u)$

 ¬ ±±¨¢¥ h µ° ­¿²±¿ ¢»±®²», ¢ ¬ ±±¨¢¥ e | ¨§¡»²ª¨, c(u; v ) |
¯°®¯³±ª­»¥ ±¯®±®¡­®±²¨ (±·¨² ¥¬, ·²® ®­¨ § ¤ ­» ² ª, ·²® ¢»·¨±«¥­¨¥ c(u; v ) ²°¥¡³¥² ¢°¥¬¥­¨ O(1)). ®²®ª § ¯¨±»¢ ¥²±¿ ¢ ¬ ±±¨¢
f.
®²®ª ¯® ª ¦¤®¬³ °¥¡°³, ¢»µ®¤¿¹¥¬³ ¨§ ¨±²®ª  s, ±² ­®¢¨²±¿ ° ¢­»¬ ¯°®¯³±ª­®© ±¯®±®¡­®±²¨ ½²®£® °¥¡° . ® ®±² «¼­»¬
°¥¡° ¬ ¯®²®ª ° ¢¥­ 0.  ª ¦¤®© ±¬¥¦­®© ± ¨±²®ª®¬ ¢¥°¸¨­¥ v
¯®¿¢«¿¥²±¿ ¨§¡»²®ª e[v ] = c(s; v ). H · «¼­ ¿ ¢»±®²  § ¤ ¥²±¿ ´®°¬³«®©

jV j; ¥±«¨ u = s;
h[u] = 0; ¢ ¯°®²¨¢­®¬ ±«³· ¥.
²® ¤¥©±²¢¨²¥«¼­® ¢»±®²­ ¿ ´³­ª¶¨¿, ² ª ª ª °¥¡°  (u; v ), ¤«¿
ª®²®°»µ h[u] > h[v ] + 1, ¢»µ®¤¿² ²®«¼ª® ¨§ ¨±²®ª  (u = s), ­® ½²¨
°¥¡°  ­ ±»¹¥­» ¨ ¨µ ­¥² ¢ ®±² ²®·­®© ±¥²¨.
°®£° ¬¬  Generic-Preflow-Push ¤ ¥² ®¡¹³¾ ±µ¥¬³  «£®°¨²¬ , ®±­®¢ ­­®£® ­  ¯°®² «ª¨¢ ­¨¨ ¯°¥¤¯®²®ª .
\textsc{Generic-Preflow-Push}
1 \textsc{Initialize-Preflow}
2
while (¯®ª ) ¢®§¬®¦­» ®¯¥° ¶¨¨ ¯®¤º\"^^a5¬  ¨«¨ ¯°®² «ª¨¢ ­¨¿
3
do ¢»¯®«­¨²¼ ®¤­³ ¨§ ½²¨µ ®¯¥° ¶¨©

«¥¤³¾¹ ¿ «¥¬¬  ¯®ª §»¢ ¥², ·²® ¯®ª  ¥±²¼ µ®²¼ ®¤­  ¯¥°¥¯®«­¥­­ ¿ ¢¥°¸¨­ , ª ª ¿-²® ¨§ ®¯¥° ¶¨© ¯®¤º¥¬  ¨«¨ ¯°®² «ª¨¢ ­¨¿
¢®§¬®¦­ .

576

« ¢  27  ª±¨¬ «¼­»© ¯®²®ª

¥¬¬  27.14 ( ¯¥°¥¯®«­¥­­®© ¢¥°¸¨­¥ ¢®§¬®¦­® «¨¡® ¯°®² «ª¨¢ ­¨¥, «¨¡® ¯®¤º¥¬)
³±²¼ f | ¯°¥¤¯®²®ª ¢ ±¥²¨ G = (V; E ). ³±²¼ h | ¢»±®²­ ¿
´³­ª¶¨¿ ¤«¿ f ¨ ¢¥°¸¨­  u ¯¥°¥¯®«­¥­ . ®£¤  ¢ u ¢®§¬®¦­® «¨¡®
¯°®² «ª¨¢ ­¨¥, «¨¡® ¯®¤º¥¬.
®ª § ²¥«¼±²¢®
®±ª®«¼ª³ h | ¢»±®²­ ¿ ´³­ª¶¨¿, ²® h(u) 6 h(v )+1 ¤«¿ «¾¡®£®
®±² ²®·­®£® °¥¡°  (u; v ). ±«¨ ¢ u ­¥¢®§¬®¦­® ¯°®² «ª¨¢ ­¨¥, ²®
¤«¿ ¢±¥µ ®±² ²®·­»µ °¥¡¥° (u; v ) ¢»¯®«­¥­® ­¥° ¢¥­±²¢® h(u) <
h(v ) + 1, ¨§ ·¥£® ±«¥¤³¥², ·²® h(u) 6 h(v ), ¨ ¢ ¢¥°¸¨­¥ u ¢®§¬®¦¥­
¯®¤º¥¬.
®°°¥ª²­®±²¼ ¬¥²®¤ 
®°°¥ª²­®±²¼ ¬¥²®¤  ¯°®² «ª¨¢ ­¨¿ ¯°¥¤¯®²®ª  ¬» ¤®ª ¦¥¬
¢ ¤¢  ½² ¯ . ­ · «  ¬» ¤®ª ¦¥¬, ·²® ¥±«¨  «£®°¨²¬ ®±² ­®¢¨²±¿, ²® ¯°¥¤¯®²®ª f ¢ ½²®² ¬®¬¥­² ¡³¤¥² ¬ ª±¨¬ «¼­»¬ ¯®²®ª®¬.
 ²¥¬ ¬» ¤®ª ¦¥¬, ·²®  «£®°¨²¬ ¤¥©±²¢¨²¥«¼­® ®±² ­®¢¨²±¿.  ·­¥¬ ± ² ª®£® § ¬¥· ­¨¿ (®·¥¢¨¤­®£® ±«¥¤³¾¹¥£® ¨§ ®¯¨± ­¨¿ ¯°®¶¥¤³°» ¯®¤º¥¬ ).
¥¬¬  27.15 (»±®²  ¢¥°¸¨­» ­¥ ³¡»¢ ¥²)
°¨ ¨±¯®«­¥­¨¨ ¯°®£° ¬¬» Generic-Preflow-Push ¢»±®² 
h[u] «¾¡®© ¢¥°¸¨­» u 2 V ¬®¦¥² ²®«¼ª® ¢®§° ±² ²¼ (¯°¨ ª ¦¤®¬
¯®¤º¥¬¥ ½²®© ¢¥°¸¨­» ¯® ¬¥­¼¸¥© ¬¥°¥ ­  ¥¤¨­¨¶³).
¥¬¬  27.16
® ¢°¥¬¿ ¢»¯®«­¥­¨¿ ¯°®£° ¬¬» Generic-Preflow-Push
´³­ª¶¨¿ h ®±² ¥²±¿ ¢»±®²­®© ´³­ª¶¨¥©.
®ª § ²¥«¼±²¢®
®±¬®²°¨¬, ·²® ¯°®¨±µ®¤¨² ¯°¨ ¯°®² «ª¨¢ ­¨¨ ¨ ¯°¨ ¯®¤º¥¬¥.
°¨ ¯®¤º¥¬¥ ¢¥°¸¨­» u ¬» § ¡®²¨¬±¿ ® ²®¬, ·²®¡» ¢»µ®¤¿¹¨¥
¨§ u ®±² ²®·­»¥ °¥¡°  ­¥ ­ °³¸ «¨ ®¯°¥¤¥«¥­¨¥ ¢»±®²­®© ´³­ª¶¨¨. ²® ¦¥ ª ± ¥²±¿ ¢µ®¤¿¹¨µ °¥¡¥°, ²® ± ­¨¬¨ ­¥ ¬®¦¥² ¡»²¼
¯°®¡«¥¬, ² ª ª ª ¢»±®²  ¢¥°¸¨­» u ²®«¼ª® ¢®§° ±² ¥².
 ±±¬®²°¨¬ ²¥¯¥°¼ ¯°®¶¥¤³°³ Push(u; v ). ¥£ª® ¯®­¿²¼, ·²®
ª°³²® ¨¤³¹¨¥ ¢­¨§µ ­¥­ ±»¹¥­­»¥ °¥¡°  ¯®¿¢¨²¼±¿ ­¥ ¬®£³². ®«¥¥ ´®°¬ «¼­®, ½²  ¯°®¶¥¤³°  ¬®¦¥² ¤®¡ ¢¨²¼ °¥¡°® (v; u) ¢ Ef ,  
² ª¦¥ ³¤ «¨²¼ °¥¡°® (u; v ) ¨§ Ef .  ¯¥°¢®¬ ±«³· ¥ h[v ] = h[u] ; 1
¨ h ®±² ¥²±¿ ¢»±®²­®© ´³­ª¶¨¥©. ® ¢²®°®¬ ±«³· ¥ ³¤ «¥­¨¾ °¥¡°  ±®¯³²±²¢³¥² ®²¬¥­  ±®®²¢¥²±²¢³¾¹¥£® ®£° ­¨·¥­¨¿ ¨ h ±­®¢ 
®±² ¥²±¿ ¢»±®²­®© ´³­ª¶¨¥©.
®ª ¦¥¬ ®¤­® ¢ ¦­®¥ ±¢®©±²¢® ¢»±®²­®© ´³­ª¶¨¨.
¥¬¬  27.17
³±²¼ G = (V; E ) | ±¥²¼ ± ¨±²®ª®¬ s ¨ ±²®ª®¬ t. ³±²¼ f |
¯°¥¤¯®²®ª ¢ G,   h | ¢»±®²­ ¿ ´³­ª¶¨¿ ¤«¿ f . ®£¤  ¢ ®±² ²®·­®©
±¥²¨ Gf ­¥ ±³¹¥±²¢³¥² ¯³²¨ ¨§ ¨±²®ª  ¢ ±²®ª.
®ª § ²¥«¼±²¢®
³±²¼ ½²® ­¥ ² ª ¨ ² ª®© ¯³²¼ ±³¹¥±²¢³¥². ±²° ­¿¿ ¶¨ª«»,
¬®¦­® ±·¨² ²¼, ·²® ®­ ¯°®±²®© ¨ ¯®²®¬³ ¤«¨­  ¥£® ¬¥­¼¸¥ jV j.

«£®°¨²¬ ¯°®² «ª¨¢ ­¨¿ ¯°¥¤¯®²®ª 

577

°¨ ½²®¬ ¢»±®²  ¯ ¤ ¥² ®² jV j ¤® ­³«¿. «¥¤®¢ ²¥«¼­®, ¢ ¯³²¨
¥±²¼ °¥¡°®, £¤¥ ¢»±®²  ¯ ¤ ¥² ¯® ª° ©­¥© ¬¥°¥ ­  2 |   ² ª®¥
°¥¡°® ­¥ ¬®¦¥² ¢µ®¤¨²¼ ¢ ®±² ²®·­³¾ ±¥²¼.
¥®°¥¬  27.18 (®°°¥ª²­®±²¼ ¬¥²®¤  ¯°®² «ª¨¢ ­¨¿ ¯°¥¤¯®²®ª )
±«¨ ¯°®£° ¬¬  Generic-Preflow-Push, ¯°¨¬¥­¥­­ ¿ ª ±¥²¨
G = (V; E ) ± ¨±²®ª®¬ s ¨ ±²®ª®¬ t ®±² ­ ¢«¨¢ ¥²±¿, ²® ¯®«³· ¾¹¨©±¿ ¯°¥¤¯®²®ª f , ¡³¤¥² ¬ ª±¨¬ «¼­»¬ ¯®²®ª®¬ ¤«¿ G.
®ª § ²¥«¼±²¢®
¥¬¬  27.14 £ ° ­²¨°³¥², ·²® ¢ ¬®¬¥­² ®±² ­®¢ª¨ ¯¥°¥¯®«­¥­­»µ ¢¥°¸¨­ ¢ ±¥²¨ ­¥² (¨§¡»²®ª ¢ ª ¦¤®© ° ¢¥­ ­³«¾). ­ ·¨², ¢
½²®² ¬®¬¥­² ¯°¥¤¯®²®ª ¿¢«¿¥²±¿ ¯®²®ª®¬. ® «¥¬¬¥ 27.16 ´³­ª¶¨¿
h ¡³¤¥² ¢»±®²­®© ´³­ª¶¨¥©, ¨ ¯®²®¬³ («¥¬¬  27.17) ¢ ®±² ²®·­®©
±¥²¨ Gf ­¥² ¯³²¨ ¨§ s ¢ t. ® ²¥®°¥¬¥ ® ¬ ª±¨¬ «¼­®¬ ¯®²®ª¥ ¨
¬¨­¨¬ «¼­®¬ ° §°¥§¥ ¯®²®ª f ¬ ª±¨¬ «¥­.
­ «¨§ ¬¥²®¤ 
²®¡» ³¡¥¤¨²¼, ·²®  «£®°¨²¬ ¯°®² «ª¨¢ ­¨¿ ¯°¥¤¯®²®ª 
®±² ­ ¢«¨¢ ¥²±¿, ³ª ¦¥¬ ¢¥°µ­¨¥ £° ­¨¶» ®²¤¥«¼­® ¤«¿ ·¨±« 
¯®¤º¥¬®¢, ­ ±»¹ ¾¹¨µ ¨ ­¥­ ±»¹ ¾¹¨µ ¯°®² «ª¨¢ ­¨©. ®±«¥
½²®£® ±² ­¥² ¿±­®, ·²® ¢°¥¬¿ ° ¡®²»  «£®°¨²¬  ¥±²¼ O(V 2 E ).
 ·­¥¬ ± ² ª®© ¢ ¦­®© «¥¬¬»:
¥¬¬  27.19
³±²¼ G = (V; E ) | ±¥²¼ ± ¨±²®ª®¬ s ¨ ±²®ª®¬ t,   f | ¯°¥¤¯®²®ª
¢ G. ®£¤  ¤«¿ «¾¡®© ¯¥°¥¯®«­¥­­®© ¢¥°¸¨­» u ­ ©¤¥²±¿ ¯°®±²®©
¯³²¼ ¨§ u ¢ s ¢ ®±² ²®·­®© ±¥²¨ Gf .
®ª § ²¥«¼±²¢®.
¨¤ª®±²¼, ±«¨¢ ¥¬ ¿ ¢ ¢¥°¸¨­¥ u, ¯®¯ ¤ ¥² ²³¤  ¨§ ¨±²®ª  s
¯® ª ª®¬³-²® ¯³²¨: ±³¹¥±²¢³¥² ¯³²¼ ¨§ s ¢ u, ¯® °¥¡° ¬ ª®²®°®£® ¨¤¥² ¯®«®¦¨²¥«¼­»© ¯®²®ª. (®°¬ «¼­® ¬®¦­® ° ±±³¦¤ ²¼
² ª: ° ±±¬®²°¨¬ ¬­®¦¥±²¢® U ²¥µ ¢¥°¸¨­, ¨§ ª®²®°»µ ¢ u ¬®¦­®
¯°®©²¨ ¯® °¥¡° ¬ ± ¯®«®¦¨²¥«¼­»¬ ¯®²®ª®¬. ±«¨ ±°¥¤¨ ­¨µ ­¥²
¨±²®ª , ²® ¢ U ­¨ ¯® ª ª¨¬ °¥¡° ¬ ¦¨¤ª®±²¼ ­¥ ¢µ®¤¨². ²±¾¤  ±«¥¤³¥², ·²® e(U ) (±³¬¬  ¢±¥µ ¨§¡»²ª®¢ ¢¥°¸¨­ ¢ U ), ° ¢­ ¿
f (V; U ) = f (V n U; U ) + f (U; U ) = f (V n U; U ) 6 0, ² ª ·²® ¢±¥
¨§¾»²ª¨ ° ¢­» 0.)
² ª, ¢®§¼¬¥¬ ¯³²¼ ¨§ s ¢ u, ¯® ¢±¥¬ °¥¡° ¬ ª®²®°®£® ¨¤¥² ¯®«®¦¨²¥«¼­»© ¯®²®ª, ¨ ®¡° ²¨¬ ¥£® °¥¡° . ¡° ²­»¥ °¥¡°  ¢µ®¤¿² ¢ ®±² ²®·­³¾ ±¥²¼. «¿ ¤®ª § ²¥«¼±²¢  ³²¢¥°¦¤¥­¨¿ «¥¬¬»
®±² ¥²±¿ ³¤ «¨²¼ ¶¨ª«» (¥±«¨ ®­¨ ¥±²¼).
«¥¤³¾¹ ¿ «¥¬¬  ®£° ­¨·¨¢ ¥² ¢»±®²³ ¢¥°¸¨­», ¨ ²¥¬ ± ¬»¬
·¨±«® ¢®§¬®¦­»µ ¯®¤º¥¬®¢.
¥¬¬  27.20
°¨ ¨±¯®«­¥­¨¨ ¯°®£° ¬¬» Generic-Preflow-Push ¢»±®² 
«¾¡®© ¢¥°¸¨­» v 2 V ­¨ª®£¤  ­¥ ¯°¥¢§®©¤¥² 2jV j ; 1.
®ª § ²¥«¼±²¢®
® ®¯°¥¤¥«¥­¨¾ ¢»±®²» h[s] = jV j ¨ h[t] = 0. ®¤º¥¬ ¯°¨¬¥­¨¬

578

« ¢  27  ª±¨¬ «¼­»© ¯®²®ª

²®«¼ª® ª ¯¥°¥¯®«­¥­­»¬ ¢¥°¸¨­ ¬ | ¯®±¬®²°¨¬, ­  ª ª®© ¢»±®²¥ ®­¨ ¬®£³² ¡»²¼. ³±²¼ u | ¯¥°¥¯®«­¥­­ ¿ ¢¥°¸¨­ . ® «¥¬¬¥
27.19, ¢ Gf ±³¹¥±²¢³¥² ¯°®±²®© ¯³²¼ p ¨§ ½²®© ¢¥°¸¨­» ¢ s. ®
®¯°¥¤¥«¥­¨¾ ¢»±®²­®© ´³­ª¶¨¨, ¢»±®²  ­¥ ¬®¦¥² ³¡»¢ ²¼ ¡®«¥¥
·¥¬ ­  1 ¢¤®«¼ °¥¡¥° ±¥²¨ Gf ,   ¢»±®²  ª®­¥·­®© ¢¥°¸¨­» ¯³²¨
(².¥. s) ° ¢­  jV j. ³²¼ (¡³¤³·¨ ¯°®±²»¬) ±®¤¥°¦¨² ­¥ ¡®«¥¥ jV j; 1
°¥¡¥°, ² ª ·²® ¢»±®²  ¥£® ­ · «  ­¥ ¯°¥¢®±µ®¤¨² 2jV j ; 1.
«¥¤±²¢¨¥ 27.21 (¶¥­ª  ·¨±«  ¯®¤º¥¬®¢)
°¨ ¨±¯®«­¥­¨¨ ¯°®£° ¬¬» Generic-Preflow-Push ®¡¹¥¥ ·¨±«® ®¯¥° ¶¨© ¯®¤º¥¬  ­¥ ¯°¥¢®±µ®¤¨² 2jV j2.
®ª § ²¥«¼±²¢®
»±®²  ¢¥°¸¨­» ¯°¨ ¯®¤º¥¬¥ ³¢¥«¨·¨¢ ¥²±¿, ­® ­¥ ¬®¦¥² ±² ²¼
¡®«¼¸¥ 2jV j ; 1, ¯®½²®¬³ «¾¡³¾ ¢¥°¸¨­³ v 2 V n fs; tg ¬®¦­® ¯®¤­¿²¼ ± ¬®¥ ¡®«¼¸¥¥ 2jV j; 1 ° §. ±¥£® ² ª¨µ ¢¥°¸¨­ jV j; 2, ¯®½²®¬³ ®¡¹¥¥ ·¨±«® ¯®¤º¥¬®¢ ­¥ ¯°¥¢®±µ®¤¨² (2jV j; 1)(jV j; 2j) < 2jV j2.
¥¬¬  27.22 (¶¥­ª  ·¨±«  ­ ±»¹ ¾¹¨µ ¯°®² «ª¨¢ ­¨©) °¨
¨±¯®«­¥­¨¨ ¯°®£° ¬¬» Generic-Preflow-Push ª®«¨·¥±²¢® ­ ±»¹ ¾¹¨µ ¯°®² «ª¨¢ ­¨© ­¥ ¯°¥¢®±µ®¤¨² 2jV jjE j.
®ª § ²¥«¼±²¢®
 ±±¬®²°¨¬ ­ ±»¹ ¾¹¨¥ ¯°®² «ª¨¢ ­¨¿ ¬¥¦¤³ ¢¥°¸¨­ ¬¨
u; v 2 V (¢ ®¡¥ ±²®°®­»). ±«¨ µ®²¿ ¡» ®¤­® ¯°®² «ª¨¢ ­¨¥ ¡»«®,
²® µ®²¿ ¡» ®¤­® ¨§ °¥¡¥° (u; v ) ¨«¨ (v; u) ¯°¨­ ¤«¥¦¨² E . ³±²¼
¨¬¥«® ¬¥±²® ­ ±»¹ ¾¹¥¥ ¯°®² «ª¨¢ ­¨¥ ¨§ u ¢ v . ®±«¥ ­¥£®
°¥¡°® (u; v ) ¨±·¥§«® ¨§ ®±² ²®·­®© ±¥²¨ Gf . «¿ ²®£®, ·²®¡» ½²®
°¥¡°® ¯®¿¢¨«®±¼, ­¥®¡µ®¤¨¬® ¯°®²®«ª­³²¼ ¯®²®ª ¨§ v ¢ u, ­® ½²®£®
­¥«¼§¿ ±¤¥« ²¼, ¯®ª  ­¥ ¡³¤¥² ¢»¯®«­¥­® h[v ] = h[u] + 1, ².¥. h[v ]
­¥®¡µ®¤¨¬® ³¢¥«¨·¨²¼ ¯® ª° ©­¥© ¬¥°¥ ­  2.
®±¬®²°¨¬ ­  §­ ·¥­¨¥ ±³¬¬» h[u] + h[v ] ¢ ¬®¬¥­²» ­ ±»¹ ¾¹¨x ¯°®² «ª¨¢ ­¨¿ ¬¥¦¤³ u ¨ v .  ¬¥²¨¬, ·²® ¯°®² «ª¨¢ ­¨¥ ¢®§¬®¦­®, ²®«¼ª® ¥±«¨ ¢»±®²» ¢¥°¸¨­ u ¨ v ®²«¨· ¾²±¿ ­  ¥¤¨­¨¶³.
®½²®¬³ ¯¥°¢ ¿ ±³¬¬  ­¥ ¬¥­¼¸¥ 1,   ¯®±«¥¤­¿¿ ±³¬¬  ­¥ ¡®«¼¸¥
(2jV j ; 1) + 2(jV j ; 2) = 4jV j ; 3. ¢¥ ±®±¥¤­¨¥ ±³¬¬» ®²«¨· ¾²±¿ ¯® ª° ©­¥© ¬¥°¥ ­  2.  ª¨¬ ®¡° §®¬, ¢±¥£® ¨¬¥¥²±¿ ­¥ ¡®«¥¥
((4jV j ; 3) ; 1)=2 + 1 = 2jV j ; 1 ­ ±»¹ ¾¹¨µ ¯°®² «ª¨¢ ­¨©. (»
¤®¡ ¢¨«¨ ¥¤¨­¨¶³, ·²®¡» ³·¥±²¼ ¨ ¯¥°¢®¥, ¨ ¯®±«¥¤­¥¥ ¯°®² «ª¨¢ ­¨¥.). «¥¤®¢ ²¥«¼­®, ®¡¹¥¥ ·¨±«® ­ ±»¹ ¾¹¨µ ¯°®² «ª¨¢ ­¨©
(¤«¿ ¢±¥µ °¥¡¥°) ­¥ ¯°¥¢®±µ®¤¨² (2jV j ; 1)jE j < 2jV jjE j.
¥¬¬  27.23 (¶¥­ª  ·¨±«  ­¥­ ±»¹ ¾¹¨µ ¯°®² «ª¨¢ ­¨©)
°¨ ¨±¯®«­¥­¨¨ ¯°®£° ¬¬» Generic-Preflow-Push ·¨±«® ­¥­ ±»¹ ¾¹¨µ ¯°®² «ª¨¢ ­¨© ­¥ ¯°¥¢®±µ®¤¨² 4jV j2 (jV j + jE j).
®ª § ²¥«¼±²¢®
 §®¢¥¬ ¯®²¥­¶¨ «®¬ ±³¬¬³ ¢»±®² ¯¥°¥¯®«­¥­­»µ ¢¥°¸¨­, ¨ ¡³¤¥¬ ±¬®²°¥²¼, ª ª ¬¥­¿¥²±¿ ¯®²¥­¶¨ « (®¡®§­ ·¨¬ ¥£® ) ¢ µ®¤¥
¨±¯®«­¥­¨¿ ¯°®£° ¬¬». §­ · «¼­®  = 0. ®¤º¥¬ ¯°®¨§¢®«¼­®©
¢¥°¸¨­» u ³¢¥«¨·¨¢ ¥²  ­¥ ¡®«¥¥, ·¥¬ ­  2jV j (¢»±®²  ¢¥°¸¨­»
­¥ ¯°¥¢®±µ®¤¨² 2jV j, «¥¬¬  27.20). H ±»¹ ¾¹¥¥ ¯°®² «ª¨¢ ­¨¥ ¨§

«£®°¨²¬ ¯°®² «ª¨¢ ­¨¿ ¯°¥¤¯®²®ª 

579

­¥ª®²®°®© ¢¥°¸¨­» u ¢ ­¥ª®²®°³¾ ¢¥°¸¨­³ v ¬®¦¥² ³¢¥«¨·¨²¼
¯®²¥­¶¨ « «¨¸¼ §  ±·¥² ¯®¿¢«¥­¨¿ ­®¢®© ¯¥°¥¯®«­¥­­®© ¢¥°¸¨­»
v (² ª ¡³¤¥², ¥±«¨ v | ­¥ ±²®ª ¨ ­¥ ¨±²®ª), ²® ¥±²¼ ­¥ ¡®«¥¥ ·¥¬
­  2jV j. H ª®­¥¶, ­¥­ ±»¹ ¾¹¥¥ ¯°®² «ª¨¢ ­¨¥ ¨§ u ¢ v ³¬¥­¼¸ ¥²  ¯® ª° ©­¥© ¬¥°¥ ­  ¥¤¨­¨¶³, ² ª ª ª ¢¥°¸¨­  u ¯¥°¥±² ¥²
¡»²¼ ¯¥°¥¯®«­¥­­®© ¨ ±« £ ¥¬®¥ h[u] ¨±·¥§ ¥²,   ¯®¿¢¨²¼±¿ ¬®¦¥²
«¨¸¼ ±« £ ¥¬®¥ h[v ] (¥±«¨ ¢¥°¸¨­  v ­¥ ±²®ª, ­¥ ¨±²®ª ¨ ­¥ ¡»« 
¯¥°¥¯®«­¥­­®©), ª®²®°®¥ ­  ¥¤¨­¨¶³ ¬¥­¼¸¥.
 ª¨¬ ®¡° §®¬, ®¡¹ ¿ ±³¬¬ , ­  ª®²®°³¾ ³¢¥«¨·¨¢ ¥²±¿ 
¢® ¢°¥¬¿ ° ¡®²» ¯°®£° ¬¬», ­¥ ¯°¥¢®±µ®¤¨² (2jV j)(2jV j2 ) +
(2jV j)(2jV jjE j) = 4jV j2(jV j + jE j) (¬» ¨±¯®«¼§³¥¬ ±«¥¤±²¢¨¥ 27.21
¨ «¥¬¬³ 27.22) H®  > 0, ¯®½²®¬³ ®¡¹ ¿ ±³¬¬ , ­  ª®²®°³¾
 ³¬¥­¼¸¨²±¿, ¨ ²¥¬ ± ¬»¬ ®¡¹¥¥ ª®«¨·¥±²¢® ­¥­ ±»¹ ¾¹¨µ
¯°®² «ª¨¢ ­¨©¾ ­¥ ¯°¥¢®±µ®¤¨² 4jV j2(jV j + jE j).
¥®°¥¬  27.24
¡¹¥¥ ·¨±«® ®¯¥° ¶¨© ¯®¤º¥¬  ¨ ¯°®² «ª¨¢ ­¨¿ ¯°¨ ¨±¯®«­¥­¨¨ ¯°®£° ¬¬» Generic-Preflow-Push ­  ±¥²¨ G = (V; E ) ° ¢­®
O(V 2E ).
®ª § ²¥«¼±²¢®
°¨¬¥­¿¥¬ ±«¥¤±²¢¨¥ 27.21 ¨ «¥¬¬» 27.22, 27.23.
«¥¤±²¢¨¥ 27.25
«£®°¨²¬, ®±­®¢ ­­»© ­  ¯°®² «ª¨¢ ­¨¨ ¯°¥¤¯®²®ª , ¬®¦­® °¥ «¨§®¢ ²¼ ² ª, ·²®¡» ­  ±¥²¨ G = (V; E ) ¢°¥¬¿ ¥£® ° ¡®²» ¡»«®
O(V 2E ).
®ª § ²¥«¼±²¢®
¥£ª® ¢¨¤¥²¼ (³¯°. 27.4-1), ·²® ¬®¦­® ¢»¯®«­¨²¼ ¯®¤º¥¬ §  ¢°¥¬¿ O(V ) ¨ ¯°®² «ª¨¢ ­¨¥ §  ¢°¥¬¿ O(1), ·²® ¨ ¤ ¥² ²°¥¡³¥¬³¾
®¶¥­ª³.
¯° ¦­¥­¨¿
27.4-1
 ª °¥ «¨§®¢ ²¼  «£®°¨²¬ ¯°®² «ª¨¢ ­¨¿ ¯°¥¤¯®²®ª  ² ª, ·²®¡» ­  ¯®¤º¥¬ ³µ®¤¨«® ¢°¥¬¿ O(V ), ¨ ­  ¯°®² «ª¨¢ ­¨¥ O(1)? (°¨
½²®¬ ®¡¹¥¥ ¢°¥¬¿ ¡³¤¥² O(V 2 E ).)
27.4-2
®ª ¦¨²¥, ·²®  «£®°¨²¬ ¯°®² «ª¨¢ ­¨¿ ¯°¥¤¯®²®ª , ­  ¢±¥
O(V 2) ¯®¤º¥¬®¢ ²° ²¨² O(V E ) ¢°¥¬¥­¨.
27.4-3
®¯³±²¨¬, ¬» ­ ¸«¨ ¬ ª±¨¬ «¼­»© ¯®²®ª ¢ ±¥²¨ G ¬¥²®¤®¬
¯°®² «ª¨¢ ­¨¿ ¯°¥¤¯®²®ª .  ª ²¥¯¥°¼ ¡»±²°® ­ ©²¨ ¬¨­¨¬ «¼­»© ° §°¥§?
27.4-4
 ª ­ ©²¨ ¬ ª±¨¬ «¼­®¥ ¯ °®±®·¥² ­¨¥ ¢ ¤¢³¤®«¼­®¬ £° ´¥, ¨±¯®«¼§³¿ ¬¥²®¤ ¯°®² «ª¨¢ ­¨¿ ¯°¥¤¯®²®ª ?  ª®¢® ¢°¥¬¿ ° ¡®²»
¢ ¸¥£®  «£®°¨²¬ ?
27.4-5
³±²¼ ¢±¥ ¯°®¯³±ª­»¥ ±¯®±®¡­®±²¨ °¥¡¥° ±¥²¨ G = (V; E ) | ¶¥-

580

« ¢  27  ª±¨¬ «¼­»© ¯®²®ª

«»¥ ·¨±«  ®² 1 ¤® k. ¶¥­¨²¥ ¢ ²¥°¬¨­ µ jV j, jE j ¨ k ¢°¥¬¿ ° ¡®²»  «£®°¨²¬  ¯°®² «ª¨¢ ­¨¿ ¯°¥¤¯®²®ª . (ª § ­¨¥: ±ª®«¼ª® ­¥­ ±»¹ ¾¹¨µ ¯°®² «ª¨¢ ­¨© ¬®¦­® ¯°¨¬¥­¨²¼ ª ­¥­ ±»¹¥­­®¬³
°¥¡°³, ¯°¥¦¤¥ ·¥¬ ®­® ±² ­¥² ­ ±»¹¥­­»¬?)
27.4-6
®ª ¦¨²¥, ·²® ±²°®ª³ 7 ¯°®¶¥¤³°» Initialize-Preflow ¬®¦­®
§ ¬¥­¨²¼ ±²°®ª®©
h[s] jV [G]j ; 2;
­¥ ­ °³¸ ¿ ª®°°¥ª²­®±²¨ ¨ ­¥ ¬¥­¿¿  ±¨¬¯²®²¨ª¨ ¢°¥¬¥­¨ ° ¡®²»
 «£®°¨²¬ .
27.4-7
¡®§­ ·¨¬ ·¥°¥§ f (u; v ) ° ±±²®¿­¨¥ (ª®«¨·¥±²¢® °¥¡¥°) ®² ¢¥°¸¨­» u ¤® ¢¥°¸¨­» v ¢ ®±² ²®·­®© ±¥²¨ Gf . ®ª ¦¨²¥, ·²® ¢®
¢°¥¬¿ ¢»¯®«­¥­¨¿ ¯°®£° ¬¬» Generic-Preflow-Push ®±² ¥²±¿
¢¥°­»¬¨ ±«¥¤³¾¹¨¥ ³²¢¥°¦¤¥­¨¿: ¥±«¨ h[u] < jV j, ²® h[u] 6 f (u; t);
¥±«¨ h[u] > V , ²® h[u] 6 f (u; s).
27.4-8*
 ª ¨ ¢ ¯°¥¤»¤³¹¥¬ ³¯° ¦­¥­¨¨, f (u; v ) ®¡®§­ · ¥² ° ±±²®¿­¨¥
®² ¢¥°¸¨­» u ¤® ¢¥°¸¨­» v ¢ ®±² ²®·­®© ±¥²¨ Gf .  ª ¨§¬¥­¨²¼
 «£®°¨²¬ ¯°®² «ª¨¢ ­¨¿ ¯°¥¤¯®²®ª , ·²®¡» ¢® ¢°¥¬¿ ¥£® ° ¡®²»
®±² ¢ «¨±¼ ¢¥°­»¬¨ ² ª¨¥ ³²¢¥°¦¤¥­¨¿: ¥±«¨ h[u] < jV j, ²® h[u] =
f (u; t); ¥±«¨ h[u] > V , ²® h[u] = f (u; s). (®¯®«­¨²¥«¼­»¥ ¤¥©±²¢¨¿
¤®«¦­» ³ª« ¤»¢ ²¼±¿ ¢ O(V E ) ®¯¥° ¶¨©.)
27.4-9
®ª ¦¨²¥, ·²® ·¨±«® ­¥­ ±»¹ ¾¹¨µ ¯°®² «ª¨¢ ­¨©, ¢»¯®«­¥­­»µ ¯°®£° ¬¬®© Generic-Preflow-Push ­  ±¥²¨ G = (V; E ), ­¥
¯°¥¢®±µ®¤¨² 4jV j2 jE j (¥±«¨ jV j > 4).

27.5. «£®°¨²¬ ¯®¤­¿²¼-¨-¢-­ · «®
®«¼§³¿±¼ ¬¥²®¤®¬ ¯°®² «ª¨¢ ­¨¿ ¯°¥¤¯®²®ª , ¬» ¯°¨¬¥­¿«¨
®¯¥° ¶¨¨ ¯®¤º¥¬  ¨ ¯°®² «ª¨¢ ­¨¿ ¢ ¡®«¥¥ ¨«¨ ¬¥­¥¥ ¯°®¨§¢®«¼­®¬ ¯®°¿¤ª¥. ®«¥¥ ¯°®¤³¬ ­­»© ¯®°¿¤®ª ¢»¯®«­¥­¨¿ ½²¨µ ®¯¥° ¶¨© ¯®§¢®«¿¥² ³¬¥­¼¸¨²¼ ¢°¥¬¿ ° ¡®²»  «£®°¨²¬ (¯® ±° ¢­¥­¨¾ ± ®¶¥­ª®© O(V 2 E ) ¨§ ±«¥¤±²¢¨¿ 27.25).  ½²®¬ ° §¤¥«¥ ¬»
° ±±¬®²°¨¬  «£®°¨²¬ À¯®¤­¿²¼-¨-¢-­ · «®Á (lift-to-front algorithm),
¨±¯®«¼§³¾¹¨© ½²³ ¨¤¥¾; ¢°¥¬¿ ¥£® ° ¡®²» ¥±²¼ O(V 3 ), ·²®  ±¨¬¯²®²¨·¥±ª¨ ¯® ª° ©­¥© ¬¥°¥ ­¥ µ³¦¥, ·¥¬ O(V 2 E ).
«£®°¨²¬ À¯®¤­¿²¼-¨-¢-­ · «®Á µ° ­¨² ¢±¥ ¢¥°¸¨­» ±¥²¨ ¢ ¢¨¤¥ ±¯¨±ª . «£®°¨²¬ ¯°®±¬ ²°¨¢ ¥² ½²®² ±¯¨±®ª, ­ ·¨­ ¿ ± £®«®¢». ¨ ­ µ®¤¨² ¢ ­¥¬ ¯¥°¥¯®«­¥­­³¾ ¢¥°¸¨­³ u.  ²¥¬  «£®°¨²¬
À®¡±«³¦¨¢ ¥²Á ½²³ ¢¥°¸¨­³, ¯°¨¬¥­¿¿ ª ­¥© ®¯¥° ¶¨¨ ¯®¤º¥¬  ¨
¯°®² «ª¨¢ ­¨¿ ¤® ²¥µ ¯®°, ¯®ª  ¨§¡»²®ª ­¥ ±² ­¥² ° ¢­»¬ ­³«¾.
±«¨ ¤«¿ ½²®£® ¢¥°¸¨­³ ¯°¨¸«®±¼ ¯®¤­¿²¼, ¥¥ ¯¥°¥¬¥¹ ¾² ¢ ­ -

«£®°¨²¬ ¯®¤­¿²¼-¨-¢-­ · «®

581

· «® ±¯¨±ª  (®²±¾¤  ¨ ­ §¢ ­¨¥  «£®°¨²¬ ), ¨ ¯°®±¬®²° ±¯¨±ª 
­ ·¨­ ¥²±¿ ¢­®¢¼.
°¨  ­ «¨§¥  «£®°¨²¬  ¯®«¼§³¥¬±¿ ¯®­¿²¨¥¬ ¤®¯³±²¨¬®£® °¥¡° 
| °¥¡°  ®±² ²®·­®© ±¥²¨, ¯® ª®²®°®¬³ ¢®§¬®¦­® ¯°®² «ª¨¢ ­¨¥.
­ · «  ¬» ¨§³·¨¬ ­¥ª®²®°»¥ ¨µ ±¢®©±²¢  ¨ ° ±±¬®²°¨¬ ¯°®¶¥±±
À®¡±«³¦¨¢ ­¨¿Á ¢¥°¸¨­».
®¯³±²¨¬»¥ °¥¡° 
³±²¼ f | ¯°¥¤¯®²®ª ¢ ±¥²¨ G = (V; E ),   h | ¢»±®²­ ¿ ´³­ª¶¨¿. H §®¢¥¬ °¥¡°® (u; v ) ¤®¯³±²¨¬»¬ (admissible), ¥±«¨ ®­® ¢µ®¤¨²
¢ ®±² ²®·­³¾ ±¥²¼ (cf (u; v ) > 0) ¨ h(u) = h(v ) + 1 ±² «¼­»¥ °¥¡° 
¬» ¡³¤¥¬ ­ §»¢ ²¼ ­¥¤®¯³±²¨¬»¬¨ (inadmissible). ¡®§­ ·¨¬ ·¥°¥§ Ef;h ¬­®¦¥±²¢® ¤®¯³±²¨¬»µ °¥¡¥°; ±¥²¼ Gf;h = (V; Ef;h) ­ §®¢¥¬ ±¥²¼¾ ¤®¯³±²¨¬»µ °¥¡¥° (admissible network). ­  ±®±²®¨²
¨§ °¥¡¥°, ¯® ª®²®°»¬ ¢®§¬®¦­® ¯°®² «ª¨¢ ­¨¥. ®±ª®«¼ª³ ¢¤®«¼
¤®¯³±²¨¬®£® °¥¡°  ¢»±®²  ³¬¥­¼¸ ¥²±¿, ¨¬¥¥² ¬¥±²® ² ª ¿ «¥¬¬ :
¥¬¬  27.26 (®¯³±²¨¬»¥ °¥¡°  ®¡° §³¾²  ¶¨ª«¨·¥±ª¨© £° ´)
³±²¼ f | ¯°¥¤¯®²®ª ¢ ±¥²¨ G = (V; E ); ¯³±²¼ h | ¢»±®²­ ¿
´³­ª¶¨¿. ®£¤  ±¥²¼ ¤®¯³±²¨¬»µ °¥¡¥° Gf;h = (V; Ef;h) ­¥ ±®¤¥°¦¨² ¶¨ª«®¢.
®±¬®²°¨¬, ª ª ¨§¬¥­¿¾² ±¥²¼ ¤®¯³±²¨¬»µ °¥¡¥° ®¯¥° ¶¨¨
¯®¤º¥¬  ¨ ¯°®² «ª¨¢ ­¨¿.
¥¬¬  27.27
³±²¼ f | ¯°¥¤¯®²®ª ¢ ±¥²¨ G = (V; E ) ¨ h | ¢»±®²­ ¿ ´³­ª¶¨¿.
³±²¼ (u; v ) | ¤®¯³±²¨¬®¥ °¥¡°® ¨ ¢¥°¸¨­  u ¯¥°¥¯®«­¥­ . ®£¤ 
¯® (u; v ) ¢®§¬®¦­® ¯°®² «ª¨¢ ­¨¥.  °¥§³«¼² ²¥ ¢»¯®«­¥­¨¿ ½²®©
®¯¥° ¶¨¨ ­®¢»¥ ¤®¯³±²¨¬»¥ °¥¡°  ­¥ ¯®¿¢«¿¾²±¿, ­® °¥¡°® (u; v )
¬®¦¥² ±² ²¼ ­¥¤®¯³±²¨¬»¬.
®ª § ²¥«¼±²¢®
 °¥§³«¼² ²¥ ¯°®² «ª¨¢ ­¨¿ ¢ ®±² ²®·­®© ±¥²¨ ¬®¦¥² ¯®¿¢¨²¼±¿
²®«¼ª® °¥¡°® (v; u). ®±ª®«¼ª³ °¥¡°® (u; v ) ¤®¯³±²¨¬®, ²® h(v ) =
h(u) ; 1, ¨ ¯®²®¬³ °¥¡°® (v; u) ­¥¤®¯³±²¨¬®. ±«¨ ¯°®² «ª¨¢ ­¨¥
®ª §»¢ ¥²±¿ ­ ±»¹ ¾¹¨¬, ²® ¢ °¥§³«¼² ²¥ cf (u; v ) = 0 ¨ °¥¡°®
(u; v ) ¨±·¥§ ¥² ¨§ ®±² ²®·­®© ±¥²¨ (¨ ±² ­®¢¨²±¿ ­¥¤®¯³±²¨¬»¬).
¥¬¬  27.28
³±²¼ f | ¯°¥¤¯®²®ª ¢ ±¥²¨ G = (V; E ) ¨ h | ¢»±®²­ ¿ ´³­ª¶¨¿. ±«¨ ¢¥°¸¨­  u ¯¥°¥¯®«­¥­  ¨ ¨§ ­¥¥ ­¥ ¢»µ®¤¨² ¤®¯³±²¨¬»µ
°¥¡¥°, ²® ¢®§¬®¦¥­ ¯®¤º¥¬ ¢¥°¸¨­» u. ®±«¥ ¯®¤º¥¬  ¯®¿¢¨²±¿ ¯®
ª° ©­¥© ¬¥°¥ ®¤­® ¤®¯³±²¨¬®¥ °¥¡°®, ¢»µ®¤¿¹¥¥ ¨§ ¢¥°¸¨­» u ¨
­¥ ¡³¤¥² °¥¡¥°, ¢µ®¤¿¹¨µ ¢ u.
®ª § ²¥«¼±²¢®
 ª ¬» ¢¨¤¥«¨ («¥¬¬  27.14), ¢ ¯¥°¥¯®«­¥­­®© ¢¥°¸¨­¥ u ¢®§¬®¦­® «¨¡® ¯°®² «ª¨¢ ­¨¥, «¨¡® ¯®¤º¥¬.  ª ª ª ¨§ u ¤®¯³±²¨¬»¥ °¥¡°  ­¥ ¢»µ®¤¿², ²® ¯°®² «ª¨¢ ­¨¥ ¢ ­¥© ­¥¢®§¬®¦­®, ¨ ¢®§¬®¦¥­ ¯®¤º¥¬. °¨ ½²®¬ ¢»±®²  ¢¥°¸¨­» ³¢¥«¨·¨¢ ¥²±¿ ² ª, ·²®
¯°®² «ª¨¢ ­¨¥ ±² ­®¢¨²±¿ ¢®§¬®¦­»¬, ²® ¥±²¼ ¯®¿¢«¿¥²±¿ ¤®¯³±²¨¬®¥ °¥¡°®.

582

« ¢  27  ª±¨¬ «¼­»© ¯®²®ª

°®¢¥°¨¬ ¢²®°®¥ ³²¢¥°¦¤¥­¨¥ «¥¬¬». °¥¤¯®«®¦¨¬, ·²® ¯®±«¥
¯®¤º¥¬  ¨¬¥¥²±¿ ¤®¯³±²¨¬®¥ °¥¡°® (v; u). ®£¤  h(v ) = h(u) + 1
|   ¤® ¯®¤º¥¬  ¡»«® ¢»¯®«­¥­® h(v ) > h(u) + 1. ® ®¯°¥¤¥«¥­¨¾
¢»±®²­®© ´³­ª¶¨¨ °¥¡°® (u; v ) ¤®«¦­® ¡»²¼ ­ ±»¹¥­­»¬ (¤® ¨
¯®±«¥ ¯®¤º¥¬  | ¯®¤º¥¬ ­¥ ¬¥­¿¥² ¯®²®ª®¢), ¨ ¯®²®¬³ ­¥ ¢µ®¤¨²
¢ ®±² ²®·­³¾ ±¥²¼ ¨ ­¥ ¿¢«¿¥²±¿ ¤®¯³±²¨¬»¬.
¯¨±ª¨ ±®±¥¤¥©
«£®°¨²¬ À¯®¤­¿²¼-¨-¢-­ · «®Á ¨±¯®«¼§³¥² ±¯¥¶¨ «¼­»© ±¯®±®¡
µ° ­¥­¨¿ °¥¡¥° ±¥²¨ G = (V; E ). ¬¥­­®, ¤«¿ ª ¦¤®© ¢¥°¸¨­»
u 2 V ¨¬¥¥²±¿ ®¤­®±²®°®­­¥ ±¢¿§¢­­»© ±¯¨±®ª ±®±¥¤¥© (neighbor
list) N [u]. ¥°¸¨­  v ´¨£³°¨°³¥² ¢ ½²®¬ ±¯¨±ª¥, ¥±«¨ (u; v ) 2 E
¨«¨ ¥±«¨ (v; u) 2 E .  ª¨¬ ®¡° §®¬, ±¯¨±®ª N [u] ±®¤¥°¦¨² ¢±¥ ¢¥°¸¨­» v , ¤«¿ ª®²®°»µ (u; v ) ¨¬¥¥² ¸ ­± ¯®¿¢¨²¼±¿ ¢ ®±² ²®·­®©
±¥²¨. ¥°¢»© ½«¥¬¥­² ½²®£® ±¯¨±ª  ®¡®§­ · ¥²±¿ head[N [u]]; ±«¥¤³¾¹¨© §  ¢¥°¸¨­®© v ±®±¥¤ | next ; neighbor[v ]. ±«¨ ¢¥°¸¨­  v
| ¯®±«¥¤­¿¿ ¢ ±¯¨±ª¥, ²® next ; neighbor[v ] =nil.
®°¿¤®ª ¢ ±¯¨±ª¥ ±®±¥¤¥© ¬®¦¥² ¡»²¼ ¯°®¨§¢®«¼­»¬; ®­ ­¥ ¬¥­¿¥²±¿ ¢ µ®¤¥ ° ¡®²» (¢±¿ª¨© ° §  «£®°¨²¬ ¯°®±¬ ²°¨¢ ¥² ±¯¨±®ª ±®±¥¤¥© ¢ ®¤­®¬ ¨ ²®¬ ¦¥ ¯®°¿¤ª¥). «¿ ª ¦¤®© ¢¥°¸¨­» u
µ° ­¨²±¿ ³ª § ²¥«¼ current[u] ­  ®·¥°¥¤­®© ½«¥¬¥­² ±¯¨±ª  N [u].
§­ · «¼­® current[u] ³±² ­®¢«¥­ ­  head[N [u]].
¡° ¡®²ª  ¯¥°¥¯®«­¥­­®© ¢¥°¸¨­»
¡° ¡®²ª  ¯¥°¥¯®«­¥­­®© ¢¥°¸¨­³ u ±®±²®¨² ¢ ²®¬, ·²® ¥¥ ° §°¿¦ ¾² (discharge), ¯°®² «ª¨¢ ¿ ¢¥±¼ ¨§¡»²®ª ¯®²®ª  ¢ ±®±¥¤­¨¥
¯® ¤®¯³±²¨¬»¬ °¥¡° ¬. ­®£¤  ¤«¿ ½²®£® ­¥®¡µ®¤¨¬® ±®§¤ ²¼ ­®¢»¥ ¤®¯³±²¨¬»¥ °¥¡° , ¯®¤­¿¢ ¢¥°¸¨­³ u.
\textsc{Discharge}($u$)
1 while $e[u]>0$
2 do $v\leftarrow current[u]$
3
if $v=$\textsc{nil}
4
then \textsc{Lift($u$)}
5
$current[u]\leftarrow head[N[u]]$
6
elseif $c_f(u,v)>0$ and $h[u]=h[v]+1$
7
then \textsc{Push($u,v$)}
8
else $current[u]\leftarrow next-neighbor[v]$

H  °¨±. 27.10 ¯®ª § ­» ­¥±ª®«¼ª® ¨²¥° ¶¨© ¶¨ª«  while (±²°®ª¨
1{8).
 ¦¤ ¿ ¨²¥° ¶¨¿ ¶¨ª«  while ¯°®¨§¢®¤¨² ®¤­® ¨§ ²°¥µ ¤¥©±²¢¨©:
1. ±«¨ ¬» ¤®¸«¨ ¤® ª®­¶  ±¯¨±ª  (v =nil), ²® ¬» ¯®¤­¨¬ ¥¬
¢¥°¸¨­³ u (±²°®ª  4) ¨ ¯¥°¥µ®¤¨¬ ª ­ · «³ ±¯¨±ª  N [u] (±²°®ª 
5). » ³¢¨¤¨¬ («¥¬¬  27.29), ·²® ¯®¤º¥¬ ¢®§¬®¦¥­.
2. ±«¨ ¬» ­¥ ¤®¸«¨ ¤® ª®­¶  ±¯¨±ª  ¨ °¥¡°® (u; v ) | ¤®¯³±²¨¬®¥
(¯°®¢¥°ª  ¢ ±²°®ª¥ 6), ²® ¯°®² «ª¨¢ ¥¬ ¯®²®ª ¨§ u ¢ v (±²°®ª  7).

«£®°¨²¬ ¯®¤­¿²¼-¨-¢-­ · «®

583

27.10  §°¿¤ª  ¢¥°¸¨­». °¥¡³¥²±¿ 15 ¯®¢²®°¥­¨© ¶¨ª«  while ¢
¯°®¶¥¤³°¥ Discharge, ·²®¡» ¯°®²®«ª­³²¼ ¢¥±¼ ¨§¡»²®ª ¨§ ¢¥°¸¨­» y . ®ª § ­» ²®«¼ª® ±®±¥¤¨ ¢¥°¸¨­» y ¨ °¥¡° , ±®¥¤¨­¿¾¹¨¥ ¨µ
± y . ­³²°¨ ª ¦¤®© ¢¥°¸¨­» ³ª § ­ ¨§¡»²®ª ¢ ­¥© ¯¥°¥¤ ±®®²¢¥²±²¢³¾¹¥© ¨²¥° ¶¨¥©; ±«¥¢  ³ª § ­  ¢»±®²  ¢¥°¸¨­». ¯° ¢  ¯®ª § ­ ±¯¨±®ª N [y ]; ¢»¤¥«¥­ ±®±¥¤ current[y ]. ( ) §­ · «¼­® ¨§¡»²®ª
¢ y ° ¢¥­ 19 ¨ current[y ] = s. § y ­¥ ¢»µ®¤¿² ¤®¯³±²¨¬»¥ °¥¡° ,
¯®½²®¬³ ¯¥°¢»¥ ²°¨ ¨²¥° ¶¨¨ ±¤¢¨£ ¾² ³ª § ²¥«¼ current[y ]. H 
·¥²¢¥°²®¬ ¸ £¥ ¬» ¤®¸«¨ ¤® ª®­¶  ±¯¨±ª . ®¤­¨¬ ¥¬ ¢¥°¸¨­³ y
¨ ¯¥°¥µ®¤¨¬ ª ­ · «³ ±¯¨±ª . (b) »±®²  ¢¥°¸¨­» y ±² «  ° ¢­®©
1. ¥¡°  (y; s) ¨ (y; x) | ­¥¤®¯³±²¨¬»¥ (¸ £¨ 5-6),   °¥¡°® (y; z )
| ¤®¯³±²¨¬®¥, ¨ ¬» ¯°®² «ª¨¢ ¥¬ 8 ¥¤¨­¨¶ ¢ z (¸ £ 7; § ¬¥²¨¬,
·²® ³ª § ²¥«¼ current[y ] ¬» ¯°¨ ½²®¬ ­¥ ±¤¢¨­³«¨). (c) °®² «ª¨¢ ­¨¥ ­  ¸ £¥ 7 ®ª § «®±¼ ­ ±»¹ ¾¹¨¬, ¨ ­  ¸ £¥ 8 °¥¡°® (y; z )
±² ­®¢¨²±¿ ­¥¤®¯³±²¨¬»¬. H  ¸ £¥ 9 ¬» ¤®¸«¨ ¤® ª®­¶  ±¯¨±ª  (current[y ] = nil), ¯®¤­¨¬ ¥¬ y , ¯¥°¥µ®¤¨¬ ª ­ · «³. (d) ¥¡°®
(y; s) ­¥¤®¯³±²¨¬® (¸ £ 10), ­® °¥¡°® (y; x) ¤®¯³±²¨¬® | ¯® ­¥¬³ ¬» ¯°®² «ª¨¢ ¥¬ 5 ¥¤¨­¨¶. (e) ®«¼¸¥ ¤®¯³±²¨¬»µ °¥¡¥° ­¥²
(¸ £¨ 12-13), ¯®½²®¬³ ¥¹¥ ° § ¯®¤­¨¬ ¥¬ y ¨ ¢®§¢° ¹ ¥¬±¿ ª ­ · «³ ±¯¨±ª  (¸ £ 14). (f) °®² «ª¨¢ ¥¬ 6 ¥¤¨­¨¶ ¢ s (¸ £ 15). (g)
§¡»²ª  ¢ ¢¥°¸¨­¥ y ¡®«¼¸¥ ­¥², ¨ ¯°®¶¥¤³°  § ¢¥°¸ ¥² ° ¡®²³.
 ¬¥²¨¬, ·²® ¢ ½²®¬ ¯°¨¬¥°¥ ¢ ­ · «¥ ¨ ¢ ª®­¶¥ ° ¡®²» ¯°®¶¥¤³°»
Discharge ³ª § ²¥«¼ current[y ] ³±² ­®¢«¥­ ­  ­ · «® ±¯¨±ª , ­® ¢
®¡¹¥¬ ±«³· ¥ ½²® ­¥ ² ª.
3. ±«¨ ¬» ­¥ ¤®¸«¨ ¤® ª®­¶  ±¯¨±ª , ­® °¥¡°® (u; v ) | ­¥¤®¯³±²¨¬®¥, ²® ±¤¢¨£ ¥¬ ³ª § ²¥«¼ current[u] ­  ®¤­³ ¯®§¨¶¨¾ ¢ ±¯¨±ª¥
(±²°®ª  8).
 ¬¥²¨¬, ·²® ¯°¨ ¢»§®¢¥ ¯°®¶¥¤³°» Discharge ³ª § ²¥«¼
current[u] ­ µ®¤¨²±¿ ¢ ¯®§¨¶¨¨, À³­ ±«¥¤®¢ ­­®©Á ®² ¯°¥¤»¤³¹¥£®
¢»§®¢ . ®±«¥¤­¨¬ ¤¥©±²¢¨¥¬ ½²®© ¯°®¶¥¤³°» ¬®¦¥² ¡»²¼ «¨¸¼
¯°®² «ª¨¢ ­¨¥: ¯°®¶¥¤³°  ®±² ­ ¢«¨¢ ¥²±¿, ¥±«¨ ¨§¡»²®ª e[u]
®¡° ¹ ¥²±¿ ¢ ­³«¼, ­® ­¨ ¯®¤º¥¬ ¢¥°¸¨­», ­¨ ±¤¢¨£ ³ª § ²¥«¿ ­¥
¬¥­¿¾² ½²³ ¢¥«¨·¨­³.
 ¤® ¯°®¢¥°¨²¼, ·²® ¯°®¶¥¤³°  Discharge ¢»¯®«­¿¥² ¯®¤º¥¬ ¨
¯°®² «ª¨¢ ­¨¥ ²®£¤ , ª®£¤  ½²® ¤¥©±²¢¨²¥«¼­® ¬®¦­® ±¤¥« ²¼ ¯®
­ ¸¨¬ ¯° ¢¨« ¬.
¥¬¬  27.29
°¨ ¢»§®¢¥ ®¯¥° ¶¨¨ Push(u; v ) ¢ ¯°®¶¥¤³°¥ Discharge (±²°®ª 
7) ¯® °¥¡°³ (u; v ) ¢®§¬®¦­® ¯°®² «ª¨¢ ­¨¥. °¨ ¢»§®¢¥ ®¯¥° ¶¨¨
Lift(u) ¢ ¯°®¶¥¤³°¥ Discharge (±²°®ª  4) ¢®§¬®¦¥­ ¯®¤º¥¬ ¢¥°¸¨­» u.
®ª § ²¥«¼±²¢®
®§¬®¦­®±²¼ ¯°®² «ª¨¢ ­¨¿ £ ° ­²¨°³¥²±¿ ¯°®¢¥°ª ¬¨ ¢ ±²°®ª µ 1 ¨ 6, ² ª ·²® ¯¥°¢®¥ ³²¢¥°¦¤¥­¨¥ ®·¥¢¨¤­®.

584

« ¢  27  ª±¨¬ «¼­»© ¯®²®ª

®ª ¦¥¬ ¢²®°®¥ ³²¢¥°¦¤¥­¨¥. «¿ ½²®£® (¯® «¥¬¬¥ 27.28) ¤®±² ²®·­® ¤®ª § ²¼, ·²® ¢±¥ ¢»µ®¤¿¹¨¥ ¨§ u °¥¡°  ­¥¤®¯³±²¨¬».  ¬¥²¨¬, ·²® ¯°¨ ¢»§®¢ µ ¯°®¶¥¤³°» Discharge ³ª § ²¥«¼ current[u]
¯¥°¥¬¥¹ ¥²±¿ ¯® ±¯¨±ª³ N [u] ®² ¥£® ­ · «  head[N [u]] ¤® ª®­¶ .
 ª®­¶¥ ¢¥°¸¨­³ u ¯®¤­¨¬ ¾² ¨ ­ ·¨­ ¥²±¿ ­®¢»© ¯°®µ®¤.  ¦¤»© ° §, ¯°¥¦¤¥ ·¥¬ ±¤¢¨­³²¼ ³ª § ²¥«¼ ± ¯°®¨§¢®«¼­®© ¯®§¨¶¨¨
v ¬» ³¡¥¦¤ ¥¬±¿ (±²°®ª  6), ·²® °¥¡°® (u; v ) ­¥¤®¯³±²¨¬®.  ª¨¬
®¡° §®¬, ¢ ª®­¶¥ ¯°®µ®¤  ¢±¥ ¢»µ®¤¿¹¨¥ ¨§ u °¥¡°  ¡»«¨ ¯°®±¬®²°¥­» ¨ ®ª § «¨±¼ ­¥¤®¯³±²¨¬»¬¨. ®£«¨ «¨ ®­¨ § ²¥¬ ±² ²¼ ¤®¯³±²¨¬»¬¨ (¤® ª®­¶  ¯°®µ®¤ )? ® «¥¬¬¥ 27.27, ¯°®² «ª¨¢ ­¨¿
¢®®¡¹¥ ­¥ ±®§¤ ¾² ¤®¯³±²¨¬»µ °¥¡¥°. µ ¬®£³² ¯®°®¤¨²¼ ²®«¼ª®
®¯¥° ¶¨¨ ¯®¤º¥¬ . ® ¢¥°¸¨­  u ­¥ ¯®¤­¨¬ « ±¼ (¢ ²¥·¥­¨¥ ¯°®µ®¤  ¯® ±¯¨±ª³),   ¯®¤º¥¬» ¤°³£¨µ ¢¥°¸¨­ ±®§¤ ¾² «¨¸¼ ¢»µ®¤¿¹¨¥
¨§ ­¨µ ¤®¯³±²¨¬»¥ °¥¡° . ®½²®¬³ ¢ ª®­¶¥ ¯°®µ®¤  ¢±¥ ¢»µ®¤¿¹¨¥
¨§ ¢¥°¸¨­» u °¥¡°  ­¥¤®¯³±²¨¬», ¯®½²®¬³ ¥¥ ¬®¦­® ¯®¤­¿²¼.
«£®°¨²¬ À¯®¤­¿²¼-¨-¢-­ · «®Á
«£®°¨²¬ À¯®¤­¿²¼-¨-¢-­ · «®Á µ° ­¨² ¬­®¦¥±²¢® V n fs; tg ¢¥°¸¨­ (®²«¨·­»µ ®² ¨±²®ª  ¨ ±²®ª ) ¢ ¢¨¤¥ ±¯¨±ª . °¨ ½²®¬ ±³¹¥±²¢¥­­® ²®, ·²® ±¯¨±®ª ½²®² ®ª §»¢ ¥²±¿ Àª®°°¥ª²­® ³¯®°¿¤®·¥­­»¬Á ¢ ±«¥¤³¾¹¥¬ ±¬»±«¥: ª®­¥¶ «¾¡®£® ¤®¯³±²¨¬®£® °¥¡°  ­ µ®¤¨²±¿ ¤ «¼¸¥ ¢ ±¯¨±ª¥, ·¥¬ ­ · «® ½²®£® °¥¡°  (­ ¯®¬­¨¬, ·²®
¤®¯³±²¨¬»¥ °¥¡°  ®¡° §³¾²  ¶¨ª«¨·¥±ª¨© £° ´, «¥¬¬  27.26). ( ¤ ·³ ® ¯®¨±ª¥ ª®°°¥ª²°®£® ³¯®°¿¤®·¥­¨¿ ¤«¿ ¯°®¨§¢®«¼­®£®  ¶¨ª«¨·¥±ª®£® £° ´  ¬» ­ §»¢ «¨ § ¤ ·¥© ²®¯®«®£¨·¥±ª®© ±®°²¨°®¢ª¨, ±¬. ° §¤¥« 23.4.)
«¥¤³¾¹³¾ ¢ ½²®¬ ±¯¨±ª¥ §  u ¢¥°¸¨­³ ®¡®§­ ·¨¬ next[u]; ¥±«¨
¢¥°¸¨­  u | ¯®±«¥¤­¿¿ ¢ ±¯¨±ª¥, ²® next[u] =nil.
\textsc{Lift-To-Front}($G,s,t$)
1 \textsc{Initialize-Preflow}($G,s$)
2 $L\leftarrow V[G]-\{s,t\}$ (¢ «¾¡®¬ ¯®°¿¤ª¥)
3 for (¤«¿) ª ¦¤®© ¢¥°¸¨­» $u\in V[G]\setminus \{s,t\}$
4
do $current[u]\leftarrow head[N[u]]$
5 $u\leftarrow head[L]$
6 while $u\ne$\textsc{nil}
7
do $old-height\leftarrow h[u]$
8
\textsc{Discharge}($u$)
9
if $h[u]>old-height$
10
then ¯¥°¥¬¥±²¨²¼ $u$ ¢ ­ · «® ±¯¨±ª  $L$
11
$u\leftarrow next[u]$

«£®°¨²¬ ´®°¬¨°³¥² ­ · «¼­»© ¯°¥¤¯®²®ª (±²°®ª  1), ±¯¨±®ª L
(±²°®ª  2) (²®·­® ² ª ¦¥, ª ª ½²® ¤¥« «®±¼ ° ­¼¸¥).  ²¥¬ (±²°®ª¨
3{4) ®­ ³±² ­ ¢«¨¢ ¥² ³ª § ²¥«¨ current[u] ¢ ­ · «® ±¯¨±ª  ±®±¥¤¥©
ª ¦¤®© ¢¥°¸¨­» u (±·¨² ¥¬, ·²® ¤«¿ ¢±¥µ ¢¥°¸¨­ u ±¯¨±ª¨ ±®±¥¤¥©
N [u] ³¦¥ ±®§¤ ­».)
 ¡®²  ¶¨ª«  (±²°®ª¨ 6{11, ±¬. ² ª¦¥ °¨±. 27.11) ¯°®¨±µ®¤¨²

«£®°¨²¬ ¯®¤­¿²¼-¨-¢-­ · «®

585

² ª: ¬» ¯°®±¬ ²°¨¢ ¥¬ ¢±¥ ½«¥¬¥­²» ±¯¨±ª  L, ­ ·¨­ ¿ ± ­ · « 
(±²°®ª  5). ±¿ª¨© ° § ¬» ° §°¿¦ ¥¬ ²¥ª³¹³¾ ¢¥°¸¨­³ u (±²°®ª 
8). ±«¨ ¯°¨ ½²®¬ ¢»±®²  ¢¥°¸¨­» u ³¢¥«¨·¨« ±¼ (·²® ®¯°¥¤¥«¿¥²±¿ ±° ¢­¥­¨¥¬ ± ±®µ° ­¥­­»¬ ¢ ±²°®ª¥ 7 ¯°¥¦­¨¬ §­ ·¥­¨¥¬),
²® ¬» ¯¥°¥¬¥¹ ¥¬ ¥¥ ¢ ­ · «® ±¯¨±ª  (±²°®ª  10). ®±«¥ ½²®£® ¬»
¯¥°¥µ®¤¨¬ ª ±«¥¤³¾¹¥¬³ ½«¥¬¥­²³ ±¯¨±ª  L.  ¬¥²¨¬, ·²® ¥±«¨
¬» ¯¥°¥¬¥±²¨«¨ u ¢ ­ · «® ±¯¨±ª , ²® ®·¥°¥¤­»¬ ¡³¤¥² ½«¥¬¥­²,
±«¥¤³¾¹¨© §  u ¢ ¥¥ ­®¢®© ¯®§¨¶¨¨.
®ª ¦¥¬, ·²®  «£®°¨²¬ Lift-To-Front ­ µ®¤¨² ¬ ª±¨¬ «¼­»©
¯®²®ª. «¿ ½²®£® ³¡¥¤¨¬±¿, ·²® ¥£® ¬®¦­® ° ±±¬ ²°¨¢ ²¼ ª ª °¥ «¨§ ¶¨¾ ®¡¹¥© ±µ¥¬» ¯°®² «ª¨¢ ­¨¿ ¯°¥¤¯®²®ª . ­ · «  § ¬¥²¨¬, ·²® ¯°®£° ¬¬  ¯°¨¬¥­¿¥² ¯®¤º¥¬» ¨ ¯°®² «ª¨¢ ­¨¿ ²®«¼ª®
² ¬, £¤¥ ®­¨ ¢®§¬®¦­» (±®£« ±­® «¥¬¬¥ 29.29). ±² «®±¼ ¤®ª § ²¼,
·²® ¯®±«¥ § ¢¥°¸¥­¨¿  «£®°¨²¬  ­¨ª ª¨¥ ¯®¤º¥¬» ¨«¨ ¯°®² «ª¨¢ ­¨¿ ­¥¢®§¬®¦­». ®±² ­ ¢«¨¢ ¥²±¿, ¢®§¬®¦­»µ ¯®¤º¥¬®¢ ¨ ¯°®² «ª¨¢ ­¨© ­¥².
®£¤  ¬» ¢ ¯®±«¥¤­¨© ° § ¢ ¯°®£° ¬¬¥ ¯°®±¬®²°¥«¨ ±¯¨±®ª L,
¬» ° §°¿¤¨«¨ ª ¦¤³¾ ¢¥°¸¨­³ u, ­¥ ¯®¤­¿¢ ¥¥.  ª ¬» ¢±ª®°¥ ³¢¨¤¨¬ («¥¬¬  27.30), ±¯¨±®ª L ¢® ¢°¥¬¿ ¢»¯®«­¥­¨¿ ¯°®£° ¬¬» ®±² ¥²±¿ ª®°°¥ª²­® ³¯®°¿¤®·¥­­»¬, ²® ¥±²¼ ª®­¥¶ «¾¡®£® ¤®¯³±²¨¬®£® °¥¡°  ¨¤¥² ¯®±«¥ ¥£® ­ · « . ®½²®¬³ ¯°®¶¥¤³° 
Discharge(u), ¯°®² «ª¨¢ ¿ ¯®²®ª ¯® ¤®¯³±²¨¬»¬ °¥¡° ¬, ±®§¤ ¥²
¨§¡»²®ª ¢ ¢¥°¸¨­ µ, ¨¤³¹¨µ ¢ ±¯¨±ª¥ ¯®±«¥ u, ¨ ­¥ ²°®£ ¥² ¢¥°¸¨­», ¯°¥¤¸¥±²¢³¾¹¨¥ u, ¢ ª®²®°»µ ¨§¡»²®ª ®±² ¥²±¿ ° ¢­»¬ ­³«¾.
 ª¨¬ ®¡° §®¬, ¯® § ¢¥°¸¨­¨¾ ° ¡®²» ¨§¡»²®ª ¢ ª ¦¤®© ¢¥°¸¨­¥
° ¢¥­ ­³«¾ (¨ ­¨ ¯°®² «ª¨¢ ­¨¥, ­¨ ¯®¤º¥¬ ­¥¢®§¬®¦­»).
¥¬¬  27.30
°¨ ¨±¯®«­¥­¨¨  «£®°¨²¬  Lift-To-Front ±¯¨±®ª L ®±² ¥²±¿
ª®°°¥ª²­® ³¯®°¿¤®·¥­­»¬ ®²­®±¨²¥«¼­® (²¥ª³¹¥£®) £° ´  ¤®¯³±²¨¬»µ °¥¡¥° Gf;h = (V; Ef;h ¯®±«¥ «¾¡®£® ·¨±«  ¨²¥° ¶¨© ¶¨ª« 
¢ ±²°®ª µ 6{11.
®ª § ²¥«¼±²¢®
¥°¥¤ ¯¥°¢»¬ ¢»¯®«­¥­¨¥¬ ¶¨ª«  ¤®¯³±²¨¬»µ °¥¡¥° ­¥², ² ª
ª ª ¢»±®²  ¨±²®ª  h[s] ° ¢­  jV j > 2 (¬­®¦¥±²¢® V ±®¤¥°¦¨² ¯®
ª° ©­¥© ¬¥°¥ ¨±²®ª s ¨ ±²®ª t),   ¢»±®²  ®±² «¼­»µ ¢¥°¸¨­  ° ¢­ 
0 (¨ ¥¤¨­¨·­®£® ¯¥°¥¯ ¤  ¢»±®² ¡»²¼ ­¥ ¬®¦¥²).
®ª ¦¥¬, ·²® ±¢®©±²¢® ²®¯®«®£¨·¥±ª®© ³¯®°¿¤®·¥­­®±²¨ ±®µ° ­¿¥²±¿ ¯®±«¥ ª ¦¤®£® ¢»¯®«­¥­¨¿ ²¥«  ¶¨ª« . ¥²¼ ¤®¯³±²¨¬»µ
°¥¡¥° ¬¥­¿¾² ²®«¼ª® ¯®¤º¥¬» ¨ ¯°®² «ª¨¢ ­¨¿. ® «¥¬¬¥ 27.27,
¯°®² «ª¨¢ ­¨¿ ­¥ ±®§¤ ¾² ¤®¯³±²¨¬»µ °¥¡¥°. ®±«¥ ¯®¤º¥¬  ¯°®¨§¢®«¼­®© ¢¥°¸¨­» u ¢±¥ °¥¡° , ¢µ®¤¿¹¨¥ ¢ ½²³ ¢¥°¸¨­³ | ­¥¤®¯³±²¨¬»¥ («¥¬¬  27.28). ®½²®¬³ ¯®±«¥ ¯¥°¥¬¥¹¥­¨¿ u ¢ ­ · «®
±¯¨±ª  ¯®°¿¤®ª ½«¥¬¥­²®¢ ¢ ±¯¨±ª¥ ±² ­®¢¨²±¿ ª®°°¥ª²­»¬.
­ «¨§  «£®°¨²¬ 
®ª ¦¥¬, ·²® ¢°¥¬¿ ° ¡®²»  «£®°¨²¬  À¯®¤­¿²¼-¨-¢-­ · «®Á ­ 
±¥²¨ G = (V; E ) ° ¢­® O(V 3 ). ­ · «  ­ ¯®¬­¨¬ ­¥ª®²®°»¥ ³¦¥

586

« ¢  27  ª±¨¬ «¼­»© ¯®²®ª

27.11  ¡®²   «£®°¨²¬  Lift-To-Front. ( ) H · «¼­»© ¯®²®ª ¯¥°¥¤ ¯¥°¢»¬ ¢»¯®«­¥­¨¥¬ ¶¨ª« . § ¨±²®ª  s ¢»µ®¤¨² 26 ¥¤¨­¨¶.
¯° ¢  ¨§®¡° ¦¥­ ±¯¨±®ª L (±¥°»¬ ¯®ª § ­® ²¥ª³¹¥¥ §­ ·¥­¨¥ u).
®¤ ª ¦¤®© ¢¥°¸¨­®© ¢»¯¨± ­ ±¯¨±®ª ¥¥ ±®±¥¤¥© (±¥°»¬ ¢»¤¥«¥­
±®±¥¤ current[u]). ­ · «  ¬» ° §°¿¦ ¥¬ ¢¥°¸¨­³ x. ­  ¯®¤­¨¬ ¥²±¿ ­  ¢»±®²³ 1. § 12 ¥¤¨­¨¶ ¨§¡»²ª  ®²¯° ¢«¿¥¬ 5 ¢ ¢¥°¸¨­³
y,   § ²¥¬ ®±² ¢¸¨¥±¿ 7 ¢ ±²®ª t. »±®²  ¢¥°¸¨­» x ³¢¥«¨·¨« ±¼,
² ª ·²® x ¯®¬¥¹ ¥¬ ¢ ­ · «® ±¯¨±ª  L (¢¯°®·¥¬, ®­  ² ¬ ¨ ¡»« ).
(b)   ±«¥¤³¾¹¥¬ ¸ £¥ ° §°¿¦ ¥¬ ¢¥°¸¨­³ y , ±«¥¤³¾¹³¾ §  x.
(H  °¨±. 27.10 ½²®² ¯°®¶¥±± ¯®ª § ­ ¯®¤°®¡­®.) »±®²  ¢¥°¸¨­»
y ³¢¥«¨·¨« ±¼, ¨ ¬» ¯¥°¥¬¥¹ ¥¬ ¥¥ ¢ ­ · «® ±¯¨±ª  L. (c) ¥¯¥°¼
¢ ±¯¨±ª¥ §  y ±«¥¤³¥² x ¨ ¬» ° §°¿¦ ¥¬ ¢¥°¸¨­³ x, ¯°®²®«ª­³¢ 5
¥¤¨­¨¶ ¯®²®ª  ¢ ±²®ª t. ®¤º¥¬  ­¥ ¯°®¨±µ®¤¨², ² ª ·²® ±¯¨±®ª
L ­¥ ¬¥­¿¥²±¿. (d) «¥¤³¾¹³¾ §  x ¢ ±¯¨±ª¥ ¢¥°¸¨­³ z ¬» ° §°¿¦ ¥¬, ¯®¤­¨¬ ¿ ¥¥ ¤® ¢»±®²» 1 ¨ ¯°®² «ª¨¢ ¿ 8 ¥¤¨­¨¶ ¢ ±²®ª
t. ®±ª®«¼ª³ ¢¥°¸¨­  ¯®¤­¿² , ®­  ¯¥°¥¬¥¹ ¥²±¿ ¢ ­ · «® ±¯¨±ª 
L. (e) ¥°¥¯®«­¥­­»µ ¢¥°¸¨­ ¡®«¼¸¥ ­¥², ¯®½²®¬³ ¯°®¶¥¤³°  Discharge, ¯®±«¥¤®¢ ²¥«¼­® ¯°¨¬¥­¥­­ ¿ ª ¢¥°¸¨­ ¬ y ¨ x, ­¨·¥£®
­¥ ¬¥­¿¥². °®£° ¬¬  Lift-to-front ¤®±²¨£ ¥² ª®­¶  ±¯¨±ª  L ¨
®±² ­ ¢«¨¢ ¥²±¿.  ª±¨¬ «¼­»© ¯®²®ª ­ ©¤¥­.
¨§¢¥±²­»¥ ­ ¬ ´ ª²». ²®²  «£®°¨²¬ ¿¢«¿¥²±¿ °¥ «¨§ ¶¨¥© ¬¥²®¤  ¯°®² «ª¨¢ ­¨¿ ¯°¥¤¯®²®ª , ¯®½²®¬³ ¤¥©±²¢³¥² ¢¥°µ­¿¿ ®¶¥­ª 
O(V ) ­  ·¨±«® ¯®¤º¥¬®¢ ª ¦¤®© ¢¥°¸¨­» (c«¥¤±²¢¨¥ 27.21),   ®¡¹¥¥ ·¨±«® ¯®¤º¥¬®¢ ¥±²¼ O(V 2 ).  ±®®²¢¥²±²¢¨¨ ± ³¯°. 27.4-2, ­ 
¢±¥ ¯®¤º¥¬» ³µ®¤¨² ¢°¥¬¿ O(V E ). ¡¹¥¥ ·¨±«® ­ ±»¹ ¾¹¨µ ¯°®² «ª¨¢ ­¨© ¥±²¼ O(V E ) («¥¬¬  27.22).
¥®°¥¬  27.31
°¥¬¿ ° ¡®²» ¯°®£° ¬¬» Lift-To-Front ­  ±¥²¨ G = (V; E )
° ¢­® O(V 3 ).
®ª § ²¥«¼±²¢®
 §®¡¼¥¬ ¢°¥¬¿ ° ¡®²» ¯°®£° ¬¬» Lift-To-Front ­  ¯¥°¨®¤» ¬¥¦¤³ ¤¢³¬¿ ¯®¤º¥¬ ¬¨. ®£¤  ¢±¥£® ¯¥°¨®¤®¢ ¡³¤¥² (ª ª ¨
¯®¤º¥¬®¢) O(V 2). ®ª ¦¥¬, ·²® §  ª ¦¤»© ¯¥°¨®¤ ¬» ¢»§»¢ ¥¬
¯°®¶¥¤³°³ Discharge O(V ) ° §. ¥©±²¢¨²¥«¼­®, §  ®¤¨­ ¯¥°¨®¤
·¨±«® ¢»§®¢®¢ ¯°®¶¥¤³°» Discharge (¯®±ª®«¼ª³ ¢­³²°¨ ¯¥°¨®¤ 
¬» ­¥ ¯®¤­¨¬ ¥¬ ¢¥°¸¨­³, ±¯¨±®ª ®±² ¥²±¿ ­¥¨§¬¥­­»¬) ­¥ ¯°¥¢®±µ®¤¨² ¤«¨­» ±¯¨±ª , ¨ ²¥¬ ± ¬»¬ jV j.
«¥¤®¢ ²¥«¼­®, ¯°®¶¥¤³°  Discharge ¢»§»¢ ¥²±¿ O(V 3 ) ° §
(±²°®ª  8), ¨ ¢°¥¬¿ ° ¡®²» ¯°®£° ¬¬» Lift-To-Front ° ¢­®
O(V 3) ¯«¾± ±³¬¬ °­®¥ ¢°¥¬¿, ³µ®¤¿¹¥¥ ­  ¢»¯®«­¥­¨¥ ¢»§®¢®¢
Discharge. ¶¥­¨¬ ¢²®°®¥ ±« £ ¥¬®¥.
°¨ ª ¦¤®¬ ¯®¢²®°¥­¨¨ ¶¨ª«  ¢ ¯°®¶¥¤³°¥ Discharge ±®¢¥°¸ ¥²±¿ °®¢­® ®¤­® ¨§ ²°¥µ ¤¥©±²¢¨©: ¯®¤º¥¬ ¢¥°¸¨­», ¯¥°¥¬¥¹¥­¨¥
³ª § ²¥«¿ ¨ ¯°®² «ª¨¢ ­¨¥ ¯°¥¤¯®²®ª . ¶¥­¨¬ ª®«¨·¥±²¢® ®¯¥-

«£®°¨²¬ ¯®¤­¿²¼-¨-¢-­ · «®

587

° ¶¨© ª ¦¤®£® ¨§ ½²¨µ ²¨¯®¢.
H ·­¥¬ ± ¯®¤º¥¬®¢ (±²°®ª¨ 4{5). H  ¢±¥ O(V 2 ) ¯®¤º¥¬®¢ ²°¥¡³¥²±¿ ¢°¥¬¿ O(V E ) (³¯°. 27.4-2).
¶¥­¨¬ ª®«¨·¥±²¢® ¯¥°¥¬¥¹¥­¨© ³ª § ²¥«¿ current[u] (±²°®ª 
8). ¡®§­ ·¨¬ ·¥°¥§ degree(u) ±²¥¯¥­¼ ¢¥°¸¨­» u.   ª ¦¤»©
¯®¤º¥¬ ¢¥°¸¨­» u ¯°¨µ®¤¿²±¿ O(degree(u)) ¯¥°¥¬¥¹¥­¨© ³ª § ²¥«¿, ¯®½²®¬³ ¢±¥£® ¯°®¨§¢®¤¨²±¿ O(V  degree(u)) ¯¥°¥¬¥¹¥­¨©
¤«¿ ª ¦¤®© ¢¥°¸¨­».  ª¨¬ ®¡° §®¬, ®¡¹¥¥ ·¨±«® ¯¥°¥¬¥¹¥­¨©
³ª § ²¥«¥© ° ¢­® O(V E ) (¯® «¥¬¬¥ ® °³ª®¯®¦ ²¨¿µ, ³¯°. 5.4-1).
¶¥­¨¬ ·¨±«® ¯°®² «ª¨¢ ­¨© (±²°®ª  7). » ³¦¥ §­ ¥¬, ·²® ª®«¨·¥±²¢® ­ ±»¹ ¾¹¨µ ¯°®² «ª¨¢ ­¨© ° ¢­® O(V E ).  ¬¥²¨¬, ·²®
±° §³ ¯®±«¥ ¢»¯®«­¥­¨¿ ­¥­ ±»¹ ¾¹¥£® ¯°®² «ª¨¢ ­¨¿ ¯°®¶¥¤³° 
Discharge ¯°¥ª° ¹ ¥² ° ¡®²³, ² ª ª ª ¨§¡»²®ª ¯®²®ª  ®¡° ¹ ¥²±¿ ¢ ­®«¼.  ª¨¬ ®¡° §®¬, ¯°¨ ª ¦¤®¬ ¢»§®¢¥ ¯°®¶¥¤³°» ¢»¯®«­¿¥²±¿ ­¥ ¡®«¥¥ ®¤­®£® ­¥­ ±»¹ ¾¹¥£® ¯°®² «ª¨¢ ­¨¿; ¢±¥£®
¢»§®¢®¢ O(V 3 ), ¯®½²®¬³ ­¥­ ±»¹ ¾¹¨µ ¯°®² «ª¨¢ ­¨© ­¥ ¡®«¥¥
O(V 3).
 ª¨¬ ®¡° §®¬, ¢°¥¬¿ ° ¡®²» ¯°®£° ¬¬» Lift-To-Front ¥±²¼
O(V 3 + V E ) = O(V 3 ).
¯° ¦­¥­¨¿
27.5-1
«¥¤³¿ ®¡° §¶³ °¨±. 27.11, ¯®ª ¦¨²¥ ° ¡®²³ ¯°®£° ¬¬» LiftTo-Front ­  ±¥²¨ °¨±.27.1 (a). ·¨² ²¼, ·²® ¨§­ · «¼­® ±¯¨±®ª L
¨¬¥¥² ¢¨¤ hv1; v2; v3; v4i,   ±¯¨±ª¨ ±®±¥¤¥© ² ª®¢»:
N [v1] = hs; v2; v3i
N [v2] = hs; v1; v3; v4i
N [v3] = hv1; v2; v4; ti
N [v4] = hv2; v3; ti:
27.5-2*
 ±±¬®²°¨¬ °¥ «¨§ ¶¨¾  «£®°¨²¬  ¯°®² «ª¨¢ ­¨¿ ¯°¥¤¯®²®ª ,
¯°¨ ª®²®°®© ¢±¥ ¯¥°¥¯®«­¥­­»¥ ¢¥°¸¨­» µ° ­¿²±¿ ¢ ¢¨¤¥ ®·¥°¥¤¨.
«£®°¨²¬ ° §°¿¦ ¥² ¯¥°¢³¾ ¢¥°¸¨­³ ¨§ ®·¥°¥¤¨ ¨ ³¤ «¿¥² ¥¥,  
¥±«¨ ¢ °¥§³«¼² ²¥ ½²®£® ¯®¿¢¨«¨±¼ ­®¢»¥ ¯¥°¥¯®«­¥­­»¥ ¢¥°¸¨­»,
®­¨ ¤®¡ ¢«¿¾²±¿ ¢ ª®­¥¶ ®·¥°¥¤¨. «£®°¨²¬ ®±² ­ ¢«¨¢ ¥²±¿, ª®£¤  ®·¥°¥¤¼ ¯³±² . ®ª ¦¨²¥, ·²® ¢°¥¬¿ ° ¡®²» ½²®£®  «£®°¨²¬ 
° ¢­® O(V 3 ).
27.5-3
 ¬¥­¨¬ ¢ ¯°®¶¥¤³°¥ Lift ±²°®ª³ 3 ±²°®ª®©: h[u] h[u] + 1. ®ª ¦¨²¥, ·²® ®¡¹¨©  «£®°¨²¬ ¯°®² «ª¨¢ ­¨¿ ¯°¥¤¯®²®ª  ®±² ­¥²±¿ ª®°°¥ª²­»¬.  ª ½²® ¨§¬¥­¥­¨¥ ±ª ¦¥²±¿ ­  ° ¡®²¥ ¯°®£° ¬¬»
Lift-To-Front?
27.5-4*
®ª ¦¨²¥, ·²®  «£®°¨²¬, ¯®±²°®¥­­»© ¯® ¬¥²®¤³ ¯°®² «ª¨¢ ­¨¿ ¯°¥¤¯®²®ª , ° §°¥¸ ¾¹¨© ¢¥°¸¨­³ ± ¬®© ¡®«¼¸®© ¢»±®²» ° ¡®² ¥² ¢°¥¬¿ O(V 3 ).

588

« ¢  27  ª±¨¬ «¼­»© ¯®²®ª

27.12  ¤ ·  ® ¢»µ®¤¥. H · «¼­»¥ ²®·ª¨ ·¥°­»¥, ®±² «¼­»¥ | ¡¥«»¥. ( ) »µ®¤ ¥±²¼ (¢»¤¥«¥­» ¯³²¨, ¥£® ®¡¥±¯¥·¨¢ ¾¹¨¥). (b) »µ®¤  ­¥².
¨±. 27.10
a

 ¤ ·¨
27-1  ¤ ·  ® ¢»µ®¤¥
¬¥¥²±¿, £° ´ ¢¥°¸¨­» ª®²®°®£® ®¡° §³¾² °¥¸¥²ª³ ¨§ n ±²°®ª
¨ n ±²®«¡¶®¢ (°¨±. 27.12). ¡®§­ ·¨¬ ·¥°¥§ (i; j ) ¢¥°¸¨­³ ­  ¯¥°¥±¥·¥­¨¨ i-£® ±²®«¡¶  ¨ j -®© ±²°®ª¨. ±¥ ¢¥°¸¨­» ² ª®© °¥¸¥²ª¨
(n  n grid), ­¥ ±·¨² ¿ £° ­¨·­»µ (i = 1, i = n, j = 1 ¨«¨ j = n)
¨¬¥¾² ·¥²»°¥µ ±®±¥¤¥©.  § ¤ ·¥ ® ¢»µ®¤¥ (escape problem) ²°¥¡³¥²±¿ ¢»¿±­¨²¼, ±³¹¥±²¢³¾² «¨ m ¯®¯ °­® ­¥¯¥°¥±¥ª ¾¹¨µ±¿ (­¥
¨¬¥¾¹¨µ ®¡¹¨µ ¢¥°¸¨­) ¯³²¥© ®² ¤ ­­»µ m 6 n2 ­ · «¼­»µ ²®·¥ª °¥¸¥²ª¨ (x1; y1); (x2; y2); : : :; (xm ; ym) ª m ° §«¨·­»¬ £° ­¨·­»¬ ²®·ª ¬. H ¯°¨¬¥°, ¤«¿ § ¤ ·¨ ® ¢»µ®¤¥ °¨±. 27.12(a) ®²¢¥²
¯®«®¦¨²¥«¥­,   ¤«¿ °¨±. 27.12 (b) | ®²°¨¶ ²¥«¥­.
(a)  ±±¬®²°¨¬ ±¥²¼, ¢ ª®²®°®© ¯°®¯³±ª­»¥ ±¯®±®¡­®±²¨ ¨¬¥¾²
­¥ ²®«¼ª® °¥¡° , ­® ¨ ¢¥°¸¨­». ²® ®§­ · ¥², ·²® ¯®²®ª, ¢µ®¤¿¹¨© ¢ ¤ ­­³¾ ¢¥°¸¨­³, ­¥ ¬®¦¥² ¯°¥¢®±µ®¤¨²¼ ­¥ª®²®°®£® ·¨±«  (¯°®¯³±ª­®© ±¯®±®¡­®±²¨ ¢¥°¸¨­»). ®ª ¦¨²¥, ·²® § ¤ ·  ®
¬ ª±¨¬ «¼­®¬ ¯®²®ª¥ ¢ ² ª®© ±¥²¨ ±¢®¤¨²±¿ ª ®¡»·­®© § ¤ ·¥ ®
¬ ª±¨¬ «¼­®¬ ¯®²®ª¥ ¤«¿ ±¥²¨ ­¥±ª®«¼ª® ¡®«¼¸¥£® ° §¬¥° .
(b) ª ¦¨²¥  «£®°¨²¬, °¥¸ ¾¹¨© § ¤ ·³ ® ¢»µ®¤¥. ¥¬³ ° ¢­®
¢°¥¬¿ ¥£® ° ¡®²»?
27-2 ¨­¨¬ «¼­®¥ ¯®ª°»²¨¥ ¯³²¿¬¨
®ª°»²¨¥¬ ¯³²¿¬¨ (path cover) ®°¨¥­²¨°®¢ ­­®£® £° ´  G =
(V; E ) ­ §®¢¥¬ ¬­®¦¥±²¢® ¯³²¥© P ± ² ª¨¬ ±¢®©±²¢®¬: ª ¦¤ ¿ ¢¥°¸¨­  ¨§ V ¯°¨­ ¤«¥¦¨² °®¢­® ®¤­®¬³ ¯³²¨ ¨§ P . ³²¨ ¬®£³² ­ ·¨­ ²¼±¿ ¨ § ª ­·¨¢ ²¼±¿ £¤¥ ³£®¤­®, ¨ ¨¬¥²¼ «¾¡³¾ ¤«¨­³, ¢ ²®¬
·¨±«¥ ­³«¥¢³¾. ®ª°»²¨¥ ­ ¨¬¥­¼¸¨¬ ¢®§¬®¦­»¬ ·¨±«®¬ ¯³²¥©
­ §®¢¥¬ ¬¨­¨¬ «¼­»¬ ¯®ª°»²¨¥¬ ¯³²¿¬¨ (minimum path cover).
( ) ®±²°®©²¥ ½´´¥ª²¨¢­»©  «£®°¨²¬, ­ µ®¤¿¹¨© ¬¨­¨¬ «¼­®¥ ¯®ª°»²¨¥ ¯³²¿¬¨ £° ´  G = (V; E ). (ª § ­¨¥. ³±²¼ V =
f1; 2; : : :; ng. ®±²°®¨¬ £° ´ G0 = (V 0; E 0), £¤¥
V 0 = fx0; x1; : : :; xng [ fy0; y1; : : :; yng;
E 0 = f(x0 ; xi)ji 2 V g [ f(yi ; y0)ji 2 V g [ f(xi; yj gj(i; j ) 2 E g;
¨ °¥¸¨¬ ¤«¿ ½²®£® £° ´  § ¤ ·³ ® ¬ ª±¨¬ «¼­®¬ ¯®²®ª¥.)
(b) ° ¢¨«¼­® «¨ ° ¡®² ¥² ½²®²  «£®°¨²¬, ¥±«¨ ³ £° ´  ¥±²¼
¶¨ª«»? ²¢¥² ®¡º¿±­¨²¥.
27-3 ª±¯¥°¨¬¥­²» ¢ ª®±¬®±¥
­±²¨²³² ª®±¬¨·¥±ª¨µ ¨±±«¥¤®¢ ­¨© ¯« ­¨°³¥² ±¥°¨¾ E =
fE1; E2; : : :; Emg ½ª±¯¥°¨¬¥­²®¢ ¢ ª®±¬®±¥.   °¥§³«¼² ² ½ª±¯¥°¨¬¥­²  Ei ±¯®­±®°» ¢»¯« ·¨¢ ¾² pi ¤®«« °®¢. «¿ ½²¨µ ½ª±¯¥°¨¬¥­²®¢ ²°¥¡³¾²±¿ ¯°¨¡®°» ¨§ ¬­®¦¥±²¢  I = fI1; I2; : : :; In g; ¤«¿
¯°®¢¥¤¥­¨¿ ½ª±¯¥°¨¬¥­²  Ej ­¥®¡µ®¤¨¬® ¬­®¦¥±²¢® Rj  I ¯°¨¡®-

«£®°¨²¬ ¯®¤­¿²¼-¨-¢-­ · «®

589

°®¢. ²®¨¬®±²¼ ¤®±² ¢ª¨ ¯°¨¡®°  Ik ±®±² ¢«¿¥² ck ¤®«« °®¢. °¥¡³¥²±¿ ¢»¿±­¨²¼, ª ª¨¥ ½ª±¯¥°¨¬¥­²» ±«¥¤³¥² ¯°®¢®¤¨²¼, ·²®¡»
¯°¨¡»«¼ (¤®µ®¤ ®² ½ª±¯¥°¨¬¥­²®¢ ¬¨­³± ±²®¨¬®±²¼ ¤®±² ¢ª¨ ­³¦­»µ ¯°¨¡®°®¢) ¡»«  ¬ ª±¨¬ «¼­®©.
«¿ °¥¸¥­¨¿ ½²®© § ¤ ·¨ ° ±±¬®²°¨¬ ±¥²¼ G ± ¨±²®ª®¬ s, ±²®ª®¬
t, ¢¥°¸¨­ ¬¨ I1; I2; : : :; In ¨ E1 ; E2; : : :; Em. ¥²¼ ¨¬¥¥² ² ª¦¥ °¥¡° 
(s; Ik ) ¯°®¯³±ª­®© ±¯®±®¡­®±²¨ ck (¤«¿ ¢±¥µ k = 1; 2; : : : ; n); (Ej ; t)
¯°®¯³±ª­®© ±¯®±®¡­®±²¨ pj ; (¤«¿ ¢±¥µ j = 1; 2; : : : ; m); (Ik ; Ej ) ¡¥±ª®­¥·­®© ¯°®¯³±ª­®© ±¯®±®¡­®±²¨, ¥±«¨ Ik 2 Ej (¤«¿ k = 1; 2; : : : ; n
¨ j = 1; 2; : : : ; m).
(a)  ±±¬®²°¨¬ ° §°¥§ (S; T ) ± ª®­¥·­®© ¯°®¯³±ª­®© ±¯®±®¡­®±²¼¾ ¤«¿ ¯®±²°®¥­­®© ±¥²¨. ³±²¼ Ej 2 T . ®ª ¦¨²¥, ·²® Ik 2 T
¤«¿ ¢±¥µ Ik 2 Rj .
(b)  ª, §­ ¿ ¢±¥ pj ¨ ¯°®¯³±ª­³¾ ±¯®±®¡­®±²¼ ¬¨­¨¬ «¼­®£®
° §°¥§  ±¥²¨ G, ­ ©²¨ ¬ ª±¨¬ «¼­³¾ ¯°¨¡»«¼ ®² ½ª±¯¥°¨¬¥­²®¢?
(c) ®±²°®©²¥  «£®°¨²¬, ®¯°¥¤¥«¿¾¹¨©, ª ª¨¥ ½ª±¯¥°¨¬¥­²»
±«¥¤³¥² ¯°®¢®¤¨²¼ [¤«¿ ¯®«³·¥­¨¿ ­ ¨¡®«¼¸¥© ¯°¨¡»«¨] ¨ ª ª¨¥
¤«¿ ½²®£® ­³¦­» ¯°¨¡®°». ¶¥­¨²¥ ¢°¥¬¿ ¥£® ° ¡®²» ª ª ´³­ªm
P
¶¨¾ ®² m, n ¨ r = jRj j.
j =1
27-4  ª±¨¬ «¼­»© ¯®²®ª ¢ ¨§¬¥­¥­­®© ±¥²¨
°¥¤¯®«®¦¨¬, ­ ¬ ¨§¢¥±²¥­ ¬ ª±¨¬ «¼­»© ¯®²®ª ¢ ±¥²¨ G =
(V; E ), ¢ ª®²®°®© ¢±¥ ¯°®¯³±ª­»¥ ±¯®±®¡­®±²¨ °¥¡¥° | ¶¥«»¥ ·¨±« .
(a) ³±²¼ ¯°®¯³±ª­ ¿ ±¯®±®¡­®±²¼ ­¥ª®²®°®£® °¥¡°  (u; v ) 2 E
³¢¥«¨·¨« ±¼ ­  ¥¤¨­¨¶³. °¨¢¥¤¨²¥  «£®°¨²¬, ­ µ®¤¿¹¨© ¬ ª±¨¬ «¼­»© ¯®²®ª (¤«¿ ¨§¬¥­¥­­®© ±¥²¨) §  ¢°¥¬¿ O(V + E ).
(b) ³±²¼ ¯°®¯³±ª­ ¿ ±¯®±®¡­®±²¼ ­¥ª®²®°®£® °¥¡°  (u; v ) 2 E
³¬¥­¼¸¨« ±¼ ­  ¥¤¨­¨¶³. °¨¢¥¤¨²¥  «£®°¨²¬, ­ µ®¤¿¹¨© ¬ ª±¨¬ «¼­»© ¯®²®ª (¤«¿ ¨§¬¥­¥­­®© ±¥²¨) §  ¢°¥¬¿ O(V + E ).
27-5  ±¸² ¡¨°®¢ ­¨¥
 ±±¬®²°¨¬ ±¥²¼ G = (V; E ) ± ¨±²®ª®¬ s ¨ ±²®ª®¬ t. ³±²¼ ¯°®¯³±ª­ ¿ ±¯®±®¡­®±²¼ c(u; v ) «¾¡®£® °¥¡°  (u; v ) 2 E | ¶¥«®¥ ·¨±«®.
®«®¦¨¬ C = max c(u; v ).
(u;v)2E
(a) ®ª ¦¨²¥, ·²® ¯°®¯³±ª­ ¿ ±¯®±®¡­®±²¼ ¬¨­¨¬ «¼­®£® ° §°¥§  ±¥²¨ G ­¥ ¯°¥¢®±µ®¤¨² C jE j.
(b) ®ª ¦¨²¥, ·²® ¯°¨ «¾¡®¬ § ¤ ­­®¬ K ¬®¦­® §  ¢°¥¬¿ O(E )
­ ©²¨ ¤®¯®«­¿¾¹¨© ¯³²¼ ± ¯°®¯³±ª­®© ±¯®±®¡­®±²¼¾ ­¥ ¬¥­¼¸¥
K ¨«¨ ³±² ­®¢¨²¼, ·²® ² ª®£® ¯³²¨ ­¥².
«£®°¨²¬ Max-Flow-By-Scaling ¢»·¨±«¿¥² ¬ ª±¨¬ «¼­»© ¯®²®ª ¢ ±¥²¨ G ± ¯®¬®¹¼¾ ¬ ±¸² ¡¨°®¢ ­¨¿. ²® ®¤­  ¨§ °¥ «¨§ ¶¨©
¬¥²®¤  ®°¤ { «ª¥°±®­ .
\textsc{Max-Flow-By-Scaling}($G,s,t$)
1 $C\leftarrow\max\limits_{(u,v)\in E}{c(u,v)}$
2 ±¤¥« ²¼ ¯®²®ª $f$ ­³«¥¢»¬

590

« ¢  27  ª±¨¬ «¼­»© ¯®²®ª

3 $K\leftarrow 2^{\lfloor\log C\rfloor}$
4 while $K\ge 1$
5
do while ±³¹¥±²¢³¥² ¤®¯®«­¿¾¹¨© ¯³²¼ $p$ ¯°®¯³±ª­®© ±¯®±®¡­®±²¨ ­¥ ¬¥­¼
6
do ¤®¯®«­¨²¼ $f$ ¢¤®«¼ $p$
7
$K\leftarrow K/2$
8 return $f$

(c) ®ª ¦¨²¥, ·²® ¯°®£° ¬¬  Max-Flow-By-Scaling ¢»·¨±«¿¥² ¬ ª±¨¬ «¼­»© ¯®²®ª.
(d) ®ª ¦¨²¥, ·²® ¢ ¬®¬¥­² ¯°®¢¥°ª¨ ³±«®¢¨¿ ¶¨ª«  ¢ ±²°®ª¥
4 ¯°®¯³±ª­ ¿ ±¯®±®¡­®±²¼ ¬¨­¨¬ «¼­®£® ° §°¥§  ®±² ²®·­®© ±¥²¨
­¥ ¯°¥¢®±µ®¤¨² 2K jE j.
(e) ®ª ¦¨²¥, ·²® ¶¨ª« ¢ ±²°®ª µ 5-6 ¢»¯®«­¿¥²±¿ O(E ) ° § ¤«¿
«¾¡®£® §­ ·¥­¨¿ K .
(f) ®ª ¦¨²¥, ·²® ¢°¥¬¿ ° ¡®²»  «£®°¨²¬  Max-Flow-ByScaling ° ¢­® O(E 2 log C ).
27-6
¢³±²®°®­­¨¥ £° ­¨¶»
 ±±¬®²°¨¬ ±¥²¼ G = (V; E ). °¥¤¯®«®¦¨¬, ·²® ®£° ­¨·¥­¨¿ ­ 
¯®²®ª ¢ ½²®© ±¥²¨ ¤¢³±²®°®­­¨¥. ¬¥­­®, ¤«¿ ¯®²®ª  f ¨ ¤«¿ ª ¦¤®£® °¥¡°  (u; v ) ¬» ²°¥¡³¥¬, ·²®¡» b(u; v ) 6 f (u; v ) 6 c(u; v ), £¤¥
c ¨ b | § ¤ ­­»¥ ´³­ª¶¨¨ ­  °¥¡° µ. (®§¬®¦­®, ·²® ½²¨ ®£° ­¨·¥­¨¿ ¯°®²¨¢®°¥·¨¢» | ²®£¤  ¯®²®ª  ­¥ ±³¹¥±²¢³¥².)
(a) ³±²¼ f | ¯®²®ª ¢ ±¥²¨ G. ®ª ¦¨²¥, ·²® jf j 6 c(S; T ) ;
b(T; S ) ¤«¿ «¾¡®£® ° §°¥§  (S; T ).
(b) ³±²¼ ¢ ±¥²¨ G ¬ ª±¨¬ «¼­»© ¯®²®ª ±³¹¥±²¢³¥². ®ª ¦¨²¥, ·²® ¥£® §­ ·¥­¨¥ ° ¢­® ¬¨­¨¬ «¼­®© (¯® ¢±¥¬ ° §°¥§ ¬ (S; T ))
° §­®±²¨ c(S; T ) ; b(T; S ).
 ±±¬®²°¨¬ ±¥²¼ G = (V; E ) ± ¤¢³±²®°®­­¨¬¨ £° ­¨¶ ¬¨ ± ¨±²®ª®¬ s ¨ ±²®ª®¬ t. ¡®§­ ·¨¬ ¢¥°µ­¾¾ ¨ ­¨¦­¾¾ £° ­¨¶» c ¨ b
±®®²¢¥²±²¢¥­­®. ®±²°®¨¬ ®¡»·­³¾ ±¥²¼ G0 = (V 0 ; E 0) ± ¢¥°µ­¥©
£° ­¨¶¥© (¯°®¯³±ª­®© ±¯®±®¡­®±²¼¾) c0, ¨±²®ª®¬ s0 ¨ ±²®ª®¬ t0 ,
¯®«®¦¨¢
V 0 = V [ fs0; t0g
E 0 = E [ f(s0; v )jv 2 V g [ f(u; t0)ju 2 V g [ f(s; t); (t; s)g:
«¿ °¥¡¥° (u; v ) 2 E ¯®«®¦¨¬ c0(u; v ) = c(u; v ) ; b(u; v ); ¤«¿ ¢±¥µ
¢¥°¸¨­ u 2 V ¯®«®¦¨¬ c0(s0 ; u) = b(V; u),   ² ª¦¥ c0(u; t0) = b(u; V ).
°®¬¥ ²®£®, ¯®«®¦¨¬ c0(s; t) = c0(t; s) = 1.
(c) ®ª ¦¨²¥, ·²® ¯®²®ª ¢ ±¥²¨ G ±³¹¥±²¢³¥² ²®£¤  ¨ ²®«¼ª® ²®£¤ , ª®£¤  ¤«¿ ¬ ª±¨¬ «¼­®£® ¯®²®ª  ¢ ±¥²¨ G0 ¢±¥ °¥¡° , ¢µ®¤¿¹¨¥
¢ t0 , ­ ±»¹¥­».
(d) ®±²°®©²¥  «£®°¨²¬, ª®²®°»© ¢»¿±­¿¥², ±³¹¥±²¢³¥² «¨ ¯®²®ª ¢ ¤ ­­®© ±¥²¨ ± ¤¢³±²®°®­­¨¬¨ £° ­¨¶ ¬¨, ¨ ¥±«¨ ¤ , ²® ­ µ®¤¨² ½²®² ¯®²®ª. ¶¥­¨²¥ ¢°¥¬¿ ° ¡®²» ½²®£®  «£®°¨²¬ .
 ¬¥· ­¨¿

«£®°¨²¬ ¯®¤­¿²¼-¨-¢-­ · «®

591

 «¼­¥©¸¥¥ ®¡±³¦¤¥­¨¥ ±¥²¥© ¨ ±¢¿§ ­­»µ ± ­¨¬¨  «£®°¨²¬®¢
±¬. ¢ ¢¥­ [65], ®³«¥° [132],  ¯ ¤¨¬¨²°¨³ ¨ ² ©£«¨¶ [154],  °¼¿­ [188]. ®°®¸¨© ®¡§®° ±¥²¥¢»µ  «£®°¨²¬®¢ ­ ¯¨± «¨ ®«¼¤¡¥°£,  °¤®± ¨  °¼¿­ [83].
¥²®¤ ®°¤ { «ª¥°±®­  ¨§®¡°¥«¨ ®°¤ ¨  «ª¥°±®­ [71]. ­¨
¦¥ ° ±±¬®²°¥«¨ ¬­®£¨¥ § ¤ ·¨, ±¢¿§ ­­»¥ ± ±¥²¿¬¨, ¢ ²®¬ ·¨±«¥
§ ¤ ·³ ® ¬ ª±¨¬ «¼­®¬ ¯®²®ª¥ ¨ ® ¬ ª±¨¬ «¼­®¬ ¯ °®±®·¥² ­¨¨.
® ¬­®£¨µ ° ­­¨µ °¥ «¨§ ¶¨¿µ ¬¥²®¤  ®°¤ { «ª¥°±®­  ¤®¯®«­¿¾¹¨© ¯³²¼ ­ µ®¤¨«¨ ± ¯®¬®¹¼¾ ¯®¨±ª  ¢ ¸¨°¨­³; ¤¬®­¤± ¨
 °¯ [63] ¤®ª § «¨, ·²® ¢ ½²®¬ ±«³· ¥  «£®°¨²¬ ¯®«¨­®¬¨ «¥­.
¤¥¾ ¯°¥¤¯®²®ª  ¯°¥¤«®¦¨«  °§ ­®¢ [119]. ¥²®¤ ¯°®² «ª¨¢ ­¨¿
¯°¥¤¯®²®ª  ¯°¥¤«®¦¨« ®«¼¤¡¥°£ [82]. H ¨¡®«¥¥ ¡»±²°»© (¢°¥¬¿
° ¡®²» O(V E log (V 2 E )) ¨§ ¨§¢¥±²­»µ  «£®°¨²¬®¢ ¯°®² «ª¨¢ ­¨¿
¯°¥¤¯®²®ª  ¯°¨­ ¤«¥¦¨² ®«¼¤¡¥°£³
¨  °¼¿­³ [85]. H ¨«³·¸¨©
p
¨§¢¥±²­»© (¢°¥¬¿ ° ¡®²» O( V E ))  «£®°¨²¬ ¤«¿ § ¤ ·¨ ® ¬ ª±¨¬ «¼­®¬ ¯ °®±®·¥² ­¨¨ ¯°¥¤«®¦¨«¨ ®¯ª°®´² ¨  °¯ [101].

28

®°²¨°³¾¹¨¥ ±¥²¨

® ¢²®°®© · ±²¨ ª­¨£¨ ¨§³· «¨±¼ ±®°²¨°³¾¹¨¥  «£®°¨²¬», °¥ «¨§®¢ ­­»¥ ­  ¬ ¸¨­ µ ¯°®¨§¢®«¼­®£® ¤®±²³¯  (RAM).  ½²®© £« ¢¥
° ±±¬ ²°¨¢ ¾²±¿ ±®°²¨°³¾¹¨¥  «£®°¨²¬», ¢ ®±­®¢³ ª®²®°»µ ¯®«®¦¥­  ±®¢¥°¸¥­­® ¨­ ¿ ¢»·¨±«¨²¥«¼­ ¿ ¬®¤¥«¼ | ±¥²¼ ª®¬¯ ° ²®°®¢.
±²¼ ¤¢  ±³¹¥±²¢¥­­»µ ®²«¨·¨¿ ¬¥¦¤³ RAM-¬ ¸¨­ ¬¨ ¨ ±¥²¿¬¨ ª®¬¯ ° ²®°®¢. ®-¯¥°¢»µ, ¢ ¯°®¶¥±±¥ ° ¡®²» ª®¬¯ ° ²®°» ¬®£³² ¢»¯®«­¿²¼ ²®«¼ª® ®¯¥° ¶¨¨ ±° ¢­¥­¨¿. «¥¤®¢ ²¥«¼­®,
°¥ «¨§®¢ ²¼ ­  ­¨µ  «£®°¨²¬», ¯®¤®¡­»¥ ±®°²¨°®¢ª¥ ¯®¤±·¥²®¬
(±¬. ° §¤¥« 9.2), ­¥¢®§¬®¦­®. ®-¢²®°»µ, RAM-¬ ¸¨­» ° ¡®² ¾²
¯®±«¥¤®¢ ²¥«¼­®, ¢»¯®«­¿¿ ®¤­³ ®¯¥° ¶¨¾ §  ®¤¨­ ² ª² ° ¡®²».
¥²¼ ª®¬¯ ° ²®°®¢ ¬®¦¥² ° ¡®² ²¼ ¯ ° ««¥«¼­®, ².¥. ¢»¯®«­¿²¼
®¤­®¢°¥¬¥­­® ­¥±ª®«¼ª® ®¯¥° ¶¨©. « £®¤ °¿ ½²®¬³ ³¤ ¥²±¿ ®²±®°²¨°®¢ ²¼ n ·¨±¥« §  ¢°¥¬¿, ±³¹¥±²¢¥­­® ¬¥­¼¸¥¥ n.
 ° §¤¥«¥ 28.1 ¢¢®¤¿²±¿ ¯®­¿²¨¿ ±¥²¨ ª®¬¯ ° ²®°®¢, ±®°²¨°³¾¹¥© ±¥²¨, ¢°¥¬¥­¨ ° ¡®²» ±¥²¨.  ° §¤¥«¥ 28.2 ¬» ¤®ª ¦¥¬ ¯° ¢¨«® À­³«¿ ¨ ¥¤¨­¨¶»Á, ª®²®°®¥ ³¯°®¹ ¥² ¯°®¢¥°ª³ ¯° ¢¨«¼­®±²¨
° ¡®²» ±®°²¨°³¾¹¥© ±¥²¨.
»±²° ¿ ±®°²¨°³¾¹ ¿ ±¥²¼, ª®²®°³¾ ¬» ¯®±²°®¨¬, ¯°¥¤±² ¢«¿¥² ±®¡®© ¯ ° ««¥«¼­³¾ °¥ «¨§ ¶¨¾ ±®°²¨°®¢ª¨ ±«¨¿­¨¥¬ (° §¤¥«
1.3.1). ­ · «  (° §¤¥« 28.3) ±²°®¨²±¿ ¡¨²®­¨·¥±ª¨© ±®°²¨°®¢¹¨ª
§ ²¥¬ (28.4) ®­ ±«¥£ª  ¬®¤¨´¨¶¨°³¥²±¿ ¨ ¯®«³· ¥²±¿ ±«¨¢ ¾¹ ¿
±¥²¼, ª®²®° ¿ ±®¥¤¨­¿¥² ¤¢  ³¯®°¿¤®·¥­­»µ ­ ¡®°  ¢ ®¤¨­.  ª®­¥¶ (28.5) ¬» ±®¥¤¨­¿¥¬ ±«¨¢ ¾¹¨¥ ±¥²¨ ¢ ±®°²¨°³¾¹³¾ ±¥²¼,
ª®²®° ¿ ¯®§¢®«¿¥² ®²±®°²¨°®¢ ²¼ n ®¡º¥ª²®¢ §  ¢°¥¬¿ O(lg2 n).
28.1 (a) ®¬¯ ° ²®° ±® ¢µ®¤ ¬¨ x, y ¨ ¢»µ®¤ ¬¨ x0 , y0 . (b) ®² ¦¥
ª®¬¯ ° ²®° ¢ ¢¨¤¥ ¢¥°²¨ª «¼­®© «¨­¨¨. ®ª § ­» ¢µ®¤» x = 7, y = 3 ¨ ¢»µ®¤»
x0 = 3, y0 = 7.
¨±. 28.1

¥²¨ ª®¬¯ ° ²®°®¢

593

¨±. 28.2 28.2 (a) ¥²¼ ª®¬¯ ° ²®°®¢ ± 4 ¢µ®¤ ¬¨ ¨ 4 ¢»µ®¤ ¬¨, ª®²®° ¿ ¿¢«¿¥²±¿ ±®°²¨°³¾¹¥©. ®ª § ­» ¢µ®¤­»¥ §­ ·¥­¨¿ ¢ ¬®¬¥­² 0. (b) ­ ·¥­¨¿ ­ 
¢»µ®¤ µ ª®¬¯ ° ²®°®¢ A ¨ B ¢ ¬®¬¥­² ¢°¥¬¥­¨ 1. (c)  ¬®¬¥­² 2 ¯®¿¢«¿¾²±¿
¢»µ®¤­»¥ §­ ·¥­¨¿ ª®¬¯ ° ²®°®¢ C ¨ D; ¢»µ®¤­»¥ §­ ·¥­¨¿ b1 ¨ b4 (­® ­¥
b2 ; b3 ) ®¯°¥¤¥«¥­». (d)  ª®­¥¶, ®±² ¢¸¨¥ ¤¢  ¢»µ®¤­»µ §­ ·¥­¨¿ ¯®¿¢«¿¾²±¿
­  ¢»µ®¤ µ ª®¬¯ ° ²®°  E .

28.1. ¥²¨ ª®¬¯ ° ²®°®¢
®°²¨°³¾¹¨¥ ±¥²¨ ±²°®¿²±¿ ¨§ ª®¬¯ ° ²®°®¢, ±®¥¤¨­¥­­»µ ¯°®¢®¤ ¬¨. ®¬¯ ° ²®° (comparator) (°¨±. 28.1(a)) ¨¬¥¥² ¤¢  ¢µ®¤ 
x; y ¨ ¤¢  ¢»µ®¤  x0 ; y 0. ®¬¯ ° ²®° ¯®«³· ¥² ­  ¢µ®¤ ¤¢  ·¨±«  ¨
¯¥°¥±² ¢«¿¥² ¨µ, ¥±«¨ ®­¨ ¨¤³² ¢ ­¥¯° ¢¨«¼­®¬ ¯®°¿¤ª¥. °³£¨¬¨
±«®¢ ¬¨,
x0 = min(x; y );
y 0 = max(x; y ):
®£®¢®°¨¬±¿ ±µ¥¬ ²¨·­® ¨§®¡° ¦ ²¼ ª®¬¯ ° ²®° ¢ ¢¨¤¥ ¢¥°²¨ª «¼­®£® ®²°¥§ª , ª ª ­  °¨±³­ª¥ 28.1(b). µ®¤» °±¯®«®¦¥­» ±«¥¢ ,
  ¢»µ®¤» | ±¯° ¢ , ¯°¨ ½²®¬ ¢¥°µ­¨© ¢»µ®¤ ±®®²¢¥²±²¢³¥² ¬¨­¨¬ «¼­®¬³ ·¨±«³,   ­¨¦­¨© | ¬ ª±¨¬ «¼­®¬³.
» ±·¨² ¥¬, ·²® ¢°¥¬¿ ° ¡®²» ª®¬¯ ° ²®°  (¬¥¦¤³ ¯®«³·¥­¨¥¬
¢µ®¤­»µ ¤ ­­»µ ¨ ¢»¤ ·¥© ¢»µ®¤­»µ) ¯®±²®¿­­® ¨ ®¤¨­ ª®¢® ¤«¿
¢±¥µ ª®¬¯ ° ²®°®¢.
 ¯®¬®¹¼¾ ¯°®¢®¤®¢ (wires) ¢»µ®¤» ®¤­¨µ ª®¬¯ ° ²®°®¢ ±®¥¤¨­¿¾² ±® ¢µ®¤ ¬¨ ¤°³£¨µ. °®¬¥ ²®£®, ±¥²¼ ¨¬¥¥² ¢µ®¤­»¥ ¨ ¢»µ®¤­»¥ ¯°®¢®¤ .  ±±¬®²°¨¬ ±¥²¼ ª®¬¯ ° ²®°®¢ ± n ¢µ®¤­»¬¨ ¯°®¢®¤ ¬¨ (input wires) a1 ; a2; : : : ; an ¨ n ¢»µ®¤­»¬¨ ¯°®¢®¤ ¬¨ (output
wires) b1; b2; : : : ; bn.   ¢µ®¤ ¯®±²³¯ ¥² ¯®±«¥¤®¢ ²¥«¼­®±²¼ n ·¨±¥«
(ª®²®°»¥ ¬» ¡³¤¥¬ ®¡®§­ · ²¼ ha1; a2; : : : ; an i, ª ª ¨ ± ¬¨ ¯°®¢®¤ ); °¥§³«¼² ²®¬ ° ¡®²» ¡³¤¥² ¯®±«¥¤®¢ ²¥«¼­®±²¼ hb1; b2; : : : ; bni.
  °¨±³­ª¥ 28.2 ¯°¨¢®¤¨²±¿ ¯°¨¬¥° ±¥²¨ ª®¬¯ ° ²®°®¢ (comparison network). ¥²¼ ± n ¢µ®¤ ¬¨ ¨ n ¢»µ®¤ ¬¨ ¨§®¡° ¦ ¥²±¿ n
£®°¨§®­² «¼­»¬¨ ¯°¿¬»¬¨, ª®²®°»¥ ¢ ­¥ª®²®°»µ ¬¥±² µ ±®¥¤¨­¥­» ¢¥°²¨ª «¼­»¬¨ ®²°¥§ª ¬¨ | ª®¬¯ ° ²®° ¬¨. °¿¬ ¿ | ½²®
­¥ ®¤¨­ ¯°®¢®¤,   ­¥±ª®«¼ª® | ¯°®¢®¤®¬ ¿¢«¿¥²±¿ ³· ±²®ª ¬¥¦¤³
ª®¬¯ ° ²®° ¬¨.  ¯°¨¬¥°, ¢¥°µ­¿¿ ¯°¿¬ ¿ ­  °¨±³­ª¥ 28.2 ±®±²®¨² ¨§ ²°¥µ ¯°®¢®¤®¢: ¢µ®¤­®£® ¯°®¢®¤  a1 ±®¥¤¨­¥­­®£® ±® ¢µ®¤®¬
ª®¬¯ ° ²®°  A; ¯°®¢®¤ , ±®¥¤¨­¿¾¹¥£® ¢¥°µ­¨© ¢»µ®¤ ª®¬¯ ° ²®°  A ±® ¢µ®¤®¬ ª®¬¯ ° ²®°  C ,   ² ª¦¥ ¢»µ®¤­®£® ¯°®¢®¤  b1,
±®¥¤¨­¥­­®£® ± ¢¥°µ­¨¬ ¢»µ®¤®¬ ª®¬¯ ° ²®°  C .
 ¦¤»© ¢µ®¤ «¾¡®£® ¨§ ª®¬¯ ° ²®°®¢ ±®¥¤¨­¥­ «¨¡® ± ®¤­¨¬
¨§ ¢µ®¤­»µ ¯°®¢®¤®¢ a1 ; a2; : : : ; an , «¨¡® ± ¢»µ®¤®¬ ¤°³£®£® ª®¬¯ ° ²®° .  ¦¤»© ¢»µ®¤ «¾¡®£® ¨§ ª®¬¯ ° ²®°®¢ ±®¥¤¨­¥­ «¨¡® ±
¢µ®¤®¬ ¤°³£®£® (°®¢­® ®¤­®£®), «¨¡® ± ®¤­¨¬ ¨§ ¢»µ®¤­»µ ¯°®¢®-

594

« ¢  28 ®°²¨°³¾¹¨¥ ±¥²¨

¤®¢ b1; b2; : : : ; bn. °¨ ½²®¬ ­¥ ¬®¦¥² ¡»²¼ ¶¨ª«®¢: ¨¤¿ ¯® ¯°®¢®¤ ¬
¨ ¯°®µ®¤¿ ª®¬¯ ° ²®°» ®² ¢µ®¤®¢ ª ¢»µ®¤ ¬, ­¥«¼§¿ ¢¥°­³²¼±¿ ª
¨±µ®¤­®¬³ ª®¬¯ ° ²®°³. ²® ²°¥¡®¢ ­¨¥ ¯®§¢®«¿¥² °¨±®¢ ²¼ ±¥²¨
ª®¬¯ ° ²®°®¢ ¢ ¢¨¤¥ ¯°¿¬»µ, ª ª ­  °¨±³­ª¥ 28.2, ° ±¯®« £ ¿ ¢µ®¤» ±«¥¢ ,   ¢»µ®¤» ±¯° ¢ : ¤ ­­»¥ ¤¢¨¦³²±¿ ¯® ¯°®¢®¤ ¬ ±«¥¢ 
­ ¯° ¢®.
» ±·¨² ¥¬, ·²® ª ¦¤»© ª®¬¯ ° ²®° ¢»¤ ¥² ¢»µ®¤­»¥ §­ ·¥­¨¿ ·¥°¥§ ¥¤¨­¨¶³ ¢°¥¬¥­¨ ¯®±«¥ ²®£®, ª ª ¯®«³·¨² ¢µ®¤­»¥ §­ ·¥­¨¿.  ±±¬®²°¨¬ ±¥²¼ °¨±. 28.2(a) ¨ ¯°¥¤±² ¢¨¬ ¢±¥¡¥, ·²® ¢ ¢
¬®¬¥­² ¢°¥¬¥­¨ 0 ­  ¢µ®¤ ¯®±²³¯ ¾² ·¨±«  h9; 5; 2; 6i.  ½²®² ¬®¬¥­² ª®¬¯ ° ²®°» A ¨ B (¨ ²®«¼ª® ®­¨) ¯®«³· ¾² ¢µ®¤­»¥ ¤ ­­»¥
¨ ­ ·¨­ ¾² ° ¡®² ²¼ (¯ ° ««¥«¼­®). ®½²®¬³ ¢ ¬®¬¥­² ¢°¥¬¥­¨
1 ­  ¨µ ¢»µ®¤ µ ¯®¿¢¿²±¿ ·¨±«  (°¨±. 28.2(b)), ª®²®°»¥ ¯®§¢®«¿²
­ · ²¼ ¯ ° ««¥«¼­³¾ ° ¡®²³ ª®¬¯ ° ²®° ¬ C ¨ D (­® ­¥ E ). ®¬¯ ° ²®°³ E ¯°¨¤¥²±¿ ¤®¦¨¤ ²¼±¿ ¬®¬¥­²  ¢°¥¬¥­¨ 2, ª®£¤  C ¨
D § ª®­· ² ° ¡®²³ (°¨±. 28.2(c)). ¹¥ ·¥°¥§ ¥¤¨­¨¶³ ¢°¥¬­¨ ¢»µ®¤­ ¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼ h2; 5; 6; 9i ¡³¤¥² ¯®«­®±²¼¾ £®²®¢  (µ®²¿
¤¢  ¨§ ·¥²»°¥µ §­ ·¥­¨© ¡»«¨ £®²®¢» ° ­¼¸¥).
 ª ¢¨¤­® ¨§ ½²®£® ¯°¨¬¥° , ¢°¥¬¿ ° ¡®²» ±¥²¨ (¯°®¸¥¤¸¥¥ ±
¬®¬¥­²  ¯®«³·¥­¨¿ ¢µ®¤­®© ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¤® ¢»¤ ·¨ ¢»µ®¤­®© ¯®±«¥¤®¢ ²¥«¼­®±²¨) ®¯°¥¤¥«¿¥²±¿ ¬ ª±¨¬ «¼­»¬ ·¨±«®¬ ª®¬¯ ° ²®°®¢, ±²®¿¹¨µ ­  ¯³²¨ ®² ¢µ®¤  ª ¢»µ®¤³. ®«¥¥ ´®°¬ «¼­®,
¬» ®¯°¥¤¥«¿¥¬ £«³¡¨­³ (depth) ¯°®¢®¤  ¢ ±¥²¨ ±«¥¤³¾¹¨¬ ®¡° §®¬:
¢µ®¤­»¥ ¯°®¢®¤  ¨¬¥¾² ­³«¥¢³¾ £«³¡¨­³, £«³¡¨­  ¢»µ®¤®¢ ª®¬¯ ° ²®°  (¯®¤ª«¾·¥­­»µ ª ­¥¬³ ¯°®¢®¤®¢) ° ¢­  max(dx; dy )+1, £¤¥
dx ¨ dy | £«³¡¨­» ¥£® ¢µ®¤®¢ (¯®¤ª«¾·¥­­»µ ª ­¨¬ ¯°®¢®¤®¢).
²® ®¯°¥¤¥«¥­¨¥ ª®°°¥ª²­®, ¯®±ª®«¼ª³ ­¥² ¶¨ª«®¢.  §®¢¥¬ £«³¡¨­®© ª®¬¯ ° ²®°  £«³¡¨­³ ¢»µ®¤¿¹¨µ ¨§ ­¥£® ¯°®¢®¤®¢. «³¡¨­®©
±¥²¨ ±·¨² ¥¬ ¬ ª±¨¬ «¼­³¾ £«³¡¨­³ ¥¥ ¢»µ®¤­»µ ¯°®¢®¤®¢ (¨«¨,
·²® ²® ¦¥ ± ¬®¥, ¬ ª±¨¬ «¼­³¾ £«³¡¨­³ ¥¥ ª®¬¯ ° ²®°®¢).  ¯°¨¬¥°, £«³¡¨­  ±¥²¨ ­  °¨±³­ª¥ 28.2 ° ¢­  3 (ª®¬¯ ° ²®° E ¨¬¥¥²
£«³¡¨­³ 3). «³¡¨­  ª®¬¯ ° ²®°  ° ¢­  ¢°¥¬¥­¨, ª®²®°®¥ ¯°®©¤¥²
®² ­ · «  ° ¡®²» ¯® ¯®¿¢«¥­¨¿ ®²¢¥²®¢ ­  ¥£® ¢»µ®¤ µ, ² ª ·²®
¢°¥¬¿ ° ¡®²» ±¥²¨ ¢ ¶¥«®¬ ° ¢­® ¥¥ £«³¡¨­¥.
 §¬¥°®¬ (size) ±¥²¨ ­ §»¢ ¾² ·¨±«® ª®¬¯ ° ²®°®¢ ¢ ­¥©.
¾¡ ¿ ±¥²¼ ª®¬¯ ° ²®°®¢ ª ª-²® ¯¥°¥±² ¢«¿¥² ·¨±« , ¯®¤ ­­»¥ ­  ª¥ ¢µ®¤». ¥ ­ §»¢ ¾² ±®°²¨°³¾¹¥© ±¥²¼¾ (sorting network), ¥±«¨ ¤«¿ «¾¡®© ¢µ®¤­®© ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¯®«³· ¾¹ ¿±¿ ¨§ ­¥¥ ¢»µ®¤­ ¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¬®­®²®­­® ¢®§° ±² ¥²
(b1 6 b2 6    6 bn ).
®­¥·­®, ¤ «¥ª® ­¥ ª ¦¤ ¿ ±¥²¼ | ±®°²¨°³¾¹ ¿, ­® ±¥²¼ °¨±³­ª  28.2 ² ª®¢®© ¿¢«¿¥²±¿.  ± ¬®¬ ¤¥«¥, ¢ ¬®¬¥­² ¢°¥¬¥­¨ 1
¬¨­¨¬ «¼­»© ¨§ ¢µ®¤®¢ ­ µ®¤¨²±¿ ­  ¢¥°µ­¥¬ ¢»µ®¤¥ ®¤­®£® ¨§
ª®¬¯ ° ²®°®¢ A ¨ B , ¨ ¢ ¬®¬¥­² ¢°¥¬¥­¨ 2 ®­ ª ¦¥²±¿ ­  ­  ¢¥°µ­¥¬ ¢»µ®¤¥ ª®¬¯ ° ²®°  C . ­ «®£¨·­»¬ ®¡° §®¬ ¬ ª±¨¬ «¼­»©
¨§ ¢µ®¤®¢ ®ª ¦¥²±¿ ¢ ½²®² ¬®¬¥­² ­  ­¨¦­¥¬ ¢»µ®¤¥ ª®¬¯ ° ²®-

¥²¨ ª®¬¯ ° ²®°®¢

595

28.3 ®°²¨°³¾¹ ¿ ±¥²¼, ±®®²¢¥²±²¢³¾¹ ¿ ±®°²¨°®¢ª¥ ¢±² ¢ª ¬¨
(³¯° ¦­¥­¨¥ 28.1-6).
¨±.

°  D. ±² ¢¸¨¥±¿ ¤¢  ·¨±«  ³¯®°¿¤®·¨¢ ¾²±¿ ª®¬¯ ° ²®°®¬ E ¢
¬®¬¥­² ¢°¥¬¥­¨ 3.
¥²¨ ª®¬¯ ° ²®°®¢  ­ «®£¨·­»  «£®°¨²¬ ¬ ±®°²¨°®¢ª¨, ®¤­ ª® ¤«¿ ª ¦¤®£® n ¬» ¤®«¦­» ±²°®¨²¼ ±¢®¾ ±¥²¼, ¢ ²® ¢°¥¬¿ ª ª
®¤¨­ ¨ ²®² ¦½¥  «£®°¨²¬ ±®°²¨°®¢ª¨ ¬®¦¥² ° ¡®² ²¼ ¤«¿ ¯®±«¥¤®¢ ²¥«¼­®±²¥© ¯°®¨§¢®«¼­®© ¤«¨­».  ½²®© £« ¢¥ ¬» ¯®±²°®¨¬
±¥¬¥©±²¢® Sorter ½´´¥ª²¨¢­»µ ±®°²¨°³¹¨µ ±¥²¥© | ¤«¿ ª ¦¤®£® n ¢ ­¥¬ ¡³¤¥² ±¢®¿ ±¥²¼, ª®²®°³¾ ¬» ®¡®§­ · ¥¬ Sorter[n].
¯° ¦­¥­¨¿.
28.1-1
 ª®¢» ¡³¤³² §­ ·¥­¨¿ ­  ¯°®¢®¤ µ ±¥²¨ °¨±. 28.2, ¥±«¨ ­  ¥¥
¢µ®¤ ¯®¤ ¾²±¿ ·¨±«  h9; 6; 5; 2i?
28.1-2
³±²¼ n | ±²¥¯¥­¼ ·¨±«  2. ®±²°®©²¥ ±¥²¼ ª®¬¯ ° ²®°®¢ ± n
¢µ®¤ ¬¨ ¨ n ¢»µ®¤ ¬¨ £«³¡¨­» lg n, ª®²®° ¿ ­  ­ µ®¤¨² ­ ¨¬¥­¼¸¨© ¨ ­ ¨¡®«¼¸¨© ¨§ ¢µ®¤®¢ (¨ ¢»¤ ¥² ¨µ ­  ¢¥°µ­¨© ¨ ­¨¦­»©
¯°®¢®¤  ±®®²¢¥²±²¢¥­­®).
28.1-3
 °«±®­ £®¢®°¨²  «»¸³, ·²® ¢ ¯°®¨§¢®«¼­®¬ ¬¥±²¥ ±®°²¨°³¾¹¥© ±¥²¨ ¬®¦­® ¤®¡ ¢¨²¼ ª®¬¯ ° ²®° ¨ ±¥²¼ ®±² ­¥²±¿ ±®°²¨°³¾¹¥©. ®ª ¦¨²¥  «»¸³, ·²® ½²® ­¥ ² ª, ¤®¡ ¢¨¢ ª®¬¯ ° ²®° ¢
±¥²¼ °¨±. 28.2.
28.1-4
®ª ¦¨²¥, ·²® «¾¡ ¿ ±®°²¨°³¾¹ ¿ ±¥²¼ ± n ¢µ®¤ ¬¨ ¨¬¥¥² £«³¡¨­³ ­¥ ¬¥­¼¸¥, ·¥¬ lg n.
28.1-5
®ª ¦¨²¥, ·²® «¾¡ ¿ ±®°²¨°³¾¹ ¿ ±¥²¼ ±®¤¥°¦¨² ­¥ ¬¥­¥¥

(n lg n) ª®¬¯ ° ²®°®¢.
28.1-6
®ª ¦¨²¥, ·²® ±¥²¼ ­  °¨±³­ª¥ 28.3 ¿¢«¿¥²±¿ ±®°²¨°³¾¹¥©, ³±² ­®¢¨¢ ¥¥ °®¤±²¢® ±  «£®°¨²¬®¬ ±®°²¨°®¢ª¨ ¢±² ¢ª ¬¨ (±¬. ° §¤¥«
1.1).
28.1-7
C¥²¼ ª®¬¯ ° ²®°®¢ ± n ¢µ®¤ ¬¨ ¨ c ª®¬¯ ° ²®° ¬¨ ¯°¥¤±² ¢¨¬ 
¢ ¢¨¤¥ ³¯®°¿¤®·¥­­®£® ±¯¨±ª , ±®¤¥°¦ ¹¥£® c ¯ ° ­ ²³° «¼­»µ ·¨±¥« ®² 1 ¤® n.  °¥ (i; j ) ±®®²¢¥²±²¢³¥² ª®¬¯ ° ²®°, ±®¥¤¨­¿¾¹¨©
i-³¾ ¨ j -³¾ ¯°¿¬»¥. ¯¨±®ª ¯¥°¥·¨±«¿¥² ª®¬¯ ° ²®°» ±«¥¢  ­ ¯° ¢®. ±¯®«¼§³¿ ½²® ¯°¥¤±² ¢«¥­¨¥, ¯°¨¤³¬ ©²¥ (¯®±«¥¤®¢ ²¥«¼­»©)
 «£®°¨²¬, ª®²®°»© ­ µ®¤¨² £«³¡¨­³ ±¥²¨ §  ¢°¥¬¿ O(n + c).
28.1-8 ?
 ±¥²¨ ­¥ª®²®°»¥ ½«¥¬¥­²» ¿¢«¿¾²±¿ ¯¥°¥¢¥°­³²»¬¨ ª®¬¯ ° ²®° ¬¨, ¢»¤ ¾¹¨¬¨ ­  ¢¥°µ­¨© ¢»µ®¤ ¬ ª±¨¬ «¼­»© ¨§ ¢µ®¤®¢,  

596

« ¢  28 ®°²¨°³¾¹¨¥ ±¥²¨

­  ­¨¦­¨© | ¬¨­¨¬ «¼­»©.  ª ¯°¥®¡° §®¢ ²¼ ¥¥ ¢ ±¥²¼ ²®«¼ª®
¨§ ®¡»·­»µ ª®¬¯ ° ²®°®¢, ½ª¢¨¢ «¥­²­³¾ ¨±µ®¤­®©?

28.2. ° ¢¨«® ­³«¿ ¨ ¥¤¨­¨¶»
° ¢¨«® ­³«¿ ¨ ¥¤¨­¨¶» (zero-one principle) £®¢®°¨², ·²® ¥±«¨
±¥²¼ ª®¬¯ ° ²®°®¢ ³¯®°¿¤®·¨¢ ¥² «¾¡³¾ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ­³«¥© ¨ ¥¤¨­¨¶, ²® ¿¢«¿¥²±¿ ±®°²¨°³¾¹¥© (¨ ³¯®°¿¤®·¨¢ ¥² «¾¡³¾
¯®±«¥¤®¢ ²¥«¼­®±²¼ ·¨±¥« (¶¥«»µ, ¢¥¹¥±²¢¥­­»µ, ¨«¨ ¢®®¡¹¥ ½«¥¬¥­²®¢ ¯°®¨§¢®«¼­®£® «¨­¥©­® ³¯®°¿¤®·¥­­®£® ¬­®¦¥±²¢ ). ¥¬
± ¬»¬, ¦¥« ¿ ¤®ª § ²¼, ·²® ¯®±²°®¥­­ ¿ ­ ¬¨ ±¥²¼ ¿¢«¿¥²±¿ ±®°²¨°³¾¹¥©, ¬®¦­® ®£° ­¨·¨²¼±¿ ° ±±¬®²°¥­¨¥¬ ¢µ®¤®¢ ¨§ ­³«¥© ¨
¥¤¨­¨¶ | ¨­®£¤  ½²® ³¯°®¹ ¥² ¤¥«®.
®ª § ²¥«¼±²¢® ¨±¯®«¼§³¥² ¯®­¿²¨¥ ¬®­®²®­­® ¢®§° ±² ¾¹¥©
´³­ª¶¨¨ (±¬. ° §¤¥« 2.2).
¥¬¬  28.1 ±«¨ ±¥²¼ ª®¬¯ ° ²®°®¢ ¯°¥®¡° §³¥² ¯®±«¥¤®¢ ²¥«¼­®±²¼ a = ha1 ; a2; : : : ; an i ¢ ¯®±«¥¤®¢ ²¥«¼­®±²¼ b = hb1; b2; : : : ; bni,
  f | ¬®­®²®­­® ¢®§° ±² ¾¹ ¿ ´³­ª¶¨¿, ²® ¯®¤ ¢ ­  ¢µ®¤ ±¥²¨
¯®±«¥¤®¢ ²¥«¼­®±²¼ f (a) = hf (a1); f (a2); : : : ; f (an)i, ¬» ¯®«³·¨¬ ­ 
¢»µ®¤¥ f (b) = hf (b1); f (b2); : : : ; f (bn)i.
®ª § ²¥«¼±²¢®. °®¢¥°¨¬ ½²® ±­ · «  ¤«¿ ®¤­®£® ª®¬¯ ° ²®° ,
²® ¥±²¼ ¯®ª ¦¥¬, ·²® ª®¬¯ ° ²®°, ¯®«³·¨¢ ­  ¢µ®¤ f (x) ¨ f (y ),
¢»¤ ±² ­  ¢»µ®¤» f (min(x; y )) ¨ f (max(x; y )) (°¨±. 28.4).
® ®¯°¥¤¥«­¨¾, ­  ¢¥°µ­¥¬ ¢»µ®¤¥ ¡³¤¥² min(f (x); f (y )),   ­ 
­¨¦­¥¬ { max(f (x); f (y )). ±² ¥²±¿ § ¬¥²¨²¼, ·²® ¤«¿ ¢®§° ±² ¾¹¥© ´³­ª¶¨¨ f ¨§ x 6 y ±«¥¤³¥² f (x) 6 f (y ), ¨ ¯®½²®¬³

min(f (x); f (y )) = f (min(x; y ));
max(f (x); f (y )) = f (max(x; y )):
²  «¥¬¬  ¯®ª §»¢ ¥², ·²® ¥±«¨ ¯°¨¬¥­¨²¼ ª® ¢µ®¤­»¬ §­ ·¥­¨¿ ª®¬¯ ° ²®°  x ¨ y ¬®­®²®­­³¾ ´³­ª¶¨¾ f , ± ¥£® ¢»µ®¤­»¬¨
§­ ·¥­¨¿¬¨ ¯°®¨§®©¤¥² ²® ¦¥ ± ¬®¥.
²® ±¢®©±²¢® ¢¥°­® ­¥ ²®«¼ª® ¤«¿ ®¤­®£® ª®¬¯ ° ²®° , ­® ¨ ¤«¿
«¾¡®© ±¥²¨ ª®¬¯ ° ²®°®¢. ³±²¼ ­  ¢µ®¤» ±¥²¨ ¯®¤ ­» §­ ·¥­¨¿
a1; a2; : : : ; an . ¥°¥§ ­¥ª®²®°®¥ ¢°¥¬¿ ­  ¢±¥µ ¯°®¢®¤ µ (¢ ²®¬ ·¨±«¥
¢»µ®¤­»µ) ³±² ­®¢¿²±¿ ­¥ª®²®°»¥ §­ ·¥­¨¿. ¥¯¥°¼ § ¬¥­¨¬ ¢µ®¤» ­  f (a1 ); f (a2); : : : ; f (an ). ²® ±«³·¨²±¿ ±® §­ ·¥­¨¿¬¨ ­  ¯°®¢®¤ µ ±µ¥¬»?  ª ¬» ²®«¼ª® ·²® ¢¨¤¥«¨, ¢»µ®¤» ª®¬¯ ° ²®°®¢ £«³¡¨­» 1 ² ª¦¥ § ¬¥­¿²±¿ ­  °¥§³«¼² ² ¯°¨¬¥°¥­¨¿ ª ­¨¬ ´³­ª¶¨¨
f . «¥¤®¢ ²¥«¼­®, ± ¢»µ®¤ ¬¨ ª®¬¯ ° ²®°®¢ £«³¡¨­» 2 ¯°®¨§®©¤¥²
²® ¦¥ ± ¬®¥, ¨ ² ª ¤ «¥¥.  ±±³¦¤ ¿ ¯® ¨­¤³ª¶¨¨, ¬» ¢»¤¨¬,
¨±. 28.4

®¬¯ ° ²®° ¨ ¬®­®²®­­ ¿ ´³­ª¶¨¿ f («¥¬¬  28.1)

° ¢¨«® ­³«¿ ¨ ¥¤¨­¨¶»

597

(a) ®°²¨°³¾¹ ¿ ±¥²¼ °¨±³­ª  28.2 ¤«¿ ¢µ®¤®¢ h9; 5; 3; 6i. (b)  
¦¥ ±¥²¼ ¯®±«¥ ¯°¨¬¥­¥­¨¿ ¬®­®²®­­®© ´³­ª¶¨¨ f (x) = dx=2e ª® ¢±¥¬ ¢µ®¤ ¬.
­ ·¥­¨¥ ­  ª ¦¤®¬ ¯°®¢®¤¥ ¯®«³· ¥²±¿ ¯°¨¬¥­¥­¨¥¬ f ª ±² °®¬³ §­ ·¥­¨¾
­  ²®¬ ¦¥ ¯°®¢®¤¥.
¨±. 28.5

·²® ­  ¢»µ®¤ µ ±µ¥¬» ¯®¿¢¿²±¿ §­ ·¥­¨¿ f (b1); f (b2); : : : ; f (bn), £¤¥
b1; b2; : : : ; bn | ¯°¥¦­¨¥ ¢»µ®¤­»¥ §­ ·¥­¨¿. ¥¬¬  ¤®ª § ­ .
¨±³­®ª 28.5 ¨««¾±²°¨°³¥² ³²¢¥°¦¤¥­¨¥ «¥¬¬» 28.1 ¤«¿ ±®°²¨°³¾¹¥© ±¥²¨ °¨±. 28.2 ¨ ´³­ª¶¨¨ f (x) = dx=2e.  ±²¼ (a) ¯®ª §»¢ ¥² §­ ·¥­¨¿ ­  ¯°®¢®¤ µ ¤® ¯°¨¬¥­¥­¨¿ f (¤³¡«¨°³¿ °¨±. 28.2
(d),   · ±²¼ (b) | ¯®±«¥.
 ¯®¬®¹¼¾ «¥¬¬» 28.1 «¥£ª® ¤®ª § ²¼ ±«¥¤³¾¹¨© § ¬¥· ²¥«¼­»© °¥§³«¼² ².
¥®°¥¬  28.2 (° ¢¨«® ­³«¿ ¨ ¥¤¨­¨¶»)
±«¨ ±¥²¼ ª®¬¯ ° ²®°®¢ ± n ¢µ®¤ ¬¨ ¯° ¢¨«¼­® ³¯®°¿¤®·¨¢ ¥² ¢±¥ 2n ¢®§¬®¦­»µ ¯®±«¥¤®¢ ²¥«¼­®±²¥© ­³«¥© ¨ ¥¤¨­¨¶, ²® ®­ 
¿¢«¿¥²±¿ ±®°²¨°³¾¹¥©, ²® ¥±²¼ ¯° ¢¨«¼­® ³¯®°¿¤®·¨¢ ¥² «¾¡³¾
·¨±«®¢³¾ ¯®±«¥¤®¢ ²¥«¼­®±²¼.
®ª § ²¥«¼±²¢®.
³±²¼ ½²® ­¥ ² ª, ¨ ¥±²¼ ·¨±«®¢ ¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼
ha1; a2; : : : ; ani, ­  ª®²®°®© ±¥²¼ ®¸¨¡ ¥²±¿. ²® ®§­ · ¥², ·²®
¥±²¼ ½«¥¬¥­²» ai , aj , ¤«¿ ª®²®°»µ ai < aj ¨ aj ¯®¯ ¤ ¥² ¢ ¢»µ®¤­³¾ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ° ­¼¸¥ ai .  ¬ ­ ¤® ¯®ª § ²¼, ·²®
±³¹¥±²¢³¥² ¯®±«¥¤®¢ ²¥«¼­®±²¼ ­³«¥© ¨ ¥¤¨­¨¶, ­  ª®²®°®© ±¥²¼
° ¡®² ¥² ­¥¯° ¢¨«¼­®. «¿ ½²®£® ° ±±¬®²°¨¬ ¬®­®²®­­³¾ ´³­ª¶¨¾ ´³­ª¶¨¾ f :

x 6 ai ;
f (x) = 01;;¥±«¨
¥±«¨ x > a
i

°¨¬¥­¨¬ ¥¥ ª ¢µ®¤ ¬ ±¥²¨, ²® ¥±²¼ ¯®¤ ¤¨¬ ­  ¢µ®¤ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ­³«¥© ¨ ¥¤¨­¨¶ hf (a1 ); f (a2); : : : ; f (an )i. ®£« ±­® «¥¬¬¥
28.1 ª ¢»µ®¤­»¬ §­ ·¥­¨¿¬ ² ª¦¥ ¯°¨¬¥­¨²±¿ ´³­ª¶¨¿ f . °¨
½²®¬ f (aj ) ¡³¤¥² ±²®¿²¼ ­  ¬¥±²¥ aj , ²® ¥±²¼ ° ­¼¸¥ f (ai ). ®
f (aj ) = 1,   f (ai ) = 0. ¥®°¥¬  ¤®ª § ­ .
¯° ¦­¥­¨¿
28.2-1
® ¢±¥¬ ·«¥­ ¬ ³¯®°¿¤®·¥­­®© ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¯°¨¬¥­¨«¨
¬®­®²®­­® ¢®§° ±² ¾¹³¾ ´³­ª¶¨¾ f . ±² ­¥²±¿ «¨ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ³¯®°¿¤®·¥­­®©?
28.2-2
®ª ¦¨²¥, ·²® ±¥²¼ ª®¬¯ ° ²®°®¢ ± n ¢µ®¤ ¬¨ ¯° ¢¨«¼­® ³¯®°¿¤®·¨¢ ¥² ¯®±«¥¤®¢ ²¥«¼­®±²¼ hn; n ; 1; : : : ; 1i ²®£¤  ¨ ²®«¼ª® ²®£¤ ,
ª®£¤  ®­  ¯° ¢¨«¼­® ³¯®°¿¤®·¨¢ ¥² ¢±¥ n ; 1 ¯®±«¥¤®¢ ²¥«¼­®±²¥©
­³«¥© ¨ ¥¤¨­¨¶: h1; 0; : : : ; 0i, h1; 0; : : : ; 0i, : : : , h1; 1; : : : ; 1; 0i.
28.2-3
±¯®«¼§³¿ ¯° ¢¨«® ­³«¿ ¨ ¥¤¨­¨¶», ¤®ª ¦¨²¥, ·²® ±¥²¼ ª®¬¯ -

598

« ¢  28 ®°²¨°³¾¹¨¥ ±¥²¨
¨±. 28.6

®°²¨°³¾¹ ¿ ±¥²¼ ¤«¿ 4 ·¨±¥«

° ²®°®¢ ­  °¨±³­ª¥ 28.6 | ±®°²¨°³¾¹ ¿.
28.2-4
´®°¬³«¨°³©²¥ ¨ ¤®ª ¦¨²¥  ­ «®£ ¯° ¢¨«  ­³«¿ ¨ ¥¤¨­¨¶» ¤«¿
 «£®°¨²¬®¢ ±®°²¨°®¢ª¨ ¢ ¬®¤¥«¨ ° §°¥¸ ¾¹¨µ ¤¥°¥¢¼¥¢ (° §¤¥«
9.1). (ª § ­¨¥. ¥ § ¡³¤¼²¥ ¯°® ° ¢­»¥ ½«¥¬¥­²».)
28.2-5
®ª ¦¨²¥, ·²® ¤«¿ «¾¡®£® i = 1; 2; : : : ; n ; 1 ±®°²¨°³¾¹ ¿ ±¥²¼
®¡¿§ ­  ±®¤¥°¦ ²¼ µ®²¿ ¡» ®¤¨­ ª®¬¯ ° ²®°, ±®¥¤¨­¿¾¹¨© ¯°¿¬»¥ i ¨ i + 1.

28.3. ¨²®­¨·¥±ª¨© ±®°²¨°®¢¹¨ª
®±²°®¥­¨¥ ½´´¥ª²¨¢­®© ±®°²¨°³¾¹¥© ±¥²¨ ¬» ­ ·­¥¬ ± ² ª ­ §»¢ ¥¬®£® ¡¨²®­¨·¥±ª®£® ±®°²¨°®¢¹¨ª , ª®²®°»© ±®°²¨°³¥² ² ª
­ §»¢ ¥¬»¥ ¡¨²®­¨·¥±ª¨¥ ¯®±«¥¤®¢ ²¥«¼­®±²¨.
» ­ §»¢ ¥¬ ¡¨²®­¨·¥±ª®© (bitonic) «¾¡³¾ ¯®±«¥¤®¢ ²¥«¼­®±²¼, ª®²®° ¿ ±­ · «  ¢®§° ±² ¥²,   ¯®²®¬ ³¡»¢ ¥², ¨«¨ ¯®«³· ¥²±¿ ¨§ ² ª®© ¶¨ª«¨·¥±ª¨¬ ±¤¢¨£®¬. ±«¨ § ¯¨± ²¼ ½«¥¬¥­²»
¡¨²®­¨·¥±ª®© ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¯® ª°³£³, ²® ¬¨­¨¬ «¼­»©
¨ ¬ ª±¨¬ «¼­»© ¥¥ ½«¥¬¥­²» ¤¥«¿² ¯®±«¥¤®¢ ²¥«¼­®±²¼ ­  ¤¢ 
¬®­®²®­­»µ ³· ±²ª .
 ¯°¨¬¥°, ¯®±«¥¤®¢ ²¥«¼­®±²¨ h1; 4; 6; 8; 3; 2i, h6; 9; 4; 2; 3; 5i ¨
h9; 8; 3; 2; 4; 6i | ¡¨²®­¨·¥±ª¨¥. ¨²®­¨·¥±ª¨¥ ¯®±«¥¤®¢ ²¥«¼­®±²¼
­³«¥© ¨ ¥¤¨­¨¶ ¨¬¥¾² ¢¨¤ «¨¡® 1i 0j 1k , «¨¡® 0i 1j 0k , £¤¥ i; j; k > 0.
 ¯¨± ­­»¥ ¯® ª°³£³, ®­¨ ±®±²®¿² ¨§ ¤¢³µ £°³¯¯ | ¢ ®¤­®©
­³«¨, ¢ ¤°³£®© ¥¤¨­¨¶», ¨ £°³¯¯» ­¥ ±¬¥¸¨¢ ¾²±¿. ²¬¥²¨¬,
·²® ¬®­®²®­­»¥ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¿¢«¿¾²±¿ · ±²­»¬ ±«³· ¥¬
¡¨²®­¨·¥±ª¨µ.
 ½²®¬ ° §¤¥«¥ ¡³¤¥² ¯®±²°®¥­ ¡¨²®­¨·¥±ª¨© ±®°²¨°®¢¹¨ª |
±¥²¼ ª®¬¯ ° ²®°®¢, ¯° ¢¨«¼­® ±®°²¨°³¾¹ ¿ ¡¨²®­¨·¥±ª¨¥ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ­³«¥© ¨ ¥¤¨­¨¶.  ³¯° ¦­¥­¨¨ 28.3-6 ¬» ¯°¥¤«®¦¨¬
¢ ¬ ¯®ª § ²¼, ·²® ®­ £®¤¨²±¿ ¤«¿ ¯°®¨§¢®«¼­»µ ¡¨²®­¨·¥±ª¨µ ¯®±«¥¤®¢ ²¥«¼­®±²¥©.
®«³®·¨±²¨²¥«¼
¨²®­¨·¥±ª®£® ±®°²¨°®¢¹¨ª ±®±²®¨² ¨§ ­¥±ª®«¼ª¨µ · ±²¥© ° §­»µ ° §¬¥°®¢, ª®²®°»¥ ¬» ¡³¤¥¨ ­ §»¢ ²¼ À¯®«³®·¨±²¨²¥«¿¬¨Á
(half-cleaner). ®«³®·¨±²¨²¥«¼ ° §¬¥°  n ¥±²¼ ±¥²¼ £«³¡¨­» 1, ¢
ª®²®°®© ª®¬¯ ° ²®°» ±®¥¤¨­¿¾¨ ¯°®¢®¤  ®¤­®© ¯®«®¢¨­» ± ¯°®¢®¤ ¬¨ ¤°³£®© (i ¨ i + n=2 ±®¥¤¨­¥­» ¯°¨ i = 1; 2; : : : ; n=2; ¯°¥¤¯®« £ ¥²±¿, ·²® n ·¥²­®).   °¨±³­ª¥ 28.7 ¯®ª § ­ Half-Cleaner[8]
| ¯®«³®·¨±²¨²¥«¼ ° §¬¥°  8.

¨²®­¨·¥±ª¨© ±®°²¨°®¢¹¨ª

599

®«³®·¨±²¨²¥«¼ Half-Cleaner[8] ¨ ¤¢¥ ° §«¨·­»¥ ¢µ®¤­»¥ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ­³«¥© ¨ ¥¤¨­¨¶. ±«¨ ¢µ®¤­ ¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¿¢«¿¥²±¿ ¡¨²®­¨·¥±ª®© ¯®±«¥¤®¢ ²¥«¼­®±²¼¾ ­³«¥© ¨ ¥¤¨­¨¶, ²® ¯®±«¥ ¥¥ ®¡° ¡®²ª¨ «¾¡®©
½«¥¬¥­² ¢¥°µ­¥© ¯®«®¢¨­» ¢»µ®¤  ¬¥­¼¸¥ «¾¡®£® ½«¥¬¥­²  ­¨¦­¥© ¯®«®¢¨­»
(¨«¨ ° ¢¥­ ¥¬³); ®¤­  ¨§ ¯®«®¢¨­ | ¡¨²®­¨·¥±ª ¿,   ¤°³£ ¿ ±®±²®¨² ²®«¼ª® ¨§
­³«¥© ¨«¨ ²®«¼ª® ¨§ ¥¤¨­¨¶ (À·¨±² ¿Á).
¨±. 28.7

¥²»°¥ ¢®§¬®¦­®±²¨ ¯°¨ ° ¡®²¥ ±¥²¨ Half-Cleaner[n].   ¢µ®¤ ¯®¤ ¥²±¿ ¡¨²®­¨·¥±ª ¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ­³«¥© ¨ ¥¤¨­¨¶; ¬» ±·¨² ¥¬, ·²® ®­ 
¨¬¥¥² ¢¨¤ 00 : : : 011 : : : 100 : : : 0. ³«¥¢»¥ ³· ±²ª¨ ­  °¨±³­ª¥ ¡¥«»¥, ¥¤¨­¨·­»¥
| ±¥°»¥. µ®¤­ ¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ° §°¥§ ¥²±¿ ­  ¤¢¥ ¯®«®¢¨­», ª®²®°»¥
¯®·«¥­­® ±° ¢­¨¢ ¾²±¿. (a){(b) «³· ¨, ª®£¤  ²®·ª  ° §¤¥«  ¯®¯ ¤ ¥² ¢ ª³±®ª ¨§ ¥¤¨­¨¶. (c){(d) ®·ª  ° §¤¥«  ¯°®µ®¤¨² ¯® ­³«¥¢®¬³ ³· ±²ª³. ® ¢±¥µ
±«³· ¿µ ¢»¯®«­¥­» ³²¢¥°¦¤¥­¨¿ (1){(3) «¥¬¬» 28.3.
¨±. 28.8

±­®¢­®¥ ±¢®©±²¢® ¯®«³®·¨±²¨²¥«¿, ®¡º¿±­¿¾¹¥¥ ¥£® ­ §¢ ­¨¥,
² ª®¢®:
¥¬¬  28.3.
³±²¼ ­  ¢µ®¤ ¯®«³®·¨±²¨²¥«¾ ¯®¤ ­  ¡¨²®­¨·¥±ª ¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ­³«¥© ¨ ¥¤¨­¨¶. ®«³· ¾¹ ¿±¿ ¢»µ®¤­ ¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ®¡« ¤ ¥² ±«¥¤³¾¹¨¬¨ ±¢®©±²¢ ¬¨: (1) ¥¥ ¢¥°µ­¿¿ ¨ ­¨¦­¿¿
¯®«®¢¨­» { ¡¨²®­¨·¥±ª¨¥; (2) «¾¡®© ½«¥¬¥­² ¢¥°µ­¥© ¯®«®¢¨­»
¬¥­¼¸¥ «¾¡®£® ½«¥¬¥­²  ¨§ ­¨¦­¥© (¨«¨ ° ¢¥­ ¥¬³); (3) µ®²¿ ¡»
®¤­  ¨§ ¯®«®¢¨­ | ·¨±² ¿ (¨, ±«¥¤®¢ ²¥«¼­®, ¡¨²®­¨·¥±ª ¿)
®ª § ²¥«¼±²¢®. ³¤¥¬ ¯°¥¤¯®« £ ²¼, ·²® ¢µ®¤ ¨¬¥¥² ¢¨¤
00 : : : 011 : : : 100 : : : 0 (±«³· © 11 : : : 100 : : : 011 : : : 1 ±¨¬¬¥²°¨·¥­).
¥²¼ Half-Cleaner[n] ±° ¢­¨¢ ¥² ¢µ®¤ ai ±® ¢µ®¤®¬ ai+n=2 , ¯®½²®¬³ ¢®§¬®¦­» ²°¨ ° ±¯®«®¦¥­¨¿ ¡«®ª  ¥¤¨­¨¶ ®²­®±¨²¥«¼­®
±¥°¥¤¨­» ¯®±«¥¤®¢ ²¥«¼­®±²¨, ¯°¨·¥¬ ±«³· ©, ª®£¤  ±¥°¥¤¨­ 
¯°¨µ®¤¨²±¿ ­  ¡«®ª ¥¤¨­¨¶, ° ±¯ ¤ ¥²±¿ ­  ¤¢  ¯®¤±«³· ¿.  ª
¢¨¤­® ¨§ °¨±. 28.8, «¥¬¬  ±¯° ¢¥¤«¨¢  ¢® ¢±¥µ ·¥²»°¥µ ±«³· ¿µ.
¨²®­¨·¥±ª¨© ±®°²¨°®¢¹¨ª
¨²®­¨·¥±ª¨© ±®°²¨°®¢¹¨ª (bitonic sorter) °¥ª³°±¨¢­® ±²°®¨²±¿ ¨§ ¯®«³®·¨±²¨²¥«¥©, ª ª ¯®ª § ­® ­  °¨±. 28.9. ¥²¼ BitonicSorter[n] ±®±²®¨² ¨§ ¯®«³®·¨±²¨²¥«¿ Half-Cleaner[n] ¨ ¤¢³µ
½ª§¥¬¯«¿°®¢ ±¥²¨ Bitonic-Sorter[n=2]. ® «¥¬¬¥ 28.3 ¯®«³®·¨±²¨²¥«¼ ¤¥« ¥² ¨§ ¢µ®¤­®© ¡¨²®­¨·¥±ª®© ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¤¢¥ ¡¨²®­¨·¥±ª¨¥ ¯®±«¥¤®¢ ²¥«¼­®±²¨ (®¤­  ¨§ ­¨µ ·¨±² ¿) ¯®«®¢¨­­®£®
° §¬¥° . °¨ ½²®¬ «¾¡®© ½«¥¬¥­² ¢¥°µ­¥© ¬¥­¼¸¥ (¨«¨ ° ¢¥­) «¾¡®£® ½«¥¬¥­²  ¤°³£®©. ®±«¥ ½²®£® ®±² ¥²±¿ ³¯®°¿¤®·¨²¼ ª ¦¤³¾
¨§ ­¨µ ¯°¨ ¯®¬®¹¨ ±¥²¨ Bitonic-Sorter[n=2].   °¨±. 28.9(a) ¯®ª § ­ ®¡¹ ¿ ±²°³ª²³°  ±¥²¨,   ­  °¨±. 28.9(b) °¥ª³°±¨¿ ° §¢¥°­³² 
¤® ª®­¶ .  ª¨¬ ®¡° §®¬ ±²°®¨²±¿ ¡¨²®­¨·¥±ª¨© ±®°²¨°®¢¹¨ª ± n
¢µ®¤ ¬¨, £¤¥ n | ¯°®¨§¢®«¼­ ¿ ±²¥¯¥­¼ ¤¢®©ª¨.

600

« ¢  28 ®°²¨°³¾¹¨¥ ±¥²¨

«³¡¨­  D(n) ±¥²¨ Bitonic-Sorter[n] ¤ ¥²±¿ ±®®²­®¸¥­¨¥¬


¥±«¨ n = 1;
D(n=2) + 1; ¥±«¨ n = 2k ¨ k > 1:
¨§ ª®²®°®£® ¢¨¤­®, ·²® D(n) = lg n.

D(x) =

0;

» ¢¨¤¨¬, ·²® ¡¨²®­¨·¥±ª¨¥ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ­³«¥© ¨ ¥¤¨­¨¶
±®°²¨°³¾²±¿ ¯° ¢¨«¼­®, ®²ª³¤  ±«¥¤³¥² (¯° ¢¨«® ­³«¿ ¨ ¥¤¨­¨¶»
¤«¿ ¡¨²®­¨·¥±ª¨µ ¯®±«¥¤®¢ ²¥«¼­®±²¥©, ³¯° ¦­¥­¨¥ 28.3-6), ·²® ¨
«¾¡»¥ ¡¨²®­¨·¥±ª¨¥ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ±®°²¨°³¾²±¿ ¯° ¢¨«¼­®.
¯° ¦­¥­¨¿
28.3-1
ª®«¼ª® ¢±¥£® ±³¹¥±²¢³¥² ° «¨·­»µ ¡¨²®­¨·¥±ª¨µ ¯®±«¥¤®¢ ²¥«¼­®±²¥© ­³«¥© ¨ ¥¤¨­¨¶ ¤«¨­» n?
28.3-2
®ª ¦¨²¥, ·²® ±¥²¼ Bitonic-Sorter[n] ±®¤¥°¦¨² (n lg n) ª®¬¯ ° ²®°®¢ (­ ¯®¬­¨¬, ·²® n ¥±²¼ ±²¥¯¥­¼ ¤¢®©ª¨).
28.3-3
®±²°®©²¥ ¡¨²®­¨·¥±ª¨© ±®°²¨°®¢¹¨ª ± n ¢µ®¤ ¬¨ £«³¡¨­»
O(lg n) ¤«¿ ±«³· ¿, ª®£¤  n ­¥ ¿¢«¿¥²±¿ ±²¥¯¥­¼¾ ¤¢®©ª¨.
28.3-4
®«³®·¨±²¨²¥«¼ ¯®«³· ¥² ­  ¢µ®¤ ¯°®¨§¢®«¼­³¾ ¡¨²®­¨·¥±ª³¾
¯®±«¥¤®¢ ²¥«¼­®±²¼. ®ª ¦¨²¥, ·²® ¢¥°µ­¿¿ ¨ ­¨¦­¿¿ ¯®«®¢¨­»
¢»µ®¤­®© ¯®±«¥¤®¢ ²¥«¼­®±²¨ | ¡¨²®­¨·¥±ª¨¥,   «¾¡®© ½«¥¬¥­²
¢¥°µ­¥© ¯®«®¢¨­» ¬¥­¼¸¥ «¾¡®£® ½«¥¬¥­²  ­¨¦­¥© (¨«¨ ° ¢¥­
¥¬³).
28.3-5
 ­» ¤¢¥ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ­³«¥© ¨ ¥¤¨­¨¶ ¯°¨·¥¬ «¾¡®© ½«¥¬¥­² ¯¥°¢®© ¬¥­¼¸¥ «¾¡®£® ½«¥¬¥­²  ¢²®°®© ¨«¨ ° ¢¥­ ¥¬³. ®ª ¦¨²¥, ·²® µ®²¿ ¡» ®¤­  ¨§ ¯®±«¥¤®¢ ²¥«¼­®±²¥© | ·¨±² ¿.
28.3-6
®ª ¦¨²¥ ¯° ¢¨«® ­³«¿ ¨ ¥¤¨­¨¶» ¤«¿ ¡¨²®­¨·¥±ª¨µ ¯®±«¥¤®¢ ²¥«¼­®±²¥©: ¥±«¨ ±¥²¼ ª®¬¯ ° ²®°®¢ ³¯®°¿¤®·¨¢ ¥² ¢±¥ ¡¨²®­¨·¥±ª¨¥ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ­³«¥© ¨ ¥¤¨­¨¶, ²® ½²  ±¥²¼ ³¯®°¿¤®·¨¢ ¥² «¾¡³¾ ¡¨²®­¨·¥±ª³¾ ¯®±«¥¤®¢ ²¥«¼­®±²¼.

28.4. «¨¢ ¾¹ ¿ ±¥²¼
«¨¢ ¾¹¥© ±¥²¼¾ (merging network) ¬» ­ §»¢ ¥¬ ±¥²¼ ª®¬¯ ° ²®°®¢, ±®¥¤¨­¿¾¹ ¿ ¤¢¥ ³¯®°¿¤®·¥­»¥ ¯®±«¥¤®¢ ²¥«¼­®±²¨ (¯®«®¢¨­» ¢µ®¤­®© ¯®±«¥¤®¢ ²¥«¼­®±²¨) ¢ ®¤­³ ³¯®°¿¤®·¥­­³¾ ¯®±«¥¤®¢ ²¥«¼­®±²¼.  ª ¿ ±¥²¼ (¬» ­ §®¢¥¬ ¥¥ Merger[n]) «¥£ª® ¯®«³· ¥²±¿ ¬®¤¨´¨ª ¶¨¥© ±¥²¨ Bitonic-Sorter[n].
¤¥¿ ¯°®±² : ¤«¿ ±«¨¿­¨¿ ¤¢³µ ³¯®°¿¤®·¥­­»µ ¯®±«¥¤®¢ ²¥«¼­®±²¥© ¯°¨¯¨¸¥¬ (¢ ®¡° ²­®¬ ¯®°¿¤ª¥) ¢²®°³¾ ¯®±«¥¤®¢ ²¥«¼­®±²¼

«¨¢ ¾¹ ¿ ±¥²¼

601

¨±. 28.9 µ®¤­ ¿ · ±²¼ ±¥²¨ Merger[8] (a) ®²«¨· ¥²±¿ ®² ±¥²¨ HalfCleaner[8] (b) ²¥¬, ·²® ­¨¦­¨¥ 4 ¯°®¢®¤  ¯¥°¥¢¥°­³²». (a) µ®¤­ ¿ · ±²¼ ±¥²¨
Merger ¯°¥®¡° §³¥² ¤¢¥ ¢®§° ±² ¾¹¨¥ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ha1 ; a2 ; : : : ; an=2 i ¨
han=2+1 ; an=2+2 ; : : : ; an i ¢ ¤¢¥ ¡¨²®­¨·¥±ª¨¥ ¯®±«¥¤®¢ ²¥«¼­®±²¨ hb1 ; b2 ; : : : ; bn=2 i
¨ hbn=2+1 ; bn=2+2 ; : : : ; bn i. (b) ®² ¦¥ ¯°®¶¥±± ¢ ®¡®§­ ·¥­¨¿µ ¯®«³®·¨±²¨²¥«¿: ¡¨²®­¨·¥±ª ¿ ¢µ®¤­ ¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ha1 ; a2 ; : : : ; an=2 ; an=2+1 ; : : : ; an i
¯°¥®¡° §³¥²±¿ ¢ ¤¢¥ ¡¨²®­¨·¥±ª¨¥ ¯®±«¥¤®¢ ²¥«¼­®±²¨ hb1 ; b2 ; : : : ; bn=2 i ¨
hbn=2+1 ; bn=2+2 ; : : : ; bn i.

¥²¼ Merger[n] ±®¥¤¨­¿¥² ¤¢¥ ®²±®°²¨°®¢ ­­»¥ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¢ ®¤­³. ­  ¯®«³· ¥²±¿ ¨§ ±¥²¨ Bitonic-Sorter ¬®¤¨´¨ª ¶¨¥© ¯¥°¢®£®
ª ±ª ¤ : ²¥¯¥°¼ ±° ¢­¨¢ ¾²±¿ i-»¥ ± ­ · «  ¨ ª®­¶  ½«¥¬¥­²». (a) ¡¹ ¿ ±²°³ª²³°  ±¥²¨: ¯¥°¢»© ª ±ª ¤, § ²¥¬ ¤¢  ½ª§¥¬¯«¿°  ±¥²¨ Bitonic-Sorter[n=2]. (b)
®«­ ¿ ±µ¥¬  ±¥²¨ (±¥°»¥ ¯°¿¬®³£®«¼­¨ª¨ | ±²°³ª²³°­»¥ ½«¥¬¥­²», ­  °¥¡° µ
¯®ª § ­» §­ ·¥­¨¿ ¤«¿ ®¤­®£® ¨§ ¢®§¬®¦­»µ ¢µ®¤®¢).
¨±. 28.10

ª ª®­¶³ ¯¥°¢®©. °¨ ½²®¬ ¯®«³·¨²±¿ ¡¨²®­¨·¥±ª ¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼, ª®²®°³¾ ³¦¥ ¬®¦­® ³¯®°¿¤®·¨²¼ ± ¯®¬o¹¼¾ ¡¨²®­¨·¥±ª®£® ±®°²¨°®¢¹¨ª .  ¯°¨¬¥°, ¤«¿ ®¡º¥¤¨­¥­¨¿ X = 00000111 ¨
Y = 00001111 ¬» ¯°¨¯¨±»¢ ¥¬ ª X ¯¥°¥¢¥°­³²³¾ ¯®±«¥¤®¢ ²¥«¼­®±²¼ Y R = 11110000 ¨ ¯®«³· ¥¬ ¡¨²®­¨·¥±ª³¾ ¯®±«¥¤®¢ ²¥«¼­®±²¼ XY R = 0000011111110000. ±² «®±¼ ¯°¨¬¥­¨²¼ ª XY R ¡¨²®­¨·¥±ª¨© ±®°²¨°®¢¹¨ª.
«¥¤³¿ ½²®¬³ ¯« ­³, ¤«¿ ¯®±²°®¥­¨¿ ±¥²¨ Merger[n], ±«¨¢ ¾¹¥©
¯®±«¥¤®¢ ²¥«¼­®±²¨ ha1 ; : : : ; an=2i ¨ han=2+1; : : : ; ani, ±«¥¤³¥² ² ª ¯¥°¥±²°®¨²¼ ¯¥°¢»© ¯®«³®·¨±²¨²¥«¼ ±¥²¨ Bitonic-Sorter[n], ·²®¡» ¤®¡¨²¼±¿ §´´¥ª²  À¯¥°¥¢®° ·¨¢ ­¨¿Á ¢²®°®© ¯®±«¥¤®¢ ²¥«¼­®±²¨.  ®¡»·­®¬ ¯®«³®·¨±²¨²¥«¥ ¢µ®¤ ai ±° ¢­¨¢ ¥²±¿ ±® ¢µ®¤®¬
an=2+i , (¯°¨ i = 1; 2; : : : ; n=2), ¯®½²®¬³ ²¥¯¥°¼ ¬» ¡³¤¥¬ ai ±® ¢µ®¤®¬ an;i+1 .   °¨±. 28.10 ¯®ª § ­ ¯¥°¥±²°®¥­­»© ¯®«³®·¨±²¨²¥«¼
¢ ±° ¢­¥­¨¨ ± ®¡»·­»¬ | ° §­¨¶  ¢ ²®¬, ·²® ¯°®¢®¤  ¢ ­¨¦­¥©
¥£® ¯®«®¢¨­¥ ¯¥°¥±² ¢«¥­» ¢ ®¡° ²­®¬ ¯®°¿¤ª¥. °¨ ½²®¬ ¢¥°µ­¿¿
¨ ­¨¦­¿¿ ¯®«®¢¨­» ¢»µ®¤®¢ ¯®-¯°¥¦­¥¬³ ®¡« ¤ ¾² ±¢®©±²¢ ¬¨,
³ª § ­­»¬¨ ¢ «¥¬¬¥ 28.3 (¡¨²®­¨·¥±ª ¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼, § ¯¨± ­­ ¿ ¢ ®¡° ²­®¬ ¯®°¿¤ª¥, ®±² ¥²±¿ ¡¨²®­¨·¥±ª®©).
«¿ § ¢¥°¸¥­¨¿ ±«¨¿­¨¿ ®±² ¥²±¿ ³¯®°¿¤®·¨²¼ ®¡¥ ¯®«®¢¨­»
¯°¨ ¯®¬®¹¨ ¤¢³µ ª®¯¨© ±¥²¨ Bitonic-Sorter[n]. ®«³·¥­ ¿ ±¥²¼
Merger[n] ¯®ª § ­  ­  °¨±. 28.11. ¥ £«³¡¨­  ² ª ¿ ¦¥, ª ª ³ ±¥²¨
Bitonic-Sorter[n], ²® ¥±²¼ lg n.
¯° ¦­¥­¨¿
28.4-1
®ª ¦¨²¥ ±«¥¤³¾¹¨© ¢ °¨ ­² ¯° ¢¨«  ­³«¿ ¨ ¥¤¨­¨¶» ¤«¿ ±«¨¢ ¾¹¨µ ±¥²¥©: ¥±«¨ ±¥²¼ ª®¬¯ ° ²®°®¢ ¯° ¢¨«¼­® ±«¨¢ ¥² «¾¡»¥
¤¢¥ ¬®­®²®­­»¥ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ­³«¥© ¨ ¥¤¨­¨¶, ²® ®­  ¯° ¢¨«¼­® ±«¨¢ ¥² «¾¡»¥ ¬®­®²®­­»¥ ·¨±«®¢»¥ ¯®±«¥¤®¢ ²¥«¼­®±²¨.
28.4-2
ª®«¼ª® ²¥±²®¢»µ ¯®±«¥¤®¢ ²¥«¼­®±²¥© ­³«¥© ¨ ¥¤¨­¨¶ ­¥®¡-

602

« ¢  28 ®°²¨°³¾¹¨¥ ±¥²¨

µ®¤¨¬®, ·²®¡» ¯°®¢¥°¨²¼. ·²® ±¥²¼ ª®¬¯ ° ²®°®¢ ¤¥©±²¢¨²¥«¼­®
¿¢«¿¥²±¿ ±«¨¢ ¾¹¥©?
28.4-3
®ª ¦¨²¥, ·²® «¾¡ ¿ ±¥²¼ ª®¬¯ ° ²®°®¢, ³¬¥¾¹ ¿ ¯° ¢¨«¼­®
±«¨¢ ²¼ ®¤¨­ ½«¥¬¥­² (a1 ) ± ³¯®°¿¤®·¥­­®© ¯®±«¥¤®¢ ²¥«¼­®±²¼¾
¤«¨­» n ; 1 (a2; a3; : : : ; an) ¢ ³¯®°¿¤®·¥­­³¾ ¯®±«¥¤®¢ ²¥«¼­®±²¼
¤«¨­» n, ¨¬¥¥² £«³¡¨­³ ª ª ¬¨­¨¬³¬ lg n.
28.4-4*
³±²¼ ¤ ­  ±«¨¢ ¾¹ ¿ ±¥²¼ ±® ¢µ®¤ ¬¨ a1 ; : : : ; an , ª®²®° ¿
±«¨¢ ¥² ³¯®°¿¤®·¥­­»¥ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ha1; a3; : : : ; an;1i ¨
ha2; a4; : : : ; ani (¯°¥¤¯®« £ ¥¬, ·²® n | ±²¥¯¥­¼ ¤¢®©ª¨). ®ª ¦¨²¥, ·²® ² ª ¿ ±¥²¼ ±®¤¥°¦¨² 
(n lg n) ª®¬¯ ° ²®°®¢. ¥¬
¨­²¥°¥±­  ½²  ­¨¦­¿¿ ®¶¥­ª ?
(ª § ­¨¥.  §¡¥©²¥ ¬­®¦¥±²¢® ª®¬¯ ° ²®°®¢ ­  ²°¨ · ±²¨.)
[ ²® ½²® §  · ±²¨?  ª®¥ §­ ·¥­¨¥ ¢®®¡¹¥ ¨¬¥¥² ¯®°¿¤®ª ¢µ®¤®¢?  ª °¥¸ ¥²±¿ ½²®  § ¤ · ? ]
28.4-5*
®ª ¦¨²¥, ·²® «¾¡ ¿ ±¥²¼, ±«¨¢ ¾¹ ¿ ¤¢¥ ³¯®°¿¤®·¥­­»¥ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¤«¨­» n=2 ¢ ®¤­³ (° §°¥¸ ¥²±¿ ° ±¯°¥¤¥«¨²¼ ¢µ®¤» ¬¥¦¤³ ¯¥°¢®© ¨ ¢²®°®© ±«¨¢ ¥¬»¬¨ ¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¿¬¨
¯°®¨§¢®«¼­»¬ ®¡° §®¬) ±®¤¥°¦¨² O(n lg n) ª®¬¯ ° ²®°®¢.

28.5. ®°²¨°³¾¹ ¿ ±¥²¼
¥¯¥°¼ ¢±¥ £®²®¢® ¤«¿ ¯®±²°®¥­¨¿ ±®°²¨°³¾¹¥© ±¥²¨

Sorter[n]8, °¥ «¨§³¾¹¥©  «£®°¨²¬ ±®°²¨°®¢ª¨ ±«¨¿­¨¥¬ ¨§

° §¤¥«  1.3.1. ±²°®©±²¢® ±¥²¨ ¯®ª § ­® ­  °¨±³­ª¥ 28.12.
¥²¼ Sorter[n] ±²°®¨²±¿ °¥ª³°±¨¢­®: ¤¢¥ ¯®«®¢¨­» ¢µ®¤­®© ¯®±«¥¤®¢ ²¥«¼­®±²¨ ³¯®°¿¤®·¨¢ ¾²±¿ ±¥²¿¬¨ Sorter[n=2],   § ²¥¬
±®¥¤¨­¿¾²±¿ ¯°¨ ¯®¬®¹¨ ±¥²¨ Merger[n].  ª ·¥±²¢¥ Merger[2]
¨±¯®«¼§³¥²±¿ ª®¬¯ ° ²®°. µ¥¬  ¯®±²°®¥­¨¿ ¯®ª § ­  ­  °¨±. 28.12
(a), ­  °¨±. 28.12 (b) ®­  ° §¢¥°­³² ,   ­  °¨±. 28.12 (c) ¯®ª § ­®
¢­³²°¥­­¥¥ ³±²°®©±²¢® ±«¨¢ ¾¹¨µ ±¥²¥©.
 ª¨¬ ®¡° §®¬, ±¥²¼ Sorter[n] ±®±²®¨² ¨§ lg n ª ±ª ¤®¢. ¥°¢»©
¨§ ­¨µ ±®¤¥°¦¨² n=2 ª®¯¨© ±¥²¨ Merger[2] ¯ ° ««¥«¼­® ±«¨¢ ¾¹¨µ ¯ °» ®¤­®½«¥¬¥­²­»µ ¯®±«¥¤®¢ ²¥«¼­®±²¥©. ²®°®© ³°®¢¥­¼
±®±²®¨² ¨§ n=4 ½ª§¥¬¯«¿°®¢ ±¥²¨ Merger[4], ª®²®°»¥ ±«¨¢ ¾² ¯ °» ¯®«³·¥­»µ ­  ¯¥°¢®¬ ³°®¢­¥ ¤¢³µ½«¥¬¥­²­»µ ¯®±«¥¤®¢ ²¥«¼­®±²¥©, ¨ ². ¤.   k-®¬ ³°®¢­¥ (¯°¨ k = 1; 2; : : : ; lg n) ¨¬¥¥²±¿ n=2k
¥²¼ Sorter[n] ±²°®¨²±¿ °¥ª³°±¨¢® ¨§ ±«¨¢ ¾¹¨µ ±¥²¥©. (a) ¥ª³°±¨¢­®¥ ®¯¨± ­¨¥ ±¥²¨ Sorter[n]. (b) ¥ª³°±¨¿ ° §¢¥°­³² . (c) ®ª § ­® ¢­³²°¥­­¥¥ ±²°®¥­¨¥ ±«¨¢ ¾¹¨µ ±¥²¥©. ª § ­» £«³¡¨­» ¯°®¢®¤®¢ ¨ §­ ·¥­¨¿ ­ 
­¨µ (¤«¿ ®¤­®£® ¨§ ¢®§¬®¦­»µ ¢ °¨ ­²®¢ ¢µ®¤®¢).
¨±. 28.11

®°²¨°³¾¹ ¿ ±¥²¼

603

½ª§¥¬¯«¿°®¢ ±¥²¨ Merger[2k ], ±«¨¢ ¾¹¨µ ¯® ¤¢¥ ³¯®°¿¤®·¥­­»¥
¯®±«¥¤®¢ ²¥«¼­®±²¨ ¤«¨­» 2k;1 . ­¤³ª²¨¢­®¥ ¯®±²°®¥­¨¥ £ ° ­²¨°³¥², ·²® ±¥²¼ ¯° ¢¨«¼­® ³¯®°¿¤®·¨¢ ¥² ¯®±«¥¤®¢ ²¥«¼­®±²¨ ­³«¥© ¨ ¥¤¨­¨¶. § ¯° ¢¨«  ­³«¿ ¨ ¥¤¨­¨¶» (²¥®°¥¬  28.2) ±«¥¤³¥²
¯° ¢¨«¼­®±²¼ ° ¡®²» ±¥²¨ ­  ¯°®¨§¢®«¼­»µ ·¨±«®¢»µ ¯®±«¥¤®¢ ²¥«¼­®±²¿µ.
«³¡¨­  D(n) ±¥²¨ Sorter[n] ° ¢­  ±³¬¬¥ £«³¡¨­ ±¥²¥©
Sorter[n=2] ¨ Merger[n] (¤¢¥ ª®¯¨¨ ±¥²¨ Sorter[n=2] ° ¡®² ¾² ¯ ° ««¥«¼­®). «³¡¨­  ±¥²¨ Merger[n] ° ¢­  lg n, ² ª ·²®
°¥ª³°°¥­²­ ¿ ´®°¬³«  ¤«¿ D(n) ² ª®¢ :
(

D(x) =

0; ¥±«¨ n = 1;
D(n=2) + lg n; ¥±«¨ n = 2k ¨ k > 1:

§ ­¥¥ ±«¥¤³¥², ·²® D(n) = (lg2 n.
 ª¨¬ ®¡° §®¬, ¬®¦­® ±ª § ²¼, ·²® ¯ ° ««¥«¼­»©  «£®°¨²¬ ±®°²¨°®¢ª¨ ¬®¦¥² ³¯®°¿¤®·¨²¼ n ·¨±¥« §  ¢°¥¬¿ O(lg2 n), ¨±¯®«¼§³¿
±®°²¨°³¾¹¨¥ ±¥²¨ ª ª ¬®¤¥«¼ ¯ ° ««¥«¼­»µ ¢»·¨±«¥­¨©.
¯° ¦­¥­¨¿
28.5-1
ª®«¼ª® ª®¬¯ ° ²®°®¢ ±®¤¥°¦¨² ±¥²¼ Sorter[n]?
28.5-2
®ª ¦¨²¥, ·²® £«³¡¨­  ±¥²¨ Sorter[n] ¢ ²®·­®±²¨ ° ¢­ 
lg n(lg n + 1)=2. (¨±«® n ¥±²¼ ±²¥¯¥­¼ ¤¢®©ª¨.)
28.5-3
 ±±¬®²°¨¬ ª®¬¯ ° ²®°» ­®¢®£® ²¨¯ , ¯®«³· ¾¹¨¥ ­  ¤¢  ±¢®¨µ ¢µ®¤  ³¯®°¿¤®·¥­­»¥ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¤«¨­» k, ±®¥¤¨­¿¾¹¨¥ ¨µ ¢ ®¤­³ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¨ ¢»¤ ¾¹¨¥ ­  ¢¥°µ­¨© ¢»µ®¤
k ¬¥­¼¸¨µ ·¨±¥«,   ­  ­¨¦­¨© { k ¡®«¼¸¨µ ·¨±¥«. ( ª¨¬ ®¡° §®¬,
§­ ·¥­¨¿¬¨ ­  ¢µ®¤ µ ¨ ¢»µ®¤ µ ª®¬¯ ° ²®°®¢ ¿¢«¿¾²±¿ ³¯®°¿¤®·¥­­»¥ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ·¨±¥« ¤«¨­» k.) ®ª ¦¨²¥, ·²® «¾¡ ¿
±®°²¨°³¾¹ ¿ ±¥²¼ ± n ¢µ®¤ ¬¨ ¨ ¢»µ®¤ ¬¨ ¯®±«¥ § ¬¥­» ª®¬¯ ° ²®°®¢ ­  ª®¬¯ ° ²®°» ­®¢®£® ²¨¯  ¯°¥¢° ¹ ¥²±¿ ¢ ³±²°®©±²¢®,
±«¨¢ ¾¹¥¥ n ³¯®°¿¤®·¥­­»µ ¯®±«¥¤®¢ ²¥«¼­®±²¥© ¤«¨­» k ¢ ³¯®°¿¤®·¥­­³¾ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¤«¨­» nk (° §¡¨²³¾ ­  n · ±²¥©
¤«¨­» k).
28.5-4
³±²¼ ¤ ­» 2n ·¨±¥« ha1; : : : ; a2n i ¨ ²°¥¡³¥²±¿ ° §¤¥«¨²¼ ¨µ ­ 
n ¬¥­¼¸¨µ ¨ n ¡®«¼¸¨µ ·¨±¥« (¢­³²°¨ ½²¨µ ¤¢³µ £°³¯¯ ¯®°¿¤®ª
¬®¦¥² ¡»²¼ «¾¡»¬). ®ª ¦¨²¥, ·²® ½²® ¬®¦­® ±¤¥« ²¼ ± ¯®¬®¹¼¾ ±¥²¨ £«³¡¨­» O(1), ¥±«¨ ¨§¢¥±²­®, ·²® ¢µ®¤­ ¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ±®±²®¨² ¨§ ¤¢³µ ®²±®°²¨°®¢ ­­»µ ¯®«®¢¨­ a1; : : : ; an ¨
an1+1; : : : ; a2n.
28.5-5*
³±²¼ ¤ ­  ±®°²¨°³¾¹ ¿ ±¥²¼ ± k ¢µ®¤ ¬¨ £«³¡¨­» S (k),   ² ª¦¥ ±¥²¼ £«³¡¨­» M (k), ±«¨¢ ¾¹ ¿ ¤¢¥ ³¯®°¿¤®·¥­­»¥ ¯®±«¥¤®-

604

« ¢  28 ®°²¨°³¾¹¨¥ ±¥²¨

¢ ²¥«¼­®±²¨ ¤«¨­» k ¢ ®¤­³ ¤«¨­» 2k. ®±²°®©²¥ ±¥²¼ £«³¡¨­»
S (k) + 2M (k), ³¯®°¿¤®·¨¢ ¾¹³¾ ¢±¥ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¤«¨­» n,
¢ ª®²®°»µ ª ¦¤»© ½«¥¬¥­² ®²±²®¨² ­¥ ¤ «¥¥ ·¥¬ ­  k ¬¥±² ®² ±¢®¥£® ¯° ¢¨«¼­®£® ¯®«®¦¥­¨¿.
28.5-6*
 ¬ ²°¨¶¥© ° §¬¥°  m  m ¢»¯®«­¿¾² ² ª¨¥ ¤¥©±²¢¨¿:
1. ±¥ ­¥·¥²­»¥ ±²°®ª¨ ³¯®°¿¤®·¨¢ ¾² ¯® ¢®§° ±² ­¨¾.
2. ±¥ ­¥·¥²­»¥ ±²°®ª¨ ³¯®°¿¤®·¨¢ ¾² ¯® ³¡»¢ ­¨¾.
3. ¯®°¿¤®·¨²¼ ª ¦¤»© ±²®«¡¥¶ ¯® ¢®§° ±² ­¨¾.
 ª ¡³¤³² ®²±®°²¨°®¢ ­» ½«¥¬¥­²» ¬ ²°¨¶» ¯®±«¥ ¬­®£®ª° ²­»µ ¯®¢²®°¥­¨© ®¯¥° ¶¨¨ 1{3? ª®«¼ª® ¯®¢²®°¥­¨© ¯®²°¥¡³¥²±¿?
 ¤ ·¨
28.1 ®°²¨°®¢ª  ²° ­±¯®§¨¶¨¿¬¨.
®¢®°¿², ·²® ±®°²¨°³¾¹ ¿ ±¥²¼ ¨±¯®«¼§³¥² «¨¸¼ ²° ­±¯®§¨¶¨¨
(is a transposition network), ¥±«¨ ª ¦¤»© ¥¥ ª®¬¯ ° ²®° ±®¥¤¨­¿¥²
¤¢¥ ±®±¥¤­¨¥ ¯°¿¬»¥ (°¨±. 28.3)
a. ®ª ¦¨²¥, ·²® «¾¡ ¿ ² ª ¿ ±¥²¼ ±®¤¥°¦¨² 
(n2 ) ª®¬¯ ° ²®°®¢.
b. ²®¡» ³¡¥¤¨²¼±¿ ¢ ¯° ¢¨«¼­®±²¨ ° ¡®²» ² ª®© ±¥²¨, ¤®±² ²®·­® ¯°®¢¥°¨²¼, ·²® ®­  ¯° ¢¨«¼­®® ±®°²¨°³¥² ¯®±«¥¤®¢ ²¥«¼­®±²¼ hn; n ; 1; : : : ; 1i. (ª § ­¨¥: ­¤³ª²¨¢­®¥ ° ±±³¦¤¥­¨¥ ±«¥¤³¥² ¤®ª § ²¥«¼±²¢³ «¥¬¬» 28.1)
¥²­®-­¥·¥²­ ¿ ±®°²¨°³¾¹ ¿ ±¥²¼ (odd-even sorting network)
¤«¿ 8 ¢µ®¤®¢ ¯®ª § ­  ­  °¨±. 28.13.  ®¡¹¥¬ ±«³· ¥ ®­  ±®¤¥°¦¨²
n ³°®¢­¥© ª®¬¯ ° ²®°®¢: ¤«¿ i = 2; 3; : : :n ; 1 ¨ d = 1; 2; : : : ; n
¯°¿¬ ¿ ­®¬¥° i ­  £«³¡¨­¥ d ±®¥¤¨­¥­  ª®¬¯ ° ²®°®¬ ± ¯°¿¬®©
­®¬¥° i + (;1)i+d
c. ®ª ¦¨²¥, ·²® ¤¥©±²¢¨²¥«¼­® ¯®«³· ¥²±¿ ±®°²¨°³¾¹ ¿ ±¥²¼.
28.2 ¥²­®-­¥·¥²­®¥ ±«¨¿­¨¥ ¯® ½²·¥°³
 ° §¤¥«¥ 28.4 ±«¨¢ ¾¹ ¿ ±¥²¼ ±²°®¨« ±¼ ­  ®±­®¢¥ ¡¨²®­¨·¥±ª®£® ±®°²¨°®¢¹¨ª .  ½²®© § ¤ ·¥ ° ±±¬ ²°¨¢ ¥²±¿ ¤°³£®© ±¯®±®¡ ¥¥
¯®±²°®¥­¨¿ | ·¥²­®-­¥·¥²­ ¿ ±«¨¢ ¾¹ ¿ ±¥²¼ (odd-even merging
network). ³¤¥¬ ±·¨² ²¼, ·²® n | ±²¥¯¥­¼ ¤¢®©ª¨, ¨ ®¯¨¸¥¬ ±¥²¼,
±«¨¢ ¾¹³¾ ¤¢¥ ³¯®°¿¤®·¥­»¥ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ha1; : : : ; an i ¨
han+1; : : : ; a2ni ¢ ®¤­³. ²°®¨²±¿ ®­  °¥ª³°±¨¢­®. ®§¼¬¥¬ ¤¢¥ ±¥²¨ ¯®«®¢¨­­®£® ° §¬¥°  ¨ ¨±¯®«¼§³¥¬ ¨µ ¤«¿ ¯ ° ««¥«¼­®£® ±«¨¿­¨¿ ¤¢³µ ¯ ° ¯®±«¥¤®¢ ²¥«¼­®±²¥© ¤«¨­» n=2: ¯®±«¥¤®¢ ²¥«¼­®±²¼
ha1; a3 : : : ; an;1i ±«¨¢ ¥²±¿ ± han+1 ; an+3 : : : ; a2n;1i,   ha2; a4 : : : ; ani
| ± han+2 ; an+4 : : : ; a2ni.   ¯®±«¥¤­¥¬ ½² ¯¥ ±²®¿² n ª®¬¯ ° ²®°®¢, i-»© ¨§ ª®²®°»µ ±° ¢­¨¢ ¥² ·¨±«® ­  ¯°¿¬®© 2i ; 1 ± ·¨±«®¬
­  ¯°¿¬®© 2i.
a.  °¨±³©²¥ ² ª³¾ ±¥²¼ ¤«¿ n = 4.
b. ±¯®«¼§³¿ ¯° ¢¨«® ­³«¿ ¨ ¥¤¨­¨¶», ¤®ª ¦¨²¥ ¯° ¢¨«¼­®±²¼
° ¡®²» ¯®±²°®¥­­®© ±¥²¨ ¤«¿ ¯°®¨§¢®«¼­®£® n, ¿¢«¿¾¹¥£®±¿ ±²¥-

®°²¨°³¾¹ ¿ ±¥²¼

605

¯¥­¼¾ ¤¢®©ª¨.
c  ª®¢» ° §¬¥°» ¨ £«³¡¨­  ·¥²­®-­¥·¥²­®© ±«¨¢ ¾¹¥© ±¥²¨ ±
2n ¢µ®¤ ¬¨?
28.3 ¥²¨ ª®¬¬³² ²®°®¢
¥²¼ ª®¬¬³² ²®°®¢ (permutation network) ± n ¢µ®¤ ¬¨ ¨ n ¢»µ®¤ ¬¨ ±®±²®¨² ¨§ ¯°®¢®¤®¢ ¨ ¯¥°¥ª«¾· ²¥«¥©, ¯®§¢®«¿¾¹¨µ ±®¥¤¨­¿²¼ ¢µ®¤» ± ¢»µ®¤ ¬¨ ¢±¥¬¨ ¢®§¬®¦­»¬¨ n! ±¯®±®¡ ¬¨.  
°¨±. 28.14 (a) ¯®ª § ­  ±¥²¼ ª®¬¬³² ²®°®¢ P2 . ­  ±®±²®¨² ¨§ ¥¤¨­±²¢¥­­®£® ª®¬¬³² ²®° , ª®²®°»© ¨¬¥¥² ¤¢  ¯®«®¦¥­¨¥: ¯°¿¬®¥ ¨
¯¥°¥ª°¥±²­®¥.
a. ®ª ¦¨²¥, ·²® ¥±«¨ ¢ «¾¡®© ±®°²¨°³¾¹¥© ±¥²¨ ª®¬¯ ° ²®°»
§ ¬¥­¨²¼ ­  ª®¬¬³² ²®°», ²® ¯®«³· ¥²±¿ ±¥²¼, °¥ «¨§³¾¹ ¿ ¢±¥
¯¥°¥±² ­®¢ª¨: ¤«¿ «¾¡®© ¯¥°¥±² ­®¢ª¨  ¬®¦­® ³±² ­®¢¨²¼ ª®¬¬³² ²®°» ¢ ² ª¨¥ ¯®«®¦¥­¨¿, ·²® ¢µ®¤ i ±®¥¤¨­¥­ ± ¢»µ®¤®¬  (i),
¯°¨ ¢±¥µ i = 1; 2 : : : ; n.
  °¨±. 28.14 (b), ¯®ª § ­  ±¥²¼ ª®¬¬³² ²®°®¢ P8 ­  8 ¯®§¨¶¨©,
±®±² ¢«¥­­ ¿ ¨§ ¤¢³µ ±¥²¥© P4 ¨ ¢®±¼¬¨ ®²¤¥«¼­»µ ª®¬¬³² ²®°®¢.
  °¨±³­ª¥ ±¥²¼ °¥ «¨§³¥² ¯¥°¥±² ­®¢ª³  = h4; 7; 3; 5; 1; 6; 8; 2i,
¯°¨ ½²®¬ ¢¥°µ­¿¿ ±¥²¼ P4 °¥ «¨§³¥² ¯¥°¥±² ­®¢ª³ h4; 2; 3; 1i,   ­¨¦­¿¿ | h2; 3; 1; 4i.
b.  ª ª®¥ ±®±²®¿­¨¥ ­ ¤® ¯¥°¥¢¥±²¨ ª®¬¬³² ²®°» ¨ ª ª¨¥ ¯¥°¥±² ­®¢ª¨ ³±² ­®¢¨²¼ ¢ ¢¥°µ­¥© ¨ ­¨¦­¥© P4 -±¥²¿µ, ·²®¡» ±¥²¼
P8 °¥ «¨§®¢ «  ¯¥°¥±² ­®¢ª³ h5; 3; 4; 6; 1; 8; 2; 7i?
³±²¼ n | ±²¥¯¥­¼ ·¨±«  2.  ±±¬®²°¨¬ ±¥²¼ Pn , ¯®±²°®¥­­³¾
¨§ ¤¢³µ ±¥²¥© Pn=2 ¨ ®²¤¥«¼­»µ ª®¬¬³² ²®°®¢  ­ «®£¨·­® ±¥²¨ P8 .
c. ®ª ¦¨²¥, ·²® ±¥²¼ Pn ±¯®±®¡­  °¥ «¨§®¢ ²¼ «¾¡³¾ ¯¥°¥±² ­®¢ª³ ¨ ³ª ¦¨²¥  «£®°¨²¬, ª®²®°»© §  ¢°¥¬¿ O(n) (¢°¥¬¿ ¨§¬¥°¿¥²±¿ ®¡»·­»¬ ®¡° §®¬, ¤«¿ ¯®±«¥¤®¢ ²¥«¼­®© ¬ ¸¨­» ± ¯°®¨§¢®«¼­»¬ ¤®±²³¯®¬) ³ª §»¢ ¥² ¯®«®¦¥­¨¿ ª®¬¬³² ²®°®¢ ¨ ¯¥°¥±² ­®¢ª¨ ¤«¿ ¯®¤±¥²¥©, °¥ «¨§³¾¦¨¥ § ¤ ­­³¾ ¯¥°¥±² ­®¢ª³ ¤«¿
±¥²¨ Pn .
d.  ª®¢» £«³¡¨­  ¨ ° §¬¥° ±¥²¨ Pn ?  ©¤¨²¥ ®¡¹¥¥ ¢°¥¬¿, § 
ª®²®°®¥ ¯®±²°®¥­­»© ¢ ¯³­ª²¥ b  «£®°¨²¬ ° ±±·¨² ¥² ¯®«®¦¥­¨¿
ª®¬¬³² ²®°®¢, ¢ª«¾· ¿ ª®¬¬³² ²®°» ¤«¿ ¯®¤±¥²¥© ­¨¦­¨µ ³°®¢­¥©.
e. ®ª ¦¨²¥, ·²® «¾¡ ¿ ±¥²¼ ª®¬¬³² ²®°®¢ ± n ¢µ®¤ ¬¨, °¥ «¨§³¾¹ ¿ ¢±¥ ¯¥°¥±² ­®¢ª¨, ­¥¨§¡¥¦­® °¥ «¨§³¥² ª ª³¾-²® ¯¥°¥±² ­®¢ª³ ¯® ª° ©­¥© ¬¥°¥ ¤¢³¬¿ ±¯®±®¡ ¬¨.
 ¬¥·¥­¨¿
­³²[123] ®¡±³¦¤ ¥² ±¢®©±²¢  ±®°²¨°³¾¹¨µ ±¥²¥© ¨ ¨µ ¨±²®°¨¾.
¨¤¨¬®, ¨µ ¢¯¥°¢»¥ ° ±±¬®²°¥«¨ °¬±²°®­£ (P.N. Armstrong), ¥«¼±®­ (R.J. Nelson) ¨ ®­­®° (D.J.O'Connor) ¢ 1954 £®¤³.  ­ · «¥
1960-µ £®¤®¢ ½²·¥° (K.E. Batcher) ¯°¨¤³¬ « ±¥²¼, ±«¨¢ ¾¹³¾ ¤¢¥
·¨±«®¢»¥ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¤«¨­» n §  ¢°¥¬¿ O(lg n), ¨±¯®«¼§³¿
·¥²­®-­¥·¥²­®¥ ±«¨­¨¥ (§ ¤ ·  28.2). ­ ² ª¦¥ ¯®ª § «, ª ª ± ¯®¬®¹¼¾ ² ª¨µ ±¥²¥© ³¯®°¿¤®·¨²¼ n ·¨±¥« §  ¢°¥¬¿ O(lg2 n). ³²¼ ¯®§-

606

« ¢  28 ®°²¨°³¾¹¨¥ ±¥²¨

¦¥ ½²·¥° ¯°¨¤³¬ « ¡¨²®­¨·¥±ª¨© ±®°²¨°®¢¹¨ª £«³¡¨­» O(lg n),
 ­ «®£¨·­³¾ ®¯¨± ­­®¬³ ¢ ° §¤¥«¥ 28.3. ®£« ±­® ­³²³, ¯° ¢¨«®
­³«¿ ¨ ¥¤¨­¨¶» ­³² ¤®ª § « ³°¨¶¨© (W.G. Bouricius, 1954) ¢
ª®­²¥ª±²¥ ° §°¥¸ ¾¹¨µ ¤¥°¥¢¼¥¢.
®«£®¥ ¢°¥¬¿ ®±² ¢ «±¿ ®²ª°»²»¬ ¢®¯°®± ® ±³¹¥±²¢°¢ ­¨¨ ±®°²¨°³¾¹¥© ±¥²¨ £«³¡¨­» O(lg n).  1983 £®¤³ ­  ­¥£® ¡»« ¤ ­ ¯®«®¦¨²¥«¼­»© ®²¢¥²: ©² ©, ®¬«®± ¨ ¥¬¥°¥¤¨ [8] ¯®±²°®¨«¨ ±®°²¨°³¾¹³¾ ±¥²¼ ¤«¿ n ·¨±¥« £«³¡¨­» O(lg n) ¨§ O(n lg n) ª®¬¯ ° ²®°®¢.  ±®¦ «¥­¨¾, ª®­±² ­²» ¢ ½²®© O(n)-®¶¥­ª¥ (¬­®£¨¥ ²»±¿·¨,
¥±«¨ ­¥ ¡®«¼¸¥) ¯°¥¯¿²±²¢³¾² ¯° ª²¨·¥±ª®¬³ ¨±¯®«¼§®¢ ­¨¾ ½²®©
±¥²¨.

29

°¨´¬¥²¨·¥±ª¨¥ ±µ¥¬»

® ±¨µ ¯®°, £®¢®°¿ ® ¢°¥¬¥­¨ ° ¡®²»  «£®°¨²¬ , ¬» ±·¨² «¨, ·²®
 °¨´¬¥²¨·¥±ª¨¥ ®¯¥° ¶¨¨ (±«®¦¥­¨¥, ¢»·¨² ­¨¥, ³¬­®¦¥­¨¥ ¨ ¤¥«¥­¨¥) ¢»¯®«­¿¾²±¿ §  ¯®±²®¿­­®¥ ¢°¥¬¿, ­¥ § ¢¨±¿¹¥¥ ®² ° §¬¥° 
·¨±¥«.  ª®¥ ¯°¨¡«¨¦¥­¨¥ ° §³¬­® ± ²®·ª¨ §°¥­¨¿ ¯° ª²¨ª¨, ¯®±ª®«¼ª³ ¤«¿ ·¨±¥«, ¯®¬¥¹ ¾¹¨µ±¿ ¢ ° §°¿¤­³¾ ±¥²ª³ ª®¬¯¼¾²¥° ,
½²¨ ¢°¥¬¥­  ­¥ ² ª ³¦ ±¨«¼­® ° §«¨· ¾²±¿. ® ¯°¨  «£®°¨²¬¨·¥±ª®© °¥ «¨§ ¶¨¨ ½²¨µ ®¯¥° ¶¨© ¬» ¢¨¤¨¬, ·²® ¢°¥¬¿ ° ¡®²» § ¢¨±¨² ®² ° §¬¥°  ¢µ®¤®¢. ª ¦¥¬, ¸ª®«¼­»©  «£®°¨²¬ ±«®¦¥­¨¿
¤¢³µ n-§­ ·­»µ ·¨±¥« ¢ ¤¥±¿²¨·­®© ±¨±²¥¬¥ ²°¥¡³¥² (n) ½«¥¬¥­² °­»µ ¤¥©±²¢¨©.
 ½²®© £« ¢¥ ° ±±¬ ²°¨¢ ¾²±¿ ±µ¥¬» ¤«¿  °¨´¬¥²¨·¥±ª¨µ ¤¥©±²¢¨©. °¨ ¯®±«¥¤®¢ ²¥«¼­®© °¥ «¨§ ¶¨¨ «¾¡®¥ ¤¥©±²¢¨¥ ± ¤¢³¬¿
n-° §°¿¤­»¬¨ ·¨±« ¬¨ ²°¥¡³¥² 
(n) ¡¨²®¢»µ ®¯¥° ¶¨© (§  ¬¥­¼¸¥¥ ¢°¥¬¿ ¬» ¤ ¦¥ ­¥ ¯°®·²¥¬ ¢µ®¤»). ¬¥­¼¸¥­¨¿ ¢°¥¬¥­¨ ¬®¦­® ¤®±²¨·¼ ¯°¨ ¨±¯®«¼§®¢ ­¨¨ ±µ¥¬, ½«¥¬¥­²» ª®²®°»µ ° ¡®² ¾²
¯ ° ««¥«¼­®.  ½²®© £« ¢¥ ¬» ¯®±²°®¨¬ ² ª¨¥ ±µ¥¬» ¤«¿ ±«®¦¥­¨¿ ¨ ³¬­®¦¥­¨¿ (¢»·¨² ­¨¥  ­ «®£¨·­® ±«®¦¥­¨¾; ¯® ¯®¢®¤³ ¤¥«¥­¨¿ ±¬. § ¤ ·³ 29.1). °¥¤¯®« £ ¥²±¿, ·²® ­  ¢µ®¤» ¯®±²³¯ ¾²
n-§­ ·­»¥ ·¨±«  ¢ ¤¢®¨·­®© ±¨±²¥¬¥.
» ­ ·­¥¬ ¢ ° §¤¥«¥ 29.1 c ®¯°¥¤¥«¥­¨¿ ¨ ¯°¨¬¥°®¢ ±µ¥¬ ¨§
´³­ª¶¨®­ «¼­»µ ½«¥¬¥­²®¢; ¢°¥¬¿ ° ¡®²» ¡³¤¥² ®¯°¥¤¥«¿²¼±¿ £«³¡¨­®© ±µ¥¬».  ¸¨¬ ¯¥°¢»¬ ¯°¨¬¥°®¬ ¡³¤¥² ±³¬¬ ²®° | ¡ §®¢»© ½«¥¬¥­² ¤«¿ ª®­±²°³ª¶¨© ½²®© £« ¢».  §¤¥« 29.2 ¯®±¢¿¹¥­
¤¢³¬ ±µ¥¬ ¬ ¤«¿ ±«®¦¥­¨¿: ±µ¥¬¥ ª ±ª ¤­®£® ±«®¦¥­¨¿ (¢°¥¬¿ ° ¡®²» (n)) ¨ ±µ¥¬¥ ±«®¦¥­¨¿ ± ¯°¥¤¢»·¨±«¥­¨¥¬ ¯¥°¥­®±®¢, (¢°¥¬¿
O(lg n)).  ¬ ¦¥ ° ±±¬®²°¥­  ±µ¥¬  ±«®¦¥­¨¿ ± § ¯®¬¨­ ­¨¥¬ ¯¥°¥­®±®¢, ¯®§¢®«¿¾¹ ¿ ±¢¥±²¨ (§  ¢°¥¬¿ (1)) ±«®¦¥­¨¥ ²°¥µ ·¨±¥«
ª ±«®¦¥­¨¾ ¤¢³µ.  ° §¤¥«¥ 29.3 ±²°®¿²±¿ ¤¢¥ ±µ¥¬» ¤«¿ ³¬­®¦¥­¨¿: ¬ ²°¨·­»© ³¬­®¦¨²¥«¼ (¢°¥¬¿ ° ¡®²» (n)) ¨ ³¬­®¦¨²¥«¼ ±
¯®¬®¹¼¾ ¤¥°¥¢  Wallace'a (¢°¥¬¿ (lg n)).  ª®­¥¶, ¢ ° §¤¥«¥ 29.4
° ±±ª § ­® ® ±µ¥¬ µ ± ½«¥¬¥­² ¬¨ § ¤¥°¦ª¨, ª®²®°»¥ ¯®§¢®«¿¾²
¬­®£®ª° ²­® ¨±¯®«¼§®¢ ²¼ ®¤­¨ ¨ ²¥ ¦¥ ´³­ª¶¨®­ «¼­»¥ ½«¥¬¥­²» (¨ ²¥¬ ± ¬»¬ ³¬¥­¼¸¨²¼ ®¡¹¥¥ ª®«¨·¥±²¢® ½«¥¬¥­²®¢ ¢ ±µ¥¬¥).

608

« ¢  29 °¨´¬¥²¨·¥±ª¨¥ ±µ¥¬»

29.1. µ¥¬» ¨§ ´³­ª¶¨®­ «¼­»µ ½«¥¬¥­²®¢
 ª ¨ ±®°²¨°³¾¹¨¥ ±¥²¨ ¢ £« ¢¥ 28, ±µ¥¬» ¨§ ´³­ª¶¨®­ «¼­»µ
½«¥¬¥­²®¢ ¿¢«¿¾²±¿ ¯ ° ««¥«¼­®© ¬®¤¥«¼¾ ¢»·¨±«¥­¨©: ­¥±ª®«¼ª® ½«¥¬¥­²®¢ ±µ¥¬» ¬®£³² ° ¡®² ²¼ ®¤­®¢°¥¬¥­­®.  ½²®¬ ° §¤¥«¥
¬» ¤ ¤¨¬ ®¯°¥¤¥«¥­¨¥ ±µ¥¬» ¨§ ´³­ª¶¨®­ «¼­»µ ½«¥¬¥­²®¢ ¨ ¯°¨¢¥¤¥¬ ¯°¨¬¥°».
29.1.1. ³­ª¶¨®­ «¼­»¥ ½«¥¬¥­²»
°¨¨´¬¥²¨·¥±ª¨¥ ±µ¥¬» ±²°®¿²±¿ ¨§ ´³­ª¶¨®­ «¼­»µ ½«¥¬¥­²®¢, ±®¥¤¨­¥­­»µ ¯°®¢®¤­¨ª ¬¨. ³­ª¶¨®­ «¼­»© ½«¥¬¥­² (combinational element) ¨¬¥¥² ¢µ®¤» ¨ ¢»µ®¤»; ¥£® ¢»µ®¤­®© ±¨£­ «
¿¢«¿¥²±¿ ´³­ª¶¨¥© ¢µ®¤­»µ. ±«¨ ¢µ®¤­»¥ ¨ ¢»µ®¤­»¥ §­ ·¥­¨¿
¿¢«¿¾²±¿ ­³«¿¬¨ ¨ ¥¤¨­¨¶ ¬¨, ½«¥¬¥­² ­ §»¢ ¥²±¿ «®£¨·¥±ª¨¬
(boolean combinational element, logic gate); ª ª ®¡»·­®, 0 ®¡®§­ · ¥² À«®¦¼Á,   1 | À¨±²¨­³Á .
¥²»°¥ ®±­®¢­»µ «®£¨·¥±ª¨µ ½«¥¬¥­² , ¨±¯®«¼§³¥¬»¥ ¢ ½²®© £« ¢¥, ¯®ª § ­» ­  °¨±. 29.1 : NOT (®²°¨¶ ­¨¥), AND («®£¨·¥±ª®¥
), OR («®£¨·¥±ª®¥ ) ¨ XOR (¨±ª«¾· ¾¹¥¥ ); ¥¹¥ ¤¢  |
NAND ¨ NOR | ¨±¯®«¼§³¾²±¿ ¢ ­¥ª®²®°»µ ³¯° ¦­¥­¨¿µ). «¥¬¥­² NOT ¨¬¥¥² ®¤¨­ ¢µ®¤ x, ­  ª®²®°»© ¯®¤ ¥²±¿ 0 ¨«¨ 1, ¨ ®¤¨­
¢»µ®¤ z , §­ ·¥­¨¥ ­  ª®²®°®¬ ¯°®²¨¢®¯®«®¦­® §­ ·¥­¨¾ ­  ¢µ®¤¥.
±² «¼­»¥ ²°¨ ½«¥¬¥­²  ¨¬¥¾² ¯® ¤¢  ¢µ®¤  (x ¨ y ) ¨ ¯® ®¤­®¬³
¢»µ®¤³ (z ).
29.1 ¥±²¼ ®±­®¢­»µ «®£¨·¥±ª¨µ ½«¥¬¥­²®¢ ¨ ±®®²¢¥²±²¢³¾¹¨¥ ² ¡«¨¶». (a) «¥¬¥­² NOT. (b) «¥¬¥­² AND. (c) «¥¬¥­² OR. (d) «¥¬¥­² XOR.
(e) «¥¬¥­² NAND (Not-AND). (e) «¥¬¥­² NOR (Not-OR).
¨±. 29.1

 ¡®²  ½«¥¬¥­²  (ª ª ¨ «¾¡®© ±µ¥¬», ±®±² ¢«¥­­®© ¨§ ­¨µ) ¬®¦¥² ¡»²¼ ®¯¨± ­  ² ¡«¨¶¥©, ª®²®° ¿ ³ª §»¢ ¥² ¢»µ®¤­»¥ §­ ·¥­¨¿
¤«¿ ¢±¥µ ­ ¡®°®¢ §­ ·¥­¨© ­  ¢µ®¤ µ.  ¯°¨¬¥°, ¨§ ² ¡«¨¶» ¤«¿
XOR ¢¨¤­®, ·²® ¢µ®¤» x = 0 ¨ y = 1 ¤ ¾² ­  ¢»µ®¤¥ z = 1. «¿
®¡®§­ ·¥­¨¿ ®¯¥° ¶¨¨ NOT ²° ¤¨¶¨®­­® ¨±¯®«¼§³¥²±¿ ±¨¬¢®« :,
¤«¿ AND { ±¨¬¢®« ^, ¤«¿ OR { ±¨¬¢®« _,   ¤«¿ XOR { ±¨¬¢®« .
 ¯°¨¬¥°, 0  1 = 1.
¥ «¼­»¥ ´³­ª¶¨®­ «¼­»¥ ½«¥¬¥­²» ° ¡®² ¾² ­¥ ¬£­®¢¥­­®.
° ¢¨«¼­®¥ §­ ·¥­¨¥ ­  ¢»µ®¤¥ ¯®¿¢«¿¥²±¿ «¨¸¼ ·¥°¥§ ­¥ª®²®°®¥
¢°¥¬¿ ¯®±«¥ ²®£®, ª ª §­ ·¥­¨¿ ­  ¢µ®¤ µ ³±² ­®¢¿²±¿. ²® ¢°¥¬¿
­ §»¢ ¥²±¿ § ¤¥°¦ª®© (propagation delay). » ¯°¥¤¯®« £ ¥¬, ·²®
§ ¤¥°¦ª  ®¤­  ¨ ²  ¦¥ ¤«¿ ¢±¥µ ½«¥¬¥­²®¢.

µ¥¬» ¨§ ´³­ª¶¨®­ «¼­»µ ½«¥¬¥­²®¢

609

29.1.2. µ¥¬» ¨§ ´³­ª¶¨®­ «¼­»µ ½«¥¬¥­²®¢
» ° ±±¬ ²°¨¢ ¥¬ ±µ¥¬» ¨§ ´³­ª¶¨®­ «¼­»µ ½«¥¬¥­²®¢ (combinational circuits), ±®¥¤¨­¥­­»µ ¯°®¢®¤ ¬¨ (wires). °¨ ½²®¬ ­¥
¤®«¦­® ®¡° §®¢»¢ ²¼±¿ ¶¨ª«®¢ (±¬. ­¨¦¥). °®¢®¤ ±®¥¤¨­¿¥² ¢»µ®¤ ®¤­®£® ½«¥¬¥­²  ±® ¢µ®¤®¬ ¤°³£®£®; ¢»µ®¤­®¥ §­ ·¥­¨¿ ¯¥°¢®£®
½«¥¬¥­²  ¨±¯®«¼§³¥²±¿ ¢²®°»¬ ª ª ¢µ®¤­®¥. °®¢®¤ ¤®«¦¥­ ¡»²¼
¯®¤ª«¾·¥­ ­¥ ¡®«¥¥ ·¥¬ ª ª ®¤­®¬³ ¢»µ®¤³, ­® ¬®¦¥² ±®¥¤¨­¿²¼
¥£® ±° §³ ± ­¥±ª®«¼ª¨¬¨ ¢µ®¤ ¬¨. ¨±«® ¢µ®¤®¢ ½«¥¬¥­²®¢, ¯®¤±®¥¤¨­¥­­»µ ª ¤ ­­®¬³ ¯°®¢®¤³, ­ §»¢ ¥²±¿ ¥£® ¢»µ®¤­®© ±²¥¯¥­¼¾
(fan-out). ±«¨ ¯°®¢®¤ ­¥ ¯®¤±®¥¤¨­¥­ ª ¢»µ®¤ ¬ ½«¥¬¥­²®¢, ²®
®­ ¿¢«¿¥²±¿ ¢µ®¤®¬ ±µ¥¬», ¯®«³· ¿ §­ ·¥­¨¥ ¨§¢­¥. ±«¨ ¯°®¢®¤
­¥ ¯®¤ª«¾·¥­ ª ¢µ®¤ ¬ ½«¥¬¥­²®¢, ²® ®­ ¿¢«¿¥²±¿ ¢»µ®¤®¬ ±µ¥¬» ¨ ¢»¤ ¥² ­ °³¦³ °¥§³«¼² ² ° ¡®²» ±µ¥¬» (¢­³²°¥­­¨© ¯°®¢®¤
² ª¦¥ ¬®¦¥², ° §¢¥²¢«¿¿±¼, ±«³¦¨²¼ ¢»µ®¤®¬ ±µ¥¬»). µ¥¬» ­¥
±®¤¥°¦ ² ¶¨ª«®¢ (¶¨ª« ¯®¿¢«¿¥²±¿, ¥±«¨ ¢»µ®¤ ½«¥¬¥­²  ¿¢«¿¥²±¿
¢µ®¤®¬ ¢²®°®£®, ¢»µ®¤ ¢²®°®£® { ¢µ®¤®¬ ²°¥²¼¥£®, : : : , ­ ª®­¥¶,
¢»µ®¤ n-£® { ¢µ®¤®¬ ¯¥°¢®£®). ­¨ ² ª¦¥ ­¥ ±®¤¥°¦ ² ½«¥¬¥­²®¢
§ ¤¥°¦ª¨ (¥±«¨ ½²® ­¥ ®£®¢®°¥­® ±¯¥¶¨ «¼­® | ±¬. ° §¤¥« 29.4).
29.1.3. ³¬¬ ²®°
  °¨±. 29.2 ¨§®¡° ¦¥­ ±³¬¬ ²®° (full adder), ­  ¢µ®¤» x, y ¨ z
ª®²®°®£® ¯®±²³¯ ¾² ²°¨ ¡¨² . ­ ·¥­¨¿ ­  ¢»µ®¤ µ c ¨ s ¤ ¾²±¿
² ¡«¨¶¥©

x y z c s

0 0 0 0 0
0 0 1 0 1
0 1 0 0 1
0 1 1 1 0
1 0 0 0 1
1 0 1 1 0
1 1 0 1 0
1 1 1 1 1
°³£¨¬¨ ±«®¢ ¬¨, s ¥±²¼ ´³­ª¶¨¿ ·¥²­®±²¨ (parity) ¢µ®¤­»µ
 °£³¬¥­²®¢:
s = parity(x; y; z) = x  y  z
(29.1)
  c { ´³­ª¶¨¿ ¡®«¼¸¨­±²¢  (majority):
c = majority(x; y; z) = (x ^ y) _ (y ^ z ) _ (x ^ z)
(29.2)
³­ª¶¨¨ ·¥²­®±²¨ ¨ ¡®«¼¸¨­±²¢  ¨¬¥¾² ±¬»±« ¤«¿ «¾¡®£® ·¨±«   °£³¬¥­²®¢: ´³­ª¶¨¿ À·¥²­®±²¼Á ° ¢­  1, ª®£¤  ±°¥¤¨ ¥¥  °£³¬¥­²®¢ ­¥·¥²­®¥ ·¨±«® ¥¤¨­¨¶,   ´³­ª¶¨¿ À¡®«¼¸¨­±²¢®Á | ª®£¤ 
¡®«¥¥ ¯®«®¢¨­» ¥¥  °£³¬¥­²®¢ ° ¢­» 1.

610

« ¢  29 °¨´¬¥²¨·¥±ª¨¥ ±µ¥¬»

 ¬¥²¼²¥, ·²® ¢ ±®¢®ª³¯­®±²¨ ¡¨²» c ¨ s ¤ ¾² ¤¢®¨·­³¾ § ¯¨±¼
±³¬¬» x + y + z .  ¯°¨¬¥°, ¥±«¨ x = 1, y = 0 ¨ z = 1, ²® hc; si = h10i,
  x + y + z = 2 = 102.
³¬¬ ²®°. (a)  ¬®¬¥­² 0 ¡¨²» ¯®±²³¯ ¾² ­  ¢µ®¤. (b) ¥°¥§ ¥¤¨­¨¶³ ¢°¥¬¥­¨ ¯®¿¢«¿¾²±¿ §­ ·¥­¨¿ ­  ¢»µ®¤ µ ½«¥¬¥­²®¢ A-D £«³¡¨­» 1. (±)
¹¥ ·¥°¥§ ¥¤¨­¨¶³ ¢°¥¬­¨ ¯®¿¢«¿¾²±¿ §­ ·¥­¨¿ ­  ¢»µ®¤ µ ½«¥¬¥­²®¢ E ¨
F £«³¡¨­» 2. (d) ¹¥ ·¥°¥§ ¥¤¨­¨¶³ ¢°¥¬¥­¨ (¬®¬¥­² ¢°¥¬¥­¨ 3) ­  ¢»µ®¤¥
½«¥¬¥­²  G ¯®¿¢«¿¥²±¿ °¥§³«¼² ² ° ¡®²» ¢±¥© ±µ¥¬».
¨±. 29.2

«¥¬¥­²» A ¨ E ¬®¦­® § ¬¥­¨²¼ ­  ®¤¨­ ½«¥¬¥­² XOR ± ²°¥¬¿
¢µ®¤ ¬¨   ½«¥¬¥­²» F ¨ G | ­  ®¤¨­ ½«¥¬¥­² OR ± ²°¥¬¿ ¢µ®¤ ¬¨.
¨±«® ¢µ®¤®¢ ½«¥¬¥­²  ­ §»¢ ¾² ¥£® ¢µ®¤­®© ±²¥¯¥­¼¾ (fan-in).
³¤¥¬ ±·¨² ²¼, ·²® ª ¦¤»© ½«¥¬¥­² ¨¬¥¥² ¥¤¨­¨·­³¾ § ¤¥°¦ª³,   ¢µ®¤­»¥ §­ ·¥­¨¿ ¯®±²³¯ ¾² ¢ ¬®¬¥­² 0 (°¨±. 29.2, a).  ½²®£®
¬®¬¥­²  ¢µ®¤» ½«¥¬¥­²®¢ A-D (¨ ²®«¼ª® ¨µ) ±² ¡¨«¼­» ¢ ½²®² ¬®¬¥­², ¯®½²®¬³ ± ¬®¬¥­²  1 ¨µ ¢»µ®¤­»¥ §­ ·¥­¨¿ ±² ¡¨«¼­» (°¨±.
29.2, b). ¥¬ ± ¬»¬ ½«¥¬¥­²» A{D ° ¡®² ¾² ¯ ° ««¥«¼­®.  ¬®¬¥­²  1 ¢µ®¤­»¥ §­ ·¥­¨¿ ³ E ¨ F (­® ­¥ ³ G!) ±² ¡¨«¼­», ¯®½²®¬³
± ¬®¬¥­²  2 ±² ¡¨«¼­» ¨µ ¢»µ®¤­»¥ §­ ¥­¨¿ (°¨±. 29.2, c), ¢ ²®¬
·¨±«¥ ¢»µ®¤­®© ¡¨² s. ¤­ ª® ¡¨² c ¥¹¥ ­¥ ¯®«³·¥­ | ½«¥¬¥­² G
¨¬¥¥² ±² ¡¨«¼­»¥ ¢µ®¤» ± ¬®¬¥­²  2 ¨ ¢»¤ ¥² c ¢ ¬®¬¥­² 3 (°¨±.
29.2, d).
29.1.4. «³¡¨­  ±µ¥¬»
 ª ¨ ¢ ±«³· ¥ ±®°²¨°³¾¹¨µ ±¥²¥© ¢ £« ¢¥ 28, § ¤¥°¦ª  ±µ¥¬» ®¯°¥¤¥«¿¥²±¿ ­ ¨¡®«¼¸¨¬ ª®«¨·¥±²¢®¬ ½«¥¬¥­²®¢ ­  ¯³²¿µ ®²
¢µ®¤®¢ ±µ¥¬» ª ¢»µ®¤ ¬. ²  µ ° ª²¥°¨±²¨ª  ±µ¥¬» ­ §»¢ ¥²±¿
¥¥ £«³¡¨­®© (depth) ¨ ®¯°¥¤¥«¿¥² ¢°¥¬¿ ¥¥ ° ¡®²». ® ®¯°¥¤¥«¥­¨¾ ¢µ®¤» ±µ¥¬» ¨¬¥¾² £«³¡¨­³ 0,   ¢»µ®¤­»¥ ¯°®¢®¤  ½«¥¬¥­² 
±® ¢µ®¤ ¬¨ £«³¡¨­» d1 ; : : : ; dn ¨¬¥¾² £«³¡¨­³ maxfd1 ; : : : ; dng + 1.
®±ª®«¼ª³ ¢ ±µ¥¬¥ ­¥² ¶¨ª«®¢, ½²® ¨­¤³ª²¨¢­®¥ ®¯°¥¤¥«¥­¨¥ ª®°°¥ª²­®. «³¡¨­®© ½«¥¬¥­²  ­ §»¢ ¥²±¿ £«³¡¨­  ¥£® ¢»µ®¤®¢,   £«³¡¨­®© ±µ¥¬» { ­ ¨¡®«¼¸ ¿ £«³¡¨­  ±®±² ¢«¿¾¹¨µ ¥¥ ½«¥¬¥­²®¢.
±«¨ ¢±¥ ´³­ª¶¨®­ «¼­»¥ ½«¥¬¥­²» ¯°®¨§¢®¤¿² ¤¥©±²¢¨¥ §  ®¤­®
¨ ²® ¦¥ ¢°¥¬¿ t, ²® ¢°¥¬¿ ° ¡®²» ±µ¥¬» £«³¡¨­» d ­¥ ¯°¥¢®±µ®¤¨²
dt.   °¨±. 29.2 ³ª § ­  £«³¡¨­  ¢±¥µ ½«¥¬¥­²®¢ ±³¬¬ ²®° . ®±ª®«¼ª³ ­ ¨¡®«¼¸³¾ £«³¡¨­³ (3) ¨¬¥¥² ½«¥¬¥­² G, £«³¡¨­  ±µ¥¬»
² ª¦¥ ° ¢­  3.
­®£¤  ±µ¥¬  ¬®¦¥² ° ¡®² ²¼ ­¥±ª®«¼ª® ¡»±²°¥¥.  ¯°¨¬¥°, ¥±«¨ ­  ®¤¨­ ¨§ ¢µ®¤®¢ ½«¥¬¥­²  AND ¯®¤ ­ 0, ²® ­  ¢»µ®¤¥ ¯®¿¢¨²±¿
0, ¤ ¦¥ ¥±«¨ ¢²®°®¥ ¢µ®¤­®¥ §­ ·¥­¨¥ ¡³¤¥² ¢±¥ ¥¹¥ ¬¥­¿²¼±¿. ¤­ ª® ­  ¯° ª²¨ª¥ ¢°¥¬¿ ° ¡®²» ±µ¥¬» · ¹¥ ¢±¥£® ¯°®¯®°¶¨®­ «¼­®
£«³¡¨­¥.

Cµ¥¬» ¤«¿ ±«®¦¥­¨¿

611

29.1.5.  §¬¥° ±µ¥¬»
°¨ ° §° ¡®²ª¥ ±µ¥¬», °¥ «¨§³¾¹¥© ¤ ­­³¾ ´³­ª¶¨¾, ±² ° ¾²±¿ ³¬¥­¼¸¨²¼ ­¥ ²®«¼ª® ¥¥ £«³¡¨­³, ­® ¨ ° §¬¥° (size) | ·¨±«®
´³­ª¶¨®­ «¼­»µ ½«¥¬¥­²®¢.  ¯°¨¬¥°, ®¯¨± ­­»© ¢»¸¥ ±³¬¬ ²®°
¨¬¥¥² ° §¬¥° 7.
³±²¼ § ¤ ­  ­¥ª®²®° ¿ ´³­ª¶¨¿, ¨ ¬» µ®²¨¬ °¥ «¨§®¢ ²¼ ¥¥
±µ¥¬®© ­ ¨¬¥­¼¸¥£® ° §¬¥° . ²®¡» ½²®² ¢®¯°®± ¨¬¥« ±¬»±«, ­ ¤® ¤®£®¢®°¨²¼±¿, ª ª¨¥ ½«¥¬¥­²» ° §°¥¸¥­® ¨±¯®«¼§®¢ ²¼ | ¢ ¯°®²¨¢­®¬ ±«³· ¥ ¬®¦­® ±·¨² ²¼, ·²® ±µ¥¬  ±®±²®¨² ¨§ ¥¤¨­±²¢¥­­®£® ½«¥¬¥­² , °¥ «¨§³¾¹¥£® ²°¥¡³¥¬³¾ ´³­ª¶¨¾.  ª¨¨¬ ®¡° §®¬,
¬¨­¨¬ «¼­»© ° §¬¥° ±µ¥¬» § ¢¨±¨² ®² ­ ¡®°  ° §°¥¸¥­­»µ ½«¥¬¥­²®¢.
¤­ ª® ¥±«¨ ­ ± ¨­²¥°¥±³¥² ­¥ ®¤­  ±µ¥¬ ,   ±¥¬¥©²¢® ®¤­®²¨¯­»µ ±µ¥¬ (­ ¯°¨¬¥°, ¬» ±²°®¨¬ ±³¬¬ ²®° n-° §°¿¤­»µ ·¨±¥«
¤«¿ «¾¡®£® n), ³¢¥«¨·¥­¨¥ ­ ¡®°  ° §°¥¸¥­­»µ ½«¥¬¥­²®¢ (¥±«¨ ®­
®±² ¥²±¿ ª®­¥·­»¬) ³¬¥­¼¸ ¥² ° §¬¥° ±µ¥¬» ¢±¥£® «¨¸¼ ¢ ª®­±² ­²³ ° § ¯® ±° ¢­¥­¨¾ ± ¡ §®¢»¬ ­ ¡®°®¬ (AND, OR, NOT), ¯®±ª®«¼ª³ ¢±¥ ° §°¥¸¥­­»¥ ½«¥¬¥­²» ¬®¦­® ±®±² ¢¨²¼ ¨§ ¡ §®¢»µ.
29.1.6. ¯° ¦­¥­¨¿
29.1-1.  ª ¨§¬¥­¿²±¿ §­ ·¥­¨¿ ­  °¨±. 29.2 (a){(d), ¥±«¨ x = 1,

y = 1, z = 1?

29.1-2. ®±²°®©²¥ ¨§ n ; 1 ½«¥¬¥­²  XOR ±µ¥¬³ ¤«¿ ´³­ª¶¨¨
À·¥²­®±²¼Á ± n ¢µ®¤ ¬¨, £«³¡¨­  ª®²®°®© ­¥ ¯°¥¢®±µ®¤¨² dlg ne.
29.1-3. ®ª ¦¨²¥, ·²® ¤«¿ «¾¡®© ² ¡«¨¶» §­ ·¥­¨© ±®®²¢¥²±²¢³¾¹¨© «®£¨·¥±ª¨© ½«¥¬¥­² ¬®¦­® °¥ «¨§®¢ ²¼ ±µ¥¬®© ¨§ ½«¥¬¥­²®¢
AND, OR ¨ NOT.
29.1-4. ®ª ¦¨²¥, ·²® ¢ ¯°¥¤»¤³¹¥© § ¤ ·¥ ¬®¦­® ®¡®©²¨±¼
²®«¼ª® ½«¥¬¥­² ¬¨ ²¨¯  NAND.
29.1-5. ®±²°®©²¥ ±µ¥¬³ ¤«¿ ´³­ª¶¨¨ XOR ¨§ ·¥²»°¥µ ½«¥¬¥­²®¢
NAND.
29.1-6. ³±²¼ ±µ¥¬  C ¨¬¥¥² n ¢µ®¤®¢, n ¢»µ®¤®¢ ¨ £«³¡¨­³ d.
®¥¤¨­¨¬ ¤¢  ½ª§¥¬¯«¿°  C , ¯°¨±®¥¤¨­¨¢ ¢»µ®¤» ¯¥°¢®£® ª® ¢µ®¤ ¬ ¢²®°®£®.  ª®¢  ¬®¦¥² ¡»²¼ £«³¡¨­  ² ª®© ±µ¥¬»? (ª ¦¨²¥
­ ¨¡®«¼¸¥¥ ¨ ­ ¨¬¥­¼¸¥¥ ¢®§¬®¦­»¥ §­ ·¥­¨¿.)

29.2. Cµ¥¬» ¤«¿ ±«®¦¥­¨¿
 ½²®¬ ° §¤¥«¥ ¯°¨¢¥¤¥­» ²°¨ ±µ¥¬» ¤«¿ ±«®¦¥­¨¿ n-¡¨²®¢»µ
¤¢®¨·­»µ ·¨±¥«.  ±ª ¤­®¥ ±«®¦¥­¨¥ (ripple-carry addition) ¯®§¢®«¿¥² ±«®¦¨²¼ ¤¢  n-§­ ·­»µ ·¨±«  §  ¢°¥¬¿ (n) ± ¯®¬®¹¼¾ ±µ¥¬» ° §¬¥°  (n). °¥¬¿ ¬®¦­® ³¬¥­¼¸¨²¼ ¤® O(lg n), ¨±¯®«¼§³¿

612

« ¢  29 °¨´¬¥²¨·¥±ª¨¥ ±µ¥¬»

±«®¦¥­¨¥ ± ¯°¥¤¢»·¨±«¥­¨¥¬ ¯¥°¥­®±®¢ (carry-lookahead addition),
¯°¨·¥¬ ±®®²¢¥²±²¢³¾¹ ¿ ±µ¥¬  ² ª¦¥ ¨¬¥¥² ° §¬¥° (n).  ª®­¥¶, ±«®¦¥­¨¥ ± § ¯®¬¨­ ­¨¥¬ ¯¥°¥­®±®¢ (carry-save addition) § 
¢°¥¬¿ O(1) ±¢®¤¨² ±«®¦¥­¨¥ ²°¥µ n-° §°¿¤­»µ ·¨±¥« ª ±«®¦¥­¨¾
n-° §°¿¤­®£® ¨ (n + 1)-° §°¿¤­®£® ·¨±¥«. µ¥¬  ² ª¦¥ ¨¬¥¥² ° §¬¥° (n).
29.2.1.  ±ª ¤­®¥ ±«®¦¥­¨¥
¥®²°¨¶ ²¥«¼­®¥ ¶¥«®¥ ·¨±«® a § ¯¨±»¢ ¥²±¿ ¢ ¤¢®¨·­®© ±¨±²¥¬¥
ª ª ¯®±«¥¤®¢ ²¥«¼­®±²¼¾ n ¡¨²®¢ han;1 ; an;2 ; : : : ; a0i, ¯°¨·¥¬ n >
dlg(a + 1)e ¨

a=

nX
;1
i=0

ai 2i :

°¨ ±«®¦¥­¨¨ ¯® ¤¢³¬ n-§­ ·­»¬ ·¨±« ¬ a = han;1 ; an;2 ; : : : ; a0i
¨ b = hbn;1 ; bn;2 ; : : : ; b0i ±²°®¨²±¿ (n + 1)-§­ ·­®¥ ·¨±«® s =
hsn; sn;2 ; : : : ; s0i, ° ¢­®¥ ¨µ ±³¬¬¥ (¯°¨¬¥° ­  °¨±. 29.3).
¨±. 29.3 29.3 °¨ ±«®¦¥­¨¨ 8-§­ ·­»µ ·¨±¥« a = h01011110i ¨ b = h11010101i
¯®«³· ¥²±¿ 9-§­ ·­®¥ ·¨±«® s = h100110011i .  i-¬ ±²®«¡¶¥ ³ª § ­» i-¥ ° §°¿¤»
·¨±¥« a, b ¨ s,   ² ª¦¥ ¡¨² ¯¥°¥­®±  ci . µ®¤­®© ¡¨² ¯¥°¥­®±  c0 ¢±¥£¤  ° ¢¥­
0.

°¨ ±«®¦¥­¨¨ ±²®«¡¨ª®¬ (±¯° ¢  ­ «¥¢®) ¬» ±ª« ¤»¢ ¥¬ ¢ i-¬
° §°¿¤¥ ai , bi ¨ ¢µ®¤­®© ¡¨² ¯¥°¥­®±  (carry-in bit) ci . « ¤¸¨©
° §°¿¤ ±³¬¬» § ¯¨±»¢ ¥²±¿ ¢ i-»© ° §°¿¤ ®²¢¥²  (si ),   ±² °¸¨©
±² ­®¢¨²±¿ ¢»µ®¤­»¬ ¡¨²®¬ ¯¥°¥­®±  (carry-out bit) ci+1 ¨ ¨±¯®«¼§³¥²±¿ ¯°¨ ±«®¦¥­¨¨ ¢ ±«¥¤³¾¹¥¬ ° §°¿¤¥.  ¬« ¤¸¨© ° §°¿¤ ­¨·¥£® ­¥ ¯¥°¥­®±¨²±¿, ¯®½²®¬³ c0 = 0. ®±«¥¤­¨© ¯¥°¥­®± cn ±² ­®¢¨²±¿ ±² °¸¨¬ ° §°¿¤®¬ ±³¬¬» sn . ®±ª®«¼ª³ si = parity(ai ; bi; ci),
  ci+1 = majority(ai ; bi; ci), ¤«¿ ª ¦¤®£® ¸ £  ¬®¦­® £®¤¨²±¿ ®¯¨± ­­»© ¢»¸¥ ±³¬¬ ²®°.
 ª¨¬ ®¡° §®¬, n-° §°¿¤­»© ª ±ª ¤­»© ±³¬¬ ²®° ±®±²®¨² ¨§ ¯®±«¥¤®¢ ²¥«¼­® ±®¥¤¨­¥­­»µ ¯°®±²»µ ±³¬¬ ²®°®¢
FA0; FA1; : : : ; FAn;1, ² ª ·²® ¢»µ®¤ ci+1 ±³¬¬ ²®°  FAi ¿¢«¿¥²±¿ ¢µ®¤®¬ ¤«¿ FAi+1 .   ¢µ®¤¥ c0 ´¨ª±¨°®¢ ­® §­ ·¥­¨¥ 0, ­¥
§ ¢¨±¿¹¥¥ ®² ¢µ®¤®¢ (±¬. °¨±. 29.4).
 ±ª ¤­»© ±³¬¬ ²®° ¤«¿ n = 8. ®¬¡¨ª ±¯° ¢  ®§­ · ¥², ·²® §­ ·¥­¨¥ ­  ¢µ®¤¥ ´¨ª±¨°®¢ ­®.
¨±. 29.4

®±ª®«¼ª³ ¡¨² ¯¥°¥­®±  ¯°®µ®¤¨² ·¥°¥§ ¢±¥ ±³¬¬ ²®°», £«³¡¨­ 
ª ±ª ¤­®£® ±³¬¬ ²®°  ° ¢­  n (  £«³¡¨­  ½«¥¬¥­²  FAi ° ¢­  i+1).
®½²®¬³ ¢°¥¬¿ ° ¡®²» ±®±² ¢«¿¥² (n).  §¬¥° ±µ¥¬» ° ¢¥­ (n).

Cµ¥¬» ¤«¿ ±«®¦¥­¨¿

613

29.2.2. «®¦¥­¨¥ ± ¯°¥¤¢»·¨±«¥­¨¥¬ ¯¥°¥­®±®¢
 ª ±ª ¤­®¬ ±³¬¬ ²®°¥ ¡¨² ¯¥°¥­®±  ci ¢»·¨±«¿¥²±¿ ¢ ¬®¬¥­²
¢°¥¬¥­¨ i. ­ ·¥­¨¿ ai ¨ bi , ®¤­ ª®, ¨§¢¥±²­» ± ± ¬®£® ­ · « . 
­¥ª®²®°»µ ±«³· ¿µ ®­¨ ®¯°¥¤¥«¿¾² ¡¨² ¯¥°¥­®±  ci :
 ¥±«¨ ai = bi = 0, ²® ci = 0 (¯¥°¥­®± À¯®£«®¹ ¥²±¿Á(kill))
 ¥±«¨ ai = bi = 1, ²® ci = 1 (¯¥°¥­®± À¯®°®¦¤ ¥²±¿Á(generate))
¤­ ª® ¥±«¨ ®¤¨­ ¨§ ¡¨²®¢ ai ¨ bi ° ¢¥­ 1,   ¤°³£®© 0, ­® ci;1
±³¹¥±²¢¥­; ¨¬¥­­®,
 ¥±«¨ ai 6= bi, ²® ci = ci;1 (¯¥°¥­®± ° ±¯°®±²° ­¿¥²±¿ (propagate))
 ¦¤®¬³ ° §°¿¤³, ±«¥¤®¢ ²¥«¼­®, ±®®²¢¥²±²¢³¥² ®¤¨­ ¨§ ²°¥µ
²¨¯®¢ ¯¥°¥­®±  (carry statuses): k, (kill), g (generate) ¨«¨ p (propagate) (±¬. °¨±. 29.5). ²®² ²¨¯ ¨§¢¥±²¥­ § ° ­¥¥, ·²® ¯®§¢®«¿¥²
³¬¥­¼¸¨²¼ ¢°¥¬¿ ° ¡®²» ±µ¥¬» ±«®¦¥­¨¿.
»µ®¤­®© ¡¨² ¯¥°¥­®±  ¨ ²¨¯ ¯¥°¥­®±  ±³¬¬ ²®°  FAi;1 ¢ § ¢¨±¨¬®±²¨ ®² ai ¨ bi .

¨±. 29.5

­ ¿ ²¨¯» ¯¥°¥­®±  ¤«¿ ±®±¥¤­¨µ ±³¬¬ ²®°®¢ ((i ; 1)-£® ¨ i-£®),
¬®¦­® ®¯°¥¤¥«¨²¼ ²¨¯ ¯¥°¥­®±  ¤«¿ ¨µ ±®¥¤¨­¥­¨¿, ±·¨² ¿ ci;1
¢µ®¤­»¬ ¡¨²®¬,   ±i+1 | ¢»µ®¤­»¬: §­ ¿, ·²® ±«³· ¥²±¿ ± ¡¨²®¬
¯¥°¥­®±  ­  ª ¦¤®¬ ¸ £¥, ¬®¦­® ° ±±·¨² ²¼, ·²® ¯°®¨§®©¤¥² § 
¤¢  ¸ £ , ²® ¥±²¼ ª ª § ¢¨±¨² ci+1 ®² ci;1 . ±«¨ i-© ° §°¿¤ ¨¬¥¥²
²¨¯ k ¨«¨ g, ²® ±®¥¤¨­¥­¨¥ ¨¬¥¥² ²®² ¦¥ ²¨¯ ¯¥°¥­®± . ±«¨ ¦¥
i-© ° §°¿¤ ¨¬¥¥² ²¨¯ ¯¥°¥­®±  p, ²® ²¨¯ ¯¥°¥­®±  ¤«¿ ±®¥¤¨­¥­¨¿
±®¢¯ ¤ ¥² ± ²¨¯®¬ (i ; 1)-£® ° §°¿¤  (±¬. °¨±. 29.6).
¨±. 29.6

¨¯ ¯¥°¥­®±  ±®¥¤¨­¥­¨¿ ¤¢³µ ±³¬¬ ²®°®¢ (² ¡«¨¶  ®¯¥° ¶¨¨ 
).

 ¡«¨¶³ ­  °¨±. 29.6 ¬®¦­® ° ±±¬ ²°¨¢ ²¼ ª ª ®¯°¥¤¥«¥­¨¥ ®¯¥° ¶¨¨ (ª®¬¯®§¨¶¨¨ ²¨¯®¢ ¯¥°¥­®± ) ­  ¬­®¦¥±²¢¥ fk; g; pg ; ®­ 
¡³¤¥² ®¡®§­ · ²¼±¿ ±¨¬¢®«®¬ 
. ²  ®¯¥° ¶¨¿  ±±®¶¨ ²¨¢­  (±¬.
³¯° ¦­¥­¨¥ 29.2-2).
 ¯®¬®¹¼¾ ½²®© ®¯¥° ¶¨¨ ²¨¯ ¯¥°¥­®±  ¤«¿ ­¥ª®²®°®£® ³· ±²ª  ·¨±«  ¢»° ¦ ¥²±¿ ·¥°¥§ ²¨¯» ¯¥°¥­®±®¢ ®²¤¥«¼­»µ °¿§°¿¤®¢.
¡®§­ ·¨¬ ·¥°¥§ xi ²¨¯ ¯¥°¥­®±  ¢ i-¬ ° §°¿¤¥.
8
>
< k;ifai;1 = bi;1 = 0;
(29:3)
xi = > g;ifai;1 = bi;1 = 1;
:
p;ifai;1 6= bi;1:
®£¤  § ¢¨±¨¬®±²¼, ±ª ¦¥¬, ¡¨²  c7 ®² c4 ®¯°¥¤¥«¿¥²±¿ ª®¬¯®§¨¶¨¥© x5 
 x6 
 x7 .
®±ª®«¼ª³ ¢ ­³«¥¢®© ° §°¿¤ ¯¥°¥­®±  ®² ¬« ¤¸¨µ ° §°¿¤®¢ ­¥
¯®±²³¯ ¥², ³±«®¢­® ¯®«®¦¨¬ x0 = k. ®£¤  ¯¥°¥­®± ­  ¢»µ®¤¥ i ; £®

614

« ¢  29 °¨´¬¥²¨·¥±ª¨¥ ±µ¥¬»

° §°¿¤  ®¯°¥¤¥«¿¥²±¿ ª®¬¯®§¨¶¨¥© x0 
 x1 
 : : : 
 xi : ci = 0, ¥±«¨
ª®¬¯®§¨¶¨¿ ° ¢­  k, ¨ ci = 1, ¥±«¨ ª®¬¯®§¨¶¨¿ ° ¢­  g. (­ ·¥­¨¥ p ¤«¿ ª®¬¯®§¨¶¨¨ ­¥¢®§¬®¦­®, ¯®±ª®«¼ª³ ¤«¿ ½²®£® ¢±¥ ·«¥­»
¤®«¦­» ¡»²¼ ° ¢­  p,   ½²® ­¥ ² ª ¤«¿ x0 .)
®«¥¥ ´®°¬ «¼­® ½²® § ¯¨±»¢ ¥²±¿ ² ª. ®«®¦¨¬ y0 = k ¨ ®¯°¥¤¥«¨¬ y1 ; y2; : : :yn ² ª:
yi = xi 
 yi;1 = x0 
 x1 
 : : : 
 xi
(29.3)
°³£¨¬¨ ±«®¢ ¬¨, y0 ; : : :yn ­ §»¢ ¾²±¿ ¯°¥´¨ª± ¬¨ (prexes) ¢»° ¦¥­¨¿ x0 
x1 
: : :
xn . (¡¹ ¿ § ¤ ·  ® ¯ ° ««¥«¼­®¬ ¢»·¨±«¥­¨¨
¯°¥´¨ª±®¢ ° ±±¬®²°¥­  ¢ £«. 30).   °¨±. 29.7 ¯®ª § ­» §­ ·¥­¨¿
xi ¨ yi ¤«¿ ¯°¨¬¥°  °¨±. 29.3.
¨±. 29.7

29.7. ­ ·¥­¨¿ xi ¨ yi ¤«¿ ¯°¨¬¥°  °¨±. 29.3.

¥¯¥°¼ ±ª § ­­®¥ ¢»¸¥ § ¯¨¸¥²±¿ ² ª:
¥¬¬  29.1. °¨ ¢±¥µ i = 0; 1; 2; : : : ; n:
1. ±«¨ yi = k, ²® ci = 0.
2. ±«¨ yi = g, ²® ci = 1
3. «³· © yi = p ­¥¢®§¬®¦¥­.
®ª § ²¥«¼±²¢®. ­¤³ª¶¨¿ ¯® i. °¨ i = 0 ¯® ®¯°¥¤¥«¥­¨¾ y0 =
x0 = k ¨ c0 = 0. ³±²¼ ³²¢¥°¦¤¥­¨¥ «¥¬¬» ¢»¯®«­¥­® ¤«¿ i ; 1.
®§¬®¦­» ²°¨ ±«³· ¿.
1. ±«¨ yi = k, ²® «¨¡® xi = k (¨ ²®£¤  ±i = 0), «¨¡® xi = p ¨
xi;1 = k. ®£¤  ¯® ¯°¥¤¯®«®¦¥­¨¾ ¨­¤³ª¶¨¨ ci;1 = 0,   ci = ci;1
(¡¨² ¯¥°¥­®±  ±®µ° ­¿¥²±¿), ¯®½²®¬³ ¨ ¢ ½²®¬ ±«³· ¥ ci = 0.
2. «³· © yi = g  ­ «®£¨·¥­.
3. ±«¨ yi = p, ²® ®¡¿§ ²¥«¼­® xi = p ¨ yi;1 = p, ­® ¯®±«¥¤­¥¥
° ¢¥­±²¢® ­¥¢®§¬®¦­® ¯® ¯°¥¤¯®«®¦¥­¨¾ ¨­¤³ª¶¨¨.
¥¬¬  ¤®ª § ­ .
 ª¨¬ ®¡° §®¬, ¢»·¨±«¥­¨¥ ¡¨²®¢ ¯¥°¥­®±  ci ±¢®¤¨²±¿ ª ¢»·¨±«¥­¨¾ ¯°¥´¨ª±®¢ yi . ±² ¢¸¨¥±¿ ¤¥©±²¢¨¿ ¢»¯®«­¿¾²±¿ §  ¢°¥¬¿
(1) -¤®±² ²®·­® ¯®¤ ²¼ ¡¨²» ¯¥°¥­®±  ­  ¢µ®¤» ±³¬¬ ²®°®¢.
29.2.3. »·¨±«¥­¨¥ ²¨¯®¢ ¯¥°¥­®±  ± ¯®¬®¹¼¾ ¯ ° ««¥«¼­®© ¯°¥´¨ª±­®© ±µ¥¬»
¤¥±¼ ¬» ° ±±¬®²°¨¬ ±µ¥¬³, ¨±¯®«¼§³¾¹³¾ ¢®§¬®¦­®±²¼ ¯ ° ««¥«¼­»µ ¢»·¨±«¥­¨© ¨ ¯®§¢®«¿¾¹³¾ §  ¢°¥¬¿ O(lg n) ¢»·¨±«¨²¼
¢±¥ ²¨¯» ¯¥°¥­®±  yi . ­  ¨¬¥¥² ° §¬¥° (n).
¢¥¤¥¬ ­¥ª®²®°»¥ ®¡®§­ ·¥­¨¿. °¨ 0 6 i 6 j 6 n ¯®«®¦¨¬
[i; j ] = xi 
 xi+1 
 : : : 
 xj
 · ±²­®±²¨, [i; i] = xi . ±«¨ 0 6 i < j 6 k 6 n, ²®
[i; k] = [i; j ; 1] 
 [j; k]
(29.4)

Cµ¥¬» ¤«¿ ±«®¦¥­¨¿

615

¯®±ª®«¼ª³ ®¯¥° ¶¨¿ ª®¬¯®§¨¶¨¨ 
  ±±®¶¨ ²¨¢­ .  ¸  ¶¥«¼ | ¢»·¨±«¨²¼ ¢±¥ yi = [0; i].
µ¥¬  ±®±²®¨² ¨§ ®¤¨­ ª®¢»µ ½«¥¬¥­²®¢, ª ¦¤»© ¨§ ª®²®°»µ
¢»·¨±«¿¥² ª®¬¯®§¨¶¨¾ 
. ¤¥¿ ¥¥ ¯°®±² : ­  ¯¥°¢®¬ ³°®¢­¥ ¯ ° ««¥«¼­® ¢»·¨±«¿¾²±¿ ª®¬¯®§¨¶¨¨ ¯ ° ([1; 2]; [3; 4]; : : : ), § ²¥¬
·¥²¢¥°®ª ¨ ² ª ¤ «¥¥, ¯®ª  ¬» ­¥ ¤®©¤¥¬ ¤® ª®¬¯®§¨¶¨¨ ¢±¥µ ½«¥¬¥­²®¢.  ²¥¬ ¬» ¤¢¨¦¥¬±¿ ¢ ®¡° ²­®¬ ­ ¯° ¢«¥­¨¨, ¯®ª  ­¥ ¤®µ®¤¨¬ ¤® ¨±ª®¬»µ yi . ° £¬¥­² ¤¥°¥¢  (¢­³²°¥­­¿¿ ¢¥°¸¨­  ¨ ¥¥
¯®²®¬ª¨) ¯®ª § ­ ­  °¨±. 29.8.   °¨±. 29.9 ¯®ª § ­  ¯®«­ ¿ ±µ¥¬ 
¤«¿ n = 8. µ®¤» x1 ; : : :xn ¨ ¢»µ®¤» y0 ; : : : ; yn;1 ° ±¯®«®¦¥­» ¢
«¨±²¼¿µ ¤¥°¥¢ , a ¢µ®¤ x0 ¨ ¢»µ®¤ yn { ¢ ª®°­¥, ² ª ·²® ¤ ­­»¥
¤¢¨¦³²±¿ ¯® ¤¥°¥¢³ ±­ · «  ®² «¨±²¼¥¢ ª ª®°­¾,   ¯®²®¬ ®¡° ²­®.
µ¥¬  ¤«¿ ¯ ° ««¥«¼­®£® ¢»·¨±«¥­¨¿ ¯°¥´¨ª±®¢. ®ª § ­  ¢­³²°¥­­¿¿ ¢¥°¸¨­ , ®²¢¥· ¾¹ ¿ §  xi : : : xk . ¥¢®¥ ¯®¤¤¥°¥¢® ®¡º¥¤¨­¿¥² ¢µ®¤»
xi ; : : : ; xj;1 , ¯° ¢®¥ | ¢µ®¤» xj ; : : : ; xk . ¢  ½«¥¬¥­²  
 (®¤¨­ ¨±¯®«¼§³¥²±¿
¯°¨ ¯°¿¬®¬ µ®¤¥, ¤°³£®© | ¯°¨ ®¡° ²­®¬) ¢»·¨±«¿¾² [i; k] = [i; j ; 1] 
 [j; k] ¨
[0; j ; 1] = [0; i ; 1] 
 [i;j ; 1].
¨±. 29.8

¨±. 29.9 29.9 «³· © n = 8. (a) ¡¹ ¿ ±²°³ª²³°  ¨ ¢»·¨±«¿¥¬»¥ §­ ·¥­¨¿
(b) ­ ·¥­¨¿, ±®®²¢¥²±²¢³¾¹¨¥ ¯°¨¬¥°³ ­  °¨±. 29.3

¢  ½«¥¬¥­²  
 ¢ ª ¦¤®¬ ³§«¥ ° ¡®² ¾² ¢ ° §­®¥ ¢°¥¬¿ (¨¬¥¾²
° §­³¾ £«³¡¨­³): «¥¢»© (­  °¨±. 29.8) ° ¡®² ¥² À­  ¯³²¨ ¢¢¥°µÁ,
  ¯° ¢»© | ­  ¯³²¨ ¢­¨§. ¡¥¤¨²¼±¿ ¢ ²®¬, ·²® ±µ¥¬  ° ¡®² ¥² ¯° ¢¨«¼­®, ¬®¦­® ¯® ¨­¤³ª¶¨¨. °¥¤¯®« £ ¿, ·²® ¯®¤¤¥°¥¢¼¿
­  °¨±. 28.8 ¢»·¨±«¿¾² [i; j ; 1] ¨ [j; k], ¬» ¯®«³· ¥¬, ·²® «¥¢»©
½«¥¬¥­² 
 ¢»·¨±«¿¥² [i; k]² ª ·²® ¢»·¨±«¥­¨¿ ±­¨§³ ¢¢¥°µ ¯° ¢¨«¼­». °®±«¥¤¨¬ §  ¤¢¨¦¥­¨¥¬ ¨­´®°¬ ¶¨¨ ¢­¨§. °¥¤¯®« £ ¿,
·²® ¢ ¢¥°¸¨­³ ­  °¨±. 29.8 ±¢¥°µ³ ¯°¨µ®¤¨² ¯° ¢¨«¼­®¥ §­ ·¥­¨¥
[0; i ; 1], ¬» ¢¨¤¨¬, ·²® ¯° ¢»© ½«¥¬¥­² 
 ¯° ¢¨«¼­® ¢»·¨±«¿¥²
[0; j ; 1] = [0; i ; 1] 
 [i; j ; 1]. ²® §­ ·¥­¨¥ ¯¥°¥¤ ¥²±¿ ¯° ¢®¬³
±»­³; «¥¢®¬³ ¯¥°¥¤ ¥²±¿ ­¥¨§¬¥­¥­­®¥ §­ ·¥­¨¥ [0; i ; 1].
²°®¥­¨¥ ª®°­¿ ¤¥°¥¢  (¤®¯®«­¨²¥«¼­»© ½«¥¬¥­² 
) ¯®ª § ­® ­ 
°¨±. 29.9.
±«¨ n ¿¢«¿¥²±¿ ±²¥¯¥­¼¾ ¤¢®©ª¨, ²® ¢ ¯ ° ««¥«¼­®© ¯°¥´¨ª±­®©
±µ¥¬¥ 2n ; 1 ½«¥¬¥­². °¥¬¿ ° ¡®²» ±®±² ¢«¿¥² O(lg n), ¯®±ª®«¼ª³ ¤¥°¥¢® ¨¬¥¥² ¢»±®²³ lg n,   ¤ ­­»¥ ¯°®µ®¤¿² ¯® ­¥¬³ ¤¢ ¦¤»
(¢¢¥°µ ¨ ¢­¨§).
29.2.4. ³¬¬ ²®° ± ¯°¥¤¢»·¨±«¥­¨¥¬ ¯¥°¥­®±®¢: ®ª®­· ­¨¥
®«­ ¿ ª®­±²°³ª¶¨¿ n-° §°¿¤­®£® ±³¬¬ ²®°  ± ¯°¥¤¢»·¨±«¥­¨¥¬ ¯¥°¥­®±®¢ (carry-lookahead adder) ¯®ª § ­  ­  °¨±. 29.10. °®-

616

« ¢  29 °¨´¬¥²¨·¥±ª¨¥ ±µ¥¬»
¨±. 29.10 29.10 C³¬¬ ²®° ± ¯°¥¤¢»·¨±«¥­¨¥¬ ¯¥°¥­®±®¢ (¯®ª § ­ ±«³· © n =
8) ±®±²®¨² ¨§ n + 1 ¡«®ª  KPG ± ­®¬¥° ¬¨ ®² 0 ¤® n. «®ª KPGi ¯®«³· ¥² ­ 
¢µ®¤ ai ¨ bi , ¢»·¨±«¿¥² ²¨¯ ¯¥°¥­®±  xi ¨ ®¡° ¡ ²»¢ ¥² ¢»µ®¤­®¥ §­ ·¥­¨¥ yi ,
¢»¤ ¢ ¿ i-»© ¡¨² ±³¬¬» si . ®ª § ­» §­ ·¥­¨¿ ¤«¿ ¯°¨¬¥°  °¨±. 29.3

¬¥ ° §®¡° ­­®© ±µ¥¬» ¯ ° ««¥«¼­®£® ¢»·¨±«¥­¨¿ ¯°¥´¨ª±®¢, ­¥£®
¢µ®¤¨² n + 1 ¡«®ª KPG. «®ª KPG ± ¨­¤¥ª±®¬ i ¢»·¨±«¿¥² ¯® ¢µ®¤ ¬ ai ; bi ²¨¯ ¯¥°¥­®±  xi ¨ ¯¥°¥¤ ¥² ¥£® ­ ¢¥°µ,   § ²¥¬, ¯®«³·¨¢
±¢¥°µ³ §­ ·¥­¨¥ yi (ª®²®°®¥, ±®£« ±­® «¥¬¬¥ 29.1, ±®®²¢¥²±²¢³¥² ¡¨²³ ¯¥°¥­®±  ci ), ¢»·¨±«¿¥² ± ¯®¬®¹¼¾ ±³¬¬ ²®°  FAi §­ ·¥­¨¥ i-£®
¡¨²  ±³¬¬» si . ­ ·¥­¨¿ an+1 = 0, bn+1 = 0 ¨ x0 = k § ´¨ª±¨°®¢ ­». ®±ª®«¼ª³ ¢±¥ ®¯¥° ¶¨¨, ª°®¬¥ ¢»¯®«­¿¥¬»µ ¯ ° ««¥«¼­®©
¯°¥´¨ª±­®© ±µ¥¬®©, ²°¥¡³¾² ¢°¥¬¥­¨ O(1), ®¡¹¥¥ ¢°¥¬¿ ° ¡®²»
±µ¥¬» ±®±² ¢«¿¥² O(lg n).  §¬¥° ±µ¥¬» ° ¢¥­ (n).
29.2.5. «®¦¥­¨¥ ± § ¯®¬¨­ ­¨¥¬ ¯¥°¥­®±®¢
 ª ­¨ ±²° ­­®, ±«®¦¥­¨¥ ²°¥µ ·¨±¥« ¯®·²¨ ­¥ ²°¥¡³¥² ¤®¯®«­¨²¥«¼­»µ § ²° ² ¯® ±° ¢­¥­¨¾ ±® ±«®¦¥­¨¥¬ ¤¢³µ: £«³¡¨­  ³¢¥«¨·¨¢ ¥²±¿ ¢±¥£® ­  ­¥±ª®«¼ª® ¥¤¨­¨¶. ³±²¼ x = hxn;1 ; xn;2 ; : : : ; x0i,
y = hyn;1 ; yn;2 ; : : : ; y0i ¨ z = hzn;1 ; zn;2 ; : : : ; z0i | ²°¨ n° §°¿¤­»µ ·¨±« . µ¥¬  ±«®¦¥­¨¿ ± § ¯®¬¨­ ­¨¥¬ ¯¥°¥­®±®¢
(carry-save adder) ­ µ®¤¨² ¤¢  ·¨±«  u = hun;2 ; un;2 ; : : : ; x0i (n
¡¨²®¢) ¨ v = hvn ; vn;1 ; : : : ; v0i (n + 1 ¡¨²®¢), ¤«¿ ª®²®°»µ
u + v = x + y + z:
­  ¤¥« ¥² ½²® ±«¥¤³¾¹¨¬ ®¡° §®¬ (°¨±. 29.11 (b)):
ui = parity(xi ; yi; zi );
vi+1 = majority(xi ; yi; zi )
(¤«¿ iu = 0; 1; : : : ; n ; 1; ¡¨² v0 ¢±¥£¤  ° ¢¥­ 0).  ±±¬®²°¨¬ ·¨±« 
u = hun;1 ; un;2 ; : : : ; u0i ¨ v = hvn ; vn;1 ; : : : ; v0i. ¥£ª® ¢¨¤¥²¼, ·²®
x+y+z = u+v
¨±«  u ¨ v ¬®£³² ¡»²¼ ¢»·¨±«¥­» §  ¢°¥¬¿ O(1) ± ¯®¬®¹¼¾ n
±³¬¬ ²®°®¢ FA0 ; : : : ; FAn;1 (°¨±. 29.11). «¿ ±«®¦¥­¨¿ ·¨±¥« u ¨ v
¨±¯®«¼§³¥²±¿ ±³¬¬ ²®° ± ¯°¥¤¢»·¨±«¥­¨¥¬ ¯¥°¥­®±®¢. ²® ²°¥¡³¥²
¢°¥¬¥­¨ O(lg n), ¢±¥£® ¯®«³· ¥²±¿ O(1) + O(lg n), ²® ¥±²¼ O(lg n).
®²¿ ²  ¦¥  ±¨¬¯²®²¨·¥±ª ¿ ®¶¥­ª  ¯®«³· ¥²±¿ ¯°¨ ¨±¯®«¼§®¢ ­¨¨
¤¢³µ ±³¬¬ ²®°®¢ ± ¯°¥¤¢»·¨±«¥­¨¥¬ ¯¥°¥­®±®¢, ­® ­  ¯° ª²¨ª¥
° §­¨¶  (¯°¨¬¥°­® ¢ ¤¢  ° § ) ±³¹¥±²¢¥­­ .
­ «®£¨·­»© ¯°¨¥¬ (±¢¥¤¥­¨¥ ±«®¦¥­¨¿ ²°¥µ ·¨±¥« ª ±«®¦¥­¨¾ ¤¢³µ) ¨£° ¥² ¢ ¦­³¾ °®«¼ ¢ ¡»±²°»µ ±µ¥¬ µ ¤«¿ ³¬­®¦¥­¨¿
(±¬. ° §¤¥« 29.3).

Cµ¥¬» ¤«¿ ±«®¦¥­¨¿
¨±. 29.11

617

(a). µ¥¬  ±«®¦¥­¨¿ ± § ¯®¬¨­ ­¨¥¬ ¯¥°¥­®±®¢. «¿ ±«®¦¥­¨¿ ²°¥µ

n-¡¨²®¢»µ ·¨±¥« x; y; z ¢»·¨±«¿¾²±¿ ·¨±«  u (n ¡¨²®¢) ¨ v (n + 1 ¡¨²®¢), ¤«¿
ª®²®°»µ x + y + z = u + v. (b) 8-° §°¿¤­»© ±³¬¬ ²®° ± § ¯®¬¨­ ­¨¥¬ ¯¥°¥­®±®¢.
 ¦¤»© ¨§ ±³¬¬ ²®°®¢ FAi ¯®«³· ¥² ­  ¢µ®¤ xi ; yi ; zi ¨ ¢»¤ ¥² ¡¨² ±³¬¬» ui
¨ ¡¨² ¯¥°¥­®±  vi . » ¯®« £ ¥¬ v0 = 0.

¯° ¦­¥­¨¿
29.2-1 ³±²¼ n = 8, a = h01111111i, b = h00000001i. ª ¦¨²¥ ¡¨²»
¯¥°¥­®±  ¨ ²¨¯» ¯¥°¥­®±  ¢® ¢±¥µ ° §°¿¤ µ,   ² ª¦¥ §­ ·¥­¨¿ ­ 
¢±¥µ ¯°®¢®¤ µ ±µ¥¬» °¨±. 29.9, ¢ª«¾· ¿ ¢»µ®¤» y0 ; y1; : : : ; y8 .
29.2-2 ®ª ¦¨²¥, ·²® ®¯¥° ¶¨¿ 
 (§ ¤ ­­ ¿ ² ¡«¨¶¥© °¨±. 29.5)
 ±±®¶¨ ²¨¢­ .
29.2-3 ¡º¿±­¨²¥, ª ª ¤®«¦­  ¡»²¼ ³±²°®¥­  ¯ ° ««¥«¼­ ¿ ¯°¥´¨ª±­ ¿ ±µ¥¬ , ¥±«¨ n ­¥ ¿¢«¿¥²±¿ ±²¥¯¥­¼¾ ¤¢®©ª¨ (­ ¯°¨¬¥°, ° ±±¬®²°¨²¥ ±«³· © n = 11).  ª®¢® ¢°¥¬¿ ° ¡®²» ² ª®© ±µ¥¬»?
29.2-4 ®ª ¦¨²¥ ¢­³²°¥­­¥¥ ³±²°®©±²¢® ±µ¥¬» KPG, ¥±«¨ §­ ·¥­¨¿ ­  ¢µ®¤ µ ¨ ¢»µ®¤ µ ª®¤¨°³¾²±¿ ² ª: ­  ¢µ®¤ µ h00i ±®®²¢¥²±²¢³¥² k, h11i { g, h01i ¨«¨ h10i { p; ­  ¢»µ®¤ µ 0 ±®®²¢¥²±²¢³¥² k,
1 { g.
29.2-5 ª ¦¨²¥ £«³¡¨­³ ª ¦¤®£® ¯°®¢®¤  ­  °¨±. 29.9 ( ).  ©¤¨²¥ ª°¨²¨·¥±ª¨© (± ¬»© ¤«¨­­»©) ¯³²¼ (critical path) ®² ¢µ®¤®¢
ª ¢»µ®¤ ¬ ¨ ¯®ª ¦¨²¥, ·²® ¥£® ¤«¨­  ¥±²¼ O(lg n).  ©¤¨²¥ ³§¥«,
¤¢  ½«¥¬¥­²  
 ª®²®°®£® ±° ¡ ²»¢ ¾² ± ¨­²¥°¢ «®¬ (lg n). ±²¼
«¨ ³§«», ¢ ª®²®°®¬ ¤¢  ½«¥¬¥­²  
 ±° ¡ ²»¢ ¾² ®¤­®¢°¥¬¥­­®?
29.2-6 «¥¤³¾ ®¡° §¶³ °¨±. 29.12, ³ª ¦¨²¥ ±¯®±®¡ ¯®±²°®¥­¨¿
±µ¥¬» ¢»·¨±«¥­¨¿ ¯°¥´¨ª±®¢ ¤«¿ «¾¡®£® ·¨±«  ¢µ®¤®¢, ¿¢«¿¾¹¥£®±¿ ±²¥¯¥­¼¾ ¤¢®©ª¨. ®ª ¦¨²¥, ·²® ±µ¥¬  ¨¬¥¥² £«³¡¨­³ (lg n)
¨ ° §¬¥° (n lg n). ®ª ¦¨²¥, ·²® ±µ¥¬  ° ¡®² ¥² ¯° ¢¨«¼­®, ° §¡¨¢ ¥¥ ­  ¡«®ª¨ ¨ ° ±±³¦¤ ¿ ¨­¤³ª²¨¢­®.
¨±. 29.12

29.12  ° ««¥«¼­ ¿ ¯°¥´¨ª±­ ¿ ±µ¥¬  ¤«¿ ³¯° ¦­¥­¨¿ 29.2-6

29.2-7  ª®¢  ¬ ª±¨¬ «¼­ ¿ ¢»µ®¤­ ¿ ±²¥¯¥­¼ ª ¦¤®£® ¯°®¢®¤ 
¢ ±µ¥¬¥ ± ¯°¥¤¢»·¨±«¥­¨¥¬ ¯¥°¥­®±®¢? ®±²°®©²¥ ±µ¥¬³ ¤«¿ ±«®¦¥­¨¿ £«³¡¨­» O(lg n) ¨ ° §¬¥°  (n), ¢ ª®²®°®© ¢±¥ ¯°®¢®¤  ¨¬¥¾²
¢»µ®¤­³¾ ±²¥¯¥­¼ O(1).
29.2-8 ®±²°®©²¥ ±·¥²·¨ª ¥¤¨­¨¶ | ±µ¥¬³ ± n ¢µ®¤ ¬¨ ¨ dlg(n +
1)e ¢»µ®¤ ¬¨, ¢»¤ ¾¹³¾ ·¨±«® ¥¤¨­¨¶ ±°¥¤¨ ¢µ®¤®¢, § ¯¨± ­­®¥
¢ ¤¢®¨·­®© ±¨±²¥¬¥. ( ¯°¨¬¥°, ¢µ®¤ h10011110i ¯®°®¦¤ ¥² ¢»µ®¤
h101i (¯¿²¼ ¥¤¨­¨¶). «³¡¨­  ±µ¥¬» ¤®«¦­  ±®±² ¢«¿²¼ O(lg n), ° §¬¥° | (n).
29.2-9* ®±²°®©²¥ ±µ¥¬³ ¤«¿ ±«®¦¥­¨¿ £«³¡¨­» 4 ¨ ¯®«¨­®¬¨ «¼­® § ¢¨±¿¹¥£® ®² n ° §¬¥° , ¨±¯®«¼§³¿ ½«¥¬¥­²» AND ¨ OR ±
¯°®¨§¢®«¼­»¬ ·¨±«®¬ ¢µ®¤®¢. (®¯®«­¨²¥«¼­»© ¢®¯°®±: ±¤¥« ©²¥
²® ¦¥ ± ¬®¥ ¤«¿ £«³¡¨­» 3.)
29.2-10* ³±²¼ ­  ª ¦¤®¬ ¢µ®¤¥ ª ±ª ¤­®£® ±³¬ ²®°  n-

618

« ¢  29 °¨´¬¥²¨·¥±ª¨¥ ±µ¥¬»

° §°¿¤­»µ ·¨±¥« ± ° ¢­®© ¢¥°®¿²­®±²¼¾ ¯®¿¢«¿¾²±¿ §­ ·¥­¨¿
0 ¨ 1, ¯°¨·¥¬ ° §­»¥ ¢µ®¤» ­¥§ ¢¨±¨¬». ®ª ¦¨²¥, ·²® ± ¢¥°®¿²­®±²¼¾ ­¥ ¬¥­¥¥ 1 ; 1=n ­¨ª ª®© ¯¥°¥­®± ­¥ ° ±¯°®±²° ­¿¥²±¿
¤ «¥¥ ·¥¬ ­  O(lg n) ° §°¿¤®¢.

29.3. µ¥¬» ¤«¿ ³¬­®¦¥­¨¿
 ¨¡®«¥¥ ¯°®±²®©  «£®°¨²¬ ³¬­®¦¥­¨¿ À±²®«¡¨ª®¬Á±®±²®¨² ¢
±«®¦¥­¨¨ À±¤¢¨£®¢Á ®¤­®£® ¨§ ±®¬­®¦¨²¥«¥©: 2n-¡¨²®¢®¥ ¯°®¨§¢¥¤¥­¨¥ ¤¢³µ n-¡¨²®¢»µ ·¨±¥« a = han;1 ; an;2 ; : : : ; a0i ¨ b =
hbn;1; bn;2; : : : ; b0i ¬®¦¥² ¡»²¼ § ¯¨± ­® ª ª

p = ab =

nX
;1
i=0

m(i);

£¤¥ m(i) = a  bi  2i ¯®«³· ¥²±¿ ¨§ a ±¤¢¨£®¬ ¢±¥µ ° §°¿¤®¢ ­  i ¥¤¨­¨¶ ¢«¥¢® (¨ § ¯®«­¥­¨¥¬ ®±¢®¡®¤¨¢¸¨µ±¿ ° §°¿¤®¢ ­³«¿¬¨), ¥±«¨
bi = 1, ¨ ° ¢­® 0, ¥±«¨ bi = 0) (°¨±. 29.13). ¨±«  mi ­ §»¢ ¾²±¿
· ±²¨·­»¬¨ ¯°®¨§¢¥¤¥­¨¿¬¨ ; ª ¦¤®¥ ­¥­³«¥¢®¥ · ±²¨·­®¥ ¯°®¨§¢¥¤¥­¨¥ ±®®²¢¥²±²¢¥² ­¥­³«¥¢®¬³ ° §°¿¤³ ¢ b.
29.13 ¬­®¦¥­¨¥ ·¨±¥« a = h1110i ¨ b = h1101i ±²®«¡¨ª®¬; ¯°®¨§¢¥¤¥­¨¥ p = a  b = h10110110i .  ¦¤®¥ · ±²¨·­®¥ ¯°®¨§¢¥¤¥­¨¥ m(i) ¯®«³· ¥²±¿
¨§ a ±¤¢¨£®¬ ­  i ° §°¿¤®¢ ¢«¥¢®, ¥±«¨ bi = 1.  ¯°®²¨¢­®¬ ±«³· ¥ ®­® ° ¢­®
­³«¾.
¨±. 29.13

 ½²®¬ ° §¤¥«¥ ° ±±¬ ²°¨¢ ¾²±¿ ¤¢¥ ±µ¥¬» ¤«¿ ³¬­®¦¥­¨¿.  ²°¨·­»© ³¬­®¦¨²¥«¼ ° ¡®² ¥² §  ¢°¥¬¿ (n) ¨ ¨¬¥¥² ° §¬¥°
(n2 ). ¥°¥¢® ®««¥±  (Wallace-tree multiplier) ² ª¦¥ ¨¬¥¥² ° §¬¥°
(n2 ), ­® ° ¡®² ¥² ¡»±²°¥¥, §  ¢°¥¬¿ (lg n). ¡¥ ±µ¥¬» ¨±¯®«¼§³¾² ³¬­®¦¥­¨¥ ±²®«¡¨ª®¬.
29.3.1.  ²°¨·­»© ³¬­®¦¨²¥«¼
 ²°¨·­»© ³¬­®¦¨²¥«¼ ° ¡®² ¥² ¢ ²°¨ ½² ¯ : (1) ¢»·¨±«¿¥²
· ±²¨·­»¥ ¯°®¨§¢¥¤¥­¨¿; (2) ±ª« ¤»¢ ¥² ¨µ, ¨±¯®«¼§³¿ ±«®¦¥­¨¥
± § ¯®¬¨­ ­¨¥¬ ¯¥°¥­®±®¢, ¯®ª  ­¥ ®±² ¥²±¿ ¤¢  ·¨±« ; (3) ±ª« ¤»¢ ¥² ½²¨ ¤¢  ·¨±«  (± ¯®¬®¹¼¾ ª ±ª ¤­®£® ±³¬¬ ²®°  ¨«¨ ±
¯°¥¤¢»·¨±«¥­¨¬ ¯¥°¥­®±®¢).
 ²°¨·­»© ³¬­®¦¨²¥«¼ (array multiplier) ¯®ª § ­ ­  °¨±. 29.14;
¢µ®¤­»¥ ¡¨²» ai ±®®²¢¥²±²¢³¾² ¢¥°²¨ª «¼­»¬ ¯°®¢®¤ ¬, ¡¨²» bi
| £®°¨§®­² «¼­»¬.  ¦¤»© ¢µ®¤­®© ¡¨² ¯®±²³¯ ¥² ­  ¢µ®¤» n
½«¥¬¥­²®¢ AND, ª®²®°»¥ ¢»·¨±«¿¾² ° §°¿¤» · ±²¨·­»µ ¯°®¨§¢¥¤¥­¨©:
m(ji+) i = aj  bi = aj AND bi

µ¥¬» ¤«¿ ³¬­®¦¥­¨¿

619

¨±«® ½«¥¬¥­²®¢ AND ° ¢­® n2 ; ¢±¥ ®­¨ ° ¡®² ¾² ®¤­®¢°¥¬¥­­®,
¢»·¨±«¿¿ ¡¨²» · ±²¨·­»µ ¯°®¨§¢¥¤¥­¨© (ª°®¬¥ ²¥µ, ·²® § ¢¥¤®¬® ° ¢­» 0).  ²¥¬ ±³¬¬ ²®°» ± § ¯®¬¨­ ­¨¥¬ ¯¥°¥­®±®¢ (±®±² ¢«¥­­»¥ ¨§ ±³¬¬¨°³¾¹¨µ ½«¥¬¥­²®¢ FA(ji) ) ±ª« ¤»¢ ¾² · ±²¨·­»¥
¯°®¨§¢¥¤¥­¨¿. « ¤¸¨¥ ° §°¿¤» ¯®¿¢«¿¾²±¿ ­  ¢»µ®¤ µ ¢ ¯ °¢®¬
±²®«¡¶¥ °¨±³­ª , ±² °¸¨¥ ¯®«³· ¾²±¿ ­  ¢»µ®¤¥ ±³¬¬ ²®°  ¢ ­¨§³
°¨±³­ª .
¨±. 29.14 29.14  ²°¨·­»© ³¬­®¦¨²¥«¼ ¤«¿ n = 4. «¥¬¥­² AND, ®¡®§­ ·¥­­»© G(ji) , ¢»·¨±«¿¥² j -© ¡¨² · ±²¨·­®£® ¯°®¨§¢¥¤¥­¨¿ m(i) .  ¦¤»© £®°¨§®­² «¼­»© °¿¤ ±³¬¬¨¯³¾¹¨µ ½«¥¬¥­²®¢ FA(ji) ) ¯°¥¤±² ¢«¿¥² ±®¡®© ±³¬¬ ²®°
± § ¯®¬¨­ ­¨¥¬ ¯¥°¥­®±®¢. « ¤¸¨¥ n ¡¨²®¢ ¯°®¨§¢¥¤¥­¨¿ | ½²® ¡¨² m(0)
0
¨ u-¡¨²», ¯®«³· ¥¬»¥ ¢ ¯° ¢®¬ ±²®«¡¶¥ ¢ µ®¤¥ ±«®¦¥­¨¿ ± § ¯®¬¨­ ­¨¥¬ ¯¥°¥­®±®¢. ² °¸¨¥ n ¡¨²®¢ ¯®«³· ¾²±¿ ­  ¢»µ®¤¥ ±³¬¬ ²®° , ±ª« ¤»¢ ¾¹¥£®
u-¡¨²» v-¡¨²», ¢»µ®¤¿¹¨¥ ¨§ ±³¬¬¨°³¾¹¨¥ ½«¥¬¥­²®¢ ­¨¦­¥© ±²°®ª¨. ®ª § ­» §­ ·¥­¨¿ ¤«¿ ¬­®¦¨²¥«¥© °¨±. 29.13.

®±«¥¤®¢ ²¥«¼­® ¢»¯®«­¿¥¬»¥ ±«®¦¥­¨¿ ± § ¯®¬¨­ ­¨¥¬ ¯¥°¥­®±®¢ ¯®ª § ­» ­  °¨±. 29.15. ­ · «¥ ¨§ ·¨±¥« 0, m(0) ¨ m(1) ¯®«³· ¾²±¿ ·¨±«  u(1) ¨ v (1) (­¥ ¡®«¥¥ n + 1 ¡¨²®¢ ¢ ª ¦¤®¬; ¤«¿ v (1) ½²®
² ª, ¯®±ª®«¼ª³ n + 1-»¥ ° §°¿¤» ¤¢³µ ±« £ ¥¬»µ ¨§ ²°¥µ ° ¢­» 0),
¯°¨ ½²®¬ m(0) + m(1) = u(1) + v (1)  ²¥¬ ¨§ ·¨±¥« u(1), v (1) ¨ m(2)
¯®«³· ¾²±¿ ·¨±«  u(2) ¨ v (2), ¨¬¥¾¹¨¥ ¯® n +2 ¡¨²®¢ ª ¦¤®¥ (±­®¢ 
¢ ¤¢³µ ±« £ ¥¬»µ ¨§ ²°¥µ ±² °¸¨© ¡¨² ° ¢¥­ 0). » ¯°®¤®«¦ ¥¬
¯°®¶¥±±, ±ª« ¤»¢ ¿ u(i;1), v (i;1) ¨ m(i) ¤«¿ ¢±¥µ i = 2; 3; : : : ; n ; 1. 
ª®­¶¥ ª®­¶®¢ ¬» ¯®«³· ¥¬ 2 ·¨±«  u(n;1) ¨ v n;1 ¯® (2n ; 1) ¡¨²®¢
¢ ª ¦¤®¬, ¯°¨ ½²®¬

u(n;1) + u(n;1) =

nX
;1
i=0

m(i) =

= p:

¥ ¢±¥ ° §°¿¤» ·¨±¥« v (i) ¨±¯®«¼§³¾²±¿: ¯®±ª®«¼ª³ m(ji) = 0 ¯°¨
j = 0; : : : ; i ; 1; i + n; : : : ; 2n ; 1 ¨ vj(i) = 0 ¯°¨ j = 0; : : : ; i; i + n; i +
n + 1; : : : ; 2n ; 1 (±¬. ³¯° ¦­¥­¨¥ 29.3-1), ­  i-¬ ¸ £¥ ­¥®¡µ®¤¨¬®
° ¡®² ²¼ ²®«¼ª® ± n ; 1 ° §°¿¤ ¬¨ (i; i +1; : : : ; i + n ; 2). ¥°­¥¬±¿ ª
¨±. 29.15 29.15 ³¬¬¨°®¢ ­¨¥ · ±²¨·­»µ ¯°®¨§¢¥¤¥­¨©: ¯®¢²®°­®¥ ±«®¦¥­¨¥
± § ¯®¬¨­ ­¨¥¬ ¯¥°¥­®±®¢.  §®¡° ­ ¯°¨¬¥° °¨±. 29.13 (a = h1110i; b = h1101i).
³±²»¥ ¬¥±²  ¯¥°¥¤ §­ ª ¬¨ ° ¢¥­±²¢  ±·¨² ¾²±¿ § ¯®«­¥­­»¬¨ ­³«¿¬¨. »
¢»·¨±«¿¥¬ m(0) + m(1) + 0 = u(1) + v(1) , § ²¥¬ u(1) + v(1) + m(2) = u(2) + v(2) ,
u(2) + v(2) + m(3) = u(3) + v(3) , ¨, ­ ª®­¥¶, p = m(0) + m(1) + m(2) + m(3) = u(3) + v(3) .
°¨ ½²®¬ p0 = m(0)
¨ pi = u(ii) ¤«¿ i = 1; 2; : : : ; n ; 1.
0

¬ ²°¨·­®¬³ ³¬­®¦¨²¥«¾ (°¨±. 29.14). «¥¬¥­²» AND (®¡®§­ ·¥­-

(29.5)
(29.6)
(29.7)

620

« ¢  29 °¨´¬¥²¨·¥±ª¨¥ ±µ¥¬»

­»¥ G(ji)) ¢»·¨±«¿¾² · ±²¨·­»¥ ¯°®¨§¢¥¤¥­¨¿. »µ®¤®¬ ½«¥¬¥­² 
G(ji) ¡³¤¥² ¡¨² m(ji), ²® ¥±²¼ j -»© ¡¨² i-£® · ±²¨·­®£® ¯°®¨§¢¥¤¥­¨¿,
² ª ·²® i- ¿ ±²°®ª  AND-¬ ²°¨¶» ¤ ¥² n §­ · ¹¨µ ¡¨²®¢ · ±²¨·­®£® ¯°®¨§¢¥¤¥­¨¿ m(i) (± ¨­¤¥ª± ¬¨ n + i ; 1; n + i ; 2; : : : ; i).
 ¦¤»© °¿¤ ±³¬¬ ²®°®¢ FA(1i); : : : ; FA(ni;) 1 ±®¢¥°¸ ¥² i-© ¸ £ ±«®¦¥­¨¿ ± § ¯®¬¨­ ­¨¥¬ ¯¥°¥­®±®¢, ¢»·¨±«¿¿ u(i) ¨ v (i); ½«¥¬¥­² FA(ji)
¯®«³· ¥² ­  ¢µ®¤ ¡¨²» m(ji) , u(ji;1) ¨ vj(i;1 ¨ ¢»¤ ¥² ¤¢  ¡¨²  u(ji)
) .  ¬¥²¼²¥, ·²® ¢ «¥¢®© ª®«®­ª¥ u(i)
(i)
¨ vj(i+1
i+n;1 = mi+n;1 , ¯®½²®¬³
½²®² ¡¨² ­¥ ­³¦­® ±¯¥¶¨ «¼­® ¢»·¨±«¿²¼.   ¢µ®¤ µ ±³¬¬ ²®°®¢ ¢
¢¥°µ­¥¬ °¿¤³ ´¨ª±¨°®¢ ­® §­ ·¥­¨¥ 0, ² ª ª ª ®¤­® ¨§ ±« £ ¥¬»µ
° ¢­® ­³«¾.
¥¯¥°¼ ® ¢»µ®¤­»µ ¡¨² µ ¬ ²°¨·­®£® ³¬­®¦¨²¥«¿.  ª ¬» ³¦¥
®²¬¥· «¨, vj(n;1) = 0 ¤«¿ j = 0; 1; : : : ; n ; 1. ®½²®¬³ pj = u(jn;1)
(1)
(0)
¤«¿ j = 0; 1; : : : ; n ; 1. ®«¥¥ ²®£®, ° § m(1)
0 = 0, ²® u0 = m0 ;
¯®±ª®«¼ª³ i ¬« ¤¸¨µ ¡¨²®¢ ³ ·¨±¥« m(i) ¨ v (i;1) ° ¢­» 0, ¬» ¨¬¥¥¬
u(ji) = u(i ; 1)j ¤«¿ i = 2; 3; : : : ; n ; 1 ¨ j = 0; 1; : : : ; i ; 1. «¥¤®i
¢ ²¥«¼­®, p0 = m(0)
0 ¨ ¤ «¥¥ pi = ui ¯°¨ i = 1; 2; : : : ; n ; 1.  ª
®¯°¥¤¥«¿¾²±¿ n ¬« ¤¸¨µ ° §°¿¤®¢ ¯°®¨§¢¥¤¥­¨¿. ² °¸¨¥ ° §°¿¤» ¯°®¨§¢¥¤¥­¨¿ ¢»·¨±«¿¾²±¿ ± ¯®¬®¹¼¾ ®¤­®© ¨§ ±µ¥¬ ¯°¥¤»¤³¹¥£® ° §¤¥« :
hp2n;1; p2n;2; : : : ; pni =
= hu(2nn;;1)2 ; u(2nn;;1)3 ; : : : ; u(nn;1)i + hv2(nn;;1)2 ; v2(nn;;1)3 ; : : : ; vn(n;1)i:
29.3.2.  ° ª²¥°¨±²¨ª¨ ±µ¥¬»
«®¦¥­¨¥ ± § ¯®¬¨­ ­¨¥¬ ¯¥°¥­®±®¢ ¢ª«¾· ¥² n ; 1 ¸ £ ¨ ²°¥¡³¥² ¢°¥¬¥­¨ (n). ®±«¥ ½²®£® £®²®¢» ¬« ¤¸¨¥ ¡¨²» ¯°®¨§¢¥¤¥­¨¿
¨ ±« £ ¥¬»¥ ¤«¿ ¯®±«¥¤­¥£® ±«®¦¥­¨¿, ª®²®°®¥ ¬®¦­® ¢»¯®«­¿²¼
«¨¡® §  ¢°¥¬¿ (n), «¨¡® §  ¢°¥¬¿ (lg n) | ¯®±«¥¤­¥¥ ­¥ ¤ ¥²
¡®«¼¸®© ½ª®­®¬¨¨, ² ª ª ª ±³¬¬ °­®¥ ¢°¥¬¿ ° ¡®²» ¢±¥ ° ¢­® ±®±² ¢«¿¥² (n).
µ¥¬  ±®¤¥°¦¨² n2 ½«¥¬¥­²®¢ AND, ¯°¨¬¥°­® ±²®«¼ª® ¦¥ ±³¬¬¨°³¾¹¨µ ½«¥¬¥­²®¢ ¨ ±³¬¬ ²®° ° §¬¥°  (n). ®½²®¬³ ¥¥ ° §¬¥°
±®±² ¢«¿¥² (n2 ).
29.3.3. ¬­®¦¥­¨¥ ± ¯®¬®¹¼¾ ¤¥°¥¢  ®««¥± 
¥°¥¢® ®««¥±  (Wallace tree) ±¢®¤¨² § ¤ ·³ ±«®¦¥­¨¿ n ·¨±¥«
° §¬¥°  n ª ±«®¦¥­¨¾ ¤¢³µ ·¨±¥« ° §¬¥°  (n). ²® ¤¥« ¥²±¿ ² ª:
¨±¯®«¼§³¿ bn=3c ±³¬¬ ²®°®¢ ± § ¯®¬¨­ ­¨¥¬ ¯¥°¥­®±®¢, ¬» ±¢®¤¨¬
±«®¦¥­¨¥ n ·¨±¥« ª ±«®¦¥­¨¾ d2n=3e ·¨±¥«. ²  ¯°®¶¥¤³°  ¯®¢²®°¿¥²±¿ ¤® ²¥µ ¯®°, ¯®ª  ­¥ ®±² ­¥²±¿ ¢±¥£® ¤¢  ±« £ ¥¬»µ.   ª ¦¤®¬

µ¥¬» ¤«¿ ³¬­®¦¥­¨¿

621

½² ¯¥ ¯ ° ««¥«¼­® ° ¡®² ¾¹¨¥ ±³¬¬ ²®°» ²°¥¡³¾² ¢°¥¬¥­¨ O(1),
½² ¯®¢ (lg n), ¯®±«¥¤­¥¥ ±«®¦¥­¨¥ (± ¯°¥¤¢»·¨±«¥­¨¥¬ ¯¥°¥­®±®¢)
²®¦¥ ²°¥¡³¥² ¢°¥¬¥­¨ (lg n), ² ª ·²® ®¡¹¥¥ ¢°¥¬¿ ¡³¤¥² (lg n)
¯°¨ ° §¬¥°¥ (n2 ).
¥°¥¢® ®««¥±  ¤«¿ n = 8 ¯®ª § ­® ­  °¨±. 29.16.   ± ¬®¬ ¤¥«¥
½²® ­¥ ¤¥°¥¢®,   ®°¨¥­²¨°®¢ ­­»© £° ´ ¡¥§ ¶¨ª«®¢, ­® ¬» ±®µ° ­¿¥¬ ²° ¤¨¶¨®­­®¥ ­ §¢ ­¨¥. » ±ª« ¤»¢ ¥¬ 8 · ±²¨·­»µ ¯°®¨§¢¥¤¥­¨© m(0); : : : ; m(7), ·¨±«  ­  ±²°¥«ª µ ³ª §»¢ ¾² ª®«¨·¥±²¢®
° §°¿¤®¢ ¢ ±ª« ¤»¢ ¥¬»µ ·¨±« µ (m(i) ±®¤¥°¦¨² n+i ¡¨²®¢, ® ·¨±«¥
¡¨²®¢ ­  ¢»µ®¤¥ ±³¬¬ ²®°  ± § ¯®¬¨­ ­¨¥¬ ¯¥°¥­®±®¢ ±¬. ³¯° ¦­¥­¨¥ 29.3-3). ®±«¥¤­¥¥ ±«®¦¥­¨¥ (±« £ ¥¬»¥ ¨¬¥¾² ¤«¨­» 2n ; 1
¨ 2n, ±³¬¬  ¨¬¥¥² ¤«¨­³ 2n) ¢»¯®«­¿¥²±¿ ± ¯®¬®¹¼¾ ±³¬¬ ²®°  ±
¯°¥¤¢»·¨±«¥­¨¥¬ ¯¥°¥­®±®¢.
¨±. 29.16

29.16 ¥°¥¢® Wallace'  ¤«¿ ±«®¦¥­¨¿ · ±²¨·­»µ ¯°®¨§¢¥¤¥­¨©

m(0) ; : : : ; m(7) .  ¦¤ ¿ ±²°¥«ª  ®¡®§­ · ¥² ·¨±«® ³ª § ­­®© ° §°¿¤­®±²¨.

29.3.4.  ° ª²¥°¨±²¨ª¨ ±µ¥¬»
¡®§­ ·¨¬ £«³¡¨­³ ¤¥°¥¢  ®««¥±  ¤«¿ n ±« £ ¥¬»µ ·¥°¥§ D(n).
  ª ¦¤®¬ ³°®¢­¥ ¨§ ª ¦¤»µ ²°¥µ ·¨±¥« ¤¥« ¥²±¿ ¯® ¤¢ , ¤  ¥¹¥
¤¢  ¬®¦¥² ®±² ²¼±¿ (ª ª ±«³·¨«®±¼ ­  ¯¥°¢®¬ ¸ £¥ ­  °¨±. 29.16),
² ª ·²®
8
¥±«¨ n 6 2;
< 0
D(n) = : 1
¥±«¨ n = 3;
D(d2n=3e) + 1 ¥±«¨ n > 4
²±¾¤  ¢ ±¨«³ ²¥®°¥¬» 4.1 (±«³· © 2) ¨¬¥¥¬ D(n) = (lg n).  ±²¨·­»¥ ¯°®¨§¢¥¤¥­¨¿ ¬®£³² ¡»²¼ ¢»·¨±«¥­» §  ¢°¥¬¿ (1), ª ¦¤»© ¨§ ¸ £®¢ ±«®¦¥­¨¿ ± § ¯®¬¨­ ­¨¥¬ ¯¥°¥­®±®¢ ² ª¦¥ ²°¥¡³¥²
¢°¥¬¥­¨ (1),   ±«®¦¥­¨¥ ¤¢³µ ±« £ ¥¬»µ ° §¬¥°  (n) (¯®±«¥¤­¨©
¸ £) ²°¥¡³¥² ¢°¥¬¥­¨ (lg n). ®½²®¬³ ®¡¹¥¥ ¢°¥¬¿ ° ¡®²» ±®±² ¢«¿¥² (lg n).
®ª ¦¥¬ ²¥¯¥°¼, ·²® ° §¬¥° ±µ¥¬» ° ¢¥­ (n2 ). ±­®, ·²® ®­ ±®±² ¢«¿¥² ­¥ ¬¥­¥¥ 
(n2), ¯®±ª®«¼ª³ ³¦¥ ­  ¢¥°µ­¥¬ ¿°³±¥ ¨¬¥¥²±¿
d2n=3e ¡«®ª®¢, ª ¦¤»© ¨§ ª®²®°»µ ±®¤¥°¦¨² ­¥ ¬¥­¥¥ n ±³¬¬ ²®°®¢. ¶¥­¨¬ ²¥¯¥°¼ ° §¬¥° ±µ¥¬» ±¢¥°µ³. ®±ª®«¼ª³ °¥§³«¼² ²
±«®¦¥­¨¿ ¨¬¥¥² 2n ° §°¿¤®¢, ·¨±«® ±³¬¬ ²®°®¢ ¢ ª ¦¤®¬ ¨§ ¡«®ª®¢
­¥ ¯°¥¢®±µ®¤¨² 2n. ±² ¥²±¿ ¯®ª § ²¼, ·²® ·¨±«® ¡«®ª®¢ (®¡®§­ ·¨¬ ¥£® C (n)) ­¥ ¯°¥¢®±µ®¤¨² O(n).  ± ¬®¬ ¤¥«¥,

1 ¥±«¨ n = 3;
C (n) = C (d2n=3e) + bn=3c ¥±«¨ n > 4
®²ª³¤  ¢ ±¨«³ ²¥®°¥¬» 4.1 (±«³· © 3) ±«¥¤³¥², ·²® C (n) = (n).
 ª¨¬ ®¡° §®¬, ®¡¹¥¥ ·¨±«® ½«¥¬¥­²®¢ ¢® ¢±¥µ ±³¬¬ ²®° µ ¤¥°¥-

622

« ¢  29 °¨´¬¥²¨·¥±ª¨¥ ±µ¥¬»

¢  ®««¥±  ­¥ ¯°¥¢®±µ®¤¨² (n2 ).  ª ¦¥ ®¶¥­ª  ±¯° ¢¥¤«¨¢  ¤«¿
½«¥¬¥­²®¢, ¢»·¨±«¿¾¹»µ · ±²¨·­»¥ ¯°®¨§¢¥¤¥­¨¿,   ±³¬¬ ²®° ±
¯°¥¤¢»·¨±«¥­¨¥¬ ¯¥°¥­®±®¢ ¨¬¥¥² ° §¬¥° (n). ­ ·¨², ° §¬¥°
¢±¥£® ³¬­®¦¨²¥«¿ ° ¢¥­ (n2 ).
®²¿ ³¬­®¦¨²¥«¼ ± ¯®¬®¹¼¾ ¤¥°¥¢  ®««¥±  ¨¬¥¥² ( ±¨¬¯²®²¨·¥±ª¨) ²®² ¦¥ ° §¬¥°, ·²® ¨ ¬ ²°¨·­»©, ¨ ¯°¨ ½²®¬ ° ¡®² ¥² ( ±¨¬¯²®²¨·¥±ª¨) ¡»±²°¥¥, ®­ ­¥ ±²®«¼ ³¤®¡¥­ ­  ¯° ª²¨ª¥,
² ª ª ª ¨¬¥¥² ­¥°¥£³«¿°­³¾ ±²°³ª²³°³ (¨ ½«¥¬¥­²» ²°³¤­® ¯«®²­® ° §¬¥±²¨²¼ ­  ¯« ²¥). ®½²®¬³ ¨±¯®«¼§³¥²±¿ ¯°®¬¥¦³²®·­»©
¢ °¨ ­²: · ±²¨·­»¥ ¯°®¨§¢¥¤¥­¨¿ ° §¡¨¢ ¾²±¿ ­  ¤¢¥ ¯®«®¢¨­»,
ª ¦¤ ¿ ±ª« ¤»¢ ¥²±¿ ± ¯®¬®¹¼¾ ¬ ²°¨·­®£® ³¬­®¦¨²¥«¿, ¨§ 4
®±² ¢¸¨µ±¿ ·¨±¥« ¤¥« ¥² ¤¢  ± ¯®¬®¹¼¾ ¤¢³ª°¢²­®£® ¨±¯®«¼§®¢ ­¨¿ ±³¬¬ ²®°  ± § ¯®¬¨­ ­¨¥¬ ¯¥°¥­®±®¢, ­ ª®­¥¶, ¤¢  ·¨±« 
±ª« ¤»¢ ¾²±¿ ± ¯®¬®¹¼¾ ±³¬¬ ²®°  ± ¯°¥¤¢»·¨±«¥­¨¥¬ ¯¥°¥­®±®¢. ²® ¯®·²¨ ¢¤¢®¥ ³¬¥­¼¸ ¥² § ¤¥°¦ª³ ¯® ±° ¢­¥­¨¾ ± ®¤­¨¬
¬ ²°¨·­»¬ ³¬­®¦¨²¥«¥¬.
29.3.5. ¯° ¦­¥­¨¿
29.3-1 ®ª ¦¨²¥, ·²® ¢ ¬ ²°¨·­®¬ ³¬­®¦¨²¥«¥ vj(i) = 0 ¯°¨ j =
0; 1; : : : ; i; i + n; i + n + 1; : : : ; 2n ; 1.
29.3-2 §¬¥­¨²¥ ±µ¥¬³ ¬ ²°¨·­®£® ³¬­®¦¨²¥«¿ ­  °¨±. 29.14 ² ª,
·²®¡» ¢ ¢¥°µ­¥¬ °¿¤³ ¨§ ±³¬¬¨°³¾¹¨µ ½«¥¬¥­²®¢ FA(1)
i ®±² «±¿
²®«¼ª® ®¤¨­.
29.3-3 ³±²¼ ¯°¨ ±«®¦¥­¨¨ ± § ¯®¬¨­ ­¨¥¬ ¯¥°¥­®±®¢ ¨§ ·¨±¥« x,
y ¨ z ¯®«³· ¾²±¿ ·¨±«  s ¨ c. ³±²¼ nx ; ny ; nx; nc; ns | ° §°¿¤­®±²¨
±®®²¢¥²±²¢³¾¹¨µ ·¨±¥« ¨ nx 6 ny 6 nz . ®ª ¦¨²¥, ·²® ns = nz ¨


n ¥±«¨ n < n ;
nc = n + 1z ¥±«¨ ny = nz
z
y
z
29.3-4 ®ª § ²¼, ·²® ¤®¯®«­¨²¥«¼­®¥ ®£° ­¨·¥­¨¥ O(1) ­  ¢»µ®¤­³¾ ±²¥¯¥­¼ ¢±¥µ ¯°®¢®¤®¢ ­¥ ¬¥¸ ¥² ¯®±²°®¨²¼ ±µ¥¬³ ³¬­®¦¨²¥«¿
£«³¡¨­» O(lg n) ¨ ° §¬¥°  O(n2 ).
29.3-5 ®±²°®©²¥ ½´´¥ª²¨¢­³¾ ±µ¥¬³ ¤«¿ ¤¥«¥­¨¿ ¤¢®¨·­®£® ·¨±«  ­  3. (ª § ­¨¥. 0:010101 : : : = 0:01  1:01  1:0001  : : : ).
29.3-6 µ¥¬  ¶¨ª«¨·¥±ª®£® ±¤¢¨£  (cyclic shifter, barrel shifter)
¨¬¥¥² ¤¢  ¢µ®¤  x = hxn;1 ; xn;2 ; : : : ; x0i ¨ s = hsm;1 ; sm;2 ; : : : ; s0i,
£¤¥ m = d(lg n)e ¨ ¢»µ®¤ y = hyn;1 ; yn;2 ; : : : ; y0i, ¯®«³· ¥¬»© ¨§ x
¶¨ª«¨·¥±ª¨¬ ±¤¢¨£®¬ ­  s ¯®§¨¶¨© ¢¯° ¢®: yi = x(i+s)modn ¯°¨ (i =
0; 1; : : : ; n ; 1).  ª ®¯¨± ²¼ ½²³ ´³­ª¶¨¾ ¢ ²¥°¬¨­ µ ³¬­®¦¥­¨¿
®±² ²ª®¢?

 ª²¨°®¢ ­­»¥ ±µ¥¬»

623

29.4.  ª²¨°®¢ ­­»¥ ±µ¥¬»
®±ª®«¼ª³ ±µ¥¬  ¨§ ´³­ª¶¨®­ «¼­»µ ½«¥¬¥­²®¢ ­¥ ±®¤¥°¦¨² ¶¨ª«®¢, ª ¦¤»© ½«¥¬¥­² ¢ ­¥© ¨±¯®«¼§³¥²±¿ ²®«¼ª® ®¤¨­ ° §. «¥¬¥­²» § ¤¥°¦ª¨ ¯®§¢®«¿¾² ¨±¯®«¼§®¢ ²¼ ®¤¨­ ¨ ²®² ¦¥ ´³­ª¶¨®­ «¼­»© ½«¥¬¥­² ¬­®£®ª° ²­® (¢ ° §­»¥ ¬®¬¥­²» ¢°¥¬¥­¨), ·²®
¯®§¢®«¿¥² ³¬¥­¼¸¨²¼ ° §¬¥° ±µ¥¬».
 ½²®¬ ° §¤¥«¥ ° ±±¬ ²°¨¢ ¾²±¿ ² ª²¨°®¢ ­­»¥ ±µ¥¬» (clocked
circuits) ¤«¿ ±«®¦¥­¨¿ ¨ ³¬­®¦¥­¨¿. ±²°®©±²¢® ¯®¡¨²®¢®£® ±«®¦¥­¨¿ ¨¬¥¥² ° §¬¥° (1) ¨ ±ª« ¤»¢ ¥² ¤¢  n-° §°¿¤­»µ ·¨±«  § 
¢°¥¬¿ (n). ¨­¥©­»© ³¬­®¦¨²¥«¼ ³¬­®¦ ¥² ¤¢  n-§­ ·­»µ ·¨±« 
§  ¢°¥¬¿ (n) ¨ ¨¬¥¥² ° §¬¥° (n).
29.4.1. ±²°®©±²¢® ¯®¡¨²®¢®£® ±«®¦¥­¨¿
  °¨±. 29.17 ¯®ª § ­  ±µ¥¬  ¤«¿ ±«®¦¥­¨¿ ¤¢³µ n-° §°¿¤­»µ
·¨±¥« a = han;1 ; an;2 : : : ; a0i ¨ b = hbn;1 ; bn;2 : : : ; b0i, ±®±²®¿¹ ¿
²®«¼ª® ¨§ ®¤­®£® ±³¬¬ ²®° . ¨²» ¯®±²³¯ ¾² ­  ¢µ®¤» ¯®±«¥¤®¢ ²¥«¼­®: ±­ · «  a0 ¨ b0, § ²¥¬ a1 ¨ b1, ¨ ². ¤. °¨ ½²®¬ ¢»µ®¤­®©
¡¨² ¯¥°¥­®±  ­ ¤® ¯®¤ ²¼ ­  ¢µ®¤ ±³¬¬ ²®° , ­® ­¥ ±° §³,   ¢ ¬®¬¥­² ¯®±²³¯«¥­¨¿ ±«¥¤³¾¹¥£® ° §°¿¤ .
¨±. 29.17 ±²°®©±²¢® ¯®¡¨²®¢®£® ±«®¦¥­¨¿. ¥¦¤³ i-¬ ¨ (i + 1)-¬ ¨¬¯³«¼± ¬¨ ­  ¢µ®¤» ±³¬¬ ²®°  FA ¯®±²³¯ ¾² §­ ·¥­¨¿ ai ¨ bi ¨§¢­¥ ¨ §­ ·¥­¨¥ ci ¨§
°¥£¨±²° . ³¬¬ ²®° ¢»·¨±«¿¥² §­ ·¥­¨¿ si ¨ ci+1 ; ¯®±«¥¤­¥¥ § ¯®¬¨­ ¥²±¿ ¢
°¥£¨±²°¥ ¤«¿ ±«¥¤³¾¹¥£® ¸ £ .  ­ · «¼­»© ¬®¬¥­² °¥£¨±²° ±®¤¥°¦¨² §­ ·¥­¨¥ c0 = 0.   °¨±³­ª µ (a)-(e) ¯®ª § ­» ¯¿²¼ ½² ¯®¢ ±«®¦¥­¨¿ ·¨±¥« a = h1011i
¨ b = h1001i

 ª ¿ § ¤¥°¦ª  ®±³¹¥±²¢«¿¥²±¿ ¢ ² ª²¨°®¢ ­­»µ ±µ¥¬ µ
(clocked circuits).  ª ¿ ±µ¥¬  ±®¤¥°¦¨² ®¤¨­ ¨«¨ ­¥±ª®«¼ª® °¥£¨±²°®¢ (½«¥¬¥­²®¢ § ¤¥°¦ª¨),   ² ª¦¥ ±µ¥¬³ ¨§ ´³­ª¶¨®­ «¼­»µ
½«¥¬¥­²®¢, ¢µ®¤ ¬¨ ª®²®°®© ¿¢«¿¾²±¿, ¯®¬¨¬® ¢µ®¤®¢ ² ª²¨°®¢ ­­®© ±µ¥¬», ¢»µ®¤» °¥£¨±²°®¢. ¥ ¢»µ®¤» ±«³¦ ² ¢»µ®¤ ¬¨
² ª²¨°®¢ ­­®© ±µ¥¬»,   ² ª¦¥ ¢µ®¤ ¬¨ °¥£¨±²°®¢.  ª ¨ ° ­¼¸¥, ±µ¥¬  ¨§ ´³­ª¶¨®­ «¼­»µ ½«¥¬¥­²®¢ ­¥ ¤®«¦­  ¨¬¥²¼ ¶¨ª«®¢
(®¡° ²­ ¿ ±¢¿§¼ ®±³¹¥±²¢«¿¥²±¿ ²®«¼ª® ·¥°¥§ ½«¥¬¥­²» § ¤¥°¦ª¨).
«¥¬¥­² § ¤¥°¦ª¨, ¨«¨ °¥£¨±²° (register) ¯®«³· ¥² ±¨£­ «»
² ª²®¢®£® £¥­¥° ²®°  (clock), ª®²®°»© ·¥°¥§ ° ¢­»¥ ¯°®¬¥¦³²ª¨ ¢°¥¬¥­¨ ¢»¤ ¥² ² ª²®¢»¥ ¨¬¯³«¼±» (ticks). » ±·¨² ¥¬, ·²®
­ ¸¨ ±µ¥¬» ¨¬¥¾² ®¡¹¨© ¤«¿ ¢±¥µ °¥£¨±²°®¢ ² ª²®¢»© £¥­¥° ²®°
(globally clocked circuits).
°¨ ª ¦¤®¬ ¨¬¯³«¼±¥ °¥£¨±²° § ¯®¬¨­ ¥² ²¥ª³¹¥¥ §­ ·¥­¨¥ ­ 
¢µ®¤¥. ±«¥¤ §  ½²¨¬ ½²® §­ ·¥­¨¥ ¯®¿¢«¿¥²±¿ ­  ¢»µ®¤¥, ¨ ²¥¬
± ¬»¬ ¯®±²³¯ ¥² ­  ¢µ®¤» ±µ¥¬» ¨§ ´¶­ª¶¨®­ «¼­»µ ½«¥¬¥­²®¢.

624

« ¢  29 °¨´¬¥²¨·¥±ª¨¥ ±µ¥¬»

»µ®¤­»¥ §­ ·¥­¨¿ ½²®© ±µ¥¬» ¯®±²³¯ ¾² ­  ¢µ®¤» °¥£¨±²°®¢, ­®
­¥ ¢®±¯°¨­¨¬ ¾²±¿ ¨¬¨ ¤® ±«¥¤³¾¹¥£® ² ª²®¢®£® ¨¬¯³«¼± .
µ¥¬ , ¨§®¡° ¦¥­­ ¿ ­  °¨±. 29.17, ­ §»¢ ¥²±¿ ³±²°®©±²¢®¬ ¯®¡¨²®¢®£® ±«®¦¥­¨¿ (bit-serial adder). ²®¡» ±µ¥¬  ° ¡®² «  ¯° ¢¨«¼­®, ¯¥°¨®¤ ¬¥¦¤³ ¨¬¯³«¼± ¬¨ ¤®«¦¥­ ¡»²¼ ­¥ ¬¥­¼¸¥ § ¤¥°¦ª¨ ±³¬¬ ²®°  (¨­ ·¥ ª ±«¥¤³¾¹¥¬³ ²¨ª³ ­¥ ¡³¤¥² £®²®¢ ¢»µ®¤­®©
¡¨² ¯¥°¥­®± ). ­ ·¥­¨¿ ­  ¢µ®¤» ¯®¤ ¾²±¿ ± ¨­²¥°¢ «®¬ ¢ ®¤¨­
¯¥°¨®¤.  ¬®¬¥­² ¯¥°¢®£® ² ª²®¢®£® ¨¬¯³«¼±  ­  ¢µ®¤» ±³¬¬ ²®°  ¯®¤ ¾²±¿ §­ ·¥­¨¿ a0, b0 ¨ 0 (°¨±. 29.17 (a); ¬» ¯°¥¤¯®« £ ¥¬,
¢ ­ · «¼­®¬ ±®±²®¿­¨¨ ­  ¢»µ®¤¥ °¥£¨±²°  ¨¬¥¥²±¿ §­ ·¥­¨¥ 0).
  ¢»µ®¤¥ ·¥°¥§ ­¥ª®²®°®¥ ¢°¥¬¿ ¯®¿¢«¿¾²±¿ ¡¨² ±³¬¬» s0 (ª®²®°»© ¢»¤ ¥²±¿ ­ °³¦³) ¨ ¡¨² ¯¥°¥­®±  c1 . ¨² ¯¥°¥­®±  ¯®±²³¯ ¥²
(¯® ¯°®¢®¤³) ­  ¢µ®¤ °¥£¨±²° , ­® «¨¸¼ ¯®±«¥ ¢²®°®£® ¨¬¯³«¼± 
¯®¿¢«¿¥²±¿ ­  ¢»µ®¤¥ °¥£¨±²° . ¬¥±²¥ ±® §­ ·¥­¨¿¬¨ a1 ¨ b1 ®­
¤ ¥² ­  ¢»µ®¤¥ s1 ¨ c2 (°¨±. 29.17(b)) ¨ ². ¤.  ª ¯°®¤®«¦ ¥²±¿, ¯®ª 
­¥ ¡³¤³² ®¡° ¡®² ­» ¢±¥ ° §°¿¤» ±« £ ¥¬»µ, ¯®±«¥ ·¥£® ­  ¢µ®¤»
¯®¤ ¾²±¿ ­³«¨ (an = 0, bn = 0), ¨ ­  ¢»µ®¤ ¯®¤ ¥²±¿ ±² °¸¨© ° §°¿¤ ±³¬¬» (±®¢¯ ¤ ¾¹¨© ± ¯®±«¥¤­¨¬ ¡¨²®¬ ¯¥°¥­®± ; sn = cn )
±¬. °¨±. 29.17(e).
29.4.2.  ° ª²¥°¨±²¨ª¨ ±µ¥¬»
 ª ¬» £®¢®°¨«¨, ² ª²®¢ ¿ · ±²®²  § ¢¨±¨² ®² § ¤¥°¦ª¨ ¢ ±µ¥¬¥ ¨§ ´³­ª¶¨®­ «¼­»µ ½«¥¬¥­²®¢ (¢ ¤ ­­®¬ ±«³· ¥ | § ¤¥°¦ª¨
¢ ½«¥¬¥­²¥ ±³¬¬¨°®¢ ­¨¿ FA), ¯®±ª®«¼ª³ ¢±¥ ¢»·¨±«¥­¨¿ ¤®«¦­»
§ ª®­·¨²¼±¿ ¤® ­ · «  ±«¥¤³¾¹¥£® ² ª²®¢®£® ¨¬¯³«¼± .  ¤ ­­®¬
±«³· ¥ ±³¬¬ ²®° ¨¬¥¥² £«³¡¨­³ (1),   ¤«¿ ¯®«³·¥­¨¿ ¢±¥µ ¢»µ®¤®¢
­¥®¡µ®¤¨¬® n +1 ¯¥°¨®¤®¢, ² ª ·²® ®¡¹¥¥ ¢°¥¬¿ ° ¡®²» ±®±² ¢«¿¥²
(n + 1)(1) = (n).  §¬¥° ±µ¥¬» ° ¢¥­ (1).
29.4.3.  ±ª ¤­®¥ ±«®¦¥­¨¥ ¨ ¯®¡¨²®¢®¥ ±«®¦¥­¨¥
 ±ª ¤­»© ±³¬¬ ²®° ¬®¦­® ° ±±¬ ²°¨¢ ²¼ ª ª ° §¢¥°­³²³¾
±µ¥¬³ ³±²°®©±²¢  ¯®¡¨²®¢®£® ±«®¦¥­¨¿: ²¥¯¥°¼ §  ª ¦¤»© ¯¥°¨®¤ ¬¥¦¤³ ¨¬¯³«¼± ¬¨ ®²¢¥· ¥² ±¢®© ±³¬¬ ²®°.
 ª®¥ ° §¢¥°²»¢ ­¨¥, § ¬¥­¿¾¹¥¥ ¢°¥¬¿ ¯°®±²° ­±²¢®¬, ¬®¦­® ±¤¥« ²¼ ¤«¿ «¾¡®© ² ª²¨°®¢ ­­®© ±µ¥¬», ±®¥¤¨­¿¿ ­¥±ª®«¼ª®
½ª§¬¥¯«¿°®¢ ±µ¥¬» (±²®«¼ª®, ±ª®«¼ª® ² ª²®¢ ²°¥¡³¥² ¥¥ ° ¡®² ).
®­¥·­®, ¯°¨ ½²®¬ ³¢¥«¨·¨¢ ¥²±¿ ·¨±«® ½«¥¬¥­²®¢ | § ²® ­¥
­³¦­» ±¨­µ°®­¨§¨°³¾¹¨¥ ¨¬¯³«¼±» ®² ² ª²®¢®£® £¥­¥° ²®° .  ª ¿ ±µ¥¬  ­  ¯° ª²¨ª¥ ° ¡®² ¥² ­¥±ª®«¼ª® ¡»±²°¥¥, ¯®±ª®«¼ª³ ¢
² ª²¨°®¢ ­­®© ±µ¥¬¥ ­  ª ¦¤®¬ ² ª²¥ ­³¦­® ®±² ¢«¿²¼ ­¥ª®²®°»© § ¯ ± ¢°¥¬¥­¨ (·²®¡» ¢»·¨±«¥­¨¿ ³±¯¥«¨ ¯°®¨§®©²¨),   ¯®±«¥
° §¢¥°²»¢ ­¨¿ ¢»µ®¤» ª ±ª ¤  ±° §³ ¦¥ ¯®¯ ¤ ¾² ­  ¢µ®¤» ±«¥¤³¾¹¥£®, ­¨·¥£® ­¥ ®¦¨¤ ¿.

 ª²¨°®¢ ­­»¥ ±µ¥¬»

625

29.4.4. ¤­®¬¥°­»© ³¬­®¦¨²¥«¼
 ²°¨·­»© ³¬­®¦¨²¥«¼, ° ±±¬®²°¥­­»© ¢ ° §¤¥«¥ 29.3, ¨¬¥¥²
° §¬¥° (n2 ).  ½²®¬ ° §¤¥«¥ ¬» ° ±±¬®²°¨¬ ¤¢  ² ª²¨°®¢ ­­»µ
³¬­®¦¨²¥«¿, ¨±¯®«¼§³¾¹¨µ ®¤­®¬¥°­»© ¬ ±±¨¢ ½«¥¬¥­²®¢ (° §¬¥°  (n)) ¢¬¥±²® ¤¢³¬¥°­®£®. ®«¥¥ ¡»±²­»© ¨§ ­¨µ ¨¬¥¥² ¢°¥¬¿
° ¡®²» (n) (ª ª ¨ ¬ ²°¨·­»© ³¬­®¦¨²¥«¼)
¡  ½²¨µ ³¬­®¦¨²¥«¿ ¨±¯®«¼§³¾²  «£®°¨²¬, ª®²®°»© ¢ ¬¥°¨ª¥ ­ §»¢ ¾² °³±±ª¨¬ ­ °®¤­»¬  «£®°¨²¬®¬ ³¬­®¦¥­¨¿ (Russian
peasant's algorithm). ­ ¯®ª § ­ ­  °¨±. 29.18 (a). ®¬­®¦¨²¥«¨ a ¨
b § ¯¨±»¢ ¾²±¿ °¿¤®¬, ¨ ¯®¤ ª ¦¤»¬ ¨§ ­¨µ ¯¨¸¥²±¿ ª®«®­ª  ·¨±¥«.  «¥¢®© ª®«®­ª¥ ·¨±«® ­  ª ¦¤®¬ ¸ £¥ ¤¥«¨²±¿ ­  2 (®±² ²®ª
®²¡° ±»¢ ¥²±¿); ¢ ¯° ¢®© | ³¬­®¦ ¥²±¿ ­  2.  ª ¯°®¤®«¦ ¥²±¿
¤® ²¥µ ¯®°, ¯®ª  ¢ «¥¢®© ª®«®­ª¥ ­¥ ¡³¤¥² 1. ®±«¥ ½²®£® ±ª« ¤»¢ ¾²±¿ ·¨±«  ¨§ ¯° ¢®© ª®«®­ª¨, ±²®¿¹¨¥ ­ ¯°®²¨¢ ­¥·¥²­»µ ·¨±¥«
¢ «¥¢®©.
  ¯¥°¢»© ¢§£«¿¤ ½²®²  «£®°¨²¬ ª ¦¥²±¿ ³¤¨¢¨²¥«¼­»¬, ­® ®­
±² ­®¢¨²±¿ ¯®­¿²­»¬, ¥±«¨ § ¯¨± ²¼ ¢±¥ ·¨±«  ¢ ¤¢®¨·­®© ±¨±²¥¬¥: ¯°¨ ½²®¬ ±² ­®¢¨²±¿ ¿±­»¬, ·²® ®­ ¯°¥¤±² ¢«¿¥² ±®¡®© ¢ °¨ ­² ³¬­®¦¥­¨¿ ¢ ±²®«¡¨ª. ²°®ª¨, ¢ ª®²®°»µ ±«¥¢  ¯®¿¢«¿¥²±¿
­¥·¥²­®¥ ·¨±«®, ±®®²¢¥²±²¢³¾² ¥¤¨­¨·­»¬ ° §°¿¤ ¬ ¢ a, ¨µ ¢ª« ¤
¢ ±³¬¬³ ¥±²¼ ³¬­®¦¥­­®¥ ­  ±®®²¢¥²±²¢³¾¹³¾ ±²¥¯¥­¼ ¤¢®©ª¨ ·¨±«® b (±¬. °¨±. 29.18 (b)).
29.18 ¬­®¦¥­¨¥ 19 ­  29 ± ¯®¬®¹¼¾ °³±±ª®£® ­ °®¤­®£®  «£®°¨²¬ .  ª®«®­ª¥ a ª ¦¤®¥ ±«¥¤³¾¹¥¥ ·¨±«® ¯®«³· ¥²±¿ ¨§ ¯°¥¤»¤³¹¥£® ¤¥«¥­¨¥¬
­  2 (®±² ²®ª ®²¡° ±»¢ ¥²±¿),   ¢ ª®«®­ª¥ b -³¬­®¦¥­¨¥¬ ­  2. ª« ¤»¢ ¾²±¿ ·¨±«  ¨§ ¯° ¢®© ª®«®­ª¨, ­ ¯°®²¨¢ ª®²®°»µ ±²®¿² ­¥·¥²­»¥ ·¨±«  ¢ «¥¢®©
(¢»¤¥«¥­» ±¥°»¬ ¶¢¥²®¬). (a) «®¦¥­¨¥ ¢ ¤¥±¿²¨·­®© ±¨±²¥¬¥. (b) ® ¦¥ ¢
¤¢®¨·­®© ±¨±²¥¬¥.
¨±. 29.18

29.4.5. °®±² ¿ °¥ «¨§ ¶¨¿
°®±²®© ¢ °¨ ­² °¥ «¨§ ¶¨¨ °³±±ª®£® ­ °®¤­®£®  «£®°¨²¬  ¢
¢¨¤¥ ² ª²¨°®¢ ­­®© ±µ¥¬» ³¬­®¦¥­¨¿ n-¡¨²®¢»µ ·¨±¥« ¯®ª § ­ ­ 
°¨±. 29.19 (a).  ­¥¬ ¨±¯®«¼§³¥²±¿ 2n £°³¯¯ ¯® 3 °¥£¨±²° . ¥°µ­¨¥ °¥£¨±²°» µ° ­¿² ¡¨²» ±®¬­®¦¨²¥«¿ a, ±°¥¤­¨¥ ®²¢¥· ¾² § 
±®¬­®¦¨²¥«¼ b,   ¢ ­¨¦­»µ ¯®±²¥¯¥­­® ´®°¬¨°³¥²±¿ ¯°®¨§¢¥¤¥­¨¥
p. ®¤¥°¦¨¬®¥ i-£® a-°¥£¨±²°  ¯¥°¥¤ j -¬ ¸ £®¬ ®¡®§­ · ¥²±¿ a(i j);
 ­ «®£¨·­® ¤«¿ b ¨ p. ¬¥±²¥ ¢±¥ ¡¨²» ¢ a-°¥£¨±²° µ ®¡° §³¾²
¤¢®¨·­³¾ § ¯¨±¼ ·¨±« , ª®²®°®£®¥ ®¡®§­ ·¥²±¿ a(j ) (¯® ±®±²®¿­¨¾
¯¥°¥¤ j -¬ ¸ £®¬); ®¡®§­ ·¥­¨¿ b(j ), p(j ) ¨¬¥¾²  ­ «®£¨·­»© ±¬»±«.
 £¨ ° ¡®²» ­³¬¥°³¾²±¿ ·¨±« ¬¨ ®² 0 lj n ; 1. ­ · «¥ a(0) = a,
(0)
b = b ¨ p(0) = 0. ®¤¤¥°¦¨¢ ¥²±¿ ¨­¢ °¨ ­²
a(j)  b(j ) + p(j) = a  b
(29:6)

626

« ¢  29 °¨´¬¥²¨·¥±ª¨¥ ±µ¥¬»

(±¬. ³¯° ¦­¥­¨¥ 29.4-2).   j -¬ ¸ £¥ ¯°®¨§¢®¤¿²±¿ ±«¥¤³¾¹¨¥ ¤¥©±²¢¨¿:
1. ±«¨ a(0j ) = 1 (². ¥. a(j ) ­¥·¥²­®), ²® p(j +1) = p(j ) + b(j ), ¨­ ·¥
p(j+1) = p(j) .
2. ¨±«® a ±¤¢¨£ ¥²±¿ ¢¯° ¢® ­  ®¤­³ ¯®§¨¶¨¾ (¤¥«¨²±¿ ­  2 ±
®±² ²ª®¬):
(
(j )
(
j
+1)
ai = ai+1 ¥±«¨ 0 6 i 6 2n ; 2
0 ¥±«¨ i = 2n ; 1
3. ¨±«® b ±¤¢¨£ ¥²±¿ ¢«¥¢® ­  ®¤­³ ¯®§¨¶¨¾ (³¬­®¦ ¥²±¿ ­  2):

b(ij +1) =

(

a(i;j )1 ¥±«¨ 1 6 i 6 2n ; 1
0 ¥±«¨ i = 0

®±«¥ n ¸ £®¢ ¯®«³· ¥¬ a(n) = 0, ¯®½²®¬³ ¨­¢ °¨ ­² £ ° ­²¨°³¥², ·²® p(n) = a  b.
 ¸  «£®°¨²¬ ²°¥¡³¥² n ¸ £®¢. ±«¨ ­  ª ¦¤®¬ ¸ £¥ ¨±¯®«¼§®¢ ²¼ ¤«¿ ±«®¦¥­¨¿ ª ±ª ¤­»© ±³¬¬ ²®°, ²® ª ¦¤»© ¸ £ § ­¨¬ ¥²
¢°¥¬¿ (n), ¯®½²®¬³ ®¡¹¥¥ ¢°¥¬¿ ° ¡®²» ±®±² ¢«¿¥² (n2 ). µ¥¬  ±®±²®¨² ¨§ 3n °¥£¨±²°®¢, ª ±ª ¤­®£® ±³¬¬ ²®°  ° §¬¥°  (n) ¨
O(n) ½«¥¬¥­²®¢, ´®°¬¨°³¾¹¨µ · ±²¨·­»¥ ¯°®¨§¢¥¤¥­¨¿ (®¯¥° ¶¨¿
AND ­ ¤ a(0j ) ¨ b-¡¨² ¬¨). ¡¹¨© ° §¬¥° ±µ¥¬» ° ¢¥­ (n).
29.19 ¢  ®¤­®¬¥°­»µ ³¬­®¦¨²¥«¿. ®ª § ­® ³¬­®¦¥­¨¥ 5-¡¨²®¢»µ
·¨±¥« a = 19 = h10011i ­  b = 29 = h11101i ¨ ±®¤¥°¦¨¬®¥ °¥£¨±²°®¢ ¯¥°¥¤ ª ¦¤»¬ ¸ £®¬; §­ · ¹¨¥ ¡¨²» ¢»¤¥«¥­» ±¥°»¬ ¶¢¥²®¬. (a) °®±²®© ³¬­®¦¨²¥«¼
(¢°¥¬¿ ° ¡®²» (n2 )).   ª ¦¤®¬ ¸ £¥ ¨±¯®«¼§³¥²±¿ ª ±ª ¤­»© ±³¬¬ ²®°, ¯®½²®¬³ ¨­²¥°¢ « ¬¥¦¤³ ² ª² ¬¨ ¤®«¦¥­ ¡»²¼ ­¥ ¬¥­¼¸¥ (n). (b) »±²°»©
³¬­®¦¨²¥«¼, ¨±¯®«¼§³¾¹¨© ±«®¦¥­¨¥ ± § ¯®¬¨­ ­¨¥¬ ¯¥°¥­®±®¢.  ¦¤»© ¸ £
²°¥¡³¥² ¢°¥¬¥­¨ (1). ±¥£® ²°¥¡³¥²±¿ 2n ; 1 = 9 ¸ £®¢, ¯®ª § ­» ¯¥°¢»¥ 5.
(®±«¥ ½²®£® ®±² ¾²±¿ ±«®¦¨²¼ u ¨ v, ¤«¿ ·¥£® ¤®±² ²®·­® ¯°®¤®«¦¨²¼ ²®² ¦¥
¯°®¶¥±± ±«®¦¥­¨¿ ± § ¯®¬¨­ ­¨¥¬ ¯¥°¥­®±®¢.)
¨±. 29.19

29.4.6. »±²° ¿ °¥ «¨§ ¶¨¿
¬¥­¼¸¥­¨¿ ¢°¥¬¥­¨ ° ¡®²» ¬®¦­® ¤®¡¨²¼±¿, ¨±¯®«¼§³¿ ¢¬¥±²® ª ±ª ¤­®£® ±«®¦¥­¨¿ ±«®¦¥­¨¥ ± § ¯®¬¨­ ­¨¥¬ ¯¥°¥­®±®¢
(±¬. °¨±. 29.19 (b)). ¥¯¥°¼ ¢¬¥±²® ²°¥µ °¥£¨±²°®¢ ­  ª ¦¤»© ° §°¿¤ ¡³¤³² ·¥²»°¥; ¢ ¤¢³µ ¨§ ­¨µ ¯®-¯°¥¦­¥¬³ µ° ­¿²±¿ ¶¨´°» ·¨±¥« a ¨ b,   ¢¬¥±²® ·¨±«  p ¡³¤² µ° ­¨²¼±¿ ¤¢  ·¨±«  u ¨ v , ¯°¨·¥¬
¯®¤¤¥°¦¨¢ ¥²±¿ ¨­¢ °¨ ­²
a(j )  b(j) + u(j) + v(j) = a  beqno(29:7)
² ª ·²® °®«¼ p ¨£° ¥² ±³¬¬  u + v (±¬. ³¯° ¦­¥­¨¥ 29.4-2). ­ · «¥ u(0) = v (0) = 0. (²® ±®®²¢¥²±²¢³¥² ¨±¯®«¼§®¢ ­¨¾  «£®°¨²¬ 

 ª²¨°®¢ ­­»¥ ±µ¥¬»

627

±«®¦¥­¨¿ ± § ¯®¬¨­ ­¨¥¬ ¯¥°¥­®±®¢ ¤«¿ µ° ­¥­¨¿ ¯°®¬¥¦³²®·­»µ
°¥§³«¼² ²®¢: ­  ª ¦¤®¬ ¸ £¥ ª ±³¬¬¥ u + v ­ ¤® ¤®¡ ¢¨²¼ ®·¥°¥¤­®¥ · ±²¨·­®¥ ¯°®¨§¢¥¤¥­¨¥, ². ¥. ­ ¤® ±«®¦¨²¼ ²°¨ ·¨±«  | ¨
¯®«³·¨²¼ ®²¢¥² ¢ ¢¨¤¥ ±³¬¬» ¤¢³µ.)
 £  «£®°¨²¬  ¢ª«¾· ¥² ±¤¢¨£¨ a ¨ b (ª ª ¨ ¢ ¬¥¤«¥­­®¬  «£®°¨²¬¥),   ² ª¦¥ ¨§¬¥­¥­¨¥ u ¨ v . ±«¨ a(0j ) = 1, ²®

u(ij +1) = parity(b(i j); u(ij ); vi(j))
¯°¨ i = 0; 1; 2; : : : ; 2n ; 1 ¨
vi(j+1) =

(

majority(b(i;j)1; u(i;j )1; vi(;j)1 ) ¥±«¨ 1 6 i 6 2n ; 1
0 ¥±«¨ i = 0

±«¨ ¦¥ a(0j ) = 0, ²® b(j ) § ¬¥­¿¥²±¿ ­  0:

u(ij +1) = parity(0; u(i j); vi(j ))
¯°¨ i = 0; 1; 2; : : : ; 2n ; 1 ¨
vi(j+1) =

(

majority(0; u(i;j)1; vi(;j )1 ) ¥±«¨ 1 6 i 6 2n ; 1
0 ¥±«¨ i = 0

±¥£® ¯°®¨§¢®¤¨²±¿ 2n ; 1 ¸ £, ¯°¨·¥¬ ¯°¨ j > n ¨¬¥¥¬ a(j ) = 0 ¨
u(j) + v (j) = a  b.  ½²®£® ¬®¬¥­²  ±³¬¬  u + v ­¥ ¬¥­¿¥²±¿,   «¨¸¼
¯¥°¥° ±¯°¥¤¥«¿¥²±¿ ¬¥¦¤³ u ¨ v .  ª®­¥¶, v ±² ­®¢¨²±¿ ° ¢­»¬ 0
¨ ±³¬¬  ®ª §»¢ ¥²±¿ ¢ u: ¯®±ª®«¼ª³ v (2n;1) = 0 (±¬. ³¯° ¦­¥­¨¥
29-4.3), u(2n;1) = a  b. ( ª¨¬ ®¡° §®¬, ­ ·¨­ ¿ ± n-£® ¸ £  ¯®
±³¹¥±²¢³ ¯°®¨±µ®¤¨² ±«®¦¥­¨¥ ¤¢³µ ·¨±¥«.)
 ª ª ª ª ¦¤»© ¸ £ § ­¨¬ ¥² ¢°¥¬¿ (1), ®¡¹¥¥ ¢°¥¬¿ ° ¡®²»
±®±² ¢«¿¥² (2n ; 1)(1) = (n).  §¬¥° ±µ¥¬» ¯®-¯°¥¦­¥¬³ ° ¢¥­
(n).
¯° ¦­¥­¨¿
29.4-1 ±¯®«¼§³¿ °³±±ª¨© ­ °®¤­»©  «£®°¨²¬, ¯¥°¥¬­®¦¼²¥ a =
h101101i ¨ b = h011110i.  ª ½²® ¢»£«¿¤¨² ¢ ¤¢®¨·­®© ¨ ¤¥±¿²¨·­®©
±¨±²¥¬ µ?
29.4-2 ®ª ¦¨²¥ ¨­¢ °¨ ­²» (29.6) ¨ (29.7).
29.4-3 ®ª ¦¨²¥, ·²® ¯°¨ ¡»±²°®© °¥ «¨§ ¶¨¨ ®¤­®¬¥°­®£®
³¬­®¦¨²¥«¿ v (2n;1) = 0.
29.4-4 ¡º¿±­¨²¥, ¯®·¥¬³ ¬ ²°¨·­»© ³¬­®¦¨²¥«¼ ¬®¦­® ° ±±¬ ²°¨¢ ²¼ ª ª ° §¢¥°­³²»© (¢ ¯°®±²° ­±²¢¥ ¢¬¥±²® ¢°¥¬¥­¨) ¢ °¨ ­² ¡»±²°®£® ®¤­®¬¥°­®£® ³¬­®¦¨²¥«¿.
29.4-5 ³±²¼ ­  ¢µ®¤ ¯®±²³¯ ¾² §­ ·¥­¨¿ x1; x2; : : : (¯® ®¤­®¬³
§  ² ª²),   ¢ ­ ¸¥¬ ° ±¯®°¿¦¥­¨¨ ¨¬¥¥²±¿ ´³­ª¶¨®­ «¼­»¥ ½«¥¬¥­²», ¢»·¨±«¿¾¹¨¥ ¬ ª±¨¬³¬ ±¢®¨µ ¤¢³µ ¢µ®¤®¢, ¨ °¥£¨±²°».

628

« ¢  29 °¨´¬¥²¨·¥±ª¨¥ ±µ¥¬»

«¿ ´¨ª±¨°®¢ ­­®£® n ¯®±²°®©²¥ ±µ¥¬³ ° §¬¥°  O(n), ª®²®° ¿ § 
¢°¥¬¿ O(1) ¢»·¨±«¿¥²

yt = t;nmax
x
+16i6t i
(¬ ª±¨¬³¬ ¨§ n ­ ¨¡®«¥¥ ±¢¥¦¨µ ½«¥¬¥­²®¢)
29.4-6* (°®¤®«¦¥­¨¥) ® ¦¥ ± ¬®¥, ¥±«¨ ¥±²¼ ²®«¼ª® O(lg n) ½«¥¬¥­²®¢ À¬ ª±¨¬³¬Á.

29.5.  ¤ ·¨
29-1. µ¥¬» ¤«¿ ¤¥«¥­¨¿
¥«¥­¨¥ ¬®¦­® ±¢¥±²¨ ª ±«®¦¥­¨¾ ¨ ³¬­®¦¥­¨¾ ± ¯®¬®¹¼¾ ¬¥²®¤  ¼¾²®­  (Newton iteration). ±­®, ·²® ¤®±² ²®·­® ¯®±²°®¨²¼
±µ¥¬³ ¤«¿ ¢»·¨±«¥­¨¿ ®¡° ²­®£® ½«¥¬¥­²  (² ª ª ª ³¬­®¦¨²¥«¼ ³
­ ± ³¦¥ ¥±²¼).
³±²¼ ´¨ª±¨°®¢ ­® ·¨±«® x, ¨ ¬» µ®²¨¬ ¢»·¨±«¨²¼ 1=x.  ±±¬®²°¨¬ ¯®±«¥¤®¢ ²¥«¼­®±²¼ y0 ; y1; y2; : : : , ¤«¿ ª®²®°®©

yi+1 = 2yi ; xyi2
³±²¼ x { n-§­ ·­ ¿ ¤¢®¨·­ ¿ ¤°®¡¼, 1=2 6 x 6 1. » µ®²¨¬ ¢»·¨±«¨²¼ 1=x ± ²®·­®±²¼¾ ¤® n §­ ª®¢ (¢®®¡¹¥-²® 1=x ±ª®°¥¥ ¢±¥£®

¡³¤¥² ¡¥±ª®­¥·­®© ¤¥±¿²·¨­®© ¤°®¡¼¾).
a. ³±²¼ jyi ; 1=xj 6 " ¤«¿ ­¥ª®²®°®£® " > 0. ®ª ¦¨²¥, ·²®
jyi+1 ; 1=xj 6 "2.
b. ª ¦¨²¥ ­ · «¼­®¥ §­ ·¥­¨¥ y0 , ¤«¿ ª®²®°®£® jyk ; 1=xj 6 2;2k
¯°¨ ¢±¥µ k > 0.  ª®¥ k ­³¦­® ¢§¿²¼, ·²®¡» ¯®«³·¨²¼ ®²¢¥² ±
²®·­®±²¼¾ ¤® n §­ ª®¢?
c. ®±²°®©²¥ ±µ¥¬³, ¢»·¨±«¿¾¹³¾ ¯® n-° §°¿¤­®¬³ ·¨±«³ x ·¨±«® 1=x ± ²®·­®±²¼¾ ¤® n §­ ª®¢ §  ¢°¥¬¿ O(lg2 n). ®¯»² ©²¥±¼
¤®¡¨²¼±¿ ° §¬¥°  (n2 lg n).
[¨²¿: ª ¦¥²±¿, beat ®§­ · ¥² `«³·¸³¾ ·¥¬' - ­® ­ ¤® ¯°®¢¥°¨²¼,
¯°®¿¢¨¢ little cleverness]
29-2. °®¯®§¨¶¨®­ «¼­»¥ ´®°¬³«» ¤«¿ ±¨¬¬¥²°¨·­»µ ¡³«¥¢»µ
´³­ª¶¨©.
³­ª¶¨¿ n  °£³¬¥­²®¢ f (x1 ; x2; : : : ; xn ) ­ §»¢ ¥²±¿ ±¨¬¬¥²°¨·­®© (symmetric), ¥±«¨ ¤«¿ «¾¡®© ¯¥°¥±² ­®¢ª¨  ·¨±¥« 1; 2; : : : ; n

f (x1; x2; : : : ; xn) = f (x(1); x(2); : : : ; x(n)
ª §»¢ ¥²±¿, «¾¡ ¿ ±¨¬¬¥²°¨·­ ¿ ¡³«¥¢  ´³­ª¶¨¿ n  °£³¬¥­²®¢
( °£³¬¥­²» ¨ §­ ·¥­¨¥ ¯°¨­ ¤«¥¦¨² f0; 1g) ¬®¦¥² ¡»²¼ ¢»° ¦¥­ 
¯°®¯®§¨¶¨®­ «¼­®© ´®°¬³«®©, ². ¥. ´®°¬³«®©, ±®¤¥°¦ ¹¥© ²®«¼ª® x1; : : : ; xn, ±ª®¡ª¨ ¨ §­ ª¨ ®¯¥° ¶¨© :, ^ ¨ _, ¯°¨·¥¬ ¤«¨­ 

®¬¬¥­² °¨¨

629

½²®© ´®°¬³«» ¯®«¨­®¬¨ «¼­® § ¢¨±¨² ®² n. «¿ ­ · «  ¬» ¯®±²°®¨¬ ¤«¿ ±¨¬¬¥²°¨·­®© ´³­ª¶¨¨ ±µ¥¬³ £«³¡¨­» O(lg n),   § ²¥¬
¨ ¨±ª®¬³¾ ´®°¬³«³. ±¥ ±µ¥¬» ¯°¥¤¯®« £ ¾²±¿ ±®±² ¢«¥­­»¬¨ ¨§
½«¥¬¥­²®¢ AND, OR ¨ NOT.
a. ®±²°®©²¥ ±µ¥¬³ £«³¡¨­» O(lg n) ¤«¿ ¤«¿ ´³­ª¶¨¨ ¡®«¼¸¨­±²¢  (majority function)

1 ¥±«¨ x1 + x2 + : : : + xn > n=2
majorityn (x1; : : : ; xn) =
0 ¨­ ·¥
(ª § ­¨¥: ¯®±²°®©²¥ ¤¥°¥¢® ±³¬¬ ²®°®¢.)
b. ³±²¼ ±³¹¥±²¢³¥² ±µ¥¬  £«³¡¨­» d, ¢»·¨±«¿¾¹ ¿ ¤ ­­³¾ ¡³«¥¢³ ´³­ª¶¨¾ f . ®ª ¦¨²¥, ·²® ²®£¤  ¤«¿ f ±³¹¥±²¢³¥² ´®°¬³« 
¤«¨­» O(2d) (¢ · ±²­®±²¨, ¤«¿ ´³­ª¶¨¨ ¡®«¼¸¨­±²¢  ±³¹¥±²¢³¥²
´®°¬³«  ¯®«¨­®¬¨ «¼­®© ¤«¨­»).
c. ®ª ¦¨²¥, ·²® ±¨¬¬¥²°¨·­ ¿ «®£¨·¥±ª ¿ ´³­ª¶¨¿ ¬®¦¥² ¡»²¼
§ ¯¨± ­  ª ª ´³­ª¶¨¿ ±³¬¬» ±¢®¨µ  °£³¬¥­²®¢.
d. ®ª ¦¨²¥, ·²® ¤«¿ ª ¦¤®© ±¨¬¬¥²°¨·­®© ¡³«¥¢®© ´³­ª¶¨¨ n
 °£³¬¥­²®¢ ±³¹¥±²¢³¥² ±µ¥¬  £«³¡¨­» O(lg n).
e. ®ª ¦¨²¥, ·²® ¤«¿ «¾¡®© ±¨¬¬¥²°¨·­®© ¡³«¥¢®© ´³­ª¶¨¨ n
 °£³¬¥­²®¢ ±³¹¥±²¢³¥² ´®°¬³« , ¤«¨­  ª®²®°®© ®£° ­¨·¥­  ¯®«¨­®¬®¬ ®² n (¥¤¨­»¬ ¤«¿ ¢±¥µ ´³­ª¶¨©)

29.6. ®¬¬¥­² °¨¨
®«¼¸¨­±²¢® ª­¨£ ¯®  °¨´¬¥²¨·¥±ª¨¬ ±µ¥¬ ¬ ®¡° ¹ ¾² ¡®«¼¸¥
¢­¨¬ ­¨¥ ­  ¯° ª²¨¢¥±ª³¾ °¥ «¨§ ¶¨¾ ±µ¥¬, ·¥¬ ­  «¥¦ ¹¨¥ ¢ ¨µ
®±­®¢¥  «£®°¨²¬». ­¨£  ½¢¥¤¦  [173] | ®¤­  ¨§ ­¥¬­®£¨µ ª­¨£,
¯®±¢¿¹¥­­ ¿  «£®°¨²¬¨·¥±ª¨¬ ¢®¯°®± ¬. ¥£ª® ·¨² ¾²±¿ ª­¨£¨
 ¢ ­ £  [39] ¨  ­£  [108] ¡®«¥¥ ¨­¦¥­¥°­®£® ±®¤¥°¦ ­¨¿. °¥¤¨
¤°³£¨µ µ®°®¸¨µ ª­¨£ ¬®¦­® ­ §¢ ²¼ ª­¨£¨ ¨««  ¨ ¥²¥°±®­  [96],
  ² ª¦¥ ®µ ¢¨ [126] (± ³ª«®­®¬ ¢ ²¥®°¨¾ ´®°¬ «¼­»µ ¿§»ª®¢).
±²®°¨¿  °¨´¬¥²¨·¥±ª¨µ  «£®°¨²¬®¢ ¨§«®¦¥­  ¢ ª­¨£¥ ©ª¥­ 
¨ ®¯¯¥°  [7]. «®¦¥­¨¥ ±²®«¡¨ª®¬¨ ¯®¿¢¨«®±¼ ­¥ ¯®§¦¥  ¡ ª  (ª®²®°®¬³ ¡®«¥¥ 5000 «¥²). ¥°¢®¥ ¬¥µ ­¨·¥±ª®¥ ³±²°®©±²¢®, ¥£® °¥ «¨§³¾¹¥¥, ¡»«® ±®§¤ ­® .  ±ª «¥¬ ¢ 1642 £®¤³. »·¨±«¨²¥«¼­®¥
³±²°®©±²¢®, ¯®§¢®«¿¾¹¥¥ ³¬­®¦ ²¼ ¯®¢²®°­»¬¨ ±«®¦¥­¨¿¬¨, ¡»«® ° §° ¡®² ­® ­¥§ ¢¨±¨¬® . ®°« ­¤®¬ (S. Morland, 1666) ¨ . .
¥©¡­¨¶¥¬ (1671). À³±±ª¨© ­ °®¤­»©  «£®°¨²¬Á, ª ª ¯¨¸¥² ­³²
[22], ¡»« ¨§¢¥±²¥­ ¥£¨¯¥²±ª¨¬ ¬ ²¥¬ ²¨ª ¬ ¥¹¥ ¢ 1800 £. ¤® ­. ½.
¤¥¿ ²°¥µ ¢®§¬®¦­»µ ²¨¯®¢ ¯¥°¥­®±  ¨±¯®«¼§®¢ « ±¼ ¢ °¥«¥©­®© ¢»·¨±«¨²¥«¼­®© ¬ ¸¨­¥, ¯®±²°®¥­­®© ¢  °¢ °¤¥ ¢ 40-¥ £®¤»
­ ¸¥£® ¢¥ª  [180]. «£®°¨²¬ ± ¯°¥¤¢»·¨±«¥­¨¥¬ ¯¥°¥­®±®¢ ®¤­¨¬¨ ¨§ ¯¥°¢»µ ®¯¨± «¨  ©­¡¥°£¥° ¨ ¬¨² [199], ­® ¨µ  «£®°¨²¬
²°¥¡®¢ « ½«¥¬¥­²®¢ ± ¡®«¼¸¨¬ ·¨±«®¬ ¢µ®¤®¢. «£®°¨²¬ ±«®¦¥­¨¿

630

« ¢  29 °¨´¬¥²¨·¥±ª¨¥ ±µ¥¬»

¤¢³µ n-° §°¿¤­»µ ·¨±¥« §  ¢°¥¬¿ O(lg n) ± ½«¥¬¥­² ¬¨, ¨¬¥¾¹¨¬¨
´¨ª±¨°®¢ ­­®¥ ·¨±«® ¢µ®¤®¢, ³ª § « ´¬ ­ [152]
¤¥¾ ¨±¯®«¼§®¢ ²¼ ±«®¦¥­¨¥ ± § ¯®¬¨­ ­¨¥¬ ¯¥°¥­®±®¢ ¤«¿
³¬­®¦¥­¨¿ ¢»±ª § «¨ ±²°¨­, ¨«µ°¨±² ¨ ®¬¥°¥­ [64]. ²°³¡¨­
[13] ¯®±²°®¨« ¡¥±ª®­¥·­»© «¨­¥©­®-¬ ²°¨·­»© ³¬­®¦¨²¥«¼ ¤«¿
·¨±¥« «¾¡®© ¤«¨­» (n-© ¡¨² ¯°®¨§¢¥¤¥­¨¿ ¢»¤ ¥²±¿ ±° §³ ¯®±«¥ ¯®±²³¯«¥­¨¿ n-»µ ¡¨²®¢ ±®¬­®¦¨²¥«¥©). ¥°¥¢® ®««¥±  ®¯¨± « ®««¥± [197] (­¥§ ¢¨±¨¬® ¥£® ¨¤¥¿ ¡»«  ®²ª°»²  ´¬ ­®¬ [152]).
«£®°¨²¬» ¤¥«¥­¨¿ ¢®±µ®¤¿² ª . ¼¾²®­³ (¯°¨¤³¬ ¢¸¥¬³ ±¢®©
¬¥²®¤ ¨²¥° ¶¨© ®ª®«® 1665 £®¤ ).  § ¤ ·¥ 29.1 ±²°®¨²±¿ ±µ¥¬  ¤«¿
¤¥«¥­¨¿, ¨¬¥¾¹ ¿ £«³¡¨­³ £«³¡¨­» O(lg2 n).  ¤¥©±²¢¨²¥«¼­®±²¨
¬®¦­® ¯®±²°®¨²¼ ±µ¥¬³ £«³¡¨­» ¢±¥£® O(lg n) (¨¬, ³ª ¨ ³¢¥°
[19]).

30

«£®°¨²¬» ¯ ° ««¥«¼­»µ ¢»·¨±«¥­¨©

 ¯®¿¢«¥­¨¥¬ ¬­®£®¯°®¶¥±±®°­»µ ª®¬¯¼¾²¥°®¢ ¢®§­¨ª«  ­¥®¡µ®¤¨¬®±²¼ ¢ ° §° ¡®²ª¥ ¯ ° ««¥«¼­»µ  «£®°¨²¬®¢ (parallel algorithms), ª®²®°»¥ ¨±¯®«¼§³¾² ¢®§¬®¦­®±²¼ ®¤­®¢°¥¬¥­­®£® ¢»¯®«­¥­¨¿ ­¥±ª®«¼ª¨µ ¤¥©±²¢¨©. ±¨«¨¿¬¨ ¬­®£¨µ ¨±±«¥¤®¢ ²¥«¥© ² ª¨¥  «£®°¨²¬» ° §° ¡®² ­» ¤«¿ ¬­®¦¥±²¢  § ¤ ·, ¢ ²®¬ ·¨±«¥ ¨
¤«¿ § ¤ ·, ° ±±¬®²°¥­­»µ ¢ ¯°¥¤»¤³¹¨µ £« ¢ µ.  ½²®© £« ¢¥ ¬»
° ±±¬®²°¨¬ ­¥±ª®«¼ª® ¯°®±²»µ ¯ ° ««¥«¼­»µ  «£®°¨²¬®¢ ¢ ª ·¥±²¢¥ ¨««¾±²° ¶¨¨ ®±­®¢­»µ ¨¤¥©.
®°²¨°³¾¹¨¥ ±¥²¨ ¨ ±µ¥¬» ¨§ ´³­ª¶¨®­ «¼­»µ ½«¥¬¥­²®¢ (£« ¢» 28, 29) ¯°¥¤±² ¢«¿¾² ±®¡®© ¬®¤¥«¼ ¯ ° ««¥«¼­»µ ¢»·¨±«¥­¨©,
­® ­¥¤®±² ²®·­® ®¡¹³¾.  ½²®© £« ¢¥ ¢ ª ·¥±²¢¥ ¬®¤¥«¨ ¨±¯®«¼§³¾²±¿ À¯ ° ««¥«¼­»¥ ¬ ¸¨­» ± ¯°®¨§¢®«¼­»¬ ¤®±²³¯®¬Á. ­¨ ³¤®¡­» ¤«¿ ®¯¨± ­¨¿  «£®°¨²¬®¢ ° ¡®²» ±® ±²°³ª²³° ¬¨ ¤ ­­»µ (¬ ±±¨¢ ¬¨, ¤¥°¥¢¼¿¬¨, ±¯¨±ª ¬¨ ¨ ². ¤.). ²  ¬®¤¥«¼ ¤®±² ²®·­® ¡«¨§ª  ª ¯° ª²¨ª¥ ¢ ²®¬ ±¬»±«¥, ·²® ¥±«¨ ®¤¨­  «£®°¨²¬ ®ª §»¢ ¥²±¿
½´´¥ª²¨¢­¥¥ ¤°³£®£® ¤«¿ ½²®© ¬®¤¥«¨, ²®, ª ª ¯° ¢¨«®, ®­ ¡³¤¥²
½´´¥ª²¨¢­¥¥ ¨ ¯°¨ ¯° ª²¨·¥±ª®© °¥ «¨§ ¶¨¨.
30.0.1.  ° ««¥«¼­ ¿ ¬ ¸¨­  ± ¯°®¨§¢®«¼­»¬ ¤®±²³¯®¬ (PRAM)
±²°®©±²¢® ¯ ° ««¥«¼­®© ¬ ¸¨­» ± ¯°®¨§¢®«¼­»¬ ¤®±²³¯®¬
(parallel random-access machine, PRAM) ¯®ª § ­® ­  °¨±. 30.1. °®¶¥±±®°» P0; : : : ; Pp;1 ¨±¯®«¼§³¾² ®¡¹³¾ ¯ ¬¿²¼ (shared memory).
±¥ p ¯°®¶¥±±®°®¢ ¬®£³² ®¤­®¢°¥¬¥­­® § ¯¨±»¢ ²¼ ¨­´®°¬ ¶¨¾
¢ ¯ ¬¿²¼ ¨«¨ ·¨² ²¼ ¨§ ¯ ¬¿²¨,   ² ª¦¥ ¯ ° ««¥«¼­® ¢»¯®«­¿²¼
 °¨´¬¥²¨·¥±ª¨¥ ¨ «®£¨·¥±ª¨¥ ®¯¥° ¶¨¨.
 ª ·¥±²¢¥ ¬¥°» ¤«¿ ®¶¥­ª¨ ¢°¥¬¥­¨ ° ¡®²» ¬» ¢»¡¨° ¥¬ ·¨±«® ¶¨ª«®¢ ¯ ° ««¥«¼­®£® ¤®±²³¯  ª ®¡¹¥© ¯ ¬¿²¨, ±·¨² ¿, ·²®
ª ¦¤»© ² ª®© ¶¨ª« § ­¨¬ ¥² ´¨ª±¨°®¢ ­­®¥ ¢°¥¬¿.   ¯° ª²¨30.1. ±²°®©±²¢® PRAM-¬ ¸¨­». °®¶¥±±®°» P0 ; P1 ; : : : ; Pp;1 ¨±¯®«¼§³¾² ®¡¹³¾ ¯ ¬¿²¼.  ¦¤»© ¯°®¶¥±±®° ¬®¦¥² ¯®«³·¨²¼ ¤®±²³¯ ª «¾¡®©
¿·¥©ª¥ ¯ ¬¿²¨ §  ¥¤¨­¨·­®¥ ¢°¥¬¿.
¨±. 30.1

632

« ¢  30 «£®°¨²¬» ¯ ° ««¥«¼­»µ ¢»·¨±«¥­¨©

ª¥ ½²® ­¥ ±®¢±¥¬ ² ª, ¯®±ª®«¼ª³ ¢°¥¬¿ ¤®±²³¯  ª ¯ ¬¿²¨ § ¢¨±¨²
®² ª®«¨·¥±²¢  ¨±¯®«¼§³¥¬»µ ¯°®¶¥±±®°®¢. ¥¬ ­¥ ¬¥­¥¥, ¢ °¥ «¼­»µ ¬­®£®¯°®¶¥±±®°­»µ ª®¬¯¼¾²¥° µ ¤®±²³¯ ª ¯ ¬¿²¨ (®¡»·­® ±
¯®¬®¹¼¾ ±¯¥¶¨ «¼­®© ±¥²¨ ª®¬¬³² ¶¨¨) ¤¥©±²¢¨²¥«¼­® § ­¨¬ ¥²
¡®«¼¸³¾ · ±²¼ ¢°¥¬¥­¨, ² ª ·²® ·¨±«® ®¡° ¹¥­¨© ª ¯ ¬¿²¨ ¿¢«¿¥²±¿ ° §³¬­®© ®¶¥­ª®© ¢°¥¬¥­¨ ° ¡®²».
°¨ ®¶¥­ª¥  «£®°¨²¬®¢ ¤«¿ PRAM ­¥®¡µ®¤¨¬® ³·¨²»¢ ²¼ ­¥
²®«¼ª® ¢°¥¬¿ ° ¡®²», ­® ¨ ª®«¨·¥±²¢® ¨±¯®«¼§³¥¬»µ ¯°®¶¥±±®°®¢.  ½²®¬ ±®±²®¨² ¢ ¦­®¥ ®²«¨·¨¥ ®² ®¤­®¯°®¶¥±±®°­®© ¬®¤¥«¨,
£¤¥ ¬» ¨­²¥°¥±³¥¬±¿ ¢ ®±­®¢­®¬ ¢°¥¬¥­¥¬ ° ¡®²».  ª ¯° ¢¨«®,
³¬¥­¼¸¥­¨¥ ·¨±«  ¯°®¶¥±±®°®¢ ¯°¨¢®¤¨² ª ±®®²¢¥²±²¢³¾¹¥¬³ ³¢¥«¨·¥­¨¾ ¢°¥¬¥­¨ ° ¡®²». ²®² ¢®¯°®± ®¡±³¦¤ ¥²±¿ ¢ ° §¤¥«¥ 30.3.
30.0.2.  ° ««¥«¼­»© ¨ ¨±ª«¾·¨²¥«¼­»© ¤®±²³¯ ª ¯ ¬¿²¨
³¹¥±²¢³¥² ­¥±ª®«¼ª® ¯®¤µ®¤®¢ ª ¨±¯®«¼§®¢ ­¨¾ ®¡¹¥© ¯ ¬¿²¨.   «£®°¨²¬ µ ± ®¤­®¢°¥¬¥­­»¬ ·²¥­¨¥¬ (concurrent-read algorithms) ­¥±ª®«¼ª® ¯°®¶¥±±®°®¢ ¬®£³² ®¤­®¢°¥¬¥­­® ±·¨²»¢ ²¼
¨­´®°¬ ¶¨¾ ¨§ ®¤­®© ¿·¥©ª¨.   «£®°¨²¬ µ ± ¨±ª«¾· ¾¹¨¬ ·²¥­¨¥¬ (exclusive-read algorithms) ®¤­®¢°¥¬¥­­®¥ ·²¥­¨¥ (¨§ ®¤­®©
¿·¥©ª¨ ¯ ¬¿²¨) § ¯°¥¹¥­®. ®¤®¡­»¬ ¦¥ ®¡° §®¬  «£®°¨²¬» ¤¥«¿²±¿ ­   «£®°¨²¬» ± ®¤­®¢°¥¬¥­­®© § ¯¨±¼¾ (concurrent-write algorithms) ¨  «£®°¨²¬» ± ¨±ª«¾· ¾¹¥© § ¯¨±¼¾ (exclusive-write algorithms).  ª¨¬ ®¡° §®¬, ¢®§¬®¦­® ·¥²»°¥ ¢¨¤  ®¡¹¥© ¯ ¬¿²¨,
¤«¿ ª®²®°»µ ²° ¤¨¶¨®­­® ³¯®²°¥¡«¿¾²±¿ ±«¥¤³¾¹¨¥ ­ §¢ ­¨¿:
 EREW (exclusive-read exclusive-write): ¨±ª«¾· ¾¹¥¥ ·²¥­¨¥ ¨
¨±ª«¾· ¾¹ ¿ § ¯¨±¼,
 CREW: ®¤­®¢°¥¬¥­­®¥ ·²¥­¨¥ ¨ ¨±ª«¾· ¾¹ ¿ § ¯¨±¼,
 ERCW: ¨±ª«¾· ¾¹¥¥ ·²¥­¨¥ ¨ ®¤­®¢°¥¬¥­­ ¿ § ¯¨±¼,
 CRCW: ®¤­®¢°¥¬¥­­®¥ ·²¥­¨¥ ¨ ®¤­®¢°¥¬¥­­ ¿ § ¯¨±¼.
 «¥¥ ¬» ¡³¤¥¬ £®¢®°¨²¼, ­ ¯°¨¬¥°, ® EREW-¬ ¸¨­¥ ¨«¨ CREW «£®°¨²¬¥, ¨¬¥¿ ¢ ¢¨¤³ ±®®²¢¥²±²¢³¾¹¨© ²¨¯ ®¡¹¥© ¯ ¬¿²¨.
 ¨¡®«¥¥ ³¯®²°¥¡¨²¥«¼­» ¬®¤¥«¨ EREW ¨ CRCW. ±­®, ·²®
¢±¥  «£®°¨²¬», ª®²®°»¥ ¬®£³² ¢»¯®«­¿²¼±¿ ­  EREW-¬ ¸¨­¥, ¬®£³² ¢»¯®«­¿²¼±¿ ¨ ­  CRCW-¬ ¸¨­¥, ­® ­¥ ­ ®¡®°®². ¯¯ ° ²­ ¿
¯®¤¤¥°¦ª  ¬®¤¥«¨ EREW ¯°®¹¥ ¨ ¡»±²°¥¥ (¨§-§  ®²±³²±²¢¨¿ ª®­´«¨ª²®¢ ¯°¨ § ¯¨±¨ ¨ ·²¥­¨¨). ¥ «¨§ ¶¨¿ ¬®¤¥«¨ CRCW ¡®«¥¥
±«®¦­ , ¥±«¨ ¬» µ®²¨¬ ®¡¥±¯¥·¨²¼ µ®²¿ ¡» ¯°¨¬¥°­® ®¤¨­ ª®¢®¥
¢°¥¬¿ ¤®±²³¯  ª ¯ ¬¿²¨ ¤«¿ ¢±¥µ ¢ °¨ ­²®¢ ¤®±²³¯ , ­® ± ²®·ª¨
§°¥­¨¿ ¯°®£° ¬¬¨±²  ½²  ¬®¤¥«¼ §­ ·¨²¥«¼­® ¯°®¹¥ ¨ ³¤®¡­¥¥.
§ ¤¢³µ ®±² ¢¸¨µ±¿ ²¨¯®¢ (CREW, ERCW) ¡®«¥¥ ¯®¯³«¿°­  ¬®¤¥«¼ CREW, µ®²¿ ­  ¯° ª²¨ª¥ °¥ «¨§®¢ ²¼ ®¤­®¢°¥¬¥­­³¾ § ¯¨±¼
­¥ ±«®¦­¥¥, ·¥¬ ®¤­®¢°¥¬¥­­®¥ ·²¥­¨¥.  ½²®© £« ¢¥ ±·¨² ¥²±¿,
·²® ¢±¥  «£®°¨²¬», ¨±¯®«¼§³¾¹¨¥ ®¤­®¢°¥¬¥­­®¥ ·²¥­¨¥ ¨«¨ § -

« ¢  30 «£®°¨²¬» ¯ ° ««¥«¼­»µ ¢»·¨±«¥­¨©

633

¯¨±¼ (µ®²¿ ¡» ®¤­® ¨§ ¤¢³µ) ¯°¥¤­ §­ ·¥­» ¤«¿ CRCW-¬ ¸¨­».
» ¢¥°­¥¬±¿ ª ±° ¢­¥­¨¾ ° §«¨·­»µ ¬®¤¥«¥© ¢ ¢ ° §¤¥«¥ 30.2.
°¨ ° ±±¬®²°¥­¨¨ ®¤­®¢°¥¬¥­­®© § ¯¨±¨ ±«¥¤³¥² ³²®·­¨²¼, ·²®
¡³¤¥² ­ µ®¤¨²¼±¿ ¢ ¿·¥©ª¥ ¯®±«¥ § ¯¨±¨.  ½²®© £« ¢¥ ¨±¯®«¼§³¥²±¿ ¬®¤¥«¼ ®¤­®¢°¥¬¥­­®© § ¯¨±¨ ®¡¹¥£® §­ ·¥­¨¿ (common-CRCW
model), ¢ ª®²®°®© ¢±¥ ¯°®¶¥±±®°», ¯°®¨§¢®¤¿¹¨¥ § ¯¨±¼ ¢ ¤ ­­³¾
¿·¥©ª³, ®¡¿§ ­» § ¯¨±»¢ ²¼ ²³¤  ®¤­® ¨ ²® ¦¥ §­ ·¥­¨¥.  «¨²¥° ²³°¥ ¢±²°¥· ¾²±¿ ¨ ¤°³£¨¥ ¬®¤¥«¨:
 ¯°®¨§¢®«¼­»© ¢»¡®° (arbitrary): ±®µ° ­¿¥²±¿ ®¤­® (¯°®¨§¢®«¼­®¥) §­ ·¥­¨¥ ¨§ § ¯¨±»¢ ¥¬»µ;
 ¯°¨®°¨²¥²» (priority): ±®µ° ­¿¥²±¿ §­ ·¥­¨¥, ¯®±²³¯¨¢¸¥¥ ®²
¯°®¶¥±±®°  ± ­ ¨¬¥­¼¸¨¬ ­®¬¥°®¬;
 ª®¬¡¨­ ¶¨¿ (combinational): ±®µ° ­¿¥²±¿ ­¥ª®²®° ¿ ª®¬¡¨­ ¶¨¿
(­ ¯°¨¬¥°, ±³¬¬  ¨«¨ ¬ ª±¨¬³¬) ¯®±²³¯¨¢¸¨µ ­  § ¯¨±¼ §­ ·¥­¨©.
 ¯®±«¥¤­¥¬ ±«³· ¥ ±®µ° ­¿¥¬®¥ §­ ·¥­¨¥ ®¡»·­® ¿¢«¿¥²±¿ ª®¬¬³² ²¨¢­®© ¨  ±±®¶¨ ²¨¢­®© ´³­ª¶¨¥© §­ ·¥­¨©, ¯®±²³¯ ¾¹¨µ ­ 
§ ¯¨±¼.
30.0.3. ¨­µ°®­¨§ ¶¨¿
«¿ ¯° ¢¨«¼­®© ° ¡®²» ¯ ° ««¥«¼­»µ  «£®°¨²¬®¢ ° ¡®²³ ¯°®¶¥±±®°®¢ ±«¥¤³¥² ±¨­µ°®­¨§¨°®¢ ²¼. °®¬¥ ²®£®, · ±²® ²°¥¡³¥²±¿
¯°®¢¥°¿²¼ ³±«®¢¨¿, § ¢¨±¿¹¨¥ ®² ±®±²®¿­¨¿ ¢±¥µ ¯°®¶¥±±®°®¢ ±° §³, ¯°¨·¥¬ ¦¥« ²¥«¼­® ¤¥« ²¼ ½²® §  ¯®±²®¿­­®¥ ¢°¥¬¿, ­¥ § ¢¨±¿¹¥¥ ®² ·¨±«  ¯°®¶¥±±®°®¢.   ¯° ª²¨ª¥ ±¨­µ°®­¨§ ¶¨¿ ¨ ¯°®¢¥°ª¨ ®±³¹¥±²¢«¿¾²±¿ ± ¯®¬®¹¼¾ ±¯¥¶¨ «¼­®© ³¯° ¢«¿¾¹¥© ±¥²¨,
±®¥¤¨­¿¾¹¥© ¢±¥ ¯°®¶¥±±®°». ²  ±¥²¼ ° ¡®² ¥² ¯°¨¬¥°­® ± ²®©
¦¥ ±ª®°®±²¼¾, ·²® ¨ ±¥²¼, ®¡¥±¯¥·¨¢ ¾¹ ¿ ¤®±²³¯ ª ®¡¹¥© ¯ ¬¿²¨.
 ¤ «¼­¥©¸¥¬ ¬» ¯°¥¤¯®« £ ¥¬, ·²® ± ¯®¬®¹¼¾ ³¯° ¢«¿¾¹¥©
±¥²¨ §  ¢°¥¬¿ O(1) ¬®¦­® ¯°®¢¥°¨²¼ ª ª®¥-«¨¡® ³±«®¢¨¥ (­ ¯°¨¬¥°, ³±«®¢¨¥ ®ª®­· ­¨¿ ¶¨ª« ) ®¤­®¢°¥¬¥­­® ¢® ¢±¥µ ¯°®¶¥±±®° µ
(¶¨ª« § ¢¥°¸ ¥²±¿, ¥±«¨ ¢±¥ ¯°®¶¥±±®°» ± ½²¨¬ ±®£« ±­»). ­®£¤ 
° ±±¬ ²°¨¢ ¾² EREW-¬®¤¥«¨ ¡¥§ ² ª®£® ¬¥µ ­¨§¬ , ¨ ²®£¤  ¯®¤®¡­ ¿ ¯°®¢¥°ª  § ­¨¬ ¥² «®£ °¨´¬¨·¥±ª®¥ ¢°¥¬¿, ª®²®°®¥ ¤®«¦­® ¡»²¼ ¢ª«¾·¥­® ¢ ®¡¹¥¥ ¢°¥¬¿ ° ¡®²» (±¬. ³¯°. 30.1-8).  ° §¤¥«¥ 30.2 ¡³¤¥² ¯®ª § ­®, ·²® ­  CRCW-¬ ¸¨­¥ ³±«®¢¨¥ ®ª®­· ­¨¿
¬®¦­® ¯°®¢¥°¨²¼ §  ¢°¥¬¿ O(1), ­¥ ¨±¯®«¼§³¿ ³¯° ¢«¿¾¹³¾ ±¥²¼
(± ¯®¬®¹¼¾ ®¤­®¢°¥¬¥­­®© § ¯¨±¨).
30.0.4. « ­ £« ¢»
 ° §¤¥«¥ 30.1 ° ±±¬ ²°¨¢ ¥²±¿ ¬¥²®¤ ¯¥°¥µ®¤®¢ ¯® ³ª § ²¥«¿¬
¨ ¥£® ¨±¯®«¼§®¢ ­¨¥ ¤«¿ ®¡° ¡®²ª¨ ¯°¥´¨ª±®¢ ±¯¨±ª ,   ² ª¦¥  ­ -

634

« ¢  30 «£®°¨²¬» ¯ ° ««¥«¼­»µ ¢»·¨±«¥­¨©

«®£¨·­»¥ ¬¥²®¤» ¤«¿ ° ¡®²» ± ¤¥°¥¢¼¿¬¨.  §¤¥« 30.2 ¯®±¢¿¹¥­
±° ¢­¥­¨¾ CRCW- ¨ EREW-¬ ¸¨­ ¨ ¯°¥¨¬³¹¥±²¢ ¬ ®¤­®¢°¥¬¥­­®£® ¤®±²³¯  ª ¯ ¬¿²¨.
 ° §¤¥«¥ 30.3 ¤®ª §»¢ ¥²±¿ ²¥®°¥¬  °¥­²  ® ¬®¤¥«¨°®¢ ­¨¨
±µ¥¬ ¨§ ´³­ª¶¨®­ «¼­»µ ½«¥¬¥­²®¢ ¢ ¬®¤¥«¨ PRAM. °®¬¥ ½²®£®,
¢ ½²®¬ ° §¤¥«¥ ° ±±¬ ²°¨¢ ¥²±¿ ¯®­¿²¨¥ ½´´¥ª²¨¢­®±²¨ ¯® § ²° ² ¬ ¨ ¤ ¾²±¿ ³±«®¢¨¿, ¯°¨ ª®²®°»µ ·¨±«® ¯°®¶¥±±®°®¢ ¬®¦¥² ¡»²¼
³¬¥­¼¸¥­® ¡¥§ ¯®²¥°¨ ½´´¥ª²¨¢­®±²¨.  ° §¤¥«¥ 30.4 ¢­®¢¼ ° ±±¬ ²°¨¢ ¥²±¿ § ¤ ·  ®¡° ¡®²ª¨ ¯°¥´¨ª±®¢ ±¯¨±ª  ¨ ®¯¨±»¢ ¥²±¿
½´´¥ª²¨¢­»© ¯® § ²° ² ¬ ¢¥°®¿²­®±²­»©  «£®°¨²¬ ¤«¿ ½²®© § ¤ ·¨.  ª®­¥¶, ° §¤¥« 30.5 ¯®±¢¿¹¥­ § ¤ ·¥ ® ­ °³¸¥­¨¨ ±¨¬¬¥²°¨¨.
°¨¢®¤¨²±¿ ¤¥²¥°¬¨­¨°®¢ ­­»©  «£®°¨²¬, ª®²®°»© ¯®§¢®«¿¥² °¥¸¨²¼ ½²³ § ¤ ·³ §  ¢°¥¬¿, ±³¹¥±²¢¥­­® ¬¥­¼¸¥¥ «®£ °¨´¬¨·¥±ª®£®.
 ° ««¥«¼­»¥  «£®°¨²¬», ° ±±¬®²°¥­­»¥ ¢ ½²®© £« ¢¥, ¯® ±³¹¥±²¢³ ®²­®±¿²±¿ ª ²¥®°¨¨ £° ´®¢. ²® ¢±¥£® «¨¸¼ ®¤­  ¨§ ¬­®£¨µ
®¡« ±²¥©, £¤¥ ¯ ° ««¥«¼­»¥  «£®°¨²¬» ¯°¨¬¥­¿¾²±¿ | ­® ­  ½²®¬
¯°¨¬¥°¥ ¬» ¨««¾±²°¨°³¥¬ ¤®±² ²®·­® ®¡¹¨¥ ¨¤¥¨ ¨ ¬¥²®¤».

30.1. ¥°¥µ®¤» ¯® ³ª § ²¥«¿¬
 ½²®¬ ° §¤¥«¥ ° ±±¬ ²°¨¢ ¥²±¿ ¬¥²®¤ ¯¥°¥µ®¤®¢ ¯® ³ª § ²¥«¿¬ | ¢ ¦­®¥ ±°¥¤±²¢® ¤«¿ ¯®±²°®¥­¨¿ ¯ ° ««¥«¼­»µ  «£®°¨²¬®¢
®¡° ¡®²ª¨ ±¯¨±ª®¢.  ¯®¬®¹¼¾ ½²®£® ¬¥²®¤  ±²°®¨²±¿  «£®°¨²¬,
¯®§¢®«¿¾¹¨© §  ¢°¥¬¿ O(lg n) ­ ©²¨ ¯®«®¦¥­¨¥ ¢ ±¯¨±ª¥ (° ±±²®¿­¨¥ ¤® ª®­¶  ±¯¨±ª ) ¤«¿ ¢±¥µ ½«¥¬¥­²®¢ ±¯¨±ª  ¤«¨­®© n. ®µ®¦¨©  «£®°¨²¬ ¨±¯®«¼§³¥²±¿ ¤«¿ ¯ ° ««¥«¼­®© ®¡° ¡®²ª¨ ¯°¥´¨ª±®¢ ±¯¨±ª  ¤«¨­®© n §  ¢°¥¬¿ O(lg n). » ³ª ¦¥¬ ² ª¦¥ ±¯®±®¡,
¯®§¢®«¿¾¹¨© ±¢®¤¨²¼ ¬­®£¨¥ § ¤ ·¨ ® ¤¥°¥¢¼¿µ ª § ¤ · ¬ ® ±¯¨±ª µ, °¥¸ ¥¬»¬ ± ¯®¬®¹¼¾ ¯¥°¥µ®¤®¢ ¯® ³ª § ²¥«¿¬. ±¥  «£®°¨²¬» ¢ ½²®¬ ° §¤¥«¥ ­¥ ²°¥¡³¾² ®¤­®¢°¥¬¥­­®£® ¤®±²³¯  ª ¯ ¬¿²¨
¨ ¯®²®¬³ ¬®£³² ¡»²¼ °¥ «¨§®¢ ­» ­  EREW-¬ ¸¨­¥.
30.1.1. ®¬¥° ¢ ±¯¨±ª¥
¯¨±®ª ¢ PRAM-¬ ¸¨­¥ µ° ­¨²±¿ ®¡»·­»¬ ®¡° §®¬. °¨ ½²®¬
¬» ¡³¤¥¬ ±·¨² ²¼, ·²® §  ª ¦¤»© ½«¥¬¥­² ±¯¨±ª  ®²¢¥· ¥² ±¢®©
¯°®¶¥±±®°, ²® ¥±²¼ ·²® i-»© ¯°®¶¥±±®° ®²¢¥· ¥² §  ½«¥¬¥­² ±¯¨±ª , µ° ­¿¹¨©±¿ ¢ i-®© ¿·¥©ª¥ ¯ ¬¿²¨. (®°¿¤ª®¢»© ­®¬¥° ½²®£®
½«¥¬¥­²  ¢ ±¯¨±ª¥ ¬®¦¥² ¡»²¼ «¾¡»¬.)   °¨±. 30.2(a) ¯®ª § ­
¯°¨¬¥° ±¯¨±ª  ¨§ ®¡º¥ª²®¢ h3; 4; 6; 0; 1; 5i. ®±ª®«¼ª³ ¤«¿ ª ¦¤®£® ½«¥¬¥­²  ¨¬¥¥²±¿ ±®¡±²¢¥­­»© ¯°®¶¥±±®°, ¢±¥ ½«¥¬¥­²» ±¯¨±ª 
¬®¦­® ®¡° ¡ ²»¢ ²¼ ¯ ° ««¥«¼­®.
³±²¼ ¤ ­ ®¤­®±²®°®­­¥ ±¢¿§ ­­»© ±¯¨±®ª L ¨§ n ½«¥¬¥­²®¢, ¨

¥°¥µ®¤» ¯® ³ª § ²¥«¿¬

635

30.2. ±¯®«¼§®¢ ­¨¥ ¬¥²®¤  ¯¥°¥µ®¤®¢ ¯® ³ª § ²¥«¿¬ ¤«¿ ¢»·¨±«¥­¨¿
° ±±²®¿­¨© ¤® ª®­¶  ±¯¨±ª  §  ¢°¥¬¿ O(lg n). (a).  · «¼­®¥ ±®±²®¿­¨¥: ¢±¥
§­ ·¥­¨¿ d ° ¢­» 1. (b){(d). ®±²®¿­¨¿ ±¯¨±ª  ¯®±«¥ ª ¦¤®£® ¢»¯®«­¥­¨¿ ¶¨ª« 
while ¢  «£®°¨²¬¥ List-Rank.  ª®­¶¥ §­ ·¥­¨¥ d ±®¢¯ ¤ ¥² ± ° ±±²®¿­¨¥¬ ¤®
ª®­¶  ±¯¨±ª .
¨±. 30.2

¤«¿ ª ¦¤®£® ¥£® ½«¥¬¥­²  ²°¥¡³¥²±¿ ­ ©²¨ ° ±±²®¿­¨¥ ¤® ª®­¶ 
±¯¨±ª . ®«¥¥ ´®°¬ «¼­®, ¥±«¨ next[i] { ³ª § ²¥«¼ ®¡º¥ª²  i ­ 
±«¥¤³¾¹¨© ®¡º¥ª², ²® ° ±±²®¿­¨¥ ¤® ª®­¶  ±¯¨±ª  § ¤ ¥²±¿ ¨­¤³ª²¨¢­® ±«¥¤³¾¹¨¬ ®¡° §®¬:

next[i] = nil
d[i] = 0d[next[i]] + 1 ¥±«¨
¥±«¨ next[i] 6= nil
²  § ¤ ·  ­ §»¢ ¥²±¿ § ¤ ·¥© ® ­®¬¥°¥ ¢ ±¯¨±ª¥ (list-ranking problem).
°¨¢¨ «¼­®¥ °¥¸¥­¨¥ ±®±²®¨² ¢ ¢»·¨±«¥­¨¨ ° ±±²®¿­¨© ¯®±«¥¤®¢ ²¥«¼­®, ­ ·¨­ ¿ ± ª®­¶  ±¯¨±ª . °¨ ½²®¬ ¢°¥¬¿ ° ¡®²» ±®±² ¢«¿¥² (n), ¯®±ª®«¼ª³ k-© ± ª®­¶  ®¡º¥ª² ¬®¦¥² ¡»²¼ ®¡° ¡®² ­
«¨¸¼ ¯®±«¥ k ; 1 ±«¥¤³¾¹¨µ §  ­¨¬ ®¡º¥ª²®¢.  ª®¥ °¥¸¥­¨¥ ¯®
±³²¨ ¿¢«¿¥²±¿ ¯®±«¥¤®¢ ²¥«¼­»¬,   ­¥ ¯ ° ««¥«¼­»¬ | ¢ ª ¦¤»©
¬®¬¥­²  ª²¨¢¥­ ²®«¼ª® ®¤¨­ ¯°®¶¥±±®°.  ±±¬®²°¨¬ ²¥¯¥°¼  «£®°¨²¬ ± ¢°¥¬¥­¥¬ ° ¡®²» (lg n).
List-Rank(L)
1 for(¤«¿) ª ¦¤®£® ¯°®¶¥±±®° 
2 do if next[i] = nil
3
then d[i] 0
4
else d[i] 1
5 while ±³¹¥±²¢³¥² ®¡º¥ª² i, ¤«¿ ª®²®°®£® next[i] 6= nil
6 do for(¤«¿) ª ¦¤®£® ¯°®¶¥±±®°  i
7
do if next[i] 6= nil
8
then d[i] d[i] + d[next[i]]
9
next[i] next[next[i]]
  °¨±. 30.2 ¯®ª § ­» ±®±²®¿­¨¿ ±¯¨±ª  ¯¥°¥¤ ª ¦¤»¬ ¯®¢²®°¥­¨¥¬ ¶¨ª«  while ¢ ±²°®ª µ 5{9. ®±²®¿­¨¥ ±¯¨±ª  ¯®±«¥ § ¯®«­¥­¨¿
¯®«¥© d[i] (±²°®ª¨ 1{4) ¯®ª § ­® ­  °¨±. 30.2(a).   ¯¥°¢®¬ ¸ £¥ ³
¢±¥µ ®¡º¥ª²®¢, ª°®¬¥ ¯®±«¥¤­¥£®, ³ª § ²¥«¨ ­¥ ° ¢­» nil, ¯®½²®¬³
±²°®ª¨ 8{9 ¢»¯®«­¿¾²±¿ ¤«¿ ¯¥°¢»µ ¯¿²¨ ¯°®¶¥±±®°®¢. ®«³· ¥²±¿
±®±²®¿­¨¥ ±¯¨±ª , ¯®ª § ­­®¥ ­  °¨±. 30-2(b).   ±«¥¤³¾¹¥¬ ¸ £¥
±²°®ª¨ 8{9 ¢»¯®«­¿¾²±¿ ²®«¼ª® ¤«¿ ¯¥°¢»µ ·¥²»°¥µ ¯°®¶¥±±®°®¢
(³ ¤¢³µ ¯®±«¥¤­¨µ ®¡º¥ª²®¢ ³ª § ²¥«¨ ³¦¥ ° ¢­» nil). ¥§³«¼² ²
¯®ª § ­ ­  °¨±. 30-2(c). °¨ ²°¥²¼¥¬ (¨ ¯®±«¥¤­¥¬) ¢»¯®«­¥­¨¨ ¶¨ª«  ° ¡®² ¾² ²®«¼ª® ¤¢  ¯¥°¢»µ ¯°®¶¥±±®° . ®­¥·­»© °¥§³«¼² ²
¯®ª § ­ ­  °¨±. 30-2(d).
¤¥¿ ª®¬¯®§¨¶¨¨ ¯¥°¥µ®¤®¢ ¯® ³ª § ²¥«¿¬ (pointer jumping)
°¥ «¨§®¢ ­  ¢ ±²°®ª¥ 9, £¤¥ ¯°®¨§¢®¤¨²±¿ ®¯¥° ¶¨¿ next[i]
next[next[i]].  ¬¥²¼²¥, ·²® ½²¨ ¤¥©±²¢¨¿ ­ °³¸ ¾² ±²°³ª²³°³

636

« ¢  30 «£®°¨²¬» ¯ ° ««¥«¼­»µ ¢»·¨±«¥­¨©

±¯¨±ª , ¯®±ª®«¼ª³ ¬¥­¿¾²±¿ ¯®«¿ ³ª § ²¥«¥©. ±«¨ ­¥®¡µ®¤¨¬® ±®µ° ­¨²¼ ±¯¨±®ª, ­¥®¡µ®¤¨¬® ±¤¥« ²¼ ª®¯¨¨ ¯®«¥© ³ª § ²¥«¥© ¨ ¯°®¨§¢®¤¨²¼ ¤¥©±²¢¨¿ ± ª®¯¨¿¬¨.
30.1.2. ®°°¥ª²­®±²¼
¨ª« ¢ ±²°®ª µ 5{9 ¨¬¥¥² ±«¥¤³¾¹¨© ¨­¢ °¨ ­²: ¤«¿ «¾¡®£®
®¡º¥ª²  i «¨¡® next[i] ³ª §»¢ ¥² ­  ®¡º¥ª², ­ µ®¤¿¹¨©±¿ ¢ ±¯¨±ª¥
­  ° ±±²®¿­¨¨ d[i], «¨¡® next[i] = nil ¨ d[i] ¥±²¼ ° ±±²®¿­¨¥ ¤®
ª®­¶  ±¯¨±ª .
 ¬¥²¼²¥, ·²® ¤«¿ ¯° ¢¨«¼­®© ° ¡®²»  «£®°¨²¬  ­¥®¡µ®¤¨¬ 
±¨­µ°®­¨§ ¶¨¿: ·²¥­¨¥ ¢±¥µ ³ª § ²¥«¥© next[next[i]] (¢ ±²°®ª¥ 9)
¤®«¦­® ¯°®¨§®©²¨ ¤® § ¯¨±¨ ¨µ ­®¢»µ §­ ·¥­¨©.
¥¯¥°¼ ¯®ª ¦¥¬, ·²® ¯°®£° ¬¬  List-Rank ­¥ ¨±¯®«¼§³¥² ®¤­®¢°¥¬¥­­®£® ®¡° ¹¥­¨¿ ª ¯ ¬¿²¨ (¨ ¯®½²®¬³ ¬®¦¥² ¢»¯®«­¿²¼±¿
­  EREW-¬ ¸¨­¥). ±­®, ·²® ¢ ±²°®ª µ 2{7,   ² ª¦¥ ¯°¨ § ¯¨±¨ ¢ ±²°®ª µ 8 ¨ 9 ­¥ ¯°®¨±µ®¤¨² ®¤­®¢°¥¬¥­­®£® ®¡° ¹¥­¨¿ ª
®¤­®© ¿·¥©ª¥, ² ª ª ª §  ª ¦¤»© ½«¥¬¥­² ±¯¨±ª  ®²¢¥· ¥² ±¢®©
¯°®¶¥±±®°. °®¬¥ ²®£®, ¯¥°¥µ®¤ ¯® ³ª § ²¥«¿¬ ±®µ° ­¿¥² ±«¥¤³¾¹¨© ¨­¢ °¨ ­²: ¤«¿ «¾¡»µ ¤¢³µ ° §«¨·­»µ ®¡º¥ª²®¢ i ¨ j «¨¡® next[i] 6= next[j ], «¨¡® next[i] = next[j ] = nil. ¥©±²¢¨²¥«¼­®,
¢­ · «¥ ½²® ³±«®¢¨¥ ¢»¯®«­¥­®; ®­® ±®µ° ­¿¥²±¿ ¯°¨ ¨±¯®«­¥­¨¨
±²°®ª¨ 9. ®½²®¬³ ¯°¨ ·²¥­¨¨ ¢ ±²°®ª¥ 9 ­¥ ¯°®¨±µ®¤¨² ®¤­®¢°¥¬¥­­®£® ®¡° ¹¥­¨¿ ª ®¤­®© ¿·¥©ª¥.
 ±²°®ª¥ 8 ­¥ ¯°®¨±µ®¤¨² ®¤­®¢°¥¬¥­­®£® ·²¥­¨¿ ¡« £®¤ °¿ ±¨­µ°®­¨§ ¶¨¨: ¬» ±·¨² ¥¬. ·²® ±­ · «  ¢±¥ ¯°®¶¥±±®°» ·¨² ¾² d[i],
¨ «¨¸¼ § ²¥¬ d[next[i]].  °¥§³«¼² ²¥ ¯°¨ i = next[j ] ±®¤¥°¦¨¬®¥
d[i] ±­ · «  ¯°®·¨²»¢ ¥²±¿ i-¬ ¯°®¶¥±±®°®¬,   § ²¥¬ j -¬. °¨ ² ª®© ±¨­µ°®­¨§ ¶¨¨  «£®°¨²¬ ¬®¦¥² ° ¡®² ²¼ ­  EREW-¬ ¸¨­¥.
 ¤ «¼­¥©¸¥¬ ¯°¥¤¯®« £ ¥²±¿, ·²® ¯°¨ ¢»¯®«­¥­¨¨ ¯°®£° ¬¬
¯°¥¤³±¬®²°¥­  ­ ¤«¥¦ ¹ ¿ ±¨­µ°®­¨§ ¶¨¿, ¨ ¯®¤®¡­®£® °®¤  ²°¥¡®¢ ­¨¿ ¢±¥£¤  ¢»¯®«­¥­».
30.1.3. ­ «¨§
³±²¼ ±¯¨±®ª L ±®¤¥°¦¨² n ½«¥¬¥­²®¢. ®ª ¦¥¬, ·²® ¢°¥¬¿ ° ¡®²»  «£®°¨²¬  ±®±² ¢«¿¥² O(lg n). ®±ª®«¼ª³ ¨­¨¶¨ «¨§ ¶¨¿ ¨
ª ¦¤®¥ ¢»¯®«­¥­¨¥ ¶¨ª«  while § ­¨¬ ¾² ¢°¥¬¿ O(1), ¤®±² ²®·­®
¯®ª § ²¼, ·²® ¶¨ª« ¢»¯®«­¿¥²±¿ lg n ° §. ²® ±«¥¤³¥² ¨§ ²®£®, ·²®
¯°¨ ª ¦¤®¬ ¢»¯®«­¥­¨¨ ¶¨ª«  §­ ·¥­¨¿ d[i] ¤«¿ ²¥µ ½«¥¬¥­²®¢ i,
¤«¿ ª®²®°»µ next[i] 6= nil, ³¢¥«¨·¨¢ ¾²±¿ ¢¤¢®¥.
» ¯°¥¤¯®« £ ¥¬, ·²® ¯°®¢¥°ª  ³±«®¢¨¿ ¢ ±²°®ª¥ 5 § ­¨¬ ¥²
¢°¥¬¿ O(1) (¯°¨ ¨±¯®«¼§®¢ ­¨¨ ³¯° ¢«¿¾¹¥© ±¥²¨).  ³¯° ¦­¥­¨¨ 30.1-8 ¯°¥¤« £ ¥²±¿ °¥ «¨§®¢ ²¼ ½²³ ¯°®¢¥°ª³ ¡¥§ ² ª®© ±¥²¨,
±®µ° ­¨¢ ¢°¥¬¿ ° ¡®²» ¯°®£° ¬¬» O(lg n).

¥°¥µ®¤» ¯® ³ª § ²¥«¿¬

637

°®¬¥ ¢°¥¬¥­¨ ° ¡®²», ¤«¿ ¯ ° ««¥«¼­»µ  «£®°¨²¬®¢ ¬» ¡³¤¥¬ ®¶¥­¨¢ ²¼ ² ª¦¥ ®¡¹¨¥ § ²° ²» (work), ²® ¥±²¼ ¯°®¨§¢¥¤¥­¨¥ ¢°¥¬¥­¨ ° ¡®²» ­  ª®«¨·¥±²¢® ¨±¯®«¼§³¥¬»µ ¯°®¶¥±±®°®¢. ² 
¢¥«¨·¨­  ®¶¥­¨¢ ¥² ±¢¥°µ³ ¢°¥¬¿ ° ¡®²» (®¤­®¯°®¶¥±±®°­®£®)  «£®°¨²¬ , ¬®¤¥«¨°³¾¹¥£® ° ¡®²³ PRAM ¯³²¥¬ ¯®±«¥¤®¢ ²¥«¼­®£®
¬®¤¥«¨°®¢ ­¨¿ ° ¡®²» ¢±¥µ ¯°®¶¥±±®°®¢.
¡¹¨¥ § ²° ²» ­  ¢»·¨±«¥­¨¥ ­®¬¥°®¢ ¢ ±¯¨±ª¥ ±®±² ¢«¿¾²
(n lg n). ®±ª®«¼ª³ ®¤­®¯°®¶¥±±®°­»©  «£®°¨²¬ ° ¡®² ¥² §  ¢°¥¬¿ (n) (§  ®¤¨­ ¯°®µ®¤ ¯® ±¯¨±ª³ ¬®¦­® ¢»·¨±«¨²¼ ° ±±²®¿­¨¿
½«¥¬¥­²®¢ ®² ­ · «  ±¯¨±ª ,   ² ª¦¥ ¥£® ¤«¨­³), ¯°¨ ¢»¯®«­¥­¨¨
 «£®°¨²¬  List-Rank ¯°®¶¥±±®°» ¢»¯®«­¿¾² ¢ ±³¬¬¥ ¢ lg n ° §
¡®«¼¸¥ ¤¥©±²¢¨©, ·¥¬ ­¥®¡µ®¤¨¬® ®¤­®¯°®¶¥±±®°­®¬³  «£®°¨²¬³.
®¢®°¿², ·²®  «£®°¨²¬ A ­¥ ¬¥­¥¥ ½´´¥ª²¨¢¥­ ¯® § ²° ² ¬,
·¥¬  «£®°¨²¬ B (A is work-ecient with respect to B ), ¥±«¨ ®¡¹¨¥
§ ²° ²» A ¯°¥¢»¸ ¾² ®¡¹¨¥ § ²° ²» B ­¥ ¡®«¥¥ ·¥¬ ¢ ª®­±² ­²³
° §. «£®°¨²¬ A ­ §»¢ ¥²±¿ ½´´¥ª²¨¢­»¬ ¯® § ²° ² ¬ (workecient), ¥±«¨ ®­ ­¥ ¬¥­¥¥ ½´´¥ª²¨¢¥­, ·¥¬ «¾¡®© ®¤­®¯°®¶¥±±®°­»©  «£®°¨²¬. ( ½²®¬ ±«³· ¥ ®­ ­¥ ¬¥­¥¥ ½´´¥ª²¨¢¥­, ·¥¬ «¾¡®©
 «£®°¨²¬, ¯®±ª®«¼ª³ ¬­®£®¯°®¶¥±±®°­»©  «£®°¨²¬ ¬®¦­® ¬®¤¥«¨°®¢ ²¼ ­  ®¤­®¬ ¯°®¶¥±±®°¥, ¯®±«¥¤®¢ ²¥«¼­® ¬®¤¥«¨°³¿ ° ¡®²³
ª ¦¤®£® ¯°®¶¥±±®° .)  ±±¬®²°¥­­»© ¢»¸¥  «£®°¨²¬ ®²»±ª ­¨¿
­®¬¥°  ¢ ±¯¨±ª¥ ­¥ ¿¢«¿¥²±¿ ½´´¥ª²¨¢­»¬ ¯® § ²° ² ¬, ¯®±ª®«¼ª³
±³¹¥±²¢³¥²  «£®°¨²¬ ± § ²° ² ¬¨ (n). ´´¥ª²¨¢­»© ¯® § ²° ² ¬ ¢¥°®¿²­®±²­»©  «£®°¨²¬ ¤«¿ ½²®© § ¤ ·¨ ±²°®¨²±¿ ¢ ° §¤¥«¥ 30.4.
30.1.4.  ° ««¥«¼­ ¿ ®¡° ¡®²ª  ¯°¥´¨ª±®¢ ±¯¨±ª 
¥²®¤ ¯¥°¥µ®¤®¢ ¯® ³ª § ²¥«¿¬ ¯°¨¬¥­¿¥²±¿ ­¥ ²®«¼ª® ¤«¿ ®¯°¥¤¥«¥­¨¿ ¯®°¿¤ª®¢»µ ­®¬¥°®¢ ½«¥¬¥­²®¢ ±¯¨±ª .  ª ¯®ª § ­® ¢
° §¤¥«¥ 29.2.2, ®¡° ¡®²ª  ¯°¥´¨ª±®¢ ¯®§¢®«¿¥² ¡»±²°® ±ª« ¤»¢ ²¼
·¨±« . ¤¥±¼ ¡³¤¥² ¯®ª § ­®, ª ª ¨±¯®«¼§®¢ ²¼ ¬¥²®¤ ¯¥°¥µ®¤®¢
¯® ³ª § ²¥«¿¬ ¤«¿ ®¡° ¡®²ª¨ ¯°¥´¨ª±®¢. «£®°¨²¬ ®¡° ¡ ²»¢ ¥² ¯°¥´¨ª±» n-½«¥¬¥­²­®£® ±¯¨±ª  ­  EREW-¬ ¸¨­¥ §  ¢°¥¬¿
O(lg n).
³±²¼ 
 |  ±±®¶¨ ²¨¢­ ¿ ¡¨­ °­ ¿ ®¯¥° ¶¨¿.  ¤ ·  ®¡° ¡®²ª¨
¯°¥´¨ª±®¢ (prex computation) ±®±²®¨² ¢ ±«¥¤³¾¹¥¬: ¯® ¤ ­­®©
¯®±«¥¤®¢ ²¥«¼­®±²¨ hx1; x2; : : : ; xni ¯®±²°®¨²¼ ¯®±«¥¤®¢ ²¥«¼­®±²¼
hy1; y2; : : : ; yni, ¤«¿ ª®²®°®© y1 = x1 ¨

yk = yk;1 
 xk = x1 
 x2 
 : : : 
 xk
¤«¿ k = 2; 3; : : : ; n. °³£¨¬¨ ±«®¢ ¬¨, yk ¥±²¼ À
-¯°®¨§¢¥¤¥­¨¥Á ¯¥°¢»µ k ½«¥¬¥­²®¢ ¯®±«¥¤®¢ ²¥«¼­®±²¨.
» ¡³¤¥¬ ±·¨² ²¼, ·²® ½«¥¬¥­²» x1 ; : : : ; xn , ¯®¤«¥¦ ¹¨¥ ®¡° -

¡®²ª¥, ±¢¿§ ­» ¢ ®¤­®±²®°®­­¨© ±¯¨±®ª. (­ «®£¨·­ ¿ § ¤ ·  ¤«¿

638

« ¢  30 «£®°¨²¬» ¯ ° ««¥«¼­»µ ¢»·¨±«¥­¨©

¬ ±±¨¢  ° ±±¬ ²°¨¢ ¥²±¿ ¢ ³¯° ¦­¥­¨¨ 30-1.2).  ¬¥²¨¬ ¤«¿ ­ · « , ·²® § ¤ ·³ ® ­®¬¥°¥ ¢ ±¯¨±ª¥ ¬®¦­® ° ±±¬ ²°¨¢ ²¼ ª ª · ±²­»©
±«³· © § ¤ ·¨ ® ¯ ° ««¥«¼­®© ®¡° ¡®²ª¥ ¯°¥´¨ª±®¢. ¥©±²¢¨²¥«¼­®, ¯³±²¼ ª ¦¤»© ½«¥¬¥­² ±¯¨±ª  ° ¢¥­ 1,   ®¯¥° ¶¨¿ 
 | ®¡»·­®¥
±«®¦¥­¨¥. ®£¤  yk = k, ²® ¥±²¼ ¬» ¢»·¨±«¨«¨ ° ±±²®¿­¨¥ ¤® ­ · «  ±¯¨±ª . ®½²®¬³ ®¡° ¡®²ª³ ¯°¥´¨ª±®¢ ¬®¦­® ¨±¯®«¼§®¢ ²¼ ¤«¿
°¥¸¥­¨¿ § ¤ ·¨ ® ­®¬¥°¥ ¢ ±¯¨±ª¥ | ­³¦­® «¨¸¼ ±­ · «  ®¡° ²¨²¼
±¯¨±®ª (·²® ¬®¦­® ±¤¥« ²¼ §  ¢°¥¬¿ O(1)).
¥°­¥¬±¿ ª § ¤ ·¥ ® ¯ ° ««¥«¼­®© ®¡° ¡®²ª¥ ¯°¥´¨ª±®¢. ¢¥¤¥¬
±«¥¤³¾¹¨¥ ®¡®§­ ·¥­¨¿:
[i; j ] = xi 
 xi+1 
 : : : 
 xj
¯°¨ 1 6 i 6 j 6 n.  · ±²­®±²¨, [k; k] = xk ¨
[i; k] = [i; j ] 
 [j + 1; k]
¯°¨ 1 6 i 6 j < k 6 n.  ¸  ¶¥«¼ | ¢»·¨±«¨²¼ yk = [1; k] ¤«¿ ¢±¥µ
k = 1; : : : ; n.
 ¯°®£° ¬¬¥ ·¥°¥§ x[i] ®¡®§­ · ¥²±¿ §­ ·¥­¨¥ ®¡º¥ª²  i. ( ¯®¬¨­ ¥¬, i ¥±²¼  ¤°¥± ¢ ¯ ¬¿²¨,   ² ª¦¥ ­®¬¥° ®²¢¥²±²¢¥­­®£® § 
½²³ ¿·¥©ª³ ¯°®¶¥±±®° , ¨ ­¨ª ª ­¥ ±¢¿§ ­ ± k | ¯®°¿¤ª®¢»¬ ­®¬¥°®¬ ¢ ±¯¨±ª¥!) «£®°¨²¬ ¢»·¨±«¿¥² y [i] = yk = [1; k], £¤¥ x[i] = xk
¥±²¼ k-© ± ­ · «  ½«¥¬¥­² ±¯¨±ª .
List-Prefix(L)
1 for(¤«¿) ª ¦¤®£® ¯°®¶¥±±®°  i
2 do y [i] x[i]
3 while ±³¹¥±²¢³¥² ®¡º¥ª² i, ¤«¿ ª®²®°®£® next[i] 6= nil
4 do for(¤«¿) ª ¦¤®£® ¯°®¶¥±±®°  i
5
do if next[i] 6= nil
6
then y [next[i]] y [i] 
 y [next[i]]
7
next[i] next[next[i]]
¨¤­®, ·²®  «£®°¨²¬ ¯®µ®¦ ­   «£®°¨²¬ ®¯°¥¤¥«¥­¨¿ ¯®°¿¤ª®¢»µ ­®¬¥°®¢ ½«¥¬¥­²®¢. ²«¨· ¾²±¿ «¨¸¼ ¨­¨¶¨ «¨§ ¶¨¿ ¨ ¨§¬¥­¥­¨¥ §­ ·¥­¨© y (¢ ¯°¥¤»¤³¹¥¬  «£®°¨²¬¥ d).   «£®°¨²¬¥ ListRank ¯°®¶¥±±®° i ¨§¬¥­¿¥² §­ ·¥­¨¥ y [i], ±®®²¢¥²±²¢³¾¹¥¥ ±¢®¥¬³ ®¡º¥ª²³, ²®£¤  ª ª ¢  «£®°¨²¬¥ List-Prefix i-© ¯°®¶¥±±®°
¨§¬¥­¿¥² À·³¦®¥Á §­ ·¥­¨¥ y [next[i]]. (±«¨ ¡» ¬» ®¡° ¡ ²»¢ «¨
­¥ ¯°¥´¨ª±»,   ±³´´¨ª±», ²® ½²®© ° §­¨¶» ¡» ­¥ ¡»«®.)  ª ¨
 «£®°¨²¬ List-Rank,  «£®°¨²¬ List-Prefix ¯®¤¤¥°¦¨¢ ¥² ±«¥¤³¾¹¨© ¨­¢ °¨ ­²: ¤«¿ «¾¡»µ ¤¢³µ ° §«¨·­»µ ®¡º¥ª²®¢ i ¨ j «¨¡®
next[i] 6= next[j ], «¨¡® next[i] = next[j ] = nil. ®½²®¬³ ­¥ ¯°®¨±µ®¤¨² ®¤­®¢°¥¬¥­­®£® ®¡° ¹¥­¨¿ ª ¯ ¬¿²¨, ² ª ·²®  «£®°¨²¬ ¬®¦­®
°¥ «¨§®¢ ²¼ ­  EREW-¬ ¸¨­¥.
  °¨±. 30.3 ¯®ª § ­® ±®±²®¿­¨¥ ±¯¨±ª  ¯¥°¥¤ ª ¦¤»¬ ¢»¯®«­¥­¨¥¬ ¶¨ª«  while. ¨ª« ¨¬¥¥² ±«¥¤³¾¹¨© ¨­¢ °¨ ­²: ¯®±«¥ t-£®
¯®¢²®°¥­¨¿ ¶¨ª«  ³ª § ²¥«¨ ®µ¢ ²»¢ ¾² 2t §¢¥­¼¥¢ ±¯¨±ª  (¨«¨

¥°¥µ®¤» ¯® ³ª § ²¥«¿¬

639

¨±. 30.3 30.3.  ¡®²   «£®°¨²¬  List-Prefix. (a). ­ · «¥ ¤«¿ k -£® ®¡º¥ª² 
§­ ·¥­¨¥ y ° ¢­® [k; k],   ³ª § ²¥«¼ next[k] ³ª §»¢ ¥² ­  (k +1)-© ®¡º¥ª² (³ª § ²¥«¼ ¯®±«¥¤­¥£® { ­  nil). (b)-(d). ­ ·¥­¨¿ y ¨ next ¯®±«¥ ª ¦¤®£® ¢»¯®«­¥­¨¿
¶¨ª«  while (±²°®ª¨ 3{6).  ª®­¶¥  «£®°¨²¬  (d) ¤«¿ k-®£® ®¡º¥ª²  §­ ·¥­¨¥ y
° ¢­® [1; k].

° ¢­» nil),   k-© ¯® ±¯¨±ª³ ½«¥¬¥­² µ° ­¨² §­ ·¥­¨¥ [max(1; k ;
2t + 1); k] ¤«¿ k = 1; 2; : : : ; n. ¥°¥¤ ¯¥°¢»¬ ¢»¯®«­¥­¨¥¬ ¶¨ª« 
(t = 0) ª ¦¤»© ®¡º¥ª² (ª°®¬¥ ¯®±«¥¤­¥£®) ³ª §»¢ ¥² ­  ±«¥¤³¾¹¨©.  ±²°®ª¥ 6  «£®°¨²¬  k-© ½«¥¬¥­² (²®·­¥¥, ®²¢¥· ¾¹¨© § 
­¥£® ¯°®¶¥±±®°) ¢»·¨±«¿¥² §­ ·¥­¨¥ [k; k +1] = [k; k] 
 [k +1; k +1],
ª®²®°®¥ ¯¥°¥¤ ¥²±¿ (k + 1)-¬³ ½«¥¬¥­²³. ª § ²¥«¨ ¬¥­¿¾²±¿ ² ª
¦¥, ª ª ¨ ¢  «£®°¨²¬¥ List-Rank. ®±²®¿­¨¥ ±¯¨±ª  ¯®±«¥ ¯¥°¢®£®
¢»¯®«­¥­¨¿ ¶¨ª«  ¯®ª § ­® ­  °¨±. 30.3 (b). °¨ ¢²®°®¬ ¢»¯®«­¥­¨¨ ¶¨ª«  k-© ½«¥¬¥­² (¯°¨ k = 2; 3; : : : ; n ; 2) ¢»·¨±«¿¥² §­ ·¥­¨¥
[k ; 1; k + 2] = [k ; 1; k] 
 [k + 1; k + 2], ª®²®°®¥ ¯¥°¥¤ ¥²±¿ k + 2¬³ ½«¥¬¥­²³; °¥§³«¼² ² ¯®ª § ­ ­  °¨±. 30.3 (c).  ª®­¥¶, ¢ µ®¤¥
²°¥²¼¥£® (¯®±«¥¤­¥£®) ¢»¯®«­¥­¨¿ ¶¨ª«  ®±² ¢¸¨¥±¿ ¤¢  ½«¥¬¥­² 
¢»·¨±«¿¾² ­³¦­»¥ §­ ·¥­¨¿ (°¨±. 30-3 (d)).
 ª ¨ ¯°¥¤»¤³¹¨©  «£®°¨²¬,  «£®°¨²¬ List-Prefix ° ¡®² ¥²
§  ¢°¥¬¿ O(lg n),   ®¡¹¨¥ § ²° ²» ±®±² ¢«¿¾² O(n lg n).
30.1.5. ¥²®¤ ½©«¥°®¢  ¶¨ª« 
 ½²®¬ ° §¤¥«¥ ° ±±¬®²°¥­ ¬¥²®¤ ½©«¥°®¢  ¶¨ª«  ¨ ¥£® ¨±¯®«¼§®¢ ­¨¥ ¢ § ¤ ·¥ ¢»·¨±«¥­¨¿ £«³¡¨­» ¢¥°¸¨­ ¤¢®¨·­®£® ¤¥°¥¢ .
±«¨ ¤¥°¥¢® ¨¬¥¥² n ¢¥°¸¨­, ²® ¢»·¨±«¥­¨¥ ¨µ £«³¡¨­ § ©¬¥² ¢°¥¬¿ O(lg n); ¯°¨ ½²®¬ ¡³¤¥² ¨±¯®«¼§®¢ ­  ²¥µ­¨ª  ¯ ° ««¥«¼­®© ®¡° ¡®²ª¨ ¯°¥´¨ª±®¢.
¥°¥¢® µ° ­¨²±¿ ¢ ¯ ¬¿²¨ ² ª, ª ª ®¯¨± ­® ¢ ° §¤¥«¥ 11.4: ª ¦¤ ¿ ¢¥°¸¨­  i ¨¬¥¥² ¯®«¿ parent[i] (°®¤¨²¥«¼), left[i] («¥¢»©
°¥¡¥­®ª) ¨ right[i] (¯° ¢»© °¥¡¥­®ª).
¬¥¿ ®¤¨­ ¯°®¶¥±±®°, ¬®¦­® ¢»·¨±«¨²¼ £«³¡¨­³ ¢±¥µ ¢¥°¸¨­
¤¥°¥¢  ± n ¢¥°¸¨­ ¬¨ §  ¢°¥¬¿ O(n).  ª ±®ª° ²¨²¼ ½²® ¢°¥¬¿,
¨±¯®«¼§³¿ ­¥±ª®«¼ª® ¯°®¶¥±±®°®¢? °®±²¥©¸¨© ¯ ° ««¥«¼­»©  «£®°¨²¬ ±®±²®¨² ¢ ¤¢¨¦¥­¨¨ ®² ª®°­¿ ¤¥°¥¢  ª «¨±²¼¿¬ ± ³¢¥«¨·¥­¨¥¬ ±·¥²·¨ª  £«³¡¨­». °¨ ½²®¬ ¢¥°¸¨­  £«³¡¨­» k ¤®±²¨£ ¥²±¿ ¢
¬®¬¥­² ¢°¥¬¥­¨ k, ² ª ·²® ¢°¥¬¿ ° ¡®²» ¯°®¯®°¶¨®­ «¼­® ¢»±®²¥
¤¥°¥¢ . «¿ ¯®«­®£® ¤¥°¥¢  ½²®²  «£®°¨²¬ ²°¥¡³¥² «®£ °¨´¬¨·¥±ª®£® ¢°¥¬¥­¨, ­® ¡»¢ ¾² ¤¥°¥¢¼¿, ³ ª®²®°»µ ¢»±®²  ° ¢­  n ; 1.
¥²®¤ ½©«¥°®¢  ¶¨ª« , ª®²®°»© ¬» ±¥©· ± ¨§«®¦¨¬, ¯®§¢®«¿¥² ®¡° ¡®² ²¼ «¾¡®¥ ¤¥°¥¢® ± n ¢¥°¸¨­ ¬¨ §  ¢°¥¬¿ O(lg n) (­¥§ ¢¨±¨¬®
®² ¥£® ¢»±®²»).
©«¥°®¢»¬ ¶¨ª«®¬ ¢ £° ´¥ ­ §»¢ ¥²±¿ ¯³²¼, ¯°®µ®¤¿¹¨© °®¢­® ®¤¨­ ° § ¯® ª ¦¤®¬³ °¥¡°³ (¢¥°¸¨­» ¬®£³² ¯°®µ®¤¨²¼±¿ ¬­®-

640

« ¢  30 «£®°¨²¬» ¯ ° ««¥«¼­»µ ¢»·¨±«¥­¨©
¨±. 30.4 30.4. ±¯®«¼§®¢ ­¨¥ ¬¥²®¤  ½©«¥°®¢  ¶¨ª«  ¤«¿ ¢»·¨±«¥­¨¿ £«³¡¨­»
¢¥°¸¨­ ¤¢®¨·­®£® ¤¥°¥¢ . (a) ©«¥°®¢³ ¶¨ª«³ (®¡µ®¤³ ¤¥°¥¢ ) ±®®²¢¥²±²¢³¥²
±¯¨±®ª.  ¦¤»© ¯°®¶¥±±®° µ° ­¨² ·¨±«®, ª®²®°®¥ ¨±¯®«¼§³¥²±¿ ¯°¨ ¯ ° ««¥«¼­®¬ ¢»·¨±«¥­¨¨ ¯°¥´¨ª±®¢. (b) ¥§³«¼² ² ¢»·¨±«¥­¨¿ ¯°¥´¨ª±®¢ ¤«¿ ¤¥°¥¢  ­ 
°¨±³­ª¥ (a). C -¯°®¶¥±±®° ª ¦¤®© ¢¥°¸¨­» (§ ·¥°­¥­­»©) ±®¤¥°¦¨² ¥¥ £«³¡¨­³.

£®ª° ²­®). ®£« ±­® § ¤ ·¥ 23-2, ±¢¿§­»© ®°¨¥­²¨°®¢ ­­»© £° ´
¨¬¥¥² ½©«¥°®¢ ¶¨ª« ¢ ²®¬ ¨ ²®«¼ª® ¢ ²®¬ ±«³· ¥, ª®£¤  ³ ª ¦¤®©
¢¥°¸¨­» ¢µ®¤­ ¿ ¨ ¢»µ®¤­ ¿ ±²¥¯¥­¨ ±®¢¯ ¤ ¾². ±«¨ ¯°¥¢° ²¨²¼
±¢¿§­»© ­¥®°¨¥­²¨°®¢ ­­»© £° ´ ¢ ®°¨¥­²¨°®¢ ­­»©, § ¬¥­¨¢ ª ¦¤®¥ °¥¡°® ¤¢³¬¿ ¯°®²¨¢®­ ¯° ¢«¥­­»¬¨, ²® ² ª®© £° ´, ®·¥¢¨¤­®, ¡³¤¥² ¨¬¥²¼ ½©«¥°®¢ ¶¨ª«.
³±²¼ T { ¤¢®¨·­®¥ ¤¥°¥¢®. ³¤¥¬ ¯°¥¤¯®« £ ²¼, ·²® ¥£® ¢¥°¸¨­» § ­³¬¥°®¢ ­» ­¥®²°¨¶ ²¥«¼­»¬¨ ¶¥«»¬¨ ·¨±« ¬¨.  ª ¦¤®©
¢¥°¸¨­®© ¬» ±¢¿§»¢ ¥¬ ²°¨ ¯°®¶¥±±®°  A, B ¨ C ; ³§«³ ± ­®¬¥°®¬
i ±®®²¢¥²±²¢³¾² ¯°®¶¥±±®°» ± ­®¬¥° ¬¨ 3i, 3i + 1 ¨ 3i + 2.  ±±¬®²°¨¬ ®°¨¥­²¨°®¢ ­­»© ¢ °¨ ­² ¤¥°¥¢  (± ³¤¢®¥­­»¬¨ °¥¡° ¬¨).
©«¥°®¢ ¶¨ª« (¨«¨ ®¡µ®¤ ¤¥°¥¢ ) ¬®¦­® ¯°¥¢° ²¨²¼ ¢ ±¯¨±®ª (±¬.
°¨±. 30.4(a)):
 A-¯°®¶¥±±®° ¢¥°¸¨­» ³ª §»¢ ¥² ­  A-¯°®¶¥±±®° «¥¢®£®
°¥¡¥­ª , ¥±«¨ ®­ ¥±²¼,   ¨­ ·¥ ­  B -¯°®¶¥±±®° ²®© ¦¥ ¢¥°¸¨­».
 B-¯°®¶¥±±®° ¢¥°¸¨­» ³ª §»¢ ¥² ­  A-¯°®¶¥±±®° ¯° ¢®£®
°¥¡¥­ª , ¥±«¨ ®­ ¥±²¼,   ¨­ ·¥ ­  C -¯°®¶¥±±®° ²®© ¦¥ ¢¥°¸¨­».
 C -¯°®¶¥±±®° ¢¥°¸¨­» ³ª §»¢ ¥² ­  B-¯°®¶¥±±®° °®¤¨²¥«¿, ¥±«¨
½²® «¥¢»© °¥¡¥­®ª, ¨ ­  C -¯°®¶¥±±®° °®¤¨²¥«¿, ¥±«¨ ½²® ¯° ¢»©
°¥¡¥­®ª. C -¯°®¶¥±±®° ª®°­¥¢®© ¢¥°¸¨­» ³ª §»¢ ¥² ­  nil.
 ª¨¬ ®¡° §®¬, ±¯¨±®ª ­ ·¨­ ¥²±¿ ¢ A-¯°®¶¥±±®°¥ ª®°­¥¢®© ¢¥°¸¨­» ¨ § ª ­·¨¢ ¥²±¿ ¢ ¥¥ C -¯°®¶¥±±®°¥. ²®² ±¯¨±®ª ¬®¦¥² ¡»²¼
¯®±²°®¥­ ¯® ¤ ­­®¬³ ¤¥°¥¢³ §  ¢°¥¬¿ O(1).
«³¡¨­³ ª ¦¤®© ¢¥°¸¨­» ¬®¦­® ¯®¤±·¨² ²¼ ª ª ±³¬¬³ ¨§¬¥­¥­¨© £«³¡¨­ ¯® ¯³²¨ ª ­¥© (¯® ½©«¥°®¢®¬³ ¶¨ª«³). ®«¥¥ ´®°¬ «¼­®, ¯³±²¼ ¢ ª ¦¤®¬ A-¯°®¶¥±±®°¥ ­ µ®¤¨²±¿ ·¨±«® 1, ¢ ª ¦¤®¬ B ¯°®¶¥±±®°¥ | ·¨±«® 0,   ¢ ª ¦¤®¬ C -¯°®¶¥±±®°¥ | ·¨±«® (;1). °®¨§¢¥¤¥¬ ¯ ° ««¥«¼­®¥ ¢»·¨±«¥­¨¥ ¯°¥´¨ª±®¢, ¨±¯®«¼§³¿ ¢ ª ·¥±²¢¥
®¯¥° ¶¨¨ ®¡»·­®¥ ±«®¦¥­¨¥. £® °¥§³«¼² ² ¤«¿ ¤¥°¥¢  °¨±. 30.4(a)
¯®ª § ­ ­  °¨±. 30.4(b).
®±«¥ ½²®£® C -¯°®¶¥±±®° ª ¦¤®© ¢¥°¸¨­» ¡³¤¥² ±®¤¥°¦ ²¼ ¥¥
£«³¡¨­³,   A- ¨ B -¯°®¶¥±±®°» | ­  ¥¤¨­¨¶³ ¡®«¼¸¥¥ §­ ·¥­¨¥. ²®
¬®¦­® ¯°®¢¥°¨²¼, ¤¢¨£ ¿±¼ ¢¤®«¼ ½©«¥°®¢  ¶¨ª« .  ± ¬®¬ ¤¥«¥, ª
A-¯°®¶¥±±®°³ ¢¥¤¥² ±²°¥«ª  ¢­¨§ ¯® ¤¥°¥¢³ ± ­ · «®¬ ¢ A- ¨«¨
B-¯°®¶¥±±®°¥ °®¤¨²¥«¿; ª B-¯°®¶¥±±®°³ ¢¥¤¥² «¨¡® ±²°¥«ª  ¢¢¥°µ
¨§ C -¯°®¶¥±±®°  «¥¢®£® ¯®²®¬ª , «¨¡® ±²°¥«ª  ¨§ A-¯°®¶¥±±®° 
²®© ¦¥ ¢¥°¸¨­»; ª C -¯°®¶¥±±®°³ ¢¥¤¥² «¨¡® ±²°¥«ª  ¢¢¥°µ ¨§ C ¯°®¶¥±±®°  ¯° ¢®£® ¯®²®¬ª , «¨¡® ±²°¥«ª  ¨§ B -¯°®¶¥±±®°  ²®©

¥°¥µ®¤» ¯® ³ª § ²¥«¿¬

641

¦¥ ¢¥°¸¨­»; ¢® ¢±¥µ ±«³· ¿µ ­ ¸¥ ³²¢¥°¦¤¥­¨¥ ®±² ¥²±¿ ¢¥°­»¬.
®§¤ ­¨¥ ±¯¨±ª  § ­¨¬ ¥² ¢°¥¬¿ O(1),   ¯ ° ««¥«¼­ ¿ ®¡° ¡®²ª 
¯°¥´¨ª±®¢ | ¢°¥¬¿ O(lg 3n), ². ¥. O(lg n).  ª¨¬ ®¡° §®¬, ®¡¹¥¥
¢°¥¬¿ ° ¡®²» ±®±² ¢«¿¥² O(lg n). ®±ª®«¼ª³ ¯ ° ««¥«¼­ ¿ ®¡° ¡®²ª  ¯°¥´¨ª±®¢ ­¥ ²°¥¡³¥² ®¤­®¢°¥¬¥­­®£® ¤®±²³¯  ª ¯ ¬¿²¨,
 «£®°¨²¬ ¬®¦¥² ¡»²¼ °¥ «¨§®¢ ­ ­  EREW-¬ ¸¨­¥.
¯° ¦­¥­¨¿
30.1-1. ª ¦¨²¥ EREW- «£®°¨²¬, ª®²®°»© ¤«¿ ª ¦¤®£® ½«¥¬¥­²  n-½«¥¬¥­²­®£® ±¯¨±ª  ®¯°¥¤¥«¿¥², ¿¢«¿¥²±¿ «¨ ®­ ±°¥¤­¨¬
(bn=2c-¬), §  ¢°¥¬¿ O(lg n).
30.1-2. ®±²°®©²¥ EREW- «£®°¨²¬ ¤«¿ ®¡° ¡®²ª¨ ¯°¥´¨ª±®¢
¬ ±±¨¢  x[1 : : :n] §  ¢°¥¬¿ O(lg n). (®¦­® ®¡®©²¨±¼ ¡¥§ ³ª § ²¥«¥©)
30.1-3. ³±²¼ ¢ ±¯¨±ª¥ L ¨¬¥¾²±¿ ®¡º¥ª²» ¤¢³µ ° §­»µ ²¨¯®¢
(­¥ª®²®°»¥ ª° ±­»¥,   ®±² «¼­»¥ ±¨­¨¥). ª ¦¨²¥ ½´´¥ª²¨¢­»©
EREW- «£®°¨²¬, ´®°¬¨°³¾¹¨© ¨§ ½²®£® ±¯¨±ª  ¤¢ : ®¤¨­ ¨§ ±¨­¨µ ®¡º¥ª²®¢,   ¤°³£®© ¨§ ª° ±­»µ (± ±®µ° ­¥­¨¥¬ ¢§ ¨¬­®£® ° ±¯®«®¦¥­¨¿).
30.1-4. ³±²¼ ¨¬¥¥²±¿ ­¥±ª®«¼ª® ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ª®«¼¶¥¢»µ
±¯¨±ª®¢, ±®¤¥°¦ ¹¨µ ¢ ±®¢®ª³¯­®±²¨ n ½«¥¬¥­²®¢. ª ¦¨²¥ ½´´¥ª²¨¢­»© EREW- «£®°¨²¬, ª®²®°»© ¢»¡¨° ¥² ¯® ®¤­®¬³ ¯°¥¤±² ¢¨²¥«¾ ¨§ ª ¦¤®£® ±¯¨±ª  ¨ ±®®¡¹ ¥² ª ¦¤®¬³ ½«¥¬¥­²³, ª²®
¿¢«¿¥²±¿ ¯°¥¤±² ¢¨²¥«¥¬ ¥£® ±¯¨±ª . (·¨² ¥²±¿, ·²® ¯°®¶¥±±®°»
§ ­³¬¥°®¢ ­» ¨ ª ¦¤®¬³ ¯°®¶¥±±®°³ ¨§¢¥±²¥­ ¥£® ±®¡±²¢¥­­»© ­®¬¥°.)
30.1-5.  ©¤¨²¥ EREW- «£®°¨²¬, ª®²®°»© §  ¢°¥¬¿ O(lg n) ®¯°¥¤¥«¿¥² ¤«¿ ª ¦¤®© ¢¥°¸¨­» ° §¬¥° ¯®¤¤¥°¥¢  ± ª®°­¥¬ ¢ ½²®© ¢¥°¸¨­¥. (ª § ­¨¥: ±«¥¤³¥² ¢§¿²¼ ° §­®±²¼ ¤¢³µ ¯°¥´¨ª±®¢ ±³¬¬»
¢¤®«¼ ½©«¥°®¢  ¶¨ª« ).
30.1-6. ¥°¸¨­» ¤¥°¥¢  ¬®¦­® ­³¬¥°®¢ ²¼ ¢ ° §­®¬ ¯®°¿¤ª¥.
 ±±¬®²°¨¬ ²°¨ ±¯®±®¡ : ª®°¥­¼ | «¥¢®¥ ¯®¤¤¥°¥¢® | ¯° ¢®¥ ¯®¤¤¥°¥¢® (preorder); «¥¢®¥ ¯®¤¤¥°¥¢® | ª®°¥­¼ | ¯° ¢®¥ ¯®¤¤¥°¥¢® (inorder); «¥¢®¥ ¯®¤¤¥°¥¢® | ¯° ¢®¥ ¯®¤¤¥°¥¢® | ª®°¥­¼ (postorder). ª ¦¨²¥ ¤«¿ ª ¦¤®£® ¨§ ±¯®±®¡®¢  «£®°¨²¬, ¢»·¨±«¿¾¹¨©
­®¬¥°  ¢±¥µ ¢¥°¸¨­.
30.1-7.  ±¯°®±²° ­¨²¥ ¬¥²®¤ ½©«¥°®¢  ¶¨ª«  ­  ¤¥°¥¢¼¿ ± ¯°®¨§¢®«¼­®© ±²¥¯¥­¼¾ ¢¥°¸¨­ (¢»¡° ¢ ¯®¤µ®¤¿¹¥¥ ¯°¥¤±² ¢«¥­¨¥ ¤¥°¥¢ ). ®±²°®©²¥  «£®°¨²¬, ¢»·¨±«¿¾¹¨© £«³¡¨­³ ¢±¥µ n ¢¥°¸¨­
¤¥°¥¢  (¢ ½²®¬ ¯°¥¤±² ¢«¥­¨¨) §  ¢°¥¬¿ O(lg n).
30.1-8. §¬¥­¨²¥  «£®°¨²¬ List-Rank ² ª, ·²®¡» ¯°®¢¥°ª  ³±«®¢¨¿ ®ª®­· ­¨¿ ¶¨ª«  ¯°®¨§¢®¤¨« ±¼ ¿¢­® (¡¥§ ¨±¯®«¼§®¢ ­¨¿ ³¯° ¢«¿¾¹¥© ±¥²¨), ±®µ° ­¨¢ ®¶¥­ª³ ­  ° ¡®²». (ª § ­¨¥: ±«¥¤¨²¥ § 
¯¥°¢»¬ ½«¥¬¥­²®¬ ±¯¨±ª ).

642

« ¢  30 «£®°¨²¬» ¯ ° ««¥«¼­»µ ¢»·¨±«¥­¨©

30.2. CRCW- ¨ EREW- «£®°¨²¬»
¤­®¢°¥¬¥­­»© ¤®±²³¯ ª ¯ ¬¿²¨ ¢ ¯ ° ««¥«¼­»µ ª®¬¯¼¾²¥° µ
¨¬¥¥² ±¢®¨ ¯«¾±» ¨ ¬¨­³±». ¥¤®±² ²ª®¬ ¿¢«¿¥²±¿ ±«®¦­®±²¼  ¯¯ ° ²­®© ¯®¤¤¥°¦ª¨ ² ª®£® ¤®±²³¯ . °®¬¥ ²®£®, ¢®§¬®¦­®±²¨ ®¤­®¢°¥¬¥­­®£® ¤®±²³¯  ¨±¯®«¼§³¾²±¿ ­¥ ² ª · ±²®.  ¤°³£®© ±²®°®­», ¢ ­¥ª®²®°»µ ±«³· ¿µ ¡¥§ ½²¨µ ¢®§¬®¦­®±²¥© ²°³¤­® ®¡®©²¨±¼.
  ¯° ª²¨ª¥ · ±²® ¢»¡¨° ¥²±¿ ®¤¨­ ¨§ ¯°®¬¥¦³²®·­»µ ¢ °¨ ­²®¢.
 ½²®¬ ° §¤¥«¥ ° ±±¬ ²°¨¢ ¾²±¿ ¯°¥¨¬³¹¥±²¢  ®¤­®¢°¥¬¥­­®£® ¤®±²³¯ . ³¹¥±²¢³¾² § ¤ ·¨, ¤«¿ ª®²®°»µ ­ ¨«³·¸¨© CRCW «£®°¨²¬ ° ¡®² ¥² ¡»±²°¥¥ ­ ¨«³·¸¥£® EREW- «£®°¨²¬ .  ª®¢ , ­ ¯°¨¬¥°, § ¤ ·  ®²»±ª ­¨¿ ª®°­¥© ¤¥°¥¢¼¥¢ ¢ £° ´¥, ¿¢«¿¾¹¥¬±¿ «¥±®¬,   ² ª¦¥ § ¤ ·  ¯®¨±ª  ¬ ª±¨¬ «¼­®£® ½«¥¬¥­²  ¢
¬ ±±¨¢¥. ²¨ § ¤ ·¨ ° ±±¬®²°¥­» ­¨¦¥.
30.2.1. ®«¼§  ¯ ° ««¥«¼­®£® ·²¥­¨¿
³±²¼ ¤ ­® ­¥±ª®«¼ª® ¤¢®¨·­»µ ¤¥°¥¢¼¥¢, § ¤ ­­»µ ±«¥¤³¾¹¨¬
®¡° §®¬: ª ¦¤ ¿ ¢¥°¸¨­  i ¨¬¥¥² ³ª § ²¥«¼ parent[i] ­  °®¤¨²¥«¿ (¥±«¨ ¢¥°¸¨­  ¿¢«¿¥²±¿ ª®°­¥¬, ²® parent[i] = nil). °¥¡³¥²±¿
¤«¿ ª ¦¤®© ¢¥°¸¨­» i ­ ©²¨ ª®°¥­¼ root[i] ¤¥°¥¢ , ª®²®°®¬³ ®­ 
¯°¨­ ¤«¥¦¨².  ª ¦¤®© ¢¥°¸¨­®© ¬» ±¢¿§»¢ ¥¬ ®¤¨­ ¯°®¶¥±±®°.
Find-Roots(F )
1 for(¤«¿) ª ¦¤®£® ¯°®¶¥±±®°  i
2 do if parent[i] = nil
3
then root[i] i
4 while ±³¹¥±²¢³¥² ³§¥« i, ¤«¿ ª®²®°®£® parent[i] 6= nil
5 do for(¤«¿) ª ¦¤®£® ¯°®¶¥±±®°  i
6
do if parent[i] 6= nil
7
then root[i] root[parent[i]]
8
parent[i] parent[parent[i]]
 ¡®²   «£®°¨²¬  ¯®ª § ­  ­  °¨±. 30.5. ®±«¥ ¨­¨¶¨ «¨§ ¶¨¨ (±²°®ª¨ 1{3) ª®°­¨ ¨§¢¥±²­» ²®«¼ª® ¤«¿ ª®°­¥¢»µ ¢¥°¸¨­
(°¨±. 30.5 (a)).  ¶¨ª«¥ while (±²°®ª¨ 4{8) ¯°®¨±µ®¤¿² ¯¥°¥µ®¤» ¯® ³ª § ²¥«¿¬ ¨ § ¯®«­¿¾²±¿ ¯®«¿ root ³ ¢¥°¸¨­ ±«¥¤³¾¹¨µ
(¯® £«³¡¨­¥) ³°®¢­¥©.   °¨±. 30.5 (b){(d) ¯®ª § ­» ±®±²®¿­¨¿
¤¥°¥¢¼¥¢ ¯®±«¥ ¯¥°¢®£®, ¢²®°®£® ¨ ²°¥²¼¥£® ¢»¯®«­¥­¨© ¶¨ª« .
¨ª« ¨¬¥¥² ±«¥¤³¾¹¨© ¨­¢ °¨ ­²: ¯®±«¥ t ¯®¢²®°¥­¨© ¶¨ª«  «¨¡®
parent[i] = nil ¨ root[i] ±®¤¥°¦¨² ¯° ¢¨«¼­»© ³ª § ²¥«¼ ­  ª®°¥­¼,
«¨¡® parent[i] ¥±²¼ ¯°¥¤®ª ­  ° ±±²®¿­¨¨ 2t.
«£®°¨²¬ Find-Roots ¬®¦­® °¥ «¨§®¢ ²¼ ­  CREW-¬ ¸¨­¥;
¢°¥¬¿ ° ¡®²» ±®±² ¢«¿¥² O(lg d), £¤¥ d | ¬ ª±¨¬ «¼­ ¿ ¨§ £«³¡¨­ ¤¥°¥¢¼¥¢. ¥©±²¢¨²¥«¼­®, ¢±¥ § ¯¨±¨ ¿¢«¿¾²±¿ ¨±ª«¾· ¾¹¨¬¨
| ª ¦¤»© ¯°®¶¥±±®° ¯°®¨§¢®¤¨² § ¯¨±¼ ²®«¼ª® ¢ ¯®«¿ ±¢®¥© ¢¥°-

CRCW- ¨ EREW- «£®°¨²¬»

643

30.5. CREW- «£®°¨²¬ ­ µ®¦¤¥­¨¿ ª®°­¥© ¤¥°¥¢¼¥¢. ®¬¥°  ¢¥°¸¨­
° ±¯®«®¦¥­» °¿¤®¬ ± ­¨¬¨. ­³²°¨ ¢¥°¸¨­ ¯®ª § ­» §­ ·¥­¨¿ root. ²°¥«ª¨ ®¡®§­ · ¾² ±±»«ª¨ parent. (a){(d) ®±²®¿­¨¥ ¤¥°¥¢  ¯¥°¥¤ ª ¦¤»¬ ¢»¯®«­¥­¨¥¬ ¶¨ª«  while (±²°®ª¨ 4{8).  ¬¥²¨¬, ·²® ¬ ª±¨¬ «¼­ ¿ ¤«¨­  ¯³²¨ ¯®
±²°¥«ª ¬ ­  ª ¦¤®¬ ¸ £¥ ³¬¥­¼¸ ¥²±¿ ¢¤¢®¥.
¨±. 30.5

¸¨­». ¤­ ª® ·²¥­¨¥ ¢ ±²°®ª µ 7 ¨ 8 ¿¢«¿¥²±¿ ®¤­®¢°¥¬¥­­»¬,
¯®±ª®«¼ª³ ®¤­  ¢¥°¸¨­  ¬®¦¥² ¡»²¼ ¯°¥¤ª®¬ ±° §³ ¤«¿ ­¥±ª®«¼ª¨µ ¤°³£¨µ.  ¯°¨¬¥°, ­  °¨±. 30.5 (b) ¯°¨ ¢²®°®¬ ¢»¯®«­¥­¨¨
¶¨ª«  §­ ·¥­¨¿ root[4] ¨ parent[4] ·¨² ¾²±¿ ¯°®¶¥±±®° ¬¨ 18, 2 ¨
7 ®¤­®¢°¥¬¥­­®.
°¥¬¿ ° ¡®²» ±®±² ¢«¿¥² O(lg d) ¯® ²¥¬ ¦¥ ¯°¨·¨­ ¬, ·²® ¨ ¤«¿
 «£®°¨²¬  List-Rank.
³±²¼ ²¥¯¥°¼ ®¤­®¢°¥¬¥­­®¥ ·²¥­¨¥ § ¯°¥¹¥­®. ®£¤  ¬®¦­® ¯®ª § ²¼, ·²® ­¥ ±³¹¥±²¢³¥²  «£®°¨²¬  ±® ¢°¥¬¥­¥¬ ° ¡®²» ¬¥­¼¸¥

(lg n) (£¤¥ n | ®¡¹¥¥ ª®«¨·¥±²¢® ¢¥°¸¨­). °¨·¨­  ²³² ¢ ²®¬,
·²® ­  ª ¦¤®¬ ¸ £¥ ·¨±«® ¢¥°¸¨­, ª®²®°»¥ §­ ¾² ±¢®© ª®°¥­¼,
³¢¥«¨·¨¢ ¥²±¿ ­¥ ¡®«¥¥ ·¥¬ ¢¤¢®¥, ¯®½²®¬³ ²°¥¡³¥²±¿ 
(lg n) ¸ £®¢ (¤«¿ «¥±  ¨§ ®¤­®£® ¤¥°¥¢ ).
±«¨ ¬ ª±¨¬ «¼­ ¿ ¢»±®²  ¤¥°¥¢¼¥¢ ¬ « , ²®  «£®°¨²¬ FindRoots ° ¡®² ¥²  ±¨¬¯²®²¨·¥±ª¨ ¡»±²°¥¥, ·¥¬ «¾¡®© EREW «£®°¨²¬.  ¯°¨¬¥°, ¯°¨ ¢»±®²¥ ¤¥°¥¢  d = O(lg n) (¯³±²¼, ±ª ¦¥¬, ¨¬¥¥²±¿ ¢±¥£® ®¤­® ¯®«­®¥ ¤¥°¥¢®), CREW- «£®°¨²¬ ° ¡®² ¥² §  ¢°¥¬¿ O(lg lg n),   «¾¡®© EREW- «£®°¨²¬ ²°¥¡³¥² ¢°¥¬¥­¨
O(lg n).
°³£®© (¡®«¥¥ ¯°®±²®©) ¯°¨¬¥° ¢»¨£°»¸  ®² ¯ ° ««¥«¼­®£® ·²¥­¨¿ ±¬. ¢ ³¯°. 30.2-1.
30.2.2. ®«¼§  ¯ ° ««¥«¼­®© § ¯¨±¨
 ±±¬®²°¨¬ § ¤ ·³ ® ­ µ®¦¤¥­¨¨ ¬ ª±¨¬ «¼­®£® ½«¥¬¥­²  ¢ ¬ ±±¨¢¥ ¨§ n ¤¥©±²¢¨²¥«¼­»µ ·¨±¥«. ®¦­® ¤®ª § ²¼, ·²® ¤«¿ ½²®©
§ ¤ ·¨ ­ ¨«³·¸¨© EREW- «£®°¨²¬ ²°¥¡³¥² ¢°¥¬¥­¨ 
(lg n) ¨ ·²®
®¤­®¢°¥¬¥­­®¥ ·²¥­¨¥ ­¥ ¯®§¢®«¿¥² ³¬¥­¼¸¨²¼ ¢°¥¬¿ ° ¡®²». ¤­ ª® ±³¹¥±²¢³¥² CRCW- «£®°¨²¬ ±® ¢°¥¬¥­¥¬ ° ¡®²» O(1).  ¯®¬­¨¬, ·²® ¬» ° ±±¬ ²°¨¢ ¥¬ CRCW-¬®¤¥«¼, ¢ ª®²®°®© ¢±¥ ¯°®¶¥±±®°», ¯°®¨§¢®¤¿¹¨¥ § ¯¨±¼ ¢ ¤ ­­³¾ ¿·¥©ª³, ¤®«¦­» § ¯¨±»¢ ²¼
²³¤  ®¤­® ¨ ²® ¦¥.
³±²¼ A[0 : : :n ; 1] { ¢µ®¤­®© ¬ ±±¨¢.  ¸ CRCW- «£®°¨²¬ ¨±¯®«¼§³¥² n2 ¯°®¶¥±±®°®¢.  ¦¤»© ¯°®¶¥±±®° ±° ¢­¨¢ ¥² ª ª¨¥-²®
¤¢  ½«¥¬¥­²  A[i] ¨ A[j ], £¤¥ 0 6 i; j 6 n ; 1, ¨ ­³¬¥°³¥²±¿ ¯ °®©
¨­¤¥ª±®¢ (i; j ).
Fast-Max(A)
1 n length[A]
2 for i 0 to n ; 1

644

« ¢  30 «£®°¨²¬» ¯ ° ««¥«¼­»µ ¢»·¨±«¥­¨©

30.6. ²»±ª ­¨¥ ¬ ª±¨¬³¬  ¢ ¬ ±±¨¢¥ §  ¢°¥¬¿ O(1) c ¯®¬®¹¼¾  «£®°¨²¬  Fast-Max. «¿ ª ¦¤®© (³¯®°¿¤®·¥­­®©) ¯ °» hi; j i ½«¥¬¥­²®¢ ¬ ±±¨¢ 
A = h5; 6; 9; 2; 9i ¢ ² ¡«¨¶¥ ¯®ª § ­ °¥§³«¼² ² ±° ¢­¥­¨¿ A[i] < A[j ] (T ®§­ · ¥²
true, F | false). ±«¨ ¢ ±²°®ª¥ ¥±²¼ µ®²¿ ¡» ®¤­  ¡³ª¢  T, ²® ±®®²¢¥²±²¢³¾¹¨© ½«¥¬¥­² m ° ¢¥­ false, ¨­ ·¥ | true. «¥¬¥­²» ¬ ±±¨¢ , ¤«¿ ª®²®°»µ ¢
±²®«¡¶¥ m ±²®¨² §­ ·¥­¨¥ true, ¿¢«¿¾²±¿ ¬ ª±¨¬ «¼­»¬¨ (¨ § ¯¨±»¢ ¾²±¿ ¢
¿·¥©ª³ max).
¨±. 30.6

3 do m[i] true
4 for i 0 to n ; 1 ¨ j 0 to n ; 1 (¯ ° ««¥«¼­®)
5 do if A[i] < A[j ]
6
then m[i] false
7 for i 0 to n ; 1 (¯ ° ««¥«¼­®)
8 do if m[i] = true
9
then max A[j ]
10 return max
 ±²°®ª¥ 1 ®¯°¥¤¥«¿¥²±¿ ¤«¨­  ¬ ±±¨¢  A (ª ª¨¬-²® ¨§ ¯°®¶¥±±®°®¢).  ±²°®ª µ 2{3 ª ¦¤»¬ ½«¥¬¥­²®¬ ¬ ±±¨¢  m § ­¨¬ ¥²±¿
ª ª®©-²® ®¤¨­ ¯°®¶¥±±®° (¨µ ³ ­ ± ¤®±² ²®·­® | n2 ) ¨ ¯®¬¥¹ ¥²
²³¤  §­ ·¥­¨¥ true. (³¤³¹¨© ±¬»±« ¬ ±±¨¢  m ² ª®¢: m[i] ¨±²¨­­®, ª®£¤  A[i] | ¬ ª±¨¬ «¼­»© ½«¥¬¥­² ¢ ¬ ±±¨¢¥).
 «¼­¥©¸ ¿ ° ¡®²   «£®°¨²¬  ¯®ª § ­  ­  °¨±. 30.6.  ±²°®ª µ
4{6 ¯°®¨±µ®¤¨² ±° ¢­¥­¨¥ ¢±¥µ ¢®§¬®¦­»µ ¯ ° A[i] ¨ A[j ]. ±«¨
A[i] < A[j ], ²® A[i] ­¥ ¬®¦¥² ¡»²¼ ¬ ª±¨¬ «¼­»¬ ½«¥¬¥­²®¬, ¯®½²®¬³ ¬» § ¯¨±»¢ ¥¬ ¢ m[i] §­ ·¥­¨¥ false (±²°®ª  6). ¥±ª®«¼ª®
° §«¨·­»µ ¯°®¶¥±±®°®¢ ¬®£³² ®¤­®¢°¥¬¥­­® ¯°®¨§¢®¤¨²¼ § ¯¨±¼ ¢
¿·¥©ª³ m[i], ­® ¢±¥ ®­¨ § ¯¨±»¢ ¾² ®¤­® ¨ ²® ¦¥ §­ ·¥­¨¥ { false.
 ª¨¬ ®¡° §®¬, ¯®±«¥ ¢»¯®«­¥­¨¿ ±²°®ª 4{6 m[i] ¨±²¨­­® ¤«¿
²¥µ ¨ ²®«¼ª® ²¥µ ¨­¤¥ª±®¢ i, ¤«¿ ª®²®°»µ A[i] | ¬ ª±¨¬ «¼­»©
½«¥¬¥­².  ±²°®ª µ 7{9 ¬ ª±¨¬ «¼­®¥ §­ ·¥­¨¥ ¯®¬¥¹ ¥²±¿ ¢ ¯¥°¥¬¥­­³¾ max, ª®²®° ¿ ¿¢«¿¥²±¿ ¢»µ®¤­»¬ §­ ·¥­¨¥¬ (±²°®ª  10). 
¯¥°¥¬¥­­®© max ¬®£³² ®¡° ¹ ²¼±¿ ±° §³ ­¥±ª®«¼ª® ¯°®¶¥±±®°®¢,
­® ¢±¥ ®­¨ ¯°¨±¢ ¨¢ ¾² ¥© ®¤­® ¨ ²® ¦¥ §­ ·¥­¨¥, ª ª ¨ ²°¥¡³¥²±¿
¢ ¬®¤¥«¨ ®¤­®¢°¥¬¥­­®© § ¯¨±¨ ®¡¹¥£® §­ ·¥­¨¿.
®±ª®«¼ª³ ¢»¯®«­¥­¨¥ ª ¦¤®£® ¨§ ¶¨ª«®¢ § ­¨¬ ¥² ¢°¥¬¿ O(1)
(¢±¥ ¯°®¶¥±±®°» ° ¡®² ¾² ®¤­®¢°¥¬¥­­®), ®¡¹¥¥ ¢°¥¬¿ ° ¡®²»  «£®°¨²¬  ±®±² ¢«¿¥² O(1). «£®°¨²¬ ­¥ ¿¢«¿¥²±¿ ½´´¥ª²¨¢­»¬ ¯®
§ ²° ² ¬: ®¡¹¨¥ § ²° ²» ±®±² ¢«¿¾² n2  O(1) = O(n2),   ¯°®±²¥©¸¨© ®¤­®¯°®¶¥±±®°­»©  «£®°¨²¬ ° ¡®² ¥² §  ¢°¥¬¿ (n). ®«¥¥
½´´¥ª²¨¢­»©  «£®°¨²¬ ° ±±¬ ²°¨¢ ¥²±¿ ¢ ³¯° ¦­¥­¨¨ 30.2-6.
 ±³¹­®±²¨,  «£®°¨²¬ ¯®¨±ª  ¬ ª±¨¬³¬  ®±­®¢ ­ ­  ¢®§¬®¦­®±²¨ ¢»·¨±«¨²¼ «®£¨·¥±ª®¥  ®² n  °£³¬¥­²®¢ §  ¢°¥¬¿ O(1) ¯°¨
­ «¨·¨¨ n ¯°®¶¥±±®°®¢ ¢ ¬®¤¥«¨ ± ®¤­®¢°¥¬¥­­®© § ¯¨±¼¾ ®¡¹¥£®
§­ ·¥­¨¿ (¨ ¢ ¤°³£¨µ, ¡®«¥¥ ¬®¹­»µ CRCW-¬®¤¥«¿µ).  ª²¨·¥±ª¨

CRCW- ¨ EREW- «£®°¨²¬»

645

¤«¿ i = 0; 1; : : : ; n ; 1 ¢»·¨±«¿¥²±¿

m[i] =

n^
;1
j =0

(A[i] > A[j ])

®§¬®¦­®±²¼ ¡»±²°® ¢»·¨±«¿²¼ «®£¨·¥±ª®¥  ®² ¬­®£¨µ  °£³¬¥­²®¢ ¨±¯®«¼§³¥²±¿ ¨ ¢ ¤°³£¨µ ±¨²³ ¶¨¿µ.  ¯°¨¬¥°, ¢ ° ­¥¥ ° ±±¬®²°¥­­»µ EREW- «£®°¨²¬ µ ¬®¦­® ®¡®©²¨±¼ ¡¥§ ¨±¯®«¼§®¢ ­¨¿
³¯° ¢«¿¾¹¥© ±¥²¨ ¯°¨ ¯°®¢¥°ª¥ ³±«®¢¨¿ ®ª®­· ­¨¿ ¶¨ª« , § ¢¨±¿¹¥£® ®² ±®±²®¿­¨¿ ¢±¥µ ¯°®¶¥±±®°®¢, ¥±«¨ ½²® ³±«®¢¨¥ ¥±²¼ ª®­º¾­ª¶¨¿ ³±«®¢¨©, ¯°®¢¥°¿¥¬»µ ¢ ª ¦¤®¬ ¨§ ¯°®¶¥±±®°®¢ §  ¢°¥¬¿
O(1).
EREW-¬ ¸¨­  ­¥ ®¡« ¤ ¥² ² ª¨¬¨ ¢®§¬®¦­®±²¿¬¨: «¾¡®©
EREW- «£®°¨²¬ ­ µ®¦¤¥­¨¿ ¬ ª±¨¬ «¼­®£® ½«¥¬¥­²  ¢ ¬ ±±¨¢¥
²°¥¡³¥² ¢°¥¬¥­¨ 
(lg n). °¨·¨­  ²³² ¢ ²®¬, ·²® ¯®±«¥ ª ¦¤®£®
¸ £   «£®°¨²¬  ·¨±«® ¯®²¥­¶¨ «¼­® ¬ ª±¨¬ «¼­»µ ½«¥¬¥­²®¢
³¬¥­¼¸ ¥²±¿ ­¥ ¡®«¥¥ ·¥¬ ¢¤¢®¥, ¯®±ª®«¼ª³ ¤«¿ ²®£®, ·²®¡» ¨±ª«¾·¨²¼ ½«¥¬¥­² ¨§ ·¨±«  À¯®¤®§°¥¢ ¥¬»µÁ, ­³¦­®, ·²®¡» ®­
®ª § «±¿ ¬¥­¼¸¥ ª ª®£®-²® ¤°³£®£®. «¥¤®¢ ²¥«¼­®, ª ¦¤®¥ ±° ¢­¥­¨¥ ®²¡° ±»¢ ¥² ¬ ª±¨¬³¬ ®¤¨­ ½«¥¬¥­²,   ·¨±«® ±° ¢­¥­¨© § 
®¤¨­ ¸ £ ­¥ ¬®¦¥² ¡»²¼ ¡®«¼¸¥ ¯®«®¢¨­» ·¨±«  ®±² ¢¸¨µ±¿ ¯®¤
¯®¤®§°¥­¨¥¬ ½«¥¬¥­²®¢.
­²¥°¥±­®, ·²® ­¨¦­¿¿ ®¶¥­ª  
(lg n) ±®µ° ­¿¥²±¿, ¤ ¦¥ ¥±«¨
° §°¥¸¨²¼ ®¤­®¢°¥¬¥­­®¥ ·²¥­¨¥, ²® ¥±²¼ «¾¡®© CREW- «£®°¨²¬
² ª¦¥ ²°¥¡³¥² ¢°¥¬¥­¨ 
(lg n). ³ª, ¢®°ª ¨  ©¸³ª [50] ¯®ª § «¨, ·²® ¢°¥¬¿ ° ¡®²» CREW- «£®°¨²¬  ­¥ ¬®¦¥² ¡»²¼ ¬¥­¼¸¥

(lg n) ¤ ¦¥ ¯°¨ ­ «¨·¨¨ ­¥®£° ­¨·¥­­®£® ·¨±«  ¯°®¶¥±±®°®¢ ¨
­¥®£° ­¨·¥­­®© ¯ ¬¿²¨. ¥ ¦¥ ®¶¥­ª¨ ¢¥°­» ¨ ¤«¿ § ¤ ·¨ ¢»·¨±«¥­¨¿ «®£¨·¥±ª®£®  ®² n  °£³¬¥­²®¢.
30.2.3. ®¤¥«¨°®¢ ­¨¥ CRCW-¬ ¸¨­» ± ¯®¬®¹¼¾ EREW-¬ ¸¨­»
» ¢¨¤¥«¨, ·²® CRCW- «£®°¨²¬» ¨­®£¤  ° ¡®² ¾² ¡»±²°¥¥
±®®²¢¥²±²¢³¾¹¨µ EREW- «£®°¨²¬®¢ (­® ­¥ ­ ®¡®°®²: «¾¡®©
EREW- «£®°¨²¬ ¬®¦¥² ¢»¯®«­¿²¼±¿ CRCW-¬ ¸¨­®© ¡¥§ ¨§¬¥­¥­¨©). ² ª, CRCW-¬ ¸¨­  ®¡« ¤ ¥² ¡®«¼¸¨¬¨ ¢®§¬®¦­®±²¿¬¨,
­® ­ ±ª®«¼ª® ®­¨ ¡®«¼¸¥? ª §»¢ ¥²±¿, ·²® ¥±«¨ ·¨±«® ¯°®¶¥±±®°®¢ ®£° ­¨·¥­®, ²® ¬®¦­® ®¶¥­¨²¼ ±¢¥°µ³ ¯°¥¨¬³¹¥±²¢®
CRCW-¬ ¸¨­» ¯¥°¥¤ EREW-¬ ¸¨­®©:
¥®°¥¬  30.1. «¿ «¾¡®£® CRCW- «£®°¨²¬  (¢ ¬®¤¥«¨ ®¤­®¢°¥¬¥­­®© § ¯¨±¨ ®¡¹¥£® §­ ·¥­¨¿), ¨±¯®«¼§³¾¹¥£® p ¯°®¶¥±±®°®¢,
±³¹¥±²¢³¥² EREW- «£®°¨²¬ ¤«¿ ²®© ¦¥ § ¤ ·¨, ¢°¥¬¿ ° ¡®²» ª®²®°®£® ¡®«¼¸¥ ¢°¥¬¥­¨ ° ¡®²» ¨±µ®¤­®£®  «£®°¨²¬  ­¥ ¡®«¥¥ ·¥¬
¢ O(lg p) ° §.
®ª § ²¥«¼±²¢®

646

« ¢  30 «£®°¨²¬» ¯ ° ««¥«¼­»µ ¢»·¨±«¥­¨©

30.7. ®¤¥«¨°®¢ ­¨¥ ®¤­®¢°¥¬¥­­®© § ¯¨±¨ ­  EREW-¬ ¸¨­¥. (a)
 £  «£®°¨²¬  ¢ CRCW-¬®¤¥«¨ ± ®¤­®¢°¥¬¥­­®© § ¯¨±¼¾ ®¡¹¥£® §­ ·¥­¨¿,
ª®£¤  ¯°®¶¥±±®°» ®±³¹¥±²¢«¿¾² ®¤­®¢°¥¬¥­­³¾ § ¯¨±¼ (¯°®¶¥±±®°» P0 , P2 ¨
P5 ). (b) ®¤¥«¨°®¢ ­¨¥ ½²®£® ¸ £  ­  EREW-¬ ¸¨­¥. ­ · «¥ ¯ °  (¿·¥©ª , §­ ·¥­¨¥) § ¯¨±»¢ ¥²±¿ ¢ ¬ ±±¨¢ A.  ²¥¬ ¬ ±±¨¢ ±®°²¨°³¥²±¿ ¯® ¯¥°¢®©
ª®¬¯®­¥­²¥, ¨ § ¯¨±»¢ ¥²±¿ «¨¸¼ ¯¥°¢®¥ ¨§ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ®¤¨­ ª®¢»µ
§­ ·¥­¨©.
¨±. 30.7

¨±¯®«¼§³¥² ´ ª², ° ±±¬ ²°¨¢ ¥¬»© ¢ ° §¤¥«¥ 30.3: ±³¹¥±²¢³¥²
EREW- «£®°¨²¬ ±®°²¨°®¢ª¨ p ½«¥¬¥­²®¢, ª®²®°»© ¨±¯®«¼§³¥² p
¯°®¶¥±±®°®¢ ¨ ° ¡®² ¥² §  ¢°¥¬¿ O(lg p).
®±² ²®·­® ³ª § ²¼ EREW- «£®°¨²¬, ª®²®°»© ¬®¤¥«¨°³¥² ª ¦¤»© ¸ £ CRCW- «£®°¨²¬  §  ¢°¥¬¿ O(lg p). ®±ª®«¼ª³ ·¨±«®
¯°®¶¥±±®°®¢ ¢ ®¡®¨µ ±«³· ¿µ ®¤­® ¨ ²® ¦¥, ­³¦­® «¨¸¼ ±¬®¤¥«¨°®¢ ²¼ ®¤­®¢°¥¬¥­­»© ¤®±²³¯ ª ¯ ¬¿²¨. » ° ±±¬®²°¨¬ ¢®¯°®±
®¡ ®¤­®¢°¥¬¥­­®© § ¯¨±¨, ®±² ¢¨¢ ®¤­®¢°¥¬¥­­®¥ ·²¥­¨¥ ·¨² ²¥«¾
(³¯°. 30.2-7).
«¿ ¬®¤¥«¨°®¢ ­¨¿ ®¤­®¢°¥¬¥­­®© § ¯¨±¨ ¨±¯®«¼§³¥²±¿ ¤®¯®«­¨²¥«¼­»© ¬ ±±¨¢ A ° §¬¥°  p. ¨±. 30.7 ¤¥¬®­±²°¨°³¥² ®±­®¢­³¾
¨¤¥¾. ±«¨ ¯°®¶¥±±®° Pi (¯°¨ i = 0; 1; : : : ; n ; 1) ­ ¯° ¢«¿¥² ¤«¿
§ ¯¨±¨ ¢ ¿·¥©ª³ ± ­®¬¥°®¬ li §­ ·¥­¨¥ xi , ²® ¢ ±®®²¢¥²±²¢³¾¹¥¬
EREW- «£®°¨²¬¥ ¯ °  (li; xi) § ¯¨±»¢ ¥²±¿ ¢ ¿·¥©ª³ A[i]. °¨ ½²®¬
§ ¯¨±¨ ®ª §»¢ ¾²±¿ ¨±ª«¾· ¾¹¨¬¨.  ²¥¬ ¬ ±±¨¢ A ±®°²¨°³¥²±¿
¯® ¯¥°¢®© ª®®°¤¨­ ²¥ §  ¢°¥¬¿ O(lg p). ®±«¥ ½²®£® ¢±¥ ¤ ­­»¥,
¯®±²³¯¨¢¸¨¥ ¤«¿ § ¯¨±¨ ¢ ¤ ­­³¾ ¿·¥©ª³, ®ª §»¢ ¾²±¿ °¿¤®¬.
­ ¤¯¨±¨ ­  ª °²¨­ª¥:
®¡¹ ¿ ¯ ¬¿²¼ CRCW-¬ ¸¨­»
±®¤¥°¦¨¬®¥ CRCW-¯ ¬¿²¨ [¢¬¥±²® simulated CRCW global memory]
±®°²¨°®¢ª 
 ²¥¬ ª ¦¤»© ¯°®¶¥±±®° Pi (¯°¨ i = 1; 2; : : : ; n ; 1) ±° ¢­¨¢ ¥² ¯¥°¢»¥ ª®®°¤¨­ ²» ±¢®¥£® ¨ ¯°¥¤¸¥±²¢³¾¹¥£® ½«¥¬¥­²®¢, ²®
¥±²¼ A[i] = (lj ; xj ) ¨ A[i ; 1] = (lk ; xk ). ±«¨ lj 6= lk ¨«¨ i = 0,
²® ¯°®¶¥±±®° Pi § ¯¨±»¢ ¥² §­ ·¥­¨¥ xj ¢ ¿·¥©ª³ lj ,   ¢ ¯°®²¨¢­®¬
±«³· ¥ ­¥ ¤¥« ¥² ­¨·¥£®. °³£¨¬¨ ±«®¢ ¬¨, § ¯¨±»¢ ¥²±¿ ¯¥°¢®¥ ¨§
¯®¤°¿¤ ¨¤³¹¨µ §­ ·¥­¨©, ¯®±²³¯¨¢¸¨µ ­  § ¯¨±¼ ¢ ¤ ­­³¾ ¿·¥©ª³. ¥§³«¼² ² ¢±¥£® ¯°®¶¥±±  ¬®¤¥«¨°³¥² ®¤­®¢°¥¬¥­­³¾ § ¯¨±¼,
  ®¡¹¥¥ ¢°¥¬¿ ±®±² ¢«¿¥² O(lg p).
®¦­® ±¬®¤¥«¨°®¢ ²¼ ¨ ¤°³£¨¥ ¢ °¨ ­²» ®¤­®¢°¥¬¥­­®© § ¯¨±¨
(³¯°. 30.2-9).
 ª ¿ ¦¥ ¬®¤¥«¼ ¯°¥¤¯®·²¨²¥«¼­¥© | EREW ¨«¨ CRCW?  ¥±«¨ CRCW, ²® ª ª®© ¨§ ¢ °¨ ­²®¢ ®¤­®¢°¥¬¥­­®© § ¯¨±¨ ¨±¯®«¼§®¢ ²¼? ²®°®­­¨ª¨ ¬®¤¥«¨ CRCW ±±»« ¾²±¿ ­  ²®, ·²® ¯°®£° ¬¬»
¤«¿ CRCW ¯°®¹¥ ¨ ¡»±²°¥¥. °®²¨¢­¨ª¨ £®¢®°¿², ·²® ®¡®°³¤®¢ ­¨¥ ¤«¿ ®¡¥±¯¥·¥­¨¿ ®¤­®¢°¥¬¥­­®£® ¤®±²³¯  ª ¯ ¬¿²¨ § ¬¥¤«¿¥²
½²®² ¤®±²³¯, ¯®½²®¬³ ­  ¯° ª²¨ª¥ ¢»¨£°»¸ ¢® ¢°¥¬¥­¨ ¿¢«¿¥²±¿

CRCW- ¨ EREW- «£®°¨²¬»

647

¬­¨¬»¬.   ± ¬®¬-²® ¤¥«¥ ­¥¢®§¬®¦­® ­ ©²¨ ¬ ª±¨¬³¬ ¢ ¬ ±±¨¢¥
§  ¢°¥¬¿ O(1), £®¢®°¿² ®­¨.
°³£ ¿ ²®·ª  §°¥­¨¿ ±®±²®¨² ¢ ²®¬, ·²® ¬®¤¥«¼ PRAM ¢®®¡¹¥ ¿¢«¿¥²±¿ ­¥¯®¤µ®¤¿¹¥©: ¯°®¶¥±±®°» ¤®«¦­» ¡»²¼ ±®¥¤¨­¥­» ¢
±¥²¼ «¨­¨¿¬¨ ±¢¿§¨, ¨ ®¡¹¥­¨¥ ¤®«¦­® ¡»²¼ ¢®§¬®¦­® «¨¸¼ ¬¥¦¤³
±®±¥¤­¨¬¨ ¢ ±¥²¨ ¯°®¶¥±±®° ¬¨, ² ª ·²® ±²°³ª²³°  ±¥²¨ ¿¢«¿¥²±¿
· ±²¼¾ ¬®¤¥«¨.
¯°®·¥¬, ± ¬ ¢®¯°®± ® À¥¤¨­±²¢¥­­® ¯° ¢¨«¼­®© ¨ ¯®¤«¨­­® ­ ³·­®©Á ¬®¤¥«¨ ¯ ° ««¥«¼­»µ ¢»·¨±«¥­¨© ­¥ ¨¬¥¥² ±¬»±« .  §­»¥
 ±¯¥ª²» °¥ «¼­»µ ª®¬¯¼¾²¥°®¢ ®²° ¦ ¾²±¿ ° §­»¬¨ ¬®¤¥«¿¬¨.
 ª®© ¨§  ±¯¥ª²®¢ ¡®«¥¥ ¢ ¦¥­, ±² ­¥² ¿±­® ¢ ¡³¤³¹¥¬.
¯° ¦­¥­¨¿
30.2-1. ³±²¼ «¥± ±®±²®¨² ¢±¥£® «¨¸¼ ¨§ ®¤­®£® ¤¥°¥¢  ± n ³§« ¬¨.
®ª ¦¨²¥, ·²® ²®£¤  ±³¹¥±²¢³¥² CREW- «£®°¨²¬ ¯®¨±ª  ª®°­¥©
±® ¢°¥¬¥­¥¬ ° ¡®²» O(1) ­¥§ ¢¨±¨¬® ®² £«³¡¨­» ¤¥°¥¢ . ®ª ¦¨²¥, ·²® «¾¡®© EREW- «£®°¨²¬ ¤ ¦¥ ¯°¨ ½²®¬ ¤®¯®«­¨²¥«¼­®¬
¯°¥¤¯®«®¦¥­¨¨ ²°¥¡³¥² ¢°¥¬¥­¨ 
(lg n).
30.2-2. ª ¦¨²¥ EREW- «£®°¨²¬ ¤«¿ ¯®¨±ª  ª®°­¥© ±® ¢°¥¬¥­¥¬
° ¡®²» O(lg n), £¤¥ n { ®¡¹¥¥ ª®«¨·¥±²¢® ³§«®¢ ¢ ¤¥°¥¢¼¿µ.
30.2-3.  ©¤¨²¥ CRCW- «£®°¨²¬, ª®²®°»©, ¨±¯®«¼§³¿ n ¯°®¶¥±±®°®¢, §  ¢°¥¬¿ O(1) ¢»·¨±«¿¥² «®£¨·¥±ª®¥  ®² n  °£³¬¥­²®¢.
30.2-4. ¯¨¸¨²¥ ½´´¥ª²¨¢­»© CRCW- «£®°¨²¬, ª®²®°»© ³¬­®¦ ¥² ¤¢¥ ¡³«¥¢» ¬ ²°¨¶» ° §¬¥°  n  n, ¨±¯®«¼§³¿ n3 ¯°®¶¥±±®°®¢.
30.2-5. ¯¨¸¨²¥ EREW- «£®°¨²¬ ¤«¿ ³¬­®¦¥­¨¿ ¤¢³µ ¢¥¹¥±²¢¥­­»µ ¬ ²°¨¶ ° §¬¥°  n  n §  ¢°¥¬¿ O(lg n), ¨±¯®«¼§³¾¹¨© n3
¯°®¶¥±±®°®¢. ®¦¥²¥ «¨ ¢» ­ ©²¨  «£®°¨²¬ ¤«¿ CRCW-¬ ¸¨­» ±
§ ¯¨±¼¾ ®¡¹¥£® §­ ·¥­¨¿, ° ¡®² ¾¹¨© ¡»±²°¥¥?  ¤«¿ ª ª®©-«¨¡®
¤°³£®© ¬®¤¥«¨ CRCW-¬ ¸¨­»?
30.2-6. ®ª ¦¨²¥, ·²® ¤«¿ «¾¡®£® " > 0 ±³¹¥±²¢³¥² CRCW «£®°¨²¬ ¤«¿ ¯®¨±ª  ¬ ª±¨¬ «¼­®£® ½«¥¬¥­²  ¢ ¬ ±±¨¢¥ ° §¬¥°  n
±® ¢°¥¬¥­¥¬ ° ¡®²» O(1), ¨±¯®«¼§³¾¹¨© O(n1+" ) ¯°®¶¥±±®°®¢.
30.2-7. ¯¨¸¨²¥  «£®°¨²¬ ¤«¿ CRCW-¬ ¸¨­» ± ¯°¨®°¨²¥² ¬¨,
¯®§¢®«¿¾¹¨© ±«¨²¼ ¤¢  ®²±®°²¨°®¢ ­­»µ ¬ ±±¨¢  §  ¢°¥¬¿ O(1).
¡º¿±­¨²¥, ª ª ± ¯®¬®¹¼¾ ½²®£®  «£®°¨²¬  ®²±®°²¨°®¢ ²¼ ¬ ±±¨¢
§  ¢°¥¬¿ O(lg n). ¢«¿¥²±¿ «¨ ¯®«³·¥­­»©  «£®°¨²¬ ±®°²¨°®¢ª¨
½´´¥ª²¨¢­»¬ ¯® § ²° ² ¬?
30.2-8. ¡º¿±­¨²¥, ª ª ±¬®¤¥«¨°®¢ ²¼ ®¤­®¢°¥¬¥­­®¥ ·²¥­¨¥
CRCW-¬ ¸¨­» c p ¯°®¶¥±±®° ¬¨ ­  EREW-¬ ¸¨­¥ §  ¢°¥¬¿
O(lg p) (¯°®¯³¹¥­­ ¿ · ±²¼ ¤®ª § ²¥«¼±²¢  ²¥®°¥¬» 30-1).
30.2-9. ¡º¿±­¨²¥, ª ª ± ¯®¬®¹¼¾ EREW-¬ ¸¨­» ±¬®¤¥«¨°®¢ ²¼ CRCW-¬ ¸¨­³ ± § ¯¨±¼¾ ª®¬¡¨­ ¶¨¨ §­ ·¥­¨©. «¿ p ¯°®¶¥±±®°®¢ ¢°¥¬¿ ° ¡®²» ¤®«¦­® ³¢¥«¨·¨²¼±¿ ­¥ ¡®«¥¥ ·¥¬ ¢ O(lg p)
° §. (ª § ­¨¥: ¨±¯®«¼§³©²¥ ¯ ° ««¥«¼­®¥ ¢»·¨±«¥­¨¥ ¯°¥´¨ª±®¢).

648

« ¢  30 «£®°¨²¬» ¯ ° ««¥«¼­»µ ¢»·¨±«¥­¨©

30.3. ¥®°¥¬  °¥­²  ¨ ½´´¥ª²¨¢­®±²¼ ¯® § ²° ² ¬
¥®°¥¬  °¥­²  ¤ ¥² ±¯®±®¡ ½´´¥ª²¨¢­® ¬®¤¥«¨°®¢ ²¼ ±µ¥¬»
¨§ ´³­ª¶¨®­ «¼­»µ ½«¥¬¥­²®¢ ± ¯®¬®¹¼¾ ¯ ° ««¥«¼­»µ ¬ ¸¨­ ±
¯°®¨§¢®«¼­»¬ ¤®±²³¯®¬ (PRAM).  ¥¥ ¯®¬®¹¼¾ ¬­®£¨¥ °¥§³«¼² ²» ® ±®°²¨°³¾¹¨µ ±¥²¿µ (£« ¢  28) ¨ ±µ¥¬ µ ¨§ ´³­ª¶¨®­ «¼­»µ
½«¥¬¥­²®¢ (£« ¢  29) ¯¥°¥­®±¿²±¿ ­  ¬®¤¥«¼ PRAM.
 ±±¬®²°¨¬ ±µ¥¬³ ¨§ ´³­ª¶¨®­ «¼­»µ ½«¥¬¥­²®¢ (combinational
circuit), ª®²®° ¿ ±®±²®¨² ¨§ ´³­ª¶¨®­ «¼­»µ ½«¥¬¥­²®¢ (combinational element), ±®¥¤¨­¥­­»µ ² ª, ·²® ­¥ ®¡° §³¥²±¿ ¶¨ª«®¢.  ½²®¬
° §¤¥«¥ ¯°¥¤¯®« £ ¥²±¿, ·²® ´³­ª¶¨®­ «¼­»¥ ½«¥¬¥­²» ¨¬¥¾² «¾¡®¥ ª®«¨·¥±²¢® ¢µ®¤®¢, ­® °®¢­® ®¤¨­ ¢»µ®¤ (½«¥¬¥­² ± ­¥±ª®«¼ª¨¬¨ ¢»µ®¤ ¬¨ ¬®¦­® § ¬¥­¨²¼ ­  ­¥±ª®«¼ª® ½«¥¬¥­²®¢ ± ®¤­¨¬
¢»µ®¤®¬). ¨±«® ¢µ®¤®¢ ­ §»¢ ¥²±¿ ¢µ®¤­®© ±²¥¯¥­¼¾ (fan-in) ½«¥¬¥­² ,   ·¨±«® ¢µ®¤®¢, ª ª®²®°»¬ ¯®¤ª«¾·¥­ ¢»µ®¤ ½«¥¬¥­²  | ¥£®
¢»µ®¤­®© ±²¥¯¥­¼¾ (fan-out).  ª ¯° ¢¨«®, ¢ ½²®¬ ° §¤¥«¥ ¯°¥¤¯®« £ ¥²±¿, ·²® ¢µ®¤­»¥ ±²¥¯¥­¨ ¢±¥µ ¨±¯®«¼§³¥¬»µ ½«¥¬¥­²®¢ ®£° ­¨·¥­» ±¢¥°µ³. »µ®¤­»¥ ±²¥¯¥­¨ ¬®£³² ¡»²¼ «¾¡»¬¨.
 §¬¥°®¬ (size) ±µ¥¬» ­ §»¢ ¥²±¿ ª®«¨·¥±²¢® ½«¥¬¥­²®¢ ¢ ­¥©.
 ¨¡®«¼¸¥¥ ·¨±«® ½«¥¬¥­²®¢ ­  ¯³²¿µ ®² ¢µ®¤®¢ ±µ¥¬» ª ¢»µ®¤³
½«¥¬¥­²  ­ §»¢ ¥²±¿ £«³¡¨­®© (depth) ½²®£® ½«¥¬¥­² . «³¡¨­®©
±µ¥¬» ­ §»¢ ¥²±¿ ­ ¨¡®«¼¸ ¿ ¨§ £«³¡¨­ ¥¥ ½«¥¬¥­²®¢.
¥®°¥¬  30.2 (²¥®°¥¬  °¥­² )
°¨ ¬®¤¥«¨°®¢ ­¨¨ ° ¡®²» ±µ¥¬» £«³¡¨­» d ¨ ° §¬¥°  n ±
®£° ­¨·¥­­»¬¨ ¢µ®¤­»¬¨ ±²¥¯¥­¿¬¨ ½«¥¬¥­²®¢ ± ¯®¬®¹¼¾ CREW «£®°¨²¬ , ¨±¯®«¼§³¾¹¥£® p ¯°®¶¥±±®°®¢, ¤®±² ²®·­® ¢°¥¬¥­¨
O(n=p + d).
®ª § ²¥«¼±²¢®.
²¢¥¤¥¬ ¢ ¯ ¬¿²¨ ¬¥±²® ¤«¿ ¢µ®¤­»µ §­ ·¥­¨© ±µ¥¬» ¨ ¤«¿ ¢»µ®¤­»µ §­ ·¥­¨© ¢±¥µ ´³­ª¶¨®­ «¼­»µ ½«¥¬¥­²®¢.  ¡®²³ ª ¦¤®£® ½«¥¬¥­²  ¬®¦­® ±¬®¤¥«¨°®¢ ²¼ ± ¯®¬®¹¼¾ ®¤­®£® ¯°®¶¥±±®°  § 
¢°¥¬¿ O(1): ¯°®¶¥±±®° ·¨² ¥² ¢µ®¤­»¥ §­ ·¥­¨¿ ¨ ¢»·¨±«¿¥² ²°¥¡³¥¬³¾ ´³­ª¶¨¾, § ¯¨±»¢ ¿ °¥§³«¼² ² ­  ­³¦­®¥ ¬¥±²®; ¯®±ª®«¼ª³ ¢µ®¤­»¥ ±²¥¯¥­¨ ¢±¥µ ½«¥¬¥­²®¢ ®£° ­¨·¥­» ±¢¥°µ³, ´³­ª¶¨¾,
±®®²¢¥²±²¢³¾¹³¾ «¾¡®¬³ ½«¥¬¥­²³, ¬®¦­® ¢»·¨±«¨²¼ §  ¢°¥¬¿
O(1).
¥¯¥°¼ ²°¥¡³¥²±¿ ³ª § ²¼, ¢ ª ª®© ¯®±«¥¤®¢ ²¥«¼­®±²¨ ±«¥¤³¥² ¬®¤¥«¨°®¢ ²¼ ° ¡®²³ ´³­ª¶¨®­ «¼­»µ ½«¥¬¥­²®¢ ± ¯®¬®¹¼¾ p
¯°®¶¥±±®°®¢, ·²®¡» ®¡¥±¯¥·¨²¼ ¢°¥¬¿ ° ¡®²» O(n=p + d). °®¡«¥¬  ±®±²®¨² ¢ ²®¬, ·²® ¢»µ®¤­®¥ §­ ·¥­¨¥ ½«¥¬¥­²  ¬®¦­® ¢»·¨±«¨²¼ «¨¸¼ ª®£¤  ¨§¢¥±²­» ¢±¥ ¥£® ¢µ®¤­»¥ §­ ·¥­¨¿. (®«¼¸¨¥
¢»µ®¤­»¥ ±²¥¯¥­¨ ½«¥¬¥­²®¢ ­¥ ±®§¤ ¾² ¯°®¡«¥¬, ¯®±ª®«¼ª³ ®¤­®¢°¥¬¥­­®¥ ·²¥­¨¥ ° §°¥¸¥­®).
­ · «  ¬» ¬®¦¥¬ ¬®¤¥«¨°®¢ ²¼ «¨¸¼ ½«¥¬¥­²» £«³¡¨­» 1 (¨µ

¥®°¥¬  °¥­²  ¨ ½´´¥ª²¨¢­®±²¼ ¯® § ²° ² ¬

649

30.8. ¥®°¥¬  °¥­² . µ¥¬³ ° §¬¥°  15 ¨ £«³¡¨­» 5 ¬®¦­® ±¬®¤¥«¨°®¢ ²¼ ­  CREW-¬ ¸¨­¥ ± ¤¢³¬¿ ¯°®¶¥±±®° ¬¨ §  9 6 15=2 + 5 ¸ £®¢.
«¥¬¥­²» ¬®¤¥«¨°³¾²±¿ ±¢¥°µ³ ¢­¨§ (¢ ¯®°¿¤ª¥ ¢®§° ±² ­¨¿ £«³¡¨­»). «¥¬¥­²», ª®²®°»¥ ¬®¤¥«¨°³¾²±¿ ®¤­®¢°¥¬¥­­®, ®¡º¥¤¨­¥­» ¢ £°³¯¯» (¯®ª § ­»
±¥°»¬ ¶¢¥²®¬); ¤«¿ ª ¦¤®© £°³¯¯» ³ª § ­®, ­  ª ª®¬ ¸ £¥ ¬®¤¥«¨°³¾²±¿ ¥¥
½«¥¬¥­²».
¨±. 30.8

¢µ®¤­»¥ §­ ·¥­¨¿ ¨§¢¥±²­» ± ± ¬®£® ­ · « ). ®±«¥ ½²®£® ¬®¦­®
¬®¤¥«¨°®¢ ²¼ ½«¥¬¥­²» £«³¡¨­» 2, § ²¥¬ £«³¡¨­» 3 ¨ ². ¤., ¤®
£«³¡¨­» d.  ¬¥²¨¬, ·²® ¥±«¨ ½«¥¬¥­²» £«³¡¨­» 1; : : : ; i ³¦¥ ±¬®¤¥«¨°®¢ ­», ²® ½«¥¬¥­²» £«³¡¨­» i + 1 ¬®¦­® ¬®¤¥«¨°®¢ ²¼ ®¤­®¢°¥¬¥­­®, ² ª ª ª ®­¨ ­¥ ¨±¯®«¼§³¾² ¢»µ®¤­»¥ §­ ·¥­¨¿ ¤°³£
¤°³£ .
«¥¬¥­²» ¬®¤¥«¨°³¾²±¿ ¢ ¯®°¿¤ª¥ ¢®§° ±² ­¨¿ £«³¡¨­»,   ­ 
®¤­®© £«³¡¨­¥ | ¯® p ¸²³ª §  ° §.   °¨±. 30.8 ¯®ª § ­®, ª ª
¯°®¨±µ®¤¨² ¬®¤¥«¨°®¢ ­¨¥ ¢ ¯°¨¬¥°¥ ± p = 2.
±«¨ ·¨±«® ½«¥¬¥­²®¢ £«³¡¨­» i ° ¢­® ni , ­  ¨µ ¬®¤¥«¨°®¢ ­¨¥
³©¤¥² ­¥ ¡®«¥¥ (ni =p) + 1 ¸ £®¢ (¥¤¨­¨¶  ¯°¨¡ ¢«¿¥²±¿, ¥±«¨ ¯®±«¥¤­¿¿ £°³¯¯  ­¥¯®«­ ¿). ±¥£® ¯®«³· ¥²±¿ ­¥ ¡®«¥¥
d
X
i=1





ni + 1 = n + d
p
p

¸ £®¢. ¥®°¥¬  ¤®ª § ­ .
¥®°¥¬  °¥­²  ±¯° ¢¥¤«¨¢  ¨ ¤«¿ ¬®¤¥«¨°®¢ ­¨¿ ±µ¥¬ ­ 
EREW-¬ ¸¨­¥ (¯°¨ ¤®¯®«­¨²¥«¼­®¬ ³±«®¢¨¨, ·²® ¢»µ®¤­»¥ ±²¥¯¥­¨ ¢±¥µ ½«¥¬¥­²®¢ ² ª¦¥ ®£° ­¨·¥­» ±¢¥°µ³):
«¥¤±²¢¨¥ 30.3. ¾¡ ¿ ±µ¥¬  £«³¡¨­» d ¨ ° §¬¥°  n, ³ ª®²®°®©
½«¥¬¥­²» ¨¬¥¾² ®£° ­¨·¥­­»¥ ±¢¥°µ³ ¢µ®¤­»¥ ¨ ¢»µ®¤­»¥ ±²¥¯¥­¨, ¬®¦¥² ¡»²¼ ±¬®¤¥«¨°®¢ ­  ± ¯®¬®¹¼¾ EREW- «£®°¨²¬ , ¨±¯®«¼§³¾¹¥£® p ¯°®¶¥±±®°®¢, ±® ¢°¥¬¥­¥¬ ° ¡®²» O(n=p + d).
®ª § ²¥«¼±²¢®. ®¤¥«¨°®¢ ­¨¥ ¯°®¨§¢®¤¨²±¿ ² ª ¦¥, ª ª ¨ ¯°¨
¤®ª § ²¥«¼±²¢¥ ²¥®°¥¬» °¥­² . ¤¨­±²¢¥­­ ¿ ° §­¨¶  ±®±²®¨²
¢ ²®¬, ·²® ¢»µ®¤­®¥ §­ ·¥­¨¥ ±«¥¤³¥² ±ª®¯¨°®¢ ²¼ ¢ O(1) ¿·¥¥ª
(¨µ ª®«¨·¥±²¢® ° ¢­® ¬ ª±¨¬ «¼­®© ¢»µ®¤­®© ±²¥¯¥­¨ ½«¥¬¥­² ),
·²®¡» ¯°®¶¥±±®°» ¢¯®±«¥¤±²¢¨¨ ¬®£«¨ ®¤­®¢°¥¬¥­­® ¯°®·¥±²¼ ½²®
§­ ·¥­¨¥, ­¥ ¨±¯®«¼§³¿ ®¤­®¢°¥¬¥­­®¥ ·²¥­¨¥ ¨§ ®¤­®© ¿·¥©ª¨.
±«¨ ¢»µ®¤­»¥ ±²¥¯¥­¨ ­¥ ®£° ­¨·¥­» ±¢¥°µ³, ª®¯¨°®¢ ­¨¥ ­¥
³ª« ¤»¢ ¥²±¿ ¢ O(1) ¸ £®¢, ² ª ·²® ²°¥¡³¥²±¿ ®¤­®¢°¥¬¥­­®¥ ·²¥­¨¥. ±«¨ ¢µ®¤­»¥ ±²¥¯¥­¨ ­¥ ®£° ­¨·¥­» ±¢¥°µ³, ²® ¢ ­¥ª®²®°»µ
±«³· ¿µ (ª®£¤  ´³­ª¶¨®­ «¼­»¥ ½«¥¬¥­²» ¤®±² ²®·­® ¯°®±²») ±µ¥¬³ ¢±¥ ¦¥ ¬®¦­® ±¬®¤¥«¨°®¢ ²¼ ­  CRCW-¬ ¸¨­¥ ±  ­ «®£¨·­®©
®¶¥­ª®© ¢°¥¬¥­¨ ° ¡®²» (³¯°. 30.3-1).
 § ¬¥· ­¨¿µ ª £« ¢¥ 28 ³ª § ­®, ·²® ±³¹¥±²¢³¥² ±®°²¨°³¾¹ ¿
AKS-±¥²¼, ª®²®° ¿ ±®°²¨°³¥² n ·¨±¥« §  ¢°¥¬¿ O(lg n), ¨±¯®«¼§³¿ O(n lg n) ª®¬¯ ° ²®°®¢. ®±ª®«¼ª³ ¢µ®¤­»¥ ±²¥¯¥­¨ ª®¬¯ ° -

650

« ¢  30 «£®°¨²¬» ¯ ° ««¥«¼­»µ ¢»·¨±«¥­¨©

²®°®¢ ®£° ­¨·¥­» ±¢¥°µ³, ¤«¿ n ¯°®¶¥±±®°®¢ ±³¹¥±²¢³¥² EREW «£®°¨²¬ ±®°²¨°®¢ª¨ ±® ¢°¥¬¥­¥¬ ° ¡®²» O((n lg n)=n + lg n) =
O(lg n) (±«¥¤±²¢¨¥ 30.3). ²®² °¥§³«¼² ² ¡»« ¨±¯®«¼§®¢ ­ ¯°¨ ¤®ª § ²¥«¼±²¢¥ ²¥®°¥¬» 30.1.  ±®¦ «¥­¨¾, ¬­®¦¨²¥«¼ ¯°¨ «®£ °¨´¬¥ ±²®«¼ ¢¥«¨ª, ·²® ² ª®©  «£®°¨²¬ ±®°²¨°®¢ª¨ ¯°¥¤±² ¢«¿¥²
«¨¸¼ ²¥®°¥²¨·¥±ª¨© ¨­²¥°¥±. ¤­ ª® ±³¹¥±²¢³¾² ¡®«¥¥ ¯° ª²¨·­»¥ EREW- «£®°¨²¬» ±®°²¨°®¢ª¨, ­ ¯°¨¬¥°, ¯ ° ««¥«¼­»©  «£®°¨²¬ ±®°²¨°®¢ª¨ ±«¨¿­¨¥¬, ¯°¨­ ¤«¥¦ ¹¨© ®³«³ [46].
³±²¼ ²¥¯¥°¼ ¨¬¥¥²±¿  «£®°¨²¬, ¨±¯®«¼§³¾¹¨© p ¯°®¶¥±±®°®¢,  
·¨±«® ¨¬¥¾¹¨µ±¿ ¯°®¶¥±±®°®¢ (p0) ¬¥­¼¸¥ p.  ª ¯®ª §»¢ ¥² ±«¥¤³¾¹ ¿ ²¥®°¥¬ , ¬®¤¥«¨°®¢ ­¨¥ ¢®§¬®¦­® ¡¥§ ³¢¥«¨·¥­¨¿ ®¡¹¨µ
§ ²° ²:
¥®°¥¬  30.4. ³±²¼  «£®°¨²¬ A ¨±¯®«¼§³¥² p ¯°®¶¥±±®°®¢ ¨ ¨¬¥¥² ¢°¥¬¿ ° ¡®²» t. ®£¤  ¤«¿ «¾¡®£® p0 < p ±³¹¥±²¢³¥²  «£®°¨²¬
A0 ¤«¿ ²®© ¦¥ § ¤ ·¨, ¨±¯®«¼§³¾¹¨© p0 ¯°®¶¥±±®°®¢ ¨ ¨¬¥¾¹¨©
¢°¥¬¿ ° ¡®²» O(pt=p0).
®ª § ²¥«¼±²¢®.  ­³¬¥°³¥¬ ¸ £¨  «£®°¨²¬  A ·¨±« ¬¨
1; 2; : : : ; t. «£®°¨²¬ A0 ¡³¤¥² ¬®¤¥«¨°®¢ ²¼ ª ¦¤»© ¸ £ § 
¢°¥¬¿ O(dp=p0e) (½²® ¤¥« ¥²±¿ ª ª ¢ ²¥®°¥¬¥ °¥­² ). ®£¤  ®¡¹¥¥
¢°¥¬¿ ° ¡®²»  «£®°¨²¬  A0 ¡³¤¥² ° ¢­® tO(dp=p0e) = O(tdp=p0 e) =
O(pt=p0), ² ª ª ª p0 < p.
¡¹¨¥ § ²° ²»  «£®°¨²¬  A ° ¢­» pt,   ®¡¹¨¥ § ²° ²»  «£®°¨²¬  A0 ° ¢­» O(pt=p0)p0 = O(pt), ¯®½²®¬³ ¥±«¨  «£®°¨²¬ A ½´´¥ª²¨¢¥­ ¯® § ²° ² ¬, ²® A0 ² ª¦¥ ½´´¥ª²¨¢¥­ ¯® § ²° ² ¬.
¤¥¿ ¤®ª § ²¥«¼±²¢  ¯°®±² : ¯°®¶¥±±®° ¬®¤¥«¨°³¥² ° ¡®²³ ­¥±ª®«¼ª¨µ ¯°®¶¥±±®°®¢ ¢ °¥¦¨¬¥ À° §¤¥«¥­¨¿ ¢°¥¬¥­¨Á.  ¯°®²¨¢,
À° ±¯ ° ««¥«¨¢ ­¨¥Á | ° §¤¥«¥­¨¥ ° ¡®²» ®¤­®£® ¯°®¶¥±±®°  ¬¥¦¤³ ­¥±ª®«¼ª¨¬¨ | ¤¥«® ²°³¤­®¥ ¨ ¤«¿ ª ¦¤®© ª®­ª°¥²­®© § ¤ ·¨
²°¥¡³¥² ±¯¥¶¨ «¼­®£® ° ±±¬®²°¥­¨¿.
«¥¤³¾¹¥¥ ±®®¡° ¦¥­¨¥ ¯®§¢®«¿¥² ¨­®£¤  °¥¸¨²¼ ¢®¯°®± ® ±³¹¥±²¢®¢ ­¨¨ ½´´¥ª²¨¢­®£® ¯® § ²° ² ¬  «£®°¨²¬  ± ¤ ­­»¬ ·¨±«®¬ ¯°®¶¥±±®°®¢. ³±²¼ ¤®ª § ­®, ·²® ¯°¨ «¾¡®¬ ª®«¨·¥±²¢¥ ¯°®¶¥±±®°®¢ ¢°¥¬¿ ° ¡®²»  «£®°¨²¬  ­¥ ¬®¦¥² ¡»²¼ ¬¥­¼¸¥ t,   § ²° ²» ­ ¨«³·¸¥£® ®¤­®¯°®¶¥±±®°­®£®  «£®°¨²¬  ° ¢­» w (±«¥¤®¢ ²¥«¼­®, § ²° ²» «¾¡®£®  «£®°¨²¬  ­¥ ¬¥­¼¸¥ w). ±«¨ ¢ ½²®©
±¨²³ ¶¨¨ ³¤ ±²±¿ ­ ©²¨ ½´´¥ª²¨¢­»© ¯® § ²° ² ¬  «£®°¨²¬, ¨±¯®«¼§³¾¹¨© p = (w=t) ¯°®¶¥±±®°®¢, ²® ²¥¬ ± ¬»¬ ¡³¤³² ­ ©¤¥­» ½´´¥ª²¨¢­»¥  «£®°¨²¬» ¤«¿ «¾¡®£® ª®«¨·¥±²¢  ¯°®¶¥±±®°®¢,
¯°¨ ª®²®°®¬ ®­¨ ±³¹¥±²¢³¾². ¥©±²¢¨²¥«¼­®, ¤«¿ ¬¥­¼¸¥£® ·¨±«  ¯°®¶¥±±®°®¢ ² ª®©  «£®°¨²¬ ¯®«³· ¥²±¿ ¨§ ²¥®°¥¬» °¥­² ,  
½´´¥ª²¨¢­»©  «£®°¨²¬ ¤«¿ ±³¹¥±²¢¥­­® ¡®«¼¸¥£® ·¨±«  ¯°®¶¥±±®°®¢ p0 ­¥ ¬®¦¥² ±³¹¥±²¢®¢ ²¼, ¯®±ª®«¼ª³ ¢°¥¬¿ ° ¡®²» ² ª®£®
 «£®°¨²¬  ­¥ ¬¥­¼¸¥ t,   § ²° ²» ­¥ ¬¥­¼¸¥ p0t = ! (pt) = ! (w).

´´¥ª²¨¢­ ¿ ¯ ° ««¥«¼­ ¿ ®¡° ¡®²ª  ¯°¥´¨ª±®¢

651

30.3.1. ¯° ¦­¥­¨¿
30.3-1. ®ª ¦¨²¥ °¥§³«¼² ²,  ­ «®£¨·­»© ²¥®°¥¬¥ °¥­² , ¤«¿
¬®¤¥«¨°®¢ ­¨¿ ­  CRCW-¬ ¸¨­¥ ±µ¥¬, ±®¤¥°¦ ¹¨µ ½«¥¬¥­²» 
¨  c «¾¡®© ¢µ®¤­®© ±²¥¯¥­¼¾. (ª § ­¨¥: ¢ ª ·¥±²¢¥ ° §¬¥° 
±«¥¤³¥² ° ±±¬®²°¥²¼ ®¡¹¥¥ ª®«¨·¥±²¢® ¢µ®¤®¢ ½«¥¬¥­²®¢).
30.3-2. ®ª ¦¨²¥, ·²® ±³¹¥±²¢³¥² EREW- «£®°¨²¬ ¤«¿ ¯ ° ««¥«¼­®© ®¡° ¡®²ª¨ ¯°¥´¨ª±®¢ ¬ ±±¨¢  ¨§ n ½«¥¬¥­²®¢, ¨±¯®«¼§³¾¹¨© O(n= lg n) ¯°®¶¥±±®°®¢ ¨ ¨¬¥¾¹¨© ¢°¥¬¿ ° ¡®²» O(lg n). ®·¥¬³ ½²®²  «£®°¨²¬ ­¥«¼§¿ ¨±¯®«¼§®¢ ²¼ ¤«¿ ±¯¨±ª®¢?
30.3-3. ®±²°®©²¥ ½´´¥ª²¨¢­»© ¯® § ²° ² ¬  «£®°¨²¬ ¤«¿ ³¬­®¦¥­¨¿ ¬ ²°¨¶» ° §¬¥°  n  n ­  ¢¥ª²®° ° §¬¥°  n ±® ¢°¥¬¥­¥¬
° ¡®²» O(lg n). (ª § ­¨¥: ®±²°®©²¥ ±­ · «  ±µ¥¬³ ¨§ ´³­ª¶¨®­ «¼­»µ ½«¥¬¥­²®¢.)
30.3-4. ®±²°®©²¥ CRCW- «£®°¨²¬ ¤«¿ ³¬­®¦¥­¨¿ ¤¢³µ ¬ ²°¨¶
° §¬¥°  n  n, ¨±¯®«¼§³¾¹¨© n2 ¯°®¶¥±±®°®¢ ¨ ­¥ ¬¥­¥¥ ½´´¥ª²¨¢­»© ¯® § ²° ² ¬, ·¥¬ ±² ­¤ °²­»©  «£®°¨²¬ ±® ¢°¥¬¥­¥¬ ° ¡®²»
(n3 ). ³¤¥² «¨ ®­ EREW- «£®°¨²¬®¬?
30.3-5.  ­¥ª®²®°»µ ¬®¤¥«¿µ ¯ ° ««¥«¼­»µ ¢»·¨±«¥­¨© ¯°®¶¥±±®°» ¬®£³² ®²ª«¾· ²¼±¿ ­  ­¥ª®²®°»µ ¸ £ µ, ² ª ·²® ·¨±«®  ª²¨¢­»µ ¯°®¶¥±±®°®¢ ³¬¥­¼¸ ¥²±¿. °¨ ¯®¤±·¥²¥ § ²° ² ­  ª ¦¤®¬
¸ £¥ ³·¨²»¢ ¾²±¿ ²®«¼ª®  ª²¨¢­»¥ ¯°®¶¥±±®°». ®ª ¦¨²¥, ·²®
CRCW- «£®°¨²¬ ¢ ² ª®© ¬®¤¥«¨ ±® ¢°¥¬¥­¥¬ ° ¡®²» t, § ²° ² ¬¨
w ¨ «¾¡»¬ ­ · «¼­»¬ ·¨±«®¬ ¯°®¶¥±±®°®¢ ¬®¦¥² ¡»²¼ ±¬®¤¥«¨°®¢ ­ ­  EREW-¬ ¸¨­¥ ± p ¯°®¶¥±±®° ¬¨ §  ¢°¥¬¿ O((w=p + t) lg p).
(±­®¢­ ¿ ±«®¦­®±²¼ ±®±²®¨² ¢ ²®¬, ·²® § ° ­¥¥ ­¥¨§¢¥±²­®, ª ª¨¥
¯°®¶¥±±®°» ¡³¤³²  ª²¨¢­».)

30.4. ´´¥ª²¨¢­ ¿ ¯ ° ««¥«¼­ ¿ ®¡° ¡®²ª  ¯°¥´¨ª±®¢
 ° §¤¥«¥ 30.1.2 ¡»« ° ±±¬®²°¥­ EREW- «£®°¨²¬ ¯ ° ««¥«¼­®© ®¡° ¡®²ª¨ ¯°¥´¨ª±®¢ ¤«¿ ±¯¨±ª  ¨§ n ½«¥¬¥­²®¢ §  ¢°¥¬¿
O(lg n). ­ ¨±¯®«¼§³¥² n ¯°®¶¥±±®°®¢, ¯®½²®¬³ § ²° ²» ±®±² ¢«¿¾² (n lg n), ·²® ¡®«¼¸¥, ·¥¬ § ²° ²» (n) ®¤­®¯°®¶¥±±®°­®£®  «£®°¨²¬ . «¥¤®¢ ²¥«¼­®,  «£®°¨²¬ List-Prefix ­¥ ¿¢«¿¥²±¿ ½´´¥ª²¨¢­»¬ ¯® § ²° ² ¬.
 ½²®¬ ° §¤¥«¥ ®¯¨±»¢ ¥²±¿ ¢¥°®¿²­®±²­»© EREW- «£®°¨²¬ ¯ ° ««¥«¼­®© ®¡° ¡®²ª¨ ¯°¥´¨ª±®¢, ª®²®°»© ¨±¯®«¼§³¥² (n= lg n)
¯°®¶¥±±®°®¢ ¨ ¢ ¡®«¼¸¨­±²¢¥ ±«³· ¥¢ (± ¡®«¼¸®© ¢¥°®¿²­®±²¼¾)
° ¡®² ¥² §  ¢°¥¬¿ O(lg n).  ª¨¬ ®¡° §®¬, ½²®² (¢¥°®¿²­®±²­»©)
 «£®°¨²¬ ¬®¦­® ±·¨² ²¼ ½´´¥ª²¨¢­»¬ ¯® § ²° ² ¬. ®­±²°³ª¶¨¿
²¥®°¥¬» 30.4 ¯®§¢®«¿¥² ³ª § ²¼ ² ª®©  «£®°¨²¬ ¤«¿ «¾¡®£® ·¨±« 
¯°®¶¥±±®°®¢ p = O(n= lg n).

652

« ¢  30 «£®°¨²¬» ¯ ° ««¥«¼­»µ ¢»·¨±«¥­¨©

splice out = ³¤ «¥­¨¥
splice in = ¢®§¢° ¹¥­¨¥ ³¤ «¥­­»µ
°¥ª³°±¨¢­»© ¢»§®¢ ¯°®¶¥¤³°» Randomized-List-Prefix
30.9. ¥ª³°±¨¢­»© ¢¥°®¿²­®±²­»©  «£®°¨²¬ ®¡° ¡®²ª¨ ¯°¥´¨ª±®¢
±¯¨±ª  ­  ¯°¨¬¥°¥ ±¯¨±ª  ¨§ 9 ®¡º¥ª²®¢. (a) ¥°­»¥ ®¡º¥ª²» ­ ¬¥·¥­» ¤«¿
³¤ «¥­¨¿. (°¥¤¨ ­¨µ ­¥² ±®±¥¤­¨µ.) (b) ­ ·¥­¨¥ ª ¦¤®£® ³¤ «¿¥¬®£® ®¡º¥ª²  ±®¥¤¨­¿¥²±¿ ±® §­ ·¥­¨¥¬ ±«¥¤³¾¹¥£®;  «£®°¨²¬ °¥ª³°±¨¢­® ¢»§»¢ ¥²±¿ ­ 
³¬¥­¼¸¥­­®¬ ±¯¨±ª¥. (c)-(d)  °¥§³«¼² ²¥ ³¶¥«¥¢¸¨¥ ½«¥¬¥­²» ¯®«³· ¾² ¯° ¢¨«¼­»¥ §­ ·¥­¨¿,   ³¤ «¥­­»¥ ®¡º¥ª²» ¢»·¨±«¿¾² ±¢®¨ ¯°¥´¨ª±» ± ¯®¬®¹¼¾
¯°¥¤»¤³¹¨µ.
¨±. 30.9

splice out ³¤ «¥­¨¥ splice in ¢®§¢° ¹¥­¨¥ stage 1 ³°®¢¥­¼ 1 (bottom)
(¢­³²°¥­­¨©) (top) (¢­¥¸­¨©)
30.10. °®¢­¨ °¥ª³°±¨¨ ¤«¿  «£®°¨²¬  Randomized-List-Prefix.
­ · «¥ ±¯¨±®ª ±®¤¥°¦¨² 9 ®¡º¥ª²®¢. ¥ª³°±¨¢­»¥ ¢»§®¢» ®±³¹¥±²¢«¿¾²±¿
¤® ²¥µ ¯®°, ¯®ª  ±¯¨±®ª ­¥ ±² ­¥² ¯³±²»¬.
¨±. 30.10

30.4.1. ¥ª³°±¨¢­ ¿ ¯ ° ««¥«¼­ ¿ ®¡° ¡®²ª  ¯°¥´¨ª±®¢
«£®°¨²¬ Randomized-List-Prefix ¨±¯®«¼§³¥² ¤«¿ n½«¥¬¥­²­®£® ±¯¨±ª  p = (n= lg n) ¯°®¶¥±±®°®¢, ² ª ·²® ª ¦¤»©
¯°®¶¥±±®° ®²¢¥· ¥² §  n=p = (lg n) ½«¥¬¥­²®¢.  ±¯°¥¤¥«¥­¨¥
®¡º¥ª²®¢ ¯® ¯°®¶¥±±®° ¬ ¯°®¨±µ®¤¨² ¯°®¨§¢®«¼­»¬ ®¡° §®¬
(­¥ ®¡¿§ ²¥«¼­® ¯®¤°¿¤) ¢ ­ · «¥ ° ¡®²»  «£®°¨²¬  ¨ ¡®«¥¥
­¥ ¬¥­¿¥²±¿. «¿ ³¤®¡±²¢  ¡³¤¥¬ ±·¨² ²¼, ·²® ±¯¨±®ª ¿¢«¿¥²±¿
¤¢³­ ¯° ¢«¥­­»¬, ¯®±ª®«¼ª³ ² ª®© ±¯¨±®ª ¬®¦­® ¨§£®²®¢¨²¼ ¨§
®¤­®­ ¯° ¢«¥­­®£® §  ¢°¥¬¿ O(1).
¤¥¿  «£®°¨²¬  ±®±²®¨² ¢ ²®¬, ·²®¡» ¨±ª«¾·¨²¼ ¨§ ±¯¨±ª  ­¥ª®²®°»¥ ®¡º¥ª²» (¯°¨±®¥¤¨­¨¢ ¨µ ª ±«¥¤³¾¹¨¬ §  ­¨¬¨), ¯°®¨§¢¥±²¨ ®¡° ¡®²ª³ ¯°¥´¨ª±®¢ ¤«¿ ¯®«³·¨¢¸¥£®±¿ ±¯¨±ª ,   § ²¥¬
®¡° ¡®² ²¼ ¯°®¯³¹¥­­»¥ ¯°¥´¨ª±», ³·²¿ ¨±ª«¾·¥­­»¥ ½«¥¬¥­²».
¤¨­ ³°®¢¥­¼ °¥ª³°±¨¨ ¯®ª § ­ ­  °¨±. 30.9,   ¢¥±¼ ¯°®¶¥±± | ­ 
°¨±. 30.10.
°¨ ¢»¡®°¥ ¨±ª«¾· ¥¬»µ ½«¥¬¥­²®¢ ¬» ¡³¤¥¬ ±®¡«¾¤ ²¼ ² ª¨¥
¯° ¢¨« ::
1. ¥«¼§¿ ®¤­®¢°¥¬¥­­® ¨±ª«¾· ²¼ ¤¢  ½«¥¬¥­² , §  ª®²®°»¥ ®²¢¥· ¥² ®¤¨­ ¨ ²®² ¦¥ ¯°®¶¥±±®°.
2. ¥«¼§¿ ¨±ª«¾· ²¼ ¤¢  ±®±¥¤­¨µ ¢ ±¯¨±ª¥ ®¡º¥ª² .
¥°¥¤ ²¥¬ ª ª ®¯¨±»¢ ²¼ ¬¥µ ­¨§¬ ¢»¡®°  ¨±ª«¾· ¥¬»µ ½«¥¬¥­²®¢, ° ±±¬®²°¨¬ ¯®¤°®¡­¥¥ ± ¬ ¯°®¶¥±± ¨±ª«¾·¥­¨¿. ³±²¼ °¥¸¥­®
¨±ª«¾·¨²¼ k-© ®¡º¥ª². ®£¤  (k +1)-© ®¡º¥ª² § ¯®¬¨­ ¥² §­ ·¥­¨¥
[k; k + 1] = [k; k] 
 [k + 1; k + 1] (¯®±«¥ ·¥£® k-© ®¡º¥ª² ³¤ «¿¥²±¿).
±«¨ k-© ®¡º¥ª² ¿¢«¿¥²±¿ ¯®±«¥¤­¨¬, ²® ®­ ¯°®±²® ³¤ «¿¥²±¿ ¨§
±¯¨±ª .
®±«¥ ³¤ «¥­¨¿ ¯°®¶¥¤³°  Randomized-List-Prefix ¢»§»¢ ¥²
± ¬³ ±¥¡¿ ­  ³¬¥­¼¸¥­­®¬ ±¯¨±ª¥, ¥±«¨ ®­ ¥¹¥ ­¥ ¯³±². ®±«¥ ½²®£®

´´¥ª²¨¢­ ¿ ¯ ° ««¥«¼­ ¿ ®¡° ¡®²ª  ¯°¥´¨ª±®¢

653

°¥ª³°±¨¢­®£® ¢»§®¢  ¢±¥ ½«¥¬¥­²» ³¬¥­¼¸¥­­®£® ±¯¨±ª  ±®¤¥°¦ ²
¯° ¢¨«¼­»¥ §­ ·¥­¨¿ ¯°¥´¨ª±®¢, ¨ ®±² ¥²±¿ «¨¸¼ ®¡° ¡®² ²¼ ¯°¥´¨ª±», ±®®²¢¥²±²¢³¾¹¨¥ ¨±ª«¾·¥­­»¬ ½«¥¬¥­² ¬.
²® ±¤¥« ²¼ «¥£ª®: ¥±«¨ k-© ®¡º¥ª² ¡»« ¨±ª«¾·¥­, ²® (k ; 1)© ®¡º¥ª² ®±² «±¿ ¢ ±¯¨±ª¥ ¨ ¯®±«¥ °¥ª³°±¨¢­®£® ¢»§®¢  ±®¤¥°¦¨²
§­ ·¥­¨¥ [1; k ; 1]. ±² ¥²±¿ «¨¸¼ ¢»·¨±«¨²¼ [1; k] = [1; k ; 1] 
 [k; k].
±«®¢¨¥ 1 £ ° ­²¨°³¥², ·²® ¤«¿ ª ¦¤®£® ¨±ª«¾·¥­­®£® ®¡º¥ª² 
­ ©¤¥²±¿ ¯°®¶¥±±®°, ª®²®°»© ¡³¤¥² ¯°®¨§¢®¤¨²¼ ¢»·¨±«¥­¨¿. ±«®¢¨¥ 2 ®¡¥±¯¥·¨¢ ¥² ¢®§¬®¦­®±²¼ ®¡° ¡®² ²¼ ­¥¤®±² ¾¹¨© ¯°¥´¨ª±, ¯°®¨§¢¥¤¿ ¢±¥£® ®¤­³ ®¯¥° ¶¨¾ 
 (±¬. ³¯°. 30-4.1). ² ª,
¯°¨ ¢»¯®«­¥­¨¨ ²°¥¡®¢ ­¨© 1 ¨ 2 ª ¦¤»© ¸ £  «£®°¨²¬  ²°¥¡³¥²
¢°¥¬¥­¨ O(1).
30.4.2. »¡®° ³¤ «¿¥¬»µ ®¡º¥ª²®¢
 ª ¦¥ ¢»¡¨° ²¼ ®¡º¥ª²» ¤«¿ ³¤ «¥­¨¿? °¥¦¤¥ ¢±¥£®, ­¥®¡µ®¤¨¬® ±®¡«¾¤ ²¼ ²°¥¡®¢ ­¨¿ 1 ¨ 2. °®¬¥ ²®£®, ± ¬ ¯°®¶¥±± ¢»¡®° 
¤®«¦¥­ § ­¨¬ ²¼ ­¥¬­®£® ¢°¥¬¥­¨ («³·¸¥ ¢±¥£® O(1)).  ª®­¥¶,
±«¥¤³¥² ³¤ «¿²¼ ª ª ¬®¦­® ¡®«¼¸¥ ®¡º¥ª²®¢, ·²®¡» ®±² ¾¹¨©±¿
±¯¨±®ª ¡»« ª ª ¬®¦­® ª®°®·¥ ¨ £«³¡¨­  °¥ª³°±¨¨ | ª ª ¬®¦­®
¬¥­¼¸¥.
ª ¦¥¬ ±¯®±®¡ ³¤®¢«¥²¢®°¨²¼ ¢±¥¬ ½²¨¬ ²°¥¡®¢ ­¨¿¬.
1.  ¦¤»© ¯°®¶¥±±®° ±«³· ©­® ¢»¡¨° ¥² ®¤¨­ ¨§ ¯®¤¢¥¤®¬±²¢¥­­»µ ¥¬³ ®¡º¥ª²®¢ (¨§ ·¨±«  ®±² ¢¸¨µ±¿ ¢ ±¯¨±ª¥).
2.  ¦¤»© ¯°®¶¥±±®° ¡°®± ¥² ¬®­¥²³ ¨ ± ¢¥°®¿²­®±²¼¾ 1=2 ¯®¬¥· ¥² ¢»¡° ­­»© ¨¬ ­  ¯°¥¤»¤³¹¥¬ ¸ £¥ ®¡º¥ª² (  ± ¢¥°®¿²­®±²¼¾ 1=2 ­¥ ¤¥« ¥² ­¨·¥£®).
3.  ³¤ «¥­¨¾ ­ §­ · ¾²±¿ ¯®¬¥·¥­­»¥ ®¡º¥ª²», ³ ª®²®°»µ ±«¥¤³¾¹¨© ®¡º¥ª² ­¥ ¯®¬¥·¥­: ®¡º¥ª² i ³¤ «¿¥²±¿, ¥±«¨ ®­ ¯®¬¥·¥­,   next[i] ­¥ ¯®¬¥·¥­ (­¨ª ª¨¬ ¤°³£¨¬ ¯°®¶¥±±®°®¬).
¯¨± ­­»¥ ¤¥©±²¢¨¿ ¢»¯®«­¿¾²±¿ §  ¢°¥¬¿ O(1) ¨ ­¥ ¨±¯®«¼§³¾²
®¤­®¢°¥¬¥­­»© ¤®±²³¯ ª ¯ ¬¿²¨.
·¥¢¨¤­®, ·²® ²°¥¡®¢ ­¨¥ 1 ¢»¯®«­¥­® (ª ¦¤»© ¯°®¶¥±±®° ¢»¡¨° ¥² ­¥ ¡®«¥¥ ®¤­®£® ½«¥¬¥­² ). °¥¡®¢ ­¨¥ 2 ² ª¦¥ ¢»¯®«­¥­®,
² ª ª ª ®¡º¥ª²» i ¨ next[i] ­¥ ¬®£³² ¡»²¼ ¢»¡° ­» ®¤­®¢°¥¬¥­­® | ¥±«¨ next[i] ¢»¡° ­, ²® ®­ ¤®«¦¥­ ¡»²¼ ¯®¬¥·¥­ |   ²®£¤ 
®¡º¥ª² i ­¥ ¢»¡¨° ¥²±¿.
30.4.3. ­ «¨§
®±ª®«¼ª³ ¸ £ °¥ª³°±¨¨ § ­¨¬ ¥² ¢°¥¬¿ O(1), ­¥®¡µ®¤¨¬® ®¶¥­¨²¼ «¨¸¼ ª®«¨·¥±²¢® ¸ £®¢, ¯®±«¥ ª®²®°®£® ±¯¨±®ª ±² ­¥² ¯³±²»¬. ³±²¼ ­  ½² ¯¥ 1 ®¯¨± ­­®£® ¯°®¶¥±±  ª ª®©-²® ¯°®¶¥±±®°
¢»¡° « ®¡º¥ª² i.  ª®¢  ¢¥°®¿²­®±²¼ ²®£®, ·²® ®¡º¥ª² i ¯®¯ ¤¥² ¢

654

« ¢  30 «£®°¨²¬» ¯ ° ««¥«¼­»µ ¢»·¨±«¥­¨©

·¨±«® ³¤ «¿¥¬»µ? «¿ ½²®£® ­³¦­®, ·²®¡» ­  ½² ¯¥ 2 ®­ ¡»« ¯®¬¥·¥­ (¢¥°®¿²­®±²¼ 1=2) ¨ ·²®¡» ·²®¡» ®¡º¥ª² next[i] ­¥ ¡»« ¯®¬¥·¥­
(½²® ­¥§ ¢¨±¨¬®¥ ±®¡»²¨¥, ¨¬¥¾¹¥¥ ¢¥°®¿²­®±²¼ ­¥ ¬¥­¼¸¥ 1=2 |
«¨¸¼ ®¤¨­ ¯°®¶¥±±®° ¬®¦¥² ¯®¬¥²¨²¼ next[i], ¨ ± ¢¥°®¿²­®±²¼¾ 1=2
®­ ¡¥§¤¥©±²¢³¥²).  ª¨¬ ®¡° §®¬, ¢¥°®¿²­®±²¼ ³¤ «¥­¨¿ ®¡º¥ª²  i
­¥¥ ¬¥­¼¸¥ 1=4.
 ª¨¬ ®¡° §®¬, ±¨²³ ¶¨¾ ¬®¦­® ®¯¨± ²¼ ² ª. ¬¥¥²±¿ n= lg n
£°³¯¯ ¯® lg n ½«¥¬¥­²®¢ ¢ ª ¦¤®© (¤«¿ ¯°®±²®²» ¬» ¡³¤¥¬ ±·¨² ²¼,
·²® ½«¥¬¥­²» ¤¥«¿²±¿ ­  £°³¯¯» ¡¥§ ®±² ²ª ).   ª ¦¤®¬ ¸ £¥ ·¨±«® ½«¥¬¥­²®¢ ¢ £°³¯¯¥ ¬®¦¥² ³¬¥­¼¸¨²±¿ ­  1 ¨«¨ ®±² ²¼±¿ ¯°¥¦­¨¬, ¯°¨ ½²®¬ ¢¥°®¿²­®±²¼ ³¬¥­¼¸¥­¨¿ ­¥ ¬¥­¥¥ 1=4. ¬¥­¼¸¥­¨¿
¢ ° §­»µ £°³¯¯ µ ­  ®¤­®¬ ¸ £¥ ¬®£³² ­¥ ¡»²¼ ­¥§ ¢¨±¨¬»¬¨, ­®
³¬¥­¼¸¥­¨¿ ­  ° §­»µ ¸ £ µ ¢ ®¤­®© £°³¯¯¥ ­¥§ ¢¨±¨¬».
 ¬ ­ ¤® ¤®ª § ²¼, ·²® ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ¢°¥¬¥­¨ ¯®«­®£® ¨±·¥§­®¢¥­¨¿ ¢±¥µ £°³¯¯ ¥±²¼ O(lg n). ­ «¨§  ¤«¿ ®¤­®© £°³¯¯» ²³² ­¥¤®±² ²®·­®, ¯®±ª®«¼ª³ ¤ ¦¥ ®¤¨­ ¤®«£® ° ¡®² ¾¹¨© ¯°®¶¥±±®° ³¦¥ ³¢¥«¨·¨¢ ¥² ®¡¹¥¥ ¢°¥¬¿ ° ¡®²».
» ¯®ª ¦¥¬, ·²® ± ¢¥°®¿²­®±²¼¾ ­¥ ¬¥­¥¥ 1 ; 1=n ±¯¨±®ª ±² ­¥²
¯³±²»¬ ·¥°¥§ ¢°¥¬¿ c lg n ¤«¿ ­¥ª®²®°®© ª®­±² ­²» c. ®«­®¥ ¤®ª § ²¥«¼±²¢® ®¶¥­ª¨ (lg n) ¤«¿ ¬ ²¥¬ ²¨·¥±ª®£® ®¦¨¤ ­¨¿ ¢°¥¬¥­¨
° ¡®²» ®±² ¢«¿¥²±¿ ·¨² ²¥«¾ (³¯°. 30.4-4 ¨ 30.4-5).
®±ª®«¼ª³ ­ ± ¨­²¥°¥±³¥² ¢¥°µ­¿¿ ®¶¥­ª  ¢°¥¬¥­¨, ª®£¤  ±¯¨±®ª
±² ­¥² ¯³±²»¬, ¡³¤¥¬ ±·¨² ²¼, ·²® ¢¥°®¿²­®±²¼ ³¬¥­¼¸¥­¨¿ ¤ ­­®© £°³¯¯» ­  ª ¦¤®¬ ¸ £¥ ¢ ²®·­®±²¨ ° ¢­  1=4 (µ®²¿ ­  ± ¬®¬
¤¥«¥ ®­  ¬®¦¥² ¡»²¼ ¡®«¼¸¥); ´®°¬ «¼­®¥ ®¡®±­®¢ ­¨¥ § ª®­­®±²¨
² ª®£® ¤®¯³¹¥­¨¿ ¤ ¥²±¿ ¢ ³¯°. 6.4-8 ¨ 6.4-9.
 ±±¬®²°¨¬ ±¨²³ ¶¨¾ ¤«¿ ®¤­®© ´¨ª±¨°®¢ ­­®© £°³¯¯». §¿¢
ª ª®¥-²® §­ ·¥­¨¥ c, ¯®±¬®²°¨¬ ­  ¢¥°®¿²­®±²¼ ²®£®, ·²® ±°¥¤¨
c lg n ­¥§ ¢¨±¨¬»µ ¨±¯»² ­¨© ± ¢¥°®¿²­®±²¼¾ ³±¯¥µ  1=4 ¢ ª ¦¤®¬
¡³¤¥² ¬¥­¼¸¥ lg n ³±¯¥µ®¢. (²® ¨ ¡³¤¥² ¢¥°®¿²­®±²¼¾ ²®£®, ·²®
£°³¯¯  ®±² ­¥²±¿ ­¥¯³±²®© ¯®±«¥ c lg n ¨±¯»² ­¨©.) ¡®§­ ·¨¢ ·¨±«® ³±¯¥µ®¢ ·¥°¥§ X , ®¶¥­¨¬ ¢¥°®¿²­®±²¼ ±®¡»²¨¿ fX < lg ng ±
¯®¬®¹¼¾ ±«¥¤±²¢¨¿ 6.3:


lg n

lg n
6 (1=4)
PfX < lg ng 6 Cclglgnn (3=4)c lg n;lg n 6 eclglgnn (3=4)(c;1) lg n = ec(3=4)c;1
(¯®±«¥¤­¥¥ ­¥° ¢¥­±²¢® ¢¥°­® ¯°¨ c > 20; ¢²®°®¥ ­¥° ¢¥­±²¢® ±«¥¤³¥² ¨§ (6.9)).  ª¨¬ ®¡° §®¬, ¢¥°®¿²­®±²¼ ²®£®, ·²® ·¥°¥§ c lg n
¸ £®¢ ­¥ ¢±¥ ®¡º¥ª²» ¤ ­­®£® ¯°®¶¥±±®°  ¨±ª«¾·¥­», ­¥ ¯°¥¢»¸ ¥² 1=n2 .
±¥£® ¨¬¥¥²±¿ n= lg n ¯°®¶¥±±®°®¢, ¯®½²®¬³ ¢¥°®¿²­®±²¼ À­¥³¤ ·¨Á (®±² ¾²±¿ ­¥³¤ «¥­­»¥) ®¤­®£® ¯°®¶¥±±®°  ­ ¤® ¥¹¥ ³¬­®¦¨²¼
­  n= lg n, (­¥° ¢¥­±²¢® ³«¿, 6.22) ¯®«³· ¥²±¿ ­¥ ¡®«¼¸¥
n  1 61
lg n n2 n


 °³¸¥­¨¥ ±¨¬¬¥²°¨¨ (¤¥²¥°¬¨­¨°®¢ ­­»©  «£®°¨²¬)

655

®½²®¬³ ± ¢¥°®¿²­®±²¼¾ ­¥ ¬¥­¥¥ 1 ; 1=n  «£®°¨²¬ § ª®­·¨² ° ¡®²³ §  ¢°¥¬¿ O(lg n).
®­±² ­²  20 ­¥ ®²° ¦ ¥² °¥ «¼­®£® ¡»±²°®¤¥©±²¢¨¿  «£®°¨²¬ 
| ­  ± ¬®¬ ¤¥«¥ ­ ¸  ®¶¥­ª¨ ¤®¢®«¼­® £°³¡»¥, ¨ ±°¥¤­¥¥ ¢°¥¬¿
§­ ·¨²¥«¼­® ¬¥­¼¸¥.
30.4.4. ¯° ¦­¥­¨¿
30.4-1.  °¨±³©²¥ ¯°¨¬¥°, ¯®ª §»¢ ¾¹¨©, ¯®·¥¬³ ­¥«¼§¿ ¨±ª«¾· ²¼ ¨§ ±¯¨±ª  ¤¢  ±®±¥¤­¨µ ®¡º¥ª² .
30.4-2. ¥°®¿²­®±²­»©  «£®°¨²¬ ¬®¦­® ±«¥£ª  ¨§¬¥­¨²¼ ² ª,
·²®¡» ¢°¥¬¿ ° ¡®²» ¢ µ³¤¸¥¬ ±«³· ¥ ±®±² ¢«¿«® O(n).  ª? ®ª ¦¨²¥, ·²® ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ¢°¥¬¥­¨ ° ¡®²» ¬®¤¨´¨¶¨°®¢ ­­®£®  «£®°¨²¬  ° ¢­® O(lg n).
30.4-3. §¬¥­¨²¥ ¢¥°®¿²­®±²­»©  «£®°¨²¬ ² ª, ·²®¡» ®­ ¨±¯®«¼§®¢ « O(n=p) ¯ ¬¿²¨ (¢ ° ±·¥²¥ ­  ®¤¨­ ¯°®¶¥±±®°) ­¥§ ¢¨±¨¬® ®² £«³¡¨­» °¥ª³°±¨¨.
30.4-4. ®ª ¦¨²¥, ·²® ¤«¿ «¾¡®£® k > 1 ­ ©¤¥²±¿ ² ª ¿ ª®­±² ­²  c, ·²® ¢°¥¬¿ ° ¡®²»  «£®°¨²¬  ¬¥­¼¸¥ c lg n ± ¢¥°®¿²­®±²¼¾
1 ; 1=nk ¨«¨ ¡®«¼¸¥.  ª § ¢¨±¨² ª®­±² ­²  c ®² k?
30.4-5. ®ª ¦¨²¥, ¨±¯®«¼§³¿ ¯°¥¤»¤³¹¥¥ ³¯° ¦­¥­¨¥, ·²® ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ¢°¥¬¥­¨ ° ¡®²» ¢¥°®¿²­®±²­®£®  «£®°¨²¬ 
¥±²¼ O(lg n).

30.5.  °³¸¥­¨¥ ±¨¬¬¥²°¨¨ (¤¥²¥°¬¨­¨°®¢ ­­»©  «£®°¨²¬)
 ±±¬®²°¨¬ ±¨²³ ¶¨¾, ª®£¤  ¤¢  ¯°®¶¥±±®°  ®¤­®¢°¥¬¥­­® µ®²¿² ¯®«³·¨²¼ ¤®±²³¯ ª ®¡º¥ª²³. °¨ ®²±³²±²¢¨¨ ¬¥µ ­¨§¬  ®¤­®¢°¥¬¥­­®£® ¤®±²³¯  ª ¯ ¬¿²¨ ®¤¨­ ¨§ ¯°®¶¥±±®°®¢ ¤®«¦¥­ ¯®«³·¨²¼ ¤®±²³¯ ¯¥°¢»¬ | ­® ª ª®©?  ¤ ·  ¢»¡®°  °®¢­® ®¤­®£® ¨§
¤¢³µ ¯°®¶¥±±®°®¢ ¿¢«¿¥²±¿ · ±²­»¬ ±«³· ¥¬ § ¤ ·¨ ® ­ °³¸¥­¨¨
±¨¬¬¥²°¨¨ (symmetry breaking). ¬¥­­® ± ² ª®© § ¤ ·¥© ±²®«ª­³«¨±¼ ¨·¨ª®¢ ¨  ­¨«®¢, ³±²³¯ ¿ ¤°³£ ¤°³£³ ¤®°®£³. ®¤®¡­»¥
§ ¤ ·¨ ¯®±²®¿­­® ¢®§­¨ª ¾² ¯°¨ °¥ «¨§ ¶¨¨ ¯ ° ««¥«¼­»µ  «£®°¨²¬®¢.
«¿ °¥¸¥­¨¿ ² ª®© § ¤ ·¨ ¬®¦­® ¯°®±²® ¡°®± ²¼ ¬®­¥²ª³ (¨±¯®«¼§®¢ ²¼ ±«³· ©­»¥ ·¨±« ).  ¯°¨¬¥°, ¢ ±«³· ¥ ¤¢³µ ¯°®¶¥±±®°®¢ ª ¦¤»© ¨§ ­¨µ ¡°®± ¥² ¬®­¥²ª³, ¨ ¤®±²³¯ ¯®«³· ¥² ²®², ³ ª®£®
®°¥« (¥±«¨ ¤¢  ®°«  ¨«¨ ¤¢¥ °¥¸ª¨ | ¡°®± ¾² ¥¹¥ ° §). °¨ ½²®¬
±¨¬¬¥²°¨¿ ¡³¤¥² ­ °³¸¥­  §  ¢°¥¬¿ O(1) (¨¬¥¥²±¿ ¢ ¢¨¤³ ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥, ±¬. ³¯°. 30.5-1).
±¯®«¼§®¢ ­¨¥ ±«³· ©­®±²¨ · ±²® ®ª §»¢ ¥²±¿ ¯®«¥§­»¬ | ¬»
¢¨¤¥«¨, ·²® ¢¥°®¿²­®±²­®¬  «£®°¨²¬¥ ®¡° ¡®²ª¨ ¯°¥´¨ª±®¢ (° §¤¥« 30.4) ¨±¯®«¼§®¢ ­¨¥ ±«³· ©­®±²¨ ¯®§¢®«¿¥² ¢»¡° ²¼ ¤®±² ²®·-

656

« ¢  30 «£®°¨²¬» ¯ ° ««¥«¼­»µ ¢»·¨±«¥­¨©

­® ¬­®£® ®¡º¥ª²®¢, £ ° ­²¨°®¢ ²¼, ·²® ±®±¥¤­¨¥ ­¥ ¢»¡° ­» ¨ ¯°¨
½²®¬ ¯° ¢¨«® ¢»¡®°  «®ª «¼­® (§ ¢¨±¨² ²®«¼ª® ®² ±¨²³ ¶¨¨ ³ ¤¢³µ
±®±¥¤­¨µ ®¡º¥ª²®¢).
 ½²®¬ ° §¤¥«¥ ° ±±¬ ²°¨¢ ¥²±¿ ¤¥²¥°¬¨­¨°®¢ ­­»© ¬¥²®¤ ­ °³¸¥­¨¿ ±¨¬¬¥²°¨¨. ­ ®±­®¢ ­ ­¥ ­  ¡°®± ­¨¨ ¬®­¥²»,   ­  ¨±¯®«¼§®¢ ­¨¨ ­®¬¥°®¢ ¯°®¶¥±±®°®¢ (¨«¨  ¤°¥±®¢ ¢ ¯ ¬¿²¨).  ¯°¨¬¥°, ¢ ±«³· ¥ ¤¢³µ ¯°®¶¥±±®°®¢ ¬®¦­® ¯°¥¤®±² ¢¨²¼ ¤®±²³¯ ¯°®¶¥±±®°³ ± ¬¥­¼¸¨¬ ­®¬¥°®¬. °¨ ½²®¬ § ¤ ·  °¥¸ ¥²±¿ §  ¯®±²®¿­­®¥ ¢°¥¬¿.
» ¨±¯®«¼§³¥¬ ²³ ¦¥ ¨¤¥¾ ¤«¿ °¥¸¥­¨¿ ¡®«¥¥ ±«®¦­®© § ¤ ·¨:
ª ª ¢»¤¥«¨²¼ (¤®±² ²®·­® ¡®«¼¸³¾) · ±²¼ ®¡º¥ª²®¢ ±¯¨±ª , ¥±«¨
­¥«¼§¿ ¢»¤¥«¿²¼ ¤¢  ±®±¥¤­¨µ ®¡º¥ª² . «¿ ½²®© § ¤ ·¨ ¡³¤¥² ¯®±²°®¥­ ¯ ° ««¥«¼­»©  «£®°¨²¬ (¢ EREW-¬®¤¥«¨), ¢°¥¬¿ ° ¡®²»
ª®²®°®£® ±®±² ¢«¿¥² O(lg n), ¥±«¨ ­®¬¥°  ¯°®¶¥±±®°®¢ ¡¥°³²±¿ ¨§
¯°®¬¥¦³²ª  1::n. ®±ª®«¼ª³ lg n 6 5 ¯°¨ n 6 265536, ­  ¯° ª²¨ª¥
¢°¥¬¿ ° ¡®²» ½²®£®  «£®°¨²¬  ¬®¦­® ±·¨² ²¼ ¯®±²®¿­­»¬ (±¬.
±²°. 00).
«£®°¨²¬ ±®±²®¨² ¨§ ¤¢³µ · ±²¥©. ­ · «  §  ¢°¥¬¿ O(lg n) ¬»
­ µ®¤¨¬ À6-° ±ª° ±ª³Á ±¯¨±ª .  ²¥¬ (§  ¢°¥¬¿ O(1)) ¬» ¯®«³· ¥¬
¨§ ­¥¥ À¬ ª±¨¬ «¼­®¥ ­¥§ ¢¨±¨¬®¥ ¯®¤¬­®¦¥±²¢®Á±¯¨±ª ; ®­® ±®¤¥°¦¨² ­¥ ¬¥­¥¥ ²°¥²¨ ®¡º¥ª²®¢ ±¯¨±ª  ¨ ­¥ ±®¤¥°¦¨² ±®±¥¤­¨µ
®¡º¥ª²®¢.
30.5.1.  ±ª° ±ª¨ ¨ ¬ ª±¨¬ «¼­»¥ ­¥§ ¢¨±¨¬»¥ ¬­®¦¥±²¢ 
 ±ª° ±ª®© (coloring) ­¥®°¨¥­²¨°®¢ ­­®£® £° ´  G = (V; E ) ­ §»¢ ¥²±¿ ®²®¡° ¦¥­¨¥ C : V ! N, ¤«¿ ª®²®°®£® C (u) 6= C (v ) ¯°¨
(u; v ) 2 E . ±«¨ ­ §»¢ ²¼ C (v ) ¶¢¥²®¬ ¢¥°¸¨­» v , ²® ¬®¦­® ±ª § ²¼, ·²® ª®­¶» «¾¡®£® °¥¡°  ¤®«¦­» ¨¬¥²¼ ° §­»¥ ¶¢¥² . »
¨¹¥¬ 6-° ±ª° ±ª³ ±¯¨±ª , ²® ¥±²¼ µ®²¨¬ ¯®±² ¢¨²¼ ¢ ±®®²¢¥²±²¢¨¥
ª ¦¤®© ¢¥°¸¨­¥ ­¥ª®²®°»© ¶¢¥² ¨§ ¬­®¦¥±²¢  f0; 1; 2; 3; 4; 5g,
¯°¨·¥¬ ² ª, ·²® ±®±¥¤­¨¥ ¢ ±¯¨±ª¥ ¢¥°¸¨­» ¨¬¥¾² ° §­»¥ ¶¢¥² .
 ª ¿ ° ±ª° ±ª  ±³¹¥±²¢³¥²; ¡®«¥¥ ²®£®, ¿±­®, ·²® ¤®±² ²®·­®
¤¢³µ ¶¢¥²®¢.  ± ¬®¬ ¤¥«¥, ¬®¦­® ¯®ª° ±¨²¼ ¢±¥ ·¥²­»¥ ¢¥°¸¨­»
¢ ®¤¨­ ¶¢¥²,   ¢±¥ ­¥·¥²­»¥ | ¢ ¤°³£®©. ® ­ µ®¤¿±¼ ¢ ±¥°¥¤¨­¥
±¯¨±ª , ­¥ ² ª ¯°®±²® ¯®­¿²¼, ·¥²­ ¿ ¢¥°¸¨­  ¨«¨ ­¥·¥²­ ¿ | ¤«¿
½²®£® ­³¦­® ®²±·¨² ²¼ ¥¥ ­®¬¥° ®² ­ · «  ±¯¨±ª , ·²® ¬®¦­® ±¤¥« ²¼ §  ¢°¥¬¿ O(lg n) (° §¤¥« 30.1).  §°¥¸¨¢ ¡®«¼¸¥ ¶¢¥²®¢ (ª ª
¬» ³¢¨¤¨¬, ¤®±² ²®·­® 6), ° ±ª° ±ª³ ¬®¦­® ¯®±²°®¨²¼ ¡»±²°¥¥
| §  ¢°¥¬¿ O(lg n), ¯°¨ ½²®¬  «£®°¨²¬ ®±² ¥²±¿ ¤¥²¥°¬¨­¨°®¢ ­­»¬.
­®¦¥±²¢® V 0  V ¢¥°¸¨­ £° ´  G = (V; E ) ­ §®¢¥¬ ­¥§ ¢¨±¨¬»¬ ¬­®¦¥±²¢®¬ (independent set), ¥±«¨ ­¨ª ª¨¥ ¤¢¥ ¢¥°¸¨­» ¨§
V 0 ­¥ ±®¥¤¨­¥­» °¥¡°®¬. ¥§ ¢¨±¨¬®¥ ¬­®¦¥±²¢® V 0 ­ §»¢ ¥²±¿
¬ ª±¨¬ «¼­»¬ (maximal independent set, MIS), ¥±«¨ ¯°¨ ¤®¡ ¢«¥-

 °³¸¥­¨¥ ±¨¬¬¥²°¨¨ (¤¥²¥°¬¨­¨°®¢ ­­»©  «£®°¨²¬)

657

­¨¨ «¾¡®© ¢¥°¸¨­» ¨§ V n V 0 ®­® ¯¥°¥±² ¥² ¡»²¼ ­¥§ ¢¨±¨¬»¬.
¥ ±«¥¤³¥² ±¬¥¸¨¢ ²¼ § ¤ ·³ ­ µ®¦¤¥­¨¿ ² ª®£® ¬­®¦¥±²¢  ±
£®° §¤® ¡®«¥¥ ±«®¦­®© § ¤ ·¥© ­ µ®¦¤¥­¨¿ ­¥§ ¢¨±¨¬®£® ¬­®¦¥±²¢  ­ ¨¡®«¼¸¥© ¬®¹­®±²¨ (ª ª®¢®¥, ª®­¥·­®, ¿¢«¿¥²±¿ ¬ ª±¨¬ «¼­»¬ | ­® ®¡° ²­®¥ ­¥¢¥°­®). «¿ ¯°®¨§¢®«¼­®£® £° ´  ¯®±«¥¤­¿¿ § ¤ ·  ¿¢«¿¥²±¿ NP-¯®«­®© (±¬. £« ¢³ 36, § ¤ ·  36.1). «¿ n½«¥¬¥­²­®£® ±¯¨±ª  ­¥§ ¢¨±¨¬®¥ ¬­®¦¥±²¢® ¬ ª±¨¬ «¼­®© ¬®¹­®±²¨ ±®±²®¨² ¨§ dn=2e ®¡º¥ª²®¢ | ¤®±² ²®·­® ¢§¿²¼ ®¡º¥ª²» ·¥°¥§
®¤¨­, ­ ·¨­ ¿ ± ¯¥°¢®£®. ²® ¬­®¦¥±²¢®, ª ª ¨ ±®®²¢¥²±²¢³¾¹ ¿
2-° ±ª° ±ª , ¬®¦¥² ¡»²¼ ­ ©¤¥)® ± ¯®¬®¹¼¾ ¯ ° ««¥«¼­®© ®¡° ¡®²ª¨ ¯°¥´¨ª±®¢ §  ¢°¥¬¿ O(lg n).
 ¬¥²¼²¥, ·²® ¢ ±«³· ¥ ±¯¨±ª  «¾¡®¥ ¬ ª±¨¬ «¼­®¥ ¬­®¦¥±²¢®
¢¥°¸¨­ ±®¤¥°¦¨² ­¥ ¬¥­¼¸¥ n=3 ½«¥¬¥­²®¢. ¥©±²¢¨²¥«¼­®, ¨§ «¾¡»µ ²°¥µ ¯®¤°¿¤ ¨¤³¹¨µ ®¡º¥ª²®¢ µ®²¿ ¡» ®¤¨­ ¤®«¦¥­ ¢µ®¤¨²¼ ¢
¬­®¦¥±²¢® | ¨­ ·¥ ±°¥¤­¨© ¨§ ½²¨µ ²°¥µ ¬®¦­® ¤®¡ ¢¨²¼, ±®µ° ­¨¢ ­¥§ ¢¨±¨¬®±²¼.
¨¦¥ ¡³¤¥² ¯®ª § ­®, ª ª §  ¢°¥¬¿ O(1) ¯®±²°®¨²¼ ¬ ª±¨¬ «¼­®¥ ­¥§ ¢¨±¨¬®¥ ¬­®¦¥±²¢® ¯® O(1)-° ±ª° ±ª¥.
30.5.2. »·¨±«¥­¨¥ 6-° ±ª° ±ª¨
ª ¦¥¬  «£®°¨²¬, ­ µ®¤¿¹¨© 6-° ±ª° ±ª³ ±¯¨±ª . » ±·¨² ¥¬,
·²® §  ª ¦¤»¬ ½«¥¬¥­²®¬ x ±¯¨±ª  § ª°¥¯«¥­ ¯°®¶¥±±®° ¯°®¶¥±±®°,
­®¬¥° ª®²®°®£® (¨§¢¥±²­»© ¯°®¶¥±±®°³) ¥±²¼ P (x) 2 f0; 1; : : : ; n ;
1g.
«£®°¨²¬ ¯®±«¥¤®¢ ²¥«¼­® ±²°®¨² ° ±ª° ±ª¨ C0; C1; : : : ; Cm, ¯®±²¥¯¥­­® ³¬¥­¼¸ ¿ ·¨±«® ¶¢¥²®¢.  · «¼­ ¿ ° ±ª° ±ª  C0 ¿¢«¿¥²±¿
n-° ±ª° ±ª®©,   Cm { 6-° ±ª° ±ª®©.   k-®¬ ¸ £¥ ¯® ° ±ª° ±ª¥ Ck
¢»·¨±«¿¥²±¿ ° ±ª° ±ª  Ck+1 . ¨±«® ¸ £®¢ m ¥±²¼ O(lg n).
 · «¼­ ¿ ° ±ª° ±ª  C0 ²°¨¢¨ «¼­ : C0[x] = P (x) (¶¢¥² ¢¥°¸¨­» ¥±²¼ ­®¬¥° ±®®²¢¥²±²¢³¾¹¥£® ¥© ¯°®¶¥±±®° ). ®±ª®«¼ª³ ­®¬¥°  ¯°®¶¥±±®°®¢ ° §«¨·­», ½²® ®²®¡° ¦¥­¨¥ ¤¥©±²¢¨²¥«¼­® ¿¢«¿¥²±¿ ° ±ª° ±ª®©. ( ¬¥²¼²¥, ·²® ª ¦¤»© ¶¢¥² ª®¤¨°³¥²±¿ dlg ne
¡¨² ¬¨ ¨ ¬®¦¥² µ° ­¨²¼±¿ ¢ ¯ ¬¿²¨, § ­¨¬ ¿ ­¥ ±«¨¸ª®¬ ¬­®£®
¬¥±² .)
¯¨¸¥¬ ²¥¯¥°¼ ¯°®¶¥±± ¯®±²°®¥­¨¿ ° ±ª° ±ª¨ Ck+1 ¯® Ck (±¬.
°¨±. 30.11). » ±·¨² ¥¬, ·²® ª ¦¤»© ¶¢¥² ª®¤¨°³¥²±¿ ¡¨²®¢®©
±²°®ª®© ´¨ª±¨°®¢ ­­®© (¤«¿ ¤ ­­®© ° ±ª° ±ª¨) ¤«¨­». ¥°¥µ®¤
®² Ck ª Ck+1 ³¬¥­¼¸ ¥² ½²³ ¤«¨­³.
² ª, ¯³±²¼ ¶¢¥²  ° ±ª° ±ª¨ Ck § ¯¨±»¢ ¾²±¿ r ¡¨² ¬¨ ¨ ±®±¥¤­¨¥ ®¡º¥ª²» x ¨ next[x] ¨¬¥¾² ¶¢¥²  Ck [x] = a ¨ Ck [next[i]] = b,
£¤¥ a = har;1 ; ar;2; : : : ; a0i, b = hbr;1 ; br;2; : : : ; b0i. ¢¥²  ½²¨ ° §«¨·­», ¯®½²®¬³ ai 6= bi ¤«¿ ­¥ª®²®°®£® i ®² 0 ¤® r ; 1. » ®¡º¿¢¨¬
¯ °³ hi; aii ¶¢¥²®¬ ½«¥¬¥­²  x ¢ ­®¢®© ° ±ª° ±ª¥ (§ ª®¤¨°®¢ ¢ ¥¥
¯®±«¥¤®¢ ²¥«¼­®±²¼¾ ¡¨²®¢). ¢¥²®¬ ¯®±«¥¤­¥£® ½«¥¬¥­²  ¢ ­®¢®©

658

« ¢  30 «£®°¨²¬» ¯ ° ««¥«¼­»µ ¢»·¨±«¥­¨©
¨±. 30.11 30.11. ®±²°®¥­¨¥ 6-° ±ª° ±ª¨ ¨ ±®®²¢¥²±²¢³¾¹¥£® ¬ ª±¨¬ «¼­®£®
­¥§ ¢¨±¨¬®£® ¬­®¦¥±²¢ . «£®°¨²¬ ¨±¯®«¼§³¥² n ¯°®¶¥±±®°®¢ ¨ ° ¡®² ¥² § 
¢°¥¬¿ O(lg  n). ­ · «¥ ±¯¨±®ª ¨§ n = 20 ®¡º¥ª²®¢ ° ±ª° ¸¥­ ¢ 20 ¶¢¥²®¢
(·²® ²°¥¡³¥² ¯¿²¨ ¡¨²®¢).   ¤¢  ¸ £  ½²  ° ±ª° ±ª  ±¢®¤¨²±¿ ª 6-° ±ª° ±ª¥.
«¥¬¥­²» MIS ¯®ª § ­» ·¥°­»¬ ¶¢¥²®¬.

° ±ª° ±ª¥ ¬» ¡³¤¥¬ ±·¨² ²¼ ¯ °³ h0; a0i, ¥±«¨ har;1 ; ar;2 ; : : : ; a0i
¡»«® ¥£® ¶¢¥²®¬ ¢ ±² °®© ° ±ª° ±ª¥.
±² ¥²±¿ ¯®­¿²¼, ¯®·¥¬³ ¢ ­®¢®© ° ±ª° ±ª¥ ¶¢¥²  ±®±¥¤­¨µ ¢¥°¸¨­ ¡³¤³² ° §«¨·­» ¨ ±ª®«¼ª® ¡¨²®¢ ­³¦­® ¤«¿ ª®¤¨°®¢ ­¨¿
¥¥ ¶¢¥²®¢.  ·­¥¬ ± ¯¥°¢®£®; ° ±±¬®²°¨¬ ¤¢  ±®±¥¤­¨µ ½«¥¬¥­²  x ¨ y = next[x] ¢ ­ ¸¥¬ ±¯¨±ª¥.  ­¼¸¥ ®­¨ ¨¬¥«¨ ¶¢¥² 
a = har;1 ; ar;2; : : : ; a0i, b = hbr;1; br;2; : : : ; b0i, ª®²®°»¥ ° §«¨· «¨±¼ ¢ ¡¨²¥ i, ¨ ­®¢»© ¶¢¥² x ¥±²¼ ¯ °  hi; aii, ¯°¨·¥¬ ai 6= bi.
³±²¼ ­®¢»© ¶¢¥² y ¥±²¼ ¯ °  hj; bj i. ¨¤­®, ·²® ¯ °» ½²¨ ° §«¨·­»: ¥±«¨ ° §«¨·­» ¨µ ¯¥°¢»¥ ·«¥­», ²® ¨ ¤®ª §»¢ ²¼ ­¥·¥£®, ¥±«¨
¦¥ ¯¥°¢»¥ ·«¥­» ±®¢¯ ¤ ¾² (i = j ), ²® ° §«¨·­» ¢²®°»¥ bj ° ¢­®
bi ¨ ­¥ ° ¢­® ai.
¥¯¥°¼ ® ª®«¨·¥±²¢¥ ¡¨²®¢: ¥±«¨ ­  k-®¬ ¸ £¥ ¶¢¥²  § ¯¨±»¢ «¨±¼ r ¡¨² ¬¨, ²® ­  (k + 1)-®¬ ¸ £¥ ®­¨ ¡³¤³² § ¯¨±»¢ ²¼±¿ ¢±¥£®
dlg re + 1 ¡¨² ¬¨. ±«¨ r > 4, ²® ¯°¨ ½²®¬ ·¨±«® ¡¨²®¢ ³¬¥­¼¸ ¥²±¿. ±«¨ ¦¥ r = 3, ²® ¤¢  ¶¢¥²  ¬®£³² ° §«¨· ²¼±¿ ¢ ° §°¿¤ µ 0, 1
¨«¨ 2, ¯®½²®¬³ ­  ±«¥¤³¾¹¥¬ ¸ £¥ ­®¬¥° «¾¡®£® ¶¢¥²  ¡³¤¥² ­ ·¨­ ²¼±¿ ± h00i, h01i ¨«¨ h10i ¨ ®ª ­·¨¢ ²¼±¿ ­³«¥¬ «¨¡® ¥¤¨­¨¶¥©.
°¨ ½²®¬ ¨§ ¢®±¼¬¨ ¶¢¥²®¢ ¯®«³· ¥²±¿ ­¥ ¡®«¥¥ ¸¥±²¨, ² ª ·²® ¬»
¯°¨µ®¤¨² ª 6-° ±ª° ±ª¥.
±«¨ ¯°¥¤¯®«®¦¨²¼, ·²® ®¯¥° ¶¨¿ ¯®¨±ª  ¬®¦¥² ­ ©²¨ ­³¦­»©
¨­¤¥ª± ¨ ±®¢¥°¸¨²¼ «¥¢»© ±¤¢¨£ §  ¢°¥¬¿ O(1), ²® ª ¦¤»© ¸ £
§ ­¨¬ ¥² ¢°¥¬¿ O(1). «£®°¨²¬ ¬®¦­® °¥ «¨§®¢ ²¼ ­  EREW¬ ¸¨­¥, ² ª ª ª ª ¦¤®¬³ ¯°®¶¥±±®°³ ­¥®¡µ®¤¨¬ ¤®±²³¯ «¨¸¼ ª
¤¢³¬ ®¡º¥ª² ¬ | x ¨ next[x].
®ª ¦¥¬ ²¥¯¥°¼, ·²® ·¨±«® ¸ £®¢ ¤® ¯®«³·¥­¨¿ 6-° ±ª° ±ª¨ ±®±² ¢«¿¥² O(lg n).  ¯®¬­¨¬, ·²® lg n ®¯°¥¤¥«¿«®±¼ ª ª ·¨±«® ¯°¨¬¥­¥­¨© ª n ´³­ª¶¨¨ lg, ¯®±«¥ ª®²®°»µ °¥§³«¼² ² ¡³¤¥² ­¥ ¡®«¼¸¥
1. ®«¥¥ ²®·­®, ¥±«¨ ·¥°¥§ lg(i) n ®¡®§­ ·¨²¼ i-ª° ²­®¥ ¯°¨¬¥­¥­¨¥
«®£ °¨´¬ , ²®
n

o

lg n = min i > 0 : lg(i) n 6 1

 ­ ¸¥¬ ±«³· ¥ ·¨±«® ¡¨²®¢ ­  ª ¦¤®¬ ¸ £¥ ²®¦¥ «®£ °¨´¬¨°³¥²±¿, ­® § ²¥¬ ®ª°³£«¿¥²±¿ (± ¨§¡»²ª®¬) ¨ ³¢¥«¨·¨¢ ¥²±¿ ­  1.
°®¢¥°¨¬, ·²® ¢±¥ ° ¢­® ·¨±«® ¸ £®¢ ¥±²¼ O(lg n).
³±²¼ ri { ·¨±«® ¡¨²®¢, ª®²®°»¬¨ § ¯¨±»¢ ¾²±¿ ¶¢¥²  ¯¥°¥¤
i-¬ ¸ £®¬. » ¤®ª ¦¥¬ ¯® ¨­¤³ª¶¨¨, ·²® ri 6 dlg(i) ne + 2 ¯°¨
dlg(i) ne > 2 §­ · «¼­® r1 6 dlg ne. ³±²¼ ³²¢¥°¦¤¥­¨¥ ¢¥°­® ¤«¿

 °³¸¥­¨¥ ±¨¬¬¥²°¨¨ (¤¥²¥°¬¨­¨°®¢ ­­»©  «£®°¨²¬)

659

(i ; 1)-£® ¸ £ . ®±ª®«¼ª³ ri = dlg ri;1 e + 1, ¨¬¥¥¬
ri = dlg ri;1e + 1 6 dlg(dlg(i;1) ne + 2)e + 1 6 dlg(lg(i;1) n + 3)e + 1 6
dlg(2 lg(i;1) n)e + 1 = dlg(lg(i;1) n) + 1e + 1 = dlg(i) ne + 2
¥²¢¥°²®¥ ­¥° ¢¥­±²¢® ¯®«³· ¥²±¿ ² ª: ¥±«¨ dlg(i) ne > 2, ²®
dlg(i;1) ne > 3, ² ª ·²® ³¢¥«¨·¥­¨¥ ­  3 ¬®¦­® § ¬¥­¨²¼ ³¬­®¦¥­¨¥¬ ­  2. ®½²®¬³ ¤«¿ m = lg n ; 1 ¨¬¥¥¬ rm 6 dlg(m;1) e + 2 6 4,
² ª ª ª lg(m+1) n 6 1 ¨ lg(m) n 6 2 ¯® ®¯°¥¤¥«¥­¨¾ lg n. ­ ·¨²,
rm+1 6 3, ¨ ¥¹¥ ·¥°¥§ ¸ £ ¯°®¶¥±± § ª®­·¨²±¿.  ª¨¬ ®¡° §®¬,
®¡¹¥¥ ª®«¨·¥±²¢® ¸ £®¢ ±®±² ¢«¿¥² O(lg n).
30.5.3. ®«³·¥­¨¥ ¬ ª±¨¬ «¼­®£® ­¥§ ¢¨±¨¬®£® ¬­®¦¥±²¢  ¨§ 6° ±ª° ±ª¨
³±²¼ ¤ ­ ±¯¨±®ª ¨§ n ®¡º¥ª²®¢ ¨ ¥£® ° ±ª° ±ª  C ¢ c ¶¢¥²®¢.
¯¨¸¥¬ EREW- «£®°¨²¬, ª®²®°»© ¯®§¢®«¿¥² ­ ©²¨ ¯® ½²®© ° ±ª° ±ª¥ ¬ ª±¨¬ «¼­®¥ ­¥§ ¢¨±¨¬®¥ ¬­®¦¥±²¢® (MIS) §  ¢°¥¬¿ O(c).
 · ±²­®±²¨, §­ ¿ 6-° ±ª° ±ª³, ¬®¦­® ­ ©²¨ ¬ ª±¨¬ «¼­®¥ ­¥§ ¢¨±¨¬®¥ ¬­®¦¥±²¢® §  ¢°¥¬¿ O(1).
¤¥¿  «£®°¨²¬  ¯®ª § ­  ­  °¨±. 30.11 (¸¥±²¼ ¯° ¢»µ ª®«®­®ª).
«¿ ª ¦¤®£® ®¡º¥ª²  x ±®®²¢¥²±²¢³¾¹¨© ¯°®¶¥±±®° µ° ­¨² ¡¨²
alive[x]. °¨ ½²®¬ alive[x] = true ®§­ · ¥², ·²® ½«¥¬¥­² x ¥¹¥
¨¬¥¥² ¸ ­± ¯®¯ ±²¼ ¢ MIS. ­ · «¥ alive[x] = true ¤«¿ ¢±¥µ ®¡º¥ª²®¢ x.
«£®°¨²¬ ­  ª ¦¤®¬ ¸ £¥ ° ±±¬ ²°¨¢ ¥² ½«¥¬¥­²» ®¤­®£® ¶¢¥² . ³±²¼ ²¥ª³¹¨© ¶¢¥² ° ¢¥­ i.  ¦¤»© ¯°®¶¥±±®° ¯°®¢¥°¿¥² ¤«¿
±¢®¥£® ½«¥¬¥­²  x ³±«®¢¨¿ C [x] = i ¨ alive[x] = true. ±«¨ ®¡  ³±«®¢¨¿ ¢»¯®«­¥­», ²® ½«¥¬¥­² x ¢ª«¾· ¥²±¿ ¢ MIS,   alive-¡¨²» ±®±¥¤­¨µ ± ­¨¬ ½«¥¬¥­²®¢ (±«¥¤³¾¹¥£® ¨ ¯°¥¤»¤³¹¥£®) ³±² ­ ¢«¨¢ ¾²±¿ ° ¢­»¬¨ false (½²¨ ½«¥¬¥­²» ­¥«¼§¿ ¢ª«¾· ²¼ ¢ MIS). ®±«¥
c ¸ £®¢ ª ¦¤»© ®¡º¥ª² «¨¡® ¢ª«¾·¥­ ¢ MIS, «¨¡® ¨¬¥¥² alive-¡¨²,
° ¢­»© false.
®ª ¦¥¬, ·²® ¯®«³·¥­­®¥ ¬­®¦¥±²¢® ¤¥©±²¢¨²¥«¼­® ¿¢«¿¥²±¿ ­¥§ ¢¨±¨¬»¬ ¨ ¬ ª±¨¬ «¼­»¬. °¥¤¯®«®¦¨¬, ·²® ¢ ¬­®¦¥±²¢® ¯®¯ «¨ ¤¢  ±®±¥¤­¨µ ®¡º¥ª² .  ±¨«³ ±¢®©±²¢ ° ±ª° ±ª¨ ®­¨ ¨¬¥¾²
° §­»¥ ¶¢¥² , ¯®½²®¬³ ¢ª«¾·¥­» ­  ° §­»µ ¸ £ µ. ® ¢ª«¾·¥­­»©
¯¥°¢»¬ ®¡º¥ª² ¤®«¦¥­ ¡»« ³±² ­®¢¨²¼ alive-¡¨² ¢²®°®£® ¢ ¯®«®¦¥­¨¥ false, ¨ ¢²®°®© ½«¥¬¥­² ³¦¥ ­¥ ¬®£ ¡»²¼ ¢ª«¾·¥­.
 ª±¨¬ «¼­®±²¼ ¬­®¦¥±²¢  ®·¥¢¨¤­ . ¥©±²¢¨²¥«¼­®, ¥±«¨ ½«¥¬¥­² x ­¥ ¢ª«¾·¥­ ¢ ¬­®¦¥±²¢®, ²® alive[x] = false, ¯®½²®¬³ ¢
¬­®¦¥±²¢® ¢ª«¾·¥­ ®¤¨­ ¨§ ¥£® ±®±¥¤¥©. ®½²®¬³ ¯°¨ ¤®¡ ¢«¥­¨¨
½«¥¬¥­²  x ¬­®¦¥±²¢® ¯¥°¥±² ­¥² ¡»²¼ ­¥§ ¢¨±¨¬»¬.
 ¦¤»© ¸ £  «£®°¨²¬  ²°¥¡³¥² ¢°¥¬¥­¨ O(1). «£®°¨²¬ ¬®¦¥²
¡»²¼ °¥ «¨§®¢ ­ ­  EREW-¬ ¸¨­¥, ¯®±ª®«¼ª³ ª ¦¤»© ¯°®¶¥±±®°
®¡° ¹ ¥²±¿ ²®«¼ª® ª ²°¥¬ ®¡º¥ª² ¬ { ±¢®¥¬³ ¨ ¥£® ±®±¥¤¿¬. ¬¥±²¥

660

« ¢  30 «£®°¨²¬» ¯ ° ««¥«¼­»µ ¢»·¨±«¥­¨©

±  «£®°¨²¬®¬ ¯®¨±ª  6-° ±ª° ±ª¨ ½²®²  «£®°¨²¬ ¤ ¥² ¢®§¬®¦­®±²¼
­ ©²¨ ¬ ª±¨¬ «¼­®¥ ­¥§ ¢¨±¨¬®¥ ¬­®¦¥±²¢® (¨ ²¥¬ ± ¬»¬ °¥¸¨²¼
§ ¤ ·³ ® ­ °³¸¥­¨¨ ±¨¬¬¥²°¨¨) §  ¢°¥¬¿ O(lg n) ± ¯®¬®¹¼¾ ¤¥²¥°¬¨­¨°®¢ ­­®£®  «£®°¨²¬ .
30.5.4. ¯° ¦­¥­¨¿
30.5-1 ®ª ¦¨²¥, ·²® ¢ ¯°¨¬¥°¥ ± ¢»¡®°®¬ ®¤­®£® ¨§ ¤¢³µ ¯°®¶¥±±®°®¢ ± ¯®¬®¹¼¾ ¡°®± ­¨¿ ¬®­¥²ª¨ ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥
²°¥¡³¥¬®£® ¢°¥¬¥­¨ ª®­¥·­®.
30.5-2 ³±²¼ ¤ ­  6-° ±ª° ±ª  ±¯¨±ª  ¨§ n ½«¥¬¥­²®¢.  ©¤¨²¥
EREW- «£®°¨²¬, ª®²®°»© §  ¢°¥¬¿ O(1) ±²°®¨² 3-° ±ª° ±ª³ ²®£®
¦¥ ±¯¨±ª , ¨±¯®«¼§³¿ n ¯°®¶¥±±®°®¢.
30.5-3 ³±²¼ ¤¥°¥¢® ± n ³§« ¬¨ § ¤ ­® ±«¥¤³¾¹¨¬ ®¡° §®¬: ª ¦¤»© ³§¥«, ª°®¬¥ ª®°­¿, ¨¬¥¥² ³ª § ²¥«¼ ­  °®¤¨²¥«¿.  ©¤¨²¥
CREW- «£®°¨²¬, ª®²®°»© ±²°®¨² O(1)-° ±ª° ±ª³ ½²®£® ¤¥°¥¢  § 
¢°¥¬¿ O(lg n).
30.5-4. °¨¤³¬ ©²¥ ½´´¥ª²¨¢­»©  «£®°¨²¬ ¯®¨±ª  O(1)° ±ª° ±ª¨ £° ´  ±²¥¯¥­¨ 3 ¨ ®¶¥­¨²¥ ¢°¥¬¿ ¥£® ° ¡®²».
30.5-5.  §®¢¥¬ k-° §¤¥«¥­­»¬ ¯®¤¬­®¦¥±²¢®¬ ±¯¨±ª  (k-ruling
set) ¬­®¦¥±²¢® ¥£® ®¡º¥ª²®¢, ª®²®°®¥ ­¥ ±®¤¥°¦¨² ±®±¥¤­¨µ ®¡º¥ª²®¢ ¨ ­¥ ¨¬¥¥² ¤»°®ª ¤«¨­» ¡®«¼¸¥ k (²® ¥±²¼ ¥£® ¤®¯®«­¥­¨¥
­¥ ±®¤¥°¦¨² ¡®«¥¥ k ¯®¤°¿¤ ¨¤³¹¨µ ®¡º¥ª²®¢).  ¯°¨¬¥°, «¾¡®¥
¬ ª±¨¬ «¼­®¥ ­¥§ ¢¨±¨¬®¥ ¬­®¦¥±²¢® ¡³¤¥² 2-° §¤¥«¥­­»¬.  ª
­ ©²¨ O(lg n)-° §¤¥«¥­­®¥ ¯®¤¬­®¦¥±²¢® ¢ n-½«¥¬¥­²­®¬ ±¯¨±ª¥ § 
¢°¥¬¿ O(1), ¨±¯®«¼§³¿ n ¯°®¶¥±±®°®¢? ®² ¦¥ ¢®¯°®± ¤«¿ O(lg lg n)¬­®¦¥±²¢ .
30.5-6 °¨¤³¬ ©²¥  «£®°¨²¬ ¯®¨±ª  6-° ±ª° ±ª¨ n-½«¥¬¥­²­®£®
±¯¨±ª  §  ¢°¥¬¿ O(lg(lg n)), ¯°¥¤¯®« £ ¿, ·²® ª ¦¤»© ¯°®¶¥±±®° ¬®¦¥² µ° ­¨²¼ § ° ­¥¥ ¢»·¨±«¥­­³¾ ² ¡«¨¶³ ° §¬¥°  O(lg n).
(ª § ­¨¥. ² ±ª®«¼ª¨µ §­ ·¥­¨© § ¢¨±¨² ª®­¥·­»© ¶¢¥² ®¡º¥ª² 
¢ ¯®±²°®¥­­®© ­ ¬¨ 6-° ±ª° ±ª¥?)

30.6.  ¤ ·¨
30-1 ¡° ¡®²ª  ¯°¥´¨ª±®¢ ­  ®²°¥§ª µ
°¨ ®¡° ¡®²ª¥ ¯°¥´¨ª±®¢ ­  ®²°¥§ª µ (segmented prex computation), ª ª ¨ ¯°¨ ®¡»·­®© ®¡° ¡®²ª¥ ¯°¥´¨ª±®¢, ´¨ª±¨°®¢ ­ 
¡¨­ °­ ¿  ±±®¶¨ ²¨¢­ ¿ ®¯¥° ¶¨¿ 
 ­  ¬­®¦¥±²¢¥ S . ® ¤ ­­®©
¯®±«¥¤®¢ ²¥«¼­®±²¨ x = hx1 ; x2; : : : ; xni, xi 2 S ¨ ¯®±«¥¤®¢ ²¥«¼­®±²¨ £° ­¨¶ (segment sequence) b = hb1; b2; : : : ; bni, £¤¥ bi 2 f0; 1g,
b1 = 1, ²°¥¡³¥²±¿ ¢»·¨±«¨²¼ ¯®±«¥¤®¢ ²¥«¼­®±²¼ hy1 ; y2; : : : ; yni,
yi 2 S , ª®²®° ¿ ±²°®¨²±¿ ² ª: ª ¦¤ ¿ ¥¤¨­¨¶  ¢ ¯®±«¥¤®¢ ²¥«¼­®±²¨ b ®§­ · ¥² ­ · «® ­®¢®£® ®²°¥§ª , ¨ ­  ª ¦¤®¬ ®²°¥§ª¥ ­¥§ -

 ¤ ·¨

661

30.12. ¡° ¡®²ª  ¯°¥´¨ª±®¢ ­  ®²°¥§ª µ (®¯¥° ¶¨¿ | ±«®¦¥­¨¥).
®ª § ­» ¢µ®¤­»¥ ¯®±«¥¤®¢ ²¥«¼­®±²¨ x ¨ b ¨ ¢»µ®¤­ ¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼ y.
 ½²®¬ ¯°¨¬¥°¥ ¨¬¥¥²±¿ 5 ®²°¥§ª®¢.
¨±. 30.12

¢¨±¨¬® ¯°®¨§¢®¤¨²±¿ ®¡° ¡®²ª  ¯°¥´¨ª±®¢ (±¬. °¨±. 30.12).
a. ¯°¥¤¥«¨¬ ­  ¬­®¦¥±²¢¥ ¯ ° f0; 1g  S ­®¢³¾ ®¯¥° ¶¨¾ 
^ :
(a; z )
^ (a0; z 0) =



(a; z 
 z 0) ¥±«¨ a0 = 0
(1; z 0)
¥±«¨ a0 = 1

®ª ¦¨²¥, ·²® ½²  ®¯¥° ¶¨¿  ±±®¶¨ ²¨¢­ .
b).  ©¤¨²¥ EREW- «£®°¨²¬ ¤«¿ ®¡° ¡®²ª¨ ¯°¥´¨ª±®¢ ­  ®²°¥§ª µ §  ¢°¥¬¿ O(lg n).
c).  ©¤¨²¥ EREW- «£®°¨²¬, ±®°²¨°³¾¹¨© ±¯¨±®ª ¨§ n k° §°¿¤­»µ ·¨±¥« §  ¢°¥¬¿ O(k lg n).
30-2 ®¨±ª ¬ ª±¨¬³¬  ¨§ n ·¨±¥« ± ¯®¬®¹¼¾ n ¯°®¶¥±±®°®¢
¤¥±¼ ®¯¨± ­ CRCW- «£®°¨²¬ ­ µ®¦¤¥­¨¿ ¬ ª±¨¬³¬  ¨§ n ·¨±¥«, ¨±¯®«¼§³¾¹¨© p = n ¯°®¶¥±±®°®¢.
a. ®ª ¦¨²¥, ·²® ¥±«¨ m 6 p=2, ²® ­ µ®¦¤¥­¨¥ ¬ ª±¨¬³¬  ¨§ m
·¨±¥« ¬®¦­® §  ¢°¥¬¿ O(1) ±¢¥±²¨ ª ­ µ®¦¤¥­¨¾ ¬ ª±¨¬³¬  ¨§ ­¥
¡®«¥¥ ·¥¬ m2=p ·¨±¥«, ¨±¯®«¼§³¿ CRCW-¬ ¸¨­³ ± p ¯°®¶¥±±®° ¬¨.
b. ³±²¼ ¢­ · «¥ ¨¬¥¥²±¿ m = bp=2c ·¨±¥«. ª®«¼ª® ¨µ ®±² ­¥²±¿
¯®±«¥ k ¯°¨¬¥­¥­¨© ª®­±²°³ª¶¨¨ ¯³­ª²  (a)?
c. ®±²°®©²¥ CRCW- «£®°¨²¬ ¯®¨±ª  ¬ ª±¨¬³¬  ¨§ n ·¨±¥« ±®
¢°¥¬¥­¥¬ ° ¡®²» O(lg lg n), ¨±¯®«¼§³¾¹¨© p = n ¯°®¶¥±±®°®¢.
30-3 ¢¿§­»¥ ª®¬¯®­¥­²»
 ½²®© § ¤ ·¥ ±²°®¨²±¿  «£®°¨²¬ ¤«¿ ¯®¨±ª  ±¢¿§­»µ ª®¬¯®­¥­² ­¥®°¨¥­²¨°®¢ ­­®£® £° ´  G = (V; E ). «£®°¨²¬ ¯°¥¤­ §­ ·¥­ ¤«¿ CRCW-¬ ¸¨­» (¢ ª®²®°®© ¬®¦¥² § ¯¨± ²¼±¿ «¾¡®¥ ¨§ ®¤­®¢°¥¬¥­­® § ¯¨±»¢ ¥¬»µ §­ ·¥­¨©) ± jV + E j ¯°®¶¥±±®° ¬¨. «¿
ª ¦¤®© ¢¥°¸¨­» v ¬» µ° ­¨¬ ³ª § ²¥«¼ p[v ]. ­ · «¥ p[v ] = v ¤«¿
¢±¥µ ¢¥°¸¨­ v .  ª®­¶¥ p[v ] = p[u] ¢ ²®¬ ¨ ²®«¼ª® ¢ ²®¬ ±«³· ¥,
ª®£¤  u ¨ v «¥¦ ² ¢ ®¤­®© ±¢¿§­®© ª®¬¯®­¥­²¥. ® ¢°¥¬¿ ° ¡®²»
 «£®°¨²¬  ³ª § ²¥«¨ ®¡° §³¾² ­¥±ª®«¼ª® ¤¥°¥¢¼¥¢ ±±»«®ª (pointer
trees). ¥°¥¢® ±±»«®ª ­ §»¢ ¥²±¿ §¢¥§¤®© (star), ¥±«¨ p[u] = p[v ] ¤«¿
«¾¡»µ ¤¢³µ ¥£® ¢¥°¸¨­ u ¨ v .
°¥¤¯®« £ ¥²±¿, ·²® ª ¦¤®¥ °¥¡°® ¢ £° ´¥ ¯°®¤³¡«¨°®¢ ­®, ²®
¥±²¼ ¢¬¥±²¥ ± ¯ °®© (u; v ) ¬­®¦¥±²¢® E ±®¤¥°¦¨² ¯ °³ (v; u). «£®°¨²¬ ¨±¯®«¼§³¥² ¤¢¥ ®±­®¢­»µ ®¯¥° ¶¨¨: Hook ¨ Jump,   ² ª¦¥
¯°®¶¥¤³°³ Star, ª®²®° ¿ ¤¥« ¥² star[v ] ° ¢­»¬ true, ¥±«¨ ¢¥°¸¨­  v ¯°¨­ ¤«¥¦¨² §¢¥§¤¥.
Hook(G)
1 Star(G)
2 for(¤«¿) ª ¦¤®£® °¥¡°  (u; v ) 2 E [G]
3 do if star[u] ¨ p[u] > p[v ]
4
then p[p[u]] p[v ]

662

« ¢  30 «£®°¨²¬» ¯ ° ««¥«¼­»µ ¢»·¨±«¥­¨©

5 Star(G)
6 for(¤«¿) ª ¦¤®£® °¥¡°  (u; v ) 2 E [G]
7 do if star[u] ¨ p[u] 6= p[v ]
8
then p[p[u]] p[v ]
Jump(G)
1 for(¤«¿) ª ¦¤®© ¢¥°¸¨­» v 2 V [G]
2 do p[v ] p[p[v ]]
«£®°¨²¬ ° ¡®² ¥² ±«¥¤³¾¹¨¬ ®¡° §®¬: ¢­ · «¥ ¢»¯®«­¿¥²±¿
Hook,   § ²¥¬ ·¥°¥¤³¾²±¿ Hook, Jump, Hook, Jump ¨ ² ª ¤ «¥¥,
¯®ª  ¯°¨ ¢»¯®«­¥­¨¨ ¯°®¶¥¤³°» Jump ­¥ ®ª ¦¥²±¿, ·²® ­¨ ®¤¨­
³ª § ²¥«¼ ­¥ ¬¥­¿¥²±¿.  ¬¥²¼²¥, ·²® ¢­ · «¥ ¤¢ ¦¤» ¢»¯®«­¿¥²±¿
¯°®¶¥¤³°  Hook.
a.  ¯¨¸¨²¥ ¯°®¶¥¤³°³ Star(G).
b. ®ª ¦¨²¥, ·²® ³ª § ²¥«¨ p ®¡° §³¾² ¢ «¾¡®© ¬®¬¥­² ­¥±ª®«¼ª® ¤¥°¥¢¼¥¢, ¯°¨·¥¬ ª®°­¨ ­ µ®¤¿²±¿ ¢ ²¥µ ¢¥°¸¨­ µ, ª®²®°»¥ ³ª §»¢ ¾² ­  ±¥¡¿. ®ª ¦¨²¥, ·²® ¥±«¨ p[u] = p[v ], ²® u ¨ v «¥¦ ² ¢
®¤­®© ±¢¿§­®© ª®¬¯®­¥­²¥.
c. ®ª ¦¨²¥, ·²®  «£®°¨²¬ ° ¡®² ¥² ¯° ¢¨«¼­®, ²® ¥±²¼ ®±² ­ ¢«¨¢ ¥²±¿ ¨ ¢ ¬®¬¥­² ®±² ­®¢ª¨ p[u] = p[v ] ²®£¤  ¨ ²®«¼ª® ²®£¤ ,
ª®£¤  u ¨ v ¯°¨­ ¤«¥¦ ² ®¤­®© ±¢¿§­®© ª®¬¯®­¥­²¥.
¶¥­¨¬ ¢°¥¬¿ ° ¡®²»  «£®°¨²¬ .  ±±¬®²°¨¬ ª ª³¾-­¨¡³¤¼
±¢¿§­³¾ ª®¬¯®­¥­²³ C , ±®¤¥°¦ ¹³¾ ­¥ ¬¥­¼¸¥ ¤¢³µ ¢¥°¸¨­.
³±²¼ ¢ ­¥ª®²®°»© ¬®¬¥­² ° ¡®²»  «£®°¨²¬  ª®¬¯®­¥­²  C ±®±²®¨² ¨§ ­¥±ª®«¼ª¨µ ¤¥°¥¢¼¥¢ fTi g. ¯°¥¤¥«¨¬ ¯®²¥­¶¨ « ª®¬¯®­¥­²»
C ª ª
X
(C ) = height(Ti)
Ti

£¤¥ height(Ti) { ¢»±®²  ¤¥°¥¢  Ti .  ¸  ¶¥«¼ { ¯®ª § ²¼, ·²® ª ¦¤ ¿ ¯ °  ®¯¥° ¶¨© Hook{Jump ³¬¥­¼¸ ¥² (C ) ¢ ­¥ª®²®°®¥
´¨ª±¨°®¢ ­­®¥ ·¨±«® ° § (¨«¨ ¥¹¥ ±¨«¼­¥¥).
d. ®ª ¦¨²¥, ·²® ¯®±«¥ ¯¥°¢®£® ¢»§®¢  ¯°®¶¥¤³°» Hook ­¥²
¤¥°¥¢¼¥¢ ¢»±®²» 0 ¨ ·²® (C ) 6 jV j.
e. ®ª ¦¨²¥, ·²® ¯®±«¥¤³¾¹¨¥ ¢»§®¢» ¯°®¶¥¤³°» Hook ­¥ ³¢¥«¨·¨¢ ¾² (C ).
f. ®ª ¦¨²¥, ·²® ¯®±«¥ «¾¡®£® ¢»§®¢  ¯°®¶¥¤³°» Hook, ª°®¬¥
¯¥°¢®£®, ±°¥¤¨ ¤¥°¥¢¼¥¢ ±±»«®ª ­¥² §¢¥§¤ (§  ¨±ª«¾·¥­¨¥¬ ±¢¿§­»µ
ª®¬¯®­¥­², ¢±¥ ¢¥°¸¨­» ª®²®°»µ ³¦¥ ®¡º¥¤¨­¥­» ¢ ®¤­³ §¢¥§¤³).
g. ®ª ¦¨²¥, ·²® ¥±«¨ ¤¥°¥¢¼¿ ±±»«®ª ¤«¿ ¤ ­­®© ±¢¿§­®© ª®¬¯®­¥­²» C ¥¹¥ ­¥ ¯°¥¢° ²¨«¨±¼ ¢ ®¤­³ §¢¥§¤³, ²® ¯®±«¥ ¢»§®¢ 
¯°®¶¥¤³°» Jump ¯®²¥­¶¨ « (C ) ³¬¥­¼¸ ¥²±¿ ¯® ª° ©­¥© ¬¥°¥ ¢
¯®«²®°  ° § .  ª®¢ ­ ¨µ³¤¸¨© ±«³· © (ª®£¤  ¯®²¥­¶¨ « ³¬¥­¼¸ ¥²±¿ ¬¥­¼¸¥ ¢±¥£®)?
h. »¢¥¤¨²¥ ¨§ ¯°¥¤»¤³¹¥£®, ·²® ¢°¥¬¿ ° ¡®²»  «£®°¨²¬  ±®±² ¢«¿¥² O(lg jV j).
30-4 ° ­±¯®­¨°®¢ ­¨¥ ¨§®¡° ¦¥­¨¿

®¬¬¥­² °¨¨

663

¨¤¥®¯ ¬¿²¼ ¬®¦­® ° ±±¬ ²°¨¢ ²¼ ª ª ¬ ²°¨¶³ ¡¨²®¢ M ° §¬¥°  p  p (±·¨² ¥¬, ·²® ²®·ª¨ ¡»¢ ¾² ·¥°­»¬¨ ¨ ¡¥«»¬¨). °¨ ½²®¬
­  ¤¨±¯«¥¥ ¢¨¤­  ¥¥ · ±²¼ | ¢¥°µ­¿¿ «¥¢ ¿ ¯®¤¬ ²°¨¶  ° §¬¥° 
n  n. ¯°¥¤¥«¨¬ ®¯¥° ¶¨¾ ¯¥°¥­®±  ¡«®ª  ¡¨²®¢ (Block Transfer
of bits, BitBLT). °®¶¥¤³°  BitBLT(r1; c1; r2; c2; nr; nc; ) ¢»¯®«­¿¥² ¯°¨±¢ ¨¢ ­¨¿

M [r2 + i; c2 + j ] M [r2 + i; c2 + j ]  M [r1 + i; c1 + j ]
¤«¿ ¢±¥µ i = 0; 1; : : : ; nr ; 1, j = 0; 1; : : : ; nc ; 1. ¤¥±¼  ®¡®§­ · ¥²

«¾¡³¾ ¨§ 16 ¡¨­ °­»µ «®£¨·¥±ª¨µ ®¯¥° ¶¨©.
³±²¼ ²°¥¡³¥²±¿ ²° ­±¯®­¨°®¢ ²¼ ¢¨¤¨¬³¾ · ±²¼ ¨§®¡° ¦¥­¨¿:
M [i; j ] M [j; i]. ³¤¥¬ ¯°¥¤¯®« £ ²¼, ·²® ¢°¥¬¿ ª®¯¨°®¢ ­¨¿ ¡¨²®¢ ¬¥­¼¸¥, ·¥¬ ¢°¥¬¿ ¯¥°¥­®±  ¡«®ª  ¡¨²®¢, ² ª ·²® ¬» ®¶¥­¨¢ ­¨¥¬ ¨¬¥­­® ·¨±«® ®¯¥° ¶¨© BitBLT.
®ª ¦¨²¥, ·²® ¬®¦­® ²° ­±¯®­¨°®¢ ²¼ ¨§®¡° ¦¥­¨¥, ¢»§¢ ¢
¯°®¶¥¤³°³ BitBLT ¢±¥£® «¨¸¼ O(lg n) ° §. °¥¤¯®« £ ¥²±¿, ·²®
p ±³¹¥±²¢¥­­® ¡®«¼¸¥, ·¥¬ n, ² ª ·²® ¨¬¥¥²±¿ ¡®«¼¸®¥ ° ¡®·¥¥
¯°®±²° ­±²¢®, £¤¥ ¬®¦­® ±®µ° ­¿²¼ ¯°®¬¥¦³²®·­»¥ °¥§³«¼² ²».
 ª ¿ · ±²¼ ½²®£® ¯°®±²° ­±²¢  ¨±¯®«¼§³¥²±¿? (ª § ­¨¥: ¨±¯®«¼§³©²¥ ¯®¤µ®¤ À° §¤¥«¿© ¨ ¢« ±²¢³©Á, § ¯³±ª ¿ ¯°®¶¥¤³°³ BitBLT
± ®¯¥° ¶¨¥© ).

30.7. ®¬¬¥­² °¨¨
 ° ««¥«¼­»¥  «£®°¨²¬» ¤«¿ ª®¬¡¨­ ²®°­»µ § ¤ · ®¯¨±»¢ ¾²
ª« [9],  °¯ ¨  ¬ · ­¤°  [118] ¨ ¥©²®­ [135].  §«¨·­»¥ ¬®¤¥«¨
¯ ° ««¥«¼­»µ ¢»·¨±«¥­¨© ®¯¨± «¨ ¢ ­£ ¨ °¨££± [109],   ² ª¦¥
¤¥ °®®² [110].
 · «® ²¥®°¨¨ ¯ ° ««¥«¼­»µ ¢»·¨±«¥­¨© ®²­®±¨²±¿ ª ª®­¶³
1940-µ £®¤®¢ XX ¢¥ª , ª®£¤  ¦. ´®­ ¥©¬ ­ [38] ¢¢¥« ¯®­¿²¨¥ ª«¥²®·­®£®  ¢²®¬ ² , ª®²®°»© ¯® ±³²¨ ¿¢«¿¥²±¿ ¤¢³¬¥°­»¬ ¬ ±±¨¢®¬
¯°®¶¥±±®°®¢ ± ª®­¥·­»¬ ·¨±«®¬ ±®±²®¿­¨©, ° ±¯®«®¦¥­­»µ ¢ ³§« µ
ª«¥²· ²®© ¡³¬ £¨. ±¥²ª¥. ®¤¥«¼ PRAM ¢¢¥«¨ ®°·³­ ¨  ©«¨ [73]
(¯®µ®¦¨¥ ¬®¤¥«¨ ¯°¥¤« £ «¨±¼ ¬­®£¨¬¨  ¢²®° ¬¨ ¨ ° ­¼¸¥).
¥²®¤ ¯¥°¥µ®¤®¢ ¯® ³ª § ²¥«¿¬ ¡»« ¯°¥¤«®¦¥­  ©«¨ [204].  ° ««¥«¼­ ¿ ®¡° ¡®²ª  ¯°¥´¨ª±®¢ ¡»«  ° ±±¬®²°¥­  ¢ ° ¡®²¥ ´¬ ­  [152] (¢ ª®­²¥ª±²¥ ±«®¦¥­¨¿ ± ¯°¥¤¢»·¨±«¥­¨¥¬ ¯¥°¥­®±®¢).
¥²®¤ ½©«¥°®¢  ¶¨ª«  ¯°¥¤«®¦¨«¨  °¼¿­ ¨ ¨¸ª¨­ [191].
®®²­®¸¥­¨¿ ¬¥¦¤³ ·¨±«®¬ ¯°®¶¥±±®°®¢ ¨ ¢°¥¬¥­¥¬ ¤«¿ § ¤ ·¨ ­ µ®¦¤¥­¨¿ ¬ ª±¨¬³¬  n ½«¥¬¥­²®¢ ¨§³· «  «¨ ­²®¬ [193]; ®­
¦¥ ¤®ª § «, ·²® ¤«¿ ½²®© § ¤ ·¨ ­¥ ±³¹¥±²¢³¥² ½´´¥ª²¨¢­®£® ¯®
§ ²° ² ¬  «£®°¨²¬  ±® ¢°¥¬¥­¥¬ ° ¡®²» O(1). ³ª, ¢®°ª ¨  ©¸³ª [50] ¤®ª § «¨, ·²® ¢»·¨±«¥­¨¥ ¬ ª±¨¬³¬  ­  CREW-¬ ¸¨­¥
²°¥¡³¥² ¢°¥¬¥­¨ 
(lg n). ¥²®¤ ¬®¤¥«¨°®¢ ­¨¿ CRCW-¬ ¸¨­» ±

664

« ¢  30 «£®°¨²¬» ¯ ° ««¥«¼­»µ ¢»·¨±«¥­¨©

¯®¬®¹¼¾ EREW-¬ ¸¨­» ¯°¥¤«®¦¨« ¨¸ª¨­ [195].
¥®°¥¬³ 30.2 ¤®ª § « °¥­² [34]. ´´¥ª²¨¢­»© ½´´¥ª²¨¢­»©
 «£®°¨²¬ ¤«¿ ­ µ®¦¤¥­¨¿ ­®¬¥°®¢ ¢ ±¯¨±ª¥ ¯°¥¤«®¦¨«¨ ­¤¥°±®­
¨ ¨««¥° [11]. ­¨ ¯°¥¤«®¦¨«¨ ² ª¦¥ ½´´¥ª²¨¢­»© ¤¥²¥°¬¨­¨°®¢ ­­»©  «£®°¨²¬ ¤«¿ ½²®© § ¤ ·¨ [10]. ¥²¥°¬¨­¨°®¢ ­­»©  «£®°¨²¬ ­ °³¸¥­¨¿ ±¨¬¬¥²°¨¨ ¢§¿² ¨§ ° ¡®²» ®«¼¤¡¥°£  ¨ «®²ª¨­ 
[84]; ®­ ®±­®¢ ­ ­  ¯®µ®¦¥¬  «£®°¨²¬¥ ± ²¥¬ ¦¥ ¢°¥¬¥­¥¬ ° ¡®²»,
ª®²®°»© ¯°¨¤³¬ «¨ ®³« ¨ ¨¸ª¨­ [47].

31

 ²°¨¶» ¨ ¤¥©±²¢¨¿ ± ­¨¬¨

 ²°¨¶» · ±²® ¢±²°¥· ¾²±¿ ¢ ­ ³·­»µ ° ±·¥² µ, ¯®½²®¬³ ¢ ¦­®
³¬¥²¼ ½´´¥ª²¨¢­® ± ­¨¬¨ ° ¡®² ²¼. ²  £« ¢  ±®¤¥°¦¨² ª° ²ª®¥
¢¢¥¤¥­¨¥ ¢ ²¥®°¨¾ ¬ ²°¨¶ ¨ ®¯¥° ¶¨© ­ ¤ ­¨¬¨. ±®¡®¥ ¢­¨¬ ­¨¥
³¤¥«¿¥²±¿ ³¬­®¦¥­¨¾ ¬ ²°¨¶ ¨ °¥¸¥­¨¾ ±¨±²¥¬ «¨­¥©­»µ ³° ¢­¥­¨©.
 ° §¤¥«¥ 31.1 ¬» ¢¢¥¤¥¬ ®±­®¢­»¥ ¯®­¿²¨¿ ¨ ®¡®§­ ·¥­¨¿.  ° §¤¥«¥ 31.2 ¨§« £ ¥²±¿  «£®°¨²¬ ²° ±±¥­ , ¯®§¢®«¿¾¹¨© ³¬­®¦¨²¼
¤¢¥ ¬ ²°¨¶» ° §¬¥°  n  n §  ¢°¥¬¿ (nlg 7 ) = O(n2:81). (®¿¢«¥­¨¥
 «£®°¨²¬  ³¬­®¦¥­¨¿ ¬ ²°¨¶, ° ¡®² ¾¹¥£® ¡»c²°¥¥, ·¥¬ ±² ­¤ °²­»©, ¡»«® ¢ ±¢®¥ ¢°¥¬¿ ¡®«¼¸®© ­¥®¦¨¤ ­­®±²¼¾.)  ° §¤¥«¥
31.3 ¬» ¢¢¥¤¥¬ ¯®­¿²¨¿ ª¢ §¨ª®«¼¶ , ª®«¼¶  ¨ ¯®«¿,   § ²¥¬ ±´®°¬³«¨°³¥¬ ¤®¯³¹¥­¨¿, ­¥®¡µ®¤¨¬»¥ ¤«¿ ¯° ¢¨«¼­®© ° ¡®²»  «£®°¨²¬  ²° ±±¥­ . ²®² ° §¤¥« ±®¤¥°¦¨² ² ª¦¥  ±¨¬¯²®²¨·¥±ª¨
¡»±²°»©  «£®°¨²¬ ¯¥°¥¬­®¦¥­¨¿ ¡³«¥¢»µ ¬ ²°¨¶, ®±­®¢ ­­»© ­ 
 «£®°¨²¬¥ ²° ±±¥­ .  ° §¤¥«¥ 31.4 ° ±±ª §»¢ ¥²±¿, ª ª °¥¸ ²¼
±¨±²¥¬» «¨­¥©­»µ ³° ¢­¥­¨© ± ¯®¬®¹¼¾ ² ª ­ §»¢ ¥¬®£® LUP° §«®¦¥­¨¿.  ° §¤¥«¥ 31.5 ¬» ®¡±³¤¨¬ ±¢¿§¼ ¬¥¦¤³ § ¤ ·¥© ³¬­®¦¥­¨¿ ¬ ²°¨¶ ¨ § ¤ ·¥© ®¡° ¹¥­¨¿ ¬ ²°¨¶».  ª®­¥¶, ¢ ° §¤¥«¥
31.6 ¬» ° ±±¬®²°¨¬ ±¨¬¬¥²°¨·¥±ª¨¥ ¯®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­»¥
¬ ²°¨¶» ¨ ¯®ª ¦¥¬, ª ª ± ¨µ ¯®¬®¹¼¾ ¬®¦­® °¥¸ ²¼ ¯¥°¥®¯°¥¤¥«¥­­»¥ ±¨±²¥¬» «¨­¥©­»µ ³° ¢­¥­¨© ¬¥²®¤®¬ ­ ¨¬¥­¼¸¨µ ª¢ ¤° ²®¢.

31.1.  ²°¨¶» ¨ ¨µ ±¢®©±²¢ 
 ½²®¬ ° §¤¥«¥ ¬» ­ ¯®¬­¨¬ ®±­®¢­»¥ ¯®­¿²¨¿ ²¥®°¨¨ ¬ ²°¨¶,
¨±¯®«¼§³¥¬»¥ ¢ ¤ «¼­¥©¸¥¬.
 ²°¨¶» ¨ ¢¥ª²®°».
 ²°¨¶¥© (matrix) ­ §»¢ ¥²±¿ ¯°¿¬®³£®«¼­ ¿ ² ¡«¨¶  ·¨±¥«.

666

« ¢  31  ²°¨¶» ¨ ¤¥©±²¢¨¿ ± ­¨¬¨

 ¯°¨¬¥°,

A=



a11 a12 a13
a21 a22 a23



=


(31:1)
1
2
3
= 4 5 6
¿¢«¿¥²±¿ 2  3 ¬ ²°¨¶¥© A = (aij ), ¢ ª®²®°®© ­  ¯¥°¥±¥·¥­¨¨ i© ±²°®ª¨ ¨ j -£® ±²®«¡¶  ±²®¨² ½«¥¬¥­² aij (i = 1; 2 ¨ j = 1; 2; 3).
» ¡³¤¥¬ ®¡®§­ · ²¼ ¬ ²°¨¶» ¡®«¼¸¨¬¨ ¡³ª¢ ¬¨,   ¨µ ½«¥¬¥­²»
| ±®®²¢¥²±²¢³¾¹¨¬¨ ¬ «¥­¼ª¨¬¨ ¡³ª¢ ¬¨ ± ­¨¦­¨¬¨ ¨­¤¥ª± ¬¨. ­®¦¥±²¢® ¢±¥µ (m  n)-¬ ²°¨¶ ± ¢¥¹¥±²¢¥­­»¬¨ ½«¥¬¥­² ¬¨
®¡®§­ · ¥²±¿ Rmn.  ®¡¹¥¬ ±«³· ¥, ¬­®¦¥±²¢® ¬ ²°¨¶ ° §¬¥° 
m  n, ½«¥¬¥­²» ª®²®°»µ ¡¥°³²±¿ ¨§ ¬­®¦¥±²¢  S , ®¡®§­ · ¥²±¿
S mn .
°¨ ²° ­±¯®­¨°®¢ ­¨¨ ¬ ²°¨¶» A ¥¥ ±²°®ª¨ ±² ­®¢¿²±¿ ±²®«¡¶ ¬¨ ¨ ­ ®¡®°®².  ²°¨¶ , ¯®«³· ¥¬ ¿ ¨§ A ²° ­±¯®­¨°®¢ ­¨¥¬,
®¡®§­ · ¥²±¿ AT (the transpoose of A).  ¯°¨¬¥°, ¤«¿ ¬ ²°¨¶» A
¨§ (31.1)
0
1
1 4
AT = @ 2 5 A
3 6
¥ª²®°®¬ (vector) ­ §»¢ ¥²±¿ ®¤­®¬¥°­»© ¬ ±±¨¢ ·¨±¥«.  ¯°¨¬¥°,
0
1
2
x=@ 3 A
(31:2)
5
¿¢«¿¥²±¿ ¢¥ª²®°®¬ ¨§ ²°¥µ ½«¥¬¥­²®¢. » ¡³¤¥¬ ®¡®§­ · ²¼ ¢¥ª²®°» ¬ «¥­¼ª¨¬¨ ¡³ª¢ ¬¨. «¿ i;£® ½«¥¬¥­²  ¢¥ª²®°  x, ±®±²®¿¹¥£®
¨§ n ½«¥¬¥­²®¢, ¯°¨¬¥­¿¥²±¿ ®¡®§­ ·¥­¨¥ xi (i = 1; 2; :::; n). ² ­¤ °²­®© ´®°¬®© ¢¥ª²®°  ¬» ¡³¤¥¬ ±·¨² ²¼ ¢¥ª²®°-±²®«¡¥¶ (²®
¥±²¼ n1-¬ ²°¨¶³); ¯°¨ ¥£® ²° ­±¯®­¨°®¢ ­¨¨ ¯®«³· ¥²±¿ ¢¥ª²®°±²°®ª  :
xT = ( 2 3 5 ):
¥ª²®°, i-© ½«¥¬¥­² ª®²®°®£® ° ¢¥­ 1,   ¢±¥ ®±² «¼­»¥ ½«¥¬¥­²»
° ¢­» 0, ­ §»¢ ¾² ¥¤¨­¨·­»¬ ¢¥ª²®°®¬ (unit vector) ¨ ®¡®§­ · ¾² ei . ®«¨·¥±²¢® ½«¥¬¥­²®¢ ¥¤¨­¨·­®£® ¢¥ª²®°  ®¡»·­® ®¯°¥¤¥«¿¥²±¿ ¨§ ª®­²¥ª±² .
³«¥¢®© ¬ ²°¨¶¥© (zero matrix) ­ §»¢ ¥²±¿ ¬ ²°¨¶ , ¢±¥ ½«¥¬¥­²» ª®²®°®© ° ¢­» 0.  ª ¿ ¬ ²°¨¶  ®¡»·­® ®¡®§­ · ¥²±¿ 0. ²®
¯®­¨¬ ²¼ ¯®¤ ½²¨¬ ®¡®§­ ·¥­¨¥¬ | ·¨±«® 0 ¨«¨ ­³«¥¢³¾ ¬ ²°¨¶³ | ®¡»·­® ¿±­® ¨§ ª®­²¥ª±² ; ¥±«¨ ¨¬¥¥²±¿ ¢ ¢¨¤³ ¬ ²°¨¶ , ²®
° §¬¥° ¥¥ ²®¦¥ ®¯°¥¤¥«¿¥²±¿ ¨§ ª®­²¥ª±² .
 ±²® ¢±²°¥· ¾²±¿ ª¢ ¤° ²­»¥ ¬ ²°¨¶» (square matrices) |
¬ ²°¨¶» ° §¬¥°  n  n. ¥ª®²®°»¥ ¨µ ¢¨¤» ¬» ®²¬¥²¨¬ ®±®¡®.


 ²°¨¶» ¨ ¨µ ±¢®©±²¢ 

667

1.  ¤¨ £®­ «¼­®© ¬ ²°¨¶» (diagonal matrix) ¢±¥ ¢­¥¤¨ £®­ «¼­»¥ ½«¥¬¥­²» ° ¢­» ­³«¾ (aij = 0 ¯°¨ i 6= j ), ¯®½²®¬³ ®­  ¬®¦¥²
¡»²¼ § ¤ ­  ¯¥°¥·¨±«¥­¨¥¬ ½«¥¬¥­²®¢, ±²®¿¹¨µ ­  ¤¨ £®­ «¨.
0
1
a11 0 : : : 0
B 0 a22 : : :
0C
B
C
diag(a11; a22; : : : ; ann ) = B
C:
.
.
.
.
.
.
.
.
@ .
. . A
.
0 0 : : : ann
2. ¤¨­¨·­®© ¬ ²°¨¶¥© (identity matrix) ­ §»¢ ¥²±¿ ¤¨ £®­ «¼­ ¿ ¬ ²°¨¶ , ¤¨ £®­ «¼ ª®²®°®© § ¯®«­¥­  ¥¤¨­¨¶ ¬¨:
0
1
1 0 ::: 0
B0 1 : : : 0C
C
In = diag(1; 1; :::; 1) = B
B. . .
C:
.
.
.
.
.
@. .
. .A
0 0 ::: 1
­®£¤  ¨­¤¥ª± n ¯°¨ ¡³ª¢¥ I ®¯³±ª ¥²±¿; ° §¬¥° ¬ ²°¨¶» ¢ ½²®¬
±«³· ¥ ®¯°¥¤¥«¿¥²±¿ ¨§ ª®­²¥ª±² . ²®«¡¶ ¬¨ ¥¤¨­¨·­®© ¬ ²°¨¶»
±«³¦ ² ¢¥ª²®°» e1 ; e2; : : : ; en .
3.  ²°¥µ¤¨ £®­ «¼­®© ¬ ²°¨¶» (tridiagonal matrix) ­¥­³«¥¢»¥
½«¥¬¥­²» ¬®£³² ¯®¿¢«¿²¼±¿ ­  £« ¢­®© ¤¨ £®­ «¨ (ti;i ¯°¨ i =
1; 2; : : : ; n), ¯°¿¬® ­ ¤ ­¥© (ti;i+1 ¯°¨ i = 1; 2; : : : ; n ; 1), ¨«¨ ¯°¿¬® ¯®¤ ­¥© (ti+1;i ¯°¨ i = 1; 2; : : : ; n ; 1). ±¥ ®±² «¼­»¥ ½«¥¬¥­²»
° ¢­» ­³«¾ (tij = 0 ¯°¨ ji ; j j > 1):
0
t11 t12 0 0 : : :
0
0
0 1
0
0
0 C
Bt21 t22 t23 0 : : :
B .
.. .. .. . . .
..
..
.. C
B .
.
.
.
.
.
.
. C
B
C:
T =B
0 0 0 : : : tn;2;n;2 tn;2;n;1 0 C
B0
C
@0
0 0 0 : : : tn;1;n;2 tn;1;n;1 tn;1;n A
0 0 0 0 :::
0
tn;n;1 tn;n
4.  ¢¥°µ­¥-²°¥³£®«¼­®© ¬ ²°¨¶» (upper-triangular matrix) ¢±¥
½«¥¬¥­²» ¯®¤ £« ¢­®© ¤¨ £®­ «¼¾ ° ¢­» ­³«¾ (uij = 0 ¯°¨ i > j ):
0

1

u11 u12 : : : u1n
B 0
u22 : : : u2n C
B
C

U =B
.
@ ..

:
.. . . . .. C
.
. A
0 0 : : : unn
5.  ­¨¦­¥-²°¥³£®«¼­®© ¬ ²°¨¶» (lower-triangular matrix) ¢±¥
½«¥¬¥­²» ­ ¤ £« ¢­®© ¤¨ £®­ «¼¾ ° ¢­» ­³«¾ (lij = 0 ¯°¨ i < j ):
0
1
l11 0 : : : 0
Bl12 l22 : : : 0 C
C
L=B
B ..
C:
.
.
.
.
.
.
@ .
. .A
.
ln1 ln2 : : : lnn

668

« ¢  31  ²°¨¶» ¨ ¤¥©±²¢¨¿ ± ­¨¬¨

6.  ²°¨¶  ¯¥°¥±² ­®¢ª¨ (permutation matrix) ¨¬¥¥² ¢ ²®·­®±²¨ ®¤­³ ¥¤¨­¨¶³ ¢ ª ¦¤®© ±²°®ª¥ ¨ ª ¦¤®¬ ±²®«¡¶¥; ­  ¢±¥µ ¯°®·¨µ ¬¥±² µ ³ ­¥¥ ±²®¿² ­³«¨. °¨¬¥° ¬ ²°¨¶» ¯¥°¥±² ­®¢ª¨:
0
1
0 1 0 0 0
B0 0 0 1 0C
B
C
C
P =B
B1 0 0 0 0C :
@0 0 0 0 1A
0 0 1 0 0
¬­®¦¥­¨¥ ¢¥ª²®°  x ­  ¬ ²°¨¶³ ¯¥°¥±² ­®¢ª¨ ¯°¨¢®¤¨² ª ¯¥°¥±² ­®¢ª¥ ¥£® ½«¥¬¥­²®¢.
7. ¨¬¬¥²°¨·¥±ª ¿ ¬ ²°¨¶  (symmetric matrix) ³¤®¢«¥²¢®°¿¥²
³±«®¢¨¾ A = AT .  ¯°¨¬¥°, ¬ ²°¨¶ 
0
1
1 2 3
A = @2 6 4A
3 4 5
¿¢«¿¥²±¿ ±¨¬¬¥²°¨·¥±ª®©.
¥©±²¢¨¿ ± ¬ ²°¨¶ ¬¨.
«¥¬¥­² ¬¨ ¬ ²°¨¶» ¨«¨ ¢¥ª²®°  ±«³¦ ² ½«¥¬¥­²» ­¥ª®²®°®© ·¨±«®¢®© ±¨±²¥¬» (¤¥©±²¢¨²¥«¼­»¥ ·¨±« , ª®¬¯«¥ª±­»¥ ·¨±« ,
®±² ²ª¨ ¯® ¬®¤³«¾ ¯°®±²®£® ·¨±« ). ¯¥° ¶¨¨ ±«®¦¥­¨¿ ¨ ³¬­®¦¥­¨¿ ¢ ½²®© ·¨±«®¢®© ±¨±²¥¬¥ ¬®¦­® ° ±¯°®±²° ­¨²¼ ­  ¬ ²°¨¶»
± ½«¥¬¥­² ¬¨ ¨§ ­¥¥.
¯°¥¤¥«¨¬ ±«®¦¥­¨¥ ¬ ²°¨¶ (matrix addition) ±«¥¤³¾¹¨¬ ®¡° §®¬. ³±²¼ ¤ ­» (m  n)-¬ ²°¨¶» A = (aij ) ¨ B = (bij ).  §®¢¥¬
¨µ ±³¬¬®© (m  n)-¬ ²°¨¶³ C = (cij ) = A + B ± ½«¥¬¥­² ¬¨
cij = aij + bij ;
£¤¥ i = 1; 2; : : : ; m ¨ j = 1; 2; : : : ; n. °³£¨¬¨ ±«®¢ ¬¨, ±«®¦¥­¨¥
¬ ²°¨¶ ®±³¹¥±²¢«¿¥²±¿ ¯®ª®¬¯®­¥­²­®. ³«¥¢ ¿ ¬ ²°¨¶  ¿¢«¿¥²±¿
­¥©²° «¼­»¬ ½«¥¬¥­²®¬ ¤«¿ ®¯¥° ¶¨¨ ±«®¦¥­¨¿ ¬ ²°¨¶:
A+0 = A
= 0+A
³±²¼  { ·¨±«®,   A = (aij ) | ¬ ²°¨¶ . ®¦­® ³¬­®¦¨²¼ ¬ ²°¨¶³ A ­  ·¨±«® , ³¬­®¦¨¢ ª ¦¤»© ½«¥¬¥­² A ­  . ¥§³«¼² ²
³¬­®¦¥­¨¿ {¬ ²°¨¶  A = (aij ) (scalar multiple of A). ±®¡® ®²¬¥²¨¬ ¬ ²°¨¶³ ;A = (;1)  A, ­ §»¢ ¥¬³¾ ¯°®²¨¢®¯®«®¦­®© ª
A ¬ ²°¨¶¥© (negative of a matrix A). «¥¬¥­² ± ¨­¤¥ª± ¬¨ ij ¢ ¬ ²°¨¶¥ ;A ° ¢¥­ ;aij , ¯®½²®¬³
A + (;A) = 0
= (;A) + A

 ²°¨¶» ¨ ¨µ ±¢®©±²¢ 

669

»·¨² ­¨¥ ¬ ²°¨¶» (matrix subtraction) ¬» ²¥¯¥°¼ ¬®¦¥¬ ®¯°¥¤¥«¨²¼ ª ª ¯°¨¡ ¢«¥­¨¥ ¯°®²¨¢®¯®«®¦­®© ¬ ²°¨¶»: A ; B = A +
(;B ).
¬­®¦¥­¨¥ ¬ ²°¨¶» A ­  ¬ ²°¨¶³ B (matrix multiplication) ®±³¹¥±²¢¨¬®, «¨¸¼ ¥±«¨ ®­¨ ¨¬¥¾² ±®£« ±®¢ ­­»¥ ° §¬¥°», ²® ¥±²¼
·¨±«® ±²®«¡¶®¢ A ±®¢¯ ¤ ¥² ± ·¨±«®¬ ±²°®ª B . ( ¯¨±¼ AB ¯®¤° §³¬¥¢ ¥², ·²® ¬ ²°¨¶» A ¨ B ¨¬¥¾² ±®£« ±®¢ ­­»¥ ° §¬¥°».)
±«¨ A = (aij ) | (m  n)-¬ ²°¨¶ ,   B = (bij ) | (n  p)-¬ ²°¨¶ , ²®
¨µ ¯°®¨§¢¥¤¥­¨¥¬ C = AB ­ §»¢ ¥²±¿ (m  p)-¬ ²°¨¶  C = (cij ),
¢ ª®²®°®©
n
X
cik = aij bjk
(31:3)
j =1

¤«¿ i = 1; 2; : : : ; m ¨ k = 1; 2; : : : ; p. ¬¥­­® ½²³ ´®°¬³«³ °¥ «¨§³¥²
¯°®¶¥¤³°  Matrix-Multiply ¨§ ° §¤¥«  26.1, ³¬­®¦ ¾¹ ¿ ª¢ ¤° ²­»¥ ¬ ²°¨¶» (m = n = p). ²®¡» ¢»·¨±«¨²¼ ¯°®¨§¢¥¤¥­¨¥
¤¢³µ (n  n) ¬ ²°¨¶, Matrix-Multiply ¢»¯®«­¿¥² n3 ³¬­®¦¥­¨©
¨ n2 (n ; 1) ±«®¦¥­¨©, ² ª ·²® ¢°¥¬¿ ¥¥ ° ¡®²» ¥±²¼ (n3 ).
 ²°¨¶» ®¡« ¤ ¾² ¬­®£¨¬¨ (µ®²¿ ¨ ­¥ ¢±¥¬¨) ±¢®©±²¢ ¬¨ ·¨±¥«.
¤¨­¨·­ ¿ ¬ ²°¨¶  ¿¢«¿¥²±¿ ­¥©²° «¼­»¬ ½«¥¬¥­²®¬ ¤«¿ ³¬­®¦¥­¨¿: ¤«¿ «¾¡®© (m  n)-¬ ²°¨¶» A:

Im A = AIn = A
¬­®¦¥­¨¥ ­  ­³«¥¢³¾ ¬ ²°¨¶³ ¤ ¥² ­³«¥¢³¾ ¬ ²°¨¶³:

A0 = 0:
¬­®¦¥­¨¥ ¬ ²°¨¶  ±±®¶¨ ²¨¢­®:

A(BC ) = (AB)C
(31:4)
¤«¿ «¾¡»µ ¬ ²°¨¶ A, B ¨ C ±®£« ±®¢ ­­»µ ° §¬¥°®¢. ¬­®¦¥­¨¥
¬ ²°¨¶ ¤¨±²°¨¡³²¨¢­® ®²­®±¨²¥«¼­® ±«®¦¥­¨¿:

A(B + C ) = AB + AC
(B + C )D = BD + CD

(31:5)

°¨ n 6= 1 ³¬­®¦¥­¨¥ n n ¬ ²°¨¶,
¢®®¡¹¥

 £®¢®°¿,
 ­¥ ª®¬¬³² 0
1
0
0
²¨¢­®.  ¯°¬¥°, ¤«¿ A = 0 0 ¨ B = 0 1 ¨¬¥¥¬

AB =
­®

BA =



1 0 ;
0 0





0 0 :
0 1



670

« ¢  31  ²°¨¶» ¨ ¤¥©±²¢¨¿ ± ­¨¬¨

·¨² ¿ ¢¥ª²®°-±²®«¡¥¶ (n  1)-¬ ²°¨¶¥©,   ¢¥ª²®°-±²°®ª³ | (1 
n)-¬ ²°¨¶³, ¬» ¬®¦¥¬ ¯¥°¥¬­®¦ ²¼ ¢¥ª²®°» ¨ ¬ ²°¨¶». ±«¨ A
| mn ¬ ²°¨¶ ,   x | ¢¥ª²®° ¨§ n ª®¬¯®­¥­², ²® ¯°®¨§¢¥¤¥­¨¥ Ax
¥±²¼ ¢¥ª²®° ¨§ m ª®¬¯®­¥­². ±«¨ x ¨ y { ¢¥ª²®°» ¨§ n ª®¬¯®­¥­²,
²® ¯°®¨§¢¥¤¥­¨¥

xT y =

n
X
i=1

xi yi

¯°¥¤±² ¢«¿¥² ±®¡®© ·¨±«® ((1  1);¬ ²°¨¶³), ­ §»¢ ¥¬®¥ ±ª «¿°­»¬ ¯°®¨§¢¥¤¥­¨¥¬ (inner product) x ¨ y .  ²°¨¶  Z = xy T ° §¬¥° 
n  n c ½«¥¬¥­² ¬¨ zij = xi zj ­ §»¢ ¥²±¿ ²¥­§®°­»¬ ¯°®¨§¢¥¤¥­¨¥¬ (outer product) ½²¨µ ¦¥ ¢¥ª²®°®¢. ¢ª«¨¤®¢  ­®°¬  (euclidean
norm) kxk ¢¥ª²®°  x ®¯°¥¤¥«¿¥²±¿ ° ¢¥­±²¢®¬

kxk = (x21 + x22 +    + x2n)1=2
= (xT x)1=2:
®°¬  ¢¥ª²®°  x | ½²® ¥£® ¤«¨­  ¢ n-¬¥°­®¬ ¥¢ª«¨¤®¢®¬ ¯°®-

±²° ­±²¢¥.
¡° ²­ ¿ ¬ ²°¨¶ , ° ­£ ¨ ¤¥²¥°¬¨­ ­².
 ²°¨¶¥©, ®¡° ²­®© ª (n  n);¬ ²°¨¶¥ A (inverse of A) ­ §»¢ ¥²±¿ ¬ ²°¨¶  A;1 , ¤«¿ ª®²®°®© AA;1 = In = A;1 A. (¥±«¨ ² ª®¢ ¿
±³¹¥±²¢³¥²).  ¯°¨¬¥°,



1 1 ;1 = 0 1 :
1 0
1 ;1



­®£¨¥ ­¥­³«¥¢»¥ n  n ¬ ²°¨¶» ­¥ ¨¬¥¾² ®¡° ²­»µ.  ²°¨¶»,
­¥ ¨¬¥¾¹¨¥ ®¡° ²­»µ, ­ §»¢ ¾²±¿ ­¥®¡° ²¨¬»¬¨ (noninvertible)
¨«¨ ¢»°®¦¤¥­­»¬¨ (singular). °¨¬¥° ­¥­³«¥¢®© ¢»°®¦¤¥­­®© ¬ ²°¨¶»:


1 0 :
1 0
 ²°¨¶ , ¨¬¥¾¹ ¿ ®¡° ²­³¾, ­ §»¢ ¥²±¿ ®¡° ²¨¬®© (invertible)
¨«¨ ­¥¢»°®¦¤¥­­®© (nonsingular). ±«¨ ®¡° ²­ ¿ ¬ ²°¨¶  ±³¹¥±²¢³¥², ²® ®­  ¥¤¨­±²¢¥­­  (±¬.³¯° ¦­¥­¨¥ 31.1-4). ±«¨ n  n ¬ ²°¨¶» A ¨ B ®¡° ²¨¬», ²®
(BA);1 = A;1 B ;1 :

(36:1)

¯¥° ¶¨¿ ®¡° ¹¥­¨¿ ¬ ²°¨¶» ¯¥°¥±² ­®¢®·­  ± ®¯¥° ¶¨¥© ²° ­±¯®­¨°®¢ ­¨¿:
; ;1 T
;

A
= AT ;1 :
®¢®°¿², ·²® ¢¥ª²®°» x1 ; x2; : : : ; xn «¨­¥©­® § ¢¨±¨¬» (linearly
dependent), ¥±«¨ ­ ©¤¥²±¿ ­ ¡®° ª®½´´¨¶¨¥­²®¢ c1 ; c2; : : : ; cn, ­¥

 ²°¨¶» ¨ ¨µ ±¢®©±²¢ 

671

¢±¥ ¨§ ª®²®°»µ ° ¢­»; ­³«¾, ¤«¿
ª®²®°®£®c1x1 +;c2 x2 +  + cn xn = 0.
 ;
 ¯°¨¬¥°, ¢¥ª²®°» 1 2 3 T , 2 6 4 T , ¨ 4 11 9 T § ¢¨±¨¬», ¯®±ª®«¼ª³ 2x1 +3x2 ; 2x3 = 0. ¥ª²®°», ­¥ ¿¢«¿¾¹¨¥±¿ «¨­¥©­®
§ ¢¨±¨¬»¬¨, ­ §»¢ ¾²±¿ «¨­¥©­® ­¥§ ¢¨±¨¬»¬¨ (linearly independent).  ª®¢», ­ ¯°¨¬¥°, ±²®«¡¶» ¥¤¨­¨·­®© ¬ ²°¨¶».
²®«¡¶®¢»¬ ° ­£®¬ (column rank) ­¥­³«¥¢®© m  n-¬ ²°¨¶» A
­ §»¢ ¥²±¿ ­ ¨¡®«¼¸¥¥ ·¨±«® «¨­¥©­® ­¥§ ¢¨±¨¬»µ ±²®«¡¶®¢ A.
²°®·­»¬ ° ­£®¬ (row rank) ­ §»¢ ¥²±¿ ­ ¨¡®«¼¸¥¥ ·¨±«® «¨­¥©­® ­¥§ ¢¨±¨¬»µ ±²°®ª. «¿ «¾¡®© ¬ ²°¨¶» A ½²¨ ¤¢  ·¨±«  ° ­£®¢
±®¢¯ ¤ ¾², ² ª ·²® ¨µ ®¡¹¥¥ §­ ·¥­¨¥ ­ §»¢ ¥²±¿ ¯°®±²® ° ­£®¬
(rank) A.  ­£ (m  n)-¬ ²°¨¶» ¯°¥¤±² ¢«¿¥² ±®¡®© ¶¥«®¥ ·¨±«® ¢
¯°¥¤¥« µ ®² 0 ¤® min(n; m). ( ­£ ­³«¥¢®© ¬ ²°¨¶» ° ¢¥­ 0,   ° ­£
¥¤¨­¨·­®© ¬ ²°¨¶» In ° ¢¥­ n.) °¨¢¥¤¥¬ ½ª¢¨¢ «¥­²­®¥ ®¯°¥¤¥«¥­¨¥, ¨­®£¤  ¡®«¥¥ ³¤®¡­®¥: ° ­£®¬ ­¥­³«¥¢®© (m  n)-¬ ²°¨¶» A
­ §»¢ ¥²±¿ ­ ¨¬¥­¼¸¥¥ ·¨±«® r, ¤«¿ ª®²®°®£® ­ ©¤³²±¿ ¬ ²°¨¶»
B ¨ C ° §¬¥°®¢ m  r ¨ r  n ±®®²¢¥²±²¢¥­­®, ¤«¿ ª®²®°»µ

A = BC:
¢ ¤° ²­ ¿ n  n ¬ ²°¨¶  ° ­£  n ­ §»¢ ¥²±¿ ¬ ²°¨¶¥© ¯®«­®£®

° ­£  (has full rank). ±­®¢­®¥ ±¢®©±²¢® ° ­£®¢ ² ª®¢®:
¥®°¥¬  31.1
¢ ¤° ²­ ¿ ¬ ²°¨¶  ¨¬¥¥² ¯®«­»© ° ­£ ²®£¤  ¨ ²®«¼ª® ²®£¤ ,
ª®£¤  ®­  ­¥¢»°®¦¤¥­ .
 ²°¨¶  ° §¬¥°  m  n, ¨¬¥¾¹ ¿ ° ­£ n, ­ §»¢ ¥²±¿ ¬ ²°¨¶¥©
¯®«­®£® ±²®«¡¶®¢®£® ° ­£  (has full column rank).
¥­³«¥¢®© ¢¥ª²®° x, ¤«¿ ª®²®°®£® Ax = 0, ­ §»¢ ¥²±¿  ­­³«¨°³¾¹¨¬ ¢¥ª²®°®¬ (null vector) ¬ ²°¨¶» A. «¥¤³¾¹ ¿ ²¥®°¥¬  (¤®ª § ²¥«¼±²¢® ª®²®°®© ®±² ¢«¿¥²±¿ ·¨² ²¥«¾ ¢ ª ·¥±²¢¥ ³¯°. 31.18) ¨ ¥¥ ±«¥¤±²¢¨¥ ³±² ­ ¢«¨¢ ¾² ±¢¿§¼ ¬¥¦¤³ ±³¹¥±²¢®¢ ­¨¥¬  ­­³«¨°³¾¹¥£® ¢¥ª²®° , ¢»°®¦¤¥­­®±²¼¾ ¨ ¢¥«¨·¨­®© ±²®«¡¶®¢®£®
° ­£ .
¥®°¥¬  31.2
 ²°¨¶  ¨¬¥¥² ¯®«­»© ±²®«¡¶®¢»© ° ­£ ²®£¤  ¨ ²®«¼ª® ²®£¤ ,
ª®£¤  ¤«¿ ­¥¥ ­¥ ±³¹¥±²¢³¥²  ­­³«¨°³¾¹¥£® ¢¥ª²®° .
«¥¤±²¢¨¥ 31.3
¢ ¤° ²­ ¿ ¬ ²°¨¶  ¢»°®¦¤¥­  ²®£¤  ¨ ²®«¼ª® ²®£¤ , ª®£¤  ¤«¿
­¥¥ ­ ©¤¥²±¿  ­­³«¨°³¾¹¨© ¢¥ª²®°.
¨­®°®¬ ½«¥¬¥­²  aij ¬ ²°¨¶» A ° §¬¥°  n  n (ij th minor) ­ §»¢ ¥²±¿ (n ; 1)  (n ; 1)-¬ ²°¨¶  A[ij ] , ¯®«³· ¥¬ ¿ ¢»·¥°ª¨¢ ­¨¥¬
i;© ±²°®ª¨ ¨ j ;£® ±²®«¡¶  ¢ ¬ ²°¨¶¥ A. ¥¯¥°¼ ®¯°¥¤¥«¨²¥«¼ (determinant) ¬ ²°¨¶» A § ¤ ¥²±¿ ² ª®© °¥ª³°±¨¢­®© ´®°¬³«®©:
8
<

a11
¥±«¨ n = 1;
det(A) = : a11 det(A[ij ] ) ; a12 det(A[12])+
+    + (;1)n+1 a1n det(A[1n]) ¥±«¨ n > 1:

672

« ¢  31  ²°¨¶» ¨ ¤¥©±²¢¨¿ ± ­¨¬¨

­®¦¨²¥«¼ (;1)i+j det(A[ij ] ) ­ §»¢ ¥²±¿  «£¥¡° ¨·¥±ª¨¬ ¤®¯®«­¥­¨¥¬ (cofactor) ½«¥¬¥­²  aij .
«¥¤³¾¹¨¥ ¤¢¥ ²¥®°¥¬» (¤®ª § ²¥«¼±²¢  ¬» ®¯³±ª ¥¬) ³ª §»¢ ¾² ®±­®¢­»¥ ±¢®©±²¢  ®¯°¥¤¥«¨²¥«¿.
¥®°¥¬  31.4 (¢®©±²¢  ®¯°¥¤¥«¨²¥«¿)
¯°¥¤¥«¨²¥«¼ ª¢ ¤° ²­®© ¬ ²°¨¶» A ®¡« ¤ ¥² ±«¥¤³¾¹¨¬¨
±¢®©±²¢ ¬¨:
 ±«¨ ¢ ª ª®©-«¨¡® ±²°®ª¥ ¨«¨ ª ª®¬-«¨¡® ±²®«¡¶¥ ¬ ²°¨¶» ±²®¿² ®¤­¨ ­³«¨, ²® ¥¥ ®¯°¥¤¥«¨²¥«¼ ° ¢¥­ 0.
 ±«¨ ³¬­®¦¨²¼ ¢±¥ ½«¥¬¥­²» ª ª®©-«¨¡® ±²°®ª¨ ¬ ²°¨¶» ­ 
­¥ª®²®°®¥ ·¨±«® , ²® ¥¥ ®¯°¥¤¥«¨²¥«¼ ³¬­®¦¨²±¿ ­  .
 ±«¨ ¯°¨¡ ¢¨²¼ ª ½«¥¬¥­² ¬ ®¤­®© ±²°®ª¨ ±®®²¢¥²±²¢³¾¹¨¥
½«¥¬¥­²» ¤°³£®©, ²® ®¯°¥¤¥«¨²¥«¼ ­¥ ¨§¬¥­¨²±¿ ( ­ «®£¨·­®
¤«¿ ±²®«¡¶®¢).
 ¯°¥¤¥«¨²¥«¨ ¬ ²°¨¶ A ¨ AT ° ¢­».
 °¨ ¯¥°¥±² ­®¢ª¥ ¤¢³µ ±²°®ª ¨«¨ ±²®«¡¶®¢ ¬ ²°¨¶» ¥¥ ®¯°¥¤¥«¨²¥«¼ ¬¥­¿¥² §­ ª.
±«¨ A ¨ B | ª¢ ¤° ²­»¥ ¬ ²°¨¶» ®¤¨­ ª®¢®£® ° §¬¥° , ²®
det(AB ) = det(A) det(B ).
¥®°¥¬  31.5
¢ ¤° ²­ ¿ ¬ ²°¨¶  A ¢»°®¦¤¥­  ²®£¤  ¨ ²®«¼ª® ²®£¤ , ª®£¤ 
det(A) = 0.
®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­»¥ ¬ ²°¨¶»
 ²°¨¶  A ° §¬¥°  n  n ­ §»¢ ¥²±¿ ¯®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­®© (positive-denite), ¥±«¨ xT Ax > 0 ¤«¿ «¾¡®£® ­¥­³«¥¢®£®
¢¥ª²®°  x ° §¬¥°  n.  ¯°¨¬¥°, ¥¤¨­¨·­ ¿ ¬ ²°¨¶  ¯®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­ , ¯®±ª®«¼ª³ ¤«¿ ¢¥ª²®°  x = (x1 ; x2; : : : ; xn )T 6= 0 ¬»
¨¬¥¥¬

xT In x = xT x
= kxk2
=

n
X
i=1

x2i

> 0:

 ±²® ¯®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­»¥ ¬ ²°¨¶» ¢®§­¨ª ¾² ² ª:
¥®°¥¬  31.6
«¿ «¾¡®© ¬ ²°¨¶» A ¯®«­®£® ±²®«¡¶®¢®£® ° ­£  ¬ ²°¨¶  AT A
¯®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­ .
®ª § ²¥«¼±²¢®.
®ª ¦¥¬, ·²® xT (AT A)x > 0 ¤«¿ ¯°®¨§¢®«¼­®£® ­¥­³«¥¢®£® ¢¥ª-

 ²°¨¶» ¨ ¨µ ±¢®©±²¢ 

²®°  x.  ± ¬®¬ ¤¥«¥,
xT (AT A)x = (Ax)T (Ax)(¯° ¦­¥­¨¥ 31.1-3)
= kAxk2
>0

673

(31:8)

»° ¦¥­¨¥ kAxk2 ¯°¥¤±² ¢«¿¥² ±®¡®© ±³¬¬³ ª¢ ¤° ²®¢ ½«¥¬¥­²®¢
¢¥ª²®°  Ax. ±«¨ kAxk2 = 0, ²® ¢±¥ ½«¥¬¥­²» ¢¥ª²®°  Ax ° ¢­»
0, ²® ¥±²¼ Ax = 0. ® A | ¬ ²°¨¶  ¯®«­®£® ±²®«¡¶®¢®£® ° ­£ ,
¯®½²®¬³ ¯® ²¥®°¥¬¥ 31.2 ®²±¾¤  ±«¥¤³¥², ·²® x = 0.
°³£¨¥ ±¢®©±²¢  ¯®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­»µ ¬ ²°¨¶ ³ª § ­»
° §¤¥«¥ 31.6.
¯° ¦­¥­¨¿
31.1-1
®ª ¦¨²¥, ·²® ¯°®¨§¢¥¤¥­¨¥ ¤¢³µ ­¨¦­¥-²°¥³£®«¼­»µ ¬ ²°¨¶
¿¢«¿¥²±¿ ­¨¦­¥-²°¥³£®«¼­®© ¬ ²°¨¶¥©. ®ª ¦¨²¥, ·²® ®¯°¥¤¥«¨²¥«¼ ­¨¦­¥- ¨«¨ ¢¥°µ­¥²°¥³£®«¼­®© ¬ ²°¨¶» ° ¢¥­ ¯°®¨§¢¥¤¥­¨¾
¥¥ ¤¨ £®­ «¼­»µ ½«¥¬¥­²®¢. ®ª ¦¨²¥, ·²® ¬ ²°¨¶ , ®¡° ²­ ¿ ª
­¨¦­¥-²°¥³£®«¼­®©, ± ¬  ¡³¤³² ­¨¦­¥-²°¥³£®«¼­®© (¥±«¨ ±³¹¥±²¢³¥²).
31.1-2
³±²¼ P ¨ A | (n  n) ¬ ²°¨¶», ¯°¨·¥¬ P | ¬ ²°¨¶  ¯¥°¥±² ­®¢ª¨. ®ª ¦¨²¥, ·²® ¬ ²°¨¶  PA ¯®«³· ¥²±¿ ¨§ A ¯¥°¥±² ­®¢ª®©
±²°®ª,   AP | ¯¥°¥±² ­®¢ª®© ±²®«¡¶®¢. ®ª ¦¨²¥, ·²® ¯°®¨§¢¥¤¥­¨¥ ¤¢³µ ¬ ²°¨¶ ¯¥°¥±² ­®¢ª¨ ±­®¢  ¡³¤¥² ¬ ²°¨¶¥© ¯¥°¥±² ­®¢ª¨. ®ª ¦¨²¥, ·²® ¥±«¨ P | ¬ ²°¨¶  ¯¥°¥±² ­®¢ª¨, ²® P ®¡° ²¨¬ , P ;1 = P T , ¨ P T ² ª¦¥ ¿¢«¿¥²±¿ ¬ ²°¨¶¥© ¯¥°¥±² ­®¢ª¨.
31.1-3
®ª ¦¨²¥, ·²® (AB )T = B T AT . ®ª ¦¨²¥, ·²® ¬ ²°¨¶  AT A
¿¢«¿¥²±¿ ±¨¬¬¥²°¨·¥±ª®© ¤«¿ «¾¡®© ¬ ²°¨¶» A.
31.1-4
®ª ¦¨²¥, ·²® ®¡° ²­ ¿ ¬ ²°¨¶  ¥¤¨­±²¢¥­­ : ¥±«¨ ¬ ²°¨¶» B
¨ C ¿¢«¿¾²±¿ ®¡° ²­»¬¨ ª ¬ ²°¨¶¥ A, ²® B = C .
31.1-5
³±²¼ ¤ ­» (n  n)-¬ ²°¨¶» A ¨ B , ¤«¿ ª®²®°»µ AB = I . ³±²¼
A0 ¯®«³· ¥²±¿ ¨§ A ¯°¨¡ ¢«¥­¨¥¬ j -© ±²°®ª¨ ª i-©. ®ª ¦¨²¥, ·²®
¬ ²°¨¶  B 0 , ®¡° ²­ ¿ ª A0 , ¬®¦¥² ¡»²¼ ¯®«³·¥­  ¢»·¨² ­¨¥¬ i-£®
±²®«¡¶  ¨§ j -£® ¢ ¬ ²°¨¶¥ B .
31.1-6
³±²¼ A | ª®¬¯«¥ª±­ ¿ (n  n)-¬ ²°¨¶ . ®ª ¦¨²¥, ·²® ¢±¥ ½«¥¬¥­²» A;1 ¡³¤³² ¢¥¹¥±²¢¥­­»¬¨ ¢ ²®¬ ¨ ²®«¼ª® ²®¬ ±«³· ¥, ¥±«¨
¢¥¹¥±²¢¥­­» ¢±¥ ½«¥¬¥­²» A.
31.1-7
®ª ¦¨²¥, ·²® ¥±«¨ ­¥¢»°®¦¤¥­­ ¿ ¬ ²°¨¶  A ¿¢«¿¥²±¿ ±¨¬¬¥²°¨·¥±ª®©, ²® ¬ ²°¨¶  A;1 ²®¦¥ ¡³¤¥² ±¨¬¬¥²°¨·¥±ª®©. ®ª ¦¨²¥, ·²® ¤«¿ ¢±¿ª®© ¬ ²°¨¶» B ­ ¤«¥¦ ¹¥£® ° §¬¥°  ¬ ²°¨¶ 

674

« ¢  31  ²°¨¶» ¨ ¤¥©±²¢¨¿ ± ­¨¬¨

BAB T ¡³¤¥² ±¨¬¬¥²°¨·¥±ª®©.

31.1-8
®ª ¦¨²¥, ·²® ¤«¿ ¬ ²°¨¶ ¯®«­®£® ±²®«¡¶®¢®£® ° ­£ , ¨ ²®«¼ª®
¤«¿ ­¨µ, ¨§ ° ¢¥­±²¢  Ax = 0 ±«¥¤³¥² ° ¢¥­±²¢® x = 0. (ª § ­¨¥.
 ¯¨¸¨²¥ ³±«®¢¨¥ «¨­¥©­®© § ¢¨±¨¬®±²¨ ±²®«¡¶®¢ ª ª ¬ ²°¨·­®¥
³° ¢­¥­¨¥.)
31.1-9
®ª ¦¨²¥, ·²® ¤«¿ «¾¡»µ ¬ ²°¨¶ A ¨ B ±®£« ±®¢ ­­»µ ° §¬¥°®¢
rank(AB) 6 min(rank(A); rank(B ));
¯°¨·¥¬ ½²® ­¥° ¢¥­±²¢® ®¡° ¹ ¥²±¿ ¢ ° ¢¥­±²¢®, ¥±«¨ ®¤­  ¨§
¬ ²°¨¶ ª¢ ¤° ²­ ¿ ¨ ­¥¢»°®¦¤¥­­ ¿, (ª § ­¨¥. ®±¯®«¼§³©²¥±¼
¢²®°»¬ ®¯°¥¤¥«¥­¨¥¬ ° ­£ .)
31.1-10
 ²°¨¶¥©  ­¤¥°¬®­¤  (Vandermonde matrix) ­ §»¢ ¥²±¿ ¬ ²°¨¶ 
0
1
1 x0 x20 : : : xn0 ;1
B1
x1 x21 : : : xn1 ;1 C
B
C
V (x0; x1; : : : ; xn;1 ) = B
:
. ..
.. . . . .. C
@ ..
.
.
. A
1 xn;1 x2n;1 : : : xnn;;11
®ª ¦¨²¥, ·²®
Y
det(V (x0 ; x1; : : : ; xn;1 )) =
(xk ; xj ):
06j 6k6n;1

(ª § ­¨¥. ®±«¥¤®¢ ²¥«¼­® ¯®« £ ¿ i = n;1; n;2; : : : ; 1 ¯°¨¡ ¢¼²¥
ª (i + 1)-¬³ ±²®«¡¶³ i-©, ³¬­®¦¥­­»© ­  (;x0),   § ²¥¬ ¯°¨¬¥­¨²¥
¨­¤³ª¶¨¾.)

31.2. «£®°¨²¬ ²° ±±¥­  ³¬­®¦¥­¨¿ ¬ ²°¨¶
 ½²®¬ ° §¤¥«¥ ¨§« £ ¥²±¿ ®²ª°»²»© ²° ±±¥­®¬ °¥ª³°±¨¢­»©
 «£®°¨²¬, ³¬­®¦ ¾¹¨© ¤¢¥ n  n ¬ ²°¨¶» §  ¢°¥¬¿ (nlg 7 ) =
O(n2:81). °¨ ¤®±² ²®·­® ¡®«¼¸¨µ n ®­ ° ¡®² ¥² ¡»±²°¥¥ ¯°®±²¥©¸¥£®  «£®°¨²¬  Matrix-Multiply ¨§ ° §¤¥«  26.1.
¡¹ ¿ ±µ¥¬   «£®°¨²¬ .
«£®°¨²¬ ²° ±±¥­  ¤¥©±²¢³¥² ¯® ¯°¨­¶¨¯³ À° §¤¥«¿© ¨ ¢« ±²¢³©Á. ³±²¼ ­³¦­® ¢»·¨±«¨²¼ ¯°®¨§¢¥¤¥­¨¥ ¤¢³µ (n  n)-¬ ²°¨¶
C = AB . °¥¤¯®«®¦¨¢, ·²® n ¿¢«¿¥²±¿ ²®·­®© ±²¥¯¥­¼¾ 2, ° §¤¥«¨¬ ª ¦¤³¾ ¨§ ¬ ²°¨¶ A,B ¨ C ­  4 ¡«®ª  ° §¬¥°  (n=2  n=2).
¥°¥¯¨¸¥¬ ° ¢¥­±²¢® C = AB ±«¥¤³¾¹¨¬ ®¡° §®¬:






r s = a b
l u
c d





e g
f h :

(31:9)

«£®°¨²¬ ²° ±±¥­  ³¬­®¦¥­¨¿ ¬ ²°¨¶

675

( ³¯°. 31.2-2 ¯°¥¤« £ ¥²±¿ ° ±±¬®²°¥²¼ ±«³· ©, ¢ ª®²®°®¬ n ­¥
¿¢«¿¥²±¿ ²®·­®© ±²¥¯¥­¼¾ 2.) «¿ ³¤®¡±²¢  ¯®¤¬ ²°¨¶» ¢ A ¨¤³²
¯®  «´ ¢¨²³ ¯®°¿¤ª¥ ±«¥¢  ­ ¯° ¢®,   ¯®¤¬ ²°¨¶» ¢ B | ±¢¥°µ³
¢­¨§, ¢ ±®®²¢¥²±²¢¨¨ ± ¯° ¢¨«®¬ ³¬­®¦¥­¨¿ ¬ ²°¨¶. ° ¢­¥­¨¥
(31.9) ° ±¯ ¤ ¥²±¿ ­  ·¥²»°¥ ³° ¢­¥­¨¿

r = ae + bf
s = as + bh
t = ce + df
u = cg + dh

(31:10)

T (n) = 8T (n=2) + (n2)

(31:14)

(31:11)
(31:12)
(31:13)
 ¦¤®¥ ¨§ ·¥²»°¥µ ³° ¢­¥­¨© ²°¥¡³¥² ¤¢³µ ³¬­®¦¥­¨© (n=2 
n=2);¬ ²°¨¶, ¯®±«¥ ·¥£® ¯°®¨§¢¥¤¥­¨¿ ±ª« ¤»¢ ¾²±¿.  ±±¬®²°¨¬
¥±²¥±²¢¥­­»© °¥ª³°±¨¢­»©  «£®°¨²¬, ¨±¯®«¼§³¾¹¨© ½²¨ ±®®²­®¸¥­¨¿. £® ¢°¥¬¿ ° ¡®²» T (n) (¤«¿ ¬ ²°¨¶ ° §¬¥°  n  n) ³¤®¢«¥²¢®°¿¥² ­¥° ¢¥­±²¢³
²±¾¤  T (n) = (n3 ), ­® ­¨·¥£® ­®¢®£® ¬» ­¥ ¯®«³·¨«¨, ² ª ª ª
±² ­¤ °²­»©  «£®°¨²¬ ³¬­®¦¥­¨¿ ¬ ²°¨¶ ¨¬¥¥² ( ±¨¬¯²®²¨·¥±ª¨) ²® ¦¥ ¢°¥¬¿ ° ¡®²».
²° ±±¥­ ¯°¨¤³¬ «, ª ª ±½ª®­®¬¨²¼ ®¤­® ³¬­®¦¥­¨¥ ¨ ®¡®©²¨±¼
«¨¸¼ 7 ³¬­®¦¥­¨¿¬¨ (n=2  n=2);¬ ²°¨¶ ¨ (n2 ) ®¯¥° ¶¨¿¬¨ ±«®¦¥­¨¿ ¨ ¢»·¨² ­¨¿ ·¨±¥« ¤«¿ ³¬­®¦¥­¨¿ (n  n)-¬ ²°¨¶. ¥ª³°°¥­²­®¥ ±®®²­®¸¥­¨¥ ²®£¤  ¯°¨­¨¬ ¥² ¢¨¤

T (n) = 7T (n=2) + (n2);

(31:15)

®²ª³¤ 

T (n) = (nlg 7)
= O(n2:81):
«£®°¨²¬ ²° ±±¥­  ³¬­®¦ ¥² ¤¢¥ (n  n)-¬ ²°¨¶» A ¨ B ² ª:
1.  ¦¤ ¿ ¨§ ¬ ²°¨¶ A ¨ B ° §¡¨¢ ¥²±¿ ­  4 ¡«®ª , ª ª ¢ (31.9).
2. ²°®¿²±¿ 14 ¬ ²°¨¶ A1; B1 ; A2; B2; : : : ; A7; B7. ° §¬¥°  (n=2 
n=2) (¤«¿ ·¥£® ­³¦­® (n2) ®¯¥° ¶¨© ±«®¦¥­¨¿/¢»·¨² ­¨¿ ·¨±¥«)

3. ¥ª³°±¨¢­® ¢»·¨±«¿¾²±¿ 7 ¯°®¨§¢¥¤¥­¨© ¬ ²°¨¶ ¬¥­¼¸¥£®
° §¬¥°  Pi = Ai Bi (i = 1; : : : ; 7).
4. »·¨±«¿¾²±¿ · ±²¨ r; s; t; u ¨±ª®¬®© ¬ ²°¨¶» C . ­¨ ¿¢«¿¾²±¿ «¨­¥©­»¬¨ ª®¬¡¨­ ¶¨¿¬¨ ¬ ²°¨¶ Pi ± ª®½´´¨¶¨¥­² ¬¨ ¨§
¬­®¦¥±²¢  f;1; 0; 1g, ¨ ¢»·¨±«¥­¨¥ ¨µ ²°¥¡³¥² (n2 ) ®¯¥° ¶¨© ±«®¦¥­¨¿/¢»·¨² ­¨¿ ·¨±¥«.
°¥¬¿ ° ¡®²» ½²®£®  «£®°¨²¬ , ®·¥¢¨¤­®, ³¤®¢«¥²¢®°¿¥² ±®®²­®¸¥­¨¾ (31.15). §«®¦¨¬ ²¥¯¥°¼ ®¯³¹¥­­»¥ ¤¥² «¨.

« ¢  31  ²°¨¶» ¨ ¤¥©±²¢¨¿ ± ­¨¬¨

676

 ª¨¥ ¦¥ ¬ ²°¨¶» ¬¥­¼¸¥£® ° §¬¥°  ­³¦­® ¯¥°¥¬­®¦ ²¼?
®²®»¥ ´®°¬³«» ¤«¿ P1 {P7 ¯°®¢¥°¨²¼ «¥£ª®, ²°³¤­¥¥ ¯®­¿²¼,
ª ª ¤® ­¨µ ¬®¦­® ¤®£ ¤ ²¼±¿. ®² ®¤¨­ ¨§ ¢®§¬®¦­»µ ¯³²¥©.
³¤¥¬ ¨±ª ²¼ ¯°®¨§¢¥¤¥­¨¿ Pi ±°¥¤¨ ¢»° ¦¥­¨© ¢¨¤ 

Pi = AiBi
= (i1a + i2b + i3 c + i4d)  (i1 e + i2 f + i3 g + i4h);

´®°¬³« 
­ ¡° ­ 
¬­®© ­¥
¢¯®«­¥
¢¥°­®

(31:16)
£¤¥ ª®½´´¨¶¨¥­²» ij ; ij ¯°¨­¨¬ ¾² §­ ·¥­¨¿ ;1; 0; 1. ®­¥·­®,
¬®¦­® ¨±ª ²¼ ´®°¬³«» ¤«¿ Pi ¨ ¢ ¡®«¥¥ ®¡¹¥¬ ¢¨¤¥, ­® ®ª §»¢ ¥²±¿, ·²® ½²®£® ³¦¥ ¤®±² ²®·­®.
¡° ²¨²¥ ¢­¨¬ ­¨¥, ·²® ¯®±«¥ ° ±ª°»²¨¿ ±ª®¡®ª ª³±ª¨ ¬ ²°¨¶»
A ¡³¤³² ±²®¿²¼ ±«¥¢  ¢ ¯®¯ °­»µ ¯°®¨§¢¥¤¥­¨¿µ,   ª³±ª¨ ¬ ²°¨¶»
B | ±¯° ¢ . ²® ¢ ¦­®, ¯®±ª®«¼ª³ ³¬­®¦¥­¨¥ ¬ ²°¨¶ ­¥ ª®¬¬³² ²¨¢­®.
«¿ ³¤®¡±²¢  ¬» ¡³¤¥¬ ¨§®¡° ¦ ²¼ «¨­¥©­³¾ ª®¬¡¨­ ¶¨¾ ¯®¯ °­»µ ¯°®¨§¢¥¤¥­¨© ª³±ª®¢ ¬ ²°¨¶ ¯°¨ ¯®¬®¹¨ (4  4)-¬ ²°¨¶»,
½«¥¬¥­² ¬¨ ª®²®°®© ±«³¦ ² ±®®²¢¥²±²¢³¾¹¨¥ ª®½´´¨¶¨¥­²» «¨­¥©­®© ª®¬¡¨­ ¶¨¨.  ¯°¨¬¥°, ° ¢¥­±²¢® (31.10) § ¯¨¸¥²±¿ ¢ ¢¨¤¥

r = ae + bf

0

+1
;
B 0
= a b c d B
@ 0
0

a

= b

c
d

e f
+ 
B +
B
@

 
0

g





0
+1
0
0

h1

C
C
A :


0
0
0
0

10 1

0 e
B C
0C
C Bf C
A
0 @g A
0 h

«¿ ª° ²ª®±²¨ ¬» § ¬¥­¿¥¬ +1 ­  +, 0 ­   ¨ ;1 ­  - ¨ ®¯³±ª ¥¬
¨¬¥­  ±²®«¡¶®¢ ¨ ±²°®ª.  ½²¨µ ²¥°¬¨­ µ ²°¨ ®±² «¼­»¥ ª®¬¯®-

«£®°¨²¬ ²° ±±¥­  ³¬­®¦¥­¨¿ ¬ ²°¨¶

677

­¥­²» °¥§³«¼²¨°³¾¹¥© ¬ ²°¨¶» C § ¯¨¸³²±¿ ² ª:

s = ag + bh
0
1
  + 
B   +C
C
=B
@  
 A;
   
t = ce + df
0
1
   
B
  C
C
=B
@+   A ;
 +  
u = cg + dh
0
1
   
B  
C
C
=B
@  +  A :
   +
[¨¤­®, ·²® ­¨ ®¤­³ ¨§ ¬ ²°¨¶ s; t; u; v ­¥«¼§¿ ¢»·¨±«¨²¼ §  ®¤­® ³¬­®¦¥­¨¥ ¯® ´®°¬³«¥ (31.16) | ­³¦­® ¤¢ . ±«¨ ¤¥« ²¼ ½²®
­¥§ ¢¨±¨¬® ¤«¿ ª ¦¤®© ¨§ ·¥²»°¥µ ¬ ²°¨¶, ¯®²°¥¡³¥²±¿ 8 ³¬­®¦¥­¨©. ¤­ ª®, ª ª ¬» ³¢¨¤¨¬, ®¤­® ³¬­®¦¥­¨¥ ¬®¦­® ±½ª®­®¬¨²¼,
¨±¯®«¼§³¿ ®¤­¨ ¨ ²¥ ¦¥ ¯°®¨§¢¥¤¥­¨¿ ¤«¿ ­¥±ª®«¼ª¨µ ¬ ²°¨¶.]
 ·­¥¬ ±® ±«¥¤³¾¹¥£® ­ ¡«¾¤¥­¨¿: s ¬®¦­® ¢»·¨±«¨²¼ ª ª s =
P1 + P2, £¤¥ ª ¦¤ ¿ ¨§ ¬ ²°¨¶ P1 ¨ P2 ²°¥¡³¥² ®¤­®£® ³¬­®¦¥­¨¿:

P1 = A1 B1
= a  (g ; h)
= ag ; ah
0
1
  + ;
B  
C
C
=B
@  
 A:
   
P2 = A2 B2
= (a + b)  h
= ah + bh
0
1
   +
B   +C
C
=B
@    A :
   
­ «®£¨·­»¬ ®¡° §®¬ ¬®¦­® ¢»·¨±«¨²¼ t. ¬¥­­®, t = P3 + P4 ,

678

« ¢  31  ²°¨¶» ¨ ¤¥©±²¢¨¿ ± ­¨¬¨

£¤¥

P3 = A3B3
= (c + d)  e
= ce + de
0
  
B  
=B
@+  
+  


C
C
A ;


P4 = A4 B4
= d  (f ; e)
= df ; de
0
  
B
 
=B
@
 
; + 


C
C
A :


1

¨

1

² ª, ¬» ¨§° ±µ®¤®¢ «¨ ·¥²»°¥ ³¬­®¦¥­¨¿ ­  ¢»·¨±«¥­¨¥ ¬ ²°¨¶
s ¨ t | ¯®ª  ·²® ­¨ª ª®© ½ª®­®¬¨¨ ¯® ±° ¢­¥­¨¾ ± ®·¥¢¨¤­»¬
¯®°¿¤ª®¬ ¤¥©±²¢¨©. ¤­ ª® ¯® µ®¤³ ¤¥«  ¬» ¢»·¨±«¨«¨ ¯°®¨§¢¥¤¥­¨¿, ª®²®°»¥ ­ ¬ ¥¹¥ ¯°¨£®¤¿²±¿.
 ¦¤®¥ ¨§ ¢®±¼¬¨ ±« £ ¥¬»µ, ¢±²°¥· ¾¹¨µ±¿ ¢ ¯° ¢®© · ±²¨
° ¢¥­±²¢ (31.10){(31.13) ¡³¤¥¬ ­ §»¢ ²¼ ±³¹¥±²¢¥­­»¬. ¦¥ ¢»·¨±«¥­­»¥ ¤¢¥ ¬ ²°¨¶» s ¨ t ±®¤¥°¦ ² 4 ±³¹¥±²¢¥­­»µ ·«¥­  ag ,
bh, ce ¨ df . ±² ¥²±¿ ¢»·¨±«¨²¼ r ¨ u; ®­¨ ¢ª«¾· ¾² ¢ ±¥¡¿ 4
±³¹¥±²¢¥­­»µ ±« £ ¥¬»µ ae, bf , cg ¨ dh, ª®²®°»¥ ±®®²¢¥²±²¢³¾²
¤¨ £®­ «¼­»¬ ¯®§¨¶¨¿¬ (4  4);¬ ²°¨¶»), ±¤¥« ¢ ­¥ ¡®«¥¥ ²°¥µ
³¬­®¦¥­¨©. ¥¬ ± ¬»¬ ®¤­® ³¬­®¦¥­¨¥ ¤®«¦­® ®µ¢ ²»¢ ²¼ ¤¢ 
±³¹¥±²¢¥­­»µ ±« £ ¥¬»µ. ®¯°®¡³¥¬ ² ª:

P5 = A5 B5
= (a + d)  (e + h)
= ae + ah + de + dh
0
1
+   +
B   C
C
=B
@     A:
+   +
®¬¨¬® ¤¢³µ ­³¦­»µ ­ ¬ ±« £ ¥¬»µ ae ¨ dh ¨¬¥¾²±¿ ¤¢  «¨¸­¨µ:
ah ¨ de. ­¨·²®¦¨¬ ¨µ ± ¯®¬®¹¼¾ P4 ¨ P2, ¯°¨ ½²®¬ ¯®¿¢¿²±¿ ¤¢ 

«£®°¨²¬ ²° ±±¥­  ³¬­®¦¥­¨¿ ¬ ²°¨¶

¤°³£¨µ:

679

P5 + P4 ; P2 = ae + dh + df ; bh
0
1
+   
B
  ;C
C
=B
@
   A:
 +  +

±¯®«¼§®¢ ¢ ¥¹¥ ®¤­® ¯°®¨§¢¥¤¥­¨¥
P6 = A6 B6
= (b ; d)  (f + h)
= bf + bh ; df ; dh
0

¯®«³·¨¬


B
=B
@


 
+ 
 
; 



1

+C
C;

A
;

r = P5 + P4 ; P2 + P6
= ae + bf
0
1
+   
B  +  C
C
=B
@
  A :
   

² ª, ­  ²°¨ ¬ ²°¨¶» ³¸«® 6 ³¬­®¦¥­¨© | ·²® ¦¥ ¢ ½²®¬ µ®°®¸¥£®?  ¢²® ·²®: ¯°¨ ±¨¬¬¥²°¨·­®¬ ¢»·¨±«¥­¨¨ u ¬» ±­®¢ 
¨±¯®«¼§³¥¬ P5 ¨ ®¤­® ³¬­®¦¥­¨¥ ±½ª®­®¬¨¬. «¿ ±­ · «  ±¬¥±²¨¬
«¨¸­¨¥ ±« £ ¥¬»¥ ¢ P5 ¢ ¤°³£®¬ ­ ¯° ¢«¥­¨¨ ¯°¨ ¯®¬®¹¨ P1 ¨ P3 :
P5 + P1 ; P3 = ae + ag ; ce + dh
0
1
+  + 
B  
C
C
=B
@;  
 A:
   +
»·¨² ¿ ¤®¯®«­¨²¥«¼­®¥ ¯°®¨§¢¥¤¥­¨¥
P7 = A7B7
= (a ; c)  (e + g )
= ae + ag ; ce ; cg
0
1
+  + 
B    C
C
=B
@;  ; A ;

   

680

« ¢  31  ²°¨¶» ¨ ¤¥©±²¢¨¿ ± ­¨¬¨

¯®«³· ¥¬

u = P5 + P1 ; P3 ; P7
= cg + dh
0
1
   
B  
C
C
=B
@  +  A :
   +
» ¢¨¤¨¬, ·²® 7 ¬ ²°¨¶ P1 ; P2; : : : ; P7 ¯®§¢®«¿¾² ¯®«­®±²¼¾ ¢»·¨±«¨²¼ ¯°¨§¢¥¤¥­¨¥ C = AB , ·²® § ¢¥°¸ ¥² ®¯¨± ­¨¥  «£®°¨²¬ 

²° ±±¥­ .
¡±³¦¤¥­¨¥
  ¯° ª²¨ª¥  «£®°¨²¬ ²° ±±¥­  ¯°¨¬¥­¿¥²±¿ °¥¤ª® ¨§-§  ¡®«¼¸®© ¢¥«¨·¨­» ª®­±² ­²», ±®¤¥°¦ ¹¥©±¿ ¢  ±¨¬¯²®²¨·¥±ª®¬ ¢»° ¦¥­¨¨ ¤«¿ ¢°¥¬¥­¨ ¥£® ° ¡®²». °¨¬¥­¥­¨¥ ¥£® ®¯° ¢¤ ­® ¤«¿
¯«®²­»µ (±®¤¥°¦ ¹¨µ ¬ «® ­³«¥©) ¬ ²°¨¶ ¤®±² ²®·­® ¡®«¼¸®£®
° §¬¥°  (¯°¨¬¥°­® ®² 45  45). ¥¡®«¼¸¨¥ ¬ ²°¨¶» ¯°®¹¥ ¢±¥£® ¯¥°¥¬­®¦ ²¼ ®¡»·­»¬ ±¯®±®¡®¬,   ¤«¿ ¡®«¼¸¨µ ° §°¥¦¥­­»µ
(±®¤¥°¦ ¹¨µ ¬­®£® ­³«¥©) ¬ ²°¨¶ ±³¹¥±²¢³¾² ±¯¥¶¨ «¼­»¥  «£®°¨²¬», ­  ¯° ª²¨ª¥ ° ¡®² ¾¹¨¥ ¡»±²°¥¥ ¸²° ±±¥­®¢±ª®£®. ¥²®¤
²° ±±¥­ , ² ª¨¬ ®¡° §®¬, ¯°¥¤±² ¢«¿¥² ¨­²¥°¥± ¢ ®±­®¢­®¬ ± ²¥®°¥²¨·¥±ª®© ²®·ª¨ §°¥­¨¿.
¹¥ ¡®«¥¥ ±«®¦­»¥ ¬¥²®¤» (° ±±¬®²°¥­¨¥ ª®²®°»µ ¢»µ®¤¨² § 
° ¬ª¨ ½²®© ª­¨£¨) ¯®§¢®«¿¾² ¯¥°¥¬­®¦¨²¼ ¤¢¥ (n  n);¬ ²°¨¶»
¥¹¥ ¡»±²°¥¥.  ¨«³·¸ ¿ ¨§¢¥±²­ ¿ ®¶¥­ª  ±®±² ¢«¿¥² ¯°¨¡«¨§¨²¥«¼­® O(n2:376). ²® ª ± ¥²±¿ ­¨¦­¨µ ®¶¥­®ª, ²® ­¥ ¨§¢¥±²­®
­¨·¥£®, ª°®¬¥ ²°¨¢¨ «¼­®© ®¶¥­ª¨ 
(n2) (¯® ·¨±«¨³ ½«¥¬¥­²®¢
¬ ²°¨¶»-°¥§³«¼² ² ), ² ª ·²® ° §°»¢ ¬¥¦¤³ ­¨¦­¨¬¨ ¨ ¢¥°µ­¨¬¨
®¶¥­ª ¬¨ ¯®-¯°¥¦­¥¬³ ¢¥«¨ª.
«¿ ¯°¨¬¥­¥­¨¿  «£®°¨²¬  ²° ±±¥­  ­¥ ®¡¿§ ²¥«¼­®, ·²®¡»
½«¥¬¥­² ¬¨ ¬ ²°¨¶ ¡»«¨ ¢¥¹¥±²¢¥­­»¥ ·¨±« .  ¦­®, ·²®¡» ·¨±«®¢ ¿ ±¨±²¥¬ , ª®²®°®© ®­¨ ¯°¨­ ¤«¥¦ ², ¿¢«¿« ±¼ ª®«¼¶®¬. ¤­ ª® ³¤ ¥²±¿ ¨±¯®«¼§®¢ ²¼ ¨¤¥¾ ²° ±±¥­  ¢ ­¥±ª®«¼ª® ¡®«¥¥ ®¡¹¥© ±¨²³ ¶¨¨; ¬» ° ±±¬®²°¨¬ ½²®² ¢®¯°®± ¢ ±«¥¤³¾¹¥¬ ° §¤¥«¥.
¯° ¦­¥­¨¿
31.2-1
±¯®«¼§³¿  «£®°¨²¬ ²° ±±¥­ , ¢»¯®«­¨²¥ ³¬­®¦¥­¨¥ ¬ ²°¨¶:




1 3
5 7



8 4 :
6 2

31.2-2
®¤¨´¨¶¨°³©²¥  «£®°¨²¬ ²° ±±¥­ , ­ ³·¨¢¸¨±¼ ¯¥°¥¬­®¦ ²¼
± ¥£® ¯®¬®¹¼¾ (n  n);¬ ²°¨¶» §  ¢°¥¬¿ (nlg 7 ) ¯°¨ ¢±¥µ §­ ·¥­¨¿µ n, (  ­¥ ²®«¼ª® ¤«¿ ±²¥¯¥­¥© 2).

¡° ¹¥­¨¥ ¬ ²°¨¶

681

31.2-3
°¥¤±² ¢¨¬ ±¥¡¥, ·²® ¬» ³¬¥¥¬ ¯¥°¥¬­®¦ ²¼ ¤¢¥ (3  3)¬ ²°¨¶», ±¤¥« ¢ k ³¬­®¦¥­¨© (¯°¨ ½²®¬ ­¥ ¨±¯®«¼§³¿ ª®¬¬³² ²¨¢­®±²¨ ³¬­®¦¥­¨¿) ¨ ¨±¯®«¼§³¥¬ ½²®² ¯°¨¥¬ °¥ª³°±¨¢­® ¤«¿
³¬­®¦¥­¨¿ (n  n)-¬ ²°¨¶, ª ª ¢ ¬¥²®¤¥ ²° ±±¥­ . °¨ ª ª¨µ k ½²® ¯®§¢®«¨«® ¡» ³«³·¸¨²¼ ®¶¥­ª³ ²° ±±¥­  ¨ ³¬­®¦ ²¼
(n  n);¬ ²°¨¶» §  ¢°¥¬¿ o(nlg 7 ).  ª ¿ ®¶¥­ª  ¯°¨ ½²®¬ ¯®«³·¨« ±¼ ¡»?
31.2-4
..  ­ ¯°¨¤³¬ « ±¯®±®¡» ³¬­®¦¥­¨¿ ¤¢³µ ¬ ²°¨¶ ° §¬¥° 
68  68 (132464 ³¬­®¦¥­¨© ·¨±¥«), 70  70 (143640 ³¬­®¦¥­¨©) ¨
72  72 (155424 ³¬­®¦¥­¨©).  ª®© ¨§ ­¨µ ¤ ¥² «³·¸³¾  ±¨¬¯²®²¨·¥±ª³¾ ®¶¥­ª³ ¤«¿ ³¬­®¦¥­¨¨ (n  n)-¬ ²°¨¶ ¯°¨ ¨±¯®«¼§®¢ ­¨¨
¯°¨¥¬  À° §¤¥«¿© ¨ ¢« ±²¢³©Á? ° ¢­¨²¥ ½²³ ®¶¥­ª³ ± ®¶¥­ª®© ¤«¿
 «£®°¨²¬  ²° ±±¥­ .
31.2-5
 ±ª®«¼ª® ¡»±²°® ¬®¦­® ³¬­®¦¨²¼ (kn  n)-¬ ²°¨¶³ ­  (n  kn)¬ ²°¨¶³, ¨±¯®«¼§³¿  «£®°¨²¬ ²° ±±¥­  ¢ ª ·¥±²¢¥ ¯®¤¯°®£° ¬¬»?  ±ª®«¼ª® ¢°¥¬¥­¨ ³©¤¥² ­  ³¬­®¦¥­¨¥ ²¥µ ¦¥ ¬ ²°¨¶ ¢ ®¡° ²­®¬ ¯®°¿¤ª¥?
31.2-6
 ª ³¬­®¦¨²¼ ¤¢  ª®¬¯«¥ª±­»µ ·¨±«  a + bi ¨ c + di, ¨±¯®«¼§³¿
«¨¸¼ 3 ®¯¥° ¶¨¨ ³¬­®¦¥­¨¿ ¢¥¹¥±²¢¥­­»µ ·¨±¥«? («£®°¨²¬ ¤®«¦¥­ ¯®«³· ²¼ ­  ¢µ®¤ §­ ·¥­¨¿ a; b; c; d ¨ ¢»·¨±«¿²¼ ¢¥¹¥±²¢¥­­³¾
¨ ¬­¨¬³¾ · ±²¨ ¯°®¨§¢¥¤¥­¨¿, ²® ¥±²¼ ac ; bd ¨ ad + bc.)

31.3. ¡° ¹¥­¨¥ ¬ ²°¨¶
  ¯° ª²¨ª¥ °¥¸¥­¨¥ ±¨±²¥¬ «¨­¥©­»µ ³° ¢­¥­¨© ­¥ ²°¥¡³¥²
®¡° ¹¥­¨¿ ¬ ²°¨¶, ª ª ¬» ±¨¤¥«¨ ¢ ¯°¥»¤³¹¥¬ ° §¤¥«¥ (LUP° §«®¦¥­¨¥). ® ¢±¥-² ª¨ ¬®¦¥² ¯®­ ¤®¡¨²¼±¿ ¢»·¨±«¨²¼ ®¡° ²­³¾ ¬ ²°¨¶³, ¨ ²®£¤  ½²® ¬®¦­® ±¤¥« ²¼ ± ¯®¬®¹¼¾ ²®£® ¦¥ LUP° §«®¦¥­¨¿. ­²¥°¥± (±ª®°¥¥ ²¥®°¥²¨·¥±ª¨©, ¢¯°®·¥¬) ¯°¥¤±² ¢«¿¥² ² ª¦¥ ¢®¯°®± ® ²®¬, ª ª ³±ª®°¨²¼ ¯®¨±ª ¢»·¨±«¥­¨¥ ®¡° ²­®©
¬ ²°¨¶» ± ¯®¬®¼¾ ¬¥²®¤®¢ ²° ±±¥­ . (¬¥­­® ½²³ ¶¥«¼ ¯°¥±«¥¤®¢ « ²° ±±¥­ ¢ ±¢®¥© ° ¡®²¥.)
»·¨±«¥­¨¥ ®¡° ²­®© ¬ ²°¨¶» ± ¯®¬®¹¼¾ LUP-° §«®¦¥­¨¿.
³±²¼ ­ ¬ ¤ ­® LUP-° §«®¦¥­¨¥ PA = LU ¬ ²°¨¶» A ° §¬¥° 
(n  n). ­ ¿ ¥£®, ¬®¦­® °¥¸¨²¼ ±¨±²¥¬³ ¢¨¤  Ax = b ± ¯®¬®¹¼¾
¯°®¶¥¤³°» LU-Solve §  ¢°¥¬¿ (n2 ). ²®¡» °¥¸¨²¼ ¤°³£³¾ ±¨±²¥¬³ Ax = b0 (± ²®© ¦¥ ¬ ²°¨¶¥©, ­® ¤°³£®© ¯° ¢®© · ±²¼¾) ­ ¬
¯®­ ¤®¡¨²±¿ ¥¹¥ ±²®«¼ª® ¦¥ ¢°¥¬¥­¨.  ª¨¬ ®¡° §®¬, §­ ¿ LUP° §«®¦¥­¨¥ ¬ ²°¨¶» A, ¬®¦­® °¥¸¨²¼ k ±¨±²¥¬ ± ¬ ²°¨¶¥© A § 
¢°¥¬¿ (kn2 ).

682

« ¢  31  ²°¨¶» ¨ ¤¥©±²¢¨¿ ± ­¨¬¨

 ²°¨·­®¥ ³° ¢­¥­¨¥

AX = In

(31:24)
¤«¿ ®¡° ²­®© ¬ ²°¨¶» X ¬®¦­® ° ±±¬ ²°¨¢ ²¼ ª ª ±®¢®ª³¯­®±²¼
n ±¨±²¥¬ ¢¨¤  Ax = b. ¡®§­ ·¨¬ i-© ±²®«¡¥¶ ¬ ²°¨¶» X ·¥°¥§ Xi ;
²®£¤ 
AXi = ei ; i = 1; : : : ; n
¯®±ª®«¼ª³ i-¬ ±²®«¡¶®¬ ¬ ²°¨¶» In ¿¢«¿¥²±¿ ¥¤¨­¨·­»© ¢¥ª²®°
ei ). °³£¨¬¨ ±«®¢ ¬¨, ­ µ®¦¤¥­¨¥ ®¡° ²­®© ¬ ²°¨¶» ±¢®¤¨²±¿ ª
°¥¸¥­¨¾ n ³° ¢­¥­¨© ± ®¤­®© ¬ ²°¨¶¥© ¨ ° §­»¬¨ ¯° ¢»¬¨ · ±²¿¬¨. ®±«¥ ¢»¯®«­¥­¨¿ LUP -° §«®¦¥­¨¿ (¢°¥¬¿ O(n3 )) ­  °¥¸¥­¨¥
ª ¦¤®£® ¨§ n ³° ¢­¥­¨© ­³¦­® ¢°¥¬¿ O(n2), ² ª ·²® ¨ ½²  · ±²¼
° ¡®²» ²°¥¡³¥² ¢°¥¬¥­¨ O(n3).
¬­®¦¥­¨¥ ¨ ®¡° ¹¥­¨¥ ¬ ²°¨¶
¥¯¥°¼ ¬» ¯®ª ¦¥¬, ª ª¨¬ ®¡° §®¬ ¬®¦­® ¨±¯®«¼§®¢ ²¼ ¡»±²°»©  «£®°¨²¬ ³¬­®¦¥­¨¿ ¬ ²°¨¶ ¤«¿ ¡»±²°®£® ¢»·¨±«¥­¨¿
®¡° ²­®© ¬ ²°¨¶». (®¤·¥°ª­¥¬, ·²® ½²® ³«³·¸¥­¨¥ ¨¬¥¥² ±ª®°¥¥
²¥®°¥²¨·¥±ª¨© ¨­²¥°¥±.) » ¤®ª ¦¥¬, ·²® (¯°¨ ­¥ª®²®°»µ ¥±²¥±²¢¥­­»µ ¯°¥¤¯®«®¦¥­¨¿µ) ¢»·¨±«¥­¨¥ ®¡° ²­®© ¬ ²°¨¶» ¨¬¥¥²
²³ ¦¥ ±«®¦­®±²¼, ·²® ¨ ³¬­®¦¥­¨¥ ¬ ²°¨¶ ²®£® ¦¥ ° §¬¥°  (± ²®·­®±²¼¾ ¤® ³¬­®¦¥­¨¿ ­  ª®­±² ­²³). ­ · «  ¬» ¤®ª ¦¥¬ ¡®«¥¥
¯°®±²³¾ · ±²¼ ½²®£® ³²¢¥°¦¤¥­¨¿.
¥®°¥¬  31.11 (¬­®¦¥­¨¥ ¬ ²°¨¶ ­¥ ±«®¦­¥¥ ®¡° ¹¥­¨¿)
±«¨ ¬®¦­® ®¡° ²¨²¼ (n  n)-¬ ²°¨¶³ §  ¢°¥¬¿ I (n), ¯°¨·¥¬
I (3n) = O(I (n)), ²® ¬®¦­® ³¬­®¦¨²¼ ¤¢¥ (n  n)-¬ ²°¨¶» §  ¢°¥¬¿
O(I (n)).
®ª § ²¥«¼±²¢®.
³±²¼ ­ ¤® ¢»·¨±«¨²¼ ¯°®¨§¢¥¤¥­¨¥ ¤¢³µ (n  n)-¬ ²°¨¶ A ¨ B .
®±² ¢¨¬ (3n  3n)-¬ ²°¨¶³
0

1

In A 0
D = @ 0 In B A :
0 0 In
 ²°¨¶ , ®¡° ²­ ¿ ª D, ¨¬¥¥² ¢¨¤
0
1
In ;A AB
D;1 = @ 0 In ;B A ;
0 0 In
¨ ¬» ¬®¦¥¬ ¢»·¨±«¨²¼ AB ª ª (n  n)-¯®¤¬ ²°¨¶³ ¢ ¢¥°µ­¥¬ ¯° ¢®¬ ³£«³ ¬ ²°¨¶» D;1 .
 ²°¨¶³ D ¬®¦­® ¯®±²°®¨²¼ §  ¢°¥¬¿ (n2 ) = O(I (n)) (§ ¬¥²¨¬, ·²® I (n) > n2 , ² ª ª ª ­³¦­® ¢»·¨±«¨²¼ ¢±¥ n2 ½«¥¬¥­²®¢
®¡° ²­®© ¬ ²°¨¶»),   ®¡° ²¨²¼ §  ¢°¥¬¿ O(I (3n)) = O(I (n)) (±®£« ±­® ³±«®¢¨¾). ²±¾¤  ¨ ±«¥¤³¥² ³²¢¥°¦¤¥­¨¥ ²¥®°¥¬».

¡° ¹¥­¨¥ ¬ ²°¨¶

683

 «®¦¥­­®¥ ­  I (n) ³±«®¢¨¥ I (3n) = O(I (n)) ®§­ · ¥², ·²® I (n)
­¥ ¤¥« ¥² ¡®«¼¸¨µ ±ª ·ª®¢ ± °®±²®¬ n.  ¯°¨¬¥°, ´³­ª¶¨¿ I (n) =
(nc lgd n) ®¡« ¤ ¥² ² ª¨¬ ±¢®©±²¢®¬ ¯°¨ «¾¡»µ §­ ·¥­¨¿µ c >
0; d > 0.
¢¥¤¥­¨¥ ®¡° ¹¥­¨¿ ¬ ²°¨¶ ª ³¬­®¦¥­¨¾
 ¬ ¯®­¿¤®¡¿²±¿ ­¥ª®²®°»¥ ±¢®©±²¢  ±¨¬¬¥²°¨·¥±ª¨µ ¯®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­»µ ¬ ²°¨¶, ª®²®°»¥ ¬» ¤®ª ¦¥¬ ¢ ° §¤¥«¥ 31.6.
¥®°¥¬  31.11 (¡° ¹¥­¨¥ ¬ ²°¨¶ ­¥ ±«®¦­¥¥ ³¬­®¦¥­¨¿)
±«¨ ¬®¦­® ³¬­®¦¨²¼ ¤¢¥ (n  n)-¬ ²°¨¶» §  ¢°¥¬¿ M (n),
¯°¨·¥¬ M (n) ¬®­®²®­­® ­¥³¡¢ ¥² ¨ ³¤®¢«¥²¢®°¿¥² ³±«®¢¨¾
c1M (n) 6 M (2n) 6 c2M (n) ¯°¨ ­¥ª®²®°»µ c1 ¨ c2, ¯°¨·¥¬
c1 > 2, ²® ¬®¦­® ®¡° ²¨²¼ ­¥¢»°®¦¤¥­­³¾ (n  n)-¬ ²°¨¶³ § 
¢°¥¬¿ O(M (n)).
®ª § ²¥«¼±²¢®. ¡° ¹¥­¨¥ ¬ ²°¨¶» ±¢®¤¨²±¿ ª ®¡° ¹¥­¨¾
¡®«¼¸¥© ¬ ²°¨¶», ² ª ª ª




A 0 ;1 = A;1 0 ;
0 Ik
0 Ik
¤«¿ «¾¡®£® k > 0. ®½²®¬³ ¬» ¬®¦¥¬ ¤®ª §»¢ ²¼ ²¥®°¥¬³ ¤«¿ n,
¿¢«¿¾¹¨µ±¿ ±²¥¯¥­¿¬¨ ¤¢®©ª¨, ¯®±ª®«¼ª³ §­ ·¥­¨¿ M (n) ¨ M (n0),
£¤¥ n0 | ¡«¨¦ ©¸ ¿ ±¢¥°µ³ ±²¥¯¥­¼ ¤¢®©ª¨, ®²«¨· ¾²±¿ ­¥ ¡®«¥¥
·¥¬ ¢ ª®­±² ­²³ ° §.
³±²¼ ±­ · «  ¬ ²°¨¶  A, ª®²®°³¾ ­ ¬ ­ ¤® ®¡° ²¨²¼, ¿¢«¿¥²±¿
¯®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­®© ±¨¬¬¥²°¨·¥±ª®© ¬ ²°¨¶¥©.  §®¡¼¥¬
¥¥ ­  ·¥²»°¥ ¡«®ª  ° §¬¥°  n=2  n=2:


 ±±¬®²°¨¬ ¬ ²°¨¶³



CT :
A= B
C D

(31:25)

S = D ; CB;1 C T ;

(31:26)

(¤®¯®«­¥­¨¥ ³° ) ¨ ­ ¯¨¸¥¬ ±®®²­®¸¥­¨¥

;1 + b;1 C T S ;1 CB ;1 ;B ;1 C T S ;1 
B
;
1
A =

(31:27)
;S ;1CB;1
S ;1
(¯°®¢¥°¿¥²±¿ ³¬­®¦¥­¨¥¬ ­  A). ®±ª®«¼ª³ A ¿¢«¿¥²±¿ ¯®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­®© ±¨¬¬¥²°¨·¥±ª®© ¬ ²°¨¶¥©, ²® B ¨ S ®¡« ¤ ¾² ²¥¬ ¦¥ ±¢®©±²¢®¬, ¨ ¯®²®¬³ ®¡° ²¨¬» («¥¬¬» 31.13, 31.14 ¨
31.15). ¥£ª® ¯°®¢¥°¨²¼, ·²® B ;1 C T = (CB ;1 )T ¨ B ;1 C T S ;1 =
(S ;1CB ;1 )T (³¯°. 31.1-3) ®®²­®¸¥­¨¿ (31.26) ¨ (31.27) § ¤ ¾²
°¥ª³°±¨¢­»©  «£®°¨²¬ ®¡° ¹¥­¨¿ ¬ ²°¨¶», ¨±¯®«¼§³¾¹¨© 4 ®¯¥° ¶¨¨ ³¬­®¦¥­¨¿ (n=2  n=2);¬ ²°¨¶:

C  B;1 ;
(CB ;1 )  C T ;
;
S ;1  (CB ;1 );
(CB ;1 )T  (S ;1 CB ;1 )

684

« ¢  31  ²°¨¶» ¨ ¤¥©±²¢¨¿ ± ­¨¬¨

  ² ª¦¥ 2 ®¯¥° ¶¨¨ ®¡° ¹¥­¨¿ ¬ ²°¨¶ ²®£® ¦¥ ° §¬¥°  ¨ O(n2 )
±«®¦¥­¨© ¨ ¤°³£¨µ ®¯¥° ¶¨©. ®«³· ¥¬ °¥ª³°°¥­²­³¾ ´®°¬³«³
I (n) 6 2I (n=2) + 4M (n=2) + dn2
¤«¿ ­¥ª®²®°£® ´¨ª±¨°®¢ ­­®£® d. ³±²¼ C | ¤®±² ²®·­® ¡®«¼¸ ¿
ª®­±² ­²  (­ ±ª®«¼ª®, ³¢¨¤¨¬ ¤ «¼¸¥). ®£¤  ¬®¦­® ¤®ª §»¢ ²¼
­¥° ¢¥­±²¢®
I (n) 6 CM (n)
¯® ¨­¤³ª¶¨¨:
I (n) 6 2I (n=2) + 4M (n=2) + dn2 6
6 2CM (n=2) + 4M (n=2) + dn2 6
6 Cc1M (n=2) 6
6 CM (n)
 ¤® ²®«¼ª® ¯°®¢¥°¨²¼, ·²® ¯°¨ ¤®±² ²®·­® ¡®«¼¸¨µ C ¯¥°¥µ®¤
®² ¢²®°®© ±²°®ª¨ ª ²°¥²¼¥© ¢ ½²®¬ ­¥° ¢¥­±²¢¥ § ª®­¥­.  ± ¬®¬
¤¥«¥ ¯°¨ ¡®«¼¸¨µ C ®±­®¢­®© ¢ª« ¤ ¤ ¥² ¯¥°¢®¥ ±« £ ¥¬®© ¢²®°®©
±²°®ª¨ (­ ¯®¬­¨¬, ·²® M (n) > n2 , ² ª ª ª ­³¦­® ¢»·¨±«¨²¼ ¢±¥
n2 ½«¥¬¥­²®¢ ¯°®¨§¢¥¤¥­¨¿), ¨ ®±² ¥²±¿ ¢±¯®¬­¨²¼, ·²® c1 > 2 ¯®
³±«®¢¨¾ ²¥®°¥¬».
² ª, ± ¯®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­»¬¨ ±¨¬¬¥²°¨·¥±ª¨¬¨ ¬ ²°¨¶ ¬¨ ¬» ° §®¡° «¨±¼. ±«¨ ­¥¢»°®¦¤¥­­ ¿ ¬ ²°¨¶» A ­¥ ¿¢«¿¥²±¿
¯®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­®© ±¨¬¬¥²°¨·¥±ª°© ¬ ²°¨¶¥©, ²® ° ±±¬®²°¨¬ ¬ ²°¨¶³ AT A, ª®²®° ¿ ³¦¥ ¡³¤¥² ² ª®¢®© (³¯° ¦­¥­¨¾ 31.13, ²¥®°¥¬  31.6). ±² ¥²±¿ § ¬¥²¨²¼, ·²®
A;1 = (AT A);1AT ;
¯®±ª®«¼ª³ ((AT A);1 AT )A = (AT A);1 (AT A) = In ,   ®¡° ²­ ¿ ¬ ²°¨¶  ¥¤¨­±²¢¥­­ . ¨¤­®, ·²® ¤®±² ²®·­® ¢»·¨±«¨²¼ ¯°®¨§¢¥¤¥­¨¥ AT A, ®¡° ²¨²¼ ¥£® (ª ª | ¬» ³¦¥ §­ ¥¬) ¨ ³¬­®¦¨²¼ °¥§³«¼² ² ­  ¬ ²°¨¶³ AT .  ¦¤»© ¨§ ²°¥µ ¸ £®¢ ²°¥¡³¥² ¢°¥¬¥­¨
O(M (n)), ±«¥¤®¢ ²¥«¼­®, ¢±¿ª³¾ ­¥¢»°®¦¤¥­­³¾ ¬ ²°¨¶³ ¬®¦­®
®¡° ²¨²¼ §  ¢°¥¬¿ O(M (n)).
®ª § ²¥«¼±²¢® ²¥®°¥¬» 31.12 ­ ¢®¤¨² ­  ¬»±«¼ ® ­®¢®¬ ±¯®±®¡¥ °¥¸¥­¨¿ ±¨±²¥¬» Ax = b ± ­¥¢»°®¦¤¥­­®© ¬ ²°¨¶¥© A, ­¥
²°¥¡³¾¹¥¬ ¢ ±¥¡¿ ¢»¡®°  £« ¢­®£® ½«¥¬¥­² . ¬­®¦¨¢ ³° ¢­¥­¨¥
±«¥¢  ­  (­¥¢»°®¦¤¥­­³¾) ¬ ²°¨¶³ AT , ¯®«³·¨¬ ½ª¢¨¢ «¥­²­®¥
³° ¢­¥­¨¥ (AT A)x = AT b.  ²°¨¶  AT A ¿¢«¿¥²±¿ ¯®«®¦¨²¥«¼­®
®¯°¥¤¥«¥­­®© ±¨¬¬¥²°¨·¥±ª®© ¬ ²°¨¶¥©, ¨ ¤«¿ ­¥¥ ¬®¦­® ­ ©²¨
LU-° §«®¦¥­¨¥ ± ¯®¬®¹¼¾ ¯°®¶¥¤³°» LU-Decomposition,   § ²¥¬ °¥¸¨²¼ ±¨±²¥¬³ ± ¯° ¢®© · ±²¼¾ AT b, ¨±¯®«¼§³¿ ¯°¿¬³¾ ¨
®¡° ²­³¾ ¯®¤±² ­®¢ª³. ±¥ ½²®, ª®­¥·­®, ² ª, ­® ­  ¯° ª²¨ª¥ «³·¸¥ ¯°¨¬¥­¨²¼ ¯°®¶¥¤³°³ LUP-Decomposition ª ¨±µ®¤­®© ¬ ²°¨¶¥ A ¯°¨ ½²®¬ ª®­±² ­²  ¢ ®¶¥­ª¥ ¤«¿ ·¨±«  ®¯¥° ¶¨© ¬¥­¼¸¥, ¨
®¸¨¡ª¨ ®ª°³£«¥­¨¿ ¬¥­¼¸¥ ±ª §»¢ ¾²±¿ ­  °¥§³«¼² ²¥.

®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­»¥ ±¨¬¬¥²°¨·¥±ª¨¥ ¬ ²°¨¶» ¨ ¬¥²®¤ ­ ¨¬¥­¼¸¨µ ª¢ ¤° ²®¢685

¯° ¦­¥­¨¿
31.5-1
®ª ¦¨²¥, ·²® ³¬­®¦¥­¨¥ ¬ ²°¨¶ ±²®«¼ ¦¥ ²°³¤­®, ª ª ¨ ¢®§¢¥¤¥­¨¥ ¬ ²°¨¶» ¢ ª¢ ¤° ²: ¤®ª ¦¨²¥ ·²® ¥±«¨ M (n) | ¢°¥¬¿, ²°¥¡³¥¬®¥ ¤«¿ ³¬­®¦¥­¨¿ ¤¢³µ (n  n)N¬ ²°¨¶,   S (n) | ¢°¥¬¿, ­³¦­®¥ ¤«¿ ¢®§¢¥¤¥­¨¿ (n  n)-¬ ²°¨¶» ¢ ª¢ ¤° ², ²® S (n) = (M (n)).
31.5-2
®ª ¦¨²¥, ·²® ³¬­®¦¥­¨¥ ¬ ²°¨¶ ±²®«¼ ¦¥ ²°³¤­®, ª ª ¨ ¢»·¨±«¥­¨¥ LUP-° §«®¦¥­¨¿. ®°¬ «¼­® £®¢®°¿, ¤®ª ¦¨²¥ ·²® ¥±«¨
M (n) | ¢°¥¬¿, ²°¥¡³¥¬®¥ ¤«¿ ³¬­®¦¥­¨¿ ¤¢³µ (n  n)-¬ ²°¨¶,  
L(n) | ¢°¥¬¿, ­³¦­®¥ ¤«¿ ¢»·¨±«¥­¨¿ LUP-° §«®¦¥­¨¿ (n  n)¬ ²°¨¶», ²® L(n) = (M (n)).
31.5-3
®ª ¦¨²¥, ·²® ¢»·¨±«¥­¨¥ ®¯°¥¤¥«¨²¥«¿ ­¥ ²°³¤­¥¥ ³¬­®¦¥­¨¿
¬ ²°¨¶: ¤®ª ¦¨²¥ ·²® ¥±«¨ M (n) | ¢°¥¬¿, ²°¥¡³¥¬®¥ ¤«¿ ³¬­®¦¥­¨¿ ¤¢³µ (n  n)-¬ ²°¨¶, ²® ®¯°¥¤¥«¨²¥«¼ (n  n)-¬ ²°¨¶» ¬®¦­®
¢»·¨±«¨²¼ §  ¢°¥¬¿ D(n) = O(M (n)).
31.5-4
³±²¼ M (n)) | ¢°¥¬¿, ­³¦­®¥ ¤«¿ ³¬­®¦¥­¨¿ ¤¢³µ ¡³«¥¢»µ ¬ ²°¨¶ ° §¬¥°  n  n,   T (n) | ¢°¥¬¿, ­³¦­®¥ ¤«¿ ¢»·¨±«¥­¨¿ ²° ­§¨²¨¢­®£® § ¬»ª ­¨¿ ¡³«¥¢®© (n  n);¬ ²°¨¶». ®ª ¦¨²¥, ·²®
M (n) = O(T (n)) ¨ T (n) = O(M (n) lg n) ¯°¨ ­¥ª®²®°»µ ¥±²¥±²¢¥­­»µ ¯°¥¤¯®«®¦¥­¨¿µ ­  M ¨ T .
31.5-5
°¨¬¥­¨¬ «¨ ¬¥²®¤ ®¡° ¹¥­¨¿ ¬ ²°¨¶ ¨§ ¤®ª § ²¥«¼±²¢  ²¥®°¥¬» 31.12 ª ¬ ²°¨¶ ¬ ­ ¤ ¯®«¥¬ ¢»·¥²®¢ ¯® ¬®¤³«¾ 2? ®·¥¬³?
31.5-6*
 ª ®¡®¡¹¨²¼  «£®°¨²¬ ¨§ ¤®ª § ²¥«¼±²¢  ²¥®°¥¬» 31.12 ­  ±«³· © ¬ ²°¨¶ ­ ¤ ¯®«¥¬ ª®¬¯«¥ª±­»µ ·¨±¥«?
(ª § ­¨¥. ° ­±¯®­¨°®¢ ­¨¥ ¬ ²°¨¶» § ¬¥­¿¥²±¿ ±®¯°¿¦¥­¨¥¬ : ¬ ²°¨¶  A (conjugate transpose) ¯®«³· ¥²±¿ ª®¬¯«¥ª±­»¬ ±®¯°¿¦¥­¨¥¬ ¢±¥µ ½«¥¬¥­²®¢ ¢ AT . ®«¼ ±¨¬¬¥²°¨·¥±ª¨µ ¬ ²°¨¶»
¨£° ¾² ½°¬¨²®¢», ¤«¿ ª®²®°»µ A = A.)

31.4. ®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­»¥ ±¨¬¬¥²°¨·¥±ª¨¥ ¬ ²°¨¶» ¨ ¬¥²®¤ ­ ¨¬¥­¼¸¨µ ª¢ ¤° ²®¢
²® ®·¥­¼ ¢ ¦­»© ª« ±± ¬ ²°¨¶, ¨ ®­¨ ®¡« ¤ ¾² ° §­»¬¨ ¯®«¥¦­»¬¨ ±¢®©±²¢ ¬¨.  ¯°¨¬¥°, ² ª ¿ ¬ ²°¨¶  ­¥ ¬®¦¥² ¡»²¼
¢»°®¦¤¥­­®©; ¯°¨ ¯®±²°®¥­¨¨ LU-° §«®¦¥­¨¿ ¬®¦­® ­¥ ¯°®¢®¤¨²¼
¢»¡®°  £« ¢­®£® ½«¥¬¥­²  | ¢±¥ ° ¢­® ¤¥«¥­¨¿ ­  ­®«¼ ­¥ ¡³¤¥²,
ª ª ¬» ³¢¨¤¨¬.  ½²®¬ ° §¤¥«¥ ¬» ¯®ª ¦¥¬, ª ª ¨µ ¬®¦­® ¨±¯®«¼§®¢ ²¼ ¤«¿ ² ª ­ §»¢ ¥¬®£® ¯°¨¡«¨¦¥­¨¿ ¬¥²®¤®¬ ­ ¨¬¥­¼¸¨µ ª¢ ¤° ²®¢.  ·­¥¬ ± ² ª®£® ¢ ¦­®£® ±¢®©±²¢ :

686

« ¢  31  ²°¨¶» ¨ ¤¥©±²¢¨¿ ± ­¨¬¨

¥¬¬  31.13
¾¡ ¿ ¯®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­ ¿ ±¨¬¬¥²°¨·¥±ª ¿ ¬ ²°¨¶ 
¿¢«¿¥²±¿ ­¥¢»°®¦¤¥­­®©.
®ª § ²¥«¼±²¢®.
³±²¼ ¬ ²°¨¶  A ¢»°®¦¤¥­  ¨ x | ­¥­³«¥¢®© ¢¥ª²®°, ¤«¿ ª®²®°®£® Ax = 0 (±«¥¤±²¢¨¥ 31.3). ®£¤  xT Ax = 0, ¨ ¯®²®¬³ ¬ ²°¨¶ 
A ­¥ ¬®¦¥² ¡»²¼ ¯®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­®©.
¥¯¥°¼ ¯¥°¥©¤¥¬ ª ¡®«¥¥ ±«®¦­®¬³ ¢®¯°®±³: ¯®·¥¬³ ¯°®¶¥¤³° 
LU-Decomposition ¤«¿ ±«³· ¿ ¯®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­»µ ±¨¬¬¥²°¨·¥±ª¨µ ¬ ²°¨¶ ®¡µ®¤¨²±¿ ¡¥§ ¤¥«¥­¨¿ ­  0.  ¬ ¯®­ ¤®¡¨²±¿
¯®­¿²¨¥ k-£® ³£«®¢®£® ¬¨­®°  (leading submatrix) ¬ ²°¨¶» A. ­
®¯°¥¤¥«¿¥²±¿ ª ª ¯®¤¬ ²°¨¶ , ±²®¿¹ ¿ ­  ¯¥°¥±¥·¥­¨¨ ¯¥°¢»µ k
±²°®ª ¨ ¯¥°¢»µ k ±²®«¡¶®¢ ¬ ²°¨¶» A; ®¡®§­ ·¨¬ ¥£® Ak .
¥¬¬  31.14
±¿ª¨© ³£«®¢®© ¬¨­®° ¯®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­®© ±¨¬¬¥²°¨·¥±ª®© ¬ ²°¨¶» ± ¬ ¿¢«¿¥²¿ ¯®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­®© ±¨¬¬¥²°¨·¥±ª®© ¬ ²°¨¶¥©.
®ª § ²¥«¼±²¢®.
¨¬¬¥²°¨·­®±²¼ ®·¥¢¨¤­ . «¿ ¤®ª § ²¥«¼±²¢  ¯®«®¦¨²¥«¼­®©
®¯°¥¤¥«¥­­®±²¨ ¬¨­®°  Ak ¢®§¼¬¥¬ ¯°®¨§¢®«¼­»© k-½«¥¬¥­²­»©
¢¥ª²®° x.  §¡¨¢ ¬ ²°¨¶³ ¬ ²°¨¶» A ­  ¡«®ª¨




T
A = ABk BC :

¨ ¯°¨¬¥­¨¢ ³±«®¢¨¥ ¯®«®¦¨²¥«¼­®© ®¯°¥¤¥«¥­­®±²¨ ª ¢¥ª²®°³, ¤®¯®«­¥­­®¬³ ­³«¿¬¨, ¯®«³· ¥¬ ²°¥¡³¥¬®¥:

xT A

kx =

;

xT

;
= xT

> 0:



T
0 ABk BC
 

0 A x0


 

x
0

¥¯¥°¼ ¯®±¬®²°¨¬ ­  ¤®¯®«­¥­¨¥ ³°  ¤«¿ ¯®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­»µ ¬ ²°¨¶. ³±²¼ Ak | £« ¢­»© ¬¨­®° ¯®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­®© ±¨¬¬¥²°¨·¥±ª®© ¬ ²°¨¶» A.  §®¡¼¥¬ A ­  ¡«®ª¨ ±«¥¤³¾¹¨¬ ®¡° §®¬:

T
A = ABk BC :
(31=28)
®¯®«­¥­¨¥¬ ³°  ª ¯®¤¬ ²°¨¶¥ Ak ¬ ²°¨¶» A (Schur complement
of A with respect to Ak ) ¡³¤¥¬ ­ §»¢ ²¼ ¬ ²°¨¶³
S = C ; BA;k 1 BT :
(31:29)
® «¥¬¬¥ 31.14 ¬ ²°¨¶  Ak ¿¢«¿¥²±¿ ¯®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­®©
±¨¬¬¥²°¨·¥±ª®© ¬ ²°¨¶¥©, ¯®½²®¬³ («¥¬¬  31.13) A;k 1 ±³¹¥±²¢³¥².

®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­»¥ ±¨¬¬¥²°¨·¥±ª¨¥ ¬ ²°¨¶» ¨ ¬¥²®¤ ­ ¨¬¥­¼¸¨µ ª¢ ¤° ²®¢687

¡° ²¨²¥ ¢­¨¬ ­¨¥, ·²® ¯°¨ k = 1 ½²® ®¯°¥¤¥«¥­¨¥ ±®£« ±³¥²±¿ ±
¯°¥¦­¨¬ ®¯°¥¤¥«¥­¨¥¬ (31.23).
®ª ¦¥¬ °¥§³«¼² ², ¨±¯®«¼§®¢ ­­»© ¯°¨ ¤®ª § ²¥«¼±²¢¥ ²¥®°¥¬» 31.12.
¥¬¬  31.15 (® ¤®¯®«­¥­¨¨ ³° )
±«¨ A ¿¢«¿¥²±¿ ¯®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­®© ±¨¬¬¥²°¨·¥±ª®©
¬ ²°¨¶¥©,   Ak | ¥¥ k;© ³£«®¢®© ¬¨­®°, ²® ¤®¯®«­¥­¨¥ ³°  ª
¯®¤¬ ²°¨¶¥ Ak ¬ ²°¨¶» A ± ¬® ¡³¤¥² ±¨¬¬¥²°¨·¥±ª®© ¯®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­®© ¬ ²°¨¶¥©.
®ª § ²¥«¼±²¢®.
 ª ±«¥¤³¥² ¨§ ³¯° ¦­¥­¨¿ 31.1-7, ¬ ²°¨¶  S ¡³¤¥² ±¨¬¬¥²°¨·¥±ª®©; ®±² ¥²±¿ ¯®ª § ²¼ ¥¥ ¯®«®¦¨²¥«¼­³¾ ®¯°¥¤¥«¥­­®±²¼. »
§­ ¥¬, ·²® xT Ax > 0 ¤«¿ «¾¡®£® ­¥­³«¥¢®£® ¢¥ª²®°  x.  §¡¨¢
¢¥ª²®° x ­  · ±²¨ y ¨ z (¢ ±®®²¢¥²±²¢¨¨ ± ° §¡¨¥­¨¥¬ (31.28) ¬ ²°¨¶» A), ¬» ¬®¦¥¬ ­ ¯¨± ²¼ ±«¥¤³¾¹¥¥ ²®¦¤¥±²¢® (¬ ²°¨¶  Ak
®¡° ²¨¬ , ª ª ¬» §­ ¥¬):


 

Ak BT y
B C z
T
T
= y Ak y + y B T z + z T By + Z T Cz
= (y + A;k 1 B T z )T Ak (y + A;k 1 B T z ) + z T (C ; BA;k 1 B T )z;
(31:30)
;

xT Ax = y T zT



(®±«¥¤­¥¥ ° ¢¥­±²¢® ±®®²¢¥²±²¢³¥² ¢»¤¥«¥­¨¾ ¯®«­®£® ª¢ ¤° ² ,
ª ª ¬» ³¢¨¤¨¬ ¢ ³¯°. 31.6-2.)
¥¯¥°¼ ¤«¿ «¾¡®£® z ¬®¦­® ¯®¤®¡° ²¼ ² ª®¥ y , ·²®¡» ¯¥°¢®¥
±« £ ¥¬®¥ ¢ ±®®²­®¸¥­¨¨ (31.30) ®¡° ²¨«®±¼ ¢ 0 |   §­ ·¨², ®±² ¾¹¥¥±¿ ¢²®°®¥ ±« £ ¥¬®¥

z T (C ; BA;k 1 B T )z = z T Sz
¯®«®¦¨²¥«¼­® ¤«¿ «¾¡®£® z . ®«®¦¨²¥«¼­ ¿ ®¯°¥¤¥«¥­­®±²¼ S ¤®-

ª § ­ .
«¥¤±²¢¨¥ 31.16
«¿ ¯®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­®© ±¨¬¬¥²°¨·¥±ª®© ¬ ²°¨¶» ¯°®¶¥¤³°  LU-Decomposition ­¥ ±² «ª¨¢ ¥²±¿ ± ¤¥«¥­¨¥¬ ­  0.
®ª § ²¥«¼±²¢®.
³±²¼ A | ¯®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­ ¿ ±¨¬¬¥²°¨·¥±ª ¿ ¬ ²°¨¶ . ®ª ¦¥¬, ·²® ¢±¥ £« ¢­»¥ ½«¥¬¥­²» ¯® µ®¤³ ¤¥©±²¢¨¿ ¡³¤³²
¯®«®¦¨²¥«¼­» (¨ ²¥¬ ± ¬»¬ ­¥ ° ¢­» 0). ¥°¢»© ¨§ ­¨µ (a11) ¯®«®¦¨²¥«¥­, ¯®±ª®«¼ª³ ¯® ®¯°¥¤¥«¥­¨¾ ¯®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­®©
¬ ²°¨¶» a11 = eT1 AeT1 > 0.   ±«¥¤³¾¹¥¬ ¸ £¥ °¥ª³°±¨¨  «£®°¨²¬ ¯°¨¬¥­¿¥²±¿ ª ¤®¯®«­¥­¨¾ ³° , ª®²®°®¥ ¯® «¥¬¬¥ 31.15 ± ¬® ¿¢«¿¥²±¿ ¯®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­®© ±¨¬¬¥²°¨·¥±ª®© ¬ ²°¨¶¥©, ² ª ·²® ¨ ¢±¥ ¤ «¼­¥©¸¨¥ £« ¢­»¥ ½«¥¬¥­²» ¯®«®¦¨²¥«¼­»
(¨­¤³ª¶¨¿).
¥²®¤ ­ ¨¬¥­¼¸¨µ ª¢ ¤° ²®¢.

688

« ¢  31  ²°¨¶» ¨ ¤¥©±²¢¨¿ ± ­¨¬¨

¥²®¤ ­ ¨¬¥­¼¸¨µ ª¢ ¤° ²®¢ ¨±¯®«¼§³¥² ¯®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­»¥ ±¨¬¬¥²°¨·¥±ª¨¥ ¬ ²°¨¶» ¤«¿ ®²»±ª ­¨¿ ª°¨¢»µ ¤ ­­®£® ¢¨¤ , ¯®µ®¤¿¹¨µ ¯®¡«¨§®±²¨ ®² § ¤ ­­»µ ²®·¥ª. ³±²¼ ­ ¬ § ¤ ­ ­ ¡®° ²®·¥ª
(x1; y1); (x2; y2 ); : : : ; (xm; ym )
(xi 6= xj ¯°¨ i 6= j ), ¯°¨·¥¬ §­ ·¥­¨¿ yi ±·¨² ¾²±¿ ±®¤¥°¦ ¹¨¬¨
®¸¨¡ª¨ ¨§¬¥°¥­¨¿. » ¨¹¥¬ ´³­ª¶¨¾ F (x), ¤«¿ ª®²®°®©

yi = F (xi ) + i;
(31:31)
¯°¨ i = 1; : : : ; m, ¯°¨·¥¬ ¯®£°¥¸­®±²¨ i ¬ «». ¹¥¬ ¬» ¥¥ ±°¥¤¨
´³­ª¶¨© ®¯°¥¤¥«¥­­®£® ª« ±± ,   ¨¬¥­­®, ±°¥¤¨ «¨­¥©­»µ ª®¬¡¨­ ¶¨©
n
X
cj fj (x):
j =1

§ ° ­¥¥ ¢»¡° ­­»µ ¡ §¨±­»µ ´³­ª¶¨© (basic functions) fj .  ±²® ¢
ª ·¥±²¢¥ ¡ §¨±­»µ ´³­ª¶¨© ° ±±¬ ²°¨¢ ¾² ¬®­®¬» fj (x) = xj ;1
¢¯«®²¼ ¤® ­¥ª®²®°®© ´¨ª±¨°®¢ ­­®© ±²¥¯¥­¨; ¤°³£¨¬¨ ±«®¢ ¬¨, ¬»
¨¹¥¬ F ±°¥¤¨ ¬­®£®·«¥­®¢ ±²¥¯¥­¨ ­¥ ¢»¸¥ n ; 1:

c1 + c2x + c3x2 +    + cn xn;1 :
°¨ n = m ¬®¦­® ­ ©²¨ ¬­®£®·«¥­, ¢ ²®·­®±²¨ ¯°®µ®¤¿¹¨©
·¥°¥§ § ¤ ­­»¥ ²®·ª¨, ²® ¥±²¼ ³¤®¢«¥²¢®°¿¾¹¨© ±®®²­®¸¥­¨¾
(31.31) ± ­³«¥¢»¬¨ ¯®£°¥¸­®±²¿¬¨.  ª ¯° ¢¨«®, ² ª®© ¯®¤µ®¤ ®ª §»¢ ¥²±¿ ­¥³¤ ·­»¬, ² ª ª ª ®¸¨¡ª¨ ¨§¬¥°¥­¨© ±¨«¼­® ¢«¨¿¾² ­ 
§­ ·¥­¨¿ ¬­®£®·«¥­  ¢­¥ x1 ; x2; : : : ; xn , ¨ ¯®«³· ¥²±¿ ¥°³­¤ .  §³¬­¥¥ ¢»¡° ²¼ n ¬­®£® ¬¥­¼¸¨¬ m | ²®£¤  ¥±²¼ ¸ ­±, ·²® À¸³¬Á,
¢­®±¨¬»© ®¸¨¡ª ¬¨ ¨§¬¥°¥­¨¿, ®²´¨«¼²°³¥²±¿. » ­¥ ®¡±³¦¤ ²¼
¯° ª²¨·¥±ª¨¥ ¯° ¢¨«  ¢»¡®°  n,   ¡³¤¥² ±·¨² ²¼, ·²® n ³¦¥ § ¤ ­®. » ¯®«³· ¥¬ ±¨±²¥¬³, £¤¥ ³° ¢­¥­¨© ¡®«¼¸¥, ·¥¬ ­¥¨§¢¥±²­»µ,
§ ²® ¨µ ­¥ ­ ¤® °¥¸ ²¼ ²®·­® | ¥±«¨ «¥¢ ¿ · ±²¼ ¡«¨§ª  ª ¯° ¢®©,
³¦¥ µ®°®¸®.  ª ¯®±²³¯ ²¼ ± ² ª®© ±¨±²¥¬®©?
³±²¼ A | ¬ ²°¨¶  §­ ·¥­¨© ¡ §¨±­»µ ´³­ª¶¨© ¢ § ¤ ­­»µ
²®·ª µ:
0
1
f1(x1) f2(x1) : : : fn (x1 )
B f1 (x2) f2 (x2) : : : fn (x2 ) C
C
A=B
B
C;
..
..
.
.
.
.
@
.
.
.
. A
f1(xm) f2 (xm ) : : : fn (xm)

®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­»¥ ±¨¬¬¥²°¨·¥±ª¨¥ ¬ ²°¨¶» ¨ ¬¥²®¤ ­ ¨¬¥­¼¸¨µ ª¢ ¤° ²®¢689

  c | ¢¥ª²®° ¨§ n ¨±ª®¬»µ ª®½´´¨¶¨¥­²®¢: c = (ck ). ®£¤ 
0

10

1

f1(x1) f2(x1) : : : fn (x1) c1
B f1 (x2) f2 (x2) : : : fn (x2 ) C Bc2 C
B
CB C

Ac = B
B.C
..
..
.. C
...
@
.
.
. A @ .. A
f1(xm ) f2(xm ) : : : fn (xm) cn
0
1
F (x1 )
B F (x2 ) C
B
C
=B
. C
@ .. A
F (xm )

¡³¤¥² ¢¥ª²®°®¬ ¨§ m §­ ·¥­¨©, ·¥°¥§ ª®²®°»¥ ¯°®µ®¤¨² ª°¨¢ ¿.
» µ®²¨¬, ·²®¡» ¢¥ª²®° ­¥¢¿§ª¨ (approximation error)

 = Ac ; y;
(° §¬¥°  m) ¡»« ª ª ¬®¦­® ¬¥­¼¸¥. ¤¥±¼ À¬¥­¼¸¥Á ¬» ¯®­¨¬ ¥¬
ª ª Àª®°®·¥Á, ¢»·¨±«¿¿ ¤«¨­³ ¯® ´®°¬³«¥
m
X

k k =

i=1

i2

!1=2

(¥¢ª«¨¤®¢  ­®°¬ ). °³£¨¬¨ ±«®¢ ¬¨, ¬» µ®²¨¬, ·²®¡» ±³¬¬  ª¢ ¤° ²®¢ ­¥¢¿§®ª ¡»«  ¬¨­¨¬ «¼­®©, ®²±¾¤  ¨ ­ §¢ ­¨¥ ¬¥²®¤ ­ ¨¬¥­¼¸¨µ ª¢ ¤° ²®¢ (least squares).  ª ³· ² ¢ ª³°±¥  ­ «¨§ , ¤«¿
¯®¨±ª  ¬¨­¨¬³¬  ­ ¤® ¯°®¤¨´´¥°¥­¶¨°®¢ ²¼

kk2 = kAc ; yk2 =
¯® ¢±¥¬ ¯¥°¥¬¥­­»¬ ck

@ k k 2

n
X

@ck = i=1

n
X
i=1

0
n
X
2@

j =1

0
@

n
X
j =1

12

aij cj ; yiA
1

aij cj ; yi A aik = 0:

(31:32)

²³ ±¨±²¥¬³ ¨§ n ³° ¢­¥­¨© (k = 1; 2; : : : ; n) ¬®¦­® § ¯¨± ²¼ ª ª
¬ ²°¨·­®¬¥ ³° ¢­¥­¨¥
(Ac ; y )T A = 0;
ª®²®°®¥ (±¬. ³¯°. 31.1-3) ½ª¢¨¢ «¥­²­® ³° ¢­¥­¨¾

AT (Ac ; y ) = 0:

690

« ¢  31  ²°¨¶» ¨ ¤¥©±²¢¨¿ ± ­¨¬¨

 ±ª°»¢ ±ª®¡ª¨, ¬» ¯°¨µ®¤¨¬ ª ³° ¢­¥­¨¾

AT Ac = AT y;

(31:33)

­ §»¢ ¥¬®¬³ ¢ ¬ ²¥¬ ²¨·¥±ª®© ±² ²¨±²¨ª¥ ­®°¬ «¼­»¬ ³° ¢­¥­¨¥¬ (normal equation).  ²°¨¶  AT A ¡³¤¥² ±¨¬¬¥²°¨·¥±ª®©
(³¯°. 31.1-3), ¨, ¥±«¨ ²®«¼ª® A ¨¬¥¥² ¯®«­»© ±²®«¡¶®¢»© ° ­£,
¯®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­®© (²¥®°¥¬  31.6).  ½²®¬ ±«³· ¥ («¥¬¬ 
31.13) ±³¹¥±²¢³¥² ®¡° ²­ ¿ ¬ ²°¨¶  (AT A);1 , ¨ °¥¸¥­¨¥ ±¨±²¥¬»
(31.33) ¥¤¨­±²¢¥­­®:

c = ((AT A);1AT )y
= A+ y;

(31:34)

¤¥±¼ ·¥°¥§ A+ ®¡®§­ ·¥­  ¬ ²°¨¶  (AT A);1 AT , ­ §»¢ ¥¬ ¿ ¯±¥¢¤®®¡° ²­®© (pseudoinverse) ª ¬ ²°¨¶¥ A. ²® ¯®­¿²¨¥ ¿¢«¿¥²±¿
¥±²¥±²¢¥­­»¬ ®¡®¡¹¥­¨¥¬ ¯®­¿²¨¿ ®¡° ²­®© ¬ ²°¨¶» ­  ±«³· ©
­¥ª¢ ¤° ²­»µ ¬ ²°¨¶». (° ¢­¨²¥ ´®°¬³«³ (31.34), ¤ ¾¹³¾ °¥¸¥­¨¥ ±¨±²¥¬» Ac = y ¯® ¬¥²®¤³ ­ ¨¬¥­¼¸¨µ ª¢ ¤° ²®¢, ± ´®°¬³«®© x = A;1 b, ¤ ¾¹¥© ²®·­®¥ °¥¸¥­¨¥ ±¨±²¥¬» Ax = b.)
«¿ ¯°¨¬¥°  ° ±±¬®²°¨¬ 5 ½ª±¯¥°¨¬¥­² «¼­»µ ²®·¥ª
(;1; 2); (1; 1); (2; 1); (3; 0); (5; 3)
(·¥°­»¥ ª°³¦ª¨ °¨±. 31.3.) » µ®²¨¬ ¯°®¢¥±²¨ °¿¤®¬ ± ­¨¬¨ £° ´¨ª ª¢ ¤° ²­®£® ²°¥µ·«¥­ 

F (x) = c1 + c2x + c3x2:
»¯¨¸¥¬ ¬ ²°¨¶³ §­ ·¥­¨© ¡ §¨±­»µ ´³­ª¶¨©:
0

1
B2
B
A=B
B3
@4
5

x1
x2
x3
x4
x5

1

0

x21
1
B1
x22C
C B
B
x23C
C = B1
2
A
@1
x4
2
1
x5

;1 1

1

1 1C
C
2 4C
C
3 9A
5 25

¨ ­ ©¤¥¬ ¯±¥¢¤®®¡° ²­³¾ ª ­¥©:
0

A+ = @

1

0:500 0:300 0:200 0:100 ;0:100
;0:388 0:093 0:190 0:193 ;0:088 A :
0:060 ;0:036 ;0:048 ;0:036 0:060

±ª®¬»© ¢¥ª²®° ª®½´´¨¶¨¥­²®¢ (c = A+ y ) ¡³¤¥² ° ¢¥­
0

c=@

1:200
;0:757
0:214

1
A

:

®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­»¥ ±¨¬¬¥²°¨·¥±ª¨¥ ¬ ²°¨¶» ¨ ¬¥²®¤ ­ ¨¬¥­¼¸¨µ ª¢ ¤° ²®¢691
¨±.

31.1

31.3 ¥²®¤ ­ ¨¬¥­¼¸¨µ ª¢ ¤° ²®¢ ¢ ¯°¨¬¥­¥­¨¨ ª ²®·ª ¬

f(;1; 2); (1; 1); (2; 1); (3; 0); (5; 3)g (·¥°­»¥). ®ª § ­ ­ ¨«³·¸¨© ª¢ ¤° ²­»©

²°¥µ·«¥­ ¨ ¥£® §­ ·¥­¨¿ (±¢¥²«»¥ ª°³¦ª¨). ¥°»¥ ®²°¥§ª¨ | ­¥¢¿§ª¨, ¨µ ±³¬¬ 
ª¢ ¤° ²®¢ ¤®«¦­  ¡»²¼ ª ª ¬®¦­® ¬¥­¼¸¥.

²¢¥²: ª¢ ¤° ²­»© ²°¥µ·«¥­

F (x) = 1:200 ; 0:757x + 0:214x2;
¯°¥¤±² ¢«¿¥² ±®¡®© ­ ¨«³·¸¥¥ ¯°¨¡«¨¦¥­¨¥ ¢ ±¬»±«¥ ­ ¨¬¥­¼¸¨µ
ª¢ ¤° ²®¢.
  ¯° ª²¨ª¥ ¯°¨ °¥¸¥­¨¨ ­®°¬ «¼­®£® ³° ¢­¥­¨¿ (31.33) ±²°®¿²
LU-° §«®¦¥­¨¥ ¬ ²°¨¶» AT A | ½²® ¯®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­ ¿
±¨¬¬¥²°¨·¥±ª ¿ ¬ ²°¨¶  (¥±«¨ A ¨¬¥¥² ¯®«­»© ° ­£, ±¬. ³¯°. 31.13 ¨ ²¥®°¥¬³ 31.6).
¯° ¦­¥­¨¿
31.6-1
®ª ¦¨²¥, ·²® ¢±¥ ½«¥¬¥­²» ­  ¤¨ £®­ «¨ ¯®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­®© ±¨¬¬¥²°¨·¥±ª®© ¬ ²°¨¶» ¯®«®¦¨²¥«¼­».
31.6-2
®ª ¦¨²¥, ·²® ¤«¿ ¯®«®¦¨²¥«¼­®
®¯°¥¤¥«¥­­®© ±¨¬¬¥²°¨·¥±ª®©


a
b
¬ ²°¨¶» ° §¬¥°  2  2 b c ¤¨±ª°¨¬¨­ ­² ac ; b2 ¯®«®¦¨²¥«¥­,
¢»¤¥«¨¢ ¯®«­»© ª¢ ¤° ² ¢ ±®®²¢¥²±²¢³¾¹¥© ª¢ ¤° ²¨·­®© ´®°¬¥ ( ­ «®£¨·­® ¤®ª § ²¥«¼±²¢³ ¥¬¬» 31.15).  ª ¢»¢¥±²¨ ½²® ¨§
³²¢¥°¦¤¥­¨¿ «¥¬¬» 31.15?
31.6-3
®ª ¦¨²¥, ·²® ­ ¨¡®«¼¸¨© ½«¥¬¥­² ¯®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­®©
¬ ²°¨¶» ¬ ²°¨¶» ­ µ®¤¨²±¿ ­  ¥¥ ¤¨ £®­ «¨.
31.6-4
®ª ¦¨²¥, ·²® ®¯°¥¤¥«¨²¥«¼ ¢±¿ª®£® ³£«®¢®£® ¬¨­®°  ¯®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­®© ±¨¬¬¥²°¨·¥±ª®© ¬ ²°¨¶» ¯®«®¦¨²¥«¥­.
31.6-5
³±²¼ Ak | k;© ³£«®¢®© ¬¨­®° ¯®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­®© ±¨¬¬¥²°¨·¥±ª®© ¬ ²°¨¶» A. ®ª ¦¨²¥, ·²® ¢ ¯°¨ ¯®±²°®¥­¨¨ LU° §«®¦¥­¨¿ ¬ ²°¨¶» A ± ¯®¬®¹¼¾ LU-Decomposition k;© £« ¢­»© ½«¥¬¥­² ¡³¤¥² ° ¢¥­ det(Ak )= det(Ak;1 ). (» ¯®« £ ¥¬ ³±«®¢­®
det(A0 ) = 1.)
31.6-6
 ­» ²®·ª¨ (1; 1); (2; 1); (3; 3); (4; 8). ®±²°®©²¥ ¯°¨¡«¨¦¥­¨¥ ¢¨¤ 
F (x) = c1 + c2x lg x + c3 ex
¬¥²®¤®¬ ­ ¨¬¥­¼¸¨µ ª¢ ¤° ²®¢.
31.6-7

692

« ¢  31  ²°¨¶» ¨ ¤¥©±²¢¨¿ ± ­¨¬¨

®ª ¦¨²¥ ±«¥¤³¾¹¨¥ ±¢®©±²¢  ¯±¥¢¤®®¡° ²­»µ ¬ ²°¨¶:

AA+ A = A;
A+ AA+ = A+ ;
(AA+ )T = AA+ ;
(A+ A)T = A+ A:
 ¤ ·¨
31-1 ¥°®¿²­®±²­»©  «£®°¨²¬  ¬¨°  ¤«¿ ³¬­®¦¥­¨¿ ¡³«¥¢»µ
¬ ²°¨¶.
 ° §¤¥«¥ 31.3 ¬» ¢¨¤¥«¨, ·²®  «£®°¨²¬ ²° ±±¥­  ­¥«¼§¿ ¯°®±²® ² ª ¯°¨¬¥­¨²¼ ¤«¿ ¡³«¥¢»µ ¬ ²°¨¶, ¯®±ª®«¼ª³ ¡³«¥¢® ª¢ §¨ª®«¼¶® Q = (f0; 1g; _; ^; 0; 1) ­¥ ¿¢«¿¥²±¿ ª®«¼¶®¬. ¥®°¥¬  31.10
¬®¤¨´¨¶¨°³¥²  «£®°¨²¬ ²° ±±¥­  ¨ ¯®§¢®«¿¥² ³¬­®¦¨²¼ ¤¢¥ ¡³«¥¢»¥ ¬ ²°¨¶» ° §¬¥°  n  n §  ¢°¥¬¿ O(nlg7 ), ­®  °¨´¬¥²¨·¥±ª¨¥ ®¯¥° ¶¨¨ ¯°¨µ®¤¨²±¿ ¢»¯®«­¿²¼ ­ ¤ O(lg n)-¡¨²®¢»¬¨ ·¨±« ¬¨. ¥°®¿²­®±²­»©  «£®°¨²¬  ¬¨°  ¯°®¨§¢®¤¨² ²®«¼ª® ¡¨²®¢»¥
®¯¥° ¶¨¨ ¨ ° ¡®² ¥² ¯®·²¨ ±²®«¼ ¦¥ ¡»±²°®, ®¤­ ª® ­¥ ¢±¥£¤  ¤ ¥²
¯° ¢¨«¼­»© ®²¢¥². ¥©· ± ¬» ¥£® ®¯¨¸¥¬.
a. ®ª ¦¨²¥, ·²® ·¨±«®¢ ¿ ±¨±²¥¬  R = (f0; 1g; ; ^; 0; 1), £¤¥ 
®§­ · ¥² XOR (¨±ª«¾· ¥¹¥¥ , ±«®¦¥­¨¥ ¯® ¬®¤³«¾ 2) ¯°¥¤±² ¢«¿¥² ±®¡®© ª®«¼¶®.
³±²¼ A ¨ B | ¡³«¥¢» (n  n);¬ ²°¨¶»,   C = AB | ¨µ ¯°®¨§¢¥¤¥­¨¥ ­ ¤ ª¢ §¨ª®«¼¶®¬ Q ®±²°®¨¬ ¯® ¬ ²°¨¶¥ A ¬ ²°¨¶³
A0 ² ª: ­³«¨ ®±² ¾²±¿ ­  ±¢®¨µ ¬¥±² µ,   ª ¦¤ ¿ ¥¤¨­¨¶  «¨¡®
®±² ¥²±¿ ­  ¬¥±²¥, «¨¡® § ¬¥­¿¥²±¿ ­³«¥¬ (± ¢¥°®¿²­®±²¼¾ 50%,
° §­»¥ ¥¤¨­¨¶» ¢¥¤³² ±¥¡¿ ­¥§ ¢¨±¨¬®).
b. ®«®¦¨¬ C 0 = (c0ij ) = A0 B , ¯°¨·¥¬ ³¬­®¦¥­¨¥ ¢»¯®«­¿¥²±¿
­ ¤ ª®«¼¶®¬ R. ®ª ¦¨²¥, ·²® ¥±«¨ ±ij = 0, ²® ±0ij = 0. ®ª ¦¨²¥,
·²® ¥±«¨ cij = 1, ²® ±0ij = 1 ± ¢¥°®¿²­®±²¼¾ 1=2.
c. §¿¢ ¯°®¨§¢®«¼­®¥ " > 0, ¯®¢²®°¨¬ ¯°®¶¥¤³°³ ¯®±²°®¥­¨¿ A0
¨ ¢»·¨±«¥­¨¿ C 0 ·¥¬ lg(n2=") ° § ¨«¨ ¡®«¥¥, ª ¦¤»© ° § ¤¥« ¿ ­¥§ ¢¨±¨¬»¥ ±«³· ©­»¥ ¢»¡®°». ®ª ¦¨²¥, ·²® ¥±«¨ cij = 1 ¤«¿ ­¥ª®²®°»µ i ¨ j , ²® ¢¥°®¿²­®±²¼ ²®£®, ·²® c0ij ­¨ ° §³ ­¥ ¯°¨¬¥²
§­ ·¥­¨¿ 1, ­¥ ¯°¥¢®±µ®¤¨² "=n2 . ®ª ¦¨²¥, ·²® ¢¥°®¿²­®±²¼ ²®£®,
·²® ¢ «¾¡®© ¯®§¨¶¨¨, £¤¥ cij = 1, µ®²¼ ° § ¡»« ¯° ¢¨«¼­»© ®²¢¥²
(².¥. 1), ­¥ ¬¥­¼¸¥¥ 1 ; ".
d. «¿ «¾¡®© ª®­±² ­²» k ³ª ¦¨²¥  «£®°¨²¬, ¢»·¨±«¿¾¹¨© ¯°®¨§¢¥¤¥­¨¥ ¤¢³µ ¡³«¥¢»µ (n  n)-¬ ²°¨¶ §  ¢°¥¬¿ O(nlg7 lg n) ± ¢¥°®¿²­®±²¼¾ ®¸¨¡ª¨ ­¥ ¢»¸¥ 1=nk .  ¤ ½«¥¬¥­² ¬¨ ¬ ²°¨¶ ° §°¥¸ ¥²±¿ ¯°®¨§¢®¤¨²¼ ²®«¼ª® ¯®¡¨²®¢»¥ ®¯¥° ¶¨¨ ^, _ ¨ .
31-2 °¥µ¤¨ £®­ «¼­»¥ ±¨±²¥¬» «¨­¥©­»µ ³° ¢­¥­¨©.

®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­»¥ ±¨¬¬¥²°¨·¥±ª¨¥ ¬ ²°¨¶» ¨ ¬¥²®¤ ­ ¨¬¥­¼¸¨µ ª¢ ¤° ²®¢693

 ±±¬®²°¨¬ ²°¥µ¤¨ £®­ «¼­³¾ ¬ ²°¨¶³
0

A=

B
B
B
B
@

1 ;1 0 0 0
;1 2 ;1 0 0
0 ;1 2 ;1 0
0 0 ;1 2 ;1
0 0 0 ;1 2

1
C
C
C
C
A

:

a.  ©¤¨²¥ LU-° §«®¦¥­¨¥ ¬ ²°¨¶» A.
b. ±¯®«¼§³¿
¯°¿¬³¾
¨ ®¡° ²­³¾ ¯®¤±² ­®¢ª³, °¥¸¨²¥ ±¨±²¥¬³
;
T
Ax = 1 1 1 1 1 .
c.  ©¤¨²¥ ®¡° ²­³¾ ¬ ²°¨¶³ A;1 .
d. ®ª ¦¨²¥, ª ª °¥¸ ²¼ ±¨±²¥¬³ Ax = b ± ¯®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­®© ±¨¬¬¥²°¨·¥±ª®© ²°¥µ¤¨ £®­ «¼­®© (n  n)-¬ ²°¨¶¥© A § 
¢°¥¬¿ O(n), ¨±¯®«¼§³¿ LU-° §«®¦¥­¨¥. ¡º¿±­¨²¥, ¯®·¥¬³ «¾¡®©
 «£®°¨²¬, ®±­®¢ ­­»© ­  ®¡° ¹¥­¨¨ ¬ ²°¨¶» A, ¨¬¥¥²  ±¨¬¯²®²¨·¥±ª¨ µ³¤¸³¾ ®¶¥­ª³ ±«®¦­®±²¨.
e. ®ª ¦¨²¥, ª ª °¥¸ ²¼ ±¨±²¥¬³ Ax = b ± ­¥¢»°®¦¤¥­­®©
²°¥µ¤¨ £®­ «¼­®© (n  n)-¬ ²°¨¶¥© A §  ¢°¥¬¿ O(n), ¨±¯®«¼§³¿
LUP-° §«®¦¥­¨¥.
31-3 ¯« ©­»
°®¢®¤¿ ª°¨¢»¥ ·¥°¥§ § ¤ ­­»¥ ²®·ª¨, · ±²® ¨±¯®«¼§³¾² ª³¡¨·¥±ª¨¥ ±¯« ©­» (cubic splines). ³±²¼ § ¤ ­ ­ ¡®° (n + 1) ²®·¥ª
f(xi; yi) : i = 0; 1; : : : ; ng, ¯°¨·¥¬ x0 < x1 <    < xn . » µ®²¨¬ ¯°®¢¥±²¨ ·¥°¥§ ¢±¥ ½²¨ ²®·ª¨ ª°¨¢³¾, ±®±²®¿¹³¾ ¨§ ª³±ª®¢
n ª³¡¨·¥±ª¨µ ¯®«¨­®¬®¢, ­  ª ¦¤®¬ ®²°¥§ª¥ ±¢®©. ®£¤  x ¯°®¡¥£ ¥² ®²°¥§®ª [xi; xi+1 ] (i = 0; 1; : : : ; n), ±¯« ©­ f ®¯°¥¤¥«¿¥²±¿
° ¢¥­±²¢®¬ f (x) = fi (x ; xi ), £¤¥ fi (x) = ai + bix + ci x2 + di x3 |
ª³¡¨·¥±ª¨© ¯®«¨­®¬. ®·ª¨ xi , ¢ ª®²®°»µ ª³±ª¨ ±®±²»ª®¢»¢ ¾²±¿,
­ §»¢ ¾²±¿ ³§« ¬¨ (knots) «¿ ¯°®±²®²» ¡³¤¥¬ ¯°¥¤¯®« £ ²¼, ·²®
xi = i ¯°¨ i = 0; 1; : : : ; n.
®²°¥¡®¢ ¢ ®² f ­¥¯°¥°»¢­®±²¨, ¯®«³·¨¬ ³±«®¢¨¿:

f (xi ) = fi(0) = yi ;
f (xi+1 ) = fi(1) = yi+1;
¤«¿ i = 0; 1; : : : ; n ; 1. ²±³²±²¢¨¥ ¨§«®¬®¢ (° §°»¢®¢ ¯¥°¢®© ¯°®¨§¢®¤­®©) ¢ ³§« µ ¤ ¥² ³±«®¢¨¿
f 0(xi+1 ) = fi0(1) = fi0+1(0);

¤«¿ i = 0; 1; : : : ; n ; 1.
a. ³±²¼ ¬» ª ª¨¬-²® ®¡° §®¬ ¢»¡° «¨, ¯®¬¨¬® ± ¬¨µ §­ ·¥­¨©
yi = f (xi), ¥¹¥ ¨ ¯°®¨§¢®¤­»¥ Di = f 0 (xi) ¢ ª ¦¤®¬ ³§«¥. »° §¨²¥
ª®½´´¨¶¨¥­²» ai , bi , ci ¨ di ·¥°¥§ §­ ·¥­¨¿ yi , yi+1 , Di ¨ Di+1 . ( ¯®¬¨­ ¥¬, ·²® xi = i.) ª®«¼ª® ¢°¥¬¥­¨ ¯®­ ¤®¡¨²±¿ ¤«¿ ² ª®£®
¢»·¨±«¥­¨¿?

694

« ¢  31  ²°¨¶» ¨ ¤¥©±²¢¨¿ ± ­¨¬¨

±«¨ §­ ·¥­¨¿ ¯°®¨§¢®¤­®© ¢ ³§« µ ­¥ § ¤ ­», ¢±² ¥² ¢®¯°®± ®¡
¨µ ¢»¡®°¥. ¤¨­ ¨§ ¬¥²®¤®¢ ±®±²®¨² ¢ ²®¬, ·²®¡» ¯®²°¥¡®¢ ²¼
­¥¯°¥°»¢­®±²¨ ¢¯«®±²¼ ¤® ¢²®°®© ¯°®¨§¢®¤­®© f 00. ²® ¤ ¥² ­ ¡®°
³±«®¢¨©:
f 00(xi+1 ) = fi00 (1) = fi0+1(0);
¤«¿ i = 0; 1; : : : ; n ; 1. ®ª  ·²® §­ ·¥­¨¿ ¢²®°®© ¯°®¨§¢®¤­®© f ¢
²®·ª µ x0 ¨ xn ­¨ª ª ­¥ ®£° ­¨·¨¢ ¾²±¿; ¯®«®¦¨¢ f 00 (x0) = f000 (0) =
0 ¨ f 00 (xn ) = fn00(1) = 0, ¯®«³· ¥¬ ² ª ­ §»¢ ¥¬»© ¥±²¥±²¢¥­­»©
ª³¡¨·¥±ª¨© ±¯« ©­ (natural cubic spline).
b. ±¯®«¼§³¿ ­¥¯°¥°»¢­®±²¼ ¢¯«®²¼ ¤® ¢²®°®© ¯°®¨§¢®¤­®©, ¯®ª ¦¨²¥, ·²®

Di;1 + 4Di + Di+1 = 3(yi+1 ; yi;1 )
¤«¿ i = 1; : : : ; n ; 1.

(31:35)

c. «¿ ¥±²¥±²¢¥­­»µ ª³¡¨·¥±ª¨µ ±¯« ©­®¢ ¤®ª ¦¨²¥ ° ¢¥­±²¢ 
2D0 + 4D1 = 3(y1 ; y0 );

Dn;1 + 2Dn = 3(yn ; yn;1 ):

(31:36)

(31:37)
d. ¥°¥¯¨¸¨²¥ ³° ¢­¥­¨¿ (31.35){(31.37) ¢ ¢¨¤¥ ¬ ²°¨·­®£®
³° ¢­¥­¨¿ ­  ¢¥ª²®° ­¥¨§¢¥±²­»µ D = (D0; D1; : : : ; Dn ).  ª¨¬¨
±¢®©±²¢ ¬¨ ®¡« ¤ ¥² ¬ ²°¨¶  ½²®£® ³° ¢­¥­¨¿?
e. ®ª ¦¨²¥, ·²® ¥±²¥±²¢¥­­»© ª³¡¨·¥±ª¨© ±¯« ©­ ¤«¿ n + 1 ²®·¥ª ¬®¦­® ¯®±²°®¨²¼ §  ¢°¥¬¿ O(n) (±°. § ¤ ·³ 31-2).
f.  ª ¯®±²°®¨²¼ ¥±²¥±²¢¥­­»© ª³¡¨·¥±ª¨© ±¯« ©­ ¤«¿ n + 1 ²®·¥ª (x0 ; y0); : : : (xn ; yn ), ³ ª®²®°»µ x0 < x1 <    < xn , (­® ­¥ ®¡¿§ ²¥«¼­® xi = i).  ª®¥ ¬ ²°¨·­®¥ ³° ¢­¥­¨¥ ¯°¨¤¥²±¿ °¥¸ ²¼ ¨
±ª®«¼ª® ¢°¥¬¥­¨ ¤«¿ ½²®£® ¯®²°¥¡³¥²±¿?
 ¬¥· ­¨¿
¥®°¨¿ ·¨±«¥­­»µ ¬¥²®¤®¢ | ¶¥« ¿ ­ ³ª , ª®²®°®© ¬» ¥¤¢  ª®±­³«¨±¼. » ®±®¡¥­­® °¥ª®¬¥­¤³¥¬ ±«¥¤³¾¹¨¥ ³·¥¡­¨ª¨: ¦®°¤¦
¨ ¼¾ [18], ®«³¡ ¨ ¢ ­ ® ­ [89], °¥±±, «½­¥°¨, ¼¾ª®«¼±ª¨ ¨
¥²²¥°«¨­£ [161,162], ²°¥­£ [181,182].
®¿¢«¥­¨¥ ° ¡®²» ²° ±±¥­  [183] ¢ 1969 £®¤³ ¡»«® ¡®«¼¸¨¬
±¾°¯°¨§®¬ | ­¨ª²® ­¥ ®¦¨¤ «, ·²® ®¡»·­»©  «£®°¨²¬ ³¬­®¦¥­¨¿
¬ ²°¨¶ ­¥ ®¯²¨¬ «¥­.  ²¥µ ¯®°  ±¨¬¯²®²¨·¥±ª ¿ ¢¥°µ­¿¿ ®¶¥­ª 
±«®¦­®±²¨ ³¬­®¦¥­¨¿ ¬ ²°¨¶ ¬­®£®ª° ²­® ³«³·¸ « ±¼ ¨ ¤®±²¨£« 
O(n2:376) (®¯¯¥°±¬¨² ¨ ¨­®£° ¤ [52]).  £«¿¤­®¥ ¯°¥¤±² ¢«¥­¨¥
 «£®°¨²¬  ²° ±±¥­  ª °²¨­ª ¬¨ ± ¯«¾± ¬¨ ¨ ¬¨­³± ¬¨ ¡»«® ¨±¯®«¼§®¢ ­® ¢ ° ¡®²¥  ²¥°±®­  [15]. ¨¸¥° ¨ ¥©¥° [67] ¯°¨¬¥­¨«¨  «£®°¨²¬ ²° ±±¥­  ¤«¿ ³¬­®¦¥­¨¿ ¡³«¥¢»µ ¬ ²°¨¶ (²¥®°¥¬ 
31.10 ½²®£® ° §¤¥« )
¥²®¤  ³±±  ¨±ª«¾·¥­¨¿ ­¥¨§¢¥±²­»µ, ¯°¨¬¥­¿¾¹¨©±¿ ¯°¨ ¯®±²°®¥­¨¨ LU- ¨ LUP-° §«®¦¥­¨¿, ¡»« ¯¥°¢»¬ ±¨±²¥¬ ²¨·¥±ª¨¬

®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­»¥ ±¨¬¬¥²°¨·¥±ª¨¥ ¬ ²°¨¶» ¨ ¬¥²®¤ ­ ¨¬¥­¼¸¨µ ª¢ ¤° ²®¢695

¬¥²®¤®¬ °¥¸¥­¨¿ ±¨±²¥¬ «¨­¥©­»µ ³° ¢­¥­¨© (¨ ®¤­¨¬ ¨§ ¯¥°¢»µ ·¨±«¥­­»µ  «£®°¨²¬®¢). £® ¨§®¡°¥²¥­¨¥ ®¡»·­® ±¢¿§»¢ ¾²
± ¨¬¥­¥¬ ..  ³±±  (1777-1855), µ®²¿ ®­ ¡»« ¨§¢¥±²¥­ ¨ ° ­¼¸¥.
«£®°¨²¬ ®¡° ¹¥­¨¿ §  ¢°¥¬¿ ¢°¥¬¿ O(nlg7 ) ±®¤¥°¦¨²±¿ ¢ ª« ±±¨·¥±ª®© ° ¡®²¥ ²° ±±¥­  [183]. ¨­®£° ¤ [203] § ¬¥²¨«, ·²® 
±¢®¥© ³¦¥ ³¯®¬¨­ ¢¸¥©±¿ ° ¡®²¥ [183] ·²® ³¬­®¦¥­¨¥ ¬ ²°¨¶ ­¥
±«®¦­¥¥ ®¡° ¹¥­¨¿; ®¡° ²­³¾ ®¶¥­ª³ ¯®«³·¨«¨ µ®, ®¯ª°®´² ¨
«¼¬ ­ [4].
°¥ª° ±­®¥ ¨§«®¦¥­¨¥ ²¥®°¨¨ ¯®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­»µ ±¨¬¬¥²°¨·¥±ª¨µ ¬ ²°¨¶ (¨ ¢®®¡¹¥ «¨­¥©­®©  «£¥¡°») ¨¬¥¥²±¿ ¢ ª­¨£¥
²°¥­£  [182].   ±. 334 ¥¥  ¢²®° ¯¨¸¥²: À¥­¿ · ±²® ±¯° ¸¨¢ ¾²,
¡»¢ ¾² «¨ ­¥±¨¬¬¥²°¨·­»¥ ¯®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­»µ ¬ ²°¨¶ µ.  ­¨ª®£¤  ­¥ ¨±¯®«¼§³¾ ½²®£® ²¥°¬¨­ .Á

696

« ¢  31  ²°¨¶» ¨ ¤¥©±²¢¨¿ ± ­¨¬¨

32. ­®£®·«¥­» ¨ ¡»±²°®¥ ¯°¥®¡° §®¢ ­¨¥ ³°¼¥
² ­¤ °²­»¥ ±¯®±®¡» ±«®¦¥­¨¿ ¨ ³¬­®¦¥­¨¿ ¤¢³µ ¬­®£®·«¥­®¢
±²¥¯¥­¨ n ²°¥¡³¾² ¢°¥¬¥­¨ (n) ¨ (n2 ) ±®®²¢¥²±²¢¥­­®.  ½²®©
£« ¢¥ ®¯¨±»¢ ¥²±¿, ª ª ³¬¥­¼¸¨²¼ ¢°¥¬¿ ³¬­®¦¥­¨¿ ¤® (n lg n)
¯°¨ ¯®¬®¹¨ ¡»±²°®£® ¯°¥®¡° §®¢ ­¨¿ ³°¼¥ (Fast Fourier Transform, FFT).
­®£®·«¥­»
­®£®·«¥­ (polynomial) A(x) ®² ¯¥°¥¬¥­­®© x ­ ¤ ¯®«¥¬ F (polynomial in the variable x over F ) ¨¬¥¥² ¢¨¤

A(x) =

nX
;1
j =0

aj xj :

­ ·¥­¨¿ a0, a1, : : : , an;1 ¯°¨­ ¤«¥¦ ² ¯®«¾ F (¢ ¡®«¼¸¨­±²¢¥
­ ¸¨µ ¯°¨¬¥°®¢ F ¡³¤¥² ¯®«¥¬ ª®¬¯«¥ª±­»µ ·¨±¥« C ). ­¨ ­ §»¢ ¾²±¿ ª®½´´¨¶¨¥­² ¬¨ (coecients) ¬­®£®·«¥­ .  ¨¡®«¼¸¨© ¨§
¯®ª § ²¥«¥© ±²¥¯¥­¥© ± ­¥­³«¥¢»¬¨ ª®½´´¨¶¨¥­² ¬¨ ­ §»¢ ¥²±¿
±²¥¯¥­¼¾ (degree) ¬­®£®·«¥­ .  ª¨¬ ®¡° §®¬, ­ ¸  ´®°¬³«  ¤ ¥² ®¡¹¨© ¢¨¤ ¬­®£®·«¥­  ±²¥¯¥­¨ ¬¥­¼¸¥ n (polynomial of degreebound n).
³±²¼ A(x) ¨ B (x) | ¤¢  ¬­®£®·«¥­  ±²¥¯¥­¨ ¬¥­¼¸¥ n. ±«¨ ¬»
¨µ ±«®¦¨¬, ²® ¯®«³·¨¬ ¨µ ±³¬¬³ (sum), ¬­®£®·«¥­ C (x) ±²¥¯¥­¨
¬¥­¼¸¥ n, ª®½´´¨¶¨¥­²» ª®²®°®£® ¥±²¼ ±³¬¬» ±®®²¢¥²±²¢³¾¹¨µ
ª®½´´¨¶¨¥­²®¢ A(x) ¨ B (x).  ½²®¬ ±«³· ¥ C (x) = A(x)+ B (x) ¤«¿
¢±¥µ x ¨§ ¯®«¿ F .  ª¨¬ ®¡° §®¬, ¥±«¨

A(x) =
 

B(x) =
²®

 (x) =

n;1
X
j =0
nX
;1
j =0
nX
;1
j =0

aj xj ;
bj xj ;
cj xj ;

£¤¥ cj = aj + bj ¤«¿ j = 0; 1; : : :; n ; 1.  ¯°¨¬¥°, ¥±«¨ A(x) = 6x3 +
7x2 ; 10x +9,   B (x) = ;2x3 +4x ; 5, ²®£¤  C (x) = 4x3 +7x2 ; 6x +4.
¥§³«¼² ²®¬ ³¬­®¦¥­¨¿ ¤¢³µ ¬­®£®·«¥­®¢ A(x) ¨ B (x) ¡³¤¥² ¨µ
¯°®¨§¢¥¤¥­¨¥ (product) | ¬­®£®·«¥­ C (x), ¤«¿ ª®²®°®£® C (x) =
A(x)B(x) ¤«¿ ¢±¥µ x ¨§ ¯®«¿ F . ¬­®¦¥­¨¥ ¢»¯®«­¿¥²±¿ ² ª: ª ¦¤®¥ ±« £ ¥¬®¥ ¬­®£®·«¥­  A(x) ³¬­®¦ ¥²±¿ ­  ª ¦¤®¥ ±« £ ¥¬®¥ ¬­®£®·«¥­  B (x), ¯®±«¥ ·¥£® ¢»¯®«­¿¥²±¿ ¯°¨¢¥¤¥­¨¥ ¯®¤®¡­»µ ·«¥­®¢ (±« £ ¥¬»µ ± ®¤¨­ ª®¢»¬¨ ±²¥¯¥­¿¬¨).  ¯°¨¬¥°, ¬»

®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­»¥ ±¨¬¬¥²°¨·¥±ª¨¥ ¬ ²°¨¶» ¨ ¬¥²®¤ ­ ¨¬¥­¼¸¨µ ª¢ ¤° ²®¢697

¬®¦¥¬ ³¬­®¦¨²¼ A(x) = 6x3 +7x2 ; 10x +9 ­  B (x) = ;2x3 +4x ; 5
±«¥¤³¾¹¨¬ ®¡° §®¬:
[§¤¥±¼ ¯°¨¢®¤¨²±¿ ³¬­®¦¥­¨¥ ±²®«¡¨ª®¬ - ­ ¤® ¢§¿²¼ ¥£® ¨§ ®°¨£¨­ «¼­»µ ´ ©«®¢]
%
%
%
%
%
%
%
%

6x^3 + 7x^2 - 10x + 9
-2x^3
+ 4x - 5
------------------------30x^3 - 35x^2 + 50x - 45
24x^4 +28x^3 - 40x^2 + 36x
-12x^6 -14x^5 +20x^4 -18x^3
----------------------------------------------12x^6 -14x^5 +44x^4 -20x^3 - 75x^2 + 86x - 45

°³£¨¬¨ ±«®¢ ¬¨, ¯°®¨§¢¥¤¥­¨¥ C (x) ¤¢³µ ¬­®£®·«¥­®¢ A(x) ¨
B(x) ±²¥¯¥­¨ ¬¥­¼¸¥ n ®¯°¥¤¥«¿¥²±¿ ª ª

C (x) =
£¤¥

cj =

2X
n;2

cj xj ;

(32:1)

ak bj ;k :

(32:2)

j =0

j
X
k=0

²¥¯¥­¼ ¬­®£®·«¥­ -¯°®¨§¢¥¤¥­¨¿ ° ¢­  ±³¬¬  ±²¥¯¥­¥© ±®¬­®¦¨²¥«¥©:
degree(C ) = degree(A) + degree(B ):
®½²®¬³ ¯°®¨§¢¥¤¥­¨¥ ¬­®£®·«¥­®¢ ±²¥¯¥­¥© ¬¥­¼¸¥ m ¨ n ¡³¤¥²
¬­®£®·«¥­®¬ ±²¥¯¥­¨ ¬¥­¼¸¥ m + n ; 1 (¨ ²¥¬ ¡®«¥¥ ¬¥­¼¸¥ m + n).
« ­ £« ¢»
 ° §¤¥«¥ 32.1 ° ±±¬ ²°¨¢ ¾²±¿ ¤¢¥ ±¯®±®¡  ¯°¥¤±² ¢«¥­¨¿ ¬­®£®·«¥­®¢: ª ª ­ ¡®° ª®½´´¨¶¨¥­²®¢ ¨ ± ¯®¬®¹¼¾ ­ ¡®°  §­ ·¥­¨©
¢ § ¤ ­­»µ ²®·ª µ. »¯®«­¥­¨¥ ³¬­®¦¥­¨¿ ¯® ´®°¬³«¥ (32.2) ²°¥¡³¥² ¢°¥¬¥­¨ (n2 ), ¥±«¨ ¬­®£®·«¥­» § ¤ ¾²±¿ ±¢®¨¬¨ ª®½´´¨¶¨¥­² ¬¨. ±«¨ ¬­®£®·«¥­» § ¤ ¾²±¿ ±¢®¨¬¨ §­ ·¥­¨¿¬¨ ¢ ­¥ª®²®°»µ ²®·ª µ, ²® ¤«¿ ³¬­®¦¥­¨¿ ¤®±² ²®·­® ¢°¥¬¥­¨ O(n) (³¬­®¦ ¥¬ §­ ·¥­¨¿ ¯®²®·¥·­®). ±¯®«¼§³¿ ¯¥°¥µ®¤ ®² ®¤­®£® ¯°¥¤±² ¢«¥­¨¿ ª ¤°³£®¬³ ¨ ¯®²®·¥·­®¥ ³¬­®¦¥­¨¥, ¬» ±¬®¦¥¬ ¢»¯®«­¿²¼
³¬­®¦¥­¨¥ (­ µ®¤¨²¼ ª®½´´¨¶¨¥­²» ¯°®¨§¢¥¤¥­¨¿ ¯® § ¤ ­­»¬
ª®½´´¨¶¨¥­² ¬ ±®¬­®¦¨²¥«¥©) §  ¢°¥¬¿ (n lg n). «¿ ½²®£® ­ ¬
¯®²°¥¡³¾²±¿ ª®¬¯«¥ª±­»¥ ª®°­¨ ¨§ ¥¤¨­¨¶», ¯°¥®¡° §®¢ ­¨¥ ³°¼¥ ¨ ®¡° ²­®¥ ª ­¥¬³ (° §¤¥« 32.2).  ° §¤¥«¥ 32.3 ®¯¨±»¢ ¾²±¿
¡»±²°»¥ ¯®±«¥¤®¢ ²¥«¼­»¥ ¨ ¯ ° ««¥«¼­»¥ °¥ «¨§ ¶¨¨ ¯°¥®¡° §®¢ ­¨¿ ³°¼¥.
®±ª®«¼ª³ ¬» ¯®±²®¿­­® ¨±¯®«¼§³¥¬ ª®¬¯«¥ª±­»¥ ·¨±« ,
p ¢ ½²®¬
° §¤¥«¥ ±¨¬¢®« i § °¥§¥°¢¨°®¢ ­ ¤«¿ ¬­¨¬®© ¥¤¨­¨¶» ( ;1).

698

« ¢  31  ²°¨¶» ¨ ¤¥©±²¢¨¿ ± ­¨¬¨

32.1 °¥¤±² ¢«¥­¨¥ ¬­®£®·«¥­®¢
­®£®·«¥­ ¬®¦­® § ¤ ²¼, ³ª § ¢ ¥£® ª®½´´¨¶¨¥­²»,   ¬®¦­® |
­ ¡®°®¬ ¥£® §­ ·¥­¨© ¢ ­¥ª®²®°®¬ ·¨±«¥ ²®·¥ª. ¥°¥µ®¤ ®² ®¤­®£®
±¯®±®¡  ª ¤°³£®¬³ ¡³¤¥² ¨±¯®«¼§®¢ ­ ¤«¿ ³¬­®¦¥­¨¿ ¤¢³µ ¬­®£®·«¥­®¢ ±²¥¯¥­¨ ¬¥­¼¸¥ n §  ¢°¥¬¿ (n lg n).
 ¤ ­¨¥ ¬­®£®·«¥­  ¢¥ª²®°®¬ ª®½´´¨¶¨¥­²®¢
nP
;1
­®£®·«¥­ A(x) = aj xj ¬®¦¥² ¡»²¼ § ¤ ­ ¢¥ª²®°®¬ ª®½´´¨j =0
¶¨¥­²®¢ a = (a0; a1; : : :; an;1 ) (coecient representation). ( ¬ ²°¨·­»µ ³° ¢­¥­¨¿µ ½²®£® ° §¤¥«  ¬» ¡³¤¥¬ ¨±¯®«¼§®¢ ²¼ ¢ ®±­®¢­®¬
¢¥ª²®°»-±²®«¡¶».)
°¥¤±² ¢«¥­¨¥ ¬­®£®·«¥­  ª®½´´¨¶¨¥­² ¬¨ ³¤®¡­® ¢ ¶¥«®¬ °¿¤¥ ±«³· ¥¢.  ¯°¨¬¥°, ®¯¥° ¶¨¿ ¢»·¨±«¥­¨¿ §­ ·¥­¨¿ ¬­®£®·«¥­ 
A(x) ¢ ¤ ­­®© ²®·ª¥ x0 (evaluating the polynomial at a given point)
¬®¦¥² ¡»²¼ ¢»¯®«­¥­  §  ¢°¥¬¿ (n) ¯® ±µ¥¬¥ ®°­¥°  (Horner's
rule):
A(x0 ) = a0 + x0(a1 + x0(a2 +    + x0(an;1 )) : : : )):
«®¦¥­¨¥ ¬­®£®·«¥­®¢, § ¤ ­­»µ ¢¥ª²®° ¬¨ ª®½´´¨¶¨¥­²®¢, ² ª¦¥ ²°¥¡³¥² ¢°¥¬¥­¨ (n): ¥±«¨ ¬­®£®·«¥­» § ¤ ­» ¢¥ª²®° ¬¨ ª®½´´¨¶¨¥­²®¢ a = (a0; a1; : : :; an;1 ) ¨ b = (b0; b1; : : :; bn;1), ²® ¨µ ±³¬¬  § ¤ ¥²±¿ ¢¥ª²®°®¬ c = (c0; c1; : : :; cn;1 ), ¢ ª®²®°®¬ cj = aj + bj
¤«¿ j = 0; 1; : : :; n ; 1.
¥¯¥°¼ ° ±±¬®²°¨¬ ³¬­®¦¥­¨¥ ¤¢³µ ¬­®£®·«¥­®¢ A(x) ¨ B (x),
±²¥¯¥­¨ ­¨¦¥ n. ±«¨ ­¥¯®±°¥¤±²¢¥­­® ¨±¯®«¼§®¢ ²¼ ´®°¬³«³
32.2), ²® ­  ¢»·¨±«¥­¨¿ ¯®²°¥¡³¥²±¿ ¢°¥¬¿ (n2 ), ¯®±ª®«¼ª³ ª ¦¤»© ª®½´´¨¶¨¥­² ¢¥ª²®°  a ­ ¤® ³¬­®¦¨²¼ ­  ª ¦¤»© ª®½´´¨¶¨¥­² ¢¥ª²®°  b. ®½²®¬³ ¢ ¦­® ­ ³·¨²¼±¿ ½ª®­®¬¨²¼ ¯°¨ ³¬­®¦¥­¨¨ | ± ¬®© ²°³¤®¥¬ª®© ¨§ ° ±±¬®²°¥­­»µ ®¯¥° ¶¨©. °³£¨¬¨
±«®¢ ¬¨, ¬» µ®²¨¬ ¡»±²°® ¢»·¨±«¿²¼ ¢¥ª²®° c, § ¤ ­­»© ³° ¢­¥­¨¥¬ (32.2). ­ ­ §»¢ ¥²±¿ ±¢¥°²ª®© (convolution) ¢¥ª²®°®¢ a ¨
b ¨ ®¡®§­ · ¥²±¿ c = a 
 b. »·¨±«¥­¨¥ ±¢¥°²ª¨ (¨­»¬¨ ±«®¢ ¬¨,
³¬­®¦¥­¨¥ ¬­®£®·«¥­®¢, § ¤ ­­»µ ¢¥ª²®° ¬¨ ª®½´´¨¶¨¥­²®¢) · ±²® ¢±²°¥· ¥²±¿ ­  ¯° ª²¨ª¥.
 ¤ ­¨¥ ¬­®£®·«¥­  ­ ¡®°®¬ §­ ·¥­¨©
¨ª±¨°³¥¬ n ° §«¨·­»µ ²®·¥ª x0 ; x1; : : : ; xn;1 . ­®£®·«¥­ A(x)
±²¥¯¥­¨ ­¨¦¥ n ®¤­®§­ ·­® ®¯°¥¤¥«¿¥²±¿ ±¢®¨¬¨ §­ ·¥­¨¿¬¨ ¢ ½²¨µ
²®·ª µ, ²® ¥±²¼ ­ ¡®°®¬ ¨§ n ¯ °  °£³¬¥­²-§­ ·¥­¨¥
f(x0; y0); (x1; y1); : : :; (xn;1; yn;1)g;
£¤¥
yk = A(xk )
(32:3)
¤«¿ k = 0; 1; : : :; n ; 1.  ª¨¬ ®¡° §®¬, ¤«¿ ª ¦¤®£® ­ ¡®°  ²®·¥ª
x0; x1; : : :; xn;1 ¬» ¯®«³· ¥¬ ±¢®© ±¯®±®¡ ¯°¥¤±² ¢«¥­¨¿ ¬­®£®·«¥­®¢ ± ¯®¬®¹¼¾ §­ ·¥­¨© ¢ ½²¨µ ²®·ª µ.

®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­»¥ ±¨¬¬¥²°¨·¥±ª¨¥ ¬ ²°¨¶» ¨ ¬¥²®¤ ­ ¨¬¥­¼¸¨µ ª¢ ¤° ²®¢699

¥°¥µ®¤ ®² ª®½´´¨¶¨¥­²®¢ ¬­®£®·«¥­  A(x) ª ¥£® §­ ·¥­¨¿¬
²°¥¡³¥² ¢°¥¬¥­¨ (n2 ), ¥±«¨ ¬» ¢»·¨±«¿¥¬ ®²¤¥«¼­® §­ ·¥­¨¥ ¢
ª ¦¤®© ¨§ n ²®·¥ª ¯® ±µ¥¬¥ ®°­¥°  §  (n) ¸ £®¢.  ¤ «¼­¥©¸¥¬ ¬» ³¢¨¤¨¬, ·²® ¢°¥¬¿ ¬®¦­® ±®ª° ²¨²¼ | ¯°¨ ¯®¤µ®¤¿¹¥¬
¢»¡®°¥ ²®·¥ª ¤®±² ²®·­® O(n lg n) ®¯¥° ¶¨©.
¡° ²­»© ¯¥°¥µ®¤ | ®² ­ ¡®°  §­ ·¥­¨© ¬­®£®·«¥­  ª ¥£® ª®½´´¨¶¨¥­² ¬ | ­ §»¢ ¥²±¿ ¨­²¥°¯®«¿¶¨¥© (interpolation). «¥¤³¾¹ ¿ ²¥®°¥¬  ³²¢¥°¦¤ ¥², ·²® ¨­²¥°¯®«¿¶¨¿ ¢»¯®«­¿¥²±¿ ®¤­®§­ ·­®, ¥±«¨ ±²¥¯¥­¼ ¬­®£®·«¥­  ¬¥­¼¸¥ ·¨±«  ²®·¥ª ¨­²¥°¯®«¿¶¨¨.
¥®°¥¬  32.1 (¤­®§­ ·­®±²¼ ¨­²¥°¯®«¿¶¨¨)
«¿ «¾¡®£® ¬­®¦¥±²¢  f(x0; y0 ); (x1; y1); : : :; (xn;1 ; yn;1 )g ¯ °
 °£³¬¥­²-§­ ·¥­¨¥ (¢±¥ xi ° §«¨·­») ±³¹¥±²¢³¥² ¥¤¨­±²¢¥­­»©
¬­®£®·«¥­ A(x) ±²¥¯¥­¨ ­¨¦¥ n, ¤«¿ ª®²®°®£® yk = A(xk ) ¤«¿
k = 0; 1; : : :; n ; 1.
®ª § ²¥«¼±²¢®
¥®°¥¬  ³²¢¥°¦¤ ¥², ·²® ­¥ª®²®° ¿ ¬ ²°¨¶  ®¡° ²¨¬ .  ± ¬®¬
¤¥«¥, ³° ¢­¥­¨¥ (32.3) ¬®¦­® § ¯¨± ²¼ ¢ ¬ ²°¨·­®¬ ¢¨¤¥:
0

10

1

0

1

1 x0 x20 : : : xn0 ;1
a0
y0
2 : : : xn;1 C B a1 C B y1 C
B 1
x
x
1
1
1 CB
B
B
C
(32:4)
B .
B
C=B . C
.. C
..
.. . . . .. C
.
@ ..
A
@
A
@
.
. A
.
.
.
an;1
yn;1
1 xn;1 x2n;1 : : : xnn;;11
¥¢ ¿ ¬ ²°¨¶  ­ §»¢ ¥²±¿ ¬ ²°¨¶¥©  ­¤¥°¬®­¤  (Vandermonde
matrix) ¨ ®¡®§­ · ¥²±¿ V (x0; x1; : : :; xn;1).  ª ³²¢¥°¦¤ ¥² ³¯° ¦­¥­¨¥ 31.1-10, ®¯°¥¤¥«¨²¥«¼ ½²®© ¬ ²°¨¶» ° ¢¥­
Y

j<k

(xk ; xj );

¨ ¯® ²¥®°¥¬¥ 31.5 ½²  ¬ ²°¨¶  ¿¢«¿¥²±¿ ®¡° ²¨¬®© (­¥¢»°®¦¤¥­­®©), ¥±«¨ xk ° §«¨·­». ®½²®¬³ ª®½´´¨¶¨¥­²» ¬­®£®·«¥­  aj ®¤­®§­ ·­® ®¯°¥¤¥«¿¾²±¿ ¯® ´®°¬³«¥

a = V (x0; x1; : : :; xn;1);1y:
²® ¤®ª § ²¥«¼±²¢® ±¢®¤¨² § ¤ ·³ ¨­²¥°¯®«¿¶¨¨ ª °¥¸¥­¨¾ ±¨±²¥¬» «¨­¥©­»µ ³° ¢­¥­¨© (32.4). ±«¨ ¤¥« ²¼ ½²® ¯® ®¡¹¨¬ ¯° ¢¨« ¬ °¥¸¥­¨¿ ±¨±²¥¬ «¨­¥©­»µ ³° ¢­¥­¨©, ®¯¨± ­­»¬ ¢ £« ¢¥ 31
(LU-° §«®¦¥­¨¥), ¯®²°¥¡³¥²±¿ ¢°¥¬¿ O(n3 ). ®«¥¥ ¡»±²°»©  «£®°¨²¬ ¨­²¥°¯®«¿¶¨¨ ®±­®¢»¢ ¥²±¿ ­  ´®°¬³«¥  £° ­¦ :
Q
(x ; xj )
n;1
X
jQ
6=k
(32:5)
A(x) = yk (x ; x ) :
k
j
k=0
j 6=k

700

« ¢  31  ²°¨¶» ¨ ¤¥©±²¢¨¿ ± ­¨¬¨

¡¥¤¨²¥±¼, ·²® ¯° ¢ ¿ · ±²¼ (32.5) ¯°¥¤±² ¢«¿¥² ±®¡®© ¬­®£®·«¥­ ±²¥¯¥­¨ ¬¥­¼¸¥ n ¨ ·²® A(xk ) = yk ¤«¿ ¢±¥µ k.  ³¯° ¦­¥­¨¨
32.1-4 ¯°¥¤« £ ¥²±¿ ¯®ª § ²¼, ·²® ± ¯®¬®¹¼¾ ´®°¬³«»  £° ­¦ 
¬®¦­® ¢»·¨±«¨²¼ ª®½´´¨¶¨¥­²» ¬­®£®·«¥­  A §  ¢°¥¬¿ (n2 ).
 ª¨¬ ®¡° §®¬, ¬» ¬®¦¥¬ ¯¥°¥µ®¤¨²¼ ®² ­ ¡®°  n ª®½´´¨¶¨¥­²®¢ ª ­ ¡®°³ §­ ·¥­¨© ¢ n ²®·ª µ ¨ ®¡° ²­® §  O(n2) ®¯¥° ¶¨©.
(­²¥°¯®«¿¶¨¿ ¿¢«¿¥²±¿ ¢»·¨±«¨²¥«¼­® ­¥³±²®©·¨¢®© ®¯¥° ¶¨¥©.
®²¿ ®¯¨± ­­»© §¤¥±¼ ¯®¤µ®¤ ¬ ²¥¬ ²¨·¥±ª¨ ª®°°¥ª²¥­, ­ ¤® ¯®­¨¬ ²¼, ·²® ­¥¡®«¼¸®¥ ¨§¬¥­¥­¨¥ ¢µ®¤­»µ §­ ·¥­¨© ¨«¨ ®¸¨¡ª¨
®ª°³£«¥­¨¿ ¢® ¢°¥¬¿ ¢»·¨±«¥­¨© ¬®£³² ¢»§¢ ²¼ ±¨«¼­®¥ ¨§¬¥­¥­¨¥
°¥§³«¼² ² .)
°¥¤±² ¢«¥­¨¥ ¬­®£®·«¥­  ± ¯®¬®¹¼¾ §­ ·¥­¨© ¢ § ¤ ­­»µ ²®·ª µ ³¤®¡­® ¤«¿ ¬­®£¨µ ®¯¥° ¶¨©: ­ ¯°¨¬¥°, ¤«¿ ±«®¦¥­¨¿ ¤®±² ²®·­® ±«®¦¨²¼ §­ ·¥­¨¿ ¬­®£®·«¥­®¢ ¢ ª ¦¤®© ¨§ ²®·¥ª. °³£¨¬¨
±«®¢ ¬¨, ¥±«¨ ¬­®£®·«¥­ A(x) § ¤ ­ ­ ¡®°®¬ ¯ °

f(x0; y0); (x1; y1); : : :; (xn;1; yn;1)g;
  ¬­®£®·«¥­ B | ­ ¡®°®¬

f(x0; y00 ); (x1; y10 ); : : :; (xn;1; yn0 ;1)g;
(§ ¬¥²¼²¥, ·²® §­ ·¥­¨¿ A ¨ B § ¤ ­» ¢ ®¤­¨µ ¨ ²¥µ ¦¥ n ²®·ª µ),
²® ¬­®£®·«¥­ C (x) § ¤ ¥²±¿ ¯ ° ¬¨
f(x0; y0 + y00 ); (x1; y1 + y10 ); : : :; (xn;1; yn;1 + yn0 ;1 )g:
®¤®¡­»¬ ®¡° §®¬ ¬®¦­® ¯®±²³¯ ²¼ ¨ ± ³¬­®¦¥­¨¥¬, ¯¥°¥¬­®¦ ¿ §­ ·¥­¨¿ ¢ ª ¦¤®© ²®·ª¥ ¯® ®²¤¥«¼­®±²¨.  ¤® ¨¬¥²¼ ¢ ¢¨¤³,
®¤­ ª®, ·²® ¯°¨ ³¬­®¦¥­¨¨ ±²¥¯¥­¨ ¬­®£®·«¥­®¢ ±ª« ¤»¢ ¾²±¿,
¨ ¯°®¨§¢¥¤¥­¨¥ ¤¢³µ ¬­®£®·«¥­®¢ ±²¥¯¥­¨ ¬¥­¼¸¥ n ¬®¦¥² ¨¬¥²¼
±²¥¯¥­¼ ¡®«¼¸¥ n. ­  § ¢¥¤®¬® ¬¥­¼¸¥ 2n (¤ ¦¥ 2n ; 1), ² ª ·²®
¤«¿ ¢®±±² ­®¢«¥­¨¿ ¯°®¨§¢¥¤¥­¨¿ ¤®±² ²®·­® 2n ²®·¥ª (²¥®°¥¬ 
32.1).  ª¨¬ ®¡° §®¬, ³¬­®¦ ¿ ¤¢  ¬­®£®·«¥­  A ¨ B ±²¥¯¥­¨ ¬¥­¼¸¥ n, ¯®«¥§­® ± ± ¬®£® ­ · «  ¨¬¥²¼ §­ ·¥­¨¿ ¬­®£®·«¥­®¢ A ¨ B
­¥ ¢ n,   ¢ 2n ²®·ª µ (®¤­¨µ ¨ ²¥µ ¤«¿ ¤«¿ A ¨ B ). ®±«¥ ½²®£® ½²¨ §­ ·¥­¨¿ ¬®¦­® ¯¥°¥¬­®¦¨²¼ §  §  ¢°¥¬¿ (n) ¨ ¯®«³·¨²¼
¯°¥¤±² ¢«¥­¨¥ ¯°®¨§¢¥¤¥­¨¿ C = AB ¢ ¢¨¤¥ ­ ¡®°  ¯ °  °£³¬¥­²{
§­ ·¥­¨¥. (° ¢­¨²¥ ½²® ¢°¥¬¿ ± (n2 ) ¯°¨ ¢»·¨±«¥­¨¨ ª®½´´¨¶¨¥­²®¢ ¯°®¨§¢¥¤¥­¨¿ ¯® ´®°¬³«¥ (32.2).)
±² «®±¼ ®¡±³¤¨²¼ ² ª®© ¢®¯°®±: ¬» §­ ¥¬ §­ ·¥­¨¿ ¬­®£®·«¥­ 
¢ § ¤ ­­»µ ²®·ª µ; ª ª ­ ©²¨ ¥£® §­ ·¥­¨¥ ¢ ²®·ª¥, ª®²®°®© ­¥²
±°¥¤¨ ­¨µ? ®-¢¨¤¨¬®¬³, ­¥² ¡®«¥¥ ¯°®±²®£® ±¯®±®¡  ±¤¥« ²¼ ½²®,
·¥¬ ±­ · «  ­ ©²¨ ª®½´´¨¶¨¥­²» ¬­®£®·«¥­ ,   § ²¥¬ ¢»·¨±«¨²¼
¥£® §­ ·¥­¨¥ ¢ ­³¦­®© ²®·ª¥.
»±²°®¥ ³¬­®¦¥­¨¥ ¬­®£®·«¥­®¢, § ¤ ­­»µ ¢¥ª²®°®¬ ª®½´´¨¶¨¥­²®¢

®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­»¥ ±¨¬¬¥²°¨·¥±ª¨¥ ¬ ²°¨¶» ¨ ¬¥²®¤ ­ ¨¬¥­¼¸¨µ ª¢ ¤° ²®¢701

 ¤¯¨±¨ ­  ± ¬®© ª °²¨­ª¥
­  ±²°¥«ª µ:
¡»·­®¥ ³¬­®¦¥­¨¥, ¢°¥¬¿ (n2 )
»·¨±«¥­¨¥ §­ ·¥­¨©, ¢°¥¬¿ (n lg n)
­²¥°¯®«¿¶¨¿, ¢°¥¬¿ (n lg n)
®²®·¥·­®¥ ³¬­®¦¥­¨¥, ¢°¥¬¿ (n)
¢ ¯° ¢®¬ ±²®«¡¶¥:
°¥¤±² ¢«¥­¨¥ ­ ¡®°®¬ ª®½´´¨¶¨¥­²®¢
°¥¤±² ¢«¥­¨¥ ­ ¡®°®¬ §­ ·¥­¨©
32.1 µ¥¬  ¡»±²°®£®  «£®°¨²¬  ³¬­®¦¥­¨¿ ¬­®£®·«¥­®¢.  ¢¥°µ­¥©
· ±²¨ °¨±³­ª  ¬­®£®·«¥­» § ¤ ­» ¢¥ª²®° ¬¨ ª®½´´¨¶¨¥­²®¢, ¢ ­¨¦­¥© | §­ ·¥­¨¿¬¨. ²°¥«ª¨, ¨¤³¹¨¥ ±«¥¢  ­ ¯° ¢®, ±®®²¢¥²±²¢³¾² ³¬­®¦¥­¨¾. ¨¬¢®«»
!2i n ®¡®§­ · ¾² ª®¬¯«¥ª±­»¥ ª®°­¨ ¨§ ¥¤¨­¨¶» ±²¥¯¥­¨ 2n.
¨±. 31.2

±«¨ ­ ³·¨²¼±¿ ¡»±²°® ¯¥°¥µ®¤¨²¼ ®² ª®½´´¨¶¨¥­² ¬ ª §­ ·¥­¨¿¬ ¨ ®¡° ²­®, ²® ¯®¿¢¨²±¿ ¢®§¬®¦­®±²¼ ¨±¯®«¼§®¢ ²¼ ¢®§¬®¦­®±²¼ §  «¨­¥©­®¥ ¢°¥¬¿ ³¬­®¦¨²¼ §­ ·¥­¨¿ ¢ ¤ ­­»µ ²®·ª µ ¤«¿
¡»±²°®£® ³¬­®¦¥­¨¿ ¬­®£®·«¥­®¢, § ¤ ­­»µ ¢¥ª²®°®¬ ª®½´´¨¶¨¥­²®¢ (®² ª®½´´¨¶¨¥­²®¢ ¯¥°¥µ®¤¨¬ ª §­ ·¥­¨¿¬ | ¯¥°¥¬­®¦ ¥¬
| ¯¥°¥µ®¤¨¬ ®¡° ²­®).
°¨ ½²®¬ ¬®¦­® ¨±¯®«¼§®¢ ²¼ «¾¡®© ­ ¡®° ¨§ n ° §«¨·­»µ ²®·¥ª, ­® ¢»¡° ¢ ¨µ ³¤®¡­»¬ ®¡° §®¬, ¬®¦­® ±®ª° ²¨²¼ ¢°¥¬¿ ¯°¥®¡° §®¢ ­¨¿ ¢ ²³ ¨ ¤°³£³¾ ±²®°®­³ ¤® (n lg n).  ª ¬» ³¢¨¤¨¬ ¢
° §¤¥«¥ 32.2, ³¤®¡­® ¢§¿²¼ ¢ ª ·¥±²¢¥ ²®·¥ª ª®¬¯«¥ª±­»¥ ª®°­¨ ¨§
¥¤¨­¨¶», ¢ ½²®¬ ±«³· ¥ ®¡  ¯¥°¥µ®¤  ±¢¥¤³²±¿ ª ² ª ­ §»¢ ¥¬®¬³
¤¨±ª°¥²­®¬³ ¯°¥®¡° §®¢ ­¨¾ ³°¼¥ (Discrete Fourier Transform,
DFT) ¨ ®¡° ²­®¬³ ª ­¥¬³ ¯°¥®¡° §®¢ ­¨¾, ª®²®°»¥ ¢»¯®«­¿¾²±¿
§  (n lg n) ®¯¥° ¶¨©.
²®² ¯« ­ ¤¥©±²¢¨© ¨§®¡° ¦¥­ ­  °¨±. 32.1.  ª ¬» ³¦¥ £®¢®°¨«¨, ¯°¨ ³¬­®¦¥­¨¨ ¤¢³µ ¬­®£®·«¥­®¢ ±²¥¯¥­¨ ¬¥­¼¸¥ n ¯®«³· ¥²±¿ ¬­®£®·«¥­ ±²¥¯¥­¨ ¬¥­¼¸¥ 2n, ¯®½²®¬³ ¤«¿ ­ · «  ¬» ¤®¯®«­¿¥¬ ¬­®£®·«¥­»{±®¬­®¦¨²¥«¨ ­³«¥¢»¬¨ ª®½´´¨¶¨¥­² ¬¨ ±² °¸¨µ ±²¥¯¥­¥©. ®±«¥ ½²®£® ¬» ¨¬¥¥¬ ¤¥«® ± ¬­®£®·«¥­ ¬¨ ±²¥¯¥­¨
¬¥­¼¸¥ 2n, ¨ ¯®²®¬³ ¨±¯®«¼§³¥¬ Àª®¬¯«¥ª±­»¥ ª®°­¨ ±²¥¯¥­¨ 2n
¨§ ¥¤¨­¨¶»Á, ®¡®§­ · ¥¬»¥ !2i n ¯°¨ i = 0; 1; : : : ; 2n ; 1.
² ª, ¯®¢²®°¨¬ ¥¹¥ ° §, ª ª ³¬­®¦ ²¼ ¤¢  ¬­®£®·«¥­  A(x) ¨
B(x) ±²¥¯¥­¨ ¬¥­¼¸¥ n. » ¯°¥¤¯®« £ ¥¬, ·²® n ¿¢«¿¥²±¿ ±²¥¯¥­¼¾
¤¢®©ª¨ | ½²®£® ¢±¥£¤  «¥£ª® ¤®±²¨·¼, ¤®¡ ¢«¿¿ ­³«¥¢»¥ ª®½´´¨¶¨¥­²» ±² °¸¨µ ±²¥¯¥­¥©.
1. ¤¢®¥­¨¥ ª®«¨·¥±²¢  ª®½´´¨¶¨¥­²®¢. ®¯®«­¨²¼ ¢¥ª²®°  ª®½´´¨¶¨¥­²®¢, § ¤ ¾¹¨¥ ¬­®£®·«¥­» A(x) ¨ B (x), ­³«¥¢»¬¨ ª®½´´¨¶¨¥­² ¬¨ ±² °¸¨µ ±²¥¯¥­¥© ² ª, ·²®¡» ¢ ¢¥ª²®° µ ª®½´´¨¶¨¥­²®¢ ±² «® ¯® 2n ½«¥¬¥­²®¢.
2. »·¨±«¥­¨¥ §­ ·¥­¨©. °¨ ¯®¬®¹¨ ¡»±²°®£® ¯°¥®¡° §®¢ ­¨¿
³°¼¥ (¯°¨¬¥­¿¥¬®£® ¤¢ ¦¤» | ¤«¿ A ¨ ¤«¿ B ) ¢»·¨±«¨²¼ §­ ·¥-

702

« ¢  31  ²°¨¶» ¨ ¤¥©±²¢¨¿ ± ­¨¬¨

­¨¿ ¬­®£®·«¥­®¢ A(x) ¨ B (x) ¢ ²®·ª µ, ¿¢«¿¾¹¨µ±¿ ª®°­¿¬¨ ±²¥¯¥­¨ 2n ¨§ ¥¤¨­¨¶».
3. ®²®·¥·­®¥ ³¬­®¦¥­¨¥. ®²®·¥·­® ³¬­®¦¨²¼ ¯®«³·¥­­»¥ §­ ·¥­¨¿ ¬­®£®·«¥­®¢ A(x) ¨ B (x) ¤°³£ ­  ¤°³£ .  °¥§³«¼² ²¥ ¯®«³· ¾²±¿ §­ ·¥­¨¿ ¬­®£®·«¥­  C (x) = A(x)B (x) ¢ ª®°­¿µ ±²¥¯¥­¨ 2n
¨§ ¥¤¨­¨¶».
4. ­²¥°¯®«¿¶¨¿. ®«³·¨²¼ ª®½´´¨¶¨¥­²» ¬­®£®·«¥­  C (x) ¯°¨
¯®¬®¹¨ ®¡° ²­®£® ¡»±²°®£® ¯°¥®¡° §®¢ ­¨¿ ³°¼¥, ¯°¨¬¥­¥­­®£®
¥£® §­ ·¥­¨¿¬ ¢ ª®°­¿µ ¨§ ¥¤¨­¨¶».
 £¨ 1 ¨ 3 ²°¥¡³¾² ¢°¥¬¥­¨ (n),   ¸ £¨ 2 ¨ 4 | ¢°¥¬¥­¨
(n lg n), ª ª ¬» ³¢¨¤¨¬ ¢ ±«¥¤³¾¹¥¬ ° §¤¥«¥. ¥¬ ± ¬»¬ ¡³¤¥²
¤®ª § ­  ±«¥¤³¾¹ ¿ ²¥®°¥¬ :
¥®°¥¬  32.2
°®¨§¢¥¤¥­¨¥ ¤¢³µ ¬­®£®·«¥­®¢ ±²¥¯¥­¨ ¬¥­¼¸¥ n ¬®¦¥² ¡»²¼
¢»·¨±«¥­® §  (n lg n) ®¯¥° ¶¨©. (­®£®·«¥­» ­  ¢µ®¤¥ ¨ ¢»µ®¤¥
§ ¤ ¾²±¿ ¢¥ª²®° ¬¨ ª®½´´¨¶¨¥­²®¢.)
¯° ¦­¥­¨¿
32.1-1
 ©¤¨²¥ ¯°®¨§¢¥¤¥­¨¥ ¬­®£®·«¥­®¢ A(x) = 7x3 ; x2 + x ; 10 ¨
B(x) = 8x3 ; 6x + 3, ¨±¯®«¼§³¿ ´®°¬³«³ (32.2).
32.1-2
­ ·¥­¨¥ ¬­®£®·«¥­  A(x) ±²¥¯¥­¨ ¬¥­¼¸¥ n ¢ ¤ ­­®© ²®·ª¥ x0
¬®¦­® ­ ©²¨, ° §¤¥«¨¢ A(x) ­  ¬­®£®·«¥­ (x ; x0) ¨ ¯®«³·¨¢ · ±²­®¥ q (x) (ª®²®°®¥ ¿¢«¿¥²±¿ ¬­®£®·«¥­®¬ ±²¥¯¥­¨ ¬¥­¼¸¥ n ; 1) ¨
®±² ²®ª r, ¤«¿ ª®²®°»µ
A(x) = q (x)(x ; x0 ) + r:
±­®, ·²® A(x0 ) = r. ®ª ¦¨²¥, ª ª ¢»·¨±«¨²¼ ®±² ²®ª r ¨ ª®½´´¨¶¨¥­²» ¬­®£®·«¥­  q (x) §  ¢°¥¬¿ (n), ¥±«¨ ¤ ­» x0 ¨ ª®½´´¨¶¨¥­²» ¬­®£®·«¥­  A.
32.1-3
P ;1
­®£®·«¥­ A(x) = nj =0
aj xj § ¤ ­ ­ ¡®°®¬ ±¢®¨µ §­ ·¥­¨© ¢ n
®²«¨·­»µ ®² 0 ²®·ª µ. ª ¦¨²¥
n ¯ °  °£³¬¥­²-§­ ·¥­¨¥, § ¤ ¾P ;1
¹¨µ ¬­®£®·«¥­ Arev (x) = nj =0
an;1;j xj . (°³£¨¬¨ ±«®¢ ¬¨, ­ ¤®
³ª § ²¼ n ° §«¨·­»µ ²®·¥ª ¨ ­ ©²¨ §­ ·¥­¨¿ ¬­®£®·«¥­  Arev ¢
½²¨µ ²®·ª µ.)
32.1-4
®ª ¦¨²¥, ª ª ¨±¯®«¼§®¢ ²¼ ´®°¬³«³ (32.5)Q¤«¿ ¨­²¥°¯®«¿¶¨¨
§  ¢°¥¬¿ (n2 ). (ª § ­¨¥: ­ · «  ¢»·¨±«¨²¥ k (x ; xk ), ¤«¿ ¢»·¨±«¥­¨¿ j -®£® ±« £ ¥¬®£® ­ ¤® ° §¤¥«¨²¼ ¯®«³·¥­­»© ¬­®£®·«¥­
­  (x ; xj ). ¬. ³¯° ¦­¥­¨¥ 32.1-2.)
32.1-5
®·¥¬³ ­¥ ³¤ ¥²±¿ ¤¥«¨²¼ ¬­®£®·«¥­» ²¥¬ ¦¥ ¬¥²®¤®¬, ¤¥«¿ ¨µ
§­ ·¥­¨¿ ¯®²®·¥·­®?  ±±¬®²°¨²¥ ®²¤¥«¼­® ±«³· ¨, ª®£¤  ¬­®£®·«¥­» ¤¥«¿²±¿ ¤°³£ ­  ¤°³£  ­ ¶¥«® ¨ ¨ ª®£¤  ¨¬¥¥²±¿ ®±² ²®ª.
32.1-6

®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­»¥ ±¨¬¬¥²°¨·¥±ª¨¥ ¬ ²°¨¶» ¨ ¬¥²®¤ ­ ¨¬¥­¼¸¨µ ª¢ ¤° ²®¢703
¨±. 31.3

e

32.2 ­ ·¥­¨¿ !0 ; !1 ; : : : ; !7 ­  ª®¬¯«¥ª±­®© ¯«®±ª®±²¨, £¤¥ !8 =

8
8
8
i=8 | £« ¢­®¥ §­ ·¥­¨¥ ª®°­¿
±²¥¯¥­¨ 8 ¨§ ¥¤¨­¨¶».

2

 ±±¬®²°¨¬ ¤¢  ¬­®¦¥±²¢ , A ¨ B , ª ¦¤®¥ ¨§ ª®²®°»µ ±®¤¥°¦¨² n ¶¥«»µ ·¨±¥« ¢ ¤¨ ¯ §®­¥ ®² 0 ¤® 10n. » µ®²¨¬ ­ ©²¨ ¨µ
¤¥ª °²®¢³ ±³¬¬³ (Cartesian sum) A ¨ B , ®¯°¥¤¥«¿¥¬³¾ ª ª

C = fx + y : x 2 A ¨ y 2 Bg:
 ¬¥²¼²¥, ·²® C ¬®¦¥² ±®¤¥°¦ ²¼ ¶¥«»¥ ·¨±«  ®² 0 ¤® 20n.  ± ¨­²¥°¥±³¾² ½«¥¬¥­²» ¬­®¦¥±²¢  C ,   ² ª¦¥ ¨µ Àª° ²­®±²¨Á (±ª®«¼ª¨¬¨ ±¯®±®¡ ¬¨ ¤ ­­»© ½«¥¬¥­² ¬®¦­® ¯®«³·¨²¼, ±«®¦¨¢ ½«¥¬¥­²
A ± ½«¥¬¥­²®¬ B ). ®ª ¦¨²¥, ·²® ½²  § ¤ ·  ¬®¦¥² ¡»²¼ °¥¸¥­  §  ¢°¥¬¿ (n lg n). (ª § ­¨¥: ¯°¥¤±² ¢¼²¥ A ¨ B ¬­®£®·«¥­ ¬¨
±²¥¯¥­¨ ­¥ ¡®«¼¸¥ 10n.)
32.2 ¨±ª°¥²­®¥ ¯°¥®¡° §®¢ ­¨¥ ³°¼¥. »±²°»©  «£®°¨²¬
 ° §¤¥«¥ 32.1 ¬» ±®¡¨° «¨±¼ ¨±¯®«¼§®¢ ²¼ ª®¬¯«¥ª±­»¥ ª®°­¨
¨§ ¥¤¨­¨¶» ª ª ²®·ª¨, ¢ ª®²®°»µ ¢»·¨±«¿¾²±¿ §­ ·¥­¨¿ ¬­®£®·«¥­ , ¨ £®¢®°¨«¨, ·²® ¢»·¨±«¥­¨¥ §­ ·¥­¨© ¢ ­¨µ ¨ ¨­²¥°¯®«¿¶¨¿ ¯°®¢®¤¿²±¿ §  ¢°¥¬¿ O(n lg n). » ±¥©· ± ®¡º¿±­¨¬, ª ª ½²®
¤¥« ¥²±¿ ± ¨±¯®«¼§®¢ ­¨¥¬ ¤¨±ª°¥²­®£® ¯°¥®¡° §®¢ ­¨¿ ³°¼¥ ¨
¡»±²°®£®  «£®°¨²¬  ¥£® ¢»¯®«­¥­¨¿.
®¬¯«¥ª±­»¥ ª®°­¨ ¥¤¨­¨¶»
®¬¯«¥ª±­»¬ ª®°­¥¬ ±²¥¯¥­¨ n ¨§ ¥¤¨­¨¶» (complex nth root of
unity) ­ §»¢ ¾² ² ª®¥ ª®¬¯«¥ª±­®¥ ·¨±«® ! , ·²®

! n = 1:
¬¥¥²±¿ °®¢­® n ª®¬¯«¥ª±­»µ ª®°­¥© ±²¥¯¥­¨ n ¨§ ¥¤¨­¨¶». ­¨
¨¬¥¾² ¢¨¤ e2ik=n ¤«¿ k = 0; 1; : : : ; n ; 1. ±¯®¬¨­ ¿ ´®°¬³«³ ¤«¿
½ª±¯®­¥­²» ª®¬¯«¥ª±­®£® ·¨±« , ¬®¦­® ­ ¯¨± ²¼

eiu = cos u + i sin u:
  °¨±³­ª¥ 32.2 ¢¨¤­®, ·²® ª®¬¯«¥ª±­»¥ ª®°­¨ ¥¤¨­¨¶» ° ¢­®¬¥°­® ° ±¯°¥¤¥«¥­» ­  ®ª°³¦­®±²¨ ¥¤¨­¨·­®£® ° ¤¨³±  ± ¶¥­²°®¬ ¢
­³«¥. ­ ·¥­¨¥
!n = e2i=n
(32:6)
­ §»¢ ¥²±¿ £« ¢­»¬ §­ ·¥­¨¥¬ ª®°­¿ ±²¥¯¥­¨ n ¨§ ¥¤¨­¨¶» (the
principal nth root of unity). ±² «¼­»¥ ª®°­¨ ¨§ ¥¤¨­¨¶» ¿¢«¿¾²±¿
¥£® ±²¥¯¥­¿¬¨.
®¬¯«¥ª±­»¥ ª®°­¨ ±²¥¯¥­¨ n ¨§ ¥¤¨­¨¶» ®¡° §³¾² £°³¯¯³ ¯®
³¬­®¦¥­¨¾ (±¬. ° §¤¥« 33.3). ²  £°³¯¯  ¨¬¥¥² ²³ ¦¥ ±²°³ª²³°³,
·²® ¨  ¤¤¨²¨¢­ ¿ £°³¯¯  (Zn; +), ¯®±ª®«¼ª³ ° ¢¥­±²¢® !nn = !n0 = 1
¯®ª §»¢ ¥², ·²® !nj !nk = !nj +k = !n(j +k) mod n . ­ «®£¨·­®, !n;1 =
!nn;1. ®ª ¦¥¬ ­¥ª®²®°»¥ ±¢®©±²¢  ª®°­¥© ¨§ ¥¤¨­¨¶».

704

« ¢  31  ²°¨¶» ¨ ¤¥©±²¢¨¿ ± ­¨¬¨

¥¬¬  32.3 (¥¬¬  ® ±®ª° ¹¥­¨¨)
«¿ «¾¡»µ ¶¥«»µ n > 0, k > 0 ¨ d > 0
dk = ! k :
!dn
n

32:7

®ª § ²¥«¼±²¢®
®£« ±­® (32.6),
dk = (e2i=dn )dk = (e2i=n )k = ! k :
!dn
n

«¥¤±²¢¨¥ 32.4
«¿ «¾¡®£® ·¥²­®£® n > 0

!nn=2 = !2 = ;1:
®ª § ²¥«¼±²¢®
®±² ¢«¿¥²±¿ ·¨² ²¥«¾ ¢ ª ·¥±²¢¥ ³¯°. 32.2-1.
¥¬¬  32.5 (¥¬¬  ® ¤¥«¥­¨¨ ¯®¯®« ¬)
±«¨ n > 0 ·¥²­®, ²®, ¢®§¢¥¤¿ ¢ ª¢ ¤° ² ¢±¥ n ª®¬¯«¥ª±­»µ ª®°­¥© ±²¥¯¥­¨ n ¨§ ¥¤¨­¨¶», ¬» ¯®«³·¨¬ ¢±¥ n=2 ª®¬¯«¥ª±­»µ ª®°­¥©
±²¥¯¥­¨ n=2 ¨§ ¥¤¨­¨¶» (ª ¦¤»© | ¯® ¤¢  ° § ).
®ª § ²¥«¼±²¢®
¥£ª® ¯°®¢¥°¨²¼, ·²® ª®°­¨ !nk ¨ !nk+n=2 ®²«¨· ¾²±¿ §­ ª®¬ ¨
k .
¯°¨ ¢®§¢¥¤¥­¨¨ ¢ ª¢ ¤° ² ¤ ¾² ®¤­® ¨ ²® ¦¥ ·¨±«® !n2k = !n=
2
¥¬¬  ® ¤¥«¥­¨¨ ¯®¯®« ¬ ¯®§¢®«¨² ±¢¥±²¨ ¢»·¨±«¥­¨¥ §­ ·¥­¨©
¬­®£®·«¥­  ¢ ª®°­¿µ ¨§ ¥¤¨­¨¶» ±²¥¯¥­¨ n ª ¢»·¨±«¥­¨¾ §­ ·¥­¨©
¤°³£¨µ ¬­®£®·«¥­®¢ ¢ ª®°­¿µ ¨§ ¥¤¨­¨¶» ±²¥¯¥­¨ n=2.
¥¬¬  32.6 (¥¬¬  ® ±«®¦¥­¨¨)
«¿ «¾¡®£® ¶¥«®£® n > 1 ¨ ­¥®²°¨¶ ²¥«¼­®£® ¶¥«®£® k, ­¥ ª° ²­®£® n, ¢»¯®«­¥­® ° ¢¥­±²¢®
nX
;1
j =0

(!nk )j = 0:

®ª § ²¥«¼±²¢®
® ´®°¬³«¥ (3.3) (ª®²®° ¿ ¢¥°­  ¨ ¤«¿ ª®¬¯«¥ª±­»µ ·¨±¥«) ¨¬¥¥¬
nX
;1
j =0

nk
k;1
k n
(!nk )j = (!!nk) ;;1 1 = (!!nk) ;;1 1 = (1)
! k ; 1 = 0:
n

n

n

(§­ ¬¥­ ²¥«¼ ­¥ ®¡° ¹ ¥²±¿ ¢ ­³«¼, ² ª ª ª k ­¥ ª° ²­® n).
¨±ª°¥²­®¥ ¯°¥®¡° §®¢ ­¨¥ ³°¼¥
±¯®¬­¨¬, ·²® ¬» µ®²¨¬ ¢»·¨±«¨²¼ §­ ·¥­¨¥ ¬­®£®·«¥­ 

A(x) =

nX
;1
j =0

aj xj

®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­»¥ ±¨¬¬¥²°¨·¥±ª¨¥ ¬ ²°¨¶» ¨ ¬¥²®¤ ­ ¨¬¥­¼¸¨µ ª¢ ¤° ²®¢705

±²¥¯¥­¨ ¬¥­¼¸¥ n ¢ ª®°­¿µ ±²¥¯¥­¨ n ¨§ ¥¤¨­¨¶», ²® ¥±²¼ ¢ ²®·ª µ !n0 ; !n1 ; !n2 ; : : : ; !nn;1 . ( ¯®¬­¨¬, ·²® ¤«¿ ³¬­®¦¥­¨¿ ¤¢³µ ¬­®£®·«¥­®¢ ±²¥¯¥­¨ ¬¥­¼¸¥ m ¬» ¨±¯®«¼§®¢ «¨ ¨µ §­ ·¥­¨¿ ¢ 2m
²®·ª µ, ² ª ·²® ­»­¥¸­¥¥ §­ ·¥­¨¥ n ³¤¢®¥­® ¯® ±° ¢­¥­¨¾ ± ° §¤¥«®¬ 32.1). » ¯°¥¤¯®« £ ¥¬, ·²® n ¿¢«¿¥²±¿ ±²¥¯¥­¼¾ 2 (½²®£®
¤«¿ ­ ¸¨µ ¶¥«¥© ¤®±² ²®·­®, ² ª ª ª ª ¬­®£®·«¥­³ ¢±¥£¤  ¬®¦­®
¤®¡ ¢¨²¼ ­³«¥¢»¥ ±² °¸¨¥ ª®½´´¨¶¨¥­²»). ² ª, ­ ¬ § ¤ ­ ¢¥ª²®° ª®½´´¨¶¨¥­²®¢ a = (a0; a1; : : : ; an;1 ) ¨ ­ ¤® ¢»·¨±«¨²¼

yk = A(!nk ) =

nX
;1
j =0

aj !nkj :

(32:8)

¤«¿ k = 0; 1; : : : ; n ; 1.
¥ª²®° y = (y0 ; y1; : : : ; yn;1 ) ­ §»¢ ¥²±¿ ¤¨±ª°¥²­»¬ ¯°¥®¡° §®¢ ­¨¥¬ ³°¼¥ (Discrete Fourier Transform, DFT) ¢¥ª²®°  a =
(a0; a1; : : : ; an;1 ). ¡®§­ ·¥­¨¥: y = DFTn (a).
»±²°®¥ ¯°¥®¡° §®¢ ­¨¥ ³°¼¥
(Fast Fourier Transform, FFT) ¯°¥¤±² ¢«¿¥² ±®¡®© ¬¥²®¤ ¡»±²°®£® ¢»·¨±«¥­¨¿ ¤¨±ª°¥²­®£® ¯°¥®¡° §®¢ ­¨¿ ³°¼¥, ¨±¯®«¼§³¾¹¨©
±¢®©±²¢  ª®¬¯«¥ª±­»µ ª®°­¥© ¨§ ¥¤¨­¨¶» ¨ ²°¥¡³¾¹¨© ¢°¥¬¥­¨
(n lg n) (  ­¥ (n2 ), ª ª ¯®«³·¨²±¿ ¯°¨ ¨±¯®«¼§®¢ ­¨¨ ´®°¬³«
(32.8)).
»±²°®¥ ¯°¥®¡° §®¢ ­¨¥ ³°¼¥ ¨±¯®«¼§³¥² ¬¥²®¤ À° §¤¥«¿© ¨
¢« ±²¢³©Á. »¤¥«¨¬ ¢ ¬­®£®·«¥­¥ A ®²¤¥«¼­® ·«¥­» ·¥²­»µ ¨
­¥·¥²­»µ ±²¥¯¥­¥©, § ¯¨± ¢

A(x) = A[0](x2 ) + xA[1](x2);
£¤¥
¨

(32:9)

A[0](x) = a0 + a2x + a4x2 + : : : + an;2 xn=2;1;

A[1](x) = a1 + a3x + a5x2 + : : : + an;1 xn=2;1:
¥¬ ± ¬»¬ § ¤ ·  ¢»·¨±«¥­¨¿ A(x) ¢ ²®·ª µ !n0 , !n1 , : : : , !nn;1

±¢®¤¨²±¿ ª
1. ¢»·¨±«¥­¨¾ §­ ·¥­¨© ¬­®£®·«¥­®¢ A[0] ¨ A[1] ±²¥¯¥­¨ ¬¥­¼¸¥
n=2 ¢ ²®·ª µ
(!n0 )2 ; (!n1 )2; : : : ; (!nn;1 )2;
(32:10)
2. ª®¬¡¨­ ¶¨¨ °¥§³«¼² ²®¢ ¯® ´®°¬³«¥ (32.9).
¥¬¬  ® ¤¥«¥­¨¨ ¯®¯®« ¬ £ ° ­²¨°³¥², ·²® ±¯¨±®ª (32.10) ±®¤¥°¦¨² ¢±¥£® n=2 ° §«¨·­»µ ·¨±¥«,   ¨¬¥­­®, ª®¬¯«¥ª±­»µ ª®°­¥©
±²¥¯¥­¨ n=2 ¨§ ¥¤¨­¨¶» (ª ¦¤»© ¢µ®¤¨² ¤¢ ¦¤»).  ª¨¬ ®¡° §®¬,
­ ¬ ­³¦­® ¢»·¨±«¨²¼ §­ ·¥­¨¿ ¬­®£®·«¥­®¢ A[0] ¨ A[1] (±²¥¯¥­¨
¬¥­¼¸¥ n=2) ¢ n=2 ª®¬¯«¥ª±­»µ ª®°­¿µ ±²¥¯¥­¨ n=2 ¨§ ¥¤¨­¨¶».
²¨ ¯®¤§ ¤ ·¨ ¨¬¥¾² ²®² ¦¥ ¢¨¤, ·²® ¨±µ®¤­ ¿, ­® ¢¤¢®¥ ¬¥­¼¸¨©

706

« ¢  31  ²°¨¶» ¨ ¤¥©±²¢¨¿ ± ­¨¬¨

° §¬¥°. » ¯°¨µ®¤¨¬ ª ² ª®¬³ °¥ª³°±¨¢­®¬³  «£®°¨²¬³: ¢»·¨±«¥­¨¿ ¯°¥®¡° §®¢ ­¨¿ ³°¼¥ ¢¥ª²®°  a = (a0; a1; : : : ; an;1) (£¤¥ n |
±²¥¯¥­¼ 2):
\textsc{Recursive-FFT}$(a)$

% ¥ª³°±¨¢­®¥ 

1 $n\leftarrow length[a]$ \qquad $n$ --- ±²¥¯¥­¼ $2$
2 if $n=1$
3 \quad then return $a$
4 $\omega_n\leftarrow e^{2\pi i/n}$
5 $\omega\leftarrow 1$
6 $a^{[0]}\leftarrow (a_0,a_2,\ldots,a_{n-2})$
7 $a^{[1]}\leftarrow (a_1,a_3,\ldots,a_{n-1})$
8 $y^{[0]}\leftarrow$ \textsc{Recursive-FFT}$(a^{[0]})$
9 $y^{[1]}\leftarrow$ \textsc{Recursive-FFT}$(a^{[1]})$
10 for $k\leftarrow0$ to $n/2-1$
11 \quad do $y_k\leftarrow y_k^{[0]} + \omega y_k^{[1]}$
12 \qquad $y_{k+(n/2)}\leftarrow y_k^{[0]} - \omega y_k^{[1]}$
13 \qquad $\omega\leftarrow\omega\omega_n$
14 return $y$

°®¶¥¤³°  Recursive-FFT ° ¡®² ¥² ±«¥¤³¾¹¨¬ ®¡° §®¬.
²°®ª¨ 2{3 ®¡° §³¾² À¡ §¨± °¥ª³°±¨¨Á: ¤¨±ª°¥²­»¬ ¯°¥®¡° §®¢ ­¨¥¬ ³°¼¥ ¤«¿ ¢¥ª²®°  ¤«¨­» 1 ¿¢«¿¥²±¿ ± ¬ ½²®² ¢¥ª²®°, ² ª
ª ª
y0 = a0 !10 = a0 1 = a0 :
 ±²°®ª µ 6{7 ´®°¬¨°³¾²±¿ ¢¥ª²®°  ª®½´´¨¶¨¥­²®¢ ¬­®£®·«¥­®¢
A[0] ¨ A[1]. ²°®ª¨ 4, 5 ¨ 13 £ ° ­²¨°³¾², ·²® ! = !nk ¢ ¬®¬¥­²
¢»¯®«­¥­¨¿ ±²°®ª 11{12 (¬» ½ª®­®¬¨¬ ¢°¥¬¿, ­¥ ¢»·¨±«¿¿ §­ ·¥­¨¥ !nk ª ¦¤»© ° § § ­®¢®)  ±²°®ª µ 8{9 °¥ª³°±¨¢­® ¢»·¨±«¿¾²±¿
§­ ·¥­¨¿
k );
yk[0] = A[0](!n=
2
k );
yk[1] = A[1](!n=
2

k = ! 2k ¯® «¥¬¬¥ ® ±®ª° ¹¥­¨¨)
¨«¨ (¯®±ª®«¼ª³ !n=
n
2

yk[0] = A[0] (!n2k );
yk[1] = A[1] (!n2k ):

 ±²°®ª µ 11{12 ±®¡¨° ¾²±¿ ¢¬¥±²¥ °¥§³«¼² ²» °¥ª³°±¨¢­»µ
¢»·¨±«¥­¨© DFTn=2 .  ±²°®ª¥ 11 ¤«¿ y0 ; y1 ; : : : ; yn=2;1 ¯®«³· ¥²±¿

yk = yk[0] + !nk yk[1] = A[0] (!n2k ) + !nk A[1] (!n2k) = A(!nk );

®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­»¥ ±¨¬¬¥²°¨·¥±ª¨¥ ¬ ²°¨¶» ¨ ¬¥²®¤ ­ ¨¬¥­¼¸¨µ ª¢ ¤° ²®¢707

¯®±«¥¤­¥¥ ° ¢¥­±²¢® ±«¥¤³¥² ¨§ (32.9). «¿ yn=2 ; yn=2+1; : : : ; yn;1
±²°®ª  12 ¤ ¥² (¯°¨ k = 0; 1; : : : ; n=2 ; 1)

yk+(n=2) = yk[0] ; !nk yk[1]
= yk[0] + !nk+(n=2) yk[1]
= A[0] (!n2k ) + !nk+(n=2) A[1] (!n2k )
= A[0] (!n2k+n ) + !nk+(n=2) A[1] (!n2k+n )
= A(!nk+(n=2)):
²®°®¥ ° ¢¥­±²¢® ¢¥°­®, ¯®±ª®«¼ª³ !nk+(n=2) = ;!nk : ¥²¢¥°²®¥ ° ¢¥­±²¢® ¢¥°­®, ¯®±ª®«¼ª³ ¨§ !nn = 1 ±«¥¤³¥², ·²® !n2k = !n2k+n . ®±«¥¤­¥¥ ° ¢¥­±²¢® ±«¥¤³¥² ¨§ ³° ¢­¥­¨¿ (32.9).  ª¨¬ ®¡° §®¬, ¢¥ª²®° y , ¢®§¢° ¹ ¥¬»© ¯°®¶¥¤³°®© Recursive-FFT, ¤¥©±²¢¨²¥«¼­®
¥±²¼ ¤¨±ª°¥²­®¥ ¯°¥®¡° §®¢ ­¨¥ ³°¼¥ ¢µ®¤­®£® ¢¥ª²®°  a.
ª®«¼ª® ¢°¥¬¥­¨ § ­¨¬ ¥² ¯°®¶¥¤³°  Recursive-FFT? ±«¨ ­¥
³·¨²»¢ ²¼ °¥ª³°±¨¢­»¥ ¢»§®¢», ®­  ²°¥¡³¥² ¢°¥¬¥­¨ (n), £¤¥ n
| ¤«¨­  ¢µ®¤­®£® ¢¥ª²®° .  ³·¥²®¬ °¥ª³°±¨¢­»µ ¢»§®¢®¢ ¯®«³· ¥¬ ² ª®¥ ±®®²­®¸¥­¨¥ ¤«¿ ¢°¥¬¥­¨ T (n) ° ¡®²» ¯°®¶¥¤³°»
T (n) = 2T (n=2) + (n) = (n lg n):
 ª¨¬ ®¡° §®¬, ¯°¨¢¥¤¥­­»©  «£®°¨²¬ (°¥ª³°±¨¢­»© ¢ °¨ ­²
¡»±²°®£® ¯°¥®¡° §®¢ ­¨¿ ³°¼¥) ¯®§¢®«¿¥² ¢»·¨±«¨²¼ §­ ·¥­¨¿
¬­®£®·«¥­  ±²¥¯¥­¨ ¬¥­¼¸¥ n ¢ ª®¬¯«¥ª±­»µ ª®°­¿µ ±²¥¯¥­¨ n ¨§
¥¤¨­¨¶» §  ¢°¥¬¿ (n lg n).
­²¥°¯®«¿¶¨¿ ¯® §­ ·¥­¨¿¬ ¢ ª®°­¿µ ¨§ ¥¤¨­¨¶»
 ¬ ®±² «®±¼ ¯®ª § ²¼, ª ª ¯¥°¥©²¨ ®¡° ²­® ®² §­ ·¥­¨© ¬­®£®·«¥­  ¢ ª®¬¯«¥ª±­»µ ª®°­¿µ ¨§ ¥¤¨­¨¶» ª ¥£® ª®½´´¨¶¨¥­² ¬.
«¿ ½²®£® ¬» ¯°¥¤±² ¢¨¬ ¯°¥®¡° §®¢ ­¨¥ ³°¼¥ ª ª ³¬­®¦¥­¨¥
­  ¬ ²°¨¶³, ¨ ­ ©¤¥¬ ®¡° ²­³¾ ¬ ²°¨¶³.
®£« ±­® ³° ¢­¥­¨¾ (32.4), ¤¨±ª°¥²­®¥ ¯°¥®¡° §®¢ ­¨¥ ³°¼¥
¬®¦­® § ¯¨± ²¼ ª ª ¬ ²°¨·­®¥ ³¬­®¦¥­¨¥ y = Vn a, £¤¥ Vn | ½²®
¬ ²°¨¶   ­¤¥°¬®­¤ , ±®±² ¢«¥­­ ¿ ¨§ ±²¥¯¥­¥© !n :
0
1
0
0
1
1
:::
1
y0 1 B 1 1
a0
2
3
n
;
1
C
!n
!n
!n : : :
!n
B 1
B y1 C
C B a1
C
B
B
B
!n2
!n4
!n6 : : : !n2(n;1) C
B 1
B y2 C
C B a2
C=B
B
C
B
3(
n
;
1)
B 1
B y3 C
C B a3
!n3
!n6
!n9 : : : !n
B
B . C
CB
..
..
..
..
..
...
B ..
C@
@ .. A
.
.
.
.
.
@ .
A
2(
n
;
1)
3(
n
;
1)
(
n
;
1)(
n
;
1)
yn;1
a
n
;
1
n;1
1 !n !n
!n
: : : !n
«¥¬¥­² ¬ ²°¨¶» Vn ± ¨­¤¥ª± ¬¨ (k; j ) ° ¢¥­ !nkj (¯°¨ j; k =
0; 1; : : : ; n ; 1); ¯®ª § ²¥«¨ ±²¥¯¥­¥© ¢ ¬ ²°¨¶¥ Vn ®¡° §³¾² À² ¡«¨¶³ ³¬­®¦¥­¨¿Á.

1
C
C
C
C
C
C
A

708

« ¢  31  ²°¨¶» ¨ ¤¥©±²¢¨¿ ± ­¨¬¨

¡° ²­ ¿ ®¯¥° ¶¨¿ a = DFT;n 1 (y ) ±®±²®¨² ¢ ³¬­®¦¥­¨¨ ¬ ²°¨¶»

Vn;1 (®¡° ²­®© ª Vn ) ­  y .

¥®°¥¬  32.7
«¥¬¥­² ± ¨­¤¥ª± ¬¨ (j; k) ¬ ²°¨¶» Vn;1 ° ¢¥­ !n;kj =n.
®ª § ²¥«¼±²¢®
®ª ¦¥¬, ·²® Vn;1 Vn = In , £¤¥ In | ½²® ¥¤¨­¨·­ ¿ (n  n)¬ ²°¨¶ . ® ®¯°¥¤¥«¥­¨¾, (j; j 0)-© ½«¥¬¥­² ¯°®¨§¢¥¤¥­¨¿ Vn;1 Vn
¥±²¼
nX
;1
nX
;1
0
;
1
;
kj
kj
[Vn Vn ]jj 0 = (!n =n)(!n ) = !nk(j 0 ;j ) =n:
k=0

k=0
0
®±«¥¤­¿¿ ±³¬¬  ° ¢­  1 ¯°¨ j = j ¨ ° ¢­  0 ¯°¨ j 6= j 0 ¯® «¥¬¬¥
® ±«®¦¥­¨¨ («¥¬¬  32.6).  ± ¬®¬ ¤¥«¥, ;(n ; 1) 6 j 0 ; j 6 n ; 1,
² ª ·²® j ; j 0 ­¥ ¤¥«¨²±¿ ­  n ¯°¨ j 6= j 0.
­ ¿ ®¡° ²­³¾ ¬ ²°¨¶³ Vn;1 , ¬» ¬®¦¥¬ ­ ©²¨ a = DFT;n 1 (y ) ¯®
´®°¬³«¥
nX
;1
1
32:11
aj = n yk !n;kj ;
k=0

¤«¿ j = 0; 1; : : : ; n ; 1. ° ¢­¨¢ ´®°¬³«» (32.8) ¨ (32.11), ¬» ¢¨¤¨¬, ·²® ¤«¿ ¢»·¨±«¥­¨¿ ®¡° ²­®£® ¯°¥®¡° §®¢ ­¨¿ ³°¼¥ ¬®¦­®
¯°¨¬¥­¨²¼ ²®² ¦¥  «£®°¨²¬ (¡»±²°®£® ¯°¥®¡° §®¢ ­¨¿ ³°¼¥),
¯®¬¥­¿¢ ¢ ­¥¬ a ¨ y ¬¥±² ¬¨, § ¬¥­¨¢ !n ­  !n;1 ¨ ° §¤¥«¨¢ ª ¦¤»© ½«¥¬¥­² °¥§³«¼² ²  ­  n (±¬. ³¯°. 32.2-4).  ª¨¬ ®¡° §®¬,
DFT;n 1 ² ª¦¥ ¬®¦­® ¢»·¨±«¨²¼ §  ¢°¥¬¿ (n lg n).
² ª, ¬» ­ ³·¨«¨±¼ ¯¥°¥µ®¤¨²¼ ®² ª®½´´¨¶¨¥­²®¢ ¬­®£®·«¥­ 
ª ­ ¡®°³ ¥£® §­ ·¥­¨© ¢ ª®°­¿µ ¨§ ¥¤¨­¨¶» ¨ ®¡° ²­® §  ¢°¥¬¿
(n lg n). ²® ³¬¥­¨¥ ¬®¦­® ¨±¯®«¼§®¢ ²¼ ¤«¿ ³¬­®¦¥­¨¿ ¬­®£®·«¥­®¢. ´®°¬³«¨°³¥¬ ±®®²¢¥²±²¢³¾¹¨© °¥§³«¼² ² ¢ ¢¨¤¥ ²¥®°¥¬»:
¥®°¥¬  32.8 (® ±¢¥°²ª¥)
«¿ «¾¡»µ ¢¥ª²®°®¢ a ¨ b ° §¬¥°­®±²¨ n, £¤¥ n | ±²¥¯¥­¼ ¤¢®©ª¨
¢»¯®«­¥­® ° ¢¥­±²¢®
a 
 b = DFT;2n1 (DFT2n (a)  DFT2n (b));
¥±«¨ ¤®¯®«­¨²¼ ¢¥ª²®°» a ¨ b ­³«¥¢»¬¨ ½«¥¬¥­² ¬¨ ¤® ¤«¨­»
2n, ¨ ·¥°¥§  ®¡®§­ ·¨²¼ ¯®ª®¬¯®­¥­²­®¥ ¯°®¨§¢¥¤¥­¨¥ ¤¢³µ 2n{
½«¥¬¥­²­»µ ¢¥ª²®°®¢.
¯° ¦­¥­¨¿
32.2-1
®ª ¦¨²¥ ±«¥¤±²¢¨¥ 32.4
32.2-2
 ©¤¨²¥ ¤¨±ª°¥²­®¥ ¯°¥®¡° §®¢ ­¨¥ ³°¼¥ ¢¥ª²®°  (0; 1; 2; 3).
32.2-3
»¯®«­¨²¥ ³¯°. 32.1-1, ¨±¯®«¼§³¿ ±µ¥¬³ ¡»±²°®£® (¢°¥¬¿
(n lg n))  «£®°¨²¬  ³¬­®¦¥­¨¿ ¬­®£®·«¥­®¢ (°¨±. 32.1).

®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­»¥ ±¨¬¬¥²°¨·¥±ª¨¥ ¬ ²°¨¶» ¨ ¬¥²®¤ ­ ¨¬¥­¼¸¨µ ª¢ ¤° ²®¢709

32.2-4
 ¯¨¸¨²¥ ¯°®¶¥¤³°³ ¢»·¨±«¥­¨¿ DFT;n 1 §  ¢°¥¬¿ (n lg n).
32.2-5
 ª ¡»±²°® ¢»¯®«­¨²¼ ¯°¥®¡° §®¢ ­¨¿ ³°¼¥, ¥±«¨ n ¿¢«¿¥²±¿
±²¥¯¥­¼¾ ²°®©ª¨?  ¯¨¸¨²¥ °¥ª³°°¥­²­®¥ ±®®²­®¸¥­¨¥ ¤«¿ ¢°¥¬¥­¨ ° ¡®²» ±®®²¢¥²±²¢³¾¹¥© ¯°®¶¥¤³°» ¨ °¥¸¨²¥ ¥£®.
32.2-6
°¥®¡° §®¢ ­¨¥ ³°¼¥ ¢¥ª²®°  ¨§ n ½«¥¬¥­²®¢ ¬®¦­® ¢»·¨±«¿²¼
­¥ ­ ¤ ¯®«¥¬ C ,   ¢ ª®«¼¶¥ Zm ¶¥«»µ ·¨±¥« ¯® ¬®¤³«¾ m, £¤¥
m = 2tn=2 + 1, £¤¥ t | ¯°®¨§¢®«¼­®¥ ¯®«®¦¨²¥«¼­®¥ ¶¥«®¥ ·¨±«®.
°¨ ½²®¬ °®«¼ !n ¨£° ¥² 2t . ®ª ¦¨²¥, ·²® ¤¨±ª°¥²­®¥ ¯°¥®¡° §®¢ ­¨¥ ³°¼¥ ¨ ®¡° ²­®¥ ª ­¥¬³ ¤«¿ ¢¥ª²®°®¢ ± ½«¥¬¥­² ¬¨ ¨§
½²®£® ª®«¼¶  ª®°°¥ª²­® ®¯°¥¤¥«¥­» ¨ ¬®£³² ¡»²¼ ¢»·¨±«¥­» § 
¢°¥¬¿ O(n lg n) ¯® ²®© ¦¥ ±µ¥¬¥.
32.2-7
®ª ¦¨²¥ ª ª ¤«¿ ¤ ­­®£® ±¯¨±ª  ·¨±¥« z0 ; z1; : : : ; zn;1 (­¥ ®¡¿§ ²¥«¼­® ° §«¨·­»µ) ­ ©²¨ ª®½´´¨¶¨¥­²» ¬­®£®·«¥­  P (x) ±²¥¯¥­¨
¬¥­¼¸¥ n, ¨¬¥¾¹¥£® ³ª § ­­»¥ ¢ ±¯¨±ª¥ ª®°­¨ (± ³·¥²®¬ ª° ²­®±²¨). °¥¬¿ ° ¡®²» ¤®«¦­® ¡»²¼ O(n lg n). (ª § ­¨¥. ­®£®·«¥­
P (x) ®¡° ¹ ¥²±¿ ¢ ­³«¼ ¢ ²®·ª¥ a ²®£¤  ¨ ²®«¼ª® ²®£¤ , ª®£¤ 
¤¥«¨²±¿ ­  (x ; a).)
32.2-8
 ±±¬®²°¨¬ ¯°¥®¡° §®¢ ­¨¥ ¢¥ª²®°  a = (a0; a1; : : : ; an;1), ¯¥°¥¢®¤¿¹¥¥ P¥£® ¢ ¢¥ª²®° y = (y0; y1 ; : : : ; yn;1 ), § ¤ ­­»© ´®°¬³;1 a z jk , £¤¥ z | ¯°®¨§¢®«¼­®¥ ª®¬¯«¥ª±­®¥ ·¨±«®.
«®© yk = nj =0
j
(¨±ª°¥²­®¥ ¯°¥®¡° §®¢ ­¨¥ ³°¼¥ ¿¢«¿¥²±¿ · ±²­»¬ ±«³· ¥¬ ¤«¿
z = !n .) ®ª ¦¨²¥, ·²® ½²® ¯°¥®¡° §®¢ ­¨¥ ¬®¦­® ¢»¯®«­¨²¼ § 
¢°¥¬¿ O(n lg n) ¤«¿ «¾¡®£® ª®¬¯«¥ª±­®£® ·¨±«  z . (ª § ­¨¥: ¨±¯®«¼§³©²¥ ° ¢¥­±²¢®
nX
;1
2 =2
k
yk = z
(aj z j 2 =2)(z ;(k;j )2 =2);
j =0

·²®¡» ¯°¥¤±² ¢¨²¼ °¥§³«¼² ² ¯°¥®¡° §®¢ ­¨¿ ª ª ±¢¥°²ª³.)
32.3 ´´¥ª²¨¢­»¥ °¥ «¨§ ¶¨¨ ¡»±²°®£® ¯°¥®¡° §®¢ ­¨¿ ³°¼¥
¨±ª°¥²­®¥ ¯°¥®¡° §®¢ ­¨¥ ³°¼¥ · ±²® ¢±²°¥· ¥²±¿ ­  ¯° ª²¨ª¥, ¯°¨·¥¬ ¢ ±¨²³ ¶¨¿µ, £¤¥ ±ª®°®±²¼ ° ¡®²» ®·¥­¼ ¢ ¦­  (®¡° ¡®²ª  ±¨£­ «®¢ ¨ ².¯.).  ½²®¬ ° §¤¥«¥ ° ±±¬ ²°¨¢ ¾²±¿ ¤¢¥ ½´´¥ª²¨¢­»¥ °¥ «¨§ ¶¨¨ ¡»±²°®£® ¯°¥®¡° §®¢ ­¨¿ ³°¼¥. ­ · « 
¬» ° ±±¬®²°¨¬ ¨²¥° ²¨¢­»©  «£®°¨²¬ ¡»±²°®£® ¯°¥®¡° §®¢ ­¨¿
³°¼¥, ª®²®°»© ¨¬¥¥² «³·¸¨¥ ª®­±² ­²» ¢  ±¨¬¯²®²¨·¥±ª®© ®¶¥­ª¥ O(n lg n), ·¥¬ °¥ª³°±¨¢­»©  «£®°¨²¬ ° §¤¥«  32.2.  ²¥¬ ¬»
¨±¯®«¼§³¥¬ ²¥ ¦¥ ¨¤¥¨ ¤«¿ ¡»±²°®© ¯ ° ««¥«¼­®© °¥ «¨§ ¶¨¨.
²¥° ²¨¢­ ¿ °¥ «¨§ ¶¨¿ ¡»±²°®£® ¯°¥®¡° §®¢ ­¨¿ ³°¼¥
°¥¦¤¥ ¢±¥£® § ¬¥²¨¬, ·²® ¢ ¶¨ª«¥ for ¢ ±²°®ª µ 10{13 ¯°®¶¥¤³°» Recursive-FFT ¤¢ ¦¤» ¢»·¨±«¿¥²±¿ §­ ·¥­¨¥ !nk yk[1]. ¢¥¤¿

710

« ¢  31  ²°¨¶» ¨ ¤¥©±²¢¨¿ ± ­¨¬¨

32.3 °¥®¡° §®¢ ­¨¥ ¡ ¡®·ª¨. «¥¢  ¯®±²³¯ ¾² ¤¢  ¢µ®¤­»µ §­ ·¥­¨¿, !nk ³¬­®¦ ¥²±¿ ­  yk[1] , ±¯° ¢  ¢»¤ ¾²±¿ §­ ·¥­¨¿ ±³¬¬» ¨ ° §­®±²¨.
¨±³­®ª ¬®¦­® ° ±±¬ ²°¨¢ ²¼ ª ª ±µ¥¬³, ±®±² ¢«¥­­³¾ ¨§ ½«¥¬¥­²®¢ ±«®¦¥­¨¿, ¢»·¨² ­¨¿ ¨ ³¬­®¦¥­¨¿.
¨±. 31.4

¨±. 31.5

32.4 ¥°¥¢® ¢µ®¤­»µ ¢¥ª²®°®¢ ¤«¿ °¥ª³°±¨¢­»µ ¢»§®¢®¢ ¯°®¶¥¤³°»

Recursive-FFT. ±µ®¤­»¬ ¿¢«¿¥²±¿ ¢»§®¢ ¯°¨ n = 8.

¢°¥¬¥­­³¾ ¯¥°¥¬¥­­³¾ t, ¬®¦­® § ¯®¬­¨²¼ §­ ·¥­¨¥ ½²®£® ®¡¹¥£® ¯®¤¢»° ¦¥­¨¿ (common subexpression | ²¥°¬¨­®«®£¨¿, ¨±¯®«¼§³¥¬ ¿ ° §° ¡®²·¨ª ¬¨ ª®¬¯¨«¿²®°®¢), ·²®¡» ­¥ ¢»·¨±«¿²¼ ¥£®
¢²®°¨·­®:
for $k \leftarrow 0$ to $n/2-1$
\quad do $t \leftarrow \omega y_k^{[1]}$
\qquad $y_k \leftarrow y_k^{[0]} + t$
\qquad $y_{k+(n/2)} \leftarrow y_k^{[0]} - t$
\qquad $\omega \leftarrow \omega \omega_n$

»¯®«­¿¥¬»¥ ¢ ½²®¬ ¶¨ª«¥ ¤¥©±²¢¨¿ ¯®ª § ­» ­  °¨±. 32.3; ¨µ
­ §»¢ ¾² ¯°¥®¡° §®¢ ­¨¥¬ ¡ ¡®·ª¨ (buttery operation).
¥©· ± ¬» ¯®ª ¦¥¬, ª ª ¯®±²°®¨²¼ ¨²¥° ²¨¢­»© (  ­¥ °¥ª³°±¨¢­»©) ¢ °¨ ­² ¡»±²°®£® ¯°¥®¡° §®¢ ­¨¿ ³°¼¥.   °¨±³­ª¥ 32.4
¯®ª § ­» ¢µ®¤­»¥ ¢¥ª²®°» ¢ ¤¥°¥¢¥ °¥ª³°±¨¢­»µ ¢»§®¢®¢ ¯°®¶¥¤³°» Recursive-FFT, ­ ·¨­ ¿ ± ¥¥ ¢»§®¢  ¤«¿ n = 8.
ª § ­» ¢µ®¤­»¥ ¢¥ª²®°» ¤«¿ °¥ª³°±¨¢­»µ ¢»§®¢®¢ ¯°®¶¥¤³°»
Recursive-FFT; ª ¦¤»© ² ª®© ¢»§®¢ ¯®°®¦¤ ¥² ¤¢  ­®¢»µ (¤«¿
¢¥ª²®°®¢ ¯®«®¢¨­­®© ¤«¨­»).   °¨±³­ª¥ «¥¢»© ¯®²®¬®ª ±®®²¢¥²±²¢³¥² ¯¥°¢®¬³ ¨§ ­¨µ,   ¯° ¢»© | ¢²®°®¬³.
²¨ °¥ª³°±¨¢­»¥ ¢»§®¢» ¬®¦­® § ¬¥­¨²¼ ¢»·¨±«¥­¨¥¬ ±­¨§³
¢¢¥°µ.  ±¯®«®¦¨¬ ½«¥¬¥­²» ¨±µ®¤­®£® ¢¥ª²®°  a ¢ ²®¬ ¯®°¿¤ª¥,
¢ ª ª®¬ ®­¨ ¯®¿¢«¿¾²±¿ ¢ «¨±²¼¿µ ¤¥°¥¢  (­¨¦­¿¿ ±²°®ª ).  ²¥¬ ¢®§¼¬¥¬ ¯ °» ½«¥¬¥­²®¢, ¢»·¨±«¨¬ ¤«¿ ­¨µ ¤¨±ª°¥²­®¥ ¯°¥®¡° §®¢ ­¨¥ ³°¼¥, ¨±¯®«¼§³¿ ¯°¥®¡° §®¢ ­¨¥ ¡ ¡®·ª¨. ®«³·¨²±¿
±®¤¥°¦¨¬®¥ ¢²®°®© ±­¨§³ ±²°®ª¨ °¨±³­ª . («¥¬¥­²» ¨±µ®¤­®£®
¢¥ª²®°  ¡®«¼¸¥ ­¥ ­³¦­», ² ª ·²® ¬®¦­® § ¯¨± ²¼ °¥§³«¼² ²»
¯°¥®¡° §®¢ ­¨© ­  ¨µ ¬¥±²®.) ¥¯¥°¼ ¨§ ª ¦¤»µ ¤¢³µ ¯ ° ¬» ±®¡¨° ¥¬ ·¥²¢¥°ª³, ¤¢ ¦¤» ¢»¯®«­¨¢ ¯°¥®¡° §®¢ ­¨¥ ¡ ¡®·ª¨, ¯®«³· ¥²±¿ n=4 ·¥²¢¥°®ª.  «¥¥ ¨§ ·¥²¢¥°®ª ±®¡¨° ¾²±¿ ¢®±¼¬¥°ª¨
¨ ².¤.; ­  ¯®±«¥¤­¥¬ ¸ £¥ ¨§ ¤¢³µ ¢¥ª²®°®¢ ¤«¨­» n=2, ¿¢«¿¾¹¨µ±¿ ¯°¥®¡° §®¢ ­¨¿¬¨ ³°¼¥ ·¥²­®© ¨ ­¥·¥²­®© · ±²¨ ¢¥ª²®°  a,
¨§£®² ¢«¨¢ ¥²±¿ ¯°¥®¡° §®¢ ­¨¥ ³°¼¥ ¢±¥£® ¢¥ª²®°  a.
®®²¢¥²±²¢³¾¹ ¿ ¯°®£° ¬¬  ¨±¯®«¼§³¥² ¢¥ª²®° A[0::n ; 1] ¢ ª®²®°»© ¢ ­ · «¥ ° ¡®²» ¬» ¯®¬¥¹ ¥¬ ½«¥¬¥­²» ¢¥ª²®°  a ¢ ²®¬
¯®°¿¤ª¥, ¢ ª®²®°®¬ ¨¤³² «¨±²¼¿ ¤¥°¥¢  °¨±. 32.4. (²® ½²® §  ¯®°¿¤®ª, ¬» ®¡±³¤¨¬ ¤ «¼¸¥.) ¢¥¤¥¬ ² ª¦¥ ¯¥°¥¬¥­­³¾ s, ¢ ª®²®°®©

®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­»¥ ±¨¬¬¥²°¨·¥±ª¨¥ ¬ ²°¨¶» ¨ ¬¥²®¤ ­ ¨¬¥­¼¸¨µ ª¢ ¤° ²®¢711

¡³¤¥² ±®¤¥°¦ ²¼±¿ ²¥ª³¹¨© ­®¬¥° ³°®¢­¿ ¢ ¤¥°¥¢¥ °¥ª³°±¨¨ (° ±²³¹¨© ®² s = 1 ¤«¿ «¨±²¼¥¢ ¤® lg n ¤«¿ ª®°­¿, ª®£¤  ¬» ¯®«³· ¥¬
n-½«¥¬¥­²­»© °¥§³«¼² ²). ®² ±µ¥¬  ¯°®£° ¬¬»:
1 for $s \leftarrow 1$ to $\lg n$
2 \quad do for $k \leftarrow 0$ to $n-1$ by $2^s$
3 \qquad do ¯°¥®¡° §®¢ ²¼ ¤¢  $2^{s-1}$-½«¥¬¥­²­»µ ª³±ª 
\quad\qquad $A[k..k+2^{s-1}-1]$ ¨ $A[k+2^{s-1}..k+2^s-1]$
\quad\qquad ¢ $2^s$-½«¥¬¥­²­»© ª³±®ª $A[k..k+2^s-1]$

¯¨¸¥¬ ²¥«® ¶¨ª«  (±²°®ª  3) ¡®«¥¥ ¯®¤°®¡­®. » ¢®±¯°®¨§¢®¤¨¬ ¶¨ª« for ¨§ ¯°®¶¥¤³°» Recursive-FFT, ¨±¯®«¼§³¿ ¢¬¥±²® y [0]
ª³±®ª A[k::k +2s;1 ; 1],   ¢¬¥±²® y [1] | ª³±®ª A[k +2s;1 ::k +2s ; 1].
­ ·¥­¨¥ ! (¨±¯®«¼§³¥¬®¥ ¢ ¯°¥®¡° §®¢ ­¨¨ ¡ ¡®·ª¨) § ¢¨±¨² ®²
s: ®­® ¥±²¼ !m , £¤¥ m = 2s . °¥¬¥­­ ¿ ¯¥°¥¬¥­­³¾ u ¨±¯®«¼§³¥²±¿
¢ ¯°¥®¡° §®¢ ­¨¨ ¡ ¡®·ª¨.  ª¨¬ ®¡° §®¬, ° §¢¥°²»¢ ¿ ±²°®ª³ 3
¢ ¯°¥¤»¤³¹¥© ¯°®¶¥¤³°¥, ¯®«³· ¥¬ ² ª³¾ ¯°®£° ¬¬³:
\textsc{FFT-Base}
1 $n \leftarrow length[a]$
\qquad $n$ ¥±²¼ ±²¥¯¥­¼ 2
2 for $s \leftarrow 1$ to $\lg n$
3 \quad do $m \leftarrow 2^s$
4 \qquad
$\omega_m \leftarrow e^{2\pi i/m}$
5 \qquad
for $k \leftarrow 0$ to $n-1$ by m
6 \qquad\quad do $\omega \leftarrow 1$
7 \qquad\qquad
for $j \leftarrow 0$ to $m/2-1$
8 \qquad\qquad\quad do $t \leftarrow \omega A[k+j+m/2]$
9 \qquad\qquad\qquad
$u \leftarrow A[k+j]$
10 \qquad\qquad\qquad
$A[k+j] \leftarrow u + t$
11 \qquad\qquad\qquad
$A[k+j+m/2] \leftarrow u - t$
12 \qquad\qquad\qquad
$\omega \leftarrow \omega \omega_m$

 ª®­¥¶, ¯°¥¤±² ¢¨¬ ®ª®­· ²¥«¼­³¾ ¢¥°±¨¾ ¨²¥° ²¨¢­®© ¯°®¶¥¤³°» ¡»±²°®£® ¯°¥®¡° §®¢ ­¨¿ ³°¼¥, ¢ ª®²®°®© ¤¢  ¢­³²°¥­­¨µ
¶¨ª«  ¯¥°¥±² ¢«¥­» (½ª®­®¬¨¿ ¯°¨ ¢»·¨±«¥­¨¨ ! ) ¨ ¨±¯®«¼§®¢ ­ 
¤®¯®«­¨²¥«¼­ ¿ ¯°®¶¥¤³°  Bit-Reverse-Copy(a; A), ª®¯¨°³¾¹ ¿
½«¥¬¥­²» ¢¥ª²®°  a ¢ ¬ ±±¨¢ A ¢ ­³¦­®¬ ­ ¬ ¯®°¿¤ª¥.
\textsc{Iterative-FFT}$(a)$
1 \textsc{Bit-Reverse-Copy}$(a, A)$
2 $n \leftarrow length[a]$ \quad $n$ --- ±²¥¯¥­¼ $2$
3 for $s \leftarrow 1$ to $\lg n$
4 \quad do $m \leftarrow 2^s$
5 \qquad
$\omega_m \leftarrow e^{2\pi i/m}$
6 \qquad
$\omega \leftarrow 1$
7 \qquad
for $j \leftarrow 0$ to $m/2-1$
8 \qquad\quad do for $k \leftarrow j$ to $n-1$ by $m$

712

« ¢  31  ²°¨¶» ¨ ¤¥©±²¢¨¿ ± ­¨¬¨
9 \qquad\qquad\quad do
10 \qquad\qquad\qquad
11 \qquad\qquad\qquad
12 \qquad\qquad\qquad
13 \qquad\qquad $\omega

$t \leftarrow \omega A [k+m/2]$
$u \leftarrow A[k]$
$A[k] \leftarrow u+t$
$A[k+m/2] \leftarrow u-t$
\leftarrow \omega \omega_m$

 ª¨¬ ®¡° §®¬ ¯°®¶¥¤³°  Bit-Reverse-Copy ¯¥°¥±² ¢«¿¥² ½«¥¬¥­²» ¢µ®¤­®£® ¢¥ª²®°  a, ¯®¬¥¹ ¿ ¨µ ¢ ¬ ±±¨¢ A? ®±¬®²°¥¢ ­ 
«¨±²¼¿ ¤¥°¥¢  ­  °¨±. 32.4, ¬®¦­® § ¬¥²¨²¼, ·²® ®­¨ ° ±¯®«®¦¥­»
À¯¥°¥¢¥°­³²®¬ ¤¢®¨·­®¬Á ¯®°¿¤ª¥ (\bit-reverse binary"). ¡º¿±­¨¬,
·²® ¨¬¥¥²±¿ ¢ ¢¨¤³. ¥°¥§ rev (k) ¯°¨ k = 0; 1; 2; : : : ; 2n ; 1 ®¡®§­ ·¨¬ (lg n)-¡¨²®¢®¥ ¶¥«®¥ ·¨±«®, ¤¢®¨·­ ¿ § ¯¨±¼ ª®²®°®£® ¯®«³· ¥²±¿, ¥±«¨ ­ ¯¨± ²¼ ¤¢®¨·­³¾ § ¯¨±¼ ·¨±«  k (¢±¥£® lg n ¡¨²®¢,
¢ª«¾· ¿ ­ · «¼­»¥ ­³«¨, ¥±«¨ ®­¨ ¥±²¼) À§ ¤®¬ ­ ¯¥°¥¤Á.  ª ¢®²,
¯°®¶¥¤³°  Bit-Reverse-Copy ¯®¬¥¹ ¥² ½«¥¬¥­² ak ¢ A[rev(k)].
  °¨±³­ª¥ 32.4, ­ ¯°¨¬¥°, «¨±²¼¿ a0 ; a1; a2; : : : ; a7 ¯®¿¢«¿¾²±¿ ¢
¯®§¨¶¨¿µ 0, 4, 2, 6, 1, 5, 3, 7; ¢ ¤¢®¨·­®© ±¨±²¥¬¥ ­®¬¥°  ¯®§¨¶¨©
§ ¯¨±»¢ ¾²±¿ ª ª 000, 100, 010, 110, 001, 101, 011, 111. (²¬¥²¨¬,
·²® rev (rev(k)) = k.)
²®¡» ¯®­¿²¼, ¯®·¥¬³ «¨±²¼¿ ¨¤³² ¢ ¯¥°¥¢¥°­³²®¬ ¤¢®¨·­®¬ ¯®°¿¤ª¥, § ¬¥²¨¬, ·²® ¢ ª®°­¥ ¤¥°¥¢  ­ «¥¢® ¨¤³² ¨­¤¥ª±» ± ­³«¥¢»¬
¬« ¤¸¨¬ ¡¨²®¬,   ­ ¯° ¢® | ± ¥¤¨­¨·­»¬, ·²® ¯®±«¥ ®¡° ¹¥­¨¿
¡¨²®¢ ±®®²¢¥²±²¢³¥² ®¡»·­®¬³ ¯®°¿¤ª³ (±­ · «  ·¨±«  ± ­³«¥¢»¬
±² °¸¨¬ ¡¨²®¬, ¯®²®¬ ± ¥¤¨­¨·­»¬). ²¡° ±»¢ ¿ ­  ª ¦¤®¬ ³°®¢­¥ ¬« ¤¸¨© ¡¨², ¬» ¯°®¤®«¦ ¥¬ ½²®² ¯°®¶¥±± ¢­¨§ ¯® ¤¥°¥¢³, ¨ ¢
ª®­¶¥ ª®­¶®¢ ¯®«³· ¥¬ ¯¥°¥¢¥°­³²»© ¤¢®¨·­»© ¯®°¿¤®ª ¢ «¨±²¼¿µ.
®±ª®«¼ª³ ´³­ª¶¨¾ rev (k) «¥£ª® ¢»·¨±«¿²¼, ¬®¦­® § ¯¨± ²¼
¯°®¶¥¤³°³ Bit-Reverse-Copy (ª®¯¨°®¢ ­¨¥ ¢ ¯¥°¥¢¥°­³²®¬ ¤¢®¨·­®¬ ¯®°¿¤ª¥) ±«¥¤³¾¹¨¬ ®¡° §®¬:
\textsc{Bit-Reverse-Copy}$(a,A)$
1 $n \leftarrow length[a]$
2 for $k \leftarrow 0$ to $n-1$
3 \quad do $A [{\mathrm rev}(k)] \leftarrow a_k$

®±²°®¥­­ ¿ ¨²¥° ²¨¢­ ¿ °¥ «¨§ ¶¨¿ ¡»±²°®£® ¯°¥®¡° §®¢ ­¨¿ ³°¼¥ ²°¥¡³¥² ¢°¥¬¥­¨ (n lg n).  ± ¬®¬ ¤¥«¥, ¢»§®¢ BitReverse-Copy § ¢¥¤®¬® ³ª« ¤»¢ ¥²±¿ ¢ O(n lg n) ®¯¥° ¶¨©, ¯®±ª®«¼ª³ ¶¨ª« ¨±¯®«­¿¥²±¿ n ° §,   ¶¥«®¥ ·¨±«® ®² 0 ¤® n ; 1 § ­¨¬ ¥² lg n ¡¨²®¢, ª®²®°»¥ ¬®£³² ¡»²¼ ®¡° ¹¥­» §  ¢°¥¬¿ O(lg n). ( 
¯° ª²¨ª¥ ¬» ®¡»·­® § ° ­¥¥ §­ ¥¬ §­ ·¥­¨¥ n, ¯®½²®¬³ ¬®¦¥¬ ¨§£®²®¢¨²¼ ² ¡«¨¶³ §­ ·¥­¨© ´³­ª¶¨¨ rev(k) § ° ­¥¥ ¨ ¯®«¼§®¢ ²¼±¿
½²®© ² ¡«¨¶¥©. ®¦­® ² ª¦¥ ¨±¯®«¼§®¢ ²¼ ¯°¨¥¬ ¨§ § ¤ ·¨ 18-1,
¯®§¢®«¿¾¹¨© ®¡° ²¨²¼ ¢±¥ n ·¨±¥« ®² 0 ¤® n ; 1 §  O(n) ®¯¥° ¶¨©.)
» ¤®«¦­» ¥¹¥ ¯°®¢¥°¨²¼, ·²® ®±² «¼­ ¿ · ±²¼ ¯°®¶¥¤³°»
Iterative-FFT ²°¥¡³¥² ¢°¥¬¥­¨ (n lg n), ²® ¿±­®: ­  ª ¦¤®¬
¨§ lg n ³°®¢­¥© ¤¥°¥¢  °¥ª³°±¨¨ (°¨±. 32.4) ¨¬¥¥²±¿ n ·¨±¥«, ­ 

®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­»¥ ±¨¬¬¥²°¨·¥±ª¨¥ ¬ ²°¨¶» ¨ ¬¥²®¤ ­ ¨¬¥­¼¸¨µ ª¢ ¤° ²®¢713
¨±. 31.6

32.5 µ¥¬  Parralel-FFT, ¢»·¨±«¿¾¹ ¿ ¯°¥®¡° §®¢ ­¨¥ ³°¼¥ ¤«¿

n = 8 ¢µ®¤®¢. °¨ ³°®¢­¿ ±®®²¢¥²±²¢³¾² §­ ·¥­¨¿¬ s = 1; 2; 3. «¿ n ¢µ®¤®¢
¯®¤®¡­ ¿ ±µ¥¬  ¨¬¥¥² £«³¡¨­³ (lg n) ¨ ° §¬¥° (n lg n).

¯®«³·¥­¨¥ ª ¦¤®£® ¨§ ­¨µ ° ±µ®¤³¥²±¿ O(1) ®¯¥° ¶¨©.
 ° ««¥«¼­ ¿ ±µ¥¬  ¡»±²°®£® ¯°¥®¡° §®¢ ­¨¿ ³°¼¥
§«®¦¥­­»¥ ¨¤¥¨ ¯®§¢®«¿¾² ¯®±²°®¨²¼ ±µ¥¬³ ¨§ ´³­ª¶¨®­ «¼­»µ ½«¥¬¥­²®¢, ½´´¥ª²¨¢­® ¢»¯®«­¿¾¹³¾ ¯°¥®¡° §®¢ ­¨¥ ³°¼¥.
(µ¥¬» ¨§ ´³­ª¶¨®­ «¼­»µ ½«¥¬¥­²®¢ ®¯¨± ­» ¢ £« ¢¥ 29; ¢ ­ ¸¥¬
±«³· ¥ ½«¥¬¥­²» ¡³¤³² ¢»¯®«­¿²¼  °¨´¬¥²¨·¥±ª¨¥ ®¯¥° ¶¨¨.)
µ¥¬ , ¢»¯®«­¿¾¹ ¿ ¯°¥®¡° §®¢ ­¨¥ ³°¼¥ ¤«¿ n ¢µ®¤®¢, ª®²®°³¾ ¬» ­ §®¢¥¬ Parallel-FFT, ¨§®¡° ¦¥­  ­  °¨±. 32.5 (¤«¿
n = 8). ­ ·¥­¨¿ ­  ¢µ®¤ ¯®±²³¯ ¾² ¢ ¯¥°¥¢¥°­³²®¬ ¤¢®¨·­®¬ ¯®°¿¤ª¥; ±µ¥¬  ±®¤¥°¦¨² lg n ª ±ª ¤®¢, ¢ ª ¦¤®¬ ¨§ ª®²®°»µ ¯ ° ««¥«¼­® ¢»¯®«­¿¾²±¿ n=2 ¯°¥®¡° §®¢ ­¨© ¡ ¡®·ª¨  ª¨¬ ®¡° §®¬,
£«³¡¨­  ±µ¥¬» ¥±²¼ (lg n).
 ª®¥ ° ±¯ ° ««¥«¨¢ ­¨¥ ¢®§¬®¦­®, ¯®±ª®«¼ª³ ­  ª ¦¤®¬ ³°®¢­¥ °¥ª³°±¨¨ (°¨±. 32.4) ¨¬¥¥²±¿ n=2 ­¥§ ¢¨±¨¬»µ ¯°¥®¡° §®¢ ­¨©
¡ ¡®·ª¨, ª®²®°»¥ ¬®¦­® ¢»¯®«­¿²¼ ¯ ° ««¥«¼­®.
¯° ¦­¥­¨¿
32.3-1
®ª ¦¨²¥ ° ¡®²³ ¯°®¶¥¤³°» Iterative-FFT ­  ¯°¨¬¥°¥ ¢µ®¤­®£® ¢¥ª²®°  (0; 2; 3; ;1; 4; 5; 7; 9).
32.3-2
 ª °¥ «¨§®¢ ²¼  «£®°¨²¬ ¡»±²°®£® ¯°¥®¡° §®¢ ­¨¿ ³°¼¥, ¢»¯®«­¿¿ ¯¥°¥±² ­®¢ª³ ¢ ¯¥°¥¢¥°­³²®¬ ¤¢®¨·­®¬ ¯®°¿¤ª¥ ¢ ª®­¶¥,  
­¥ ¢ ­ · «¥? (ª § ­¨¥.  ±±¬®²°¨²¥ ®¡° ²­®¥ ¯°¥®¡° §®¢ ­¨¥ ³°¼¥.)
32.3-3
ª®«¼ª® ¯°®¢®¤®¢, ½«¥¬¥­²®¢ ±«®¦¥­¨¿, ¢»·¨² ­¨¿ ¨ ³¬­®¦¥­¨¿
¨¬¥¥²±¿ ¢ ±µ¥¬¥ Parallel-FFT ®¯¨± ­­®© ¢ ½²®¬ ° §¤¥«¥? ( ¦¤»© ¯°®¢®¤ ±®¥¤¨­¿¥² ®¤¨­ ¢»µ®¤ ± ®¤­¨¬ ¨«¨ ­¥±ª®«¼ª¨¬¨ ¢µ®¤ ¬¨.)
32.3-4*
°¥¤¯®«®¦¨¬, ·²® ±³¬¬ ²®°» ¢ ±µ¥¬¥ Parallel-FFT ¨­®£¤  «®¬ ¾²±¿ ¨ ¢»¤ ¾² ­  ¢»µ®¤¥ ­®«¼ ­¥§ ¢¨±¨¬® ®² ¢µ®¤­»µ §­ ·¥­¨©.
°¥¤¯®«®¦¨¬, ·²® ±«®¬ «±¿ °®¢­® ®¤¨­ ±³¬¬ ²®°, ¨ ¬» ­¥ §­ ¥¬,
ª ª®©.  ª ¬®¦­® ¡»±²°® ¥£® ­ ©²¨, ¯®¤ ¢ ¿ ­  ¢µ®¤ ±µ¥¬» ° §­»¥
­ ¡®°» §­ ·¥­¨© ¨ ­ ¡«¾¤ ¿ §  ¢»µ®¤­»¬¨ §­ ·¥­¨¿¬¨?
 ¤ ·¨
32-1 ¬­®¦¥­¨¥ ¬¥²®¤®¬ ° §¤¥«¿© ¨ ¢« ±²¢³©
a. ®ª ¦¨²¥, ª ª ³¬­®¦¨²¼ ¤¢  «¨­¥©­»µ ¬­®£®·«¥­  ax + b ¨
cx + d, ±¤¥« ¢ ²®«¼ª® ²°¨ ³¬­®¦¥­¨¿. (ª § ­¨¥: ®¤­¨¬ ¨§ ³¬­®¦¥­¨© ¡³¤¥² (a + b)  (c + d).)
b. °¥¤«®¦¨²¥ ¤¢   «£®°¨²¬  ¤«¿ ¢»·¨±«¥­¨¿ ¯°®¨§¢¥¤¥­¨¿ ¤¢³µ

714

« ¢  31  ²°¨¶» ¨ ¤¥©±²¢¨¿ ± ­¨¬¨

¬­®£®·«¥­®¢ ±²¥¯¥­¨ ¬¥­¼¸¥ n, ²°¥¡³¾¹¨µ ¢°¥¬¥­¨ (nlog 3).
(®¦­® ¤¥«¨²¼ ª®½´´¨¶¨¥­²» ¬­®£®·«¥­  ­  ±² °¸³¾ ¨ ¬« ¤¸³¾ ¯®«®¢¨­»,   ¬®¦­® ° §¤¥«¿²¼ ª®½´´¨¶¨¥­²» ¯°¨ ·¥²­»µ ¨
­¥·¥²­»µ ±²¥¯¥­¿µ.)
c. ®ª ¦¨²¥, ª ª ¬®¦­® ³¬­®¦¨²¼ ¤¢  n-¡¨²­»µ ¶¥«»µ ·¨±«  § 
O(nlog 3) ¸ £®¢, ±·¨² ¿, ·²® ­  ª ¦¤®¬ ¸ £¥ ®¡° ¡ ²»¢ ¥²±¿ O(1)
¡¨²®¢.
32-2 ¥¯«¨¶¥¢» ¬ ²°¨¶»
¥¯«¨¶¥¢®© ¬ ²°¨¶¥© (Toeplitz matrix) ­ §»¢ ¥²±¿ ¬ ²°¨¶  A =
(aij ) ° §¬¥°  n  n, ¤«¿ ª®²®°®© aij = ai;1;j ;1 ¤«¿ i = 2; 3; : : : ; n ¨
j = 2; 3; : : : ; n.
a. ¡¿§ ²¥«¼­® «¨ ±³¬¬  ¤¢³µ ²¥¯«¨¶¥¢»µ ¬ ²°¨¶ ¿¢«¿¥²±¿ ²¥¯«¨¶¥¢®©?  ¯°®¨§¢¥¤¥­¨¥?
b. ¯¨¸¨²¥, ª ª ¯°¥¤±² ¢¨²¼ ²¥¯«¨¶¥¢» ¬ ²°¨¶» ² ª, ·²®¡»
¤¢¥ ²¥¯«¨¶¥¢» ¬ ²°¨¶» ° §¬¥°  n  n ¬®¦­® ¡»«® ±«®¦¨²¼ §  ¢°¥¬¿ O(n).
c.  ¯¨¸¨²¥  «£®°¨²¬ ³¬­®¦¥­¨¿ ²¥¯«¨¶¥¢®© ¬ ²°¨¶» ° §¬¥° 
nn ­  ¢¥ª²®° ¤«¨­» n §  ¢°¥¬¿ O(n lg n) (¨±¯®«¼§³¿ ¯°¥¤±² ¢«¥­¨¥
¯³­ª²  b).
d.  ¯¨¸¨²¥ ½´´¥ª²¨¢­»©  «£®°¨²¬ ³¬­®¦¥­¨¿ ¤¢³µ ²¥¯«¨¶¥¢»µ ¬ ²°¨¶ ° §¬¥°  n  n ¨ ®¶¥­¨²¥ ¥£® ¢°¥¬¿ ° ¡®²».
32-3 »·¨±«¥­¨¥ §­ ·¥­¨© ¢±¥µ ¯°®¨§¢®¤­»µ ¬­®£®·«¥­  ¢ ²®·ª¥
­®£®·«¥­ A(x) ±²¥¯¥­¨ ¬¥­¼¸¥ n § ¤ ­ ±¢®¨¬¨ ª®½´´¨¶¨¥­² ¬¨ (a0 ; a1; : : : ; an;1 ). » µ®²¨¬ ­ ©²¨ ¥£® §­ ·¥­¨¥ ¢¬¥±²¥ ±® ¢±¥¬¨
¯°®¨§¢®¤­»¬¨ ¢ § ¤ ­­®© ²®·ª¥ x0.
a. ³±²¼ ¨§¢¥±²­» ª®½´´¨¶¨¥­²» b0; b1; : : : ; bn;1 ¢ ¯°¥¤±² ¢«¥­¨¨
¬­®£®·«¥­  A(x) ¯® ±²¥¯¥­¿¬ (x ; x0):
2

2

A(x) =

n;1
X
j =0

bj (x ; x0)j ;

 ª ²®£¤  ­ ©²¨ §­ ·¥­¨¥ ¬­®£®·«¥­  A(x) ¨ ¢±¥µ ¥£® ¯°®¨§¢®¤­»µ
¢ ²®·ª¥ x0 §  ¢°¥¬¿ O(n)?
b. ¡º¿±­¨²¥, ª ª ­ ©²¨ b0; b1; : : : ; bn;1 §  ¢°¥¬¿ O(n lg n), ¥±«¨
¨§¢¥±²­» §­ ·¥­¨¿ A(x0 + !nk ) ¯°¨ k = 0; 1; : : : ; n ; 1.
c. ®ª ¦¨²¥, ·²®
0

1

;1
kr nX
A(x0 + !nk ) = @ !rn!
f (j )g (r ; j )A ;
r=0
j =0
n;1
X

£¤¥ f (j ) = aj  j !,  

g (l ) =



x;0 l =(;l)! ¯°¨ ;(n ; 1) 6 l 6 0;
0
¯°¨ 1 6 l 6 (n ; 1):

®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­»¥ ±¨¬¬¥²°¨·¥±ª¨¥ ¬ ²°¨¶» ¨ ¬¥²®¤ ­ ¨¬¥­¼¸¨µ ª¢ ¤° ²®¢715

d. ¡º¿±­¨²¥, ª ª ¢»·¨±«¨²¼ A(x0 + !nk ) ¤«¿ k = 0; 1; : : : ; n ; 1 § 
¢°¥¬¿ O(n lg n). ®ª ¦¨²¥, ·²® ¢±¥ ¯°®¨§¢®¤­»¥ ¬­®£®·«¥­  A(x)
¢ ²®·ª¥ x0 ¬®¦­® ¢»·¨±«¨²¼ §  ¢°¥¬¿ O(n lg n).
32-4 »·¨±«¥­¨¥ §­ ·¥­¨© ¬­®£®·«¥­  ¢ ­¥±ª®«¼ª¨µ ²®·ª µ
» ¢¨¤¥«¨, ·²® §­ ·¥­¨¥ ¬­®£®·«¥­  ¢ ²®·ª¥ ¬®¦­® ­ ©²¨ § 
¢°¥¬¿ O(n), ¨±¯®«¼§³¿ ±µ¥¬³ ®°­¥° . °®¬¥ ²®£®, ¬» §­ ¥¬, ·²® ±
¯®¬®¹¼¾ ¡»±²°®£® ¯°¥®¡° §®¢ ­¨¿ ³°¼¥ ¬®¦­® ­ ©²¨ §­ ·¥­¨¿
¬­®£®·«¥­  ¢ n ª®¬¯«¥ª±­»µ ª®°­¿µ ¨§ ¥¤¨­¨¶» §  ¢°¥¬¿ O(n lg n).
¥©· ± ¬» ¯®ª ¦¥¬, ª ª ¢»·¨±«¨²¼ §­ ·¥­¨¿ ¬­®£®·«¥­  ±²¥¯¥­¨
¬¥­¼¸¥ n ¢ n «¾¡»µ ²®·ª µ §  ¢°¥¬¿ O(n lg2 n).
°¨ ½²®¬ ¬» ¨±¯®«¼§³¥¬ (¡¥§ ¤®ª § ²¥«¼±²¢ ) ²®² ´ ª², ·²®
¬®¦­® ­ ©²¨ ®±² ²®ª ®² ¤¥«¥­¨¿ ®¤­®£® ¬­®£®·«¥­  ­  ¤°³£®© § 
¢°¥¬¿ O(n lg n).  ¯°¨¬¥°, ®±² ²ª®¬ ®² ¤¥«¥­¨¿ 3x3 + x2 ; 3x + 1
­  x2 + x + 2 ° ¢¥­
(3x3 + x2 ; 3x + 1) mod (x2 + x + 2) = 5x ; 3:
n;1 a xk ¨
® ª®½´´¨¶¨¥­² ¬ ¬­®£®·«¥­  A(x) =
k=0 k
n ²®·ª ¬ x0; x1; : : : ; xn;1 ¬» µ®²¨¬ ­ ©²¨ n §­ ·¥­¨©
A(x0); A(x1); : : : ; A(xn;1Q
). «¿ 0 6 i 6 j 6 n ; 1 ®¯°¥¤¥«¨¬
¬­®£®·«¥­» Pij (x) = jk=i (x ; xk ) ¨ Qij = A(x) mod Pij (x).
 ¬¥²¼²¥, ·²® ±²¥¯¥­¼ Qij (x) ­¥ ¡®«¼¸¥ j ; i.
 . ®ª ¦¨²¥, ·²® A(x) mod (x ; z ) = A(z ) ¤«¿ «¾¡®© ²®·ª¨ z .
¡. ®ª ¦¨²¥, ·²® Qkk (x) = A(xk ) ¨ ·²® Q0;n;1 (x) = A(x).
¢. ®ª ¦¨²¥, ·²® Qik (x) = Qij (x) mod Pik (x) ¨ Qkj (x) = Qij (x)
mod Pkj (x) ¤«¿ i 6 k 6 j .
£. ª ¦¨²¥  «£®°¨²¬, ¢»·¨±«¿¾¹¨© A(x0); A(x1); : : : ; A(xn;1) § 
¢°¥¬¿ O(n lg2 n).
32-5 »±²°®¥ ¯°¥®¡° §®¢ ­¨¥ ³°¼¥ ¢ ª®«¼¶¥ ¢»·¥²®¢
¨±ª°¥²­®¥ ¯°¥®¡° §®¢ ­¨¥ ³°¼¥ (¢ ²®¬ ¢¨¤¥, ª ª ®­® ¡»«® ­ ¬¨ ®¯°¥¤¥«¥­®), ¨±¯®«¼§³¥² ¢»·¨±«¥­¨¿ ± ª®¬¯«¥ª±­»¬¨ ·¨±« ¬¨,
·²® ¬®¦¥² ¯°¨¢¥±²¨ ª ¯®²¥°¥ ²®·­®±²¨ ¨§-§  ®¸¨¡®ª ®ª°³£«¥­¨¿.
²® ®±®¡¥­­® ­¥¦¥« ²¥«¼­®, ¥±«¨ ¨±µ®¤­»¬¨ ¤ ­­»¬¨ ¨ °¥§³«¼² ² ¬¨ ¿¢«¿¾²±¿ ¶¥«»¥ ·¨±«  (­ ¯°¨¬¥°, ¥±«¨ ¬» ¯¥°¥¬­®¦ ¥¬ ¤¢ 
¬­®£®·«¥­  ± ¶¥«»¬¨ ª®½´´¨¶¨¥­² ¬¨) | ¡³¤¥² ¯«®µ®, ¥±«¨ ¨§-§ 
®¸¨¡®ª ¬» ¯®«³·¨¬ ®¤­® ·¨±«® ¢¬¥±²® ¤°³£®£®.
 ½²®¬ ±«³· ¥ ¬®¦­® ¨±¯®«¼§®¢ ²¼ ¢ °¨ ­² ¯°¥®¡° §®¢ ­¨¿ ³°¼¥, ¨±¯®«¼§³¾¹¨© ª®«¼¶® ¢»·¥²®¢ (¢ ª®²®°®¬ ¢»·¨±«¥­¨¿ ¯°®¢®¤¿²±¿ ²®·­®). » ³¦¥ ¢¨¤¥«¨ (³¯°. 32.2-6), ·²® ¢®§¬®¦­® ¨±¯®«¼§®¢ ­¨¥ ¢»·¥²®¢ ° §¬¥°®¬ 
(n) ¡¨²®¢ ¤«¿ ° ¡®²» ± n-²®·¥·­»¬
¤¨±ª°¥²­»¬ ¯°¥®¡° §®¢ ­¨¥¬ ³°¼¥.  ½²®© § ¤ ·¥ ° ±±¬ ²°¨¢ ¥²±¿ ¡®«¥¥ ¯° ª²¨·­»© ¯®¤µ®¤, ¨±¯®«¼§³¾¹¨© 
(lg n)-¡¨²®¢³¾
 °¨´¬¥²¨ª³ ¢»·¥²®¢. (¬» ¨±¯®«¼§³¥¬ ¬ ²¥°¨ « £« ¢» 33).
°¥¤¯®« £ ¥²±¿, ·²® ·¨±«® n ¥±²¼ ±²¥¯¥­¼ 2.
a. ³¤¥¬ ¨±ª ²¼ ­ ¨¬¥­¼¸¥¥ k, ¤«¿ ª®²®°®£® ·¨±«® p = kn + 1
| ¯°®±²®¥.  ©¤¨²¥ ¯°®±²®© ½¢°¨±²¨·¥±ª¨© ¤®¢®¤ ¢ ¯®«¼§³ ²®£®,
P

716

« ¢  31  ²°¨¶» ¨ ¤¥©±²¢¨¿ ± ­¨¬¨

·²® k ¯°¨¬¥°­® ° ¢­® lg n. (­ ·¥­¨¥ k ¬®¦¥² ®ª § ²¼±¿ ±¨«¼­®
¡®«¼¸¨¬ ¨«¨ ¬¥­¼¸¨¬, ­® ¥±²¼ ®±­®¢ ­¨¿ ®¦¨¤ ²¼, ·²® ¢ ±°¥¤­¥¬
¯®²°¥¡³¥²±¿ ¯°®¢¥°¨²¼ O(lg n) ª ­¤¨¤ ²®¢ ­  °®«¼ k.)
³±²¼ g ¿¢«¿¥²±¿ ®¡° §³¾¹¥© £°³¯¯» Zp ¨ w = g k mod p.
b. ®ª ¦¨²¥, ·²® ¤¨±ª°¥²­®¥ ¯°¥®¡° §®¢ ­¨¥ ³°¼¥ ¨ ®¡° ²­®¥
ª ­¥¬³ ¬®¦­® ª®°°¥ª²­® ®¯°¥¤¥«¨²¼ ¤«¿ ®¯¥° ¶¨© ¯® ¬®¤³«¾ p,
¨±¯®«¼§³¿ w ¢ ª ·¥±²¢¥ £« ¢­®£® §­ ·¥­¨¿ ª®°­¿ ±²¥¯¥­¨ n ¨§ ¥¤¨­¨¶».
c. ¡¥¤¨²¥±¼, ·²® ¡»±²°®¥ ¯°¥®¡° §®¢ ­¨¥ ³°¼¥ ¨ ®¡° ²­®¥ ª
­¥¬³ ¬®¦­® ¢»¯®«­¨²¼ ¢ ª®«¼¶¥ ¢»·¥²®¢ ¯® ¬®¤³«¾ p §  ¢°¥¬¿
O(n lg n), ¥±«¨ ±·¨² ²¼, ·²® ®¯¥° ¶¨¨ ­ ¤ O(lg n)-¡¨²®¢»¬¨ ·¨±« ¬¨ ¢»¯®«­¿¾²±¿ §  ¥¤¨­¨·­®¥ ¢°¥¬¿. (·¨² ©²¥ p ¨ w ¨§¢¥±²­»¬¨.)
d. »·¨±«¨²¥ ¤¨±ª°¥²­®¥ ¯°¥®¡° §®¢ ­¨¥ ³°¼¥ ¢¥ª²®° 
(0; 5; 3; 7; 7; 2; 1; 6), ¨±¯®«¼§³¿ ¢»·¨±«¥­¨¿ ¯® ¬®¤³«¾ 17.  ¬¥²¼²¥,
·²® g = 3 ¿¢«¿¥²±¿ £¥­¥° ²®°®¬ Z17.
 ¬¥· ­¨¿
°¥±±, «½­¥°¨, ¼¾ª®«¼±ª¨ ¨ ¥²²¥°«¨­£ (Vetterling) [161, 162]
¤ ¾² µ®°®¸¥¥ ®¯¨± ­¨¥ ¡»±²°®£® ¯°¥®¡° §®¢ ­¨¿ ³°¼¥ ¨ ¥£® ¯°¨«®¦¥­¨©. ®°®¸¥¥ ¢¢¥¤¥­¨¥ ¢ ²¥®°¨¾ ®¡° ¡®²ª¨ ±¨£­ «®¢ (®¡« ±²¼,
£¤¥ ¡»±²°®¥ ¯°¥®¡° §®¢ ­¨¥ ³°¼¥ ¯°¨¬¥­¿¥²±¿ · ¹¥ ¢±¥£®) ­ ¯¨± «¨ ¯¯¥­£¥©¬ ¨ ¨«±ª¨ [153].
¡»·­® ¨§®¡°¥²¥­¨¥ ¬¥²®¤  ¡»±²°®£® ¯°¥®¡° §®¢ ­¨¿ ³°¼¥ ¢
1960-µ £®¤ µ ±¢¿§»¢ ¾² ± ¨¬¥­ ¬¨ ³«¨ ¨ ¼¾ª¨ [51].   ± ¬®¬
¤¥«¥ ½²®² ¬¥²®¤ ­¥®¤­®ª° ²­® ¢±²°¥· «±¿ ¨ ° ­¼¸¥, ­® ¥£® ¢ ¦­®±²¼ ±² «  ®·¥¢¨¤­®© «¨¸¼ ± ¯®¿¢«¥­¨¿ ±®¢°¥¬¥­­»µ ¶¨´°®¢»µ
¢»·¨±«¨²¥«¼­»µ ¬ ¸¨­. °¥±±, «½­¥°¨, ¼¾ª®«¼±ª¨ ¨ ¥²²¥°«¨­£ ³ª §»¢ ¾², ·²® ½²®² ¬¥²®¤ §­ «¨ ³­£¥ (Runge) ¨ ¥­¨£
(Konig) ¥¹¥ ¢ 1924 £®¤³.

®«®¦¨²¥«¼­® ®¯°¥¤¥«¥­­»¥ ±¨¬¬¥²°¨·¥±ª¨¥ ¬ ²°¨¶» ¨ ¬¥²®¤ ­ ¨¬¥­¼¸¨µ ª¢ ¤° ²®¢717

33. ¥®°¥²¨ª®-·¨±«®¢»¥  «£®°¨²¬»

33

¥®p¥²¨ª®-·¨±«®¢»¥  «£®p¨²¬»

®£¤ -²® ²¥®°¨¿ ·¨±¥« ¡»«  ª« ±±¨·¥±ª¨¬ ¯°¨¬¥°®¬ ª° ±¨¢®©,
­® ±®¢¥°¸¥­­® ¡¥±¯®«¥§­®© ®¡« ±²¨ ·¨±²®© ¬ ²¥¬ ²¨ª¨. ¥©· ±
²¥®°¥²¨ª®-·¨±«®¢»¥  «£®°¨²¬» ¸¨°®ª® ¨±¯®«¼§³¾²±¿ | ¯°¥¦¤¥
¢±¥£® ¢ ° §«¨·­»µ ª°¨¯²®£° ´¨·¥±ª¨µ ±µ¥¬ µ, £¤¥ ­³¦­» ¡®«¼¸¨¥
¯°®±²»¥ ·¨±« .  ½²®© £« ¢¥ ¬» ®±­®¢­»¥ ´ ª²» ¨  «£®°¨²¬», ¨±¯®«¼§³¥¬»¥ ¢ ² ª®£® °®¤  ¯°¨«®¦¥­¨¿µ.
 §¤¥« 33.1 ¯®±¢¿¹¥­ ®±­®¢ ¬ ²¥®°¨¨ ·¨±¥« (¤¥«¨¬®±²¼, ±° ¢­¥­¨¿ ¯® ¬®¤³«¾, ²¥®°¥¬  ®¡ ¥¤¨­±²¢¥­­®±²¨ ° §«®¦¥­¨¿ ­  ¯°®±²»¥ ¬­®¦¨²¥«¨).  ° §¤¥«¥ 33.2 ° ±±¬ ²°¨¢ ¥²±¿ ®¤¨­ ¨§ ± ¬»µ
¤°¥¢­¨µ  «£®°¨²¬®¢ |  «£®°¨²¬ ¢ª«¨¤  ¯®¨±ª  ­ ¨¡®«¼¸¥£® ®¡¹¥£® ¤¥«¨²¥«¿ ¤¢³µ ¶¥«»µ ·¨±¥«.  ° §¤¥«¥ 33.3 ¬» ­ ¯®¬¨­ ¥¬
®±­®¢­»¥ ´ ª²»  °¨´¬¥²¨ª¨ ¢ ª®«¼¶ µ ¢»·¥²®¢.  ° §¤¥«¥ 33.4
¬» ¨§³·¨¬ ®±² ²ª¨, ¤ ¢ ¥¬»¥ ª° ²­»¬¨ ¤ ­­®£® ·¨±«  a ¯® ¤ ­­®¬³ ¬®¤³«¾ n, ¨ ­ ³·¨¬±¿ °¥¸ ²¼ ³° ¢­¥­¨¥ ax  b (mod n) ¯°¨
¯®¬®¹¨  «£®°¨²¬  ¢ª«¨¤ .  §¤¥« 33.5 ¯®±¢¿¹¥­ Àª¨² ©±ª®© ²¥®°¥¬¥ ®¡ ®±² ²ª µÁ.  ° §¤¥«¥ 33.6 ° ±±¬ ²°¨¢ ¾²±¿ ®±² ²ª¨ ®²
¤¥«¥­¨¿ ±²¥¯¥­¥© ¤ ­­®£® ·¨±«  a ¯® ´¨ª±¨°®¢ ­­®¬³ ¬®¤³«¾; ¨§« £ ¥²±¿  «£®°¨²¬ ¢»·¨±«¥­¨¿ ab mod n ¯°¨ ¯®¬®¹¨ ¬­®£®ª° ²­®£® ¢®§¢¥¤¥­¨¿ ¢ ª¢ ¤° ². (²®²  «£®°¨²¬ ¨£° ¥² ¢ ¦­¥©¸³¾ °®«¼
¯°¨ ¯°®¢¥°ª¥ ¯°®±²®²» ·¨±¥«.)  ° §¤¥«¥ 33.7 ®¯¨±»¢ ¥²±¿ ®¤­ 
¨§ ² ª ­ §»¢ ¥¬»µ ª°¨¯²®±¨±²¥¬ ± ®²ª°»²»¬ ª«¾·®¬ | ±¨±²¥¬  RSA.  §¤¥« 33.8 ±®¤¥°¦¨² ¢¥°®¿²­®±²­»©  «£®°¨²¬ ¯°®¢¥°ª¨
·¨±¥« ­  ¯°®±²®²³ (± ¥£® ¯®¬®¹¼¾ ¨¹³² ¡®«¼¸¨¥ ¯°®±²»¥ ·¨±« ,
¨±¯®«¼§³¥¬»¥ ¤«¿ £¥­¥° ¶¨¨ ª«¾·¥© ¢ ±¨±²¥¬¥ RSA).  ª®­¥¶, ¢
° §¤¥«¥ 33.9 ¬» ¯°¨¢¥¤¥¬ ¤®±² ²®·­® ½´´¥ª²¨¢­»© ½¢°¨±²¨·¥±ª¨©
 «£®°¨²¬, ¯®¬®£ ¾¹¨© ° §« £ ²¼ ­  ¬­®¦¨²¥«¨ ­¥¡®«¼¸¨¥ ¶¥«»¥
·¨±« . ²¬¥²¨²¼, ·²® ¨¬¥­­® ®²±³²±²¢¨¥ (­  ±¥£®¤­¿¸­¨© ¤¥­¼)
½´´¥ª²¨¢­®£®  «£®°¨²¬  ° §«®¦¥­¨¿ ·¨±¥« ­  ¬­®¦¨²¥«¨ ¯®§¢®«¿¥² ¨±¯®«¼§®¢ ²¼ ±¨±²¥¬³ RSA; ¥±«¨ ² ª®©  «£®°¨²¬ ­ ©¤¥²±¿,
¢±¿ ½²  ±¨±²¥¬  °³µ­¥² ¢ ®¤­®· ±¼¥. ( ª ·²® ®²±³²±²¢¨¥  «£®°¨²¬  ¬®¦¥² ¡»²¼ ¯®«¥§­¥¥ ¥£® ±³¹¥±²¢®¢ ­¨¿!)
°¨´¬¥²¨·¥±ª¨¥ ®¯¥° ¶¨¨ ± ¤«¨­­»¬¨ ·¨±« ¬¨
 ¡®² ¿ ± ¡®«¼¸¨¬¨ ¶¥«»¬¨ ·¨±« ¬¨, ¬» ¤®«¦­» ¤®£®¢®°¨²¼±¿, ·²® ±·¨² ²¼ ° §¬¥°®¬ ¢µ®¤­»µ ¤ ­­»µ ²®© ¨«¨ ¨­®© § ¤ ·¨,  

 · «¼­»¥ ±¢¥¤¥­¨¿ ¨§ ²¥®°¨¨ ·¨±¥«

719

² ª¦¥ ³±«®¢¨²¼±¿ ®²­®±¨²¥«¼­® ±²®¨¬®±²¨ ½«¥¬¥­² °­»µ  °¨´¬¥²¨·¥±ª¨µ ®¯¥° ¶¨©.
 ½²®© £« ¢¥ ¯®¤ À¡®«¼¸¨¬ ¢µ®¤®¬Á (¢µ®¤®¬ ¡®«¼¸®£® ° §¬¥° )
¬» ¡³¤¥¬ ¯®­¨¬ ²¼ ¢µ®¤, ±®¤¥°¦ ¹¨© ¡®«¼¸¨¥ ·¨±«  (  ­¥ ¢µ®¤,
±®¤¥°¦ ¹¨© ¬­®£® ·¨±¥« | ª ª, ±ª ¦¥¬, ¢ § ¤ ·¥ ±®°²¨°®¢ª¨).
®½²®¬³ ° §¬¥° ¢µ®¤  ¬» ¡³¤¥¬ ¨§¬¥°¿²¼ ª®«¨·¥±²¢®¬ ¡¨²®¢,
¨±¯®«¼§®¢ ­­»µ ¤«¿ § ¯¨±¨ ·¨±¥«. «£®°¨²¬, ¯®«³· ¾¹¨© ­  ¢µ®¤
¶¥«»¥ ·¨±«  a1 ; a2; : : : ; ak , ­ §»¢ ¥²±¿ ¯®«¨­®¬¨ «¼­»¬ (polinomialtime algorithm), ¥±«¨ ¢°¥¬¿ ¥£® ° ¡®²» ®£° ­¨·¥­® ¬­®£®·«¥­®¬ ®²
lg a1; lg a2 ; : : : ; lg ak , ²® ¥±²¼ ¬­®£®·«¥­®¬ ®² ¤«¨­ ¨±µ®¤­»µ ¤ ­­»µ
(¢ ¤¢®¨·­®© ±¨±²¥¬¥ ±·¨±«¥­¨¿).
® ±¨µ ¯®° ¬» ®¡»·­® ±·¨² «¨, ·²®  °¨´¬¥²¨·¥±ª¨¥ ¤¥©±²¢¨¿
(³¬­®¦¥­¨¥, ¤¥«¥­¨¥, ¢»·¨±«¥­¨¥ ®±² ²ª ) ¢»¯®«­¿¾²±¿ §  ¥¤¨­¨¶³ ¢°¥¬¥­¨. ²® ¡»«® ° §³¬­®, ¯®ª  ­¥ ¨±¯®«¼§®¢ «¨±¼ ¡®«¼¸¨¥
·¨±« , ­® ²¥¯¥°¼ ² ª®© ¯®¤µ®¤ ¯¥°¥±² ¥² ¡»²¼  ¤¥ª¢ ²­»¬. »¯®«­¥­¨¥  °¨´¬¥²¨·¥±ª¨µ ®¯¥° ¶¨© ± ¬® ±² ­®¢¨²±¿ ¤®±² ²®·­® ²°³¤®¥¬ª¨¬. ®½²®¬³ ·¨±«® ®¯¥° ¶¨© ²¥®°¥²¨ª®-·¨±«®¢®£®  «£®°¨²¬  ¥±²¥±²¢¥­­¥¥ ¨§¬¥°¿²¼ ¢ ¡¨²®¢»µ ®¯¥° ¶¨¿µ (bit operations).
 ¯°¨¬¥°, ¯°®±²¥©¸¨© ¬¥²®¤ ³¬­®¦¥­¨¿ ¤¢³µ  ;¡¨²®¢»µ ¶¥«»µ
·¨±¥« ²°¥¡³¥² ( 2) ¡¨²®¢»µ ®¯¥° ¶¨©. ­ «®£¨·­»¬ ®¡° §®¬ ¤¥«¥­¨¥  ;¡¨²®¢®£® ·¨±«  ­  ¡®«¥¥ ª®°®²ª®¥ ¨«¨ ¢»·¨±«¥­¨¥ ®±² ²ª  ®² ¤¥«¥­¨¿  ;¡¨²®¢®£® ·¨±«  ­  ¡®«¥¥ ª®°®²ª®¥ (±² ­¤ °²­»¬¨
¬¥²®¤ ¬¨) ²°¥¡³¾² ( 2 ) ¡¨²®¢»µ ®¯¥° ¶¨© (±¬. ³¯°. 33.1-11.)
 ª ¯° ¢¨«®, ¯°®±²¥©¸¨¥  «£®°¨²¬» ­¥ ¿¢«¿¾²±¿ ®¯²¨¬ «¼­»¬¨.  ¯°¨¬¥°, ­¥±«®¦­»©  «£®°¨²¬, ¨±¯®«¼§³¾¹¨© ¬¥²®¤ \° §¤¥«¿© ¨ ¢« ±²¢³©", ³¬­®¦ ¥² ¤¢   ;¡¨²®¢»µ ¶¥«»µ ·¨±« . ¤¥« ¿
( lg 3 ) (¡¨²®¢»µ) ®¯¥° ¶¨©,   ± ¬»© ¡»±²°»© ¨§ ¨§¢¥±²­»µ ­  ±¥£®¤­¿¸­¨© ¤¥­¼  «£®°¨²¬®¢ ²°¥¡³¥² ( lg  lg lg  ) ®¯¥° ¶¨©.  
¯° ª²¨ª¥ ®¡»·­® ¯°¨¬¥­¿¾² ¯°®±²¥©¸¨¥  «£®°¨²¬», ¯®½²®¬³ ¢
­ ¸¨µ ° ±·¥² µ ¬» ¡³¤¥¬ ¨±µ®¤¨²¼ ¨§ ®¶¥­ª¨ ®¶¥­ª³ ( 2 ) ¤«¿
³¬­®¦¥­¨¿ ¨ ¤¥«¥­¨¿.
 ½²®© £« ¢¥ ¬» ¡³¤¥¬ ®¡° ¹ ²¼ ¢­¨¬ ­¨¥ ¨ ­  ·¨±«®  °¨´¬¥²¨·¥±ª¨µ, ¨ ­  ·¨±«® ¡¨²®¢»µ ®¯¥° ¶¨©.
2

33.1.  · «¼­»¥ ±¢¥¤¥­¨¿ ¨§ ²¥®°¨¨ ·¨±¥«
 ½²®¬ ° §¤¥«¥ ¬» ­ ¯®¬­¨¬ ­¥ª®²®°»¥ ±¢®©±²¢  ¬­®¦¥±²¢
¶¥«»µ ·¨±¥« (Z = f: : : ; ;2; ;1; 0; 1; 2; : : : g) ¨ ­ ²³° «¼­»µ ·¨±¥«
(N = f0; 1; 2; : : : g).
¥«¨¬®±²¼ ¨ ¤¥«¨²¥«¨.
®¢®°¿², ·²® d ¤¥«¨² a (d divides a, § ¯¨±¼ d j a), ¥±«¨ a = kd
¯°¨ ­¥ª®²®°®¬ ¶¥«®¬ k. ¨­®­¨¬»: Àd ¿¢«¿¥²±¿ ¤¥«¨²¥«¥¬ aÁ (d is
a divisor of a), Àa ¤¥«¨²±¿ ­  dÁ. Àa ª° ²­® dÁ (a is a multiple of d).
¨±«® 0 ª° ²­® «¾¡®¬³ ·¨±«³. ±«¨ a > 0 ¨ d j a, ²® jdj 6 jaj. ±«¨

720

« ¢  33 ¥®p¥²¨ª®-·¨±«®¢»¥  «£®p¨²¬»

d ­¥ ¤¥«¨² a, ¯¨¸³² d a.
-

¡»·­® ¯¥°¥·¨±«¿¾² ²®«¼ª® ¯®«®¦¨²¥«¼­»¥ ¤¥«¨²¥«¨; ­ ¯°¨¬¥°, ¤¥«¨²¥«¨ ·¨±«  24 | ½²® ·¨±«  1, 2, 3, 4, 6, 8, 12 ¨ ± ¬® ·¨±«®
24.
°®±²»¥ ¨ ±®±² ¢­»¥ ·¨±« .
¨±«® a, ­¥ ¨¬¥¾¹¥¥ ¤¥«¨²¥«¥©, ª°®¬¥ 1 ¨ a, ­ §»¢ ¥²±¿ ¯°®±²»¬ (prime); ² ª®¢» ·¨±« 
2; 3; 5; 7; 11; 13; 17; 19; 23; 29; 31; 37; 41; 43; 47; 53; 59; : : : :
°®±²»µ ·¨±¥« ¡¥±ª®­¥·­® ¬­®£® (³¯°. 33.1-1). ¥«®¥ ·¨±«® a > 1,
­¥ ¿¢«¿¾¹¥¥±¿ ¯°®±²»¬, ­ §»¢ ¥²±¿ ±®±² ¢­»¬ (composite). ¨±«®
1, ·¨±«® 0,   ² ª¦¥ ®²°¨¶ ²¥«¼­»¥ ¶¥«»¥ ·¨±«  ¬» ­¥ ®²­®±¨¬ ­¨
ª ¯°®±²»¬, ­¨ ª ±®±² ¢­»¬.
¥«¥­¨¥ ± ®±² ²ª®¬. ° ¢­¥­¨¿ ¯® ¬®¤³«¾.
¨ª±¨°³¥¬ ¶¥«®¥ ·¨±«® n. ±¥ ¶¥«»¥ ·¨±«  ¤¥«¿²±¿ ­  n £°³¯¯
¢ § ¢¨±¨¬®±²¨ ®² ®±² ²ª®¢, ª®²®°»¥ ®­¨ ¤ ¾² ¯°¨ ¤¥«¥­¨¨ ­  n:
·¨±«  ¢¨¤  kn (ª° ²­»¥ n) ®¡° §³¾² ®¤­³ £°³¯¯³, ·¨±«  ¢¨¤  kn +1
| ¤°³£³¾ ¨ ².¯.
²°®£® £®¢®°¿, ²³² ±«¥¤³¥² ±®±« ²¼±¿ ­  ² ª³¾ ²¥®°¥¬³ (¯®¤°®¡­®±²¨ ¬®¦­® ­ ©²¨ ¢ ³·¥¡­¨ª¥ ¯® ²¥®°¨¨ ·¨±¥«, ­ ¯°¨¬¥°, ¢ ª­¨£¥
¨¢¥­  ¨ ³ª¥°¬ ­  [151]):
¥®°¥¬  33.1 (® ¤¥«¥­¨¨ ± ®±² ²ª®¬)
«¿ «¾¡®£® ¶¥«®£® ·¨±«  a ¨ ¯®«®¦¨²¥«¼­®£® ¶¥«®£® ·¨±«  n
±³¹¥±²¢³¥² ¥¤¨­±²¢¥­­ ¿ ¯ °  ¶¥«»µ ·¨±«  q ¨ r, ¤«¿ ª®²®°»µ 0 6
r < n ¨ a = qn + r.
¨±«® q = ba=nc ­ §»¢ ¥²±¿ · ±²­»¬ (quotient); ·¨±«® r, ®¡®§­ · ¥¬®¥ a mod n, ­ §»¢ ¥²±¿ ®±² ²ª®¬ (remainder, residue). ·¥¢¨¤­®, ·²® n j a ²®£¤  ¨ ²®«¼ª® ²®£¤ , ª®£¤  a mod n = 0, ·²®
a = ba=ncn + (a mod n)
(33:1)
¨ ·²®

a mod n = a ; ba=ncn:
(33:2)
®¢®°¿², ·²® a ±° ¢­¨¬® ± b ¯® ¬®¤³«¾ n (a is equivalent to b,
modulo n; § ¯¨±¼: a  b (mod n)) ¥±«¨ (a mod n) = (b mod n), ²®
¥±²¼ n j (b ; a). ±«¨ a ­¥ ±° ¢­¨¬® ± b ¯® ¬®¤³«¾ n, ¯¨¸³² a 6 b
(mod n).  ¯°¨¬¥°, 61  6 (mod 11) ¨ ;13  22  2 (mod 5).
±¥ ¶¥«»¥ ·¨±«  ¤¥«¿²±¿ ­  n ª« ±±®¢ ½ª¢¨¢ «¥­²­®±²¨ ¯® ¬®¤³«¾ n (eqivalence classes modulo n). ¨±«® a ¢µ®¤¨² ¢ ª« ±±
[a]n = fa + kn : k 2 Zg:
 ¯°¨¬¥°, [3]7 = [;4]7 = [10]7 = f: : : ; ;11; ;4; 3; 10; 17; : : : g. ­®¦¥±²¢® ¢±¥µ ª« ±±®¢ ½ª¢¨¢ «¥­²­®±²¨ ¯® ¬®¤³«¾ n ®¡®§­ · ¥²±¿
n:

Z

n = f[a]n : 0 6 a 6 n ; 1g:

Z

(33:3)

 · «¼­»¥ ±¢¥¤¥­¨¿ ¨§ ²¥®°¨¨ ·¨±¥«

721

»¡¨° ¿ ¢ ª ¦¤®¬ ª« ±±¥ ¯® ¯°¥¤±² ¢¨²¥«¾, ¬®¦­® ±·¨² ²¼, ·²®
n = f0; 1; : : : ; n ; 1g:

Z

(33:4)

¡¹¨¥ ¤¥«¨²¥«¨.  ¨¡®«¼¸¨© ®¡¹¨© ¤¥«¨²¥«¼.
°¥¤¨ ¢±¥µ ®¡¹¨µ ¤¥«¨²¥«¥© (common divisors) ¤ ­­»µ ·¨±¥« a
¨ b ¬®¦­® ¢»¡° ²¼ ­ ¨¡®«¼¸¨© ®¡¹¨© ¤¥«¨²¥«¼. (greatest common
divisor), ª®²®°»© ®¡®§­ · ¾² gcd(a; b) ¨«¨ (a; b) (®­ ®¯°¥¤¥«¥­,
¥±«¨ µ®²¿ ¡» ®¤­® ¨§ ·¨±¥« a ¨ b ®²«¨·­® ®² 0; ¯®«®¦¨¬ ¤«¿ ³¤®¡±²¢  gcd(0; 0) = 0.
 ¦­»¥ ±¢®©±²¢  ®¡¹¨µ ¤¥«¨²¥«¥© ¨ ­ ¨¡®«¼¸¥£® ®¡¹¥£® ¤¥«¨²¥«¿:
¥±«¨ d j a ¨ d j b, ²® d j (a + b) ¨ d j (a ; b):

(33:5)

¥±«¨ d j a ¨ d j b, ²® d j (ax + by );
(33:6)
¯°¨ «¾¡»µ ¶¥«»µ x ¨ y . ±«¨ a j b ²® jaj 6 jbj ¨«¨ b = 0, ¯®½²®¬³
¥±«¨ a j b ¨ b j a, ²® a = b:

(33:7)

gcd(a; b) = gcd(b; a)
gcd(a; b) = gcd(;a; b);
gcd(a; b) = gcd(jaj; jbj);
gcd(a; 0) = jaj;
gcd(a; ka) = jaj ¯°¨ ¢±¿ª®¬ k 2 Z:

(33:8)
(33:9)
(33:10)
(33:11)
(33:12)

¥®°¥¬  33.2
 ¨¡®«¼¸¨© ®¡¹¨© ¤¥«¨²¥«¼ ¶¥«»µ ·¨±¥« a ¨ b, ­¥ ° ¢­»µ 0 ®¤­®¢°¥¬¥­­®, ¿¢«¿¥²±¿ ­ ¨¬¥­¼¸¨¬ ¯®«®¦¨²¥«¼­»¬ ½«¥¬¥­²®¬ ¬­®¦¥±²¢  fax + by : x; y 2 Zg ¶¥«®·¨±«¥­­»µ «¨­¥©­»µ ª®¬¡¨­ ¶¨©
·¨±¥« a ¨ b.
®ª § ²¥«¼±²¢®. ³±²¼ ­ ¨¬¥­¼¸¨© ¯®«®¦¨²¥«¼­»© ½«¥¬¥­² ½²®£® ¬­®¦¥±²¢  ° ¢¥­ s. ®£¤  s = ax + by ¤«¿ ­¥ª®²®°»µ x; y 2 Z.
®«®¦¨¬ q = ba=sc. ®£« ±­® (33.2),

a mod s = a ; qs
= a ; q (ax + by )
= a(1 ; qx) + b(;qy );
¨ ¯®²®¬³ ®±² ²®ª ®² ¤¥«¥­¨¿ a ­  s ²®¦¥ ¿¢«¿¥²±¿ «¨­¥©­®© ª®¬¡¨­ ¶¨¥© a ¨ b. ® s ¡»« ­ ¨¬¥­¼¸¥© ¯®«®¦¨²¥«¼­®© ª®¬¡¨­ ¶¨¥©
² ª®£® ¢¨¤ , ² ª ·²® a mod s = 0 ¨ s j a. ®  ­ «®£¨·­»¬ ¯°¨·¨­ ¬ ¢¥°­® s j b.  ª¨¬ ®¡° §®¬, s ¿¢«¿¥²±¿ ®¡¹¨¬ ¤¥«¨²¥«¥¬ a

722

« ¢  33 ¥®p¥²¨ª®-·¨±«®¢»¥  «£®p¨²¬»

¨ b, ¯®½²®¬³ gcd(a; b) > s.  ¤°³£®© ±²®°®­», gcd(a; b) ¤¥«¨² ª ª
a, ² ª ¨ b,   ¯®²®¬³ ¤¥«¨² ¨ s = ax + by (33.6). ®±ª®«¼ª³ s > 0,
®²±¾¤  ±«¥¤³¥², ·²® gcd(a; b) 6 s.  ª¨¬ ®¡° §®¬, gcd(a; b) > s ¨
gcd(a; b) 6 s, ² ª ·²® gcd(a; b) = s,

«¥¤±²¢¨¥ 33.3
 ¨¡®«¼¸¨© ®¡¹¨© ¤¥«¨²¥«¼ ¤¢³µ ¶¥«»µ ·¨±¥« ª° ²¥­ «¾¡®¬³
¨µ ®¡¹¥¬³ ¤¥«¨²¥«¾.
®ª § ²¥«¼±²¢®.
® ²¥®°¥¬¥ 33.2 gcd(a; b) ¿¢«¿¥²±¿ «¨­¥©­®© ª®¬¡¨­ ¶¨¥© a ¨ b.
«¥¤±²¢¨¥ 33.4
«¿ «¾¡»µ ¶¥«»µ ·¨±¥« a ¨ b ¨ ­¥®²°¨¶ ²¥«¼­®£® ¶¥«®£® ·¨±« 
n ¢»¯®«­¿¥²±¿ ±®®²­®¸¥­¨¥ gcd(an; bn) = ngcd(a; b).
®ª § ²¥«¼±²¢®. «¥¬¥­²» ¢¨¤  anx + bny ¯®«³· ¾²±¿ ¨§ ½«¥¬¥­²®¢ ¢¨¤  ax + by ³¬­®¦¥­¨¥¬ ­  n, ² ª ·²® ½²® ®²­®±¨²±¿ ¨ ª
­ ¨¬¥­¼¸¥¬³ ½«¥¬¥­²³ ² ª®£® ¢¨¤ .
«¥¤±²¢¨¥ 33.5
«¿ «¾¡»µ ¯®«®¦¨²¥«¼­»µ ¶¥«»µ ·¨±¥« n, a ¨ b ¨§ n j ab ¨
gcd(a; n) = 1 ±«¥¤³¥² n j b.
®ª § ²¥«¼±²¢®
®±² ¢«¿¥²±¿ ·¨² ²¥«¾ (³¯°. 33.1-4).
§ ¨¬­® ¯°®±²»¥ ·¨±« .
¥«»¥ ·¨±«  a ¨ b ¢§ ¨¬­® ¯°®±²» (are relatively prime), ¥±«¨
gcd(a; b) = 1.
¥®°¥¬  33.6
±«¨ gcd(a; p) = 1 ¨ gcd(b; p) = 1, ²®  (ab; p) = 1 (¤«¿ «¾¡»µ
¶¥«»µ ·¨±¥« a; b; p).
®ª § ²¥«¼±²¢®. ® ²¥®°¥¬¥ 33.2 ­ ©¤³²±¿ ¶¥«»¥ ·¨±«  x, y , x0 ¨
y0, ¤«¿ ª®²®°»µ
ax + py = 1;
bx0 + py0 = 1:
¥°¥¬­®¦ ¿ ½²¨ ° ¢¥­±²¢ , ¬» ¢¨¤¨¬, ·²®
ab(xx0) + p(ybx0 + y 0 ax + pyy 0) = 1;
² ª ·²® 1 ¿¢«¿¥²±¿ ¶¥«®·¨±«¥­­®© «¨­¥©­®© ª®¬¡¨­ ¶¨¥© ab ¨ p;
®±² «®±¼ ±®±« ²¼±¿ ­  ²¥®°¥¬³ 33.2.
¥«»¥ ·¨±«  n1 ; n2 ; : : : ; nk ­ §»¢ ¾²±¿ ¯®¯ °­® ¢§ ¨¬­® ¯°®±²»¬¨ (pairwise relatively prime), ¥±«¨ «¾¡»¥ ¤¢  ¨§ ­¨µ ¢§ ¨¬­® ¯°®±²».
 §«®¦¥­¨¥ ­  ¯°®±²»¥ ¬­®¦¨²¥«¨
¥®°¥¬  33.7
±«¨ ¯°®±²®¥ ·¨±«® p ¤¥«¨² ¯°®¨§¢¥¤¥­¨¥ ¤¢³µ ¶¥«»µ ·¨±¥« a ¨
b, ²® p j a ¨«¨ p j b.
®ª § ²¥«¼±²¢®. ±«¨ ½²® ­¥ ² ª ¨ p ­¥ ¤¥«¨² ­¨ a, ­¨ b, ²® P
¢§ ¨¬­® ¯°®±²® ± ½²¨¬¨ ·¨±« ¬¨ (¤°³£¨µ ¤¥«¨²¥«¥© ³ p ­¥²), ¨
¯®²®¬³ ¢§ ¨¬­® ¯°®±²® ± ¨µ ¯°®¨§¢¥¤¥­¨¥¬ (²¥®°¥¬  33.6).

 · «¼­»¥ ±¢¥¤¥­¨¿ ¨§ ²¥®°¨¨ ·¨±¥«

723

¥®°¥¬  33.8 (³¹¥±²¢®¢ ­¨¥ ¨ ¥¤¨­±²¢¥­­®±²¼ ° §«®¦¥­¨¿)
±¿ª®¥ ±®±² ¢­®¥ ·¨±«® a ¥¤¨­±²¢¥­­»¬ ®¡° §®¬ ¯°¥¤±² ¢«¿¥²±¿
¢ ¢¨¤¥
a = pe1 pe2    perr ;
£¤¥ p1 < p2 <    < pr | ¯°®±²»¥ ·¨±« ,   ei | ¯®«®¦¨²¥«¼­»¥
¶¥«»¥ ·¨±« .
®ª § ²¥«¼±²¢® ®±² ¢«¿¥²±¿ ·¨² ²¥«¾ (³¯°. 33.1-10).
¯° ¦­¥­¨¿.
33.1-1
®ª ¦¨²¥, ·²® ±³¹¥±²¢³¥² ¡¥±ª®­¥·­® ¬­®£® ¯°®±²»µ ·¨±¥«.
(ª § ­¨¥: ­¨ ®¤­® ¨§ ¯°®±²»µ ·¨±¥« p1 ; p2; : : : ; pk ­¥ ¤¥«¨² ·¨±«®
(p1p2    pk ) + 1.)
33.1-2
®ª ¦¨²¥, ·²® ¥±«¨ a j b ¨ b j c, ²® a j c.
33.1-3
³±²¼ ·¨±«® p | ¯°®±²®¥,   0 < k < p. ®ª ¦¨²¥, ·²®
 (k; p) = 1.
33.1-4
®ª ¦¨²¥ ±«¥¤±²¢¨¥ 33.5.
33.1-5
³±²¼ ·¨±«® p | ¯°®±²®¥,   0 < k < p. ®ª ¦¨²¥, ·²® p j Cpk . »¢¥¤¨²¥ ®²±¾¤ , ·²® ¤«¿ «¾¡»µ ¶¥«»µ a, b ¨ ¯°®±²®£® p ¢»¯®«­¿¥²±¿
±° ¢­¥­¨¥
(a + b)p  ap + bp (mod p):
33.1-6
³±²¼ a ¨ b | ¶¥«»¥ ·¨±« , ¯°¨·¥¬ a j b ¨ b > 0. ®ª ¦¨²¥, ·²®
(x mod b) mod a = x mod a ¯°¨ «¾¡®¬ ¶¥«®¬ x. ®ª ¦¨²¥, ·²® (¯°¨
²¥µ ¦¥ ¤®¯³¹¥­¨¿µ) ¨§ x  y (mod b) ±«¥¤³¥², ·²® x  y (mod a)
¯°¨ «¾¡»µ ¶¥«»µ x ¨ y .
33.1-7
¨ª±¨°³¥¬ ¶¥«®¥ ¯®«®¦¨²¥«¼­®¥ k. ³¤¥¬ ­ §»¢ ²¼ ¶¥«®¥ ·¨±«®
n (²®·­®©) k-© ±²¥¯¥­¼¾ (kth power), ¥±«¨ n ° ¢­® ak ¯°¨ ­¥ª®²®°®¬ ¶¥«®¬ a. ¥«®¥ ·¨±«® n > 1 ­ §®¢¥¬ ­¥²°¨¢¨ «¼­®© ±²¥¯¥­¼¾
(nontrivial power), ¥±«¨ ®­® ¿¢«¿¥²±¿ k-© ±²¥¯¥­¼¾ ¯°¨ ­¥ª®²®°®¬
¶¥«®¬ k > 1. °¥¤«®¦¨²¥ ¯®«¨­®¬¨ «¼­»©  «£®°¨²¬, ®¯°¥¤¥«¿¾¹¨©, ¿¢«¿¥²±¿ «¨ ¤ ­­®¥ ·¨±«® n ­¥²°¨¢¨ «¼­®© ±²¥¯¥­¼¾.
33.1-8
®ª ¦¨²¥ ±¢®©±²¢  (33.8){(33.12).
33.1-9
®ª ¦¨²¥, ·²® ´³­ª¶¨¿ gcd  ±±®¶¨ ²¨¢­ , ²® ¥±²¼ ¤«¿
gcd(a; gcd(b; c)) = gcd(gcd(a; b); c) ¤«¿ «¾¡»µ ¶¥«»µ a; b; c.
33.1-10*
®ª ¦¨²¥ ²¥®°¥¬³ 33.8.
33.1-11
1

2

724

« ¢  33 ¥®p¥²¨ª®-·¨±«®¢»¥  «£®p¨²¬»

°¥¤«®¦¨²¥  «£®°¨²¬», ¢»·¨±«¿¾¹¨¥ §  ¢°¥¬¿ O( 2 ) · ±²­®¥
¨ ®±² ²®ª ®² ¤¥«¥­¨¿  -¡¨²®¢®£® ¶¥«®£® ·¨±«  ­  ¡®«¥¥ ª®°®²ª®¥
(¢°¥¬¥­¥¬ ±·¨² ¥¬ ·¨±«® ¡¨²®¢»µ ®¯¥° ¶¨©).
33.1-12
®±²°®©²¥ ½´´¥ª²¨¢­»©  «£®°¨²¬, ¯¥°¥¢®¤¿¹¨©  -¡¨²®¢®¥ ¶¥«®¥ ·¨±«® ¨§ ¤¢®¨·­®© ±¨±²¥¬» ¢ ¤¥±¿²¨·­³¾. ®ª ¦¨²¥, ·²® ¥±«¨
³¬­®¦¥­¨¥ ¨ ¤¥«¥­¨¥ ¤¢³µ ¶¥«»µ ·¨±¥« ¤«¨­» ­¥ ¡®«¥¥  (¨¬¥¥²±¿
¢ ¢¨¤³ ¤«¨­  ¤¢®¨·­®© § ¯¨±¨) ²°¥¡³¥² ¢°¥¬¥­¨ M ( ), ²® ¯¥°¥¢®¤  ;¡¨²®¢®£® ¶¥«®£® ·¨±«  ¨§ ¤¢®¨·­®© ±¨±²¥¬» ¢ ¤¥±¿²¨·­³¾
¬®¦¥² ¡»²¼ ¢»¯®«­¥­ §  ¢°¥¬¿ (M ( ) lg  ).
(ª § ­¨¥. ±¯®«¼§³©²¥ ¬¥²®¤ À° §¤¥«¿© ¨ ¢« ±²¢³©Á, ¯®«³· ¿
®²¤¥«¼­® «¥¢³¾ ¨ ¯° ¢³¾ · ±²¨ °¥§³«¼² ² .)

33.2.  ¨¡®«¼¸¨© ®¡¹¨© ¤¥«¨²¥«¼
 ½²®¬ ° §¤¥«¥ ¬» ¯°¥¤¯®« £ ¥¬, ·²® ¢±¥ ° ±±¬ ²°¨¢ ¥¬»¥ ¶¥«»¥ ·¨±«  ¯®«®¦¨²¥«¼­» (¤«¿ ­ ¨¡®«¼¸¥£® ®¡¹¥£® ¤¥«¨²¥«¿ §­ ª
°®«¨ ­¥ ¨£° ¥²).
®¦­® ¢»·¨±«¿²¼  (a; b), ° §« £ ¿ a ¨ b ­  ¬­®¦¨²¥«¨ ¨
®²¡¨° ¿ ®¡¹¨¥ ¬­®¦¨²¥«¨: ¥±«¨

a = pe1 pe2  : : :  perr
2

(33:13)

b = pf1 pf2  : : :  pfrr ;

(33:14)

1

¨
²®

1

2

e ;f ) pmin(e ;f )  : : :  pmin(er ;fr )
gcd(a; b) = pmin(
(33:15)
r
1
2
® ° §«®¦¥­¨¥ ­  ¬­®¦¨²¥«¨, ª ª ¬» ³¢¨¤¨¬ ¢ ° §¤¥«¥ 33.9, ¿¢«¿¥²±¿ ²°³¤­®© § ¤ ·¥©, ² ª ·²® ¥£® «³·¸¥ ¨§¡¥£ ²¼.
«£®°¨²¬ ¢ª«¨¤  ¤«¿ ­ µ®¦¤¥­¨¿ ­ ¨¡®«¼¸¥£® ®¡¹¥£® ¤¥«¨²¥«¿ ®±­®¢ ­ ­  ±«¥¤³¾¹¥© ²¥®°¥¬¥.
¥®°¥¬  33.9 (¥ª³°°¥­²­ ¿ ´®°¬³«  ¤«¿ gcd)
³±²¼ a | ¶¥«®¥ ­¥®²°¨¶ ²¥«¼­®¥,   b | ¶¥«®¥ ¯®«®¦¨²¥«¼­®¥
·¨±«®. ®£¤  gcd(a; b) = gcd(b; a mod b):
®ª § ²¥«¼±²¢®.
 °  (a; b) ¨¬¥¥² ²¥ ¦¥ ¤¥«¨²¥«¨, ·²® ¨ ¯ °  (b; a mod b) (a mod b
¿¢«¿¥²±¿ ¶¥«®·¨±«¥­­®© «¨­¥©­®© ª®¬¡¨­ ¶¨¥© a ¨ b ¨ ­ ®¡®°®²).
®½²®¬³ ¨ ­ ¨¡®«¼¸¨© ®¡¹¨© ¤¥«¨²¥«¼ ³ ½²¨µ ¯ ° ®¤¨­ ª®¢»©.
«£®°¨²¬ ¢ª«¨¤ .
°¨¢®¤¨¬»© ­¨¦¥  «£®°¨²¬ ¢»·¨±«¥­¨¿ ­ ¨¡®«¼¸¥£® ®¡¹¥£®
¤¥«¨²¥«¿ ®¯¨± ­ ¢ ª­¨£¥ ¢ª«¨¤  À · « Á (®ª®«® 300 £. ¤® ..),
µ®²¿, ¢®§¬®¦­®, ¡»« ¨§¢¥±²¥­ ¨ ° ­¥¥. » § ¯¨¸¥¬ ¥£® ¢ ¢¨¤¥ °¥ª³°±¨¢­®© ¯°®¶¥¤³°»; ¥¥ ¢µ®¤®¬ ¿¢«¿¾²±¿ ­¥®²°¨¶ ²¥«¼­»¥ ¶¥«»¥
·¨±«  a ¨ b.
1

1

2

2

 ¨¡®«¼¸¨© ®¡¹¨© ¤¥«¨²¥«¼

725

Euclid (a,b)
1 if b=0
2
then return a
3
else return Euclid (b, a mod b)

 ¯°¨¬¥°, ¯°¨ ¢»·¨±«¥­¨¨ Euclid(30; 21) = Euclid(21:9) =
Euclid(9; 3) = Euclid(3; 0) = 3 ¯°®¶¥¤³°  ¢»§»¢ ¥² ±¥¡¿ ²°¨¦¤».
° ¢¨«¼­®±²¼ ¯°®¶¥¤³°» Euclid ¢»²¥ª ¥² ¨§ ±®®²­®¸¥­¨¿

(33.11) ¨ ¨§ ²¥®°¥¬» 33.9. °®¶¥¤³°  ­¥ ¬®¦¥² ° ¡®² ²¼ ¡¥±ª®­¥·­®, ¯®±ª®«¼ª³ °¥ª³°±¨¢­»© ¢»§®¢ ¯°®¨±µ®¤¨² ± ¬¥­¼¸¨¬
§­ ·¥­¨¥¬ ¢²®°®£®  °£³¬¥­² .
°¥¬¿ ° ¡®²»  «£®°¨²¬  ¢ª«¨¤ .
¶¥­¨¬ ¢°¥¬¿ ° ¡®²»  «£®°¨²¬  ¢ª«¨¤ , ±·¨² ¿, ·²® ° §¬¥° 
¢µ®¤  ±«³· © a > b > 0 (¯°¨ b > a > 0 ¯°®¶¥¤³°  Euclid(a; b)
¯¥°¢»¬ ¤¥«®¬ ¢»§»¢ ¥² ±¥¡¿, ¯¥°¥±² ¢¨¢  °£³¬¥­²» ¬¥±² ¬¨,  
¯°¨ a = b > 0 ° ¡®²  ¯°®¶¥¤³°» § ¢¥°¸ ¥²±¿ ¯®±«¥ ¥¤¨­±²¢¥­­®£®
°¥ª³°±¨¢­®£® ¢»§®¢ , ¯®±ª®«¼ª³ a mod a = 0).  ¬¥²¨¬, ·²® ¢®
¢±¥µ °¥ª³°±¨¢­»µ ¢»§®¢ µ ¯¥°¢»©  °£³¬¥­² ¡³¤¥² ±²°®£® ¡®«¼¸¥
¢²®°®£® (®±² ²®ª ¬¥­¼¸¥ ¤¥«¨²¥«¿).
°¥¬¿ ° ¡®²» ¯°®¶¥¤³°» Euclid ¯°®¯®°¶¨®­ «¼­® £«³¡¨­¥ °¥ª³°±¨¨. «¿ ¥¥ ®¶¥­ª¨ ­ ¬ ¯°¨£®¤¿²±¿ ·¨±«  ¨¡®­ ··¨ Fk , ®¯°¥¤¥«¥­­»¥ °¥ª³°°¥­²­»¬ ±®®²­®¸¥­¨¥¬ (2.13).
¥¬¬  33.10
³±²¼ a > b > 0. ±«¨ ¯°®¶¥¤³°  Euclid(a; b) ¢® ¢°¥¬¿ ° ¡®²»
¢»§»¢ ¥² ±¥¡¿ k ° § (k > 1), ²® a > Fk+2 ¨ b > Fk+1 .
®ª § ²¥«¼±²¢®
¯°®¢¥¤¥¬ ¨­¤³ª¶¨¥© ¯® k.  §¨±®¬ ¨­¤³ª¶¨¨ ±«³¦¨² §­ ·¥­¨¥
k = 1. ±«¨ ¯°®¨±µ®¤¨² µ®²¼ ®¤¨­ °¥ª³°±¨¢­»© ¢»§®¢, ²® b > 1 =
F2 ; ¯® ³±«®¢¨¾ ²¥®°¥¬» a > b, ² ª ·²® a > 2 = F3 .
³±²¼ «¥¬¬  ¢»¯®«­¥­  ¤«¿ ±«³· ¿ k ; 1 ¢»§®¢®¢; ¤®ª ¦¥¬ ¥¥
¤«¿ k ¢»§®¢®¢.   ¯¥°¢®¬ ¸ £¥ ¯°®¶¥¤³°  Euclid(a; b) ¢»¯®«­¿¥²
¢»§®¢ Euclid(b; a mod b), ¢­³²°¨ ª®²®°®£® ¯°®¨±µ®¤¨² k ; 1 °¥ª³°±¨¢­»µ ¢»§®¢®¢, ² ª ·²® ¯® ¯°¥¤¯®«®¦¥­¨¾ ¨­¤³ª¶¨¨ b > Fk+1
¨ (a mod b) > Fk . § ­¥° ¢¥­±²¢  a > b > 0 ±«¥¤³¥², ·²® ba=bc > 1
¨ b + (a mod b) = b + (a ; ba=bcb) 6 a, ² ª ·²® a > b + (a mod b) >
Fk+1 + Fk = Fk+2 .
§ «¥¬¬» 33.10 ¢»²¥ª ¥² ±«¥¤³¾¹ ¿ ²¥®°¥¬ .
¥®°¥¬  33.11 (¥®°¥¬   ¬¥)
³±²¼ k | ¶¥«®¥ ¯®«®¦¨²¥«¼­®¥ ·¨±«®. ±«¨ a > b > 0 ¨ b <
Fk+1 , ²® ¯°®¶¥¤³°  Euclid(a; b) ¢»¯®«­¿¥² ¬¥­¥¥ k °¥ª³°±¨¢­»µ
¢»§®¢®¢.
®ª ¦¥¬, ·²® ®¶¥­ª  ²¥®°¥¬» 33.11 ­¥³«³·¸ ¥¬ , ° ±±¬®²°¥¢
¢»·¨±«¥­¨¥ ­ ¨¡®«¼¸¥£® ®¡¹¥£® ¤¥«¨²¥«¿ ±®±¥¤­¨µ ·¨±¥« ¨¡®­ ··¨. °®¶¥¤³°  Euclid(F3 ; F2) ¢»¯®«­¿¥² ®¤¨­ °¥ª³°±¨¢­»© ¢»§®¢. ®±ª®«¼ª³ Fk+1 mod Fk = Fk;1 , ¢»·¨±«¥­¨¥ ¡³¤¥² ¨¤²¨ ² ª:
gcd(Fk+1 ; Fk ) = gcd(Fk ; (Fk+1 mod Fk )) =  (Fk ; Fk;1 ), ¯®½²®¬³

726

« ¢  33 ¥®p¥²¨ª®-·¨±«®¢»¥  «£®p¨²¬»

33.1:  ¡®²  ¯°®¶¥¤³°» Extended-Euclid ­  ¢µ®¤¥ (99; 78).
¢®§¢° ¹ ¥² ²°®©ª³ (3; ;11; 14), ² ª ·²®
 (99; 78) = 3 = 99  (;11) + 78  14.
¨±.

33.1

Extended-Euclid(99; 78)

¢»·¨±«¥­¨¥ Euclid(Fk+1 ; Fk ) ¢ª«¾· ¥² °®¢­® k ; 1 °¥ª³°±¨¢­»µ
¢»§®¢®¢ ¨ ¢¥°µ­¿¿ ®¶¥­ª  ¤®±²¨£ ¥²±¿.
p
p
®±ª®«¼ª³ Fk ¯°¨¬¥°­® ° ¢­® 'k = 5, £¤¥ ' = (1 + 5)=2 | ² ª
­ §»¢ ¥¬®¥ À§®«®²®¥ ±¥·¥­¨¥Á ±¬. (2.14)), ·¨±«® °¥ª³°±¨¢­»µ ¢»§®¢®¢ ¤«¿ Euclid(a; b) (¯°¨ a > b > 0) ±®±² ¢«¿¥² O(lg b). (®«¥¥ ²®·­³¾ ®¶¥­ª³ ±¬. ¢ ³¯°. 33.2-5.) ±«¨ ¯°®¶¥¤³°  Euclid ¯°¨¬¥­¿¥²±¿
ª ¤¢³¬  -¡¨²®¢»¬ ·¨±« ¬, ²® ¥© ¯°¨µ®¤¨²±¿ ¢»¯®«­¿²¼ O( )  °¨´¬¥²¨·¥±ª¨µ ®¯¥° ¶¨©, ¨«¨ O( 3 ) ¡¨²®¢»µ (±·¨² ¥¬, ·²® ³¬­®¦¥­¨¥
¨ ¤¥«¥­¨¥  ;¡¨²®¢»µ ·¨±¥« ²°¥¡³¥² O( 2 ) ¡¨²®¢»µ ®¯¥° ¶¨©).  
± ¬®¬ ¤¥«¥ ±¯° ¢¥¤«¨¢  ¡®«¥¥ ±¨«¼­ ¿ ®¶¥­ª  O( 2 ) ­  ·¨±«® ¡¨²®¢»µ ®¯¥° ¶¨©, ¢»¯®«­¿¥¬»µ ¯°®¶¥¤³°®© Euclid (§ ¤ ·  33-2).
 ±¸¨°¥­­»©  «£®°¨²¬ ¢ª«¨¤ .
¥¬­®£® ¤®¯®«­¨¢  «£®°¨²¬ ¢ª«¨¤ , ¬®¦­® ¯®«³· ²¼ ± ¥£® ¯®¬®¹¼¾ ª®½´´¨¶¨¥­²» x ¨ y , ¤«¿ ª®²®°»µ

d =  (a; b) = ax + by

(33:18)

(²¥®°¥¬  33.2). ¡° ²¨²¥ ¢­¨¬ ­¨¥, ·²® ª®½´´¨¶¨¥­²» x ¨ y ¬®£³²
®ª § ²¼±¿ ­¥ ²®«¼ª® ¯®«®¦¨²¥«¼­»¬¨, ­® ¨ ­³«¥¢»¬¨ ¨«¨ ®²°¨¶ ²¥«¼­»¬¨. (²¨ ª®½´´¨¶¨¥­²» ­³¦­» ¤«¿ ¢»·¨±«¥­¨¿ ®¡° ²­»µ
½«¥¬¥­²®¢ ¢ ª®«¼¶¥ ¢»·¥²®¢.)
°®¶¥¤³°  Extended-Euclid ¯®«³· ¥² ­  ¢µ®¤ ¯°®¨§¢®«¼­³¾
¯ °³ ¶¥«»µ ·¨±¥« ¨ ¢»¤ ¥² ­  ¢»µ®¤¥ ²°®©ª³ ¶¥«»µ ·¨±¥« (d; x; y ),
³¤®¢«¥²¢®°¿¾¹¨µ ±®®²­®¸¥­¨¾ (33.18).
Extended-Euclid (a,b)
1 if b=0
2
then return (a,1,0)
3 (d',x',y') \gets Extended-Euclid(b,a mod b)
4 (d,x,y) \gets (d', y', x'-\lfloor a/b\rfloor y')
5 return (d,x,y)

¨±³­®ª 33.1 ¨««¾±²°¨°³¥² ° ¡®²³ ¯°®¶¥¤³°» Extended-

Euclid ­  ¢µ®¤¥ (99; 78)

±«¨ b = 0, ¯°®¶¥¤³°  Extended-Euclid ¢»¤ ¥² §­ ·¥­¨¥ d = a,
  ² ª¦¥ §­ ·¥­¨¿ x = 1 ¨ y = 0, ¤«¿ ª®²®°»µ d = a = ax + by .
±«¨ b 6= 0, °¥ª³°±¨¢­»© ¢»§®¢ ¯®§¢®«¿¥² ­ ©²¨ ·¨±«  (d0; x0; y 0),
² ª¨µ, ·²® d0 =  (b; a mod b) ¨

d0 = bx0 + (a mod b)y 0:

(33:19)

 ª ¬» §­ ¥¬, d0 = d, ² ª ·²® ®±² «®±¼ ­ ©²¨ x ¨ y , ¤«¿ ª®²®°»µ
d = ax + by . ¥°¥¯¨¸¥¬ ° ¢¥­±²¢® (33.19): d = bx0 +(a ;ba=bcb)y 0 =

 ¨¡®«¼¸¨© ®¡¹¨© ¤¥«¨²¥«¼

727

ay 0 + b(x0 ; ba=bcy 0).  ª¨¬ ®¡° §®¬, ¬®¦­® ¯®«®¦¨²¼ x = y 0 ¨
y = x0 ; ba=bcy 0.

 ª ¨ ° ­¼¸¥, ·¨±«® °¥ª³°±¨¢­»µ ¢»§®¢®¢ ¯°¨ ° ¡®²¥

Extended-Euclid(a; b) ±®±² ¢«¿¥² O(lg b).

¯° ¦­¥­¨¿
33.2-1
¡º¿±­¨²¥, ª ª¨¬ ®¡° §®¬ ¨§ ° ¢¥­±²¢ (33.13){(33.14) ±«¥¤³¥²
° ¢¥­±²¢® (33.15).
33.2-2
°®±«¥¤¨²¥ §  ¢»¯®«­¥­¨¥¬ ¯°®¶¥¤³°» Extended-Euclid ­ 
¢µ®¤¥ (899; 493) ¨ ­ ©¤¨²¥ ²°®©ª³ (d; x; y ).
33.2-3
®ª ¦¨²¥, ·²® ¤«¿ «¾¡»µ ¶¥«»µ ·¨±¥« a, k ¨ n ¢»¯®«­¿¥²±¿ ° ¢¥­±²¢® gcd(a; n) = gcd(a + kn; n).
33.2-4
¥°¥¯¨¸¨²¥ ¯°®¶¥¤³°³ Euclid, § ¬¥­¨¢ °¥ª³°±¨¾ ¶¨ª«®¬ ¨
®£° ­¨·¨¢¸¨±¼ ´¨ª±¨°®¢ ­­»¬ ®¡º¥¬®¬ ¯ ¬¿²¨ (¨±¯®«¼§³¿ «¨¸¼
´¨ª±¨°®¢ ­­®¥ ·¨±«® ¶¥«»µ ¯¥°¥¬¥­­»µ)
33.2-5
³±²¼ a > b > 0. ®ª ¦¨²¥, ·²® ¯°®¶¥¤³°  Euclid(a; b) ¢»¯®«­¿¥² ­¥ ¡®«¥¥ 1+log' b °¥ª³°±¨¢­»µ ¢»§®¢®¢. ®ª ¦¨²¥ ¡®«¥¥ ²®·­³¾
®¶¥­ª³ 1 + log' (b=gcd(a; b)).
33.2-6
 ª®© ®²¢¥² ¤ ¥² ¯°®¶¥¤³°  Extended-Euclid(Fk+1 ; Fk )?
33.2-7
®ª ¦¨²¥, ·²® ¥±«¨ d j a, d j b ¨ d = ax + by , ²® d = gcd(a; b).
33.2-8
 ±¯°®±²° ­¨¬ ®¯°¥¤¥«¥­¨¥ ´³­ª¶¨¨ gcd ­  ¡®«¼¸¥¥ ·¨±«®  °£³¬¥­²®¢, ¯®«®¦¨¢ gcd(a0 ; a1; : : : ; an ) = gcd(a0 ; gcd(a1; : : : ; an )): ®ª ¦¨²¥, ·²® °¥§³«¼² ² ­¥ § ¢¨±¨² ®² ¯®°¿¤ª   °£³¬¥­²®¢. °¥¤«®¦¨²¥  «£®°¨²¬ ­ µ®¦¤¥­¨¿ ª®½´´¨¶¨¥­²®¢ x0; x1; : : : ; xn, ¤«¿ ª®²®°»µ gcd(a0 ; a1; : : : ; an ) = a0 x0 + a1 x1 +    + an xn ;, ¢»¯®«­¿¾¹¨©
O(n + lg(maxi ai )) ®¯¥° ¶¨© ¤¥«¥­¨¿.
33.2-9
 §®¢¥¬ ­ ¨¬¥­¼¸¨¬ ®¡¹¨¬ ª° ²­»¬ (least common multiple)
¶¥«»µ ·¨±¥« a1 ; a2; : : : ; an ­ ¨¬¥­¼¸¥¥ ¯®«®¦¨²¥«¼­®¥ ¶¥«®¥ ·¨±«®,
ª° ²­®¥ ª ¦¤®¬³ ¨§ ­¨µ (®¡®§­ ·¥­¨¥ lcm(a0; a1; : : : ; an)). ª ¦¨²¥ ½´´¥ª²¨¢­»©  «£®°¨²¬, ¢»·¨±«¿¾¹¨© lcm(a0; a1; : : : ; an) ¨ ¨±¯®«¼§³¾¹¨© ®¯¥° ¶¨¾ ¯®¨±ª  ­ ¨¡®«¼¸¥£® ®¡¹¥£® ¤¥«¨²¥«¿ (¤¢³µ
·¨±¥«) ¢ ª ·¥±²¢¥ ¯®¤¯°®£° ¬¬».
33.2-10
®ª ¦¨²¥, ·²® ·¨±«  n1 , n2 , n3 ¨ n4 ¯®¯ °­® ¢§ ¨¬­® ¯°®±²»
²®£¤  ¨ ²®«¼ª® ²®£¤ , ª®£¤  gcd(n1 n2 ; n3n4 ) = gcd(n1 n3 ; n2n4 ) = 1.
®ª ¦¨²¥, ·²® ½²® ³²¢¥°¦¤¥­¨¥ ¬®¦­® ®¡®¡¹¨²¼, ¤®ª § ²¼
³²¢¥°¦¤¥­¨¥ ² ª®£® ²¨¯ : ·¨±«  n1 ; n2; : : : ; nk ¯®¯ °­® ¢§ ¨¬­®
¯°®±²», ¥±«¨ ¨ ²®«¼ª® ¥±«¨ gcd(a1 ; b1) = gcd(a2 ; b2) = : : : =

728

« ¢  33 ¥®p¥²¨ª®-·¨±«®¢»¥  «£®p¨²¬»

gcd(at ; bt) = 1, £¤¥ t = dlg ke,   ·¨±«  ai ¨ bi ¯°¥¤±² ¢«¿¾² ±®¡®©
¯°®¨§¢¥¤¥­¨¿ ­¥ª®²®°»µ ni .

33.3. ®¤³«¿°­ ¿  °¨´¬¥²¨ª 
°¨´¬¥²¨·¥±ª¨¥ ®¯¥° ¶¨¨ ¯® ¬®¤³«¾ n ¯°®¢®¤¿²±¿ ­ ¤ ·¨±« ¬¨
0; 1; : : : ; n ; 1 ² ª: ¥±«¨ °¥§³«¼² ² ±«®¦¥­¨¿, ¢»·¨² ­¨¿ ¨«¨ ³¬­®¦¥­¨¿ ¢»µ®¤¨² §  ¯°¥¤¥«» ³ª § ­­®£® ¨­²¥°¢ « , ²® ®­ § ¬¥­¿¥²±¿ ®±² ²ª®¬ ¯°¨ ¤¥«¥­¨¨ ­  n. «®¦­¥¥ ®¡±²®¨² ¤¥«® ± ¤¥«¥­¨¥¬.
²®¡» ° §®¡° ²¼±¿ ¢ ½²®¬, ­ ¯®¬­¨¬ ­¥ª®²®°»¥ ¯®­¿²¨¿ ²¥®°¨¨
£°³¯¯.
®­¥·­»¥ £°³¯¯».
­®¦¥±²¢® S ± ®¯°¥¤¥«¥­­®© ­  ­¥¬ ¡¨­ °­®© ®¯¥° ¶¨¥©  ­ §»¢ ¥²±¿ £°³¯¯®© (group), ¥±«¨ ¢»¯®«­¥­» ² ª¨¥ ±¢®©±²¢ :
1.  ¬ª­³²®±²¼ (closure): a  b 2 S ¤«¿ «¾¡»µ a; b 2 S .
2. ³¹¥±²¢®¢ ­¨¥ ­¥©²° «¼­®£® ½«¥¬¥­²  (identity): ±³¹¥±²¢³¥²
½«¥¬¥­² e 2 S , ¤«¿ ª®²®°®£® e  a = a  e = a ¤«¿ «¾¡®£® a 2 S
(² ª®© ½«¥¬¥­² ¬®¦¥² ¡»²¼ ²®«¼ª® ®¤¨­, ² ª ª ª e = e  e0 = e0
¤«¿ «¾¡»µ ¤¢³µ ½«¥¬¥­²®¢ e ¨ e0 ± ² ª¨¬ ±¢®©±²¢®¬).
3. ±±®¶¨ ²¨¢­®±²¼ (associativity): a  (b  c) = (a  b)  c ¤«¿
«¾¡»µ a; b; c 2 S .
4. ³¹¥±²¢®¢ ­¨¥ ®¡° ²­»µ ½«¥¬¥­²®¢ (inverses): ¤«¿ ¢±¿ª®£® a 2
S ­ ©¤¥²±¿ ¥¤¨­±²¢¥­­»© ½«¥¬¥­² b 2 S , ¤«¿ ª®²®°®£® a  b =
b  a = e.
 ¯°¨¬¥°, ¶¥«»¥ ·¨±«  ± ®¯¥° ¶¨¥© ±«®¦¥­¨¿: ®¡° §³¾² £°³¯¯³.
 ­¥© 0 ±«³¦¨² ­¥©²° «¼­»¬ ½«¥¬¥­²®¬,   ®¡° ²­»¬ (¯® ±«®¦¥­¨¾) ½«¥¬¥­²®¬ ª ·¨±«³ a ¿¢«¿¥²±¿ ·¨±«® (;a). °³¯¯  ­ §»¢ ¥²±¿
 ¡¥«¥¢®© (abelian), ¥±«¨ ¢»¯®«­¥­® ±¢®©±²¢® ª®¬¬³² ²¨¢­®±²¨ :
a  b = b  a ¤«¿ ¢±¥µ a; b 2 S .
°³¯¯  ­ §»¢ ¥²±¿ ª®­¥·­®© (nite), ¥±«¨ ·¨±«® ½«¥¬¥­²®¢ ¢ ­¥©
ª®­¥·­®.
¤¤¨²¨¢­»¥ ¨ ¬³«¼²¨¯«¨ª ²¨¢­»¥ £°³¯¯» ¢»·¥²®¢
®¦­® ¯®±²°®¨²¼ ¤¢¥ £°³¯¯», ½«¥¬¥­² ¬¨ ª®²®°»µ ¡³¤³² ¢»·¥²» (®±² ²ª¨ ¯® ¬®¤³«¾ n, ¨«¨ ª« ±±» ½ª¢¨¢ «¥­²­®±²¨ ¯® ¬®¤³«¾
n, ±¬. ° §¤¥« 33.1).
» ±ª« ¤»¢ ¥¬ ¨ ³¬­®¦ ¥¬ ¢»·¥²» ¯® ¬®¤³«¾ n ¯® ¯° ¢¨« ¬
[a]n +n [b]n = [a + b]n; [a]n n [b]n = [ab]n:
²¨ ®¯°¥¤¥«¥­¨¿ ª®°°¥ª²­», ² ª ª ª ±³¬¬  (¯°®¨§¢¥¤¥­¨¥) ­¥ ¨§¬¥­¨²±¿ ¯® ¬®¤³«¾ n, ¥±«¨ ¨§¬¥­¨²¼ ±« £ ¥¬»¥ (¬­®¦¨²¥«¨) ­ 
½ª¢¨¢ «¥­²­»¥ ¯® ¬®¤³«¾ n.
¤¤¨²¨¢­ ¿ £°³¯¯  ¢»·¥²®¢ ¯® ¬®¤³«¾ n (additive group modulo n) ±®¤¥°¦¨² ¢»·¥²» [0]n; [1]n; : : : ; [n ; 1]n ; ®­¨ ±ª« ¤»¢ ¾²±¿
®¯¨± ­­»¬ ¢»¸¥ ®¡° §®¬; ®­  ®¡®§­ · ¥²±¿ (Zn; +n ).

®¤³«¿°­ ¿  °¨´¬¥²¨ª 

729

¨±. 33.2 33.2 (a) °³¯¯  ¢»·¥²®¢ ¯® ¬®¤³«¾ 6 ¯® ±«®¦¥­¨¾ (Z
6; +6 ). (b) °³¯¯  ®¡° ²¨¬»µ ¢»·¥²®¢ ¯® ¬®¤³«¾ 15 ¯® ³¬­®¦¥­¨¾ (Z15; 15 ).

¥®°¥¬  33.12
¨±²¥¬  (Zn; +n ) ¿¢«¿¥²±¿ ª®­¥·­®©  ¡¥«¥¢®© £°³¯¯®©.
®ª § ²¥«¼±²¢®.
±±®¶¨ ²¨¢­®±²¼ ¨ ª®¬¬³² ²¨¢­®±²¼ ®¯¥° ¶¨¨ +n ±«¥¤³¾² ¨§
 ­ «®£¨·­»µ ±¢®©±²¢ ±«®¦¥­¨¿ ¶¥«»µ ·¨±¥«. ¥©²° «¼­»¬ ½«¥¬¥­²®¬ ¿¢«¿¥²±¿ 0 (²®·­¥¥ £®¢®°¿, [0]n ). ¡° ²­»¬ (®²­®±¨²¥«¼­®
£°³¯¯®¢®© ®¯¥° ¶¨¨) ½«¥¬¥­²®¬ ª a (²®·­¥¥, [a]n ) ±«³¦¨² (;a) (²®
¥±²¼, [;a]n ¨«¨ [n ; a]n ).
¥±ª®«¼ª® ±«®¦­¥¥ ®¯°¥¤¥«¿¥²±¿ ¬³«¼²¨¯«¨ª ²¨¢­ ¿ £°³¯¯ 
¢»·¥²®¢ ¯® ¬®¤³«¾ n (mutiplicative group modulo n). «¥¬¥­²»
½²®© £°³¯¯» ®¡° §³¾² ¬­®¦¥±²¢® Zn, ±®±²®¿¹¥¥ ¨§ ½«¥¬¥­²®¢ Zn,
¢§ ¨¬­® ¯°®±²»µ ± n. ®­¿²¨¥ ¢§ ¨¬­®© ¯°®±²®²» ¨¬¥¥² ±¬»±« (­¥
§ ¢¨±¨² ®² ¢»¡®°  ¯°¥¤±² ¢¨²¥«¿ ¢ ª« ±±¥ ½ª¢¨¢ «¥­²­®±²¨): ¥±«¨
k | ¶¥«®¥ ·¨±«®, ²®  (a; n) = 1 ° ¢­®±¨«¼­®  (a+kn; n) = 1
(³¯°. 33.2-3).
 ª ·¥±²¢¥ ¯°¨¬¥°  ° ±±¬®²°¨¬ ±«³· © n = 15 (°¨±. 33.2 (b),
£¤¥ ¯¥°¥·¨±«¥­» ½«¥¬¥­²» ±®®²¢¥²±²¢³¾¹¥© £°³¯¯» ¨ ¯®ª § ­ 
² ¡«¨¶  ³¬­®¦¥­¨¿).
¥®°¥¬  33.13
¨±²¥¬  (Zn; n ) ¿¢«¿¥²±¿ ª®­¥·­®©  ¡¥«¥¢®© £°³¯¯®©.
®ª § ²¥«¼±²¢®.
°®¢¥°¨¬, ·²® «¾¡®© ½«¥¬¥­² ¨¬¥¥² ®¡° ²­»© ¢ ±¬»±«¥ £°³¯¯®¢®© ®¯¥° ¶¨¨. (¥©²° «¼­»¬ ½«¥¬¥­²®¬ ¿¢«¿¥²±¿ ª« ±± [1].) ²®¡»
­ ©²¨ ®¡° ²­»© ª ½«¥¬¥­²³ a, ° ±±¬®²°¨¬ ²°®©ª³ (d; x; y ), ¢»¤ ¢ ¥¬³¾ ¯°®¶¥¤³°®© Extended-Euclid(a; n). ®±ª®«¼ª³ a 2 Zn , ·¨±« 
a ¨ n ¢§ ¨¬­® ¯°®±²» ¨ d =  (a; b) = 1, ¯®½²®¬³ ax + ny = 1 ¨
ax  1 (mod n):  ª¨¬ ®¡° §®¬, ½«¥¬¥­² [x]n ¿¢«¿¥²±¿ ®¡° ²­»¬ ª
[a]n ¢ £°³¯¯¥ (Zn; n). ¤¨­±²¢¥­­®±²¼ ®¡° ²­®£® ¬®¦­® ¤®ª § ²¼
(ª ª ¨ ¤«¿ «¾¡®© £°³¯¯») ±«¥¤³¾¹¨¬ ®¡° §®¬: ¥±«¨ x ¨ x0 ®¡° ²­»
ª a, ²® (x  a)  x0 = e  x0 = x0 ,   ¯¥°¥±² ¢¨¢ ±ª®¡ª¨ ¯®  ±±®¶¨ ²¨¢­®±²¨, ¯®«³·¨¬ x  (a  x0 ) = x  e = x,
 ¤ «¼­¥©¸¥¬ ¬» ¤«¿ ¯°®±²®²» ¡³¤¥¬ ®¡®§­ · ²¼ ±«®¦¥­¨¥ ¨
³¬­®¦¥­¨¥ ¯® ¬®¤³«¾ ®¡»·­»¬¨ §­ ª ¬¨ + ¨  (¨­®£¤  ®¯³±ª ¿
§­ ª ³¬­®¦¥­¨¿),    ¤¤¨²¨¢­³¾ ¨ ¬³«¼²¨¯«¨ª ²¨¢­³¾ £°³¯¯» ¢»·¥²®¢ ¯® ¬®¤³«¾ n ¡³¤¥¬ ®¡®§­ · ²¼ Zn ¨ Zn (­¥ ³¯®¬¨­ ¿ £°³¯¯®¢³¾ ®¯¥° ¶¨¾). «¥¬¥­², ®¡° ²­»© (®²­®±¨²¥«¼­® ®¯¥° ¶¨¨ ³¬­®¦¥­¨¿) ª a, ¬» ¡³¤¥¬ ®¡®§­ · ²¼ a;1 mod n.  ª ®¡»·­®, · ±²­®¥
a=b ¢ Zn ®¯°¥¤¥«¿¥²±¿ ª ª ab;1 (mod n).  ¯°¨¬¥°, ¢ Z15 ¨¬¥¥¬
7;1  13 (mod 15), ¯®±ª®«¼ª³ 7  13  91  1 (mod 15), ®²ª³¤ 
4=7  4  13  7 (mod 15).
¨±«® ½«¥¬¥­²®¢ ¢ Zn ®¡®§­ · ¥²±¿ '(n). ³­ª¶¨¿ ' ­ §»¢ ¥²±¿
'-´³­ª¶¨¥© ©«¥°  (Euler's phi function). ®¦­® ¤®ª § ²¼ ² ª³¾

730

« ¢  33 ¥®p¥²¨ª®-·¨±«®¢»¥  «£®p¨²¬»

´®°¬³«³ ¤«¿ ´³­ª¶¨¨ ©«¥° :








'(n) = n 1 ; p1  : : :  1 ; p1 ;
(33:20)
1
s
£¤¥ p1; : : : ; ps | ±¯¨±®ª ¢±¥µ ¯°®±²»µ ¤¥«¨²¥«¥© ·¨±«  n. ®¦­®
¯®¿±­¨²¼ ½²³ ´®°¬³«³ ² ª: ±«³· ©­®¥ ·¨±«® t ¢§ ¨¬­® ¯°®±²® ± n,
¥±«¨ ®­® ­¥ ¤¥«¨²±¿ ­  p1 (¢¥°®¿²­®±²¼ ·¥£® ¥±²¼ (1 ; 1=p1), ­¥
¤¥«¨²±¿ ­  p2 (¢¥°®¿²­®±²¼ (1 ; 1=p2) ¨ ².¤.,   ±®¡»²¨¿ ½²¨ ­¥§ ¢¨±¨¬».
 ¯°¨¬¥°, '(45) = 45(1 ; 1=3)(1 ; 1=5) = 24, ¯®±ª®«¼ª³ ¯°®±²»¬¨
¤¥«¨²¥«¿¬¨ ·¨±«  45 ¿¢«¿¾²±¿ ·¨±«  3 ¨ 5. «¿ ¯°®±²®£® ·¨±«  p
¨¬¥¥¬
'(p) = p ; 1;
(33:21)
² ª ª ª ¢±¥ ·¨±«  1; 2; : : : ; p ; 1 ¢§ ¨¬­® ¯°®±²» ± p. ±«¨ ·¨±«® n
±®±² ¢­®¥, ²® '(n) < n ; 1.
®¤£°³¯¯».
³±²¼ (S; ) ¿¢«¿¥²±¿ £°³¯¯®©,   S 0  S . ±«¨ (S 0; ) ²®¦¥ ¿¢«¿¥²±¿ £°³¯¯®©, ²® (S 0; ) ­ §»¢ ¾² ¯®¤£°³¯¯®© (subgroup) £°³¯¯»
(S; ).  ¯°¨¬¥°, ·¥²­»¥ ·¨±«  ®¡° §³¾² ¯®¤£°³¯¯³ £°³¯¯» ¶¥«»µ
·¨±¥« (± ®¯¥° ¶¨¥© ±«®¦¥­¨¿).
¥®°¥¬  33.14
 ¬ª­³²®¥ ¯®¤¬­®¦¥±²¢® ª®­¥·­®© £°³¯¯» ¿¢«¿¥²±¿ ¯®¤£°³¯¯®©: ¥±«¨ (S; ) | ª®­¥·­ ¿ £°³¯¯®©, S 0  S ¨ a  b 2 S 0 ¤«¿
«¾¡»µ a; b 2 S 0, ²® (S 0; ) ¿¢«¿¥²±¿ ¯®¤£°³¯¯®© £°³¯¯» (S; ).
®ª § ²¥«¼±²¢®
®±² ¢«¿¥²±¿ ·¨² ²¥«¾ (³¯°. 33.3-2).
°¨¬¥°: ¬­®¦¥±²¢® f0; 2; 4; 6g  Z8 § ¬ª­³²® ®²­®±¨²¥«¼­® ±«®¦¥­¨¿ ¨ ®¡° §³¥² ¯®¤£°³¯¯³ £°³¯¯» Z8.
«¥¤³¾¹ ¿ ²¥®°¥¬  ­ ª« ¤»¢ ¥² ­  ° §¬¥° ¯®¤£°³¯¯ ¢ ¦­»¥
®£° ­¨·¥­¨¿.
¥®°¥¬  33.15 (¥®°¥¬   £° ­¦ )
±«¨ (S 0; ) ¿¢«¿¥²±¿ ¯®¤£°³¯¯®© ª®­¥·­®© £°³¯¯» (S; ), ²® jS 0j
¤¥«¨² jS j.
®ª § ²¥«¼±²¢®
¬®¦­® ­ ©²¨ ¢ ³·¥¡­¨ª µ  «£¥¡°» (£°³¯¯  S ° §¡¨¢ ¥²±¿ ­  ­¥¯¥°¥±¥ª ¾¹¨¥±¿ ª« ±±» ¢¨¤  x  S 0 , ª ¦¤»© ¨§ ª®²®°»µ ±®¤¥°¦¨²
jS 0j ½«¥¬¥­²®¢).
®¤£°³¯¯  S 0 £°³¯¯» S , ­¥ ±®¢¯ ¤ ¾¹ ¿ ±® ¢±¥© £°³¯¯®©, ­ §»¢ ¥²±¿ ±®¡±²¢¥­­®© (proper) ¯®¤£°³¯¯®©.
«¥¤±²¢¨¥ 33.16
±«¨ S 0 ¿¢«¿¥²±¿ ±®¡±²¢¥­­®© ¯®¤£°³¯¯®© ª®­¥·­®© £°³¯¯» S ,
²® jS 0j < jS j 6 2.
²® (®·¥¢¨¤­®¥) ±«¥¤±²¢¨¥ ²¥®°¥¬»  £° ­¦  ¡³¤¥² ¨±¯®«¼§®¢ ­® ¯°¨  ­ «¨§¥ ¢¥°®¿²­®±²­®£®  «£®°¨²¬  ¨««¥°  |  ¡¨­ 
(¯°®¢¥°ª  ¯°®±²®²»).

®¤³«¿°­ ¿  °¨´¬¥²¨ª 

731

®¤£°³¯¯ , ¯®°®¦¤¥­­ ¿ ½«¥¬¥­²®¬ £°³¯¯».
³±²¼ a | ­¥ª®²®°»© ½«¥¬¥­² ª®­¥·­®© £°³¯¯» S .  ±±¬®²°¨¬
¯®±«¥¤®¢ ²¥«¼­®±²¼ ½«¥¬¥­²®¢

e; a; a  a; a  a  a; : : :

®  ­ «®£¨¨ ±® ±²¥¯¥­¿¬¨ (£°³¯¯®¢ ¿ ®¯¥° ¶¨¿ ±®®²¢¥²±²¢³¥²
³¬­®¦¥­¨¾) ¡³¤¥¬ ¯¨± ²¼ a(0) = e, a(1) = a, a(2) = a  a, a(3) =
a  a  a ¨ ².¤. ¥£ª® ¢¨¤¥²¼, ·²® a(i)  a(j ) = a(i+j ), ¢ · ±²­®±²¨,
a(i)  a = a(i+1) . ­ «®£¨·­®¥ ³²¢¥°¦¤¥­¨¥ ¬®¦­® ±´®°¬³«¨°®¢ ²¼
¨ ¤«¿ À®²°¨¶ ²¥«¼­»µ ±²¥¯¥­¥©Á, ¢ · ±²­®±²¨, a(i)  a;1 = a(i;1) .
±«¨ £°³¯¯  S ª®­¥·­ , ²® ¯®±«¥¤®¢ ²¥«¼­®±²¼

e; a; a  a; a  a  a; : : :

¡³¤¥² ¯¥°¨®¤¨·­  (±«¥¤³¾¹¨© ½«¥¬¥­² ®¯°¥¤¥«¿¥²±¿ ¯°¥¤»¤³¹¨¬,
¯®½²®¬³ ° § ¯®¢²®°¨¢¸¨±¼, ½«¥¬¥­²» ¡³¤³² ¯®¢²®°¿²¼±¿ ¯® ¶¨ª«³).
°¥¤¯¥°¨®¤  ¯°¨ ½²®¬ ­¥ ¡³¤¥², ² ª ª ª ª ¦¤»© ½«¥¬¥­² ¬®¦¥²
¡»²¼ ¯®«³·¥­ ¨§ ±«¥¤³¾¹¥£® (¯°¨¬¥­¥­¨¥¬ £°³¯¯®¢®© ®¯¥° ¶¨¨ ª
­¥¬³ ¨ ª a;1 ) ¨ ¯®²®¬³ ¯¥°¥¤ ° ¢­»¬¨ ½«¥¬¥­² ¬¨ ¨¤³² ° ¢­»¥.
 ª¨¬ ®¡° §®¬, ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¨¬¥¥² ¢¨¤
e = a(0); a(1); a(2); : : : ; a(n;1); a(t) = e; : : :
(¤ «¼¸¥ ¢±¥ ¯®¢²®°¿¥²±¿) ¨ ±®¤¥°¦¨² t ° §«¨·­»µ ½«¥¬¥­²®¢, £¤¥ t
| ­ ¨¬¥­¼¸¥¥ ¯®«®¦¨²¥«¼­®¥ ·¨±«®, ¤«¿ ª®²®°®£® a(t) = e. ²® ·¨±«® ­ §»¢ ¥²±¿ ¯®°¿¤ª®¬ (order) ½«¥¬¥­²  a ¨ ®¡®§­ · ¥²±¿ ord(a).
ª § ­­»¥ n ½«¥¬¥­²®¢ ®¡° §³¾² ¯®¤£°³¯¯³. ²® ±«¥¤³¥² ¨§ ²¥®°¥¬» 33:14, ª°®¬¥ ²®£®, ½²® ¬®¦­® ¯°®¢¥°¨²¼ ­¥¯®±°¥¤±²¢¥­­®,
² ª ª ª £°³¯¯®¢ ¿ ®¯¥° ¶¨¿ ±®®²¢¥²±²¢³¥² ±«®¦¥­¨¾ À±²¥¯¥­¥©Á.
²  ¯®¤£°³¯¯  ­ §»¢ ¥²±¿ ¯®°®¦¤¥­­®© ½«¥¬¥­²®¬ a (subgroup
generated by a) ¨ ®¡®§­ · ¥²±¿ hai ¨«¨, ¥±«¨ ¬» µ®²¨ ¿¢­® ³ª § ²¼
£°³¯¯®¢³¾ ®¯¥° ¶¨¾, (hai; ). «¥¬¥­² a ­ §»¢ ¾² ®¡° §³¾¹¥©
(generator) ¯®¤£°³¯¯» hai; £®¢®°¿², ·²® ®­ ¯®°®¦¤ ¥² (generates)
½²³ ¯®¤£°³¯¯³.  ¯°¨¬¥°, ½«¥¬¥­² a = 2 £°³¯¯» Z6 ¯®°®¦¤ ¥²
¯®¤£°³¯¯³. ±®±²®¿¹ ¿ ¨§ ½«¥¬¥­²®¢ 0; 2; 4.
®² ­¥±ª®«¼ª® ¯®¤£°³¯¯ £°³¯¯» Z6, ¯®°®¦¤¥­­»µ ° §«¨·­»¬¨
½«¥¬¥­² ¬¨: h0i = f0g, h1i = f0; 1; 2; 3; 4; 5g, h2i = f0; 2; 4g. ­ «®£¨·­»© ¯°¨¬¥° ¤«¿ ¬³«¼²¨¯«¨ª ²¨¢­®© £°³¯¯» Z7: §¤¥±¼ h1i = f1g,
h2i = f1; 2; 4g, h3i = f1; 2; 3; 4; 5; 6g.
§ ±ª § ­­®£® ­ ¬¨ ¢»²¥ª ¥²
¥®°¥¬  33.17
³±²¼ (S; ) | ª®­¥·­ ¿ £°³¯¯ . ±«¨ a 2 S , ²® ° §¬¥° ¯®¤£°³¯¯», ¯®°®¦¤ ¥¬®© a, ±®¢¯ ¤ ¥² ± ¯®°¿¤ª®¬ a (²® ¥±²¼, jhaij =
ord(a)).
«¥¤±²¢¨¥ 33.18
®±«¥¤®¢ ²¥«¼­®±²¼ a(1) ; a(2); : : : ¯¥°¨®¤¨·­  ± ¯¥°¨®¤®¬ t =
ord(a); ¨­ ·¥ £®¢®°¿, a(i) = a(j ) ²®£¤  ¨ ²®«¼ª® ²®£¤ , ª®£¤  i  j
(mod t).

732

« ¢  33 ¥®p¥²¨ª®-·¨±«®¢»¥  «£®p¨²¬»

¥°¨®¤¨·­®±²¼ ¯®§¢®«¿¥² ¯°®¤®«¦¨²¼ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¢ ®¡¥
±²®°®­», ®¯°¥¤¥«¨¢ a(i) ª ª a(i) = a(i modt) (°¨ ¢±¿ª®¬ ¶¥«®¬ i (¢
²®¬ ·¨±«¥ ¨ ®²°¨¶ ²¥«¼­®¬.)
«¥¤±²¢¨¥ 33.19
 ª®­¥·­®© £°³¯¯¥ (S; ) ± ¥¤¨­¨¶¥© e ¤«¿ ¢±¿ª®£® a 2 S ¢»¯®«­¿¥²±¿ ° ¢¥­±²¢® a(jS j) = e:
®ª § ²¥«¼±²¢®
® ²¥®°¥¬¥  £° ­¦  ord(a) j jS j, ®²ª³¤  jS j  0 (mod t), £¤¥
t = ord(a).
¯° ¦­¥­¨¿
33.3-1
 ¯¨¸¨²¥ ² ¡«¨¶» ¤«¿ £°³¯¯®¢»µ ®¯¥° ¶¨© ¢ £°³¯¯ µ (Z4; +4) ¨
(Z5; 5). ®ª ¦¨²¥, ·²® ½²¨ £°³¯¯» ¨§®¬®°´­», ²® ¥±²¼ ¯®±²°®©²¥
¢§ ¨¬­®-®¤­®§­ ·­®¥ ±®®²¢¥²±²¢¨¥  ¬¥¦¤³ ¨µ ½«¥¬¥­² ¬¨, ³¤®¢«¥²¢®°¿¾¹¥¥ ±«¥¤³¾¹¥¬³ ±¢®©±²¢³: ° ¢¥­±²¢® a + b  c (mod 4)
¤®«¦­® ¢»¯®«­¿²¼±¿ ®¤­®¢°¥¬¥­­® ± ° ¢¥­±²¢®¬ (a)  (b)  (c)
(mod 5).
33.3-2
®ª ¦¨²¥ ²¥®°¥¬³ 33.14
33.3-3
³±²¼ p | ¯°®±²®¥ ·¨±«®, k | ¯®«®¦¨²¥«¼­®¥ ¶¥«®¥ ·¨±«®. ®ª ¦¨²¥, ·²® '(pk ) = pk;1 (p ; 1):
33.3-4
³±²¼ n > 1 ¨ a 2 Zn. ®ª ¦¨²¥, ·²® ´³­ª¶¨¿ fa : Zn ! Zn,
®¯°¥¤¥«¿¥¬ ¿ ° ¢¥­±²¢®¬ fa (x) = ax mod n ¿¢«¿¥²±¿ ¯¥°¥±² ­®¢ª®© ¬­®¦¥±²¢  Zn.
33.3-5
»¯¨¸¨²¥ ¢±¥ ¯®¤£°³¯¯» £°³¯¯ Z9 ¨ Z13.

33.4. ¥¸¥­¨¥ «¨­¥©­»µ ¤¨®´ ­²®¢»µ ³° ¢­¥­¨©
 ± ¡³¤³² ¨­²¥°¥±®¢ ²¼ ¶¥«®·¨±«¥­­»¥ °¥¸¥­¨¿ ³° ¢­¥­¨¿

ax  b (mod n);

(33:22)

(§¤¥±¼ a, b ¨ n | ¶¥«»¥ ·¨±« ; ² ª¨¥ ³° ¢­¥­¨¿ ­ §»¢ ¾² À«¨­¥©­»¬¨ ¤¨®´ ­²®¢»¬¨ ³° ¢­¥­¨¿¬¨Á). ±­®, ·²® §¤¥±¼ ¢ - ¦¥­ «¨¸¼
®±² ²®ª ®² ¤¥«¥­¨¿ x ­  n, ² ª ·²® °¥¸¥­¨¥¬ (33.22) ¥±²¥±²¢¥­­®
­ §»¢ ²¼ ­¥ ¶¥«®¥ ·¨±«®,   ½«¥¬¥­² £°³¯¯» Zn (ª« ±± ·¨±¥«, ¤ ¾¹¨µ ®¤¨­ ¨ ²®² ¦¥ ®±² ²®ª ¯°¨ ¤¥«¥­¨¨ ­  n).  ª¨¬ ®¡° §®¬,
¬®¦­® ±´®°¬³«¨°®¢ ²¼ § ¤ ·³ ² ª: ¥±²¼ ½«¥¬¥­²» a; b 2 Zn, ¬»
¨¹¥¬ ¢±¥ x 2 Zn, ¤«¿ ª®²®°»µ ax = b (mod n).
 ¯®¬­¨¬, ·²® ·¥°¥§ hai ®¡®§­ · ¥²±¿ ¯®°®¦¤¥­­ ¿ ½«¥¬¥­²®¢ a
¯®¤£°³¯¯  (¢ ¤ ­­®¬ ±«³· ¥ ¯®¤£°³¯¯  £°³¯¯» Zn). ® ®¯°¥¤¥«¥­¨¾ hai = fa(x) : x > 0g = fax mod n : x > 0g, ¯®½²®¬³ ³° ¢­¥­¨¥

¥¸¥­¨¥ «¨­¥©­»µ ¤¨®´ ­²®¢»µ ³° ¢­¥­¨©

733

(33.22) ¨¬¥¥² µ®²¿ ¡» ®¤­® °¥¸¥­¨¥ ²®£¤  ¨ ²®«¼ª® ²®£¤ , ª®£¤ 
b 2 hai. ª®«¼ª® ½«¥¬¥­²®¢ ¢ jhaij? ® ²¥®°¥¬¥  £° ­¦  (33.15)
½²® ·¨±«® ¿¢«¿¥²±¿ ¤¥«¨²¥«¥¬ n.
¥®°¥¬  33.20
«¿ «¾¡»µ ¯®«®¦¨²¥«¼­»µ ¶¥«»µ a ¨ n
hai = hdi = f0; d; 2d; : : : ; ((n=d) ; 1)dg;
(33:23)
¨
jhaij = n=d;
£¤¥ d = gcd(a; n).
®ª § ²¥«¼±²¢®
 ±¸¨°¥­­»©  «£®°¨²¬ ¢ª«¨¤  ¢ ¯°¨¬¥­¥­¨¨ ª a ¨ n ¤ ¥²
²°®©ª³ (d; x0; y 0), ¤«¿ ª®²®°®© d = gcd(a; n) ¨ ax0 + ny 0 = d. ®£¤  ax0  d (mod n), ¨ ¯®²®¬³ d 2 hai.  ¤°³£®© ±²®°®­», d
¥±²¼ ¤¥«¨²¥«¼ a, ¨ ¯®²®¬³ a 2 hdi. «¥¤®¢ ²¥«¼­®, hai = hdi =
f0; d; 2d; : : : ; ((n=d) ; 1)dg
«¥¤±²¢¨¥ 33.21
° ¢­¥­¨¥ ax  b (mod n) ° §°¥¸¨¬® ®²­®±¨²¥«¼­® x ²®£¤  ¨
²®«¼ª® ²®£¤ , ª®£¤   (a; n) j b.
«¥¤±²¢¨¥ 33.22
° ¢­¥­¨¥ ax  b (mod n) ¨¬¥¥² d = gcd(a; n) ° §«¨·­»µ °¥¸¥­¨© ¢ Zn ¨«¨ ­¥ ¨¬¥¥² ¨µ ¢®¢±¥.
®ª § ²¥«¼±²¢® ±«¨ ³° ¢­¥­¨¥ ax  b (mod n) ¨¬¥¥² °¥¸¥­¨¥,
²® b 2 hai. ®£« ±­® ±«¥¤±²¢¨¾ 33.18, ¯®±«¥¤®¢ ²¥«¼­®±²¼ ax mod n
(a ¨ n ´¨ª±¨°®¢ ­», x = 0; 1; : : : ) ¯¥°¨®¤¨·­  ± ¯¥°¨®¤®¬ jhaij =
n=d. ±«¨ b 2 hai, ²® b ¢±²°¥· ¥²±¿ °®¢­® ®¤¨­ ° § ±°¥¤¨ ¯¥°¢»µ
n=d ·«¥­®¢ ° ±±¬ ²°¨¢ ¥¬®© ¯®±«¥¤®¢ ²¥«¼­®±²¨. °¨ ¨§¬¥­¥­¨¨ i
®² 0 ¤® n ; 1 ½²®² ­ ¡®° ¨§ n=d ·¨±¥« ¯°®µ®¤¨²±¿ d ° § ¨ ½«¥¬¥­² b
¢±²°¥· ¥²±¿ d ° §; ±®®²¢¥²±²¢³¾¹¨¥ §­ ·¥­¨¿ x ±«³¦ ² °¥¸¥­¨¿¬¨
³° ¢­¥­¨¿ ax  b (mod n).
¥®°¥¬  33.23
³±²¼ d = gcd(a; n) = ax0 + ny 0 , £¤¥ x0 ¨ y 0 | ¶¥«»¥ ·¨±«  (­ ¯°¨¬¥°, ¢»¤ ¢ ¥¬»¥ ¯°®¶¥¤³°®© Extended-Euclid). ±«¨ d j b, ²®
·¨±«® x0 = x0(b=d) (mod n) ¿¢«¿¥²±¿ °¥¸¥­¨¥¬ ³° ¢­¥­¨¿ ax = b
(mod n).
®ª § ²¥«¼±²¢®
® ³±«®¢¨¾ ax0  d (mod n), ¯®½²®¬³ ax0  ax0 (b=d)  d(b=d)  b
(mod n):
¥®°¥¬  33.24
³±²¼ ³° ¢­¥­¨¥ ax  b (mod n) ° §°¥¸¨¬®, ¨ x0 ¿¢«¿¥²±¿ ¥£®
°¥¸¥­¨¥¬. ®£¤  ³° ¢­¥­¨¥ ¨¬¥¥² d = gcd(a; b) °¥¸¥­¨© ¢ Zn, § ¤ ¢ ¥¬»µ ´®°¬³«®© xi = x0 + i(n=d), £¤¥ i = 0; 1; 2; : : : ; n ; 1.
®ª § ²¥«¼±²¢®
 · ¢ ± x0 ¨ ¤¢¨£ ¿±¼ ± ¸ £®¬ n=d, ¬» ±¤¥« ¥¬ d ¸ £®¢, ¯°¥¦¤¥
·¥¬ § ¬ª­¥¬ ª°³£. °¨ ½²®¬ ¢±¥ ½²¨ ·¨±«  ¡³¤³² ®±² ¢ ²¼±¿ °¥¸¥­¨¿¬¨ ³° ¢­¥­¨¿ ax  b (mod n), ² ª ª ª ¯°¨ ³¢¥«¨·¥­¨¨ x ­ 

734

« ¢  33 ¥®p¥²¨ª®-·¨±«®¢»¥  «£®p¨²¬»

n=d ¯°®¨§¢¥¤¥­¨¥ ax ³¢¥«¨·¨¢ ¥²±¿ ­  n(a=d), ²® ¥±²¼ ­  ª° ²­®¥
n.  ª¨¬ ®¡° §®¬, ¬» ¯¥°¥·¨±«¨«¨ ¢±¥ d °¥¸¥­¨©.

 ±®®²¢¥²±²¢¨¨ ±® ±ª § ­­»¬ ­ ¯¨¸¥¬ ¯°®¶¥¤³°³, ª®²®° ¿ ¯®
¶¥«»¬ ·¨±« ¬ a, b ¨ n > 0 ¤ ¥² ¢±¥ °¥¸¥­¨¿ ³° ¢­¥­¨¿ ax  b
(mod n).
Modular-Linear-Equation-Solver(a,b,n)
1 (d,x',y')\gets Extended-Euclid(a,n)
2 if d| b
3
then x_0 \gets x' (b/d) \bmod n
4
for i \gets 0 to d-1
5
do print (x_0+i(n/d)) \bmod n
6
else print "­¥² °¥¸¥­¨©"

 ¯°¨¬¥°, ¤«¿ ³° ¢­¥­¨¿ 14x  30 (mod 100) (a = 14, b = 30
¨ n = 100) ¢»§®¢ ¯°®¶¥¤³°» Extended-Euclid ¢ ±²°®ª¥ 1 ¤ ¥²
(d; x; y ) = (2; ;7; 1). ®±ª®«¼ª³ 2 j 30, ¢ ±²°®ª¥ 3 ¢»·¨±«¿¥²±¿ x0 =
(;7)  (15) mod 100 = 95, ¨ ¢ ±²°®ª µ 4{5 ¯¥· ² ¾²±¿ ·¨±«  95 ¨ 45.
°®¶¥¤³°  Modular-Linear-Equation-Solver(a; n) ¢»¯®«­¿¥² O(lg n +  (a; n))  °¨´¬¥²¨·¥±ª¨µ ®¯¥° ¶¨© (O(lg n) ¢ ±²°®ª¥
1 ¨ O(gcd(a; n)) ¢ ®±² «¼­»µ ±²°®ª µ).
«¥¤±²¢¨¥ 33.25
³±²¼ n > 1. ±«¨ gcd(a; n) = 1, ²® ³° ¢­¥­¨¥ ax  b (mod n)
¨¬¥¥² ¥¤¨­±²¢¥­­®¥ °¥¸¥­¨¥ (¢ Zn).
«³· © b = 1 ®±®¡¥­­® ¢ ¦¥­ | ¯°¨ ½²®¬ ¬» ­ µ®¤¨² ®¡° ²­»©
ª x ½«¥¬¥­² ¯® ¬®¤³«¾ n (multiplicative inverse modulo n), ²® ¥±²¼
®¡° ²­»© ¢ £°³¯¯¥ Zn ½«¥¬¥­².
«¥¤±²¢¨¥ 33.26
³±²¼ n > 1. ±«¨ gcd(a; n) = 1, ²® ³° ¢­¥­¨¥
ax  1 (mod n)
(33:24)
¨¬¥¥² ¥¤¨­±²¢¥­­®¥ °¥¸¥­¨¥ ¢ Zn. °¨ gcd(a; n) > 1 ½²® ³° ¢­¥­¨¥
°¥¸¥­¨© ­¥ ¨¬¥¥².
¥¬ ± ¬»¬ ¬» ­ ³·¨«¨±¼ ¢»·¨±«¿²¼ ®¡° ²­»© ½«¥¬¥­² ¢ £°³¯¯¥
 §  O(lg n)  °¨´¬¥²¨·¥±ª¨µ ®¯¥° ¶¨©.
Z
n
¯° ¦­¥­¨¿
33.4-1
¥¸¨²¥ ³° ¢­¥­¨¥ 35x  10 (mod 50).
33.4-2
®ª ¦¨²¥, ·²® ¥±«¨ gcd(a; n) = 1, ²® ¨§ ax = ay (mod n) ±«¥¤³¥² ³° ¢­¥­¨¥ x = y (mod n). ®ª ¦¨²¥ ­  ¯°¨¬¥°, ·²® ³±«®¢¨¥
gcd(a; n) = 1 ±³¹¥±²¢¥­­®.
33.4-3
³¤¥² «¨ ° ¡®² ²¼ ¯°®¶¥¤³°  Modular-Linear-EquationSolver, ¥±«¨ ±²°®ª³ 3 ¢ ­¥© § ¬¥­¨²¼ ­ 
3

then x_0 \gets x' (b/d) \bmod (n/d)

¨² ©±ª ¿ ²¥®°¥¬  ®¡ ®±² ²ª µ

735

¡º¿±­¨²¥ ±¢®© ®²¢¥².
33.4-4*
³±²¼ f (x)  f0 + f1 x +    + ft xt (mod p) | ¬­®£®·«¥­ ±²¥¯¥­¨ t
± ª®½´´¨¶¨¥­² ¬¨ fi 2 Zp (£¤¥ p | ¯°®±²®¥ ·¨±«®).  §®¢¥¬ a 2 Zp
­³«¥¬ (zero) ¬­®£®·«¥­  f , ¥±«¨ f (a)  0 (mod p). ®ª ¦¨²¥, ·²®
¥±«¨ a | ­³«¼ ¬­®£®·«¥­  f , ²® ­ ©¤¥²±¿ ¬­®£®·«¥­ g (x) ±²¥¯¥­¨
t ; 1, ¤«¿ ª®²®°®£® f (x)  (x ; a)g(x) (mod p). »¢¥¤¨²¥ ®²±¾¤ ,
·²® ¬­®£®·«¥­ ±²¥¯¥­¨ t ¨¬¥¥² ­¥ ¡®«¥¥ t ­³«¥© (¢ Zp).

33.5. ¨² ©±ª ¿ ²¥®°¥¬  ®¡ ®±² ²ª µ
ª®«® 100 £. ¤® .. ª¨² ©±ª¨© ¬ ²¥¬ ²¨ª ³­ ³ (Sun-Tsu)
°¥¸¨« ² ª³¾ § ¤ ·³: ­ ©²¨ ·¨±«®, ¤ ¾¹¥¥ ¯°¨ ¤¥«¥­¨¨ ­  3, 5 ¨ 7
®±² ²ª¨ 2, 3 ¨ 2 ±®®²¢¥²±²¢¥­­® (®¡¹¨© ¢¨¤ °¥¸¥­¨¿ | 23 + 105k
¯°¨ ¶¥«»µ k). ®½²®¬³ ³²¢¥°¦¤¥­¨¥ ®¡ ½ª¢¨¢ «¥­²­®±²¨ ±¨±²¥¬»
±° ¢­¥­¨© ¯® ¢§ ¨¬­® ¯°®±²»¬ ¬®¤³«¿¬ ¨ ±° ¢­¥­¨¿ ¯® ¬®¤³«¾
¯°®¨§¢¥¤¥­¨© ­ §»¢ ¾² Àª¨² ©±ª®© ²¥®°¥¬®© ®¡ ®±² ²ª µÁ.
³±²¼ ­¥ª®²®°®¥ ·¨±«® n ¯°¥¤±² ¢«¥­® ¢ ¢¨¤¥ ¯°®¨§¢¥¤¥­¨¿ ¯®¯ °­® ¢§ ¨¬­® ¯°®±²»µ ·¨±¥« n1 n2  : : :  nk . ¨² ©±ª ¿ ²¥®°¥¬  ®¡
®±² ²ª µ ³²¢¥°¦¤ ¥², ·²® ª®«¼¶® ¢»·¥²®¢ Zn ³±²°®¥­® ª ª ¯°®¨§¢¥¤¥­¨¥ ª®«¥¶ ¢»·¥²®¢ Zn  Zn      Znk (± ¯®ª®¬¯®­¥­²­»¬
±«®¦¥­¨¥¬ ¨ ³¬­®¦¥­¨¥¬). ²® ±®®²¢¥²±²¢¨¥ ¯®«¥§­® ¨ ±  «£®°¨²¬¨·¥±ª®© ²®·ª¨ §°¥­¨¿, ² ª ª ª ¡»¢ ¥² ¯°®¹¥ ¢»¯®«­¨²¼ ®¯¥° ¶¨¨
¢® ¢±¥µ ¬­®¦¥±²¢ µ Zni , ·¥¬ ­¥¯®±°¥¤±²¢¥­­® ¢ Zn.
¥®°¥¬  33.27 (¨² ©±ª ¿ ²¥®°¥¬  ®¡ ®±² ²ª µ)
³±²¼ n = n1 n2    nk , £¤¥ n1 ; n2; : : : ; nk ¯®¯ °­® ¢§ ¨¬­® ¯°®±²».
 ±±¬®²°¨¬ ±®®²¢¥²±²¢¨¥
a $ (a1; a2; : : : ; ak);
(33:25)
£¤¥ a 2 Zn , ai 2 Zni ¨ ai  a mod ni ¯°¨ i = 1; 2; : : : ; k. ®°¬³«  (33.25) ®¯°¥¤¥«¿¥² ¢§ ¨¬­® ®¤­®§­ ·­®¥ ±®®²¢¥²±²¢¨¥ ¬¥¦¤³
Z
n ¨ ¤¥ª °²®¢»¬ ¯°®¨§¢¥¤¥­¨¥¬ Zn  Zn      Znk . °¨ ½²®¬
®¯¥° ¶¨¿¬ ±«®¦¥­¨¿, ¢»·¨² ­¨¿ ¨ ³¬­®¦¥­¨¿ ¢ Zn ±®®²¢¥²±²¢³¾²
¯®ª®¬¯®­¥­²­»¥ ®¯¥° ¶¨¨ ­ ¤ k-½«¥¬¥­²­»¬¨ ª®°²¥¦ ¬¨: ¥±«¨
a $ (a1 ; a2; : : : ; ak )
¨
b $ (b1; b2; : : : ; bk);
²®
(a+b) mod n $ ((a1+b1) mod n1 ; (a2+b2 ) mod n2 ; : : : ; (an+bn ) mod nk );
(33:26)
(a;b) mod n $ ((a1;b1) mod n1 ; (a2;b2 ) mod n2 ; : : : ; (an;bn ) mod nk );
(33:27)
1

2

1

2

736

« ¢  33 ¥®p¥²¨ª®-·¨±«®¢»¥  «£®p¨²¬»

(ab) mod n $ ((a1b1) mod n1 ; (a2b2) mod n2 ; : : : ; (an bn ) mod nk ):
(33:28)
®ª § ²¥«¼±²¢®
 ¬¥²¨¬ ¯°¥¦¤¥ ¢±¥£®, ·²® ´®°¬³«  (33.25) ¤¥©±²¢¨²¥«¼­® § ¤ ¥² ª®°°¥ª²­® ®¯°¥¤¥«¥­­®¥ ®²®¡° ¦¥­¨¥ Zn ¢ ³ª § ­­®¥ ¯°®¨§¢¥¤¥­¨¥: ¥±«¨ ¤¢  ·¨±«  ±° ¢­¨¬» ¯® ¬®¤³«¾ n, ²® ¨µ ° §­®±²¼
ª° ²­  n, ¨ ¯®²®¬³ ½²¨ ·¨±«  ¤ ¾² ®¤¨­ ª®¢»¥ ®±² ²ª¨ ¯°¨ ¤¥«¥­¨¨ ­  «¾¡®¥ ¨§ ni (² ª ª ª ni j n).
¡° ²­®¥ ®²®¡° ¦¥­¨¥ ² ª¦¥ «¥£ª® ®¯¨± ²¼. ®«®¦¨¬ mi =
n=ni , £¤¥ i = 1; 2; : : : ; k, ²® ¥±²¼ mi = n1n2 : : :ni;1 ni+1 : : :nk . ·¥¢¨¤­®, mi  0 (mod nj ) ¯°¨ i 6= j . ®«®¦¨¬

ci = mi (m;i 1 mod ni )
(33:29)
¯°¨ i = 1; 2; : : : ; k. ®£¤  ci  1 (mod n)i ¨ ci  0 (mod n)j ¯°¨
j 6= i, ¨ ·¨±«³ ci ±®®²¢¥²±²¢³¥² ­ ¡®° ± ®¤­®© ¥¤¨­¨¶¥© ­  i-¬
¬¥±²¥:

ci $ (0; 0; : : : ; 0; 1; 0; : : : ; 0):

¥¬ ± ¬»¬. ¯®«®¦¨¢

a  (a1c1 + a2c2 + : : :ak ck ) (mod n):
(33:30)
¬» ¯®«³·¨¬ ·¨±«®, ±®®²¢¥²±²¢³¾¹¥¥ ­ ¡®°³ (a1 ; a2; : : : ; ak ). ¥¬

± ¬»¬ ¤«¿ ª ¦¤®£® ­ ¡®°  ¬®¦­® ­ ©²¨ ±®®²¢¥²±²¢³¾¹¨© ½«¥¬¥­²
Z
n. ±² «®±¼ ³¡¥¤¨²¼±¿, ·²® ² ª®© ½«¥¬¥­² ²®«¼ª® ®¤¨­. ®¦­®
±®±« ²¼±¿ ­  ²®, ·²® ¨ ±«¥¢ , ¨ ±¯° ¢  ³ ­ ± ¨¬¥¾²±¿ ¬­®¦¥±²¢ 
¨§ n = n1 n2 : : :nk ½«¥¬¥­²®¢, ¨ ¯®²®¬³ ¢±¿ª ¿ ±¾°º¥ª¶¨¿ ¿¢«¿¥²±¿
¡¨¥ª¶¨¥©.  ¬®¦­® § ¬¥²¨²¼, ·²® ¥±«¨ a ¨ a0 ¤ ¾² ®¤¨­ ª®¢»¥
®±² ²ª¨ ¯°¨ ¤¥«¥­¨¨ ­  ¢±¥ ni , ²® a ; a0 ¤¥«¨²±¿ ­  ¢±¥ ni ¨ ¢ ±¨«³
¢§ ¨¬­®© ¯°®±²®²» ­  ¨µ ¯°®¨§¢¥¤¥­¨¥, ²® ¥±²¼ ­  n (½²® «¥£ª®
±«¥¤³¥² ¨§ ®¤­®§­ ·­®±²¨ ° §«®¦¥­¨¿ ­  ¬­®¦¨²¥«¨).
«¥¤±²¢¨¥ 33.28
±«¨ n1 ; n2; : : : ; nk ¯®¯ °­® ¢§ ¨¬­® ¯°®±²» ¨ n = n1 n2    nk , ²®
±¨±²¥¬  ±° ¢­¥­¨©
x  ai (mod ni )
®²­®±¨²¥«¼­® x (£¤¥ i = 1; 2; : : : ; k) ¨¬¥¥² ¥¤¨­±²¢¥­­®¥ °¥¸¥­¨¥ ¯®
¬®¤³«¾ n.
«¥¤±²¢¨¥ 33.29
±«¨ n1 ; n2 ; : : : ; nk ¯®¯ °­® ¢§ ¨¬­® ¯°®±²», n = n1 n2    nk ,   x
¨ a | ¶¥«»¥ ·¨±« , ²® ±¢®©±²¢®

x  a (mod n)
° ¢­®±¨«¼­® ¢»¯®«­¥­¨¾ ±° ¢­¥­¨©

x  a (mod ni)

¨² ©±ª ¿ ²¥®°¥¬  ®¡ ®±² ²ª µ

737

¨±. 33.3 33.3 ¨² ©±ª ¿ ²¥®°¥¬  ®¡ ®±² ²ª : n1 = 5, n2 = 13.  ±²®«¡¶ µ
¯¥°¥·¨±«¥­» ° §«¨·­»¥ ®±² ²ª¨ ¯°¨ ¤¥«¥­¨¨ ­  13, ¢ ±²°®ª µ - ¯°¨ ¤¥«¥­¨¨ ­ 
5.  ¦¤®¥ ·¨±«® ®² 0 ¤® 65 ; 1 ¯®¬¥¹¥­® ¢ ±®®²¢¥²±²¢³¾¹³¾ ±²°®ª³ ¨ ±²®«¡¥¶,
¨ ²¥®°¥¬  £ ° ­²¨°³¥², ·²® ¢ ª ¦¤®© ª«¥²ª¥ ² ¡«¨¶» ¡³¤¥² ¯® ®¤­®¬³ ·¨±«³.

¯°¨ ¢±¥µ i = 1; 2; : : : ; k.
 ª ·¥±²¢¥ ¯°¨¬¥°  ° ±±¬®²°¨¬ ±¨±²¥¬³ ±° ¢­¥­¨©

a  2 (mod 5);
a  3 (mod 13):
¤¥±¼ a1 = 2, a3 = 3, n1 = m2 = 5, n2 = m1 = 13, ¨ ±«¥¤®¢ ²¥«¼­®, n = 65. ®±ª®«¼ª³ 13;1  2 (mod 5) ¨ 5;1 = 8 (mod 13), ¬»

­ µ®¤¨¬
¨

c1  13(2 mod 5) 26;
c2  5(8 mod 13) 40;
a  2  26 + 3  40

52 + 120

42

(mod 65)
(mod 65)
(mod 65):

¬. ² ª¦¥ °¨±. 33.3.
 ª¨¬ ®¡° §®¬, ¢»·¨±«¥­¨¿ ¯® ¬®¤³«¾ ¯°®¨§¢¥¤¥­¨¿ ¢§ ¨¬­®
¯°®±²»µ ·¨±¥« ¬®¦­® ¢»¯®«­¿²¼ ®²¤¥«¼­® ¯® ¬®¤³«¾ ª ¦¤®£® ¨§
½²¨µ ·¨±¥«.
¯° ¦­¥­¨¿
33.5-1
 ©¤¨²¥ ¢±¥ x, ¯°¨ ª®²®°»µ x  4 (mod 5) ¨ x  5 (mod 11).
33.5-2
 ©¤¨²¥ ¢±¥ ¶¥«»¥ ·¨±«  x, ¤ ¾¹¨¥ ¯°¨ ¤¥«¥­¨¨ ­  2, 3, 4, 5, 6
®±² ²ª¨ 1, 2, 3, 4, 5 (±®®²¢¥²±²¢¥­­®).
33.5-3
®ª ¦¨²¥, ·²® (¢ ª®­²¥ª±²¥ ²¥®°¥¬» 33.27) ¯°¨ gcd(a; n) = 1
¨¬¥¥² ¬¥±²® ±®®²¢¥²±²¢¨¥
(a;1 mod n) $ ((a;1 1 mod n1 ); (a;2 1 mod n2 ); : : : ; (a;k 1 mod nk )):
33.5-4
³±²¼ f (x) | ¬­®£®·«¥­ ± ¶¥«»¬¨ ª®½´´¨¶¨¥­² ¬¨. ®ª ¦¨²¥,
·²® (¢ ³±«®¢¨¿µ ²¥®°¥¬» 33.27) ·¨±«® ¥£® ª®°­¥© ¯® ¬®¤³«¾ n (¢»·¥²®¢, ¤«¿ ª®²®°»µ f (x)  0 (mod n)) ° ¢­® ¯°®¨§¢¥¤¥­¨¾ ·¨±¥«
¥£® ª®°­¥© ¯® ¬®¤³«¿¬ n1 ; n2; : : : ; nk .

738

« ¢  33 ¥®p¥²¨ª®-·¨±«®¢»¥  «£®p¨²¬»

33.6. ²¥¯¥­¼ ½«¥¬¥­² 
 ±±¬®²°¨¬ ¢ ¬³«¼²¨¯«¨ª ²¨¢­®© £°³¯¯¥ ¢»·¥²®¢ Zn ¯®±«¥¤®¢ ²¥«¼­®±²¼ ±²¥¯¥­¥© ­¥ª®²®°®£® ½«¥¬¥­²  a:
a0; a1; a2; a3; : : : :
(33:31)
» ­ ·¨­ ¥¬ ±·¥² ± ­³«¿, ¯®« £ ¿ a0 mod n = 1; i-© ·«¥­ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ° ¢¥­ ai mod n.  ¯°¨¬¥°, ¯®±«¥¤®¢ ²¥«¼­®±²¼ ±²¥¯¥­¥©
·¨±«  3 ¯® ¬®¤³«¾ 7 ¨¬¥¥² ¢¨¤
i
0 1 2 3 4 5 6 7 8 9 10 11 : : :
3i mod 7 1 3 2 6 4 5 1 3 2 6 4 5 : : :
  ¤«¿ ±²¥¯¥­¥© ·¨±«  2 ¯® ¬®¤³«¾ 7 ¨¬¥¥¬
i
0 1 2 3 4 5 6 7 8 9 10 11 : : :
2i mod 7 1 2 4 1 2 4 1 2 4 1 2 4 : : :
 ½²®¬ ° §¤¥«¥ ¯®¤ hai ¬» ¡³¤¥¬ ¯®­¨¬ ²¼ ¯®¤£°³¯¯³ £°³¯¯»
 , ¯®°®¦¤¥­­³¾ ½«¥¬¥­²®¬ a,   ¯®¤ ordn (a) | ¯®°¿¤®ª ½«¥¬¥­² 
Z
n
a £°³¯¯» Zn.  ¯°¨¬¥°³, h2i = f1; 2; 4g ¢ £°³¯¯¥ Z7 ¨ ord7(2) =
3. °¨¬¥­¨¢ ª £°³¯¯¥ Zn ±«¥¤±²¢¨¥ 33.19 ¨ ¢±¯®¬­¨¢ ®¯°¥¤¥«¥­¨¥
';´³­ª¶¨¨ ©«¥° , ¯®«³·¨¬ ² ª®¥ ³²¢¥°¦¤¥­¨¥:
¥®°¥¬  33.30 (²¥®°¥¬  ©«¥° )
±«¨ n > 1 | ¶¥«®¥ ·¨±«®, ²®
a'(n)  1 (mod n):
(33:22)
¤«¿ ¢±¿ª®£® a 2 Zn
°¨ ¯°®±²®¬ n ½²  ²¥®°¥¬  ¯°¥¢° ¹ ¥²±¿ ¢ À¬ «³¾ ²¥®°¥¬³
¥°¬ Á:
¥®°¥¬  33.31 (¬ « ¿ ²¥®°¥¬  ¥°¬ )
±«¨ p > 1 | ¯°®±²®¥ ·¨±«®, ²®
ap;1  1 (mod p)
(33:23)
¤«¿ ¢±¿ª®£® a 2 Zp
®ª § ²¥«¼±²¢®
®±ª®«¼ª³ ·¨±«® p | ¯°®±²®¥, '(p) = p ; 1 (33.21).
 « ¿ ²¥®°¥¬  ¥°¬  ¯°¨¬¥­¨¬  ª® ¢±¥¬ ½«¥¬¥­² ¬ Zp, ª°®¬¥
­³«¿. ±«¨ ³¬­®¦¨²¼ ½²® ±° ¢­¥­¨¥ ­  a. ²® ¯®«³·¨²±¿ ±° ¢­¥­¨¥
ap  a (mod p), ª®²®°®¥ ¢¥°­® ¨ ¤«¿ a = 0 (p | «¾¡®¥ ¯°®±²®¥
·¨±«®).
±«¨ ordn (g ) = jZnj, ²® ¢±¥ ½«¥¬¥­²» Zn ¿¢«¿¾²±¿ ±²¥¯¥­¿¬¨ ½«¥¬¥­²  g .  ½²®¬ ±«³· ¥ g ­ §»¢ ¥²±¿ ¯°¨¬¨²¨¢­»¬ ª®°­¥¬ (primitive root) ¨«¨ ®¡° §³¾¹¥© (generator) £°³¯¯» Zn.  ¯°¨¬¥°, 3 ¿¢«¿¥²±¿ ¯°¨¬¨²¨¢­»¬ ª®°­¥¬ ¢ Z7. ±«¨ £°³¯¯  Zn ¨¬¥¥² ®¡° §³¾¹¥©,

²¥¯¥­¼ ½«¥¬¥­² 

739

¥¥ ­ §»¢ ¾² ¶¨ª«¨·¥±ª®© (cyclic). ¬¥¥² ¬¥±²® ±«¥¤³¾¹ ¿ ²¥®°¥¬ 
(¤®ª § ²¥«¼±²¢® ¬®¦­® ­ ©²¨, ­ ¯°¨¬¥°, ¢ ª­¨£¥ ¨¢¥­  ¨ ³ª¥°¬ ­  [151]).
¥®°¥¬  33.32
³±²¼ n > 1. °³¯¯  Zn ¶¨ª«¨·­  ²®£¤  ¨ ²®«¼ª® ²®£¤ , ª®£¤  n
° ¢­® 2, 4, ¨¬¥¥² ¢¨¤ pk ¨«¨ 2pk (£¤¥ p > 2 | ¯°®±²®¥ ·¨±«®,   k
| ¶¥«®¥ ¯®«®¦¨²¥«¼­®¥ ·¨±«®).
³±²¼ g ¿¢«¿¥²±¿ ®¡° §³¾¹¥© £°³¯¯» Zn . ®£¤  ¤«¿ ¢±¿ª®£® a 2
 ­ ©¤¥²±¿ z , ¤«¿ ª®²®°®£® g z = a (mod n).  ª®¥ z ­ §»¢ ¾²
Z
n
¤¨±ª°¥²­»¬ «®£ °¨´¬®¬ (discrete logarithm) ¨«¨ ¨­¤¥ª±®¬ (index)
½«¥¬¥­²  a 2 Zn ¯® ®±­®¢ ­¨¾ g ¨ ®¡®§­ · ¾² ind n;g (a).
¥®°¥¬  33.33 (® ¤¨±ª°¥²­®¬ «®£ °¨´¬¥)
³±²¼ g ¿¢«¿¥²±¿ ®¡° §³¾¹¥© £°³¯¯» Zn. ®£¤  ±° ¢­¥­¨¥ g x 
gy (mod n) ° ¢­®±¨«¼­® ±° ¢­¥­¨¾ x  y (mod '(n)).
®ª § ²¥«¼±²¢®
±«¨ x  y (mod '(n)), ²® ¥±²¼ x = y + k'(n) ¯°¨ ­¥ª®²®°®¬
¶¥«®¬ k, ²® g x  g y+k'(n)  g y  (g '(n))k  g y  1k  g y (¢±¥ ° ¢¥­±²¢ 
¯® ¬®¤³«¾ n).
 ¯°®²¨¢, ¯³±²¼ g x  g y (mod n). ®£« ±­® ±«¥¤±²¢¨¾ 33.18, ¯®±«¥¤®¢ ²¥«¼­®±²¼ ±²¥¯¥­¥© g ¯¥°¨®¤¨·­  ± ¯¥°¨®¤®¬ jhg ij = '(n),
¯®½²®¬³ ·²® x  y (mod '(n)).
» ¢¨¤¨¬, ·²® ¢¥«¨·¨­  indn;g (a) ®¯°¥¤¥«¥­  ± ²®·­®±²¼¾ ¤®
±« £ ¥¬®£®, ª° ²­®£® '(n), ²® ¥±²¼ ¬®¦¥² ° ±±¬ ²°¨¢ ²¼±¿ ª ª
½«¥¬¥­²  ¤¤¨²¨¢­®© £°³¯¯» Z'(n).
®² ¯°¨¬¥° ¨±¯®«¼§®¢ ­¨¿ ¯®­¿²¨¿ ¨­¤¥ª± :
¥®°¥¬  °¨ ¯°®±²®¬ p > 2 ¨ ¯®«®¦¨²¥«¼­®¬ ¶¥«®¬ k ³° ¢­¥­¨¥
x2  1 (mod pk )
(33:34)
¨¬¥¥² °®¢­® ¤¢  °¥¸¥­¨¿ (x = 1).
®ª § ²¥«¼±²¢®
±«¨ x2  1 (mod pk ), ²® x ¢§ ¨¬­® ¯°®±²® ± p, ¯®½²®¬³ °¥¸¥­¨¿
­ ¤® ¨±ª ²¼ ¢ £°³¯¯¥ Zn (£¤¥ n = pk ); ¯³±²¼ g | ®¡° §³¾¹ ¿ ½²®©
£°³¯¯». ®£¤  ³° ¢­¥­¨¥ (33.34) § ¯¨±»¢ ¥²±¿ ¢ ¢¨¤¥
(g indn;g (x) )2  g indn;g (1) (mod n):
(33:35)
® ²¥®°¥¬¥ 33.33 ½²® ¬®¦­® ¯¥°¥¯¨± ²¼ ª ª
2  indn;g (x)  0 (mod '(n)):
(33:36)
(§ ¬¥²¨¬, ·²® ¨­¤¥ª± 1 ° ¢¥­ 0).  ª¨¥ ³° ¢­¥­¨¿ ¬» ³¦¥ °¥¸ «¨
¢ ° §¤¥«¥ 33.4; ²¥®°¥¬  33.24 £®¢®°¨², ·²® (33.36) ¨¬¥¥² °®¢­® ¤¢ 
°¥¸¥­¨¿ (  ¬» §­ ¥¬, ·²® x = 1 ¯®¤µ®¤¨²).
[¯°®·¥¬, ¬®¦­® ¡»«® ¡» ®¡®©²¨±¼ ¨ ¡¥§ ±±»«ª¨ ­  ²¥®°¥¬³
33.32: ¥±«¨ x2 ; 1 = (x ; 1)(x + 1) ¤¥«¨²±¿ ­  pk , ²® ®¤­  ¨§ ±ª®¡®ª
¤¥«¨²±¿ ­  p, ²®£¤  ¤°³£ ¿ ­¥ ¤¥«¨²±¿,   §­ ·¨², ¯¥°¢ ¿ ¤¥«¨²±¿ ¨
­  pk .]

740

« ¢  33 ¥®p¥²¨ª®-·¨±«®¢»¥  «£®p¨²¬»

¥¸¥­¨¥ ³° ¢­¥­¨¿ x2  1 (mod n), ­¥ ±° ¢­¨¬®¥ ¯® ¬®¤³«¾ n
± 1, ­ §»¢ ¥²±¿ ­¥²°¨¢¨ «¼­»¬ ª¢ ¤° ²­»¬ ª®°­¥¬ ¨§ 1 ¢ Zn
(nontrivial square root of 1 modulo n).  ¯°¨¬¥°, 6 ¿¢«¿¥²±¿ ­¥²°¨¢¨ «¼­»¬ ª®°­¥¬ ¨§ 1 ¯® ¬®¤³«¾ 35. «¥¤³¾¹¥¥ ³²¢¥°¦¤¥­¨¥
¯®­ ¤®¡¨²±¿ ­ ¬ ¢ ° §¤¥«¥ 33.8 ¯°¨ ®¡±³¦¤¥­¨¨ ²¥±²  ¨««¥°  |
 ¡¨­ .
«¥¤±²¢¨¥ 33.35
±«¨ Zn ±®¤¥°¦¨² ­¥²°¨¢¨ «¼­»© ª®°¥­¼ ¨§ 1, ²® ·¨±«® n ±®±² ¢­®¥.
®ª § ²¥«¼±²¢®
·¥¢¨¤­® ¢»²¥ª ¥² ¨§ ²¥®°¥¬» 33.8.
»·¨±«¥­¨¥ ±²¥¯¥­¥© ¯®¢²®°­»¬ ¢®§¢¥¤¥­¨¥¬ ¢ ª¢ ¤° ².
®§¢¥¤¥­¨¥ ¢ ±²¥¯¥­¼ ¯® ¬®¤³«¾ ¨£° ¥² ¢ ¦­³¾ °®«¼ ¯°¨ ¯°®¢¥°ª¥ ·¨±¥« ­  ¯°®±²®²³,   ² ª¦¥ ¢ ª°¨¯²®±¨±²¥¬¥ RSA.  ª ¨ ¤«¿
®¡»·­»µ ·¨±¥«, ¯®¢²®°­®¥ ³¬­®¦¥­¨¥ | ­¥ ± ¬»© ¡»±²°»© ±¯®±®¡; «³·¸¥ ¢®±¯®«¼§®¢ ²¼±¿  «£®°¨²¬®¬ ¯®¢²®°­®£® ¢®§¢¥¤¥­¨¿ ¢
ª¢ ¤° ² (repeated squaring).
³±²¼ ¬» µ®²¨¬ ¢»·¨±«¨²¼ ab mod n, £¤¥ a | ¢»·¥² ¯® ¬®¤³«¾
n,   b | ¶¥«®¥ ­¥®²°¨¶ ²¥«¼­®¥ ·¨±«®, ¨¬¥¾¹¥¥ ¢ ¤¢®¨·­®© § ¯¨±¨ ¢¨¤ hbk ; bk;1; : : : ; b1; b0i (·¨±«® §­ ª®¢ ±·¨² ¥¬ ° ¢­»¬ k + 1;
±² °¸¨¥ ° §°¿¤», ª ª ®¡»·­®, ±«¥¢ ). » ¢»·¨±«¿¥¬ ac mod n
¤«¿ ­¥ª®²®°®£® c, ª®²®°®¥ ¢®§° ±² ¥² ¨ ¢ ª®­¶¥ ª®­¶®¢ ±² ­®¢¨²±¿
° ¢­»¬ b.
Modular-Exponentiation (a,b,n)
1 c \gets 0
2 d \gets 2
3 ¯³±²¼ \langle b_k,b_{k-1},\ldots,b_0\rangle --¤¢®¨·­ ¿ § ¯¨±¼ $b$
4 for i \gets k downto 0
5
do c \gets 2±
6
d \gets (d \cdot d) \bmod n
7
if b_i=1
8
then c \gets c+1
9
d \gets (d\cdot a) \bmod n
10 return d

°¨ ³¬­®¦¥­¨¨ c ­  2 ·¨±«® ac ¢®§¢®¤¨²±¿ ¢ ª¢ ¤° ², ¯°¨ ³¢¥«¨·¥­¨¨ c ­  1 ·¨±«® ac ³¬­®¦ ¥²±¿ ­  a.   ª ¦¤®¬ ¸ £¥ ¤¢®¨·­ ¿
§ ¯¨±¼ c ±¤¢¨£ ¥²±¿ ­  1 ¢«¥¢®, ¯®±«¥ ·¥£®, ¥±«¨ ­ ¤® (bi = 1), ¯®±«¥¤­¿¿ ¶¨´°  ¤¢®¨·­®© § ¯¨±¨ ¬¥­¿¥²±¿ ± 0 ­  1. ( ¬¥²¨¬, ·²®
¯¥°¥¬¥­­ ¿ c ´ ª²¨·¥±ª¨ ­¥ ¨±¯®«¼§³¥²±¿ ¨ ¬®¦¥² ¡»²¼ ®¯³¹¥­ .)
¶¥­¨¬ ¢°¥¬¿ ° ¡®²» ¯°®¶¥¤³°». ±«¨ ²°¨ ·¨±« , ¿¢«¿¾¹¨¥±¿
¥¥ ¨±µ®¤­»¬¨ ¤ ­­»¬¨, ¨¬¥¾² ­¥ ¡®«¥¥  ¡¨²®¢, ²® ·¨±«®  °¨´¬¥²¨·¥±ª¨µ ®¯¥° ¶¨© ¥±²¼ O( ),   ·¨±«® ¡¨²®¢»µ | O( 3).
°¨¬¥° (a = 7; b = 560; n = 561) ¯®ª § ­ ­  °¨±. 33.4.
¯° ¦­¥­¨¿

°¨¯²®±¨±²¥¬  RSA ± ®²ª°»²»¬ ª«¾·®¬

i
bi
c
d
¨±. 33.4

741

9 8 7 6 5 4 3 2 1 0
1 0 0 0 1 1 0 0 0 0
1 2 4 8 17 35 70 140 280 560
7 49 157 526 160 241 298 166 67 1

 ¡®²  ¯°®¶¥¤³°» Modular-Exponentation ¯°¨ a = 7, b = 560 =

h1000110000i ¨ n = 561. ®ª § ­» §­ ·¥­¨¿ ¯¥°¥¬¥­­»µ ¯®±«¥ ®·¥°¥¤­®£® ¨±-

¯®«­¥­¨¿ ²¥«  ¶¨ª«  for. °®¶¥¤³°  ¢®§¢° ¹ ¥² ®²¢¥² 1.

33.6-1
 ©¤¨²¥ ¯®°¿¤ª¨ ¢±¥µ ½«¥¬¥­²®¢ ¢ Z11.  ©¤¨²¥ ­ ¨¬¥­¼¸³¾
®¡° §³¾¹³¾ ½²®© £°³¯¯» ¨ ³ª ¦¨²¥ ¨­¤¥ª±» ¢±¥µ ½«¥¬¥­²®¢ ½²®©
£°³¯¯».
33.7-2
°¥¤«®¦¨²¥  «£®°¨²¬ ¢»·¨±«¥­¨¿ ab mod n, ª®²®°»© ®¡° ¡ ²»¢ ¥² ¡¨²» ¤¢®¨·­®© § ¯¨±¨ b ±¯° ¢  ­ «¥¢® (®² ±² °¸¨µ ª ¬« ¤¸¨¬).
33.7-3
¡º¿±­¨²¥, ª ª ¢»·¨±«¨²¼ a;1 mod n ¤«¿ a 2 Zn ¯°¨ ¯®¬®¹¨ ¯°®¶¥¤³°» Modular-Exponentation, ¥±«¨ ¨§¢¥±²­® §­ ·¥­¨¥
'(n).

33.7. °¨¯²®±¨±²¥¬  RSA ± ®²ª°»²»¬ ª«¾·®¬
°¨¯²®±¨±²¥¬» ± ®²ª°»²»¬ ª«¾·®¬ ¯®§¢®«¿¾² ®¡¬¥­¨¢ ²¼±¿
±¥ª°¥²­»¬¨ ±®®¡¹¥­¨¿¬¨ ¯® ®²ª°»²®¬³ ª ­ «³, ­¥ ¤®£®¢ °¨¢ ¿±¼
§ ° ­¥¥ ® ª«¾·¥ ¸¨´°¥; ¤ ¦¥ ¯¥°¥µ¢ ²¨¢ ¢¥±¼ ° §£®¢®° ®² ­ · « 
¤® ª®­¶ , ¢° £ ­¥ ³§­ ¥² ±¥ª°¥²­®£® ±®®¡¹¥­¨¿. °®¬¥ ²®£®, ½²¨ ¦¥
¬¥²®¤» ¯®§¢®«¿¾² ¤®¡ ¢«¿²¼ ª ±®®¡¹¥­¨¾ À¶¨´°®¢³¾ ¯®¤¯¨±¼Á,
³¤®±²®¢¥°¿¾¹³¾, ·²® ±®®¡¹¥­¨¥ ­¥ ´ «¼±¨´¨¶¨°®¢ ­® ¢° £ ¬¨.
°®¢¥°¨²¼  ³²¥­²¨·­®±²¼ ¯®¤¯¨±¨ «¥£ª®,     ¯®¤¤¥« ²¼ ¥¥ ª° ©­¥
²°³¤­®. ®­¿²­®, ·²® ² ª¨¥ ¬¥²®¤» ­ µ®¤¿² ¸¨°®ª®¥ ¯°¨¬¥­¥­¨¥
¢ ¡ ­ª µ, ¯°¨ ¯®¤¯¨±»¢ ­¨¨ ª®­²° ª²®¢, ¤¥­¥¦­»µ ¯¥°¥¢®¤ µ ¨
².¯.
°¨¯²®±¨±²¥¬  RSA ®±­®¢ ­  ­  ² ª®¬ ®¡±²®¿²¥«¼±²¢¥: ¢ ­ ±²®¿¹¥¥ ¢°¥¬¿ ¨§¢¥±²­» ½´´¥ª²¨¢­»¥  «£®°¨²¬» ¯®¨±ª  ¡®«¼¸¨µ
¯°®±²»µ ·¨±¥«, ­® ­¥ ¨§¢¥±²­® ±ª®«¼ª®-­¨¡³¤¼ ¯°¨¥¬«¥¬®£® ¯® ¢°¥¬¥­¨ ° ¡®²»  «£®°¨²¬  ° §«®¦¥­¨¿ ¯°®¨§¢¥¤¥­¨¿ ¤¢³µ ¡®«¼¸¨µ
¯°®±²»µ ·¨±¥« ­  ¬­®¦¨²¥«¨. » ° ±±¬®²°¨¬ ½²¨ § ¤ ·¨ (¯°®¢¥°ª  ¯°®±²®²» ¨ ° §«®¦¥­¨¥ ­  ¬­®¦¨²¥«¨) ¢ ° §¤¥« µ 33.8 ¨
33.9.
°¨¯²®±¨±²¥¬» ± ®²ª°»²»¬ ª«¾·®¬.
°¨ ¨±¯®«¼§®¢ ­¨¨ ² ª¨µ ±¨±²¥¬ ª ¦¤»© ³· ±²­¨ª ¯¥°¥£®¢®°®¢
¨¬¥¥² ®²ª°»²»© ª«¾· (public key) ¨ ±¥ª°¥²­»© ª«¾· (secret key).

742

« ¢  33 ¥®p¥²¨ª®-·¨±«®¢»¥  «£®p¨²¬»

 ±¨±²¥¬¥ RSA ª«¾· ±®±²®¨² ¨§ ¯ °» ¶¥«»µ ·¨±¥«. · ±²­¨ª®¢
¯¥°¥£®¢®°®¢ ¬®¦¥² ¡»²¼ ­¥±ª®«¼ª®. ­® ¤«¿ ¯°¨¬¥°  ¬» ¡³¤¥¬ £®¢®°¨²¼ ® ¯¥°¥£®¢®° µ «¨±» (A) ¨ ®¡  (B ). µ ®²ª°»²»¥ ª«¾·¨
¬» ¡³¤¥¬ ®¡®§­ · ²¼ PA ¨ PB ,   ±¥ª°¥²­»¥ | SB ¨ SB .
 ¦¤»© ³· ±²­¨ª ± ¬ ±®§¤ ¥² ¤¢  ±¢®¨µ ª«¾· . ¥ª°¥²­»©
ª«¾· ®­ µ° ­¨² ¢ ² ©­¥,   ®²ª°»²»© ±®®¡¹ ¥² ®±² «¼­»¬ ³· ±²­¨ª ¬ (¨ ¢®®¡¹¥ ¢±¥¬ ¦¥« ¾¹¨¬, ­ ¯°¨¬¥°, ·¥°¥§ £ §¥²» ¨«¨ Internet; ®²ª°»²»¥ ª«¾·¨ ¢±¥µ § ¨­²¥°¥±®¢ ­­»µ «¨¶ ¬®¦­® ¯³¡«¨ª®¢ ²¼ ¢ ±¯¥¶¨ «¼­»µ ±¯° ¢®·­¨ª µ ¨ ².¯.).
¡®§­ ·¨¬ ·¥°¥§ D ¬­®¦¥±²¢® ¢±¥µ ¢®§¬®¦­»µ ±®®¡¹¥­¨© (­ ¯°¨¬¥°, ½²® ¬®¦¥² ¡»²¼ ¬­®¦¥±²¢® ¢±¥µ ¡¨²®¢»µ ±²°®ª). ®²°¥¡³¥¬, ·²®¡» ª ¦¤»© ª«¾· § ¤ ¢ « ¯¥°¥±² ­®¢ª³ ¬­®¦¥±²¢  D, ¨
·¥°¥§ PA () ¨ SA () ¡³¤¥¬ ®¡®§­ · ²¼ ¯¥°¥±² ­®¢ª¨, ±®®²¢¥²±²¢³¾¹¨¥ ª«¾· ¬ «¨±». » ±·¨² ¥¬, ·²® ª ¦¤ ¿ ¨§ ¯¥°¥±² ­®¢®ª
PA () ¨ SA () ¬®¦¥² ¡»²¼ ¡»±²°® ¢»·¨±«¥­ , ¥±«¨ ²®«¼ª® ¨§¢¥±²¥­
±®®²¢¥²±²¢³¾¹¨© ª«¾·.
» µ®²¨¬, ·²®¡» ª«¾·¨ ®¤­®£® ³· ±²­¨ª  § ¤ ¢ «¨ ¢§ ¨¬­®
®¡° ²­»¥ ¯¥°¥±² ­®¢ª¨, ²® ¥±²¼ ·²®¡»

M = SA(PA (M ));
¨

M = PA (SA (M )):
¡»«® ¢»¯®«­¥­® ¤«¿ «¾¡®£® ±®®¡¹¥­¨¿ M 2 D.

(33:37)
(33:38)

 ¬®¥ £« ¢­®¥ | ·²®¡» ­¨ª²®, ª°®¬¥ «¨±», ­¥ ¬®£ ¢»·¨±«¿²¼
´³­ª¶¨¾ SA () §  ° §³¬­®¥ ¢°¥¬¿; ¨¬¥­­® ­  ½²®¬ ®±­®¢ ­» ¢±¥
¯®«¥§­»¥ ±¢®©±²¢  ª°¨¯²®±¨±²¥¬», ¯¥°¥·¨±«¥­­»¥ ¢»¸¥. ®²®¬³²® «¨±  ¨ ¤¥°¦¨² §­ ·¥­¨¥ SA ¢ ±¥ª°¥²¥: ¥±«¨ ª²®-«¨¡® ³§­ ¥²
¥¥ ±¥ª°¥²­»© ª«¾·, ®­ ±¬®¦¥² ° ±¸¨´°®¢»¢ ²¼  ¤°¥±®¢ ­­»¥ ¥©
±®®¡¹¥­¨¿, ¯®¤¤¥«»¢ ²¼ ¥¥ ¯®¤¯¨±¼ ¨«¨ ¯¥°¥¢¨° ²¼ ±®®¡¹¥­¨¿, ª®²®°»¥ ®­  ®²¯° ¢«¿¥² ®² ±¢®¥£® ¨¬¥­¨. « ¢­ ¿ ²°³¤­®±²¼ ¯°¨ ° §° ¡®²ª¥ ª°¨¯²®±¨±²¥¬ ±®±²®¨² ¢ ²®¬, ·²®¡» ¯°¨¤³¬ ²¼ ´³­ª¶¨¾
SA(), ¤«¿ ª®²®°®© ²°³¤­® ¡»«® ¡» ­ ©²¨ ¡»±²°»© ±¯®±®¡ ¢»·¨±«¥­¨¿, ¤ ¦¥ §­ ¿ ² ª®© ±¯®±®¡ ¤«¿ ®¡° ²­®© ´³­ª¶¨¨ PA ().
¯¨¸¥¬ ¯°®¶¥±± ¯¥°¥±»«ª¨ ¸¨´°®¢ ­­®£® ±®®¡¹¥­¨¿. ®¯³±²¨¬, ®¡ ¦¥« ¥² ¯®±« ²¼ «¨±¥ ±¥ª°¥²­®¥ ±®®¡¹¥­¨¥. ²® ¯°®¨±µ®¤¨² ² ª:
 ®¡ ­ µ®¤¨² PA | ®²ª°»²»© ª®¤ «¨±» (¯® ±¯° ¢®·­¨ª³ ¨«¨
¯°¿¬® ®² «¨±»)
 ®¡ § ¸¨´°®¢»¢ ¥² ±¢®¥ ±®®¡¹¥­¨¥ M ¨ ¯®±»« ¥² «¨±¥ ¸¨´°®¢ª³ (ciphertext) C = PA (M ).
 «¨±  ¯®«³· ¥² C ¨ ¢®±±² ­ ¢«¨¢ ¥² ¨§­ · «¼­®¥ ±®®¡¹¥­¨¥
M = SA(C ).
²®² ¯°®¶¥±± ¯®ª § ­ ­  °¨±. 33.5.

°¨¯²®±¨±²¥¬  RSA ± ®²ª°»²»¬ ª«¾·®¬

743

­ ¤¯¨±¨:
encrypt - ¸¨´°®¢ ­¨¥
communication channel - «¨­¨¿ ±¢¿§¨
eavesdropper - §«®³¬»¸«¥­­¨ª
decrypt - ° ±¸¨´°®¢ª 
®¡, «¨± 
¨±. 33.5 33.5 ¨´°®¢ ­¨¥ ± ®²ª°»²»¬ ª«¾·®¬. ®¡ ¸¨´°³¥² ±®®¡¹¥­¨¥ M ±
¯®¬®¹¼¾ ´³­ª¶¨¨ PA ¨ ¯®«³· ¥² ¸¨´°®¢ª³ C = PA(M ). ³­ª¶¨¨ SA () ¨ PA ()
¢§ ¨¬­® ®¡° ²­», ¯®½²®¬³ «¨±  ¬®¦¥² ¢®±±² ­®¢¨²¼ ¨±µ®¤­®¥ ±®®¡¹¥­¨¥ M
¯® ¸¨´°®¢ª¥: M = SA (C ). ¨ª²®, ª°®¬¥ «¨±», ­¥ §­ ¥² ±¯®±®¡  ¢»·¨±«¥­¨¿
SA (), ¯®½²®¬³ ±®®¡¹¥­¨¥ M ®±² ­¥²±¿ ±¥ª°¥²­»¬, ¤ ¦¥ ¥±«¨ §«®³¬»¸«¥­­¨ª
¯®¤±«³¸ ¥² C ¨ §­ ¥² PA.

sign - ¢»·¨±«¥­¨¥ ¯®¤¯¨±¨
verify - ¯°®¢¥°ª  ¯®¤¯¨±¨
accept - ±®®¡¹¥­¨¥ ¯®¤«¨­­®¥
¨±. 33.6 33.6 ¨´°®¢ ¿ ¯®¤¯¨±¼ ¢ ±¨±²¥¬¥ ± ®²ª°»²»¬ ª«¾·®¬. «¨±  ¯®¤¯¨±»¢ ¥² ±¢®¥ ±®®¡¹¥­¨¥ M 0 , ¯°¨ª« ¤»¢ ¿ ª ­¥¬³ ¶¨´°®¢³¾ ¯®¤¯¨±¼  = SA (M 0 ).
®¡, ¯®«³· ¿ ®² «¨±» ¯ °³ (M 0 ; ), ¯°®¢¥°¿¥² ±®®²­®¸¥­¨¥ M 0 = PA (). ±«¨
®­® ¢»¯®«­¿¥²±¿, ¯®¤¯¨±¼ ¨ ± ¬® ±®®¡¹¥­¨¥ ¯®¤«¨­­».

¥¯¥°¼ ®¡º¿±­¨¬, ª ª ±­ ¡¤¨²¼ ±®®¡¹¥­¨¥ ½«¥ª²°®­­®© ¯®¤¯¨±¼¾. ³±²¼ «¨±  µ®·¥² ¯®±« ²¼ ®¡³ ®²¢¥² M 0 , ¯®¤¯¨± ­­»© ½«¥ª²°®­­®© ¯®¤¯¨±¼¾ (°¨±. 33.6).
 «¨±  ¢»·¨±«¿¥² ½«¥ª²°®­­³¾ ¯®¤¯¨±¼ (digital signature)  =
SA (M 0).
 «¨±  ¯®±»« ¥² ®¡³ ¯ °³ (M 0; ), ±®±²®¿¹³¾ ¨§ ±®®¡¹¥­¨¿ ¨
¯®¤¯¨±¨.
 ®¡ ¯®«³· ¥² ¯ °³ (M 0; ) ¨ ³¡¥¦¤ ¥²±¿ ¢ ¯®¤«¨­­®±²¨ ¯®¤¯¨±¨,
¯°®¢¥°¨¢ ° ¢¥­±²¢® M 0 = PA ( ).
±«¨ ³· ±²­¨ª®¢ ¯¥°¥£®¢®°®¢ ¬­®£®, ¡³¤¥¬ ±·¨² ²¼, ·²® ª ¦¤®¥
±®®¡¹¥­¨¥ M 0 ¤®«¦­® ­ ·¨­ ²¼±¿ ± ¨¬¥­¨ ®²¯° ¢¨²¥«¿ | ¯°®·²¿
¥£®, ¬®¦­® ³§­ ²¼, ·¥© ª«¾· ­ ¤® ¨±¯®«¼§®¢ ²¼ ¤«¿ ¯°®¢¥°ª¨. ±«¨ ° ¢¥­±²¢® ¢»¯®«­¿¥²±¿, ²® ¬®¦­® ¡»²¼ ³¢¥°¥­­»¬ ¢ ²®¬, ·²®
±®®¡¹¥­¨¥ ¤¥©±²¢¨²¥«¼­® ¡»«® ¯®±« ­® ®²¯° ¢¨²¥«¥¬ ¨ ¤®¸«® ¢
­¥¨§¬¥­¥­­®¬ ¢¨¤¥. ±«¨ ¦¥ ° ¢¥­±²¢® ­¥ ¢»¯®«­¥­®, ±®®¡¹¥­¨¥
¡»«® ¯®¢°¥¦¤¥­® ¯®¬¥µ ¬¨ ¨«¨ ´ «¼±¨´¨¶¨°®¢ ­®.
 ª¨¬ ®¡° §®¬, ¶¨´°®¢ ¿ ¯®¤¯¨±¼ ¢»¯®«­¿¥² ´³­ª¶¨¨ ®¡»·­®©.
®¤«¨­­®±²¼ ¶¨´°®¢®© ¯®¤¯¨±¨ ¬®¦¥² ¯°®¢¥°¨²¼ ª ¦¤»©, §­ ¾¹¨© ®²ª°»²»© ª«¾· «¨±». °®·¨² ¢ ±®®¡¹¥­¨¥ «¨±», ®¡ ¬®¦¥² ¯¥°¥±« ²¼ ¤°³£¨¬ ³· ±²­¨ª ¬ ¯¥°¥£®¢®°®¢, ¨ ²¥ ²®¦¥ ±¬®£³²
³¡¥¤¨²¼±¿ ¢ ¥£® ¯®¤«¨­­®±²¨.  ¯°¨¬¥°, ¯®¤¯¨± ­­»¬ ¤®ª³¬¥­²®¬
¬®¦¥² ¡»²¼ ¡ ­ª®¢±ª®¥ ¯®°³·¥­¨¥ ® ¯¥°¥·¨±«¥­¨¨ ¤¥­¥£ ±® ±·¥² 
«¨±» ­  ±·¥² ®¡  | ¨ ¡ ­ª ¡³¤¥² §­ ²¼, ·²® ®­® ­ ±²®¿¹¥¥,  
­¥ ´ «¼±¨´¨¶¨°®¢ ­® ®¡®¬.
°¨ ² ª®¬ ±¶¥­ °¨¨ ±®¤¥°¦¨¬®¥ ¯®¤¯¨± ­­®£® ±®®¡¹¥­¨¿ ­¥

744

« ¢  33 ¥®p¥²¨ª®-·¨±«®¢»¥  «£®p¨²¬»

¿¢«¿¥²±¿ ±¥ª°¥²­»¬. ®¦­® ¤®¡¨²¼±¿ ¨ ½²®£®, ±ª®¬¡¨­¨°®¢ ¢ ¤¢ 
®¯¨± ­­»µ ¯°¨¥¬ . ²¯° ¢¨²¥«¼, ¦¥« ¾¹¨© § ¸¨´°®¢ ²¼ ¨ ¯®¤¯¨± ²¼ ±¢®¥ ±®®¡¹¥­¨¥, ¤®«¦¥­ ±­ · «  ¯°¨«®¦¨²¼ ª ±¢®¥¬³ ±®®¡¹¥­¨¾ ¶¨´°®¢³¾ ¯®¤¯¨±¼,   § ²¥¬ § ¸¨´°®¢ ²¼ ¯ °³ (±®®¡¹¥­¨¥,
¯®¤¯¨±¼) ¯°¨ ¯®¬®¹¨ ®²ª°»²®£® ª«¾·  ¯®«³· ²¥«¿. ®«³· ²¥«¼
±­ · «  ° ±¸¨´°³¥² ½²³ ¯ °³ ± ¯®¬®¹¼¾ ±¢®¥£® ±¥ª°¥²­®£® ª«¾· ,
  § ²¥¬ ¯°®¢¥°¨² ¥¥ ¯®¤«¨­­®±²¼ ± ¯®¬®¹¼¾ ®²ª°»²®£® ª«¾·  ®²¯° ¢¨²¥«¿. ­ «®£¨·­ ¿ ¯°®¶¥¤³°  ± ¡³¬ ¦­»¬ ¤®ª³¬¥­²®¬ ¬®£« 
¡» ¢»£«¿¤¥²¼ ² ª: ¯¨±¼¬® ¯¨¸¥²±¿ ®² °³ª¨, ¯®¤¯¨±»¢ ¥²±¿ ¨ ¢ª« ¤»¢ ¥²±¿ ¢ ª®­¢¥°², ª®²®°»© ¬®¦¥² ®²ª°»²¼ ²®«¼ª® ¯®«³· ²¥«¼.
°¨¯²®±¨±²¥¬  RSA.
²®¡» ¯®±²°®¨²¼ ¯ °³ ª«¾·¥© ¤«¿ ª°¨¯²®±¨±²¥¬» RSA (RSA
cryptosystem), ­ ¤® ±¤¥« ²¼ ±«¥¤³¾¹¥¥:
1. §¿²¼ ¤¢  ¡®«¼¸¨µ ¯°®±²»µ ·¨±«  p ¨ q (±ª ¦¥¬, ®ª®«® 100 ¤¥±¿²¨·­»µ ¶¨´° ¢ ª ¦¤®¬).
2. »·¨±«¨²¼ n = pq .
3. §¿²¼ ­¥¡®«¼¸®¥ ­¥·¥²­®¥ ·¨±«® e, ¢§ ¨¬­® ¯°®±²®¥ ± '(n). (§
±®®²­®¸¥­¨¿ (33.20) ±«¥¤³¥², ·²® '(n) = (p ; 1)(q ; 1).)
4. »·¨±«¨²¼ d = e;1 mod '(n). (® «¥¤±²¢¨¾ 33.26 d ±³¹¥±²¢³¥²
¨ ®¯°¥¤¥«¥­®, ¯® ¬®¤³«¾ '(n) ®¤­®§­ ·­®.)
5. ®±² ¢¨²¼ ¯ °³ P = (e; n) | ®²ª°»²»© RSA-ª«¾· (RSA public
key).
6. ®±² ¢¨²¼ ¯ °³ S = (d; n) | ±¥ª°¥²­»© RSA-ª«¾· (RSA secret
key).
­®¦¥±²¢®¬ D ¢±¥µ ¢®§¬®¦­»µ ±®®¡¹¥­¨© ¤«¿ ½²®© ª°¨¯²®±¨±²¥¬» ¿¢«¿¥²±¿ Zn. ²ª°»²®¬³ ª«¾·³ P = (e; n) ±®®²¢¥²±²¢³¥²
¯°¥®¡° §®¢ ­¨¥
P (M ) = M e mod n;
(33:39)
  ±¥ª°¥²­®¬³ ª«¾·³ S = (d; n) | ¯°¥®¡° §®¢ ­¨¥

S (C ) = C d mod n:

(33:40)

 ª ³¦¥ £®¢®°¨«®±¼, ½²¨ ¯°¥®¡° §®¢ ­¨¿ ¬®¦­® ¨±¯®«¼§®¢ ²¼ ¨
¤«¿ ¸¨´°®¢ ­¨¿, ¨ ¤«¿ ½«¥ª²°®­­»µ ¯®¤¯¨±¥©.
«¿ ¢®§¢¥¤¥­¨¿ ¢ ±²¥¯¥­¼ ¢ ´®°¬³« µ !(33.39){(33.40) ° §³¬­®
¯®«¼§®¢ ²¼±¿ ¯°®¶¥¤³°®© Modular-Exponentation ¨§  §¤¥« 
33.6. ±«¨ ±·¨² ²¼, ·²® ·¨±«  d ¨ n ¨¬¥¾² ¯®°¿¤ª   ¡¨²®¢,  
·¨±«® e ¨¬¥¥² O(1) ¡¨²®¢, ²® ¯°¥®¡° §®¢ ­¨¥ P ¯®²°¥¡³¥² O(1)
³¬­®¦¥­¨© ¯® ¬®¤³«¾ n (O( 2) ¡¨²®¢»µ ®¯¥° ¶¨©),     ¯°¥®¡° §®¢ ­¨¥ S O( ) ³¬­®¦¥­¨© (O( 3) ¡¨²®¢»µ ®¯¥° ¶¨©) (° §³¬¥¥²±¿,
¯°¨ ¨§¢¥±²­®¬ ª«¾·¥).
¥®°¥¬  33.36 (®°°¥ª²­®±²¼ ±¨±²¥¬» RSA)
®°¬³«» (33.39) ¨ (33.40) § ¤ ¾² ¢§ ¨¬­® ®¡° ²­»¥ ¯¥°¥±² ­®¢ª¨ ¬­®¦¥±²¢  Zn.

°¨¯²®±¨±²¥¬  RSA ± ®²ª°»²»¬ ª«¾·®¬

745

®ª § ²¥«¼±²¢®
·¥¢¨¤­®,

P (S (M )) = S (P (M )) = M ed (mod n)
¤«¿ ¢±¿ª®£® M 2 n. » §­ ¥¬, ·²® e ¨ d ¢§ ¨¬­® ®¡° ²­» ¯®
¬®¤³«¾ '(n), ²® ¥±²¼
ed = 1 + k(p ; 1)(q ; 1)
¤«¿ ­¥ª®²®°®£® ¶¥«®£® k. ±«¨ M 6 0 (mod p), ²® ¯® ¬ «®© ²¥®°¥¬¥
Z

¥°¬  (²¥®°¥¬  33.31) ¨¬¥¥²

M ed  M (M p;1)k(q;1)  M  1k(q;1)  M
¯® ¬®¤³«¾ p.  ¢¥­±²¢® M ed  M (mod p). ¢»¯®«­¥­®, ª®­¥·­®,
¨ ¯°¨ M  0 (mod p), ² ª ·²® ®­® ¢¥°­® ¤«¿ ¢±¥µ M . ® ²¥¬ ¦¥
¯°¨·¨­ ¬ M ed  M (mod q ), ¨ ¯®²®¬³ (±«¥¤±²¢¨¥ 33.29) M ed  M
(mod n) ¯°¨ ¢±¿ª®¬ M .

 ¤¥¦­®±²¼ ª°¨¯²®±¨±²¥¬» RSA ®±­®¢»¢ ¥²±¿ ­  ²°³¤­®±²¨ § ¤ ·¨ ° §«®¦¥­¨¿ ±®±² ¢­»µ ·¨±¥« ­  ¬­®¦¨²¥«¨: ¥±«¨ ¢° £ ° §«®¦¨² (®²ª°»²® ®¯³¡«¨ª®¢ ­­®¥) ·¨±«® n ­  ¬­®¦¨²¥«¨ p ¨ q , ®­
±¬®¦¥² ­ ©²¨ d ²¥¬ ¦¥ ±¯®±®¡®¬, ·²® ¨ ±®§¤ ²¥«¼ ª«¾· .  ª¨¬
®¡° §®¬, ¥±«¨ § ¤ ·  ° §«®¦¥­¨¿ ­  ¬­®¦¨²¥«¨ ¬®¦¥² ¡»²¼ °¥¸¥­  ¡»±²°® (ª ª¨¬-²® ¯®ª  ­¥¨§¢¥±²­»¬ ­ ¬  «£®°¨²¬®¬), ²®
À¢§«®¬ ²¼Á ª°¨¯²®±¨±²¥¬³ RSA «¥£ª®. ¡° ²­®¥ ³²¢¥°¦¤¥­¨¥, ¯®ª §»¢ ¾¹¥¥, ·²® ¥±«¨ § ¤ ·  ° §«®¦¥­¨¿ ­  ¬­®¦¨²¥«¨ ±«®¦­ ,
²® ¢§«®¬ ²¼ ±¨±²¥¬³ RSA ²°³¤­®, ­¥ ¤®ª § ­® | ®¤­ ª® §  ¢°¥¬¿
±³¹¥±²¢®¢ ­¨¿ ½²®© ±¨±²¥¬» ­¨ª ª®£® ¨­®£® ±¯®±®¡  ¥¥ ±«®¬ ²¼
®¡­ °³¦¥­® ­¥ ¡»«®.
 ª ¬» ³¢¨¤¨¬ ¢ ° §¤¥«¥ 33.9, ° §«®¦¥­¨¥ ·¨±¥« ­  ¬­®¦¨²¥«¨
| ¤¥«® ­¥¯°®±²®¥, ¡»±²°®£®  «£®°¨²¬  ¤«¿ ½²®£® ¬» ­¥ §­ ¥¬; ¨§¢¥±²­»¥ ­»­¥ ¬¥²®¤» ­¥ ¯®§¢®«¿¾² ° §«®¦¨²¼ ­  ¬­®¦¨²¥«¨ ¯°®¨§¢¥¤¥­¨¥ ¤¢³µ 100-§­ ·­»µ ¯°®±²»µ ·¨±¥« §  ° §³¬­®¥ ¢°¥¬¿ |
¤«¿ ½²®£® ­³¦­» ª ª¨¥-²® ­®¢»¥ ¨¤¥¨ ¨ ¬¥²®¤» (¥±«¨ ½²® ¢®®¡¹¥
¢®§¬®¦­®).
®­¥·­®, ­ ¤¥­®±²¼ ±¨±²¥¬» RSA § ¢¨±¨² ®² ° §¬¥°  ¯°®±²»µ
·¨±¥«, ¯®±ª®«¼ª³ ­¥¡®«¼¸¨¥ ·¨±«  «¥£ª® ° §«®¦¨²¼ ­  ¬­®¦¨²¥«¨.
®½²®¬³ ­ ¤® ³¬¥²¼ ¨±ª ²¼ ¡®«¼¸¨¥ ¯°®±²»¥ ·¨±« . ²®© § ¤ ·¥©
¬» § ©¬¥¬±¿ ¢ ° §¤¥«¥ 33.8.
  ¯° ª²¨ª¥ (¤«¿ ³±ª®°¥­¨¿ ¢»·¨±«¥­¨© ª°¨¯²®±¨±²¥¬³ RSA · ±²® ¨±¯®«¼§³¾² ¢¬¥±²¥ ± ª ª®©-²® ²° ¤¨¶¨®­­®© ±¨±²¥¬®© ¸¨´°®¢ ­¨¿, ¢ ª®²®°®© ª«¾· ­¥®¡µ®¤¨¬® µ° ­¨²¼ ¢ ±¥ª°¥²¥. »¡° ¢ ² ª³¾ ±¨±²¥¬³, ¬» ¨±¯®«¼§³¥¬ ¤«¿ ¸¨´°®¢ ­¨¿ ¥¥ |   ±¨±²¥¬  RSA
¨±¯®«¼§³¥²±¿ ²®«¼ª® ¤«¿ ¯¥°¥¤ ·¨ ±¥ª°¥²­®£® ª«¾· , ª®²®°»© ¬®¦¥² ¡»²¼ §­ ·¨²¥«¼­® ª®°®·¥ ± ¬®£® ±®®¡¹¥­¨¿.  ¬ ½²®² ª«¾·
¬®¦¥² ¢»¡¨° ²¼±¿, ­ ¯°¨¬¥°, ±«³· ©­® ¨ ²®«¼ª® ¤«¿ ®¤¨­ ° §.

746

« ¢  33 ¥®p¥²¨ª®-·¨±«®¢»¥  «£®p¨²¬»

®µ®¦¨© ¯®¤µ®¤ ¯°¨¬¥­¿¥²±¿ ¤«¿ ³±ª®°¥­¨¿ ° ¡®²» ± ¶¨´°®¢»¬¨ ¯®¤¯¨±¿¬¨. ¨±²¥¬  RSA ¨±¯®«¼§³¥²±¿ ¯°¨ ½²®¬ ¢ ¯ °¥ ± ² ª
­ §»¢ ¥¬®© ®¤­®±²®°®­­¥© µ¥¸-´³­ª¶¨¥© (one-way hash function).
 ª ¿ ´³­ª¶¨¿ ®²®¡° ¦ ¥² ª ¦¤®¥ ±®®¡¹¥­¨¥ M ¢ ¤®±² ²®·­® ª®°®²ª®¥ ±®®¡¹¥­¨¥ h(M ) (­ ¯°¨¬¥°, 128-¡¨²®¢³¾ ±²°®ª³), ¯°¨ ½²®¬
h(M ) «¥£ª® ¢»·¨±«¨²¼ ¯® M , ­® ­¥ ³¤ ¥²±¿ ­ ©²¨ ¤¢  ° §­»µ ±®®¡¹¥­¨¿ M ¨ M 0 , ¤«¿ ª®²®°»µ h(M ) = h(M 0 ) (µ®²¿ ² ª¨µ ¯ ° ¬­®£®
¯® ¯°¨­¶¨¯³ ¨°¨µ«¥).
¡° § h(M ) ±®®¡¹¥­¨¿ M ¬®¦­® ±° ¢­¨²¼ ± À®²¯¥· ²ª®¬
¯ «¼¶ Á (ngerprint) ±®®¡¹¥­¨¿ M . «¨± , ¦¥« ¿ ¯®¤¯¨± ²¼
±¢®¥ ±®®¡¹¥­¨¥ M , ¢»·¨±«¿¥² h(M ), ª®²®°»© ¨ ¸¨´°³¥² ±¢®¨¬ ±¥ª°¥²­»¬ RSA-ª«¾·®¬.  ²¥¬ ®­  ¯®±»« ¥² ®¡³ ¯ °³
(M; SA (h(M ))). ®¡ ³¤®±²®¢¥°¿¥²±¿ ¢ ¯®¤«¨­­®±²¨ ¯®¤¯¨±¨, ¯°®¢¥°¨¢, ·²® PA (SA (h(M ))) = h(M ). ®­¥·­®, ¬®¦­® ´ «¼±¨´¨¶¨°®¢ ²¼ ²¥ª±² ±®®¡¹¥­¨¿, ­ ©¤¿ ¤°³£®¥ ±®®¡¹¥­¨¥ M 0, ¤«¿ ª®²®°®£®
h(M ) = h(M 0), ­® ½²® (¯® ­ ¸¥¬³ ¯°¥¤¯®«®¦¥­¨¾) ±«®¦­®.
®­¥·­®, ¯°¨ ¨±¯®«¼§®¢ ­¨¨ ®²ª°»²»µ ª«¾·¥© ­ ¤® ¥¹¥ ³¡¥¤¨²¼±¿, ·²® ± ¬¨ ª«¾·¨ ­¥ ¡»«¨ ¯®¤¬¥­¥­». °¥¤¯®«®¦¨¬, ·²®
¨¬¥¥²±¿ ­¥ª®²®°»© À­®² °¨³±Á, ·¥±²­®±²¼ ª®²®°®£® ¢­¥ ¯®¤®§°¥­¨© ¨ ®²ª°»²»© ª«¾· ª®²®°®£® ¢±¥ §­ ¾² (¨ ¢ ¥£® ¯° ¢¨«¼­®±²¨
­¥ ±®¬­¥¢ ¾²±¿). ®² °¨³± ¬®¦¥² ¢»¤ ¢ ²¼ ¨§¢¥±²­»¬ ¥¬³ «¾¤¿¬
±¯° ¢ª¨ (±¥°²¨´¨ª ²», certicates) ® ²®¬, ·²® ¨µ ®²ª°»²»© ª«¾·
² ª®©-²®, ¯®¤¯¨±»¢ ¿ ½²¨ ±¯° ¢ª¨ ±®¡±²¢¥­­®© ¶¨´°®¢®© ¯®¤¯¨±¼¾. (°¨µ®¤¿¹¨¥ ¤®«¦­» ±®®¡¹¨²¼ ­®² °¨³±³ ±¢®© ®²ª°»²»©
ª«¾·.) ®¤«¨­­®±²¼ ±¥°²¨´¨ª ²  ¬®¦¥² ¡»²¼ ¯°®¢¥°¥­  ª ¦¤»¬,
ª®¬³ ¨§¢¥±²¥­ ®²ª°»²»© ª«¾· ­®² °¨³± ; «¾¡®© § °¥£¨±²°¨°®¢ ­­»© ³ ­®² °¨³±  ³· ±²­¨ª ¯¥°¥£®¢®°®¢ ¬®¦¥² ¯°¨« £ ²¼ ± ±¢®¨¬
±®®¡¹¥­¨¿¬ ¢»¤ ­­»© ­®² °¨³±®¬ ±¥°²¨´¨ª ².
¯° ¦­¥­¨¿
33.7-1
»·¨±«¨²¥ ®²ª°»²»© ¨ ±¥ª°¥²­»© RSA-ª«¾·¨ ¯°¨ p = 11, q =
29, n = 319 ¨ e = 3. ¥¬³ ° ¢­® d ¢ ±¥ª°¥²­®¬ ª«¾·¥?  ¸¨´°³©²¥
±®®¡¹¥­¨¥ M = 100.
33.7-2
³±²¼ §­ ·¥­¨¥ e ¤«¿ ®²ª°»²®£® ª®¤  ° ¢­® 3. ®ª ¦¨²¥, ·²®
¢° £, ³§­ ¢¸¨© §­ ·¥­¨¥ d, ±¬®¦¥² ° §«®¦¨²¼ n ­  ¬­®¦¨²¥«¨ § 
¢°¥¬¿, ¯®«¨­®¬¨ «¼­®¥ ®²­®±¨²¥«¼­® ¤«¨­» ¤¢®¨·­®© § ¯¨±¨ n.
(­ «®£¨·­®¥ ³²¢¥°¦¤¥­¨¥ ¢¥°­® ¨ ¤«¿ ¯°®¨§¢®«¼­®£® e, ±¬. ° ¡®²³ ¨««¥°  [147].)
33.7-3*
®ª ¦¨²¥, ·²® ±¨±²¥¬  RSA ¬³«¼²¨¯«¨ª ²¨¢­ , ²® ¥±²¼
PA (M1 )PA(M2)  PA (M1M2) (mod n)
¤«¿ «¾¡»µ M1 ; M2 2 Zn. °¥¤¯®«®¦¨¬, ·²® ¢° £ ¨¬¥¥² ±¯®±®¡ ¡»±²°® ° ±¸¨´°®¢»¢ ²¼ 1% ¢±¥µ ±®®¡¹¥­¨© ¨§ Zn . ±¯®«¼§³¿ ¬³«¼²¨¯«¨ª ²¨¢­®±²¼ ±¨±²¥¬» RSA, ®¡º¿±­¨²¥, ª ª ²®£¤  ®­ ¬®¦¥²

°®¢¥°ª  ·¨±¥« ­  ¯°®±²®²³

747

± ¢»±®ª®© ¢¥°®¿²­®±²¼¾ ¤®±² ²®·­® ¡»±²°® ° ±¸¨´°®¢ ²¼ «¾¡®¥
±®®¡¹¥­¨¥.

33.8. °®¢¥°ª  ·¨±¥« ­  ¯°®±²®²³
 ½²®¬ ° §¤¥«¥ ¬» ®¡±³¦¤ ¥¬ ¢®¯°®± ® ²®¬, ª ª ¨±ª ²¼ ¡®«¼¸¨¥
¯°®±²»¥ ·¨±« .
 ±¯°¥¤¥«¥­¨¥ ¯°®±²»µ ·¨±¥«.
 ª ­ ©²¨ ¡®«¼¸®¥ ¯°®±²®¥ ·¨±«®? ±²¥±²¢¥­­»© ¯®¤µ®¤ ² ª®¢:
¢§¿²¼ ¡®«¼¸®¥ ±«³· ©­®¥ ·¨±«® ¨ ¯®±¬®²°¥²¼, ­¥ ®ª ¦¥²±¿ «¨ ®­®
¯°®±²»¬. ±«¨ ­¥², ¯®¯°®¡®¢ ²¼ ¤°³£®¥ ±«³· ©­®¥ ·¨±«® ¨ ² ª ¤ «¥¥. ²®² ±¯®±®¡ ¯°¨£®¤¥­, «¨¸¼ ¥±«¨ ¯°®±²»¥ ·¨±«  ­¥ ±«¨¸ª®¬
°¥¤ª¨ | ª ±· ±²¼¾, ½²® ¤¥©±²¢¨²¥«¼­® ² ª, ª ª ¯®ª §»¢ ¥² ²¥®°¥¬  ® ° ±¯°¥¤¥«¥­¨¨ ¯°®±²»µ ·¨±¥«, ¤®ª § ­­ ¿ ¢ ª®­¶¥ ¯°®¸«®£® ¢¥ª . ®² ¥¥ ´®°¬³«¨°®¢ª  (¤®ª § ²¥«¼±²¢® ¤ «¥ª® ¢»µ®¤¨² § 
° ¬ª¨ ½²®© ª­¨£¨).
¯°¥¤¥«¨¬ ´³­ª¶¨¾ ° ±¯°¥¤¥«¥­¨¿ ¯°®±²»µ ·¨±¥« (prime distribution function)  , ¯®«®¦¨¢  (n) ° ¢­»¬ ª®«¨·¥±²¢³ ¯°®±²»µ ·¨±¥«, ­¥ ¯°¥¢®±µ®¤¿¹¨µ n.  ¯°¨¬¥°, ­  ®²°¥§ª¥ ®² 1 ¤® 10 ¥±²¼ 4
¯°®±²»µ ·¨±«  2, 3, 5 ¨ 7, ¯®½²®¬³  (10) = 4.
¥®°¥¬  33.37 ( ±¨¬¯²®²¨·¥±ª¨© § ª®­ ° ±¯°¥¤¥«¥­¨¿ ¯°®±²»µ
·¨±¥«)
lim  (n) = 1:
n!1 n= ln n
»° ¦¥­¨¥ n= ln n ¤ ¥² ­¥¯«®µ®¥ ¯°¨¡«¨¦¥­¨¥ ª  (n) ¤ ¦¥ ¯°¨
­¥¡®«¼¸¨µ §­ ·¥­¨¿µ n. ¦¥ ¯°¨ n = 109 (­¥¡®«¼¸®¥ ·¨±«® ± ²®·ª¨
§°¥­¨¿ ±¯¥¶¨ «¨±²®¢ ¯® ²¥®°¨¨ ·¨±¥«) ¯®£°¥¸­®±²¼ ¯°¨¡«¨¦¥­¨¿
­¥ ¯°¥¢®±µ®¤¨² 6% ( (109) = 50 847 478, 109=109 ln 109  48 254 942).
±¨¬¯²®²¨·¥±ª¨© § ª®­ ¯®§¢®«¿¥² ®¶¥­¨²¼ ¢¥°®¿²­®±²¼, ± ª®²®°®© ¶¥«®¥ ·¨±«®, ­ ³£ ¤ ¢»¡° ­­®¥ ¨§ ®²°¥§ª  ®² 1 ¤® n, ¿¢«¿¥²±¿
¯°®±²»¬ | ½²® ¯°¨¬¥°­® 1= ln n. ¥¬ ± ¬»¬ ¤«¿ ®²»±ª ­¨¿ ¯°®±²®£® ·¨±«  ®² 1 ¤® n ­³¦­® ¯°®¢¥°¨²¼ ­  ¯°®±²®²³ ¯®°¿¤ª  ln n
±«³· ©­® ¢»¡° ­­»µ ·¨±¥«.  ¯°¨¬¥°, ·²®¡» ­ ©²¨ ¯°®±²®¥ ·¨±«®
¨§ 100 ¤¥±¿²¨·­»µ §­ ª®¢, ­ ¤® ¯¥°¥¡° ²¼ ¯®°¤¿ª  ln 10100  230
±«³· ©­»µ ·¨±¥« ®² 1 ¤® 10100. (²  ®¶¥­ª  ¯® ®·¥¢¨¤­»¬ ¯°¨·¨­ ¬ ¬®¦¥² ¡»²¼ ³¬¥­¼¸¥­  ¢¤¢®¥: ¯°®¢¥°¿²¼ ­  ¯°®±²®²³ ±²®¨²
²®«¼ª® ­¥·¥²­»¥ ·¨±« .  ¬¥²¨¬ ² ª¦¥, ·²® ·¨±«® ¤¥±¿²¨·­»µ §­ ª®¢ ¢ ­ ³£ ¤ ¢§¿²®¬ ·¨±«¥ ®² 1 ¤® 10100 ± ¡®«¼¸®© ¢¥°®¿²­®±²¼¾
¡«¨§ª® ª 100 | ®ª®«® 90% ¢±¥µ ·¨±¥« ¢ ½²®¬ ¤¨ ¯ §®­¥ ¨¬¥¾² 100
§­ ª®¢, ®ª®«® 99% | 99 ¨«¨ ¡®«¥¥ §­ ª®¢, ®ª®«® 99; 9% | 98 ¨«¨
¡®«¥¥ §­ ª®¢ ¨ ².¤.)
 ¬ ®±² ¥²±¿ ®¡º¿±­¨²¼, ª ª¨¬ ®¡° §®¬ ¬®¦­® ¯°®¢¥°¨²¼, ¡³¤¥²
«¨ ¯°®±²»¬ ¤ ­­®¥ ¡®«¼¸®¥ ·¨±«® n. °³£¨¬¨ ±«®¢ ¬¨, ¬» µ®²¨¬

748

« ¢  33 ¥®p¥²¨ª®-·¨±«®¢»¥  «£®p¨²¬»

³§­ ²¼, ±®±²®¨² «¨ ° §«®¦¥­¨¥ ·¨±«  n ­  ¯°®±²»¥ ¬­®¦¨²¥«¨
n = pe1 pe2    perr ;
(r > 1; ·¨±«  p1; p2; : : : ; pr | ° §«¨·­»¥ ¯°®±²»¥ ¤¥«¨²¥«¨ n) ¨§
¥¤¨­±²¢¥­­®£® ¯°®±²®£® ·¨±«  (r = 1, e1 = 1).
 ¬»© ¯°®±²®© ±¯®±®¡ ¯°®¢¥°ª¨ | ¯¥°¥¡®° ¤¥«¨²¥«¥©
(trial divip
sion). ³¤¥¬ ¯»² ²¼±¿ ° §¤¥«¨²¼ n ­  2; 3; : : : ; b nc (·¥²­»¥ ·¨±« ,
¡®«¼¸¨¥ 2, ¬®¦­® ¯°®¯³±ª ²¼). ±«¨ n ­¥ ¤¥«¨²±¿ ­¨ ­  ®¤­® ¨§
½²¨µ ·¨±¥«, ²® ®­® ¯°®±²®¥ (¥±«¨ n ° §« £ ¥²±¿ ¢ ¯°®¨§¢¥¤¥­¨¥ ¤¢³µ
p
¨«¨ ¡®«¥¥ ¬­®¦¨²¥«¥©, ²® ®¤¨­ ¨§ ¬­®¦¨²¥«¥© ­¥p¯°¥¢®±µ®¤¨² n).
® ¤¥«® ½²® ¤®«£®¥ | ³¦¥ ·¨±«® ¤¥«¥­¨© ¥±²¼ ( n), ¨ ¢°¥¬¿ ° ¡®²» ½ª±¯®­¥­¶¨ «¼­® § ¢¨±¨² ®² ¤«¨­» § ¯¨±¨ ·¨±«  n (­ ¯®¬­¨¬,
·²® ¤¢®¨·­®¥
¯°¥¤±² ¢«¥­¨¥ n § ­¨¬ ¥²  = blg(n + 1)c ¡¨²®¢, ² ª
p
·²® n = (2=2)).  ª¨¬ ®¡° §®¬, ² ª®© ¯®¤µ®¤ ¯°¨¬¥­¨¬, «¨¸¼
¥±²¼ ·¨±«® n ¬ «®, ¨«¨ ¨¬¥¥² ­¥¡®«¼¸®© ¤¥«¨²¥«¼.
±«¨ ¯°¨ ¯¥°¥¡®°¥ ¤¥«¨²¥«¥© ¬» ®¡­ °³¦¨¢ ¥¬, ·²® ·¨±«® n ±®±² ¢­®¥, ²® ®¤­®¢°¥¬¥­­® ­ µ®¤¨²±¿ ¨ ¤¥«¨²¥«¼ ·¨±«  n. «¿ ¤°³£¨µ ±¯®±®¡®¢ ¯°®¢¥°ª¨ ¯°®±²®²» ½²® ­¥ ² ª | ¬®¦­® ³¡¥¤¨²¼±¿,
·²® ·¨±«® ±®±² ¢­®¥, ² ª ¨ ­¥ ³ª § ¢ ­¨ª ª®£® ¥£® ¤¥«¨²¥«¿. ²®
­¥ ³¤¨¢¨²¥«¼­®, ² ª ª ª § ¤ ·  ° §«®¦¥­¨¿ ·¨±«  ­  ¬­®¦¨²¥«¨,
¯®-¢¨¤¨¬®¬³, £®° §¤® ±«®¦­¥¥ § ¤ ·¨ ¯°®¢¥°ª¨ ¯°®±²®²» ·¨±« . 
§ ¤ ·¥ ° §«®¦¥­¨¿ ­  ¬­®¦¨²¥«¨ ¬» ¢¥°­¥¬±¿ ¢ ±«¥¤³¾¹¥¬ ° §¤¥«¥.
±¥¢¤®¯°®±²»¥ ·¨±« .
¥©· ± ¬» ®¯¨¸¥¬ À¯®·²¨ ¯° ¢¨«¼­»©Á  «£®°¨²¬ ¯°®¢¥°ª¨ ·¨±«  ­  ¯°®±²®²³, ¯°¨¥¬«¥¬»© ¤«¿ ¬­®£¨µ ¯° ª²¨·¥±ª¨µ ¯°¨«®¦¥­¨©. (¥¡®«¼¸®¥ ³±«®¦­¥­¨¥ ½²®£®  «£®°¨²¬ , ¤¥« ¾¹¥¥ ¥£® ±®¢±¥¬ ¯° ¢¨«¼­»¬, ¡³¤¥² ®¯¨± ­® ¤ «¼¸¥.)
¡®§­ ·¨¬ ·¥°¥§ Z+n ¬­®¦¥±²¢® ¢±¥µ ­¥­³«¥¢»µ ¢»·¥²®¢ ¯® ¬®¤³«¾ n:
Z+n = f1; 2; : : : ; n ; 1g:
±«¨ ·¨±«® n ¯°®±²®¥, ²® Z+n = Zn.
 §®¢¥¬ ·¨±«® n ¯±¥¢¤®¯°®±²»¬ ¯® ®±­®¢ ­¨¾ a (base-a pseudoprime), ¥±«¨ ¢»¯®«­¥­® ³²¢¥°¦¤¥­¨¥ ¬ «®© ²¥®°¥¬» ¥°¬ :
an;1  1 (mod n):
(33:42)
¾¡®¥ ¯°®±²®¥ ·¨±«® n ¿¢«¿¥²±¿ ¯±¥¢¤®¯°®±²»¬ ¯® «¾¡®¬³ ®±­®¢ ­¨¾ a 2 Z+n . ®½²®¬³ ¥±«¨ ­ ¬ ³¤ «®±¼ ­ ©²¨ ®±­®¢ ­¨¥ a, ¯®
ª®²®°®¬³ n ­¥ ¿¢«¿¥²±¿ ¯±¥¢¤®¯°®±²»¬, ²® ¬» ¬®¦¥¬ ¡»²¼ ³¢¥°¥­», ·²® n | ±®±² ¢­®¥. ª §»¢ ¥²±¿, ·²® ¢® ¬­®£¨µ ±«³· ¿µ
¤®±² ²®·­® ¯°®¢¥°¨²¼ ®±­®¢ ­¨¥ a = 2
1

2

Pseudoprime(n)
1 if Modular-Exponentiation(2,n-1,n) \not\equiv 1 \pmod n
2
then return composite
(§ ¢¥¤®¬®)
3
else return prime
(¢®§¬®¦­®)

°®¢¥°ª  ·¨±¥« ­  ¯°®±²®²³

749

²  ¯°®¶¥¤³°  ¬®¦¥² ±®¢¥°¸ ²¼ ®¸¨¡ª¨, ­® ²®«¼ª® ¢ ®¤­³ ±²®°®­³: ¥±«¨ ®­  ±®®¡¹ ¥², ·²® ·¨±«® n ±®±² ¢­®¥, ²® ½²® ¤¥©±²¢¨²¥«¼­® ² ª, ­® ®­  ¬®¦¥² ¯°¨­¿²¼ ±®±² ¢­®¥ ·¨±«® §  ¯°®±²®¥ (¥±«¨
®­® ¿¢«¿¥²±¿ ¯±¥¢¤®¯°®±²»¬ ¯® ®±­®¢ ­¨¾ 2).  ª · ±²® ² ª®¥ ¯°®¨±µ®¤¨²? ª §»¢ ¥²±¿, ­¥ ² ª ³¦ · ±²® | ±°¥¤¨ ·¨±¥« ¤® 10 000
¥±²¼ ²®«¼ª® 22 ·¨±« , ¤«¿ ª®²®°»µ ¯°®¶¥¤³°  Pseudoprime ¤ ¥²
­¥¢¥°­»© ®²¢¥² (¯¥°¢»¥ ·¥²»°¥ ¨§ ­¨µ | 341, 561, 645 ¨ 1105).
®¦­® ¯®ª § ²¼, ·²® ¤®«¿ ² ª¨µ À¯«®µ¨µÁ ·¨±¥« ±°¥¤¨  -§­ ·­»µ
·¨±¥« ±²°¥¬¨²±¿ ª 0 ¯°¨  ! 1. ±¯®«¼§³¿ ®¶¥­ª¨ ¨§ ° ¡®²»
®¬¥° ­¶  [157], ¬®¦­® ¯®ª § ²¼, ·²® ¤®«¿ ±®±² ¢­»µ ·¨±¥« ±°¥¤¨
50-° §°¿¤­»µ ¯±¥¢¤®¯°®±²»µ ¯® ®±­®¢ ­¨¾ 2 ·¨±¥« ­¥ ¯°¥¢®±µ®¤¨²
10;6 ,   ±°¥¤¨ 100-° §°¿¤­»µ ¯±¥¢¤®¯°®±²»µ ·¨±¥« | 10;13.
¥² ­¨ª ª¨µ ¯°¨·¨­ ®£° ­¨·¨¢ ²¼±¿ ¯°®¢¥°ª®© «¨¸¼ ®±­®¢ ­¨¿
2; ¬®¦­® ¯°®¢¥°¿²¼ ±®®²­®¸¥­¨¥ (33.42) ¨ ¯°¨ ¤°³£¨µ a. ® ½²®
­¥ ¢±¥£¤  ¯®¬®£ ¥²: ±³¹¥±²¢³¾² ±®±² ¢­»¥ ·¨±«  n, ª®²®°»¥ ¿¢«¿¾²±¿ ¯±¥¢¤®¯°®±²»¬¨ ¯® «¾¡®¬³ ®±­®¢ ­¨¾ a 2 Zn.  ª¨¥ ·¨±« 
­ §»¢ ¾²±¿ ·¨±« ¬¨  °¬ ©ª«  (Carmichael numbers). °¨ ¯¥°¢»µ
·¨±«   °¬ ©ª«  ² ª®¢»: 561, 1105 ¨ 1729. ¨±«   °¬ ©ª«  °¥¤ª¨: ±°¥¤¨ ¯¥°¢»µ ±²  ¬¨««¨®­®¢ ¯®«®¦¨²¥«¼­»µ ·¨±¥« ¨µ ¨¬¥¥²±¿
¢±¥£® 255. ( ³¯°. 33.8-2 ¬» ³ª ¦¥¬ ®¤­³ ¨§ ¯°¨·¨­, ¯® ª®²®°»¬
² ª¨µ ·¨±¥« ¬ «®.)
¥©· ± ¬» ¨±¯° ¢¨¬ ­ ¸ ²¥±² ² ª, ·²®¡» ¤ ¦¥ ·¨±«   °¬ ©ª« 
­¥ ±¬®£«¨ ¢¢¥±²¨ ¥£® ¢ § ¡«³¦¤¥­¨¥.
¥°®¿²­®±²­»© ²¥±² ¨««¥°  |  ¡¨­ 
²®² ¢¥°®¿²­®±²­»©  «£®°¨²¬ ¯°®¢¥°ª¨ ¯°®±²®²» ·¨±«  ¯®«³· ¥²±¿ ¨§ ¯°®¶¥¤³°» Pseudoprime ¤¢³¬¿ ¯°¨­¶¨¯¨ «¼­»¬¨ ³±®¢¥°¸¥­±²¢®¢ ­¨¿¬¨.
 ¥±² ¨««¥°  |  ¡¨­  ¯°®¢¥°¿¥² ±®®²­®¸¥­¨¥ (33.42) ¤«¿ ­¥±ª®«¼ª¨µ §­ ·¥­¨© a.
 »·¨±«¿¿ ±²¥¯¥­¼ a, ´¨£³°¨°³¾¹³¾ ¢ ±° ¢­¥­¨¨ (33.42), ²¥±²
¯® µ®¤³ ¢»·¨±«¥­¨¿ ¯°®¢¥°¿², ­¥ ®¡­ °³¦¨«±¿ «¨ ­¥²°¨¢¨ «¼­»© ª®°¥­¼ ¨§ 1 ¯® ¬®¤³«¾ n. ±«¨ ¤ , ²¥±² ­¥¬¥¤«¥­­® ¯°¥ª° ¹ ¥² ° ¡®²³ ¨ ±®®¡¹ ¥², ·²® ·¨±«® n | ±®±² ¢­®¥ (±«¥¤±²¢¨¥
33.35).
°®¶¥¤³°  Miller-Rabin, ¯°¨¢¥¤¥­­ ¿ ­¨¦¥, ­¨¦¥, ¯®«³· ¥² ­ 
¢µ®¤ ­¥·¥²­®¥ ·¨±«® n > 2 (¯°®±²®²³ ª®²®°®£® ¬» µ®²¨¬ ¯°®¢¥°¨²¼) ¨ ¨ ¶¥«®¥ ¯®«®¦¨²¥«¼­®¥ ·¨±«® s, ®¯°¥¤¥«¿¾¹¥¥, ±ª®«¼ª® ¨²¥° ¶¨© ­ ¤® ¯°®¢¥±²¨ (·¥¬ ¡®«¼¸¥ s, ²¥¬ ¬¥­¼¸¥ ¢¥°®¿²­®±²¼ ®¸¨¡ª¨). ¥±² ¨±¯®«¼§³¥² £¥­¥° ²®° ±«³· ©­»µ ·¨±¥« Random (±¬. ° §¤¥« 8.3); ¯°®¶¥¤³°  Random(1; n ; 1) ¢®§¢° ¹ ¥² ±«³· ©­®¥ ¶¥«®¥
·¨±«® a, ° ¢­®¬¥°­® ° ±¯°¥¤¥«¥­­®¥ ­  ®²°¥§ª¥ 1 6 a 6 n ; 1.
¥±² ¨±¯®«¼§³¥² ¯°®¶¥¤³°³ Witness: Witness(a; n) ¨±²¨­­®, ¥±«¨ a ¿¢«¿¥²±¿ À±¢¨¤¥²¥«¥¬Á ²®£®, ·²® ·¨±«® n ±®±² ¢­®¥.
Witness(a,n)
1 ¯³±²¼ \langle b_k,b_{k-1},\ldots,b_0$ --- ¤¢®¨·­ ¿ § ¯¨±¼ $n-1$

750

« ¢  33 ¥®p¥²¨ª®-·¨±«®¢»¥  «£®p¨²¬»
2 d \gets 1
3 for i \gets k downto 0
4
do x \gets d
5
d \gets (d\cdot d) \bmod n
6
if d=1 ¨ $x\ne 1$ ¨ $x\ne n-1$
7
then return true
8
if b_i=1
9
then d \gets (d \cdot a) \bmod n
10 if d\ne 1
11
then return true
12 return false

®² ª ª ¯°®¨±µ®¤¨² ½²  ¯°®¢¥°ª .  ±²°®ª¥ 1 ·¨±«® n ; 1 ¯¥°¥¢®¤¨²±¿ ¢ ¤¢®¨·­³¾ ±¨±²¥¬³. ²® ¯°¥¤±² ¢«¥­¨¥ ­³¦­®, ·²®¡»
¢»·¨±«¿²¼ an;1 mod n ¬¥²®¤®¬ ¯®¢²®°­®£® ¢®§¢¥¤¥­¨¿ ¢ ª¢ ¤° ²
(±²°®ª¨ 3{9). ²® ¤¥« ¥²±¿ ²¥¬ ¦¥ ±¯®±®¡®¬, ·²® ¨ ¢ ¯°®¶¥¤³°¥
Modular-Exponentation, ­® § ®¤­® ¢ ±²°®ª µ 6{7 ¯°®¢¥°¿¥²±¿,
­¥ ­ ²ª­³«¨±¼ «¨ ¬» ­  ­¥²°¨¢¨ «¼­»© ª®°¥­¼ ¨§ 1. ±«¨ ­ ²ª­³«¨±¼, ²® ¯°®¤®«¦ ²¼ ¤ «¼¸¥ ¢»·¨±«¥­¨¥ an;1 mod n ­¥² ±¬»±« ,
¬» ¨ ² ª §­ ¥¬, ·²® ·¨±«® n ±®±² ¢­®¥; ¯°®¶¥¤³°  Witness ¢®§¢° ¹ ¥² §­ ·¥­¨¥ true. ±«¨ ½²®£® ­¥ ¯°®¨§®¸«®, ¢®§¢¥¤¥­¨¥ ¢
±²¥¯¥­¼ § ª ­·¨¢ ¥²±¿ ± °¥§³«¼² ²®¬ d ¨ ¢ ±²°®ª µ 10{11 ¬» ¯°®¢¥°¿¥¬, ° ¢­® «¨ d ¥¤¨­¨¶¥ ¯® ¬®¤³«¾ n. ±«¨ ­¥², ²® ·¨±«® n
² ª¦¥ c®±² ¢­®¥ (¯°®¶¥¤³°  ¢®§¢° ¹ ¥² §­ ·¥­¨¥ true). ±«¨ ­¥²,
²® ¢®§¢° ¹ ¥²±¿ §­ ·¥­¨¥ false (À·¨±«® a ­¥ ¿¢«¿¥²±¿ ±¢¨¤¥²¥«¥¬
²®£®, ·²® n ±®±² ¢­®¥Á).
 ª ª®¬ ±«³· ¥ ¯°®¶¥¤³°  Witness(a; n) ¢®§¢° ¹ ¥² §­ ·¥­¨¥
true?  ¤¢³µ | «¨¡® ¨¬¥¥²±¿ ­¥²°¨¢¨ «¼­»© ª®°¥­¼ ¨§ 1 ¯® ¬®¤³«¾ n, «¨¡® ­¥ ¢»¯®«­¥­  ¬ « ¿ ²¥®°¥¬  ¥°¬  (·¨±«® n ­¥ ¿¢«¿¥²±¿ ¯¢±¥¢¤®¯°®±²»¬ ¯® ®±­®¢ ­¨¾ a).  ®¡®¨µ ±«³· ¿µ ·¨±«® n
¿¢«¿¥²±¿ ±®±² ¢­»¬.
°¨¢¥¤¥¬ ²¥¯¥°¼ ¯®«­®±²¼¾ ¢¥°®¿²­®±²­»©  «£®°¨²¬ ¨««¥° 
|  ¡¨­ .
1 for j \gets 1 to s
2
do a \gets Random(1,n-1)
3
if Witness(a,n)
4
then return ±®±² ¢­®¥
5 return ¯°®±²®¥

§ ¢¥¤®¬®
¯®·²¨ ­ ¢¥°­¿ª 

°®¶¥¤³°  Miller-Rabin ¡¥°¥² s ±«³· ©­»µ ·¨±¥« ®² 1 ¤® n ;
1 ¨ ¯°®¢¥°¿¥², ­¥ ¿¢«¿¥²±¿ «¨ ª ª®¥-²® ¨§ ­¨µ ±¢¨¤¥²¥«¥¬ ²®£®,
·²® n | ±®±² ¢­®¥ (¢ ®¯¨± ­­®¬ ¢»¸¥ ±¬»±«¥). ±«¨ ¿¢«¿¥²±¿, ²®
·¨±«® n § ¢¥¤®¬® ¿¢«¿¥²±¿ ±®±² ¢­»¬, ¨ ®¡ ½²®¬ ¬®¦­® ±®®¡¹¨²¼ ¢
±²°®ª¥ 4. ±«¨ ­¨ ®¤­® ¨§ ¢»¡° ­­»µ ·¨±¥« ­¥ ¿¢«¿¥²±¿ ±¢¨¤¥²¥«¥¬,
²® ¢»¤ ¥²±¿ ®²¢¥² À¯°®±²®¥Á, µ®²¿ £ ° ­²¨¨ ²³² ­¥². (» ®¶¥­¨¬
¤ «¥¥, ­ ±ª®«¼ª® ¢¥°®¿²¥­ ² ª®© ®²¢¥² ¯°¨ ±®±² ¢­®¬ n.)

°®¢¥°ª  ·¨±¥« ­  ¯°®±²®²³

751

«¿ ¯°¨¬¥°  ° ±±¬®²°¨¬ ° ¡®²³ ½²®£®  «£®°¨²¬  ¤«¿ ·¨±«  561
(ª®²®°®¥, ª ª ¬» £®¢®°¨«¨, ¿¢«¿¥²±¿ ·¨±«®¬  °¬ ©ª«  561). «¿
½²®£® ¢¥°­¥¬±¿ ª °¨±. 33.4, ª®²®°»© ±®®²¢¥²±²¢³¥² ¢»·¨±«¥­¨¿¬
¤«¿ a = 7. °¨ ¯®±«¥¤­¥¬ ¢®§¢¥¤¥­¨¨ ¢ ª¢ ¤° ² ¯°®¶¥¤³°  ®¡­ °³¦¨¢ ¥² ­¥²°¨¢¨ «¼­»© ª®°¥­¼ ¨§ 1, ¯®±ª®«¼ª³ 7280  67 (mod 561)
¨ 7560  1 (mod 561). ¥¬ ± ¬»¬ §­ ·¥­¨¥ a = 7 ¿¢«¿¥²±¿ ±¢¨¤¥²¥«¥¬ ²®£®, ·²® ·¨±«® 561 ±®±² ¢­®¥: Witness(7; 561) = true. ±«¨
a = 7 ¢±²°¥²¨²±¿ ±°¥¤¨ s ±«³· ©­»µ §­ ·¥­¨©, ¢»¡° ­­»µ ¢  «£®°¨²¬¥ Miller-Rabin, ²®  «£®°¨²¬ ¢»¤ ±² ®²¢¥² À±®±² ¢­®¥Á.
±«¨ ¤¢®¨·­ ¿ § ¯¨±¼ n ±®¤¥°¦¨²  ¡¨²®¢, ²® ¯°®¶¥¤³° 
Miller-Rabin(s; n) ¢»¯®«­¿¥² O(s )  °¨´¬¥²¨·¥±ª¨µ (¨ O(s 3 )
¡¨²®¢»µ) ®¯¥° ¶¨© (¯°®¨§¢®¤¨²±¿ ­¥ ¡®«¥¥ s ®¯¥° ¶¨© ¢®§¢¥¤¥­¨¿
¢ ±²¥¯¥­¼).
¶¥­ª  ¢¥°®¿²­®±²¨ ®¸¨¡ª¨ ¤«¿ ²¥±²  ¨««¥°  |  ¡¨­ .
®®¡¹ ¿, ·²® ·¨±«® n ¿¢«¿¥²±¿ ¯°®±²»¬, ¯°®¶¥¤³°  MillerRabin (ª ª ¨ Pseudoprime) ¬®¦¥² ®¸¨¡ ²¼±¿. ® ²³² ¥±²¼ ¢ ¦­ ¿
° §­¨¶ . °®¶¥¤³°  Pseudoprime ¤ ¢ «  ­¥¯° ¢¨«¼­»© ®²¢¥² ¤«¿
­¥ª®²®°®© (¯³±²¼ ­¥¡®«¼¸®©) ¤®«¨ ¢±¥µ ·¨±¥« | ² ª¨¥ ·¨±«  ¬®¦­® ­ §¢ ²¼ À¯«®µ¨¬¨Á ± ²®·ª¨ §°¥­¨¿ ½²®© ¯°®¶¥¤³°». «¿ ²¥±² 
¨««¥°  |  ¡¨­  ¯«®µ¨µ ·¨±¥« ­¥²: ¤«¿ «¾¡®£® ·¨±«  ²¥±² ¤ ¥²
¯° ¢¨«¼­»© ®²¢¥² ± ¡®«¼¸®© ¢¥°®¿²­®±²¼¾. «®µ¨¬ ¬®¦¥² ¡»²¼
«¨¸¼ ±«³· ©­»© ¢»¡®° ¯°®¡­»µ ±¢¨¤¥²¥«¥©, ¨ ¢¥°®¿²­®±²¼ ½²®£®
±®¡»²¨¿ ¬ « .
 ª ¬» ±¥©· ± ¤®ª ¦¥¬, ¤«¿ «¾¡®£® ±®±² ¢­®£® ·¨±«  n ­¥ ¬¥­¥¥
¯®«®¢¨­» ¢±¥µ ¢®§¬®¦­»µ §­ ·¥­¨© a ¯®§¢®«¿² ³±² ­®¢¨²¼, ·²® n
±®±² ¢­®¥ | ² ª ·²® ¢¥°®¿²­®±²¼ ®¤­®ª° ²­®£® ­¥³¤ ·­®£® ¢»¡®°¯  ±¢¨¤¥²¥«¿ ­¥ ¯°¥¢»¸ ¥² 1=2,   ¯°¨ s-ª° ²­®¬ ¯®¢²®°¥­¨¨
¯ ¤ ¥² ¤® 2;s .
¥®°¥¬  33.38
³±²¼ n | ­¥·¥²­®¥ ±®±² ¢­®¥ ·¨±«®. ®£¤  ±°¥¤¨ ½«¥¬¥­²®¢ Z+n
­¥ ¬¥­¥¥ (n ; 1)=2 ¿¢«¿¾²±¿ ±¢¨¤¥²¥«¿¬¨ ²®£®, ·²® n ±®±² ¢­®¥, ²®
¥±²¼


fa 2 Z+ : Witness(a; n) = true > (n ; 1)=2:
n
®ª § ²¥«¼±²¢®
³±²¼ ´¨ª±¨°®¢ ­® ­ ·¥²­®¥ ±®±² ¢­®¥ ·¨±«® n. ³¤¥¬ ­ §»¢ ²¼
½«¥¬¥­²» a 2 Z+n , ¤«¿ ª®²®°»µ Witness(a; n) = false, ¯«®µ¨¬¨.
» µ®²¨¬ ¯®ª § ²¼, ·²® ·¨±«® ¯«®µ¨µ ½«¥¬¥­²®¢ ­¥ ¯°¥¢®±µ®¤¨²
(n ; 1)=2.
 ¬¥²¨¬, ·²® ¢±¥ ­¥£®¤­»¥ ½«¥¬¥­²» «¥¦ ² ¢ Zn.  ± ¬®¬ ¤¥«¥,
¤«¿ ¯«®µ®£® a ¢»¯®«­¥­® ° ¢¥­±²¢® an;1  1 (mod n), ¨ ¯®²®¬³
an;1 ¨ ± ¬® a ¢§ ¨¬­® ¯°®±²» ± n.
¥¯¥°¼ ¬» ¯®ª ¦¥¬, ·²® ¢±¥ ¯«®µ¨¥ ½«¥¬¥­²» ±®¤¥°¦ ²±¿ ¢ ­¥ª®²®°®© ±®¡±²¢¥­­®© ¯®¤£°³¯¯¥ B £°³¯¯» Zn. ® ±«¥¤±²¢¨¾ 33.16
·¨±«® ½«¥¬¥­²®¢ ¢ B ­¥ ¡®«¼¸¥ ¯®«®¢¨­» ®¡¹¥£® ·¨±«  ½¤¥¬¥­²®¢ ¢
n, ®²ª³¤  ¨ ±«¥¤³¥² ¤®ª §»¢ ¥¬®¥ ³²¢¥°¦¤¥­¨¥. ±² ¥²±¿ ­ ©²¨
Z

752

« ¢  33 ¥®p¥²¨ª®-·¨±«®¢»¥  «£®p¨²¬»

±®¡±²¢¥­­³¾ ¯®¤£°³¯¯³ B , ±®¤¥°¦ ¹³¾ ¢±¥ ¯«®µ¨¥ ½«¥¬¥­²».
«³· © 1: ³¹¥±²¢³¥² x 2 Zn, ¤«¿ ª®²®°®£®
xn;1 6 1 (mod n):
(33:43)
®£¤  ¯®«®¦¨¬ B ° ¢­»¬ fb 2 Zn : bn;1  1 (mod n)g. ­®¦¥±²¢®
B § ¬ª­³²® ®²­®±¨²¥«¼­® ®¯¥° ¶¨¨ n , ¯®½²®¬³ ¯® ²¥®°¥¬¥ 33.14
®­® ¿¢«¿¥²±¿ ¯®¤£°³¯¯®© £°³¯¯» Zn. ·¥¢¨¤­®, ¢±¥ ¯«®µ¨¥ ½«¥¬¥­²» «¥¦ ² ¢ B ¨ ¯® ¯°¥¤¯®«®¦¥­¨¾ £°³¯¯  B ¿¢«¿¥²±¿ ±®¡±²¢¥­­®©
¯®¤°³£®®© | ² ª ·²® ¢ ½²®¬ ±«³· ¥ ¢±¥ ¤®ª § ­®.
«³· © 2: «¿ ¢±¿ª®£® x 2 Zn
xn;1  1 (mod n)
(33:44)
(n ¿¢«¿¥²±¿ ·¨±«®¬  °¬ ©ª« ).
²®² ±«³· © ­¥±ª®«¼ª® ¡®«¥¥ ±«®¦¥­. ®ª ¦¥¬ ¯°¥¦¤¥ ¢±¥£®, ·²®
n ­¥ ¬®¦¥² ¡»²¼ ±²¥¯¥­¼¾ ¯°®±²®£® ·¨±« . ³±²¼ ½²® ­¥ ² ª ¨ n =
pe ¤«¿ ­¥·¥²­®£® ¯°®±²®£® p ¨ ¤«¿ ¶¥«®£® e > 1. ®£¤  ¯® ²¥®°¥¬¥
33.32 £°³¯¯  Zn ¿¢«¿¥²±¿ ¶¨ª«¨·¥±ª®©, ²® ¥±²¼ ±®¤¥°¦¨² ½«¥¬¥­²
g, ¤«¿ ª®²®°®£® ordn(g ) = jZnj = '(n) = (p ; 1)pe;1 . ® ²¥®°¥¬¥
33.33 ¨§ ±° ¢­¥­¨¿ (33.44) ±«¥¤³¥², ·²® n ; 1  0 (mod '(n)), ­® ½²®
­¥¢®§¬®¦­®, ² ª ª ª ¯° ¢ ¿ · ±²¼ ¤¥«¨²±¿ ­  p (¨ ¤ ¦¥ ­  pe;1 ,  
«¥¢ ¿ ­  ¥¤¨­¨¶³ ¬¥­¼¸¥ ·¨±«  n, ¤¥«¿¹¥£®±¿ ­  p.
² ª, n ¿¢«¿¥²±¿ ±®±² ¢­»¬ ·¨±«®¬, ª®²®°®¥ ­¥ ¥±²¼ ±²¥¯¥­¼ ­¨ª ª®£® ¯°®±²®£® ·¨±« , ¨ ¯®²®¬³ ±®¤¥°¦¨² ­¥±ª®«¼ª® ° §­»µ ¯°®±²»µ ¬­®¦¨²¥«¥©. ®½²®¬³ ¬» ¬®¦¥¬ ° §«®¦¨²¼ n ¢ ¯°®¨§¢¥¤¥­¨¥
¤¢³µ ¢§ ¨¬­® ¯°®±²»µ ·¨±¥« n1 ; n2 > 1 (­ ¯°¨¬¥°, ¢ª«¾·¨¢ ¢ n1
®¤¨­ ¯°®±²®© ¬­®¦¨²¥«¼,   ¢ n2 | ¢±¥ ®±² «¼­»¥).
¨±«® n ; 1 ·¥²­®. »¤¥«¨¬ ¨§ ­¥£® ­ ¨¡®«¼¸³¾ ±²¥¯¥­¼ ¤¢®©ª¨
t
2 , ²® ¥±²¼ § ¯¨¸¥¬ ¥£® ¢ ¢¨¤¥ n ; 1 = 2t u, £¤¥ u ­¥·¥²­®. «¿
ª ¦¤®£® a 2 Z+n ° ±±¬®²°¨¬ ¯®±«¥¤®¢ ²¥«¼­®±²¼

a^ = hau; a2u; a2 u ; : : : ; a2tu i:
(33:45)
±®±²®¿¹³¾ ¨§ ¢»·¥²®¢ ¯® ¬®¤³«¾ n; ª ¦¤»© ±«¥¤³¾¹¨© ¥¥ ½«¥2

¬¥­² ¯®«³· ¥²±¿ ¨§ ¯°¥¤»¤³¹¥£® ¢®§¢¥¤¥­¨¥¬ ¢ ª¢ ¤° ²,   ¯®±«¥¤­¨© ½«¥¬¥­² ¥±²¼ an;1 .  ¬¥²¨¬, ·²® ¤¢®¨·­ ¿ § ¯¨±¼ ·¨±«  n ; 1
®ª ­·¨¢ ¥²±¿ ­  n ­³«¥©. ¨ ¯®²®¬³ ¢±¥ ½«¥¬¥­²» ½²®© ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¢±²°¥²¿²±¿ ¢ ª ·¥±²¢¥ ¯°®¬¥¦³²®·­»µ °¥§³«¼² ²®¢ ¯°¨
¢»·¨±«¥­¨¿µ ¢ ¯°®¶¥¤³°¥ Witness (ª®²®°»¥ § ª ­·¨¢ ¾²±¿ t ¢®§¢¥¤¥­¨¿¬¨ ¢ ª¢ ¤° ²).
 ª®© ¢¨¤ ¬®¦¥² ¨¬¥²¼ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ^a ¯°¨ ° §«¨·­»µ
a? «¿ ª ¦¤®£® j = 0; 1; : : : ; t ¯®±¬®²°¨¬, ª ª¨¥ ·«¥­» ¬®£³² ¯®¿¢«¿²¼±¿ ­  j -®¬ ¬¥±²¥ ¢ ¯®±«¥¤®¢ ²¥«¼­®±²¨ a (¤«¿ ³¤®¡±²¢  ­ ·¨­ ¥¬ ­³¬¥° ¶¨¾ ± ­³«¿, ±·¨² ¿ au ­³«¥¢»¬ ·«¥­®¬ ¯®±«¥¤®¢ ²¥«¼­®±²¨ a^). ®±«¥¤­¨¬ ·«¥­®¬ (j = t) ¬®¦¥² ¡»²¼ ²®«¼ª® ¥¤¨­¨¶ 
(¨­ ·¥ ¬» ¨¬¥«¨ ¡» ³¦¥ ° ±±¬®²°¥­­»© ±«³· © 1).  ¤°³£®© ±²®°®­», ¢ ­ · «¥ ¯®±«¥¤®¢ ²¥«¼­®±²¨ a^ (²® ¥±²¼ ¤«¿ j = 0) ¬®¦¥²

°®¢¥°ª  ·¨±¥« ­  ¯°®±²®²³

753

±²®¿²¼ ­¥ ²®«¼ª® 1, ­® ¨ ;1 (¯°¨ a = ;1 ¨¬¥¥¬ au = ;1, ² ª ª ª u
­¥·¥²­®),   ² ª¦¥, ¢®§¬®¦­®, ¨ ¤°³£¨¥ ·¨±« .
 ±±¬®²°¨¬ ­ ¨¡®«¼¸¥¥ §­ ·¥­¨¥ j 2 f0; 1; : : : ; tg, ¤«¿ ª®²®°®£®
±³¹¥±²¢³¥² ² ª®© ½«¥¬¥­² v 2 Zn, ·²® v 2y u  ;1 (mod n). (°¨
j = 0, ª ª ¬» ¢¨¤¥«¨, ² ª®© ½«¥¬¥­²
v ­ ©¤¥²±¿.) ³±²¼ v 2 Zn |
ju
2
®¤¨­ ¨§ ²¢ª¨µ ½«¥¬¥­²®¢, ²® ¥±²¼ v  ;1 (mod n). (²®² ½«¥¬¥­²
¯°¨£®¤¨²±¿ ­ ¬ ·³²¼ ¯®§¦¥.)
®«®¦¨¬
B = fx 2 Zn : x2j u  1 (mod n)g:
®±ª®«¼ª³ B § ¬ª­³²® ®²­®±¨²¥«¼­® ³¬­®¦¥­¨¿ ¯® ¬®¤³«¾ n, ®­®
¿¢«¿¥²±¿ ¯®¤£°³¯¯®© £°³¯¯» Zn.
®ª ¦¥¬, ·²® «¾¡®© ¯«®µ®© ½«¥¬¥­² a ¯°¨­ ¤«¥¦¨² B . ®±¬®²°¨¬ ­  ¯®±«¥¤®¢ ²¥«¼­®±²¼ a^, ¯®°®¦¤¥­­³¾ ¯«®µ¨¬ ½«¥¬¥­²®¬,
¨ ¤¢¨£ ¿±¼ ±¯° ¢  ­ «¥¢®.   ¥¥ ¯®±«¥¤­¥¬ ¬¥±²¥ ±²®¨² ¥¤¨­¨¶ .
¥°¥¤ ¥¤¨­¨¶¥© ¬®¦¥² ±²®¿²¼ «¨¡® ¥¹¥ ®¤­  ¥¤¨­¨¶ , «¨¡® ·¨±«®
;1 (¨­ ·¥ ¡»« ¡» ®¡­ °³¦¥­ ­¥²°¨¢¨ «¼­»© ª®°¥­¼ ¨§ ¥¤¨­¨¶» ¨
½«¥¬¥­² a ­¥ ¡»« ¡» ¯«®µ¨¬). °¨ ½²®¬ ·¨±«® ;1 ¬®¦¥² ¯®¿¢¨²¼±¿
«¨¸¼ ¢ ¯®§¨¶¨¨ j ¨«¨ «¥¢¥¥ (² ª ª ª j ¡»«® ¢»¡° ­® ¬ ª±¨¬ «¼­»¬). ­ ·¨², ¢ j -®© ¯®§¨¶¨¨ ­ µ®¤¨²±¿ «¨¡® 1, «¨¡® ;1, ²® ¥±²¼
a 2 B.
¥¯¥°¼ ¬» ¢®±¯®«¼§³¥¬±¿ ±³¹¥±²¢®¢ ­¨¥¬ ½«¥¬¥­²  v , ·²®¡» ¯®ª § ²¼, ·²® B ¿¢«¿¥²±¿ ±®¡±²¢¥­­®©
¯®¤£°³¯¯®©, ¯®±²°®¨¢ w 2
ju

2
Z
 ;1 (mod n) ±«¥¤³¥², ·²®
n n B . ® ±«¥¤±²¢¨¾ 33.29 ¨§ v
v2j u  ;1 (mod n1 ). ® ±«¥¤±²¢¨¾ 33.28 ­ ©¤¥²±¿ ½«¥¬¥­² w, ¤«¿
ª®²®°®£® ®¤­®¢°¥¬¥­­® ¢»¯®«­¥­» ³±«®¢¨¿

w  v (mod n1);
w  1 (mod n2 ):
®£¤ 

w2jj u  ;1
w2 u  1

®²ª³¤  ¢¨¤­® (±«¥¤±²¢¨¥ 33.29), ·²®

(mod n1 );
(mod n2 );

w2j u 6 1 (mod n);

(33:46)

§ ¤¢³µ ¯®±«¥¤­¨µ ±° ¢­¥­¨© ¯® ¬®¤³«¿¬ n1 ¨ n2 ¢¨¤­®, ·²® w
¢§ ¨¬­® ¯°®±²® ± n1 ¨ ± n2 ¨ ²¥¬ ± ¬»¬ ¢§ ¨¬­® ¯°®±²® ± n. «¥¤®¢ ²¥«¼­®, w ¯°¨­ ¤«¥¦¨² Zn n B , ·²® § ¢¥°¸ ¥² ¤®ª § ²¥«¼±²¢®
²¥®°¥¬» | ¬» ³±² ­®¢¨«¨, ·²® ¢±¥ ¯«®µ¨¥ ½«¥¬¥­²» ¯°¨­ ¤«¥¦ ²
±®¡±²¢¥­­®© ¯®¤£°³¯¯¥, ¨ ¯®²®¬³ ¨µ ·¨±«® ­¥ ¯°¥¢®±µ®¤¨² (n;1)=2.
¥®°¥¬  33.39
«¿ ­¥·¥²­®£® n > 2 ­¥·¥²­® ¨ ¤«¿ «¾¡®£® ¶¥«®£® ¯®«®¦¨²¥«¼­®£® s ¢¥°®¿²­®±²¼ ®¸¨¡ª¨ ¯°®¶¥¤³°» Miller-Rabin (n; s) ­¥ ¯°¥¢®±µ®¤¨² 2;s .

754

« ¢  33 ¥®p¥²¨ª®-·¨±«®¢»¥  «£®p¨²¬»

®ª § ²¥«¼±²¢®
«¿ ¯°®±²®£® n ¢®®¡¹¥ ­¥ ¬®¦¥² ¡»²¼ ®¸¨¡ª¨. ±«¨ ¦¥ n ±®±² ¢­®¥, ²® ¯® ²¥®°¥¬¥ 33.38 ¯°¨ ª ¦¤®¬ ±«³· ©­®¬ ¢»¡®°¥ a ¢
±²°®ª¥ 2 ¬» ± ¢¥°®¿²­®±²¼¾ 1=2 ¨«¨ ¡®«¥¥ ®¡­ °³¦¨¬ ±¢¨¤¥²¥«¿
²®£®, ·²® n ±®±² ¢­®¥. ®½²®¬³ ¢¥°®¿²­®±²¼ ²®£®, ·²® ½²®£® ­¥
¯°®¨§®©¤¥² ¯°¨ s (­¥§ ¢¨±¨¬»µ) ¯®¯»²ª µ, ­¥ ¯°¥¢®±µ®¤¨² 2;s .
§¿¢, ­ ¯°¨¬¥°, s = 50, ¬» ¯®«³·¨¬ ¢¥°®¿²­®±²¼ ®¸¨¡ª¨ 2;50.
 ª¨¬¨ ¬ «»¬¨ ¢¥°®¿²­®±²¿¬¨ ­  ¯° ª²¨ª¥ ®¡»·­® ¯°¥­¥¡°¥£ ¾². ±«¨ ¯°¨¬¥­¿²¼ ²¥±² ª ±«³· ©­® ¢»¡° ­­®¬³ ·¨±«³, ²® ¢¥°®¿²­®±²¼ ®¸¨¡ª¨ ¡³¤¥² ¥¹¥ ¬¥­¼¸¥. ¥«® ¢ ²®¬, ·²® ­ ¸  ®¶¥­ª  (±¢¨¤¥²¥«¥© ­¥ ¬¥­¼¸¥ ¯®«®¢¨­») ¤«¿ ¡®«¼¸¨­±²¢  n ¢¥°­  ± ¡®«¼¸¨¬
§ ¯ ±®¬. «¿ ¡®«¼¸¨­±²¢  n ª®«¨·¥±²¢® ¯«®µ¨µ §­ ·¥­¨© a ®¡»·­®
§­ ·¨²¥«¼­® ¬¥­¼¸¥ (n ; 1)=2, ¨ ­  ¯° ª²¨ª¥ ¬®¦­® ®£° ­¨·¨²¼±¿,
±ª ¦¥¬, ²°¥¬¿ ¯®¯»²ª ¬¨ (s = 3) ± ¤®±² ²®·­® ¬ «®© ¢¥°®¿²­®±²¼¾ ®¸¨¡¨²¼±¿. ¤­ ª® ¥±«¨ n ­¥ ¢»¡¨° ¥²±¿ ±«³· ©­»¬ ®¡° §®¬,
  ¤ ¥²±¿ ­ ¬ ¨§¢­¥, ²® §­ ·¨²¥«¼­® ³«³·¸¨²¼ ®¶¥­ª³ (n ; 1)=2 ¤«¿
·¨±«  ¯«®µ¨µ ½«¥¬¥­²®¢ ­¥«¼§¿ (µ®²¿ ­¥¬­®£® ¬®¦­®: ·¨±«® ¯«®µ¨µ
½«¥¬¥­²®¢, ª ª ¬®¦­® ¤®ª § ²¼, ­¥ ¯°¥¢®±µ®¤¨² (n ; 1)=4 | ¨ ½² 
®¶¥­ª  ³¦¥ ­¥³«³·¸ ¥¬ ).
¯° ¦­¥­¨¿
33.8-1
®ª ¦¨²¥, ·²® ¥±«¨ ¶¥«®¥ ·¨±«® n ­¥ ¿¢«¿¥²±¿ ¯°®±²»¬ ¨ ­¥ ¿¢«¿¥²±¿ ±²¥¯¥­¼¾ ¯°®±²®£® ·¨±« , ²® ¢ Zn ±³¹¥±²¢³¥² ­¥²°¨¢¨ «¼­»©
ª®°¥­¼ ¨§ 1.
33.8-2*
®¦­® ­¥±ª®«¼ª® ³±¨«¨²¼ ²¥®°¥¬³ ©«¥° , ¯®ª § ¢, ·²®

a(n)  1 (mod n);
¤«¿ ¢±¥µ a, ¥±«¨ (n) ®¯°¥¤¥«¨²¼ ´®°¬³«®©

(n) = lcm('(pe1 ); : : : ; '(perr ):
(33:47)
(¯°¨ n = pe1 : : :perr ). ®ª ¦¨²¥, ·²® (n) j '(n). ®ª ¦¨²¥, ·²® ±®±² ¢­®¥ ·¨±«® n ¿¢«¿¥²±¿ ·¨±«®¬  °¬ ©ª«  ²®£¤  ¨ ²®«¼ª® ²®£¤ ,
ª®£¤  (n) j n ; 1.  ¯°¨¬¥°, ¤«¿ ·¨±«  561 = 3  11  17 (­ ¨¬¥­¼¸¥¥ ·¨±«®  °¬ ©ª« ) ¨¬ ¨¬¥¥¬ (n) = lcm(2; 10; 16) = 80 j 560.
1

1

®ª ¦¨²¥, ·²® ¢±¿ª®¥ ·¨±«®  °¬ ©ª«  À±¢®¡®¤­® ®² ª¢ ¤° ²®¢Á
(­¥ ¤¥«¨²±¿ ­  ª¢ ¤° ² ­¨ª ª®£® ¯°®±²®£® ·¨±« ) ¨ ¨¬¥¥² ¯® ¬¥­¼¸¥© ¬¥°¥ 3 ¯°®±²»µ ¤¥«¨²¥«¿. (²® ®¤­  ¨§ ¯°¨·¨­, ¯®·¥¬³ ·¨±« 
 °¬ ©ª«  °¥¤ª¨.)
33.8-3
³±²¼ x ¿¢«¿¥²±¿ ­¥²°¨¢¨ «¼­»¬ ª®°­¥¬ ¨§ 1 ¯® ¬®¤³«¾ n. ®ª ¦¨²¥, ·²® gcd(x ; 1; n) ¨ gcd(x + 1; n) ¿¢«¿¾²±¿ ­¥²°¨¢¨ «¼­»¬¨
(®²«¨·­»¬¨ ®² 1 ¨ ®² n) ¤¥«¨²¥«¿¬¨ ·¨±«  n.
*33.9  §«®¦¥­¨¥ ·¨±¥« ­  ¬­®¦¨²¥«¨.

°®¢¥°ª  ·¨±¥« ­  ¯°®±²®²³

755

³±²¼ ­ ¬ ¤ ­® ·¨±«® n, ª®²®°®¥ ­ ¤® ° §«®¦¨²¼ ­  ¬­®¦¨²¥«¨ (to factor it), ²® ¥±²¼ ¯°¥¤±² ¢¨²¼ ¢ ¢¨¤¥ ¯°®¨§¢¥¤¥­¨¿ ¯°®±²»µ ·¨±¥«. ¥±² ¨§ ¯°¥¤»¤³¹¥£® ° §¤¥«  ¯®§¢®«¿¥² ³±² ­®¢¨²¼,
·²® n ±®±² ¢­®¥, ­® ­¨·¥£® ­¥ £®¢®°¨² ®¡ ¥£® ¬­®¦¨²¥«¿µ. ²® ­¥
±«³· ©­® | ­ ±ª®«¼ª® ¬» ¬®¦¥¬ ±³¤¨²¼ ±¥£®¤­¿, ° §«®¦¥­¨¥ ­ 
¬­®¦¨²¥«¨ §­ ·¨²¥«¼­® ±«®¦­¥¥ ¯°®¢¥°ª¨ ¯°®±²®²».  ¦¥ ­ ¨¡®«¥¥ ¬®¹­»¥ ±®¢°¥¬¥­­»¥ ±³¯¥°ª®¬¯¼¾²¥°», ¨±¯®«¼§³¾¹¨¥ ­ ¨¡®«¥¥ ±®¢¥°¸¥­­»¥ (¨§ ¨§¢¥±²­»µ ­  ±¥£®¤­¿¸­¨© ¤¥­¼)  «£®°¨²¬»,
­¥ ±¯®±®¡­» §  ° §³¬­®¥ ¢°¥¬¿ ° §«®¦¨²¼ ­  ¬­®¦¨²¥«¨ ­ ³£ ¤
¢§¿²®¥ 200-§­ ·­®¥ ·¨±«®.
;½¢°¨±²¨ª  ®«« °¤ .
¥°¥¡¨° ¿ ¢±¥ ·¨±«  ®² 1 ¤® B ¢ ª ·¥±²¢¥ ¢®§¬®¦­»µ ¤¥«¨²¥«¥© § ¤ ­­®£® ·¨±«  n, ¬» ±¬®¦¥¬ ° §«®¦¨²¼ ­  ¬­®¦¨²¥«¨ «¾¡®¥ ·¨±«® ¢¯«®²¼ ¤® B 2 . ¥©· ± ¬» ®¯¨¸¥¬  «£®°¨²¬, ª®²®°»©
¤¥« ¥² ¯°¨¬¥°­® ±²®«¼ª® ¦¥ ¤¥©±²¢¨© ¨ ¯®§¢®«¿¥² ° ±ª« ¤»¢ ²¼
­  ¬­®¦¨²¥«¨ ·¨±«  ¯®°¿¤ª  B 4 (¢ ¡®«¼¸¨­±²¢¥ ±«³· ¥¢).  ±®¦ «¥­¨¾, ­¥«¼§¿ £ ° ­²¨°®¢ ²¼, ·²® ®­ ¢»¤ ±² ®²¢¥² ¤®±² ²®·­®
¡»±²°®; ­¥«¼§¿ £ ° ­²¨°®¢ ²¼ ¤ ¦¥ ²®£®, ·²® ¢®®¡¹¥ ° §«®¦¥­¨¥
¡³¤¥² ­ ©¤¥­®. ¤­ ª® ­  ¯° ª²¨ª¥ ½²®²  «£®°¨²¬ § °¥ª®¬¥­¤®¢ «
±¥¡¿ ­¥¯«®µ®.
Pollard-Rho(n)
1 i \gets 1
2 x_i \gets Random (0,n-1)
3 y \gets x_i
4 k \gets 2
5 while true
6
do i \gets i+1
7
x_i \gets (x_{i-1}^2 - 1) \bmod n
8
d \gets \HO(y-x_i,n)
9
if d \ne 1 ¨ d \ne n
10
then print d
11
if i=k
12
then y \gets x_i
13
k \gets 2k

²  ¯°®¶¥¤³¢  ®±­®¢ ­  ­  °¥ª³°°¥­²­®¬ ±®®²­®¸¥­¨¨

xi = (x2i;1 ; 1) mod n

(33:48)

¨ ¢»·¨±«¿¥² ®¤¨­ §  ¤°³£¨¬ ·«¥­» ±®®²¢¥²±²¢³¾¹¥© ¯®±«¥¤®¢ ²¥«¼­®±²¨
x1 ; x2; x3; x4; : : : :
(33:49)
(±²°®ª  7); ¯¥°¥¬¥­­ ¿ i ³ª §»¢ ¥² ­®¬¥° ·«¥­ , ­ ·¨­ ¿ ± 1¦ ¯¥°¢»© ·«¥­ x1 ¢»¡¨° ¥²±¿ ±«³· ©­® (±²°®ª¨ 1{2). (  ± ¬®¬ ¤¥«¥ ¢
ª ¦¤»© ¬®¬¥­² µ° ­¨²±¿ ²®«¼ª® ®¤¨­ ·«¥­ ¯®±«¥¤®¢ ²¥«¼­®±²¨,

756

« ¢  33 ¥®p¥²¨ª®-·¨±«®¢»¥  «£®p¨²¬»

33.7 ;½¢°¨±²¨ª  ®«« °¤ . (a) ®±«¥¤®¢ ²¥«¼­®±²¼ xi+1 = (x2i ;
1) mod 1387 ± ­ · «¼­»¬ ½«¥¬¥­²®¬ x1 = 2. ( §«®¦¥­¨¥: 1387 = 19  73.) ¨°­»¥ ±²°¥«ª¨ ±®®²¢¥²±²¢³¾² ¸ £ ¬ ¶¨ª« , ¢»¯®«­¿¥¬»¬ ¤® ­ µ®¦¤¥­¨¿ ¤¥«¨²¥«¿ 19. (®±«¥ ½²®£® ¢»¯®«­¥­¨¥ ¯°®¶¥¤³°» ¯°¥ª° ¹ ¥²±¿ | ­® ­  °¨±³­ª¥
¯®ª § ­ ¢¥±¼ -¶¨ª«.) ¥°»¬ ¶¢¥²®¬ ¯®ª § ­» ¯®±«¥¤®¢ ²¥«¼­»¥ §­ ·¥­¨¿ ¯¥°¥¬¥­­®© y. ¥«¨²¥«¼ 19 ®¡­ °³¦¨¢ ¥²±¿ ¯°¨ ±° ¢­¥­¨¨ y = 63 ± x7 = 177:
 (63 ; 177; 1387) = 19. (b)   ¦¥ ± ¬ ¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¯® ¬®¤³«¾ 19.
® ½²®¬³ ¬®¤³«¾ ³¯®¬¿­³²»¥ ¢»¸¥ ·¨±«  x7 = 177 ¨ y = 63 ±° ¢­¨¬». (c)  
¦¥ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¯® ¬®¤³«¾ 73
¨±. 33.7

² ª ·²® ¬®¦­® ®¯³±²¨²¼ ¨­¤¥ª± i ¨ ¨±¯®«¼§®¢ ²¼ ®¤­³ ¯¥°¥¬¥­­³¾
x ¤«¿ µ° ­¥­¨¿ ²¥ª³¹¥£® ·«¥­  ¯®±«¥¤®¢ ²¥«¼­®±²¨).
¥°¥¬¥­­ ¿ k ¯®±«¥¤®¢ ²¥«¼­® ¯°¨­¨¬ ¥² §­ ·¥­¨¿ 2; 4; 8; : : :
(±²°®ª¨ 4 ¨ 13), ª®£¤  §­ ·¥­¨¥ i ¤®µ®¤¨² ¤® ²¥ª³¹¥£® §­ ·¥­¨¿
k, §­ ·¥­¨¥ xi § ¯®¬¨­ ¥²±¿ ¢ ¯¥°¥¬¥­­®© y ,   ¯¥°¥¬¥­­ ¿ k ³¢¥«¨·¨¢ ¥²±¿ ¢¤¢®¥.  ª¨¬ ®¡° §®¬, y ¯®±«¥¤®¢ ²¥«¼­® ¯°¨­¨¬ ¥²
§­ ·¥­¨¿ x1; x2; x4; x8; : : :
 ±²°®ª µ 8{10 ¬» ¯»² ¥¬±¿ ­ ©²¨ ¤¥«¨²¥«¼ ·¨±«  n, ¨±¯®«¼§³¿ ¤¢  ·«¥­  ¯®±«¥¤®¢ ²¥«¼­®±²¨ | ²¥ª³¹¥¥ §­ ·¥­¨¥ xi ¨ ±®µ° ­¥­­®¥ §­ ·¥­¨¥ y . ²  ¯®¯»²ª  ³¤ ·­ , ¥±«¨ ·¨±«® d = gcd(y ;
xi ; n) ®²«¨·­® ®² 1 ¨ ®² n (¯°®¢¥°ª  ¢»¯®«­¿¥²±¿ ¢ ±²°®ª¥ 9).

²¨ ¤¥©±²¢¨¿ ­  ¯¥°¢»© ¢§£«¿¤ ¢»£«¿¤¿² ±²° ­­®, ­® ¯® ª° ©­¥©
¬¥°¥ «¥£ª® ¢¨¤¥²¼, ·²® ¯°®¶¥¤³°  Pollard-Rho ­¨ª®£¤  ­¥ ¢»¤ ¥² ­¥¯° ¢¨«¼­»µ ®²¢¥²®¢: ³¦ ¥±«¨ ®­  ·¥£® ­ ¯¥· ² « , §­ ·¨²,
½²® ­¥²°¨¢¨ «¼­»© ¤¥«¨²¥«¼ n. ®¯°®± ²®«¼ª® ¢ ²®¬, ­ ¯¥· ² ¥²
«¨ ®­  µ®²¼ ·²®-²®. ¥©· ± ¬» ¯°¨¢¥¤¥¬ ­¥ª®²®°»¥ ­¥´®°¬ «¼­»¥
 °£³¬¥­²» ¢ ¯®«¼§³ ²®£®, ·²® ¥±«¨ ·¨±«® n ¨¬¥¥²
­¥²°¨¢¨ «¼­»©
p
¤¥«¨²¥«¼ s, ²® ¥±²¼ ¸ ­±» ­ ©²¨ ¥£® ¯®±«¥ s ¯°®µ®¤®¢. ( ¯®¬­¨¬,
±®±² ¢­®£® ·¨±«  n ¥±²¼ ¤¥«¨²¥«¼, ­¥ ¯°¥¢®±µ®¤¿¹¨©
pn, ² ª·²®·²®³ ®¦¨¤ ¥¬®¥
p
·¨±«® ¨²¥° ¶¨© ¬®¦­® ®¶¥­¨²¼ ª ª n.
®² ®¡¥¹ ­­»¥ ­¥´®°¬ «¼­»¥  °£³¬¥­²». «¿ ­ · «  § ¬¥²¨¬,
·²® ¯®±«¥¤®¢ ²¥«¼­®±²¼ (33.49), ­ ·¨­ ¿ ± ª ª®£®-²® ¬¥±² , ±² ­®¢¨²±¿ ¯¥°¨®¤¨·¥±ª®©. ( ± ¬®¬ ¤¥«¥, ¢®§¬®¦­®±²¥© ª®­¥·­®¥ ·¨±«®, ² ª ·²® ¤®«¦­® ¢±²°¥²¨²¼±¿ ¯®¢²®°¥­¨¥,   ¤ «¼¸¥ ³¦¥ ¢±¥
¯®©¤¥² ¯® ¶¨ª«³, ² ª ª ª ±«¥¤³¾¹¨© ·«¥­ ¯®±«¥¤®¢ ²¥«¼­®±²¨ § ¢¨±¨² ²®«¼ª® ®² ¯°¥¤»¤³¹¥£®.)
®½²®¬³ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¬®¦­® ¨§®¡° §¨²¼ ¢ ¢¨¤¥ ®ª°³¦­®±²¨ ± µ¢®±²¨ª®¬ (°¨±. 33.7): ®ª°³¦­®±²¼ ±®®²¢¥²±²¢³¥² ¯¥°¨®¤¨·¥±ª®© · ±²¨ ¯®±«¥¤®¢ ²¥«¼­®±²¨,   µ¢®±²¨ª | ¤®¯¥°¨®¤¨·¥±ª®©.
(²  ª °²¨­ª  ­ ¯®¬¨­ ¥² £°¥·¥±ª³¾ ¡³ª¢³ , ¯®½²®¬³ ¬¥²®¤ ¨
­ §»¢ ¥²±¿ -½¢°¨±²¨ª®©.)
²® ¬®¦­® ±ª § ²¼ ® ¤«¨­¥ ¯¥°¨®¤  ¤«¿ ±«³· ©­® ¢»¡° ­­®£®
x1 ? ¥ª®²®° ¿ (¯³±²¼ ¨ ¡¥§®±­®¢ ²¥«¼­ ¿) ®¶¥­ª  ¬®¦¥² ¡»²¼ ¯®«³·¥­  ² ª. °¥¤±² ¢¨¬ ±¥¡¥, ·²® ª ¦¤®¥ xi ¢»¡¨° ¥²±¿ ±«³· ©­®
¨ ­¥ § ¢¨±¨² ®² ¯°¥¤»¤³¹¨µ; ±ª®«¼ª® ¸ £®¢ ¯°®©¤¥² ¤® ¯¥°¢®£®
¯®¢²®°¥­¨¿? (®­¥·­®, ¯°¥¤¯®«®¦¥­¨¥ ® ±«³· ©­®±²¨ xi  ¡±³°¤­®
4

°®¢¥°ª  ·¨±¥« ­  ¯°®±²®²³

757

| ª ¦¤»© ½«¥¬¥­² ¥±²¼ ´³­ª¶¨¿ ¯°¥¤»¤³¹¥£® | ­® ¯°¥®¡° §®¢ ­¨¥ x 7! x2 ; 1 ¤®±² ²®·­® ±«®¦­®, ¨ ± ¡®«¼¸®© ­ ²¿¦ª®© ¥£®
¬®¦­® ³¯®¤®¡¨²¼ ±«³· ©­®¬³ ¯¥°¥¬¥¸¨¢ ­¨¾.)
² ª, ±ª®«¼ª® ¸ £®¢ ¯°®©¤¥² ¤® ¯¥°¢®£® ¯®¢²®°¥­¨¿? ²³ § ¤ ·³ ¬» ³¦¥ ° ±±¬ ²°¨¢ «¨ ¯®¤ ­ §¢ ­¨¥¬ ¯ ° ¤®ª±  ± ¤­¿¬¨ °®¦¤¥­¨¿ (° §¤¥« 6.6.1), £¤¥ ®²¬¥· «¨, ·²® ±°¥¤­¥¥ ª®«¨·¥±²¢®p·«¥­®¢
¯®±«¥¤®¢ ²¥«¼­®±²¨ ¤® ¯¥°¢®£® ¯®¢²®°  ¨¬¥¥² ¯®°¿¤®ª ( n).
 ± ¡³¤³², ¢¯°®·¥¬, ¨­²¥°¥±®¢ ²¼ ®¶¥­ª¨ ¤«¨­» ¯¥°¨®¤  ­¥ ¯®
¬®¤³«¾ n,   ¯® ¬®¤³«¾ ¤¥«¨²¥«¥© n. ³±²¼ s | ­¥ª®²®°»© ¤¥«¨²¥«¼ n, ¤«¿ ª®²®°®£® gcd(s; n=s) = 1 (­ ¯°¨¬¥°, ¢»¤¥«¨¬ ±²¥¯¥­¨
­¥ª®²®°®£® ®¤­®£® ¯°®±²®£® ¬­®¦¨²¥«¿ ¢ ° §«®¦¥­¨¨ n ­  ¬­®¦¨²¥«¨). ®±¬®²°¨¬ ­  ®±² ²ª¨ ®² ¤¥«¥­¨¿ ·¨±¥« xi ­  ·¨±«® s. ² 
¯®±«¥¤®¢ ²¥«¼­®±²¼ x0i = xi mod s ² ª¦¥ ¬®¦­® ° ±±¬ ²°¨¢ ²¼ ª ª
§ ¤ ­­³¾ °¥ª³°°¥­²­»¬ ±®®²­®¸¥­¨¥¬

x0i+1 = (x0i 2 ; 1) (mod s);
(33:50)
¯®±ª®«¼ª³ ¯¥°¥µ®¤ ®² ¬®¤³«¿ n ª ¬®¤³«¾ s ®¯°¥¤¥«¥­ ª®°°¥ª²­®
(¯°¨ s j n) ¨ ¯¥°¥±² ­®¢®·¥­ ± ¢®§¢¥¤¥­¨¥¬ ¢ ª¢ ¤° ² ¨ ¢»·¨² ­¨¥¬

¥¤¨­¨¶».
®¢²®°¨¢ ¯°¨¢¥¤¥­­®¥ ¢»¸¥ ¢¥°®¿²­®±²­®¥ ° ±±³¦¤¥­¨¥, ¬»
¯°¨¤¥¬ ª § ª«¾·¥­¨¾,
·²® ¯®±«¥¤®¢ ²¥«¼­®±²¼ hx0i i ±² ­®¢¨²±¿ ¯¥p
°¨®¤¨·­®© §  ( s) ¸ £®¢. ®¦­® ®¦¨¤ ²¼, ·²® ¢ ¯®±«¥¤®¢ ²¥«¼­®±²¨ hx0i i ¯®¢²®°¥­¨¥ ¯®¿¢¨²±¿ ° ­¼¸¥, ² ª ª ª ±° ¢­¨¬®±²¼ ¯®
¬®¤³«¾ n | ¡®«¥¥ ±¨«¼­®¥ ³±«®¢¨¥, ·¥¬ ±° ¢­¨¬®±²¼ ¯® ¬®¤³«¾ s.
(  °¨±. 33.7 ª ª ° § ² ª®© ±«³· © ¨ ¯®ª § ­.)
¥¯¥°¼ ®¡º¿±­¨¬, ª ª ¨±¯®«¼§³¥²±¿ ¯¥°¥¬¥­­ ¿ y . ³±²¼ ¬» µ®²¨¬ ­ ©²¨ ¯®¢²®°¿¾¹¨¥±¿ ·«¥­» ¢ ¯®±«¥¤®¢ ²¥«¼­®±²¨ hxii. «¿
½²®£® ­¥ ­³¦­® ±° ¢­¨¢ ²¼ ª ¦¤»© ·«¥­ ± ª ¦¤»¬ | ¢¬¥±²® ½²®£® ¬®¦­® § ¯®¬¨­ ²¼ ·«¥­» x1; x2; x4; x8; : : : ¨ ±° ¢­¨¢ ²¼ ¤°³£¨¥
·«¥­» ¯®±«¥¤®¢ ²¥«¼­®±²¨ ± ­¨¬¨, ¨¹  ¯®¢²®°¥­¨©. °¨ ½²®¬, ª®­¥·­®, ¬» ­¥ £ ° ­²¨°³¥¬, ·²® ®¡­ °³¦¨¬ ± ¬³¾ ° ­­¾¾ ¯ °³
¯®¢²®°¿¾¹¨µ±¿ ·«¥­®¢. ® ¯®±ª®«¼ª³ ¯®¢²®°¥­¨¥, ° § ±«³·¨¢¸¨±¼,
¤ «¥¥ ¨¤¥² ¯® ¶¨ª«³, ¬» ¥£® ­¥ ¯°®¯³±²¨¬. °¨ ½²®¬ ­ ¬ ¯°¨¤¥²±¿
¯°®±¬®²°¥²¼ ¡®«¼¸¥ ·«¥­®¢ ¯®±«¥¤®¢ ²¥«¼­®±²¨, ·¥¬ ¥±«¨ ¡» ¬»
±° ¢­¨¢ «¨ ¢±¥ ¯ °», ­® ­¥­ ¬­®£® (­¥ ¡®«¥¥ ·¥¬ ¢ ª®­±² ­²³ ° §).
°®¶¥¤³°  Pollard-Rho ±° ¢­¨¢ ¥² ²¥ª³¹¥¥ §­ ·¥­¨¥ xi ± § ¯®¬­¥­­»¬ §­ ·¥­¨¥¬ y | ­® ¢¬¥±²® ²®£®, ·²®¡» ¯°®¢¥°¿²¼ ¨µ
° ¢¥­±²¢® (¨ ²¥¬ ± ¬»¬ ¨±ª ²¼ ¯®¢²®°¥­¨¿ ¢ ¯®±«¥¤®¢ ²¥«¼­®±²¨
hxii) ¢»·¨±«¿¥² ­ ¨¡®«¼¸¨© ®¡¹¨© ¤¥«¨²¥«¼ ¨µ ° §­®±²¨ ¨ ·¨±« 
n. ¬»±« ½²®£® ¢ ²®¬, ·²® ²¥¬ ± ¬»¬ ¬®¦­® ³«®¢¨²¼ ¶¨ª« ¢ ¯®±«¥¤®¢ ²¥«¼­®±²¨ x0i | ¥±«¨ xi ¨ y ±° ¢­¨¬» ¯® ¬®¤³«¾ s, ²® ­ ¨¡®«¼¸¨© ®¡¹¨© ¤¥«¨²¥«¼ xi ; y ¨ n ¡³¤¥² ª° ²¥­ s, ¨ ¥±«¨ ²®«¼ª® ®­
­¥ ®ª ¦¥²±¿ ° ¢­»¬ n, ²® ¤¥«® ±¤¥« ­® - ¬» ­ ¸«¨ ­¥²°¨¢¨ «¼­»©
¤¥«¨²¥«¼ ·¨±«  n. ( ¬¥²¨¬ ¥¹¥, ·²® ·¨±«® s ¨±¯®«¼§³¥²±¿ ²®«¼ª®
¢ ­ ¸¨µ ° ±±³¦¤¥­¨¿µ, ­¥ ¢±²°¥· ¿±¼ ¢ ¯°®£° ¬¬¥.)

758

« ¢  33 ¥®p¥²¨ª®-·¨±«®¢»¥  «£®p¨²¬»

±¥ ¬®¦¥² ¡»²¼ ­¥ ² ª £« ¤ª®, ª ª ¬» ®¯¨± «¨, ¯® ¤¢³¬ ¯°¨·¨­ ¬. ®-¯¥°¢»µ, ­ ¸¨ ®¶¥­ª¨ ¤«¿ ·¨±«  ¸ £®¢ | ¢±¥£® «¨¸¼
¯°¨ª¨¤ª¨¨, ¨  «£®°¨²¬ ¬®¦¥² ¯°®° ¡®² ²¼ ­ ¬­®£® ¤®«¼¸¥, ¯°¥¦¤¥ ·¥¬ ¡³¤¥² ­ ©¤¥­ ®¡¹¨© ¤¥«¨²¥«¼. ®-¢²®°»µ, ®¡­ °³¦¥­­»©
¤¥«¨²¥«¼, ª° ²­»© s, ¬®¦¥² ®ª § ²¼±¿ ° ¢­»¬ n ¨, ±«¥¤®¢ ²¥«¼­®,
¡¥±¯®«¥§­»¬.  ª®¥ ¢®§¬®¦­®: ¯³±²¼. ­ ¯°¨¬¥°, n = pq , £¤¥ p ¨ q
¯°®±²», ¨ ¯³±²¼ ¯®±«¥¤®¢ ²¥«¼­®±²¨ hxi mod pi ¨ hxi mod q i ¨¬¥¾²
®¤¨­ ª®¢»¥ ¯® ¤«¨­¥ ¯¥°¨®¤¨·¥±ª¨¥ ¨ ¤®¯¥°¨®¤¨·¥±ª¨¥ · ±²¨. ®£¤  ¯®¢²®°¥­¨¿ ¯® ¬®¤³«¾ p ±®¢¬¥¹¥­» ± ¯®¢²®°¥­¨¿¬¨ ¯® ¬®¤³«¾
q, ¨ ¢ °¥§³«¼² ²¥ ¡³¤¥² ®¡­ °³¦¨¢ ²¼±¿ ®¡¹¨© ¤¥«¨²¥«¼ n.
¡¥ ½²¨ ¢®§¬®¦­®±²¨ °¥¤ª® ¢±²°¥· ¾²±¿ ­  ¯° ª²¨ª¥.  ª° ©­¥¬
±«³· ¥ ¬®¦­® ¨§¬¥­¨²¼ ´®°¬³«³, ¯®°®¦¤ ¾¹³¾ °¥ª³°°¥­²­³¾ ¯®±«¥¤®¢ ²¥«¼­®±²¼, ¯®«®¦¨¢, ­ ¯°¨¬¥°, xi+1 ° ¢­»¬ (xi 2 ; c) mod n.
 ª ·¥±²¢¥ §­ ·¥­¨¿ c ­¥ ±«¥¤³¥² ¡° ²¼ 0 ¨ 2 (­¥ ¡³¤¥¬ ±¥©· ± ®¡º¿±­¿²¼, ¯®·¥¬³); ¤°³£¨¥ §­ ·¥­¨¿ ¢¯®«­¥ ¯°¨¥¬«¥¬».
®­¥·­®, ­ ¸  ­ «¨§ ¢¥±¼¬  ¯°¨¡«¨§¨²¥«¥­, ² ª ª ª ¯®±ª®«¼ª³
·¨±«  xi ­¥ ¿¢«¿¾²±¿ ±«³· ©­»¬¨ | ­® ­  ¯° ª²¨ª¥ ¯°®¶¥¤³°  ° ¡®² ¥² µ®°®¸®, ¿¢«¿¿±¼ ®¤­¨¬ ¨§ ­ ¨¡®«¥¥ ½´´¥ª²¨¢­»µ ¬¥²®¤®¢
p
¯®¨±ª  ­¥¡®«¼¸¨µ ¤¥«¨²¥«¥© ¡®«¼¸¨µ ¶¥«»µ ·¨±¥«: ®¶¥­ª  s ­ 
·¨±«® ®¯¥° ¶¨© § ¢¨±¨² ®² ¢¥«¨·¨­» ¤¥«¨²¥«¿,   ­¥ ®² ¢¥«¨·¨­»
± ¬®£® ·¨±« .
p °¨ ° ¡®²¥ ± -¡¨²®¢»¬ ·¨±«®¬ n ¬» ¨¹¥¬ ¬­®¦¨²¥«¨ ¤® n, ²® ¥±²¼ ° §¬¥°  ­¥ ¡®«¥¥ =2, ¨ ®¦¨¤ ¥¬®¥ ·¨±«®
 °¨´¬¥²¨·¥±ª¨µ ®¯¥° ¶¨© ¨¬¥¥² ¯®°¿¤®ª n1=4 = 2=4 (·²® ¤ ¥²
¯®°¿¤ª  n1=4  3 = 2=4 3 ¡¨²®¢»µ ®¯¥° ¶¨©.
¯° ¦­¥­¨¿
33.9-1
®«¼§³¿±¼ °¨±. 33.7(a), ®¯°¥¤¥«¨²¥, ¢ ª ª®© ¬®¬¥­²½ ¯°®¶¥¤³° 
Pollard-Rho ­ ¯¥· ² ¥² ¤¥«¨²¥«¼ 73 ·¨±«  1387.
33.9-2
³±²¼ § ¤ ­  ´³­ª¶¨¿ f : Zn ! Zn ¨ §­ ·¥­¨¥ x0 2 Zn. ¯°¥¤¥«¨¬ ¯®±«¥¤®¢ ²¥«¼­®±²¼ x1 ; x2; ::: ±®®²­®¸¥­¨¥¬ xi = f (xi;1 ). ¡®§­ ·¨¬ ·¥°¥§ u ¤«¨­³ ¯¥°¨®¤¨·¥±ª®© · ±²¨ ¯®±«¥¤®¢ ²¥«¼­®±²¨,  
·¥°¥§ t | ¤«¨­³ ¤®¯¥°¨®¤¨·¥±ª®© · ±²¨. °¥¤«®¦¨²¥ ½´´¥ª²¨¢­»©  «£®°¨²¬ ­ µ®¦¤¥­¨¿ t ¨ u. ¶¥­¨²¥ ¢°¥¬¿ ¥£® ° ¡®²».
33.9-3
¥°¥§ ±ª®«¼ª® ¸ £®¢ ¬®¦­® ®¦¨¤ ²¼, ·²® ¯°®¶¥¤³°  PollardRho ®¡­ °³¦¨² ¤¥«¨²¥«¼ ¢¨¤  pe , £¤¥ p | ¯°®±²®¥ ·¨±«®,   e > 1?
33.9-4*
°®¶¥¤³°  Pollard-Rho ­  ª ¦¤®¬ ¸ £¥ ¢»·¨±«¿¥² ­ ¨¡®«¼¸¨© ®¡¹¨© ¤¥«¨²¥«¼. ®¦­® ¯»² ²¼±¿ ³±ª®°¨²¼ ° ¡®²³ ¯°®¶¥¤³°»
² ª: ¯¥°¥¬­®¦¨²¼ ­¥±ª®«¼ª® ±®±¥¤­¨µ ·«¥­®¢ ¯®±«¥¤®¢ ²¥«¼­®±²¨
hxii, ¨ ¢»·¨±«¨²¼ ­ ¨¡®«¼¸¨© ®¡¹¨µ ¤¥«¨²¥«¼ ¨µ ¯°®¨§¢¥¤¥­¨¿ ¨
·¨±«  y .  §° ¡®² ©²¥ ±®®²¢¥²±²¢³¾¹³¾ ¯°®¶¥¤³°³ ¨ ®¡º¿±­¨²¥,
¯®·¥¬³ ®­  ¡³¤¥² ° ¡®² ²¼. ª®«¼ª® ±®±¥¤­¨µ ·«¥­®¢ ±²®¨² ¡° ²¼
¯°¨ ° ¡®²¥ ±  -¡¨²®¢»¬¨ ·¨±« ¬¨?
 ¤ ·¨.

°®¢¥°ª  ·¨±¥« ­  ¯°®±²®²³

759

33-1 ¢®¨·­»©  «£®°¨²¬ ¢»·¨±«¥­¨¿ ­ ¨¡®«¼¸¥£® ®¡¹¥£® ¤¥«¨²¥«¿.
®¢°¥¬¥­­»¥ ª®¬¯¼¾²¥°» ¢»¯®«­¿¾² ®¯¥° ¶¨¨ ±«®¦¥­¨¿ ¨ ¢»·¨² ­¨¿,   ² ª¦¥ ¯°®¢¥°¿¾² ·¥²­®±²¼ ·¨±«  ¡»±²°¥¥, ·¥¬ ¢»¯®«­¿¾² ¤¥«¥­¨¥ ± ®±² ²ª®¬. ®½²®¬³ ¨­²¥°¥±¥­ ¤¢®¨·­»©  «£®°¨²¬
¢»·¨±«¥­¨¿ ­ ¨¡®«¼¸¥£® ®¡¹¥£® ¤¥«¨²¥«¿ (binary gcd algorithm),
¨§¡¥£ ¾¹¨© ¤¥«¥­¨¿ ± ®±² ²ª®¬.
a. ®ª ¦¨²¥, ·²® gcd(a; b) = 2gcd(a=2; b=2) ¤«¿ ·¥²­»µ ¶¥«»µ
·¨±¥« a ¨ b.
b. ®ª ¦¨²¥, ·²® ¥±«¨ a ·¥²­®,   b ­¥·¥²­®, ²® gcd(a; b) =
gcd(a; b=2).
c. ®ª ¦¨²¥, ·²® ¥±«¨ ®¡  ·¨±«  a ¨ b ­¥·¥²­», ²® gcd(a; b) =
gcd((a ; b)=2; b).
d. ®±²°®©²¥  «£®°¨²¬, ¢»·¨±«¿¾¹¨© gcd(a; b) ± ¨±¯®«¼§®¢ ­¨¥¬ ³ª § ­­»µ ±®®²­®¸¥­¨© §  ¢°¥¬¿ O(lg(max(a; b))) (±·¨² ¿, ·²®
¢»·¨² ­¨¥, ¯°®¢¥°ª  ­  ·¥²­®±²¼, ³¤¢®¥­¨¥ ¨ ¨ ¤¥«¥­¨¥ ¯®¯®« ¬
¢»¯®«­¿¾²±¿ §  ¥¤¨­¨¶³ ¢°¥¬¥­¨).
33-2 ¶¥­ª  ·¨±«  ¡¨²®¢»µ ®¯¥° ¶¨© ¢  «£®°¨²¬¥ ¢ª«¨¤ .
a. ®ª ¦¨²¥, ·²® ®¡»·­»© ±¯®±®¡ ¤¥«¥­¨¿ ³£®«ª®¬ ·¨±«  a ­ 
·¨±«® b ²°¥¡³¥² O((1 + lg q ) lg b) ¡¨²®¢»µ ®¯¥° ¶¨© ®¯¥° ¶¨© (q |
· ±²­®¥).
b. ®«®¦¨¬ (a; b) = (1 + lg a)(1 + lg b). ®ª ¦¨²¥, ·²® ·¨±«®
¡¨²®¢»µ ®¯¥° ¶¨© ¢ ¯°®¶¥¤³°¥ Euclid, ²°¥¡³¥¬»µ ¤«¿ ±¢¥¤¥­¨¿
§ ¤ ·¨ ¢»·¨±«¥­¨¿ gcd(a; b) ª § ¤ ·¥ ¢»·¨±«¥­¨¿ gcd(b; a mod b),
­¥ ¯°¥¢®±µ®¤¨² c((a; b) ; (b; a mod b), ¥±«¨ c > 0 | ¤®±² ²®·­®
¡®«¼¸ ¿ ª®­±² ­² . (±¯®«¼§³©²¥ ®¶¥­ª³ ¯°¥¤»¤³¹¥£® ¯³­ª² .)
c. ®ª ¦¨²¥, ·²® ¯°®¶¥¤³°  Euclid(a; b) ¢»¯®«­¿¥² ­¥ ¡®«¥¥
O((a; b)) ¡¨²®¢»µ ®¯¥° ¶¨©. ®ª ¦¨²¥, ·²® ¯°®¶¥¤³°  Euclid,
¯°¨¬¥­¥­­ ¿ ª ¤¢³¬  ;¡¨²®¢»¬ ·¨±« ¬, ¢»¯®«­¿¥² ­¥ ¡®«¥¥ O( 2)
¡¨²®¢»µ ®¯¥° ¶¨©.
33-3 °¨  «£®°¨²¬  ¢»·¨±«¥­¨¿ ·¨±¥« ¨¡®­ ··¨.
 ½²®© § ¤ ·¨ ¬» ±° ¢­¨¢ ¥¬ ²°¨ ±¯®±®¡  ¢»·¨±«¥­¨¿ n-£® ·¨±«  ¨¡®­ ··¨ Fn ¯°¨ § ¤ ­­®¬ n. («¿ ¯°®±²®²» ¬» ±·¨² ¥¬,
·²® ®¯¥° ¶¨¨ ±«®¦¥­¨¿, ¢»·¨² ­¨¿ ¨«¨ ³¬­®¦¥­¨¿ ¢»¯®«­¿¾²±¿
§  ¥¤¨­¨·­®¥ ¢°¥¬¿ ­¥§ ¢¨±¨¬® ®² ° §¬¥°  ·¨±¥«.)
a. ®ª ¦¨²¥, ·²® ¢°¥¬¿ ° ¡®²» ¯°®±²¥©¸¥© °¥ª³°±¨¢­®© ¯°®¶¥¤³°», ­¥¯®±°¥¤±²¢¥­­® °¥ «¨§³¾¹¥© ´®°¬³«³ (2.14), ½ª±¯®­¥­¶¨ «¼­® § ¢¨±¨² ®² n.
b. ®ª ¦¨²¥, ª ª ²¥µ­¨ª  § ¯®¬¨­ ­¨¿ ¯°®¬¥¦³²®·­»µ °¥§³«¼² ²®¢ ¯®§¢®«¿¥² ±®ª° ²¨²¼ ¢°¥¬¿ ¤® O(n).
c. ®ª ¦¨²¥, ª ª ¢»·¨±«¨²¼ Fn §  ¢°¥¬¿ O(lg n), ¨±¯®«¼§³¿ ²®«¼ª® ®¯¥° ¶¨¨ (±«®¦¥­¨¥ ¨ ³¬­®¦¥­¨¥) ± ¶¥«»¬¨ ·¨±« ¬¨. (ª § ­¨¥.
 ±±¬®²°¨²¥ ¬ ²°¨¶³


1 1
0 1

760

« ¢  33 ¥®p¥²¨ª®-·¨±«®¢»¥  «£®p¨²¬»

¨ ¥¥ ±²¥¯¥­¨.)
d. ¶¥­¨²¥ ¢°¥¬¿ ° ¡®²» ²°¥µ ®¯¨± ­­»µ  «£®°¨²¬®¢, ¨±µ®¤¿ ¨§
¡®«¥¥ °¥ «¨±²¨·­»µ ®¶¥­®ª ¢°¥¬¥­¨ ±«®¦¥­¨¿ ¨ ³¬­®¦¥­¨¿: ±·¨² ©²¥, ·²® ±«®¦¥­¨¥ ¤¢³µ  -¡¨²®¢»µ ·¨±¥« ²°¥¡³¥² ¢°¥¬¥­¨ O( ),
  ³¬­®¦¥­¨¥ | O( 2).
33-4 ¢ ¤° ²¨·­»¥ ¢»·¥²».
³±²¼ p | ­¥·¥²­®¥ ¯°®±²®¥ ·¨±«®. «¥¬¥­² a 2 Zp ­ §»¢ ¥²±¿
ª¢ ¤° ²¨·­»¬ ¢»·¥²®¬ (quadratic residue), ¥±«¨ ±³¹¥±²¢³¥² x 2
, ¤«¿ ª®²®°®£® x2  a (mod p).
Z
p
a. ®ª ¦¨²¥, ·²® ¢ £°³¯¯¥ Zp ¨¬¥¥²±¿ ¢ ²®·­®±²¨ (p ; 1)=2 ª¢ ¤° ²¨·­»µ ¢»·¥²®¢.
b. ³±²¼ p | ¯°®±²®¥ ¨ a 2 Zp. ¨¬¢®« ¥¦ ­¤° 
(Legendre
 
a
a
symbol), ®¡®§­ · ¥¬»© p , ®¯°¥¤¥«¿¥²±¿ ² ª: p = 1, ¥±«¨ a
 
¿¢«¿¥²±¿ ª¢ ¤° ²¨·­»¬ ¢»·¥²®¬ ¢ Zp, ¨ ap = ;1 ¢ ¯°®²¨¢­®¬
±«³· ¥. ®ª ¦¨²¥, ·²®
 

a  a(p;1)=2 (mod p):
p

°¥¤«®¦¨²¥ ½´´¥ª²¨¢­»©  «£®°¨²¬, ®¯°¥¤¥«¿¾¹¨©, ¿¢«¿¥²±¿ «¨
§ ¤ ­­»© ½«¥¬¥­² a 2 Zp ª¢ ¤° ²¨·­»¬ ¢»·¥²®¬. ¶¥­¨²¥ ¢°¥¬¿
¥£® ° ¡®²».
c. ³±²¼ ¯°®±²®¥ ·¨±«® p ¨¬¥¥² ¢¨¤ 4k + 3,   ·¨±«® a 2 Zp ¿¢«¿¥²±¿ ª¢ ¤° ²¨·­»¬ ¢»·¥²®¬. ®ª ¦¨²¥, ·²® ak+1 mod p ¿¢«¿¥²±¿
ª¢ ¤° ²­»¬ ª®°­¥¬ ¨§ a ¯® ¬®¤³«¾ p.   ª ª®¥ ¢°¥¬¿ ¬®¦­® ¢»·¨±«¨²¼ ª¢ ¤° ²­»© ª®°¥­¼ ¯® ¬®¤³«¾ p ¨§ ª¢ ¤° ²¨·­®£® ¢»·¥² 
a 2 Zp, ¥±«¨ p ¨¬¥¥² ¢¨¤ 4k + 3?
d. °¥¤«®¦¨²¥ ½´´¥ª²¨¢­»© ¢¥°®¿²­®±²­»©  «£®°¨²¬ ¯®¨±ª 
(¤«¿ «¾¡®£® ¯°®±²®£® p) ½«¥¬¥­²®¢ a 2 Zp, ­¥ ¿¢«¿¾¹¨µ±¿ ª¢ ¤° ²¨·­»¬¨ ¢»·¥² ¬¨. ª®«¼ª®  °¨´¬¥²¨·¥±ª¨µ ®¯¥° ¶¨© ¡³¤¥²
¢»¯®«­¿²¼ ¢ ±°¥¤­¥¬ ½²®²  «£®°¨²¬?
 ¬¥· ­¨¿.
­¨£  ¨¢¥­  ¨ ³ª¥°¬ ­  [191] | ¯°¥¢®±µ®¤­»© ³·¥¡­¨ª ¯®
½«¥¬¥­² °­®© ²¥®°¨¨ ·¨±¥«.  ª­¨£¥ ­³²  [122] ¤¥² «¼­® ° ±±¬ ²°¨¢ ¾²±¿  «£®°¨²¬» ­ µ®¦¤¥­¨¿ ­ ¨¡®«¼¸¥£® ®¡¹¥£® ¤¥«¨²¥«¿
¨ ¤°³£¨¥ ¡ §®¢»¥  «£®°¨²¬» ²¥®°¨¨ ·¨±¥«. § ª­¨£ ¨§¥«¿ [168]
¨  µ  [16] ¬®¦­® ³§­ ²¼ ® ±®¢°¥¬¥­­®¬ ±®±²®¿­¨¨ ¢»·¨±«¨²¥«¼­®© ²¥®°¨¨ ·¨±¥«.  ¤ ·¨ ° §«®¦¥­¨¿ ­  ¬­®¦¨²¥«¨ ¨ ¯°®¢¥°ª¨
­  ¯°®±²®²³ ° ±±¬ ²°¨¢ ¾²±¿ ¢ ª­¨£¥ ¨ª±®­  [56].  ±¡®°­¨ª¥
¯®¤ °¥¤ ª¶¨¥© ®¬¥° ­¶  [159] ¬®¦­® ­ ©²¨ ­¥±ª®«¼ª® µ®°®¸¨µ
®¡§®°®¢ ±² ²¥©.
­³² ¢ [122] ®¡±³¦¤ ¥² ¯°®±µ®¦¤¥­¨¥  «£®°¨²¬  ¢ª«¨¤ . ­
±®¤¥°¦¨²±¿ ¢ ±¥¤¼¬®© ª­¨£¥ §­ ¬¥­¨²»µ À · «Á ¢ª«¨¤  (¯°¥¤«®¦¥­¨¿ 1 ¨ 2), ­ ¯¨± ­­®© ®ª®«® 300 £. ¤® .. ®§¬®¦­®, ¨¤¥¿
 «£®°¨²¬  ¢®±µ®¤¨² ª ²°³¤ ¬ ¢¤®ª±  (®ª®«® 375 £. ¤® ..). «-

°®¢¥°ª  ·¨±¥« ­  ¯°®±²®²³

761

£®°¨²¬ ¢ª«¨¤  ¯°¥²¥­¤³¥² ­  °®«¼ ¤°¥¢­¥©¸¥£® ­¥²°¨¢¨ «¼­®£®  «£®°¨²¬  | ±®¯¥°­¨· ²¼ ± ­¨¬ ¬®¦¥² ²®«¼ª® ² ª ­ »¢ ¥¬»©
À°³±±ª¨© ­ °®¤­»©  «£®°¨²¬ ³¬­®¦¥­¨¿ ·±¨¥«Á (£« ¢  29), ª®²®°»© ¡»« ¨§¢¥±²¥­ ¥¹¥ ¤°¥¢­¨¬ ¥£¨¯²¿­ ¬.
­³² ®²¬¥· ¥², ·²® · ±²­»© ±«³· © Àª¨² ©±ª®© ²¥®°¥¬» ®¡
®±² ²ª µÁ ¡»« ¨§¢¥±²¥­ ª¨² ©±ª®¬³ ¬ ²¥¬ ²¨ª³ ³­-³, ¦¨¢¸¥¬³ £¤¥-²® ¬¥¦¤³ 200 £. ¤® .. ¨ 200 £. ®² .. ®² ¦¥ ± ¬»©
· ±²­»© ±«³· © ¡»« ° §®¡° ­ ¤°¥¢­¥£°¥·¥±ª¨¬ ¬ ²¥¬ ²¨ª®¬ ¨ª®¬ µ®¬ ®ª®«® 100 £. ®² .. ®«¥¥ ®¡¹³¾ ´®°¬³ ²¥®°¥¬¥ ¯°¨¤ «
¨­ ¼¾- ® ¢ 1247 £®¤³.  ¯®«­®© ®¡¹­®±²¨ ²¥®°¥¬  ¡»«  ±´®°¬³«¨°®¢ ­  ¨ ¤®ª § ­  ¥®­ °¤®¬ ©«¥°®¬ ¢ 1734 £®¤³.
¥°®¿²­®±²­»©  «£®°¨²¬ ¯°®¢¥°ª¨ ·¨±¥« ­  ¯°®±²®²³, ° ±±¬®²°¥­­»© ­ ¬¨, ¯°¥¤«®¦¥­ ¨««¥°®¬ [147] ¨  ¡¨­®¬ [166]; ®­ ¿¢«¿¥²±¿ (± ²®·­®±²¼¾ ¤® ¯®±²®¿­­®£® ¬­®¦¨²¥«¿) ± ¬»¬ ¡»±²°»¬ ¨§
¨§¢¥±²­»µ, ®ª § ²¥«¼±²¢® ¥®°¥¬» 33.39, ¯°¨¢¥¤¥­­®¥ ­ ¬¨, ±«¥¤³¥² ¨¤¥¥  µ  [15]. ®«¥¥ ±¨«¼­»© °¥§³«¼² ² ® ²¥±²¥ ¨««¥°  |
 ¡¨­  ¤®ª § ­ ®­¼¥ [148,149]. ±¯®«¼§®¢ ­¨¥ ±«³· ©­®±²¨ ²³²
±³¹¥±²¢¥­­® | ­ ¨«³·¸¨© ¨§¢¥±²­»© ¤¥²¥°¬¨­¨°®¢ ­­»© (­¥ ¨±¯®«¼§³¾¹¨© ¤ ²·¨ª  ±«³· ©­»µ ·¨±¥«)  «£®°¨²¬ ¯°®¢¥°ª¨ ­  ¯°®±²®²³ ¨§¢¥±²¥­ ª ª ¢¥°±¨¿ ®½­  | ¥­±²°» [45] ²¥±²  ¤«¥¬ ­ ,
®¬¥° ­¶  ¨ ³¬¥«¨ [3].   ¯°®¢¥°ª³ ¯°®±²®²» ·¨±«  n ®­ ²° ²¨²
¢°¥¬¿ (lg n)O(lg lg lg n) (·³²¼ ¡®«¼¸¥ ¯®«¨­®¬¨ «¼­®£®).
 ¤ ·  ¯®¨±ª  ¡®«¼¸®£® À±«³· ©­®£®Á ¯°®±²®£® ·¨±«  ¯®¤°®¡­®
®¡±³¦¤¾² ®¸¥¬¨­, ° ±± °, °¥¯®, ®²¼¥ ¨ ®¬¥° ­¶ [20].
¤¥¿ ª°¨¯²®±¨±²¥¬» ± ®²ª°»²»¬ ª«¾·®¬ ¯°¨­ ¤«¥¦¨² ¨´´¨
¨ ¥««¬ ­³ [54]. °¨¯²®±¨±²¥¬³ RSA ¯°¥¤«®¦¨«¨ ¢ 1977 £®¤³ ¨¢¥±²,  ¬¨° ¨ ¤«¥¬ ­.  ²¥µ ¯®° ª°¨¯²®£° ´¨¿ ±² «  ¡»±²°® ° §¢¨¢ ¾¹¥©±¿ ®¡« ±²¼¾ ±® ¬­®¦¥±²¢®¬ ¨­²¥°¥±­»µ °¥§³«¼² ²®¢.  ¯°¨¬¥°, ®«¼¤¢ ±±¥° ¨ ¨ª½«¨ [86], ¯®ª § «¨, ª ª ¬®¦­® ¨±¯®«¼§®¢ ²¼ ° ­¤®¬¨§ ¶¨¾ (¤ ²·¨ª ±«³· ©­»µ ·¨±¥«) ¤«¿ ¯®±²°®¥­¨¿ ª°¨¯²®±¨±²¥¬ ± ®²ª°»²»¬ ª«¾·®¬ ¢¥°®¿²­®±²­»¥  «£®°¨²¬». ®«¼¤¢ ±±¥°, ¨ª½«¨ ¨ ¨¢¥±² [87] ¯°¥¤«®¦¨«¨ ±µ¥¬³ ½«¥ª²°®­­®© ¯®¤¯¨±¨, ¢§«®¬ ª®²®°®© ¯® ²°³¤­®±²¨ ° ¢­®±¨«¥­ ° §«®¦¥­¨¾ ·¨±¥«
­  ¬­®¦¨²¥«¨. ®«¼¤¢ ±c¥°, ¨ª½«¨ ¨  ª®¢ [87] ¢¢¥«¨ ª« ±± ² ª
­ §»¢ ¥¬»µ ±¨±²¥¬ ± ­³«¥¢»¬ ° §£« ¸¥­¨¥¬, ¯°® ª®²®°»¥ ¬®¦­®
¤®ª § ²¼ (¯°¨ ­¥ª®²®°»µ ¥±²¥±²¢¥­­»µ ¤®¯³¹¥­¨¿µ), ·²® ­¨ ®¤­ 
¨§ ±²®°®­ ­¥ ³§­ ¥² ¡®«¼¸¥, ·¥¬ ¥© ¯®«®¦¥­®.
¥²®¤ ° §«®¦¥­¨¿ ·¨±¥«, ­ §»¢ ¥¬»© -½¢°¨±²¨ª®©, ¢¯¥°¢»¥
¡»« ¯°¥¤«®¦¥­ ®«« °¤®¬ [156].  °¨ ­², ¨§« £ ¥¬»© ­ ¬¨, ¯°¥¤«®¦¨« °¥­² [35].
°¥¬¿ ° ¡®²» ­ ¨«³·¸¥£® ¨§¢¥±²­®£®  «£®°¨²¬  ° §«®¦¥­¨¿ ·¨±«  n ­  ¬­®¦¨²¥«¨ ¢®§° ±² ¥² ± °®±²®¬ n ª ª ½ª±¯®­¥­² , ¯®ª § ²¥«¥¬ ª®²®°®© ¿¢«¿¥²±¿ ª®°¥­¼ ¨§ ¤«¨­» n.  ®¡¹¥¬ ±«³· ¥, ¢®§¬®¦­®, ­ ¨¡®«¥¥ ½´´¥ª²¨¢­»¬ ¿¢«¿¥²±¿  «£®°¨²¬ Àª¢ ¤° ²¨·­®£®
°¥¸¥² Á, ¯°¥¤«®¦¥­­»© ®¬¥° ­¶¥¬ ¢ [158]. °¨ ­¥ª®²®°»µ ¥±²¥±²¢¥­­»µ ¯°¥¤¯®«®¦¥­¨¿µ ¢°¥¬¿ ° ¡®²» ½²®£®  «£®°¨²¬  ¬®¦­®

762

« ¢  33 ¥®p¥²¨ª®-·¨±«®¢»¥  «£®p¨²¬»

p

®¶¥­¨²¼ ª ª L(n)1+o(1), £¤¥ L(n) = e ln n lnln n . ¥²®¤ ½««¨¯²¨·¥±ª¨µ ª°¨¢»µ, ¯°¥¤«®¦¥­­»© ¥­±²°®© [173], ¨­®£¤  ½´´¥ª²¨¢­¥¥
 «£®°¨²¬  ª¢ ¤° ²¨·­®£® °¥¸¥² , ¯®±ª®«¼ª³ ®­ (² ª ¦¥ ª ª ¨  «£®°¨²¬ ®«« °¤ ) ¡»±²°® ¨¹¥² ­¥¡®«¼¸¨¥
¤¥«¨²¥«¨; ¢°¥¬¿ ¯®p
¨±ª  ¤¥«¨²¥«¿ p ¬®¦­® ®¶¥­¨²¼ ª ª L(p) 2+o(1) .

34

®¨±ª ¯®¤±²°®ª

®«¼¸¨­±²¢® ²¥ª±²®¢»µ °¥¤ ª²®°®¢ ³¬¥¥² ¨±ª ²¼ § ¤ ­­®¥ ±«®¢® ¢
°¥¤ ª²¨°³¥¬®¬ ²¥ª±²¥ | µ®·¥²±¿, ·²®¡» ½²® ¯°®¨±µ®¤¨«® ¡»±²°®.
°³£®© ¯°¨¬¥° § ¤ ·¨, ¢ ª®²®°®© ²°¥¡³¥²±¿ ¨±ª ²¼ § ¤ ­­³¾ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ±¨¬¢®«®¢ ¢ ±²°®ª¥, | ¯®¨±ª ¤ ­­®© ¶¥¯®·ª¨ ­³ª«¥®²¨¤®¢ ¢ ¬®«¥ª³«¥ .
®¢®°¿ ´®°¬ «¼­®, § ¤ ·  ¯®¨±ª  ¯®¤±²°®ª (string-matching
problem) ±®±²®¨² ¢ ±«¥¤³¾¹¥¬. ³±²¼ ¤ ­» À²¥ª±²Á | ¬ ±±¨¢
T [1::n] ¤«¨­» n ¨ À®¡° §¥¶Á | ¬ ±±¨¢ P [1::m] ¤«¨­» m. » ±·¨² ¥¬, ·²® ½«¥¬¥­²» ¬ ±±¨¢®¢ P ¨ T | ±¨¬¢®«» ­¥ª®²®°®£® ª®­¥·­®£®
 «´ ¢¨²   (­ ¯°¨¬¥°,  = f0; 1g ¨«¨  = fa; b; : : :; zg).  ±±¨¢», ±®±²®¿¹¨¥ ¨§ ±¨¬¢®«®¢  «´ ¢¨²  , · ±²® ­ §»¢ ¾² ±²°®ª ¬¨
(strings) ±¨¬¢®«®¢, ¨«¨ ±«®¢ ¬¨ ¢ ½²®¬  «´ ¢¨²¥.
³¤¥¬ £®¢®°¨²¼, ·²® ®¡° §¥¶ P ¢µ®¤¨² ±® ±¤¢¨£®¬ s (occurs
with shift s), ¨«¨, ½ª¢¨¢ «¥­²­®, ¢µ®¤¨² ± ¯®§¨¶¨¨ s + 1 (occurs
beginning at position s + 1) ¢ ²¥ª±² T , ¥±«¨ 0 6 s 6 n ; m ¨
T [s + 1::s + m] = P [1::m] (¨­»¬¨ ±«®¢ ¬¨, ¥±«¨ T [s + j ] = P [j ]
¯°¨ 1 6 j 6 m). ±«¨ P ¢µ®¤¨² ±® ±¤¢¨£®¬ s ¢ ²¥ª±² T , ²® £®¢®°¿²,
·²® s | ¤®¯³±²¨¬»© ±¤¢¨£ (valid shift), ¢ ¯°®²¨¢­®¬ ±«³· ¥ s |
­¥¤®¯³±²¨¬»© ±¤¢¨£ (invalid shift).  ¤ ·  ¯®¨±ª  ¯®¤±²°®ª ±®±²®¨² ¢ ­ µ®¦¤¥­¨¨ ¢±¥µ ¤®¯³±²¨¬»µ ±¤¢¨£®¢ ¤«¿ ¤ ­­»µ ²¥ª±²  T ¨
®¡° §¶  P (±¬. °¨±. 34.1).
 ±²®¿¹ ¿ £« ¢  ¯®±¢¿¹¥­  ° §«¨·­»¬  «£®°¨²¬ ¬ ¤«¿ ¯®¨±ª  ¯®¤±²°®ª.  ° §¤¥«¥ 34.1 ¬» ° ±±¬ ²°¨¢ ¥¬ ¯°®±²¥©¸¨©  «£®°¨²¬, ° ¡®² ¾¹¨© §  ¢°¥¬¿ O((n ; m + 1)m) (¢ µ³¤¸¥¬ ±«³· ¥).
 ²¥¬ ¢ ° §¤¥«¥ 34.2 ¬» ° ±±ª §»¢ ¥¬ ®¡  «£®°¨²¬¥  ¡¨­  |
 °¯ . ²®² ®±²°®³¬­»©  «£®°¨²¬ ¯®¨±ª  ¯®¤±²°®ª ² ª¦¥ ¢ µ³¤¨±.34.1. ¥°¥¢®¤» ±«®¢ ­  °¨±³­ª¥: text | ²¥ª±², pattern | ®¡° §¥¶.
®¤¯¨±¼:
 ¤ ·  ¯®¨±ª  ¯®¤±²°®ª. °¥¡³¥²±¿ ­ ©²¨ ¢±¥ ¢µ®¦¤¥­¨¿ ®¡° §¶ 
P = abaa ¢ ²¥ª±² T = abcabaabcabac. ¡° §¥¶ ¢µ®¤¨² ¢ ²¥ª±²
²®«¼ª® ®¤¨­ ° §, ±® ±¤¢¨£®¬ s = 3 (±² «® ¡»²¼, 3 | ¤®¯³±²¨¬»©
±¤¢¨£).

764

« ¢  34 ®¨±ª ¯®¤±²°®ª

¨±. 34.2
®¤¯¨±¼: ¨±. 34.2. ®ª § ²¥«¼±²¢® «¥¬¬» 34.1. ®¢¯ ¤ ¾¹¨¥ ±¨¬¢®«» ±®¥¤¨­¥­» ¢¥°²¨ª «¼­»¬¨ «¨­¨¿¬¨,   ±®¢¯ ¤ ¾¹¨¥ · ±²¨
±²°®ª § ¸²°¨µ®¢ ­». ¨±. ( ) ±®®²¢¥²±²¢³¥² ±«³· ¾ jxj 6 jy j,
°¨±. (¡) | ±«³· ¾ jxj > jy j, °¨±. (¢) | ±«³· ¾ jxj = jy j.
¸¥¬ ±«³· ¥ ° ¡®² ¥² §  ¢°¥¬¿ O((n ; m + 1)m), ­® ­  ¯° ª²¨ª¥ ®­
¢ ±°¥¤­¥¬ £®° §¤® ¡»±²°¥¥; ª°®¬¥ ²®£®,  «£®°¨²¬  ¡¨­  |  °¯  ®¡®¡¹ ¥²±¿ ­  ¤°³£¨¥ § ¤ ·¨ ¯®¨±ª  ®¡° §¶ .  ° §¤¥«¥ 34.3
¬» ®¯¨±»¢ ¥¬  «£®°¨²¬ ¯®¨±ª  ¯®¤±²°®ª, ª®²®°»© ¯® § ¤ ­­®¬³
®¡° §¶³ ±²°®¨² ª®­¥·­»©  ¢²®¬ ², ¨ § ²¥¬ ¯°®¯³±ª ¥² ·¥°¥§ ½²®²
 ¢²®¬ ² ²¥ª±² T . °¥¬¿ ° ¡®²»  «£®°¨²¬®¢, ®±­®¢ ­­»µ ­  ½²®©
¨¤¥¥, ¬®¦¥² ¡»²¼ ¤®¢¥¤¥­® ¤® O(n + mjj). ­ «®£¨·­»©, ­® ¡®«¥¥
¨§®¹°¥­­»©  «£®°¨²¬ ­³²  | ®°°¨±  | ° ²²  (±®ª° ¹¥­­® KMP) ° ¡®² ¥² §  ¢°¥¬¿ O(m + n); ½²®¬³  «£®°¨²¬³ ¯®±¢¿¹¥­
° §¤¥« 34.4.  ª®­¥¶, ¢ ° §¤¥«¥ 34.5 ®¯¨±»¢ ¥²±¿  «£®°¨²¬ ®©¥° ³° . ²®²  «£®°¨²¬ § · ±²³¾ ®ª §»¢ ¥²±¿ ­ ¨¡®«¥¥ ³¤®¡­»¬ ­ 
¯° ª²¨ª¥, µ®²¿, ¯®¤®¡­®  «£®°¨²¬³  ¡¨­ - °¯ , ¢ µ³¤¸¥¬ ±«³· ¥ ®­ ­¥ ¤ ¥² ¢»¨£°»¸  ¯® ±° ¢­¥­¨¾ ± ¯°®±²¥©¸¨¬  «£®°¨²¬®¬.
34.0.1. ¡®§­ ·¥­¨¿ ¨ ²¥°¬¨­®«®£¨¿
¥°¥§  ®¡®§­ · ¥²±¿ ¬­®¦¥±²¢® ¢±¥µ ª®­¥·­»µ ±²°®ª ­ ¤  «´ ¢¨²®¬ , ¢ª«¾· ¿ ¯³±²³¾ ±²°®ª³ (empty string), ¨¬¥¾¹³¾ ­³«¥¢³¾ ¤«¨­³ ¨ ®¡®§­ · ¥¬³¾ ". «¨­  ±²°®ª¨ x ®¡®§­ · ¥²±¿ jxj.
®¥¤¨­¥­¨¥, ¨«¨ ª®­ª ²¥­ ¶¨¿ (concatenation) ±²°®ª x ¨ y ¯®«³·¨²±¿, ¥±«¨ ¢»¯¨± ²¼ ±²°®ª³ x,   §  ­¥© ¢±²»ª | ±²°®ª³ y . ®­ª ²¥­ ¶¨¿ ±²°®ª x ¨ y ®¡®§­ · ¥²±¿ xy ; ®·¥¢¨¤­®, jxy j = jxj + jy j.
» ¡³¤¥¬ £®¢®°¨²¼, ·²® ±²°®ª  w | ¯°¥´¨ª± (prex), ¨«¨ ­ · «®, ±²°®ª¨ x, ¥±«¨ x = wy ¤«¿ ­¥ª®²®°®£® y 2 . ³¤¥¬ £®¢®°¨²¼,
·²® w | ±³´´¨ª± (sux), ¨«¨ ª®­¥¶, ±²°®ª¨ x, ¥±«¨ x = yw ¤«¿
­¥ª®²®°®£® y 2  . ³¤¥¬ ¯¨± ²¼ w @ x, ¥±«¨ w | ¯°¥´¨ª± x, ¨
w A x, ¥±«¨ w | ±³´´¨ª± x.  ¯°¨¬¥°, ab @ abcca ¨ cca A abcca.
[ ½²¨¬¨ ®¡®§­ ·¥­¨¬¨ ­³¦­® ®¡° ¹ ²¼±¿ ®±²®°®¦­®: a @ b ¨ b A a
®§­ · ¾² ±®¢¥°¸¥­­® ° §­®¥!]
³±² ¿ ±²°®ª  ¿¢«¿¥²±¿ ¯°¥´¨ª±®¬ ¨ ±³´´¨ª±®¬ «¾¡®© ±²°®ª¨;
¥±«¨ w | ¯°¥´¨ª± ¨«¨ ±³´´¨ª± x, ²® jwj 6 jxj. «¿ «¾¡»µ ±²°®ª
x ¨ y ¨ ¤«¿ «¾¡®£® ±¨¬¢®«  a ±®®²­®¸¥­¨¿ x A y ¨ xa A ya ° ¢­®±¨«¼­»; ®²­®¸¥­¨¿ @ ¨ A ²° ­§¨²¨¢­».  ¤ «¼­¥©¸¥¬ ¬» ¡³¤¥¬
¯®«¼§®¢ ²¼±¿ ±«¥¤³¾¹¥© «¥¬¬®©.
¥¬¬  34.1 (¥¬¬  ® ¤¢³µ ±³´´¨ª± µ)
³±²¼ x, y ¨ z | ±²°®ª¨, ¤«¿ ª®²®°»µ x A z ¨ y A z . ®£¤  x A y ,
¥±«¨ jxj 6 jy j; y A x, ¥±«¨ jxj > jy j, ¨ x = y , ¥±«¨ jxj = jy j.
®ª § ²¥«¼±²¢®. ¬. °¨±. 34.2.
±«¨ S [1::r] | ±²°®ª  ¤«¨­» r, ²® ¥¥ ¯°¥´¨ª± ¤«¨­» k 6 r ¡³¤¥²

°®±²¥©¸¨©  «£®°¨²¬

765

®¡®§­ · ²¼±¿ Sk = S [1::k] (¢ · ±²­®±²¨, S0 = " ¨ Sr = S ).  ½²¨µ
®¡®§­ ·¥­¨¿µ § ¤ ·  ® ­ µ®¦¤¥­¨¨ ®¡° §¶  P ¤«¨­» m ¢ ²¥ª±²¥ T
¤«¨­» n ±®±²®¨² ¢ ­ µ®¦¤¥­¨¨ ¢±¥µ ² ª¨µ s ¨§ ¯°®¬¥¦³²ª  0 6
s 6 n ; m, ·²® P A Ts+m .
°¨ § ¯¨±¨  «£®°¨²¬®¢ ¤«¿ ¯®¨±ª  ¯®¤±²°®ª ¬» ¡³¤¥¬ ° ±±¬ ²°¨¢ ²¼ ¯°®¢¥°ª³ ° ¢¥­±²¢  ¤¢³µ ±²°®ª ª ª ½«¥¬¥­² °­³¾ ®¯¥° ¶¨¾, ¢°¥¬¿ ¢»¯®«­¥­¨¿ ª®²®°®© ¯°®¯®°¶¨®­ «¼­® ¤«¨­¥ ±° ¢­¨¢ ¥¬»µ ±²°®ª. ±«¨ ±° ¢­¨¢ ²¼ ±²°®ª¨ ±«¥¢  ­ ¯° ¢® ¨ ®±² ­ ¢«¨¢ ²¼±¿, ª ª ²®«¼ª® ®¡­ °³¦¥­® ° ±µ®¦¤¥­¨¥, ²® ±²®¨¬®±²¼ ±° ¢­¥­¨¿ ±²°®ª x ¨ y ¥±²¼ (t + 1), £¤¥ t | ¤«¨­  ­ ¨¡®«¼¸¥£® ®¡¹¥£®
¯°¥´¨ª±  ±²°®ª x ¨ y . (» ¯¨¸¥¬ t + 1 ¢¬¥±²® t, ³·¨²»¢ ¿ ±° ¢­¥­¨¥ ¯¥°¢»µ ­¥ ±®¢¯ ¢¸¨µ ±¨¬¢®«®¢.)

34.1. °®±²¥©¸¨©  «£®°¨²¬
¥°¢»© ¯°¨µ®¤¿¹¨© ¢ £®«®¢³  «£®°¨²¬ ¤«¿ ¯®¨±ª  ®¡° §¶  P
¢ ²¥ª±²¥ T ¯®±«¥¤®¢ ²¥«¼­® ¯°®¢¥°¿¥² ° ¢¥­±²¢® P [1::m] = T [s +
1::s + m] ¤«¿ ¢±¥µ n ; m + 1 ¢®§¬®¦­»µ §­ ·¥­¨© s:
Naive-String-Matcher(T,P)
1 n \gets length[T]
2 m \gets length[P]
3 for s \gets 0 to n-m
4
do if P[1..m]= T[s+1..s+m]
5
then print ``®¤±²°®ª  ¢µ®¤¨² ±® ±¤¢¨£®¬ ''s

®¦­® ±ª § ²¼, ·²® ¬» ¤¢¨£ ¥¬ ®¡° §¥¶ ¢¤®«¼ ²¥ª±²  ¨ ¯°®¢¥°¿¥¬ ¢±¥ ¥£® ¯®«®¦¥­¨¿ (°¨±. 34.3). ²¬¥²¨¬, ·²® ¯°®¢¥°ª  ¢ ±²°®ª¥ 4
¯°¥¤±² ¢«¿¥² ±®¡®© ¥¹¥ ®¤¨­ ¶¨ª«.
°¥¬¿ ° ¡®²» ¯°®¶¥¤³°» Naive-String-Matcher ¢ µ³¤¸¥¬
±«³· ¥ ¥±²¼ ((n ; m + 1)m).  ± ¬®¬ ¤¥«¥, ¯³±²¼ T = an (¡³ª¢ 
a, ¯®¢²®°
¥­­ ¿ n ° §),   P = am . ®£¤  ¤«¿ ª ¦¤®© ¨§ n ; m + 1
¯°®¢¥°®ª (±²°®ª  4) ¡³¤¥² ¢»¯®«­¥­® m ±° ¢­¥­¨© ±¨¬¢®«®¢, ¢±¥£®
(n ; m + 1)m, ·²® ¥±²¼ (n2 ) (¯°¨ m = bn=2c).
°®±²¥©¸¨©  «£®°¨²¬ | ­¥ «³·¸¨© (¤ «¥¥ ¬» ° ±±ª ¦¥¬ ®¡  «£®°¨²¬¥, ° ¡®² ¾¹¥¬ §  ¢°¥¬¿ O(n + m)). ¥½´´¥ª²¨¢­®±²¼ ¯°®¨±. 34.3
®¤¯¨±¼:
¨±. 34.3. °®±²¥©¸¨©  «£®°¨²¬ ¨¹¥² ®¡° §¥¶ P = aab ¢ ²¥ª±²¥ T = acaabc. ¥²»°¥ ¯®±«¥¤®¢ ²¥«¼­»¥ ¯®¯»²ª¨ ¨§®¡° ¦¥­»
­  °¨±. ( ){(£). ³ª¢», ¤«¿ ª®²®°»µ ±° ¢­¥­¨¥ ¯°®¸«® ³±¯¥¸­®,
±®¥¤¨­¥­» ¨ ¯®ª § ­» ±¥°»¬. ³ª¢», ­  ª®²®°»µ ¢»¿¢«¥­® ­¥±®¢¯ ¤¥­¨¥, ±®¥¤¨­¥­» «®¬ ­»¬¨ «¨­¨¿¬¨. °¨ ½²®¬ s = 2 | ¥¤¨­±²¢¥­­»© ¤®¯³±²¨¬»© ±¤¢¨£.

766

« ¢  34 ®¨±ª ¯®¤±²°®ª

±²¥©¸¥£®  «£®°¨²¬  ±¢¿§ ­  ± ²¥¬, ·²® ¨­´®°¬ ¶¨¿ ® ²¥ª±²¥ T ,
¯®«³· ¥¬ ¿ ¯°¨ ¯°®¢¥°ª¥ ¤ ­­®£® ±¤¢¨£  s, ­¨ª ª ­¥ ¨±¯®«¼§³¥²±¿
¯°¨ ¯°®¢¥°ª¥ ¯®±«¥¤³¾¹¨µ ±¤¢¨£®¢. ¥¦¤³ ²¥¬ ² ª ¿ ¨­´®°¬ ¶¨¿
¬®¦¥² ®·¥­¼ ¯®¬®·¼. ³±²¼, ­ ¯°¨¬¥°, P = aaab ¨ ¬» ¢»¿±­¨«¨,
·²® ±¤¢¨£ s = 0 ¤®¯³±²¨¬. ®£¤  ±¤¢¨£¨ 1, 2 ¨ 3 § ¢¥¤®¬® ­¥¤®¯³±²¨¬», ¯®±ª®«¼ª³ T [4] = b.  «¥¥ ¬» ®¡±³¤¨¬ ° §«¨·­»¥ ±¯®±®¡»
°¥ «¨§ ¶¨¨ ½²®© ¨¤¥¨.
¯° ¦­¥­¨¿
34.1-1
 ª¨¥ ±° ¢­¥­¨¿ ±¨¬¢®«®¢ ¤¥« ¥² ¯°®±²¥©¸¨©  «£®°¨²¬ ¯°¨ P =
0001 ¨ T = 000010001010001?
34.1-2
®ª ¦¨²¥, ·²® ¢ µ³¤¸¥¬ ±«³· ¥ ¯°®±²¥©¸¨©  «£®°¨²¬ ­ ©¤¥²
¯¥°¢®¥ ¢µ®¦¤¥­¨¥ ¯®¤±²°®ª¨ §  ¢°¥¬¿ ((n ; m + 1)(m ; 1)).
34.1-3
³±²¼ ¢±¥ ±¨¬¢®«» ¢ ®¡° §¶¥ P ° §«¨·­».  ª ³±®¢¥°¸¥­±²¢®¢ ²¼  «£®°¨²¬ Naive-String-Matcher, ·²®¡» ®­ ° ¡®² « §  ¢°¥¬¿ O(n), £¤¥ n | ¤«¨­  ²¥ª±² ?
34.1-4
³±²¼  «´ ¢¨² ±®¤¥°¦¨² d ±¨¬¢®«®¢, ¨ ¯³±²¼ ®¡° §¥¶ ¨ ²¥ª±² |
±«³· ©­»¥ ±²°®ª¨ ¤«¨­» m ¨ n ±®®²¢¥²±²¢¥­­®. ®ª ¦¨²¥, ·²® ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ·¨±«  ±° ¢­¥­¨© ±¨¬¢®«®¢, ¯°®¨§¢®¤¨¬»µ
¯°®±²¥©¸¨¬  «£®°¨²¬®¬ ¯°¨ ¢»¯®«­¥­¨¨ ±²°®ª¨ 4, ¥±²¼
;m
(n ; m + 1) 11 ;; dd;1 6 2(n ; m + 1)
(±° ¢­¥­¨¥ ±²°®ª ¯°¥ª° ¹ ¥²±¿, ª ª ²®«¼ª® ­ ©¤¥­» ­¥±®¢¯ ¤ ¾¹¨¥ ±¨¬¢®«» ¨«¨ ª®£¤  ¯°®±¬®²°¥­ ¢¥±¼ ®¡° §¥¶).  ª¨¬ ®¡° §®¬,
¤«¿ ±«³· ©­»µ ±²°®ª ¯°®±²¥©¸¨©  «£®°¨²¬ ¢¯®«­¥ ½´´¥ª²¨¢¥­.
34-1.5 ³±²¼ ¢ ®¡° §¶¥ (­® ­¥ ¢ ²¥ª±²¥!) ¬®¦¥² ¢±²°¥· ²¼±¿, ­ °¿¤³ ± ±¨¬¢®« ¬¨ ¨§  «´ ¢¨²  , ±¨¬¢®« , ­ §»¢ ¥¬»© ±¨¬¢®«®¬ ¯°®¯³±ª  (gap character), ª®²®°»© ±®®²¢¥²±²¢³¥² ¯°®¨§¢®«¼­®© ¯®¤±²°®ª¥ (¢ ²®¬ ·¨±«¥ ¯³±²®©).  ¯°¨¬¥°, ®¡° §¥¶ abbac
¢µ®¤¨² ¢ ²¥ª±² cabccbacbacab ¨ ª ª

;

c |{z}
ab |{z}
cc |{z}
ba |{z}
cba |{z}
c ab
c
ab
ba

¨ ª ª





c |{z}
ab |ccbac
ba |{z} |{z}
c ab
{z } |{z}
c
ab
ba





:

 §° ¡®² ©²¥ ¯®«¨­®¬¨ «¼­»©  «£®°¨²¬, ¢»¿±­¿¾¹¨©, ¢µ®¤¨² «¨
¤ ­­»© ®¡° §¥¶ (± ±¨¬¢®« ¬¨ ¯°®¯³±ª ) ¢ ¤ ­­»© ²¥ª±².

«£®°¨²¬  ¡¨­  |  °¯ 

767

34.2. «£®°¨²¬  ¡¨­  |  °¯ 
 ¡¨­ ¨  °¯ ¨§®¡°¥«¨  «£®°¨²¬ ¯®¨±ª  ¯®¤±²°®ª, ª®²®°»© ½´´¥ª²¨¢¥­ ­  ¯° ª²¨ª¥ ¨ ª ²®¬³ ¦¥ ®¡®¡¹ ¥²±¿ ­  ¤°³£¨¥  ­ «®£¨·­»¥ § ¤ ·¨ (­ ¯°¨¬¥°, ¯®¨±ª ®¡° §¶  ­  ¤¢³¬¥°­®© °¥¸¥²ª¥).
®²¿ ¢ µ³¤¸¥¬ ±«³· ¥ ¢°¥¬¿ ° ¡®²»  «£®°¨²¬   ¡¨­ - °¯  ¥±²¼
((n ; m + 1)m), ¢ ±°¥¤­¥¬ ®­ ° ¡®² ¥² ¤®±² ²®·­® ¡»±²°®.
°¥¤¯®«®¦¨¬ ¤«¿ ­ · « , ·²®  = f 0; 1; 2; : : :; 9 g (¢ ®¡¹¥¬ ±«³· ¥ ¬®¦­® ±·¨² ²¼, ·²® ª ¦¤»© ±¨¬¢®« ¢  «´ ¢¨²¥  ¥±²¼ d-¨·­ ¿
¶¨´° , £¤¥ d = jj). ®£¤  ±²°®ª³ ¨§ k ±¨¬¢®«®¢ ¬®¦­® ° ±±¬ ²°¨¢ ²¼ ª ª ¤¥±¿²¨·­³¾ § ¯¨±¼ ·¨±«  (k-§­ ·­®£®),   ± ¬¨ ±¨¬¢®«» |
ª ª ¶¨´°».
±«¨ P [1::m] | ®¡° §¥¶, ²® ·¥°¥§ p ®¡®§­ ·¨¬ ·¨±«®, ¤¥±¿²¨·­®©
§ ¯¨±¼¾ ª®²®°®£® ®­ ¿¢«¿¥²±¿;  ­ «®£¨·­®, ¥±«¨ T [1::n] | ²¥ª±²,
²® ¤«¿ s = 0; 1; : : :; n ; m ®¡®§­ ·¨¬ ·¥°¥§ ts ·¨±«®, ¤¥±¿²¨·­®© § ¯¨±¼¾ ª®²®°®£® ¿¢«¿¥²±¿ ±²°®ª  T [s + 1::s + m]. ·¥¢¨¤­®, s ¿¢«¿¥²±¿ ¤®¯³±²¨¬»¬ ±¤¢¨£®¬ ²®£¤  ¨ ²®«¼ª® ²®£¤ , ª®£¤  ts = p. ±«¨
¡» ¬» ¬®£«¨ ¢»·¨±«¨²¼ p §  ¢°¥¬¿ O(m) ¨ ¢±¥ ti §  ¢°¥¬¿ O(n)
(¢°¥¬¥­­® § ª°®¥¬ £« §  ­  ²® ®¡±²®¿²¥«¼±²¢®, ·²® ½²¨ ¢»·¨±«¥­¨¿ ¬®£³² ¯°¨¢¥±²¨ ª ±«¨¸ª®¬ ¡®«¼¸¨¬ ·¨±« ¬), ²® ¬» ±¬®£«¨ ¡»
­ ©²¨ ¢±¥ ¤®¯³±²¨¬»¥ ±¤¢¨£¨ §  ¢°¥¬¿ O(n), ±° ¢­¨¢ ¿ p ±® ¢±¥¬¨
ts ¯® ®·¥°¥¤¨.
»·¨±«¨²¼ p §  ¢°¥¬¿ O(m) ¤¥©±²¢¨²¥«¼­® ¬®¦­®, ¯® ±µ¥¬¥ ®°­¥°  (° §¤. 32.1):
p = P [m] + 10(P [m ; 1] + 10(P [m ; 2] +    + 10(P [2] + 10P [1]) : : : )):
®·­® ² ª ¦¥ §  ¢°¥¬¿ O(m) ¬®¦­® ¢»·¨±«¨²¼ t0 .
²®¡» ¢»·¨±«¨²¼ t1 ; t2 ; : : :; tn;m §  ¢°¥¬¿ O(n ; m), § ¬¥²¨¬,
·²® ¯°¨ ¨§¢¥±²­®¬ ts ¬®¦­® ¢»·¨±«¨²¼ ts+1 §  ¢°¥¬¿ O(1).  ± ¬®¬
¤¥«¥,
ts+1 = 10(ts ; 10m;1 T [s + 1]) + T [s + m + 1] :
(34:1)
·²®¡» ¯®«³·¨²¼ ±²°®ª³ T [s + 2::s + m + 1] ¨§ T [s + 1::s + m], ­ ¤®
³¤ «¨²¼ T [s + 1] (²® ¥±²¼ ¢»·¥±²¼ 10m;1 T [s + 1] ¨§ ts ) ¨ ¯°¨¯¨± ²¼ ±¯° ¢  T [s + m + 1] (²® ¥±²¼ ³¬­®¦¨²¼ ¯®«³·¥­­³¾ ° §­®±²¼
­  10 ¨ ¯°¨¡ ¢¨²¼ ª ­¥© T [s + m + 1]). ±«¨ ¢»·¨±«¨²¼ ª®­±² ­²³ 10m;1 § ° ­¥¥ (± ¯®¬®¹¼¾ ²¥µ­¨ª¨, ®¯¨± ­­®© ¢ ° §¤. 33.6, ½²®
¬®¦­® ±¤¥« ²¼ §  ¢°¥¬¿ O(lg m); ¢¯°®·¥¬, ®¶¥­ª  ­¥ ³µ³¤¸¨²±¿,
¥±«¨ ­¥¯®±°¥¤±²¢¥­­® ¯¥°¥¬­®¦¨²¼ m ; 1 ¤¥±¿²ª³ §  ¢°¥¬¿ O(m)),
²® ±²®¨¬®±²¼ ¢»·¨±«¥­¨© ¯® ´®°¬³«¥ (34.1) ®£° ­¨·¥­  ±¢¥°µ³ ª®­±² ­²®©; ±² «® ¡»²¼, ·¨±«  p ¨ t0 ; t1; : : :; tn;m ¬®£³² ¡»²¼ ­ ©¤¥­»
§  ¢°¥¬¿ O(n + m), ¨ ² ª¦¥ §  ¢°¥¬¿ O(n + m) ¬®£³² ¡»²¼ ­ ©¤¥­»
¢±¥ ¢µ®¦¤¥­¨¿ ®¡° §¶  P [1::m] ¢ ²¥ª±² T [1::n].
® ±¨µ ¯®° ¬» ­¥ ³·¨²»¢ «¨ ²®£®, ·²® ·¨±«  p ¨ ts ¢¥«¨ª¨ |
­ ±²®«¼ª®, ·²® ¯°¥¤¯®«®¦¥­¨¥ ® ¢»¯®«­¥­¨¨  °¨´¬¥²¨·¥±ª¨µ ®¯¥-

768

« ¢  34 ®¨±ª ¯®¤±²°®ª

° ¶¨© §  ¢°¥¬¿ O(1) ¥¤¢  «¨ ¤®¯³±²¨¬®.  ±· ±²¼¾, ½²³ ²°³¤­®±²¼
¬®¦­® ®¡®©²¨ ±«¥¤³¾¹¨¬ ®¡° §®¬: ­ ¤® ¯°®¢®¤¨²¼ ¢»·¨±«¥­¨¿
·¨±¥« p ¨ t0 ,   ² ª¦¥ ¢»·¨±«¥­¨¿ ¯® ´®°¬³«¥ (34.1), ¯® ¬®¤³«¾
´¨ª±¨°®¢ ­­®£® ·¨±«  q (°¨±. 34.4; ¯® ¯®¢®¤³  °¨´¬¥²¨ª¨ ¯® ¬®¤³«¾ q ±¬. ° §¤. 33.1). ®£¤  ¢±¥ ·¨±«  ­¥ ¯°¥¢®±µ®¤¿² q ¨ ¬®¦­®
±·¨² ²¼, ·²® ·¨±«® p ¨ ¢±¥ tj ¡³¤³² ¤¥©±²¢¨²¥«¼­® ¢»·¨±«¥­» § 
¢°¥¬¿ O(n + m). ¡»·­® ¢ ª ·¥±²¢¥ q ¢»¡¨° ¾² ¯°®±²®¥ ·¨±«®,
¤«¿ ª®²®°®£® 10q ¯®¬¥¹ ¥²±¿ ¢ ¬ ¸¨­­®¥ ±«®¢® | ½²® ³¯°®¹ ¥² ¯°®£° ¬¬¨°®¢ ­¨¥ ¢»·¨±«¥­¨©.  ®¡¹¥¬ ±«³· ¥ (¤«¿  «´ ¢¨² 
f 0; 1; 2; : : :; d g) ¢»¡¨° ¾² ² ª®¥ ¯°®±²®¥ ·¨±«® q, ·²® dq ¯®¬¥¹ ¥²±¿ ¢ ¬ ¸¨­­®¥ ±«®¢® (¡« £®¤ °¿ ½²®¬³ ¢±¥  °¨´¬¥²¨·¥±ª¨¥ ®¯¥° ¶¨¨ ¯°®¨±µ®¤¿² ¢ ¯°¥¤¥« µ ®¤­®£® ±«®¢ ); °¥ª³°°¥­²­®¥ ±®®²­®¸¥­¨¥ (34.1) ¯°¨®¡°¥² ¥² ¢¨¤
ts+1 = (d(ts ; T [s + 1]h) + T [s + m + 1]) mod q;
(34:2)
£¤¥ h  dm;1 (mod q ).
»·¨±«¥­¨¿ ¯® ¬®¤³«¾ q µ®°®¸¨ ¢±¥¬, ª°®¬¥ ®¤­®£®: ¨§ ° ¢¥­±²¢  ts  p (mod q ) ¥¹¥ ­¥ ±«¥¤³¥², ·²® ts = p. ®½²®¬³, ¥±«¨ ts 6 p
(mod q ), ²® ±¤¢¨£ s § ¢¥¤®¬® ­¥¤®¯³±²¨¬ ¨ ® ­¥¬ ¬®¦­® § ¡»²¼,  
¥±«¨ ts  p (mod q ), ²® ­ ¤® ¥¹¥ ¯°®¢¥°¨²¼, ±®¢¯ ¤ ¾² «¨ ±²°®ª¨
P [1::m] ¨ T [s+1::s+m] ­  ± ¬®¬ ¤¥«¥. ±«¨ ±®¢¯ ¤ ¾², ²® ¬» ­ ¸«¨
¢µ®¦¤¥­¨¥ ®¡° §¶  ¢ ±²°®ª³,   ¥±«¨ ­¥ ±®¢¯ ¤ ¾², ²® ¯°®¨§®¸«®
µ®«®±²®¥ ±° ¡ ²»¢ ­¨¥ (spurious hit). ±«¨ ¯°®±²®¥ ·¨±«® q ¤®±² ²®·­® ¢¥«¨ª®, ²® ¬®¦­® ­ ¤¥¿²¼±¿, ·²® ¤®¯®«­¨²¥«¼­»¥ § ²° ²»
­   ­ «¨§ µ®«®±²»µ ±° ¡ ²»¢ ­¨© ¡³¤³² ­¥¢¥«¨ª¨.
 ¯¨¸¥¬ ²¥ª±² ±®®²¢¥²±²¢³¾¹¥© ¯°®¶¥¤³°» Rabin-KarpMatcher. ­  ¯®«³· ¥² ­  ¢µ®¤ ²¥ª±² T , ®¡° §¥¶ P , À®±­®¢ ­¨¥
±¨±²¥¬» ±·¨±«¥­¨¿Á d (®¡»·­® ¡¥°³² d = jj) ¨ ¯°®±²®¥ ·¨±«® q .
Rabin-Karp-Matcher(T,P,d,q)
1 n \gets length[T]
2 m \gets length[P]
3 h \gets d^{m-1} \bmod q
4 p \gets 0
5 t \gets 0
6 for i \gets 1 to m
7
do p \gets (dp+P[i]) \bmod q
8
t \gets (dt+T[i]) \bmod q
9 for s \gets 0 to n-m
10
do if p=t
11
then if P[1..m]=T[s+1..s+m]
12
then print ``¡° §¥¶ ¢µ®¤¨² ±® ±¤¢¨£®¬ ''s
13
if s<n-m
14
then t \gets (d(t-T[s+1]h) + T[s+m+1]) \bmod q

¯¨¸¥¬ ° ¡®²³ ¯°®¶¥¤³°». ±¥ ±¨¬¢®«» ° ±±¬ ²°¨¢ ¾²±¿ ª ª

d-¨·­»¥ ¶¨´°».  ±²°®ª µ 1{5 ¯¥°¥¬¥­­»¬ ¯°¨±¢ ¨¢ ¾²±¿ ­ · «¼-

«£®°¨²¬  ¡¨­  |  °¯ 

769

¨±.34.4, § ­¨¬ ¾¹¨© ¶¥«³¾ ±²° ­¨¶³.
¥°¥¢®¤» ­ ¤¯¨±¥©, ¢µ®¤¿¹¨µ ¢ °¨±³­®ª: valid match | ¢µ®¦¤¥­¨¥ ®¡° §¶ , spurious hit | µ®«®±²®¥ ±° ¡ ²»¢ ­¨¥, old high-order
digit | ¶¨´°  ±² °¸¥£® ° §°¿¤ , new low-order digit | ¶¨´°  ¬« ¤¸¥£® ° §°¿¤ , shift ­¥ ¯¥°¥¢®¤¨²¼ ¨ ­¥ ¢®±¯°®¨§¢®¤¨²¼ (­¨ ±«®¢®,
­¨ ±²°¥«ª³).

®¤¯¨±¼:
¨±.34.4. «£®°¨²¬  ¡¨­ - °¯ .  = f 0; 1; 2; : : :; 9 g, q = 13. ( )
²°®ª  T (²¥ª±²). ¥°»¬ ¢»¤¥«¥­® ®ª®¸ª® ¸¨°¨­» 5. ¨±«¥­­®¥
§­ ·¥­¨¥ ¢»¤¥«¥­­®© ¯®¤±²°®ª¨ ° ¢­® 7 ¯® ¬®¤³«¾ 13. (¡) «¿ ²®£®
¦¥ ²¥ª±²  ³ª § ­» ·¨±«¥­­»¥ §­ ·¥­¨¿ (¯® ¬®¤³«¾ 13) ¢±¥µ ¯®¤±²°®ª ¤«¨­» 5. ±«¨ ®¡° §¥¶ ¥±²¼ P = 31415, ²® ­ ± ¨­²¥°¥±³¾²
¯®¤±²°®ª¨ ±® §­ ·¥­¨¥¬ 7, ¯®±ª®«¼ª³ 31415  7 (mod 13).  ª¨µ
¯®¤±²°®ª ¢±¥£® ¤¢¥; ®¤­  ¨§ ­¨µ ±®®²¢¥²±²¢³¥² ¢µ®¦¤¥­¨¾ ®¡° §¶ 
¢ ²¥ª±²,   ¤°³£ ¿ | µ®«®±²®¬³ ±° ¡ ²»¢ ­¨¾. (¢) §¬¥­¥­¨¥ ·¨±«®¢®£® §­ ·¥­¨¿ ¯°¨ ±¤¢¨£¥ ®ª®¸ª .  ¯°¥¤»¤³¹¥¬ ®ª®¸ª¥ ±²®¿«®
31415. ¤ «¨¢ ¶¨´°³ ±² °¸¥£® ° §°¿¤  ¨ ¯°¨¯¨± ¢ ­®¢³¾ ¶¨´°³
¬« ¤¸¥£® ° §°¿¤ , ¯®«³· ¥¬ 14152. ¥ ¦¥ ¢»·¨±«¥­¨¿ ¯® ¬®¤³«¾
13 ¨§ ±² °®£® §­ ·¥­¨¿ 7 ¯®«³· ¾² ­®¢®¥ §­ ·¥­¨¥ 8.

770

« ¢  34 ®¨±ª ¯®¤±²°®ª

­»¥ §­ ·¥­¨¿ (h | ½²® À¥¤¨­¨¶  ±² °¸¥£® ° §°¿¤ Á ¢ d-¨·­®© ±¨±²¥¬¥).  ¶¨ª«¥ ¢ ±²°®ª µ 6{8 ± ¯®¬®¹¼¾ ±µ¥¬» ®°­¥°  ¢»·¨±«¿¾²±¿ §­ ·¥­¨¿ p ¨ t0 (¯®±«¥¤­¥¥ ¯°¨±¢ ¨¢ ¥²±¿ ¯¥°¥¬¥­­®© t).
¨ª« ¢ ±²°®ª µ 9{14 ¯¥°¥¡¨° ¥² ¢±¥ ¢®§¬®¦­»¥ §­ ·¥­¨¿ s; ¢ ¬®¬¥­² ¨±¯®«­¥­¨¿ ±²°®ª¨ 10 ¨¬¥¥¬ t  ts (mod q ). ±«¨ ®ª §»¢ ¥²±¿, ·²® ts  p, ²® ±²°®ª¨ T [s +1::s + m] ¨ P [1::m] ±° ¢­¨¢ ¾²±¿ ¨, ¢
±«³· ¥ ±®¢¯ ¤¥­¨¿, ®¡ ½²®¬ ¯¥· ² ¥²±¿ ±®®¡¹¥­¨¥ (±²°®ª¨ 11{12).
±«¨ ts 6 p, ²® ¯°®£° ¬¬  ¯°®¢¥°¿¥², ¡³¤¥² «¨ ¶¨ª« ¢»¯®«­¿²¼±¿
¤ «¥¥ (±²°®ª  13), ¨ ¥±«¨ ¡³¤¥², ²® ®¡­®¢«¿¥² §­ ·¥­¨¥ t ¯® ´®°¬³«¥ (34.2) | ±²°®ª  14.
 µ³¤¸¥¬ ±«³· ¥ ½²  ¯°®¶¥¤³°  ²°¥¡³¥² ¢°¥¬¥­¨ ((n ; m +1)m),
ª ª ¨ ¯°®±²¥©¸¨©  «£®°¨²¬ | ³¦¥ ¯®²®¬³, ·²® ¤«¿ ¢±¥µ ¤®¯³±²¨¬»µ ±¤¢¨£®¢ ¯°®¨±µ®¤¨² ¯®±¨¬¢®«¼­ ¿ ¯°®¢¥°ª .  ¯°¨¬¥°, ¥±«¨
P = am ¨ T = an , ²® ±° ¢­¥­¨¥ ¢ ±²°®ª¥ 11 ¡³¤¥² ¢»¯®«­¿²¼±¿ ¤«¿
¢±¥µ §­ ·¥­¨© s (¨  «£®°¨²¬ ®²«¨· ¥²±¿ ®² ²°¨¢¨ «¼­®£® «¨¸¼ ¢
µ³¤¸³¾ ±²®°®­³ §  ±·¥² ¤®¯®«­¨²¥«¼­»µ § ²° ² ­  ¢»·¨±«¥­¨¥ h
¢ ±²°®ª¥ 3, ­  ¶¨ª« ¢ ±²°®ª µ 6{8 ¨ ­  ¢»·¨±«¥­¨¿ ¢ ±²°®ª¥ 14).
® ¬­®£¨µ ¯°¨«®¦¥­¨¿µ ±«¥¤³¥² ®¦¨¤ ²¼, ·²® ¤®¯³±²¨¬»µ ±¤¢¨£®¢ ¡³¤¥² ­¥¬­®£®; ¢ ½²®¬ ±«³· ¥ ¢°¥¬¿ ° ¡®²»  «£®°¨²¬   ¡¨­ 
|  °¯  ¡³¤¥² O(n + m) ¯«¾± ­¥¡®«¼¸¨¥ ¤®¯®«­¨²¥«¼­»¥ § ²° ²»
­  ®¡° ¡®²ª³ µ®«®±²»µ ±° ¡ ²»¢ ­¨©. ®¦­® ±¤¥« ²¼ ­¥±²°®£³¾
¯°¨ª¨¤ª³, ®±­®¢»¢ ¿±¼ ­  ±«¥¤³¾¹¨µ ±®®¡° ¦¥­¨¿µ. ³¤¥¬ ±·¨² ²¼, ·²® ®²®¡° ¦¥­¨¥ °¥¤³ª¶¨¨ ¯® ¬®¤³«¾ q | ±«³· ©­ ¿ ´³­ª¶¨¿ ¨§  ¢ Zq . ²® ³²¢¥°¦¤¥­¨¥ ²°³¤­® ¯®¤¤ ¥²±¿ ´®°¬ «¨§ ¶¨¨ ¨
¤®ª § ²¥«¼±²¢³, ­® ½¬¯¨°¨·¥±ª¨ ¯®¤²¢¥°¦¤ ¥²±¿ (±°. ° §¤. 12.3.1,
£¤¥ ¬» ®¡±³¦¤ «¨ ¯°¨¬¥­¥­¨¥ ¤¥«¥­¨¿ ± ®±² ²ª®¬ ª µ¥¸¨°®¢ ­¨¾).
®£¤  ¬®¦­® ­ ¤¥¿²¼±¿, ·²® ª®«¨·¥±²¢® µ®«®±²»µ ±° ¡ ²»¢ ­¨©
¥±²¼ O(n=q ), ¯®±ª®«¼ª³ ¢¥°®¿²­®±²¼ ²®£®, ·²® ±«³· ©­®¥ ·¨±«® ts
±° ¢­¨¬® ± p ¯® ¬®¤³«¾ q , ° ¢­  1=q . ² «® ¡»²¼, ®¦¨¤ ¥¬®¥ ¢°¥¬¿
° ¡®²»  «£®°¨²¬   ¡¨­  |  °¯  ¥±²¼

O(n) + O(m(v + n=q ));
£¤¥ v | ª®«¨·¥±²¢® ¢µ®¦¤¥­¨© ®¡° §¶  ¢ ²¥ª±². ±«¨ q > m (²®
¥±²¼ ¤«¨­  ®¡° §¶  ­¥ ¯°¥¢®±µ®¤¨² ¢»¡° ­­®£® §­ ·¥­¨¿ q ) ¨ v =
O(1), ²® ¯®«³· ¥²±¿, ·²®  «£®°¨²¬ ° ¡®² ¥² §  ¢°¥¬¿ O(n + m).
34.2.1. ¯° ¦­¥­¨¿
34.2-1
ª®«¼ª® µ®«®±²»µ ±° ¡ ²»¢ ­¨© ¤ ±²  «£®°¨²¬  ¡¨­ - °¯ ,
¥±«¨ q = 11, T = 3141592653589793 ¨ P = 26?
34.2-2 ¡®¡¹¨²¥  «£®°¨²¬  ¡¨­  |  °¯  ­  ±«³· ©, ª®£¤  ¢
²¥ª±²¥ ­ ¤® ¨±ª ²¼ ®¤­³ ¨§ k ¤ ­­»µ ¯®¤±²°®ª.
34-2.3 ¡®¡¹¨²¥  «£®°¨²¬  ¡¨­  |  °¯  ­  ±«³· ©, ª®£¤  ­ ¤® ¨±ª ²¼ ª¢ ¤° ² ° §¬¥°®¬ m  m ¢ ¬ ²°¨¶¥ ° §¬¥°®¬ n  n ±

®¨±ª ¯®¤±²°®ª ± ¯®¬®¹¼¾ ª®­¥·­»µ  ¢²®¬ ²®¢

771

§ ¤ ­­»¬ ±®¤¥°¦¨¬»¬ (².¥. ¯®«³· ¾¹¨©±¿ ¨§ ®¡° §¶  ¯ ° ««¥«¼­»¬ ¯¥°¥­®±®¬).
34-2.4  ­¨ ­  ª®¬¯¼¾²¥°¥ ¥±²¼ n-¡¨²®¢»© ´ ©« A =
han;1; an;2; : : :; a0i,   ³ ®°¨ | n -¡¨²®¢»© ´ ©« B =
hbn;1; bn;2; : : :; b0i. ­¨ µ®²¿² ¯°®¢¥°¨²¼, ¨¤¥­²¨·­» «¨ ½²¨ ´ ©«»,
­¥ ¯¥°¥±»« ¿ ¨µ ¤°³£ ¤°³£³, ±«¥¤³¾¹¨¬ ®¡° §®¬. »¡¨° ¥²±¿ ¯°®±²®¥ ·¨±«® q > 1000n ¨ ±«³· ©­®¥ ¶¥«®¥ ·¨±«® x 2 f0; 1; : : :; q ; 1g.
®±«¥ ½²®£® ­¿ ¢»·¨±«¿¥² ¢»° ¦¥­¨¥

A(x) =

n
X
i=0

ai xi

!

mod q;

  ®°¿ ¢»·¨±«¿¥²  ­ «®£¨·­®¥ ¢»° ¦¥­¨¥ B (x). ®ª ¦¨²¥, ·²®, ¥±«¨ A 6= B , ±³¹¥±²¢³¥² «¨¸¼ ®¤¨­ ¸ ­± ¨§ ²»±¿·¨, ·²® A(x) = B (x)
(¨ ³¦ ª®­¥·­® A(x) = B (x), ¥±«¨ A = B ). (ª § ­¨¥: ¢®±¯®«¼§³©²¥±¼ ³¯° ¦­¥­¨¥¬ 33.4-4).

34.3. ®¨±ª ¯®¤±²°®ª ± ¯®¬®¹¼¾ ª®­¥·­»µ  ¢²®¬ ²®¢
­®£¨¥  «£®°¨²¬» ¤«¿ ¯®¨±ª  ¯®¤±²°®ª ­ ·¨­ ¾² ± ²®£®, ·²®
±²°®¿² ª®­¥·­»©  ¢²®¬ ², ª®²®°»© ­ µ®¤¨² ¢ ²¥ª±²¥ T ¢±¥ ¢µ®¦¤¥­¨¿ ®¡° §¶  P .  ½²®¬ ° §¤¥«¥ ¬» ®¯¨¸¥¬, ª ª ¬®¦­® ¯®±²°®¨²¼
² ª®©  ¢²®¬ ².  ¬ ¯® ±¥¡¥ ¯®¨±ª ¯®¤±²°®ª¨ ± ¯®¬®¹¼¾ ª®­¥·­®£®
 ¢²®¬ ²  ¢¥±¼¬  ½´´¥ª²¨¢¥­: ª ¦¤»© ±¨¬¢®« ¯®±²³¯ ¥² ­  ¢µ®¤
ª®­¥·­®£®  ¢²®¬ ²  ²®«¼ª® ¥¤¨­®¦¤»,   ®¡° ¡®²ª  ª ¦¤®£® ±¨¬¢®«  § ­¨¬ ¥² ®£° ­¨·¥­­®¥ ¢°¥¬¿, ² ª ·²® ®¡¹¥¥ ¢°¥¬¿ ° ¡®²»
¥±²¼ (n) | ¯®±«¥ ²®£®, ®¤­ ª®, ª ª  ¢²®¬ ² ¯®±²°®¥­!  ±®¦ «¥­¨¾, ¢°¥¬¿ ­  ¯®±²°®¥­¨¥ ª®­¥·­®£®  ¢²®¬ ²  ¬®¦¥² ¡»²¼ ¢¥«¨ª®,
¥±«¨ ¢¥«¨ª  «´ ¢¨²  (¢ ° §¤. 34.4 ¬» ®¡±³¤¨¬ ®±²°®³¬­»© ±¯®±®¡
®¡®©²¨ ½²³ ²°³¤­®±²¼).
 ½²®¬ ° §¤¥«¥ ¬» ¤ ¤¨¬ ®¯°¥¤¥«¥­¨¥ ª®­¥·­®£®  ¢²®¬ ² , § ²¥¬ ° ±±¬®²°¨¬ ±¯¥¶¨ «¼­»© ª®­¥·­»©  ¢²®¬ ², ¯°¥¤­ §­ ·¥­­»©
¤«¿ ¯®¨±ª  ¯®¤±²°®ª, ¨ ­ ª®­¥¶ ¯®ª ¦¥¬, ª ª ±ª®­±²°³¨°®¢ ²¼
½²®²  ¢²®¬ ², ¨±µ®¤¿ ¨§ ¯®¤±²°®ª¨, ª®²®°³¾ ®­ ¯°¨§¢ ­ ¨±ª ²¼.
34.3.1. ®­¥·­»¥  ¢²®¬ ²»
® ®¯°¥¤¥«¥­¨¾, ª®­¥·­»©  ¢²®¬ ² (nite automaton) | ½²®
¯¿²¥°ª  M = (Q; q0; A; ;  ), £¤¥:
 Q | ª®­¥·­®¥ ¬­®¦¥±²¢® ±®±²®¿­¨© (states);
 q0 2 Q | ­ · «¼­®¥ ±®±²®¿­¨¥ (start state);
 A  Q | ª®­¥·­®¥ ¬­®¦¥±²¢® ¤®¯³±ª ¾¹¨µ ±®±²®¿­¨© (accepting states);

772

« ¢  34 ®¨±ª ¯®¤±²°®ª

¨±. 34.5. ¥°¥¢®¤» ±«®¢ ¢ °¨±³­ª¥: input | ¢µ®¤, state | ±®±²®¿­¨¥.
®¤¯¨±¼:
®­¥·­»©  ¢²®¬ ² ±® ¬­®¦¥±²¢®¬ ±®±²®¿­¨© Q = f0; 1g, ­ · «¼­»¬ ±®±²®¿­¨¥¬ q0 = 0 ¨ ¢µ®¤­»¬  «´ ¢¨²®¬  = fa; bg. ( )  ¡«¨¶  §­ ·¥­¨© ´³­ª¶¨¨ ¯¥°¥µ®¤   . (¡) ³­ª¶¨¿ ¯¥°¥µ®¤  ¢ ¢¨¤¥ ¤¨ £° ¬¬». ®±²®¿­¨¥ 1 | ¥¤¨­±²¢¥­­®¥ ¤®¯³±ª ¾¹¥¥ ±®±²®¿­¨¥ (·¥°­®¥). ²°¥«ª ¬¨ ¯®ª § ­» ¯¥°¥µ®¤».  ¯°¨¬¥° ±²°¥«ª 
¨§ ±®±²®¿­¨¿ 1 ¢ ±®±²®¿­¨¥ 0, ¯®¬¥·¥­­ ¿ ¡³ª¢®© b, ®§­ · ¥², ·²®
(1; b) = 0. ²®²  ¢²®¬ ² ¤®¯³±ª ¥² ±²°®ª¨, ®ª ­·¨¢ ¾¹¨¥±¿ ­ 
­¥·¥²­®¥ ·¨±«® ¡³ª¢ a (²®·­¥¥ £®¢®°¿, ±²°®ª¨ ¢¨¤  y ak , £¤¥ ±²°®ª 
y ¯³±²  ¨«¨ ®ª ­·¨¢ ¥²±¿ ­  b,   ·¨±«® k ­¥·¥²­®).  ¯°¨¬¥°, ¤«¿
¢µ®¤­®© ±²°®ª¨ abaaa ¯®±«¥¤®¢ ²¥«¼­®±²¼ ±®±²®¿­¨© (¢ª«¾· ¿ ¨±µ®¤­®¥) ¡³¤¥² h0; 1; 0; 1; 0; 1i, ¨ ½²  ±²°®ª  ¤®¯³±ª ¥²±¿; ¤«¿ ¢µ®¤­®©
±²°®ª¨ abbaa ¯®±«¥¤®¢ ²¥«¼­®±²¼ ±®±²®¿­¨© ¡³¤¥² h0; 1; 0; 0; 1; 0i, ¨
½²  ±²°®ª  ®²¢¥°£ ¥²±¿.

  | ª®­¥·­»© ¢µ®¤­®©  «´ ¢¨² (input alphabet);
  | ´³­ª¶¨¿ ¨§ Q   ¢ Q, ­ §»¢ ¥¬ ¿ ´³­ª¶¨¥© ¯¥°¥µ®¤  (tran-

sition function)  ¢²®¬ ² .
¥°¢®­ · «¼­® ª®­¥·­»©  ¢²®¬ ² ­ µ®¤¨²±¿ ¢ ±®±²®¿­¨¨ q0 ; § ²¥¬ ®­ ¯® ®·¥°¥¤¨ ·¨² ¥² ±¨¬¢®«» ¨§ ¢µ®¤­®© ±²°®ª¨.  µ®¤¿±¼
¢ ±®±²®¿­¨¨ q ¨ ·¨² ¿ ±¨¬¢®« a,  ¢²®¬ ² ¯¥°¥µ®¤¨² ¢ ±®±²®¿­¨¥
(q; a). ±«¨  ¢²®¬ ² ­ µ®¤¨²±¿ ¢ ±®±²®¿­¨¨ q 2 A, £®¢®°¿², ·²® ®­
¤®¯³±ª ¥² (accepts) ¯°®·¨² ­­³¾ · ±²¼ ¢µ®¤­®© ±²°®ª¨; ¥±«¨ ¦¥
q 2= A, ²® ¯°®·¨² ­­ ¿ · ±²¼ ±²°®ª¨ ®²¢¥°£­³²  (is rejected).  
°¨±. 34.5 ¯®ª § ­ ¯°¨¬¥° ¯°®±²®£®  ¢²®¬ ²  ± ¤¢³¬¿ ±®±²®¿­¨¿¬¨.
 ª®­¥·­»¬  ¢²®¬ ²®¬ M ±¢¿§ ­  ´³­ª¶¨¿ ' :  ! Q, ­ §»¢ ¥¬ ¿ ´³­ª¶¨¥© ª®­¥·­®£® ±®±²®¿­¨¿ (nal-state function), ®¯°¥¤¥«¿¥¬ ¿ ±«¥¤³¾¹¨¬ ®¡° §®¬: '(w) ¥±²¼ ±®±²®¿­¨¥, ¢ ª®²®°®¥ ¯°¨¤¥²
 ¢²®¬ ² (¨§ ­ · «¼­®£® ±®±²®¿­¨¿), ¯°®·¨² ¢ ±²°®ª³ w. ¢²®¬ ²
¤®¯³±ª ¥² ±²°®ª³ w ²®£¤  ¨ ²®«¼ª® ²®£¤ , ª®£¤  '(w) 2 A. ³­ª¶¨¾ ' ¬®¦­® ®¯°¥¤¥«¨²¼ °¥ª³°°¥­²­®:

'(") = q0 ;
'(wa) = ('(w); a)

¤«¿ «¾¡»µ w 2  ¨ a 2 .

34.3.2. ¢²®¬ ²» ¤«¿ ¯®¨±ª  ¯®¤±²°®ª
«¿ ª ¦¤®£® ®¡° §¶  P ¬®¦­® ¯®±²°®¨²¼ ª®­¥·­»©  ¢²®¬ ²,
¨¹³¹¨© ½²®² ®¡° §¥¶ ¢ ²¥ª±²¥ (±¬. °¨±. 34.6, £¤¥ ¨§®¡° ¦¥­  ¢²®¬ ², ±®®²¢¥²±²¢³¾¹¨© ®¡° §¶³ P = ababaca).  ´¨ª±¨°³¥¬ ¤®
ª®­¶  ½²®£® ° §¤¥«  ±²°®ª³-®¡° §¥¶ P .
¥°¢»¬ ¸ £®¬ ¢ ¯®±²°®¥­¨¨  ¢²®¬ ² , ±®®²¢¥²±²¢³¾¹¥£®
±²°®ª¥-®¡° §¶³ P [1::m], ¡³¤¥² ¯®±²°®¥­¨¥ ¯® P ¢±¯®¬®£ ²¥«¼­®©

®¨±ª ¯®¤±²°®ª ± ¯®¬®¹¼¾ ª®­¥·­»µ  ¢²®¬ ²®¢

773

´³­ª¶¨¨  :  ! f 0; 1; : : :; m g, ­ §»¢ ¥¬®© ±³´´¨ª±-´³­ª¶¨¥©
(sux function). ® ®¯°¥¤¥«¥­¨¾,  ±®¯®±² ¢«¿¥² ±²°®ª¥ x ¤«¨­³
¬ ª±¨¬ «¼­®£® ±³´´¨ª±  x, ¿¢«¿¾¹¥£®±¿ ¯°¥´¨ª±®¬ P :
 (x) = maxf k : Pk A x g:
®±ª®«¼ª³ P0 = " ¿¢«¿¥²±¿ ±³´´¨ª±®¬ «¾¡®© ±²°®ª¨,  ®¯°¥¤¥«¥­  ­  ¢±¥¬ . °¨¬¥°: ¥±«¨ P = ab, ²®  (") = 0,  (ccaca) = 1,
(ccab) = 2. ±«¨ ¤«¨­  P ° ¢­  m, ²® (x) = m ²®£¤  ¨ ²®«¼ª®
²®£¤ , ª®£¤  P | ±³´´¨ª± x. ±«¨ x A y , ²®  (x) 6  (y ).
¥¯¥°¼ ®¯°¥¤¥«¨¬ ª®­¥·­»©  ¢²®¬ ², ±®®²¢¥²±²¢³¾¹¨© ®¡° §¶³
P [1::m], ±«¥¤³¾¹¨¬ ®¡° §®¬:
 ­®¦¥±²¢® ±®±²®¿­¨© ¥±²¼ Q = f 0; 1; : : :; m g.  · «¼­®¥ ±®±²®¿­¨¥ q0 = 0, ¥¤¨­±²¢¥­­®¥ ¤®¯³±ª ¾¹¥¥ ±®±²®¿­¨¥ ¥±²¼ m.
 ³­ª¶¨¿ ¯¥°¥µ®¤   ®¯°¥¤¥«¥­  ±«¥¤³¾¹¥© ´®°¬³«®© (q | ±®±²®¿­¨¥, a 2  | ±¨¬¢®«):
 (q; a) =  (Pqa):
(34:3)
¡º¿±­¨¬, ®²ª³¤  ¡¥°¥²±¿ ´®°¬³«  (34.3). » µ®²¨¬ ±ª®­±²°³¨°®¢ ²¼  ¢²®¬ ² ² ª¨¬ ®¡° §®¬, ·²®¡» ¯°¨ ¥£® ¤¥©±²¢¨¨ ­  ±²°®ª³
T ±®®²­®¸¥­¨¥
'(Ti) =  (Ti)
(34:4)
¿¢«¿«®±¼ ¨­¢ °¨ ­²®¬ (²®£¤  ° ¢¥­±²¢® '(Ti) = m ¡³¤¥² ° ¢­®±¨«¼­® ²®¬³, ·²® P ¢µ®¤¨² ¢ T ±® ±¤¢¨£®¬ i ; m, ¨  ¢²®¬ ² ²¥¬
± ¬»¬ ­ ©¤¥² ¢±¥ ¤®¯³±²¨¬»¥ ±¤¢¨£¨). ® ¢ ½²®¬ ±«³· ¥ ¢»·¨±«¥­¨¥ ¯¥°¥µ®¤  ¯® ´®°¬³«¥ (34.3) ­¥®¡µ®¤¨¬® ¤«¿ ¯®¤¤¥°¦ ­¨¿
¨±²¨­­®±²¨ ¨­¢ °¨ ­²  (±¬. ²¥®°¥¬³ 34.4 ­¨¦¥).
 ¯°¨¬¥°, ¢  ¢²®¬ ²¥ °¨±. 34.6, ¨¬¥¥¬  (5; b) = 4: ¥±«¨ q = 5,
¯°®·¨² ­­ ¿ · ±²¼ ¢µ®¤  ª®­· ¥²±¿ ­  ababa, ¨ ¯®±«¥ ¤®¡ ¢«¥­¨¿
¢µ®¤­®£® ±¨¬¢®«  b ­ ¨¡®«¼¸¨© ±³´´¨ª± ¯°®·¨² ­­®© · ±²¨, ¿¢«¿¾¹¨©±¿ ¯°¥´¨ª±®¬ P , ¡³¤¥² ° ¢¥­ abab.
 ¯¨¸¥¬ ¤¥©±²¢¨¥ ª®­¥·­®£®  ¢²®¬ ² , ¨¹³¹¥£® ¯®¤±²°®ª³ P
¤«¨­» m ¢ ¤ ­­®¬ ²¥ª±²¥ T , ¢ ¢¨¤¥ ¯°®£° ¬¬» ( ®¡®§­ · ¥² ´³­ª¶¨¾ ¯¥°¥µ®¤ ):
Finite-Automaton-Matcher(T,\delta,m)
1 n \gets length[T]
2 q \gets 0
3 for i \gets 1 to n
4
do q \gets \delta(q, T[i])
5
if q=m
6
then s \gets i-m
7
print ``¡° §¥¶ ¢µ®¤¨² ±® ±¤¢¨£®¬ ''s

®±ª®«¼ª³ ½²  ¯°®£° ¬¬  ®¡° ¡ ²»¢ ¥² ª ¦¤»© ±¨¬¢®« ¨§ ²¥ª±²  T ¯® ° §³, ¢°¥¬¿ ¥¥ ° ¡®²» ¥±²¼ O(n). ¤­ ª® ±«¥¤³¥² ³·¥±²¼

774

« ¢  34 ®¨±ª ¯®¤±²°®ª

¨±. 34.6, § ­¨¬ ¾¹¨© ¶¥«³¾ ±²° ­¨¶³. ¥°¥¢®¤» ±«®¢, ¢µ®¤¿¹¨µ
¢ °¨±³­®ª: input | ¢µ®¤, state | ±®±²®¿­¨¥.

®¤¯¨±¼:
¨±. 34.6. ( )  ¡«¨¶  ¯¥°¥µ®¤®¢ ¤«¿ ª®­¥·­®£®  ¢²®¬ ² , ¤®¯³±ª ¾¹¥£® ±²°®ª¨, ®ª ­·¨¢ ¾¹¨¥±¿ ­  ababaca (¨ ²®«¼ª® ¨µ). ¤¥±¼
0 | ¨±µ®¤­®¥ ±®±²®¿­¨¥, 7 | ¥¤¨­±²¢¥­­®¥ ¤®¯³±ª ¾¹¥¥ ±®±²®¿­¨¥ (§ ·¥°­¥­®). ±«¨ ¨§ i ¢ j ¢¥¤¥² ±²°¥«ª , ¯®¬¥·¥­­ ¿ ¡³ª¢®© a,
½²® ®§­ · ¥², ·²®  (a; i) = j . ¨°­»¥ ±²°¥«ª¨, ¨¤³¹¨¥ ±«¥¢  ­ ¯° ¢®, ±®®²¢¥²±²¢³¾² ³±¯¥¸­»¬ ½² ¯ ¬ ¯®¨±ª  ¯®¤±²°®ª¨ P [¥±«¨
¬» ¢ ±®±²®¿­¨¨ j , ²® j ¯®±«¥¤­¨µ ¯°®·¨² ­­»µ ¡³ª¢ ²¥ª±²  ±®¢¯ ¤ ¾² ± j ¯¥°¢»¬¨ ¡³ª¢ ¬¨ ®¡° §¶ ; ¥±«¨ ¬» ¯¥°¥¸«¨ ¨§ ±®±²®¿­¨¿
j ¢ ±®±²®¿­¨¥ j + 1, ²® ®·¥°¥¤­ ¿ ¡³ª¢  ²¥ª±²  ² ª¦¥ ±®¢¯ ¤ ¥² ± ®·¥°¥¤­®© ¡³ª¢®© ®¡° §¶  | ¸ ­±» ­ ©²¨ ®¡° §¥¶ ° ±²³²!].
²°¥«ª¨, ¨¤³¹¨¥ ±¯° ¢  ­ «¥¢®, ±®®²¢¥²±²¢³¾² ­¥³¤ · ¬ [¯®±«¥¤­¨¥ j ¡³ª¢ ²¥ª±²  ±®¢¯ ¤ «¨ ± ¯¥°¢»¬¨ j ¡³ª¢ ¬¨ ®¡° §¶ , ­® ®·¥°¥¤­ ¿ ¡³ª¢  | ­¥ ² ª ¿, ª ª µ®²¥«®±¼ ¡»]. ¥ ¢±¥ ±²°¥«ª¨, ¨¤³¹¨¥ ±¯° ¢  ­ «¥¢®, ¯®ª § ­» ­  °¨±³­ª¥: ¥±«¨ ¨§ ±®±²®¿­¨¿ i ­¥
¢»µ®¤¨² ±²°¥«ª¨, ¯®¬¥·¥­­®© ¡³ª¢®© a, ²® ¯®¤° §³¬¥¢ ¥²±¿, ·²®
(i; a) = 0. (¡)  ¡«¨¶  ¯¥°¥µ®¤®¢ ¤«¿ ²®£® ¦¥  ¢²®¬ ² . «¥²®·ª¨,
±®®²¢¥²±²¢³¾¹¨¥ ³±¯¥¸­»¬ ½² ¯ ¬ ¯®¨±ª  (¦¨°­»¬ ±²°¥«ª ¬ ­ 
¤¨ £° ¬¬¥), ¢»¤¥«¥­» ±¥°»¬. (¢) ¥§³«¼² ² ¯°¨¬¥­¥­¨¿  ¢²®¬ ² 
ª ²¥ª±²³ T = abababacaba. ®¤ ª ¦¤»¬ ±¨¬¢®«®¬ T [i] § ¯¨± ­®
±®±²®¿­¨¥  ¢²®¬ ²  ¯®±«¥ ¯°®·²¥­¨¿ ½²®£® ±¨¬¢®«  (¨­»¬¨ ±«®¢ ¬¨, §­ ·¥­¨¥ '(Ti)).  ©¤¥­® ®¤­® ¢µ®¦¤¥­¨¥ ®¡° §¶  (­ ·¨­ ¿ ±
¯®§¨¶¨¨ 3).

®¨±ª ¯®¤±²°®ª ± ¯®¬®¹¼¾ ª®­¥·­»µ  ¢²®¬ ²®¢

775

¨±. 34.7
®¤¯¨±¼:
 ¤®ª § ²¥«¼±²¢³ «¥¬¬» 34.2: ¥±«¨ r =  (xa), ²® r 6  (x) + 1.
¨±. 34.8
®¤¯¨±¼:
 ¤®ª § ²¥«¼±²¢³ «¥¬¬» 34.3. § °¨±³­ª  ¢¨¤­®, ·²® r =  (Pq a),
£¤¥ q =  (x) ¨ r =  (xa).
¨ ¢°¥¬¿, ²°¥¡³¥¬®¥ ¤«¿ ¢»·¨±«¥­¨¿ ´³­ª¶¨¨ ¯¥°¥µ®¤   . »
½²¨¬ ¢±ª®°¥ § ©¬¥¬±¿, ­® ±­ · «  ¤®ª ¦¥¬, ·²® ¯°®¶¥¤³°  FiniteAutomaton-Matcher ¯° ¢¨«¼­® ­ µ®¤¨² ¢±¥ ¢µ®¦¤¥­¨¿ ¯®¤±²°®ª¨ T .
 ª ®²¬¥· «®±¼ ¢»¸¥, ­ ¬ ¤®±² ²®·­® ¯®ª § ²¼, ·²® ¤«¿ ¢±¥µ i
¢»¯®«­¥­® ±®®²­®¸¥­¨¥ (34.4), ²® ¥±²¼ ·²® ¯®±«¥ ¯°®·²¥­¨¿ ±¨¬¢®«  T [i]  ¢²®¬ ² ®ª §»¢ ¥²±¿ ¢ ±®±²®¿­¨¨  (Ti). ²® ¢»²¥ª ¥² ¨§
±«¥¤³¾¹¨µ ¤¢³µ «¥¬¬.
¥¬¬  34.2 (­¥° ¢¥­±²¢® ¤«¿ ±³´´¨ª±-´³­ª¶¨¨)
«¿ «¾¡»µ ±²°®ª¨ x ¨ ±¨¬¢®«  a ¨¬¥¥¬  (xa) 6  (x) + 1.
®ª § ²¥«¼±²¢®.
±«¨  (xa) >  (x) + 1, ²® ®²¡°®±¨¬ ¯®±«¥¤­¨© ±¨¬¢®« a ®² ­ ¨¡®«¼¸¥£® ±³´´¨ª±  xa, ¿¢«¿¾¹¥£®±¿ ¯°¥´¨ª±®¬ P , ¨ ¯®«³·¨¬ ±³´´¨ª± ±²°®ª¨ x, ¨¬¥¾¹¨© ¤«¨­³ ¡®«¼¸¥  (x) ¨ ¿¢«¿¾¹¨©±¿ ¯°¥´¨ª±®¬ P | ¯°®²¨¢®°¥·¨¥ (±¬. °¨±. 34.7).
¥¬¬  34.3 (¥ª³°°¥­²­ ¿ ´®°¬³«  ¤«¿ ±³´´¨ª±-´³­ª¶¨¨)
³±²¼ q =  (x), £¤¥ x | ±²°®ª . ®£¤  ¤«¿ «¾¡®£® ±¨¬¢®«  a
¨¬¥¥¬  (xa) =  (Pq a).
®ª § ²¥«¼±²¢®.
¥¬¬  34.2 £« ±¨², ·²®  (xa) 6 q +1. ®½²®¬³ §­ ·¥­¨¥  (xa) ­¥
¨§¬¥­¨²±¿, ¥±«¨ ®±² ¢¨²¼ ®² ±²°®ª¨ xa ¯®±«¥¤­¨¥ q + 1 ±¨¬¢®«®¢,
²® ¥±²¼ § ¬¥­¨²¼ ¥£® ­  ±²°®ª³ Pq a (­ ¯®¬­¨¬, ·²® ¯®±«¥¤­¨¥ q
±¨¬¢®«®¢ ±²°®ª¨ x ®¡° §³¾² ±«®¢® Pq , ² ª ª ª  (x) = q (°¨±. 34.8).
§ «¥¬¬» 34.3 ­¥¬¥¤«¥­­® ¢»²¥ª ¥²
¥®°¥¬  34.4
³±²¼ ' | ´³­ª¶¨¿ ª®­¥·­®£® ±®±²®¿­¨¿  ¢²®¬ ²  ¤«¿ ¯®¨±ª 
¯®¤±²°®ª¨ P [1::m]. ±«¨ T [1::n] | ¯°®¨§¢®«¼­»© ²¥ª±², ²®
'(Ti) =  (Ti)
¤«¿ i = 0; 1; : : :; n.
®ª § ²¥«¼±²¢®.
«¿ i = 0 ½²® ±®®²­®¸¥­¨¥ ®·¥¢¨¤­®. ¥¬¬  34.3 ¨ ´®°¬³«  (34.3)
¤«¿ ´³­ª¶¨¨ ¯¥°¥µ®¤  ¯®ª §»¢ ¾², ·²® ®­® ±®µ° ­¿¥²±¿ ¯°¨ ¯°®·²¥­¨¨  ¢²®¬ ²®¬ ®·¥°¥¤­®£® ±¨¬¢®« .
 ±¨«³ ¤®ª § ­­®© ²¥®°¥¬»,  ¢²®¬ ² ¯®±«¥ ¯°®·²¥­¨¿ i ±¨¬¢®«®¢ ²¥ª±²  ­ µ®¤¨²±¿ ¢ ±®±²®¿­¨¨ q ²®£¤  ¨ ²®«¼ª® ²®£¤ , ª®£¤ 
Pq ¿¢«¿¥²±¿ ± ¬»¬ ¤«¨­­»¬ ±³´´¨ª±®¬ ±²°®ª¨ Ti, ¿¢«¿¾¹¨¬±¿

776

« ¢  34 ®¨±ª ¯®¤±²°®ª

®¤­®¢°¥¬¥­­® ¯°¥´¨ª±®¬ ±²°®ª¨ P .  · ±²­®±²¨, q = m ®§­ · ¥², ·²®  ¢²®¬ ² ²®«¼ª® ·²® ¯°®·¥« ¯®¤±²°®ª³ P . ²® ¤®ª §»¢ ¥²
¯° ¢¨«¼­®±²¼  «£®°¨²¬  Finite-Automaton-Matcher.
34.3.3. »·¨±«¥­¨¥ ´³­ª¶¨¨ ¯¥°¥µ®¤ 
³­ª¶¨¾ ¯¥°¥µ®¤   , ±®®²¢¥²±²¢³¾¹³¾ ®¡° §¶³ T [1::m], ¬®¦­®
¢»·¨±«¨²¼ ² ª:
Compute-Transition-Function(P,\Sigma)
1 m \gets length[P]
2 for q \gets 0 to m
3
do for (¤«¿) ¢±¥µ ±¨¬¢®«®¢ a \in \Sigma
4
do k \gets \min(m+1, q+2)
5
repeat k \gets k-1
6
until P_k \sqsupset P_qa
7
\delta(q,a) \gets k
8 return \delta

²  ¯°®¶¥¤³°  ¢»·¨±«¿¥² ´³­ª¶¨¾  À¢ «®¡Á: ¶¨ª«», ­ ·¨­ ¾¹¨¥±¿ ¢ ±²°®ª µ 2 ¨ 3, ¯¥°¥¡¨° ¾² ¢±¥ ¯ °» (q; a),   ¢ ±²°®ª µ
4{7 ­ ¨¡®«¼¸¥¥ §­ ·¥­¨¥ k, ¯°¨ ª®²®°®¬ ¤«¿ ¤ ­­®© ¯ °» (q; a)
¢»¯®«­¥­® ±®®²­®¸¥­¨¥ Pk A Pq a, ­ µ®¤¨²±¿ ¯°¿¬»¬ ¯¥°¥¡®°®¬,
­ ·¨­ ¿ ± ­ ¨¡®«¼¸¥£®  ¯°¨®°¨ ¢®§¬®¦­®£® §­ ·¥­¨¿ k, ²® ¥±²¼
min(m; q + 1).
°¥¬¿ ° ¡®²» ½²®£®  «£®°¨²¬  ¥±²¼ O(m3jj): ¢ ± ¬®¬ ¤¥«¥, ¤¢ 
¢­¥¸­¨µ ¶¨ª«  ¤ ¾² ¬­®¦¨²¥«¼ mjj, ¢­³²°¥­­¨© ¶¨ª« repeat ¬®¦¥² ¢»¯®«­¿²¼±¿ ­¥ ¡®«¥¥ m + 1 ° §, ¨ ±° ¢­¥­¨¥ ¢ ±²°®ª¥ 6 ²°¥¡³¥² O(m) ®¯¥° ¶¨©.   ± ¬®¬ ¤¥«¥ ´³­ª¶¨¾ ¯¥°¥µ®¤  ¬®¦­® ¢»·¨±«¨²¼ £®° §¤® ¡»±²°¥¥, §  ¢°¥¬¿ O(mjj) (±¬. ³¯°. 34.4-6). 
½²®¬ ±«³· ¥ ¢°¥¬¿ ¯®¨±ª  ®¡° §¶  ¤«¨­» m ¢ ²¥ª±²¥ ¤«¨­» n ¡³¤¥² O(n + mjj).
¯° ¦­¥­¨¿
34.3-1
®±²°®©²¥  ¢²®¬ ² ¤«¿ ¯®¨±ª  ¯®¤±²°®ª¨ P = aabab ¨ ¯°®¤¥¬®­±²°¨°³©²¥ ¥£® ° ¡®²³ ­  ²¥ª±²¥ T = aaababaabaababaab.
34.3-2
 °¨±³©²¥ ¤¨ £° ¬¬³ ¯¥°¥µ®¤®¢  ¢²®¬ ²  ¤«¿ ¯®¨±ª  ¯®¤±²°®ª¨
P = ababbabbababbababbabb (­ ¤  «´ ¢¨²®¬  = fa; bg).
34.3-3
³¤¥¬ £®¢®°¨²¼, ·²® P | ±²°®ª  ± ³­¨ª «¼­»¬¨ ¯°¥´¨ª± ¬¨ (P
is nonoverlappable), ¥±«¨ ±®®²­®¸¥­¨¥ Pk A Pq ¢®§¬®¦­® «¨¸¼ ¯°¨
k = 0 ¨«¨ k = q.  ª ¢»£«¿¤¨² ¤¨ £° ¬¬  ¯¥°¥µ®¤®¢  ¢²®¬ ²  ¤«¿
¯®¨±ª  ¯®¤±²°®ª¨ ± ³­¨ª «¼­»¬¨ ¯°¥´¨ª± ¬¨?

«£®°¨²¬ ­³²  | ®°°¨±  | ° ²² 

777

34.3-4*
 ­» ¤¢  ®¡° §¶  P ¨ P 0 . ®±²°®©²¥ ª®­¥·­»©  ¢²®¬ ², ­ µ®¤¿¹¨© ¢±¥ ¢µ®¦¤¥­¨¿ ª ¦¤®£® ¨§ ½²¨µ ®¡° §¶®¢ ¢ ¤ ­­»© ²¥ª±². ®±² ° ©²¥±¼, ·²®¡ ·¨±«® ±®±²®¿­¨© ¢ ¸¥£®  ¢²®¬ ²  ¡»«® ¯®¬¥­¼¸¥.
34.3-5
³±²¼ ®¡° §¥¶ P ±®¤¥°¦¨², ­ °¿¤³ ± ±¨¬¢®« ¬¨ ¨§  «´ ¢¨²  ,
¥¹¥ ¨ ±¨¬¢®«» ¯°®¯³±ª®¢ (³¯° ¦­¥­¨¥ 34.1-5). ®±²°®©²¥ ª®­¥·­»©  ¢²®¬ ², ª®²®°»© ®²»±ª¨¢ ¥² ¢±¥ ¢µ®¦¤¥­¨¿ ² ª®£® ®¡° §¶ 
P ¢ ²¥ª±² T §  ¢°¥¬¿ O(jT j).

34.4. «£®°¨²¬ ­³²  | ®°°¨±  | ° ²² 
¥¯¥°¼ ¬» ¯¥°¥µ®¤¨¬ ª  «£®°¨²¬³ ¤«¿ ¯®¨±ª  ¯®¤±²°®ª, ° ¡®² ¾¹¥¬³ §  «¨­¥©­®¥ ¢°¥¬¿. ²®²  «£®°¨²¬, ¯°¥¤«®¦¥­­»© ­³²®¬,
®°°¨±®¬ ¨ ° ²²®¬, ° ¡®² ¥² §  ¢°¥¬¿ (m + n).  ª®¥ ³±ª®°¥­¨¥ ¤®±²¨£ ¥²±¿ §  ±·¥² ²®£®, ·²® ¯°¥¤¢ °¨²¥«¼­® ¢»·¨±«¿¥²±¿
­¥ ´³­ª¶¨¿ ¯¥°¥µ®¤   [0::m; 1::jj],   ¢ jj ° § ¬¥­¼¸¨© ¬ ±±¨¢ |
À¯°¥´¨ª±-´³­ª¶¨¿Á  [1::m] (¥¥ ¢»·¨±«¥­¨¥ ¯°®¨§¢®¤¨²±¿ §  ¢°¥¬¿
O(m)). ­ ¿ ´³­ª¶¨¾ , ¬®¦­® ¢»·¨±«¨²¼ (q; a) ¤«¿ «¾¡®£® ±®±²®¿­¨¿ q 2 f 0; 1; : : :; m g ¨ ±¨¬¢®«  a ± ³·¥²­®© ±²®¨¬®±²¼¾ O(1)
(¢ ±¬»±«¥  ¬®°²¨§ ¶¨®­­®£®  ­ «¨§ ). ¥©· ± ¬» ³¢¨¤¨¬, ª ª ½²®
¤¥« ¥²±¿.
34.4.1. °¥´¨ª±-´³­ª¶¨¿,  ±±®¶¨¨°®¢ ­­ ¿ ± ®¡° §¶®¬
°¥´¨ª±-´³­ª¶¨¿,  ±±®¶¨¨°®¢ ­­ ¿ ± ®¡° §¶®¬ P , ­¥±¥² ¨­´®°¬ ¶¨¾ ® ²®¬, £¤¥ ¢ ±²°®ª¥ P ¯®¢²®°­® ¢±²°¥· ¾²±¿ ° §«¨·­»¥
¯°¥´¨ª±» ½²®© ±²°®ª¨. ±¯®«¼§®¢ ­¨¥ ½²®© ¨­´®°¬ ¶¨¨ ¯®§¢®«¿¥² ¨§¡¥¦ ²¼ ¯°®¢¥°ª¨ § ¢¥¤®¬® ­¥¤®¯³±²¨¬»µ ±¤¢¨£®¢ (£®¢®°¿ ¢
²¥°¬¨­ µ ¯°®±²¥©¸¥£®  «£®°¨²¬  ¯®¨±ª ) ¨«¨ ®¡®©²¨±¼ ¡¥§ ¯°¥¤¢ °¨²¥«¼­®£® ¢»·¨±«¥­¨¿ ´³­ª¶¨¨ ¯¥°¥µ®¤  (¢ ²¥°¬¨­ µ ª®­¥·­»µ
 ¢²®¬ ²®¢).
 ¯°¥´¨ª±-´³­ª¶¨¨ ¯°¨¢®¤¨² ±«¥¤³¾¹¨© µ®¤ ¬»±«¥©. ³±²¼
¯°®±²¥©¸¨©  «£®°¨²¬ ¨¹¥² ¢µ®¦¤¥­¨¿ ¯®¤±²°®ª¨ P = ababaca
¢ ²¥ª±² T . °¥¤¯®«®¦¨¬, ·²® ¤«¿ ­¥ª®²®°®£® ±¤¢¨£  s ®ª § «®±¼,
·²® q ¯¥°¢»µ ±¨¬¢®«®¢ ®¡° §¶  ±®¢¯ ¤ ¾² ± ±¨¬¢®« ¬¨ ²¥ª±² ,   ¢
±«¥¤³¾¹¥¬ ±¨¬¢®«¥ ¨¬¥¥²±¿ ° ±µ®¦¤¥­¨¥ (°¨±. 34.9 ( ), £¤¥ q = 5).
² «® ¡»²¼, ¬» §­ ¥¬ q ±¨¬¢®«®¢ ²¥ª±² , ®² T [s +1] ¤® T [s + q ], ¨ ¨§
½²®© ¨­´®°¬ ¶¨¨ ¬®¦­® § ª«¾·¨²¼, ·²® ­¥ª®²®°»¥ ¯®±«¥¤³¾¹¨¥
±¤¢¨£¨ ¡³¤³² § ¢¥¤®¬® ­¥¤®¯³±²¨¬».  ¯°¨¬¥°¥ ­  °¨±. 34.9, ±ª ¦¥¬, ±° §³ ¢¨¤­®, ·²® ­¥¤®¯³±²¨¬ ±¤¢¨£ s + 1, ¯®±ª®«¼ª³ ¯°¨ ½²®¬
±¤¢¨£¥ ¯¥°¢»© ±¨¬¢®« ®¡° §¶  (¡³ª¢  a) ®ª ¦¥²±¿ ­ ¯°®²¨¢ s + 2£® ±¨¬¢®«  ²¥ª±² , ±®¢¯ ¤ ¾¹¥£® ±® ¢²®°»¬ ±¨¬¢®«®¬ ®¡° §¶ , |

778

« ¢  34 ®¨±ª ¯®¤±²°®ª

¨±. 34.9. °¥´¨ª±-´³­ª¶¨¿  . ( ) ¡° §¥¶ P = ababaca ° ±¯®«®¦¥­ ² ª, ·²® ¯¥°¢»¥ 5 ¡³ª¢ ®¡° §¶  ±®¢¯ ¤ ¾² ± ¡³ª¢ ¬¨ ¢ ²¥ª±²¥
T (±®¢¯ ¤ ¾¹¨¥ ¡³ª¢» ±¥°»¥ ¨ ±®¥¤¨­¥­» ®²°¥§ª ¬¨). (¡) ±µ®¤¿
²®«¼ª® ¨§ ±®¢¯ ¤¥­¨¿ ½²¨µ 5 ¡³ª¢, ¬» ¬®¦¥¬ § ª«¾·¨²¼, ·²® ±¤¢¨£
s +1 ­¥¤®¯³±²¨¬. ®¯³±²¨¬®±²¼ ±¤¢¨£  s +2 ­¥ ¯°®²¨¢®°¥·¨² ²®¬³,
·²® ¬» ª ¤ ­­®¬³ ¬®¬¥­²³ §­ ¥¬ ® ²¥ª±²¥, ¨ ®²¡°®±¨²¼ ½²®² ±¤¢¨£
§ ° ­¥¥ ­¥«¼§¿. (¢) ­´®°¬ ¶¨¾ ® ²®¬, ª ª¨¥ ±¤¢¨£¨ § ¢¥¤®¬® ­¥¤®¯³±²¨¬», ¬®¦­® ¯®«³·¨²¼, ¨±µ®¤¿ ²®«¼ª® ¨§ ®¡° §¶  P .  ­ ¸¥¬
±«³· ¥ ¬» ¢¨¤¨¬, ·²® ­ ¨¡®«¼¸¨© ¯°¥´¨ª± ±²°®ª¨ P , ¿¢«¿¾¹¨©±¿
±³´´¨ª±®¬ P5 [¨ ®²«¨·­»© ®² ¢±¥© P5 ], ¨¬¥¥² ¤«¨­³ 3.   ¿§»ª¥
¯°¥´¨ª±-´³­ª¶¨© ½²® ®§­ · ¥², ·²®  [5] = 3.  ®¡¹¥¬ ±«³· ¥: ¥±«¨
¯°¨ ¯°®¢¥°ª¥ ±¤¢¨£  s ¯¥°¢»¥ q ±¨¬¢®«®¢ ®¡° §¶  ±®¢¯ «¨ ± ±®®²¢¥²±²¢³¾¹¨¬¨ ±¨¬¢®« ¬¨ ²¥ª±² , ²® ±«¥¤³¾¹¨© ±¤¢¨£, ª®²®°»©
­ ¤® ¯°®¢¥°¿²¼, ° ¢¥­ s0 = s + (q ;  [q ]).
  ½²® ¡³ª¢  b.  ¢®² ¯°¨ ±¤¢¨£¥ ­  s + 2 (°¨±. 34.9 (¡)) ¯¥°¢»¥ ²°¨
±¨¬¢®«  ®¡° §¶  ±®¢¯ ¤ ¾² ± ²°¥¬¿ ¯®±«¥¤­¨¬¨ ¨§ ¨§¢¥±²­»µ ­ ¬
±¨¬¢®«®¢ ²¥ª±² , ² ª ·²® ½²®² ±¤¢¨£  ¯°¨®°¨ ®²¡°®±¨²¼ ­¥«¼§¿. 
®¡¹¥¬ ±«³· ¥ µ®²¥«®±¼ ¡» ³¬¥²¼ ®²¢¥· ²¼ ­  ² ª®© ¢®¯°®±:
³±²¼ P [1::q ] = T [s + 1::s + q ]; ª ª®¢® ­ ¨¬¥­¼¸¥¥ §­ ·¥­¨¥
±¤¢¨£  s0 > s, ¤«¿ ª®²®°®£®

P [1::k] = T [s0 + 1::s0 + k];

(34:5)

£¤¥ s0 + k = s + q ?
¨±«® s0 | ½²® ­ ¨¬¥­¼¸¥¥ §­ ·¥­¨¥ ±¤¢¨£ , ¡®«¼¸¥¥ s, ª®²®°®¥
­¥«¼§¿ ®²¡°®±¨²¼ ± ¯®°®£ , ¨±µ®¤¿ ¨§ ° ¢¥­±²¢  T [s + 1::s + q ] =
P [1::q]. ®«¼¸¥ ¢±¥£® ­ ¬ ¯®¢¥§¥², ¥±«¨ s0 = s + q: ²®£¤  ¬» ¬®¦¥¬
­¥ ° ±±¬ ²°¨¢ ²¼ ±¤¢¨£¨ s +1; s +2; : : :; s + q ; 1.  ¢® ¢±¿ª®¬ ±«³· ¥,
¯°¨ ¯°®¢¥°ª¥ ­®¢®£® ±¤¢¨£  s0 ¬» ¬®¦¥¬ ­¥ ° ±±¬ ²°¨¢ ²¼ ¯¥°¢»¥
k ±¨¬¢®«®¢ ®¡° §¶ : ¨§ ´®°¬³«» (34.5) ¬» §­ ¥¬, ·²® ®­¨ § ¢¥¤®¬®
±®¢¯ ¤ ¾² ± ±®®²¢¥²±²¢³¾¹¨¬¨ ±¨¬¢®« ¬¨ ¢ ²¥ª±²¥.
²®¡» ­ ©²¨ s0 , ­ ¬ ­¥ ­³¦­® ­¨·¥£® §­ ²¼ ® ²¥ª±²¥ T : ¤®±² ²®·­® §­ ­¨¿ ®¡° §¶  P ¨ ·¨±«  q . ¬¥­­®, T [s0 + 1::s0 + k] | ±³´´¨ª±
±²°®ª¨ Pq . ®½²®¬³ ·¨±«® k ¢ ´®°¬³«¥ (34.5) | ½²® ­ ¨¡®«¼¸¥¥ ·¨±«® k < q , ¤«¿ ª®²®°®£® Pk ¿¢«¿¥²±¿ ±³´´¨ª±®¬ Pq . ° ª²¨·¥±ª¨
³¤®¡­® µ° ­¨²¼ ¨­´®°¬ ¶¨¾ ¨¬¥­­® ®¡ ½²®¬ ·¨±«¥ k | ª®«¨·¥±²¢¥ ±¨¬¢®«®¢, § ¢¥¤®¬® ±®¢¯ ¤ ¾¹¨µ ¯°¨ ¯°®¢¥°ª¥ ­®¢®£® ±¤¢¨£ 
s0.  ¬® §­ ·¥­¨¥ s0 ¢»·¨±«¿¥²±¿ ¯® ´®°¬³«¥ s0 = s + (q ; k).
¥¯¥°¼ ¤ ¤¨¬ ´®°¬ «¼­®¥ ®¯°¥¤¥«¥­¨¥. °¥´¨ª±-´³­ª¶¨¥©
(prex function),  ±±®¶¨¨°®¢ ­­®© ±® ±²°®ª®© P [1::m], ­ §»¢ ¥²±¿ ´³­ª¶¨¿  : f 1; 2; : : :; m g ! f 0; 1; : : :; m ; 1 g, ®¯°¥¤¥«¥­­ ¿
±«¥¤³¾¹¨¬ ®¡° §®¬:

 [q] = maxf k : k < q ¨ Pk A Pq g:

«£®°¨²¬ ­³²  | ®°°¨±  | ° ²² 

779

­»¬¨ ±«®¢ ¬¨,  [q ] | ¤«¨­  ­ ¨¡®«¼¸¥£® ¯°¥´¨ª±  P , ¿¢«¿¾¹¥£®±¿ (±®¡±²¢¥­­»¬) ±³´´¨ª±®¬ Pq .   °¨±. 34.10 ( ) ¯°¨¢¥¤¥­ 
¯°¥´¨ª±-´³­ª¶¨¿ ¤«¿ ±²°®ª¨ ababababca.
«£®°¨²¬ ­³²  | ®°°¨±  | ° ²²  ¬» § ¯¨¸¥¬ ¢ ¢¨¤¥ ¯°®¶¥¤³°» KMP-Matcher.  ª ¬» ³¢¨¤¨¬, KMP-Matcher
¬®¦­® ° ±±¬ ²°¨¢ ²¼ ª ª ³±®¢¥°¸¥­±²¢®¢ ­¨¥  «£®°¨²¬  FiniteAutomaton-Matcher. °®¶¥¤³°  Compute-Prefix-Function,
¢»§»¢ ¥¬ ¿  «£®°¨²¬®¬ KMP-Matcher, ¢»·¨±«¿¥² ¯°¥´¨ª±­³¾
´³­ª¶¨¾  .
KMP-Matcher(T,P)
1 n \gets length[T]
2 m \gets length[P]
3 \pi \gets Compute-Prefix-Function(P)
4 q \gets 0
5 for i \gets 1 to n
6
do while q>0 and P[q+1] \ne T[i]
7
do q \gets \pi[q]
8
if P[q+1]=T[i]
9
then q \gets q+1
10
if q=m
11
then print ``¡° §¥¶ ¢µ®¤¨² ±® ±¤¢¨£®¬ ''i-m
12
q \gets \pi[q]
Compute-Prefix-Function(P)
1 m \gets length[P]
2 \pi[1] \gets 0
3 k \gets 0
4 for q \gets 2 to m
5
do while k>0 and P[k+1] \ne P[q]
6
do k \gets \pi[k]
7
if P[k+1]=P[q]
8
then k \gets k+1
9
\pi[q] \gets k
10 return \pi

­ · «  ¬» ¯°® ­ «¨§¨°³¥¬ ¢°¥¬¿ ° ¡®²» ½²¨µ ¯°®¶¥¤³° (¢
¯°¥¤¯®«®¦¥­¨¨ ¨µ ¯° ¢¨«¼­®±²¨),   § ²¥¬ ¤®ª ¦¥¬, ·²® ®­¨ ° ¡®² ¾² ¯° ¢¨«¼­®.
34.4.2. °¥¬¿ ° ¡®²»
®ª ¦¥¬, ·²® ¢°¥¬¿ ° ¡®²» ¯°®¶¥¤³°» Compute-PrefixFunction ¥±²¼ O(m). «¿ ½²®£® ¢®±¯®«¼§³¥¬±¿ ¬¥²®¤®¬ ¯®²¥­¶¨-

 «®¢ ¢  ¬®°²¨§ ¶¨®­­®¬  ­ «¨§¥ (£« ¢  18).
°®¶¥¤³°  Compute-Prefix-Function ¢»¯®«­¿¥² m ; 1 ¨²¥° ¶¨© ¶¨ª«  ¢ ±²°®ª µ 4{9. ®ª ¦¥¬, ·²® ³·¥²­³¾ ±²®¨¬®±²¼ ª ¦¤®©

780

« ¢  34 ®¨±ª ¯®¤±²°®ª

¨§ ½²¨µ ¨²¥° ¶¨© ¬®¦­® ±·¨² ²¼ ° ¢­®© O(1). «¿ ½²®£® ¢ ª ·¥±²¢¥ ¯®²¥­¶¨ «  ¡³¤¥¬ ° ±±¬ ²°¨¢ ²¼ §­ ·¥­¨¥ k ¢ ¬®¬¥­² ¢µ®¤ 
¢ ¶¨ª«. ®±ª®«¼ª³ ­ · «¼­®¥ §­ ·¥­¨¥ k ° ¢­® ­³«¾,   ¯®±«¥¤³¾¹¨¥ ° ¢­»  [q ] > 0, °¥ «¼­ ¿ ±²®¨¬®±²¼ (¢°¥¬¿ ¢»¯®«­¥­¨¿) ¢±¥µ
¨²¥° ¶¨© ®¶¥­¨¢ ¥²±¿ ±³¬¬®© ³·¥²­»µ ±²®¨¬®±²¥©, ¥±«¨ ±·¨² ²¼
³·¥²­®© ±²®¨¬®±²¼¾ ±³¬¬³ °¥ «¼­®© ±²®¨¬®±²¨ ¨ ¨§¬¥­¥­¨¿ ¯®²¥­¶¨ « .
¥ «¼­ ¿ ±²®¨¬®±²¼ ª ¦¤®© ¨²¥° ¶¨¨ ±ª« ¤»¢ ¥²±¿ ¨§ ±²®¨¬®±²¨ ¯°¨±¢ ¨¢ ­¨© ¢ ±²°®ª¥ 6, ¯°¨±¢ ¨¢ ­¨¿ ¢ ±²°®ª¥ 8 ¨ ¯°¨±¢ ¨¢ ­¨¿ ¢ ±²°®ª¥ 9. ®±ª®«¼ª³  [j ] < j ¤«¿ ¢±¥µ j , ¯°¨ ª ¦¤®¬
¯°¨±¢ ¨¢ ­¨¨ ¢ ±²°®ª¥ 6 ¯®²¥­¶¨ « ³¬¥­¼¸ ¥²±¿ ¯® ª° ©­¥© ¬¥°¥
­  1, ·²® ª®¬¯¥­±¨°³¥² ° ¡®²³ ¯® ¢»¯®«­¥­¨¾ ¤¥©±²¢¨© ¢ ¶¨ª«¥
while, ¥±«¨ ³¬­®¦¨²¼ ¯®²¥­¶¨ « ­  ¤®±² ²®·­® ¡®«¼¸³¾ ª®­±² ­²³. ®½²®¬³ ¢ª« ¤ ¶¨ª«  while ¢ ³·¥²­³¾ ±²®¨¬®±²¼ ¥±²¼ O(1);
¯°¨±¢ ¨¢ ­¨¿ ¦¥ ¢ ±²°®ª µ 8 ¨ 9 ¢»¯®«­¿¾²±¿ ­¥ ¡®«¥¥, ·¥¬ ¯® ° §³ ª ¦¤®¥, ¨ ³¢¥«¨·¨¢ ¾² ¯®²¥­¶¨ « ­¥ ¡®«¥¥ ·¥¬ ­  ¤¢¥ ¥¤¨­¨¶».
®½²®¬³ ³·¥²­ ¿ ±²®¨¬®±²¼ ª ¦¤®© ¨²¥° ¶¨¨ ¶¨ª«  for ¥±²¼ O(1),
  ±²®¨¬®±²¼ ¢±¥© ¯°®¶¥¤³°» ¥±²¼ O(m).
­ «®£¨·­®¥ ° ±±³¦¤¥­¨¥, ¢ ª®²®°®¬ ¢ ª ·¥±²¢¥ ¯®²¥­¶¨ «  ¢»¡¨° ¥²±¿ q , ¯®ª §»¢ ¥², ·²® ¢°¥¬¿ ¢»¯®«­¥­¨¿ ±²°®ª 5{12 ¯°®¶¥¤³°» KMP-Matcher ¥±²¼ O(n). ² «® ¡»²¼, ¢°¥¬¿ ¢»¯®«­¥­¨¿
¢±¥© ¯°®¶¥¤³°» KMP-Matcher ¥±²¼ O(m + n). ²® | ¢»¨£°»¸
¯® ±° ¢­¥­¨¾ ±  «£®°¨²¬®¬ Finite-Automaton-Matcher, ª®²®°»© ¤ ¦¥ ¯°¨ ½ª®­®¬­®¬ ¢»·¨±«¥­¨¨ ´³­ª¶¨¨  ²°¥¡³¥² ¢°¥¬¥­¨
O(mjj + n).
34.4.3. °¥´¨ª±-´³­ª¶¨¿ ¢»·¨±«¿¥²±¿ ¯° ¢¨«¼­®
 ·­¥¬ ± ¢ ¦­®© «¥¬¬», ¯®ª §»¢ ¾¹¥©, ·²®, ¨²¥°¨°³¿ ¯°¥´¨ª±´³­ª¶¨¾, ¬®¦­® ¤«¿ ¤ ­­®£® q ­ ©²¨ ¢±¥ ² ª¨¥ k, ·²® Pk ¿¢«¿¥²±¿
±³´´¨ª±®¬ Pq . ¬¥­­®, ¤«¿ ¤ ­­®£® q ¯®«®¦¨¬
[q] = f q;  [q ]; 2[q]; 3[q]; : : :; t[q ] g;
£¤¥  i [q ] ®¡®§­ · ¥² i-³¾ ¨²¥° ¶¨¾ ¯°¥´¨ª±-´³­ª¶¨¨ (²® ¥±²¼
 0[q] = q ,   i [q ] =  [i;1[q ]]) ¨  t[q ] = 0 (² ª®¥ t ­ ©¤¥²±¿, ² ª
ª ª  [j ] < j ¤«¿ ¢±¥µ j ; ­  ½²®¬ ¬¥±²¥ ¨²¥° ¶¨¨ ®¡°»¢ ¾²±¿).
¥¬¬  34.5 (¥¬¬  ®¡ ¨²¥° ¶¨¿µ ¯°¥´¨ª±-´³­ª¶¨¨) ³±²¼ P |
±²°®ª  ¤«¨­» m ± ¯°¥´¨ª±-´³­ª¶¨¥©  . ®£¤  ¤«¿ ¢±¥µ q =
1; 2; : : :; m ¨¬¥¥¬   [q ] = f k : Pk A Pq g.
®ª § ²¥«¼±²¢®.
®ª ¦¥¬ ±­ · « , ·²®
i 2 [q ] =) Pi A Pq :
(34:6)
 ± ¬®¬ ¤¥«¥, P(i) A Pi , ² ª ·²® ª ¦¤»© ±«¥¤³¾¹¨© ·«¥­ ¯®±«¥¤®¢ ²¥«¼­®±²¨ Pq ; P[q]; P[[q]] ; : : : ¿¢«¿¥²±¿ ±³´´¨ª±®¬ ¯°¥¤»¤³¹¥£®
(¨, ±«¥¤®¢ ²¥«¼­®, ¢±¥µ ¯°¥¤»¤³¹¨µ).

«£®°¨²¬ ­³²  | ®°°¨±  | ° ²² 

781

¨±. 34.10
®¤¯¨±¼:
¨±.34.10.  «¥¬¬¥ 34.5 (P = ababababca, q = 8). ( ) ³­ª¶¨¿  ,
±¢¿§ ­­ ¿ ±® ±²°®ª®© P . ¬¥¥¬  [8] = 6,  [6] = 4,  [4] = 2,  [2] = 0,
² ª ·²®   [8] = f 8; 6; 4; 2; 0 g. (¡) ¤¢¨£ ¿ ±²°®ª³ P ®²­®±¨²¥«¼­®
± ¬®© ±¥¡¿ ±«¥¢  ­ ¯° ¢®, ®²¬¥· ¥¬ ¬®¬¥­²», ª®£¤  ¯°¥´¨ª± Pk @
P ¿¢«¿¥²±¿ ±³´´¨ª±®¬ ±²°®ª¨ P8 (±®¢¯ ¤ ¾¹¨¥ ±¨¬¢®«» ¢»¤¥«¥­»
±¥°»¬ ¨ ±®¥¤¨­¥­» ¢¥°²¨ª «¼­»¬¨ ®²°¥§ª ¬¨; ¯³­ª²¨°­ ¿ «¨­¨¿
­ °¨±®¢ ­  ±¯° ¢  ®² P8 ). ²® ¯°®¨±µ®¤¨² ¯°¨ k = 8; 6; 4; 2; 0, ·²®
±®¢¯ ¤ ¥² ±® ¬­®¦¥±²¢®¬  [8].
®ª ¦¥¬ ²¥¯¥°¼, ·²® ¨ ­ ®¡®°®², f k : Pk A Pq g   [q ].  ±±³¦¤ ¿ ®² ¯°®²¨¢­®£®, ®¡®§­ ·¨¬ ·¥°¥§ j ­ ¨¡®«¼¸¨© ½«¥¬¥­² ¬­®¦¥±²¢  f k : Pk A Pq g n   [q ]. ·¥¢¨¤­®, j < q ; ° § j ­¥ «¥¦¨² ¢
¯®±«¥¤®¢ ²¥«¼­®±²¨  [q ], ²® j ¯®¯ ¤ ¥² ¬¥¦¤³ ¤¢³¬¿ ¥¥ ·«¥­ ¬¨:
j 0 > j > [j 0] ¤«¿ ­¥ª®²®°®£® j 0 2  [q].
¡¥ ±²°®ª¨ Pj ¨ Pj 0 ¿¢«¿¾²±¿ ±³´´¨ª± ¬¨ Pq : ¯¥°¢ ¿ | ¯® ¢»¡®°³ j , ¢²®° ¿ | ¢ ±¨«³ ±®®²­®¸¥­¨¿ (34.6). ² «® ¡»²¼, Pj A Pj 0 ¯®
«¥¬¬¥ 34.1, ¨ Pj ¿¢«¿¥²±¿ ¯°¥´¨ª±®¬ ±²°®ª¨ P , ª®²®°»© ¿¢«¿¥²±¿
(±®¡±²¢¥­­»¬) ±³´´¨ª±®¬ ±²°®ª¨ Pj 0 ¨ ¨¬¥¥² ¤«¨­³ ¡®«¼¸¥  [j 0],
·²® ¯°®²¨¢®°¥·¨² ®¯°¥¤¥«¥­¨¾ ´³­ª¶¨¨  .
¨±. 34.10 ¨««¾±²°¨°³¥² ¤®ª § ­­³¾ «¥¬¬³.
¥¬¬  34.6
³±²¼ P | ±²°®ª  ¤«¨­» m ± ¯°¥´¨ª±-´³­ª¶¨¥©  . ®£¤   [q ] ;
1 2   [q ; 1] ¤«¿ ¢±¥µ q = 1; 2; : : :; m. ¤«¿ ª®²®°»µ  [q ] > 0.
®ª § ²¥«¼±²¢®.
±«¨ k =  [q ] > 0, ²® Pk A Pq , ®²ª³¤ , ®²¡° ±»¢ ¿ ¯®±«¥¤­¨©
±¨¬¢®«, ¯®«³· ¥¬, ·²® Pk;1 A Pq;1 . ® «¥¬¬¥ 34.5 ½²® ®§­ · ¥²,
·²®  [q ] ; 1 2  [q ; 1].
«¿ q = 2; 3; : : :; m ®¯°¥¤¥«¨¬ ¬­®¦¥±²¢  Eq;1 ´®°¬³«®©

Eq;1 = f k : k 2   [q ; 1] ¨ P [k + 1] = P [q] g
(±«®¢ ¬¨: Eq;1 ±®±²®¨² ¨§ ² ª¨µ k, ·²® Pk | ±³´´¨ª± Pq;1 , ¨ §  ­¨¬¨ ¨¤³² ®¤¨­ ª®¢»¥ ¡³ª¢» P [k +1] ¨ P [q ], ² ª ·²® Pk+1 | ±³´´¨ª±
Pq ).

«¥¤±²¢¨¥ 34.7
³±²¼ P | ±²°®ª  ¤«¨­» m ± ¯°¥´¨ª±-´³­ª¶¨¥©  . ®£¤  ¤«¿
¢±¥µ q = 2; 3; : : :; m ¨¬¥¥¬:
(

 [q] =

0;
¥±«¨ Eq;1 = ;;
1 + maxf k 2 Eq;1 g; ¥±«¨ Eq;1 6= ;.

®ª § ²¥«¼±²¢®.
±«¨ r =  [q ] > 1, ²® P [r] = P [q ]; ª°®¬¥ ²®£® («¥¬¬  34.6), r ; 1 2

 [q ; 1], ² ª ·²® r ; 1 2 Eq;1 . ²±¾¤  ¿±­®, ·²® ¥±«¨ Eq;1 ¯³±²®,

782

« ¢  34 ®¨±ª ¯®¤±²°®ª

²®  [q ] = 0, ¨ ·²® ¥±«¨ Eq;1 ­¥¯³±²®, ²®  [q ] 6 1 + maxf; k 2 Eq;1 g.
±² «®±¼ ¯®ª § ²¼, ·²® ¥±«¨ k 2 Eq;1 , ²®  [q ] > k +1 | ­® ½²® ¿±­®,
¯®±ª®«¼ª³ ¢ ½²®¬ ±«³· ¥ Pk+1 ¥±²¼ ±³´´¨ª± Pq (ª ª ¬» ®²¬¥· «¨
¯®±«¥ ®¯°¥¤¥«¥­¨¿ Eq;1 .
¥¯¥°¼ ¬» ¬®¦¥¬ § ¢¥°¸¨²¼ ¤®ª § ²¥«¼±²¢® ¯° ¢¨«¼­®±²¨ ¯°®¶¥¤³°» Compute-Prefix-Function. ¢±¥µ q . ®ª ¦¥¬ ¨­¤³ª¶¨¥©
¯® q ±«¥¤³¾¹¥¥ ³²¢¥°¦¤¥­¨¥: ¯°¨ ¢µ®¤¥ ¢ ¶¨ª«, ­ ·¨­ ¾¹¨©±¿ ¢
±²°®ª¥ 4, ¢»¯®«­¥­® ° ¢¥­±²¢® k =  [q ; 1]. °¨ q = 2 ½²® ®¡¥±¯¥·¨¢ ¥²±¿ ¯°¨±¢ ¨¢ ­¨¿¬¨ ¢ ±²°®ª µ 2 ¨ 3.  £ ¨­¤³ª¶¨¨: ¯³±²¼
k = [q ; 1] ¯°¨ ¢µ®¤¥ ¢ ¶¨ª«, ²®£¤  ­ ¬ ¤®±² ²®·­® ¤®ª § ²¼, ·²®
¯°¨ ¢»µ®¤¥ ¨§ ¶¨ª«  ¡³¤¥² k =  [q ].  ± ¬®¬ ¤¥«¥, ¢ ±²°®ª µ 5{6
¨¹¥²±¿ ­ ¨¡®«¼¸¨© ½«¥¬¥­² ¬­®¦¥±²¢  Eq;1 ; ¥±«¨ ½²® ¬­®¦¥±²¢®
­¥¯³±²® (½²® ° ¢­®±¨«¼­® ²®¬³, ·²® P [k + 1] = P [q ] ¯°¨ ¢»µ®¤¥ ¨§
¶¨ª«  ¢ ±²°®ª µ 5{6), ²® ¯®±«¥ ¯°¨±¢ ¨¢ ­¨¿ ¢ ±²°®ª¥ 9 ·¨±«® k
®ª §»¢ ¥²±¿ ° ¢­»¬  [q ] ¢¢¨¤³ ±«¥¤±²¢¨¿ 34.7. ±«¨ ¦¥ ½²® ¬­®¦¥±²¢® ¯³±²® (¯® ¢»µ®¤¥ ¨§ ¶¨ª«  ¢ ±²°®ª µ 5{6 ®ª § «®±¼ k = 0 ¨
P [k + 1] 6= P [q]), ²® ®ª §»¢ ¥²±¿  [q] = 0, ·²® ² ª¦¥ ¢¥°­® (±«¥¤±²¢¨¥ 34.7).
34.4.4. «£®°¨²¬ KMP ¯° ¢¨«¥­
®ª § ²¥«¼±²¢® ¯° ¢¨«¼­®±²¨ ¯°®¶¥¤³°» KMP-Matcher ¯°®µ®¤¨² ¯® ²®© ¦¥ ±µ¥¬¥, ·²® ¨ ¤«¿ ¯°®¶¥¤³°» Compute-PrefixFunction. ®±² ²®·­® (¨­¤³ª¶¨¥© ¯® i) ¤®ª § ²¼ ² ª¨¥ ³²¢¥°¦¤¥­¨¿:
  ¬®¬¥­² ¨±¯®«­¥­¨¿ ±²°®ª 10{12 ¢»¯®«­¥­® ° ¢¥­±²¢® q =
 (Ti);
 ¥°¥¤ ª ¦¤»¬ ¨±¯®«­¥­¨¥¬ ²¥«  ¶¨ª«  (±²°®ª¨ 6{12) ¢»¯®«­¥­® ° ¢¥­±²¢®
(
q =  (Ti;1); ¥±«¨  (Ti;1) < m;
 [m]; ¥±«¨  (Ti;1) = m.
(§¤¥±¼  (Tj ) | ¤«¨­  ­ ¨¡®«¼¸¥£® ¯°¥´¨ª±  P , ¿¢«¿¾¹¥£®±¿ ±³´´¨ª±®¬ Tj ).
 ¬¥²¨¬, ·²® ¯°¨ i = 1 ¢²®°®¥ ³²¢¥°¦¤¥­¨¥ ¢¥°­®. ®ª ¦¥¬ ²¥¯¥°¼, ·²® ¯°¨ ª ¦¤®¬ i ¨§ ¢²®°®£® ³²¢¥°¦¤¥­¨¿ ±«¥¤³¥² ¯¥°¢®¥.
 ± ¬®¬ ¤¥«¥, ¯³±²¼ ¯°¨ ­¥ª®²®°®¬ i ¢²®°®¥ ³²¢¥°¦¤¥­¨¥ ¢¥°­®.
¥¬¬  34.5 ¯®ª §»¢ ¥², ·²® ¢ ±²°®ª µ 6{7 ¯¥°¥¡¨° ¾²±¿ ¢ ³¡»¢ ¾¹¥¬ ¯®°¿¤ª¥ ½«¥¬¥­²» ¬­®¦¥±²¢  S = f k < m : Pk A Pq g, ¯°¨·¥¬
¯¥°¥¡®° ®¡°»¢ ¥²±¿ «¨¡® ¯°¨ ­ µ®¦¤¥­¨¨ ­ ¨¡®«¼¸¥£® k 2 S , ¤«¿
ª®²®°®£® P [k + 1] = T [i], «¨¡® ¯°¨ k = 0 ¨ P [1] 6= T [i].  ¯¥°¢®¬
±«³· ¥ ¯® ¢»µ®¤¥ ¨§ ¶¨ª«  ¢ ±²°®ª µ 6{7 q ° ¢­¿¥²±¿ ­ ¨¡®«¼¸¥¬³
k, ¤«¿ ª®²®°®£® Pk A Ti;1 ¨ Pk+1 A Ti; ¿±­®, ·²® k + 1 = (Ti), ¨
¯®±«¥ ¨±¯®«­¥­¨¿ ±²°®ª¨ 9 §­ ·¥­¨¥ k + 1 ¯°¨±¢ ¨¢ ¥²±¿ ¯¥°¥¬¥­­®© q . ® ¢²®°®¬ ±«³· ¥ ¯® ¢»µ®¤¥ ¨§ ¶¨ª«  ¢ ±²°®ª µ 6{7 ¨¬¥¥¬,

«£®°¨²¬ ®©¥°  | ³° 

783

®·¥¢¨¤­®,  (Ti) = 0 ¨ q = 0; ¢ ®¡®¨µ ±«³· ¿µ ¢²®°®¥ ³²¢¥°¦¤¥­¨¥
¢»¯®«­¥­®.  ª®­¥¶, ¥±«¨ ¢²®°®¥ ³²¢¥°¦¤¥­¨¥ ¢¥°­® ¤«¿ ­¥ª®²®°®£® i < n, ²®, ®·¥¢¨¤­®, ¯¥°¢®¥ ³²¢¥°¦¤¥­¨¥ ¢¥°­® ¤«¿ i + 1. ²®
§ ¢¥°¸ ¥² ¨­¤³ª¶¨¾ ¨ ¤®ª § ²¥«¼±²¢®.
¯° ¦­¥­¨¿
34.4-1
 ©¤¨²¥ ¯°¥´¨ª±-´³­ª¶¨¾ ¤«¿ ±²°®ª¨ ababbabbababbababbabb.
34.4-2
ª ¦¨²¥ ¢¥°µ­¾¾ ®¶¥­ª³ ­  ° §¬¥° ¬­®¦¥±²¢   [q ] (ª ª ´³­ª¶¨¾ ®² q ) ¨ ¯®ª ¦¨²¥, ·²® ¢ ¸  ®¶¥­ª  ­¥³«³·¸ ¥¬ .
34.4-3
 ª ¬®¦­® ­ ©²¨ ¢±¥ ¢µ®¦¤¥­¨¿ ®¡° §¶  P ¢ ²¥ª±² T , §­ ¿
¯°¥´¨ª±-´³­ª¶¨¾ ±²°®ª¨ PT (ª®­ª ²¥­ ¶¨¿ P ¨ T )?
34.4-4
®ª ¦¨²¥, ·²® ¢  «£®°¨²¬¥ KMP-Matcher ¬®¦­® ¢ ±²°®ª¥ 7
(­® ­¥ ¢ ±²°®ª¥ 12) § ¬¥­¨²¼  ­   0, £¤¥ ´³­ª¶¨¿  0 ®¯°¥¤¥«¥­ 
² ª:
8
>
¥±«¨  [q ] = 0;
< 0;
0
0
 [q] = >  [[q ]]; ¥±«¨ [q ] 6= 0 ¨ P [ [q] + 1] = P [q + 1];
:
[q ];
¥±«¨  [q ] 6= 0 ¨ P [ [q ] + 1] 6= P [q + 1].
®·¥¬³ ¬®¦­® ±ª § ²¼, ·²® ² ª ¿ ¬®¤¨´¨ª ¶¨¿  «£®°¨²¬  KMPMatcher ¿¢«¿¥²±¿ ¥£® ³±®¢¥°¸¥­±²¢®¢ ­¨¥¬?
34.4-5
ª ¦¨²¥ ° ¡®² ¾¹¨© §  «¨­¥©­®¥ ¢°¥¬¿  «£®°¨²¬, ¢»¿±­¿¾¹¨©, ¿¢«¿¥²±¿ «¨ ¤ ­­ ¿ ±²°®ª  T ¶¨ª«¨·¥±ª®© ¯¥°¥±² ­®¢ª®©
±²°®ª¨ T 0 (­ ¯°¨¬¥°, ±²°®ª¨ arc ¨ car ¯®«³· ¾²±¿ ®¤­  ¨§ ¤°³£®©
¶¨ª«¨·¥±ª®© ¯¥°¥±² ­®¢ª®©).
34.4-6
 §° ¡®² ©²¥ ½´´¥ª²¨¢­»©  «£®°¨²¬, ¢»·¨±«¿¾¹¨© ´³­ª¶¨¾
¯¥°¥µ®¤   ¤«¿ ª®­¥·­®£®  ¢²®¬ ² , ¨¹³¹¥£® ¯®¤±²°®ª³ P [1::m] ¢
±²°®ª¥ ±¨¬¢®«®¢  «´ ¢¨²  .  ¸  «£®°¨²¬ ¤®«¦¥­ ° ¡®² ²¼ § 
¢°¥¬¿ O(mjj). (ª § ­¨¥. ®ª ¦¨²¥, ·²®  (q; a) =  ( [q ]; a), ¥±«¨
q = m ¨«¨ P [q + 1] 6= a.)

34.5. «£®°¨²¬ ®©¥°  | ³° 
±«¨ ®¡° §¥¶ P ¤«¨­­»©,    «´ ¢¨²  ¤®±² ²®·­® ¢¥«¨ª, ²® ­ ¨¡®«¥¥ ½´´¥ª²¨¢­»¬  «£®°¨²¬®¬ ¯®¨±ª  ¯®¤±²°®ª ¿¢«¿¥²±¿, ¢¨¤¨¬®, ±«¥¤³¾¹¨©  «£®°¨²¬, ¨§®¡°¥²¥­­»© ®©¥°®¬ (Robert S. Boyer)
¨ ³°®¬ (J. Strother Moore):

784

« ¢  34 ®¨±ª ¯®¤±²°®ª
Boyer-Moore-Matcher(T,P,\Sigma)
1 n \gets length[T]
2 m \gets length[P]
3 \lambda \gets Compute-Last-Occurrence-Function(P,m,\Sigma)
4 \gamma \gets Compute-Good-Suffix-Function(P,m)
5 s \gets 0
6 while s \leqslant n-m
7
do j \gets m
8
while j>0 and P[j]=T[s+j]
9
do j \gets j-1
10
if j=0
11
then print ``¡° §¥¶ ¢µ®¤¨² ±® ±¤¢¨£®¬ ''s
12
s \gets s+\gamma[0]
13
else s \gets s+\max(\gamma[j],j-\lambda[T[s+j]])

±«¨ ­¥ ®¡° ¹ ²¼ ¢­¨¬ ­¨¿ ­  § £ ¤®·­»¥  ¨  , ½²®²  «£®°¨²¬
®·¥­¼ ¯®µ®¦ ­  ¯°®±²¥©¸¨©  «£®°¨²¬ ¯®¨±ª  ¯®¤±²°®ª.  ± ¬®¬
¤¥«¥, ¥±«¨ ¬» § ª®¬¬¥­²¨°³¥¬ ±²°®ª¨ 3{4 ¨ § ¬¥­¨¬ ±²°®ª¨ 12{13
­ 
12
13

s \gets s+1
else s \gets s+1,

²® ¯®«³·¨²±¿ ¢ ²®·­®±²¨ ¯°®±²¥©¸¨©  «£®°¨²¬ ° §¤. 34.1, ± ²®©
¥¤¨­±²¢¥­­®© ° §­¨¶¥©, ·²® ±° ¢­¥­¨¥ P [1::m] ¨ T [s +1::s + m] ¨¤¥²
±¯° ¢  ­ «¥¢®,   ­¥ ±«¥¢  ­ ¯° ¢®.
«£®°¨²¬ ®©¥°  | ³°  ¢­®±¨² ¢ ¯°®±²¥©¸¨©  «£®°¨²¬ ±®
±° ¢­¥­¨¥¬ ±¯° ¢  ­ «¥¢® ¤¢  ³±®¢¥°¸¥­±²¢®¢ ­¨¿, ­ §»¢ ¥¬»¥
À½¢°¨±²¨ª®© ±²®¯-±¨¬¢®« Á ¨ À½¢°¨±²¨ª®© ¡¥§®¯ ±­®£® ±³´´¨ª± Á (±¬. °¨±. 34.11). ²¨ ½¢°¨±²¨ª¨ ¯®§¢®«¿¾² ­¥ ° ±±¬ ²°¨¢ ²¼
­¥ª®²®°»¥ (­  ¯° ª²¨ª¥ | ¢¥±¼¬  ¬­®£¨¥) §­ ·¥­¨¿ ±¤¢¨£  s.
¡¥ ½¢°¨±²¨ª¨ ¤¥©±²¢³¾² ­¥§ ¢¨±¨¬® ¨ ¨±¯®«¼§³¾²±¿ ®¤­®¢°¥¬¥­­®. ±«¨ ¯°¨ ¯°®¢¥°ª¥ ±¤¢¨£  s ®¡­ °³¦¨¢ ¥²±¿, ·²® ¯®¤±²°®ª 
T [s + 1::s + m] ­¥ ±®¢¯ ¤ ¥² ± ®¡° §¶®¬, ²® ª ¦¤ ¿ ¨§ ½¢°¨±²¨ª
³ª §»¢ ¥² §­ ·¥­¨¥, ­  ª®²®°®¥ ¬®¦­® ³¢¥«¨·¨²¼ s, ­¥ ®¯ ± ¿±¼
¯°®¯³±²¨²¼ ¤®¯³±²¨¬»© ±¤¢¨£ (½²® j ; [T [s + j ]] ¤«¿ ½¢°¨±²¨ª¨
±²®¯-±¨¬¢®«  ¨  [j ] ¤«¿ ½¢°¨±²¨ª¨ ¡¥§®¯ ±­®£® ±³´´¨ª± );  «£®°¨²¬ ®©¥°  | ³°  ¢»¡¨° ¥² ¨§ ¤¢³µ ±¤¢¨£®¢ ¡®«¼¸¨©.
34.5.1. ¢°¨±²¨ª  ±²®¯-±¨¬¢®« 
²®¯-±¨¬¢®«, ±®®²¢¥²±²¢³¾¹¨© ¤ ­­®¬³ ±¤¢¨£³ ®¡° §¶ , | ½²®
¯¥°¢»© ±¯° ¢  ±¨¬¢®« ¢ ²¥ª±²¥, ®²«¨·­»© ®² ±®®²¢¥²±²¢³¾¹¥£®
±¨¬¢®«  ¢ ®¡° §¶¥. ¢°¨±²¨ª  ±²®¯-±¨¬¢®«  ¯°¥¤« £ ¥² ¯®¯°®¡®¢ ²¼ ­®¢®¥ §­ ·¥­¨¥ ±¤¢¨£ , ¨±µ®¤¿ ¨§ ²®£®, £¤¥ ¢ ®¡° §¶¥ ¢±²°¥· ¥²±¿ ±²®¯-±¨¬¢®« (¥±«¨ ¢®®¡¹¥ ¢±²°¥· ¥²±¿).  ­ ¨¡®«¥¥ ³¤ ·­®¬
±«³· ¥ ±²®¯-±¨¬¢®« ¢»¿¢«¿¥²±¿ ¯°¨ ¯¥°¢®¬ ¦¥ ±° ¢­¥­¨¨ (²® ¥±²¼

«£®°¨²¬ ®©¥°  | ³° 

785

¨±. 34.11, § ­¨¬ ¾¹¨© ¶¥«³¾ ±²° ­¨¶³. ¥°¥¢®¤» ²¥ª±²®¢ ­  °¨±³­ª¥: bad character | ±²®¯-±¨¬¢®«, good sux | ¡¥§®¯ ±­»© ±³´´¨ª±.

®¤¯¨±¼:
¨±. 34.11. ¢°¨±²¨ª¨ ®©¥°  | ³°  (¬» ¨¹¥¬ ¢ ²¥ª±²¥ ¯®¤±²°®ª³ reminiscence). ( ) °¨ ±° ¢­¥­¨¨ ±¤¢¨­³²®£® ­  s ®¡° §¶  ± ²¥ª±²®¬ (±¯° ¢  ­ «¥¢®) ¢»¿±­¨«®±¼, ·²® ¤¢¥ ª° ©­¨¥ ¯° ¢»¥
¡³ª¢» ±®¢¯ ¤ ¾² (®­¨ ®¡° §³¾² À¡¥§®¯ ±­»© ±³´´¨ª±Á ce),   ²°¥²¼¿ ±¯° ¢  ¡³ª¢  ¢ ®¡° §¶¥ | ­¥ ² ª ¿, ª ª ¢ ²¥ª±²¥ (¢ ²¥ª±²¥ ­ 
½²®¬ ¬¥±²¥ ±²®¨² À±²®¯-±¨¬¢®«Á i: ­  ­¥¬ ±° ¢­¥­¨¥ ±²°®ª ®¡°»¢ ¥²±¿). (¡) ¢°¨±²¨ª  ±²®¯-±¨¬¢®«  ¯°¥¤« £ ¥² ±¤¢¨­³²¼ ®¡° §¥¶
¢¯° ¢® ­  ² ª®¥ ° ±±²®¿­¨¥, ·²®¡» ±²®¯-±¨¬¢®« ¢ ²¥ª±²¥ ®ª § «±¿
­ ¯°®²¨¢ ª° ©­¥£® ¯° ¢®£® ¢µ®¦¤¥­¨¿ ½²®£® ±¨¬¢®«  ¢ ®¡° §¥¶. 
­ ¸¥¬ ±«³· ¥ ½²® ®§­ · ¥² ±¤¢¨£ ­  4 ¯®§¨¶¨¨. ±«¨ ±²®¯-±¨¬¢®« 
¢ ®¡° §¶¥ ¢®®¡¹¥ ­¥², ²® ®¡° §¥¶ ­ ¤® ¯®«­®±²¼¾ § ¤¢¨­³²¼ § 
±²®¯-±¨¬¢®« ²¥ª±² ; ¥±«¨ ±²®¯-±¨¬¢®« ¢ ®¡° §¶¥ ¢±²°¥· ¥²±¿ ¯° ¢¥¥ ±²®¯-±¨¬¢®«  ¢ ²¥ª±²¥, ²® ½¢°¨±²¨ª  ±²®¯-±¨¬¢®«  ­¨·¥£® ¯®«¥§­®£® ­¥ ¯°¥¤« £ ¥² (¤ ¥² ®²°¨¶ ²¥«¼­»© ±¤¢¨£, ª®²®°»© ¡³¤¥²
¯°®¨£­®°¨°®¢ ­  «£®°¨²¬®¬). (¢) ¢°¨±²¨ª  ¡¥§®¯ ±­®£® ±³´´¨ª±  ¯°¥¤« £ ¥² ±¤¢¨­³²¼ ®¡° §¥¶ ¢¯° ¢® ­ ±²®«¼ª®, ·²®¡» ¡«¨¦ ©¸¥¥ (¥±«¨ ±¬®²°¥²¼ ±¯° ¢  ­ «¥¢®) ¢µ®¦¤¥­¨¥ ¡¥§®¯ ±­®£® ±³´´¨ª±  ¢ ®¡° §¥¶ ®ª § «®±¼ ­ ¯°®²¨¢ ¡¥§®¯ ±­®£® ±³´´¨ª±  ¢ ²¥ª±²¥. 
­ ¸¥¬ ¯°¨¬¥°¥ ½²® ®§­ · ¥² ±¤¢¨£ ­  3 ¯®§¨¶¨¨. «£®°¨²¬ ®©¥°  | ³°  ¢»¡¨° ¥² ¡®«¼¸¨© ¨§ ¤¢³µ °¥ª®¬¥­¤³¥¬»µ ±¤¢¨£®¢ (¢
­ ¸¥¬ ±«³· ¥ | ±¤¢¨£ ­  4).

786

« ¢  34 ®¨±ª ¯®¤±²°®ª

P [m] 6= T [s + m]) ¨ ­¥ ¢±²°¥· ¥²±¿ ­¨£¤¥ ¢ ®¡° §¶¥ (¯°¥¤±² ¢¼-

²¥ ±¥¡¥, ·²® ¢» ¨¹¥²¥ ¯®¤±²°®ª³ am ¢ ±²°®ª¥ bn ).  ½²®¬ ±«³· ¥
±¤¢¨£ s ¬®¦­® ±° §³ ³¢¥«¨·¨²¼ ­  m: «¾¡®© ¬¥­¼¸¨© ±¤¢¨£ § ¢¥¤®¬® ­¥ ¯®¤®©¤¥², ² ª ª ª ±²®¯-±¨¬¢®« ¢ ²¥ª±²¥ ®ª ¦¥²±¿ ­ ¯°®²¨¢
ª ª®£®-²® ±¨¬¢®«  ¨§ ®¡° §¶ . ±«¨ ½²®² ­ ¨¡®«¥¥ ³¤ ·­»© ±«³· ©
¯®¢²®°¿¥²±¿ ¯®±²®¿­­®, ²® ¯°¨ ¯®¨±ª¥ ¯®¤±²°®ª¨ ¬» ¯°®±¬®²°¨¬
¢±¥£® «¨¸¼ 1=m · ±²¼ ²¥ª±²  (¢®² ª ª ¯®«¥§­® ±° ¢­¨¢ ²¼ ±¯° ¢ 
­ «¥¢®!).
 ®¡¹¥¬ ±«³· ¥ ½¢°¨±²¨ª  ±²®¯-±¨¬¢®«  (bad-character heuristic) ° ¡®² ¥² ² ª. °¥¤¯®«®¦¨¬, ·²® ¯°¨ ±° ¢­¥­¨¨ ±¯° ¢  ­ «¥¢® ¬» ­ ²ª­³«¨±¼ ­  ¯¥°¢®¥ ­¥±®¢¯ ¤¥­¨¥: P [j ] 6= T [s + j ], £¤¥
1 6 j 6 m. ³±²¼ k | ­®¬¥° ± ¬®£® ¯° ¢®£® ¢µ®¦¤¥­¨¿ ±¨¬¢®«  T [s + j ] ¢ ®¡° §¥¶ P (¥±«¨ ½²®² ±¨¬¢®« ¢®®¡¹¥ ­¥ ¯®¿¢«¿¥²±¿ ¢
®¡° §¶¥, ±·¨² ¥¬ k ° ¢­»¬ 0). » ³²¢¥°¦¤ ¥¬, ·²® ¬®¦­® ³¢¥«¨·¨²¼ s ­  j ; k, ­¥ ³¯³±²¨¢ ­¨ ®¤­®£® ¤®¯³±²¨¬®£® ±¤¢¨£ .  ± ¬®¬
¤¥«¥, ¥±«¨ k = 0, ²® ±²®¯-±¨¬¢®« T [s + j ] ¢®®¡¹¥ ­¥ ¢±²°¥· ¥²±¿
¢ ®¡° §¶¥ P , ² ª ·²® ¬®¦­® ±° §³ ±¤¢¨­³²¼ ®¡° §¥¶ ­  j ; k = j
¯®§¨¶¨© ¢¯° ¢® (°¨±. 34.12 ( )); ¥±«¨ 0 < k < j , ²® ®¡° §¥¶ ¬®¦­®
±¤¢¨­³²¼ ­  j ; k ¯®§¨¶¨© ¢¯° ¢®, ² ª ª ª ¯°¨ ¬¥­¼¸¨µ ±¤¢¨£ µ
±²®¯-±¨¬¢®« ¢ ²¥ª±²¥ ­¥ ±®¢¯ ¤¥² ± ±®®²¢¥²±²¢³¾¹¨¬ ±¨¬¢®«®¬
®¡° §¶  (°¨±. 34.12 (¡)).  ª®­¥¶, ¥±«¨ k > j , ²® ½¢°¨±²¨ª  ¯°¥¤« £ ¥² ±¤¢¨£ ²¼ ®¡° §¥¶ ­¥ ¢¯° ¢®,   ¢«¥¢®;  «£®°¨²¬ ®©¥° -³° 
½²³ °¥ª®¬¥­¤ ¶¨¾ ¨£­®°¨°³¥², ¯®±ª®«¼ª³ ½¢°¨±²¨ª  ¡¥§®¯ ±­®£®
±³´´¨ª±  ¢±¥£¤  ¯°¥¤« £ ¥² ­¥­³«¥¢®© ±¤¢¨£ ¢¯° ¢®.
²®¡» ¯°¨¬¥­¿²¼ ½¢°¨±²¨ª³ ±²®¯-±¨¬¢®« , ¯®«¥§­® ¤«¿ ª ¦¤®£®
¢®§¬®¦­®£® ±²®¯-±¨¬¢®«  a 2  ¢»·¨±«¨²¼ §­ ·¥­¨¥ k. ²® ¤¥« ¥²±¿ ¯°®±²®© ¯°®¶¥¤³°®© Compute-Last-Occurrence-Function
(À­ ©²¨ ¯®±«¥¤­¥¥ ¢µ®¦¤¥­¨¥Á), ª®²®° ¿ ¤«¿ ª ¦¤®£® a 2  ¢»·¨±«¿¥² [a] | ­®¬¥° ª° ©­¥£® ¯° ¢®£® ¢µ®¦¤¥­¨¿ a ¢ P , ¨«¨ ­³«¼,
¥±«¨ a ¢ P ­¥ ¢µ®¤¨².  ½²¨µ ®¡®§­ ·¥­¨¿µ ¯°¨° ¹¥­¨¥ ±¤¢¨£ , ¤¨ª²³¥¬®¥ ½¢°¨±²¨ª®© ±²®¯-±¨¬¢®« , ¥±²¼ j ; [T [s + j ]], ª ª ¨ ­ ¯¨± ­®
¢ ±²°®ª¥ 13  «£®°¨²¬  Boyer-Moore-Matcher.
Compute-Last-Occurrence-Function(P,m,\Sigma)
1 for (¤«¿) ª ¦¤®£® ±¨¬¢®«  a \in \Sigma
2
do \lambda[a] \gets 0
3 for j \gets 1 to m
4
do \lambda[P[j]] \gets j
5 return \lambda

°¥¬¿

° ¡®²»

¯°®¶¥¤³°»

Function ¥±²¼ O(jj + m).

Compute-Last-Occurrence-

34.5.2. ¢°¨±²¨ª  ¡¥§®¯ ±­®£® ±³´´¨ª± 
±«¨ Q ¨ R | ±²°®ª¨, ¡³¤¥¬ £®¢®°¨²¼, ·²® ®­¨ ±° ¢­¨¬» (®¡®§­ ·¥­¨¥: Q  R), ¥±«¨ ®¤­  ¨§ ­¨µ ¿¢«¿¥²±¿ ±³´´¨ª±®¬ ¤°³£®©.

«£®°¨²¬ ®©¥°  | ³° 

787

¨±. 34.12, § ­¨¬ ¾¹¨© ¶¥«³¾ ±²° ­¨¶³. ¥°¥¢®¤ ­ ¤¯¨±¨ ¢ °¨±³­ª¥: bad character | ±²®¯-±¨¬¢®«.

®¤¯¨±¼:
¨±. 34.12. ¢°¨±²¨ª  ±²®¯-±¨¬¢®« : ²°¨ ±«³· ¿. ( ) ²®¯-±¨¬¢®« ¢
®¡° §¶¥ ­¥ ¢±²°¥· ¥²±¿, ² ª ·²® ®¡° §¥¶ ¬®¦­® ±¤¢¨­³²¼ ­  j = 11
¯®§¨¶¨© ¢¯° ¢®, ®±² ¢¨¢ ±²®¯-±¨¬¢®« ¯®§ ¤¨. (¡) ° ©­¥¥ ¯° ¢®¥
¢µ®¦¤¥­¨¥ ±²®¯-±¨¬¢®«  ¢ ®¡° §¥¶ | ¢ ¯®§¨¶¨¨ k < j . ¡° §¥¶
¬®¦­® ±¤¢¨­³²¼ ¢¯° ¢® ­  j ; k | ² ª, ·²®¡» ±²®¯-±¨¬¢®«» ¢
²¥ª±²¥ ¨ ®¡° §¶¥ ®ª § «¨±¼ ¤°³£ ¯®¤ ¤°³£®¬ (¢ ¯°¨¬¥°¥ j = 10,
k = 6, ±²®¯-±¨¬¢®« ¥±²¼ i, ±¤¢¨£ ­  10 ; 6 = 4). (¢) ²®¯-±¨¬¢®«
¢±²°¥· ¥²±¿ ¢ ®¡° §¶¥ ¢ ¯®§¨¶¨¨ k > j (¢ ¯°¨¬¥°¥ ±²®¯-±¨¬¢®« ¥±²¼
e, j = 10, k = 12). ¢°¨±²¨ª  ¯°¥¤« £ ¥² ±¤¢¨£ ¢«¥¢®, ­®  «£®°¨²¬
½²® ¯°¥¤«®¦¥­¨¥ ¨£­®°¨°³¥².

788

« ¢  34 ®¨±ª ¯®¤±²°®ª

±«¨ ¢»°®¢­¿²¼ ¤¢¥ ±° ¢­¨¬»¥ ±²°®ª¨ ¯® ¯° ¢®¬³ ª° ¾, ²® ±¨¬¢®«», ° ±¯®«®¦¥­­»¥ ®¤¨­ ¯®¤ ¤°³£¨¬, ¡³¤³² ±®¢¯ ¤ ²¼. ²­®¸¥­¨¥
 ±¨¬¬¥²°¨·­®: ¥±«¨ Q  R, ²® ¨ R  Q. § «¥¬¬» 34.1 ±«¥¤³¥²,
·²®
¥±«¨ Q A R ¨ S A R, ²® Q  S .
(34:7)
¢°¨±²¨ª  ¡¥§®¯ ±­®£® ±³´´¨ª±  (good-sux heuristic) ±®±²®¨²
¢ ±«¥¤³¾¹¥¬: ¥±«¨ P [j ] 6= T [s + j ], £¤¥ j < m (¨ ·¨±«® j | ­ ¨¡®«¼¸¥¥ ± ² ª¨¬ ±¢®©±²¢®¬), ²® ¬» ¬®¦¥¬ ¡¥§¡®¿§­¥­­® ³¢¥«¨·¨²¼
±¤¢¨£ ­ 

 [j ] = m ; maxf k : 0 6 k < m ¨ P [j + 1::m]  Pk g:
­»¬¨ ±«®¢ ¬¨,  [j ] | ­ ¨¬¥­¼¸¥¥ ° ±±²®¿­¨¥, ­  ª®²®°®¥ ¬» ¬®-

¦¥¬ ±¤¢¨­³²¼ ®¡° §¥¶ ¡¥§ ²®£®, ·²®¡» ª ª®©-²® ¨§ ±¨¬¢®«®¢, ¢µ®¤¿¹¨µ ¢ À¡¥§®¯ ±­»© ±³´´¨ª±Á T [s + j + 1::s + m] ®ª § «±¿ ­ ¯°®²¨¢ ­¥ ±®¢¯ ¤ ¾¹¥£® ± ­¨¬ ±¨¬¢®«  ¨§ ®¡° §¶ . ®±ª®«¼ª³ ±²°®ª 
P [j + 1::m] § ¢¥¤®¬® ±° ¢­¨¬  ± ¯³±²®© ±²°®ª®© P0 , ·¨±«®  [j ] ª®°°¥ª²­® ®¯°¥¤¥«¥­® ¤«¿ ¢±¥µ j . ²®¨² ² ª¦¥ § ¬¥²¨²¼, ·²®  [j ] > 0
¤«¿ ¢±¥µ j , ² ª ·²® ­  ª ¦¤®¬ ¸ £¥  «£®°¨²¬  ®©¥°  | ³° 
®¡° §¥¶ ¡³¤¥² ±¤¢¨£ ²¼±¿ ¢¯° ¢® µ®²¿ ¡» ­  ®¤­³ ¯®§¨¶¨¾. »
¡³¤¥¬ ­ §»¢ ²¼  ´³­ª¶¨¥© ¡¥§®¯ ±­®£® ±³´´¨ª±  (good-sux function),  ±±®¶¨¨°®¢ ­­®© ±® ±²°®ª®© P .
®±¬®²°¨¬, ª ª ¬®¦­® ¢»·¨±«¨²¼ ´³­ª¶¨¾ ¡¥§®¯ ±­®£® ±³´´¨ª±   . «¿ ­ · «  § ¬¥²¨¬, ·²® P[m] A P , ®²ª³¤ , ¢ ±¨«³ (34.7),
¨¬¥¥¬ P [j + 1::m]  P[m] ¤«¿ «¾¡®£® j . «¥¤®¢ ²¥«¼­®, ¬ ª±¨¬³¬
¢ ¯° ¢®© · ±²¨ ®¯°¥¤¥«¥­¨¿ ¢¥«¨·¨­»  [j ] ­¥ ¬¥­¼¸¥  [m], ² ª ·²®
 [j ] 6 m ; [m] ¤«¿ ¢±¥µ j .
² «® ¡»²¼, ¬®¦­® ¯¥°¥¯¨± ²¼ ­ ¸¥ ®¯°¥¤¥«¥­¨¥  ² ª:

 [j ] = m ; maxf k :  [m] 6 k < m ¨ P [j + 1::m]  Pk g:
±«®¢¨¥ P [j + 1::m]  Pk ¬®¦¥² ¢»¯®«­¿²¼±¿ ¢ ¤¢³µ ±«³· ¿µ: «¨¡®
ª®£¤  P [j + 1::m] A Pk , «¨¡® ª®£¤  Pk A P [j + 1::m]. ® ¢²®°®¬
±«³· ¥, ®¤­ ª®, ¨¬¥¥¬ Pk A Pm , ®²ª³¤  k 6  [m] ¨ ¯®²®¬³ k =  [m].
®½²®¬³ ®¯°¥¤¥«¥­¨¥  ¬®¦­® ¯¥°¥¯¨± ²¼ ¥¹¥ ¨ ² ª:
 [j ] = m ; max (f [m]g [ f k : [m] < k < m ¨ P [j + 1::m] A Pk g)
²®°®¥ ¨§ ½²¨µ ¬­®¦¥±²¢ ¬®¦¥² ®ª § ²¼±¿ ¯³±²»¬.  ± ¬®¬ ¤¥«¥,
¬» ¨¹¥¬ ¯°¥´¨ª± Pk ®¡° §¶  P , ¢ ª®²®°®¬ P [j + 1::m] ¿¢«¿¥²±¿
±³´´¨ª±®¬; ¤°³£¨¬¨ ±«®¢ ¬¨, ¬» ¨¹¥¬ ¢ ®¡° §¶¥ ³· ±²®ª ° ¢­»©
¥£® ±³´´¨ª±³ P [j + 1::m] ¨ ° ±¯®«®¦¥­­»© «¥¢¥¥ (k < m)
 ¬ ­³¦­® ­ ©²¨ ± ¬»© ¯° ¢»© ¨§ ² ª¨µ ³· ±²ª®¢ (·¨±«  k,
¨§ ª®²®°»µ ¡¥°¥²±¿ ¬ ª±¨¬ «¼­®¥ | ½²® ¯° ¢»¥ £° ­¨¶» ² ª¨µ
³· ±²ª®¢). «¿ ½²®£® ¯®«¥§­® ° ±±¬®²°¥²¼ ±²°®ª³ P 0 , ¿¢«¿¾¹³¾±¿
®¡° ¹¥­¨¥¬ ±²°®ª¨ P ¨ ±®®²¢¥²±²¢³¾¹³¾ ¥© ¯°¥´¨ª±-´³­ª¶¨¾ pi0

«£®°¨²¬ ®©¥°  | ³° 

789

(¨­»¬¨ ±«®¢ ¬¨, P 0 [i] = P [m + 1 ; i] ¨  0 [t] | ¬ ª±¨¬ «¼­®¥ u < t,
¤«¿ ª®²®°®£® Pu0 A Pt0 ).
³±²¼ ³· ±²®ª X ±²°®ª¨ P § ª ­·¨¢ ¥²±¿ ¢ ¯®§¨¶¨¨ k (²® ¥±²¼
¿¢«¿¥²±¿ ±³´´¨ª±®¢ ±²°®ª¨ Pk ) ¨ ° ¢¥­ P [j + 1::m]. «¨­» ®¡®¨µ
° ¢­»µ ³· ±²ª®¢ ° ¢­» m ; j , ¨ «¥£ª® ¯®­¿²¼, ·²® ½²¨ ³· ±²ª¨
(¢ ¯¥°¥¢¥°­³²®¬ ¢¨¤¥) ¡³¤³² ±³´´¨ª±®¬ ¨ ¯°¥´¨ª±®¬ ±²°®ª¨ Pl0 ,
£¤¥ l = (m ; k) + (m ; j ) (§¤¥±¼ (m ; k) | ° ±±²®¿­¨¥ ®² ª®­¶ 
³· ±²ª  X ¤® ª®­¶  ®¡° §¶ , (m ; j ) | ¤«¨­  ³· ±²ª ). ®½²®¬³
0[l] > m ; j . ®ª ¦¥¬, ·²® ­  ± ¬®¬ ¤¥«¥ ¨¬¥¥² ¬¥±²® ° ¢¥­±²¢®
 0[l] = m ; j:
(34:8)
 ± ¬®¬ ¤¥«¥, ¥±«¨ ¡» ¡®«¥¥ ¤«¨­­»© ³· ±²®ª X 0, ­ ·¨­ ¾¹¨©±¿ ¢
²®© ¦¥ ¯®§¨¶¨¨, ·²® ¨ X , ¡»« ¡» ±³´´¨ª±®¬ ®¡° §¶ , ²® ­¥ª®²®°»©
¥£® ±³´´¨ª± ±®¢¯ ¤ « ¡» ± P [j +1::m] ¨ ¯®²®¬³ X ­¥ ¡»« ¡» ± ¬»¬
¯° ¢»¬ ³· ±²ª®¬ ±²°®ª¨ P , ±®¢¯ ¤ ¾¹¨¬ ± P [j + 1::m],
 ¢¥­±²¢® (34.8) ¬®¦­® ¯¥°¥¯¨± ²¼ ª ª j = m ;  0[l]; ª°®¬¥ ²®£®,
¨§ ­¥£® ±«¥¤³¥², ·²® k = m ; l +  0 [l]. ¯®½²®¬³ ¬®¦­® ®ª®­· ²¥«¼­®
¯¥°¥¯¨± ²¼ ­ ¸³ ´®°¬³«³ ¤«¿  [j ] ² ª:
 [j ] = m;max(f[m]g[f m;l+0[l] : 1 6< l 6 m ¨ j = m ; 0[l] g)
= min(f m ;  [m] g [ f l ;  0[l] : 1 6 l 6 m ¨ j = m ;  0[l] g) (34.9)
(®¯¿²¼-² ª¨, ¢²®°®¥ ¬­®¦¥±²¢® ¬®¦¥² ®ª § ²¼±¿ ¯³±²»¬).
¥¯¥°¼ ¬®¦­® ¢»¯¨± ²¼ ¯±¥¢¤®ª®¤ ¤«¿ ´³­ª¶¨¨, ¢»·¨±«¿¾¹¥©
:
Compute-Good-Suffix-Function(P,m)
1 \pi \gets Compute-Prefix-Function(P,m)
2 P' \gets ®¡° ¹¥­¨¥ ±²°®ª¨ P
3 \pi' \gets Compute-Prefix-Function(P',m)
4 for j \gets 0 to m
5
do \gamma[j] \gets m-\pi[m]
6 for l \gets 1 to m
7
do j \gets m - \pi'[l]
8
if \gamma[j] > l - \pi'[l]
9
then \gamma[j] \gets l - \pi'[l]
10 return \gamma

°®¶¥¤³°  Compute-Good-Suffix-Function ¯°®¢®¤¨² ¢»·¨±«¥­¨¿ ¢ ²®·­®±²¨ ¯® ´®°¬³«¥ (34.9). ¥ ¢°¥¬¿ ° ¡®²» ¥±²¼ O(m).
°¥¬¿ ° ¡®²»  «£®°¨²¬  ®©¥°  | ³°  ¢ µ³¤¸¥¬ ±«³· ¥ ¥±²¼
O((n ; m + 1)m + jj), ¯®±ª®«¼ª³ ­  ¨±¯®«­¥­¨¥ Compute-LastOccurrence-Function ³µ®¤¨² ¢°¥¬¿ O(m + jj), ­  ComputeGood-Suffix-Function ³µ®¤¨² O(m), ¨ ¢ µ³¤¸¥¬ ±«³· ¥  «£®°¨²¬ ®©¥°  | ³°  (ª ª ¨  «£®°¨²¬  ¡¨­  |  °¯ ) ¯®²° ²¨²
¢°¥¬¿ O(m) ­  ¯°®¢¥°ª³ ª ¦¤®£®  ¯°¨®°¨ ¢®§¬®¦­®£® ±¤¢¨£ .  
¯° ª²¨ª¥, ®¤­ ª®, ¨¬¥­­®  «£®°¨²¬ ®©¥° -³°  · ±²® ®ª §»¢ ¥²±¿ ­ ¨¡®«¥¥ ½´´¥ª²¨¢­»¬.

790

« ¢  34 ®¨±ª ¯®¤±²°®ª

34.5.3. ¯° ¦­¥­¨¿
34.5-1
»·¨±«¨²¥ ´³­ª¶¨¨  ¨  ¤«¿ ±²°®ª¨ P = 0101101201.
34.5-2
®ª ¦¨²¥ ­  ¯°¨¬¥° µ, ·²® ½¢°¨±²¨ª¨ ±²®¯-±¨¬¢®«  ¨ ½¢°¨±²¨ª  ¡¥§®¯ ±­®£® ±³´´¨ª± , ¤¥©±²¢³¿ ¢¬¥±²¥, ¬®£³² ¤ ²¼ ¡®«¼¸®©
¢»¨£°»¸ ¯® ±° ¢­¥­¨¾ ± ¨±¯®«¼§®¢ ­¨¥¬ ²®«¼ª® ½¢°¨±²¨ª¨ ¡¥§®¯ ±­®£® ±³´´¨ª± .
34-5.3*
  ¯° ª²¨ª¥ ¢¬¥±²® ´³­ª¶¨¨  · ±²® ¨±¯®«¼§³¾² ³±®¢¥°¸¥­±²¢®¢ ­­³¾ ´³­ª¶¨¾  0, ®¯°¥¤¥«¥­­³¾ ² ª:

 0[j ] = m ; maxf k : 0 6 k < m, P [j + 1::m]  Pk
¨ (k ; m + j > 0 ) P [j ] =
6 P [k ; m + j ]) g
(¨­»¬¨ ±«®¢ ¬¨, ¬» ¤®¯®«­¨²¥«¼­® ²°¥¡³¥¬, ·²®¡» ¯°¨ ­®¢®¬
±¤¢¨£¥ ­ ¯°®²¨¢ ±²®¯-±¨¬¢®«  ¢ ²¥ª±²¥ ±²®¿« ­¥ ²®² ¦¥ § ¢¥¤®¬®
­¥£®¤­»© ±¨¬¢®« ®¡° §¶ , ·²® ¯°¨ ¯°¥¤»¤³¹¥¬).  ª ½´´¥ª²¨¢­®
¢»·¨±«¿²¼ ´³­ª¶¨¾  0?

 ¤ ·¨
34-1 «£®°¨²¬ ¯®¨±ª , ³·¨²»¢ ¾¹¨© ¯®¢²®°¥­¨¿ ¢ ®¡° §¶¥
¥°¥§ y i ¡³¤¥¬ ¤ «¥¥ ®¡®§­ · ²¼ i-ª° ²­³¾ ª®­ª ²¥­ ¶¨¾ ±²°®ª¨ y ± ±®¡®© (­ ¯°¨¬¥°, (ab)3 = ababab). ³¤¥¬ £®¢®°¨²¼, ·²® ±²°®ª  x 2  ¨¬¥¥² ª®½´´¨¶¨¥­² ¯®¢²®°¥­¨¿ (has repetition factor) r,
¥±«¨ x = y r , £¤¥ r > 0 ¨ y 2 . ¥°¥§ (x) ®¡®§­ ·¨¬ ­ ¨¡®«¼¸¨©
¨§ ª®½´´¨¶¨¥­²®¢ ¯®¢²®°¥­¨¿ ±²°®ª¨ x.
( )  §° ¡®² ©²¥ ½´´¥ª²¨¢­»©  «£®°¨²¬, ­ µ®¤¿¹¨© (Pi ) ¤«¿
¤ ­­®© ±²°®ª¨ P ¨ ¤«¿ ¢±¥µ i = 1; 2; : : :; m. ¶¥­¨²¥ ¢°¥¬¿ ° ¡®²» ¢ ¸¥£®  «£®°¨²¬ .
(¡) «¿ ±²°®ª¨ P [1::m] ¯®«®¦¨¬ (P ) = max16i6m (Pi ). ³±²¼
jj = 2 ¨ ±²°®ª  P ¢»¡¨° ¥²±¿ ±«³· ©­»¬ ®¡° §®¬. ®ª ¦¨²¥, ·²® ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥  (P ) ®£° ­¨·¥­® ±¢¥°µ³ ª®­±² ­²®©, ­¥ § ¢¨±¿¹¥© ®² m.
(¢) ®ª ¦¨²¥, ·²® ¯°¨¢¥¤¥­­ ¿ ­¨¦¥ ¯°®£° ¬¬  ­ µ®¤¨² ¢±¥ ¢µ®¦¤¥­¨¿ ®¡° §¶  P ¢ ²¥ª±² T §  ¢°¥¬¿ O((P )n + m).
Repetition-Matcher(P,T)
1 m \gets length[P]
2 n \gets length[T]
3 k \gets 1+\rho^*(P)
4 q \gets 0
5 s \gets 0

 ¬¥· ­¨¿

791

6 while s \leqslant n-m
7
do if T[s+q+1]=P[q+1]
8
then q \gets q+1
9
if q=m
10
then print
``¡° §¥¶ ¢µ®¤¨² ±® ±¤¢¨£®¬ ''s
11
if q=m ¨«¨ T[s+q+1]\ne P[q+1]
12
then s \gets s+\max(1, \lceil q/k \rceil)
13
q \gets 0

²®²  «£®°¨²¬ ¯°¥¤«®¦¨«¨  «¨« ¨ ¥©´¥° ±.  §¢¨¢ ¿ ½²¨
¨¤¥¨, ®­¨ ¯®«³·¨«¨  «£®°¨²¬ ¤«¿ ¯®¨±ª  ¯®¤±²°®ª, ° ¡®² ¾¹¨©
§  «¨­¥©­®¥ ¢°¥¬¿ ¨ ¨±¯®«¼§³¾¹¨© ¢±¥£® O(1) ¯ ¬¿²¨ ¯®¬¨¬®
²°¥¡³¥¬®© ¤«¿ µ° ­¥­¨¿ P ¨ T .
34-2  ° ««¥«¼­»©  «£®°¨²¬ ¯®¨±ª 
¡±³¤¨¬, ª ª ¬®¦­® ¨±¯®«¼§®¢ ²¼ ¯ ° ««¥«¼­»© ª®¬¯¼¾²¥° ¤«¿
¯®¨±ª  ¯®¤±²°®ª. ³±²¼ ¤«¿ ¤ ­­®£® ®¡° §¶  P ³ ­ ± ¥±²¼ ª®­¥·­»©  ¢²®¬ ² M , ¯°¥¤­ §­ ·¥­­»© ¤«¿ ¯®¨±ª  P ¢ ²¥ª±²¥. ³±²¼
Q | ¬­®¦¥±²¢® ¥£® ±®±²®¿­¨©,   ' | ´³­ª¶¨¿, ª®²®° ¿ ±² ¢¨² ¢
±®®²¢¥²±²¢¨¥ ª ¦¤®¬³ ±«®¢³ ±®±²®¿­¨¥  ¢²®¬ ²  M ¯®±«¥ ·²¥­¨¿
½²®£® ±«®¢ . ³±²¼ T [1::n] | ²¥ª±², ¢ ª®²®°®¬ ¬» ¨¹¥¬ ®¡° §¥¶ P ,
²®£¤  ­ ¬ ­¥®¡µ®¤¨¬® ­ ©²¨ '(Ti) ¤«¿ ¢±¥µ i. » ¡³¤¥¬ ¤¥©±²¢®¢ ²¼ ª ª ¢ ° §¤¥«¥ 30.1.2.
«¿ ¢±¿ª®© ±²°®ª¨ x ®¡®§­ ·¨¬ ·¥°¥§ x (q ) ±®±²®¿­¨¥  ¢²®¬ ² 
M , ¢ ª®²®°®¥ ®­ ¯°¨¤¥², ¥±«¨ ¯®¬¥±²¨²¼ ¥£® ¢ ±®±²®¿­¨¥ q ¨ ¯®¤ ²¼
­  ¢µ®¤ ±²°®ª³ x. ( ª¨¬ ®¡° §®¬, x ¥±²¼ ´³­ª¶¨¿ ¨§ Q ¢ Q.)
( ) ®ª ¦¨²¥, ·²® y  x = xy (¢ «¥¢®© · ±²¨ ±²®¨² ª®¬¯®§¨¶¨¿
®²®¡° ¦¥­¨©).
(¡) ®ª ¦¨²¥, ·²® ®¯¥° ¶¨¿   ±±®¶¨ ²¨¢­ .
(¢) ®ª ¦¨²¥, ·²® ² ¡«¨¶  §­ ·¥­¨© ´³­ª¶¨¨ xy ¬®¦¥² ¡»²¼ ¢»·¨±«¥­  ­  CREW PRAM §  ¢°¥¬¿ O(1) ¨±µ®¤¿ ¨§ ² ¡«¨¶ §­ ·¥­¨© x ¨ y . ¶¥­¨²¥ ­¥®¡µ®¤¨¬®¥ ¤«¿ ½²®£® ·¨±«® ¯°®¶¥±±®°®¢
¢ § ¢¨±¨¬®±²¨ ®² jQj.
(£) ®ª ¦¨²¥, ·²® '(Ti) = Ti (q0 ), £¤¥ q0 | ¨±µ®¤­®¥ ±®±²®¿­¨¥.
(¤) ®ª ¦¨²¥, ·²® ­  CREW PRAM ¢±¥ ¢µ®¦¤¥­¨¿ ®¡° §¶  P ¢
²¥ª±² T ¤«¨­» n ¬®¦­® ­ ©²¨ §  ¢°¥¬¿ O(lg n) (±·¨² ©²¥, ·²®
®¡° §¥¶ P § ¤ ­ ¢ ¢¨¤¥ ±®®²¢¥²±²¢³¾¹¥£® ª®­¥·­®£®  ¢²®¬ ² ).

34.6.  ¬¥· ­¨¿
¢¿§¼ § ¤ ·¨ ® ¯®¨±ª¥ ¯®¤±²°®ª ± ª®­¥·­»¬¨  ¢²®¬ ² ¬¨ ®¡±³¦¤ ¥²±¿ ³ µ®, ®¯ª°®´²  ¨ «¼¬ ­  [4]. «£®°¨²¬ ­³²  | ®°°¨±  | ° ²²  ¡»« ­¥§ ¢¨±¨¬® ¨§®¡°¥²¥­ ­³²®¬ ¨ ®°°¨±®¬, ±
®¤­®© ±²®°®­», ¨ ° ²²®¬ | ± ¤°³£®©; ¢ °¥§³«¼² ²¥ ®­¨ ®¯³¡«¨-

792

« ¢  34 ®¨±ª ¯®¤±²°®ª

ª®¢ «¨ ±®¢¬¥±²­³¾ ° ¡®²³.  ¡¨­ ¨  °¯ ®¯¨± «¨ ±¢®©  «£®°¨²¬
¢ [117]; ®©¥° ¨ ³° | ¢ [32].  «¨« ¨ ¥©´¥° ± [78] ¯°¥¤«®¦¨«¨
¨­²¥°¥±­»© ¤¥²¥°¬¨­¨°®¢ ­­»©  «£®°¨²¬ ¤«¿ ¯®¨±ª  ¯®¤±²°®ª,
° ¡®² ¾¹¨© §  «¨­¥©­®¥ ¢°¥¬¿ ¨ ¨±¯®«¼§³¾¹¨© «¨¸¼ O(1) ¯ ¬¿²¨ (¯®¬¨¬® ¯ ¬¿²¨ ¤«¿ µ° ­¥­¨¿ ®¡° §¶  ¨ ²¥ª±² ).

35

»·¨±«¨²¥«¼­ ¿ £¥®¬¥²°¨¿

»·¨±«¨²¥«¼­ ¿ £¥®¬¥²°¨¿ | ½²® ° §¤¥« ¨­´®°¬ ²¨ª¨, ¨§³· ¾¹¨©  «£®°¨²¬» °¥¸¥­¨¿ £¥®¬¥²°¨·¥±ª¨µ § ¤ ·.  ª¨¥ § ¤ ·¨ ¢®§­¨ª ¾² ¢ ¬ ¸¨­­®© £° ´¨ª¥, ¯°®¥ª²¨°®¢ ­¨¨ ¨­²¥£° «¼­»µ ±µ¥¬,
²¥µ­¨·¥±ª¨µ ³±²°®©±²¢ ¨ ¤°. ±µ®¤­»¬¨ ¤ ­­»¬¨ ¢ ² ª®£® °®¤ 
§ ¤ ·¥ ¬®£³² ¡»²¼ ¬­®¦¥±²¢® ²®·¥ª, ­ ¡®° ®²°¥§ª®¢, ¬­®£®³£®«¼­¨ª (§ ¤ ­­»©, ­ ¯°¨¬¥°, ±¯¨±ª®¬ ±¢®¨µ ¢¥°¸¨­ ¢ ¯®°¿¤ª¥ ¤¢¨¦¥­¨¿ ¯°®²¨¢ · ±®¢®© ±²°¥«ª¨) ¨ ².¯. ¥§³«¼² ²®¬ ¬®¦¥² ¡»²¼ «¨¡®
®²¢¥² ­  ª ª®© ²® ¢®¯°®± (²¨¯  À¯¥°¥±¥ª ¾²±¿ «¨ ½²¨ ¯°¿¬»¥?Á),
«¨¡® ª ª®©-²® £¥®¬¥²°¨·¥±ª¨© ®¡º¥ª² (­ ¯°¨¬¥°, ­ ¨¬¥­¼¸¨© ¢»¯³ª«»© ¬­®£®³£®«¼­¨ª, ±®¤¥°¦ ¹¨© § ¤ ­­»¥ ²®·ª¨).
 ½²®© £« ¢¥ ¬» ¡³¤¥¬ ° ±±¬ ²°¨¢ ²¼ ²®«¼ª® ¯« ­¨¬¥²°¨·¥±ª¨¥
§ ¤ ·¨ ¨ ¯°®¨««¾±²°¨°³¥¬ ­¥ª®²®°»¥ ¢ ¦­»¥ ¬¥²®¤» ¢»·¨±«¨²¥«¼­®© £¥®¬¥²°¨¨ ­  ½²®¬ ¯°¨¬¥°¥.  ­ ¸¨µ § ¤ · µ ¨±µ®¤­»¬¨
¤ ­­»¬¨ ¡³¤¥² ¬­®¦¥±²¢® ²®·¥ª ¯«®±ª®±²¨ fpig , § ¤ ­­»µ ±¢®¨¬¨
ª®®°¤¨­ ² ¬¨: pi = (xi; yi ), £¤¥ xi ; yi 2 R.  ¯°¨¬¥°, n-³£®«¼­¨ª P
¬®¦­® § ¤ ²¼ ¯®±«¥¤®¢ ²¥«¼­®±²¼¾ hp0 ; p1; p2; : : :; pn;1 i ¥£® ¢¥°¸¨­
¢ ¯®°¿¤ª¥ ®¡µ®¤ .
 ° §¤¥«¥ 35.1 ¬» ° §¡¥°¥¬ ¯°®±²¥©¸¨¥ § ¤ ·¨ ®¡ ®²°¥§ª µ (¢ ª ª³¾ ±²®°®­³ ¬» ¯®¢®° ·¨¢ ¥¬, ¤¢¨£ ¿±¼ ¯® «®¬ ­®©, ±®±² ¢«¥­­®©
¨§ ¤¢³µ ®²°¥§ª®¢? ¯¥°¥±¥ª ¾²±¿ «¨ ¤¢  ®²°¥§ª ?) ¨ ½´´¥ª²¨¢­»¥
¬¥²®¤» ¨µ °¥¸¥­¨¿.  ° §¤¥«¥ 35.2 ¬» ¯°¨¬¥­¨¬ ² ª ­ §»¢ ¥¬»©
À¬¥²®¤ ¤¢¨¦³¹¥©±¿ ¯°¿¬®©Á ¨ ¯®±²°®¨¬  «£®°¨²¬, ®¯°¥¤¥«¿¾¹¨©
§  ¢°¥¬¿ O(n lg n), ¥±²¼ «¨ ±°¥¤¨ n ®²°¥§ª®¢ µ®²¿ ¡» ¤¢  ¯¥°¥±¥ª ¾¹¨µ±¿.  ° §¤¥«¥ 35.3 ¨§«®¦¥­» ¤¢   «£®°¨²¬ , ¨±¯®«¼§³¾¹¨¥
À¢° ¹ ¾¹³¾±¿ ¯°¿¬³¾Á ¤«¿ ¢»·¨±«¥­¨¿ ¢»¯³ª«®© ®¡®«®·ª¨ ¬­®¦¥±²¢  n ²®·¥ª: ¯°®±¬®²° °½µ¥¬ , ²°¥¡³¾¹¨© ¢°¥¬¥­¨ O(n lg n),
¨ ¯°®µ®¤ ¦ °¢¨± , ¢°¥¬¿ ° ¡®²» ª®²®°®£® O(nh), £¤¥ h | ·¨±«®
¢¥°¸¨­ ¢»¯³ª«®© ®¡®«®·ª¨.  ° §¤¥«¥ 35.4 ° ±±¬®²°¥­  «£®°¨²¬,
ª®²®°»© ¬¥²®¤®¬ À° §¤¥«¿© ¨ ¢« ±²¢³©Á §  ¢°¥¬¿ O(n lg n) ­ µ®¤¨²
¯ °³ ¡«¨¦ ©¸¨µ ²®·¥ª ±°¥¤¨ n § ¤ ­­»µ ²®·¥ª ¯«®±ª®±²¨.

794

« ¢  35 »·¨±«¨²¥«¼­ ¿ £¥®¬¥²°¨¿

35.1. ¢®©±²¢  ®²°¥§ª®¢
 ·­¥¬ ± ­¥ª®²®°»µ ®¯°¥¤¥«¥­¨©, ±¢¿§ ­­»µ ± ®²°¥§ª ¬¨. »¯³ª«®© ª®¬¡¨­ ¶¨¥© (convex combination) ¤¢³µ ° §«¨·­»µ ²®·¥ª
p1 = (x1 ; y1) ¨ p2 = (x2; y2) ¡³¤¥¬ ­ §»¢ ²¼ «¾¡³¾ ²®·ª³ p3 =
(x3; y3 ), ¤«¿ ª®²®°®© x3 = x1 + (1 ; )x2 ¨ y3 = y1 + (1 ; )y2
¯°¨ ­¥ª®²®°®¬ 0 6  6 1. ²® ¦¥ ³±«®¢¨¥ ¬®¦­® § ¯¨± ²¼ ª ª
p3 = p1 +(1; )p2.  ¤ ­­ ¿ ² ª¨¬ ®¡° §®¬ ²®·ª  p3 ¯°¨­ ¤«¥¦¨²
®²°¥§ª³ ±®¥¤¨­¿¾¹¥¬³ p1 ¨ p2 (¨ ¬®¦¥² ±®¢¯ ¤ ²¼ ± ®¤­¨¬ ¨§ ª®­¶®¢). ²® ±¢®©±²¢® ¬®¦­® ¯°¨­¿²¼ §  ®¯°¥¤¥«¥­¨¥ ®²°¥§ª , ­ §¢ ¢
®²°¥§ª®¬ (line segment), p1 p2 ¬­®¦¥±²¢® ¢±¥µ ¢»¯³ª«»µ ª®¬¡¨­ ¶¨© p1 ¨ p2 . ®·ª¨ p1 ¨ p2 ­ §»¢ ¾² ª®­¶ ¬¨ (endpoints) ®²°¥§ª .
±«¨ ¢ ¦¥­ ¯®°¿¤®ª ª®­¶®¢,£®¢®°¿² ®¡ ®°¨¥­²¨°®¢ ­­®¬ ®²°¥§ª¥
(directed segment) ;
p;1!
p2. ±«¨ p1 ±®¢¯ ¤ ¥² ± ²®·ª®© (0; 0), ­ §»¢ ¥¬®© ­ · «®¬ ª®®°¤¨­ ² (origin), ²® ®°¨¥­²¨°®¢ ­­»© ®²°¥§®ª ;
p;1!
p2
­ §»¢ ¾² ¢¥ª²®°®¬ (vector) p2 .
 ± ¨­²¥°¥±³¾² ² ª¨¥ ¢®¯°®±»:
1.  ­» ¤¢  ®°¨¥­²¨°®¢ ­­»µ ®²°¥§ª  ;
p;0!
p1 ¨ ;
p;0!
p2 ± ®¡¹¨¬ ­ · «®¬ p0.  ª ª³¾ ±²®°®­³ (¯® · ±®¢®© ±²°¥«ª¥ ¨«¨ ¯°®²¨¢ ­¥¥) ­ ¤®
¯®¢¥°­³²¼ ®²°¥§®ª ;
p;0!
p1 ¢®ª°³£ p0, ·²®¡» ®­ ¯®¸¥« ¢ ­ ¯° ¢«¥­¨¨
;
;
!
p0 p2? (¬¥¥²±¿ ¢ ¢¨¤³ ¬¥­¼¸¨© ¨§ ¤¢³µ ¯®¢®°®²®¢.)
2.  ­» «®¬ ­ ¿ p1 p2p3 , ±®±² ¢«¥­­ ¿ ¨§ ¤¢³µ ®²°¥§ª®¢ p1 p2 ¨
p2p3. ¤¿ ¯® ­¥© ®² p1 ª p3, ¢ ª ª³¾ ±²®°®­³ ¬» ¯®¢®° ·¨¢ ¥¬ ³ p2
| ­ «¥¢® ¨«¨ ­ ¯° ¢®?
3. ¥°¥±¥ª ¾²±¿ «¨ ®²°¥§ª¨ p1 p2 ¨ p3p4 ?
» ±¬®¦¥¬ ®²¢¥²¨²¼ ­  ª ¦¤»© ¨§ ½²¨µ ¢®¯°®±®¢ §  ¢°¥¬¿ O(1),
·²®, ¢¯°®·¥¬, ­¥ ³¤¨¢¨²¥«¼­®, ¯®±ª®«¼ª³ ¨±µ®¤­»¬¨ ¤ ­­»¬¨ ¢ ª ¦¤®¬ ±«³· ¥ ¿¢«¿¥²±¿ ´¨ª±¨°®¢ ­­®¥ ·¨±«® ²®·¥ª. ®«¥¥ ¢ ¦­® ²®,
·²® ­ ¸¨ ¬¥²®¤» ­¥ ¡³¤³² ¨±¯®«¼§®¢ ²¼ ­¨ ¤¥«¥­¨¿, ­¨ ²°¨£®­®¬¥²°¨·¥±ª¨µ ´³­ª¶¨© { ®¯¥° ¶¨©, ª®²®°»¥ ±«®¦­¥¥ ¨ ¡®«¥¥ ·³¢±²¢¨²¥«¼­» ª ®¸¨¡ª ¬ ®ª°³£«¥­¨¿, ·¥¬ ¨±¯®«¼§³¥¬»¥ ­ ¬¨ ±«®¦¥­¨¥,
¢»·¨² ­¨¥, ³¬­®¦¥­¨¥ ¨ ±° ¢­¥­¨¥.  ¯°¨¬¥°, ¥±«¨ (®²¢¥· ¿ ­  ¢®¯°®± ­®¬¥° 3) ¤¥©±²¢®¢ ²¼ ­ ¨¡®«¥¥ ®·¥¢¨¤­»¬ ±¯®±®¡®¬ ¨ ¨±ª ²¼
³° ¢­¥­¨¿ ¯°¿¬»µ, ±®¤¥°¦ ¹¨µ ¤ ­­»¥ ®²°¥§ª¨, ¢ ¢¨¤¥ y = mx + b
(m | ³£«®¢®© ª®½´´¨¶¨¥­², b | ®°¤¨­ ²  ²®·ª¨ ¯¥°¥±¥·¥­¨¿ ¯°¿¬®© ± ®±¼¾ y), § ²¥¬ ²®·ª³ ¯¥°¥±¥·¥­¨¿ ¯°¿¬»µ,   § ²¥¬ ¯°®¢¥°¿²¼,
¯°¨­ ¤«¥¦¨² «¨ ­ ©¤¥­­ ¿ ²®·ª  ®¡®¨¬ ®²°¥§ª ¬, ²® ¯®­ ¤®¡¨²±¿
¤¥«¥­¨¥, ¨ ¤«¿ ¯®·²¨ ¯ ° ««¥«¼­»µ ®²°¥§ª®¢ ¢®§¬®¦­» ±«®¦­®±²¨,
¢»§¢ ­­»¥ ®ª°³£«¥­¨¥¬ ¯°¨ ¤¥«¥­¨¨ ­  ¡«¨§ª®¥ ª ­³«¾ ·¨±«®. (»
³ª ¦¥¬ ±¯®±®¡, ¯®§¢®«¿¾¹¨© ¨§¡¥¦ ²¼ ¤¥«¥­¨¿.)
¥ª²®°­®¥ ¯°®¨§¢¥¤¥­¨¥
 ¸¥ ®±­®¢­®¥ ±°¥¤±²¢® | ¯®­¿²¨¥ ¢¥ª²®°­®£® ¯°®¨§¢¥¤¥­¨¿.
³±²¼ ¤ ­» ¢¥ª²®°  p1 ¨ p2 (°¨±. 35.1 (a)).  ± ¨­²¥°¥±³¾² ²®«¼ª® ¢¥ª²®° , «¥¦ ¹¨¥ ¢ ®¤­®© ¯«®±ª®±²¨, ¯®½²®¬³ ¯®¤ ¢¥ª²®°­»¬

¢®©±²¢  ®²°¥§ª®¢

795

35.1 (a) ¥ª²®°­®¥ ¯°®¨§¢¥¤¥­¨¥ ¢¥ª²®°®¢ p1 ¨ p2 | ½²® ¯«®¹ ¤¼
¯ ° ««¥«®£° ¬¬  (± ³·¥²®¬ §­ ª ). (b) ¥ª²®°  ¢ ±¢¥²«®© · ±²¨
¯«®±ª®±²¨ ¯®«³· ¾²±¿ ¨§ ¢¥ª²®°  p ¯®¢®°®²®¬ ¯® · ±®¢®© ±²°¥«ª¥,
¢ ²¥¬­®© | ¯°®²¨¢.
¯°®¨§¢¥¤¥­¨¥¬ (cross product) p1  p2 ¬®¦­® ¯®­¨¬ ²¼ ¯«®¹ ¤¼ ¯ ° ««¥«®£° ¬¬  (± ³·¥²®¬ §­ ª ), ®¡° §®¢ ­­®£® ²®·ª ¬¨ (0; 0), p1,
p2, p1 + p2 = (x1 + x2 ; y1 + y2). «¿ ¢»·¨±«¥­¨© ¡®«¥¥ ³¤®¡­® ®¯°¥¤¥«¥­¨¥ ¢¥ª²®°­®£® ¯°®¨§¢¥¤¥­¨¿ ª ª ®¯°¥¤¥«¨²¥«¿ ¬ ²°¨¶»


p1  p2 = det xy11 xy22



= x1y2 ; x2 y1 = ;p2  p1

(®®¡¹¥ £®¢®°¿, ¢¥ª²®°­®¥ ¯°®¨§¢¥¤¥­¨¥ ®¯°¥¤¥«¿¥²±¿ ¤«¿ ¢¥ª²®°®¢ ¢ ²°¥µ¬¥°­®¬ ¯°®±²° ­±²¢¥ ª ª ¢¥ª²®°, ¯¥°¯¥­¤¨ª³«¿°­»© p1
¨ p2, ®¡° §³¾¹¨© ¢¬¥±²¥ ± ½²¨¬¨ ¢¥ª²®° ¬¨ ¯° ¢³¾ ²°®©ª³, ¤«¨­ 
ª®²®°®£® ° ¢­  ¯«®¹ ¤¨ ¯ ° ««¥«®£° ¬¬ , ®¡° §®¢ ­­®£® ²®·ª ¬¨ (0; 0), p1, p2 , p1 + p2 . ® ¢ ½²®© £« ¢¥ ­ ¬ ¤®±² ²®·­® ®¯°¥¤¥«¥­¨¿
¢¥ª²®°­®£® ¯°®¨§¢¥¤¥­¨¿ ­  ¯«®±ª®±²¨ ¯® ´®°¬³«¥ x1 y2 ; x2 y1 .)
±«¨ p1  p2 ¯®«®¦¨²¥«¼­®, ²® ª° ²· ©¸¨© ¯®¢®°®² p2 ®²­®±¨²¥«¼­® (0; 0), ±®¢¬¥¹ ¾¹¨© ¥£® ± p1 , ¯°®¨±µ®¤¨² ¯® · ±®¢®© ±²°¥«ª¥,   ¥±«¨ ®²°¨¶ ²¥«¼­®, ²® | ¯°®²¨¢.   °¨±. 35.1 (b) ¢¥ª²®° 
¢ ±¢¥²«®© · ±²¨ ¯«®±ª®±²¨ ¯®«³· ¾²±¿ ¨§ ¢¥ª²®°  p ¯®¢®°®²®¬ ¯®
· ±®¢®© ±²°¥«ª¥, ¢ ²¥¬­®© | ¯°®²¨¢. ° ­¨¶  ½²¨µ ®¡« ±²¥© ±®±²®¨² ¨§ ¢¥ª²®°®¢, ¢¥ª²®°­®¥ ¯°®¨§¢¥¤¥­¨¥ ª®²®°»µ ± p ° ¢­® ­³«¾.
²¨ ¢¥ª²®°» «¥¦ ² ­  ®¤­®© ¯°¿¬®© ± p.
 ¯¨¸¥¬ ´®°¬³«³, ¯®§¢®«¿¾¹³¾ ®¯°¥¤¥«¨²¼, ¢ ª ª³¾ ±²®°®­³
­ ¤® ¯®¢®° ·¨¢ ²¼ ;
p;0!
p1 ¢®ª°³£p0, ·²®¡» ­ «®¦¨²¼ ¥£® ­  ;
p;0!
p2 (¯®
· ±®¢®© ±²°¥«ª¥ ¨«¨ ¯°®²¨¢). ·¨² ¿ ­ · «®¬ ª®®°¤¨­ ² ²®·ª³ p0,
¬» ¯®«³· ¥¬ ¤¢  ¢¥ª²®°  p1 ; p0 = (x1 ; x0 ; y1 ; y0 ) ¨ p2 ; p0 =
(x2 ; x0 ; y2 ; y0 ). µ ¢¥ª²®°­®¥ ¯°®¨§¢¥¤¥­¨¥ ° ¢­®
(p1 ; p0)  (p2 ; p0 ) = (x1 ; x0 )(y2 ; y0 ) ; (x2 ; x0 )(y1 ; y0 ):
±«¨ ®­® ¯®«®¦¨²¥«¼­®, ²® ¢° ¹ ²¼ ­ ¤® ¯°®²¨¢ · ±®¢®© ±²°¥«ª¨
(À¢ ¯®«®¦¨²¥«¼­®¬ ­ ¯° ¢«¥­¨¨Á, ª ª £®¢®°¿²), ¥±«¨ ®²°¨¶ ²¥«¼­®
| ²® ¯® · ±®¢®© ±²°¥«ª¥.
 ¯° ¢«¥­¨¥ ¯®¢®°®² .
¥°¥©¤¥¬ ª® ¢²®°®¬³ ¢®¯°®±³: ¢ ª ª³¾ ±²®°®­³ ¬» ¯®¢®° ·¨¢ ¥¬ (¢ ²®·ª¥ p1 ), ¤¢¨£ ¿±¼ ¯® «®¬ ­®© p0p1 p2 ? ¥£ª® ¨§¡¥¦ ²¼
¢»·¨±«¥­¨¿ ³£«  \p0p1 p2, ¢­®¢¼ ¢®±¯®«¼§®¢ ¢¸¨±¼ ¢¥ª²®°­»¬ ¯°®¨§¢¥¤¥­¨¥¬.  ª ¢¨¤­® ¨§ °¨±. 35.2, ­ ¬ ­ ¤® ¢»¿±­¨²¼, ¢ ª ª®¬
­ ¯° ¢«¥­¨¨ ­ ¤® ¯®¢®° ·¨¢ ²¼ ¢¥ª²®° ;
p;0!
p1, ·²®¡» ®­ ±² « ­ ¯° ;
;
!
¢«¥­­»¬ ¢ ±²®°®­³ p0 p2 . «¿ ½²®£® ¬» ¢»·¨±«¨¬ ¢¥ª²®°­®¥ ¯°®¨§¢¥¤¥­¨¥ (p2 ; p0 )  (p1 ; p0 ). ±«¨ ®­® ®²°¨¶ ²¥«¼­®, ²® ;
p;0!
p2 ­ µ®¤¨²;
;
!
±¿ ¯°®²¨¢ · ±®¢®© ±²°¥«ª¨ ®² p0 p1, ¨ ¢ ²®·ª¥ p0 ¬» ¯®¢®° ·¨¢ ¥¬

796

« ¢  35 »·¨±«¨²¥«¼­ ¿ £¥®¬¥²°¨¿

35.2 ¥ª²®°­®¥ ¯°®¨§¢¥¤¥­¨¥ ¯®¬®£ ¥² ®¯°¥¤¥«¨²¼, ¢ ª ª³¾ ±²®°®­³ ¬» ¯®¢®° ·¨¢ ¥¬ ¢ ²®·ª¥ p1, ¨¤¿ ¯® «®¬ ­®© p0 p1p2 . «¿ ½²®£®
­ ¤® ¢»¿±­¨²¼, ¢ ª ª®© ±²®°®­¥ ­ µ®¤¨²±¿ ¢¥ª²®° ;
p;0!
p2 ®² ¢¥ª²®° 
;
;
!
p0p1. (a) ±«¨ ¯°®²¨¢ · ±®¢®© ±²°¥«ª¨, ²® ¬» ¯®¢®° ·¨¢ ¥¬ ­ «¥¢®.
(b) ±«¨ ¯® · ±®¢®© ±²°¥«ª¥, ²® | ­ ¯° ¢®.
­ «¥¢®. ±«¨ ¢¥ª²®°­®¥ ¯°®¨§¢¥¤¥­¨¥ ¯®«®¦¨²¥«¼­®, ¬» ¯®¢®° ·¨¢ ¥¬ ­ ¯° ¢®.  ª®­¥¶, ¥±«¨ ®­® ° ¢­® ­³«¾, ²® ¬» «¨¡® ¨¤¥¬
¯°¿¬®, «¨¡® ¯®¢®° ·¨¢ ¥¬ ª°³£®¬ (²®·ª¨ p0; p1 ¨ p2 ¯°¨­ ¤«¥¦ ²
®¤­®© ¯°¿¬®©).
¥°¥±¥ª ¾²±¿ «¨ ®²°¥§ª¨?
¯°¥¤¥«¿²¼, ¯¥°¥±¥ª ¾²±¿ «¨ ®²°¥§ª¨, ¬» ¡³¤¥¬ ¢ ¤¢  ½² ¯ .
 · «¼­»© ²¥±² (quick rejection) ±®±²®¨² ¢ ±«¥¤³¾¹¥¬: ¥±«¨ ®£° ­¨·¨¢ ¾¹¨¥ ¯°¿¬®³£®«¼­¨ª¨ ®²°¥§ª®¢ ­¥ ¨¬¥¾² ®¡¹¨µ ²®·¥ª, ²®
¨ ± ¬¨ ®²°¥§ª¨ ­¥ ¯¥°¥±¥ª ¾²±¿. °¨ ½²®¬ ®£° ­¨·¨¢ ¾¹¨¬ ¯°¿¬®³£®«¼­¨ª®¬ (bounding box) £¥®¬¥²°¨·¥±ª®© ´¨£³°» ¬» ¡³¤¥¬
­ §»¢ ²¼ ­ ¨¬¥­¼¸¨© ¨§ ¯°¿¬®³£®«¼­¨ª®¢ ±® ±²®°®­ ¬¨, ¯ ° ««¥«¼­»¬¨ ®±¿¬ ª®®°¤¨­ ², ª®²®°»¥ ±®¤¥°¦ ² ¤ ­­³¾ ´¨£³°³.
«¿ ®²°¥§ª  p1p2 ² ª®¢»¬ ¡³¤¥² ¯°¿¬®³£®«¼­¨ª (^p1 ; p^2) ± «¥¢»¬
­¨¦­¨¬ ³£«®¬ p^1 = (^x1; y^1 ) ¨ ¯° ¢»¬ ¢¥°µ­¨¬ ³£«®¬ p^2 = (^x2; y^2)
, £¤¥ x^1 = min(x1 ; x2), y^1 = min(y1; y2), x^2 = max(x1; x2), y^2 =
max(y1 ; y2). ±«®¢¨¥ ¯¥°¥±¥·¥­¨¿ ¤¢³µ ¯°¿¬®³£®«¼­¨ª®¢, § ¤ ­­»µ
«¥¢»¬¨ ­¨¦­¨¬¨ ¨ ¯° ¢»¬¨ ¢¥°µ­¨¬¨ ³£« ¬¨, ² ª®¢®: (^p1; p^2) ¨
(^p3; p^4) ¨¬¥¾² ®¡¹¨¥ ²®·ª¨ ²®£¤  ¨ ²®«¼ª® ²®£¤ , ª®£¤ 
(^x2 > x^3 ) ^ (^x4 > x^1 ) ^ (^y2 > y^3 ) ^ (^y4 > y^1 )
(¯¥°¢»¥ ¤¢  ³±«®¢¨¿ ±®®²¢¥²±²¢³¾² ¯¥°¥±¥·¥­¨¾ x-¯°®¥ª¶¨©, ¢²®°»¥ | y -¯°®¥ª¶¨¿¬).
±«¨ ­  ¯¥°¢®¬ ½² ¯¥ ­¥ ³¤ ¥²±¿ ³±² ­®¢¨²¼, ·²® ®²°¥§ª¨ ­¥
¯¥°¥±¥ª ¾²±¿, ¬» ¯¥°¥µ®¤¨¬ ª® ¢²®°®¬³ ½² ¯³ ¨ ¯°®¢¥°¿¥¬, ¯¥°¥±¥ª ¥²±¿ «¨ ª ¦¤»© ¨§ ¤ ­­»µ ®²°¥§ª®¢ ± ¯°¿¬®©, ±®¤¥°¦ ¹¥©
¤°³£®© ®²°¥§®ª. ²°¥§®ª ¯¥°¥±¥ª ¥² ¯°¿¬³¾ (straddles a line), ¥±«¨ ¥£® ª®­¶» «¥¦ ² ¯® ° §­»¥ ±²®°®­» ®² ­¥¥ ¨«¨ ¥±«¨ ®¤¨­ ¨§
ª®­¶®¢ «¥¦¨² ­  ¯°¿¬®©. ®¦­® ¯°®¢¥°¨²¼, ·²® ¤¢  ®²°¥§ª  ¯¥°¥±¥ª ¾²±¿ ²®£¤  ¨ ²®«¼ª® ²®£¤ , ª®£¤  ¯¥°¥±¥ª ¾²±¿ ®£° ­¨·¨¢ ¾¹¨¥ ¨µ ¯°¿¬®³£®«¼­¨ª¨ (­ · «¼­»© ²¥±²) ¨, ª°®¬¥ ²®£®, ª ¦¤»©
¨§ ®²°¥§ª®¢ ¯¥°¥±¥ª ¥²±¿ ± ¯°¿¬®©, ±®¤¥°¦ ¹¥© ¤°³£®© ®²°¥§®ª.
®±«¥¤­¥¥ ³±«®¢¨¥ ¯°®¢¥°¿¥²±¿ ± ¯®¬®¹¼¾ ¢¥ª²®°­»µ ¯°®¨§¢¥¤¥­¨©. ®·ª¨ p3 ¨ p4 «¥¦ ² ¯® ° §­»¥ ±²®°®­» ®² ¯°¿¬®© p1p2 , ¥±«¨
¢¥ª²®°» ;
p;1!
p3 ¨ ;
p;1!
p4 ¨¬¥¾² ° §«¨·­³¾ ®°¨¥­² ¶¨¾ ®²­®±¨²¥«¼­®
;
;
!
¢¥ª²®°  p1p2 (±¬. °¨±.35.3 (a), (b)), ²® ¥±²¼ ¥±«¨ §­ ª¨ ¢¥ª²®°­»µ
¯°®¨§¢¥¤¥­¨© (p3 ; p1)  (p2 ; p1) ¨ (p4 ; p1 )  (p2 ; p1 ) ° §«¨·­».
±«¨ ®¤­® ¨§ ½²¨µ ¢¥ª²®°­»µ ¯°®¨§¢¥¤¥­¨© ° ¢­® ­³«¾, ²® ®¤­ 
¨§ ²®·¥ª p3 ¨«¨ p4 ¯°¨­ ¤«¥¦¨² ¯°¿¬®© p1 p2. ¢  ² ª¨µ ±«³· ¿
¯®ª § ­» ­  °¨±³­ª µ (°¨±. 35.3 (c),(d)).  ®¡®¨µ ±«³· ¿µ ®²°¥§ª¨ ¯¥°¥±¥ª ¾²±¿, ®¤­ ª® ¢®§¬®¦¥­ ¨ ¤°³£®© ±«³· ©: µ®²¿ ®²°¥§ª¨

¢®©±²¢  ®²°¥§ª®¢

797

!!! ¨±³­®ª, ²°¥¡³¾¹¨© ¤®¡ ¢«¥­¨©.  ª­¨£¥ ¥±²¼
®¸¨¡ª , ¨ ¯®±«¥ ¥¥ ¨±¯° ¢«¥­¨¿ °¨±³­®ª, ­ §»¢ ¢¸¨©±¿ (e), ­ §»¢ ¥²±¿ (f),   ­  ¥£® ¬¥±²¥ ­ ¤® ¯®¬¥±²¨²¼ ­®¢»© (±¬. ­  ¯®«¿µ ®°¨£¨­ « ) ¥°¥±¥ª ¥² «¨ ®²°¥§®ª p3p4 ¯°¿¬³¾, ±®¤¥°¦ ¹³¾ ®²°¥§®ª
p1p2? (a) ±«¨ ¤ , ²® ¢¥ª²®°­»¥ ¯°®¨§¢¥¤¥­¨¿ (p3 ; p1)  (p2 ; p1)
¨ (p4 ; p1 )  (p2 ; p1) ¨¬¥¾² ° §­»¥ §­ ª¨. (b) ±«¨ ­¥², ²® ½²¨
¯°®¨§¢¥¤¥­¨¿ ¨¬¥¾² ®¤¨­ ¨ ²®² ¦¥ §­ ª. (c){(d) ° ­¨·­»¥ ±«³· ¨, ª®£¤  ®¤­® ¨§ ¢¥ª²®°­»µ ¯°®¨§¢¥¤¥­¨© ° ¢­® ­³«¾ (¨ ®²°¥§®ª
¯¥°¥±¥ª ¥² ¯°¿¬³¾). (e) ¤­® ¨§ ¢¥ª²®°­»µ ¯°®¨§¢¥¤¥­¨© ° ¢­®
­³«¾, ®£° ­¨·¨¢ ¾¹¨¥ ¯°¿¬®³£®«¼­¨ª¨ ¯¥°¥±¥ª ¾²±¿, ­® ®²°¥§ª¨ ¢±¥-² ª¨ ­¥ ¯¥°¥±¥ª ¾²±¿ (®²°¥§®ª p1p2 ­¥ ¯¥°¥±¥ª ¥² ¯°¿¬³¾
p3p4) (f) ²°¥§ª¨ «¥¦ ² ­  ®¤­®© ¯°¿¬®©, ­® ­¥ ¯¥°¥±¥ª ¾²±¿.  ¦¤»© ¨§ ®²°¥§ª®¢ ¯¥°¥±¥ª ¥² ¯°¿¬³¾, ±®¤¥°¦ ¹³¾ ¤°³£®©. ® ± ¬¨ ®²°¥§ª¨ ­¥ ¯¥°¥±¥ª ¾²±¿ | §¤¥±¼ ½²® ­¥ ±²° ¸­®, ² ª ª ª ½²®²
±«³· © ®²¡°®¸¥­ ­  ¯¥°¢®¬ ½² ¯¥.
¯°®µ®¤¿² ­ · «¼­»© ²¥±² ¨ ¢¥ª²®°­®¥ ¯°®¨§¢¥¤¥­¨¥ ° ¢­® ­³«¾,
¢±¥-² ª¨ ¯¥°¥±¥·¥­¨¿ ­¥² (°¨±. 35.3 (e)) ®½²®¬³ ³±«®¢¨¥ À®²°¥§®ª
¯¥°¥±¥ª ¥² ¯°¿¬³¾Á ­ ¤® ¯°®¢¥°¿²¼ ¤«¿ ®¡®¨µ ®²°¥§ª®¢.  ¬¥²¨¬,
·²® ­ · «¼­»© ²¥±² ­¥«¼§¿ ®¯³±²¨²¼: ­  °¨±. 35.3 (f) ª ¦¤»© ¨§ ®²°¥§ª®¢ ¯¥°¥±¥ª ¥² ¯°¿¬³¾, ±®¤¥°¦ ¹³¾ ¤°³£®© («¥¦¨² ­  ­¥© |
¬» ±·¨² ¥¬ ½²® ¯¥°¥±¥·¥­¨¥¬), ­® ± ¬¨ ®²°¥§ª¨ ­¥ ¯¥°¥±¥ª ¾²±¿.
±«¨ ®¤¨­ ¨§ ®²°¥§ª®¢, ­ ¯°¨¬¥°, p1p2 , ° ¢¥­ ­³«¾, ²® ¢®¯°®± ®
²®¬, ¯¥°¥±¥ª ¥² «¨ ®²°¥§®ª p3 p4 ¯°¿¬³¾ p1p2 , «¨¸¥­ ±¬»±«  (¯°¿¬»µ ¬­®£®). ¥¬ ­¥ ¬¥­¥¥ ¬®¦­® ¢»·¨±«¨²¼ ¢¥ª²®°­»¥ ¯°®¨§¢¥¤¥­¨¿ (p3 ; p1 )  (p2 ; p1 ) ¨ (p4 ; p1)  (p2 ; p1), ª®²®°»¥ ¢ ¤ ­­®¬
±«³· ¥ ° ¢­» ­³«¾.  ¸ ª°¨²¥°¨© ¯¥°¥±¥·¥­¨¿ ¯°¨¬¥­¨¬ ¨ ¢ ½²®¬
±«³· ¥, ¥±«¨ ³±«®¢­® ¯°¨­¿²¼, ·²® p3p4 ¯¥°¥±¥ª ¥² ¯°¿¬³¾ p1p2 .
² ª, ª°¨²¥°¨© ² ª®¢: ®²°¥§ª¨ p1p2 ¨ p3 p4 ¯¥°¥±¥ª ¾²±¿ ²®£¤ 
¨ ²®«¼ª® ²®£¤ , ª®£¤  ®¤­®¢°¥¬¥­­® ¢»¯®«­¥­» ²°¨ ³±«®¢¨¿:
(a) ¯¥°¥±¥ª ¾²±¿ ®£° ­¨·¨¢ ¾¹¨¥ ¨µ ¯°¿¬®³£®«¼­¨ª¨;
(b)
[(p3 ; p1)  (p2 ; p1 )]  [(p4 ; p1)  (p2 ; p1 )] 6 0
(c)
[(p1 ; p3)  (p4 ; p3 )]  [(p2 ; p3)  (p4 ; p3 )] 6 0
°³£¨¥ ¯°¨¬¥­¥­¨¿ ¢¥ª²®°­®£® ¯°®¨§¢¥¤¥­¨¿.
¥ª²®°­®¥ ¯°®¨§¢¥¤¥­¨¥ ¯®­ ¤®¡¨²±¿ ­ ¬ ¥¹¥ ­¥ ° §.  ° §¤¥«¥ 35.3 ± ¥£® ¯®¬®¹¼¾ ¬» ¡³¤¥¬ ±®°²¨°®¢ ²¼ ²®·ª¨ ¯® ¯®«¿°­®¬³
³£«³ ®²­®±¨²¥«¼­® ¤ ­­®£® ¶¥­²°  (±¬. ³¯°. 35.1-2).  ° §¤¥«¥ 35.2
¯°¨ ¯®±²°®¥­¨¨ ª° ±­®-·¥°­®£® ¤¥°¥¢  ®²°¥§ª®¢, ³¯®°¿¤®·¥­­»µ
¯® ¬¥±²³ ¨µ ¯¥°¥±¥·¥­¨¿ ± ¤ ­­®© ¢¥°²¨ª «¼¾, ¬» ¡³¤¥¬ ¨±¯®«¼§®¢ ²¼ ´®°¬³«³ ± ¢¥ª²®°­»¬ ¯°®¨§¢¥¤¥­¨¥¬, ·²®¡» ®¯°¥¤¥«¨²¼,
ª ª®© ¨§ ¤¢³µ ®²°¥§ª®¢ ¯¥°¥±¥ª ¥² ½²³ ¢¥°²¨ª «¼ ¢ ¡®«¥¥ ¢»±®ª®©
²®·ª¥.
¯° ¦­¥­¨¿

798

« ¢  35 »·¨±«¨²¥«¼­ ¿ £¥®¬¥²°¨¿

35.1-1
®ª ¦¨²¥, ·²® ¯°¨ ¯®«®¦¨²¥«¼­®¬ p1 p2 ¢¥ª²®° p1 ­ µ®¤¨²±¿ ¯®
· ±®¢®© ±²°¥«ª¥ ®² ¢¥ª²®°  p2,   ¯°¨ ®²°¨¶ ²¥«¼­®¬ | ¯°®²¨¢. ¡ 
¢¥ª²®°  ¢»µ®¤¿² ¨§ ­ · «  ª®®°¤¨­ ² (0; 0), ¡¥°/²±¿ ­ ¯° ¢«¥­¨¥
¯®¢®°®²  ¢ ¡«¨¦ ©¸³¾ ±²®°®­³.
35.1-2
 ¯¨¸¨²¥  «£®°¨²¬ ±®°²¨°®¢ª¨, ° ±¯®« £ ¾¹¨© ²®·ª¨
hp1; p2; : : :; pni. ¢ ¯®°¿¤ª¥ ®¡µ®¤  ¯°®²¨¢ · ±®¢®© ±²°¥«ª¨, ¥±«¨
±¬®²°¥²¼ ¨§ § ¤ ­­®£® ¯®«¾±  p0. ( · ²¼ ¬®¦­® ± «¾¡®© ²®·ª¨.) «£®°¨²¬ ¤®«¦¥­ ¨±¯®«¼§®¢ ²¼ ¢¥ª²®°­®¥ ¯°®¨§¢¥¤¥­¨¥ ¤«¿
±° ¢­¥­¨¿ ³£«®¢ ¨ ¢»¯®«­¿²¼±¿ §  ¢°¥¬¿ O(n lg n).
35.1-3
 ª §  ¢°¥¬¿ O(n2 ln n) ®¯°¥¤¥«¨²¼, «¥¦ ² «¨ ª ª¨¥-²® ²°¨ ¨§
¤ ­­»µ n ²®·¥ª ­  ®¤­®© ¯°¿¬®©?
35.1-4
²®¡» ³§­ ²¼, ¿¢«¿¾²±¿ «¨ ²®·ª¨ hp0 ; p1; : : :; pn;1 i ¢¥°¸¨­ ¬¨
¢»¯³ª«®£® ¬­®£®³£®«¼­¨ª  (¯®¤°®¡­¥¥ ® ¬­®£®³£®«¼­¨ª µ ±¬. ¢
° §¤¥«¥ 16.4), ¯¥°¥·¨±«¥­­»¬¨ ¢ ¯®°¿¤ª¥ ®¡µ®¤  ¬­®£®³£®«¼­¨ª , ¯°®´¥±±®° ¯°¥¤« £ ¥² ² ª®© ¬¥²®¤: ¯°®¢¥°¨²¼, ·²® ¬­®¦¥±²¢®
\pipi+1pi+2 : i = 0; 1; : : :; n ; 1, £¤¥ i + 1 ¨ i + 2 ¢»·¨±«¿¾²±¿ ¯® ¬®¤³«¾ n, ­¥ ±®¤¥°¦¨² ®¤­®¢°¥¬¥­­® ¯° ¢»µ ¨ «¥¢»µ ¯®¢®°®²®¢. ®ª ¦¨²¥, ·²® ½²®² ±¯®±®¡ ­¥ ¢±¥£¤  ¤ ¾² ¯° ¢¨«¼­»© ®²¢¥², µ®²¿ ¨
¢»¯®«­¿¥²±¿ §  «¨­¥©­®¥ ¢°¥¬¿.  ª ¨§¬¥­¨²¼ ¥£®, ·²®¡» ¯®«³·¨²¼
¯° ¢¨«¼­»© ®²¢¥² (² ª¦¥ §  «¨­¥©­®¥ ¢°¥¬¿)?
35.1-5
° ¢»© £®°¨§®­² «¼­»© «³· (right horizontal ray) ²®·ª¨ p0 =
(x0; y0 ) ®¯°¥¤¥«¿¥²±¿ ª ª ¬­®¦¥±²¢® fpi = (xi ; yi ) : x ; i > x0 ¨yi =
y0g, ²® ¥±²¼ ª ª «³·, ¢»µ®¤¿¹¨© ¨§ p0 ¢¯° ¢® ¯ ° ««¥«¼­® ®±¨  ¡±¶¨±±.  ª §  ¢°¥¬¿ O(1) ®¯°¥¤¥«¨²¼, ¯¥°¥±¥ª ¾²±¿ «¨ £®°¨§®­² «¼­»© «³· ²®·ª¨ p0 ¨ ®²°¥§®ª p1p2 , ±¢¥¤¿ § ¤ ·³ ª ¨±±«¥¤®¢ ­¨¾
¯¥°¥±¥·¥­¨¿ ¤¢³µ ®²°¥§ª®¢?
35.1-6
²®¡» ³§­ ²¼, «¥¦¨² «¨ ²®·ª  p0 ¢­³²°¨ ¯°®±²®£® (­¥ ®¡¿§ ²¥«¼­® ¢»¯³ª«®£®) ¬­®£®³£®«¼­¨ª  P , ¬®¦­® ° ±±¬®²°¥²¼ ª ª®©­¨¡³¤¼ «³·, ¢»µ®¤¿¹¨© ¨§ ²®·ª¨ p0 , ¨ ¯®±·¨² ²¼, ±ª®«¼ª® ° § ®­
¯¥°¥±¥ª ¥² £° ­¨¶³ ¬­®£®³£®«¼­¨ª : ®­  ¡³¤¥² ¢­³²°¥­­¥©, ¥±«¨
·¨±«® ¯¥°¥±¥·¥­¨© ­¥·¥²­®. ±¯®«¼§³¿ ½²³ ¨¤¥¾, ­ ¯¨¸¨²¥  «£®°¨²¬, ®¯°¥¤¥«¿¾¹¨© §  ¢°¥¬¿ O(n), ¿¢«¿¥²±¿ «¨ ¤ ­­ ¿ ²®·ª  p0
¢­³²°¥­­¥© ¤«¿ ¯°®±²®£® n-³£®«¼­¨ª  P . (ª § ­¨¥. ±¯®«¼§³©²¥
³¯° ¦­¥­¨¥ 35.1-5. ±®¡®£® ° ±±¬®²°¥­¨¿ ²°¥¡³¾² ±«³· ¨, ª®£¤ 
²®·ª  p0 «¥¦¨² ­  £° ­¨¶¥ ¬­®£®³£®«¼­¨ª , ª®£¤  «³· ¯°®µ®¤¨²
·¥°¥§ ®¤­³ ¨§ ¥£® ¢¥°¸¨­ ¨«¨ ±®¤¥°¦¨² ³· ±²®ª ±²®°®­».)
35.1-7
®ª ¦¨²¥, ª ª §  ¢°¥¬¿ (n) ¢»·¨±«¨²¼ ¯«®¹ ¤¼ ¯°®±²®£®
(­¥ ®¡¿§ ²¥«¼­® ¢»¯³ª«®£®) n-³£®«¼­¨ª , § ¤ ­­®£® ¯¥°¥·¨±«¥­¨¥¬
¢¥°¸¨­ ¢ ¯®°¿¤ª¥ ®¡µ®¤ .

±²¼ «¨ ¯¥°¥±¥ª ¾¹¨¥±¿ ®²°¥§ª¨?

799

¯®°¿¤®·¥­¨¥ ®²°¥§ª®¢ ®²­®±¨²¥«¼­® ° §«¨·­»µ ¢¥°²¨ª «¼­»µ
¯°¿¬»µ. (a) «¿ ½²®© ª®­´¨£³° ¶¨¨ a >r c; a >t b; b >t c; a >t c
¨ b >u c; ®²°¥§®ª d ­¥ ±° ¢­¨¬ ­¨ ± ª ª¨¬ ¨§ ®²°¥§ª®¢ ­  °¨±³­ª¥. (b) °¨ ¯°®µ®¤¥ ²®·ª¨ ¯¥°¥±¥·¥­¨¿ ®²­®¸¥­¨¥ ¯®°¿¤ª  ¬¥¦¤³
®²°¥§ª ¬¨ e ¨ f ¬¥­¿¥²±¿ ­  ¯°®²¨¢®¯®«®¦­®¥: e >v f ,   f >w e.
®£¤  ¤¢¨¦³¹ ¿±¿ ¯°¿¬ ¿ z ¯¥°¥±¥ª ¥² ±¥°³¾ ®¡« ±²¼, ®²°¥§ª¨ e
¨ f ¿¢«¿¾²±¿ ±®±¥¤­¨¬¨ ± ²®·ª¨ §°¥­¨¿ ±®®²¢¥²±²¢³¾¹¥£® ¥© ¯®°¿¤ª 

35.2. ±²¼ «¨ ¯¥°¥±¥ª ¾¹¨¥±¿ ®²°¥§ª¨?
 ½²®¬ ° §¤¥«¥ ¬» ° ±±¬®²°¨¬  «£®°¨²¬, ª®²®°»© ®¯°¥¤¥«¿¥²,
¥±²¼ «¨ ±°¥¤¨ n ¤ ­­»µ ®²°¥§ª®¢ ¤¢  ¯¥°¥±¥ª ¾¹¨µ±¿. °¨ ½²®¬
¨±¯®«¼§³¥²±¿ ¬¥²®¤ À¤¢¨¦³¹¥©±¿ ¯°¿¬®©Á, · ±²® ¢±²°¥· ¾¹¨©±¿ ¢
¢»·¨±«¨²¥«¼­®© £¥®¬¥²°¨¨. °³£¨¥ ¯°¨¬¥­¥­¨¿ ½²®£® ¬¥²®¤  ³ª § ­» ¢ ³¯° ¦­¥­¨¿µ ¢ ª®­¶¥ ° §¤¥« .
«£®°¨²¬ ¢»¯®«­¿¥²±¿ §  ¢°¥¬¿ O(n ln n), £¤¥ n | ·¨±«® ¤ ­­»µ ®²°¥§ª®¢. °¨ ½²®¬ ¯°®¢¥°¿¥²±¿ ²®«¼ª® ­ «¨·¨¥ ¨«¨ ®²±³²±²¢¨¥ ¯¥°¥±¥·¥­¨©; ± ¬¨ ¯¥°¥±¥·¥­¨¿ ­¥ ­ µ®¤¿²±¿. ( ª ¯®ª §»¢ ¥² ³¯° ¦­¥­¨¥ 35.2-1, ¨µ ®²»±ª ­¨¥ ¬®¦¥² ¯®²°¥¡®¢ ²¼ ¢°¥¬¥­¨

(n2 ).)
¥²®¤ ¤¢¨¦³¹¥©±¿ ¯°¿¬®© (sweeping line method) ±®±²®¨² ¢
²®¬, ·²® ¢®®¡° ¦ ¥¬ ¿ ¢¥°²¨ª «¼­ ¿ ¯°¿¬ ¿ ¤¢¨¦¥²±¿ ±«¥¢  ­ ¯° ¢® ¬¨¬® ° ±±¬ ²°¨¢ ¥¬»µ £¥®¬¥²°¨·¥±ª¨µ ®¡º¥ª²®¢. ¤¥¿ ±®±²®¨² ¢ ²®¬, ·²® ®² ¤¢³¬¥°­®£® ¯°®±²° ­±²¢  ¬» ¯¥°¥µ®¤¨¬ ª
¯°®¨§¢¥¤¥­¨¾ ¯°®±²° ­±²¢®-¢°¥¬¿ (®¡  ®¤­®¬¥°­»), ±·¨² ¿ ®±¼  ¡±¶¨±± ®±¼¾ ¢°¥¬¥­¨, ¤¢¨¦³¹³¾±¿ ¯°¿¬³¾ | ¬£­®¢¥­­»¬ ±°¥§®¬
±¨²³ ¶¨¨. °¨ ½²®¬ «¨­¨¨ ­  ¯«®±ª®±²¨ ±² ­®¢¿²±¿ ¤¢¨¦³¹¨¬¨±¿ ¯® ¯°¿¬®© ²®·ª ¬¨, ¨ ¨µ ¬®¦­® ³¯®°¿¤®·¨¢ ²¼. (¡»·­® ®­¨
µ° ­¿²±¿ ± ¯®¬®¹¼¾ ¤¨­ ¬¨·¥±ª®© ±²°³ª²³°» ¤ ­­»µ.)  § ¤ ·¥
® ¯¥°¥±¥·¥­¨¿µ ®²°¥§ª®¢  «£®°¨²¬ ¯°®±¬ ²°¨¢ ¥² ª®­¶» ¢±¥µ ®²°¥§ª®¢ ±«¥¢  ­ ¯° ¢® ¨ ¯°®¢¥°¿¥², ­¥² «¨ ¯¥°¥±¥·¥­¨¿ ­  ®·¥°¥¤­®¬
³· ±²ª¥ ®±¨  ¡±¶¨±±.
 ¸  «£®°¨²¬ ¨±¯®«¼§³¥² ¤¢  ³¯°®¹ ¾¹¨µ ¯°¥¤¯®«®¦¥­¨¿. »
±·¨² ¥¬, ·²® ±°¥¤¨ ° ±±¬ ²°¨¢ ¥¬»µ ®²°¥§ª®¢ ­¥² ¢¥°²¨ª «¼­»µ
¨ ·²® ­¨ª ª¨¥ ²°¨ ®²°¥§ª  ­¥ ¯®µ®¤¿² ·¥°¥§ ®¤­³ ¨ ²³ ¦¥ ²®·ª³
(³¯°. 35.2-8 ²°¥¡³¥² ¯®±²°®¨²¼  «£®°¨²¬, ª®²®°»© £®¤¨²±¿ ¢® ¢±¥µ
±«³· ¿µ.) «¥¤³¥² ®²¬¥²¨²¼, ·²® ¢®§­¿ ± ° §­®®¡° §­»¬¨ £° ­¨·­»¬¨ ±«³· ¿¬¨ | ®¤¨­ ¨§ ®±­®¢­»µ ¨±²®·­¨ª®¢ µ«®¯®² ¨ ®¸¨¡®ª
¯°¨ ¯°®£° ¬¬¨°®¢ ­¨¨ § ¤ · ¢»·¨±«¨²¥«¼­®© £¥®¬¥²°¨¨.
²­®¸¥­¨¿ ¯®°¿¤ª  ­  ®²°¥§ª µ
» ¯°¥¤¯®«®¦¨«¨, ·²® ±°¥¤¨ ° ±±¬ ²°¨¢ ¥¬»µ ®²°¥§ª®¢ ­¥²
¢¥°²¨ª «¼­»µ. ®½²®¬³ ¤¢¨¦³¹ ¿±¿ ¢¥°²¨ª «¼­ ¿ ¯°¿¬ ¿ ¢ «¾¡®©
¬®¬¥­² ¯¥°¥±¥ª ¥² ª ¦¤»© ¨§ ­¨µ ¬ ª±¨¬³¬ ¢ ®¤­®© ²®·ª¥. »

800

« ¢  35 »·¨±«¨²¥«¼­ ¿ £¥®¬¥²°¨¿

³¯®°¿¤®·¨¢ ¥¬ ®²°¥§ª¨ (²¥, ª®²®°»¥ ¥¥ ¯¥°¥±¥ª ¾²) ¯® ®°¤¨­ ²¥
²®·ª¨ ¯¥°¥±¥·¥­¨¿.
®«¥¥ ²®·­®, ¤¢  ®²°¥§ª  s1 ¨ s2 ±° ¢­¨¬» ®²­®±¨²¥«¼­® x (comparable at x), ¥±«¨ ¢¥°²¨ª «¼­ ¿ ¯°¿¬ ¿, ±  ¡±¶¨±±®© x, ¯¥°¥±¥ª ¥²±¿ ± ­¨¬¨ ®¡®¨¬¨. °¨ ½²®¬ s1 ¢»¸¥ s2 ®²­®±¨²¥«¼­® x (s1 is
above s2 at x, ®¡®§­ ·¥­¨¥ s1 >x s2 ), ¥±«¨ ®²°¥§ª¨ s1 ¨ s2 ±° ¢­¨¬»
®²­®±¨²¥«¼­® x ¨ ²®·ª  ¯¥°¥±¥·¥­¨¿ s1 ± ¢¥°²¨ª «¼­®© ¯°¿¬®© ­ µ®¤¨²±¿ ¢»¸¥ ²®·ª¨ ¯¥°¥±¥·¥­¨¿ s2 ± ½²®© ¦¥ ¯°¿¬®©.   °¨±³­ª¥
35.4 (a) ¬» ¢¨¤¨¬, ·²® a >r c, a >t b, b >t c, a >t c ¨ b >u c,  
®²°¥§®ª d ­¥ ±° ¢­¨¬ ­¨ ± ®¤­¨¬ ¨§ ®±² «¼­»µ.
«¿ «¾¡®£® ´¨ª±¨°®¢ ­­®£® x ®²­®¸¥­¨¥ À>x Á ¿¢«¿¥²±¿ ®²­®¸¥­¨¥¬ ¯®°¿¤ª  (±¬. ° §¤¥« 5.2) ­  ¬­®¦¥±²¢¥ ®²°¥§ª®¢, ¯¥°¥±¥ª ¾¹¨µ±¿ ± ¢¥°²¨ª «¼­®© ¯°¿¬®©, ¯°®µ®¤¿¹¥© ·¥°¥§ x. °¨ ° §­»µ
§­ ·¥­¨¿µ x ½²®² ¯®°¿¤®ª (ª ª ¨ ¬­®¦¥±²¢®, ­  ª®²®°®¬ ®­ ®¯°¥¤¥«¥­) ¬®¦¥² ¡»²¼ ° §«¨·­»¬. ²°¥§®ª ¯®¯ ¤ ¥² ¢ ½²® ¬­®¦¥±²¢®,
ª®£¤  ¢¥°²¨ª «¼­ ¿ ¯°¿¬ ¿ ¯°®µ®¤¨² ·¥°¥§ ¥£® «¥¢»© ª®­¥¶, ¨ ¢»¡»¢ ¥² ¨§ ­¥£®, ª®£¤  ®­  ¯°®µ®¤¨² ·¥°¥§ ¯° ¢»© ª®­¥¶.
²® ¯°®¨±µ®¤¨², ª®£¤  ¢¥°²¨ª «¼­ ¿ ¯°¿¬ ¿ ¯°®µ®¤¨² ·¥°¥§ ²®·ª³ ¯¥°¥±¥·¥­¨¿ ¤¢³µ ®²°¥§ª®¢? ²­®¸¥­¨¥ ¯®°¿¤ª  ¬¥¦¤³ ¯¥°¥±¥ª ¾¹¨¬¨±¿ ®²°¥§ª ¬¨ ¢ ²®·ª¥ ¯¥°¥±¥·¥­¨¿ ¬¥­¿¥²±¿ ­  ¯°®²¨¢®¯®«®¦­®¥ (°¨±. 35.4 (b)): ¯°¿¬»¥ v ¨ w ­ µ®¤¿²±¿ ±«¥¢  ¨ ±¯° ¢  ®²
²®·ª¨ ¯¥°¥±¥·¥­¨¿ ®²°¥§ª®¢ e ¨ f , ¯°¨ ½²®¬ e >v f ¨ f >u e.
 ¯®¬­¨¬, ·²® ¯® ­ ¸¥¬³ ¯°¥¤¯®«®¦¥­¨¾ ­¨ª ª¨¥ ²°¨ ®²°¥§ª 
­¥ ¯°®µ®¤¿² ·¥°¥§ ®¤­³ ¨ ²³ ¦¥ ²®·ª³, ¯®½²®¬³ ¢ ®ª°¥±²­®±²¨ ²®·ª¨ ¯¥°¥±¥·¥­¨¿ ¯¥°¥±¥ª ¾¹¨¥±¿ ®²°¥§ª¨ ­¥¯®±°¥¤±²¢¥­­® ±«¥¤³¾²
®¤¨­ §  ¤°³£¨¬ (± ²®·ª¨ §°¥­¨¿ ³ª § ­­®£® ¯®°¿¤ª ), °¨±. 35.4 (b).
¢¨¦¥­¨¥ ¯°¿¬®©.
±¯®«¼§³¿ ¬¥²®¤ ¤¢¨¦³¹¥©±¿ ¯°¿¬®©, ¬» µ° ­¨¬ ¨­´®°¬ ¶¨¾
¤¢³µ ¢¨¤®¢:
1. ®±²®¿­¨¥ ¤¥« ³ ¯°¿¬®© (sweep-line status) § ¤ ¥²±¿ ³¯®°¿¤®·¥­­»¬ ¬­®¦¥±²¢®¬ ®¡º¥ª²®¢, ¯¥°¥±¥ª ¥¬»µ ¤¢¨¦³¹¥©±¿ ¯°¿¬®©
¢ ²¥ª³¹¨© ¬®¬¥­².
2.  ±¯¨± ­¨¥ (event-point schedule) ¯°¥¤±² ¢«¿¥² ±®¡®© ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¬®¬¥­²®¢ ¢°¥¬¥­¨, ¢ ª®²®°»µ ±®±²®¿­¨¥ ¬®¦¥² ¨§¬¥­¨²¼±¿ (¯¥°¥·¨±«¥­­»µ ¢ ¯®°¿¤ª¥ ¢®§° ±² ­¨¿ ¢°¥¬¥­¨).  ª¨¥ ¬®¬¥­²» ¢°¥¬¥­¨ ¬» ¡³¤¥¬ ­ §»¢ ²¼ ª°¨²¨·¥±ª¨¬¨ ²®·ª ¬¨ (event
point), ² ª ·²® ¨§¬¥­¥­¨¥ ±®±²®¿­¨¿ ¤¥« ³ ¯°¿¬®© ¢®§¬®¦­® ²®«¼ª®
¢ ª°¨²¨·¥±ª®© ²®·ª¥.
«¿ ­¥ª®²®°»µ  «£®°¨²¬®¢ (±¬., ­ ¯°¨¬¥°, ³¯° ¦­¥­¨¥ 35.2-7)
ª°¨²¨·¥±ª¨¥ ²®·ª¨ ®¯°¥¤¥«¿¥²±¿ ¯®±²¥¯¥­­® ¯® µ®¤³ ° ¡®²»  «£®°¨²¬ . ¤­ ª® ¬» ¡³¤¥¬ ° ±±¬ ²°¨¢ ²¼  «£®°¨²¬, ¢ ª®²®°®¬ ° ±¯¨± ­¨¥ «¥£ª® ­ ©²¨ § ° ­¥¥.  · ±²­®±²¨,  ¡±¶¨±±  ª®­¶  «¾¡®£®
®²°¥§ª  ¿¢«¿¥²±¿ ª°¨²¨·¥±ª®© ²®·ª®©. ¯®°¿¤®·¨¬ ª®­¶» ®²°¥§ª®¢ ¢ ¯®°¿¤ª¥ ¢®§° ±² ­¨¿ ¨µ  ¡±¶¨±±. ²°¥§®ª ­ ·¨­ ¥² ¢«¨¿²¼ ­ 
±®±²®¿­¨¥ ¤¥« ³ ¯°¿¬®© ± ¬®¬¥­² , ª®£¤  ¯°¿¬ ¿ ¯°®µ®¤¨² ·¥°¥§
¥£® «¥¢»© ª®­¥¶, ¨ ¯¥°¥±² ¥² ± ¬®¬¥­² , ª®£¤  ¯°¿¬ ¿ ¯°®µ®¤¨²

±²¼ «¨ ¯¥°¥±¥ª ¾¹¨¥±¿ ®²°¥§ª¨?

801

35.5 ±¯®«­¥­¨¥  «£®°¨²¬  Any-Segment-Intersect. ®«®¦¥­¨¿ ¤¢¨¦³¹¥©±¿ ¯°¿¬®© ¢ ª°¨²¨·¥±ª¨µ ²®·ª µ ¯®ª § ­» ¯³­ª²¨°®¬; °¿¤®¬ ¢»¯¨± ­» ¯¥°¥±¥ª ¥¬»¥ ®²°¥§ª¨ (¢ ¯®°¿¤ª¥ ±¢¥°µ³ | ¢­¨§) ¢
¬®¬¥­² ±° §³ ¯®±«¥ ¯°®µ®¤  ª°¨²¨·¥±ª®© ²®·ª¨, ¥°¥±¥·¥­¨¥ ®²°¥§ª®¢ d ¨ b ®¡­ °³¦¨¢ ¥²±¿ ¯®±«¥ ³¤ «¥­¨¿ ®²°¥§ª  c.
·¥°¥§ ¥£® ¯° ¢»© ª®­¥¶.
®±²®¿­¨¥ ¤¥« ³ ¯°¿¬®© ¬®¦­® µ° ­¨²¼ ª ª ³¯®°¿¤®·¥­­®¥ ¬­®¦¥±²¢® ®²°¥§ª®¢, ± ª®²®°»¬ ¢»¯®«­¿¾²±¿ ±«¥¤³¾¹¨¥ ®¯¥° ¶¨¨:
Insert(T; s) : ¤®¡ ¢¨²¼ ®²°¥§®ª s ¢ T ;
Delete(T; s) : ³¤ «¨²¼ ®²°¥§®ª s ¨§ T ;
Above(T; s) : ³ª § ²¼ ®²°¥§®ª, ° ±¯®« £ ¾¹¨©±¿ ­¥¯®±°¥¤±²¢¥­­® ¢»¸¥ s ¢ ¬­®¦¥±²¢¥ T ;
Below(T; s) : ¢®§¢° ¹ ¥² ®²°¥§®ª, ° ±¯®« £ ¾¹¨©±¿ ­¥¯®±°¥¤±²¢¥­­® ­¨¦¥ s ¢ ¬­®¦¥±²¢¥ T .
(®¢®°¿ ®¡ ®²­®¸¥­¨¨ ¯®°¿¤ª  ¢ T , ¬» ®¯¨±»¢ ¥¬ ±«®¢  À¢»¸¥Á
¨ À­¨¦¥Á ¢ ±®®²¢¥²±²¢¨¨ ± £¥®¬¥²°¨·¥±ª¨¬ ±¬»±«®¬ ½²®£® ®²­®¸¥­¨¿.)
» ¬®¦¥¬ µ° ­¨²¼ («¨­¥©­®) ³¯®°¿¤®·¥­­®¥ ¬­®¦¥±²¢® ¨§ n ®²°¥§ª®¢ ¨ ¢»¯®«­¿²¼ «¾¡³¾ ¨§ ³ª § ­­»µ ®¯¥° ¶¨© §  ¢°¥¬¿ O(lg n),
¨±¯®«¼§³¿ ª° ±­®-·¥°­®¥ ¤¥°¥¢®,  ¬¥²¨¬, ·²® ®¯¥° ¶¨¨ ±° ¢­¥­¨¿
(ª ª®© ¨§ ®²°¥§ª®¢ ¢»¸¥ ¢ ¤ ­­»© ¬®¬¥­²) ¬®¦­® ¢»¯®«­¨²¼ § 
¢°¥¬¿ O(1), ¨±¯®«¼§³¿ ¢¥ª²®°­»¥ ¯°®¨§¢¥¤¥­¨¿ (±¬. ³¯°. 35.2-2).
°®¢¥°ª  ¯¥°¥±¥·¥­¨©
®±²°®¨¬  «£®°¨²¬, ª®²®°»© ¯® § ¤ ­­®¬³ ¬­®¦¥±²¢³ S , ±®±²®¿¹¥¬³ ¨§ n ®²°¥§ª®¢, ¯°®¢¥°¿¥², ¥±²¼ «¨ ±°¥¤¨ ­¨µ µ®²¿ ¡» ¤¢ 
¯¥°¥±¥ª ¾¹¨µ±¿. ²®²  «£®°¨²¬ ¨±¯®«¼§³¥² ª° ±­®-·¥°­®¥ ¤¥°¥¢®
¤«¿ µ° ­¥­¨¿ ²¥ª³¹¥£® ±®±²®¿­¨¿ ¤¥« ³ ¤¢¨¦³¹¥©±¿ ¯°¿¬®©.
Any-Segment-Intersect(S)
1 T \gets \emptyset
2 ±®°²¨°³¥¬ ª®­¶» ®²°¥§ª®¢ ¢ ¯®°¿¤ª¥ ¢®§° ±² ­¨¿  ¡±¶¨±± (²®·ª¨
± ° ¢­»¬¨  ¡±¶¨±± ¬¨ ¨¤³² ¢ ¯®°¿¤ª¥ ¢®§° ±² ­¨¿ ®°¤¨­ ²);
¯°®¢¥°¿¥¬, ­¥² «¨ ±®¢¯ ¤ ¾¹¨µ ²®·¥ª ±°¥¤¨ ª®­¶®¢ (¥±«¨ ¥±²¼ ¢®§¢° ¹ ¥¬ true)
3 \emph{for} (¤«¿) ª ¦¤®© ²®·ª¨ $p$ ¨§ ¯®«³·¥­­®£® ±¯¨±ª 
4
\emph{do} if $p$ --- «¥¢»© ª®­¥¶ ­¥ª®²®°®£® ®²°¥§ª  $s$
5
\emph{then} Insert (T, s )
6
\emph{if} (Above (T, s) ±³¹¥±²¢³¥² ¨ ¯¥°¥±¥ª ¥² s) ¨«¨
(Below (T, s) ±³¹¥±²¢³¥² ¨ ¯¥°¥±¥ª ¥² s)
7
\emph{then return} true
8
\emph{if} $p$ ¯° ¢»© ª®­¥¶ ­¥ª®²®°®£® ®²°¥§ª  $s$
9
\emph{then if} ®¯°¥¤¥«¥­» Above (T, s) ¨ Below (T, s)
¨ (Above (T, s) ¯¥°¥±¥ª ¥² Below
10
\emph{then return} true
11
Delete(T, s)

802

« ¢  35 »·¨±«¨²¥«¼­ ¿ £¥®¬¥²°¨¿
12

\emph{return} false

  °¨±. 35.5 ¯®ª § ­® ¢»¯®«­¥­¨¥  «£®°¨²¬ . §­ · «¼­® ¬­®¦¥±²¢® T ¯³±²® (±²°®ª  1).  ±²°®ª¥ 2 ±²°®¨²±¿ ° ±¯¨± ­¨¥ ®¦¨¤ ¥¬»µ ±®¡»²¨©, ±®®²¢¥²±²¢³¾¹¨µ ª®­¶ ¬ ®²°¥§ª®¢ (¢®®¡¹¥-²®
ª°¨²¨·¥±ª¨¬¨ ²®·ª ¬¨ ¿¢«¿¾²±¿ ² ª¦¥ ¬®¬¥­²» ¯¥°¥±¥·¥­¨¿ ®²°¥§ª®¢, ­® ¯®±«¥ ®¡­ °³¦¥­¨¿ ² ª®£® ¯¥°¥±¥·¥­¨¿  «£®°¨²¬ § ª ­·¨¢ ¥² ° ¡®²³ ±° §³ ¦¥, ² ª ·²® ½²¨ ¬®¬¥­²» ¬» ±¬¥«® ¬®¦¥¬
¨£­®°¨°®¢ ²¼.
 ¦¤ ¿ ¨²¥° ¶¨¿ ¶¨ª«  for ¢ ±²°®ª µ 3{11 ®¡° ¡ ²»¢ ¥² ®¤­³
ª°¨²¨·¥±ª³¾ ²®·ª³. ±«¨ ®­  ±®®²¢¥²±²¢³¾² «¥¢®¬³ ª®­¶³ ­¥ª®²®°®£® ®²°¥§ª  s, ²® ¢ ±²°®ª¥ 5 ½²®² ®²°¥§®ª ¤®¡ ¢«¿¥²±¿ ¢ ³¯®°¿¤®·¥­­®¥ ¬­®¦¥±²¢®,   ¢ ±²°®ª µ 6{7 ¯°®¢¥°¿¥²±¿, ­¥ ¯¥°¥±¥ª ¥²±¿
«¨ ®­ · ±®¬ ± ®¤­¨¬ ¨§ ±®±¥¤­¨µ ®²°¥§ª®¢ (¥±«¨ ¤ , ²®  «£®°¨²¬
ª®­· ¥² ° ¡®²³ ¨ ¤ ¥² ®²¢¥² true). (®§¬®¦­®, ·²® ª°¨²¨·¥±ª ¿
²®·ª  ±®®²¢¥²±²¢³¥² ª®­¶ ¬ ­¥±ª®«¼ª¨µ ®²°¥§ª®¢ | ¢ ½²®¬ ±«³· ¥
®­¨ ¤®¡ ¢«¿¾²±¿ ®¤¨­ §  ¤°³£¨¬.)
±«¨ ®¡° ¡ ²»¢ ¥¬ ¿ ª°¨²¨·¥±ª ¿ ²®·ª  ¿¢«¿¥²±¿ ¯° ¢»¬ ª®­¶®¬ ­¥ª®²®°®£® ®²°¥§ª  s, ²® ½²®² ®²°¥§®ª ³¤ «¿¥²±¿ ¨§ T (±²°®ª 
11); ¯°¥¤¢ °¨²¥«¼­® ¯°®¢¥°¿¥²±¿, ­¥ ¯¥°¥±¥ª ¾²±¿ «¨ ®²°¥§ª¨, ª®²®°»¥ ° §¤¥«¿« ³¤ «¿¥¬»© ®²°¥§®ª ¨ ª®²®°»¥ ²¥¯¥°¼ ±² ­®¢¿²±¿
±®±¥¤­¨¬¨ (±²°®ª¨ 9{10)
 ª ¤¥« ¥²±¿ ¤«¿ ¢±¥µ ª®­¶®¢ ¢±¥µ ®²°¥§ª®¢; ¥±«¨ ¯°¨ ½²®¬ ¯¥°¥±¥·¥­¨¥ ² ª ¨ ®¡­ °³¦¨¢ ¥²±¿, ²®  «£®°¨²¬ ¢®§¢° ¹ ¥² false
(±²°®ª  12).
° ¢¨«¼­®±²¼  «£®°¨²¬ 
¥®°¥¬  35.1
°®¶¥¤³°  Any-Segment-Intersect(S ) ¢®§¢° ¹ ¥² true ¢ ²®¬
¨ ²®«¼ª® ²®¬ ±«³· ¥, ª®£¤  ±°¥¤¨ ®²°¥§ª®¢ ¬­®¦¥±²¢  S ¥±²¼ ¯¥°¥±¥ª ¾¹¨¥±¿.
®ª § ²¥«¼±²¢®.
 ¬¥²¨¬, ·²® §­ ·¥­¨¥ true ¢®§¢° ¹ ¥²±¿ «¨¸¼ ¯®±«¥ ²®£®, ª ª
®¡­ °³¦¥­» ¤¢  ¯¥°¥±¥ª ¾¹¨µ±¿ ®²°¥§ª . ®½²®¬³ ­ ¤® «¨¸¼ ¯°®¢¥°¨²¼, ·²® ¥±«¨ ¢ S ¥±²¼ ¯ °  ¯¥°¥±¥ª ¾¹¨µ±¿ ®²°¥§ª®¢, ²® ®­ 
¡³¤¥² ®¡­ °³¦¥­ .
°¥¤¯®«®¦¨¬ ²¥¯¥°¼, ·²®  «£®°¨²¬ ­¥ ¢®§¢° ¹ ¥² §­ ·¥­¨¿
true,   ¯°®±¬ ²°¨¢ ¥² ¯® ®·¥°¥¤¨ ¢±¥ ª®­¶» ®²°¥§ª®¢, ­¥ ­ µ®¤¨²
¯¥°¥±¥·¥­¨¿ ¨ ¢®§¢° ¹ ¥² §­ ·¥­¨¥ false. ®ª ¦¥¬, ·²® ¢ ² ª®¬
±«³· ¥ ®²°¥§ª¨ ­¥ ¯¥°¥±¥ª ¾²±¿.
 ±±¬®²°¨¬ ±­ · «  ±«³· ©, ª®£¤  ª®­¶» ¢±¥µ ®²°¥§ª®¢ ¨¬¥¾²
° §«¨·­»¥  ¡±¶¨±±». ®£¤  ­  ª ¦¤®© ¨²¥° ¶¨¨ ¶¨ª«  ° ±±¬ ²°¨¢ ¥²±¿ ­®¢®¥ §­ ·¥­¨¥  ¡±¶¨±±». ®ª ¦¥¬, ·²® ¯°¨ ½²®¬ ®±² ¾²±¿
¢¥°­»¬¨ ² ª¨¥ ±¢®©±²¢ :
(a) ¬­®¦¥±²¢® T ±®®²¢¥²±²¢³¥² ¯®«®¦¥­¨¾ ¯°¿¬®© ­¥¯®±°¥¤±²¢¥­­® ±¯° ¢  ®² ¯®±«¥¤­¥© ®¡° ¡®² ­­®©  ¡±¶¨±±»;
(b) ±®±¥¤­¨¥ ¢ ¬­®¦¥±²¢¥ T ®²°¥§ª¨ ­¥ ¯¥°¥±¥ª ¾²±¿.

±²¼ «¨ ¯¥°¥±¥ª ¾¹¨¥±¿ ®²°¥§ª¨?

803

­ · «¥ ½²¨ ±¢®©±²¢  ¢»¯®«­¥­» (T ¯³±²®, ¤¢¨¦³¹ ¿±¿ ¯°¿¬ ¿
­¥ ¯¥°¥±¥ª ¥² ­¨ ®¤­®£® ¨§ ®²°¥§ª®¢, ­ µ®¤¿±¼ ±«¥¢  ®² ¢±¥µ ­¨µ).
°®¢¥°¨¬, ·²® ®­¨ ®±² ¾²±¿ ¢»¯®«­¥­­»¬¨ ¯®±«¥ ¯°®µ®¤  ·¥°¥§
®¤¨­ ¨§ ª®­¶®¢ (¤°³£¨¬¨ ±«®¢ ¬¨, ¯®±«¥ ®·¥°¥¤­®© ¨²¥° ¶¨¨ ¶¨ª« ).
±«¨ ®·¥°¥¤­ ¿ ²®·ª  ¥±²¼ «¥¢»© ª®­¥¶ ®²°¥§ª , ²® ¯®¿¢«¿¥²±¿
­®¢ ¿ ²®·ª  ¯¥°¥±¥·¥­¨¿ ± ¤¢¨¦³¹¥©±¿ ¯°¿¬®©.  ·¨­ ¾¹¨©±¿ ¢
­¥© ®²°¥§®ª ­¥ ¯¥°¥±¥ª ¥²±¿ ± ±®±¥¤­¨¬¨ (¢ ±¬»±«¥ ²¥ª³¹¥£® ±®±²®¿­¨¿ ¬­®¦¥±²¢  T ) ®²°¥§ª ¬¨, ¨­ ·¥ ½²® ¡»«® ¡» ®¡­ °³¦¥­®.
±² «¼­»¥ ¯ °» ±®±¥¤­¨µ ®²°¥§ª®¢ ¡»«¨ ±®±¥¤­¨¬¨ ° ­¼¸¥, ² ª
·²® ¬» ³¦¥ §­ ¥¬, ·²® ®­¨ ­¥ ¯¥°¥±¥ª ¾²±¿.
 § ±®±¥¤­¨¥ ®²°¥§ª¨ ­¥ ¯¥°¥±¥ª ¾²±¿, ²® ­  ³· ±²ª¥ ¤® ±«¥¤³¾¹¥£® §­ ·¥­¨¿  ¡±¶¨±±» ¢ ±¯¨±ª¥ ®²­®±¨²¥«¼­»© ¯®°¿¤®ª ±®µ° ­¿¥²±¿ (²®·ª  ¯¥°¥±¥·¥­¨¿ ¬®¦¥² ¡»²¼ ²®«¼ª® ³ ­¥±®±¥¤­¨µ ®²°¥§ª®¢
¨ ²®«¼ª® ¯®±«¥ ª®­¶  ²®£® ®²°¥§ª , ª®²®°»© ¨µ ° §¤¥«¿«).
³±²¼ ²¥¯¥°¼ ®·¥°¥¤­ ¿ ²®·ª  ¥±²¼ ¯° ¢»© ª®­¥¶ ®²°¥§ª . ®£¤ 
¨§ ¬­®¦¥±²¢  T ³¤ «¿¥²±¿ ½«¥¬¥­² (ª ª ¨ ¯®« £ ¥²±¿, ¥±«¨ ¬» µ®²¨¬, ·²®¡» T ±®®²¢¥²±²¢®¢ «® ¯®«®¦¥­¨¾ ¯°¿¬®© ±¯° ¢  ®² ®·¥°¥¤­®© ²®·ª¨). ®¿¢«¿¥²±¿ ­®¢ ¿ ¯ °  ±®±¥¤­¨µ ®²°¥§ª®¢ | ¯°®
ª®²®°³¾  «£®°¨²¬ ¯°®¢¥°¿¥², ·²® ®­¨ ­¥ ¯¥°¥±¥ª ¾²±¿. ® ²¥¬ ¦¥
¯°¨·¨­ ¬, ·²® ¨ ° ­¼¸¥, ¬®¦­® ³²¢¥°¦¤ ²¼, ·²® ¤® ±«¥¤³¾¹¥£®
§­ ·¥­¨¿  ¡±¶¨±±» ®²­®±¨²¥«¼­»© ¯®°¿¤®ª ±®µ° ­¿¥²±¿.
² ª, ±¢®©±²¢  (a) ¨ (b) ¯°®¢¥°¥­», ¨ § ®¤­® ¤®ª § ­®, ·²® ­¨ª ª¨¥ ¤¢  ®²°¥§ª  ­¥ ¯¥°¥±¥ª ¾²±¿.  ± ¬®¬ ¤¥«¥, ° § ¬¥¦¤³ ° ±±¬ ²°¨¢ ¥¬»¬¨  ¡±¶¨±± ¬¨ ¯®°¿¤®ª ±®µ° ­¿¥²±¿, ¬¥¦¤³ ­¨¬¨ ¯¥°¥±¥·¥­¨¥ ­¥¢®§¬®¦­®;   ¯°¨ ¯°®µ®¦¤¥­¨¨ ¤¢¨¦³¹¥©±¿ ¯°¿¬®© ·¥°¥§
ª®­¥¶ ®²°¥§ª  ¯¥°¥±¥·¥­¨¥ ² ª¦¥ ­¥¢®§¬®¦­®, ² ª ª ª ­¥ª®²®°»¥
¯¥°¥±¥ª ¾¹¨¥±¿ ®²°¥§ª¨ ¡»«¨ ¡» ±®±¥¤­¨¬¨ ±«¥¢  ¨«¨ ±¯° ¢  ®²
¯°¿¬®©.
±² «®±¼ ° §®¡° ²¼±¿, ¯®·¥¬³ ­ ¸¥ ° ±±³¦¤¥­¨¥ ¯°¨¬¥­¨¬® ª
±«³· ¾, ª®£¤  ­¥±ª®«¼ª® ª®­¶®¢ ®²°¥§ª®¢ «¥¦ ² ­  ®¤­®© ¢¥°²¨ª «¨ (­® ­¥ ±®¢¯ ¤ ¾² | ½²® ¯°®¢¥°¿¥²±¿ ¯°¨ ±®°²¨°®¢ª¥ ª®­¶®¢ ®²°¥§ª®¢). ²® ¬®¦­® ®¡º¿±­¨²¼ ² ª: ¯°¥¤±² ¢¨¬ ±¥¡¥, ·²® ¤¢¨¦³¹ ¿±¿ ¯°¿¬ ¿ ·³²¼-·³²¼ ­ ª«®­¥­  ¢«¥¢® (¯°®²¨¢ · ±®¢®© ±²°¥«ª¨).
®£¤  ®­  ¡³¤¥² ¯¥°¥±¥ª ²¼ ª®­¶» ®²°¥§ª®¢ ¢ ° §­»¥ (µ®²¿, ¢®§¬®¦­®, ®·¥­¼ ¡«¨§ª¨¥) ¬®¬¥­²» ¢°¥¬¥­¨, ¨ ¯°®±¬ ²°¨¢ ²¼±¿ ®­¨
¡³¤³² ª ª ° § ¢ ­³¦­®¬ ¯®°¿¤ª¥ (²®·ª¨ ± ®¤¨­ ª®¢®©  ¡±¶¨±±®©
| ¢ ¯®°¿¤ª¥ ¢®§° ±² ­¨¿ ®°¤¨­ ²). ¥¬ ± ¬»¬ ¬®¦­® ±¢¥±²¨ ¤¥«®
ª ³¦¥ ° §®¡° ­­®¬³ ±«³· ¾ (¯°®¢¥°¿²¼±¿ ­  ¯¥°¥±¥·¥­¨¥ ¡³¤³² ²¥
¦¥ ¯ °» ®²°¥§ª®¢, ·²® ¨ ± ¢®®¡° ¦ ¥¬®© ­ ª«®­¥­­®© ¯°¿¬®©).
°¥¬¿ ° ¡®²».
±«¨ ¬­®¦¥±²¢® S ±®±²®¨² ¨§ n ®²°¥§ª®¢, ²® ¢°¥¬¿ ° ¡®²»  «£®°¨²¬  Any-Segment-Intersect ¥±²¼ O(n lg n).  ± ¬®¬ ¤¥«¥, ±®°²¨°®¢ª³ ¬®¦­® ¢»¯®«­¨²¼ §  ² ª®¥ ¢°¥¬¿ (±®°²¨°®¢ª³ ±«¨¿­¨¥¬
¨«¨ ± ¯®¬®¹¼¾ ¤¢®¨·­®© ª³·¨), § ²¥¬ ¬» ®¡° ¡ ²»¢ ¥¬ 2n ª®­¶®¢
®²°¥§ª®¢, ²° ²¿ ­  ª ¦¤»© ¢°¥¬¿ O(lg n) (² ª®¢® ¢°¥¬¿ «¾¡®© ¨±-

804

« ¢  35 »·¨±«¨²¥«¼­ ¿ £¥®¬¥²°¨¿

¯®«¼§®¢ ­­®© ­ ¬¨ ®¯¥° ¶¨¨ ± ª° ±­®-·¥°­»¬ ¤¥°¥¢®¬).  ¬¥²¨¬,
·²® ¤«¿ ®¤­®© ¯ °» ®²°¥§ª®¢ ¢»¿±­¥­¨¥ ²®£®, ¯¥°¥±¥ª ¾²±¿ ®­¨
¨«¨ ­¥², ¢»¯®«­¿¥²±¿ §  ¢°¥¬¿ O(1).
¯° ¦­¥­¨¿.
35.2-1
®ª § ²¼, ·²® n ®²°¥§ª®¢ ¬®£³² ¨¬¥²¼ (n2 ) ²®·¥ª ¯¥°¥±¥·¥­¨¿.
35.2-2
 ­» ¤¢  ­¥¯¥°¥±¥ª ¾¹¨µ±¿ ®²°¥§ª  a ¨ b, ±° ¢­¨¬»µ ®²­®±¨²¥«¼­® x. ±¯®«¼§³¿ ¢¥ª²®°­®¥ ¯°®¨§¢¥¤¥­¨¥, ®¯°¥¤¥«¨²¼ §  ¢°¥¬¿
O(1), ¢»¯®«­¥­® «¨ ±®®²­®¸¥­¨¥ a >x b.
35.2-3
°®´¥±±®° ¯°¥¤« £ ¥² ¨§¬¥­¨²¼ ¯°®£° ¬¬³ Any-SegmentIntersect ² ª: ­ ©¤¿ ¯¥°¥±¥ª ¾¹¨¥±¿ ®²°¥§ª¨,  «£®°¨²¬ ­¥
ª®­· ¥² ° ¡®²³,   ¯°®¤®«¦ ¥² ¢»¯®«­¿²¼ ¶¨ª« for. ®«³·¨¢¸¨©±¿
 «£®°¨²¬ ¯°®´¥±±®° ­ §»¢ ¥² Print-Intersecting-Segments
¨ ³²¢¥°¦¤ ¥², ·²® ² ª®©  «£®°¨²¬ ­ ¯¥· ² ¥² ¢±¥ ¯¥°¥±¥·¥­¨¿
®²°¥§ª®¢ ¬­®¦¥±²¢  ¢ ¯®°¿¤ª¥ ¢®§° ±² ­¨¿ ¨µ  ¡±¶¨±±. ®ª ¦¨²¥,
·²® ¯°®´¥±±®° ¤¢ ¦¤» ­¥¯° ¢: ¢®-¯¥°¢»µ,  «£®°¨²¬ ¬®¦¥² ­ ¯¥· ² ²¼ ­¥ ¢±¥ ®²°¥§ª¨; ¢®-¢²®°»µ, ¯¥°¢ ¿ ­ ¯¥· ² ­­ ¿ ¨¬ ²®·ª 
¬®¦¥² ­¥ ¡»²¼ ± ¬®© «¥¢®© ²®·ª®© ¯¥°¥±¥·¥­¨¿.
35.2-4
®±²°®©²¥  «£®°¨²¬, ª®²®°»© §  ¢°¥¬¿ O(n lg n) ®¯°¥¤¥«¿¥²,
¨¬¥¥² «¨ ¤ ­­ ¿ § ¬ª­³² ¿ n-§¢¥­­ ¿ «®¬ ­ ¿ ± ¬®¯¥°¥±¥·¥­¨¿.
35.2-5
§¢¥±²­®, ·²® ¤¢  ­¥± ¬®¯¥°¥±¥ª ¾¹¨¥±¿ «®¬ ­»¥ ¨¬¥¾² ¢ ±³¬¬¥ n ¢¥°¸¨­. ®±²°®©²¥  «£®°¨²¬, ª®²®°»© §  ¢°¥¬¿ O(n lg n)
®¯°¥¤¥«¿¥², ¯¥°¥±¥ª ¾²±¿ «¨ ®­¨ ¤°³£ ± ¤°³£®¬.
35.2-6
 ­» n ª°³£®¢, § ¤ ­­»µ ±¢®¨¬¨ ¶¥­²° ¬¨ ¨ ° ¤¨³± ¬¨.  ª
®¯°¥¤¥«¨²¼ §  ¢°¥¬¿ O(n lg n), ¥±²¼ «¨ ±°¥¤¨ ­¨µ ¤¢  ¯¥°¥±¥ª ¾¹¨µ±¿ (²® ¥±²¼ ¨¬¥¾¹¨µ ®¡¹³¾ ²®·ª³)?
35.2-7
«¿ ­ ¡®°  ¨§ n ®²°¥§ª®¢ ¨¬¥¥²±¿ k ²®·¥ª ¯¥°¥±¥·¥­¨¿.   ¢°¥¬¿
O((n + k) lg n) ­ ©²¨ ¢±¥ ²®·ª¨ ¯¥°¥±¥·¥­¨¿.
35.2-8
®ª § ²¼, ª ª ¬®¤¨´¨¶¨°®¢ ²¼  «£®°¨²¬ Any-SegmentIntersect, ·²®¡» ®­ ¯° ¢¨«¼­® ° ¡®² « ¤«¿ «¾¡®£® ­ ¡®° 
®²°¥§ª®¢ (¢ ²®¬ ·¨±«¥ ¨ ¢¥°²¨ª «¼­»µ; ¢ ­¥ª®²®°»µ ²®·ª  ¬®¦¥²
¯¥°¥±¥ª ²¼±¿ ¡®«¥¥ ¤¢³µ ®²°¥§ª®¢).

35.3. ®±²°®¥­¨¥ ¢»¯³ª«®© ®¡®«®·ª¨
»¯³ª«®© ®¡®«®·ª®© (convex hull) ª®­¥·­®£® ¬­®¦¥±²¢  ²®·¥ª
Q ­ §»¢ ¥²±¿ ­ ¨¬¥­¼¸¨© ¢»¯³ª«»© ¬­®£®³£®«¼­¨ª, ±®¤¥°¦ ¹¨©

®±²°®¥­¨¥ ¢»¯³ª«®© ®¡®«®·ª¨

805

35.6 »¯³ª« ¿ ®¡®«®·ª  CH (Q) ¬­®¦¥±²¢  Q (±¥°»© ¬­®£®³£®«¼­¨ª)
¢±¥ ²®·ª¨ ¨§ Q (­¥ª®²®°»¥ ¨§ ²®·¥ª ¬®£³² ¡»²¼ ¢­³²°¨ ¬­®£®³£®«¼­¨ª , ­¥ª®²®°»¥ | ­  ¥£® ±²®°®­ µ,   ­¥ª®²®°»¥ ¡³¤³² ¥£®
¢¥°¸¨­ ¬¨). »¯³ª«³¾ ®¡®«®·ª³ ¬­®¦¥±²¢  Q ¬» ¡³¤¥¬ ®¡®§­ · ²¼ CH (Q).  £«¿¤­® ¬®¦­® ¯°¥¤±² ¢«¿²¼ ±¥¡¥ ¤¥«® ² ª: ¢ ²®·ª µ
Q ¢¡¨²» £¢®§¤¨, ­  ª®²®°»¥ ­ ²¿­³²  °¥§¨­ª , ®µ¢ ²»¢ ¾¹ ¿ ¨µ
¢±¥ | ½²  °¥§¨­ª  ¨ ¡³¤¥² ¢»¯³ª«®© ®¡®«®·ª®© ¬­®¦¥±²¢  £¢®§¤¥©
(°¨±. 35.6)
 ¤ ­­®¬ ° §¤¥«¥ ¬» ° ±±¬®²°¨¬ ¤¢   «£®°¨²¬  ®²»±ª ­¨¿ ¢»¯³ª«®© ®¡®«®·ª¨ ¬­®¦¥±²¢  ¨§ n ²®·¥ª; °¥§³«¼² ²®¬ ¨µ ° ¡®²»
¡³¤¥² ±¯¨±®ª ¢¥°¸¨­ ¢»¯³ª«®© ®¡®«®·ª¨ (¢ ¯®°¿¤ª¥ ®¡µ®¤  ¯°®²¨¢ · ±®¢®© ±²°¥«ª¨). ¥°¢»© ¨§  «£®°¨²¬®¢ (¯°®±¬®²° °½µ¥¬ )
²°¥¡³¥² ¢°¥¬¥­¨ O(n lg n). ²®°®© (¯°®µ®¤ ¦ °¢¨± ) ¢»¯®«­¿¥²±¿ §  ¢°¥¬¿ O(nh), £¤¥ h | ·¨±«® ¢¥°¸¨­ ¢»¯³ª«®© ®¡®«®·ª¨.  ª
¯®¤±ª §»¢ ¥² °¨±. 35.6, ª ¦¤ ¿ ¢¥°¸¨­  ¬­®£®³£®«¼­¨ª  CH (Q)
¿¢«¿¥²±¿ ®¤­®© ¨§ ²®·¥ª ¬­®¦¥±²¢  Q.  ª¨¬ ®¡° §®¬, ¤«¿ ®²»±ª ­¨¿ CH (Q)  «£®°¨²¬ ¤®«¦¥­ °¥¸¨²¼, ª ª¨¥ ¢¥°¸¨­» ¨§ Q ®±² ¢¨²¼,   ª ª¨¥ | ®²¡°®±¨²¼.
¡  ° ±±¬ ²°¨¢ ¥¬»µ ­ ¬¨  «£®°¨²¬  (¯°®±¬®²°®¬ °½µ¥¬  ¨ ¯°®µ®¤ ¦ °¢¨± ) ¨±¯®«¼§³¾² ¬¥²®¤ À¢° ¹ ¾¹¥£®±¿ «³· Á(rotational sweep): ¢»¡¨° ¥²±¿ ¯®«¿°­ ¿ ±¨±²¥¬» ª®®°¤¨­ ²,
¨ ²®·ª¨ ®¡° ¡ ²»¢ ¾²±¿ ¢ ¯®°¿¤ª¥ ¢®§° ±² ­¨¿ ¯®«¿°­»µ ³£«®¢
(ª ª ¢® ¢° ¹ ¾¹¥¬±¿ ° ¤ °¥). ® ±³¹¥±²¢³¾² ¨ ¤°³£¨¥ ¬¥²®¤»
¯®¨±ª  ¢»¯³ª«®© ®¡®«®·ª¨ §  ¢°¥¬¿ O(n lg n); ¢®² ­¥ª®²®°»¥
¢®§¬®¦­®±²¨.
¥²®¤ ¤®¡ ¢«¥­¨¿ ²®·¥ª (incremental method) ° ±±¬ ²°¨¢ ¥² ²®·ª¨ ±«¥¢  ­ ¯° ¢®, ° ±¯®« £ ¿ ¨§ ¢ ¯®±«¥¤®¢ ²¥«¼­®±²¼
(p1; p2; :::; pn) ¢ ¯®°¿¤ª¥ ¢®§° ±² ­¨¿  ¡±¶¨±±.   i-®¬ ¸ £¥ ±²°®¨²±¿ ¢»¯³ª« ¿ ®¡®«®·ª  CH (p1; p2; :::; pi) ¯¥°¢»µ i ²®·¥ª (ª ³¦¥
¨§¢¥±²­®© ®¡®«®·ª¥ ¯¥°¢»µ i ; 1 ²®·¥ª ¤®¡ ¢«¿¥²±¿ ²®·ª  pi).
²³ ¨¤¥¾ ¬®¦­® ¯°¥¢° ²¨²¼ ¢  «£®°¨²¬, ­ µ®¤¿¹¨© ¢»¯³ª«³¾
®¡®«®·ª³ §  ¢°¥¬¿ O(n lg n) (³¯°. 35.3-6).
¥²®¤ ° §¤¥«¿© ¨ ¢« ±²¢³© (divide-and-conquer method) §  ¢°¥¬¿ (n) ¤¥«¨² ¬­®¦¥±²¢® ¨§ n ²®·¥ª ¢¥°²¨ª «¼­®© ¯°¿¬®© ­  ¤¢ 
¯°¨¬¥°­® ° ¢­»µ ¯®¤¬­®¦¥±²¢ , § ²¥¬ °¥ª³°±¨¢­® ¨¹¥² ¢»¯³ª«³¾ ®¡®«®·ª³ ª ¦¤®£® ¨§ ­¨µ,   § ²¥¬ ®¡º¥¤¨­¿¥² ¤¢¥ ½²¨ ®¡®«®·ª¨
§  ¢°¥¬¿ O(n).
¥²®¤ ±²°¨¦ª¨ ¨ ¯®¨±ª  (prune-and-search method) ­ ¯®¬¨­ ¥²
 «£®°¨²¬ ¯®¨±ª  ¬¥¤¨ ­» ¢ ³¯®°¿¤®·¥­­®¬ ¬­®¦¥±²¢¥ §  «¨­¥©­®¥ ¢°¥¬¿ (° §¤¥« 10.3). ­ ­ µ®¤¨² À¢¥°µ­¾¾ ¶¥¯®·ª³Á ¢»¯³ª«®©
®¡®«®·ª¨, ¯®¢²®°­® ®²¡° ±»¢ ¿ ­¥ª®²®°³¾ ´¨ª±¨°®¢ ­­³¾ ¤®«¾
¢¥°¸¨­, ¯®ª  ­¥ ®±² ­³²±¿ ²®«¼ª® ¢¥°¸¨­» ¨§ ¢¥°µ­¥© ¶¥¯®·ª¨.
­ «®£¨·­»¬ ®¡° §®¬ ¨¹¥²±¿ ­¨¦­¿¿ ¶¥¯®·ª . ±¨¬¯²®²¨·¥±ª¨

806

« ¢  35 »·¨±«¨²¥«¼­ ¿ £¥®¬¥²°¨¿

35.7
 ¡®²  ¯°®¶¥¤³°» textscGraham-Scan ¤«¿ ¬­®¦¥±²¢  Q (°¨±. 35.6).
«¿ ª ¦¤®£® ¨§ ¸ £®¢ ²¥ª³¹¥¥ ±®¤¥°¦¨¬®¥ ±²¥ª  S ¯®ª § ­® ±¥°»¬.
(a) ®·ª¨ hp1 ; p2; :::pmi ®²±®°²¨°®¢ ­» ¯® ¯®«¿°­®¬³ ³£«³ ®²­®±¨²¥«¼­® p0; ¢ ±²¥ª¥ | ¯¥°¢»¥ ²°¨ ²®·ª¨ (p0; p1; p2).
(b) | (k) ²¥ª S ¯®±«¥ ®·¥°¥¤­®© ¨²¥° ¶¨¨ ¶¨ª«  for ( ±²°®ª¨
7 |10 ). ³­ª²¨°­»¬¨ «¨­¨¿¬¨ ¯®ª § ­» ¯®¢®°®²», ª®²®°»¥ ­¥
¿¢«¿¾²±¿ «¥¢»¬¨; ¢ ½²®¬ ±«³· ¥ ¢¥°¸¨­  ³£«  ¯®¢®°®²  ³¤ «¿¥²±¿
¨§ ±²¥ª .  ¯°¨¬¥°, ­  ½² ¯¥ (h) ¨§ ±²¥ª  ±­ · «  ³¤ «¿¥²±¿ ²®·ª  p8 (¯° ¢»© ¯®¢®°®² p7 p8 p9),   § ²¥¬ ²®·ª  p7 (¯° ¢»© ¯®¢®°®²
p6p7p9 ).
(l) ¥§³«¼² ² ° ¡®²»  «£®°¨²¬  | ¢»¯³ª« ¿ ®¡®«®·ª  | ±®¢¯ ¤ ¥² ± ¯°¨¢¥¤¥­­®© ­  °¨±. 35.6.
½²®² ¬¥²®¤ | ± ¬»© ¡»±²°»© ¨§ ¨§¢¥±²­»µ: ¥±«¨ ¢»¯³ª« ¿ ®¡®«®·ª  ±®¤¥°¦¨² h ¢¥°¸¨­, ²® ²°¥¡³¥²±¿ ¢°¥¬¿ O(n lg h).
»·¨±«¥­¨¥ ¢»¯³ª«®© ®¡®«®·ª¨ ¢ ¦­® ­¥ ²®«¼ª® ± ¬® ¯® ±¥¡¥.
­® ¨ ª ª ¯°®¬¥¦³²®·­»© ½² ¯ ¤«¿ ¬­®£¨µ § ¤ · ¢»·¨±«¨²¥«¼­®©
£¥®¬¥²°¨¨.  ±±¬®²°¨¬, ­ ¯°¨¬¥°, ¤¢³¬¥°­³¾ § ¤ ·³ ® ­ ¨¡®«¥¥
³¤ «¥­­»µ ²®·ª µ (farthest-pair problem): ¤ ­® ¬­®¦¥±²¢® ¨§ n ²®·¥ª ­  ¯«®±ª®±²¨; ­³¦­® ¢»¡° ²¼ ¯ °³ ¬ ª±¨¬ «¼­® ³¤ «¥­­»µ
¤°³£ ®² ¤°³£  ²®·¥ª. ®¦­® ¤®ª § ²¼, ·²® ½²¨ ²®·ª¨ ¡³¤³² ¢¥°¸¨­ ¬¨ ¢»¯³ª«®© ®¡®«®·ª¨ (³¯°. 35.3-3); ¤«¿ ¢»¯³ª«®£® n-³£®«¼­¨ª 
¬®¦­® ­ ©²¨ ¤¢¥ ­ ¨¡®«¥¥ ³¤ «¥­­»¥ ¢¥°¸¨­» §  ¢°¥¬¿ O(n) (¨¤¥¿:
§ ¦¨¬ ¥¬ ¥£® ¬¥¦¤³ ¤¢³¬¿ ¯ ° ««¥«¼­»¬¨ ¯°¿¬»¬¨ ¨ ¢° ¹ ¥¬).
¥¬ ± ¬»¬ ¬®¦­® ­ ©²¨ ¤¢¥ ­ ¨¡®«¥¥ ³¤ «¥­­»¥ (¨§ n) ²®·¥ª § 
¢°¥¬¿ O(n lg n).
°®±¬®²° °½µ¥¬ 
°®±¬®²° °½µ¥¬  ¨±¯®«¼§³¥² ±²¥ª S , ¢ ª®²®°®¬ µ° ­¿²±¿ ²®·ª¨. ¿¢«¿¾¹¨¥±¿ ª ­¤¨¤ ² ¬¨ ¢ ¢»¯³ª«³¾ ®¡®«®·ª³.  ¦¤ ¿ ²®·ª 
¨±µ®¤­®£® ¬­®¦¥±²¢  Q ¢ ­¥ª®²®°»© ¬®¬¥­² ¯®¬¥¹ ¥²±¿ ¢ ±²¥ª;
¥±«¨ ®­  ­¥ ¿¢«¿¥²±¿ ¢¥°¸¨­®© ¢»¯³ª«®© ®¡®«®·ª¨ CH (Q), ²® ·¥°¥§ ­¥ª®²®°®¥ ¢°¥¬¿ ²®·ª  ¡³¤¥² ³¤ «¥­  ¨§ ±²¥ª ,   ¥±«¨ ¿¢«¿¥²±¿
| ²® ®±² ­¥²±¿.  ¬®¬¥­² ®ª®­· ­¨¿ ° ¡®²»  «£®°¨²¬  ¢ ±²¥ª¥
S ­ µ®¤¿²±¿ ¢ ²®·­®±²¨ ¢±¥ ¢¥°¸¨­» ¢»¯³ª«®© ®¡®«®·ª¨ CH (Q) ¢
¯®°¿¤ª¥ ®¡µ®¤  ¯°®²¨¢ · ±®¢®© ±²°¥«ª¨.
±µ®¤­»¬¨ ¤ ­­»¬¨ ¤«¿ Graham-Scan ¿¢«¿¥²±¿ ¬­®¦¥±²¢®
Q ¨§ (­¥ ¬¥­¥¥ ·¥¬ ²°¥µ) ²®·¥ªr. °®¶¥¤³°  ¨±¯®«¼§³¥¬ ´³­ª¶¨¾ Top(S ), ª®²®° ¿ ¢®§¢° ¹ ¥² ²®·ª³, ­ µ®¤¿¹³¾±¿ ¢ ¢¥°¸¨­¥ ±²¥ª  S (­¥ ¬¥­¿¿ ±®¤¥°¦¨¬®£® ±²¥ª ),   ² ª¦¥ ´³­ª¶¨¾
Next-To-Top(S ), ª®²®° ¿ ¢®§¢° ¹ ¥² ±«¥¤³¾¹¨© §  ¢¥°¸¨­®©
½«¥¬¥­² ±²¥ª , ² ª¦¥ ­¥ ¬¥­¿¿ ±®¤¥°¦¨¬®£®. » ¤®ª ¦¥¬, ·²® ¯®
®ª®­· ­¨¨ ° ¡®²» ¢ ±²¥ª¥ (®² ¤­  ª ¢¥°¸¨­¥) ¨¤³² ª ª ° § ¢¥°¸¨­» CH (Q) (¢ ¯®°¿¤ª¥ ®¡µ®¤  ¯°®²¨¢ · ±®¢®© ±²°¥«ª¨).

®±²°®¥­¨¥ ¢»¯³ª«®© ®¡®«®·ª¨

807

Graham-Scan(Q)
1 ¯³±²¼ $p_0$ --- ²®·ª  ¨§ ¬­®¦¥±²¢  $Q$ ± ­ ¨¬¥­¼¸¥© ®°¤¨­ ²®©
(¥±«¨ ² ª®¢»µ ­¥±ª®«¼ª® --- ± ¬ ¿ «¥¢ ¿)
2 ¯³±²¼ $\langle p_1, p_2, ... p_m \rangle$ --- ®±² «¼­»¥ ²®·ª¨
¬­®¦¥±²¢  $Q$, ®²±®°²¨°®¢ ­­»¥ ¢ ¯®°¿¤ª¥ ¢®§° ±² ­¨¿
¯®«¿°­®£® ³£«  (¯°®²¨¢ · ±®¢®© ±²°¥«ª¨) ®²­®±¨²¥«¼­® ²®·ª¨
$p_0$ ±«¨ ¥±²¼ ­¥±ª®«¼ª® ²®·¥ª ± ®¤¨­ ª®¢»¬ ¯®«¿°­»¬ ³£«®¬,
²® ®±² ¢«¿¥¬ ²®«¼ª® ± ¬³¾ ³¤ «\"^^a5­­³¾ ®² $p_0$.
3 ±¤¥« ²¼ ±²¥ª $S$ ¯³±²»¬
4 $Push(S,p_0)$
5 $Push(S,p_1)$
6 $Push(S,p_2)$
7 \emph{for} $i\leftarrow 3 \emph{to} m$
8
\emph{do while} ¯°¨ ¤¢¨¦¥­¨¨ ¯® «®¬ ­®©
$Next-To-Top(S) \rightarrow Top(S) \rightarrow p_i$
¬» ¤¢¨£ ¥¬±¿ ¯°¿¬® ¨«¨ ­ ¯° ¢®
9
\emph{do} $Pop(S)$
10
$Push(S,p_i)$
11 \emph{return} $S$

  °¨±³­ª¥ 35.7 ¯®ª § ­» ¸ £¨ ¢»¯®«­¥­¨¿  «£®°¨²¬  GrahamScan.  ±²°®ª¥ 1 ¬» ­ µ®¤¨¬ ²®·ª³ p0 ; ¢±¥ ®±² «¼­»¥ ²®·ª¨ ¬­®¦¥±²¢  Q ­ µ®¤¿²±¿ ¢»¸¥ ­¥¥ (¨«¨ ­  ®¤­®¬ ³°®¢­¥, ­® ¯° ¢¥¥),
¨ ¯®²®¬³ ®­  § ¢¥¤®¬® ¾ ¢µ®¤¨² ¢ CH (Q).  ±²°®ª¥ 2 ®±² ¢¸¨¥±¿
²®·ª¨ ¬­®¦¥±²¢  Q ³¯®°¿¤®·¨¢ ¾²±¿ ¯®«¿°­®¬³ ³£«³ ®²­®±¨²¥«¼­® ²®·ª¨ p0.  ¦¤®¥ ±° ¢­¥­¨¥ ¬®¦­® ¢»¯®«­¨²¼ §  ¢°¥¬¿ O(1) ±
¯®¬®¹¼¾ ¯°®¨§¢¥¤¥­¨© (³¯°. 35.1-2); ¨§ ²®·¥ª ± ®¤¨­ ª®¢»¬ ³£«®¬
®±² ¥²±¿ ± ¬ ¿ ¤ «¼­¿¿ (®±² «¼­»¥ § ¢¥¤®¬® ­¥ ¯°¨­ ¤«¥¦ ² ¢»¯³ª«®© ®¡®«®·ª¥). ®«¿°­»© ³£«» ²®·¥ª ¬­®¦¥±²¢  Q ­ µ®¤¿²±¿ ¢
¯°¥¤¥« µ ¯°®¬¥¦³²ª  [0;  ).  ¬¥²¨¬, ·²® ²®·ª¨ p1 ¨ pm ¿¢«¿¾²±¿
¢¥°¸¨­ ¬¨ CH (Q) (³¯°. 35.3-1).
 ²¥¬ (±²°®ª¨ 3{6) ¬» ¯®¬¥¹ ¥¬ ¢ ±²¥ª ²°¨ ¯¥°¢»¥ ²®·ª¨
p0 ; p1; p2, ¯®±«¥ ·¥£® ¬®¦¥¬ ³²¢¥°¦¤ ²¼, ·²® ±²¥ª ±®¤¥°¦¨² ¢»¯³ª«³¾ ®¡®«®·ª³ ¬­®¦¥±²¢  p0 ; p1; : : : ; pk ¯°¨ k = 2. ²® ±¢®©±²¢®
¡³¤¥² ¯®¤¤¥°¦¨¢ ²¼±¿ ¨ ¢ ¤ «¼­¥©¸¥¬,   k ¡³¤¥² ° ±²¨, ¯®ª  ­¥
±² ­¥² ° ¢­»¬ m. °¨ ¤¢¨¦¥­¨¨ ®² ¤­  ±²¥ª  ª ¥£® ¢¥°¸¨­¥ ¬» ¢±¥
¢°¥¬¿ ¯®¢®° ·¨¢ ¥¬ ­ «¥¢®. ±«¨ ¯°®±²® ² ª ¤®¡ ¢¨²¼ ®·¥°¥¤­³¾
²®·ª³ ¢ ±²¥ª, ¬» ­ °³¸¨¬ ½²® ±¢®©±²¢®, ¯®½²®¬³ ¯°¥¤¢ °¨²¥«¼­®
¬» ¢»¡° ±»¢ ¥¬ ­¥±ª®«¼ª® ¢¥°µ­¨µ ¢¥°¸¨­ ±²¥ª .
¥®°¥¬  35.2 ( «£®°¨²¬ °½µ¥¬  ¯° ¢¨«¥­)
®±«¥ ¨±¯®«­¥­¨¿ ¯°®¶¥¤³°» Graham-Scan ¤«¿ ¬­®¦¥±²¢  ²®·¥ª Q, ±®¤¥°¦ ¹¥£® ¯® ¬¥­¼¸¥© ¬¥°¥ ²°¨ ²®·ª¨, ¢ ±²¥ª¥ S ±®¤¥°¦¨²±¿ ¢»¯³ª« ¿ ®¡®«®·ª  ¬­®¦¥±²¢  Q (¢ ¯®°¿¤ª¥ ®¡µ®¤  ¯°®²¨¢
· ±®¢®© ±²°¥«ª¨).
®ª § ²¥«¼±²¢®.
®-­ ±²®¿¹¥¬³ ±²°®£®¥ ¤®ª § ²¥«¼±²¢® ¢»µ®¤¨² §  ° ¬ª¨ ª­¨£¨

808

« ¢  35 »·¨±«¨²¥«¼­ ¿ £¥®¬¥²°¨¿

°¨±³­®ª ±®¢¯ ¤ ¥² ± 35.8 (b), ²®«¼ª® ­¥² ²®·ª¨ pi , ¯³­ª²¨°­»µ
«¨­¨© p0pi pj ¨ ±¥°®© ®¡« ±²¨
35.8 ±«¨ ²®·ª¨ p1 ; : : : ; pk ; pj ¨¤³² ¢ ¯®°¿¤ª¥ ¢®§° ±² ­¨¿ ¯®«¿°­»µ
³£«®¢ (®²­®±¨²¥«¼­® ²®·ª¨ p0 ), ª®²®°»¥ ¬¥­¿¾²±¿ ¢ ¯°®¬¥¦³²ª¥ ®²
[0;  ), ¨ ¯°¨ ¤¢¨¦¥­¨¨ ¯® «®¬ ­®© p0p1 : : :pk pj ¬» ¢ ª ¦¤®© ¢¥°¸¨­¥
¯®¢®° ·¨¢ ¥¬ ­ «¥¢®, ²® ¢»¯³ª«®© ®¡®«®·ª®© ²®·¥ª p0; p1; : : : ; pk ; pl
¡³¤¥² ¬­®£®³£®«¼­¨ª, ¢¥°¸¨­ ¬¨ ª®²®°®£® ¡³¤³² ¢±¥ ½²¨ ²®·ª¨,  
£° ­¨¶¥© ¡³¤¥² «®¬ ­ ¿ p0p1 : : :pk pj p0
[°¨±³­®ª ±®¢¯ ¤ ¥² ± 35.8 (a), ²®«¼ª® ¤®¡ ¢«¥­® ®¡®§­ ·¥­¨¥ p1 ¤«¿
²®·ª¨ °¿¤®¬ ± p0 ]
35.9 ±«¨ ²®·ª¨ p1; : : : ; pk ; pj ; pi ¨¤³² ¢ ¯®°¿¤ª¥ ¢®§° ±² ­¨¿ ¯®«¿°­»µ ³£«®¢ (®²­®±¨²¥«¼­® ²®·ª¨ p0), ª®²®°»¥ ¬¥­¿¾²±¿ ¢ ¯°®¬¥¦³²ª¥ ®² [0;  ), ¨ ¯°¨ ¤¢¨¦¥­¨¨ ¯® ¤¢³¬ ±®±¥¤­¨¬ ³· ±²ª ¬ pk pj pi
«®¬ ­®© p0 p1 : : :pk pj pi ¬» ¯®¢®° ·¨¢ ¥¬ ¢¯° ¢® ¨«¨ ¨¤¥¬ ¯°¿¬®, ²®
¢»¯³ª« ¿ ®¡®«®·ª  ²®·¥ª p1 ; : : : ; pk ; pj ; pi ­¥ ¨§¬¥­¨²±¿ ¯®±«¥ ³¤ «¥­¨¿ ²®·ª¨ pj (¯®±ª®«¼ª³ ®­  «¥¦¨² ¢­³²°¨ ²°¥³£®«¼­¨ª  p0pk pi).
(±²°®£®¥ ®¯°¥¤¥«¥­¨¥ ¢­³²°¥­­®±²¨ ¬­®£®³£®«¼­¨ª  | ³¦¥ ­¥¯°®±² ¿ § ¤ · ), ¯®½²®¬³ ¬» «¨¸¼ ³ª ¦¥¬ ¤¢  ­ £«¿¤­® ®·¥¢¨¤­»µ
´ ª² , ª®²®°»¥ £ ° ­²¨°³¾² ¯° ¢¨«¼­®±²¼  «£®°¨²¬ ; ®­¨ ¯®ª § ­» ­  °¨±. 35.8 ¨ 35.9
:   !!!
®ª ¦¥¬ ²¥¯¥°¼, ·²® ¢°¥¬¿ ° ¡®²»  «£®°¨²¬  Graham-Scan
¥±²¼ O(n lg n), £¤¥ n = jQj. ®°²¨°®¢ª  ³ª« ¤»¢ ¥²±¿ ¢ ½²¨ £° ­¨¶», ¥±«¨ ¨±¯®«¼§®¢ ²¼ ±®°²¨°®¢ª³ ±«¨¿­¨¥¬ ¨«¨ ± ¯®¬®¹¼¾ ª³·¨.
±² «¼­ ¿ · ±²¼  «£®°¨²¬  ²°¥¡³¥² ¢°¥¬¥­¨ O(n). ²® ­¥ ±° §³
®·¥¢¨¤­®, ¯®±ª®«¼ª³ ®·¥°¥¤­ ¿ ¨²¥° ¶¨¿ ¶¨ª«  for, ¯®¬¨¬® ¤®¡ ¢«¥­¨¿ ®¤­®© ­®¢®© ²®·ª¨, ¬®¦¥² ¯®²°¥¡®¢ ²¼ ³¤ «¥­¨¿ ­¥±ª®«¼ª¨µ (¨, ¢®§¬®¦­®, ¬­®£¨µ) ±² °»µ.
¥¬ ­¥ ¬¥­¥¥, ¬¥²®¤»  ¬®°²¨§ ¶¨®­­®£®  ­ «¨§  ¯®§¢®«¿¾² «¥£ª® ¤®ª § ²¼, ·²® ®¡¹¥¥ ·¨±«® ¤¥©±²¢¨© ¥±²¼ O(n).  ± ¬®¬ ¤¥«¥,
«¾¡ ¿ ²®·ª  pi ¤®¡ ¢«¿¥²±¿ ¢ ±²¥ª S ²®«¼ª® ®¤¨­ ° §,   ¯®²®¬³ ¨
³¤ «¿¥²±¿ ­¥ ¡®«¥¥ ®¤­®£® ° § . ¥¬ ± ¬»¬ ®¡¹¥¥ ¢°¥¬¿ ¨ ­  ¤®¡ ¢«¥­¨¥, ¨ ­  ³¤ «¥­¨¥ ¥±²¼ O(n). (­ «®£¨·­®¥ ° ±±³¦¤¥­¨¥ ¬»
¨±¯®«¼§®¢ «¨ ¢ ° §¤¥«¥ 18.1 ¯°¨  ­ «¨§¥ ¯°®¶¥¤³°» Multipop.)
°®µ®¤ ¦ °¢¨± 
°®µ®¤ ¦ °¢¨±  ¢»·¨±«¿¥² ¢»¯³ª«³¾ ®¡®«®·ª³ ¬­®¦¥±²¢  ²®·¥ª Q ¯°¨ ¯®¬®¹¨ À§ ¢®° ·¨¢ ­¨¿Á (package wrapping, gift wrapping). «£®°¨²¬ ²°¥¡³¥² ¢°¥¬¥­¨ O(nh), £¤¥ h | ·¨±«® ¢¥°¸¨­
¢»¯³ª«®© ®¡®«®·ª¨. ®½²®¬³, ¤«¿ ª« ±±  § ¤ ·, £¤¥ h ¥±²¼ o(lg n),
¯°®µ®¤ ¦ °¢¨±   ±¨¬¯²®²¨·¥±ª¨ ¡»±²°¥¥ ¯°®±¬®²°  °½µ¥¬ .
¤¥¿  «£®°¨²¬  ² ª®¢ : ¬» µ®²¨¬ ®¡¢¿§ ²¼ ­ ¸¨ £¢®§¤¨
¢¥°¥¢ª®©. ®­¥¶ ¢¥°¥¢ª¨ ¯°¨ª°¥¯¨¬ ª ­¨¦­¥¬³ £¢®§¤¾ p0 (ª®²®° ¿ ¢»¡¨° ¥²±¿ ª ª ¨ ¢ ¯°¥¤»¤³¹¥¬  «£®°¨²¬¥), ¨ ¯³±²¨¬
¢¥°¥¢ª³ ¢¯° ¢®.  ²¥¬ ¡³¤¥¬ ¯®¤­¨¬ ²¼ ¯° ¢»© ª®­¥¶ ¢¥°¥¢ª¨,

®±²°®¥­¨¥ ¢»¯³ª«®© ®¡®«®·ª¨

809

¯®ª  ®­  ­¥ ª®±­¥²±¿ ­¥ª®²®°®£® £¢®§¤¿ p1 .  «¼¸¥ ¬» ¢° ¹ ¥¬
¢¥°¥¢ª³ ³¦¥ ®²­®±¨²¥«¼­® p1 , ¯®ª  ®­  ­¥ ª®±­¥²±¿ ±«¥¤³¾¥¹¥£®
£¢®§¤¿ p2.  ª ¯°®¤®«¦ ¥²±¿, ¯®ª  ¢¥°¥¢ª  ­¥ ¤®©¤¥² ¤® ¨±µ®¤­®©
²®·ª¨ p0.
®«¥¥ ´®°¬ «¼­®, ¯®±«¥¤®¢ ²¥«¼­®±²¼ ²®·¥ª H = hp0; p1; : : : ; ph ;
1i, ¿¢«¿¾¹¨µ±¿ ¢¥°¸¨­ ¬¨ CH (Q), ±²°®¨²±¿ ² ª. » ­ ·¨­ ¥¬
± ²®·ª¨ p0. «¥¤³¾¹ ¿ ²®·ª  p1 ¨¬¥¥² ­ ¨¬¥­¼¸¨© (±°¥¤¨ ¢±¥µ
²®·¥ª ¬­®¦¥±²¢  Q) ¯®«¿°­»© ³£®« ®²­®±¨²¥«¼­® p0 (±¬. °¨±. 35.10)
(±«¨ ² ª®¢»µ ­¥±ª®«¼ª®, ¢»¡¨° ¥¬ ± ¬³¾ ¤ «¥ª³¾.)  ²¥¬ ¬»,
±²®¿ ¢ ²®·ª¥ p1 , ±° ¢­¨¢ ¥¬ ¯®«¿°­»¥ ³£«» ¢±¥µ ²®·¥ª ¨ ¢»¡¨° ¥¬
²®·ª³ p2 ± ­ ¨¬¥­¼¸¨¬ ¯®«¿°­»¬ ³£«®¬ (®²­®±¨²¥«¼­® p1), ¨ ² ª
¤ «¥¥.  ª ª®©-²® ¬®¬¥­² ¬» ¤®©¤¥¬ ¤® ¢¥°µ­¥© ²®·ª¨ (²®·ª¨ ±
­ ¨¡®«¼¸¥© ®°¤¨­ ²®©), ¯®±«¥ ·¥£® ¯°®¶¥±± ¯°®¤®«¦¨²±¿, ²®«¼ª®
²¥¯¥°¼ ­ ¤® ®²±·¨²»¢ ²¼ ¯®«¿°­»¥ ³£«» ®² «³· , ­ ¯° ¢«¥­­®£®
¢«¥¢®,   ­¥ ¢¯° ¢®. ¥¬ ± ¬»¬ ¬» ¯®±²°®¨¬ ±­ · «  (¤® ¢¥°µ­¥©
²®·ª¨) ¯° ¢³¾ ¶¥¯¼ (right chain) ¢»¯³ª«®© ®¡®«®·ª¨,   § ²¥¬ «¥¢³¾
¶¥¯¼ (°¨±. 35.10)
  ± ¬®¬ ¤¥«¥ ¬®¦­® ¡»«® ¡» ®¡®©²¨±¼ ¡¥§ ¢»¤¥«¥­¨¿ ¯° ¢®© ¨
«¥¢®© ¶¥¯¨. «¿ ½²®£® ¬®¦­® ®¡»·­® µ° ­¨²¼ ­ ¯° ¢«¥­¨¥ ¯®±«¥¤­¥© ­ ©¤¥­­®© ±²®°®­» ¨ ¢»¡¨° ²¼ ²®·ª³ ± ¡«¨¦ ©¸¨¬ (¢ ¯®«®¦¨²¥«¼­³¾ ±²®°®­³) ­ ¯° ¢«¥­¨¥¬ «³· . ¯°®·¥¬, ¢ ½²®¬ ±«³· ¥ ­¥±ª®«¼ª® ±«®¦­¥¥ ±° ¢­¨¢ ²¼ ³£«» (¯°¨ ¨±¯®«¼§®¢ ­¨¨ «¥¢®© ¨ ¯° ¢®© ¶¥¯¨ ±° ¢­¥­¨¥ ³£«®¢ ¬®¦­® ¯°®¨§¢¥±²¨ ± ¯®¬®¹¼¾ ¯°¨¥¬®¢
° §¤¥«  35.1, ­¥ ¢»·¨±«¿¿ ¨µ ¿¢­®.
°¨ ¥±²¥±²¢¥­­®© °¥ «¨§ ¶¨¨ ¯°®µ®¤ ¦ °¢¨±  ¢»¯®«­¿¥²±¿ § 
¢°¥¬¿ O(nh). «¿ ª ¦¤®© ¢¥°¸¨­» h ¢»¯³ª«®© ®¡®«®·ª¨ CH (Q)
¬» ¨¹¥¬ ¢¥°¸¨­³ ± ¬¨­¨¬ «¼­»¬ ¯®«¿°­»¬ ³£«®¬.  ¦¤®¥ ±° ¢­¥­¨¥ ³£«®¢ ¢»¯®«­¿¥²±¿ §  ¢°¥¬¿ O(1) (¯°¨ ½²®¬ ¬®¦­® ®¡®©²¨±¼
¡¥§ ²°¨£®­®¬¥²°¨¨, ¨±¯®«¼§®¢ ¢ ¯°¨¥¬» ° §¤. 35.1), ² ª ·²® ¯®¨±ª
¬¨­¨¬³¬  ²°¥¡³¥² ¢°¥¬¥­¨ O(n) (° §¤. 10.1). ¡¹¥¥ ¢°¥¬¿, ¡³¤¥²,
² ª¨¬ ®¡° §®¬, O(nh).
¯° ¦­¥­¨¿
35.3-1
®ª ¦¨²¥, ·²® ²®·ª¨ p1 ¨ pm ¢ ¯°®¶¥¤³°¥ Graham-Scan ®ª ¦³²±¿ ¢¥°¸¨­ ¬¨ CH (Q).
35.3-2
³¤¥¬ ±·¨² ²¼, ·²® ±«®¦¥­¨¥, ³¬­®¦¥­¨¥ ¨ ±° ¢­¥­¨¥ ¢»¯®«­¿¾²±¿ §  ¢°¥¬¿ O(1). ®ª ¦¨²¥, ·²® ¥±«¨ ¬» ³¬¥¥¬ ­ µ®¤¨²¼ ¢»¯³ª«³¾ ®¡®«®·ª³ n ²®·¥ª (¢¥°¸¨­» ª®²®°®© ²°¥¡³¥²±¿ ³ª § ²¼ ¢
¯®°¿¤ª¥ ®¡µ®¤  ¯°®²¨¢ · ±®¢®© ±²°¥«ª¨) ¡»±²°¥¥ ·¥¬ §  
(n lg n)
¸ £®¢, ²® ¬®¦­® ®²±®°²¨°®¢ ²¼ n ·¨±¥« ¡»±²°¥¥ ·¥¬ §  
(n lg n)
¸ £®¢.
35.3-3
 ¬­®¦¥±²¢¥ ²®·¥ª Q ¢®§¼¬¥¬ ¤¢¥ ­ ¨¡®«¥¥ ³¤ «¥­­»¥ ¤°³£ ®²
¤°³£  ²®·ª¨. ®ª ¦¨²¥, ·²® ®¡¥ ®­¨ ¿¢«¿¾²±¿ ¢¥°¸¨­ ¬¨ ¢»¯³ª«®© ®¡®«®·ª¨.

810

« ¢  35 »·¨±«¨²¥«¼­ ¿ £¥®¬¥²°¨¿

35.11
( ³¯°. 35.3-4)
(a) ¢¥§¤­»© ¬­®£®³£®«¼­¨ª: ¨§ ²®·ª¨ p ¢¨¤­  «¾¡ ¿ ²®·ª  ¥£®
£° ­¨¶».
(b) ­®£®³£®«¼­¨ª, ­¥ ¿¢«¿¾¹¨©±¿ §¢¥§¤­»¬. «¥¢  § ª° ¸¥­ 
²¥­¼ ²®·ª¨ q , ±¯° ¢  | ²¥­¼ ²®·ª¨ q 0. ¤°® ¯³±²®, ² ª ª ª ½²¨
®¡« ±²¨ ­¥ ¯¥°¥±¥ª ¾²±¿.
35-3.4
³±²¼ ¤ ­» ¬­®£®³£®«¼­¨ª P ¨ ²®·ª  q ­  ¥£® £° ­¨¶¥. ¥­¼¾
(shadow) ²®·ª¨ q ­ §»¢ ¥²±¿ ¬­®¦¥±²¢® ¢±¥µ ²®·¥ª r, ¤«¿ ª®²®°»µ
·²® ®²°¥§®ª qr ­¥ ¢»µ®¤¨² §  ¯°¥¤¥«» ¬­®£®³£®«¼­¨ª  P . ­®£®³£®«¼­¨ª P ­ §»¢ ¥²±¿ §¢¥§¤­»¬ (star-shaped), ¥±«¨ ¢­³²°¨ ­¥£®
¥±²¼ ²®·ª  p, ¨§ ª®²®°®© ¢¨¤­  ¢±¿ ¥£® £° ­¨¶  (¤°³£¨¬¨ ±«®¢ ¬¨, p
¯°¨­ ¤«¥¦¨² ²¥­¨ «¾¡®© ²®·ª¨ £° ­¨¶» ¬­®£®³£®«¼­¨ª  P ). ­®¦¥±²¢® ¢±¥µ ² ª¨µ ²®·¥ª p ­ §»¢ ¥²±¿ ¿¤°®¬ (kernel) ¬­®£®³£®«¼­¨ª  P (±¬. °¨±. 35.11).  ­» ¢¥°¸¨­» §¢/§¤­®£® n-³£®«¼­¨ª  P ,
¯¥°¥·¨±«¥­­»¥ ¢ ¯®°¿¤ª¥ ®¡µ®¤  £° ­¨¶» ¯°®²¨¢ · ±®¢®© ±²°¥«ª¨.
®ª ¦¨²¥, ª ª ¬®¦­® ­ ©²¨ CH (P ) §  ¢°¥¬¿ O(n).
35.3-5
 ¤ ·  ®¡ ®²»±ª ­¨¨ ¢»¯³ª«®© ®¡®«®·ª¨ ¬­®¦¥±²¢  Q ¢ °¥¦¨¬¥ Àon-lineÁ (on-line convex-hull problem) ±®±²®¨² ¢ ±«¥¤³¾¹¥¬: ­ ¬
¤ ¾² n ²®·¥ª ®¤­³ §  ¤°³£®©; ¢ ª ¦¤»© ¬®¬¥­² ¢°¥¬¥­¨ ¬» ¤®«¦­» ³ª § ²¼ ¢»¯³ª«³¾ ®¡®«®·ª³ ¢±¥µ ²®·¥ª, ¯®«³·¥­­»µ ª ½²®¬³
¬®¬¥­²³. ®¦­® ¯°¨¬¥­¨²¼ ¯°®µ®¤ °½µ¥¬  ­  ª ¦¤®¬ ¸ £¥ § ­®¢®, ¨ ²®£¤  ®¡¹¥¥ ¢°¥¬¿ ° ¡®²»  «£®°¨²¬  ¡³¤¥² ° ¢­® O(n2 lg n).
°¨¤³¬ ©²¥  «£®°¨²¬, ²°¥¡³¾¹¨© ¢°¥¬¥­¨ O(n2).
35.3-6*
±¯®«¼§³¿ ¯°®±¬®²° ²®·¥ª ±«¥¢  ­ ¯° ¢®, ­ ©¤¨²¥ ¢»¯³ª«³¾
®¡®«®·ª³ n ²®·¥ª §  ¢°¥¬¿ O(n lg n).

35.4. ²»±ª ­¨¥ ¯ °» ¡«¨¦ ©¸¨µ ²®·¥ª
³±²¼ ²¥¯¥°¼ ­ ¬ ­ ¤® ­ ©²¨ ±°¥¤¨ n 6 2 ²®·¥ª ¬­®¦¥±²¢  Q
¯ °³ ¡«¨¦ ©¸¨µ ¤°³£ ª ¤°³£³ ²®·¥ª.  ±±²®¿­¨¥ ¬¥¦¤³ ²®·ª ¬¨
¯®­¨¬ ¥²±¿ ¢ ®¡»·­®¬ ±¬»±«¥:
²®·ª¨ p1 = (x1 ; y1) ¨ p2 = (x2; y2)
p
­ µ®¤¿²±¿ ­  ° ±±²®¿­¨¨ (x1 ; x2)2 + (y1 ; y2 )2 .
®®¡¹¥ £®¢®°¿, ¤¢¥ ²®·ª¨ ¬®£³² ±®¢¯ ¤ ²¼ (²®£¤  ° ±±²®¿­¨¥
¬¥¦¤³ ­¨¬¨ ° ¢­® 0).  ª ¿ § ¤ ·  ¬®¦¥² ¢®§­¨ª­³²¼, ­ ¯°¨¬¥°,
¢ ±¨±²¥¬ µ ª®­²°®«¿ §  ²° ­±¯®°²®¬: ¯®«¥§­® §­ ²¼, ª ª¨¥ ¤¢ 
²° ­±¯®°²­»µ ±°¥¤±²¢  ¡«¨¦¥ ¢±¥£® ¤°³£ ª ¤°³£³ (°¨±ª ±²®«ª­®¢¥­¨¿)
±«¨ ¨±ª ²¼ ¯ °³ ¡«¨¦ ©¸¨µ ²®·¥ª À¢ «®¡Á, ­ ¤® ¯¥°¥¡° ²¼ ¢±¥
Cn2 = (n2 ) ¯ °» ²®·¥ª.  ½²®¬ ° §¤¥«¥ ¬» ± ¯®¬®¹¼¾ ¬¥²®¤ 

²»±ª ­¨¥ ¯ °» ¡«¨¦ ©¸¨µ ²®·¥ª

811

À° §¤¥«¿© ¨ ¢« ±²¢³©Á ¯®±²°®¨¬  «£®°¨²¬, ¢°¥¬¿ ° ¡®²» ª®²®°®£®
®¯¨±»¢ ¥²±¿ °¥ª³°°¥­²­»¬ ±®®²­®¸¥­¨¥¬ T (n) = 2T (n=2) + O(n),
².¥. ° ¢­® O(n lg n).
¥²®¤ À° §¤¥«¿© ¨ ¢« ±²¢³©Á ¤«¿ ®²»±ª ­¨¿ ¡«¨¦ ©¸¨µ ²®·¥ª.
µ®¤­»¥ ¤ ­­»¥ ª ¦¤®£® °¥ª³°±¨¢­®£® ¢»§®¢   «£®°¨²¬  ±®±²®¿² ¨§ ¯®¤¬­®¦¥±²¢® P  Q ¨ ¤¢³µ ¬ ±±¨¢» X ¨ Y .  ¦¤»© ¨§ ¬ ±±¨¢®¢ ±®¤¥°¦¨² ²®·ª¨ ¯®¤¬­®¦¥±²¢  p, ­® ¯®°¿¤®ª ¢ ­¨µ ° §­»©:
¢ ¬ ±±¨¢¥ X ²®·ª¨ ° ±¯®«®¦¥­» ¢ ¯®°¿¤ª¥ ¢®§° ±² ­¨¿  ¡±¶¨±±,
  ¢ ¬ ±±¨¢¥ Y | ¢ ¯®°¿¤ª¥ ¢®§° ±² ­¨¿ ®°¤¨­ ².  ¬¥²¨¬, ·²®
¬» ­¥ ¬®¦¥¬ ¯®§¢®«¨²¼ ±¥¡¥ ±®°²¨°®¢ ²¼ ²®·ª¨ ¯°¨ ª ¦¤®¬ ¢»§®¢¥, ² ª ª ª ¢ ½²®¬ ±«³· ¥ ¯®«³·¨²±¿ ±®®²­®¸¥­¨¥ (ª ª ¬¨­¨¬³¬)
T (n) = 2T (n=2) + O(n lg n), ².¥. T (n) = O(n ln2 n). (» ³¢¨¤¨¬, ª ª
½²³ ²°³¤­®±²¼ ¬®¦­® ®¡®©²¨ ± ¯®¬®¹¼¾ À¯°¥¤±®°²¨°®¢ª¨Á.
² ª, ¯³±²¼ ¬» ¯®«³·¨«¨ P ,X ¨ Y . ±«¨ jP j 6 3, ¯¥°¥¡¨° ¥¬
¢±¥ ¯ °» ²®·¥ª (¬ ª±¨¬³¬ ²°¨) ¨ ±° ¢­¨¢ ¥¬ ° ±±²®¿­¨¥. ±«¨ ¦¥
jP j > 3, ¬» ¯®±²³¯ ¥¬ ² ª:
 §¤¥«¿© (divide):  µ®¤¨¬ ¢¥°²¨ª «¼­³¾ ¯°¿¬³¾ l, ª®²®° ¿ ¤¥«¨² ¬­®¦¥±²¢® P ­  ¤¢  ¯®¤¬­®¦¥±²¢  PL ¨ PR ¯®«®¢¨­­®£® ° §¬¥°  (jPL j = djP j=2e, jPRj = bjP j=2c; ²®·ª¨, «¥¦ ¹¨¥ ­  ¯°¿¬®© l,
ª ª-²® ¯®¤¥«¥­» ¬¥¦¤³ PL ¨ PR ).  ±±¨¢ X ¤¥«¨¬ ­  ¬ ±±¨¢» XL ¨
XR , ±®¤¥°¦ ¹¨¥ ²®·ª¨ ¯®¤¬­®¦¥±²¢ PL ¨ PR (±®µ° ­¿¿ ¯®°¿¤®ª);
¬ ±±¨¢ Y ¤¥«¨²±¿ ­  ¬ ±±¨¢» YL ¨ YR  ­ «®£¨·­»¬ ®¡° §®¬.
« ±²¢³© (conquer): ®±«¥ ¤¥«¥­¨¿ P ­  PL ¨ PR , ¢»¯®«­¿¥¬
¤¢  °¥ª³°±¨¢­»µ ¢»§®¢  ¨ ­ µ®¤¨¬ ¯ °³ ¡«¨¦ ©¸¨µ ²®·¥ª ¢ ¬­®¦¥±²¢¥ PL (¢µ®¤­»¥ ¤ ­­»¥ ½²®£® ¢»§®¢  | ¯®¤¬­®¦¥±²¢® PL ¨
¬ ±±¨¢» XL ¨ YL ),   ² ª¦¥ ¯ °³ ¡«¨¦ ©¸¨µ ²®·¥ª ¢ ¬­®¦¥±²¢¥
PR (¢µ®¤­»¥ ¤ ­­»¥ | PR , XR ¨ YR ). ¡®§­ ·¨¬ ° ±±²®¿­¨¿ ¬¥¦¤³ ¡«¨¦ ©¸¨¬¨ ²®·ª ¬¨ ¢ ¯®¤¬­®¦¥±²¢ PL ¨ PR ·¥°¥§ L ¨ R .
®«®¦¨¬  = min(L ; deltaR).
®¥¤¨­¿© (combine): «¿ ¢±¥£® ¬­®¦¥±²¢  P ¯ °®© ¡«¨¦ ©¸¨µ
²®·¥ª ¿¢«¿¥²±¿ «¨¡® ®¤­  ¨§ ­ ©¤¥­­»µ ¯ ° ²®·¥ª (° ±±²®¿­¨¥  ),
«¨¡® ­¥ª®²®° ¿ À¯°¨£° ­¨·­ ¿Á ¯ °  ²®·¥ª, ¢ ª®²®°®© ®¤­  ²®·ª  ¯°¨­ ¤«¥¦¨² ¬­®¦¥±²¢³ PL ,   ¤°³£ ¿ | PR (¥±«¨ ±°¥¤¨ ² ª¨µ
¯ ° ¥±²¼ ¯ °  ± ° ±±²®¿­¨¥¬ ¬¥­¼¸¥  ). ·¥¢¨¤­®, ·²® ²®·ª¨ ² ª®© ¯°¨£° ­¨·­®© ¯ °» ®²±²®¿² ®² ¯°¿¬®© l ­¥ ¡®«¥¥, ·¥¬ ­   ,
².¥. ­ µ®¤¿²±¿ ¢ ±¨¬¬¥²°¨·­®© ®²­®±¨²¥«¼­® l ¢¥°²¨ª «¼­®© ¯®£° ­¨·­®© ¯®«®±¥ ¸¨°¨­®© 2 (°¨±. 35.12 (a)). ²®¡» ­ ©²¨ ² ª³¾
¯°¨£° ­¨·­³¾ ¯ °³, ¥±«¨ ®­  ±³¹¥±²¢³¥², ¯°®¤¥« ¥¬ ±«¥¤³¾¹¥¥.
1. ®§¤ ¤¨¬ ¬ ±±¨¢ Y 0, ¯®¬¥±²¨¢ ¢ ­¥£® ¢±¥ ²®·ª¨ ¨§ ¬ ±±¨¢  Y ,
ª®²®°»¥ ¯®¯ ¤ ¾² ¢ ¯®£° ­¨·­³¾ ¯®«®±³ (± ²®© ¨«¨ ¨­®© ±²®°®­» ®² ¯°¿¬®© l). (®°¿¤®ª ±®µ° ­¿¥¬: ¬ ±±¨¢ Y 0 ®²±®°²¨°®¢ ­ ¯®
®°¤¨­ ² ¬ ²®·¥ª.)
2. «¿ ª ¦¤®© ²®·ª¨ p ¬ ±±¨¢  Y 0 ¨¹¥¬ ² ª¨¥ ²®·ª¨ ¬ ±±¨¢  Y 0 ,
ª®²®°»¥ ³¤ «¥­» ®² p ­¥ ¡®«¥¥, ·¥¬ ­   .  ª ¬» ¢±ª®°¥ ³¢¨¤¨¬,
¤®±² ²®·­® ° ±±¬®²°¥²¼ ²®«¼ª® 7 ±®±¥¤­¨µ (¢ ¯®°¿¤ª¥ ¢®§° ±² ­¨¿ ®°¤¨­ ²) ²®·¥ª ¢ ¬ ±±¨¢¥ Y 0 . » ¢»·¨±«¿¥¬ ° ±±²®¿­¨¥ ®² p

812

« ¢  35 »·¨±«¨²¥«¼­ ¿ £¥®¬¥²°¨¿

¤® ª ¦¤®© ¨§ ½²¨µ 7 ²®·¥ª. »¯®«­¨¢ ½²® ¤«¿ ¢±¥µ ²®·¥ª p ¨§ Y 0 ,
­ µ®¤¨¬  0 | ° ±±²®¿­¨¥ ¬¥¦¤³ ²®·ª ¬¨ ¬ ±±¨¢  Y 0, ° ±¯®«®¦¥­­»¬¨ ¡«¨¦¥ ¢±¥£® ¤°³£ ª ¤°³£³.
3. ±«¨  0 <  , ²® ¯ °  ¡«¨¦ ©¸¨µ ²®·¥ª ­ µ®¤¨²±¿ ¢­³²°¨ ¢¥°²¨ª «¼­®© ¯®«®±» ¨ ¬» ¢®§¢° ¹ ¥¬ ½²³ ¯ °³ ²®·¥ª ¨ ° ±±²®¿­¨¥
0 .  ¯°®²¨¢­®¬ ±«³· ¥ ¬» ¢®§¢° ¹ ¥¬ ¯ °³, ­ ©¤¥­­³¾ ¯°¨ ®¤­®¬
¨§ °¥ª³°±¨¢­»µ ¢»§®¢®¢, ¨ ° ±±²®¿­¨¥  .
¥©· ± ¬» ¤®ª ¦¥¬ ¯° ¢¨«¼­®±²¼ ½²®£®  «£®°¨²¬ ,   § ²¥¬ ®¡±³¤¨¬ ¤¥² «¨ ¥£® °¥ «¨§ ¶¨¨ (­¥®¡µ®¤¨¬»¥, ·²®¡» ³«®¦¨²¼±¿ ¢
O(n lg n) ¤¥©±²¢¨©.
° ¢¨«¼­®±²¼  «£®°¨²¬ 
³¦­® ¯®­¿²¼ «¨¸¼, ¯®·¥¬³ ¤®±² ²®·­® ±° ¢­¨¢ ²¼ ª ¦¤³¾
²®·ª³ ¯®«®±» «¨¸¼ ± ±¥¬¼¾ ±«¥¤³¾¹¨¬¨ §  ­¥© (¢ ¯®°¿¤ª¥ ¢®§° ±² ­¨¿ ®°¤¨­ ²»). ¥©· ± ¬» ¢ ½²®¬ ³¡¥¤¨¬±¿.
³±²¼ (¯°¨ ­¥ª®²®°®¬ ¢»§®¢¥) ¡«¨¦ ©¸¥© ¯ °®© ²®·¥ª ¿¢«¿¥²±¿
¯ °  ¨§ ²®·¥ª pL 2 PL ¨ pR 2 PR (°¨±. 35.12 (a)), ¨ ° ±±²®¿­¨¥  0
¬¥¦¤³ ½²¨¬¨ ²®·ª ¬¨ ±²°®£® ¬¥­¼¸¥  . ®·ª  pL ¤®«¦­  ­ µ®¤¨²¼±¿ ±«¥¢  ®² l ­  ° ±±²®¿­¨¨ ­¥ ¡®«¥¥  (¨«¨ ­  ± ¬®© ¯°¿¬®©); pR |
±¯° ¢  ­  ° ±±²®¿­¨¨ ­¥ ¡®«¼¸¥¬  (¨«¨ ­  ¯°¿¬®©). °®¬¥ ²®£®,
° ±±²®¿­¨¥ ¯® ¢¥°²¨ª «¨ ¬¥¦¤³ pL ¨ pR ² ª¦¥ ­¥ ¯°¥¢®±µ®¤¨²  .
«¥¤®¢ ²¥«¼­® (°¨±. 35.12 (a)), ²®·ª¨ pL ¨ pR ¬®¦­® ¯®¬¥±²¨²¼ ¢
¯°¿¬®³£®«¼­¨ª ° §¬¥°    2 , ±¨¬¬¥²°¨·­®© ®²­®±¨²¥«¼­® ¯°¿¬®©
l. (®­¥·­®, ¢ ­¥£® ¬®£³² ¯®¯ ±²¼ ¨ ¤°³£¨¥ ²®·ª¨.)
®ª ¦¥¬ ²¥¯¥°¼, ·²® ¢­³²°¨ ½²®£® ¯°¿¬®³£®«¼­¨ª  ¬®¦¥² ¡»²¼
­¥ ¡®«¥¥ 8 ²®·¥ª ¨§ ¬­®¦¥±²¢  P .  ±±¬®²°¨¬ ¥£® «¥¢³¾ ¯®«®¢¨­³
| ª¢ ¤° ²    . ±¥ ²®·ª¨ ¨§ PL ­ µ®¤¿²±¿ ­  ° ±±²®¿­¨¨ ­¥ ¬¥­¥¥
 ¤°³£ ®² ¤°³£ , ¯®½²®¬³ ¢ ½²®¬ ª¢ ¤° ²¥ ¬®¦¥² ¡»²¼ ¬ ª±¨¬³¬
4 ² ª¨µ ²®·ª¨ (¢ ª ¦¤®© ¥£® ·¥²¢¥°²¨­ª¥ ¬®¦¥² ¡»²¼ ­¥ ¡®«¥¥ ®¤­®© ²®·ª¨), ±¬. °¨±. 35.12 (b).  ¯° ¢®© ¯®«®¢¨­¥ ¯°¿¬®³£®«¼­¨ª 
(­¥ ±·¨² ¿ £° ­¨¶») ²®·¥ª ¨§ PL ¡»²¼ ­¥ ¬®¦¥², ² ª ·²® ¢±¥£® ¢
¯°¿¬®³£®«¼­¨ª¥ ­¥ ¡®«¥¥ 4 ²®·¥ª ¨§ PL . ®  ­ «®£¨·­»¬ ¯°¨·¨­ ¬
² ¬ ­¥ ¡®«¥¥ 4 ²®·¥ª ¨§ PR .  ¬¥²¨¬, ·²® ±«³· © 8 ²®·¥ª ¤¥©±²¢¨²¥«¼­® ¢®§¬®¦¥­: ·¥²»°¥ ²®·ª¨ ¨§ PL ¬®£³² ¡»²¼ ¢ ³£« µ «¥¢®£®
ª¢ ¤° ² ,   ·¥²»°¥ ²®·ª¨ ¨§ PR | ¢ ³£« µ ¯° ¢®£® (¤¢¥ ²®·ª¨ ¡³¤³² ®¡¹¨¬¨ ¤«¿ PL ¨ PR ).   ¥¯¥°¼ ¿±­®, ·²® ·²® ¤«¿ ª ¦¤®© ²®·ª¨
¤®±² ²®·­® ¯°®¢¥°¨²¼ 7 ²®·¥ª, ­¥¯®±°¥¤±²¢¥­­® ±«¥¤³¾¹¨µ §  ­¥©
¢ ¬ ±±¨¢¥ Y 0 : ¥±«¨ ¬¥¦¤³ ¤¢³¬¿ ¡«¨¦ ©¸¨¬¨ ²®·ª ¬¨ ¥±²¼ ¥¹¥ 7
¯°®¬¥¦³²®·­»µ (¢ ¯®°¿¤ª¥ ¢®§° ±² ­¨¿ ®°¤¨­ ²), ²® ¢±¥ 9 ²®·¥ª
¯®¯ ¤³² ¢­³²°¼ ¯°¿¬®³£®«¼­¨ª ,   ½²®£® ¡»²¼ ­¥ ¬®¦¥², ª ª ¬»
¢¨¤¥«¨.
¥² «¨ °¥ «¨§ ¶¨¨ ¨ ¢°¥¬¿ ° ¡®²»  «£®°¨²¬ .
 ¸  ¶¥«¼ | ¯®«³·¨²¼ ¤«¿ ¢°¥¬¥­¨ ° ¡®²»  «£®°¨²¬  °¥ª³°°¥­²­®¥ ±®®²­®¸¥­¨¥ T (n) = 2T (n=2) + O(n) (§¤¥±¼ T (n) | ¢°¥¬¿
®¡° ¡®²ª¨ n ²®·¥ª). ²®¡» ½²®£® ¤®±²¨·¼, ¬» ¤®«¦­» ¯°¥¤¯®« £ ²¼, ·²® ¢µ®¤­»¥ ¬ ±±¨¢» X ¨ Y ®²±®°²¨°®¢ ­» ¯®  ¡±¶¨±±¥ ¨
®°¤¨­ ²¥ ±®®²¢¥²±²¢¥­­® (²®£¤  ° §¤¥«¨²¼ ¬­®¦¥±²¢® ­  «¥¢³¾ ¨

 ¤ ·¨

813

¯° ¢³¾ ¯®«®¢¨­» ¬®¦­® §  «¨­¥©­®¥ ¢°¥¬¿). ®®²¢¥²±²¢¥­­® ¬»
®¡¿§ ­» ¯°¨ °¥ª³°±¨¢­®¬ ¢»§®¢¥ ¯¥°¥¤ ¢ ²¼ ¬­®¦¥±²¢  PL ¨ PR
¢ ®²±®°²¨°®¢ ­­®¬ ¢¨¤¥. ±­®, ·²® ½²® ­¥²°³¤­® ±¤¥« ²¼, ¯°®µ®¤¿
¬ ±±¨¢ ®² ­ · «  ª ª®­¶³ ¨ ° ±ª« ¤»¢ ¿ ¥£® ½«¥¬¥­²» ­  ¤¢¥ £°³¯¯».  ­¥ª®²®°®¬ ±¬»±«¥ ½²® ¤¥©±²¢¨¥ ®¡° ²­® ¢ ¯°®¶¥¤³°¥ Merge,
¨±¯®«¼§®¢ ­­®© ¯°¨ ±®°²¨°®¢ª¥ ±«¨¿­¨¥¬ (° §¤¥« 1.3.1).
±² «®±¼ § ¬¥²¨²¼, ·²® ­ · «¼­ ¿ ±®°²¨°®¢ª  (presorting) ¢»¯®«­¿¥²±¿ ¢±¥£® ®¤¨­ ° § ¨ ¯®²®¬³ ­¥ ¢µ®¤¨² ¢ °¥ª³°°¥­²­®¥ ±®®²­®¸¥­¨¥ | ¥¥ ¢°¥¬¿ ­³¦­® ¯°®±²® ¤®¡ ¢¨²¼ ª ¢°¥¬¥­¨ ° ¡®²»
°¥ª³°±¨¢­®© ¯°®¶¥¤³°». °¥¬¿ ½²®© ±®°²¨°®¢ª¨ ¥±²¼ O(n lg n), ² ª
·²® ®¡¹¥¥ ¢°¥¬¿ ¥±²¼ ±³¬¬  ¤¢³µ ±« £ ¥¬»µ ¢¨¤  O(n lg n) ¨ ¯®²®¬³ ¥±²¼ O(n lg n).
¯° ¦­¥­¨¿
35.4-1
°®´¥±±®° ¯°¥¤« £ ¥² ³±®¢¥°¸¥­±²¢®¢ ²¼  «£®°¨²¬ ¯®¨±ª  ¯ °» ¡«¨¦ ©¸¨µ ²®·¥ª ¨ ¯°®¢¥°¿²¼ ²®«¼ª® 5 ²®·¥ª ¬ ±±¨¢  Y 0. ­
£®¢®°¨² ±«¥¤³¾¹¥¥: À³¤¥¬ ®²­®±¨²¼ ²®·ª¨, ¯°¨­ ¤«¥¦ ¹¨¥ ¯°¿¬®© l, ª ¬­®¦¥±²¢³ PR .  ½²®¬ ±«³· ¥ ­  ¯°¿¬®© l ­¥ ¡³¤¥² ±®¢¯ ¤ ¾¹¨µ ²®·¥ª, ª®²®°»¥ ®²­®±¿²±¿ ®¤­®¢°¥¬¥­­® ª ¤¢³¬ ¬­®¦¥±²¢ ¬
PL ¨ PR. ®½²®¬³ ¢­³²°¨ ¯°¿¬®³£®«¼­¨ª    2 ¡³¤¥² ±®¤¥°¦ ²¼±¿
­¥ ¡®«¥¥ 6 ²®·¥ª.Á ²® ­¥¯° ¢¨«¼­® ¢ ¨¤¥¥ ¯°®´¥±±®° ?
35.4-2
®ª ¦¨²¥, ·²® (¡¥§ ¨§¬¥­¥­¨¿  ±¨¬¯²®²¨ª¨ ¢°¥¬¥­¨ ° ¡®²»  «£®°¨²¬ ) ¬®¦­® ¯®¤ ¢ ²¼ ­  ¢µ®¤  «£®°¨²¬  ¬­®¦¥±²¢®, ­¥ ±®¤¥°¦ ¹¥¥ ±®¢¯ ¤ ¾¹¨µ ²®·¥ª. ®ª ¦¨²¥, ·²®, ¥±«¨ ±®¢¯ ¤ ¾¹¨µ
²®·¥ª ¢ ¬­®¦¥±²¢¥ ­¥², ²® ¤«¿ ª ¦¤®© ²®·ª¨ ¬ ±±¨¢  Y 0 ¤®±² ²®·­® ¯°®¢¥°¿²¼ 6 (  ­¥ 7) ±®±¥¤­¨µ ²®·¥ª. ¡º¿±­¨²¥, ¯®·¥¬³ ­¥«¼§¿
®¡®©²¨±¼ 5 ¡«¨¦ ©¸¨¬¨ ²®·ª ¬¨.
35.4-3
¯°¥¤¥«¨¬ Lm -° ±±²®¿­¨¥ (Lm -distance) ¬¥¦¤³ ²®·ª ¬¨ p1 ¨ p2
¯«®±ª®±²¨ ´®°¬³«®© (jx1 ; x2 jm + jy1 ; y2 jm )1=m. ¢ª«¨¤®¢® ° ±±²®¿­¨¥ ±®®²¢¥²±²¢³¥² §­ ·¥­¨¾ p = 2. §¬¥­¨²¥ ¯°¨¢¥¤¥­­»© ¢ ½²®¬
° §¤¥«¥  «£®°¨²¬ ² ª, ·²®¡» ®­ ¨±ª « ¡«¨¦ ©¸¨¥ ²®·ª¨ ¢ ±¬»±«¥
L1-° ±±²®¿­¨¿.
35.4-4
¯°¥¤¥«¨¬ L1 -° ±±²®¿­¨¥ ¬¥¦¤³ ²®·ª ¬¨ p1 ¨ p2 ª ª max(jx1 ;
x2 j; jy1 ; y2j).  ª ¯°¨±¯®±®¡¨²¼  «£®°¨²¬ ¯®¨±ª  ¡«¨¦ ©¸¨µ ²®·¥ª
ª ±«³· ¾ L1 -° ±±²®¿­¨¿?

35.5.  ¤ ·¨
35-1 »¯³ª«»¥ ±«®¨
¯°¥¤¥«¨¬ emph¢»¯³ª«»¥ ±«®¨ (convex layers) ¬­®¦¥±²¢  Q ²®·¥ª ¯«®±ª®±²¨. ¥°¢»© ¢»¯³ª«»© ±«®© Q ±®¤¥°¦¨² ²®·ª¨ ¬­®¦¥-

814

« ¢  35 »·¨±«¨²¥«¼­ ¿ £¥®¬¥²°¨¿

±²¢  Q, ª®²®°»¥ ¿¢«¿¾²±¿ ¢¥°¸¨­ ¬¨ CH (Q). »¡°®±¨¬ ½²¨ ½²¨
²®·ª¨ ¨ ±­®¢  ­ ©¤¥¬ ¢»¯³ª«³¾ ®¡®«®·ª³ | ¥¥ ¢¥°¸¨­» ®¡° §³¾²
¢²®°®© ¢»¯³ª«»© ±«®©. »¡°®±¨¬ ¨ ¨µ; ¢®§¼¬¥¬ ¢»¯³ª«³¾ ®¡®«®·ª³ ®±² ²ª ; ¥¥ ¢¥°¸¨­» ®¡° §³¾² ²°¥²¨© ¢»¯³ª«»© ±«®© ¨ ².¤.
a. °¨¤³¬ ²¼ ±¯®±®¡ §  ¢°¥¬¿ O(n2) ­ ©²¨ ¢±¥ ¢»¯³ª«»¥ ±«®¨
¬­®¦¥±²¢  ¨§ n ²®·¥ª ¯«®±ª®±²¨.
b. ®ª ¦¨²¥, ·²® § ¤ ·³ ±®°²¨°®¢ª¨ n ¢¥¹¥±²¢¥­­»µ ·¨±¥« ¬®¦­® ±¢¥±²¨ ª § ¤ ·¥ ®²»±ª ­¨¿ ¢»¯³ª«»µ ±«®¥¢, ¨ ¯®²®¬³ ¢ «¾¡®© ¬®¤¥«¨, £¤¥ ±®°²¨°®¢ª  ²°¥¡³¥² ¢°¥¬¥­¨ jOmega(n lg n), ²  ¦¥
®¶¥­ª  ¢¥°­  ¨ ¤«¿ § ¤ ·¨ ®²»±ª ­¨¿ ¢»¯³ª«»µ ±«®¥¢.
35-2
 ª±¨¬³¬-±«®¨
³¤¥¬ £®¢®°¨²¼, ·²® ²®·ª  ¯«®±ª®±²¨ (x; y ) ¬ ¦®°¨°³¥² (dominates) ²®·ª³ (x0; y 0), ¥±«¨ x > x0 ¨ y > y 0 . ³±²¼ Q | ¬­®¦¥±²¢® ²®·¥ª ¯«®±ª®±²¨. ±«¨ ¤«¿ ²®·ª¨ ¨§ ¬­®¦¥±²¢  Q ­¥² ¤°³£¨µ ²®·¥ª ¨§
Q, ¬ ¦®°¨°³¾¹¨µ ¥¥, ²® ² ª³¾ ²®·ª³ ¡³¤¥¬ ­ §»¢ ²¼ ¬ ª±¨¬ «¼­®© (maximal) ¢ ¬­®¦¥±²¢¥ Q.  ª¨µ ²®·¥ª ¬®¦¥² ¡»²¼ ­¥±ª®«¼ª®;
¬­®¦¥±²¢® ² ª¨µ ²®·¥ª ­ §»¢ ¾² ¯¥°¢»¬ ¬ ª±¨¬³¬-±«®¥¬. ¤ «¨¢ ¢±¥ ½²¨ ²®·ª¨, ¯®¢²®°¨¬ ¯°®¶¥±± ± ®±² ¢¸¨¬±¿ ¬­®¦¥±²¢®¬
²®·¥ª, ¯®«³·¨¬ ¢²®°®© ¬ ª±¨¬³¬-±«®©, ¨ ¡³¤¥² ½²® ¯®¢²®°¿²¼ ¤®
²¥µ ¯®°, ¯®ª  ²®·ª¨ ­¥ ª®­· ²±¿.
°¥¤¯®«®¦¨¬, ·²® ¬­®¦¥±²¢® Q ¨¬¥¥² k ­¥¯³±²»µ ¬ ª±¨¬³¬ ±«®¥¢ L1 ; L2; : : : ; Lk . ³±²¼ yi | ®°¤¨­ ²  ± ¬®© «¥¢®© ²®·ª¨ ±«®¿ Li
¤«¿ i = 1; 2; :::k. ³¤¥¬ ¯°¥¤¯®« £ ²¼, ·²® ¢ Q ­¥² ¤¢³µ ²®·¥ª ±
±®¢¯ ¤ ¾¹¨¬¨  ¡±¶¨±± ¬¨ ¨«¨ ®°¤¨­ ² ¬¨.
a. ®ª ¦¨²¥, ·²® y1 > y2 > : : : > yk .
³±²¼ ²®·ª  (x; y ) ­ µ®¤¨²±¿ «¥¢¥¥ «¾¡®© ¨§ ²®·¥ª Q,   ¥¥ ®°¤¨­ ²  y ®²«¨·­  ®² ®°¤¨­ ² ¢±¥µ ²®·¥ª ¬­®¦¥±²¢  Q. ³±²¼
Q0 = Q [ f(x; y)g.
b. ¡®§­ ·¨¬ ·¥°¥§ j ­ ¨¬¥­¼¸¨© ¨§ ¨­¤¥ª±®¢, ¤«¿ ª®²®°»µ yj <
y; ¥±«¨ ² ª®£® ¨­¤¥ª±  ­¥² (y < yk ), ¯®«®¦¨¬ j = k + 1. ®ª ¦¨²¥,
·²® ¬ ª±¨¬³¬-±«®¨ ¬­®¦¥±²¢  Q0 ³±²°®¥­» ² ª:
±«¨ j 6 k, ²® ¢±¥ ¬ ª±¨¬³¬-±«®¨ Q0 ±®¢¯ ¤ ¾² ± ¬ ª±¨¬³¬±«®¿¬¨ Q, §  ¨±ª«¾·¥­¨¥¬ ±«®¿ Lj , ¢ ª®²®°»© ¤®¡ ¢¨« ±¼ ²®·ª 
(x; y ) (¨ ±² «  ± ¬®© «¥¢®© ²®·ª®© ­®¢®£® Lj ).
±«¨ j = k + 1, ²® ¯¥°¢»¥ k ¬ ª±¨¬³¬-±«®¥¢ ¬­®¦¥±²¢  Q0 ² ª¨¥
¦¥, ª ª ³ Q, ­® ª°®¬¥ ­¨µ ¥±²¼ ­¥¯³±²®© (k +1)-»© ±«®©, ±®±²®¿¹¥©
¨§ ¥¤¨­±²¢¥­­®© ²®·ª¨ (x; y ).
c. ¯¨¸¨²¥  «£®°¨²¬, ¢»·¨±«¿¾¹¨© ¢±¥ ¬ ª±¨¬³¬-±«®¨ ¬­®¦¥±²¢  ¨§ n ²®·¥ª §  ¢°¥¬¿ O(n lg n). (ª § ­¨¥. ¢¨£ ©²¥ ¯°¿¬³¾
±¯° ¢  ­ «¥¢®.)
d.  ª¨¥ ±«®¦­®±²¨ ¢®§­¨ª­³², ¥±«¨ ±°¥¤¨ ²®·¥ª ¥±²¼ ²®·ª¨ ±
° ¢­»¬¨  ¡±¶¨±± ¬¨ ¨«¨ ®°¤¨­ ² ¬¨, ¨ ª ª ¬®¦­® ¯®±²³¯¨²¼ ¢
² ª®¬ ±«³· ¥?
35-3 ®¡®²» ¨ ¯°¨§° ª¨.
®¬ ­¤  ¨§ n °®¡®²®¢ ±° ¦ ¥²±¿ ± n ¯°¨§° ª ¬¨.  ¦¤»© °®¡®²

 ¤ ·¨

815

¢®®°³¦¥­ ¯°®²®­­»¬ °³¦¼¥¬, «³· ª®²®°®£® ³­¨·²®¦ ¥² ¯°¨§° ª.
³· ¤¢¨¦¥²±¿ ¯® ¯°¿¬®© ¨ ®¡°»¢ ¥²±¿, ¢±²°¥²¨¢ ¯°¨§° ª.  ª²¨ª 
°®¡®²®¢ ² ª®¢ : ª ¦¤»© ¢»¡¨° ¥² ±¥¡¥ ¯°¨§° ª (¯°¨ ½²®¬ ®¡° §³¥²±¿ n ¯ ° °®¡®² | ¯°¨§° ª),   § ²¥¬ ¢±¥ °®¡®²» ®¤­®¢°¥¬¥­­®
¢»¯³±ª ¾² «³·¨ ª ¦¤»© ¢ ±¢®¥ ¯°¨¢¥¤¥­¨¥. °¨ ½²®¬ ­¥«¼§¿, ·²®¡» ¢»¯³±ª ¥¬»¥ °®¡®² ¬¨ «³·¨ ¯¥°¥±¥ª«¨±¼.
·¨² ¥¬, ·²® ¯®«®¦¥­¨¥ ª ¦¤®£® °®¡®²  ¨ ª ¦¤®£® ¯°¨§° ª  |
§ ¤ ­­ ¿ ²®·ª  ¯«®±ª®±²¨, ¨ ­¨ª ª¨¥ ²°¨ ¨§ ½²¨µ ²®·¥ª ­¥ «¥¦ ²
­  ®¤­®© ¯°¿¬®©.
a. ®ª § ²¼, ·²® ¢±¥£¤  ±³¹¥±²¢³¥² ¯°¿¬ ¿, ±®¥¤¨­¿¾¹ ¿ ®¤­®£®
¨§ °®¡®²®¢ ± ®¤­¨¬ ¨§ ¯°¨§° ª®¢, ¤«¿ ª®²®°®© ·¨±«® °®¡®²®¢ ¯® ®¤­³ ±²®°®­³ ®² ­¥¥ ±®¢¯ ¤ ¥² ± ·¨±«®¬ ¯°¨§° ª®¢ ± ²®© ¦¥ ±²®°®­».
°¨¤³¬ ©²¥, ª ª ­ ©²¨ ² ª³¾ ¯°¿¬³¾ §  ¢°¥¬¿ O(n lg n).
b. ®±²°®©²¥  «£®°¨²¬, §  ¢°¥¬¿ O(n2 lg n) £°³¯¯¨°³¾¹¨© °®¡®²®¢ ¨ ¯°¨¢¥¤¥­¨© ¢ ¯ °» ² ª, ·²®¡» ¢»¯³±ª ¥¬»¥ °®¡®² ¬¨ «³·¨
­¥ ¯¥°¥±¥ª «¨±¼.
35-4.  ±¯°¥¤¥«¥­¨¥ ± ¬ «®© ®¡®«®·ª®©.
³±²¼ ¬» µ®²¨¬ ¯®±²°®¨²¼ ¢»¯³ª«³¾ ®¡®«®·ª³ ¬­®¦¥±²¢  ±«³· ©­»µ ²®·¥ª ¯«®±ª®±²¨, ¯®¤·¨­¿¾¹¨µ±¿ ­¥ª®²®°®¬³ ° ±¯°¥¤¥«¥­¨¾ ¢¥°®¿²­®±²¥© (° §«¨·­»¥ ²®·ª¨ ­¥§ ¢¨±¨¬»). «¿ ­¥ª®²®°»µ
° ±¯°¥¤¥«¥­¨© ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ·¨±«  ¢¥°¸¨­ ¢»¯³ª«®©
®¡®«®·ª¨ ¥±²¼ O(n1;" ) ¤«¿ ­¥ª®²®°®© ª®­±² ­²» " > 0 (§¤¥±¼ n |
·¨±«® ²®·¥ª).  ª¨¥ ° ±¯°¥¤¥«¥­¨¿ ¬» ¡³¤¥¬ ­ §»¢ ²¼ ° ±¯°¥¤¥«¥­¨¿¬¨ ± ¬ «®© ®¡®«®·ª®© (sparse-hulled distributions). ®² ¯°¨¬¥°»
² ª¨µ ° ±¯°¥¤¥«¥­¨©:
®·ª¨ ° ¢­®¬¥°­® ° ±¯°¥¤¥«¥­» ¢­³²°¨ ª°³£  ¥¤¨­¨·­®£® ° ¤¨³± . »¯³ª« ¿ ®¡®«®·ª  ¨¬¥¥² ¢ ±°¥¤­¥¬ (n1=3) ¢¥°¸¨­.
®·ª¨ ° ¢­®¬¥°­® ° ±¯°¥¤¥«¥­» ¢­³²°¨ ´¨ª±¨°®¢ ­­®£® ¢»¯³ª«®£® ¬­®£®³£®«¼­¨ª . »¯³ª« ¿ ®¡®«®·ª  ±®¤¥°¦¨² ¢ ±°¥¤­¥¬
(lg n) ¢¥°¸¨­. (®­±² ­²  § ¢¨±¨² ®² ·¨±«  ¢¥°¸¨­ ¬­®£®³£®«¼­¨ª .)
®·ª¨ ¯®¤·¨­¥­» ¤¢³¬¥°­®¬³ ­®°¬ «¼­®¬³
p ° ±¯°¥¤¥«¥­¨¾. »¯³ª« ¿ ®¡®«®·ª  ±®¤¥°¦¨² ¢ ±°¥¤­¥¬ ( lg n) ¢¥°¸¨­.
a.  ­» ¤¢  ¢»¯³ª«»µ ¬­®£®³£®«¼­¨ª  (¢®§¬®¦­®, ¯¥°¥±¥ª ¾¹¨µ±¿) ± n1 ¨ n2 ¢¥°¸¨­. °¨¤³¬ ©²¥ ±¯®±®¡ ¯®±²°®¨²¼ ¢»¯³ª«³¾
®¡®«®·ª³ ¢±¥µ n1 + n2 ¢¥°¸¨­ §  ¢°¥¬¿ O(n1 + n2 ). (­®£®³£®«¼­¨ª¨
¬®£³² ¯¥°¥±¥ª ²¼±¿.)
b. ®±²°®©²¥  «£®°¨²¬, ª®²®°»© ®²»±ª¨¢ ¥² ¢»¯³ª«³¾ ®¡®«®·ª³ n ­¥§ ¢¨±¨¬»µ ²®·¥ª, ¯®¤·¨­¥­­»µ ­¥ª®²®°®¬³ ° ±¯°¥¤¥«¥­¨¾
± ¬ «®© ®¡®«®·ª®©.  ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥ ¢°¥¬¥­¨ ° ¡®²» ²
 «£®°¨²¬  ¤®«¦­® ¡»²¼ O(n). (ª § ­¨¥. ¥ª³°±¨¢­® ¨¹¥¬ ¢»¯³ª«³¾ ®¡®«®·ª³ ¤«¿ ¤¢³µ ¯®«®¢¨­ ¬­®¦¥±²¢ ,   § ²¥¬ ±®¥¤¨­¿¥¬
½²¨ ¢»¯³ª«»¥ ®¡®«®·ª¨ ¢ ®¤­³.)
 ¬¥· ­¨¿
 ½²®© £« ¢¥ ¬» «¨¸¼ ±«¥£ª  ª®±­³«¨±¼ § ¤ · ¢»·¨±«¨²¥«¼­®©
£¥®¬¥²°¨¨. ­¨£¨ ¯® ¢»·¨±«¨²¥«¼­®© £¥®¬¥²°¨¨ ­ ¯¨± «¨ °¥¯ -

816

« ¢  35 »·¨±«¨²¥«¼­ ¿ £¥®¬¥²°¨¿

° ²  ¨  ¬®± [160],   ² ª¦¥ ¤¥«¼±¡°³­­¥° [60].
®²¿ ± ¬  £¥®¬¥²°¨¿ ¨¬¥¥² ²»±¿·¥«¥²­¾¾ ¨±²®°¨¾,  «£®°¨²¬¨·¥±ª¨¥ § ¤ ·¨ ¢ £¥®¬¥²°¨¨ ±² «¨ ° ±±¬ ²°¨¢ ²¼ «¨¸¼ ­¥¤ ¢­®.  ª
®²¬¥· ¾² °¥¯ ° ²  ¨  ¬®±, ¢¯¥°¢»¥ ±«®¦­®±²¼¾ £¥®¬¥²°¨·¥±ª¨µ § ¤ · § ¨­²¥°¥±®¢ «±¿ ¥¬³ ­ (E. Lemoine) ¢ 1902 £®¤³. §³· ¿ ¯®±²°®¥­¨¿ ¯°¨ ¯®¬®¹¨ ¶¨°ª³«¿ ¨ «¨­¥©ª¨, ®­ ¢»¤¥«¨« ¯¿²¼
½«¥¬¥­² °­»µ ¤¥©±²¢¨© (³±² ­®¢¨²¼ ®¤­³ ¨§ ­®¦¥ª ¶¨°ª³«¿ ¢ ¤ ­­³¾ ²®·ª³, ³±² ­®¢¨²¼ ®¤­³ ¨§ ­®¦¥ª ¶¨°ª³«¿ ­  ¤ ­­®© ¯°¿¬®©,
­ °¨±®¢ ²¼ ª°³£, ¯°¨«®¦¨²¼ ª° © «¨­¥©ª¨ ² ª, ·²®¡» ®­ ¯°®µ®¤¨« ·¥°¥§ ¤ ­­³¾ ²®·ª³, ¯°®¢¥±²¨ ¯°¿¬³¾). ¥¬³ ­ ¨­²¥°¥±®¢ «±¿ ¬¨­¨¬ «¼­»¬ ·¨±«®¬ ¤¥©±²¢¨©, ²°¥¡³¥¬»µ ¤«¿ °¥¸¥­¨¿ ¤ ­­®©
§ ¤ ·¨ ­  ¯®±²°®¥­¨¥.
«£®°¨²¬ ° §¤¥«  35.2, ¢»¿±­¿¾¹¨©, ¥±²¼ «¨ ¢ ¬­®¦¥±²¢¥ ®²°¥§ª®¢ ¯¥°¥±¥ª ¾¹¨¥±¿, ° §° ¡®² «¨  ¬®± ¨ ®© [176].
°½µ¥¬ (Grahm) ®¯¨±»¢ ¥² À¯°®±¬®²° °½µ¥¬ Á ¢ [91]. «£®°¨²¬
± À§ ¢®° ·¨¢ ­¨¥¬Á ¯°¨­ ¤«¥¦¨² ¦ °¢¨±³ [112]. ±¯®«¼§³¿ ² ª
­ §»¢ ¥¬»¥ ° §°¥¸ ¾¹¨¥ ¤¥°¥¢¼¿ ¢ ª ·¥±²¢¥ ¢»·¨±«¨²¥«¼­®© ¬®¤¥«¨, ® ¤®ª § « [205] ­¨¦­¾¾ ®¶¥­ª³ 
(n ln n) ­  ¢°¥¬¿ ° ¡®²»
«¾¡®£®  «£®°¨²¬ , ­ µ®¤¿¹¥£® ¢»¯³ª«³¾ ®¡®«®·ª³.
±«¨ ¨­²¥°¥±®¢ ²¼±¿ ¢°¥¬¥­¥¬ ° ¡®²» ª ª ´³­ª¶¨¥© ®² ·¨±« 
¢±¥µ ²®·¥ª (n) ¨ ®² ·¨±«  ²®·¥ª ¢»¯³ª«®© ®¡®«®·ª¨ (h), ­ ¨¡®«¥¥ ¡»±²°»¬ ¿¢«¿¥²±¿ ¬¥²®¤ À±²°¨¦ª¨ ¨ ¯®¨±ª Á (prune-and-search
method), ª®²®°»© ¯°¨¤³¬ «¨ ¨°ª¯ ²°¨ª ¨  ©¤¥«¼ [120]; ²°¥¡³¾¹¨© ¢°¥¬¥­¨ O(n lg h). ²®²  «£®°¨²¬ ¿¢«¿¥²±¿  ±¨¬¯²®²¨·¥±ª¨
®¯²¨¬ «¼­»¬.
¯¨± ­­»© ­ ¬¨  «£®°¨²¬ ¯®¨±ª  ¯ °» ¡«¨¦ ©¸¨µ ²®·¥ª (¢°¥¬¿ ° ¡®²» O(n ln n)) ¯°¥¤«®¦¨«  ¬®± (±¬. °¥¯ ° ²  ¨  ¬®±
[160]). °¥¯ ° ²  ¨  ¬®± ¯®ª § «¨, ·²® ½²®²  «£®°¨²¬  ±¨¬¯²®²¨·¥±ª¨ ®¯²¨¬ «¥­ ¢ ¬®¤¥«¨ ° §°¥¸ ¾¹¨µ ¤¥°¥¢¼¥¢.

36

NP-¯®«­®² 

±¥ ° ±±¬®²°¥­­»¥ ­ ¬¨ ° ­¥¥  «£®°¨²¬» ¡»«¨ ¯®«¨­®¬¨ «¼­»¬¨ (° ¡®² «¨ §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿). ²® §­ ·¨², ·²® ¢°¥¬¿
° ¡®²»  «£®°¨²¬  ­  ¢µ®¤¥ ¤«¨­» n ±®±² ¢«¿«® ­¥ ¡®«¥¥ O(nk )
¤«¿ ­¥ª®²®°®© ª®­±² ­²» k (­¥ § ¢¨±¿¹¥© ®² ¤«¨­» ¢µ®¤ ). ±²¥±²¢¥­­® ¯®¨­²¥°¥±®¢ ²¼±¿, ¢±¿ª ¿ «¨ § ¤ ·  ¬®¦¥² ¡»²¼ °¥¸¥­  § 
¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿.
²¢¥² ­  ½²®² ¢®¯°®± ±³£³¡® ®²°¨¶ ²¥«¼­»© | ­¥ª®²®°»¥ § ¤ ·¨ ¢®®¡¹¥ ­¥ ¬®£³² ¡»²¼ °¥¸¥­» ­¨ª ª¨¬  «£®°¨²¬®¬. « ±±¨·¥±ª¨© ¯°¨¬¥° ² ª®© § ¤ ·¨ | À¯°®¡«¥¬  ®±² ­®¢ª¨Á (¢»¿±­¨²¼,
®±² ­ ¢«¨¢ ¥²±¿ «¨ ¤ ­­ ¿ ¯°®£° ¬¬  ­  ¤ ­­®¬ ¢µ®¤¥). °®¬¥
²®£®, ±³¹¥±²¢³¾² § ¤ ·¨, ¤«¿ ª®²®°»µ ±³¹¥±²¢³¥² °¥¸ ¾¹¨© ¨µ
 «£®°¨²¬, ­® «¾¡®© ² ª®©  «£®°¨²¬ ° ¡®² ¥² ¤®«£® | ¢°¥¬¿ ¥£®
° ¡®²» ­¥ ¥±²¼ O(nk ) ­¨ ¤«¿ ª ª®£® ´¨ª±¨°®¢ ­­®£® ·¨±«  k.
±«¨ ¬» µ®²¨¬ ¯°®¢¥±²¨ ¯³±²¼ £°³¡³¾, ­® ´®°¬ «¼­³¾ £° ­¨¶³ ¬¥¦¤³ À¯° ª²¨·¥±ª¨¬¨Á  «£®°¨²¬ ¬¨ ¨  «£®°¨²¬ ¬¨, ¯°¥¤±² ¢«¿¾¹¨¬¨ «¨¸¼ ²¥®°¥²¨·¥±ª¨© ¨­²¥°¥±, ²® ª« ±±  «£®°¨²¬®¢, ° ¡®² ¾¹¨µ §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿, ¿¢«¿¥²±¿ ° §³¬­»¬ ¯¥°¢»¬
¯°¨¡«¨¦¥­¨¥¬.
 ½²®© £« ¢¥ ¬» ° ±±¬®²°¨¬ ª« ±± § ¤ ·, ­ §»¢ ¥¬»µ ÀNP¯®«­»¬¨Á. «¿ ½²¨µ § ¤ · ­¥ ­ ©¤¥­» ¯®«¨­®¬¨ «¼­»¥  «£®°¨²¬»,
®¤­ ª® ­¥ ¤®ª § ­®, ·²® ² ª¨µ  «£®°¨²¬®¢ ­¥ ±³¹¥±²¢³¥². §³·¥­¨¥ NP-¯®«­»µ § ¤ · ±¢¿§ ­® ± ² ª ­ §»¢ ¥¬»¬ ¢®¯°®±®¬ P 6= NP.
²®² ¢®¯°®± ¡»« ¯®±² ¢«¥­ ¢ 1971 £®¤³ ¨ ¿¢«¿¥²±¿ ±¥©· ± ®¤­®© ¨§
­ ¨¡®«¥¥ ¨­²¥°¥±­»µ ¨ ±«®¦­»µ ¯°®¡«¥¬ ²¥®°¨¨ ¢»·¨±«¥­¨©.
®«¼¸¨­±²¢® ±¯¥¶¨ «¨±²®¢ ¯®« £ ¾², ·²® NP-¯®«­»¥ § ¤ ·¨ ­¥«¼§¿ °¥¸¨²¼ §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿. ¥«® ¢ ²®¬, ·²® ¥±«¨ µ®²¿
¡» ¤«¿ ®¤­®© NP-¯®«­®© § ¤ ·¨ ±³¹¥±²¢³¥² °¥¸ ¾¹¨© ¥¥ ¯®«¨­®¬¨ «¼­»©  «£®°¨²¬, ²® ¨ ¤«¿ ¢±¥µ NP-¯®«­»µ § ¤ · ² ª¨¥  «£®°¨²¬» ±³¹¥±²¢³¾².  ­ ±²®¿¹¥¥ ¢°¥¬¿ ¨§¢¥±²­® ®·¥­¼ ¬­®£® NP¯®«­»µ § ¤ ·. ±¥ ¯®¯»²ª¨ ­ ©²¨ ¤«¿ ­¨µ ¯®«¨­®¬¨ «¼­»¥  «£®°¨²¬» ®ª § «¨±¼ ¡¥§³±¯¥¸­»¬¨. ®-¢¨¤¨¬®¬³, ² ª¨µ  «£®°¨²¬®¢
­¥² ¢®¢±¥.
 ·¥¬ ¯°®£° ¬¬¨±²³ §­ ²¼ ® NP-¯®«­»µ § ¤ · µ? ±«¨ ¤«¿ ­¥ª®²®°®© § ¤ ·¨ ³¤ ¥²±¿ ¤®ª § ²¼ ¥¥ NP-¯®«­®²³, ¥±²¼ ®±­®¢ ­¨¿

818

« ¢  36 NP-¯®«­®² 

±·¨² ²¼ ¥¥ ¯° ª²¨·¥±ª¨ ­¥° §°¥¸¨¬®©.  ½²®¬ ±«³· ¥ «³·¸¥ ¯®²° ²¨²¼ ¢°¥¬¿ ­  ¯®±²°®¥­¨¥ ¯°¨¡«¨¦¥­­®£®  «£®°¨²¬  (£«. 37),
·¥¬ ¯°®¤®«¦ ²¼ ¨±ª ²¼ ¡»±²°»©  «£®°¨²¬, °¥¸ ¾¹¨© ¥¥ ²®·­®.
­®£¨¥ ¨­²¥°¥±­»¥ ¨ ¯° ª²¨·¥±ª¨ ¢ ¦­»¥ § ¤ ·¨ ¿¢«¿¾²±¿ NP¯®«­»¬¨, µ®²¿ ­  ¢¨¤ ­¨·³²¼ ­¥ ±«®¦­¥¥, ·¥¬ § ¤ ·  ±®°²¨°®¢ª¨,
§ ¤ ·  ® ª° ²· ©¸¥¬ ¯³²¨ ¢ £° ´¥ ¨«¨ ® ¬ ª±¨¬ «¼­®¬ ¯®²®ª¥ ¢
±¥²¨ (¤«¿ ½²¨µ § ¤ · ¯®«¨­®¬¨ «¼­»¥  «£®°¨²¬» ±³¹¥±²¢³¾²).
 ° §¤¥«¥ 36.1 ¬» ´®°¬ «¨§³¥¬ ¯®­¿²¨¥ § ¤ ·¨ ¨ ®¯°¥¤¥«¨¬
ª« ±± P, ±®±²®¿¹¨© ¨§ À§ ¤ ·Á (¨«¨, ª ª £®¢®°¿², À¿§»ª®¢Á), ° §°¥¸¨¬»µ §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿.  ° §¤¥«¥ 36.2 ¡³¤¥² ®¯°¥¤¥«¥­
ª« ±± NP, ±®±²®¿¹¨© ¨§ § ¤ ·, °¥¸¥­¨¥ ª®²®°»µ ¬®¦¥² ¡»²¼ ¯°®¢¥°¥­® §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿. ®¯°®± ® ±®¢¯ ¤¥­¨¨ ½²¨µ ª« ±±®¢
¨ ¥±²¼ ²  ¶¥­²° «¼­ ¿ ¯°®¡«¥¬  ²¥®°¨¨ ±«®¦­®±²¨ ¢»·¨±«¥­¨©, ®
ª®²®°®© ¬» £®¢®°¨«¨.
 ° §¤¥«¥ 36.3 ¬» ¢¢¥¤¥¬ ¯®­¿²¨¥ ±¢®¤¨¬®±²¨ §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿, ¤ ¤¨¬ ®¯°¥¤¥«¥­¨¥ NP-¯®«­®© § ¤ ·¨ ¨ ³±² ­®¢¨¬ NP¯®«­®²³ § ¤ ·¨ ® ¢»¯®«­¨¬®±²¨. ®±«¥ ½²®£® ¢ ° §¤¥«¥ 36.4 ¬»
¤®ª ¦¥¬ NP-¯®«­®²³ ­¥ª®²®°»µ ¤°³£¨µ § ¤ ·, ±¢¥¤¿ ª ­¨¬ § ¤ ·³
® ¢»¯®«­¨¬®±²¨.  ° §¤¥«¥ 36.5 ¡³¤¥² ¤®ª § ­  NP-¯®«­®²  ¥¹¥
­¥±ª®«¼ª¨µ § ¤ ·.

36.1. ®«¨­®¬¨ «¼­®¥ ¢°¥¬¿
 ª ¬» ³¦¥ £®¢®°¨«¨, ¯®­¿²¨¥ ¯®«¨­®¬¨ «¼­® ° §°¥¸¨¬®© § ¤ ·¨ ¯°¨­¿²® ±·¨² ²¼ ³²®·­¥­¨¥¬ ¨¤¥¨ À¯° ª²¨·¥±ª¨ ° §°¥¸¨¬®©Á
§ ¤ ·¨. ¥¬ ®¡º¿±­¿¥²±¿ ² ª®¥ ±®£« ¸¥­¨¥?
®-¯¥°¢»µ, ¨±¯®«¼§³¥¬»¥ ­  ¯° ª²¨ª¥ ¯®«¨­®¬¨ «¼­»¥  «£®°¨²¬» ®¡»·­® ¤¥©±²¢¨²¥«¼­® ° ¡®² ¾² ¤®¢®«¼­® ¡»±²°®. ®­¥·­®,
²°³¤­® ­ §¢ ²¼ ¯° ª²¨·¥±ª¨ ° §°¥¸¨¬®© § ¤ ·³, ª®²° ¿ ²°¥¡³¥²
¢°¥¬¥­¨ n100 . ¤­ ª® ¯®«¨­®¬» ² ª®© ±²¥¯¥­¨ ¢ °¥ «¼­»µ § ¤ · µ
¯®·²¨ ­¥ ¢±²°¥· ¾²±¿.
²®°®©  °£³¬¥­² ¢ ¯®«¼§³ ° ±±¬®²°¥­¨¿ ª« ±±  ¯®«¨­®¬¨ «¼­»µ  «£®°¨²¬®¢ | ²®² ´ ª², ·²® ®¡º¥¬ ½²®£® ª« ±±  ­¥ § ¢¨±¨²
®² ¢»¡®°  ª®­ª°¥²­®© ¬®¤¥«¨ ¢»·¨±«¥­¨© (¤«¿ ¤®±² ²®·­® ¸¨°®ª®£® ª« ±±  ¬®¤¥«¥©).  ¯°¨¬¥°, ª« ±± § ¤ ·, ª®²®°»¥ ¬®£³² ¡»²¼
°¥¸¥­» §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿ ­  ¯®±«¥¤®¢ ²¥«¼­®© ¬ ¸¨­¥ ±
¯°®¨§¢®«¼­»¬ ¤®±²³¯®¬ (RAM), ±®¢¯ ¤ ¥² ± ª« ±±®¬ § ¤ ·, ¯®«¨­®¬¨ «¼­® ° §°¥¸¨¬»µ ­  ¬ ¸¨­ µ ¼¾°¨­£  (®¯°¥¤¥«¥­¨¥ ª®²®°»µ ¬®¦­® ­ ©²¨ ¢ ª­¨£¥ ®¯ª°®´²  ¨ «¼¬ ­  [104] ¨«¨ ¼¾¨±  ¨
 ¯ ¤¨¬¨²°¨³ [139]). « ±± ¡³¤¥² ²¥¬ ¦¥ ¨ ¤«¿ ¬®¤¥«¥© ¯ ° ««¥«¼­»µ ¢»·¨±«¥­¨©, ¥±«¨, ª®­¥·­®, ·¨±«® ¯°®¶¥±±®°®¢ ¯®«¨­®¬¨ «¼­®
§ ¢¨±¨² ®² ¤«¨­» ¢µ®¤ .
-²°¥²¼¨µ, ª« ±± ¯®«¨­®¬¨ «¼­® ° §°¥¸¨¬»µ § ¤ · ®¡« ¤ ¥²
¥±²¥±²¢¥­­»¬¨ ±¢®©±²¢ ¬¨ § ¬ª­³²®±²¨.  ¯°¨¬¥°, ª®¬¯®§¨¶¨¿

®«¨­®¬¨ «¼­®¥ ¢°¥¬¿

819

¤¢³µ ¯®«¨­®¬¨ «¼­»µ  «£®°¨²¬®¢ (¢»µ®¤ ¯¥°¢®£®  «£®°¨²¬  ¯®¤ ¥²±¿ ­  ¢µ®¤ ¢²®°®£®) ² ª¦¥ ° ¡®² ¥² ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿.
¡º¿±­¿¥²±¿ ½²® ²¥¬, ·²® ±³¬¬ , ¯°®¨§¢¥¤¥­¨¥ ¨ ª®¬¯®§¨¶¨¿ ¬­®£®·«¥­®¢ ±­®¢  ¥±²¼ ¬­®£®·«¥­.
¡±²° ª²­»¥ § ¤ ·¨
» ¯°¨­¨¬ ¥¬ ±«¥¤³¾¹³¾  ¡±²° ª²­³¾ ¬®¤¥«¼ ¢»·¨±«¨²¥«¼­®©
§ ¤ ·¨. ³¤¥¬ ­ §»¢ ²¼  ¡±²° ª²­®© § ¤ ·¥© (abstract °roblem)
¯°®¨§¢®«¼­®¥ ¡¨­ °­®¥ ®²­®¸¥­¨¥ Q ¬¥¦¤³ ½«¥¬¥­² ¬¨ ¤¢³µ ¬­®¦¥±²¢ | ¬­®¦¥±²¢  ³±«®¢¨© (instances) I ¨ ¬­®¦¥±²¢  °¥¸¥­¨© (solutions) S .  ¯°¨¬¥° ¢ § ¤ ·¥ SHORTEST-PATH (¯®¨±ª ª° ²· ©¸¥£® ¯³²¨ ¬¥¦¤³ ¤¢³¬¿ § ¤ ­­»¬¨ ¢¥°¸¨­ ¬¨ ­¥ª®²®°®£® ­¥®°¨¥­²¨°®¢ ­­®£® £° ´  G = (V; E )) ³±«®¢¨¥¬ (½«¥¬¥­²®¬ I ) ¿¢«¿¥²±¿
²°®©ª , ±®±²®¿¹ ¿ ¨§ £° ´  ¨ ¤¢³µ ¢¥°¸¨­,   °¥¸¥­¨¥¬ (½«¥¬¥­²®¢
S ) | ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¢¥°¸¨­, ±®±² ¢«¿¾¹¨µ ²°¥¡³¥¬»© ¯³²¼
¢ £° ´¥. °¨ ½²®¬ ®¤¨­ ½«¥¬¥­² ¬­®¦¥±²¢  I ¬®¦¥² ­ µ®¤¨²¼±¿ ¢
®²­®¸¥­¨¨ Q ± ­¥±ª®«¼ª¨¬¨ ½«¥¬¥­² ¬¨ ¬­®¦¥±²¢  S (¥±«¨ ª° ²· ©¸¨µ ¯³²¥© ¬¥¦¤³ ¤ ­­»¬¨ ¢¥°¸¨­ ¬¨ ­¥±ª®«¼ª®)
 ²¥®°¨¨ NP-¯®«­®²» ° ±±¬ ²°¨¢ ¾²±¿ ²®«¼ª® § ¤ ·¨ ° §°¥¸¥­¨¿ (decision problems) | § ¤ ·¨, ¢ ª®²®°»µ ²°¥¡³¥²±¿ ¤ ²¼ ®²¢¥²
À¤ Á ¨«¨ À­¥²Á ­  ­¥ª®²®°»© ¢®¯°®±. ®°¬ «¼­® § ¤ ·³ ° §°¥¸¥­¨¿ ¬®¦­® ° ±±¬ ²°¨¢ ²¼ ª ª ´³­ª¶¨¾, ®²®¡° ¦ ¾¹³¾ ¬­®¦¥±²¢® ³±«®¢¨© I ¢ ¬­®¦¥±²¢® f0; 1g (1 = À¤ Á, 0 = À­¥²Á). ­®£¨¥
§ ¤ ·¨ ¬®¦­® ² ¬ ¨«¨ ¨­»¬ ±¯®±®¡®¬ ¯°¥®¡° §®¢ ²¼ ª ² ª®¬³ ¢¨¤³.  ¯°¨¬¥°, ± § ¤ ·¥© ¯®¨±ª  ª° ²· ©¸¥£® ¯³²¨ ¢ £° ´¥ ±¢¿§ ­ 
§ ¤ ·  ° §°¥¸¥­¨¿ PATH: À¯® § ¤ ­­®¬³ £° ´³ G = (V; E ), ¯ °¥
¢¥°¸¨­ u; v 2 V ¨ ­ ²³° «¼­®¬³ ·¨±«³ k ®¯°¥¤¥«¨²¼, ±³¹¥±²¢³¥²
«¨ ¢ G ¯³²¼ ¬¥¦¤³ ¢¥°¸¨­ ¬¨ u ¨ v , ¤«¨­  ª®²®°®£® ­¥ ¯°¥¢®±µ®¤¨² kÁ. ³±²¼ ·¥²¢¥°ª  i = hG; u; v; ki ¿¢«¿¥²±¿ ³±«®¢¨¥¬ § ¤ ·¨
PATH. ®£¤  PATH(i) = 1, ¥±«¨ ¤«¨­  ª° ²· ©¸¥£® ¯³²¨ ¬¥¦¤³
¢¥°¸¨­ ¬¨ u ¨ v ­¥ ¯°¥¢®±µ®¤¨² k, ¨ PATH(i) = 0 ¢ ¯°®²¨¢­®¬
±«³· ¥.
 ±²® ¢±²°¥· ¾²±¿ § ¤ ·¨ ®¯²¨¬¨§ ¶¨¨ (optimization problems),
¢ ª®²®°»µ ²°¥¡³¥²±¿ ¬¨­¨¬¨§¨°®¢ ²¼ ¨«¨ ¬ ª±¨¬¨§¨°®¢ ²¼ §­ ·¥­¨¥ ­¥ª®²®°®© ¢¥«¨·¨­». °¥¦¤¥ ·¥¬ ±² ¢¨²¼ ¢®¯°®± ® NP-¯®«­®²¥
² ª¨µ § ¤ ·, ¨µ ±«¥¤³¥² ¯°¥®¡° §®¢ ²¼ ¢ § ¤ ·³ ° §°¥¸¥­¨¿. ¡»·­® ¢ ª ·¥±²¢¥ ² ª®© § ¤ ·¨ ° §°¥¸¥­¨¿ ° ±±¬ ²°¨¢ ¾² § ¤ ·³ ¯°®¢¥°ª¨, ¿¢«¿¥²±¿ «¨ ­¥ª®²®°®¥ ·¨±«® ¢¥°µ­¥© (¨«¨ ­¨¦­¥©) £° ­¨¶¥©
¤«¿ ®¯²¨¬¨§¨°³¥¬®© ¢¥«¨·¨­».  ª, ­ ¯°¨¬¥°, ¬» ¯¥°¥¸«¨ ®² § ¤ ·¨ ®¯²¨¬¨§ ¶¨¨ SHORTEST-PATH ª § ¤ ·¥ ° §°¥¸¥­¨¿ PATH,
¤®¡ ¢¨¢ ¢ ³±«®¢¨¥ § ¤ ·¨ £° ­¨¶³ ¤«¨­» ¯³²¨ k.
±«¨ ¯®±«¥ ½²®£® ¯®«³· ¥²±¿ NP-¯®«­ ¿ § ¤ · , ²® ²¥¬ ± ¬»¬
³±² ­®¢«¥­  ²°³¤­®±²¼ ¨±µ®¤­®© § ¤ ·¨.  ± ¬®¬ ¤¥«¥, ¥±«¨ ¤«¿
®¯²¨¬¨§ ¶¨®­­®© § ¤ ·¨ ¨¬¥¥²±¿ ¡»±²°»©  «£®°¨²¬, ²® ¨ ¯®«³·¥­­³¾ ¨§ ­¥¥ § ¤ ·³ ° §°¥¸¥­¨¿ ¬®¦­® °¥¸¨²¼ ¡»±²°® (­ ¤® ¯°®±²® ±° ¢­¨²¼ ®²¢¥² ½²®£®  «£®°¨²¬  ± § ¤ ­­®© £° ­¨¶¥©).  ª¨¬
®¡° §®¬, ²¥®°¨¾ NP-¯®«­®²» ¬®¦­® ¨±¯®«¼§®¢ ²¼ ¨ ¤«¿ ¨±±«¥¤®-

820

« ¢  36 NP-¯®«­®² 

¢ ­¨¿ § ¤ · ®¯²¨¬¨§ ¶¨¨.
°¥¤±² ¢«¥­¨¥ ¤ ­­»µ
°¥¦¤¥ ·¥¬ ¯®¤ ¢ ²¼ ­  ¢µ®¤  «£®°¨²¬  ¨±µ®¤­»¥ ¤ ­­»¥ (²®
¥±²¼ ½«¥¬¥­² ¬­®¦¥±²¢  I ), ­ ¤® ¤®£®¢®°¨²¼±¿ ® ²®¬, ª ª ®­¨ ¯°¥¤±² ¢«¿¾²±¿ ¢ À¯®­¿²­®¬ ¤«¿ ª®¬¯¼¾²¥°  ¢¨¤¥Á; ¬» ¡³¤¥¬ ±·¨² ²¼,
·²® ¨±µ®¤­»¥ ¤ ­­»¥ § ª®¤¨°®¢ ­» ¯®±«¥¤®¢ ²¥«¼­®±²¼¾ ¡¨²®¢.
®°¬ «¼­® £®¢®°¿, ¯°¥¤±² ¢«¥­¨¥¬ ½«¥¬¥­²®¢ ­¥ª®²®°®£® ¬­®¦¥±²¢  S ­ §»¢ ¥²±¿ ®²®¡° ¦¥­¨¥ e ¨§ S ¢® ¬­®¦¥±²¢® ¡¨²®¢»µ
±²°®ª. ( §³¬¥¥²±¿, ¢¬¥±²® ¡¨²®¢»µ ±²°®ª ¬®¦­® ¡»«® ¡» ° ±±¬ ²°¨¢ ²¼ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ±¨¬¢®«®¢ «¾¡®£® ¤°³£®£® ª®­¥·­®£®
 «´ ¢¨² , ¨¬¥¾¹¥£® ­¥ ¬¥­¥¥ ¤¢³µ ±¨¬¢®«®¢.)  ¯°¨¬¥°, ­ ²³° «¼­»¥ ·¨±«  0; 1; 2; 3; : : : ®¡»·­® ¯°¥¤±² ¢«¿¾² ¡¨²®¢»¬¨ ±²°®ª ¬¨
0; 1; 10; 11; 100; : : : (¯°¨ ½²®¬, ­ ¯°¨¬¥°, e(17) = 10001).  ª®¬¯¼¾²¥° µ ¤«¿ ¯°¥¤±² ¢«¥­¨¿ ¡³ª¢ ¨ ¤°³£¨µ ±¨¬¢®«®¢ ¨±¯®«¼§³¾² ª®¤
ASCII (°¥¦¥ | EBCDIC).  ª, e(A) = 1000001 ¢ ª®¤¥ ASCII.
¨ª±¨°®¢ ¢ ¯°¥¤±² ¢«¥­¨¥ ¤ ­­»µ, ¬» ¯°¥¢° ¹ ¥¬  ¡±²° ª²­³¾ § ¤ ·³ ¢ ±²°®ª®¢³¾, ¤«¿ ª®²®°»© ¢µ®¤­»¬ ¤ ­­»¬ ¿¢«¿¥²±¿
¡¨²®¢ ¿ ±²°®ª , ¯°¥¤±² ¢«¿¾¹ ¿ ¨±µ®¤­®¥ ¤ ­­®¥  ¡±²° ª²­®© § ¤ ·¨. ³¤¥¬ £®¢®°¨²¼, ·²®  «£®°¨²¬ °¥¸ ¥² (solves) ±²°®ª®¢³¾
§ ¤ ·³ §  ¢°¥¬¿ O(T (n)), ¥±«¨ ­  ¢µ®¤­®¬ ¤ ­­®¬ (¡¨²®¢®© ±²°®ª¥) i ¤«¨­» n  «£®°¨²¬ ° ¡®² ¥² ¢°¥¬¿ O(T (n)). ²°®ª®¢ ¿ § ¤ · 
­ §»¢ ¥²±¿ ¯®«¨­®¬¨ «¼­®© (polynomial-time solvable), ±³¹¥±²¢³¥²
ª®­±² ­²  k ¨  «£®°¨²¬, °¥¸ ¾¹¨© ½²³ § ¤ ·³ §  ¢°¥¬¿ O(nk ).
«®¦­®±²­»¬ ª« ±±®¬ P ­ §»¢ ¥²±¿ ¬­®¦¥±²¢® ¢±¥µ ±²°®ª®¢»µ
§ ¤ · ° §°¥¸¥­¨¿, ª®²®°»¥ ¬®£³² ¡»²¼ °¥¸¥­» §  ¯®«¨­®¬¨ «¼­®¥
¢°¥¬¿.
¥« ¿ ®¯°¥¤¥«¨²¼ ¯®­¿²¨¥ ¯®«¨­®¬¨ «¼­®©  ¡±²° ª²­®© § ¤ ·¨, ¬» ±² «ª¨¢ ¥¬±¿ ± ²¥¬, ·²® ¢®§¬®¦­» ° §«¨·­»¥ ¯°¥¤±² ¢«¥­¨¿ ¤ ­­»µ. «¿ ª ¦¤®£® ¯°¥¤±² ¢«¥­¨¿ e ¬­®¦¥±²¢  I ¢µ®¤®¢  ¡±²° ª²­®© § ¤ ·¨ Q ¬» ¯®«³· ¥¬ ±¢®¾ ±²°®ª®¢³¾ § ¤ ·³, ª®²®°³¾
¬» ¢ ¤ «¼­¥©¸¥¬ ®¡®§­ · ¥¬ e(Q). ®®¡¹¥ £®¢®°¿, ¯°¨ ®¤­®¬ ¯°¥¤±² ¢«¥­¨¨ ¬®¦¥² ¯®«³·¨²¼±¿ ¯®«¨­®¬¨ «¼­ ¿ ±²°®ª®¢ ¿ § ¤ · ,  
¯°¨ ¤°³£®¬ | ­¥². (³² ¥±²¼ ¥¹¥ ®¤­  | ·¨±²® ²¥µ­¨·¥±ª ¿ |
¤¥² «¼: ­¥ª®²®°»¥ ¡¨²®¢»¥ ±²°®ª¨ ¬®£³² ­¥ ¯°¥¤±² ¢«¿²¼ ­¨ª ª¨µ ¨±µ®¤­»µ ¤ ­­»µ; ·²® ²°¥¡³¥²±¿ ¢ ½²®¬ ±«³· ¥ ®²  «£®°¨²¬ ,
°¥¸ ¾¹¥£® ±²°®ª®¢³¾ § ¤ ·³? ³¤¥¬ ±·¨² ²¼, ·²® ®­ ¤®«¦¥­ ¤ ¢ ²¼ ¢ ½²®¬ ±«³· ¥ ®²¢¥² 0, ²® ¥±²¼ ·²® ±¢®©±²¢® e(Q) «®¦­® ¤«¿
² ª¨µ ¢µ®¤®¢.)
¥°­¥¬±¿ ª ¢®¯°®±³ ® ²®¬, ª ª § ¢¨±¨² ¯®«¨­®¬¨ «¼­®±²¼ § ¤ ·¨ ®² ¢»¡° ­­®£® ¯°¥¤±² ¢«¥­¨¿. ³±²¼, ­ ¯°¨¬¥°, ¢µ®¤®¬ § ¤ ·¨ ¿¢«¿¥²±¿ ­ ²³° «¼­®¥ ·¨±«® k, ¨ ¢°¥¬¿ ° ¡®²»  «£®°¨²¬  ¥±²¼
(k). ±«¨ ·¨±«® k ¯°¥¤±² ¢¨²¼ ¢ ±¨±²¥¬¥ ±·¨±«¥­¨¿ ± ®±­®¢ ­¨¥¬ 1
(unary representation), ²® ¥±²¼ ¢ ¢¨¤¥ ¯®±«¥¤®¢ ²¥«¼­®±²¨ k ¥¤¨­¨¶,
²® ¢°¥¬¿ ° ¡®²»  «£®°¨²¬  ­  ¢µ®¤¥ ¤«¨­» n ¡³¤¥² ° ¢­® O(n),
¨  «£®°¨²¬ ¡³¤¥² ¯®«¨­®¬¨ «¼­»¬. °¨ ¡®«¥¥ ¥±²¥±²¢¥­­®¬ ¤¢®¨·­®¬ ¯°¥¤±² ¢«¥­¨¨ ·¨±«  k ¢°¥¬¿ ° ¡®²» ­  ¢µ®¤¥ ¤«¨­» n (²®

®«¨­®¬¨ «¼­®¥ ¢°¥¬¿

821

¥±²¼ ­  n-¡¨²®¢®¬ ·¨±«¥) ¡³¤¥² ° ¢­® (2n ), ¨  «£®°¨²¬ ­¥ ¡³¤¥²
¯®«¨­®¬¨ «¼­»¬.
¤­ ª® ­  ¯° ª²¨ª¥ (¥±«¨ ¨±ª«¾·¨²¼ ² ª¨¥ À¤®°®£¨¥Á ±¯®±®¡»
¯°¥¤±² ¢«¥­¨¿, ª ª ±¨±²¥¬  ±·¨±«¥­¨¿ ± ®±­®¢ ­¨¥¬ 1) ¥±²¥±²¢¥­­»¥ ±¯®±®¡» ¯°¥¤±² ¢«¥­¨¿ ®ª §»¢ ¾²±¿ ®¡»·­® ½ª¢¨¢ «¥­²­»¬¨,
¯®±ª®«¼ª³ ®­¨ ¬®£³² ¡»²¼ ¡»±²°® (¯®«¨­®¬¨ «¼­®) ¯°¥®¡° §®¢ ­»
¤°³£ ¢ ¤°³£ .  ¯°¨¬¥°, ¤¢®¨·­³¾ § ¯¨±¼ ·¨±«  ¬®¦­® ¯°¥®¡° §®¢ ²¼ ¢ ²°®¨·­³¾ ¨ ®¡° ²­® §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿.
³¤¥¬ £®¢®°¨²¼, ·²® ´³­ª¶¨¿ f : f0; 1g ! f0; 1g ¢»·¨±«¨¬  §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿ (is polynomial-time computable), ¥±«¨ ±³¹¥±²¢³¥² ¯®«¨­®¬¨ «¼­»©  «£®°¨²¬ A, ª®²®°»© ¤«¿ «¾¡®£®
x 2 f0; 1) ¢»¤ ¥² °¥§³«¼² ² f (x).
 ±±¬®²°¨¬ ²¥¯¥°¼ ¬­®¦¥±²¢® I ³±«®¢¨© ¯°®¨§¢®«¼­®©  ¡±²° ª²­®© § ¤ ·¨ ° §°¥¸¥­¨¿. ¢  ¯°¥¤±² ¢«¥­¨¿ e1 ¨ e2 ½²®£®
¬­®¦¥±²¢  ­ §»¢ ¾²±¿ ¯®«¨­®¬¨ «¼­® ±¢¿§ ­­»¬¨ (polynomially
related), ¥±«¨ ±³¹¥±²¢³¾² ¤¢¥ ¢»·¨±«¨¬»¥ §  ¯®«¨­®¬¨ «¼­®¥
¢°¥¬¿ ´³­ª¶¨¨ ®¤  f12 ¨ f21 , ¤«¿ ª®²®°»µ f12(e1 (i)) = e2 (i)
¨ f21 (e2 (i)) = e1 (i) ¤«¿ ¢±¿ª®£® i 2 I . ²® §­ ·¨², ·²® e1 ¯°¥¤±² ¢«¥­¨¥ ¢µ®¤  ¬®¦¥² ¡»²¼ §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿ ¯®«³·¥­® ¨§ e2-¯°¥¤±² ¢«¥­¨¿ ¨ ­ ®¡®°®².  ½²®¬ ±«³· ¥ ­¥ ¨¬¥¥²
§­ ·¥­¨¿, ª ª®¥ ¨§ ¤¢³µ ¯®«¨­®¬¨ «¼­® ±¢¿§ ­­»µ ¯°¥¤±² ¢«¥­¨©
¢»¡° ²¼, ª ª ¯®ª §»¢ ¥² ±«¥¤³¾¹ ¿ «¥¬¬ .
¥¬¬  36.1
³±²¼ Q |  ¡±²° ª²­ ¿ § ¤ ·  ° §°¥¸¥­¨¿ ± ¬­®¦¥±²¢®¬ ³±«®¢¨© I ,   e1 ¨ e2 | ¯®«¨­®¬¨ «¼­® ±¢¿§ ­­»¥ ¯°¥¤±² ¢«¥­¨¿ ¤«¿
½«¥¬¥­²®¢ ¬­®¦¥±²¢  I . °¥¤¯®«®¦¨¬, ·²® ¬­®¦¥±²¢® ¢±¥µ ±²°®ª,
ª®²®°»¥ ¿¢«¿¾²±¿ e1 -¯°¥¤±² ¢«¥­¨¿¬¨ ½«¥¬¥­²®¢ Q, ° §°¥¸¨¬® § 
¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿, ¨ ·²®  ­ «®£¨·­®¥ ±¢®©±²¢® ¢»¯®«­¥­® ¤«¿
¯°¥¤±² ¢«¥­¨¿ e2 . ®£¤  ±¢®©±²¢  e1 (Q) 2 P ¨ e2 (Q) 2 P ° ¢­®±¨«¼­».
®ª § ²¥«¼±²¢®. ²¢¥°¦¤¥­¨¥ ±¨¬¬¥²°¨·­®, ² ª ·²® ¤®±² ²®·­® ¤®ª § ²¼ ¥£® ¢ ®¤­³ ±²®°®­³. °¥¤¯®«®¦¨¬, ·²® § ¤ ·  e1(Q)
° §°¥¸¨¬  §  ¢°¥¬¿ O(nk ) ¤«¿ ­¥ª®²®°®£® ´¨ª±¨°®¢ ­­®£® ·¨±« 
k. ® ¯°¥¤¯®«®¦¥­¨¾ ¤«¿ ¢±¿ª®£® ³±«®¢¨¿ i 2 I ¯°¥¤±² ¢«¥­¨¥ e1 (i)
¬®¦¥² ¡»²¼ ¯®«³·¥­® ¨§ ¯°¥¤±² ¢«¥­¨¿ e2 (i) §  ¢°¥¬¿ O(nc ) (£¤¥ c
| ­¥ª®²®° ¿ ª®­±² ­² , n = je2 (i)j). «¿ °¥¸¥­¨¿ § ¤ ·¨ e2 (Q), ¯®«³·¨¢ ­  ¢µ®¤ e2 (i), ¬» ±¯¥°¢  ¢»·¨±«¨¬ e1 (i),   § ²¥¬ ¯°¨¬¥­¨¬
 «£®°¨²¬, ° §°¥¸ ¾¹¨© e1 (Q), ª ±²°®ª¥ e1 (i). ª®«¼ª® ¢°¥¬¥­¨
§ ©¬¥² ­ ¸¥ ¢»·¨±«¥­¨¥? °¥®¡° §®¢ ­¨¥ e2(i) ¢ e1 (i) ²°¥¡³¥² ¯®«¨­®¬¨ «¼­®£® ¢°¥¬¥­¨. «¥¤®¢ ²¥«¼­®, je1(i)j = O(nc ), ¯®±ª®«¼ª³
¤«¨­  ¢»µ®¤   «£®°¨²¬  ­¥ ¯°¥¢®±µ®¤¨² ¢°¥¬¥­¨ ¥£® ° ¡®²». ¥¸¥­¨¥ § ¤ ·¨ ± ³±«®¢¨¥¬ e1 (i) § ­¨¬ ¥² O(je1(i)jk ) = O(nck ) ¢°¥¬¥­¨. ² ª, ¢°¥¬¿ ¢»·¨±«¥­¨¿ ®ª § «®±¼ ¯®«¨­®¬¨ «¼­»¬. (» ¯°®¯³±²¨«¨ ¢ ¦­»© ¬®¬¥­²: ¯®«³·¨¢ ­  ¢µ®¤¥ ­¥ª®²®°³¾ ±²°®ª³, ¬»
¤®«¦­» ±­ · «  ¯°®¢¥°¨²¼, ·²® ®­  ¿¢«¿¥²±¿ e2 -¯°¥¤±² ¢«¥­¨¥¬
­¥ª®²®°®£® ¢µ®¤ ; ¯® ¯°¥¤¯®«®¦¥­¨¾ ½²® ¬®¦­® ±¤¥« ²¼ §  ¯®«¨-

822

« ¢  36 NP-¯®«­®² 

­®¬¨ «¼­®¥ ¢°¥¬¿.)
» ­¥ ¡³¤¥¬ ¯®¤°®¡­® ®¯¨±»¢ ²¼ ¨±¯®«¼§³¥¬®¥ ¯°¥¤±² ¢«¥­¨¥ ¢
ª®­ª°¥²­»µ § ¤ · µ, ±·¨² ¿, ·²® ®­® ¢»¡° ­® ¤®±² ²®·­® ° §³¬­® ¨ ½ª®­®¬­® (¶¥«»¥ ·¨±«  § ¤ ¾²±¿ ¤¢®¨·­®© § ¯¨±¼¾, ª®­¥·­»¥ ¬­®¦¥±²¢  | ±¯¨±ª®¬ ½«¥¬¥­²®¢ ¨ ².¯.) °¥¤±² ¢«¥­¨¥ ®¡º¥ª²  ¡³¤¥¬ ®¡®§­ · ²¼ ³£«®¢»¬¨ ±ª®¡ª ¬¨: hGi | ½²® ±² ­¤ °²­®¥
¯°¥¤±² ¢«¥­¨¥ ®¡º¥ª²  G. °¨ ½²®¬ ¬­®¦¥±²¢® ¢±¥µ ±²°®ª, ¿¢«¿¾¹¨µ±¿ ¯°¥¤±² ¢«¥­¨¿¬¨, ®ª §»¢ ¥²±¿ ¯®«¨­®¬¨ «¼­»¬,   ° §«¨·­»¥ À° §³¬­»¥Á ±¯®±®¡» ¯°¥¤±² ¢«¥­¨¿ ¤ ­­»µ ®ª §»¢ ¾²±¿ ¯®«¨­®¬¨ «¼­® ±¢¿§ ­­»¬¨, ² ª ·²® ¬®¦­® ¢®±¯®«¼§®¢ ²¼±¿ «¥¬¬®©
36.1 ¨ ­¥ ®¯¨±»¢ ²¼ ¯°¥¤±² ¢«¥­¨¥ ¤¥² «¼­®, ¥±«¨ ­ ± ¨­²¥°¥±³¥²
«¨¸¼ ¢®¯°®± ® ¯®«¨­®¬¨ «¼­®±²¨ § ¤ ·¨.  ª¨¬ ®¡° §®¬, ¢ ¤ «¼­¥©¸¥¬ ¬» ­¥ ¡³¤¥¬ ¤¥« ²¼ ° §«¨·¨¿ ¬¥¦¤³  ¡±²° ª²­®© § ¤ ·¥©
¨ ¥¥ ±²°®ª®¢»¬ ¯°¥¤±² ¢«¥­¨¥¬, ª ª ½²® ®¡»·­® ¨ ¤¥« ¾² (ª°®¬¥
²¥µ °¥¤ª¨µ § ¤ ·, ¢ ª®²®°»µ ±² ­¤ °²­®¥ ¯°¥¤±² ¢«¥­¨¥ ­¥ ®·¥¢¨¤­® | ¤«¿ ­¨µ ¢»¡®° ¯°¥¤±² ¢«¥­¨¿ ¬®¦¥² ±¨«¼­® ¯®¢«¨¿²¼ ­ 
±«®¦­®±²¼ °¥¸¥­¨¿ § ¤ ·¨).
®°¬ «¼­»¥ ¿§»ª¨
«¿ § ¤ · ° §°¥¸¥­¨¿ ³¤®¡­® ¨±¯®«¼§®¢ ²¼ ²¥°¬¨­®«®£¨¾ ²¥®°¨¨ ´®°¬ «¼­»µ ¿§»ª®¢. «´ ¢¨²®¬ (alphabet)  ­ §»¢ ¥²±¿ «¾¡®© ª®­¥·­»© ­ ¡®° ±¨¬¢®«®¢. §»ª®¬ L ­ ¤  «´ ¢¨²®¬  (language L over ) ­ §»¢ ¥²±¿ ¯°®¨§¢®«¼­®¥ ¬­®¦¥±²¢® ±²°®ª ±¨¬¢®«®¢ ¨§  «´ ¢¨²   (² ª¨¥ ±²°®ª¨ ­ §»¢ ¾² ±«®¢ ¬¨ ¢  «´ ¢¨²¥ )  ¯°¨¬¥°, ¬®¦­® ° ±±¬®²°¥²¼  = f0; 1g ¨ ¿§»ª L =
f10; 11; 101; 111; 1011; 1101; 10001; : : : g, ±®±²®¿¹¨© ¨§ ¤¢®¨·­»µ § ¯¨±¥© ¯°®±²»µ ·¨±¥«. » ¡³¤¥¬ ®¡®§­ · ²¼ ±¨¬¢®«®¬ " ¯³±²®¥
±«®¢® (empty string), ­¥ ±®¤¥°¦ ¹¥¥ ±¨¬¢®«®¢,   ±¨¬¢®«®¬ ; | ¯³±²®© ¿§»ª (empty language), ­¥ ±®¤¥°¦ ¹¨© ±«®¢. §»ª, ±®±²®¿¹¨© ¨§ ¢±¥µ ±²°®ª ¢  «´ ¢¨²¥ , ®¡®§­ · ¥²±¿  .  ¯°¨¬¥°, ¯°¨
 = f0; 1g ¨¬¥¥¬  = f"; 0; 1; 00; 01; 10; 11; 000; : : : g.  ª¨¬ ®¡° §®¬, ¢±¿ª¨© ¿§»ª L ­ ¤  ¿¢«¿¥²±¿ ¯®¤¬­®¦¥±²¢®¬ ¬­®¦¥±²¢  .
¬¥¥²±¿ ­¥±ª®«¼ª® ±² ­¤ °²­»µ ®¯¥° ¶¨© ­ ¤ ¿§»ª ¬¨. ¯¥° ¶¨¨ ®¡º¥¤¨­¥­¨¿ (union) ¨ ¯¥°¥±¥·¥­¨¿ (intersection) ¿§»ª®¢ ®¯°¥¤¥«¿¾²±¿ ª ª ®¡»·­»¥ ®¯¥° ¶¨¨ ®¡º¥¤¨­¥­¨¿ ¨ ¯¥°¥±¥·¥­¨¿ ¬­®¦¥±²¢. ®¯®«­¥­¨¥¬ (complement) ¿§»ª  L ­ §»¢ ¾² ¿§»ª L =
 n L. ®­ª ²¥­ ¶¨¥© (concatenation), ¨«¨ ±®¥¤¨­¥­¨¥¬, ¤¢³µ ¿§»ª®¢ L1 ¨ L2 ­ §»¢ ¥²±¿ ¿§»ª

L = fx1 x2 : x1 2 L1; x2 2 L2g:
 ¬»ª ­¨¥¬ (closure) ¿§»ª  L ­ §»¢ ¥²±¿ ¿§»ª
L = f"g [ L [ L2 [ L3 [ : : : ;
£¤¥ Lk | ¿§»ª, ¯®«³·¥­­»© k-ª° ²­®© ª®­ª ²¥­ ¶¨¥© ¿§»ª  L ±
± ¬¨¬ ±®¡®©. ¯¥° ¶¨¿ § ¬»ª ­¨¿ ­ §»¢ ¥²±¿ ² ª¦¥ ?-®¯¥° ¶¨¥©
«¨­¨ (Kleene star).

®«¨­®¬¨ «¼­®¥ ¢°¥¬¿

823

¥¯¥°¼ ¬®¦­® ±ª § ²¼, ·²® § ¤ ·  ° §°¥¸¥­¨¿ (²®·­¥¥, ±®®²¢¥²±²¢³¾¹ ¿ ¥© ±²°®ª®¢ ¿ § ¤ ·  ° §°¥¸¥­¨¿) ¿¢«¿¥²±¿ ¿§»ª®¬ ­ ¤
 «´ ¢¨²®¬  = f0; 1g.  ¯°¨¬¥°, § ¤ ·¥ PATH ±®®²¢¥²±²¢³¥² ¿§»ª
PATH = fhG; u; v; ki : G = (V; E ) | ­¥®°¨¥­²¨°®¢ ­­»© £° ´, ,
u; v 2 V ; k > 0 | ¶¥«®¥ ·¨±«®, ¨ ¢ £° ´¥ G ±³¹¥±²¢³¥² ¯³²¼ ¨§ u
¢ v , ¤«¨­  ª®²®°®£® ­¥ ¯°¥¢®±µ®¤¨² kg:
(» ¡³¤¥¬ ¨±¯®«¼§®¢ ²¼ ®¤­® ¨ ²® ¦¥ ­ §¢ ­¨¥ | ¢ ¤ ­­®¬ ±«³· ¥ PATH | ¤«¿ ®¡®§­ ·¥­¨¿ § ¤ ·¨ ¨ ±®®²¢¥²±²¢³¾¹¥£® ¿§»ª .)
°®¤®«¦¨¬ §­ ª®¬±²¢® ± ²¥°¬¨­®«®£¨¥© ²¥®°¨¨ ´®°¬ «¼­»µ
¿§»ª®¢. ®¢®°¿², ·²®  «£®°¨²¬ A ¤®¯³±ª ¥² (accepts) ±²°®ª³ x 2
f0; 1g, ¥±«¨ ­  ¢µ®¤¥ x  «£®°¨²¬ ¢»¤ ¥² °¥§³«¼² ² 1 (A(x) = 1).
«£®°¨²¬ A ®²¢¥°£ ¥² (rejects) ±«®¢® x, ¥±«¨ A(x) = 0. ( ¬¥²¨¬,
·²®  «£®°¨²¬ ¬®¦¥² ­¥ ®±² ­®¢¨²¼±¿ ­  ¢µ®¤¥ x ¨«¨ ¤ ²¼ ®²¢¥²,
®²«¨·­»© ®² 0 ¨ 1.  ½²®¬ ±«³· ¥ ®­ ¨ ­¥ ¤®¯³±ª ¥², ¨ ­¥ ®²¢¥°£ ¥²
±«®¢® x.) «£®°¨²¬ A ¤®¯³±ª ¥² (accepts) ¿§»ª L, ¥±«¨  «£®°¨²¬
¤®¯³±ª ¥² ²¥ ¨ ²®«¼ª® ²¥ ±«®¢ , ª®²®°»¥ ¯°¨­ ¤«¥¦ ² ¿§»ª³ L.
«£®°¨²¬ A, ¤®¯³±ª ¾¹¨© ­¥ª®²®°»© ¿§»ª L, ­¥ ®¡¿§ ­ ®²¢¥°£ ²¼ ¢±¿ª®¥ ±«®¢® x 62 L. ±«¨  «£®°¨²¬ ¤®¯³±ª ¥² ¢±¥ ±«®¢  ¨§ L,
  ¢±¥ ®±² «¼­»¥ ±«®¢  ®²¢¥°£ ¥², £®¢®°¿², ·²® ·²® A ° ±¯®§­ ¥²
(decides) ¿§»ª L. §»ª L ¤®¯³±ª ¥²±¿ §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿
(is accepted in polynomial time), ¥±«¨ ¨¬¥¥²±¿  «£®°¨²¬ A, ª®²®°»©
¤®¯³±ª ¥² ¤ ­­»© ¿§»ª, ¯°¨·¥¬ ¢±¿ª®¥ ±«®¢® x 2 L ¤®¯³±ª ¥²±¿
 «£®°¨²¬®¬ §  ¢°¥¬¿ O(nk ), £¤¥ n | ¤«¨­  ±«®¢  x,   k | ­¥ª®²®°®¥ ­¥ § ¢¨±¿¹¥¥ ®² x ·¨±«®. §»ª L ­ §»¢ ¥²±¿ ° ±¯®§­ ¥²±¿ § 
¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿ (is decided in polynomial time), ¥±«¨ ­¥ª®²®°»©  «£®°¨²¬ A ° ±¯®§­ ¥² ¤ ­­»© ¿§»ª, ¯°¨·¥¬ ¢°¥¬¿ ° ¡®²»
 «£®°¨²¬  ­  ª ¦¤®¬ ±«®¢¥ ¤«¨­» n ­¥ ¡®«¼¸¥ O(nk ).
 ±±¬®²°¥­­»© ­ ¬¨ ¿§»ª PATH ¤®¯³±ª ¥²±¿ §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿. ¥²°³¤­® ¯®±²°®¨²¼  «£®°¨²¬, ª®²®°»© ¬¥²®¤®¬ ¯®¨±ª  ¢ ¸¨°¨­³ §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿ ­ µ®¤¨² ª° ²· ©¸¨© ¯³²¼
¬¥¦¤³ ¢¥°¸¨­ ¬¨ u ¨ v ¢ £° ´¥ G,   § ²¥¬ ±° ¢­¨¢ ¥² ¤«¨­³ ­ ©¤¥­­®£® ¯³²¨ ± ¤ ­­»¬ ¢ ³±«®¢¨¨ ·¨±«®¬ k. ±«¨ ¤«¨­  ¯³²¨ ­¥
¯°¥¢®±µ®¤¨² k,  «£®°¨²¬ ¢»¤ ¥² 1 ¨ ®±² ­ ¢«¨¢ ¥²±¿.  ¯°®²¨¢­®¬ ±«³· ¥  «£®°¨²¬ § ¶¨ª«¨¢ ¥²±¿, ­¥ ¢»¤ ¢ ¿ ­¨ª ª®£® ®²¢¥² .
±­®, ·²® ² ª®©  «£®°¨²¬ ¤®¯³±ª ¥², ­® ­¥ ° ±¯®§­ ¥² ¿§»ª PATH.
¤­ ª® «¥£ª® ¨±¯° ¢¨²¼ ®¯¨± ­­»©  «£®°¨²¬ ² ª¨¬ ®¡° §®¬, ·²®¡» ±«®¢ , ­¥ ¯°¨­ ¤«¥¦ ¹¨¥ ¿§»ª³, ®²¢¥°£ «¨±¼ (¥±«¨ ¤«¨­  ª° ²· ©¸¥£® ¯³²¨ ¯°¥¢®±µ®¤¨² k, ­ ¤® ®²¢¥°£ ²¼ ¢µ®¤­®¥ ±«®¢®).  ª®©
 «£®°¨²¬ ¤®¯³±ª ¥² ¨ ° ±¯®§­ ¥² ¿§»ª PATH.
²¬¥²¨¬, ·²® ¤«¿ ­¥ª®²®°»µ ¿§»ª®¢ (­ ¯°¨¬¥°, ¤«¿ ¬­®¦¥±²¢ 
¢±¥µ ¯°®£° ¬¬, § ª ­·¨¢ ¾¹¨µ ±¢®¾ ° ¡®²³) ¥±²¼ ¤®¯³±ª ¾¹¨©,
­® ­¥² ° ±¯®§­ ¾¹¥£®  «£®°¨²¬ .
» ³¦¥ ¤ «¨ ®¯°¥¤¥«¥­¨¥ ª« ±±  § ¤ · P. ¨¦¥ ¬» ®¯°¥¤¥«¨¬
² ª¦¥ ª« ±± NP.  ²¥®°¨¨ ±«®¦­®±²¨ ¢»·¨±«¥­¨© ° ±±¬ ²°¨¢ ¾²±¿ ¬­®£¨¥ ¤°³£¨¥ ±«®¦­®±²­»¥ ª« ±±» (complexity classes).  ¯°¨¬¥°, ¨¬¥¥²±¿ ¢ ¦­»© ª« ±± PSPACE, ±®±²®¿¹¨© ¨§ § ¤ ·, °¥¸ ¥-

824

« ¢  36 NP-¯®«­®² 

¬»µ  «£®°¨²¬ ¬¨ ± ¨±¯®«¼§®¢ ­¨¥¬ ¯ ¬¿²¨ ¯®«¨­®¬¨ «¼­®£® ° §¬¥° , ¨«¨ ª« ±±k EXP, ±®±²®¿¹¨© ¨§ § ¤ ·, ª®²®°»¥ ¬®¦­® °¥¸¨²¼
§  ¢°¥¬¿ O(2n ). ¥´®°¬ «¼­® ±«®¦­®±²­®© ª« ±± ¬®¦­® ®¯°¥¤¥«¨²¼ ª ª ±¥¬¥©±²¢® ¿§»ª®¢, ¤«¿ ª®²®°»µ ° ±¯®§­ ¾¹¨¥  «£®°¨²¬»
¨¬¥¾² § ¤ ­­³¾ ¬¥°³ ±«®¦­®±²¨ (­ ¯°¨¬¥° § ¤ ­­®¥ ¢°¥¬¿ ° ¡®²»). » ­¥ ¤ ¥¬ ²®·­®£® ®¯°¥¤¥«¥­¨¿, ®²±»« ¿ § ¨­²¥°¥±®¢ ­­®£®
·¨² ²¥«¿ ° ¡®²¥  °²¬ ­¨±  ¨ ²¨°­±  [95].
¥¯¥°¼ ¬®¦­® ¯¥°¥´®°¬³«¨°®¢ ²¼ ®¯°¥¤¥«¥­¨¥ ª« ±±  P ² ª:
P = fL  f0; 1g : ±³¹¥±²¢³¥²  «£®°¨²¬ A, ° ±¯®§­ ¾¹¨© ¿§»ª L§  ¯®«¨­®¬¨ «¼­®¥ ¢
  ± ¬®¬ ¤¥«¥ ¢ ¤ ­­®© ±¨²³ ¶¨¨ ­¥² ° §­¨¶» ¬¥¦¤³ ¿§»ª ¬¨,
¤®¯³±ª ¥¬»¬¨ ¨ ° ±¯®§­ ¢ ¥¬»¬¨ §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿.
¥®°¥¬  36.2
P = fL : L ¤®¯³±ª ¥²±¿ §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿g
®ª § ²¥«¼±²¢®
±«¨ ¿§»ª ° ±¯®§­ ¥²±¿ ­¥ª®²®°»¬  «£®°¨²¬®¬, ²® ®­ ¨ ¤®¯³±ª ¥²±¿ ²¥¬ ¦¥  «£®°¨²¬®¬. ±² ¥²±¿ ¤®ª § ²¼, ·²® ¥±«¨ ¿§»ª L
¤®¯³±ª ¥²±¿ ¯®«¨­®¬¨ «¼­»¬  «£®°¨²¬®¬ A, ²® ®­ ° ±¯®§­ ¥²±¿
­¥ª®²®°»¬ (¢®§¬®¦­®, ¤°³£¨¬) ¯®«¨­®¬¨ «¼­»¬  «£®°¨²¬®¬ A0 .
³±²¼  «£®°¨²¬ A ¤®¯³±ª ¥² ¿§»ª L §  ¢°¥¬¿ O(nk ). ²® §­ ·¨²,
·²® ±³¹¥±²¢³¥² ª®­±² ­²  c, ¤«¿ ª®²®°®© A ¤®¯³±ª ¥² «¾¡®¥ ±«®¢®
¤«¨­» n ¨§ L, ±¤¥« ¢ ­¥ ¡®«¥¥ T = cnk ¸ £®¢. (®°¬ «¼­® £®¢®°¿,
½²® ¢¥°­® ¤«¿ ¤®±² ²®·­® ¤«¨­­»µ ±«®¢ x; ¬» ®¯³±ª ¥¬ ®·¥¢¨¤­»¥
¤¥² «¨.)
®¢»©  «£®°¨²¬ A0 ¬®¤¥«¨°³¥² ° ¡®²³  «£®°¨²¬  A ¨ ±·¨² ¥²
·¨±«® ¸ £®¢ ½²®£®  «£®°¨²¬ , ±° ¢­¨¢ ¿ ¥£® ± ¨§¢¥±²­®© £° ­¨¶¥©
T . ±«¨ §  ¢°¥¬¿ T  «£®°¨²¬ A ¤®¯³±ª ¥² ±«®¢® x,  «£®°¨²¬ A0
² ª¦¥ ¤®¯³±ª ¥² ½²® ±«®¢® ¨ ¢»¤ ¥² 1. ±«¨ ¦¥ A ­¥ ¤®¯³±ª ¥²
x §  ³ª § ­­®¥ ¢°¥¬¿, ²®  «£®°¨²¬ A0 ¯°¥ª° ¹ ¥² ¬®¤¥«¨°®¢ ­¨¥
¨ ®²¢¥°£ ¥² ±«®¢® (¢»¤ ¥² 0).  ¬¥¤«¥­¨¥ ° ¡®²» §  ±·¥² ¬®¤¥«¨°®¢ ­¨¿ ¨ ¯®¤±·¥²  ¸ £®¢ ­¥ ² ª ³¦ ¨ ¢¥«¨ª® ¨ ®±² ¢«¿¥² ¢°¥¬¿
° ¡®²» ¯®«¨­®¬¨ «¼­»¬.
 ¬¥²¨¬, ·²® ¤®ª § ²¥«¼±²¢® ²¥®°¥¬» 36.2 ­¥ª®­±²°³ª²¨¢­®: ¥±«¨ ¬» ¨¬¥¥¬ ¯®«¨­®¬¨ «¼­»©  «£®°¨²¬ A, ¤®¯³±ª ¾¹¨© ¿§»ª
¿§»ª L, ­® ­¥ §­ ¥¬, ª ª¨¬ ¨¬¥­­® ¯®«¨­®¬®¬ ®£° ­¨·¥­® ¢°¥¬¿
¥£® ° ¡®²», ¬» ­¥ ¬®¦¥¬ ¯®±²°®¨²¼  «£®°¨²¬  A0 ,   ¬®¦¥¬ «¨¸¼
³²¢¥°¦¤ ²¼, ·²® ² ª®©  «£®°¨²¬ ±³¹¥±²¢³¥².
¯° ¦­¥­¨¿
36.1-1
¯°¥¤¥«¨¬ § ¤ ·³ ®¯²¨¬¨§ ¶¨¨ LONGEST-PATH-LENGTH.
±«®¢¨¿¬¨ ¿¢«¿¾²±¿ ²°®©ª¨, ±®±²®¿¹¨¥ ¨§ ­¥®°¨¥­²¨°®¢ ­­®£® £° ´  ¨ ¤¢³µ ¥£® ¢¥°¸¨­; ¥¥ °¥¸¥­¨¥ | ½²®
± ¬»© ¤«¨­­»© ¯°®±²®© ¯³²¼ ¢ £° ´¥, ª®­¶ ¬¨ ª®²°®£® ¿¢«¿¾²±¿ ¤ ­­»¥ ¢¥°¸¨­».  ±±¬®²°¨¬ ±®®²¢¥²±²¢³¾¹³¾ § ¤ ·³ ° §°¥¸¥­¨¿ LONGEST-PATH = fhG; u; v; ki :

°®¢¥°ª  ¯°¨­ ¤«¥¦­®±²¨ ¿§»ª³ ¨ ª« ±± NP

825

G = (V; E ) | ­¥®°¨¥­²¨°®¢ ­­»© £° ´, u; v 2 V; k >
0 | ¶¥«®¥ ·¨±«®, ¨ ±³¹¥±²¢³¥² ¯°®±²®© ¯³²¼¨§ u ¢ v; ¤«¨­» ­¥ ¬¥­¥¥ kg.

®ª ¦¨²¥, ·²® § ¤ ·  ®¯²¨¬¨§ ¶¨¨ LONGEST-PATH-LENGTH
¬®¦¥² ¡»²¼ °¥¸¥­  §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿ ¢ ²®¬ ¨ ²®«¼ª® ²®¬
±«³· ¥, ¥±«¨ § ¤ ·  ° §°¥¸¥­¨¿ LONGEST-PATH ¯°¨­ ¤«¥¦¨²
ª« ±±³ P.
36.1-2
¯°¥¤¥«¨²¥ ´®°¬ «¼­® § ¤ ·³ ­ µ®¦¤¥­¨¿ ­ ¨¡®«¼¸¥£® ¯°®±²®£® ¶¨ª«  ¢ ­¥®°¨¥­²¨°®¢ ­­®¬ £° ´¥. ´®°¬³«¨°³©²¥ ±®®²¢¥²±²¢³¾¹³¾ ±²°®ª®¢³¾ § ¤ ·³ ° §°¥¸¥­¨¿ (¿§»ª).
36.1-3
 ±±¬®²°¨²¥ ¤¢  ¯°¥¤±² ¢«¥­¨¿ ¤«¿ £° ´  | ± ¯®¬®¹¼¾ ¬ ²°¨¶» ¨­¶¨¤¥­²­®±²¨ (§ ª®¤¨°®¢ ­­®© ¯®±«¥¤®¢ ²¥«¼­®±²¼¾ ¡¨²®¢) ¨
± ¯®¬®¹¼¾ ±¯¨±ª®¢ °¥¡¥° (² ª¦¥ ­ ¤«¥¦ ¹¨¬ ®¡° §®¬ § ª®¤¨°®¢ ­­»µ). ¡º¿±­¨²¥, ¯®·¥¬³ ¤¢  ¤ ­­»µ ¯°¥¤±² ¢«¥­¨¿ ¯®«¨­®¬¨ «¼­® ±¢¿§ ­».
36.1-4
¢«¿¥²±¿ «¨  «£®°¨²¬ ¤¨­ ¬¨·¥±ª®£® ¯°®£° ¬¬¨°®¢ ­¨¿ ¤«¿ 01-§ ¤ ·¨ ® °¾ª§ ª¥ ¨§ ³¯° ¦­¥­¨¿ 17.2-2 ¯®«¨­®¬¨ «¼­»¬? ¡º¿±­¨²¥ ±¢®© ®²¢¥².
36.1-5
°¥¤¯®«®¦¨¬, ·²® ­¥ª®²®°»© ¿§»ª L ¤®¯³±ª ¥²±¿ §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿ ­¥ª®²®°»¬  «£®°¨²¬®¢. ®¦¥² «¨ ½²®²  «£®°¨²¬ ° ¡®² ²¼ ¡®«¥¥ ·¥¬ ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿ ­  ±«®¢ µ, ­¥ ¯°¨­ ¤«¥¦ ¹¨µ L? (° ¢­¨²¥ ±¢®© ®²¢¥² ± ³²¢¥°¦¤¥­¨¥¬ ²¥®°¥¬» 36.2.)
36.1-6
®ª ¦¨²¥, ·²®  «£®°¨²¬, ª®²®°»© ±®¤¥°¦¨² ´¨ª±¨°®¢ ­­®¥ (­¥
§ ¢¨±¿¹¥¥ ®² ¢µ®¤ ) ·¨±«® ¢»§®¢®¢ ¯°®¶¥¤³°», ° ¡®² ¾¹¥© §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿, ± ¬ ° ¡®² ¥² ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿. ±«¨ ¦¥
 «£®°¨²¬ ¤¥« ¥² ¯®«¨­®¬¨ «¼­®¥ ·¨±«® ¢»§®¢®¢ ² ª®© ¯°®¶¥¤³°»,
²® ®¡¹¥¥ ¢°¥¬¿ ° ¡®²» ¬®¦¥² ¡»²¼ ½ª±¯®­¥­¶¨ «¼­»¬. ®·¥¬³?
36.1-7
®ª ¦¨²¥, ·²® ª« ±± P ª ª ¬­®¦¥±²¢® ¿§»ª®¢ § ¬ª­³² ®²­®±¨²¥«¼­® ®¡º¥¤¨­¥­¨¿, ¯¥°¥±¥·¥­¨¿, ¤®¯®«­¥­¨¿, ª®­ª ²¥­ ¶¨¨ ¨ ?®¯¥° ¶¨¨ «¨­¨. ²® §­ ·¨², ·²® ¨§ L1; L2 2 P ±«¥¤³¥² L1 [ L2 2 P
¨ ².¤.

36.2. °®¢¥°ª  ¯°¨­ ¤«¥¦­®±²¨ ¿§»ª³ ¨ ª« ±± NP
 ¯°¥¤»¤³¹¥¬ ° §¤¥«¥ ¬» ° ±±¬ ²°¨¢ «¨ § ¤ ·³ ° §°¥¸¥­¨¿
PATH (¢»¿±­¨²¼, ¥±²¼ «¨ ¢ ¤ ­­®¬ £° ´¥ G ¬¥¦¤³ ¤ ­­»¬¨ ¤¢³¬¿ ¢¥°¸¨­ ¬¨ u ¨ v ¯³²¼ ¤«¨­» ­¥ ¡®«¥¥ k). ²  § ¤ ·  ®ª § « ±¼
¯®«¨­®¬¨ «¼­®© (¨ °¥¸ ¥²±¿ ± ¯®¬®¹¼¾  «£®°¨²¬  ¯®¨±ª  ¢ ¸¨°¨­³). °¥¤±² ¢¨¬ ±¥¡¥, ®¤­ ª®, ·²® ¬» ­¨·¥£® ­¥ §­ ¥¬ ¯°® ¯®¨±ª

826

« ¢  36 NP-¯®«­®² 

36.1 (a) ®¤¥ª ½¤° (¢¨¤ ¨§ ²®·ª¨, ° ±¯®«®¦¥­­®© ­¥¤ «¥ª® ®² ¶¥­²°  ®¤­®© ¨§ £° ­¥©); ±¥°»¥ °¥¡°  ®¡° §³¾² £ ¬¨«¼²®­®¢ ¶¨ª«.
(b) ¢³¤®«¼­»© £° ´ ± ­¥·¥²­»¬ ·¨±«®¬ ¢¥°¸¨­ | ² ª®© £° ´ ­¥
£ ¬¨«¼²®­®¢.
¢ ¸¨°¨­³. ®£¤  § ¤ ·  PATH ¡³¤¥² ¤«¿ ­ ± ²°³¤­®©: ¢¨¤¿ £° ´
G, ¢¥°¸¨­» u ¨ v ¨ §­ ¾ ·¨±«® k, ¬» ­¥ ¡³¤¥¬ §­ ²¼, ¥±²¼ «¨
¨±ª®¬»© ¯³²¼, ¯®ª  ­ ¬ ª²®-­¨¡³¤¼ ¥£® ­¥ ¯®ª ¦¥². ® ¥±«¨ ­ ¬
¥£® ¯®ª ¦³², ²® ¬» ¬®¦¥¬ ¡¥§ ²°³¤  ¯°®¢¥°¨²¼, ·²® ¯³²¼ ½²®² |
¨±ª®¬»©.
¬¥­­® ² ª ¿ ±¨²³ ¶¨¿ ¨¬¥¥² ¬¥±²® ¤«¿ § ¤ · ¨§ ª« ±±  NP, ®
ª®²®°»µ ¬» ¡³¤¥¬ £®¢®°¨²¼ ¢ ½²®¬ ° §¤¥«¥.
 ¬¨«¼²®­®¢ ¶¨ª«
 ¤ ·  ¯®¨±ª  £ ¬¨«¼²®­®¢  ¶¨ª«  ¢ £° ´¥ ¨§³· ¥²±¿ ³¦¥ ¡®«¥¥ ±²  «¥². ®­¤¨ ¨ ¥°²¨ [131] ¶¨²¨°³¾² ¯¨±¼¬®  ¬¨«¼²®­ 
(W.R.Hamilton), ¢ ª®²®°®¬ ®¯¨± ­  ² ª ¿ ¨£° : ¯¥°¢»© ¨£°®ª ®²¬¥· ¥² ¢ ¤®¤¥ª ½¤°¥ (°¨±. 26.1( )) ¯³²¼ ¨§ ¯¿²¨ ¨¤³¹¨µ ¤°³£ § 
¤°³£®¬ ¢¥°¸¨­,   ¢²®°®© ¨£°®ª ¤®«¦¥­ ¤®¯®«­¨²¼ ½²®² ¯³²¼ ¤®
¯°®±²®£® ¶¨ª« , ¯°®µ®¤¿¹¥£® ·¥°¥§ ¢±¥ ¢¥°¸¨­» ¤®¤¥ª ½¤° .
®®¡¹¥ £ ¬¨«¼²®­®¢»¬ ¶¨ª«®¬ (hamiltonian cycle) ¢ ­¥®°¨¥­²¨°®¢ ­­®¬ £° ´¥ G = (V; E ) ­ §»¢ ¥²±¿ ¯°®±²®© ¶¨ª«, ª®²®°»©
¯°®µ®¤¨² ·¥°¥§ ¢±¥ ¢¥°¸¨­» £° ´ . ° ´», ¢ ª®²®°»µ ¥±²¼ £ ¬¨«¼²®­®¢ ¶¨ª«, ­ §»¢ ¾² £ ¬¨«¼²®­®¢»¬¨ (hamiltonian graph)
®¤¥ª ½¤° (¯°®¥ª¶¨¿ ª®²®°®£® ¨§®¡° ¦¥­  ­  °¨±. 35.1(a)) |
£ ¬¨«¼²®­®¢ £° ´; ±¥°»¬ ¶¢¥²®¬ ¯®ª § ­ ®¤¨­ ¨§ £ ¬¨«¼²®­®¢»µ
¶¨ª«®¢. ¥ ¢±¥ £° ´» £ ¬¨«¼²®­®¢»: ­  °¨±. 36.1(b) ¯®ª § ­ ¤¢³¤®«¼­»© £° ´ ± ­¥·¥²­»¬ ·¨±«®¬ ¢¥°¸¨­; «¥£ª® ¢¨¤¥²¼ (³¯°. 36.22), ·²® ² ª®© £° ´ ­¥ ¬®¦¥² ¨¬¥²¼ £ ¬¨«¼²®­®¢  ¶¨ª« .
 ¤ ·  ® £ ¬¨«¼²®­®¢®¬ ¶¨ª«¥ (hamiltonian path problem) ±®±²®¨² ¢»¿±­¥­¨¨, ¨¬¥¥² «¨ ¤ ­­»© £° ´ G £ ¬¨«¼²®­®¢ ¶¨ª«. ®°¬ «¼­® £®¢®°¿,
HAM-CYCLE = fhGi : G | £ ¬¨«¼²®­®¢ £° ´g
 ª °¥¸ ²¼ ² ª³¾ § ¤ ·³? ®¦­® ¯¥°¥¡° ²¼ ¢±¥ ¯¥°¥±² ­®¢ª¨
¢¥°¸¨­ ¤ ­­®£® £° ´  ¨ ¯°®¢¥°¨²¼, ¿¢«¿¥²±¿ «¨ µ®²¿ ¡» ®¤­  ¨§
­¨µ £ ¬¨«¼²®­®¢»¬ ¶¨ª«®¬. ¶¥­¨¬ ¢°¥¬¿ ° ¡®²» ² ª®£®  «£®°¨²¬ . ±«¨ ¬» ¨±¯®«¼§³¥¬ ¯°¥¤±² ¢«¥­¨¥ £° ´  ± ¯®¬®¹¼¾p¬ ²°¨¶» ¨­¶¨¤¥­²­®±²¨, ²® ·¨±«® ¢¥°¸¨­ m ¢ £° ´¥ ¡³¤¥² 
( n),
£¤¥ n = jhGij | ¤«¨­  ¯°¥¤±² ¢«¥­¨¿ £° ´  G. ¬¥¥²±¿ m! ° §«¨·­»µ ¯¥°¥±² ­®¢®ª
p ¢¥°¸¨­ p£° ´ , ¨ ¢°¥¬¿ ° ¡®²»  «£®°¨²¬ 
° ¢­® 
(m!) = 
( n!) = 
(2 n ), ²® ¥±²¼ ­¥ ¿¢«¿¥²±¿ ¯®«¨­®¬¨ «¼­»¬.  ª¨¬ ®¡° §®¬, ­ ¨¢­»©  «£®°¨²¬ ­¥ ¤ ¥² ½´´¥ª²¨¢­®£®
°¥¸¥­¨¿ § ¤ ·¨.   ± ¬®¬ ¤¥«¥, ª ª ¬» ¯®ª ¦¥¬ ¢ ° §¤¥«¥ 36.1, § ¤ ·  ® £ ¬¨«¼²®­®¢®¬ ¶¨ª«¥ ¿¢«¿¥²±¿ NP-¯®«­®©, ¨ ¯®²®¬³ ¬®¦­®
¯°¥¤¯®« £ ²¼, ·²® ¯®«¨­®¬¨ «¼­®£®  «£®°¨²¬  ¤«¿ ­¥¥ ¢®®¡¹¥ ­¥
±³¹¥±²¢³¥².

°®¢¥°ª  ¯°¨­ ¤«¥¦­®±²¨ ¿§»ª³ ¨ ª« ±± NP

827

°®¢¥°ª  ¯°¨­ ¤«¥¦­®±²¨ ¿§»ª³
³±²¼ ¢» § ª«¾·¨«¨ ¯ °¨ ± ¯°¨¿²¥«¥¬, ª®²®°»© ³²¢¥°¦¤ ¥²,
·²® (­ °¨±®¢ ­­»© ¯¥°¥¤ ¢ ¬¨ ­  ¤®±ª¥) £° ´ ¿¢«¿¥²±¿ £ ¬¨«¼²®­®¢»¬. °¨ ½²®¬ ¢» ­¥ ¬®¦¥²¥ ¡»±²°® ¯°®¢¥°¨²¼, ² ª ½²® ¨«¨
­¥². ¥¬ ­¥ ¬¥­¥¥ ¯°¨¿²¥«¼ ¬®¦¥² ¢»¨£° ²¼ ¯ °¨, ¥±«¨ ª ª¨¬-²®
®¡° §®¬ ®²£ ¤ ¥² £ ¬¨«¼²®­®¢ ¶¨ª« ¨ ¯°¥¤º¿¢¨² ¥£® ¢ ¬: ¯°®¢¥°ª  ²®£®, ·²® ¤ ­­»© ¶¨ª« ¿¢«¿¥²±¿ £ ¬¨«¼²®­®¢»¬, ¯°®±² . ³¦­® «¨¸¼ ¯°®¢¥°¨²¼, ·²® ¯°¥¤º¿¢«¥­­»© ¶¨ª« ¯°®µ®¤¨² ·¥°¥§ ¢±¥
¢¥°¸¨­» £° ´ , ¨ ·²® ®­ ¤¥©±²¢¨²¥«¼­® ¨¤¥² ¯® °¥¡° ¬. ² ª,
¤®ª § ²¥«¼±²¢® ±³¹¥±²¢®¢ ­¨¿ £ ¬¨«¼²®­®¢  ¶¨ª«  ¢ £° ´¥ (±®±²®¿¹¥¥ ¢ ¯°¥¤º¿¢«¥­¨¨ £ ¬¨«¼²®­®¢  ¯³²¨) ¬®¦­® ¯°®¢¥°¨²¼ § 
¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿.
 §®¢¥¬ ¯°®¢¥°¿¾¹¨¬  «£®°¨²¬®¬ (verication algorithm)  «£®°¨²¬ A ± ¤¢³¬¿  °£³¬¥­² ¬¨; ¯¥°¢»©  °£³¬¥­² ¬» ¡³¤¥¬ ­ §»¢ ²¼ (ª ª ¨ ° ­¼¸¥) ¢µ®¤­®© ±²°®ª®©,   ¢²®°®© | ±¥°²¨´¨ª ²®¬
(certicatie). » £®¢®°¨¬, ·²®  «£®°¨²¬ A ± ¤¢³¬¿  °£³¬¥­² ¬¨
¤®¯³±ª ¥² ¢µ®¤ x (A veries an input string x), ¥±«¨ ±³¹¥±²¢³¥²
±¥°²¨´¨ª ² y , ¤«¿ ª®²®°®£® A(x; y ) = 1. §»ª®¬, ¯°®¢¥°¿¥¬»¬  «£®°¨²¬®¬ A (language veried by A), ¬» ­ §®¢¥¬ ¿§»ª
L = fx 2 f0; 1g : ±³¹¥±²¢³¥² y 2 f0; 1g, ¤«¿ ª®²®°®£®A(x; y ) = 1g:
°³£¨¬¨ ±«®¢ ¬¨,  «£®°¨²¬ A ¯°®¢¥°¿¥² ¿§»ª L, ¥±«¨ ¤«¿ «¾¡®©
±²°®ª¨ x 2 L ­ ©¤¥²±¿ ±¥°²¨´¨ª ² y , ± ¯®¬®¹¼¾ ª®²®°®£® A ¬®¦¥² ¯°®¢¥°¨²¼ ¯°¨­ ¤«¥¦­®±²¼ x ª ¿§»ª³ L,   ¤«¿ x 62 L ² ª®£®
±¥°²¨´¨ª ²  ­¥².  ¯°¨¬¥°, ¢ § ¤ ·¥ HAM-CYCLE ±¥°²¨´¨ª ²®¬
¡»«  ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¢¥°¸¨­, ®¡° §³¾¹ ¿ £ ¬¨«¼²®­®¢ ¶¨ª«.
«®¦­®±²­®© ª« ±± NP
«®¦­®±²­®© ª« ±± NP (complexity class NP) | ½²® ª« ±± ¿§»ª®¢, ¤«¿ ª®²®°»µ ±³¹¥±²¢³¾² ¯°®¢¥°¿¾¹¨¥  «£®°¨²¬», ° ¡®² ¾¹¨¥ ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿, ¯°¨·¥¬ ¤«¨­  ±¥°²¨´¨ª ²  ² ª¦¥
®£° ­¨·¥­  ­¥ª®²®°»¬ ¯®«¨­®¬®¬. ®«¥¥ ²®·­®, ¿§»ª L ¯°¨­ ¤«¥¦¨² ª« ±±³ NP, ¥±«¨ ±³¹¥±²¢³¥² ² ª®© ¯®«¨­®¬¨ «¼­»©  «£®°¨²¬
A ± ¤¢³¬¿  °£³¬¥­² ¬¨ ¨ ² ª ¿ ¬­®£®·«¥­ p(x) ± ¶¥«»¬¨ ª®½´´¨¶¨¥­² ¬¨, ·²®

L = fx 2 f0; 1g : ±³¹¥±²¢³¥² ±¥°²¨´¨ª ² y , ¤«¿ ª®²®°®£® jyj 6 p(jxj) ¨ A(x; y ) = 1g
 ½²®¬ ±«³· ¥ ¬» £®¢®°¨¬, ·²®  «£®°¨²¬ A ¯°®¢¥°¿¥² ¿§»ª L § 
¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿ (A veries language L in polynomial time).
 ¬¥²¨¬, ·²®, ´®°¬ «¼­® £®¢®°¿, ¨§ ½²®£® ­¥ ±«¥¤³¥², ·²® A ¯°®¢¥°¿¥² ¿§»ª L ¢ ±¬»±«¥ ° ­¥¥ ¤ ­­®£® ®¯°¥¤¥«¥­¨¿, ² ª ª ª ¤«¿
x 2= L ¬®£³² ±³¹¥±²¢®¢ ²¼ ¤«¨­­»¥ ±¥°²¨´¨ª ²», ª®²®°»¥ ®²¡° -

±»¢ ¾²±¿ ¯°¨ ­®¢®¬ ®¯°¥¤¥«¥­¨¨, ­® ¯°¥¯¿²±²¢³¾² ±² °®¬³.
¥±ª®«¼ª® ±«®¢ ® ­ §¢ ­¨¨: ±®ª° ¹¥­¨¥ NP ¯°®¨±µ®¤¨² ®²  ­£«¨©±ª¨µ ±«®¢ Nondeterministic Polynomial (time), ·²® ¯¥°¥¢®¤¨²±¿
ª ª ­¥¤¥²¥°¬¨­¨°®¢ ­­®¥ ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿. ¥°¢®­ · «¼­®

828

« ¢  36 NP-¯®«­®² 

36.2 ¥²»°¥ ¢®§¬®¦­»µ ±¨²³ ¶¨¨ (¨¬¥¥²±¿ ¢ ¢¨¤³, ·²® ¢±¥ ¯®ª § ­­»¥ ­  °¨±³­ª¥ ®¡« ±²¨ ­¥¯³±²»).
(a) « ±±» P , NP ¨ co ; NP ±®¢¯ ¤ ¾². (®«¼¸¨­±²¢® ½ª±¯¥°²®¢
±·¨² ¥² ½²® ­ ¨¬¥­¥¥ ¢¥°®¿²­»¬.)
(b) « ±± NP § ¬ª­³² ®²­®±¨²¥«¼­® ¤®¯®«­¥­¨¿ (NP=co-NP), ­®
­¥ ±®¢¯ ¤ ¥² ± P .
(c) « ±± NP ­¥ § ¬ª­³² ®²­®±¨²¥«¼­® ¤®¯®«­¥­¨¿ ¨ ¢ ¯¥°¥±¥·¥­¨¨
± co-NP ¤ ¥² P.
(d) « ±± NP ­¥ § ¬ª­³² ®²­®±¨²¥«¼­® ¤®¯®«­¥­¨¿; ¯¥°¥±¥·¥­¨¥
NP \ co ; NP ¡®«¼¸¥, ·¥¬ P.
ª« ±± NP ®¯°¥¤¥«¿«±¿ ¢ ²¥°¬¨­ µ ² ª ­ §»¢ ¥¬»µ ­¥¤¥²¥°¬¨­¨°®¢ ­­»µ ¢»·¨±«¥­¨© (±¬. ª­¨£³ ®¯ª°®´²  ¨ «¼¬ ­  [104]).
» ³¦¥ §­ ¥¬ ®¤­³ § ¤ ·³ ¨§ ª« ±±  NP | ½²® § ¤ ·  HAMCYCLE. °®¬¥ ²®£®, ¢±¿ª ¿ § ¤ ·  ¨§ P ¯°¨­ ¤«¥¦¨² ² ª¦¥ ¨ NP.
¥©±²¢¨²¥«¼­®, ¥±«¨ ¥±²¼ ¯®«¨­®¬¨ «¼­»©  «£®°¨²¬, ° ±¯®§­ ¾¹¨© ¿§»ª, ²® «¥£ª® ¯®±²°®¨²¼ ¯°®¢¥°¿¾¹¨©  «£®°¨²¬ ¤«¿ ²®£® ¦¥
¿§»ª  | ¯°®¢¥°¿¾¹¨©  «£®°¨²¬ ¬®¦¥² ¯°®±²® ¨£­®°¨°®¢ ²¼ ±¢®©
¢²®°®©  °£³¬¥­² (±¥°²¨´¨ª ²).  ª¨¬ ®¡° §®¬ P  NP.
 ¤ ­­®¥ ¢°¥¬¿ ­¥¨§¢¥±²­®, ±®¢¯ ¤ ¾² «¨ ª« ±±» P ¨ NP, ­®
¡®«¼¸¨­±²¢® ±¯¥¶¨ «¨±²®¢ ¯®« £ ¥², ·²® ­¥². ­²³¨²¨¢­® ª« ±± P
¬®¦­® ¯°¥¤±² ¢«¿²¼ ±¥¡¥ ª ª ª« ±± § ¤ ·, ª®²®°»¥ ¬®¦­® ¡»±²°®
°¥¸¨²¼,   ª« ±± NP | ª ª ª« ±± § ¤ ·, °¥¸¥­¨¥ ª®²®°»µ ¬®¦¥²
¡»²¼ ¡»±²°® ¯°®¢¥°¥­®.   ¯° ª²¨ª¥ °¥¸¨²¼ ± ¬®¬³ § ¤ ·³ · ±²®
­ ¬­®£® ²°³¤­¥¥, ·¥¬ ¯°®¢¥°¨²¼ ³¦¥ £®²®¢®¥ °¥¸¥­¨¥, ®±®¡¥­­®
¥±«¨ ¢°¥¬¿ ° ¡®²» ®£° ­¨·¥­®. ®  ­ «®£¨¨ ¬®¦­® ¤³¬ ²¼, ·²® ¢
ª« ±±¥ NP ¨¬¥¾²±¿ § ¤ ·¨, ª®²®°»¥ ­¥«¼§¿ °¥¸¨²¼ §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿.
±²¼ ¨ ¡®«¥¥ ±¥°¼¥§­»¥ ¯°¨·¨­» ¯®« £ ²¼, ·²® P 6= NP | ¯°¥¦¤¥
¢±¥£® ½²® ±³¹¥±²¢®¢ ­¨¥ ÀNP-¯®«­»µÁ § ¤ · (° §¤¥« 36.3).
°®¬¥ ¯°®¡«¥¬» P = NP, ®±² ¾²±¿ ®²ª°»²»¬¨ ¨ ¬­®£¨¥ ¤°³£¨¥
¢®¯°®±» ® ª« ±±¥ NP.  ª, ­¥±¬®²°¿ ­  ®£°®¬­»¥ ³±¨«¨¿ ¨±±«¥¤®¢ ²¥«¥©, ­¥ ¨§¢¥±²­®, § ¬ª­³² «¨ ª« ±± NP ®²­®±¨²¥«¼­® ¤®¯®«­¥­¨¿,
²® ¥±²¼ ¢¥°­® «¨, ·²® ¨§ L 2 NP ±«¥¤³¥² L 2 NP. » ¬®¦¥¬ ®¯°¥¤¥«¨²¼ ±«®¦­®±²­®© ª« ±± co ; NP ª ª ¬­®¦¥±²¢® ¿§»ª®¢ L, ¤«¿
ª®²°»µ L 2 NP. ®¯°®± ® § ¬ª­³²®±²¨ ª« ±±  NP ®²­®±¨²¥«¼­®
¤®¯®«­¥­¨¿ ¬®¦­® ¯¥°¥´®°¬³«¨°®¢ ²¼ ² ª: ° ¢­» «¨ ª« ±±» NP ¨
co-NP?
®±ª®«¼ª³ ª« ±± P § ¬ª­³² ®²­®±¨²¥«¼­® ¤®¯®«­¥­¨¿ (³¯°. 36.17), P  NP \ co ; NP.  ²® ¦¥ ¢°¥¬¿ ®±² ¥²±¿ ­¥¨§¢¥±²­»¬, ¢¥°­®
«¨ ° ¢¥­±²¢® P = NP \ co ; NP.   °¨±. 36.2 ¯®ª § ­» ·¥²»°¥
¢®§¬®¦­»µ ±¨²³ ¶¨¨.
¢», ­ ¸¨ §­ ­¨¿ ® ±®®²­®¸¥­¨¨ ª« ±±®¢ P ¨ NP ¤ «¥ª® ­¥ ¯®«­»
(£®¢®°¿ ¯°¿¬®, ¬» ¢®®¡¹¥ ­¨·¥£® ­¥ §­ ¥¬). ® ³¦¥ ¯®­¿²¨¥ NP¯®«­®²» ¿¢«¿¥²±¿ ¢ ¦­»¬ ±°¥¤±²¢®¬ ª« ±±¨´¨ª ¶¨¨ § ¤ ·; ª ª ¬»

°®¢¥°ª  ¯°¨­ ¤«¥¦­®±²¨ ¿§»ª³ ¨ ª« ±± NP

829

³¢¨¤¨¬, ®­® ±¢®¤¨² ¢®¯°®± ® ±«®¦­®±²¨ ¤ ­­®© § ¤ ·¨ ª ®¡¹¥¬³
(¯³±²¼ ¨ ­¥ °¥¸¥­­®¬³) ¢®¯°®±³ ® ±®®²­®¸¥­¨¨ ª« ±±®¢ P ¨ NP.
¯° ¦­¥­¨¿
36.2-1
 ±±¬®²°¨¬ ¿§»ª GRAPH-ISOMORPHISM=fhG1 ; G2i : £° ´»
G1 ¨ G2 ¨§®¬®°´­»g. ®ª ¦¨²¥, ·²® ¤ ­­»© ¿§»ª ¯°¨­ ¤«¥¦¨²
ª« ±±³ NP (¯®±²°®©²¥ ¯®«¨­®¬¨ «¼­»©  «£®°¨²¬, ¯°®¢¥°¿¾¹¨©
½²®² ¿§»ª).
36.2-2
®ª ¦¨²¥, ·²® ­¥®°¨¥­²¨°®¢ ­­»© ¤¢³¤®«¼­»© £° ´ ±
­¥·¥²­»¬ ·¨±«®¬ ¢¥°¸¨­ ­¥ £ ¬¨«¼²®­®¢.
36.2-3
®ª ¦¨²¥, ·²® ¥±«¨ HAM-CYCLE «¥¦¨² ¢ P, ²® §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿ ¬®¦­® ­¥ ²®«¼ª® ¯°®¢¥°¨²¼, ±³¹¥±²¢³¥² «¨ £ ¬¨«¼²®­®¢
¶¨ª«, ­® ¨ ­ ©²¨ ¥£®.
36.2-4
®ª ¦¨²¥, ·²® ª« ±± ¿§»ª®¢ NP § ¬ª­³² ®²­®±¨²¥«¼­® ®¡º¥¤¨­¥­¨¿, ¯¥°¥±¥·¥­¨¿, ª®­ª ²¥­ ¶¨¨ ¨ ?-®¯¥° ¶¨¨ «¨­¨.
36.2-5
®ª ¦¨²¥, ·²® «¾¡®© ¿§»ª ¨§ NP ° ±¯®§­ ¥²±¿ ­¥ª®²®°»¬  «£®°¨²¬®¬ §  ¢°¥¬¿ 2O(nk ) ), £¤¥ n | ¤«¨­  ¢µ®¤ ,   k | ­¥ § ¢¨±¿¹ ¿
®² n ª®­±² ­² .
36.2-6
 ¬¨«¼²®­®¢»¬ ¯³²¥¬ ¢ £° ´¥ ­ §»¢ ¥²±¿ ¯³²¼, ª®²°»© ¯°®µ®¤¨² ·¥°¥§ ª ¦¤³¾ ¢¥°¸¨­³ £° ´  °®¢­® ®¤¨­ ° §. ®ª ¦¨²¥, ·²®
¿§»ª HAM-PATH=fhG; u; v i : ¢ £° ´¥ G ±³¹¥±²¢³¥² £ ¬¨«¼²®­®¢ ¯³²¼ ¨§ ¢¥°¸¨­» u
¯°¨­ ¤«¥¦¨² NP.
36.2-7
®ª ¦¨²¥, ·²® ¤«¿ ®°¨¥­²¨°®¢ ­­»µ £° ´®¢ ¡¥§ ¶¨ª«®¢ ¬®¦­®
§  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿ ¢»¿±­¨²¼, ±³¹¥±²¢³¥² «¨ £ ¬¨«¼²®­®¢
¯³²¼.
36.2-8
³±²¼ ' | ¡³«¥¢  ´®°¬³« , ¯®±²°®¥­­ ¿ ¨§ ¡³«¥¢»µ ¯¥°¥¬¥­­»µ

x1 ; x2; : : : ;
xn ± ¯®¬®¹¼¾ ®¯¥° ¶¨© ®²°¨¶ ­¨¿ (:), ª®­º¾­ª¶¨© (, ^), ¤¨§º¾­ª¶¨© (, _) ¨ ±ª®¡®ª. ®°¬³«  ' ­ §»¢ ¥²±¿ ² ¢²®«®£¨¥©

(tautology), ¥±«¨ ®­  ¨±²¨­­  ¤«¿ ¢±¥µ §­ ·¥­¨© ¯¥°¥¬¥­­»µ. ¯°¥¤¥«¨¬ ¿§»ª TAUTOLOGY, ±®±²®¿¹¨© ¨§ ¢±¥µ ² ¢²®«®£¨©. ®ª ¦¨²¥, ·²® TAUTOLOGY ¯°¨­ ¤«¥¦¨² co-NP.
36.2-9
®ª ¦¨²¥, ·²® P  co ; NP
36.2-10
®ª ¦¨²¥, ·²® ¥±«¨ NP 6= co ; NP, ²® P 6= NP.
36.2-11
³±²¼ G | ±¢¿§­»© ­¥®°¨¥­²¨°®¢ ­­»© £° ´, ¨¬¥¾¹¨© ­¥ ¬¥­¼¸¥ ²°¥µ ¢¥°¸¨­.  ±±¬®²°¨¬ £° ´ G3 , ª®²®°»© ¯®«³·¨²±¿, ¥±«¨ ±®-

830

« ¢  36 NP-¯®«­®² 

¥¤¨­¨²¼ °¥¡°®¬ ª ¦¤³¾ ¯ °³ ¢¥°¸¨­ £° ´  G, ª®²®°»¥ ±®¥¤¨­¥­»
¢ G ¯³²¥¬ ¤«¨­» ­¥ ¡®«¼¸¥ 3. ®ª ¦¨²¥, ·²® £° ´ G3 £ ¬¨«¼²®­®¢.
(ª § ­¨¥: ¯®±²°®©²¥ ¯®ª°»¢ ¾¹¥¥ ¤¥°¥¢® £° ´  G ¨ ¯°¨¬¥­¨²¥
¬ ²¥¬ ²¨·¥±ª³¾ ¨­¤³ª¶¨¾.)

36.3. NP-¯®«­®²  ¨ ±¢®¤¨¬®±²¼
®-¢¨¤¨¬®¬³, ­ ¨¡®«¥¥ ³¡¥¤¨²¥«¼­»¬  °£³¬¥­²®¬ ¢ ¯®«¼§³ ²®£®, ·²® ª« ±±» P ¨ NP ° §«¨·­», ¿¢«¿¥²±¿ ±³¹¥±²¢®¢ ­¨¥ ² ª ­ §»¢ ¥¬»µ NP-¯®«­»µ § ¤ ·. ²®² ª« ±± ®¡« ¤ ¥² ³¤¨¢¨²¥«¼­»¬
±¢®©±²¢®¬: ¥±«¨ ª ª ¿-­¨¡³¤¼ NP-¯®«­ ¿ § ¤ ·  ° §°¥¸¨¬  §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿, ²® ¨ ¢±¥ § ¤ ·¨ ¨§ ª« ±±  NP ° §°¥¸¨¬» § 
¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿, ²® ¥±²¼ P=NP. ¥±¬®²°¿ ­  ¬­®£®«¥²­¨¥
¨±±«¥¤®¢ ­¨¿, ­¨ ¤«¿ ®¤­®© NP-¯®«­®© § ¤ ·¨ ­¥ ­ ©¤¥­ ¯®«¨­®¬¨ «¼­»© ° §°¥¸ ¾¹¨©  «£®°¨²¬.
 · ±²­®±²¨, § ¤ ·  HAM-PATH (® £ ¬¨«¼²®­®¢®¬ ¶¨ª«¥) ¿¢«¿¥²±¿ NP-¯®«­®©.  ª¨¬ ®¡° §®¬, ¥±«¨ ­ ³·¨²¼±¿ °¥¸ ²¼ ¥¥ §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿, ²® ¨ ¤«¿ ¢±¥µ § ¤ · ª« ±±  NP ±³¹¥±²¢®¢ «¨ ¡»
¯®«¨­®¬¨ «¼­»¥  «£®°¨²¬». ¥°¥´®°¬³«¨°®¢ª : NP n P ­¥¯³±²®,
²® HAM-PATH 2 NP n P.
¥´®°¬ «¼­® £®¢®°¿, NP-¯®«­»¥ ¿§»ª¨ ¿¢«¿¾²±¿ ± ¬»¬¨ À²°³¤­»¬¨Á ¢ ª« ±±¥ NP. °¨ ½²®¬ ²°³¤­®±²¼ ¿§»ª®¢ ¬®¦­® ±° ¢­¨¢ ²¼, ±¢®¤¿ ®¤¨­ ¿§»ª ª ¤°³£®¬³.  ½²®¬ ° §¤¥«¥ ¬» ¤ ¥¬ ®¯°¥¤¥«¥­¨¥ ±¢®¤¨¬®±²¨, § ²¥¬ ®¯°¥¤¥«¿¥¬ ª« ±± NP-¯®«­»µ ¿§»ª®¢ ¨
³±² ­ ¢«¨¢ ¥¬ ¯®«­®²³ ®¤­®£® ª®­ª°¥²­®£® ¿§»ª , CIRCUIT-SAT.
 ° §¤¥«¥ 36.5 ¬» ¨±¯®«¼§³¥¬ ¬¥²®¤ ±¢¥¤¥­¨¿ ¤«¿ ¤®ª § ²¥«¼±²¢ 
NP-¯®«­®²» ¬­®£¨µ ¤°³£¨µ § ¤ ·.
¢®¤¨¬®±²¼
®¢®°¿ ­¥´®°¬ «¼­®, § ¤ ·  Q ±¢®¤¨²±¿ ª § ¤ ·¥ Q0, ¥±«¨ § ¤ ·³ Q ¬®¦­® °¥¸¨²¼ ¤«¿ «¾¡®£® ¢µ®¤ , ±·¨² ¿ ¨§¢¥±²­»¬ °¥¸¥­¨¥
§ ¤ ·¨ Q0 ¤«¿ ª ª®£®-²® ¤°³£®£® ¢µ®¤ .  ¯°¨¬¥°, § ¤ ·  °¥¸¥­¨¿ «¨­¥©­®£® ³° ¢­¥­¨¿ ±¢®¤¨²±¿ ª § ¤ ·¥ °¥¸¥­¨¿ ª¢ ¤° ²­®£®
³° ¢­¥­¨¿ («¨­¥©­®¥ ³° ¢­¥­¨¥ ¬®¦­® ¯°¥¢° ²¨²¼ ¢ ª¢ ¤° ²­®¥,
¤®¡ ¢¨¢ ´¨ª²¨¢­»© ±² °¸¨© ·«¥­). ±«¨ § ¤ ·  Q ±¢®¤¨²±¿ ª § ¤ ·¥ Q0 , ²® «¾¡®©  «£®°¨²¬, °¥¸ ¾¹¨© Q0 , ¬®¦­® ¨±¯®«¼§®¢ ²¼
¤«¿ °¥¸¥­¨¿ § ¤ ·¨ Q, ²® ¥±²¼ Q À­¥ ²°³¤­¥¥Á Q0 .
 ¤¨¬ ´®°¬ «¼­®¥ ®¯°¥¤¥«¥­¨¥. ®¢®°¿², ·²® ¿§»ª L1 ±¢®¤¨²±¿
§  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿ (is polynomial-time reducible) ª ¿§»ª³ L2
(§ ¯¨±¼: L1 6P L2), ¥±«¨ ±³¹¥±²¢³¥² ² ª ¿ ´³­ª¶¨¿ f : f0; 1g !
f0; 1g, ¢»·¨±«¨¬ ¿ §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿, ·²® ¤«¿ «¾¡®£® x 2
f0; 1g,
x 2 L1 , f (x) 2 L2
(36:1)
³­ª¶¨¾ f ­ §»¢ ¾² ±¢®¤¿¹¥© ´³­ª¶¨¥© (reduction function).  
¯®«¨­®¬¨ «¼­»©  «£®°¨²¬ F , ¢»·¨±«¿¾¹¨© ´³­ª¶¨¾ f | ±¢®¤¿-

NP-¯®«­®²  ¨ ±¢®¤¨¬®±²¼

831

¹¨¬  «£®°¨²¬®¬ (reduction algorithm).
¨±³­®ª 36.3 ¨««¾±²°¨°³¥² ®¯°¥¤¥«¥­¨¥ ±¢®¤¨¬®±²¨ ¿§»ª  L1 ª
¿§»ª³ L2 §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿.  ¦¤»© ¿§»ª ¥±²¼ ¯®¤¬­®¦¥±²¢® ¬­®¦¥±²¢  f0; 1g. ¢®¤¿¹ ¿ ´³­ª¶¨¿ ¯¥°¥¢®¤¨² «¾¡®¥ ±«®¢®
x 2 L1 ¢ ±«®¢  f (x) 2 L2 ,   ±«®¢® x 62 L1 | ¢ ±«®¢® f (x) 62 L2.
®½²®¬³, ¥±«¨ ¬» ³§­ ¥¬, ¯°¨­ ¤«¥¦¨² «¨ ±«®¢® f (x) ¿§»ª³ L2 ,
¬» ²¥¬ ± ¬»¬ ¯®«³·¨¬ ®²¢¥² ­  ¢®¯°®± ® ¯°¨­ ¤«¥¦­®±²¨ ±«®¢ 
x ¿§»ª³ L1.
¥¬¬  36.3
±«¨ ¿§»ª L1  f0; 1g ±¢®¤¨²±¿ §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿ ª ¿§»ª³ L2  f0; 1g, ²® ²® ¨§ L2 2 P ±«¥¤³¥² L1 2 P.
®ª § ²¥«¼±²¢® ³±²¼ A2 | ¯®«¨­®¬¨ «¼­»©  «£®°¨²¬, ° ±¯®§­ ¾¹¨© ¿§»ª L2,   F | ¯®«¨­®¬¨ «¼­»©  «£®°¨²¬, ±¢®¤¿¹¨©
¿§»ª L1 ª ¿§»ª³ L2 . ®±²°®¨¬  «£®°¨²¬ A1, ª®²®°»© ¡³¤¥² § 
¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿ ° §°¥¸ ²¼ ¿§»ª L1 .
¨±³­®ª 36.4 ¨««¾±²°¨°³¥² ¯®±²°®¥­¨¥. ®«³·¨¢ ¢µ®¤ x 2
f0; 1g,  «£®°¨²¬ A1 (± ¯®¬®¹¼¾  «£®°¨²¬  F ) ¯®«³· ¥² f (x) ¨
± ¯®¬®¹¼¾  «£®°¨²¬  A2 ¯°®¢¥°¿¥², ¯°¨­ ¤«¥¦¨² «¨ ±«®¢® f (x)
¿§»ª³ L2 . ¥§³«¼² ² ° ¡®²»  «£®°¨²¬  A2 ­  ±«®¢¥ f (x) ¨ ¢»¤ ¥²±¿  «£®°¨²¬®¬ A1 ¢ ª ·¥±²¢¥ ®²¢¥² .
¯°¥¤¥«¥­¨¥ (36.1) £ ° ­²¨°³¥², ·²®  «£®°¨²¬ A1 ¤ ¥² ¯° ¢¨«¼­»© ®²¢¥²; ®­ ¯®«¨­®¬¨ «¥­, ¯®±ª®«¼ª³ ¯®«¨­®¬¨ «¼­»  «£®°¨²¬»
F ¨ A1 (³¯°. 36.1-6).
NP-¯®«­®² 
®­¿²¨¥ ±¢®¤¨¬®±²¨ ¯®§¢®«¿¥² ¯°¨¤ ²¼ ²®·­»© ±¬»±« ³²¢¥°¦¤¥­¨¾ ® ²®¬, ·²® ®¤¨­ ¿§»ª ­¥ ¬¥­¥¥ ²°³¤¥­, ·¥¬ ¤°³£®© (± ²®·­®±²¼¾ ¤® ¯®«¨­®¬ ).  ¯¨±¼ L1 6P L2 ¬®¦­® ¨­²¥°¯°¥²¨°®¢ ²¼
² ª: ±«®¦­®±²¼ ¿§»ª  L1 ­¥ ¡®«¥¥ ·¥¬ ¯®«¨­®¬¨ «¼­® ¯°¥¢®±µ®¤¨²
±«®¦­®±²¼ ¿§»ª  L2 .  ¨¡®«¥¥ ²°³¤­» ¢ ½²®¬ ±¬»±«¥ NP-¯®«­»¥
§ ¤ ·¨.
§»ª L  f0; 1g ­ §»¢ ¥²±¿ NP-¯®«­»¬ (NP-complete), ¥±«¨
1: L 2 NP:
2: L0 6P L ¤«¿ «¾¡®£® L0 2 NP
« ±± NP-¯®«­»µ ¿§»ª®¢ ¡³¤¥¬ ®¡®§­ · ²¼ NPC. §»ª¨, ª®²®°»¥ ®¡« ¤ ¾² ±¢®©±²¢®¬ 2 (­® ­¥ ®¡¿§ ²¥«¼­® ®¡« ¤ ¾² ±¢®©±²¢®¬
1), ­ §»¢ ¾² NP-²°³¤­»¬¨ (NP-hard)
±­®¢­®¥ ±¢®©±²¢® NP-¯®«­»µ ¿§»ª®¢ ±®±²®¨² ¢ ±«¥¤³¾¹¥¬:
¥®°¥¬  36.4
±«¨ ­¥ª®²®° ¿ NP-¯®«­ ¿ § ¤ ·  ° §°¥¸¨¬  §  ¯®«¨­®¬¨ «¼­®¥
¢°¥¬¿, ²® P = NP.
±«¨ ¢ ª« ±±¥ NP ±³¹¥±²¢³¥² § ¤ · , ­¥ ° §°¥¸¨¬ ¿ §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿, ²® ¢±¥ NP-¯®«­»¥ § ¤ ·¨ ² ª®¢».
®ª § ²¥«¼±²¢®
³±²¼ L | NP-¯®«­»© ¿§»ª, ª®²®°»© ®¤­®¢°¥¬¥­­® ®ª § «±¿
° §°¥¸¨¬»¬ §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿ (L 2 P ¨ L 2 NPC). ®£¤ 
¤«¿ «¾¡®£® L0 2 NP ¯® ±¢®©±²¢³ 2 ®¯°¥¤¥«¥­¨¿ NP-¯®«­®£® ¿§»-

832

« ¢  36 NP-¯®«­®² 

36.5
°¥¤¯®« £ ¥¬®¥ ±®®²­®¸¥­¨¥ ¬¥¦¤³ ª« ±± ¬¨ P. NP ¨ NPC. « ±±» P ¨ NPC ±®¤¥°¦ ²±¿ ¢ NP (·²® ®·¥¢¨¤­®), ¨, ¬®¦­® ¯®« £ ²¼,
­¥ ¯¥°¥±¥ª ¾²±¿ ¨ ­¥ ¯®ª°»¢ ¾² ¢±¥£® NP.
: ¢­³²°¨ ²°¥³£®«¼­¨ª®¢ ± ª°³¦®·ª ¬¨ ­ ¤® ­ ¯¨± ²¼
, ¢­³²°¨ £­³²»µ ²°¥³£®«¼­¨ª®¢ | , ¢­³²°¨ ª°¨¢»µ ¯°¿¬®³£®«¼­¨ª®¢ | .
¢  ­ ¡®°  ¢µ®¤­»µ ¤ ­­»µ ¤«¿ § ¤ ·¨ CIRCUIT-SAT. (a)  ¡®°
¢µ®¤­»µ §­ ·¥­¨© hx1 = 1; x2 = 1; x3 = 0i ¤ ¥² §­ ·¥­¨¥ 1 ­  ¢»µ®¤¥, ² ª ·²® ½²  ±µ¥¬  ¢»¯®«­¨¬ . (b) «¿ ½²®© ±µ¥¬» ­¨ª ª®©
­ ¡®° ¢µ®¤­»µ §­ ·¥­¨© ­¥ ¯°¨¢®¤¨² ª ¥¤¨­¨¶¥ ­  ¢»µ®¤¥, ² ª ·²®
½²  ±µ¥¬  ­¥ ¢»¯®«­¨¬ .
ª  ¨¬¥¥¬ L0 6P L. «¥¤®¢ ²¥«¼­®, L0 2 P («¥¬¬  36.3), ¨ ¯¥°¢®¥
³²¢¥°¦¤¥­¨¥ ²¥®°¥¬» ¤®ª § ­®.
²®°®¥ ³²¢¥°¦¤¥­¨¥ ²¥®°¥¬» ¿¢«¿¥²±¿ ¯¥°¥´®°¬³«¨°®¢ª®© ¯¥°¢®£®.
 ª¨¬ ®¡° §®¬, £¨¯®²¥§  P 6= NP ®§­ · ¥², ·²® NP-¯®«­»¥ § ¤ ·¨ ­¥ ¬®£³² ¡»²¼ °¥¸¥­» §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿. ®«¼¸¨­±²¢®
½ª±¯¥°²®¢ ¯®« £ ¥², ·²® ½²® ¤¥©±²¢¨²¥«¼­® ² ª; ¯°¥¤¯®« £ ¥¬®¥
±®®²­®¸¥­¨¥ ¬¥¦¤³ ª« ±± ¬¨ P, NP ¨ CNP ¯®ª § ­® ­  °¨±. 36.5.
®­¥·­®, ¬» ­¥ ¬®¦¥¬ ¡»²¼ ³¢¥°¥­», ·²® ®¤­ ¦¤» ª²®-­¨¡³¤¼
­¥ ¯°¥¤º¿¢¨² ¯®«¨­®¬¨ «¼­»©  «£®°¨²¬ ¤«¿ °¥¸¥­¨¿ NP-¯®«­®©
§ ¤ ·¨ ¨ ­¥ ¤®ª ¦¥² ²¥¬ ± ¬»¬, ·²® P = NP. ® ¯®ª  ·²® ½²®£®
­¨ª®¬³ ­¥ ³¤ «®±¼, ¨ ¯®²®¬³ ¤®ª § ²¥«¼±²¢® NP-¯®«­®²» ­¥ª®²®°®© § ¤ ·¨ ¿¢«¿¥²±¿ ³¡¥¤¨²¥«¼­»¬  °£³¬¥­²®¬ ¢ ¯®«¼§³ ²®£®, ·²®
®­  ¿¢«¿¥²±¿ ¯° ª²¨·¥±ª¨ ­¥° §°¥¸¨¬®©.
 ¤ ·  ® ¢»¯®«­¨¬®±²¨ ¤«¿ ±µ¥¬
 ª ¬» ³¦¥ £®¢®°¨«¨, ¬» ­ ·­¥¬ ± ®¤­®© ª®­ª°¥²­®© § ¤ ·¨; ³±² ­®¢¨¢ ¥¥ NP-¯®«­®²³, ¬®¦­® ¤®ª §»¢ ²¼ NP-¯®«­®²³ ¤°³£¨µ § ¤ · ¬¥²®¤®¬ ±¢¥¤¥­¨¿.  ª ·¥±²¢¥ ² ª®© § ¤ ·¨ ¬» ° ±±¬®²°¨¬ § ¤ ·³ ® ¢»¯®«­¨¬®±²¨ ¤«¿ ±µ¥¬ (circuit-satisfyability problem, ¨«¨ CIRCUIT-SAT).  ±®¦ «¥­¨¾, ¯®¤°®¡­®¥ ¤®ª § ²¥«¼±²¢®
NP-¯®«­®²» ½²®© § ¤ ·¨ ²°¥¡³¥² ° ±±¬®²°¥­¨¿ ²¥µ­¨·¥±ª¨µ ¤¥² «¥©, ¢»µ®¤¿¹¥£® §  ° ¬ª¨ ¤ ­­®© ª­¨£¨. ®½²®¬³ ¬» ®£° ­¨·¨¬±¿ ­¥´®°¬ «¼­»¬ ­ ¡°®±ª®¬ ¤®ª § ²¥«¼±²¢ , ¯®« £ ¿, ·²® ·¨² ²¥«¼ ¨¬¥¥² ¯°¥¤±² ¢«¥­¨¥ ® ±µ¥¬ µ ¨§ ´³­ª¶¨®­ «¼­»µ ½«¥¬¥­²®¢
(±¬. £«. 29).
  °¨±³­ª¥ 36.6 ¯®ª § ­» ¤¢¥ ±µ¥¬» ¨§ ´³­ª¶¨®­ «¼­»µ ½«¥¬¥­²®¢. ¡¥ ¨¬¥¾² ¯® ²°¨ ¢µ®¤  ¨ ¯® ®¤­®¬³ ¢»µ®¤³.
³¤¥¬ ° ±±¬ ²°¨¢ ²¼ ­ ¡®°» §­ ·¥­¨© ¡³«¥¢»µ ¯¥°¥¬¥­­»µ, ±®®²¢¥²±²¢³¾¹¨µ ¢µ®¤ ¬ ±µ¥¬ (truth assignments). µ¥¬  ¨§ ´³­ª¶¨®­ «¼­»µ ½«¥¬¥­²®¢ ± ®¤­¨¬ ¢»µ®¤®¬ ­ §»¢ ¥²±¿ ¢»¯®«­¨¬®©
(satisable), ¥±«¨ ±³¹¥±²¢³¥² ¢»¯®«­¿¾¹¨© ­ ¡®° (satisfying assignment), ²® ¥±²¼ ² ª®© ­ ¡®° §­ ·¥­¨© ¢µ®¤®¢, ¯°¨ ª®²®°®¬ ­  ¢»µ®-

NP-¯®«­®²  ¨ ±¢®¤¨¬®±²¼

833

¤¥ ±µ¥¬» ¯®¿¢«¿¥²±¿ ¥¤¨­¨¶ .  ¯°¨¬¥°, ±µ¥¬  °¨±. 36.6( ) ¨¬¥¥²
¢»¯®«­¿¾¹¨© ­ ¡®° hx1 = 1; x2 = 1; x3 = 0i ¨ ¯®²®¬³ ¿¢«¿¥²±¿ ¢»¯®«­¨¬®©.  ²® ¦¥ ¢°¥¬¿ ­¨ª ª¨¥ §­ ·¥­¨¿ ¯¥°¥¬¥­­»µ x1 ; x2; x3
¤«¿ ±µ¥¬» °¨±. 36.6(¡) ­¥ ¯°¨¢®¤¿² ª ¯®¿¢«¥­¨¾ 1 ­  ¢»µ®¤¥. «¥¤®¢ ²¥«¼­®, ½²  ±µ¥¬  ­¥¢»¯®«­¨¬ .
 ¤ ·  ® ¢»¯®«­¨¬®±²¨ ±µ¥¬» (circuit-satisability problem) ²°¥¡³¥² ¢»¿±­¨²¼, À¿¢«¿¥²±¿ «¨ ¤ ­­ ¿ ±µ¥¬ , ±®±² ¢«¥­­ ¿ ¨§ ½«¥¬¥­²®¢ .  ¨ , ¢»¯®«­¨¬®©Á. ®­¥·­®, ­³¦­® ¤®£®¢®°¨²¼±¿ ®
±¯®±®¡¥ ¯°¥¤±² ¢«¥­¨¿ ¡³«¥¢»µ ±µ¥¬ ± ¯®¬®¹¼¾ ±²°®ª ¡¨²®¢ | ½²®
¤¥« ¥²±¿ ¥±²¥±²¢¥­­»¬ ®¡° §®¬ (¯®¤®¡­® ²®¬³, ª ª ½²® ¤¥« ¥²±¿
¤«¿ £° ´®¢); ¯°¨ ½²®¬ ° §¬¥° ¯®«³·¥­­®© ±²°®ª¨ ¡¨²®¢ ­¥ ¡®«¥¥
·¥¬ ¯®«¨­®¬¨ «¼­® § ¢¨±¨² ®² ° §¬¥°  ±µ¥¬».  ´¨ª±¨°®¢ ¢ ² ª®¥
¯°¥¤±² ¢«¥­¨¥, ° ±±¬®²°¨¬ ¿§»ª
CIRCUIT-SAT = fhC i : C | ¢»¯®«­¨¬ ¿ ±µ¥¬  ¨§ ´³­ª¶¨®­ «¼­»µ ½«¥¬¥­²®¢g
 ¤ ·³ ® ¢»¯®«­¨¬®±²¨ ¬®¦­® ±´®°¬³«¨°®¢ ²¼ ² ª: ¬®¦­® «¨
¤ ­­³¾ ±µ¥¬³ § ¬¥­¨²¼ ­  ½ª¢¨¢ «¥­²­³¾, ¢ ª®²®°®© ¢»µ®¤ ±®¥¤¨­¥­ ­ ¯°¿¬³¾ ± ­³«¥¢»¬ ¯°®¢®¤®¬.
 §³¬¥¥²±¿, ¬®¦­® ³§­ ²¼, ¢»¯®«­¨¬  «¨ ¤ ­­ ¿ ±µ¥¬ , ¯¥°¥¡° ¢ ¢±¥ ¢®§¬®¦­»¥ ª®¬¡¨­ ¶¨¨ §­ ·¥­¨© ¢µ®¤®¢.  ±®¦ «¥­¨¾,
¨µ ¬­®£®: ¤«¿ ±µ¥¬» ± k ¢µ®¤ ¬¨ ¯°¨¤¥²±¿ ¯¥°¥¡° ²¼ 2k ­ ¡®°®¢
| ¢°¥¬¿ ° ¡®²» ² ª®£® ¯¥°¥¡®°­®£®  «£®°¨²¬  ­¥ ®£° ­¨·¥­® ¯®«¨­®¬®¬ (®² k, ¨«¨, ·²® ²® ¦¥, ®² ° §¬¥°  ±µ¥¬»).  ª ¬» ³¦¥
®²¬¥· «¨, ¡®«¼¸¨­±²¢® ±¯¥¶¨ «¨±²®¢ ³¢¥°¥­», ·²® ·²® § ¤ ·  ®
¢»¯®«­¨¬®±²¨ ±µ¥¬» ­¥ ¬®¦¥² ¡»²¼ °¥¸¥­  ¯®«¨­®¬¨ «¼­»¬  «£®°¨²¬®¬ (¯®±ª®«¼ª³ NP-¯®«­ ).
«¿ ­ · «  ³¡¥¤¨¬±¿, ·²® § ¤ ·  CIRCUIT-SAT ¯°¨­ ¤«¥¦¨²
ª« ±±³ NP.
¥¬¬  36.5
 ¤ ·  CIRCUIT-SAT ¯°¨­ ¤«¥¦¨² ª« ±±³ NP.
®ª § ²¥«¼±²¢®
¥°²¨´¨ª ²®¬ ¿¢«¿¥²±¿ ­ ¡®° ¢µ®¤­»µ §­ ·¥­¨©, ¯°¨ ª®²®°»µ
¢»µ®¤­®¥ §­ ·¥­¨¥ ° ¢­® 1 | ¿±­®, ·²® ½²®² ´ ª² «¥£ª® ¯°®¢¥°¨²¼
§  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿.
«¿ ¤®ª § ²¥«¼±²¢  NP-¯®«­®²» § ¤ ·¨ CIRCUIT-SAT ­ ¬ ®±² «®±¼ ¤®ª § ²¼, ·²® ¤ ­­ ¿ § ¤ ·  NP-²°³¤­ , ²® ¥±²¼ ·²® «¾¡ ¿
§ ¤ ·  ¨§ ª« ±±  NP ±¢®¤¨²±¿ ª § ¤ ·¥ CIRCUIT-SAT §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿. ®«­®¥ ¤®ª § ²¥«¼±²¢® ½²®£® ³²¢¥°¦¤¥­¨¿ ¤®¢®«¼­®
£°®¬®§¤ª®, ² ª ·²® ¬» ¤ ¤¨¬ «¨¸¼ ­ ¡°®±®ª ¤®ª § ²¥«¼±²¢ .
®°®²ª® ­ ¯®¬­¨¬, ª ª ³±²°®¥­ ª®¬¯¼¾²¥°. °®£° ¬¬  µ° ­¨²±¿ ¢ ¯ ¬¿²¨ ª®¬¯¼¾²¥°  ¢ ¢¨¤¥ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¨­±²°³ª¶¨©
(ª®¬ ­¤). ­±²°³ª¶¨¨ ±®¤¥°¦ ² ª®¤ ®¯¥° ¶¨¨, ª®²®°³¾ ­³¦­® ¢»¯®«­¨²¼,  ¤°¥±   °£³¬¥­²®¢ (®¯¥° ­¤®¢) ª®¬ ­¤» ¨  ¤°¥±, ¯® ª®²®°®¬³ ±«¥¤³¥² § ¯¨± ²¼ °¥§³«¼² ² ®¯¥° ¶¨¨.  ±¯¥¶¨ «¼­®¬ ¬¥±²¥
¯ ¬¿²¨, ª®²®°®¥ ­ §»¢ ¥²±¿ ±·¥²·¨ª®¬ ª®¬ ­¤ (program counter),
µ° ­¨²±¿  ¤°¥± ²¥ª³¹¥© ª®¬ ­¤». ²®²  ¤°¥± ¢ ¯°®¶¥±±¥ ¢»¯®«­¥­¨¿ ¯°®£° ¬¬» ¬¥­¿¥²±¿ (¯®±²¥¯¥­­® ³¢¥«¨·¨¢ ¿±¼ ¯°¨ ¢»¯®«­¥-

834

« ¢  36 NP-¯®«­®² 

­¨¨ ®¡»·­»µ ª®¬ ­¤ ¨«¨ ¯¥°¥±ª ª¨¢ ¿ ¢ ¤°³£®¥ ¬¥±²® ¯°®£° ¬¬»
¢ ³±«®¢­»µ ®¯¥° ²®° µ ¨ ¶¨ª« µ).
¥ª³¹¥¥ ±®±²®¿­¨¥ ¯°®£° ¬¬», ®¯°¥¤¥«¿¾¹¥¥ ¤ «¼­¥©¸¨© µ®¤
¥¥ ¨±¯®«­¥­¨¿, § ¯¨± ­® ¢ ª ¦¤»© ¬®¬¥­² ¢ ¯ ¬¿²¨ (¬» ¢ª«¾· ¥¬ ¢ ½²® ¯®­¿²¨¥ °¥£¨±²°» ¯°®¶¥±±®° , ±·¥²·¨ª ª®¬ ­¤ ¨ ².¯.).
 ¦¤®¥ ±®±²®¿­¨¥ ¯ ¬¿²¨ ª®¬¯¼¾²¥°  ¡³¤¥¬ ­ §»¢ ²¼ ª®­´¨£³° ¶¨¥© (conguration). »¯®«­¥­¨¥ ¨­±²°³ª¶¨© ¬®¦¥² ° ±±¬ ²°¨¢ ²¼±¿ ª ª ¯®±«¥¤®¢ ²¥«¼­®¥ ¯°¥®¡° §®¢ ­¨¥ ²¥ª³¹¥© ª®­´¨£³° ¶¨¨ ¢ ±«¥¤³¾¹³¾ §  ­¥© ¢ ±®®²¢¥²±²¢¨¨ ± ­¥ª®²®°»¬¨ ¯° ¢¨« ¬¨. ²¨ ¯° ¢¨«  ®¯°¥¤¥«¿¾²±¿ ½«¥ª²°®­¨ª®© ª®¬¯¼¾²¥°  ¨ ¬®£³²
¡»²¼ ¯°¥¤±² ¢«¥­» ¢ ¢¨¤¥ ±µ¥¬» ¨§ ´³­ª¶¨®­ «¼­»µ ½«¥¬¥­²®¢
(¥±«¨ ª®­´¨£³° ¶¨¿ ¯°¥¤±² ¢«¿¥²±¿ ­ ¡®°®¬ n ¡¨²®¢, ²® ½²  ±µ¥¬ 
¨¬¥¥² n ¢µ®¤®¢ ¨ n ¢»µ®¤®¢).  ¤®ª § ²¥«¼±²¢¥ ±«¥¤³¾¹¥© «¥¬¬»
¬» ¡³¤¥¬ ®¡®§­ · ²¼ ½²³ ±µ¥¬³ ·¥°¥§ M .
¥¬¬  36.6
 ¤ ·  CURCUIT-SAT ¿¢«¿¥²±¿ NP-²°³¤­®©.
®ª § ²¥«¼±²¢®
³±²¼ L | ¯°®¨§¢®«¼­»© ¿§»ª ¨§ ª« ±±  NP. » ¯®±²°®¨¬ ´³­ª¶¨¾ f , ª®²®° ¿ ¡³¤¥² ®²®¡° ¦ ²¼ ª ¦¤®¥ ¤¢®¨·­®¥ ±«®¢® ¢ ±µ¥¬³
C = f (x), ¤«¿ ª®²®°®© x 2 L ° ¢­®±¨«¼­® C 2 CIRCUIT ; SAT.
(³­ª¶¨¿ f ¡³¤¥² ¢»·¨±«¿²¼±¿ ¯®«¨­®¬¨ «¼­»¬  «£®°¨²¬®¬.)
®±ª®«¼ª³ L 2 NP, ±³¹¥±²¢³¥²  «£®°¨²¬ A, ¯°®¢¥°¿¾¹¨© ¤ ­­»© ¿§»ª §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿. » ¨±¯®«¼§³¥¬ ½²®²  «£®°¨²¬
¤«¿ ¯®±²°®¥­¨¿ ±¢®¤¿¹¥£®  «£®°¨²¬  F . ³±²¼ T (n) | ­ ¨¡®«¼¸¥¥
¢°¥¬¿ ° ¡®²»  «£®°¨²¬  A ­  ¢µ®¤ µ ¤«¨­» n (­ ¯®¬­¨¬, ·²® ¬»
­ §»¢ ¥¬ ¢µ®¤®¬ ¯¥°¢»©  °£³¬¥­²  «£®°¨²¬  A; ¢²®°®© ­ §»¢ ¥²±¿ ±¥°²¨´¨ª ²®¬). »¡¥°¥¬ ² ª®¥ ·¨±«® k, ·²® T (n) = O(nk ) ¨
¤«¨­  ±¥°²¨´¨ª ²®¢ ¤«¿ ¢µ®¤®¢ ¤«¨­» n ²®¦¥ ¥±²¼ O(nk ). (°¥¬¿
° ¡®²»  «£®°¨²¬  ¯®«¨­®¬¨ «¼­® § ¢¨±¨² ®² ®¡¹¥© ¤«¨­» ³±«®¢¨¿ ¨ ±¥°²¨´¨ª ² . ® ¯®±ª®«¼ª³ ¤«¨­  ±¥°²¨´¨ª ²  ®£° ­¨·¥­ 
¯®«¨­®¬®¬ ®² ¤«¨­» ³±«®¢¨¿, ¢°¥¬¿ ° ¡®²»  «£®°¨²¬  ² ª¦¥ ®£° ­¨·¥­® ¯®«¨­®¬®¬ ®² n.)
¤¥¿ ¤®ª § ²¥«¼±²¢  ±®±²®¨² ¢ ¯°¥¤±² ¢«¥­¨¨ ° ¡®²»  «£®°¨²¬  A ¢ ¢¨¤¥ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ª®­´¨£³° ¶¨©.  ª ¯®ª § ­® ­ 
°¨±. 36.7, ª ¦¤ ¿ ª®­´¨£³° ¶¨¿ ±®±²®¨² ¨§ · ±²¨, ±®¤¥°¦ ¹¥© ¯°®£° ¬¬³, ±·¥²·¨ª  ª®¬ ­¤, ±®±²®¿­¨¿ °¥£¨±²°®¢ ¯°®¶¥±±®° , ¢µ®¤ 
x, ±¥°²¨´¨ª ²  y ¨ ° ¡®·¥© ¯ ¬¿²¨.
 · «¼­®¥ ±®±²®¿­¨¥ ¯ ¬¿²¨ ª®¬¯¼¾²¥°  ®¡° §³¥² ª®­´¨£³° ¶¨¾ c0 .  ²¥¬ ª ¦¤ ¿ ª®­´¨£³° ¶¨¿ ci ¯°¥®¡° §³¥²±¿ ¢ ±«¥¤³¾¹³¾ ª®­´¨£³° ¶¨¾ ci+1 , ¯°¨·¥¬ ½²® ¯°¥®¡° §®¢ ­¨¥ ¢»¯®«­¿¥²±¿
± ¯®¬®¹¼¾ ±µ¥¬» ¨§ ´³­ª¶¨®­ «¼­»µ ½«¥¬¥­²®¢ M , °¥ «¨§®¢ ­­®© ¢ ½«¥ª²°®­¨ª¥ ª®¬¯¼¾²¥° .  ª®­¶¥ ° ¡®²»  «£®°¨²¬ ¯®«³· ¥² ®²¢¥² (­®«¼ ¨«¨ ¥¤¨­¨¶³). ³¤¥¬ ±·¨² ²¼, ·²® ½²®² ®²¢¥²
§ ¯¨±»¢ ¥²±¿ ¢ ®¯°¥¤¥«¥­­®¥ ¬¥±²® ¯ ¬¿²¨. ®±«¥ ¯®«³·¥­¨¿ ®²¢¥²  ¯°®£° ¬¬  ®±² ­ ¢«¨¢ ¥²±¿, ¨ ±®±²®¿­¨¥ ¯ ¬¿²¨ ¢ ¤ «¼­¥©¸¥¬
­¥ ¨§¬¥­¿¥²±¿. «¥¤®¢ ²¥«¼­®, ¥±«¨  «£®°¨²¬ ¤¥« ¥² ­¥ ¡®«¥¥ T (n)

NP-¯®«­®²  ¨ ±¢®¤¨¬®±²¼

835

¯¥°¥¢®¤» ­ ¤¯¨±¥©:
input bits | ±¥°²¨´¨ª ² aux machine state | °¥£¨±²°» ¯°®¶¥±±®° 
working storage | ° ¡®· ¿ ¯ ¬¿²¼
0/1 output | ¢»µ®¤­®© ¡¨²
36.7 ®±«¥¤®¢ ²¥«¼­®±²¼ ª®­´¨£³° ¶¨©, ±®®²¢¥²±²¢³¾¹ ¿ ° ¡®²¥
 «£®°¨²¬  A ¤«¿ ¢µ®¤  x ¨ ±¥°²¨´¨ª ²  y .  ¦¤ ¿ ª®­´¨£³° ¶¨¿
±®®²¢¥²±²¢³¥² ±®±²®¿­¨¾ ¢»·¨±«¥­¨¿ ¢ ª ª®©-²® ¬®¬¥­² ¢°¥¬¥­¨ ¨
¢ª«¾· ¥² ¢ ±¥¡¿ (¯®¬¨¬® A, x ¨ y ) ² ª¦¥ §­ ·¥­¨¥ ±·¥²·¨ª  ª®¬ ­¤
(PC),   ² ª¦¥ ±®¤¥°¦¨¬®¥ °¥£¨±²°®¢ ¯°®¶¥±±®°  ¨ ° ¡®·¥© ¯ ¬¿²¨.  ¦¤ ¿ ª®­´¨£³° ¶¨¿ ¯¥°¥¢®¤¨²±¿ ¢ ±«¥¤³¾¹³¾ ± ¯®¬®¹¼¾
±µ¥¬» M ¨§ ´³­ª¶¨®­ «¼­»µ ½«¥¬¥­²®¢. »µ®¤­®© ¡¨² § ¯¨± ­ ¢
¢»¤¥«¥­­®¬ ¬¥±²¥ ° ¡®·¥© ¯ ¬¿²¨.
¸ £®¢, °¥§³«¼² ² ° ¡®²»  «£®°¨²¬  ­ µ®¤¨²±¿ ¢ ´¨ª±¨°®¢ ­­®¬
¡¨²¥ ª®­´¨£³° ¶¨¨ cT (n).
 ª¨¬ ®¡° §®¬, ¬®¦­® ¯®±²°®¨²¼ ±µ¥¬³, ª®²®° ¿ ¯®±«¥¤®¢ ²¥«¼­® ¢»·¨±«¿¥² ª®­´¨£³° ¶¨¨ c1; c2; : : : ; cT (N ). ²  ±µ¥¬  ±®±²®¨² ¨§
¯®±«¥¤®¢ ²¥«¼­® ±®¥¤¨­¥­­»µ T (n) ª®¯¨© ±µ¥¬» M . »µ®¤ i-®© ª®¯¨¨ ±µ¥¬» M ¡³¤¥² ª®­´¨£³° ¶¨¥© ci . »µ®¤­»¬¨ §­ ·¥­¨¿¬¨ ±µ¥¬» ¡³¤³² ¡¨²» ª®­´¨£³° ¶¨¨ cT (n). ¯¨± ­­³¾ ±µ¥¬³ ­ §®¢¥¬ C 0.
±¯®¬­¨¬, ·²® ¤®«¦¥­ ¤¥« ²¼ ±¢®¤¿¹¨©  «£®°¨²¬ F . ®«³·¨¢
¢µ®¤­®¥ ±«®¢® x, ®­ ¤®«¦¥­ ¯®±²°®¨²¼ ±µ¥¬³ C = f (x), ª®²®° ¿ ¢»¯®«­¨¬ , ¥±«¨ ¨ ²®«¼ª® ¥±«¨ ±³¹¥±²¢³¥² ² ª®© ±¥°²¨´¨ª ² y , ·²®
A(x; y ) = 1. «¿ ½²®£® ­ ©¤¥¬ ¤«¨­³ n ±«®¢  x ¨ ¯®±²°®¨¬ ±µ¥¬³
C 0 ®¯¨± ­­»¬ ±¯®±®¡®¬. µ®¤®¬ ±µ¥¬» C 0 ¡³¤¥² ­ · «¼­ ¿ ª®­´¨£³° ¶¨¿ ¢»·¨±«¥­¨¿ A(x; y ),   ¢»µ®¤®¬ | ª®­´¨£³° ¶¨¿ cT (n).
 ²¥¬ ¯®«³·¥­­³¾ ±µ¥¬³ C 0 ±«¥¤³¥² ­¥¬­®£® ¯°¥®¡° §®¢ ²¼. ®¯¥°¢»µ, ­³¦­® ³±² ­®¢¨²¼ §­ ·¥­¨¿ ¢µ®¤­»µ ¯¥°¥¬¥­­»µ, ±®®²¢¥²±²¢³¾¹¨µ ¯°®£° ¬¬¥ A, ­ · «¼­®¬³ ¯®«®¦¥­¨¾ ±·¥²·¨ª  ª®¬ ­¤,
¢µ®¤³ x, ¨±µ®¤­®¬³ ±®±²®¿­¨¾ ±«³¦¥¡­®© ¨­´®°¬ ¶¨¨ ¨ ° ¡®·¥©
· ±²¨ ¯ ¬¿²¨. («¿ ½²®£® ¬» ±®¥¤¨­¿¥¬ ±®®²¢¥²±²¢³¾¹¨¥ ¢µ®¤»
±µ¥¬» ± ¯®±²®¿­­»¬¨ ±¨£­ « ¬¨ 0 ¨«¨ 1.) ¥®¯°¥¤¥«¥­­»¬¨ ®±² ¾²±¿ ²®«¼ª® ²¥ ¢µ®¤­»¥ ¯¥°¥¬¥­­»¥, ª®²®°»¥ ®²¢¥· ¾² §  §­ ·¥­¨¥ ±¥°²¨´¨ª ²  y . ®-¢²®°»µ, ¨£­®°¨°³¾²±¿ ¢±¥ ¢»µ®¤» ±µ¥¬»
C 0, ª°®¬¥ ®¤­®£® | ²®£® ¡¨²  ª®­´¨£³° ¶¨¨ cT (n), ¢ ª®²®°®¬ µ° ­¨²±¿ °¥§³«¼² ² ° ¡®²»  «£®°¨²¬  A. ®¢ ¿, ¯°¥®¡° §®¢ ­­ ¿ ±µ¥¬  ¨ ¥±²¼ ­³¦­ ¿ ­ ¬ ±µ¥¬  C . ¢®¤¿¹¨©  «£®°¨²¬, ¯®«³·¨¢ ¢µ®¤
x, ±²°®¨² ±µ¥¬³ C ¨ ¢»¤ ¥² ¥¥ (²®·­¥¥, ¥¥ ¯°¥¤±² ¢«¥­¨¥ ¢ ¢¨¤¥
±²°®ª¨ ¡¨²®¢).
±² ¥²±¿ ¤®ª § ²¼, ·²® ±¢®¤¿¹¨©  «£®°¨²¬ ®¡« ¤ ¥² ¤¢³¬¿ ­¥®¡µ®¤¨¬»¬¨ ±¢®©±²¢ ¬¨. ®-¯¥°¢»µ, ­³¦­® ¯®ª § ²¼, ·²® F ª®°°¥ª²­® ¢»·¨±«¿¥² ±¢®¤¿¹³¾ ´³­ª¶¨¾ f . ²® §­ ·¨², ·²® ±µ¥¬  C
¢»¯®«­¨¬  ²®£¤  ¨ ²®«¼ª® ²®£¤ , ª®£¤  ±³¹¥±²¢³¥² ±¥°²¨´¨ª ² y ,
¤«¿ ª®²®°®£® A(x; y ) = 1. ®-¢²®°»µ, ­³¦­® ¯®ª § ²¼, ·²®  «£®°¨²¬ F ° ¡®² ¥² ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿.

836

« ¢  36 NP-¯®«­®² 

®ª ¦¥¬ ª®°°¥ª²­®±²¼  «£®°¨²¬  F . ³±²¼ ±³¹¥±²¢³¥² ±¥°²¨´¨ª ² y ¤«¨­» O(nk ), ¤«¿ ª®²®°®£® A(x; y ) = 1. ®¤±² ¢¨¬ ¡¨²»
±¥°²¨´¨ª ²  y ¢® ¢µ®¤­»¥ ¯¥°¥¬¥­­»¥ ±µ¥¬» C . ®£¤  ¢»µ®¤ ±µ¥¬» C (y ) ¡³¤¥² ° ¢¥­ A(x; y ) = 1.  ª¨¬ ®¡° §®¬, ¥±«¨ ±³¹¥±²¢³¥²
±¥°²¨´¨ª ², ²® ±µ¥¬  C = f (x) ¢»¯®«­¨¬ .  ®¡®°®², ¥±«¨ ±µ¥¬  C ¢»¯®«­¨¬ , ²® ¤«¿ ­¥ª®²®°®£® ­ ¡®°  y §­ ·¥­¨© ¢µ®¤­»µ
¯¥°¥¬¥­­»µ ¨¬¥¥¬ C (y ) = 1, ¨ ¯®²®¬³ A(x; y ) = 1. ®°°¥ª²­®±²¼
 «£®°¨²¬  F ¤®ª § ­ .
±² «®±¼ § ¬¥²¨²¼, ·²® ° §¬¥° ±µ¥¬» C ¨ ¢°¥¬¿ ° ¡®²» ±¢®¤¿¹¥£®  «£®°¨²¬  ¯®«¨­®¬¨ «¼­® § ¢¨±¿² ®² ° §¬¥°  ¢µ®¤  n = jxj.
°¥¦¤¥ ¢±¥£® § ¬¥²¨¬, ·²® ª ¦¤ ¿ ª®­´¨£³° ¶¨¿ ±®¤¥°¦¨² ¯®«¨­®¬¨ «¼­®¥ ·¨±«® ¡¨²®¢. ¥©±²¢¨²¥«¼­®, ¤«¨­  ¯°®£° ¬¬» A ´¨ª±¨°®¢ ­  ¨ ­¥ § ¢¨±¨² ®² ¢µ®¤ , ¤«¨­  ¢µ®¤  x ° ¢­  n,   ¤«¨­ 
±¥°²¨´¨ª ²  y ¯®«¨­®¬¨ «¼­® § ¢¨±¨² ®² n. ®±ª®«¼ª³  «£®°¨²¬
A ¤¥« ¥² ²®«¼ª® ¯®«¨­®¬¨ «¼­®¥ ·¨±«® ¸ £®¢, ° §¬¥° ¨±¯®«¼§³¥¬®© ¨¬ ¯ ¬¿²¨ ²®¦¥ ¯®«¨­®¬¨ «¥­. (» ±·¨² ¥¬, ·²® ­¥ ²®«¼ª®
·¨±«® ´ ª²¨·¥±ª¨ ¨±¯®«¼§®¢ ­­»µ ¿·¥¥ª ¯ ¬¿²¨, ­® ¨ ®¡¹¥¥ ·¨±«®
¿·¥¥ª ¯ ¬¿²¨ ¯®«¨­®¬¨ «¼­®.   ± ¬®¬ ¤¥«¥ ½²® ®£° ­¨·¥­¨¥ ­¥±³¹¥±²¢¥­­®, ±¬. ³¯°. 36.3-4.)  ª¨¬ ®¡° §®¬, ¨ ·¨±«® ³°®¢­¥© ­ 
°¨±. 36.7, ¨ ° §¬¥° ª ¦¤®£® ³°®¢­¿ ¯®«¨­®¬¨ «¼­»; ª®­±²°³ª¶¨¿
±µ¥¬» ² ª¦¥ °¥£³«¿°­  ¨ ¯®±²°®¥­¨¥ ¥¥ §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿
­¥ ±®±² ¢«¿¥² ²°³¤ .
² ª, ¬» ¤®ª § «¨, ·²® ¿§»ª CIRCUIT-SAT «¥¦¨² ¢ ª« ±±¥ NP
¨ ·²® «¾¡®© ¿§»ª ¨§ NP ª ­¥¬³ ±¢®¤¨²±¿, ²® ¥±²¼ ·²® § ¤ · 
CIRCUIT-SAT ¿¢«¿¥²±¿ NP-¯®«­®©.
¥®°¥¬  36.7
 ¤ ·  ® ¢»¯®«­¨¬®±²¨ ±µ¥¬» NP-¯®«­ .
¯° ¦­¥­¨¿
36.3-1
®ª ¦¨²¥, ·²® ®²­®¸¥­¨¥ 6P ²° ­§¨²¨¢­®, ²® ¥±²¼ ·²® ¨§ L1 6P
L2 ¨ L2 6P L3 ±«¥¤³¥² L1 6P L3.
36.3-2
®ª ¦¨²¥, ·²® L 6P L , ¥±«¨ ¨ ²®«¼ª® ¥±«¨ L 6P L
36.3-3
°®¢¥°¼²¥, ·²® ¢ ¤®ª § ²¥«¼±²¢¥ «¥¬¬» 36.5 ¢ ª ·¥±²¢¥ ±¥°²¨´¨ª ²  ¬®¦­® ¢§¿²¼ §­ ·¥­¨¿ ­  ¢±¥µ ¯°®¢®¤ µ (¢µ®¤­»µ, ¢»µ®¤­»µ
¨ ¢­³²°¥­­¨µ) ±µ¥¬».
36.3-4
 ¤®ª § ²¥«¼±²¢¥ «¥¬¬» 36.6 ¬» ¯°¥¤¯®« £ «¨, ·²® ª®¬¯¼¾²¥°
¨±¯®«¼§³¥² ³· ±²®ª ¯ ¬¿²¨ ¯®«¨­®¬¨ «¼­®£® ° §¬¥°  (  ­¥ ¯®«¨­®¬¨ «¼­®¥ ·¨±«® ¿·¥¥ª ¢ ° §­»µ ¬¥±² µ ¯ ¬¿²¨ ½ª±¯®­¥­¶¨ «¼­®£®
° §¬¥° ). ®·¥¬³ ½²® ¡»«® ±³¹¥±²¢¥­­®?  ª ®¡®©²¨±¼ ¡¥§ ½²®£®
¯°¥¤¯®«®¦¥­¨¿?
36.3-5
§»ª L ­ §»¢ ¥²±¿ ¯®«­»¬ ¢ ª« ±±¥ ¿§»ª®¢ C ®²­®±¨²¥«¼­® ¯®«¨­®¬¨ «¼­®© ±¢®¤¨¬®±²¨, ¥±«¨ L 2 C ¨ L0 6p L ¤«¿ «¾¡®£® L0 2 C .

NP-¯®«­®²  ¨ ±¢®¤¨¬®±²¼

837

®ª ¦¨²¥, ·²® ¢ ª« ±±¥ P ¢±¥ ¿§»ª¨ (ª°®¬¥ ; ¨ f0; 1g) ¯®«­» ®²­®±¨²¥«¼­® ¯®«¨­®¬¨ «¼­®© ±¢®¤¨¬®±²¨.
36.3-6
®ª ¦¨²¥, ·²® ¿§»ª L ¯®«®­ ¢ ª« ±±¥ NP ²®£¤  ¨ ²®«¼ª® ²®£¤ ,
ª®£¤  ¿§»ª L ¯®«®­ ¢ co ; NP.
36.3-7
¢®¤¿¹¨©  «£®°¨²¬ F («¥¬¬  36.6) ±²°®¨² ±µ¥¬³ C = f (x), ¨±¯®«¼§³¿ ¨­´®°¬ ¶¨¾ ®¡ x, A ¨ k. °®´¥±±®° § ¬¥²¨«, ·²®  «£®°¨²¬
F ¯®«³· ¥² ¢ ª ·¥±²¢¥  °£³¬¥­²  ²®«¼ª® x, ®¤­ ª® ­¨ A, ­¨ k ¥¬³
­¥ ¤ ­». (®±ª®«¼ª³ ¿§»ª L ¯°¨­ ¤«¥¦¨² NP, ¬®¦­® ³²¢¥°¦¤ ²¼,
·²® ²°¥¡³¥¬»¥ A ¨ k ±³¹¥±²¢³¾², ­® ª ª®¢» ®­¨, ¬» ­¥ §­ ¥¬.)  
½²®¬ ®±­®¢ ­¨¨ ¯°®´¥±±®° ¤¥« ¥² ¢»¢®¤, ·²®  «£®°¨²¬ F ¯®±²°®¨²¼ ­¥«¼§¿, ¨ ·²® ¿§»ª CIRCUIT-SAT ­¥ ®¡¿§ ­ ¯°¨­ ¤«¥¦ ²¼ NP.
¡º¿±­¨²¥, ¢ ·¥¬ ®¸¨¡ª  ¯°®´¥±±®° .
®ª § ²¥«¼±²¢  NP-¯®«­®²».
®ª §»¢ ¿ NP-¯®«­®²³ ¿§»ª  CIRCUIT-SAT, ¬» ¯°®¢¥°¿«¨, ·²®
¢±¿ª¨© ¿§»ª ¨§ ª« ±±  NP ±¢®¤¨²±¿ ª CIRCUIT-SAT §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿. ®«¼¸¥ ½²®£® (° ±±¬ ²°¨¢ ²¼ ¯°®¨§¢®«¼­»© ¿§»ª ¨§
ª« ±±  NP) ­ ¬ ¤¥« ²¼ ­¥ ¯°¨¤¥²±¿ | ·²®¡» ¤®ª § ²¼ NP-¯®«­®²³
ª ª®£®-«¨¡® ¿§»ª , ¤®±² ²®·­® ±¢¥±²¨ ª ­¥¬³ ¤°³£®© ¿§»ª, NP¯®«­®²  ª®²®°®£® ³¦¥ ¤®ª § ­ .  ª¨¬ ±¯®±®¡®¬ ¬» ¤®ª ¦¥¬ NP¯®«­®²³ ¤¢³µ § ¤ · ® ¢»¯®«­¨¬®±²¨ ´®°¬³«,   ¢ ° §¤¥«¥ 36.5 |
NP-¯®«­®²³ ¥¹¥ ­¥±ª®«¼ª¨µ § ¤ ·.
°³£¨¬¨ ±«®¢ ¬¨, NP-¯®«­®²³ ¿§»ª®¢ ¬» ¡³¤¥¬ ¤®ª §»¢ ²¼ ±
¯®¬®¹¼¾ ±«¥¤³¾¹¥© «¥¬¬».
¥¬¬  36.8
±«¨ ¤«¿ ¿§»ª  L ­ ©¤¥²±¿ ¿§»ª L0 2 CNP, ¤«¿ ª®²®°®£® L0 6P L,
²® ¿§»ª L NP-²°³¤¥­. ±«¨, ª°®¬¥ ²®£®, L 2 NP, ²® L 2 CNP.
®ª § ²¥«¼±²¢®
®±ª®«¼ª³ L0 2 CNP, «¾¡®© ¿§»ª L00 ¨§ ª« ±±  NP ±¢®¤¨²±¿
ª L0 . ® ³±«®¢¨¾ L0 6P L, ¯®½²®¬³ ¯® ±¢®©±²¢³ ²° ­§¨²¨¢­®±²¨ (³¯°. 36.3-1) L00 6p L.  ª¨¬ ®¡° §®¬, ¿§»ª L ¿¢«¿¥²±¿ NP²°³¤­»¬. ±«¨ ²¥¯¥°¼ L 2 NP, ²® L 2 CNP.
°³£¨¬¨ ±«®¢ ¬¨, ­ ¬ ­¥ ­ ¤® ¤®ª §»¢ ²¼, ·²® «¾¡®© NP-¿§»ª
±¢®¤¨²±¿ ª ¨­²¥°¥±³¾¹¥¬³ ­ ± | ¤®±² ²®·­® ¯°®¢¥°¨²¼ ½²® ¤«¿
®¤­®£® NP-¯®«­®£® ¿§»ª . ®«³· ¥¬ ² ª³¾ ±µ¥¬³ ¤®ª § ²¥«¼±²¢ 
NP-¯®«­®²» ¿§»ª  L.
1. ®ª §»¢ ¥¬, ·²® L 2 NP.
2. »¡¨° ¥¬ ª ª®©-«¨¡® ¨§¢¥±²­»© NP-¯®«­»© ¿§»ª L0.
3. ²°®¨¬  «£®°¨²¬, ¢»·¨±«¿¾¹¨© ´³­ª¶¨¾ f , ª®²®° ¿ ®²®¡° ¦ ¥² ¢µ®¤» § ¤ ·¨ L0 ¢® ¢µ®¤» § ¤ ·¨ L.
4. ®ª §»¢ ¥¬, ·²® ´³­ª¶¨¿ f ±¢®¤¨² L0 ª L, ²® ¥±²¼ ·²® x 2 L0
²®£¤  ¨ ²®«¼ª® ²®£¤ , ª®£¤  f (x) 2 L.
5. ®ª §»¢ ¥¬, ·²® ¢»·¨±«¿¾¹¨© ´³­ª¶¨¾ f  «£®°¨²¬ ° ¡®² ¥²
¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿.
®¦­® ±ª § ²¼ ¨ ² ª: ¬» ³¦¥ ¯°®¡¨«¨ ¡°¥¸¼ ¢ ±²¥­¥, ³±² ­®¢¨¢

838

« ¢  36 NP-¯®«­®² 

NP-¯®«­®²³ ®¤­®£® ¿§»ª , ¨ ²¥¯¥°¼ ¬®¦¥¬ ¨±¯®«¼§®¢ ²¼ ½²® ¤«¿
¤®ª § ²¥«¼±²¢  NP-¯®«­®²» ¤°³£¨µ ¿§»ª®¢. ²¨ ¿§»ª¨ ² ª¦¥ ¬®¦­® ¨±¯®«¼§®¢ ²¼ ª ª ½² «®­­»¥ ¯°¨ ¤®ª § ²¥«¼±²¢¥ NP-¯®«­®²»,
² ª ·²® ·¥¬ ¡®«¼¸¥ ­ ¸  ª®««¥ª¶¨¿ NP-¯®«­»µ ¿§»ª®¢, ²¥¬ «¥£·¥
¤®ª §»¢ ²¼ NP-¯®«­®²³ ­®¢»µ.
»¯®«­¨¬®±²¼ ´®°¬³«
» ¤®ª ¦¥¬ NP-¯®«­®²³ § ¤ ·¨ ® ¢»¯®«­¨¬®±²¨ ¯°®¯®§¨¶¨®­ «¼­»µ ´®°¬³«. (¬¥­­® ¤«¿ ½²®© § ¤ ·¨ ¢¯¥°¢»¥ ¡»«  ¤®ª § ­ 
NP-¯®«­®² .) ®² ª ª ®­  ´®°¬³«¨°³¥²±¿.
°®¯®§¨¶¨®­ «¼­»¥ ´®°¬³«» ±®±² ¢«¥­» ¨§
1. ¡³«¥¢»µ ¯¥°¥¬¥­­»µ x1 ; x2; : : : ;
2. ¡³«¥¢±ª¨µ ®¯¥° ¶¨© (¯°®¯®§¨¶¨®­ «¼­»µ ±¢¿§®ª) ^ (ª®­º¾­ª¶¨¿, AND, ), _ (¤¨§º¾­ª¶¨¿, OR, ), : (®²°¨¶ ­¨¥, , NOT),
) (¨¬¯«¨ª ¶¨¿, ±«¥¤®¢ ­¨¥), , (½ª¢¨¢ «¥­²­®±²¼, ¥±«¨ ¨ ²®«¼ª®
¥±«¨);
3. ±ª®¡®ª.
 ª ¦¥ ª ª ¨ ¤«¿ ¡³«¥¢»µ ±µ¥¬, ­ ¡®°®¬ §­ ·¥­¨© (truth assignment) ¤«¿ ¯°®¯®§¨¶®­ «¼­®© ´®°¬³«» ' ¡³¤¥¬ ­ §»¢ ²¼ ­ ¡®° §­ ·¥­¨© ¯¥°¥¬¥­­»µ, ¢µ®¤¿¹¨µ ¢ ½²³ ´®°¬³«³. »¯®«­¿¾¹¨¬ ­ ¡®°®¬ (satisfying assignment) ¬» ­ §»¢ ¥¬ ­ ¡®° §­ ·¥­¨©, ­  ª®²®°®¬ ´®°¬³«  ¯°¨­¨¬ ¥² §­ ·¥­¨¥ 1 (¨±²¨­­ ). ®°¬³«  ­ §»¢ ¥²±¿ ¢»¯®«­¨¬®© (satisable), ¥±«¨ ¤«¿ ­¥¥ ±³¹¥±²¢³¥² ¢»¯®«­¿¾¹¨© ­ ¡®°.  ¤ ·  ® ¢»¯®«­¨¬®±²¨ ´®°¬³«» (formula satisability
problem) ±®±²®¨² ¢ ¯°®¢¥°ª¥, ¿¢«¿¥²±¿ «¨ § ¤ ­­ ¿ (¯°®¯®§¨¶¨®­ «¼­ ¿) ´®°¬³«  ¢»¯®«­¨¬®©. °³£¨¬¨ ±«®¢ ¬¨,
SAT = fh'i : ' | ¢»¯®«­¨¬ ¿ ¡³«¥¢  ´®°¬³« g:
 ¯°¨¬¥°, ´®°¬³« 

' = ((x1 ) x2) _ :((:x1 , x3 ) _ x4)) ^ :x2
¨¬¥¥² ¢»¯®«­¿¾¹¨© ­ ¡®° hx1 = 0; x2 = 0; x3 = 1; x4 = 1i, ² ª ª ª
' = ((0 ) 0) _ :((:0 , 1) _ 1)) ^ :0
= (1 _ :(1 _ 1)) ^ 1
(36:2)
= (1 _ 0) ^ 1
= 1;
¨, ±«¥¤®¢ ²¥«¼­®, ¤ ­­ ¿ ´®°¬³«  ' ¯°¨­ ¤«¥¦¨² SAT.

»¯®«­¨¬®±²¼ ´®°¬³«» ¬®¦­® ¯°®¢¥°¨²¼, ¯¥°¥¡° ¢ ¢±¥ ­ ¡®°»
§­ ·¥­¨© ¯¥°¥¬¥­­»µ. ¤­ ª® ½²®² ¯¥°¥¡®°­»©  «£®°¨²¬ ­¥ ¿¢«¿¥²±¿ ¯®«¨­®¬¨ «¼­»¬ (¤«¿ ´®°¬³«» ± n ¯¥°¥¬¥­­»¬¨ ¥±²¼ 2n ¢ °¨ ­²®¢).  ª ¯®ª §»¢ ¥² ±«¥¤³¾¹ ¿ ²¥®°¥¬ , § ¤ ·  SAT ¿¢«¿¥²±¿
NP-¯®«­®© ¨ ¯®²®¬³ ¤«¿ ­¥¥ ¢°¿¤ «¨ ±³¹¥±²¢³¥² ¯®«¨­®¬¨ «¼­»©
 «£®°¨²¬.
¥®°¥¬  36.9

NP-¯®«­®²  ¨ ±¢®¤¨¬®±²¼

839

36.8
¢¥¤¥­¨¥ ¢»¯®«­¨¬®±²¨ ±µ¥¬» ª ¢»¯®«­¨¬®±²¨ ´®°¬³«». «¿ ª ¦¤®£® ¯°®¢®¤  ±µ¥¬» § ¢®¤¨¬ ¯¥°¥¬¥­­³¾; ´®°¬³«  ¯°¥¤±² ¢«¿¥²
±®¡®© ª®­º¾­ª¶¨¾ ³²¢¥°¦¤¥­¨© ® ¯®¢¥¤¥­¨¨ ª ¦¤®£® ½«¥¬¥­² .
 ¤ ·  ® ¢»¯®«­¨¬®±²¨ ´®°¬³«» NP-¯®«­ .
®ª § ²¥«¼±²¢®
°¥¦¤¥ ¢±¥£® ³¡¥¤¨¬±¿, ·²® SAT 2 NP.  ± ¬®¬ ¤¥«¥, ±¥°²¨´¨ª ²®¬ ¿¢«¿¥²±¿ ¢»¯®«­¿¾¹¨© ­ ¡®°,   ¯°®¢¥°¿¾¹¨©  «£®°¨²¬
¯®¤±² ¢«¿¥² §­ ·¥­¨¿ ¨§ ½²®£® ­ ¡®°  ­  ¬¥±²® ¯¥°¥¬¥­­»µ ¨ ¢»·¨±«¿¥² §­ ·¥­¨¥ ´®°¬³«».
±² «®±¼ ¯®ª § ²¼, ·²® § ¤ ·  SAT NP-²°³¤­ . «¿ ½²®£® ¤®±² ²®·­® ¯°®¢¥°¨²¼, ·²® CIRCUIT-SAT 6P SAT. °³£¨¬¨ ±«®¢ ¬¨,
¬» ¤®«¦­» ¯® ¤ ­­®© ±µ¥¬¥ ¯®±²°®¨²¼ ´®°¬³«³, ª®²®° ¿ ¡³¤¥²
¢»¯®«­¨¬  ¢ ²®¬ ¨ ²®«¼ª® ²®¬ ±«³· ¥, ª®£¤  ¨±µ®¤­ ¿ ±µ¥¬  ¡»« 
¢»¯®«­¨¬ .
®¦­® ¯®±²°®¨²¼ ´®°¬³«³, ª®²®° ¿ ¢»·¨±«¿¥² ²³ ¦¥ ´³­ª¶¨¾,
·²® ¨ § ¤ ­­ ¿ ±µ¥¬ . ²® ¤¥« ¥²±¿ ¯°®±²®: ¤¢¨£ ¿±¼ ®² ¢µ®¤®¢ ±µ¥¬» ª ¢»µ®¤³, ¬» ­  ª ¦¤®¬ ¯°®¢®¤¥ ¯¨¸¥¬ ´®°¬³«³, ¥¬³ ±®®²¢¥²±²¢³¾¹³¾ (­ ¯°¨¬¥°, ¢»µ®¤³ ½«¥¬¥­²   ±®®²¢¥²±²¢³¥² ´®°¬³« 
' ^ , £¤¥ ' ¨ | ´®°¬³«», ±®®²¢¥²±²¢³¾¹¨¥ ¥¥ ¢µ®¤ ¬).
 ±®¦ «¥­¨¾, ½²®² ¬¥²®¤ ­¥ ¿¢«¿¥²±¿ ¯®«¨­®¬¨ «¼­»¬. ­®£®ª° ²­®¥ ¨±¯®«¼§®¢ ­¨¥ ®¤­¨µ ¨ ²¥µ ¦¥ ¯®¤´®°¬³« ¬®¦¥² ¯°¨¢¥±²¨
ª ´®°¬³«¥ ½ª±¯®­¥­¶¨ «¼­®£® ° §¬¥°  (³¯°. 36.4-1). ®½²®¬³ ­³¦­® ¤¥©±²¢®¢ ²¼ ¡®«¥¥  ªª³° ²­®.
°¾ª ±®±²®¨² ¢ ²®¬, ·²®¡» ³¢¥«¨·¨²¼ ·¨±«® ¯¥°¥¬¥­­»µ ¢ ´®°¬³«¥, ¢¢¥¤¿ ¤®¯®«­¨²¥«¼­³¾ ¯¥°¥¬¥­­³¾ ¤«¿ ª ¦¤®£® ¯°®¢®¤  ¢
±µ¥¬¥, (  ­¥ ²®«¼ª® ¤«¿ ¥¥ ¢µ®¤®¢). ±­®¢­ ¿ ¨¤¥¿ ¯®ª § ­  ­ 
°¨±. 36.8.
®°¬³« , ª®²®°³¾ ±²°®¨² ±¢®¤¿¹¨©  «£®°¨²¬, ¥±²¼ ª®­º¾­ª¶¨¿ ¯¥°¥¬¥­­®©, ±®®²¢¥²±²¢³¾¹¥© ¢»µ®¤³ ±µ¥¬», ¨ ³²¢¥°¦¤¥­¨© ®
ª®°°¥ª²­®±²¨ ° ¡®²» ¢±¥µ ´³­ª¶¨®­ «¼­»µ ½«¥¬¥­²®¢.  ¯°¨¬¥°,
±µ¥¬¥ ­  °¨±³­ª¥ 36.8 ¡³¤¥² ¯®±² ¢«¥­  ¢ ±®®²¢¥²±²¢¨¥ ´®°¬³« 

' = x10^(x4 , :x3 )
^(x5 , :(x1 _ x2))
^(x6 , :x4)
^(x7 , :(x1 ^ x2 ^ x3))
^(x8 , :(x5 _ x6))
^(x9 , :(x6 _ x7))
^(x10 , :(x7 ^ x8 ^ x9))
²® ¯®±²°®¥­¨¥, ª ª «¥£ª® ¢¨¤¥²¼, ¯°¨¢®¤¨² ª ±µ¥¬¥ ¯®«¨­®¬¨ «¼­®£® ° §¬¥°  ¨ ¢»¯®«­¿¥²±¿ §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿.
®·¥¬³ ±µ¥¬  C ¢»¯®«­¨¬  ²®£¤  ¨ ²®«¼ª® ²®£¤ , ª®£¤  ¢»¯®«­¨¬  ¯®±²°®¥­­ ¿ ´®°¬³«  '? ³±²¼ ±µ¥¬  C ¨¬¥¥² ¢»¯®«­¿¾¹¨©

840

« ¢  36 NP-¯®«­®² 

­ ¡®°. ®¤ ¢ ¿ ­  ¢µ®¤ ±µ¥¬» C §­ ·¥­¨¿ ¯¥°¥¬¥­­»µ ¨§ ½²®£® ­ ¡®° , ¬» ¯®«³·¨¬ ®¯°¥¤¥«¥­­»¥ §­ ·¥­¨¿ ­  ª ¦¤®¬ ¯°®¢®¤¥ ±µ¥¬». °¨ ½²®¬ ¢»µ®¤­»¬ §­ ·¥­¨¥¬ ±µ¥¬» ¡³¤¥² 1. ²¨ §­ ·¥­¨¿ ¨
¡³¤³² ¢»¯®«­¿¾¹¨¬ ­ ¡®°®¬ ¤«¿ ´®°¬³«» '.
 ¯°®²¨¢, ¥±«¨ ¬» ¨¬¥¥¬ ­¥ª®²®°»© ¢»¯®«­¿¾¹¨© ­ ¡®° ¤«¿
´®°¬³«» ', ²® ®­ § ¤ ¥² ­¥ª®²®°®¥ ±®£« ±®¢ ­­®¥ ° ±¯°¥¤¥«¥­¨¥
§­ ·¥­¨© ¯® ¯°®¢®¤ ¬ ±µ¥¬», ¯°¨ ª®²®°®¬ ¢»µ®¤­®¥ §­ ·¥­¨¥ ° ¢­® 1, ¨ ¯®²®¬³ ±µ¥¬  ¢»¯®«­¨¬ .
 ª¨¬ ®¡° §®¬, CIRCUIT-SAT 6P SAT, ·²® ¨ ²°¥¡®¢ «®±¼ ¤®ª § ²¼.
»¯®«­¨¬®±²¼ 3-CNF ´®°¬³«
«¿ ¬­®£¨µ § ¤ · ³¤ ¥²±¿ ¤®ª § ²¼ ¨µ NP-¯®«­®²³, ±¢¥¤¿ ª
­¨¬ § ¤ ·³ ® ¢»¯®«­¨¬®±²¨ ´®°¬³«. °¨ ½²®¬ ³¤®¡­® ®£° ­¨·¨²¼
ª« ±± ´®°¬³«, ¢»¯®«­¨¬®±²¼ ª®²®°»µ ­ ± ¨­²¥°¥±³¥² | ·¥¬ ½²®²
ª« ±± ¬¥­¼¸¥, ²¥¬ «¥£·¥ ®±³¹¥±²¢¨²¼ ±¢¥¤¥­¨¥. (°¨ ½²®¬, ª®­¥·­®, § ¤ ·  ® ¢»¯®«­¨¬®±²¨ ´®°¬³« ¨§ ½²®£® ª« ±±  ¤®«¦­  ®±² ¢ ²¼±¿ NP-¯®«­®©.)   ¯° ª²¨ª¥ ®ª §»¢ ¥²±¿ ³¤®¡­»¬ ª« ±± ´®°¬³« ¢ 3-ª®­º¾­ª²¨¢­®© ­®°¬ «¼­®© ´®°¬¥ (3-conjunctive normal
form), ±®ª° ¹¥­­® ®¡®§­ · ¥¬»© 3-CNF.  ª¨¥ ´®°¬³«» ¯°¥¤±² ¢«¿¾² ±®¡®© ª®­º¾­ª¶¨¾ ­¥±ª®«¼ª¨µ ¯®¤´®°¬³«, ª ¦¤ ¿ ¨§ ª®²®°»µ ¥±²¼ ¤¨§º¾­ª¶¨¿ °®¢­® ²°¥µ ° §«¨·­»µ «¨²¥° «®¢ («¨²¥° «
| ½²® ¯¥°¥¬¥­­ ¿ ¨«¨ ®²°¨¶ ­¨¥ ¯¥°¥¬¥­­®©).
 ¯°¨¬¥°, ´®°¬³« 
(x1 _ :x1 _ x2 ) ^ (x3 _ x2 _ x4 ) ^ (:x1 _ :x3 _ :x4 )
¯°¨­ ¤«¥¦¨² ª« ±±³ 3-CNF. ¥°¢ ¿ ¨§ ²°¥µ ¥¥ ¤¨§º¾­ª¶¨© ¥±²¼
(x1 _ :x1 _ x2 ); ®­  ±®¤¥°¦¨² «¨²¥° «» x1 ; :x1 ¨ :x2 .
 ¤ ·  ® ¢»¯®«­¨¬®±²¨ ´®°¬³« ¨§ ª« ±±  3-CNF, ®¡®§­ · ¥¬ ¿
3-CNF-SAT, ¿¢«¿¥²±¿ NP-¯®«­®© ±® ¢±¥¬¨ ¢»²¥ª ¾¹¨¬¨ ¯®±«¥¤±²¢¨¿¬¨ (¢°¿¤ «¨ ¤«¿ ­¥¥ ¥±²¼ ¯®«¨­®¬¨ «¼­»©  «£®°¨²¬; ¥¥ ¬®¦­®
¨±¯®«¼§®¢ ²¼ ¤«¿ ¤®ª § ²¥«¼±²¢  NP-¯®«­®²» ¤°³£¨µ § ¤ ·).
¥®°¥¬  36.10
 ¤ ·  ¯°®¢¥°ª¨ ¢»¯®«­¨¬®±²¨ ´®°¬³«» ¨§ ª« ±±  3-CNF NP¯®«­ .
®ª § ²¥«¼±²¢®
§»ª 3-CNF-SAT ¯°¨­ ¤«¥¦¨² ª« ±±³ NP ¯® ²¥¬ ¦¥ ¯°¨·¨­ ¬,
·²® ¨ ¿§»ª SAT (²¥®°¥¬  36.9). ²®¡» ¤®ª § ²¼, ·²® § ¤ ·  3-CNFSAT ¿¢«¿¥²±¿ NP-²°³¤­®©, ¬» ¯®ª ¦¥¬, ·²® SAT 6P 3-CNF-SAT,
¨ ®±² ­¥²±¿ ±®±« ²¼±¿ ­  «¥¬¬³ 36.8.
¢¥¤¥­¨¥ ¡³¤¥² ¨±¯®«¼§®¢ ²¼ ²³ ¦¥ ¨¤¥¾, ·²® ¨ ¤®ª § ²¥«¼±²¢®
²¥®°¥¬» 36.9 (­  ± ¬®¬ ¤¥«¥ ¬®¦­® ¡»«® ¡» ¬®¤¨´¨¶¨°®¢ ²¼ ½²®
¤®ª § ²¥«¼±²¢® ² ª, ·²®¡» ¯®«³· « ±¼ ´®°¬³«  ¨§ ª« ±±  3-CNF).
³±²¼ ¤ ­  ¯°®¨§¢®«¼­ ¿ ´®°¬³«  '. ®±²°®¨¬ À¤¥°¥¢® ° §¡®° Á
½²®© ´®°¬³«»; «¨±²¼¿ ½²®£® ¤¥°¥¢  ±®®²¢¥²±²¢³¾² «¨²¥° « ¬,  
¢­³²°¥­­¨¥ ¢¥°¸¨­» | ¯°®¯®§¨¶¨®­ «¼­»¬ ±¢¿§ª ¬.   °¨±. 36.9

NP-¯®«­®²  ¨ ±¢®¤¨¬®±²¼

841

¯®ª § ­® ² ª®¥ ¤¥°¥¢® ¤«¿ ´®°¬³«»

' = ((x1 ! x2 ) _ :((:x1 $ x3) _ x4)) ^ :x2 :

(36:3)

» ±·¨² ¥¬, ·²® ¢ ´®°¬³«¥ ­¥ ¢±²°¥· ¾²±¿ ¤¨§º¾­ª¶¨¨ ¨«¨ ª®­º¾­ª¶¨¨ ¡®«¥¥ ·¥¬ ¤¢³µ ¯®¤´®°¬³« (½²® ®£° ­¨·¥­¨¥ ­¥ ¨¬¥¥² §­ ·¥­¨¿, ² ª ª ª ¢±¥£¤  ¬®¦­® ° ±±² ¢¨²¼ ­¥¤®±² ¾¹¨¥ ±ª®¡ª¨).  ª¨¬ ®¡° §®¬, ª ¦¤ ¿ ¢­³²°¥­­¿¿ ¢¥°¸¨­  ¨¬¥¥² ®¤­®£® ¨«¨ ¤¢³µ
¯®²®¬ª®¢. ®«³·¥­­®¥ ¤¥°¥¢® ° §¡®°  ¬®¦­® ° ±±¬ ²°¨¢ ²¼ ª ª
±µ¥¬³, ¢»·¨±«¿¾¹³¾ ¡³«¥¢³ ´³­ª¶¨¾ (±®®²¢¥²±²¢³¾¹³¾ ´®°¬³«¥).
 «¥¥ ¤¥©±²¢³¥¬ ª ª ¢ ²¥®°¥¬¥ 36.9. ¢¥¤¥¬ ¯¥°¥¬¥­­»¥ yi ¤«¿
ª ¦¤®© ¢­³²°¥­­¥© ¢¥°¸¨­» ¯®±²°®¥­­®© ±µ¥¬». ¥¯¥°¼ ¬®¦­®
¢¬¥±²® ¨±µ®¤­®© ´®°¬³«» ­ ¯¨± ²¼ ª®­º¾­ª¶¨¾ ¯¥°¥¬¥­­®©, ±®®²¢¥²±²¢³¾¹¥© ª®°­¾ ¤¥°¥¢  ° §¡®° , ¨ ¯®¤´®°¬³«, ³²¢¥°¦¤ ¾¹¨µ ª®°°¥ª²­®±²¼ ®¯¥° ¶¨© ¢ ª ¦¤®© ¢¥°¸¨­¥.  ¯°¨¬¥°, ¤«¿
´®°¬³«» (36.3) ¯®«³·¨²±¿ ´®°¬³« 

'0 = y1^(y1 , (y2 ^ :y2))
^(y2 , (y3 _ y4))
^(y3 , (x1 ! x2))
^(y4 , (:y5))
^(y5 , (y6 _ x4))
^(y6 , (:x1 $ x3)):
®«³·¥­­ ¿ ´®°¬³«  '0 ¿¢«¿¥²±¿ ª®­º¾­ª¶¨¥© ­¥±ª®«¼ª¨µ ¯®¤´®°¬³«, ª ¦¤ ¿ ¨§ ª®²®°»µ ±®¤¥°¦¨² ­¥ ¡®«¥¥ 3 ¯¥°¥¬¥­­»µ | ­® ½²¨
¯®¤´®°¬³«» ¥¹¥ ­¥ ¿¢«¿¾²±¿ ¤¨§º¾­ª¶¨¿¬¨ ²°¥µ ° §«¨·­»µ «¨²¥° «®¢.
²® ¦, ®±² ¥²±¿ § ¬¥­¨²¼ ª ¦¤³¾ ¨§ ½²¨µ ¯®¤´®°¬³« ­  ª®­º¾­ª¶¨¾ ­¥±ª®«¼ª¨µ «¨²¥° «®¢. ²® ¤¥« ¥²±¿ ² ª: ±®±² ¢¨¬ ² ¡«¨¶³ §­ ·¥­¨© ¤«¿ ½²®© ¯®¤´®°¬³«» (ª ª ­  °¨±. 36.10) ¨ ¯®±¬®²°¨¬
­  ±²°®ª¨, ¢ ª®²®°»µ ¯®¤´®°¬³«  «®¦­  (¨¬¥¥² §­ ·¥­¨¥ 0). «¿
ª ¦¤®© ¨§ ½²¨µ ±²°®ª ­ ¯¨¸¥¬ ¤¨§º¾­ª¶¨¾ ²°¥µ «¨²¥° «®¢, ª®²®° ¿ ¡³¤¥² «®¦­®© ª ª ° § ¯°¨ ½²¨µ §­ ·¥­¨¿µ ¯¥°¥¬¥­­»µ,   § ²¥¬ ­ ¯¨¸¥¬ ª®­º¾­ª¶¨¾ ½²¨µ ¤¨§º¾­ª¶¨©, ª®²®° ¿ ¡³¤¥² ½ª¢¨¢ «¥­²­  ° ±±¬®²°¥­­®© ¯®¤´®°¬³«¥ ®² ²°¥µ ¯¥°¥¬¥­­»µ.
«¿ ´®°¬³«» ¨§ ­ ¸¥£® ¯°¨¬¥°  ² ¡«¨¶  ¨±²¨­­®±²¨ ¯®ª § ­ 
­  °¨±. 36.10, ´®°¬³«  «®¦­  ¢ ·¥²»°¥µ ±«³· ¿µ. ¨ § ¯¨±»¢ ¿ ª®­º¾­ª¶¨¨, ¨±ª«¾· ¾¹¨¥ ª ¦¤»© ¨§ ½²¨µ ·¥²»°¥µ ±«³· ¥¢, ¯®«³· ¥¬
´®°¬³«³
(:y1 _ :y2 _ :x2 ) ^ (:y1 _ y2 _ :x2 ) ^ (:y1 _ y2 _ x2 ) ^ (y1 _ :y2 _ x2);
ª®²®° ¿ ½ª¢¨¢ «¥­²­  ´®°¬³«¥ (y1 , (y2 ^ :x2 )).
±² « ±¼ ¥¹¥ ®¤­  ­¥¡®«¼¸ ¿ ²°³¤­®±²¼ | ­ ¬ ­ ¤®, ·²®¡»
ª ¦¤ ¿ ¤¨§º¾­ª¶¨¿ ±®¤¥°¦ «  °®¢­® ²°¨ ¯¥°¥¬¥­­»µ. «¿ ½²®£®

842

« ¢  36 NP-¯®«­®² 

¬®¦­® ¤®¡ ¢¨²¼ ´¨ª²¨¢­»¥ ¯¥°¥¬¥­­»¥ | ¨«¨ ­  ½² ¯¥ ¯®±²°®¥­¨¿ ² ¡«¨¶» ¨±²¨­­®±²¨, ¨«¨ ±¥©· ±: ´®°¬³«³ p_q ¬®¦­® § ¬¥­¨²¼
­  (p _ q _ r) ^ (p _ q _ :r),   ´®°¬³«³ p ¬®¦­® § ¬¥­¨²¼ ­ 
(p _ q _ r) ^ (p _ q _ :r) ^ (p _ :q _ r) ^ (p _ :q _ :r)^
¥£ª® ¢¨¤¥²¼, ·²® ¯®«³·¥­­ ¿ ¢ ¨²®£¥ ´®°¬³«  ¢»¯®«­¨¬  ¢ ²®¬
¨ ²®«¼ª® ²®¬ ±«³· ¥, ª®£¤  ¢»¯®«­¨¬  ¨±µ®¤­ ¿ ´®°¬³«  (­  ¯¥°¢®¬ ¸ £¥ ½²® ®¡®±­®¢»¢ ¥²±¿ ª ª ¢ ²¥®°¥¬¥ 36.9,   ¤ «¼¸¥ ¬» § ¬¥­¿«¨ ´®°¬³«» ­  ½ª¢¨¢ «¥­²­»¥). ±­® ² ª¦¥, ·²® ¤«¨­  ­®¢®©
´®°¬³«» ®£° ­¨·¥­  ¯®«¨­®¬®¬ ®² ¤«¨­» ±² °®© ¨ ·²® ¢±¥ ½² ¯»
­ ¸¥£® ¯®±²°®¥­¨¿ ¢»¯®«­¨¬» §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿.
¯° ¦­¥­¨¿
36.4-1
®ª ¦¨²¥, ·²® ®¡±³¦¤ ¥¬»© ¢ ­ · «¥ ¤®ª § ²¥«¼±²¢  ²¥®°¥¬»
36.9 ¯°¿¬®© ¬¥²®¤ ±¢¥¤¥­¨¿ ­¥ £®¤¨²±¿, ¯°¥¤º¿¢¨¢ ±µ¥¬³ ° §¬¥°  n,
ª®²®° ¿ ¯¥°¥¢®¤¨²±¿ ¢ ´®°¬³«³ ½ª±¯®­¥­¶¨ «¼­®£® (on n) ° §¬¥° .
36.4-2
®±²°®©²¥ ´®°¬³«³ ¨§ ª« ±±  3-CNF, ¯°¨¬¥­¨¢ ª ´®°¬³«¥ (36.3)
 «£®°¨²¬ ¨§ ¤®ª § ²¥«¼±²¢  ²¥®°¥¬» 36.10.
36.4-3
°®´¥±±®° ³²¢¥°¦¤ ¥², ·²® ®­ ³¯°®±²¨« ¤®ª § ²¥«¼±²¢® ²¥®°¥¬» 36.10 ¨ ¯°¨¤³¬ « ±¯®±®¡ ¯°¥®¡° §®¢ ²¼ ¯°®¨§¢®«¼­³¾ ´®°¬³«³
¢ «®£¨·¥±ª¨ ½ª¢¨¢ «¥­²­³¾ ¥© ´®°¬³«³ (± ²¥¬¨ ¦¥ ¯¥°¥¬¥­­»¬¨),
¯°¨­ ¤«¥¦ ¹³¾ ª« ±±³ 3-CNF. ®·¥¬³ ®­ ­¥ ¯° ¢?
36.4-4
®ª ¦¨²¥, ·²® § ¤ ·  ®¯°¥¤¥«¥­¨¿, ¿¢«¿¥²±¿ «¨ ¤ ­­ ¿ ¯°®¯®§¨¶¨®­ «¼­ ¿ ´®°¬³«  ² ¢²®«®£¨¥©, NP-¯®«­  ¢ ª« ±±¥ co ; NP.
(ª § ­¨¥: ±¬. ³¯° ¦­¥­¨¥ 36.3-6.)
36.4-5
®ª ¦¨²¥, ·²® §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿ ¬®¦­® ®¯°¥¤¥«¨²¼,
¿¢«¿¥²±¿ «¨ ¤ ­­ ¿ ¡³«¥¢  ´®°¬³«  ¢ À¤¨§º¾­ª²¨¢­®© ­®°¬ «¼­®© ´®°¬¥Á (¤¨§º¾­ª¶¨¿ ¯®¤´®°¬³«, ª ¦¤ ¿ ¨§ ª®²®°»µ ¿¢«¿¥²±¿
ª®­º¾­ª¶¨¥© «¨²¥° «®¢) ¢»¯®«­¨¬®©.
36.4-6
³±²¼ ª²®-²® ¯°¨¤³¬ « ¯®«¨­®¬¨ «¼­»©  «£®°¨²¬, ¯°®¢¥°¿¾¹¨© ¢»¯®«­¨¬®±²¼ «¾¡®© ¯°®¯®§¨¶¨®­ «¼­®© ´®°¬³«».  ª ¬®¦­® ¨±¯®«¼§®¢ ²¼ ½²®²  «£®°¨²¬ ¤«¿ ®²»±ª ­¨¿ ¢»¯®«­¿¾¹¥£® ­ ¡®°  (¤«¿ ¤ ­­®© ¢»¯®«­¨¬®© ´®°¬³«») §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿?
36.4-7
 ±±¬®²°¨¬ ¿§»ª 2-CNF-SAT, ª®²®°»© ±®±²®¨² ¨§ ¢»¯®«­¨¬»µ
´®°¬³« ¢ ª®­º¾­ª²¨¢­®© ­®°¬ «¼­®© ´®°¬¥, ¢ ª®²®°»µ ª ¦¤»©
ª®­º¾­ª²¨¢­»© ·«¥­ ¿¢«¿¥²±¿ ¤¨§º¾­ª¶¨¥© ­¥ ¡®«¥¥ ·¥¬ ¤¢³µ «¨²¥° «®¢. ®ª ¦¨²¥, ·²® 2-CNF-SAT 2 P. ®±²°®©²¥ ª ª ¬®¦­® ¡®«¥¥ ¡»±²°»© ° §°¥¸ ¾¹¨©  «£®°¨²¬. (ª § ­¨¥: ®±ª®«¼ª³ (x _ y )
½ª¢¨¢ «¥­²­® ¢»° ¦¥­¨¾ (:x ! y ), ¬®¦­® ±¢¥±²¨ 2-CNF-SAT ª

NP-¯®«­»¥ § ¤ ·¨

843

­¥ª®²®°®© ¯®«¨­®¬ «¼­® ° §°¥¸¨¬®© § ¤ ·¥, ±¢¿§ ­­®© ± ®°¨¥­²¨°®¢ ­­»¬¨ £° ´ ¬¨.)

36.4. NP-¯®«­»¥ § ¤ ·¨
 ­ ±²®¿¹¥¥ ¢°¥¬¿ ¨§¢¥±²­® ¬­®£® NP-¯®«­»µ § ¤ ·, ±¢¿§ ­­»¥ ± ± ¬»¬¨ ° §­»¬¨ ®¡« ±²¿¬¨ ¬ ²¥¬ ²¨ª¨ ¨ ¨­´®°¬ ²¨ª¨:
«®£¨ª®©, ²¥®°¨¥© £° ´®¢, ª®¬¯¼¾²¥°­»¬¨ ±¥²¿¬¨, ¬­®¦¥±²¢ ¬¨
¨ ° §¡¨¥­¨¿¬¨, ° ±¯¨± ­¨¿¬¨, ¬ ²¥¬ ²¨·¥±ª¨¬ ¯°®£° ¬¬¨°®¢ ­¨¥¬,  «£¥¡°®© ¨ ²¥®°¨¥© ·¨±¥«, ¨£° ¬¨ ¨ £®«®¢®«®¬ª ¬¨, ®¯²¨¬¨§ ¶¨¥© ¯°®£° ¬¬ ¨ ².¤. ¨ ².¯.
 ½²®¬ ° §¤¥«¥ ¬» ¤®ª ¦¥¬ NP-¯®«­®²³ ­¥±ª®«¼ª¨µ § ¤ · ® £° ´ µ ¨ ¬­®¦¥±²¢ µ ± ¯®¬®¹¼¾ ¬¥²®¤  ¯®«¨­®¬¨ «¼­®£® ±¢¥¤¥­¨¿.
¢¿§¼ ¬¥¦¤³ ½²¨¬¨ § ¤ · ¬¨ ¯®ª § ­  ­  °¨±. 36.11; ±²°¥«ª¨ ®§­ · ¾² ±¢®¤¨¬®±²¼ §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿ (CIRCUIT-SAT
±¢®¤¨²±¿ ª SAT ¨ ².¤.) ®ª § ¢ (¢ ²¥®°¥¬¥ 36.7) NP-¯®«­®²³ § ¤ ·¨ SAT, ± ¯®¬®¹¼¾ ½²¨µ ±¢¥¤¥­¨© ¬» ³¡¥¦¤ ¥¬±¿ ¢ ¯®«­®²¥ ¢±¥µ
¯¥°¥·¨±«¥­­»µ ­  °¨±³­ª¥ § ¤ ·.
36.4.1.  ¤ ·  ® ª«¨ª¥
«¨ª®© (clique) ¢ ­¥®°¨¥­²¨°®¢ ­­®¬ £° ´¥ G = (V; E ) ­ §»¢ ¥²±¿ ¯®¤¬­®¦¥±²¢® ¢¥°¸¨­ V 0  V , ª ¦¤»¥ ¤¢¥ ¨§ ª®²®°»µ ±®¥¤¨­¥­» °¥¡°®¬ £° ´ . °³£¨¬¨ ±«®¢ ¬¨, ª«¨ª  | ½²® ¯®«­»© ¯®¤£° ´ £° ´  G.  §¬¥°®¬ (size) ª«¨ª¨ ­ §»¢ ¥²±¿ ·¨±«® ±®¤¥°¦ ¹¨µ±¿ ¢ ­¥© ¢¥°¸¨­.  ±±¬®²°¨¬ ®¯²¨¬¨§ ¶¨®­­³¾ § ¤ ·³: ®¯°¥¤¥«¨²¼ ¬ ª±¨¬ «¼­»© ° §¬¥° ª«¨ª¨ ¢ ¤ ­­®© £° ´¥. ¥ ­ §»¢ ¾²
§ ¤ ·¥© ® ª«¨ª¥ (clique problem). ®®²¢¥²±²¢³¾¹ ¿ § ¤ ·  ° §°¥¸¥­¨¿ ´®°¬³«¨°³¥²±¿ ² ª: ¤ ­» £° ´ G ¨ ·¨±«® k; ²°¥¡³¥²±¿ ³±² ­®¢¨²¼, ¥±²¼ «¨ ¢ £° ´¥ G ª«¨ª  ° §¬¥°  k. ®°¬ «¼­® £®¢®°¿,
CLIQUE = fhG; ki : ¢ £° ´¥ G ¥±²¼ ª«¨ª  ° §¬¥°  kg:
 ª ¢±¥£¤ , ¬» ¬®¦¥¬ ¯¥°¥¡° ²¼ ¢±¥ ¯®¤¬­®¦¥±²¢  ° §¬¥°  k ¢ V ¨
¯°®¢¥°¨²¼, ¥±²¼ «¨ ±°¥¤¨ ­¨µ ª«¨ª . «¿ ½²®£® ²°¥¡³¥²±¿ 
(k2  CVk )
¤¥©±²¢¨© (V | ·¨±«® ¢¥°¸¨­ ¢ £° ´¥). °¨ «¾¡®¬ ´¨ª±¨°®¢ ­­®¬ k ½²  ¢¥«¨·¨­  ¯®«¨­®¬¨ «¼­® § ¢¨±¨² ®² ° §¬¥°  £° ´  G.
¤­ ª® ¢ ®¡¹¥© ¯®±² ­®¢ª¥ § ¤ ·¨ k ¬®¦¥² ¡»²¼ «¾¡»¬ ·¨±«®¬,
­¥ ¯°¥¢®±µ®¤¿¹¨¬ jV j, ¨  «£®°¨²¬ ­¥ ¿¢«¿¥²±¿ ¯®«¨­®¬¨ «¼­»¬.
®«¨­®¬¨ «¼­®£®  «£®°¨²¬  ±ª®°¥¥ ¢±¥£® ¯°®±²® ­¥², ¯®±ª®«¼ª³
¨¬¥¥² ¬¥±²® ±«¥¤³¾¹ ¿
¥®°¥¬  36.11
 ¤ ·  CLIQUE ¿¢«¿¥²±¿ NP-¯®«­®©.
®ª § ²¥«¼±²¢®
­ · «  ³¡¥¤¨¬±¿, ·²® CLIQUE 2 NP.  ± ¬®¬ ¤¥«¥, ¢ ª ·¥±²¢¥

844

« ¢  36 NP-¯®«­®² 

36.12 ° ´. ±®®²¢¥²±²¢³¾¹¨© ´®°¬³«¥ ' = C1 ^ C2 ^ C3 , £¤¥ C1 =
x1 _:x2 _:x3 , C2 = :x1_x2 _x3 , C3 = x1_x2 _x3 ¯°¨ ±¢¥¤¥­¨¨ 3-CNFSAT ª § ¤ ·¥ ® ª«¨ª¥. »¯®«­¿¾¹¨© ­ ¡®° hx1 = 0; x2 = 0; x3 = 1i
¢»¯®«­¿¥² C1 §  ±·¥² :x2 ,   C2 ¨ C3 §  ±·¥² x3. ®®²¢¥²±²¢³¾¹¨¥
¢¥°¸¨­» ¯®ª § ­» ±¢¥²«®-±¥°»¬ ¨ ®¡° §³¾² ª«¨ª³.
±¥°²¨´¨ª ²  ¬®¦­® ¢§¿²¼ ±¯¨±®ª ¢±¥µ ¢¥°¸¨­, ®¡° §³¾¹¨µ ª«¨ª³ (¨¬¥¿ ½²®² ±¯¨±®ª, ­ «¨·¨¥ ¢±¥µ ±®¥¤¨­¨²¥«¼­»µ °¥¡¥° ¬®¦­®
¯°®¢¥°¨²¼ §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿).
«¿ ¤®ª § ²¥«¼±²¢  NP-²°³¤­®±²¨ § ¤ ·¨ CLIQUE ¯®ª ¦¥¬, ·²®
3-CNF-SAT 6m athrmP CLIQUE.   ¯¥°¢»© ¢§£«¿¤ ½²® ª ¦¥²±¿
±²° ­­»¬ | ¯°®¯®§¨¶¨®­ «¼­»¥ ´®°¬³«» ­¨ª ª ­¥ ±¢¿§ ­» ± £° ´ ¬¨ ¨ ª«¨ª ¬¨ | ­® ­  ± ¬®¬ ¤¥«¥ ±¢¥¤¥­¨¥ ¯®±²°®¨²¼ «¥£ª®
¢®¤¿¹¨©  «£®°¨²¬ ¯®«³· ¥² ´®°¬³«³ ¨§ ª« ±±  3-CNF, ¢»¯®«­¨¬®±²¼ ª®²®°®© ­³¦­® ¯°®¢¥°¨²¼ (².¥. ±¢¥±²¨ ª § ¤ ·¥ ® ª«¨ª¥).
³±²¼ ¤ ­  ´®°¬³« 

' = C1 ^ C2 ^ : : : ^ Ck ;
£¤¥ ª ¦¤ ¿ ¯®¤´®°¬³«  Cr ¥±²¼ ¤¨§º¾­ª¶¨¿ ²°¥µ ° §­»µ «¨²¥° «®¢ l1r , l2r ¨ l3r . ®±²°®¨¬ £° ´ G = (V; E ), ª®²®°»© ±®¤¥°¦¨² ª«¨ª³
° §¬¥°  k, ¥±«¨ ¨ ²®«¼ª® ¥±«¨ ´®°¬³«  ´®°¬³«  ' ¢»¯®«­¨¬ .
«¿ ª ¦¤®© ¤¨§º¾­ª¶¨¨ Cr = (l1r _ l2r _ l3r ) ¨§ ´®°¬³«» ' ­ °¨±³¥¬
²°¨ ¢¥°¸¨­» v1r ; v2r ; v3r .  ª¨¬ ®¡° §®¬, £° ´ G ¡³¤¥² ±®¤¥°¦ ²¼ 3k

¢¥°¸¨­. ( ¡¥£ ¿ ¢¯¥°¥¤, ¬®¦­® ±ª § ²¼, ·²® ¡³¤³¹ ¿ ª«¨ª  ¡³¤¥²
®¡° §®¢ ­  ¨±²¨­­»¬¨ ·«¥­ ¬¨ ¤¨§º¾­ª¶¨©.) ®ª  ·²® ®¯¨¸¥¬
°¥¡°  £° ´ : ¤¢¥ ¢¥°¸¨­» vir ¨ vjs ±®¥¤¨­¥­» °¥¡°®¬ ¢ £° ´¥ G,
¥±«¨ ¢»¯®«­¥­» ±«¥¤³¾¹¨¥ ³±«®¢¨¿:
vir ¨ vjs ¯°¨­ ¤«¥¦ ² ° §­»¬ ²°®©ª ¬ (r 6= s);
«¨²¥° «» lir ¨ ljs , ª®²®°»¥ ±®®²¢¥²±²¢³¾² ¤ ­­»¬ ¢¥°¸¨­ ¬, ±®¢¬¥±²­» (are consistent), ²® ¥±²¼ ­¥ ¿¢«¿¾²±¿ ®²°¨¶ ­¨¿¬¨ ¤°³£
¤°³£ .
° ´ G «¥£ª® ¯®±²°®¨²¼ ¯® ´®°¬³«¥ ' §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿.
  °¨±. 36.12 ¯®ª § ­ £° ´, ±®®²¢¥²±²¢³¾¹¨© ´®°¬³«¥

' = (x1 _ :x2 _ :x3 ) ^ (:x1 _ x2 _ x3) ^ (x1 _ x2 _ x3):
®ª ¦¥¬, ·²® ®¯¨± ­­®¥ ¯°¥®¡° §®¢ ­¨¥ ¤¥©±²¢¨²¥«¼­® ¿¢«¿¥²±¿ ±¢¥¤¥­¨¥¬. ­ · «  ¯°¥¤¯®«®¦¨¬, ·²® ´®°¬³«  ' ¨¬¥¥² ¢»¯®«­¿¾¹¨© ­ ¡®°. ®£¤  ª ¦¤ ¿ ¤¨§º¾­ª¶¨¿ Ci ±®¤¥°¦¨² µ®²¿ ¡»
®¤¨­ ¨±²¨­­»© «¨²¥° «; ¢»¡¥°¥¬ ®¤¨­ ¨§ ² ª®¢»µ (¤«¿ ª ¦¤®©
¤¨§º¾­ª¶¨¨). ²¬¥²¨¬ ±®®²¢¥²±²¢³¾¹¨¥ ¢»¡° ­­»¬ «¨²¥° « ¬
¢¥°¸¨­» vir £° ´  G. » ³²¢¥°¦¤ ¥¬, ·²® k ®²¬¥·¥­­»µ ¢¥°¸¨­ ®¡° §³¾² ª«¨ª³. ¥©±²¢¨²¥«¼­®, ¤¢  ®²¬¥·¥­­»µ «¨²¥° «  ±®¢¬¥±²­», ² ª ª ª ®¡  ¨±²¨­­» ­  ®¤­®¬ ¨ ²®¬ ¦¥ ¢»¯®«­¿¾¹¥¬
­ ¡®°¥ (¨ ¯®²®¬³ ­¥ ¬®£³² ¡»²¼ ®²°¨¶ ­¨¿¬¨ ¤°³£ ¤°³£ ).

NP-¯®«­»¥ § ¤ ·¨

845

¡° ²­®, ¯³±²¼ ¢ £° ´¥ G ¥±²¼ ª«¨ª  V 0 ° §¬¥°  k.  ª ¦¤®©
²°®©ª¥ ¢¥°¸¨­» ­¥ ±®¥¤¨­¥­» °¥¡° ¬¨ ¤°³£ ± ¤°³£®¬, ¯®½²®¬³
ª«¨ª  V 0 ±®¤¥°¦¨² °®¢­® ¯® ®¤­®© ¢¥°¸¨­¥ ¨§ ª ¦¤®© ²°®©ª¨.
 ±±¬®²°¨¬ ±®®²¢¥²±²¢³¾¹¨¥ «¨²¥° «» ¨ ®¡º¿¢¨¬ ¨µ ¨±²¨­­»¬¨.
®¢¬¥±²­®±²¼ «¨²¥° «®¢ £ ° ­²¨°³¥², ·²® ¤«¿ ½²®£® ­¥ ¯°¨¤¥²±¿
®¡º¿¢«¿²¼ ¯¥°¥¬¥­­³¾ ®¤­®¢°¥¬¥­­® ¨±²¨­­®© ¨ «®¦­®©. ±«¨ ¯®±«¥ ½²®£® §­ ·¥­¨¿ ­¥ª®²®°»µ ¯¥°¥¬¥­­»µ ¥¹¥ ­¥ ®¯°¥¤¥«¥­», ¢»¡¥°¥¬ ¨µ ¯°®¨§¢®«¼­®. ®«³·¨¬ ­ ¡®° §­ ·¥­¨© ¯¥°¥¬¥­­»µ, ª®²®°»© ¡³¤¥² ¢»¯®«­¿¾¹¨¬, ² ª ª ª ¢ ª ¦¤®© ¨§ ¤¨§º¾­ª¶¨© ¥±²¼
µ®²¿ ¡» ®¤¨­ ¨±²¨­­»© ·«¥­.
36.4.2.  ¤ ·  ® ¢¥°¸¨­­®¬ ¯®ª°»²¨¨
­®¦¥±²¢® ¢¥°¸¨­ V 0  V £° ´  V = (V; E ) ­ §»¢ ¥²±¿ ¢¥°¸¨­­»¬ ¯®ª°»²¨¥¬ (vertex cover) £° ´ , ¥±«¨ ³ «¾¡®£® °¥¡°  £° ´ 
µ®²¿ ¡» ®¤¨­ ¨§ ª®­¶®¢ ¢µ®¤¨² ¢ V 0 . ±«¨ ±·¨² ²¼, ·²® ¢¥°¸¨­ 
À¯®ª°»¢ ¥²Á ¨­¶¨¤¥­²­»¥ ¥© °¥¡° , ²® ¢¥°¸¨­­®¥ ¯®ª°»²¨¥ £° ´  G | ½²® ¬­®¦¥±²¢® ¢¥°¸¨­, ª®²®°»¥ ¯®ª°»¢ ¾² ¢±¥ ¥£® °¥¡° .
 §¬¥°®¬ (size) ¢¥°¸¨­­®£® ¯®ª°»²¨¿ ­ §»¢ ¥²±¿ ·¨±«® ¢µ®¤¿¹¨µ
¢ ­¥£® ¢¥°¸¨­.  ¯°¨¬¥°, £° ´ °¨±. 36.13 (b) ¨¬¥¥² ¢¥°¸¨­­®¥
¯®ª°»²¨¥ fw; z g (° §¬¥°  2).
 ¤ ·  ® ¢¥°¸¨­­®¬ ¯®ª°»²¨¨ (vertex-cover problem) ²°¥¡³¥²
³ª § ²¼ ¬¨­¨¬ «¼­® ¢®§¬®¦­»© ° §¬¥° ¢¥°¸¨­­®£® ¯®ª°»²¨¿ ¤«¿
§ ¤ ­­®£® £° ´ .  ª ®¡»·­®, ¬» ¯¥°¥©¤¥¬ ®² § ¤ ·¨ ®¯²¨¬¨§ ¶¨¨ ª § ¤ ·¥ ° §°¥¸¥­¨¿ ¨ ¡³¤¥¬ ±¯° ¸¨¢ ²¼, ¨¬¥¥² «¨ ¤ ­­»© £° ´ ¢¥°¸¨­­®¥ ¯®ª°»²¨¥ ¤ ­­®£® ° §¬¥° . ®®²¢¥²±²¢³¾¹¨© ¿§»ª ² ª®¢:
VERTEX-COVER = fhG; ki : £° ´ G ¨¬¥¥² ¢¥°¸¨­­®¥ ¯®ª°»²¨¥ ° §¬¥°  kg
¥®°¥¬  36.12
 ¤ ·  VERTEX-COVER ¿¢«¿¥²±¿ NP-¯®«­®©.
®ª § ²¥«¼±²¢®
­ · «  ³¡¥¤¨¬±¿, ·²® ¤ ­­ ¿ § ¤ ·  ¯°¨­ ¤«¥¦¨² ª« ±±³ NP.
 ± ¬®¬ ¤¥«¥, ¢ ª ·¥±²¢¥ ±¥°²¨´¨ª ²  £®¤¨²±¿ ± ¬® ¢¥°¸¨­­®¥
¯®ª°»²¨¥ («¥£ª® ¯°®¢¥°¨²¼, ·²® ®­® ¨¬¥¥² ²°¥¡³¥¬»© ° §¬¥° ¨
·²® ®­® ¤¥©±²¢¨²¥«¼­® ¿¢«¿¥²±¿ ¯®ª°»²¨¥, ¯°®±¬®²°¥¢ ¢±¥ °¥¡° ).
²®¡» ¤®ª § ²¼, ·²® § ¤ ·  VERTEX-COVER ¿¢«¿¥²±¿ NP²°³¤­®©, ±¢¥¤¥¬ ª ­¥© § ¤ ·³ ® ª«¨ª¥.  ¤®ª § ²¥«¼±²¢¥ ¨±¯®«¼§³¥²±¿ ¯®­¿²¨¥ ¤®¯®«­¥­¨¿ £° ´ . ³±²¼ ¤ ­ ­¥®°¨¥­²¨°®¢ ­­»©
£° ´ G = (V; E ). £® ¤®¯®«­¥­¨¥¬ (complement) ­ §®¢¥¬ £° ´
G = (V; E), £¤¥ E = f(u; v) : (u; v ) 2= E g. °³£¨¬¨ ±«®¢ ¬¨, £° ´
G ¨¬¥¥² ²¥ ¦¥ ¢¥°¸¨­», ·²® ¨ £° ´ G,   °¥¡°  ±®¥¤¨­¿¾² ²¥ ¯ °» ¢¥°¸¨­, ª®²®°»¥ ­¥ ¡»«¨ ±®¥¤¨­¥­» °¥¡°®¬ ¢ £° ´¥ G.  
°¨±. 36.13 ¯®ª § ­» ¯°¨¬¥° £° ´  ¨ ¥£® ¤®¯®«­¥­¨¿, ¯®¿¢«¿¾¹¨¥±¿ ¯°¨ ±¢¥¤¥­¨¨ § ¤ ·¨ CLIQUE ± § ¤ ·¥ VERTEX-COVER.

846

« ¢  36 NP-¯®«­®² 

36.13
¢¥¤¥­¨¥ § ¤ ·¨ CLIQUE ª § ¤ ·¥ VERTEX-COVER.
(a) ¥®°¨¥­²¨°®¢ ­­»© £° ´ G = (V; E ) ¨ ª«¨ª  V 0 = fu; v; x; y g.
(b) £® ¤®¯®«­¥­¨¥ G , ¯®±²°®¥­­®¥ ±¢®¤¿¹¨¬  «£®°¨²¬®¬, ¨¬¥¥²
¢¥°¸¨­­®¥ ¯®ª°»²¨¥ V n V 0 = fw; z g.
¢®¤¿¹¨©  «£®°¨²¬ ¯®«³· ¥² ­  ¢µ®¤ £° ´ G ¨ ·¨±«® k; ¢®¯°®±
±®±²®¨² ¢ ²®¬, ¥±²¼ «¨ ¢ £° ´¥ g ª«¨ª  ° §¬¥°  k. «£®°¨²¬ ±²°® jV j; ki.
¨² £° ´ G (¤®¯®«­¥­¨¥ £° ´  G) ¨ ¤ ¥² ­  ¢»µ®¤¥ ¯ °³ hG;

±² ¥²±¿ § ¬¥²¨²¼, ·²® £° ´ G ¨¬¥¥² ¢¥°¸¨­­®¥ ¯®ª°»²¨¥ ° §¬¥°  jV j; k ²®£¤  ¨ ²®«¼ª® ²®£¤ , ª®£¤  £° ´ G ¨¬¥¥² ª«¨ª³ ° §¬¥° 
k (¢®§¬®¦­®±²¼ ¢»¯®«­¨²¼ ½²® ¯°¥®¡° §®¢ ­¨¥ §  ¯®«¨­®¬¨ «¼­®¥
¢°¥¬¿ ®·¥¢¨¤­ ).
 ± ¬®¬ ¤¥«¥, ¥±«¨ ¥±²¼ ª«¨ª  ° §¬¥°  k, ²® ¥¥ ¤®¯®«­¥­¨¥ ®¡° §³¥² ¢¥°¸¨­­®¥ ¯®ª°»²¨¥ £° ´  G («¾¡®¥ °¥¡°® £° ´  G ®²±³²±²¢³¥² ¢ £° ´¥ G, ¯®½²®¬³ ®¤¨­ ¨§ ª®­¶®¢ ½²®£® °¥¡°  ¤®«¦¥­
¡»²¼ ¢­¥ ª«¨ª¨).
 ¯°®²¨¢, ¥±«¨ ¥±²¼ ¢¥°¸¨­­®¥ ¯®ª°»²¨¥ £° ´  G ° §¬¥°  jV j;
k, ²® ¥£® ¤®¯®«­¥­¨¥ ¿¢«¿¥²±¿ ª«¨ª®©: ¥±«¨ ª ª¨¥-²® ¤¢¥ ¢¥°¸¨­»
½²®£® ¤®¯®«­¥­¨¿ ­¥ ±¢¿§ ­» °¥¡°®¬ ¢ £° ´¥ G, ²® ®­¨ ¡»«¨ ¡»
±¢¿§ ­» °¥¡°®¬ ¢ G , ¨ ½²® °¥¡°® ­¥ ¡»«® ¡» ¯®ª°»²®.
®±ª®«¼ª³ § ¤ ·  VERTEX-CLIQUE ¿¢«¿¥²±¿ NP¯®«­®©, ¢°¿¤ «¨
¤«¿ ­¥¥ ±³¹¥±²¢³¥² ½´´¥ª²¨¢­»©  «£®°¨²¬. ¤­ ª®, ª ª ¬» ³¢¨¤¨¬ ¢ ° §¤¥«¥ 37.1, ±³¹¥±²¢³¥² ½´´¥ª²¨¢­»©  «£®°¨²¬, ¤ ¾¹¨©
À¯°¨¡«¨¦¥­­®¥Á °¥¸¥­¨¥ ½²®© § ¤ ·¨ | ¬®¦­® ­ ©²¨ ¢¥°¸¨­­®¥
¯®ª°»²¨¥, ¢ ª®²®°®¬ ·¨±«® ¢¥°¸¨­ ­¥ ¡®«¥¥ ·¥¬ ¢¤¢®¥ ¯°¥¢®±µ®¤¨²
¬¨­¨¬ «¼­® ¢®§¬®¦­®¥.
 ª¨¬ ®¡° §®¬, NP-¯®«­®²  § ¤ ·¨ ¥¹¥ ­¥ ®§­ · ¥², ·²® ­ ¤®
®²ª § ²¼±¿ ®² ¨¤¥¨ ¥¥ °¥¸¨²¼ | ¢®§¬®¦­®, ­ ¯°¨¬¥°, ·²® ¥±²¼ ¯®«¨­®¬¨ «¼­»©  «£®°¨²¬, ª®²®°»© ¤ ¥² °¥¸¥­¨¥, ¡«¨§ª®¥ ª ®¯²¨¬ «¼­®¬³. ( ° §¤¥«¥ 37 ¬» ¢¥°­¥¬±¿ ª ½²®© ¨¤¥¥ ¨ ° ±±¬®²°¨¬
¯°¨¡«¨¦¥­­»¥  «£®°¨²¬» ¤«¿ ­¥±ª®«¼ª¨µ NP-¯®«­»µ § ¤ ·.)
36.5.3  ¤ ·  ® ±³¬¬ µ ¯®¤¬­®¦¥±²¢
 ½²®¬ ° §¤¥«¥ ¬» ° ±±¬®²°¨¬ ¥¹¥ ®¤­³ NP-¯®«­³¾ § ¤ ·³, ­ 
½²®² ° § |  °¨´¬¥²¨·¥±ª³¾. ³±²¼ ¤ ­» ª®­¥·­®¥ ¬­®¦¥±²¢® ­ ²³° «¼­»µ ·¨±¥« S  N ¨ ·¨±«® t 2 N.  § ¤ ·¥ ® ±³¬¬ µ ¯®¤¬­®¦¥±²¢ ²°¥¡³¥²±¿ ¢»¿±­¨²¼, ±³¹¥±²¢³¥² «¨ ² ª®¥ ¯®¤¬­®¦¥±²¢®
S 0  S , ±³¬¬  ½«¥¬¥­²®¢ ª®²®°®£® ° ¢­  t.  ¯°¨¬¥°, ¥±«¨ S =
f1; 4; 16; 64; 256; 1040; 1093; 1284; 1344g ¨ t = 3754, ²® ®²¢¥² ¡³¤¥² ¯®«®¦¨²¥«¼­»¬ | ¬®¦­® ¢§¿²¼ S 0 = f1; 16; 64; 256; 1040; 1093; 1284g.
®®²¢¥²±²¢³¾¹¨© ¿§»ª ² ª®¢:
X
SUBSET-SUM = fhS; ti : ±³¹¥±²¢³¥² ² ª®¥ ¯®¤¬­®¦¥±²¢® S 0  S; ·²® t =
sg:
 ¯®¬­¨¬, ·²® ¬» § ¯¨±»¢ ¥¬ ·¨±«  ¢ ¤¢®¨·­®© ±¨±²¥¬¥ (¯°¥¤±² ¢«¿¿ ¢µ®¤ § ¤ ·¨ ¢ ¢¨¤¥ ¡¨²®¢®© ±²°®ª¨).

s2S 0

NP-¯®«­»¥ § ¤ ·¨

847

36.14 ¢¥¤¥­¨¥ § ¤ ·¨ ® ¢¥°¸¨­­®¬ ¯®ª°»²¨¨ ª § ¤ ·¥ ® ±³¬¬ µ
¯®¤¬­®¦¥±²¢.
(a) ¥®°¨¥­²¨°®¢ ­­»© £° ´ G. ¢¥²«®-±¥°»¥ ¢¥°¸¨­» ®¡° §³¾²
¢¥°¸¨­­®¥ ¯®ª°»²¨¥ fv1; v3; v4g ° §¬¥°  3.
(b)  ²°¨¶  ¨­¶¨¤¥­²­®±²¨ ½²®£® £° ´ . ¢¥²«®-±¥°»¥ ±²°®ª¨ ±®®²¢¥²±²¢³¾² ¢¥°¸¨­ ¬ ¯®ª°»²¨¿.
(c) ®®²¢¥²±²¢³¾¹¨© ¢µ®¤ § ¤ ·¨ ® ±³¬¬ µ ¯®¤¬­®¦¥±²¢. ­³²°¨ ° ¬ª¨ ­ µ®¤¨²±¿ ¬ ²°¨¶  ¨­¶¨¤¥­²­®±²¨, ¥°¸¨­­®¥ ¯®ª°»²¨¥ fv1; v3; v4g ° §¬¥°  k = 3 ±®®²¢¥²±²¢³¥² ¯®¤¬­®¦¥±²¢³ ¨§
±¢¥²«®-±¥°»µ ½«¥¬¥­²®¢ f1; 16; 64; 256; 1040; 1093; 1284g, ±³¬¬  ª®²®°®£® ¥±²¼ 3754.
¥®°¥¬  36.13
 ¤ ·  SUBSET-SUM ¿¢«¿¥²±¿ NP-¯®«­®©.
®ª § ²¥«¼±²¢®
·¥¢¨¤­®, ½²  § ¤ ·  ¯°¨­ ¤«¥¦¨² ª« ±±³ NP (±¥°²¨´¨ª ²®¬
¬®¦­® ±·¨² ²¼ ± ¬® ¯®¤¬­®¦¥±²¢® S 0).
¥¯¥°¼ ¯®ª ¦¥¬, ·²® VERTEX-COVER 6P SUBSET-SUM. ¢®¤¿¹¨©  «£®°¨²¬ ¯°¥®¡° §³¥² ¢µ®¤ hG; ki § ¤ ·¨ ® ¢¥°¸¨­­®¬ ¯®ª°»²¨¨ ¢ ¯ °³ hS; ti ± ² ª¨¬ ±¢®©±²¢®¬: ¢ £° ´¥ G ±³¹¥±²¢³¥²
¢¥°¸¨­­®¥ ¯®ª°»²¨¥ ° §¬¥°  k ²®£¤  ¨ ²®«¼ª® ²®£¤ , ª®£¤  ¢ S
­ ©¤¥²±¿ ¯®¤¬­®¦¥±²¢® ± ±³¬¬®© t.
³¤¥¬ ¨±¯®«¼§®¢ ²¼ ¯°¥¤±² ¢«¥­¨¥ £° ´  G ¬ ²°¨¶¥© ¨­¶¨¤¥­²­®±²¨. ³±²¼ G = (V; E ) | ­¥®°¨¥­²¨°®¢ ­­»© £° ´; ¬» ±·¨² ¥¬,
·²® ¥£® ¢¥°¸¨­ ¬¨ ¿¢«¿¾²±¿ ·¨±«  0; 1; 2; : : : ; jV j ; 1,   °¥¡° ¬¨ |
·¨±«  0; 1; 2; : : : ; jE j; 1. ®£¤  ¬ ²°¨¶¥© ¨­¶¨¤¥­²­®±²¨ (incidence
matrix) £° ´  G ¡³¤¥² jV j  jE j-¬ ²°¨¶  B , ®¯°¥¤¥«¿¥¬ ¿ ² ª:

bij =



1; ¥±«¨ °¥¡°® j ¨­¶¨¤¥­²­® ¢¥°¸¨­¥ i,
0; ¢ ¯°®²¨¢­®¬ ±«³· ¥.

 ¯°¨¬¥°, ¬ ²°¨¶  ¨­¶¨¤¥­²­®±²¨ °¨±. 36.14 (b) ±®®²¢¥²±²¢³¥²
£° ´³ °¨±. 36.14 (a).
¢®¤¿¹¨©  «£®°¨²¬ ¯®«³· ¥² ­  ¢µ®¤ ¬ ²°¨¶³ ¨­¶¨¤¥­²­®±²¨ B
¨ ·¨±«® k. °¥¡³¥²±¿ ¯®±²°®¨²¼ ¬­®¦¥±²¢® S ¨ ·¨±«® t. ±¥ ·¨±« 
¡³¤¥¬ § ¯¨±»¢ ²¼ ¢ ±¨±²¥¬¥ ±·¨±«¥­¨¿ ¯® ®±­®¢ ­¨¾ 4.
­®¦¥±²¢® S ¡³¤¥² ±®±²®¿²¼ ¨§ ·¨±¥« ¤¢³µ ²¨¯®¢: ®¤­¨ ±®®²¢¥²±²¢³¾² ¢¥°¸¨­ ¬ £° ´ , ¤°³£¨¥ | ¥£® °¥¡° ¬.  ¦¤®© ¢¥°¸¨­¥
i 2 V ±² ¢¨²±¿ ¢ ±®®²¢¥²±²¢¨¥ ·¨±«®, ª®²®°®¥ § ¯¨±»¢ ¥²±¿ (¢ ±¨±²¥¬¥ ¯® ®±­®¢ ­¨¾ 4) ¨ jE j ² ª: ±­ · «  ¨¤¥² ¥¤¨­¨¶ ,   ¯®²®¬
i- ¿ ±²°®ª  ¬ ²°¨¶» ¨­¶¨¤¥­²­®±²¨ B = (bij ) (°¨±. 36.14 (c)), ²®
¥±²¼ ±²°®ª , ±®®²¢¥²±²¢³¾¹ ¿ ½²®© ¢¥°¸¨­¥.  ¦¤®¬³ °¥¡°³ j 2 E
±®¯®±² ¢«¿¥²±¿ ·¨±«® yj , § ¯¨±¼ ª®²®°®£® ±®¤¥°¦¨² ¥¤¨­±²¢¥­­³¾
¥¤¨­¨¶³ ¢ ¯®§¨¶¨¨, ±®®²¢¥²±²¢³¾¹¥© °¥¡°³ i (².¥. ·¨±«® 4j ).
±² ¥²±¿ ³ª § ²¼ ·¨±«® t. ² °¸¨¥ ° §°¿¤» ·¨±«  t ±®¢¯ ¤ ¾²
± § ¯¨±¼¾ ·¨±«  k ¯® ®±­®¢ ­¨¾ 4,   ¯®±«¥¤³¾¹¨¥ jE j ° §°¿¤®¢

848

« ¢  36 NP-¯®«­®² 

§ ¯®«­¥­» ¤¢®©ª ¬¨. ®«¥¥ ²®·­®,

t = k  4jE j +

jEX
j;1
j =0

2  4j :

±¥ ¯®±²°®¥­­»¥ ·¨±«  ¨¬¥¾² ¤¢®¨·­®¥ ¯°¥¤±² ¢«¥­¨¥ ¯®«¨­®¬¨ «¼­®£® ° §¬¥°  ¨ ±²°®¿²±¿ §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿.
¥¯¥°¼ ­³¦­® ¯°®¢¥°¨²¼, ·²® £° ´ G ¨¬¥¥² ¢¥°¸¨­­®¥ ¯®ª°»²¨¥ ° §¬¥°  k ²®£¤  ¨ ²®«¼ª® ²®£¤ , ª®£¤  ¢ S ±³¹¥±²¢³¥² ¯®¤¬­®¦¥±²¢® S 0 ± ±³¬¬®© t. ³±²¼ ¤ ­® ¢¥°¸¨­­®¥ ¯®ª°»²¨¥ V 0  V
²°¥¡³¥¬®£® ° §¬¥° , ±®¤¥°¦ ¹¥¥ ¢¥°¸¨­» i1 ; i2; : : : ; ik . ª«¾·¨¬ ¢
¬­®¦¥±²¢® S 0 ·¨±« , ±®®²¢¥²±²¢³¾¹¨¥ ½²¨¬ ¢¥°¸¨­ ¬. ®£¤  ±³¬¬  ½«¥¬¥­²®¢ ¬­®¦¥±²¢  S 0, § ¯¨± ­­ ¿ ¯® ®±­®¢ ­¨¾ 4, ¡³¤¥² ¢»£«¿¤¥²¼ ² ª: ¢ ±² °¸¨µ ° §°¿¤ µ ±²®¨² ·¨±«® k,   ¢® ¢±¥µ ¬« ¤¸¨µ
° §°¿¤ µ ±²®¿² ¶¨´°» 1 ¨«¨ 2 (¢ § ¢¨±¨¬®±²¨ ®² ²®£®, ®¡  ª®­¶  °¥¡°  ¢®¸«¨ ¢ ¢¥°¸¨­­®¥ ¯®ª°»²¨¥ ¨«¨ ²®«¼ª® ®¤¨­). §¿¢ ²¥
°¥¡° , ³ ª®²®°»µ ²®«¼ª® ®¤¨­ ª®­¥¶ ¢®¸¥« ¢ ¢¥°¸¨­­®¥ ¯®ª°»²¨¥ ¨ ¤®¡ ¢¨¢ ±®®²¢¥²±²¢³¾¹¨¥ ¨¬ ·¨±«  ¢ ¬­®¦¥±²¢® S 0, ¬» ¯°¥¢° ²¨¬ ¥¤¨­¨¶» ¢ ¤¢®©ª¨, ²® ¥±²¼ ¯®«³·¨¬ ¢ ±³¬¬¥ ·¨±«® t. ( 
°¨±. 36.14 (c) ¯®²°¥¡®¢ «®±¼ ¤®¡ ¢¨²¼ ·¥²»°¥ ±²°®ª¨ y0 ; y2; y3; y4,
·²®¡» ®¡¥±¯¥·¨²¼ ­¥¤®±² ¾¹¨¥ ¤¢®©ª¨ ¢ ¬« ¤¸¨µ ° §°¿¤ µ.)
¡° ²­®¥ ° ±±³¦¤¥­¨¥  ­ «®£¨·­®. ³±²¼ ¨¬¥¥²±¿ ¬­®¦¥±²¢® S 0,
±³¬¬  ½«¥¬¥­²®¢ ª®²®°®£® ° ¢­  t. ²® §­ ·¨², ·²® ¢ ¬« ¤¸¨µ
° §°¿¤ µ ±³¬¬» ±²®¿² ¤¢®©ª¨. ®±ª®«¼ª³ ±²°®ª¨, ±®®²¢¥²±²¢³¾¹¨¥ °¥¡° ¬, ¬®£³² ¤ ²¼ ¢ ª ¦¤®¬ ° §°¿¤¥ ¬ ª±¨¬³¬ ¥¤¨­¨¶³, ­®
­¨ª ª ­¥ ¤¢®©ª³, ½²® §­ ·¨², ·²® ­¥¤®±² ¾¹ ¿ ¥¤¨­¨¶  ¯°¨µ®¤¨²
®² À¢¥°¸¨­­»µÁ ±²°®ª. «¥¤®¢ ²¥«¼­®, ¢¥°¸¨­», ±®®²¢¥²±²¢³¾¹¨¥
¢µ®¤¿¹¨¬ ¢ S 0 ±²°®ª ¬, ®¡° §³¾² ¢¥°¸¨­­®¥ ¯®ª°»²¨¥.  ±² °¸¨¥
° §°¿¤» £ ° ­²¨°³¾², ·²® ·¨±«® ¢¥°¸¨­ ¢ ½²®¬ ¯®ª°»²¨¨ ° ¢­®
k.
36.4.3.  ¤ ·  ® £ ¬¨«¼²®­®¢®¬ ¶¨ª«¥
¥°­¥¬±¿ ª § ¤ ·¥ ® £ ¬¨«¼²®­®¢®¬ ¶¨ª«¥ (HAM-CYCLE; ¬»
£®¢®°¨«¨ ® ­¥© ¢ ° §¤¥«¥ 36.2).
¥®°¥¬  36.14
 ¤ ·  HAM-CYCLE ¿¢«¿¥²±¿ NP-¯®«­®©.
®ª § ²¥«¼±²¢®
» ³¦¥ ®¡º¿±­¿«¨, ¯®·¥¬³ ½²  § ¤ ·  ¯°¨­ ¤«¥¦¨² ª« ±±³ NP
(£ ¬¨«¼²®­®¢ ¶¨ª« ¬®¦­® ±·¨² ²¼ ±¥°²¨´¨ª ²®¬).
²®¡» ¤®ª § ²¼ NP-¯®«­®²³ § ¤ ·¨ HAM-CYCLE, ¬» ¯®ª ¦¥¬,
·²® 3-CNF-SAT 6m athrmP HAM-CYCLE. °³£¨¬¨ ±«®¢ ¬¨, ¬»
®¯¨¸¥¬  «£®°¨²¬, ¯°¥®¡° §³¾¹¨© ´®°¬³«³ ' ¨§ ª« ±±  3-CNF ±
¯¥°¥¬¥­­»¬¨ x1; x2; : : : ; xn ¢ £° ´ G = (V; E ), ª®²®°»© ¨¬¥¥² £ ¬¨«¼²®­®¢ ¶¨ª« ¢ ²®¬ ¨ ²®«¼ª® ²®¬ ±«³· ¥, ¥±«¨ ¥±«¨ ¨±µ®¤­ ¿

NP-¯®«­»¥ § ¤ ·¨

849

36.15
(a) «®ª A, ¨±¯®«¼§³¥¬»© ¯°¨ ±¢¥¤¥­¨¨ § ¤ ·¨ 3-SAT ª § ¤ ·¥
HAM-CYCLE.
(b){(c) ±«¨ ¡«®ª A ¢µ®¤¨² ¢ £° ´ G ¨ ±®¥¤¨­¿¥²±¿ ± ­¨¬ «¨¸¼ ¢
³£«®¢»µ ¢¥°¸¨­ µ, ²® «¾¡®© £ ¬¨«¼²®­®¢ ¶¨ª« ¢ £° ´¥ G ¯°®µ®¤¨²
·¥°¥§ A ®¤­¨¬ ¨§ ¤¢³µ ±¯®±®¡®¢.
(d) ¨¬¢®«¨·¥±ª®¥ ¨§®¡° ¦¥­¨¥ ¡«®ª  A
36.16
«®ª B , ¨±¯®«¼§³¥¬»© ¯°¨ ±¢¥¤¥­¨¨ § ¤ ·¨ 3-CNF-SAT ª § ¤ ·¥
HAM-CYCLE. ³²¼ ¨§ ¢¥°¸¨­» b1 ¢ b4 ­¥ ¬®¦¥² ¯°®µ®¤¨²¼ ¯® ¢±¥¬
²°¥¬ °¥¡° ¬ b1{b2¡ b2{b3 ¨ b3 {b4, ­® ¬®¦¥² ¯°®µ®¤¨²¼ ¯® «¾¡®¬³
±®¡±²¢¥­­®¬³ ¯®¤¬­®¦¥±²¢³ ½²®£® ¬­®¦¥±²¢ , ª ª ¯®ª § ­® ¢ (a){
(e). ¨¬¢®«¨·¥±ª®¥ ¨§®¡° ¦¥­¨¥ (f) ¯®¤·¥°ª¨¢ ¥² ½²® ±¢®©±²¢®: ¯®
ª° ©­¥© ¬¥°¥ ®¤¨­ ¨§ ²°¥µ ¯³²¥©, ­  ª®²®°»¥ ³ª §»¢ ¾² ±²°¥«ª¨,
¤®«¦¥­ ¢®©²¨ ¢ £ ¬¨«¼²®­®¢ ¯³²¼.
´®°¬³«  ¡»«  ¢»¯®«­¨¬®©.  ­ ¸¥© ª®­±²°³ª¶¨¨ ¬» ¡³¤¥¬ ¨±¯®«¼§®¢ ²¼ ­¥ª®²®°»¥ ¡«®ª¨ | ª³±ª¨ £° ´ , ®¡« ¤ ¾¹¨¥ ­¥ª®²®°»¬¨ ±¯¥¶¨ «¼­»¬¨ ±¢®©±²¢ ¬¨.
¥°¢»© ¨§ ¨±¯®«¼§³¥¬»µ ¡«®ª®¢ (¡«®ª A) ¯®ª § ­ ­ 
°¨±. 36.15 (a). °¥¤¯®«®¦¨¬, ·²® A ¢µ®¤¨² ¢ ­¥ª®²®°»© £° ´ G,
¯°¨·¥¬ «¨¸¼ ¢¥°¸¨­» a; a0; b; b0 ¬®£³² ¡»²¼ ±®¥¤¨­¥­» ± ®±² «¼­»¬¨ ¢¥°¸¨­ ¬¨ £° ´ . ®£¤  £ ¬¨«¼²®­®¢ ¶¨ª« ¢ £° ´¥ G (¥±«¨
² ª®¢®© ±³¹¥±²¢³¥²) ¤®«¦¥­ ¯°®µ®¤¨²¼ ·¥°¥§ ¢¥°¸¨­» z1 ; ;z4 ,
¨ ½²® ¬®¦¥² ¯°®¨±µ®¤¨²¼ «¨¸¼ ¤¢³¬¿ ±¯®±®¡ ¬¨ (°¨±. 36.15 (b)
¨ (c)). ®½²®¬³ ¬®¦­® ±¨¬¢®«¨·¥±ª¨ ¨§®¡° ¦ ²¼ ¡«®ª A ª ª ­ 
°¨±. 36.15 (d), ¨¬¥¿ ¢ ¢¨¤³, ·²® ®­ § ¬¥­¿¥² ¤¢  °¥¡°  a{a0 ¨ b ;;b0
± ² ª¨¬ ¤®¯®«­¨²¥«¼­»¬ ³±«®¢¨¥¬: £ ¬¨«¼²®­®¢ ¶¨ª« ¤®«¦¥­
±®¤¥°¦ ²¼ °®¢­® ®¤­® ¨§ ¤¢³µ ½²¨µ °¥¡¥°.
²®°®© ¨±¯®«¼§³¥¬»© ¡«®ª (B ) ¯®ª § ­ ­  °¨±. 36.16. °¥¤¯®«®¦¨¬, ·²® ¡«®ª B ¢µ®¤¨² ¢ ­¥ª®²®°»© £° ´ G, ¯°¨·¥¬ B ¬®¦¥²
¡»²¼ ±¢¿§ ­ ± ®±² «¼­®© · ±²¼¾ £° ´  ²®«¼ª® ·¥°¥§ ¢¥°¸¨­» b1,
b2, b3 ¨ b4. ®¦­® ¯°®¢¥°¨²¼, ·²® £ ¬¨«¼²®­®¢ ¶¨ª« £° ´  G (¥±«¨
®­ ±³¹¥±²¢³¥²) ­¥ ¬®¦¥² ¯°®µ®¤¨²¼ ®¤­®¢°¥¬¥­­® ·¥°¥§ ²°¨ °¥¡° 
(b1; b2); (b2; b3) ¨ (b3; b4), ¯®±ª®«¼ª³ ²®£¤  ¶¨ª« ­¥ ±¬®£ ¡» ¯°®©²¨
·¥°¥§ ¢±¥ ¢¥°¸¨­» B . ¤­ ª® £ ¬¨«¼²®­®¢ ¶¨ª« ¬®¦¥² ¯°®µ®¤¨²¼
·¥°¥§ «¾¡®¥ ±®¡±²¢¥­­®¥ ¯®¤¬­®¦¥±²¢® ½²®© ²°®©ª¨ °¥¡¥°, ª ª ¯®ª § ­® ­  °¨±. 36.16 (a){(e). (¥¹¥ ¤¢  ±¨¬¬¥²°¨·­»µ ¢ °¨ ­²  ¯®«³· ²±¿, ¥±«¨ ¯¥°¥¢¥°­³²¼ (b) ¨ (e)). «®ª B ¡³¤¥¬ ±¨¬¢®«¨·¥±ª¨
¨§®¡° ¦ ²¼ ª ª ­  °¨±. 36.16(f) (±²°¥«ª¨ ­  °¨±³­ª¥ ®§­ · ¾², ·²®
µ®²¿ ¡» ®¤¨­ ¨§ ²°¥µ ¯³²¥©, ­  ª®²®°»¥ ®­¨ ³ª §»¢ ¾², ¤®«¦¥­
¢®©²¨ ¢ ¢ £ ¬¨«¼²®­®¢ ¶¨ª«).
¥¯¥°¼ ³ ­ ± ¢±¥ £®²®¢® ¤«¿ ¯®±²°®¥­¨¿ £° ´  G, ±®®²¢¥²±²¢³¾¹¥£® ´®°¬³«¥ ¨§ ª« ±±  3-CNF. ²®² £° ´ G ¡³¤¥² ±®±²®¿²¼ ¨§
­¥±ª®«¼ª¨µ ¡«®ª®¢ ²¨¯  A ¨ B (°¨±. 36.17).

850

« ¢  36 NP-¯®«­®² 

36.17 ° ´ G, ¯®±²°®¥­­»© ¯® ´®°¬³«¥ ' = (:x1 _ x2 _ :x3 ) ^ (x1 _
:x2 _ x3) ^ (x1 _ x2 _:x3 ). «¿ ½²®© ´®°¬³«» ¨¬¥¥²±¿ ¢»¯®«­¿¾¹¨©
­ ¡®° x1 = 0, x2 = 1, x3 = 1. ®®²¢¥²±²¢³¾¹¨© £ ¬¨«¼²®­®¢ ¶¨ª«
¯®ª § ­ ±¥°»¬. ²¬¥²¨¬, ·²® ¥±«¨ ¢ ­ ¡®°¥ xm = 1, ²® ¢ ¶¨ª«
¢µ®¤¨² °¥¡°® em ,   ¥±«¨ xm = 0, ²® em .
°¥¤¯®«®¦¨¬, ·²® ´®°¬³«  ' ±®±² ¢«¥­  ¨§ k ¤¨§º¾­ª¶¨©
C1; C2; : : : ; Ck , ª ¦¤ ¿ ¨§ ª®²®°»µ ±®¤¥°¦¨² °®¢­® 3 «¨²¥° « . «¿
ª ¦¤®© ¤¨§º¾­ª¶¨¨ Ci ¨§£®²®¢¨¬ ¡«®ª ²¨¯  B ; ®¡®§­ ·¨¬ ·¥°¥§
bi;j ±®®²¢¥²±²¢³¾¹¨¥ ª®¯¨¨ ¢¥°¸¨­ bj . ®¥¤¨­¨¬ ¢¥°¸¨­» bi;4 ¨
bi+1;1 ¤«¿ i = 1; 2; : : : ; k ; 1.
 «¥¥, ª ¦¤®© ¯¥°¥¬¥­­®© xm ´®°¬³«» ' ¬» ±®¯®±² ¢¨¬ ¯ °³
¢¥°¸¨­ x0m , x00m . ²¨ ¢¥°¸¨­» ¬» ±®¥¤¨­¨¬ ¤¢³¬¿ °¥¡° ¬¨ em ¨
e0m . (  ± ¬®¬ ¤¥«¥, ª ª ¬» ³¢¨¤¨¬, ½²® ¡³¤³² ­¥ °¥¡° ,   ¡®«¥¥

±«®¦­»¥ ª®­±²°³ª¶¨¨, ² ª ·²® ª° ²­»µ °¥¡¥° ­¥ ¡³¤¥².) ¤¥¿ §¤¥±¼
¢ ²®¬, ·²® £ ¬¨«¼²®­®¢ ¶¨ª« ¡³¤¥² ¯°®µ®¤¨²¼ ·¥°¥§ °¥¡°® em , ¥±«¨
¢ ¢»¯®«­¿¾¹¥¬ ­ ¡®°¥ ¯¥°¥¬¥­­ ¿ xm ¯°¨­¨¬ ¥² §­ ·¥­¨¥ 1, ¨
·¥°¥§ e0m , ¥±«¨ ½²  ¯¥°¥¬¥­­ ¿ ¯°¨­¨¬ ¥² §­ ·¥­¨¥ 0.
²®¡» ¤ ²¼ £ ¬¨«¼²®­®¢³ ¶¨ª«³ ¢®§¬®¦­®±²¼ ¯°®©²¨ ¯® em ¨«¨
0
em , ¤®¡ ¢¨¬ ¢ £° ´ °¥¡°  (x00m; x0m+1) ¤«¿ m = 1; 2; : : : ; m ; 1.  
² ª¦¥ ¥¹¥ ¤¢  °¥¡° : (b1;1; x01) ¨ (bk;4; x00n) (¢¥°µ­¥¥ ¨ ­¨¦­¥¥ °¥¡° ,
°¨±. 36.17).
®±²°®¥­¨¥ £° ´  ¥¹¥ ­¥ ®ª®­·¥­®, ¬» ¤®«¦­» ±¢¿§ ²¼ ¡«®ª¨
£° ´ , ±®®²¢¥²±²¢³¾¹¨¥ ¯¥°¥¬¥­­»¬ ´®°¬³«», ± ¡«®ª ¬¨, ±®®²¢¥²±²¢³¾¹¨¬¨ ¥¥ ¤¨§º¾­ª¶¨¿¬. ±«¨ j -»© «¨²¥° « ¤¨§º¾­ª¶¨¨
Ci ¥±²¼ xm , ±®¥¤¨­¨¬ °¥¡°® (bi;j ; bi;j +1) ± °¥¡°®¬ em ± ¯®¬®¹¼¾ A¡«®ª . ±«¨ ¦¥ j -»¬ «¨²¥° «®¬ ¤¨§º¾­ª¶¨¨ Ci ¿¢«¿¥²±¿ :xm , ¬»
±®¥¤¨­¨¬ ± ¯®¬®¹¼¾ A-¡«®ª  °¥¡°  (bi;j ; bi;j +1) ¨ em .  ª, ¢ ¯°¨¬¥°¥ °¨±. 36.17 ¨¬¥¥¬ C2 = x1 _ :x2 _ x3 , ¯®½²®¬³ ¬» ° §¬¥¹ ¥¬ ²°¨
A-¡«®ª  ¬¥¦¤³ °¥¡° ¬¨
(b2;1; b2;2) ¨ e1 ;
(b2;2; b2;3) ¨ e2 ;
(b2;3; b2;4) ¨ e3 .
²¬¥²¨¬, ·²® ±«®¢  À±®¥¤¨­¨²¼ ¤¢  °¥¡°  ± ¯®¬®¹¼¾ AÁ ®§­ · ¾², ·²® ª ¦¤®¥ ¨§ ­¨µ § ¬¥­¿¥²±¿ ­  ¶¥¯®·ª³ ¨§ ¯¿²¨ ­®¢»µ
°¥¡¥° ¨ ¤®¡ ¢«¿¾²±¿ ±¢¿§»¢ ¾¹¨¥ ¨µ °¥¡°  ¨ ¢¥°¸¨­», ª ª ½²®
¯°¥¤³±¬®²°¥­® ª®­±²°³ª¶¨¥© A-¡«®ª  (°¨±. 36.15).
¤¨­ «¨²¥° « lm ¬®¦¥² ¢±²°¥· ²¼±¿ ¢ ­¥±ª®«¼ª¨µ ¤¨§º¾­ª¶¨¿µ (­ ¯°¨¬¥°, :x3 ­  °¨±. 36.17).  ½²¨µ ±«³· ¿µ ²°¥¡³¥²±¿ À¯®¤ª«¾·¨²¼Á ª ±®®²¢¥²±²¢³¾¹¥¬³ °¥¡°³ ­¥±ª®«¼ª® A-¡«®ª®¢; ½²® ¬®¦­® ±¤¥« ²¼, ¥±«¨ ¢µ®¤¿¹¨¥ ¢ A-¡«®ª¨ ¶¥¯®·ª¨ ¨§ ¯¿²¨ °¥¡¥° ±®¥¤¨­¨²¼ ¯®±«¥¤®¢ ²¥«¼­®, ª ª ¯®ª § ­® ­  °¨±. 36.18.
» ³²¢¥°¦¤ ¥¬, ·²® ´®°¬³«  ' ¢»¯®«­¨¬ , ¥±«¨ ¨ ²®«¼ª® ¥±«¨ ¯®±²°®¥­­»© £° ´ G ¨¬¥¥² £ ¬¨«¼²®­®¢ ¶¨ª«. °¥¤¯®«®¦¨¬
±­ · « , ·²® ¢ £° ´¥ G ¥±²¼ £ ¬¨«¼²®­®¢ ¶¨ª« h, ¨ ¤®ª ¦¥¬ ¢»-

NP-¯®«­»¥ § ¤ ·¨

851

36.18
®¤°®¡­®±²¨ ª®­±²°³ª¶¨¨ ¤«¿ ±«³· ¿, ª®£¤  °¥¡°® em (¨«¨ em )
¢µ®¤¨² ¢ ­¥±ª®«¼ª® A-¡«®ª®¢.
(a) ° £¬¥­² °¨±. 36.17.
(b) ° ´, ª®²®°»© ½²®² ´° £¬¥­² ±¨¬¢®«¨§¨°³¥².
¯®«­¨¬®±²¼ ´®°¬³«» '.
¨ª« h ¤®«¦¥­ ¡»²¼ ³±²°®¥­ ² ª:
±­ · «  ¯°®µ®¤¨¬ °¥¡°® (b1;1; x01) (¡³¤¥¬ ±·¨² ²¼, ·²® ±«¥¢  ­ ¯° ¢®);
§ ²¥¬ ¤«¿ ª ¦¤®£® m ¯°®µ®¤¨¬ ¯® ®¤­®¬³ (¨ ²®«¼ª® ®¤­®¬³) ¨§
°¥¡¥° em , e0m ;
¯°®µ®¤¨¬ ¯® °¥¡°³ (bk;4; x00n ) ±¯° ¢  ­ «¥¢®.
¯°®µ®¤¨¬ ¢±¥ B -¡«®ª¨ ±­¨§³ ¢¢¥°µ
 ¬¥²¨¬, ·²® ¢ ¤¥©±²¢¨²¥«¼­®±²¨ ¬» ¯°®µ®¤¨¬ ­¥ ¯® ± ¬¨¬
°¥¡° ¬ em ¨ em ,   ¯® A-¡«®ª ¬, ª®²®°»¥ ª ­¨¬ ¯°¨¢¥¸¥­» (¥±«¨
² ª®¢»¥ ¥±²¼). ²¬¥²¨¬ ² ª¦¥, ·²® ¥±«¨ ­¨ ª em , ­¨ ª em ­¥ ¯°¨¢¥¸¥­® ­¨ ®¤­®£® A-¡«®ª , ²® ¯¥°¥¬¥­­ ¿ xm ­¥ ¢µ®¤¨² ¢ ´®°¬³«³
¨ ¥¥ ¬®¦­® ¢®®¡¹¥ ³¤ «¨²¼, ² ª ·²® ª° ²­»µ °¥¡¥° ¤¥©±²¢¨²¥«¼­®
­¥².
¥¯¥°¼ ¬®¦­® ³ª § ²¼ ¢»¯®«­¿¾¹¨© ­ ¡®° ¤«¿ ´®°¬³«» ': ¥±«¨
°¥¡°® em ¯°¨­ ¤«¥¦¨² £ ¬¨«¼²®­®¢³ ¶¨ª«³ h, ¯®«®¦¨¬ xm = 1.
 ¯°®²¨¢­®¬ ±«³· ¥ ¶¨ª« h ±®¤¥°¦¨² °¥¡°® em , ¨ ¬» ¯®« £ ¥¬
xm = 0.
®ª ¦¥¬, ·²® ¯®±²°®¥­­»© ­ ¡®° ¿¢«¿¥²±¿ ¢»¯®«­¿¾¹¨¬ ¤«¿
´®°¬³«» '.  ±±¬®²°¨¬ ª ª³¾-²® ¤¨§º¾­ª¶¨¾ Ci ¨ ±®®²¢¥²±²¢³¾¹¨© ¥© B -¡«®ª.  ¦¤®¥ °¥¡°® (bi;j ; bi;j +1) ±¢¿§ ­® ± ¯®¬®¹¼¾ A¡«®ª  «¨¡® ± °¥¡°®¬ em , «¨¡® ± °¥¡°®¬ em (¢ § ¢¨±¨¬®±²¨ ®² ²®£®,
¿¢«¿¥²±¿ «¨ j -¬ «¨²¥° «®¢ ¢ ¤¨§º¾­ª¶¨¨ Ci ¯¥°¥¬¥­­ ¿ xm ¨«¨
¥¥ ®²°¨¶ ­¨¥ :xm ). ¨ª« h ¯°®µ®¤¨² ·¥°¥§ °¥¡°® (bi;j ; bi;j +1), ¥±«¨
¨ ²®«¼ª® ¥±«¨ ±®®²¢¥²±²¢³¾¹¨© «¨²¥° « ° ¢¥­ 0. ±¯®¬­¨¬, ·²®
h ­¥ ¬®¦¥² ¯°®µ®¤¨²¼ ·¥°¥§ ¢±¥ ²°¨ °¥¡°  (bi;1; bi;2), (bi;2; bi;3) ¨
(bi;3; bi;4) ¢ B -¡«®ª¥, ¯®½²®¬³ µ®²¿ ¡» ®¤­®¬³ ¨§ ½²¨µ °¥¡¥° ±®®²¢¥²±²¢³¥² ¨±²¨­­»© «¨²¥° « ¤¨§º¾­ª¶¨¨, ¨ ¤¨§º¾­ª¶¨¿ Ci ¨±²¨­­ .
²® ¬®¦­® ±ª § ²¼ ¯°® «¾¡³¾ ¤¨§º¾­ª¶¨¾ Ci, ² ª ·²® ¢±¥ ®­¨
¨±²¨­­» ¨ ´®°¬³«  ' ¨±²¨­­  ¤«¿ ¯®±²°®¥­­®£® ­ ¡®°  §­ ·¥­¨©
¯¥°¥¬¥­­»µ.
¡° ²­®, ¯³±²¼ ' ¨±²¨­­ ¿ ¤«¿ ­¥ª®²®°®£® ­ ¡®°  §­ ·¥­¨© ¯¥°¥¬¥­­»µ. ®±²°®¨¬ ¶¨ª« h ¯® ®¯¨± ­­»¬ ¢»¸¥ ¯° ¢¨« ¬ (¶¨ª«
±®¤¥°¦¨² °¥¡°® em ¯°¨ xm = 1 ¨ °¥¡°® em ¯°¨ xm = 0; ¶¨ª«
¯°®µ®¤¨² ·¥°¥§ °¥¡°® (bi;j ; bi;j +1), ¥±«¨ ¨ ²®«¼ª® ¥±«¨ j -© «¨²¥° «
¤¨§º¾­ª¶¨¨ Ci ° ¢¥­ 0 ­  ¤ ­­®¬ ­ ¡®°¥. ·¥¢¨¤­®, ®¯¨± ­­»¥
¯° ¢¨«  ¯®§¢®«¿¾² ¯®±²°®¨²¼ £ ¬¨«¼²®­®¢ ¶¨ª« ¯® ¢»¯®«­¿¾¹¥¬³ ­ ¡®°³.
²¬¥²¨¬, ­ ª®­¥¶, ·²® £° ´ G ¨¬¥¥² ¯®«¨­®¬¨ «¼­»© ° §¬¥°

852

« ¢  36 NP-¯®«­®² 

(².¥. ¥£® ° §¬¥° ®£° ­¨·¥­ ¯®«¨­®¬®¬ ®² ° §¬¥°  ´®°¬³«» '),
¨ ·²® ¯®±²°®¥­¨¥ £° ´  G ¯® ´®°¬³«¥ ' ¯°®¢®¤¨²±¿ §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿.  ª¨¬ ®¡° §®¬, § ¤ ·  3-CNF-SAT ±¢®¤¨²±¿ § 
¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿ ª § ¤ ·¥ HAM-CYCLE, ·²® ¨ ²°¥¡®¢ «®±¼
¤®ª § ²¼.
36.4.4.  ¤ ·  ª®¬¬¨¢®¿¦¥° 
 § ¤ ·¥© ® £ ¬¨«¼²®­®¢®¬ ¶¨ª«¥ ²¥±­® ±¢¿§ ­  § ¤ ·  ª®¬¬¨¢®¿¦¥°  (traveling salesman problem, TSP).  ½²®© § ¤ ·¥ ²°¥¡³¥²±¿
­ ©²¨ ®¯²¨¬ «¼­»© ¬ °¸°³² ¯®±¥¹¥­¨¿ n £®°®¤®¢.
®¬¬¨¢®¿¦¥° µ®·¥² ®¡º¥µ ²¼ ¢±¥ £®°®¤ , ¯®¡»¢ ¢ ¢ ª ¦¤®¬ °®¢­® ¯® ®¤­®¬³ ° §³ ¨ ¢¥°­³²¼±¿ ¢ £®°®¤, ¨§ ª®²®°®£® ­ · ²® ¯³²¥¸¥±²¢¨¥. §¢¥±²­®, ·²® ¯¥°¥«¥² ¨§ £®°®¤  i ¢ £®°®¤ j ±²®¨² c(i; j )
°³¡«¥© (±·¨² ¥¬ ¶¥­» ¶¥«»¬¨ ·¨±« ¬¨).  ²¥°¬¨­ µ ²¥®°¨¨ £° ´®¢ § ¤ ·³ ¬®¦­® ±´®°¬³«¨°®¢ ²¼ ² ª: ²°¥¡³¥²±¿ ­ ©²¨ ¢ ¤ ­­®¬
£° ´¥ £ ¬¨«¼²®­®¢ ¶¨ª« ± ­ ¨¬¥­¼¸¥© ±²®¨¬®±²¼¾ (±²®¨¬®±²¼ ¶¨ª«  ¥±²¼ ±³¬¬  ±²®¨¬®±²¥© ¢±¥µ ¥£® °¥¡¥°). ®®²¢¥²±²¢³¾¹¨© ¿§»ª
´®°¬ «¼­® ®¯°¥¤¥«¿¥²±¿ ² ª:
TSP = fhG; c; ki : G = (V; E ) | ¯®«­»© £° ´,c : V  V ! Z| ´³­ª¶¨¿ ±²®¨¬®±²¨,
k 2 Z¨ ¢ G ¥±²¼ £ ¬¨«¼²®­®¢ ¶¨ª« ±²®¨¬®±²¨ ­¥ ¡®«¥¥ kg:
¥®°¥¬  36.15
 ¤ ·  ª®¬¬¨¢®¿¦¥°  ¿¢«¿¥²±¿ NP-¯®«­®©.
®ª § ²¥«¼±²¢®
·¥¢¨¤­®, § ¤ ·  TSP ¯°¨­ ¤«¥¦¨² ª« ±±³ NP (¢ ª ·¥±²¢¥ ±¥°²¨´¨ª ²  ¬®¦­® ¢§¿²¼ £ ¬¨«¼²®­®¢ ¶¨ª« ±²®¨¬®±²¨ ­¥ ¢»¸¥ k).
²®¡» ³¡¥¤¨²¼±¿, ·²® § ¤ ·  ª®¬¬¨¢®¿¦¥°  ¿¢«¿¥²±¿ NP²°³¤­®©, ±¢¥¤¥¬ ª ­¥© § ¤ ·³ HAM-CYCLE. ²®¡» ³§­ ²¼, ¥±²¼
«¨ ¢ £° ´¥ G £ ¬¨«¼²®­®¢ ¶¨ª«, ¯®±²°®¨¬ ¯®«­»© £° ´ G0 ± ²¥¬¨
¦¥ ¢¥°¸¨­ ¬¨; °¥¡°  ¨§ G ¡³¤³² ¨¬¥²¼ ¶¥­³ 0,   ¢±¥ ®±² «¼­»¥
°¥¡°  | ¶¥­³ 1. ·¥¢¨¤­®, ·²® ¢ £° ´¥ G0 ±³¹¥±²¢³¥² ¯³²¼ ª®¬¬¨¢®¿¦¥°  ±²®¨¬®±²¨ 0 ¢ ²®¬ ¨ ²®«¼ª® ¢ ²®¬ ±«³· ¥, ª®£¤  £° ´
G ¨¬¥« £ ¬¨«¼²®­®¢ ¶¨ª«.
¯° ¦­¥­¨¿
36.5-1
 ¤ ·  ¨§®¬®°´¨§¬  ± ¯®¤£° ´®¬ subgraph-isomorphism problem
²°¥¡³¥² ¢»¿±­¨²¼ ¤«¿ ¯ °» £° ´®¢ G1 ¨ G2, ¨§®¬®°´¥­ «¨ £° ´
G1 ­¥ª®²®°®¬³ ¯®¤£° ´³ £° ´  G2. ®ª ¦¨²¥, ·²® ½²  § ¤ ·  NP¯®«­ .
36.5-2
 ­  ¶¥«®·¨±«¥­­ ¿ ¬ ²°¨¶  A ° §¬¥°  m  n ¨ m-¬¥°­»© ¢¥ª²®° b.  ¤ ·  0-1 ¶¥«®·¨±«¥­­®£® «¨­¥©­®£® ¯°®£° ¬¬¨°®¢ ­¨¿ (01 integer-progeamming problem) ²°¥¡³¥² ¢»¿±­¨²¼, ±³¹¥±²¢³¥² «¨
² ª®© n-¬¥°­»© ¢¥ª²®° x ± ½«¥¬¥­² ¬¨ ¨§ ¬­®¦¥±²¢  f0; 1g, ·²®
Ax 6 b. ®ª ¦¨²¥, ·²® ¤ ­­ ¿ § ¤ ·  NP-¯®«­ . (ª § ­¨¥: ±¢¥¤¨-

NP-¯®«­»¥ § ¤ ·¨

853

²¥ ª ­¥© § ¤ ·³ 3-CNF-SAT.)
36.5-3
®ª ¦¨²¥, ·²® § ¤ ·  ® ±³¬¬¥ ¯®¤¬­®¦¥±²¢  ±² ­®¢¨²±¿ ¯®«¨­®¬¨ «¼­®©, ¥±«¨ ¢¥«¨·¨­³ ²°¥¡³¥¬®© ±³¬¬» (t) § ¯¨±»¢ ²¼ ¢ ³­ °­®© ±¨±²¥¬¥ ±·¨±«¥­¨¿ (ª ª ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¨§ t ¥¤¨­¨¶).
36.5-4
 ¤ ·  ® ° §¡¨¥­¨¨ ­  ° ¢­»¥ · ±²¨ (set-partition problem) ±®±²®¨² ¢ ±«¥¤³¾¹¥¬: ¤ ­® ¬­®¦¥±²¢® ¶¥«»µ ·¨±¥« S ; ¢»¿±­¨²¼, ¬®¦­® «¨ ° §¡¨²¼ ¥£® ­  ¤¢¥ · ±²¨ ± ° ¢­»¬¨
±³¬¬ ¬¨,
²® ¥±²¼ ­ ©²¨
P
P
¬­®¦¥±²¢® A  S , ¤«¿ ª®²®°®£® x2A x = x2S nA x. ®ª ¦¨²¥,
·²® ½²  § ¤ ·  ¿¢«¿¥²±¿ NP-¯®«­®©.
36.5-5
®ª ¦¨²¥ NP-¯®«­®²³ § ¤ ·¨ ® £ ¬¨«¼²®­®¢®¬ ¯³²¨ (³¯°. 36.26).
36.5-6
 ¤ ·  ® ± ¬®¬ ¤«¨­­®¬ ¯°®±²®¬ ¶¨ª«¥ ±®±²®¨² ¢ ®²»±ª ­¨¨ ¢
¤ ­­®¬ £° ´¥ ¯°®±²®£® (¡¥§ ¯®¢²®°¿¾¹¨µ±¿ ¢¥°¸¨­) ¶¨ª«  ­ ¨¡®«¼¸¥© ¤«¨­». ´®°¬³«¨°³©²¥ ±®®²¢¥²±²¢³¾¹³¾ § ¤ ·³ ° §°¥¸¥­¨¿ ¨ ¤®ª ¦¨²¥ ¥¥ NP-¯®«­®²³.
36.5-7
°®´¥±±®° ³²¢¥°¦¤ ¥², ·²® ª®­±²°³ª¶¨¾ A-¡«®ª  ¢ ¤®ª § ²¥«¼±²¢¥ ²¥®°¥¬» 36.14 ¬®¦­® ³¯°®±²¨²¼, ¨±ª«¾·¨¢ ¢¥°¸¨­» z3 ¨ z4 ,  
² ª¦¥ ¢¥°¸¨­» ¯®¤ ­ ¤ ­¨¬¨. ° ¢ «¨ ®­ | ¨«¨ ² ª®¥ ³¯°®¹¥­¨¥
±®§¤ ±² ­¥ ¯°¥¤¢¨¤¥­­»¥ ¨¬ ¯°®¡«¥¬»?
 ¤ ·¨
36-1 ¥§ ¢¨±¨¬®¥ ¬­®¦¥±²¢®
­®¦¥±²¢® ¢¥°¸¨­ V 0  V £° ´  G = (V; E ) ­ §»¢ ¥²±¿ ­¥§ ¢¨±¨¬»¬ (independent), ¥±«¨ ­¨ª ª¨¥ ¤¢¥ ¥£® ¢¥°¸¨­» ­¥ ±®¥¤¨­¥­»
°¥¡°®¬.  ¤ ·  ® ­¥§ ¢¨±¨¬®¬ ¬­®¦¥±²¢¥ (independent-set problem) ±®±²®¨² ¢ ®²»±ª ­¨¨ ¢ ¤ ­­®¬ £° ´¥ ­¥§ ¢¨±¨¬®£® ¬­®¦¥±²¢ 
¬ ª±¨¬ «¼­®£® ° §¬¥° .
a. ´®°¬³«¨°³©²¥ ±®®²¢¥²±²¢³¾¹³¾ § ¤ ·³ ° §°¥¸¥­¨¿ ¨ ¤®ª ¦¨²¥ ¥¥ NP-¯®«­®²³.
b. °¥¤¯®«®¦¨¬, ¬» ¨¬¥¥¬ À·¥°­»© ¿¹¨ªÁ, ± ¯®¬®¹¼¾ ª®²®°®£® ¬®¦¥¬ °¥¸ ²¼ § ¤ ·³ ¨§ ¯³­ª²  (a) §  ¥¤¨­¨·­®¥ ¢°¥¬¿.  ª
± ¥£® ¯®¬®¹¼¾ ­ µ®¤¨²¼ ­¥§ ¢¨±¨¬®¥ ¬­®¦¥±²¢® ¬ ª±¨¬ «¼­®£®
° §¬¥°  (  ­¥ ²®«¼ª® ½²®² ° §¬¥°) §  ¯®«¨­®¬¨ «¼­®¥ (®² jV j ¨
jE j) ¢°¥¬¿?
®²¿ § ¤ ·  ® ­¥§ ¢¨±¨¬®¬ ¬­®¦¥±²¢¥ ¢ ®¡¹¥© ¯®±² ­®¢ª¥ NP¯®«­ , ­¥ª®²®°»¥ ¥¥ · ±²­»¥ ±«³· ¨ ¬®£³² ¡»²¼ °¥¸¥­» §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿.
c. ®±²°®©²¥ ¯®«¨­®¬¨ «¼­»©  «£®°¨²¬, °¥¸ ¾¹¨© § ¤ ·³ ® ­¥§ ¢¨±¨¬®¬ ¬­®¦¥±²¢¥ ¤«¿ £° ´®¢ ±²¥¯¥­¨ 2. ®ª ¦¨²¥ ¯° ¢¨«¼­®±²¼ ¢ ¸¥£®  «£®°¨²¬  ¨ ®¶¥­¨²¥ ¢°¥¬¿ ¥£® ° ¡®²».
d. ®±²°®©²¥ ¯®«¨­®¬¨ «¼­»©  «£®°¨²¬, °¥¸ ¾¹¨© § ¤ ·³ ® ­¥§ ¢¨±¨¬®¬ ¬­®¦¥±²¢¥ ¤«¿ ¤¢³¤®«¼­»µ £° ´®¢. ®ª ¦¨²¥ ¯° ¢¨«¼-

854

« ¢  36 NP-¯®«­®² 

­®±²¼ ¢ ¸¥£®  «£®°¨²¬  ¨ ®¶¥­¨²¥ ¢°¥¬¿ ¥£® ° ¡®²». (ª § ­¨¥:
¨±¯®«¼§³©²¥ °¥§³«¼² ²» ° §¤¥«  27.3.)
36-2  ±ª° ±ª  £° ´ 
 §®¢¥¬ k-° ±ª° ±ª®© (k-coloring) ­¥®°¨¥­²¨°®¢ ­­®£® £° ´ 
G = (V; E ) ´³­ª¶¨¾ c : V ! f1; 2; : : : ; kg, ¤«¿ ª®²®°®© c(u) 6= c(v )
¤«¿ ¢±¥µ °¥¡¥° (u; v ) 2 E . ±«¨ ±·¨² ²¼, ·²® ·¨±«  1; 2; : : : ; k ®¡®§­ · ¾² k ° §«¨·­»µ ¶¢¥²®¢,   c(v ) ¥±²¼ ¶¢¥² ¢¥°¸¨­» v , ²® ³±«®¢¨¥ ­  ° ±ª° ±ª³ ±®±²®¨² ¢ ²®¬, ·²® ª®­¶» «¾¡®£® °¥¡°  ¨¬¥¾²
° §­»¥ ¶¢¥² .  ¤ ·  ® ° ±ª° ±ª¥ £° ´  (graph-coloring problem)
±®±²®¨² ¢ ­ µ®¦¤¥­¨¨ ¬¨­¨¬ «¼­®£® ª®«¨·¥±²¢  ¶¢¥²®¢, ­¥®¡µ®¤¨¬®£® ¤«¿ ° ±ª° ±ª¨ ¤ ­­®£® £° ´  G ± ±®¡«¾¤¥­¨¥¬ ½²®£® ³±«®¢¨¿.
a. ®±²°®©²¥ ½´´¥ª²¨¢­»©  «£®°¨²¬, ­ µ®¤¿¹¨© 2-° ±ª° ±ª³
¤ ­­®£® £° ´  (¥±«¨ ² ª®¢ ¿ ±³¹¥±²¢³¥²).
b. ´®°¬³«¨°³©²¥ § ¤ ·³ ° §°¥¸¥­¨¿, ±®®²¢¥²±²¢³¾¹³¾ § ¤ ·¥
® ° ±ª° ±ª¥ £° ´ . ®ª ¦¨²¥, ·²® ±´®°¬³«¨°®¢ ­­ ¿ ¢ ¬¨ § ¤ · 
° §°¥¸¨¬  §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿ ¢ ²®¬ ¨ ²®«¼ª® ²®¬ ±«³· ¥,
¥±«¨ § ¤ ·  ® ° ±ª° ±ª¥ £° ´  ° §°¥¸¨¬  §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿.
c.  ±±¬®²°¨¬ ¿§»ª 3-COLOR, ±®±²®¿¹¨© ¨§ £° ´®¢, ¤«¿ ª®²®°»µ ±³¹¥±²¢³¥² 3-° ±ª° ±ª . ®ª ¦¨²¥, ·²® ¥±«¨ ¿§»ª 3-COLOR
¿¢«¿¥²±¿ NP-¯®«­»¬, ²® ¨ § ¤ ·  ¯³­ª²  (b) ¿¢«¿¥²±¿ NP-¯®«­®©.
²®¡» ³±² ­®¢¨²¼ NP-¯®«­®²³ ¿§»ª  3-COLOR, ±¢¥¤¥¬ ª ­¥¬³
¿§»ª 3-CNF-SAT. ³±²¼ ¨¬¥¥²±¿ ´®°¬³«  ' ¨§ ª« ±±  3-CNF, ±®±²®¿¹ ¿ ¨§ m ¤¨§º¾­ª¶¨© ¨ ±®¤¥°¦ ¹ ¿ ¯¥°¥¬¥­­»¥ x1 ; x2; : : : ; xn .
®±²°®¨¬ ¯® ­¥© £° ´ G = (V; E ), ª®²®°»© ¬®¦­® ° ±ª° ±¨²¼ ¢
²°¨ ¶¢¥²  ¢ ²®¬ ¨ ²®«¼ª® ²®¬ ±«³· ¥, ª®£¤  ´®°¬³«  ' ¢»¯®«­¨¬ .
«¿ ª ¦¤®© ¯¥°¥¬¥­­®© xi ´®°¬³«» ' ¬» ¤®¡ ¢¨¬ ¢ £° ´ ¤¢¥
¢¥°¸¨­» (®¤­  ¡³¤¥² ®¡®§­ · ²¼±¿ xi , ¤°³£ ¿ | :xi ). °®¬¥ ²®£®,
¤«¿ ª ¦¤®© ¤¨§º¾­ª¶¨¨ ¬» ¤®¡ ¢¨¬ ¯® 5 ¢¥°¸¨­.  ª®­¥¶, ­ ¬
¯®­ ¤®¡¿²±¿ ²°¨ ±¯¥¶¨ «¼­»¥ ¢¥°¸¨­», ª®²®°»¥ ¬» ¡³¤¥¬ ³±«®¢­®
­ §»¢ ²¼ true, false ¨ red.
¥¯¥°¼ ®¯¨¸¥¬ °¥¡°  £° ´  G. ­¨ ¤¥«¿²±¿ ­  ¤¢  ²¨¯ , ª®²®°»¥
¬» ³±«®¢­® ­ §®¢¥¬ À«¨²¥° «¼­»¥Á ¨ À¤¨§º¾­ª²¨¢­»¥Á. °¨ «¨²¥° «¼­»µ °¥¡°  ±®¥¤¨­¿¾² ¬¥¦¤³ ±®¡®© ¢¥°¸¨­» true, false ¨ red
(²¥¬ ± ¬»¬ £ ° ­²¨°³¿, ·²® ª ¦¤ ¿ ¨§ ²°¥µ ¢¥°¸¨­ ¡³¤¥² ®ª° ¸¥­  ¢ ±¢®© ¶¢¥²). °®¬¥ ²®£®, ¤«¿ ª ¦¤®© ¯¥°¥¬¥­­®© xi ¨¬¥¥²±¿
²°¥³£®«¼­¨ª ¨§ «¨²¥° «¼­»µ °¥¡¥°, ¢ª«¾· ¾¹¨© ¢ ±¥¡¿ ¢¥°¸¨­»
xi , :xi ¨ red. ( ¤¨§º¾­ª²¨¢­»¬ °¥¡° ¬ ¬» ¥¹¥ ¢¥°­¥¬±¿.)
d.  ±±¬®²°¨¬ ¯°®¨§¢®«¼­³¾ 3-° ±ª° ±ª³ £° ´  G ± ®¯¨± ­­»¬¨
«¨²¥° «¼­»¬¨ °¥¡° ¬¨. ®ª ¦¨²¥, ·²® ¨§ ª ¦¤®© ¯ °» ¢¥°¸¨­ xi ,
:xi ®¤­  ¯®ª° ¸¥­  ¢ ¶¢¥² c(true), ²® ¥±²¼ ¢ ²®² ¦¥ ¶¢¥², ·²®
¢¥°¸¨­  true,   ¤°³£ ¿ | ¢ ¶¢¥² c(false). ®ª ¦¨²¥, ·²® ¥±²¼
¥±²¥±²¢¥­­®¥ ±®®²¢¥²±²¢¨¥ ¬¥¦¤³ 3-° ±ª° ±ª ¬¨ ² ª®£® £° ´  ¨
­ ¡®° ¬¨ §­ ·¥­¨© ¯¥°¥¬¥­­»µ.
±² ¥²±¿ ®¯¨± ²¼ ¤¨§º¾­ª²¨¢­»¥ °¥¡° ; ®­¨ ­³¦­», ·²®¡»
­ «®¦¨²¼ ­  3-° ±ª° ±ª³ ³±«®¢¨¿, ±®®²¢¥²±²¢³¾¹¨¥ ¨±²¨­­®±²¨

NP-¯®«­»¥ § ¤ ·¨

855

36.20
«®ª, ±®®²¢¥²±²¢³¾¹¨© ¤¨§º¾­ª¶¨¨ (x _ y _ z ) (§ ¤ ·  36-2).
¤¨§º¾­ª¶¨©, ±®±² ¢«¿¾¹¨µ ´®°¬³«³ '.   °¨±. 36.20 ¯®ª § ­»
°¥¡° , ±®®²¢¥²±²¢³¾¹¨¥ ¤¨§º¾­ª¶¨¨ (x _ y _ z ). «®ª, ±®®²¢¥²±²¢³¾¹¨© ª ¦¤®© ¤¨§º¾­ª¶¨¨, ±®±²®¨² ¨§ 3 ¢¥°¸¨­ ¤«¿ ¢µ®¤¿¹¨µ ¢
­¥¥ «¨²¥° «®¢, 5 ¢±¯®¬®£ ²¥«¼­»µ ¢¥°¸¨­ ¨ ¢¥°¸¨­» true. ¥°¥·¨±«¥­­»¥ ¢¥°¸¨­» ±®¥¤¨­¥­» °¥¡° ¬¨ ª ª ­  °¨±. 36.20.
e. ®ª ¦¨²¥, ·²® ¥±«¨ ¢ ¢ ² ª®¬ ¡«®ª¥ «¨²¥° «» (¢¥°¸¨­» x, y , z )
¨¬¥¾² ¶¢¥²  c(true) ¨«¨ c(false), ²® ª®°°¥ª²­ ¿ 3-° ±ª° ±ª  ¯¿²¨ ¢±¯®¬®£ ²¥«¼­»µ ¢¥°¸¨­ ¢®§¬®¦­  ¢ ²®¬ ¨ ²®«¼ª® ²®¬ ±«³· ¥,
ª®£¤  µ®²¿ ¡» ®¤¨­ ¨§ «¨²¥° «®¢ ¨¬¥¥² ¶¢¥² c(true).
f.  ¢¥°¸¨²¥ ¤®ª § ²¥«¼±²¢® NP-¯®«­®²» § ¤ ·¨ 3-COLOR.
 ¬¥· ­¨¿
°¥ª° ±­»¬ ¢¢¥¤¥­¨¥¬ ¢ ²¥®°¨¾ NP-¯®«­®²» ¿¢«¿¥²±¿ ª­¨£  ½°¨ ¨ ¦®­±®­  [79], ±®¤¥°¦ ¹ ¿ ¤«¨­­»© ±¯¨±®ª NP-¯®«­»µ § ¤ ·
¨§ ± ¬»µ ° §­»µ ®¡« ±²¥© (±¬. ¯¥°¥·¨±«¥­¨¥ ®¡« ±²¥© ¢ ­ · «¥ ° §¤¥«  36.5). ®¤°®¡­®¥ ®¡±³¦¤¥­¨¥ NP-¯®«­®²» ¨ ±¬¥¦­»µ ° §¤¥«®¢
²¥®°¨¨ ±«®¦­®±²¨ ¢»·¨±«¥­¨© ¬®¦­® ­ ©²¨ ¢ ª­¨£ µ ®¯ª°®´² 
¨ «¼¬ ­  [104] ¨ ¼¾¨±  ¨  ¯ ¤¨¬¨²°¨³ [139]. µ®, ®¯ª°®´² ¨
«¼¬ ­ [4] ² ª¦¥ ° ±±¬ ²°¨¢ ¾² NP-¯®«­»¥ § ¤ ·¨ ¨ ±¢®¤¨¬®±²¼
§  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿ (¢ · ±²­®±²¨, ² ¬ ° ±±¬ ²°¨¢ ¥²±¿ ±¢¥¤¥­¨¥ § ¤ ·¨ ® ¢¥°¸¨­­®¬ ¯®ª°»²¨¨ ª § ¤ ·¥ ® £ ¬¨«¼²®­®¢®¬
¶¨ª«¥)
« ±± P ¡»« ®¯°¥¤¥«¥­ ¢ 1964 £®¤³ ®¡½¬®¬ [44] ¨ ­¥§ ¢¨±¨¬® ¢ 1965 £®¤³ ¤¬®­¤±®¬ [61]. ¤¬®­¤± ®¯°¥¤¥«¨« ² ª¦¥ ª« ±±
NP ¨ ¢»±ª § « £¨¯®²¥§³ P 6= NP.  1971 £®¤³ ³ª [49] ¢¢¥« ¯®­¿²¨¥ NP-¯®«­®²» ¨ ¤®ª § «, ·²® § ¤ · ® ¢»¯®«­¨¬®±²¨ ´®°¬³«»,   ² ª¦¥ § ¤ ·  3-CNF-SAT, ¿¢«¿¾²±¿ NP-¯®«­»¬¨. ¥§ ¢¨±¨¬® ®¯°¥¤¥«¥­¨¥ NP-¯®«­®²» ¡»«® ¤ ­® ¥¢¨­»¬, ª®²®°»© ¤®ª § «
NP-¯®«­®²³ ­¥±ª®«¼ª¨µ § ¤ · [138].  °¯ ¢ 1972 £®¤³ ¯°¥¤«®¦¨«
¬¥²®¤ ±¢¥¤¥­¨¿ §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿ ¨ ¨±¯®«¼§®¢ « ¥£® ¤«¿
¤®ª § ²¥«¼±²¢  NP-¯®«­®²» ¬­®£¨µ § ¤ · [116]. ²  ±² ²¼¿  °¯ 
±®¤¥°¦¨² ¨±²®°¨·¥±ª¨ ¯¥°¢»¥ ¤®ª § ²¥«¼±²¢  NP-¯®«­®²» § ¤ ·
® ª«¨ª¥, ¢¥°¸¨­­®¬ ¯®ª°»²¨¨ ¨ £ ¬¨«¼²®­®¢®¬ ¶¨ª«¥.  ­ ±²®¿¹¥¬³ ¢°¥¬¥­¨ ¡« £®¤ °¿ ³±¨«¨¿¬ ¬­®£¨µ ³·¥­»µ ¨§¢¥±²­» ±®²­¨
NP-¯®«­»µ § ¤ ·.
°¨¢¥¤¥­­®¥ ­ ¬¨ ¤®ª § ²¥«¼±²¢® ²¥®°¥¬» 36.14 § ¨¬±²¢®¢ ­®
¨§ ª­¨£¨  ¯ ¤¨¬¨²°¨³ ¨ ² ©£«¨¶  [154].

37

°¨¡«¨¦¥­­»¥  «£®°¨²¬»

 ±²® ¢®§­¨ª¸ ¿ ­  ¯° ª²¨ª¥ NP-¯®«­ ¿ § ¤ ·  ­ ±²®«¼ª® ¢ ¦­ , ·²® ¬» ­¥ ¬®¦¥¬ ¯®§¢®«¨²¼ ±¥¡¥ ³ª«®­¨²¼±¿ ®² ­¥¥, ±®±« ¢¸¨±¼ ­  NP-¯®«­®²³. ®­¥·­®, ­ ¤¥¦¤ ¯®±²°®¨²¼ ¯®«¨­®¬¨ «¼­»©  «£®°¨²¬ ¤«¿ ² ª®© § ¤ ·¨ ¬ «®. ¤­ ª® ½²® ¥¹¥ ­¥ §­ ·¨²,
·²® ± ­¥© ¢®®¡¹¥ ­¨·¥£® ­¥ ±¤¥« ¥¸¼. ®-¯¥°¢»µ, ¬®¦¥² ®ª § ²¼±¿, ·²® ª ª®©-²® ½ª±¯®­¥­¶¨ «¼­»©  «£®°¨²¬ ° ¡®² ¥² ¯°¨¥¬«¥¬®¥ ¢°¥¬¿ ­  °¥ «¼­»µ ¤ ­­»µ. ®-¢²®°»µ, ¬®¦­® ¯»² ²¼±¿ ­ ©²¨
(§  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿ | ¢ µ³¤¸¥¬ ±«³· ¥ ¨«¨ ¢ ±°¥¤­¥¬) ­¥
®¯²¨¬ «¼­®¥ °¥¸¥­¨¥,   ­¥ª®²®°®¥ ¯°¨¡«¨¦¥­¨¥ ª ­¥¬³.   ¯° ª²¨ª¥ ² ª®¥ ¡«¨§ª®¥ ª ®¯²¨¬ «¼­®¬³ °¥¸¥­¨¥ ¬®¦¥² ¡»²¼ ¢¯®«­¥ ¤®±² ²®·­»¬. «£®°¨²¬», ¤ ¾¹¨¥ ² ª¨¥ °¥¸¥­¨¿, ­ §»¢ ¾²
¯°¨¡«¨¦¥­­»¬¨  «£®°¨²¬ ¬¨ (approximation algorithms).  ½²®©
£« ¢¥ ¬» ° §¡¥°¥¬ ¯°¨¡«¨¦¥­­»¥  «£®°¨²¬» ¤«¿ ­¥±ª®«¼ª¨µ NP¯®«­»µ § ¤ ·.
¶¥­ª¨ ª ·¥±²¢  ¯°¨¡«¨¦¥­­»µ  «£®°¨²¬®¢.
³±²¼ ¬» °¥¸ ¥¬ ®¯²¨¬¨§ ¶¨®­­³¾ § ¤ ·³, ²® ¥±²¼ ¨¹¥¬ ®¡º¥ª² ± ­ ¨¡®«¼¸¥© ¨«¨ ­ ¨¬¥­¼¸¥© ±²®¨¬®±²¼¾ ±°¥¤¨ ¬­®¦¥±²¢ 
®¡º¥ª²®¢, ­  ª®²®°»µ § ¤ ­  ´³­ª¶¨¿ ±²®¨¬®±²¨. ²®¨¬®±²¼ «¾¡®£® ®¡º¥ª²  ¯®«®¦¨²¥«¼­ . » £®¢®°¨¬, ·²® ­¥ª®²®°»©  «£®°¨²¬
°¥¸ ¥² ² ª³¾ § ¤ ·³ ± ®¸¨¡ª®© ­¥ ¡®«¥¥ ·¥¬ ¢ (n) ° § (has a ratio bound (n)), ¥±«¨ ±²®¨¬®±²¼ ­ ©¤¥­­®£® ¨¬ °¥¸¥­¨¿ (®¡®§­ ·¨¬ ¥¥ C ) ®²«¨· ¥²±¿ ®² ±²®¨¬®±²¨ ®¯²¨¬ «¼­®£® (ª®²®°³¾ ¬»
®¡®§­ ·¨¬ C ) ­¥ ¡®«¥¥ ·¥¬ ¢ (n) ° §. ®°¬ «¼­® ½²® ³±«®¢¨¥ § ¯¨±»¢ ¥²±¿ ² ª:
max(C=C ; C =C ) 6 (n):
(37:1)
²  § ¯¨±¼ £®¤¨²±¿ ¤«¿ § ¤ · ­  ¬¨­¨¬³¬ ¨ ­  ¬ ª±¨¬³¬. ±«¨
¬» ¨¹¥¬ ¬ ª±¨¬³¬, ²® 0 < C 6 C  , ¨ ¯®²®¬³ ®²­®¸¥­¨¥ C=C 
­¥ ¯°¥¢®±µ®¤¨² 1,   ®²­®¸¥­¨¥ C  =C ¯®ª §»¢ ¥², ¢® ±ª®«¼ª® ° §
®¯²¨¬ «¼­®¥ °¥¸¥­¨¥ ¡®«¼¸¥ (=«³·¸¥) ­ ¸¥£®. «¿ § ¤ · ­  ¬¨­¨¬³¬, ­ ¯°®²¨¢, 0 < C  6 C , ¨ ®²­®¸¥­¨¥ C=C  ¯®ª §»¢ ¥², ¢®
±ª®«¼ª® ° § ±²®¨¬®±²¼ ­ ¸¥£® °¥¸¥­¨¿ ¡®«¼¸¥ ±²®¨¬®±²¨ ®¯²¨¬ «¼­®£®. » ¯°¥¤¯®« £ ¥¬, ·²® ¢±¥ ±²®¨¬®±²¨ ¯®«®¦¨²¥«¼­», ¨
¯®½²®¬³ ¤°®¡¨ ¨¬¥¾² ±¬»±«.  ¬¥²¨¬, ·²® (n) ­¥ ¬®¦¥² ¡»²¼
¬¥­¼¸¥ 1, ² ª ª ª ¢§ ¨¬­® ®¡° ²­»¥ ¢¥«¨·¨­» C=C  ¨ C =C ­¥

« ¢  37 °¨¡«¨¦¥­­»¥  «£®°¨²¬»

857

¬®£³² ®¤­®¢°¥¬¥­­® ¡»²¼ ¬¥­¼¸¥ 1.
®¦­® ±ª § ²¼, ·²® ®¯²¨¬ «¼­»©  «£®°¨²¬ | ½²®  «£®°¨²¬,
ª®²®°»© °¥¸ ¥² § ¤ ·³ ± ®¸¨¡ª®© ­¥ ¡®«¥¥ ·¥¬ ¢ 1 ° §. ¥¬ ¡«¨¦¥
ª ¥¤¨­¨¶¥ ®¶¥­ª  ®¸¨¡ª¨, ²¥¬ ¡«¨¦¥  «£®°¨²¬ ª ®¯²¨¬ «¼­®¬³.
­®£¤  ³¤®¡­¥¥ ®¶¥­¨¢ ²¼ ª ·¥±²¢®  «£®°¨²¬ , ¨§¬¥°¿¿ ®²­®±¨²¥«¼­³¾ ®¸¨¡ª³ (relative error). ­  ®¯°¥¤¥«¿¥²±¿ (¤«¿ ª ¦¤®£®
¢µ®¤   «£®°¨²¬ ) ª ª ®²­®¸¥­¨¥

jC ; C j ;
C

£¤¥ (ª ª ¨ ° ­¼¸¥) C  ®¡®§­ · ¥² ±²®¨¬®±²¼ ®¯²¨¬ «¼­®£® °¥¸¥­¨¿,   C | ±²®¨¬®±²¼ °¥¸¥­¨¿, ¤ ¢ ¥¬®£®  «£®°¨²¬®¬. ²­®±¨²¥«¼­ ¿ ®¸¨¡ª  ¢±¥£¤  ­¥®²°¨¶ ²¥«¼­ . ®¢®°¿², ·²® ¯°¨¡«¨¦¥­­»©  «£®°¨²¬ ¨¬¥¥² ®²­®±¨²¥«¼­³¾ ®¸¨¡ª³ ­¥ ¡®«¥¥ "(n)
(has a relative error bound "(n)), ¥±«¨

jC ; C j 6 "(n)
(37:2)
C
¤«¿ «¾¡®£® ¢µ®¤  ¤«¨­» n. ¥£ª® ¯°®¢¥°¨²¼, ·²® ®²­®±¨²¥«¼­ ¿
®¸¨¡ª  "(n) ¬®¦¥² ¡»²¼ ®¶¥­¥­  ±¢¥°µ³ ·¥°¥§ ´³­ª¶¨¾ (n). ¬¥­­®,

"(n) 6 (n) ; 1:

(37:3)
 ± ¬®¬ ¤¥«¥, ¤«¿ § ¤ · ­  ¬¨­¨¬³¬ ½²® ­¥° ¢¥­±²¢® ¯°¥¢° ¹ ¥²±¿
¢ ° ¢¥­±²¢®. «¿ § ¤ · ­  ¬ ª±¨¬³¬ "(n) = ((n) ; 1)=(n); ·²®¡»
¯®«³·¨²¼ (37.3), ¤®±² ²®·­® ¢±¯®¬­¨²¼, ·²® (n) > 1.
«¿ ¬­®£¨µ § ¤ · ¨§¢¥±²­» ¯°¨¡«¨¦¥­­»¥  «£®°¨²¬», °¥¸ ¾¹¨¥ § ¤ ·³ ± ®¸¨¡ª®© ­¥ ¡®«¥¥ ·¥¬ ¢ ­¥ª®²®°®¥ ´¨ª±¨°®¢ ­­®¥
·¨±«® ° § (­¥§ ¢¨±¨¬® ®² ¤«¨­» ¢µ®¤ ).  ½²¨µ ±«³· ¿µ ¬» ¯¨¸¥¬
 ¨«¨ ", ­¥ ³ª §»¢ ¿  °£³¬¥­²  n.  ¤°³£¨µ ±«³· ¿µ ² ª¨¥  «£®°¨²¬» ­¥¨§¢¥±²­», ¨ ¯°¨µ®¤¨²¼±¿ ¤®¢®«¼±²¢®¢ ²¼±¿  «£®°¨²¬ ¬¨,
¢ ª®²®°»µ ®¶¥­ª  ®¸¨¡ª¨ ° ±²¥² ± °®±²®¬ n.  ¯°¨¬¥°, ² ª®¢ 
±¨²³ ¶¨¿ ¢ § ¤ ·¥ ® ¯®ª°»²¨¨ ¬­®¦¥±²¢ ¬¨, ª®²®° ¿ ° ±±¬ ²°¨¢ ¥²±¿ ¢ ° §¤¥«¥ 37.3.
«¿ ­¥ª®²®°»µ § ¤ · ¬®¦­® ³«³·¸ ²¼ ª ·¥±²¢® ¯°¨¡«¨¦¥­¨¿
(³¬¥­¼¸ ²¼ ®²­®±¨²¥«¼­³¾ ®¸¨¡ª³) ¶¥­®© ³¢¥«¨·¥­¨¿ ¢°¥¬¥­¨ ° ¡®²».  ª®¢  ±¨²³ ¶¨¿ ± § ¤ ·¥© ® ±³¬¬¥ ¯®¤¬­®¦¥±²¢  (±¬. ° §¤¥«
37.4). ²  ±¨²³ ¶¨¿ § ±«³¦¨¢ ¥² ±¯¥¶¨ «¼­®£® ®¯°¥¤¥«¥­¨¿.
µ¥¬®© ¯°¨¡«¨¦¥­¨¿ (approximation scheme) ¤«¿ ¤ ­­®© ®¯²¨¬¨§ ¶¨®­­®© § ¤ ·¨ ­ §»¢ ¥²±¿  «£®°¨²¬, ª®²®°»©, ¯®¬¨¬® ³±«®¢¨¿ § ¤ ·¨, ¯®«³· ¥² ¯®«®¦¨²¥«¼­®¥ ·¨±«® ", ¨ ¤ ¥² °¥¸¥­¨¥ ± ®²­®±¨²¥«¼­®© ®¸¨¡ª®© ­¥ ¡®«¥¥ ". µ¥¬  ¯°¨¡«¨¦¥­¨¿ ­ §»¢ ¥²±¿
¯®«¨­®¬¨ «¼­®© (polynomial-time approximation scheme), ¥±«¨ ¤«¿
«¾¡®£® ´¨ª±¨°®¢ ­­®£® " > 0 ¢°¥¬¿ ¥¥ ° ¡®²» ­¥ ¯°¥¢®±µ®¤¨² ­¥ª®²®°®£® ¯®«¨­®¬  ®² n (° §¬¥°  ¢µ®¤ ).

858

« ¢  37 °¨¡«¨¦¥­­»¥  «£®°¨²¬»

°¨ ½²®¬ ±²¥¯¥­¼ ¨ ª®½´´¨¶¥­²» ¯®«¨­®¬ , ®£° ­¨·¨¢ ¾¹¥£®
¢°¥¬¿ ° ¡®²», ¬®£³² ±ª®«¼ ³£®¤­® ¡»±²°® ° ±²¨ ± ³¬¥­¼¸¥­¨¥¬ ".
®«¥¥ ±¨«¼­®¥ ®£° ­¨·¥­¨¥ ² ª®¢®: ±µ¥¬  ¯°¨¡«¨¦¥­¨¿ ­ §»¢ ¥²±¿ ¯®«­®±²¼¾ ¯®«¨­®¬¨ «¼­®© (fully polynomial-time approximation
scheme), ¥±«¨ ¢°¥¬¿ ° ¡®²» ®¡° ­¨·¥­® ­¥ª®²®°»¬ ¯®«¨­®¬®¬ ®²
n ¨ ®² 1=", £¤¥ n | ° §¬¥° ¢µ®¤ ,   " | ®¶¥­ª  ®²­®±¨²¥«¼­®©
®¸¨¡ª¨.
 ¯°¨¬¥°, ¢°¥¬¿ ° ¡®²» ¬®¦¥² ¡»²¼ ®£° ­¨·¥­® ¢¥«¨·¨­®©
(1=")2n3 .  ½²®¬ ±«³· ¥ ³¬¥­¼¸¥­¨¥ ", ±ª ¦¥¬, ¢ 3 ° §  ¯°¨¢®¤¨²
ª ³¢¥«¨·¥­¨¾ ¢°¥¬¥­¨ ° ¡®²» ¢ 9 ° §.
« ­ £« ¢»
 ¯¥°¢»µ ²°¥µ ° §¤¥« µ ° ±±¬ ²°¨¢ ¾²±¿ ¯®«¨­®¬¨ «¼­»¥ ¯°¨¡«¨¦¥­­»¥  «£®°¨²¬» ¤«¿ ²°¥µ NP-¯®«­»µ § ¤ ·. ®±«¥¤­¨© ° §¤¥« ±®¤¥°¦¨² ¯°¨¬¥° ¯®«­®±²¼¾ ¯®«¨­®¬¨ «¼­®© ±µ¥¬» ¯°¨¡«¨¦¥­¨¿.  ° §¤¥«¥ 37.1 ¯°¨¢®¤¨²±¿ ¯®«¨­®¬¨ «¼­»© ¯°¨¡«¨¦¥­­»©
 «£®°¨²¬, °¥¸ ¾¹¨© § ¤ ·³ ® ¬¨­¨¬ «¼­®¬ ¢¥°¸¨­­®¬ ¯®ª°»²¨¨
± ®¸¨¡ª®© ­¥ ¡®«¥¥ ·¥¬ ¢ 2 ° § .  ° §¤¥«¥ 37.2 ° ±±¬ ²°¨¢ ¥²±¿ § ¤ ·  ® ª®¬¬¨¢®¿¦¥°¥. ±«¨ ° ±±²®¿­¨¿ ³¤®¢«¥²¢®°¿¾² ­¥° ¢¥­±²¢³
²°¥³£®«¼­¨ª , ²® ¨¬¥¥²±¿ ¯°¨¡«¨¦¥­­»©  «£®°¨²¬, °¥¸ ¾¹¨© ½²³
§ ¤ ·³ ± ®¸¨¡ª®© ­¥ ¡®«¥¥ ·¥¬ ¢ 2 ° § .  ®¡¹¥¬ ±«³· ¥ (ª®£¤  ­¥° ¢¥­±²¢® ²°¥³£®«¼­¨ª  ­¥ ®¡¿§ ²¥«¼­®) ² ª®£®  «£®°¨²¬  ­¥ ±³¹¥±²¢³¥² ­¨ ¤«¿ ª ª®© ´¨ª±¨°®¢ ­­®© ®¶¥­ª¨ ®¸¨¡ª¨ (¥±«¨ ²®«¼ª®
P ­¥ ° ¢­® NP).  ° §¤¥«¥ 37.3 ±²°®¨²±¿ ¦ ¤­»© ¯°¨¡«¨¦¥­­»©
 «£®°¨²¬ ¤«¿ § ¤ ·¨ ® ¯®ª°»²¨¨ ¬­®¦¥±²¢ ¬¨.  ¢ ¥¬®¥ ¨¬ °¥¸¥­¨¥ ®²«¨· ¥²±¿ ®² ®¯²¨¬ «¼­®£® ­¥ ¡®«¥¥ ·¥¬ «®£ °¨´¬¨·¥±ª¨¬
(®² ·¨±«  ½«¥¬¥­²®¢) ¬­®¦¨²¥«¥¬.  ª®­¥¶, ¢ ° §¤¥«¥ 37.4 ¬» ¯°¨¢®¤¨¬ ¯®«­®±²¼¾ ¯®«¨­®¬¨ «¼­³¾ ±µ¥¬³ ¯°¨¡«¨¦¥­¨¿ ¤«¿ § ¤ ·¨
® ±³¬¬¥ ¯®¤¬­®¦¥±²¢ .

37.1.  ¤ ·  ® ¢¥°¸¨­­®¬ ¯®ª°»²¨¨
²  § ¤ ·  ®¯¨± ­  ¢ ° §¤¥«¥ 36.5.2.  ¬ ¦¥ ¤®ª § ­  ¥¥ NP¯®«­®² .  ¯®¬­¨¬, ·²® ¢¥°¸¨­­»¬ ¯®ª°»²¨¥¬ (vertex cover) ­¥®°¨¥­²¨°®¢ ­­®£® £° ¿  G = (V; E ) ¬» ­ §»¢ ¥¬ ­¥ª®²®°®¥ ±¥¬¥©±²¢® ¥£® ¢¥°¸¨­ V 0  V ± ² ª¨¬ ±¢®©±²¢®¬: ¤«¿ ¢±¿ª®£® °¥¡°  (u; v )
£° ´  G µ®²¿ ¡» ®¤¨­ ¨§ ª®­¶®¢ u; v ½²®£® °¥¡°  ±®¤¥°¦¨²±¿ ¢ V 0 .
 §¬¥°®¬ ¢¥°¸¨­­®£® ¯®ª°»²¨¿ ±·¨² ¥¬ ª®«¨·¥±²¢® ¢µ®¤¿¹¨µ ¢
­¥£® ¢¥°¸¨­.
 ¤ ·  ® ¢¥°¸¨­­®¬ ¯®ª°»²¨¨ (vertex-cover problem) ±®±²®¨² ¢
­ µ®¦¤¥­¨¨ ®¯²¨¬ «¼­®£® ¢¥°¸¨­­®£® ¯®ª°»²¨¿ (optimal vertex
cover), ²® ¥±²¼ ¢¥°¸¨­­®£® ¯®ª°»²¨¿ ¬¨­¨¬ «¼­®£® ° §¬¥° . ² 
¯°®¡«¥¬  ¿¢«¿¥²±¿ NP-²°³¤­®©, ¯®±ª®«¼ª³ ±®®²¢¥²±²¢³¾¹ ¿ ¯°®¡«¥¬  ° §°¥¸¥­¨¿ ¿¢«¿¥²±¿ NP-¯®«­®© (¯® ²¥®°¥¬¥ 36.12).
¥±¬®²°¿ ­  ½²® ­¥±«®¦­® ­ ©²¨ ¢¥°¸¨­­®¥ ¯®ª°»²¨¥, ª®²®°®¥

 ¤ ·  ® ¢¥°¸¨­­®¬ ¯®ª°»²¨¨

859

37.1  ¡®²   «£®°¨²¬  Approx-Vertex-Cover (a) ±µ®¤­»© £° ´ G
± 7 ¢¥°¸¨­ ¬¨ ¨ 8 °¥¡° ¬¨. (b)   ¯¥°¢®¬ ¸ £¥ ¢»¡° ­® °¥¡°® (b; c) (¦¨°­®¥).
£® ª®­¶» b ¨ c (±¥°»¥) ¢ª«¾· ¾²±¿ ¢ ¢¥°¸¨­­®¥ ¯®ª°»²¨¥ C . ³­ª²¨°­»¥
°¥¡°  (a; b), (c;e) ¨ (c; d) ¯®ª°»²» ¨ ³¤ «¿¾²±¿. (c) ¥¡°® (e; f ) ¤®¡ ¢«¿¥²±¿ ª C .
(d) ¥¡°® (d; g) ¤®¡ ¢«¿¥²±¿ ª C . (e) ¥§³«¼² ² ° ¡®²»  «£®°¨²¬ , ¬­®¦¥±²¢®
C , ±®¤¥°¦¨² 6 ¢¥°¸¨­ b; c; d; e; f; g. (f) ¯²¨¬ «¼­®¥ ¢¥°¸¨­­®¥ ¯®ª°»²¨¥ ½²®£®
£° ´  ±®¤¥°¦¨² ²®«¼ª® ²°¨ ¢¥°¸¨­» (b; d; e).
¨±. 37.1

µ³¦¥ ®¯²¨¬ «¼­®£® ­¥ ¡®«¥¥ ·¥¬ ¢ 2 ° § . ²® ¤¥« ¥²  «£®°¨²¬
Approx-Vertex-Cover:
4 ¢®§¼¬¥¬ ¯°®¨§¢®«¼­®¥ °¥¡°® (u; v ) ¨§ E 0
6 ³¤ «¨¬ ¨§ E 0 ¢±¥ °¥¡° , ¨­¶¨¤¥­²­»¥ u ¨«¨ v
  °¨±³­ª¥ 37.1 ¯°¨¢¥¤¾­ ¯°¨¬¥° ° ¡®²»  «£®°¨²¬  ApproxVertex-Cover. «£®°¨²¬ ±²°®¨² ¢¥°¸¨­­®¥ ¯®ª°»²¨¥ C ¯®±²¥¯¥­­®. ­ · «¥ C ¯³±²®¢ (±²°®ª  1),   ¬­®¦¥±²¢® E 0 ±®¤¥°¦¨² ¢±¥
°¥¡°  £° ´  (±²°®ª  2).  ²¥¬ ¢ ¶¨ª«¥ (±²°®ª¨ 3{6) ¬» ¡¥°¥¬ °¥¡°®
¨§ E 0, ¤®¡ ¢«¿¥¬ ¥£® ª®­¶» u ¨ v ¢ C ,   ¨§ E 0 ¨§»¬ ¥¬ ¢±¥ °¥¡° ,
¨¬¥¾¹¨¥ ±¢®¨¬ ª®­¶®¬ u ¨«¨ v . °¥¬¿ ° ¡®²» ½²®£®  «£®°¨²¬ 
¥±²¼ O(E ) (¯°¨ ±®®²¢¥²±²¢³¾¹¥¬ ¯°¥¤±² ¢«¥­¨¨ ¬­®¦¥±²¢  E 0).
¥®°¥¬  37.1. «£®°¨²¬ Approx-Vertex-Cover ° ¡®² ¥² ±
®¸¨¡ª®© ­¥ ¡®«¥¥ ·¥¬ ¢ 2 ° § .
®ª § ²¥«¼±²¢®. °¥¦¤¥ ¢±¥£® § ¬¥²¨¬, ·²® ¤ ¢ ¥¬®¥ ¨¬ ¬­®¥¦±²¢® C ¿¢«¿¥²±¿ ¢¥°¸¨­­»¬ ¯®ª°»²¨¥¬.  ± ¬®¬ ¤¥«¥, ¶¨ª« ¢
±²°®ª µ 3{6 ¯°®¤®«¦ ¥²±¿ ¤® ²¥µ ¯®°, ¯®ª  ¬­®¦¥±²¢® ­¥¯®ª°»²»µ
°¥¡¥° E 0 ­¥ ±² ­¥² ¯³±²»¬.
²®¡» ³¡¥¤¨²¼±¿, ·²® ·¨±«® ¢¥°¸¨­ ¢ C ­¥ ¡®«¥¥ ·¥¬ ¢¤¢®¥ µ³¦¥ ®¯²¨¬ «¼­®, ¯®±¬®²°¨¬ ­  ¬­®¦¥±²¢® A °¥¡¥°, ¢»¡¨° ¥¬»µ ¢
µ®¤¥ ° ¡®²»  «£®°¨²¬ . ¨ª ª¨¥ ¤¢  ¨§ ­¨µ ­¥ ¨¬¥¾² ®¡¹¥© ¢¥°¸¨­» (¯®±«¥ ²®£®, ª ª °¥¡°® ¢»¡° ­® ¢ ±²°®ª¥ 4, ¢±¥ ¨¬¥¾¹¨¥ ±
­¨¬ ®¡¹³¾ ¢¥°¸¨­³ ³¤ «¿¾²±¿ ¢ ±²°®ª¥ 6). ®½²®¬³ ®¡¹¥¥ ·¨±«®
¢¥°¸¨­ ¢ C ¢¤¢®¥ ¡®«¼¸¥ ·¨±«  °¥¡¥° ¢ A.  ¬¥²¨¬ ²¥¯¥°¼, ·²®
«¾¡®¥ ¢¥°¸¨­­®¥ ¯®ª°»²¨¥ (¢ · ±²­®±²¨, ®¯²¨¬ «¼­®¥ ¯®ª°»²¨¥
C ) ±®¤¥°¦¨² µ®²¿ ¡» ®¤­³ ¢¥°¸¨­³ ª ¦¤®£® ¢»¡° ­­®£® °¥¡° , ¨
¤«¿ ° §­»µ °¥¡¥° ½²¨ ¢¥°¸¨­» ° §­»¥.  ª¨¬ ®¡° §®¬, jAj 6 jC  j,
¨, ±«¥¤®¢ ²¥«¼­®, jC j = 2jAj 6 2jC j. ²® ¨ ²°¥¡®¢ «®±¼ ¤®ª § ²¼.
¯° ¦­¥­¨¿.
37.1-1. °¨¢¥¤¨²¥ ¯°¨¬¥° £° ´ , ¤«¿ ª®²®°®£® ½²®²  «£®°¨²¬
¢±¥£¤  ¤ ¥² ­¥®¯²¨¬ «¼­®¥ °¥¸¥­¨¥.
37.1-2. °®´¥±±®° ¨¯¨«®¢ ¯°¥¤« £ ¥² ² ª®©  «£®°¨²¬ °¥¸¥­¨¿
§ ¤ ·¨ ® ¢¥°¸¨­­®¬ ¯®ª°»²¨¨: ¢§¿²¼ ¢¥°¸¨­³ ­ ¨¡®«¼¸¥© ±²¥¯¥­¨, ¢ª«¾·¨²¼ ¥¥ ¢ ¯®ª°»²¨¥, ³¤ «¨²¼ ¢±¥ ±¬¥¦­»¥ °¥¡° , ¯®¢²®°¨²¼ ½²® ¥¹¥ ° § ¨ ² ª ¤ «¥¥. °¨¢¥¤¨²¥ ¯°¨¬¥° £° ´ , ¤«¿ ª®²®°®£® ½²®² ±¯®±®¡ ¤ ¥² °¥¸¥­¨¥, ®²«¨· ¾¹¥¥±¿ ®² ®¯²¨¬ «¼­®£®
¡®«¥¥ ·¥¬ ¢ 2 ° § .
37.1-3. ®±²°®©²¥ ¦ ¤­»©  «£®°¨²¬, ª®²®°»© ­ µ®¤¨² ®¯²¨¬ «¼­®¥ ¢¥°¸¨­­®¥ ¯®ª°»²¨¥ ¤«¿ £° ´ , ¿¢«¿¾¹¥£®±¿ ¤¥°¥¢®¬, § 

860

« ¢  37 °¨¡«¨¦¥­­»¥  «£®°¨²¬»

«¨­¥©­®¥ ¢°¥¬¿.
37.1-4.  ª ¬» ¢¨¤¥«¨ ¢ ¤®ª § ²¥«¼±²¢¥ ²¥®°¥¬» 6.12, § ¤ ·  ®
¢¥°¸¨­­®¬ ¯®ª°»²¨¨ ¨ § ¤ ·  ® ª«¨ª¥ ¢§ ¨¬­® ¤®¯®«­¨²¥«¼­»:
¬¨­¨¬ «¼­®¥ ¢¥°¸¨­­®¥ ¯®ª°»²¨¥ ¿¢«¿¥²±¿ ¤®¯®«­¥­¨¥¬ ª ¬ ª±¨¬ «¼­®© ª«¨ª¥ ¢ ¤®¯®«­¨²¥«¼­®¬ £° ´¥. ®¦­® «¨ ®²±¾¤  § ª«¾·¨²¼, ·²® ¨ ¤«¿ § ¤ ·¨ ® ª«¨ª¥ ¨¬¥¥²±¿ ¯°¨¡«¨¦¥­­»©  «£®°¨²¬ ± ®¸¨¡ª®© ­¥ ¡®«¥¥ ·¥¬ ¢ ª®­±² ­²³ ° §? ®·¥¬³?

37.2.  ¤ ·  ª®¬¬¨¢®¿¦¥° 
²  § ¤ ·  ®¯¨± ­  ¢ ° §¤¥«¥ 36.5.5 ¨ ±®±²®¨² ¢ ±«¥¤³¾¹¥¬.
«¿ ª ¦¤®£® °¥¡°  (u; v ) ¯®«­®£® ­¥®°¨¥­²¨°®¢ ­­®£® £° ´  G =
(V; E ) ¨§¢¥±²­  ¥£® ±²®¨¬®±²¼ c(u; v ). ¥®¡µ®¤¨¬® ­ ©²¨ £ ¬¨«¼²®­®¢ ¶¨ª« ¬¨­¨¬ «¼­®© ±²®¨¬®±²¨. ²®¨¬®±²¼¾ ¶¨ª«  (¨ ¢®®¡¹¥
«¾¡®£® ¬­®¦¥±²¢  °¥¡¥° A  E ) ¬» ±·¨² ¥¬ ±³¬¬³ ±²®¨¬®±²¥©
¥£® °¥¡¥°:
X
c(A) =
c(u; v ):
(u;v)2A

  ¯° ª²¨ª¥ ´³­ª¶¨¿ ±²®¨¬®±²¨ °¥¡¥° ®¡»·­® ³¤®¢«¥²¢®°¿¥²
­¥° ¢¥­±²¢³ ²°¥³£®«¼­¨ª , ª®²®°®¥ £®¢®°¨², ·²® ¯°®¬¥¦³²®·­ ¿
®±² ­®¢ª  w ­  ¯³²¨ ¨§ u ¢ v ³¢¥«¨·¨¢ ¥² ¥£® ±²®¨¬®±²¼:
c(u; w) 6 c(u; v) + c(v; w)
¤«¿ «¾¡»µ ²°¥µ ¢¥°¸¨­ u; v; w.  ¯°¨¬¥°, ½²® ­¥° ¢¥­±²¢® ¢»¯®«­¥­®, ¥±«¨ ¢¥°¸¨­ ¬¨ £° ´  ¿¢«¿¾²±¿ ²®·ª¨ ¯«®±ª®±²¨ ¨ ±²®¨¬®±²¼¾ °¥¡°  ±·¨² ¥²±¿ ¥£® ¤«¨­  (° ±±²®¿­¨¥ ¬¥¦¤³ ¥£® ª®­¶ ¬¨).
 ª ¯®ª §»¢ ¥² ³¯° ¦­¥­¨¥ 37.2-1, ¤ ¦¥ ¢ ¯°¥¤¯®«®¦¥­¨¨ ­¥° ¢¥­±²¢  ²°¥³£®«¼­¨ª  § ¤ ·  ª®¬¬¨¢®¿¦¥°  ®±² ¥²±¿ NP-¯®«­®©.
¥¬ ± ¬»¬ ¬ «® ¸ ­±®¢ ­ ©²¨ ¯®«¨­®¬¨ «¼­»©  «£®°¨²¬, ¤ ¾¹¨©
®¯²¨¬ «¼­»© ¯³²¼, ¨ ¨¬¥¥² ±¬»±« ¨±ª ²¼ ¯°¨¡«¨¦¥­­»¥  «£®°¨²¬».
 ° §¤¥«¥ 37.2.1 ¬» ° ±±¬®²°¨¬ ¯°¨¡«¨¦¥­­»©  «£®°¨²¬, °¥¸ ¾¹¨© ½²³ § ¤ ·³ (¢ ¯°¥¤¯®«®¦¥­¨¨ ­¥° ¢¥­±²¢  ²°¥³£®«¼­¨ª ) ±
®¸¨¡ª®© ­¥ ¡®«¥¥ ·¥¬ ¢ 2 ° § . ¥° ¢¥­±²¢® ²°¥³£®«¼­¨ª  ±³¹¥±²¢¥­­®: ¢ ®¡¹¥¬ ±«³· ¥  «£®°¨²¬ , °¥¸ ¾¹¥£® ¥¥ ± ®¸¨¡ª®© ­¥
¡®«¥¥ ·¥¬ ¢ C ° §, ­¥ ±³¹¥±²¢³¥² ­¨ ¤«¿ ª ª®£® ´¨ª±¨°®¢ ­­®£® C
(¥±«¨ ²®«¼ª® P ­¥ ° ¢­® NP).
37.2.1.  ¤ ·  ª®¬¬¨¢®¿¦¥°  (± ­¥° ¢¥­±²¢®¬ ²°¥³£®«¼­¨ª )
» ¬®¦¥¬ ¢®±¯®«¼§®¢ ²¼±¿  «£®°¨²¬®¬ MST-Prim ®²»±ª ­¨¿
¬¨­¨¬ «¼­®£® ¯®ª°»¢ ¾¹¥£® ¤¥°¥¢  ¨§ ° §¤¥«  24.2, ¯¥°¥¤¥« ¢ ¥£®
¢ ¶¨ª«. ±«¨ ¢»¯®«­¥­® ­¥° ¢¥­±²¢® ²°¥³£®«¼­¨ª , ²® ½²®² ¶¨ª«
­¥ ¡®«¥¥ ·¥¬ ¢¤¢®¥ ¤«¨­­¥¥ ®¯²¨¬ «¼­®£®.

 ¤ ·  ª®¬¬¨¢®¿¦¥° 

861

¨±. 37.2  ¡®²   «£®°¨²¬  Approx-MST-Tour. (a) ±µ®¤­»¥ ²®·ª¨ «¥¦ ² ¢ ¢¥°¸¨­ µ ¶¥«®·¨±«¥­­®© °¥¸¥²ª¨. ( ¯°¨¬¥°, ¢¥°¸¨­  f ­  1 ¯° ¢¥¥ ¨ ­  2 ¢»¸¥ ¢¥°¸¨­» h.) ²®¨¬®±²¼ °¥¡°  ®¯°¥¤¥«¿¥²±¿ ª ª (¥¢ª«¨¤®¢®) ° ±±²®¿­¨¥ ¬¥¦¤³ ²®·ª ¬¨. (b) ¨­¨¬ «¼­®¥ ¯®ª°»¢ ¾¹¥¥ ¤¥°¥¢® T ,
¯®±²°®¥­­®¥  «£®°¨²¬®¬ MST-Prim. ¥°¸¨­  a ¿¢«¿¥²±¿ ¥£® ª®°­¥¬. («´ ¢¨²­»© ¯®°¿¤®ª ­ §¢ ­¨© ¢¥°¸¨­ ±®®²¢¥²±²¢³¥² ¯®°¿¤ª³ ¨µ ¤®¡ ¢«¥­¨¿
¢ µ®¤¥ ° ¡®²»  «£®°¨²¬  MST-Prim.) (c) ¡µ®¤ ¤¥°¥¢  T ­ ·¨­ ¥²±¿ ± ¥£®
ª®°­¿ a. ²¬¥· ¿ ¢¥°¸¨­» ­  ¯³²¨ ²³¤  ¨ ®¡° ²­®, ¬» ¯®«³·¨¬ ¯®±«¥¤®¢ ²¥«¼­®±²¼ a; b; c; b; h; b; a; d; e; f; e; g; e; d; a. «£®°¨²¬ ®¡µ®¤  ¤¥°¥¢  ¢ ¯®°¿¤ª¥ À¢¥°¸¨­ {¯®²®¬ª¨Á ¯°®¯³±ª ¥² ¢¥°¸¨­» ­  ®¡° ²­®¬ ¯³²¨, ¨ ®±² ¥²±¿
a; b; c; h; d; e; f;g. (d) ®®²¢¥²±²¢³¾¹¨© ¶¨ª« H ¿¢«¿¥²±¿ °¥§³«¼² ²®¬ ° ¡®²»
 «£®°¨²¬  Approx-MST-TOUR. £® ±²®¨¬®±²¼ ¯°¨¬¥°­® ° ¢­  19;074. (e)
¯²¨¬ «¼­»© ¶¨ª« ±²®¨¬®±²¨  14;715.

Approx-TSP-TOUR

1 ±·¨² ¥¬ ¯°®¨§¢®«¼­³¾ ¢¥°¸¨­³ r 2 V [G] Àª®°­¥¬Á
2 ¯®±²°®¨¬ ¬¨­¨¬ «¼­®¥ ¯®ª°»¢ ¾¹¥¥ ¤¥°¥¢® T ¤«¿ £° ´  G (±
ª®°­¥¬ ¢ r) ± ¯®¬®¹¼¾  «£®°¨²¬  MST-Prim(G; c; r)
3 ¯³±²¼ L | ¯¥°¥·¥­¼ ¢¥°¸¨­ ½²®£® ¤¥°¥¢  ¢ ¯®°¿¤ª¥ ®¡µ®¤ 
À¢¥°¸¨­ {¯®²®¬ª¨Á
4 return £ ¬¨«¼²®­®¢ ¶¨ª«, ®¡µ®¤¿¹¨© ¢¥°¸¨­» ¢ ¯®°¿¤ª¥ L
¡µ®¤ ¢¥°¸¨­ ¤¥°¥¢  ®¯¨± ­ ¢ ° §¤¥«¥ 13.1: °¥ª³°±¨¢­»©  «£®°¨²¬ ®¡µ®¤  ¯®¤¤¥°¥¢  ± ª®°­¥¬ ¢ v ¯®±¥¹ ¥² ¢¥°¸¨­³ v ,   § ²¥¬
®¡µ®¤¨² ¯®¤¤¥°¥¢¼¿, ª®°­¿¬¨ ª®²®°»µ ¿¢«¿¾²±¿ ¤¥²¨ ¢¥°¸¨­» v .
  °¨±³­ª¥ 37.2 ¯®ª § ­  ° ¡®²   «£®°¨²¬ . «¿ ¤ ­­®© ±¨±²¥¬» ²®·¥ª ­  ¯«®±ª®±²¨ (a) ±²°®¨²±¿ ¬¨­¨¬ «¼­®¥ ®±²®¢­®¥ ¤¥°¥¢®
T ; ¢¥°¸¨­  a | ¥£® ª®°¥­¼ (b). ¯°¥¤¥«¿¥¬»© ¨¬ ¯®°¿¤®ª ®¡µ®¤ 
¢¥°¸¨­ (c) ¤ ¥² £ ¬¨«¼²®­®¢ ¶¨ª« (d), ª®²®°»© ¿¢«¿¥²±¿ °¥§³«¼² ²®¬ ° ¡®²»  «£®°¨²¬  Approx-MST-Tour. ­ ¯°¨¬¥°­® ­  23%
¤«¨­­¥¥ ®¯²¨¬ «¼­®£® ¶¨ª«  (e).
°¥¬¿ ° ¡®²»  «£®°¨²¬  Approx-MST-Tour ° ¢­® (E ) =
(V 2) ¯®±ª®«¼ª³  «£®°¨²¬ MST-Prim ¯°¨¬¥­¿¥²±¿ ª ¯®«­®¬³ £° ´³. (¬. ³¯° ¦­¥­¨¥ 24.2-2.) ±² «®±¼ ¯°®¢¥°¨²¼, ·²® ­ ©¤¥­­»©
¶¨ª« ­¥ ¡®«¥¥ ·¥¬ ¢¤¢®¥ ¤«¨­­¥¥ ®¯²¨¬ «¼­®£®. (°¨ ½²®¬ ¬» ¨±¯®«¼§³¥¬ ­¥° ¢¥­±²¢® ²°¥³£®«¼­¨ª .)
¥®°¥¬  37.2
«£®°¨²¬ Approx-MST-Tour °¥¸ ¥² § ¤ ·³ ® ª®¬¬¨¢®¿¦¥°¥
± ®¸¨¡ª®© ­¥ ¡®«¥¥ ·¥¬ ¢ 2 ° § , ¥±«¨ ¢»¯®«­¥­® ­¥° ¢¥­±²¢® ²°¥³£®«¼­¨ª .
®ª § ²¥«¼±²¢®. ³±²¼ H  | £ ¬¨«¼²®­®¢ ¶¨ª« ­ ¨¬¥­¼¸¥© ±²®¨¬®±²¨.  ¬ ­ ¤® ¤®ª § ²¼, ·²® c(H ) 6 2c(H ) ¤«¿ ¶¨ª«  H , ­ ©¤¥­­®£® ± ¯®¬®¹¼¾ ­ ¸¥£®  «£®°¨²¬ . ¤ «¿¿ «¾¡®¥ °¥¡°® ¨§ ¶¨ª«  H , ¬» ¯®«³· ¥¬ ¯®ª°»¢ ¾¹¥¥ ¤¥°¥¢®. £® ±²®¨¬®±²¼ ­¥ ¯°¥¢®±µ®¤¨² c(H ). ¥¬ ¡®«¥¥ ½²® ¢¥°­® ¤«¿ ®¯²¨¬ «¼­®£® ¯®ª°»¢ ¾¹¥£® ¤¥°¥¢  T :
c(T ) 6 c(H )
(37:4)
³±²¼ ¬» ®¡µ®¤¨¬ ¢¥°¸¨­» ¤¥°¥¢  T , ¯®±¥¹ ¿ ª ¦¤³¾ ¢¥°¸¨-

862

« ¢  37 °¨¡«¨¦¥­­»¥  «£®°¨²¬»

­³ ¤¢ ¦¤» | ¤® ¯®±¥¹¥­¨¿ ¥¥ ¯®²®¬ª®¢ ¨ ¯®±«¥. «¿ ¤¥°¥¢  ­ 
°¨±. 37.2 ½²®² ¯®«­»© ®¡µ®¤ W ¢ª«¾· ¥² ¢ ±¥¡¿ ¢¥°¸¨­»

a; b; c; b; h; b; a; d; e; f; e; g; e; d; a
°¨ ½²®¬ ª ¦¤®¥ °¥¡°® ¤¥°¥¢  ¯°®µ®¤¨²±¿ ¤¢ ¦¤», ¯®½²®¬³ ±³¬¬ °­ ¿ ±²®¨¬®±²¼ ¢±¥µ °¥¡¥° c(W ) ¡³¤¥² ¢¤¢®¥ ¡®«¼¸¥ c(T )

c(W ) = 2c(T ):

(37:5)

§ ­¥° ¢¥­±²¢ (37.4) ¨ (37.5) ±«¥¤³¥², ·²®

c(W ) = 2c(H ):

(37:5)
²¥¬ ± ¬»¬ ±²®¨¬®±²¼ ®¡µ®¤  ¢¥°¸¨­ ¢ ¯®°¿¤ª¥ W ­¥ ¡®«¥¥ ·¥¬
¢¤¢®¥ ¯°¥¢®±µ®¤¨² ®¯²¨¬ «¼­³¾.
¤­ ª® ½²® ¥¹¥ ­¥ ¢±¥: W ­¥ ¿¢«¿¥²±¿ ¶¨ª«®¬, ² ª ª ª ¬» ¡»¢ ¥¬
¤¢ ¦¤» ¢ ®¤­®© ¨ ²®© ¦¥ ¢¥°¸¨­¥. ¨·¥£® ±²° ¸­®£® | ¬» ¬®¦¥¬ ³¤ «¨²¼ «¨¸­¨¥ ¢¥°¸¨­», ¯°¨ ½²®¬ ±²®¨¬®±²¼ ¬®¦¥² ²®«¼ª®
³¬¥­¼¸¨²¼±¿. ±«¨ ¢ ¯³²¨ : : : ! u ! w ! : : : ¬» ³¤ «¿¥¬ ¢¥°¸¨­³
v, ®±² ¥²±¿ °¥¡°® (u; w), ¤«¨­  ª®²®°®£® ¯® ­¥° ¢¥­±²¢³ ²°¥³£®«¼­¨ª  ­¥ ¡®«¼¸¥ ±³¬¬» ¤«¨­ ³¤ «¥­­»µ °¥¡¥° (u; v ) ¨ (v; w). ®£¤ 
¬» ³¤ «¨¬ ¨§ ¯³²¨ W ¯®¢²®°­® ¯°®µ®¤¨¬»¥ ¢¥°¸¨­» (®±² ¢¨¢
²®«¼ª® ¯¥°¢®¥ ¢µ®¦¤¥­¨¥ ª ¦¤®©), ¯®«³·¨²±¿ ¶¨ª«

a; b; c; h; d; e; f; g:
ª®²®°»© ª ª ° § ¨ ±®®²¢¥²±²¢³¥² ®¡µ®¤³ ¤¥°¥¢  ¢ ¯®°¿¤ª¥
À¢¥°¸¨­ {¯®²®¬ª¨Á. ²®² ¶¨ª« H ¨ ¡³¤¥² °¥§³«¼² ²®¬ ° ¡®²»
 «£®°¨²¬  Approx-TSP-Tour. °¨ ½²®¬

c(H ) 6 c(W );

(37:7)

² ª ª ª H ¯®«³·¥­ ¨§ W ³¤ «¥­¨¥¬ ¢¥°¸¨­. ²® ­¥° ¢¥­±²¢® ¢¬¥±²¥ ± (37.6) § ¢¥°¸ ¥² ¤®ª § ²¥«¼±²¢® ²¥®°¥¬».
®²¿  «£®°¨²¬ Approx-TSP-Tour ¨ £ ° ­²¨°³¥² ®¸¨¡ª³ ­¥
¡®«¥¥ ·¥¬ ¢ 2 ° § , ¤«¿ ¯° ª²¨·¥±ª¨µ ¶¥«¥© ®­, ª ª ¯° ¢¨«®, ­¥¤®±² ²®·­® µ®°®¸, ¨ ¯°¨¬¥­¿¾²±¿ ¤°³£¨¥  «£®°¨²¬». (®®²¢¥²±²¢³¾¹¨¥ ±±»«ª¨ ¤ ­» ¢ ª®­¶¥ £« ¢».)
37.2.2. ¡¹ ¿ § ¤ ·  ª®¬¬¨¢®¿¦¥° 
±«¨ ­¥° ¢¥­±²¢  ²°¥³£®«¼­¨ª  ­¥², ²® µ®°®¸¨¥ ¯°¨¡«¨¦¥­¨¿ ª
®¯²¨¬ «¼­®¬³ ¶¨ª«³ ­ ©²¨ §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿ ­¥ ³¤ ¥²±¿
(¥±«¨ ²®«¼ª® P ­¥ ° ¢­® NP).
¥®°¥¬  37.3. ³±²¼ P 6= NP ¨  > 1. ®£¤  ­¥ ±³¹¥±²¢³¥² ¯®«¨­®¬¨ «¼­®£® ¯°¨¡«¨¦¥­­®£®  «£®°¨²¬ , °¥¸ ¾¹¥£® ®¡¹³¾ § ¤ ·³
® ª®¬¬¨¢®¿¦¥°¥ ± ®¸¨¡ª®© ­¥ ¡®«¥¥ ·¥¬ ¢  ° §.

 ¤ ·  ª®¬¬¨¢®¿¦¥° 

863

®ª § ²¥«¼±²¢®. ³±²¼ ² ª®©  «£®°¨²¬ (­ §®¢¥¬ ¥£® A) ±³¹¥±²¢³¥² ¤«¿ ­¥ª®²®°®£®  > 1 (­¥ ®£° ­¨·¨¢ ¿ ®¡¹­®±²¨, ¬®¦­®
±·¨² ²¼  ¶¥«»¬). » ¯®ª ¦¥¬, ª ª ¨±¯®«¼§®¢ ²¼ A ¤«¿ °¥¸¥­¨¿
§ ¤ ·¨ ® £ ¬¨«¼²®­®¢®¬ ¶¨ª«¥, ®¯°¥¤¥«¥­­®© ¢ ° §¤¥«¥ 36.5.5.  ª
ª ª ½²  § ¤ ·  NP-¯®«­  (²¥®°¥¬  36.14), ±³¹¥±²¢®¢ ­¨¥ °¥¸ ¾¹¥£® ¥¥ ¯®«¨­®¬¨ «¼­®£®  «£®°¨²¬  ¢«¥·¥² P = NP (²¥®°¥¬  36.4).
² ª, ¯³±²¼ ¤ ­ £° ´ G = (V; E ), ¨ ¬» µ®²¨¬ ³§­ ²¼, ¥±²¼ «¨ ¢
­¥¬ £ ¬¨«¼²®­®¢ ¶¨ª«, ¨±¯®«¼§³¿  «£®°¨²¬ A. «¿ ½²®£® ° ±±¬®²°¨¬ ¯®«­»© £° ´ G0 = (V; E 0) ± ¬­®¦¥±²¢®¬ ¢¥°¸¨­ V :
E 0 = f(u; v ) : u; vinV ¨ u 6= v g
  ¥£® °¥¡° µ ®¯°¥¤¥«¨¬ ´³­ª¶¨¾ ±²®¨¬®±²¨ ±«¥³¤¾¹¨¬ ®¡° §®¬:

1; ¥±«¨ (u; v ) 2 E;
c(u; v ) = jV j + 1 ¢ ¯°®²¨¢­®¬ ±«³· ¥.
¥£ª® ¯®­¿²¼, ·²® ¢°¥¬¿ ¯®±²°®¥­¨¥ G0 ¨ c ­¥ ¯°¥¢®±µ®¤¨² ¯®«¨­®¬  ®² jV j ¨ jE j.
¥¯¥°¼ ¯®±¬®²°¨¬ ­  § ¤ ·³ ª®¬¬¨¢®¿¦¥°  ¤«¿ £° ´  G0 ± ´³­ª¶¨¥© ±²®¨¬®±²¨ c. ±«¨ ¨±µ®¤­»© £° ´ G ¨¬¥« £ ¬¨«¼²®­®¢ ¶¨ª«,
²® ½²®² ¶¨ª« ¿¢«¿¥²±¿ °¥¸¥­¨¥¬ § ¤ ·¨ ® ª®¬¬¨¢®¿¦¥°¥ ±® ±²®¨¬®±²¼¾ jV j, ¯®±ª®«¼ª³ ±®¤¥°¦¨² jV j °¥¡¥° ¥¤¨­¨·­®© ±²®¨¬®±²¨.
±«¨ ¦¥ £ ¬¨«¼²®­®¢  ¶¨ª«  ­¥ ¡»«®, ²® «¾¡®¥ °¥¸¥­¨¥ § ¤ ·¨
® ª®¬¬¨¢®¿¦¥°¥ ¯°®µ®¤¨² ¯® ®¤­®¬³ ¨§ ­®¢»µ (­¥ ¢µ®¤¿¹¨µ ¢ E )
°¥¡¥°. ®¢»¥ °¥¡°  ¤®°®£¨.  ¦¥ ¥±«¨ ­®¢®¥ °¥¡°® ²®«¼ª® ®¤­®, ²®
®¡¹ ¿ ±²®¨¬®±²¼ (®¤­® ­®¢®¥ ¨ jV j ; 1 ±² °»µ) ¡³¤¥²
(jV j + 1) + (jV j ; 1) > jV j;
¥±«¨ ­®¢»µ °¥¡¥° ­¥±ª®«¼ª®, ®­  ¡³¤¥² ¥¹¥ ¡®«¼¸¥. ¥¬ ± ¬»¬ ¨¬¥¥²±¿ ¡®«¼¸®© | ¡®«¼¸¥ ·¥¬ ¢  ° § | ° §°»¢ ¬¥¦¤³ ±²®¨¬®±²¼¾
®¯²¨¬ «¼­®£® ¶¨ª«  ¢ G0 ¤«¿ ±«³· ¥¢ ­ «¨·¨¿ ¨«¨ ®²±³²±²¢¨¿ £ ¬¨«¼²®­®¢  ¶¨ª«  ¢ G.  ¯¥°¢®¬ ±«³· ¥ ¥±²¼ ¶¨ª« ±²®¨¬®±²¼¾ jV j,
¢® ¢²®°®¬ ¢±¥ ¶¨ª«» ¨¬¥¾² ±²®¨¬®±²¼ ¡®«¼¸¥ jV j.
²® ¤ ±² ¯°¨¡«¨¦¥­­»©  «£®°¨²¬ A, ¯°¨¬¥­¥­­»© ª £° ´³ G0?
» ¯°¥¤¯®« £ ¥¬, ·²® ¤ ¢ ¥¬»© ¨¬ ®²¢¥² ­¥ ¡®«¥¥ ·¥¬ ¢  ° § µ³¦¥ ®¯²¨¬ «¼­®£®. «¥¤®¢ ²¥«¼­®, ¥±«¨ G ¨¬¥¥² £ ¬¨«¼²®­®¢ ¶¨ª«,
²® A ¤®«¦¥­ ¥£® ¢»¤ ²¼. ±«¨ ¦¥ ¶¨ª«  ­¥², ²® A ¢»¤ ¥² ¶¨ª«
±²®¨¬®±²¨ ¡®«¥¥ jV j. ¥¬ ± ¬»¬ ¬®¦­® ° §«¨·¨²¼ ®¤¨­ ±«³· © ®²
¤°³£®£® §  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿.
¯° ¦­¥­¨¿
37.2-1
®ª ¦¨²¥, ·²® ¢ § ¤ ·¥ ® ª®¬¬¨¢®¿¦¥°¥ ¬®¦­® (§  ¯®«¨­®¬¨ «¼­®¥ ¢°¥¬¿) ¬®¤¨´¨¶¨°®¢ ²¼ ´³­ª¶¨¾ ±²®¨¬®±²¨ ² ª, ·²®¡»
®­  ±² «  ³¤®¢«¥²¢®°¿²¼ ­¥° ¢¥­±²¢³ ²°¥³£®«¼­¨ª , ¨ ®¯²¨¬ «¼­»¥ ¶¨ª«» ¯°¨ ½²®¬ ­¥ ¨§¬¥­¨«¨±¼. ®·¥¬³ ½²® ­¥ ¯°®²¨¢®°¥·¨²
²¥®°¥¬¥ 37.3, ¤ ¦¥ ¥±«¨ P = NP?

864

« ¢  37 °¨¡«¨¦¥­­»¥  «£®°¨²¬»

37.2-2
 ¤ ·³ ª®¬¬¨¢®¿¦¥°  ¬®¦­® °¥¸ ²¼ ± ¯®¬®¹¼¾ ½¢°¨±²¨ª¨ ¡«¨¦ ©¸¥© ²®·ª¨ ±«¥¤³¾¹¨¬ ®¡° §®¬.  ·­¥¬ ± ²°¨¢¨ «¼­®£® ¶¨ª« , ±®¤¥°¦ ¹¥£® ®¤­³ ¢¥°¸¨­³ (¥¥ ¬®¦­® ¢»¡° ²¼ ¯°®¨§¢®«¼­®).
 ²¥¬ ¡³¤¥¬ ° ±¸¨°¿²¼ ¥£® ² ª: ¢»¡¨° ¥¬ ± ¬³¾ ¡«¨§ª³¾ ¢ ¶¨ª«³ ¢¥°¸¨­³ v , ±¬®²°¨¬, ª ª ¿ ¢¥°¸¨­  u ¶¨ª«  ¡«¨¦¥ ¢±¥£® ª v ¨
¢±² ¢«¿¥¬ v ¢ ¶¨ª« ±° §³ ¯®±«¥ u.  ª ¬» ¤¥« ¥¬ ¤® ²¥µ ¯®°, ¯®ª 
¶¨ª« ­¥ ¯°®©¤¥² ·¥°¥§ ¢±¥ ¢¥°¸¨­». ®ª ¦¨²¥, ·²® ¯®«³·¥­­»©
² ª¨¬ ®¡° §®¬ ¶¨ª« ¨¬¥¥² ±²®¨¬®±²¼ ­¥ ¡®«¥¥ ·¥¬ ¢¤¢®¥ µ³¤¸³¾
®¯²¨¬ «¼­®£®.
37.2-3
 ¤ ·  ® £ ¬¨«¼²®­®¢®¬ ¶¨ª«¥ ± ª®°®²ª¨¬¨ °¥¡° ¬¨ ±®±²®¨²
¢ ®²»±ª ­¨¨ £ ¬¨«¼²®­®¢  ¶¨ª« , ³ ª®²®°®£® ¤«¨­  ± ¬®£® ¤«¨­­®£® °¥¡°  ¡»«  ¡» ª ª ¬®¦­® ¬¥­¼¸¥.  ¯°®¤¯®«®¦¥­¨¨ ­¥° ¢¥­±²¢  ²°¥³£®«¼­¨ª  ¯®±²°®¨²¼ ¯®«¨­®¬¨ «¼­»© ¯°¨¡«¨¦¥­­»©
 «£®°¨²¬, °¥¸ ¾¹¨© ½²³ § ¤ ·³ ± ®¸¨¡ª®© ­¥ ¡®«¥¥ ·¥¬ ¢ 3 ° § .
(ª § ­¨¥: ®ª ¦¨²¥ ¯® ¨­¤³ª¶¨¨, ·²® ¬®¦­® ®¡®©²¨ ¢±¥ ¢¥°¸¨­»
¬¨­¨¬ «¼­®£® ¯®ª°»¢ ¾¹¥£® ¤¥°¥¢  ¯® ®¤­®¬³ ° §³, ¢§¿¢ ¥£® ¯®«­»© ®¡µ®¤ ¨ ¯°®¯³±ª ¿ ­¥ª®²®°»¥ ¢¥°¸¨­», ¯°¨ ½²®¬ ­¥ ¯°®¯³±ª ¿
¡®«¥¥ ¤¢³µ ¢­³²°¥­­¨µ ¢¥°¸¨­ ¯®¤°¿¤.)
37.2-4
®ª ¦¨²¥, ·²® ¥±«¨ ¢¥°¸¨­ ¬¨ £° ´  ¿¢«¿¾²±¿ ²®·ª¨ ­  ¯«®±ª®±²¨,   ±²®¨¬®±²¼ °¥¡°  | ° ±±²®¿­¨¥ ¬¥¦¤³ ¥£® ª®­¶ ¬¨, ²®
®¯²¨¬ «¼­»© ¶¨ª« ¢ § ¤ ·¥ ® ª®¬¬¨¢®¿¦¥°¥ ¿¢«¿¥²±¿ ­¥± ¬®¯¥°¥±¥ª ¾¹¨¬±¿ ¬­®£®³£®«¼­¨ª®¬.
 ¤ ·  ® ¯®ª°»²¨¨ ¬­®¦¥±²¢ ¬¨
²  § ¤ ·  ®¡®¡¹ ¥² NP-¯®«­³¾ § ¤ ·³ ® ¢¥°¸¨­­®¬ ¯®ª°»²¨¨
(¨ ¯®²®¬³ ¿¢«¿¥²±¿ NP-²°³¤­®©). ¤­ ª® ¯®¤µ®¤, ¨±¯®«¼§®¢ ­­»©
¢ ¯°¨¡«¨¦¥­­®¬  «£®°¨²¬¥ ¤«¿ § ¤ ·¨ ® ¢¥°¸¨­­®¬ ¯®ª°»²¨¨,
§¤¥±¼ ­¥ ° ¡®² ¥². ¬¥±²® ½²®£® ¬» ° ±±¬®²°¨¬ ¦ ¤­»©  «£®°¨²¬; ¤ ¢ ¥¬®¥ ¨¬ °¥¸¥­¨¥ ¡³¤¥² µ³¦¥ ®¯²¨¬ «¼­®£® ¢ «®£ °¨´¬¨·¥±ª®¥ ·¨±«® ° §.  °®±²®¬ ° §¬¥°  § ¤ ·¨ ª ·¥±²¢® °¥¸¥­¨¿
³µ³¤¸ ¥²±¿, ­® ¢±¥ ¦¥ ¤®¢®«¼­® ¬¥¤«¥­­® («®£ °¨´¬ | ¬¥¤«¥­­®
° ±²³¹ ¿ ´³­ª¶¨¿), ¯®½²®¬³ ² ª®© ¯®¤µ®¤ ¬®¦¥² ¡»²¼ ¯®«¥§¥­.
±µ®¤­»¬ ¤ ­­»¬¨ § ¤ ·¨ ® ¯®ª°»²¨¨ ¬­®¦¥±²¢ ¬¨ (setcovering problem) ¿¢«¿¾²±¿ ª®­¥·­®¥ ¬­®¦¥±²¢® X ,   ² ª¦¥ ±¥¬¥©±²¢® F ¥£® ¯®¤¬­®¦¥±²¢. °¨ ½²®¬ ª ¦¤»© ½«¥¬¥­² ¬­®¦¥±²¢  X
¯°¨­ ¤«¥¦¨² µ®²¿ ¡³ ®¤­®¬³ ¨§ ¯®¤¬­®¦¥±²¢ ±¥¬¥©±²¢  F :
[
X = S:
S 2F

» ¨¹¥¬ ¬¨­¨¬ «¼­®¥ ·¨±«® ¯®¤¬­®¦¥±²¢ ¨§ F , ª®²®°»¥ ¢¬¥±²¥
¯®ª°»¢ ¾² ¬­®¦¥±²¢® X , ²® ¥±²¼ ±¥¬¥©±²¢® mathcalC ­ ¨¬¥­¼¸¥©
¬®¹­®±²¨, ¤«¿ ª®²®°®£®
[
X = S:
(37:8)
S 2C

 ¤ ·  ª®¬¬¨¢®¿¦¥° 

865

37.3. °¨¬¥° ¨±µ®¤­»µ ¤ ­­»µ ¤«¿ § ¤ ·¨ ® ¯®ª°»²¨¨ ¬­®¦¥±²¢ ¬¨.
­®¦¥±²¢® X ±®±²®¨² ¨§ 12 ·¥°­»µ ²®·¥ª. ¥¬¥©±²¢® F ±®±²®¨² ¨§ 6 ¬­®¦¥±²¢
S1 {S6 . ¨­¨¬ «¼­®¥ ¯®ª°»²¨¥ ¨¬¥¥² ° §¬¥° 3 (¬­®¦¥±²¢  S3 ; S4 ; S5 ).  ¤­»©
 «£®°¨²¬ ¤ ¥² ¯®ª°»²¨¥ ° §¬¥°  4, ¢¥«¾· ¿ ¢ ­¥£® ¬­®¦¥±²¢  S1 , S4 , S5 ¨ S3
(¢ ³ª § ­­®¬ ¯®°¿¤ª¥).
¨±. 37.3

 ª®¥ ±¥¬¥©±²¢® C ¬» ¡³¤¥ ­ §»¢ ²¼ ¯®ª°»²¨¥¬ ¬­®¦¥±²¢  X .
(°¨¬¥° § ¤ ·¨ ® ¯®ª°»²¨¨ ¯°¨¢¥¤¥­ ­  °¨±. 37.3.)
®¦­® ¯°¥¤±² ¢«¿²¼ ±¥¡¥ X ª ª ­ ¡®° ­ ¢»ª®¢, ­¥®¡µ®¤¨¬»µ
¤«¿ ¢»¯®«­¥­¨¿ ª ª®£®-²® § ¤ ­¨¿; ¥±²¼ ­¥±ª®«¼ª® ·¥«®¢¥ª, ¢« ¤¥¾¹¨µ ­¥ª®²®°»¬¨ ¨§ ­¨µ.  ¤® ±´®°¬¨°®¢ ²¼ ¬¨­¨¬ «¼­³¾ £°³¯¯³ ¤«¿ ¢»¯®«­¥­¨¿ § ¤ ­¨¿, ¢ª«¾· ¾¹³¾ ¢ ±¥¡¿ ­®±¨²¥«¥© ¢±¥µ
­¥®¡µ®¤¨¬»µ ­ ¢»ª®¢.
 ¤ ·³ ® ¯®ª°»²¨¨ ¬­®¦¥±²¢ ¬¨ ¬®¦­® ±´®°¬³«¨°®¢ ²¼ ¢ ¢ °¨ ­²¥, ²°¥¡³¾¹¥¬ ®²¢¥²  ¤ /­¥²: À±³¹¥±²¢³¥² «¨ ¯®ª°»²¨¥ ° §¬¥° 
­¥ ¡®«²¸¥ kÁ (¤«¿ «¾¡®£® § ¤ ­­®£® k).  ³¯° ¦­¥­¨¨ 37.3-2 ¬»
¯®¯°®±¨¬ ¢ ± ¤®ª § ²¼, ·²® ½²  § ¤ ·  ¿¢«¿¥²±¿ NP-¯®«­®©.
 ¤­»© ¯°¨¡«¨¦¥­­»©  «£®°¨²¬
²®²  «£®°¨²¬ ®±­®¢ ­ ­  ¯°®±²®© ¨¤¥¥: ¢ ª ¦¤»© ¬®¬¥­² ¬»
¢»¡¨° ¥¬ ¬­®¦¥±²¢®, ¯®ª°»¢ ¾¹¥¥ ¬ ª±¨¬ «¼­®¥ ·¨±«® ¥¹¥ ­¥ ¯®ª°»²»µ ½«¥¬¥­²®¢.
1
2
3
4
5
6
7

U <- X
mathcal{C} <- 0
while U \ne \emptyset
do ¢»¡¨° ¥¬ S \in \mathcal{F} ± ­ ¨¡®«¼¸¨¬ |S\cap U|
U <- U - S
\mathcal{C} <- \mathcal{C} \cup \{S\}
return \mathcal{C}

 ¯°¨¬¥°¥ ­  °¨±. 37.3 ½²®²  «£®°¨²¬ ¢»¡¨° ¥² ¬­®¦¥±²¢  ¢
² ª®¬ ¯®°¿¤ª¥: S1 , S4, S5 ¨ S3 .
 ª ¦¤»© ¬®¬¥­² ° ¡®²»  «£®°¨²¬  ¬­®¦¥±²¢® U ±®¤¥°¦¨² ¥¹¥
­¥ ¯®ª°»²»¥ ½«¥¬¥­²»,   ±¥¬¥©±²¢® C | ³¦¥ ¢ª«¾·¥­­»¥ ¢ ¯®ª°»²¨¥ ¯®¤¬­®¦¥±²¢ .   ¸ £¥ 4 ¯°®¨§¢®¤¨²±¿ ¦ ¤­»© ¢»¡®°: ¢ ª ·¥±²¢¥ S ¡¥°¥²±¿ ¬­®¦¥±²¢®, ¯®ª°»¢ ¾¹¥¥ ­ ¨¡®«¼¸¥¥ ·¨±«® ¥¹¥
­¥ ¯®ª°»²»µ ½«¥¬¥­²®¢ (¥±«¨ ² ª¨µ ­¥±ª®«¼ª®, ¡¥°¥¬ «¾¡®¥). ®±«¥ ½²®£® S ¤®¡ ¢«¿¥²±¿ ª ±¥¬¥©±²¢³ C ,   ¥£® ½«¥¬¥­²» ³¤ «¿¾²±¿
¨§ U .  ª®­¶¥ ª®­¶®¢ ¬­®¦¥±²¢® ¥¹¥ ­¥ ¯®ª°»²»µ ½«¥¬¥­²®¢ (U )
¯³±²®,   C ¿¢«¿¥²±¿ ¯®ª°»²¨¥¬ ¬­®¦¥±²¢  X .
¨¤­®, ·²®  «£®°¨²¬ Greedy-Set-Cover ¯®«¨­®¬¨ «¥­ (¢°¥¬¿ ° ¡®²» ®¶¥­¨¢ ¥²±¿ ¬­®£®·«¥­®¬ ®² jX j ¨ jF j): ª®«¨·¥±²¢® ¯®¢²®°¥­¨© ¶¨ª«  ­¥ ¯°¥¢®±µ®¤¨² min(jX j; jFj),   ª ¦¤®¥ ¯®¢²®°¥­¨¥
«¥£ª® °¥ «¨§®¢ ²¼ §  O(jX j  jFj) ®¯¥° ¶¨©, ² ª ·²® ¢±¥£® ¡³¤¥²
O(jX j jFj  min(jX j; jFj)) ®¯¥° ¶¨©.  ³¯° ¦­¥­¨¨ 37.3-3 ¬» ¯°¥¤«®¦¨¬ ¢ ¬ °¥ «¨§®¢ ²¼ ½²®²  «£®°¨²¬ §  «¨­¥©­®¥ ¢°¥¬¿.
­ «¨§  «£®°¨²¬ 

866

« ¢  37 °¨¡«¨¦¥­­»¥  «£®°¨²¬»

¥¯¥°¼ ¬» ¤®«¦­» ±° ¢­¨²¼ ° §¬¥° ¯®ª°»²¨¿, ¤ ¢ ¥¬®£® ½²¨¬
 «£®°¨²¬, ± ¬¨­¨¬ «¼­® ¢®§¬®¦­»¬.  ¬ ¯®­ ¤®¡¨²±¿ ®¡®§­ ·¥­¨¥ H (d) ¤«¿ ±³¬¬»
¯¥°¢»µ d ·«¥­®¢ £ °¬®­¨·¥±ª®£® °¿¤  (±¬. ° §Pd
¤¥« 3.1): H (d) = i=1 1=i.
¥®°¥¬  37.4.
 §¬¥° ¯®ª°»²¨¿, ¤ ¢ ¥¬®£®  «£®°¨²¬®¬ Greedy-Set-Cover,
¯°¥¢®±µ®¤¨² ¬¨­¨¬ «¼­® ¢®§¬®¦­»© ­¥ ¡®«¥¥ ·¥¬ ¢

H (maxfjS j : S 2 Fg)
° §.
®ª § ²¥«¼±²¢®.
 ¤­»©  «£®°¨²¬ ®²¡¨° ¥² ¬­®¦¥±²¢  ®¤­® §  ¤°³£¨¬, ­  ª ¦¤®¬ ¸ £¥ ¢»¡¨° ¿ ²® ¨§ ­¨µ, ª®²®°®¥ ¯®ª°»¢ ¥² ¡®«¼¸¥ ¢±¥£®
­¥¯®ª°»²»µ ½«¥¬¥­²®¢. ³¤¥¬ ¯°¥¤±² ¢«¿²¼ ±¥¡¥, ·²® ­  ª ¦¤®¬
¸ £¥ ¨¬¥¥²±¿ ¤®«« °, ª®²®°»© ¯®°®¢­³ ° ±¯°¥¤¥«¿¥²±¿ ¬¥¦¤³ ¢±¥¬¨ ¢­®¢¼ ¯®ª°»²»¬¨ ½«¥¬¥­² ¬¨.  ª¨¬ ®¡° §®¬, ª ¦¤»© ½«¥¬¥­²
¯®«³· ¥² ¤¥­¼£¨ ²®«¼ª® ®¤­ ¦¤» | ­  ²®¬ ¸ £¥, ª®£¤  ®­ ¢¯¥°¢»¥
¯®¯ ¤ ¥² ¢ ¯®ª°»²¨¥, ¨ ¯®«³· ¥² ²¥¬ ¡®«¼¸¥ ¤¥­¥£, ·¥¬ ¬¥­¼¸¥
½«¥¬¥­²®¢ ®ª § «¨±¼ ¢ ²®¬ ¦¥ ¯®«®¦¥­¨¨. ®°¬ «¼­® £®¢®°¿, ¥±«¨
½«¥¬¥­² x ¢µ®¤¨² ¢ ¬­®¦¥±²¢® Si , ¢»¡° ­­®¥ ­  i-®¬ ¸ £¥ ° ¡®²»
 «£®°¨²¬ , ¨ ­¥ ¢µ®¤¨² ¢ Sk ¯°¨ ¬¥­¼¸¨µ k, ²® ®­ ¯®«³·¨²
cx = jS ; (S [ S1 [ : : :S )j
i
1
2
i;1
¤®«« °®¢. [ ¬¥²¨¬ ¢ ±ª®¡ª µ, ·²® ¢»£®¤­¥¥ ¯®«³· ²¼ ¤¥­¼£¨ ª ª
¬®¦­® ¯®§¦¥, ² ª ª ª ¯® ¬¥°¥ ¯°®¤¢¨¦¥­¨¿  «£®°¨²¬  ª®«¨·¥±²¢®
¢­®¢¼ ¯®ª°»¢ ¥¬»µ §  ° § ½«¥¬¥­²®¢ ¬®¦¥² ²®«¼ª® ³¬¥­¼¸ ²¼±¿ |
¦ ¤­»©  «£®°¨²¬ ­¥ ¡³¤¥² À®±² ¢«¿²¼ « ª®¬»© ª³±®ª ­  ¯®²®¬Á]
±¥£® ¡³¤¥² ¨§° ±µ®¤®¢ ­® jCj ¤®«« °®¢, ¯® ®¤­®¬³ ­  ª ¦¤»©
½«¥¬¥­² ¯®±²°®¥­­®£® ¯®ª°»²¨¿ C . ²¨ ¤¥­¼£¨ ¡³¤³² ª ª¨¬-²®
®¡° §®¬ ° ±¯°¥¤¥«¥­» ¬¥¦¤³ ¢±¥¬¨ ½«¥¬¥­² ¬¨ ¬­®¦¥±²¢  X (½«¥¬¥­² x ¯®«³· ¥² cx ¤®«« °®¢).  ¬ ­ ¤® ¯®ª § ²¼, ·²® ®¯²¨¬ «¼­®¥
¯®ª°»²¨¥ (±®¤¥°¦ ¹¥¥ ¬¨­¨¬ «¼­® ¢®§¬®¦­®¥ ·¨±«® ¬­®¦¥±²¢) ­¥
¬®¦¥² ¡»²¼ ±¨«¼­® ¬¥­¼¸¥ ­ ¸¥£®. » ±¤¥« ¥¬ ½²®, ³¡¥¤¨¢¸¨±¼,
·²® ¤«¿ «¾¡®£® ¬­®¦¥±²¢  S ¨§ ±¥¬¥©±²¢  F ®¡¹ ¿ ±³¬¬  ¤¥­¥£,
¯®«³·¥­­ ¿ ¢±¥¬¨ ½«¥¬¥­² ¬¨ S , ­¥ ¯°¥¢®±µ®¤¨² H (jS j), ¨ ¯®²®¬³
¯®­ ¤®¡¨²±¿ ­¥ ¬¥­¥¥ jCj=H (maxfjS j : S 2 Fg) ½«¥¬¥­²®¢ ®¯²¨¬ «¼­®£® ¯®ª°»²¨¿, ·²®¡» ­ ¡° ²¼ ®¡¹³¾ ±³¬¬³ ¢ jCj.
®°¬ «¼­® £®¢®°¿, ¤«¿ ®¯²¨¬ «¼­®£® ¯®ª°»²¨¿ C  ¬» ¨¬¥¥¬

jCj =
6

X

x2X

cx 6

X X

S 2C  x2S

cx

(37:9)

 ¤ ·  ª®¬¬¨¢®¿¦¥° 

867

¨, ª°®¬¥ ²®£®, ¤«¿ «¾¡®£® S ¨§ ±¥¬¥©±²¢  F ¬» ¢±ª®°¥ ¤®ª ¦¥¬,
·²®
X
cx 6 H (jS j):
x2S

§ ­¥° ¢¥­±²¢ (37.9) ¨ (37.10) ±«¥¤³¥², ·²®

C6

X

S 2C 

H (jS j) 6

6 jC j  H (maxfjS j : S 2 Fg);

·²® ¨ ±®±² ¢«¿¥² ³²¢¥°¦¤¥­¨¥ ²¥®°¥¬».
±² «®±¼ ¤®ª § ²¼ ­¥° ¢¥­±²¢® (37.10). ³±²¼ S | ¯°®¨§¢®«¼­®¥
¬­®¦¥±²¢® ¨§ ±¥¬¥©±²¢  F , ±®¤¥°¦ ¹¥¥ u ½«¥¬¥­²®¢.  ¦¤»© ¨§
½²¨µ ½«¥¬¥­²®¢ ¯®«³·¨² ª ª³¾-²® ±³¬¬³ ¤¥­¥£ ¯® ­ ¸¨¬ ¯° ¢¨« ¬, ¨ ­ ¤® ¯°®¢¥°¨²¼, ·²® ®¡¹ ¿ ±³¬¬  ¤«¿ ¢±¥µ ½«¥¬¥­²®¢ S ­¥
¯°¥¢®±µ®¤¨² ±³¬¬»
1 + 1=2 + 1=3 + : : : + 1=u
(½²  ±³¬¬  ² ª¦¥ ±®±²®¨² ¨§ u ±« £ ¥¬»µ). ¥©· ± ¬» ¢ ½²®¬ ³¡¥¤¨¬±¿. ®±¬®²°¨¬ ­  £°³¯¯³ ½«¥¬¥­²®¢ S , ª®²®°»¥ ¯®«³· ¾² ±¢®¨
¤¥­¼£¨ ¯¥°¢»¬¨ (±°¥¤¨ ½«¥¬¥­²®¢ S ).  ¦¤»© ¨§ ­¨µ ¯®«³·¨² ­¥
¡®«¥¥ 1=u.  ± ¬®¬ ¤¥«¥, ®¡¹¥¥ ª®«¨·¥±²¢® ½«¥¬¥­²®¢ X , ¯®«³· ¾¹¨µ ¤¥­¼£¨ ­  ½²®¬ ¸ £¥, ­¥ ¬®¦¥² ¡»²¼ ¬¥­¼¸¥ u, ¢¥¤¼ ¦ ¤­»©
 «£®°¨²¬ ¢»¡¨° ¥² ¬­®¦¥±²¢®, ¯®ª°»¢ ¾¹¥¥ ­ ¨¡®«¼¸¥¥ ¢®§¬®¦­®¥ ·¨±«® ¥¹¥ ­¥ ¯®ª°»²»µ ½«¥¬¥­²®¢, ¨ ­¥ ¬®¦¥² ¢»¡° ²¼ ¬­®¦¥±²¢ , µ³¤¸¥£® S . ­ ·¨², ­  ª ¦¤»© ½«¥¬¥­² ¯°¨¤¥²±¿ ­¥ ¡®«¥¥ 1=u,
¨ ®¡¹ ¿ ±³¬¬  ¡³¤¥² ­¥ ¡®«¼¸¥, ·¥¬ µ¢®±² ­ ¸¥© ±³¬¬», ¨¬¥¾¹¨©
²³ ¦¥ ¤«¨­³. ®±«¥ ½²®£® ®±² ­¥²±¿ ª ª®¥-²® ·¨±«® u1 ­¥¯®ª°»²»µ
½«¥¬¥­²®¢, ¨ ­ ¤® ¡³¤¥² ¤®ª § ²¼, ·²® ®¡¹ ¿ ±³¬¬  ¤¥­¥£, ¨¬ ¯°¨·¨² ¾¹ ¿±¿, ­¥ ¯°¥¢®±µ®¤¨² ®±² ¢¸¥©±¿ · ±²¨ ­ ¸¥© ±³¬¬», ²®
¥±²¼
1 + 1=2 + 1=3 + : : : + 1=u1
®±¬®²°¨¬ ­  ½«¥¬¥­²», ª®²®°»¥ ¡³¤³² ¯®«³· ²¼ ¤¥­¼£¨ ¯¥°¢»¬¨
(±°¥¤¨ ®±² ¢¸¨µ±¿): ¯® ²¥¬ ¦¥ ¯°¨·¨­ ¬, ·²® ¨ ° ­¼¸¥, ®­¨ ¯®«³· ² ­¥ ¡®«¥¥ 1=u1 ª ¦¤»©, ¨ ®¡¹ ¿ ±³¬¬  ­¥ ¡³¤¥² ¯°¥¢®±µ®¤¨²¼
±®®²¢¥²±²¢³¾¹¥© · ±²¨ ­ ¸¥© ±³¬¬». °®¤®«¦ ¿ ½²® ° ±±³¦¤¥­¨¥, ¬» ¢¨¤¨¬, ·²® ¥±«¨ ¢»¯« ²» ¯°®¨±µ®¤¿² ¢ k ½² ¯®¢ ¨ ¥±«¨
u1 > u2 > : : : > uk;1 > uk = 0
| ª®«¨·¥±²¢® ½«¥¬¥­²®¢ ¢ S , ª®²®°»¬ ¥¹¥ ­¥ ¢»¤ «¨ ¤¥­¥£ ¯®±«¥
1; 2; : : : ; k ¢»¯« ², ²® ®¡¹ ¿ ±³¬¬  ¢»¯« ·¥­­»µ ½«¥¬¥­² ¬ S ¤¥­¥£
­¥ ¯°¥¢®±µ®¤¨²
1 + : : :+ 1 + 1 + : : : + 1 + : : : + 1 + : : : + 1 + 1 + : : : + 1 ;

uk;1

uk;1 uk;2

uk;2

u1

u1 u

u

868

« ¢  37 °¨¡«¨¦¥­­»¥  «£®°¨²¬»

·²® ­¥ ¯°¥¢®±µ®¤¨² (±° ¢­¨¢ ¥¬ ¯®·«¥­­®) · ±²­®© ±³¬¬» £ °¬®­¨·¥±ª®£® °¿¤ 
1 +: : :+ 1 + 1 +: : :+ 1 +: : :+ 1 +: : :+ 1 + 1 +: : :+ 1 ;
1
uk;1 uk;1 + 1
uk;2
u2 + 1
u1 u1 + 1
u
²® ¥±²¼ H (u), ·²® § ¢¥°¸ ¥² ¤®ª § ²¥«¼±²¢® ­¥° ¢¥­±²¢  (37.10) ¨
²¥®°¥¬» 37.4
[ ¤¨ª: ­ ¤® ¡» ­ ¡° ²¼ ±®®²¢¥²±²¢³¾¹¨¥ ·«¥­» ®¤¨­ ¯®¤ ¤°³£¨¬!!]
«¥¤±²¢¨¥ 37.4.
«£®°¨²¬ Greedy-Set-Cover ¤ ¥² °¥¸¥­¨¥ § ¤ ·¨ ® ¯®ª°»²¨¨, µ³¤¸¥¥ ®¯²¨¬ «¼­®£® ­¥ ¡®«¥¥ ·¥¬ ¢ (ln jX j + 1) ° §.
®ª § ²¥«¼±²¢®. ·¥¢¨¤­®¥ ±«¥¤±²¢¨¥ ²¥®°¥¬» 37.3 ¨ ­¥° ¢¥­±²¢  (3.12).
±«¨ ¬­®¦¥±²¢ , ¨§ ª®²®°»µ ­ ¤® ¢»¡¨° ²¼ ¯®ª°»²¨¥, ±®¤¥°¦ ²
¬ «® ½«¥¬¥­²®¢, ²®  «£®°¨²¬ Greedy-Set-Cover ¤ ¥² °¥¸¥­¨¥,
¤®¢®«¼­® ¡«¨§ª®¥ ª ®¯²¨¬ «¼­®¬³.  ¯°¨¬¥°, ¥±«¨ ¬» ¯°¨¬¥­¿¥¬
½²®²  «£®°¨²¬ ª § ¤ ·¥ ® ¢¥°¸¨­­®¬ ¯®ª°»²¨¨ £° ´ , ¢ ª®²®°®¬
±²¥¯¥­¨ ¢¥°¸¨­ ­¥ ¯°¥¢®±µ®¤¿² 3, ²® ¤ ¢ ¥¬®¥ ¨¬ °¥¸¥­¨¥ ­¥ ¡®«¥¥
·¥¬ ¢ H (3) = 11=6 ° § µ³¦¥ ®¯²¨¬ «¼­®£®. (²  ®¶¥­ª  ­¥¬­®£®
«³·¸¥, ·¥¬ ¤«¿ ¯°¨¢¥¤¥­­®£® ¢ ° §¤¥«¥ 37.1  «£®°¨²¬  ApproxVertex-Cover.)
¯° ¦­¥­¨¿.
37.3-1
 ±±¬®²°¨¬ ª ¦¤®¥ ¨§ ±«®¢ arid, dash, drain, heard, lost, nose,
shun, slate, snare, thread ª ª ¬­®¦¥±²¢® ¡³ª¢. ²® ¤ ±²  «£®°¨²¬
Greedy-Set-Cover ¢ ¯°¨¬¥­¥­¨¨ ª ½²¨¬ ¬­®¦¥±²¢ ¬? (±«¨ ¢®§­¨ª ¥² ¢»¡®° ¬¥¦¤³ ­¥±ª®«¼ª¨¬¨ ±«®¢ ¬¨, ¡¥°¥²±¿ ¯¥°¢®¥ ¢  «´ ¢¨²­®¬ ¯®°¿¤ª¥.)
37.3-2
®ª ¦¨²¥, ·²® § ¤ ·  ® ¯®ª°»²¨¨ ¬­®¦¥±²¢ ¬¨, ° ±±¬ ²°¨¢ ¥¬ ¿ ª ª § ¤ ·  ° §°¥¸¥­¨¿, ¿¢«¿¥²±¿ NP-¯®«­®©, ±¢¥¤¿ ª ­¥© § ¤ ·³ ® ¢¥°¸¨­­®¬ ¯®ª°»²¨¨.
37.3-3
®ª § ²¼, ·²® ¬®¦­® °¥ «¨§®¢ ²¼
 «£®°¨²¬ Greedy-SetP
Cover ± ¢°¥¬¥­¥¬ ° ¡®²» O( S 2F jS j).
37.3-4
¡º¿±­¨²¥, ¯®·¥¬³ ±«¥¤³¾¹¥¥ ®±« ¡«¥­¨¥ ³²¢¥°¦¤¥­¨¿ ²¥®°¥¬»
37.4 ®·¥¢¨¤­®:
jCj 6 jC j  maxfjS j : S 2 Fg:
37.5
°¨¢¥¤¨²¥ ¯°¨¬¥°», ¯®ª §»¢ ¾¹¨¥, ·²® ª®«¨·¥±²¢® ° §«¨·­»µ
®²¢¥²®¢, ¤ ¢ ¥¬»µ  «£®°¨²¬®¬ Greedy-Set-Cover ¯°¨ ° §­»µ
±¯®±®¡ µ ¢»¡®°  ¬­®¦¥±²¢  ¢ ±²°®ª¥ 4 (¨§ ¬­®¦¥±²¢, ¯®ª°»¢ ¾¹¨µ ®¤¨­ ª®¢®¥ ·¨±«® ¥¹¥ ­¥ ¯®ª°»²»µ ½«¥¬¥­²®¢), ¬®¦¥² ½ª±¯®­¥­¶¨ «¼­® ° ±²¨ ± °®±²®¬ ° §¬¥°  § ¤ ·¨.

 ¤ ·  ® ±³¬¬¥ ¯®¤¬­®¦¥±²¢ 

869

37.3.  ¤ ·  ® ±³¬¬¥ ¯®¤¬­®¦¥±²¢ 
±µ®¤­»¬ ¤ ­­»¬ ¤«¿ ½²®© § ¤ ·¨ ¿¢«¿¥²±¿ ¯ °  (S; t), £¤¥
S = fx1; x2; : : : ; xn g ¯°¥¤±² ¢«¿¥² ±®¡®© ­¥ª®²®°®¥ ¬­®¦¥²±¢® ¯®«®¦¨²¥«¼­»µ ¶¥«»µ ·¨±¥«,   t | ¯®«®¦¨²¥«¼­®¥ ¶¥«®¥ ·¨±«®. ­ ¿
S ¨ t, ­ ¤® ¢»¿±­¨²¼, ¬®¦­® «¨ ­ ©²¨ ¯®¤¬­®¦¥±²¢® ¬­®¦¥±²¢  S ,
±³¬¬  ½«¥¬¥­²®¢ ª®²®°®£® ¢ ²®·­®±²¨ ° ¢­  t. ²  § ¤ ·  ¿¢«¿¥²±¿

NP-¯®«­®© (±¬. ° §¤¥« 36.5.3).
 ¤ ·³ ¬®¦­® ±² ¢¨²¼ ¨ ¢ ®¯²¨¬¨§ ¶¨®­­®¬ ¢ °¨ ­²¥, ²°¥¡³¿
®²»±ª ²¼ ±°¥¤¨ ¯®¤¬­®¦¥±²¢, ±³¬¬  ª®²®°»µ ­¥ ¯°¥¢®±µ®¤¨² t,
² ª®¥, ³ ª®²®°®£® ±³¬¬  ¡«¨¦¥ ¢±¥£® ª t. ®¦­® ¯°¥¤±² ¢«¿²¼ ±¥¡¥, ·²® ¬» ¤®«¦­» ª ª ¬®¦­® ¡®«¼¸¥ § £°³§¨²¼ ¬ ¸¨­³ £°³§®¯®¤º¥¬­®±²¨ t, ¨¬¥¿ ¿¹¨ª¨ ¢¥±®¢ x1; : : : ; xn (­® ­¥ ¯¥°¥µ®¤¿ £° ­¨¶»).
 ½²®¬ ° §¤¥«¥ ¬» ¯°¨¢®¤¨¬  «£®°¨²¬, °¥¸ ¾¹¨© ½²³ § ¤ ·³
§  ½ª±¯®­¥­¶¨ «¼­®¥ ¢°¥¬¿, ¨ ¯®ª §»¢ ¥¬, ª ª ¨§ ­¥£® ¯®«³·¨²¼
¯®«­®±²¼¾ ¯®«¨­®¬¨ «¼­³¾ ±µ¥¬³ ¯°¨¡«¨¦¥­¨¿. ( ¯®¬­¨¬: ½²®
®§­ · ¥², ·²® ¢°¥¬¿ ° ¡®²» ®¶¥­¨¢ ¥²±¿ ¬­®£®·«¥­®¬ ®² ° §¬¥° 
§ ¤ ·¨ ¨ ®² 1=", £¤¥ " | ®²­®±¨²¥«¼­ ¿ ®¸¨¡ª .)
ª±¯®­¥­¶¨ «¼­»©  «£®°¨²¬
±«¨ L | ­ ¡®° ·¨±¥«,   x | ­¥ª®²®°®¥ ·¨±«®, ²® ·¥°¥§ L + x
¬» ®¡®§­ · ¥¬ ­ ¡®° ·¨±¥«, ª®²®°»© ¯®«³·¨²±¿, ¥±«¨ ¤®¡ ¢¨²¼ x
ª ª ¦¤®¬³ ¨§ ½«¥¬¥­²®¢ L.  ¯°¨¬¥°, ¤«¿ L = h1; 2; 3; 5; 9i ¨ x = 2
¬» ¨¬¥¥¬ L + x = h3; 4; 5; 7; 11i. ­ «®£¨·­ ¿ § ¯¨±¼ ¨±¯®«¼§³¥²±¿
¨ ¤«¿ ¬­®¦¥±²¢:
S + x = fs + x : s 2 S g
 ¬ ¯®­ ¤®¡¨²±¿ ¯°®¶¥¤³°  Merge-Lists(L; L0), °¥§³«¼² ²®¬
ª®²®°®© ¿¢«¿¥²±¿ ±®¥¤¨­¥­¨¥ ¤¢³µ ³¯®°¿¤®·¥­­»µ ­ ¡®°®¢ L ¨ L0
± ±®µ° ­¥­¨¥¬ ¯®°¿¤ª . ±¯®¬¨­ ¿ ±®°²¨°®¢ª³ ±«¨¿­¨¥¬ (° §¤¥«
1.3.1). ¬» ¢¨¤¨¬, ·²® ½²® ¬®¦­® ±¤¥« ²¼ §  ¢°¥¬¿ O(jLj + jL0j).
(» ­¥ ¯°¨¢®¤¨¬ ²¥ª±²  ½²®© ¯°®¶¥¤³°».)
¥¯¥°¼ ¬» ¬®¦¥¬ ­ ¯¨± ²¼  «£®°¨²¬ Exact-Subset-Sum, °¥¸ ¾¹¨© ±´®°¬³«¨°®¢ ­­³¾ ¢»¸¥ § ¤ ·³ ® ±³¬¬¥ ¯®¤¬­®¦¥±²¢ . ±µ®¤­»¬¨ ¤ ­­»¬¨ ¤«¿ ­¥£® ¿¢«¿¥²±¿ ­ ¡®° ¯®«®¦¨²¥«¼­»µ ¶¥«»µ
·¨±¥« S = hx1; x2; : : : ; xni ¨ ¯®«®¦¨²¥«¼­®¥ ¶¥«®¥ ·¨±«® t. ¥§³«¼² ²®¬ ° ¡®²» ¿¢«¿¥²±¿ ¬ ª±¨¬ «¼­® ¢®§¬®¦­ ¿ ±³¬¬  ­¥ª®²®°»µ
½«¥¬¥­²®¢ ¨§ S , ­¥ ¯°¥¢®±µ®¤¿¹ ¿ t.
Exact-Subset-Sum (S,t)
1 n <- |S|
2 L_0 <- <0>
3 for i<-1 1 to n
4 do L_i <- Merge-Lists(L_{i-1}, L_{i-1}+x_i)
5
³¤ «¨²¼ ¨§ $L_i$ ½«¥¬¥­²», ¡®«¼¸¨¥ $t$
6 return ­ ¨¡®«¼¸¨© ½«¥¬¥­² ¢ $L_n$

870

« ¢  37 °¨¡«¨¦¥­­»¥  «£®°¨²¬»

¤¥¿  «£®°¨²¬  ¯°®±² : ¥±«¨ ·¥°¥§ Pi ®¡®§­ ·¨²¼ ¬­®¦¥±²¢®
¢±¥µ ·¨±¥«, ª®²®°»¥ ¬®¦­® ¯®«³·¨²¼, ±ª« ¤»¢ ¿ ­¥ª®²®°»¥ ¨§
x1 ; x2; : : : ; xi, ²®
Pi = Pi;1 [ (Pi;1 + xi )
(37:11)
(½«¥¬¥­² xi ¬®¦¥² ­¥ ¢µ®¤¨²¼ ¢ ±³¬¬³,   ¬®¦¥² ¨ ¢µ®¤¨²¼) ¬»
¢¨¤¨¬ (¨­¤³ª¶¨¿ ¯® i, ³¯° ¦­¥­¨¥ 37.4-1), ·²® Li ¯°¥¤±² ¢«¿¥²
±®¡®© ±¯¨±®ª ½«¥¬¥­²®¢ ¬­®¦¥±²¢  Pi ¢ ¯®°¿¤ª¥ ¢®§° ±² ­¨¿ (¨§
ª®²®°®£® ¢»¡°®¸¥­» ½«¥¬¥­²», ¡®«¼¸¨¥ t).
ª®«¼ª® ¢°¥¬¥­¨ ²°¥¡³¥² ½²®²  «£®°¨²¬? ¯¨±®ª Li ¬®¦¥² ±®¤¥°¦ ²¼ ¤® 2i ½«¥¬¥­²®¢, ² ª ·²®  «£®°¨²¬ ½ª±¯®­¥­¶¨ «¥­. ¯°®·¥¬, ¥±«¨ t (¨«¨ ¢±¥ ½«¥¬¥­²» S ) ®£° ­¨·¥­® ±¢¥°µ³ ¬­®£®·«¥­®¬
®² jS j, ²® ¢°¥¬¿ ° ¡®²»  «£®°¨²¬  ² ª¦¥ ®£° ­¨·¥­® ¬­®£®·«¥­®¬
®² jS j.
®«­®±²¼¾ ¯®«¨­®¬¨ «¼­ ¿ ±µ¥¬  ¯°¨¡«¨¦¥­¨¿
 ª ¿ ±µ¥¬  ¯®«³· ¥²±¿ ¨§ ®¯¨± ­­®£®  «£®°¨²¬ , ¥±«¨ µ° ­¨²¼
±¯¨±ª¨ Li ¢ ±®ª° ¹¥­­®© ´®°¬¥. ²¥¯¥­¼ ±®ª° ¹¥­¨¿ ®¯°¥¤¥®¿¥²±¿ ¯ ° ¬¥²°®¬  - ·¥¬ ®­ ¬¥­¼¸¥, ²¥¬ ¡«¨¦¥ ±¯¨±®ª ª ¯®«­®¬³.
¯¨±®ª L0 ­ §»¢ ¥²±¿  -±®ª° ¹¥­¨¥¬ ±¯¨±ª  L, ¥±«¨ L0 ¿¢«¿¥²±¿
· ±²¼¾ L ¨ ¤«¿ «¾¡®£® ½«¥¬¥­²  y ¨§ L ¢ ±¯¨±ª¥ L0 ­ ©¤¥²±¿ ­¥
¯°¥¢®±µ®¤ ¹¨© ¥£® ½«¥¬¥­² z , ¤«¿ ª®²®°®£®
¨«¨, ¤°³£¨¬¨ ±«®¢ ¬¨,

y;z 6
y

(1 ;  )y 6 z 6 y:
¥¬ ± ¬»¬ «¾¡®© ½«¥¬¥­² y , ¢»¡°®¸¥­­»© ¨§ L ¯°¨ ¯®«³·¥­¨¨
¬¥­¼¸¥£® ±¯¨±ª  L0, ¯°¥¤±² ¢«¥­ ¢ L0 ±¢®¨¬ ¯°¨¡«¨¦¥­¨¥¬ ±­¨§³
± ®²­®±¨²¥«¼­®© ®¸¨¡ª®© (®²­®±¨²¥«¼­® y ) ­¥ ¡®«¥¥  .  ¯°¨¬¥°,
¤«¿  = 0;1 ¨

L = h10; 11; 12; 15; 20; 21; 22; 23; 24; 29i
±¯¨±®ª

L0 = h10; 13; 15; 20; 23; 29i
¿¢«¿¥²±¿  -±®ª° ¹¥­¨¥¬ L, ¢ ª®²®°®¬ ¢»¡°®¸¥­­®¥ ·¨±«® 11 ¯°¥¤-

±² ¢«¥­® ·¨±«®¬ 10, ·¨±«  21 ¨ 22 ¯°¥¤±² ¢«¥­» ·¨±«®¬ 20,   ·¨±«®
24 ¯°¥¤±² ¢«¥­® ·¨±«®¬ 23.  ¦­® ¨¬¥²¼ ¢ ¢¨¤³, ·²®  -±®ª° ¹¥­¨¥
¿¢«¿¥²±¿ · ±²¼¾ ®°¨£¨­ «¼­®£® ±¯¨±ª . °¨ ½²®¬ ·¨±«® ½«¥¬¥­²®¢ ¬®¦¥² ±¨«¼­® ³¬¥­¼¸¨²±¿, ­® ¤«¿ ¢±¥µ ¢»¡°®¸¥­­» ½«¥¬¥­²®¢
·³²¼ ¬¥­¼¸¨¥ §­ ·¥­¨¿ ®±² ­³²±¿.
«¥¤³¾¹ ¿ ¯°®¶¥¤³°  ±®ª° ¹ ¥² ±¯¨±®ª L = hy1 ; y2; : : : ; ymi,
³¯®°¿¤®·¥­­»© ¯® ¢®§° ±² ­¨¾, §  ¢°¥¬¿ (m). ¥ °¥§³«¼² ² L0
¿¢«¿¥²±¿  -±®ª° ¹¥­¨¬ L; ±¯¨±®ª L0 ² ª¦¥ ³¯®°¿¤®·¥­ ¯® ¢®§° ±² ­¨¾.

 ¤ ·  ® ±³¬¬¥ ¯®¤¬­®¦¥±²¢ 

871

\textsc{Trim} (L, \delta)
1 m <- |L|
2 L' <- <y_1>
3 last <- y_1
4 for i<-2 to m
5
do if last < (1-\delta) y_i
6
then ¤®¯¨± ²¼ $y_i$ ¢ ª®­¥¶ ±¯¨±ª  L'
7
last <- y_i
8 return L'

«¥¬¥­²» ±¯¨±ª  L ¯°®±¬ ²°¨¢ ¾²±¿ ¢ ¯®°¿¤ª¥ ¢®§° ±² ­¨¿, ¨
¢ L0 ¯®¬¥¹ ¥²±¿ ¯¥°¢»© ¨§ ­¨µ,   ² ª¦¥ ²¥, ª®²®°»¥ ±«¨¸ª®¬ ¢¥«¨ª¨, ·²®¡» ¡»²¼ ¯°¥¤±² ¢«¥­­»¬¨ ¯®±«¥¤­¨¬ ¨§ ³¦¥ ¨¬¥¾¹¨µ±¿
½«¥¬¥­²®¢ ±¯¨±ª  L0 .
¥¯¥°¼ ±µ¥¬  ¯°¨¡«¨¦¥­¨¿ ¤«¿ § ¤ ·¨ ® ±³¬¬ µ ¯®¤¬­®¦¥±²¢
¬®¦¥² ¡»²¼ ¯®±²°®¥­  ±«¥¤³¾¹¨¬ ®¡° §®¬.  ¯®¬­¨¬, ·²® ¨±µ®¤­»¬¨ ¤ ­­»¬¨ ¤«¿ ­¥¥ ¿¢«¿¾²±¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼ S =
hx1; x2; : : : ; xni ¨§ n ·¨±¥« (¨¤³¹¨µ ¢ ¯°®¨§¢®«¼­®¬ ¯®°¿¤ª¥), ·¨±«® t,   ² ª¦¥ ¯ ° ¬¥²° ¯°¨¡«¨¦¥­¨¿ " (¢ ¨­²¥°¢ «¥ 0 < " < 1).
\textsc{Approx-Subset-Sum}(S,t,\varepsilon)
1 n <- |S|
2 L_0 <- <0>
3 for i<-1 to n
4
do L_i <- Merge-Lists(L_{i-1},L_{i-1}+x_i)
5
L_i <- Trim (L_i, \varepsilon/n)
6
¢±¥ ½«¥¬¥­²» $L_i$, ¡®«¼¸¨¥ $t$, ³¤ «¿¾²±¿
7 z <- ­ ¨¡®«¼¸¨© ½«¥¬¥­² $L_n$
8 return z

­ · «¥ (±²°®ª  2) ¢ ±¯¨±®ª L0 ¯®¬¥¹ ¥²±¿ ¥¤¨­±²¢¥­­»© ½«¥¬¥­² 0.  ±²°®ª µ 3{6 ¬» ¯®±«¥¤®¢ ²¥«¼­® (¤«¿ i = 1; : : :n) ¢»·¨±«¿¥¬ ±¯¨±®ª Li , ª®²®°»© ®ª ¦¥²±¿ ±®ª° ¹¥­¨¥¬ ¬­®¦¥±²¢  Pi
(¢±¥¢®§¬®¦­»µ ±³¬¬, ±®±² ¢«¥­­»µ ¨§ ¯¥°¢»µ i ½«¥¬¥­²®¢) ¨§ ª®²®°®£® ³¤ «¥­» ¢±¥ ½«¥¬¥­²», ¡®«¼¸¨¥ t. ²¬¥²¨¬, ·²® ½²® ²°¥¡³¥²
±¯¥¶¨ «¼­®© ¯°®¢¥°ª¨, ² ª ª ª ±®ª° ¹¥­¨¿ ¯°®¨§¢®¤¿²±¿ ­  ª ¦¤®¬ ¸ £¥, ¨ ¢ ±²°®ª¥ 4 ±®¥¤¨­¿¾²±¿ ³¦¥ ±®ª° ¹¥­­»¥ ¢ °¨ ­²»
±¯¨±ª®¢.
°¥¦¤¥ ·¥¬ ¯°®¢¥°¿²¼ ½²®, ° ±±¬®²°¨¬ ¯°¨¬¥°: ¯³±²¼

L = h104; 102; 201; 101i
¯°¨ ½²®¬ t = 308 ¨ " = 0;2. ®£¤  ­  ª ¦¤®¬ ¸ £¥ ¯°®¨§¢®¤¨²¼±¿
0;05-±®ª° ¹¥­¨¥, ¨ ¢»·¨±«¥­¨¿ ¯°®µ®¤¿² ² ª:
±²°®ª  2: L_0 = <0>,

872

« ¢  37 °¨¡«¨¦¥­­»¥  «£®°¨²¬»
±²°®ª  4: L_1 = <0,104>
±²°®ª  5: L_1 = <0,104>
±²°®ª  6: L_1 = <0,104>
±²°®ª  4: L_2 = <0,102,104,206>
±²°®ª  5: L_2 = <0,102,206>
±²°®ª  5: L_2 = <0,102,206>
±²°®ª  4: L_3 = <0,102,201,206,303,407>
±²°®ª  5: L_3 = <0,102,201,303,407>
±²°®ª  6: L_3 = <0,102,201,303>
±²°®ª  4: L_4 = <0,101,102,201,203,302,303,404>
±²°®ª  5: L_4 = <0,101,201,302,404>
±²°®ª  6: L_4 = <0,101,201,302>

 ®²¢¥²¥ ¯®«³· ¥²±¿ z = 302, ·²® ®²«¨· ¥²±¿ ®² ®¯²¨¬ «¼­®£®
¢ °¨ ­²  (307 = 104+102+101) ¬¥­¥¥ ·¥¬ ­  2% (·²® ¬­®£® ¬¥­¼¸¥
° §°¥¸¥­­®£® ®²ª«®­¥­¨¿ ¢ 20%).
¥®°¥¬ . «£®°¨²¬ Approx-Subset-Sum ¯°¥¤±² ¢«¿¥² ±®¡®©
¯®«­®±²¼¾ ¯®«¨­®¬¨ «¼­³¾ ±µ¥¬³ ¯°¨¡«¨¦¥­¨¿ ¤«¿ § ¤ ·¨ ® ±³¬¬¥ ¯®¤¬­®¦¥±²¢ .
®ª § ²¥«¼±²¢®. ¡¥ ®¯¥° ¶¨¨ (±®ª° ¹¥­¨¥ ±¯¨±ª  ¢ ±²°®ª¥ 5
¨ ³¤ «¥­¨¥ ±«¨¸ª®¬ ¡®«¼¸¨µ ½«¥¬¥­²®¢ ¢ ±²°®ª¥ 6) ¬®£³² «¨¸¼
³¬¥­¼¸¨²¼ ±¯¨±®ª, ² ª ·²® ±¯¨±®ª Li ®±² ¥²±¿ ¯®¤¬­®¦¥±²¢®¬
¬­®¦¥±²¢  Pi . ( ¯®¬­¨¬, ·²® ·¥°¥§ Pi ®¡®§­ · ¥²±¿ ¬­®¦¥±²¢®
¢±¥µ ·¨±¥«, ª®²®°»¥ ¬®¦­® ¯®«³·¨²¼, ±ª« ¤»¢ ¿ ­¥ª®²®°»¥ ¨§
x1 ; x2; : : : ; xi.)  ª¨¬ ®¡° §®¬, ·¨±«® z ¤¥©±²¢¨²¥«¼­® ¡³¤¥² ±³¬¬®© ­¥ª®²®°®£® ¯®¤¬­®¦¥±²¢ , ¯°¨·¥¬ z 6 t. ±² «®±¼ ¯°®¢¥°¨²¼
«¨¸¼, ·²® ®­® ­¥ ¬¥­¼¸¥ (1 ; "), ³¬­®¦¥­­®£® ­  ¬ ª±¨¬ «¼­® ¢®§¬®¦­³¾ ±³¬¬³, ­¥ ¯°¥¢®±µ®¤¿¹³¾ t. (¬¥­­® ½²®£® ²°¥¡³¥² ­¥° ¢¥­±²¢® (37.2) ¤«¿ ­ ¸¥©£® ±«³· ¿.)
®±¬®²°¨¬, ª ª ª®© ®¸¨¡ª¥ ¯°¨¢®¤¨² ±®ª° ¹¥­¨¥ ±¯¨±ª  ­  ª ¦¤®¬ ¸ £¥. °¨ ±®ª° ¹¥­¨¨ ®±² ¾¹¥¥±¿ ·¨±«® ¡³¤¥² ¬¥­¼¸¥ ¢»·¥°ª­³²®£®, ­® ­¥ ­ ¬­®£®: ­¥ ¡®«¥¥ ·¥¬ ­  ("=n)-³¾ ¤®«¾. °³£¨¬¨
±«®¢ ¬¨, ®±² ¾¹¨©±¿ ½«¥¬¥­² ­¥ ¬¥­¼¸¥ ¢»·¥°ª­³²®£®, ³¬­®¦¥­­®£® ­  (1 ; "=n).  ±±³¦¤ ¿ ¯® ¨­¤³ª¶¨¨, «¥£ª® ¢¨¤¥²¼, ·²® ¤«¿
¢±¿ª®£® ½«¥¬¥­²  y ¬­®¦¥±²¢  Pi , ­¥ ¯°¥¢®±µ®¤¿¹¥£® t, ¬®¦­® ³ª § ²¼ ½«¥¬¥­² z ¢ ±¯¨±ª¥ Li , ¤«¿ ª®²®°®£®
(1 ; "=n)i y 6 z 6 y:
 · ±²­®±²¨, ¯°¨ i = n ¬®¦­® ¢§¿²¼ ¢ ª ·¥±²¢¥ y ®¯²¨¬ «¼­®¥ °¥¸¥­¨¥ § ¤ ·¨ ® ±³¬¬¥ ¯®¤¬­®¦¥±²¢  ¨ ³¡¥¤¨²¼±¿, ·²® ±³¹¥±²¢³¥²
z 2 Ln, ¤«¿ ª®²®°®£®
(1 ; "=n)n y 6 z 6 y

 ¤ ·  ® ±³¬¬¥ ¯®¤¬­®¦¥±²¢ 

873

²¥¬ ± ¬»¬ ®²¢¥²  «£®°¨²¬  (ª®²®°»© § ¢¥¤®¬® ­¥ ¬¥­¼¸¥ ½²®£®
z) ¡³¤¥² ­¥ ¬¥­¼¸¥ (1 ; "=n)ny .  ¬ ®±² «®±²¼ ²®«¼ª® ³¡¥¤¨²¼±¿,
·²® (1 ; "=n)n > (1 ; ").
 ± ®¬ ¤¥«¥, ¯°®¤¨´´¥°¥¶¨°®¢ ¢ (1 ; "=u)u ¯® u, ³¡¥¦¤ ¥¬±¿, ·²®
½²® ¢»° ¦¥­¨¥ ¢®§° ±² ¥² ª ª ´³­ª¶¨¿ ®² u; ®±² ¾²±¿ ±° ¢­¨²¼
¥£® §­ ·¥­¨¿ ¯°¨ u = 1 ¨ u = n.
[²® «¥£ª® ¯®­¿²¼ ¨ ¡¥§ ¯°®¨§¢®¤­»µ: ¢ ³¡»¢ ¾¹¥© ¯®±«¥¤®¢ «¼­®±²¨
1; (1 ;  ); (1 ;  )2 ; : : : ; (1 ;  )n
¢²®°®© ·«¥­ ¬¥­¼¸¥ ¯¥°¢®£® (­   ), ²°¥²¨© ·«¥­ ¬¥­¼¸¥ ¢²®°®£®
¨ ².¯.  §­®±²¨ ¬¥¦¤³ ±®±¥¤­¨¬¨ ·«¥­ ¬¨ ³¡»¢ ¾², ² ª ª ª ±®±² ¢«¿¾² ´¨ª±¨°®¢ ­­³¾ ¤®«¾ ®² ³¬¥­¼¸ ¥¬®£®. ®½²®¬³ ®¡¹¥¥
¨§¬¥­¥­¨¥ ¯°¨ ¯¥°¥µ®¤¥ ®² ¯¥°¢®£® ·«¥­  ª ¯®±«¥¤­¥¬³ ­¥ ¯°¥¢®±µ®¤¨² n ¨ (1 ;  )n > 1 ; n . ±² ¥²±¿ ¯®«®¦¨²¼  = "=n.]
¥¯¥°¼ ®¶¥­¨¬ ¢°¥¬¿ ° ¡®²» ­ ¸¥£®  «£®°¨²¬ , ¤«¿ ·¥£® ­ ¤®
®¶¥­¨²¼ ¤«¨­³ ±¯¨±ª®¢ Li . ®±«¥ ±®ª° ¹¥­¨¿ ±¯¨±ª  ±®±¥¤­¨¥ ¥£®
½«¥¬¥­²» ®²«¨· ¾²±¿ ª ª ¬¨­¨¬³¬ ¢ 1=(1 ; "=n) ° §. °¨ ½²®¬
¬ ª±¨¬ «¼­»© ®±² ¢«¿¥¬»© ¢ ±¯¨±ª¥ ½«¥¬¥­² ­¥ ¯°¥¢®±µ®¤¨² t,  
¢²®°®© ½«¥¬¥­² (¯¥°¢»© ° ¢¥­ ­³«¾) ­¥ ¬¥­¼¸¥ 1. ²±¾¤  ¢¨¤­®,
·²® ·¨±«® ½«¥¬¥­²®¢ ¢ ±¯¨±ª¥ ­¥ ¡®«¼¸¥
log1=(1;"=n) t + 2 = ln(1 ln; t"=n) + 2 6
6 n log t + 2:

"

(» ¨±¯®«¼§®¢ «¨ ­¥° ¢¥­±²¢® (2.10) ­  ¯®±«¥¤­¥¬ ¸ £¥.) ² 
®¶¥­ª  ¯®«¨­®¬¨ «¼­ , ² ª ª ª lg t ¯°¨¬¥°­® ° ¢­® ·¨±«³ ¡¨²®¢
¢ § ¯¨±¨ ·¨±«  t. ±² «®±¼ § ¬¥²¨²¼, ·²® ¢°¥¬¿ ° ¡®²»  «£®°¨²¬ 
Approx-Subset-Sum ®£° ­¨·¨¢ ¥²±¿ ¯®«¨­®¬®¬ ®² n ¨ ®² ¤«¨­»
±¯¨±ª®¢ Li .
¯° ¦­¥­¨¿
37.4-1 ®ª ¦¨²¥ ° ¢¥­±²¢® (37.11).
37.4-2 ®ª ¦¨²¥ ­¥° ¢¥­±²¢  (37.12) ¨ (37.13).
37.4-3  ª ±«¥¤³¥² ¨§¬¥­¨²¼ ±µ¥¬³ ¯°¨¡«¨¦¥­¨¿, ®¯¨± ­­³¾ ¢
½²®¬ ° §¤¥«¥, ¥±«¨ ¬» ° ±±¬ ²°¨¢ ¥¬ ¢±¥ ±³¬¬», ±®±² ¢«¥­­»¥ ¨§
½«¥¬¥­²®¢ § ¤ ­­®£® ±¯¨±ª , ­¥ ¬¥­¼¸¨¥ § ¤ ­­®£® ·¨±«  t, ¨ µ®²¨¬ ­ ©²¨ ¬¨­¨¬ «¼­³¾ ¨§ ­¨µ (± § ¤ ­­®© ®²­®±¨²¥«¼­®© ®¸¨¡ª®©)?
 ¤ ·¨
37-1 ¯ ª®¢ª  ¢ ¿§¨ª¨ ¬¥¥²±¿ n ®¡º¥ª²®¢, ¯°¨·¥¬ i-»© ®¡º¥ª²
¨¬¥¥² ° §¬¥° si , £¤¥ 0 < si < 1. » µ®²¨¬ ³¯ ª®¢ ²¼ ¨µ ¢ ¬¨­¨¬ «¼­®¥ ·¨±«® ¿¹¨ª®¢ ¥¤¨­¨·­®£® ° §¬¥°  (ª ¦¤»© ¨§ ª®²®°»µ
¬®¦¥² ¢¬¥±²¨²¼ «¾¡®¥ ·¨±«® ®¡º¥ª²®¢, ±³¬¬ °­»© ° §¬¥° ª®²®°»µ ­¥ ¯°¥¢®±µ®¤¨² 1).

874

« ¢  37 °¨¡«¨¦¥­­»¥  «£®°¨²¬»

a. ®ª §¨²¥, ·²® § ¤ ·  ­ µ®¦¤¥­¨¿ ¬¨­¨¬ «¼­® ­¥®¡µ®¤¨¬®£®
·¨±«  ¿¹¨ª®¢ ¿¢«¿¥²±¿ NP-²°³¤­®©. (ª § ­¨¥. ¢¥¤¨²¥ ª ­¥© § ¤ ·³ ® ±³¬¬¥ ¯®¤¬­®¦¥±²¢ .)
P
b. ³±²¼ S ! ni=1 si | ±³¬¬ °­»© ° §¬¥° ¢±¥µ ¯°¥¤¬¥²®¢. ®ª ¦¨²¥, ·²® ­¥®¡µ®¤¨¬® ¯® ª° ©­¥© ¬¥°¥ dS e ¿¹¨ª®¢.
¢°¨±²¨ª  ¯¥°¢®£® ¯®¤µ®¤¿¹¥£® ¯°¥¤« £ ¥² ° ±±¬ ²°¨¢ ²¼ ¢±¥
¯°¥¤¬¥²» ¯® ®·¥°¥¤¨ ¨ ¯®¬¥¹ ²¼ ¨µ ¢ ¯¥°¢»© (¢ ­¥ª®²®°®¬ ¯®°¿¤ª¥) ¿¹¨ª, ¢ ª®²®°»© ®­¨ ¥¹¥ ¯®¬¥¹ ¾²±¿.
c. ®ª ¦¨²¥, ·²® ¯°¨ ² ª®¬ ¯®¤µ®¤¥ ­¥ ¡®«¥¥ ·¥¬ ®¤¨­ ¿¹¨ª
¡³¤¥² § ¯®«­¥­ ¬¥­¥¥ ·¥¬ ­ ¯®«®¢¨­³.
d. ®ª ¦¨²¥, ·²® ¨±«® ¨±¯®«¼§®¢ ­­»µ ¿¹¨ª®¢ ¯°¨ ½²®¬ ¡³¤¥²
­¥ ¡®«¥¥ d2S e.
e. ®ª ¦¨²¥, ·²® ½²  ½¢°¨±²¨ª  ¤ ¥² °¥¸¥­¨¥, ­¥ ¡®«¥¥ ·¥¬ ¢ 2
° §  µ³¤¸¥¥ ®¯²¨¬ «¼­®£®.
f. °¨¤³¬ ²¼ ½´´¥ª²¨¢­³¾ °¥ «¨§ ¶¨¾ ½²®£® ¯®¤µ®¤ , ¨ ®¶¥­¨²¼ ¢°¥¬¿ ° ¡®²» ¯®«³·¨¢¸¥£®±¿  «£®°¨²¬ .
37-2  §¬¥° ¬ ª±¨¬ «¼­®© ª«¨­¨ ¨ ¯°¨¡«¨¦¥­­»¥  «£®°¨²¬»
³±²¼ G = (V; E ) | ­¥®°¨¥­²¨°®¢ ­­»© £° ´. ¯°¥¤¥«¨¬ ¥£®
k-³¾ ±²¥¯¥­¼ G(k) ª ª ­¥®°¨¥­²¨°®¢ ­­»© £° ´ (V (k); E (k)), ¢¥°¸¨­ ¬¨ ª®²®°®£® ¿¢«¿¾²±¿ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¨§ k ½«¥¬¥­²®¢ V ,
¯°¨·¥¬ ¤¢¥ ¢¥°¸¨­» (v1 ; v2; : : : ; vk ) ¨ (w1; w2; : : : ; wk ) ±®¥¤¨­¥­»
°¥¡°®¬ ¢ ²®¬ ¨ ²®«¼ª® ²®¬ ±«³· ¥, ¥±«¨ ¯°¨ «¾¡®¬ i ¢¥°¸¨­» vi ¨
wi ±®¥¤¨­¥­» °¥¡°®¬ ¢ V ¨«¨ ±®¢¯ ¤ ¾².
a. ®ª ¦¨²¥, ·²® ° §¬¥° ¬ ª±¨¬ «¼­®© ª«¨ª¨ ¢ £° ´¥ G(k) ¿¢«¿¥²±¿ k-®© ±²¥¯¥­¼¾ ° §¬¥°  ¬ ª±¨¬ «¼­®© ª«¨ª¨ ¢ £° ´¥ G.
b. ®ª ¦¨²¥, ·²® ¥±«¨ ¡» ¤«¿ § ¤ ·¨ ® ª«¨ª¥ ±³¹¥±²¢®¢ « ¯°¨¡«¨¦¥­­»©  «£®°¨²¬ ± ®¸¨¡ª®© ­¥ ¡®«¥¥ ¢ C ° § (¤«¿ ­¥ª®²®°®£®
´¨ª±¨°®¢ ­­®£® C ), ²® ¤«¿ ½²®© § ¤ ·¨ ±³¹¥±²¢®¢ «  ¡» ¯®«­®±²¼¾ ¯®«¨­®¬¨ «¼­ ¿ ±µ¥¬  ¯°¨¡«¨¦¥­¨¿.
[ ª ³±² ­®¢«¥­® ¢ ° ¡®²¥ S. Arora and S. Safra, Approximating
clique is NP-complete, in Proc. of the 33rd IEEE Symp. on Foundation
of Computer Science, 1992, ² ª®¥ ¢®§¬®¦­®, «¨¸¼ ¥±«¨ P=NP. ²®²
°¥§³«¼² ² (¨ °®¤±²¢¥­­»¥ ¥¬³) ¿¢«¿¥²±¿ ®¤­¨¬ ¨§ ± ¬»µ § ¬¥· ²¥«¼­»µ ¤®±²¨¦¥­¨© ¢ ²¥®°¨¨ ±«®¦­®±²¨ ¢»·¨±«¥­¨© §  ¯®±«¥¤­¥¥
¤¥±¿²¨«¥²¨¥.]
37-3  ¤ ·  ® ¯®ª°»²¨¨ ¬­®¦¥±²¢ ¬¨ ± ¢¥± ¬¨
 ±±¬®²°¨¬ ®¡®¹¥­¨¥ § ¤ ·¨ ¢ ¯®ª°»²¨¨ ¬­®¦¥±²¢ ¬¨, ¢ ª®²®°®¬ ª ¦¤®¬³ ¬­®¦¥±²¢³ ¨§ ±¥¬¥©±²¢  F ¯°¨¯¨± ­ ­¥ª®²®°»© ¢¥±.
°¨ ½²®¬ ¢¥±®¬ ¯®ª°»²¨¿ ±·¨² ¥²±¿ ±³¬¬ °­»© ¢¥± ¢µ®¤¿¹¨µ ¢
­¥£® ¬­®¦¥±²¢, ¨ ¬» µ®²¨¬ ­ ©²¨ ¯®ª°»²¨¥ ­ ¨¬¥­¼¸¥£® ¢¥± .
®ª ¦¨²¥, ·²® ¨¬¥¥²±¿ ¥±²¥±²¢¥­­®¥ ®¡®¡¹¥­¨¥ ° ±±¬®²°¥­­®£®
­ ¬¨ ¦ ¤­®£®  «£®°¨²¬ , ª®²®°®¥ ¯®§¢®«¿¥² °¥¸¨²¼ ½²³ § ¤ ·³ ±
®¸¨¡ª®© ­¥ ¡®«¥¥ ·¥¬ ¢ H (d) ° §, £¤¥ d | ¬ ª±¨¬ «¼­»© ° §¬¥°
¬­®¦¥±²¢ ¯®ª°»²¨¿.
 ¬¥· ­¨¿
¨²¥° ²³° , ¯®±¢¿¹¥­­ ¿ ¯°¨¡«¨¦¥­­»¬  «£®°¨²¬ ¬, ®¡¸¨°­ ;

 ¤ ·  ® ±³¬¬¥ ¯®¤¬­®¦¥±²¢ 

875

¤«¿ ­ · «  ¬®¦­® ¯°®·¥±²¼ ª­¨£³ ½°¨ ¨ ¦®­±®­  [79]. °³£®¥
¯°¥¢®±µ®¤­®¥ ¢¢¥¤¥­¨¥ ¢ ¯°¥¤¬¥² |  ¯ ¤¨¬¨²°¨³ ¨ ² ©£«¨¶
[154]. ®³«¥°, ¥­±²° , ¨­­®©- ­ ¨ ¬®©± [133] ¯®¤°®¡­® ° ±±¬ ²°¨¢ ¾² § ¤ ·³ ® ª®¬¬¨¢®¿¦¥°¥.
®£« ±­®  ¯ ¤¨¬¨²°¨³ ¨ ² £«¨¶³,  «£®°¨²¬ ApproxVertex-Cover ¡»« ¯°¥¤«®¦¥­  ¢°¨«®¬ (F. Gavril) ¨ ­­ ª ª¨±®¬ (M. Yannakakis). «£®°¨²¬ Approx-TSP-Tour ¯°¨¢®¤¨²±¿
¢ § ¬¥· ²¥«¼­®© ° ¡®²¥ ®§¥­ª° ­¶ , ²¨°­  ¨ ¼¾¨±  [170].
¥®°¥¬  37.3 § ¨¬±²¢®¢ ­  ¨§ ° ¡®²»  µ­¨ ¨ ®­± «¥±  [172].
­ «¨§ ¦ ¤­®© ½¢°¨±²¨ª¨ ¤«¿ § ¤ ·¨ ® ¯®ª°»²¨¨ ¬­®¦¥±²¢ ¬¨
¯°¥¤±² ¢«¿¥² ±®¡®© ³¯°®¹¥­­»© ¢ °¨ ­² ¡®«¥¥ ®¡¹¨µ ° ±±³¦¤¥­¨© ¨§ ° ¡®²» ¢ ² «  [42]; ± ¬® ³²¢¥°¦¤¥­¨¥ ¨¬¥¥²±¿ ¢ ° ¡®² µ
¦®­±®­  [113] ¨ ®¢ ±  [141]. «£®°¨²¬ Approx-Subset-Sum ¨
¥£®  ­ «¨§ °®¤±²¢¥­­»  «£®°¨²¬ ¬ ¤«¿ § ¤ ·¨ ® °¾ª§ ª¥ ¨ ±³¬¬¥
¯®¤¬­®¦¥±²¢ , ° ±±¬®²°¥­­»¬ ¢ ° ¡®²¥ ¡ °°» ¨ ¨¬  [111].

°¥¤¬¥²­»© ³ª § ²¥«¼

k-±²°®ª , 101
k-³­¨¢¥°± «¼­®¥

0-1 knapsack problem, 336
Cnk , 103
O-notation, 32
O-®¡®§­ ·¥­¨¥, 32

-notation, 32

-®¡®§­ ·¥­¨¥, 32
-notation, 30
-®¡®§­ ·¥­¨¥,
30
;n
,
103
k
\, 76
[, 76
2, 75
N, 75
R, 75
Z
, 75
!-notation, 33
!-®¡®§­ ·¥­¨¥, 33
n, 76
, 76
, 76
?, 75
d-ary heap, 151
d-¨·­ ¿ ª³· , 151
k-ary tree, 96
k-coloring, 97
k-combination, 102
k-permutation, 102
k-string, 101
k-subset, 78
k-substring, 101
k-universal hashing, 244
k-¨·­®¥ ¤¥°¥¢®, 96
k-¯®¤±²°®ª , 101
k-° ±ª° ±ª , 97

µ¥¸¨°®¢ ­¨¥, 244
n-ary relation, 80
n-set, 78
n-¬¥±²­®¥ ®²­®¸¥­¨¥, 80
o-notation, 33
o-®¡®§­ ·¥­¨¥, 33
Delete, 198, 246
Insert, 198, 246
Maximum, 198, 246
Minimum, 198, 246
Persistent-Tree-Insert,
281
Predecessor, 198, 246
RB-Enumerate, 291
Randomized-Quicksort, 260
Random, 159
Search, 198, 246
Successor, 198, 246
nil, 14
nil, 95
À° §¤¥«¿© ¨ ¢« ±²¢³©Á ¬¥²®¤,
312
absorption laws, 77
activity-selection problem, 332
acyclic subgraph, 354
adjacent vertex, 87
algorithm, 11
algorithm/correctness of, 12
algorithm/greedy, 331
algorithm/randomized, 159
ancestor, 93
ancestor/proper, 93
876

 

antisymmetric relation, 81
argument, 83, 84
arithmetic series, 44
associative laws, 76
asymptotic eciency, 30
asymptotic notation, 30
asymptotically
nonnegative
function, 31
asymptotically tight bound, 31
attribute of an object, 14
average-case running time, 18
axioms of probability, 106
balanced tree, 266
balls, 129
Bayes's theorem, 110
Bernoulli trials, 117
bijection, 84
binary character code, 338
binary entropy, 104
binary heap, 140
binary relation, 80
binary search, 23
binary search tree, 247
binary tree, 95, 214
binary-search-tree property, 247
binomial coecients, 103
binomial distribution, 118
binomial expansion, 103
bins, 129
bipartite graph, 90
birthday paradox, 127
bit vector, 223
bitonic tour, 326
black-height, 267
Boole's inequality, 111
boolean function, 104
bound/asymptotically tight, 31
boundary, 321
bucket, 178
bucket sort, 138, 178
Build-Heap0 , 151
Build-Heap0 Build-Heap0 [],
151
calling the subroutine, 16

877

canonical form, 352
cardinality, 78
Cartesian product, 79
Catalan number, 263
Catalan numbers, 306
ceiling, 35
certain event, 106
chaining, 224
child, 94
chord, 322
circular list, 205
closed interval, 292
code/Humen, 341
codeword, 338
codomain of a function, 83
coecient, 35
coin, 108
coin changing, 354
collision, 224
coloring, 97
common subsequence, 316
common subsequence/longest,
316
commutative laws, 76
comparison sort, 170
compatible activities, 331
complement, 77
complete k-ary tree, 96
complete graph, 90
computational problem, 11, 12
conditional probability, 109
conditionally
independent
events, 111
connected component, 88
connected graph, 88
continuous uniform probability
distribution, 108
contraction, 349
convex polygon, 321
correctness of an algorithm, 12
cost, 340
countably innite set, 78
counting, 100
counting sort, 138, 173
counting/probabilistic, 133
cycle, 87

878

 

cycle/simple, 88
dag, 90
data, 137
de Morgan's laws, 77
deadline, 351
decision trees, 170
degree, 35, 94
depth, 94
deque, 204
descendant, 93
descendant/proper, 93
deviation, 116
dictionary, 197
dierence, 76
digraph, 86
direact addressing, 221
direct addressing, 221
directed graph, 86
directed version (of an undirected graph), 89
discrete probability distribution, 107
discrete random variable, 112
disjoint sets, 77
distribution/binomial, 118
distribution/geometric, 117
distributive laws, 77
divide-and-conquer approach,
19
division m¥thod, 230
domain of a function, 83
double hashing, 238
doubly linked list, 205
dynamic order statistics, 284
dynamic programming, 303
dynamic set, 197
early task, 351
edge, 86
edit distance, 328
element, 75
elementary event, 106
empty binary tree, 95
empty set, 75, 76
empty stack, 202

endpoint, 292
entropy/Shannon, 104
equal functions, 83
equal sets, 75
equivalence class, 81
equivalence relation, 81
euclidian travelling-salesman
problem, 326
Euler's constant, 242
event, 106
event-driven simulation, 149
events/conditionally independent, 111
events/independent, 109
events/mutually independent,
109
events/pairwise independent,
109
exchange property, 346
executing the subroutine, 16
expectation, 113
expected value, 113
expexted running time, 18
exponential, 36
exponential series, 44
extension, 347
exterior, 321
external node, 94
external path length, 97
factorial, 38
failure, 117
fair coin, 108
father, 94
Fibonacci numbers, 39, 71
eld of an object, 14
FIFO, 201
nite sequence, 83
nite set, 78
xed-length code, 338
ipping a fair coin, 108
oor, 35
forest, 90, 91
formal power series, 71
fractional knapsack problem,
336

 

free list, 212
free tree, 90, 91
function, 83
function/boolean, 104
function/generating, 71
function/inverse, 85
function/linear, 17
function/monotonically
decreasing (increasing),
34
function/polylogarithmically
bounded, 37
function/polynomially bounded, 36
function/quadratic, 17
function/strictly decreasing (increasing), 34
garbage collector, 211
generating function, 71
geometric distribution, 117
geometric series, 44
golden ratio, 39
graph/bipartite, 90
graph/complete, 90
graph/connected, 88
graph/directed, 86
graph/isomorphic, 88
graph/simple directed, 88
graph/strongly connected, 88
graph/undirected, 86
graphic matroid, 346
greedoid, 356
greedy algorithm, 331
greedy-choice property, 335
handshaking lemma, 90
harmonic series, 45
hash function, 221, 224
hash table, 221, 224
hash value, 224
hashing/simple uniform, 226
head (of a list), 205
head (of a queue), 203
heap property, 141
heap/d-ary, 151

879

heap/binary, 138, 140
heapsort, 138, 140, 147
height, 141
height of a tree, 94
hereditary family, 346
high endpoint, 292
hyperedge, 90
hypergraph, 90
idempotency laws, 76
image, 84
in-degree, 87
incidence matrix, 354, 355
incident from, 87
incident on, 87
incident to, 87
incremental approach, 19
independent events, 109
independent random variables,
113
independent subset, 346, 352
induced subgraph, 89
inequality/Boole's, 111
inequality/Markov's, 116
innite sequence, 83
innite set, 78
injection, 84
inorder tree walk, 247
input, 11
input size, 16
insertion sort, 12
Insertion-Sort, 16
instance, 11
integers, 75
interior, 321
internal node, 94
internal path length, 97
intersection, 76
interval tree, 292
interval-graph coloring problem, 334
interval/closed, 292
interval/half-closed, 292
interval/open, 292
inverse function, 85
inversions, 25

880

 

isomorphic graphs, 88
iterated logarithm, 38
iteration method, 53
join, 282
joint probability density function, 113
Josephus permutation, 298
key, 137, 148, 197
knapsack problem, 336
Kraft inequality, 97
late task, 351
LCS (longest common subsequence), 316
leaf, 94
left child, 95
left subtree, 95
left-child, right-sibling representation, 215
length, 87
lexicographically less, 261
LIFO, 201
linear function, 17
linear order, 82
linear probing, 237
linear programming, 329
linear search, 15
linked list, 205
List-Delete0 , 207
List-Delete0 List-Delete0 [],
207
List-Insert0 , 208
List-Insert0 List-Insert0 [], 208
List-Search0 , 208
List-Search0 List-Search0[],
208
list/circular, 205
list/doubly linked, 205
list/linked, 205
list/singly linked, 205
list/sorted, 205
logarithm, 37
logarithm/iterated, 38
longest common subsequence,
316

low endpoint, 292
Markov's inequality, 116
master theorem, 53, 61
matric matroid, 346
matrix-chain
multiplication
problem, 305
matroid, 346
maximal element, 82
maximum, 184
maximum overlap, 297
mean, 113
median, 184
median-of-3 method, 169
member, 75
memoization, 314
merge, 20
merge sort, 20
mergeable heaps, 218
minimum, 184
minimum spanning tree, 348
modifying operation, 198
monotonically decreasing (increasing) function, 34
multigraph, 90
multiplication method, 231
mutually exclusive events, 106
mutually independent events,
109
natural number, 75
neighbor, 89
node, 93
node/external, 94
node/internal, 94
null event, 106
objects, 14
one-to-one correspondence, 85
one-to-one function, 84
open addressing, 235
optimal subset, 348
optimal substructure, 311, 335
optimal tiangulation problem,
322
optimization problem, 303
order of growth, 18

 

order statistic, 184
order statistics, 139
order-statistic tree, 284
ordered pair, 78
ordered tree, 95
out-degree, 87
output, 11
overow, 202
overlapping segments, 292
overlapping subproblems, 312
pair/ordered, 78
pair/unordered, 86
pairwise disjoint sets, 78
pairwise independent events,
109
paragraph, 326
parameters, 14
parent, 94
partial order, 81
partially ordered set, 81
partition, 77
Pascal triangle, 105
path, 87
path/simple, 87
penalty, 351
permutation, 85, 101
persistent data structure, 281
point/of maximum overlap, 297
polygon, 321
polylogarithmically bounded
function, 37
polynomially bounded function,
36
position, 221
positional tree, 96
post-oce location problem,
193
postorder tree walk, 248
power set, 78
pres code, 339
prex, 317
preorder tree walk, 248
primary clustering, 237
principle of inclusion and exclusion, 80

881

priority queue, 148
probabilistic counting, 133
probability axioms, 106
probability density function,
112
probability distribution, 106
probability distribution function, 180
probability theory, 100
probability/conditional, 109
probe sequnce, 235
problem/computational, 11, 12
problem/solution to, 12
product, 46
proper ancestor, 93
proper descendant, 93
proper subset, 76
pseudocode, 12, 14
pseudorandom-number generator, 159
quadratic function, 17
quadratic probing, 238
quantiles, 191
query, 198
queue, 201, 203
queue/priority, 148
quicksort, 138, 152
Quicksort0 , 168
Quicksort0 Quicksort0[], 168
radix sort, 138, 175
radix trees, 261
RAM, 15
random variable/discrete, 112
random-access machine, 15
random-number generator, 159
randomized algorithm, 159
randomly built seacrh tree, 256
range, 84
rank, 162, 286
rate of growth, 18
RB-±¢®©±²¢ , 266
reachable vertex, 87
real number, 75
record, 137

882

 

recurrence, 53
recurrence equation, 21
recursive algorithm, 20
red-black properties, 266
red-black tree, 266
reexive relation, 80
reexivity, 33
relation/n-ary, 80
relation/binary, 80
resursion tree, 58
right child, 95
right subtree, 95
root of a tree, 93
root/of a binary tree, 95
rooted tree, 93, 214
rotation, 269
rule of product, 101
rule of sum, 100
running time, 16
running time/average-case, 18
running time/expexted, 18
running time/worst-case, 18
sample space, 106
satellite data, 137, 197
schedule, 351
scheduling problem, 351
search tree, 246
search tree/randomly built, 256
search/binary, 23
searching problem, 15
searching/linear search, 15
secondary clustering, 238
selection problem, 184
selection sort, 19
self-loop, 86
sentinel, 207, 275
sequence/nite, 83
sequence/innite, 83
series, 43
series/absolutely convergent, 44
series/arithmetic, 44
series/convergent, 44
series/divergent, 44
series/exponential, 44
series/geometric, 44

series/harmonic, 45
series/telescoping, 45
set, 75
set operations, 76
set/countably innite, 78
set/dynamic, 197
set/empty, 75, 76
set/nite, 78
set/innite, 78
set/of integers, 75
set/of natural numbers, 75
set/of real numbers, 75
set/partially ordered, 81
set/uncountable, 78
Shannon entropy, 104
side, 321
simple cycle, 88
simple directed graph, 88
simple path, 87
simple polygon, 321
simple uniform hashing, 226
simulation/event-driven, 149
singleton, 78
singly linked list, 205
size, 78
slot, 221
soblings, 94
solution/to a computational
problem, 12
son, 94
sorted list, 205
sorting problem, 11, 137
sorting/in place, 12, 138
spanning tree, 347
splay tree, 283
stable sort, 174
stack, 201
stack/depth, 168
standard deviation, 116
Stirling's approximation, 38
strictly decreasing (increasing)
function, 34
string, 101
strongly connected graph, 88
subgraph, 89
subpath, 87

 

subsequence, 316
subsequence/common, 316
subsequence/longest common,
316
subset of a set, 76
substitution method, 53, 54
substring, 101
subtree/rooted at x, 94
success, 117
summation formulas, 43
surjection, 84
symmetric relation, 80
symmetry, 33
tail (of a list), 205
tail (of a queue), 203
tail recursion, 168
tails of the binomial distribution, 123
task, 351
Taylor expansion, 263
telescoping series, 45
theorem/Bayes's, 110
top, 202
total order, 82
transitive relation, 80
transitivity, 33
travelling-salesman problem,
326
tree, 90
tree/k-ary, 96
tree/balanced, 266
tree/binary, 95, 214
tree/complete k-ary, 96
tree/free, 90, 91
tree/order-statistic, 284
tree/ordered, 95
tree/positional, 96
tree/radix, 261
tree/red-black, 266
tree/rooted, 93, 214
triangulation, 322
uncountable set, 78
underow, 202
undirected graph, 86

883

undirected version (of a directed graph), 89
uniform hashing, 236
uniform probability distribution, 108
union, 76
universal hashing, 232
universe, 77
unordered pair, 86
value, 83
variable-length code, 338
variance, 115
vertex, 86, 321
vertex/adjacent to u, 87
vertex/reachable, 87
Viterbi algorithm, 328
weighted matroid, 347
weighted median, 193
worst-case running time, 18
x¢®±² ®·¥°¥¤¨, 203
 ¡§ ¶, ° §¡¨¥­¨¥ ­  ±²°®ª¨,
326
 ¡±®«¾²­® ±µ®¤¿¹¨©±¿ °¿¤, 44
 ª±¨®¬» ¢¥°®¿²­®±²¨, 106
 «£®°¨²¬, 11
 «£®°¨²¬/¢¥°®¿²­®±²­»©,
159
 «£®°¨²¬/¦ ¤­»©, 331
 «£®°¨²¬/¯° ¢¨«¼­»©, 12
 «£®°¨²¬/°¥ª³°±¨¢­»©, 20
 «´ ¢¨², 101
 ­²¨±¨¬¬¥²°¨·­®¥ ®²­®¸¥­¨¥, 81
 °£³¬¥­² ´³­ª¶¨¨, 83, 84
 °¨´¬¥²¨·¥±ª ¿ ¯°®£°¥±±¨¿,
44
 ±¨¬¯²®²¨ª , 30
 ±¨¬¯²®²¨·¥±ª¨ ­¥®²°¨¶ ²¥«¼­ ¿ ´³­ª¶¨¿, 31
 ±¨¬¯²®²¨·¥±ª¨ ¯®«®¦¨²¥«¼­ ¿ ´³­ª¶¨¿, 36
 ±¨¬¯²®²¨·¥±ª¨ ²®·­ ¿ ®¶¥­ª , 31

884

 

 ±±®¶¨ ²¨¢­®±²¼, 76
 ²°¨¡³² ®¡º¥ª² , 14
 ¶¨ª«¨·­»© ¯®¤£° ´, 354
 ©¥±  ´®°¬³« , 110
¥°­³««¨ ±µ¥¬ , 117
¡¥±ª®­¥·­ ¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼, 83
¡¥±ª®­¥·­®¥ ¬­®¦¥±²¢®, 78
¡¨¥ª¶¨¿, 84
¡¨­ °­®¥ ®²­®¸¥­¨¥, 80
¡¨­®¬ ¼¾²®­ , 103
¡¨­®¬¨ «¼­®¥ ° ±¯°¥¤¥«¥­¨¥,
118, 123
¡¨­®¬¨ «¼­»¥ ª®½´´¨¶¨¥­²», 103
¡¨²®¢»© ¢¥ª²®°, 223
¡¨²®­¨·¥±ª¨© ¯³²¼, 326
¡° ²¼¿, 94
¡³«¥¢  ´³­ª¶¨¿, 104
³«¿/­¥° ¢¥­±²¢®, 111
¡»±²° ¿ ±®°²¨°®¢ª , 138, 152
¢¥ª²®°/¡¨²®¢, 223
¢¥°®¿²­®±²¥© ° ±¯°¥¤¥«¥­¨¥,
106
¢¥°®¿²­®±²¥©/²¥®°¨¿, 100
¢¥°®¿²­®±²­®¥ ¯°®±²° ­±²¢®,
106
¢¥°®¿²­®±²­»©  «£®°¨²¬, 159
¢¥°®¿²­®±²­»© ±·¥²·¨ª, 133
¢¥°®¿²­®±²¼ ±®¡»²¨¿, 107
¢¥°®¿²­®±²¼/³±«®¢­ ¿, 109
¢¥°±¨¨, ±®µ° ­¥­¨¥ ¯°¥¦­¨µ,
281
¢¥°¸¨­  £° ´ , 86
¢¥°¸¨­  ¬­®£®³£®«¼­¨ª , 321
¢¥°¸¨­  ±²¥ª , 202
¢¥°¸¨­ /¢­³²°¥­­¿¿, 94
¢¥°¸¨­ /¤®±²¨¦¨¬ ¿, 87
¢¥°¸¨­ /±¬¥¦­ ¿, 87
¢¥°¸¨­ /±®±¥¤­¿¿, 89
¢¥¹¥±²¢¥­­»µ ·¨±¥« ¬­®¦¥±²¢®, 75
¢§ ¨¬­® ®¤­®§­ ·­®¥ ±®®²¢¥²±²¢¨¥, 85

¢§¢¥¸¥­­ ¿ ¬¥¤¨ ­ , 193
¢§¢¥¸¥­­»© ¬ ²°®¨¤, 347
¨²¥°¡¨  «£®°¨²¬, 328
¢ª«¾·¥­¨© ¨ ¨±ª«¾·¥­¨©
´®°¬³« , 80
¢«®¦¥­¨¥, 84
¢­¥¸­®±²¼ ¬­®£®³£®«¼­¨ª ,
321
¢­¥¸­¿¿ ±³¬¬  ¤«¨­, 97
¢­³²°¥­­®±²¼ ¬­®£®³£®«¼­¨ª , 321
¢­³²°¥­­¿¿ ¢¥°¸¨­ , 94
¢­³²°¥­­¿¿ ±³¬¬  ¤«¨­, 97
¢° ¹¥­¨¥, 269
¢°¥¬¿ ° ¡®²»  «£®°¨²¬ , 16
¢°¥¬¿ ° ¡®²»/¢ µ³¤¸¥¬ ±«³· ¥, 18
¢°¥¬¿ ° ¡®²»/±°¥¤­¥¥, 18
¢µ®¤  «£®°¨²¬ , 11
¢µ®¤/§ ¤ ·¨ ±®°²¨°®¢ª¨, 11
¢µ®¤/° §¬¥°, 16
¢µ®¤¿¹ ¿ ±²¥¯¥­¼, 87
¢µ®¤¿¹¥¥ ¢ ¢¥°¸¨­³ °¥¡°®, 87
¢»§®¢ ¯°®¶¥¤³°», 16
¢»¯®«­¥­¨¥ ¯°®¶¥¤³°», 16
¢»¯®«­¥­­»© ¢ ±°®ª § ª §,
351
¢»¯³ª«»© ¬­®£®³£®«¼­¨ª,
321
¢»±®²  ¢¥°¸¨­», 141
¢»±®²  ¤¥°¥¢ , 94
¢»±®² /·¥°­ ¿, 267
¢»µ®¤¿¹¥¥ ¨§ ¢¥°¸¨­» °¥¡°®,
87
¢»·¥°¯»¢ ­¨¥, 178
¢»·¨±«¨²¥«¼­ ¿ § ¤ · , 11
¢»·¨±«¨²¥«¼­ ¿
§ ¤ · /°¥¸¥­¨¥, 12
£ °¬®­¨·¥±ª¨© °¿¤, 45
£¥­¥° ²®° ¯±¥¢¤®±«³· ©­»µ
·¨±¥«, 159
£¥­¥° ²®° ±«³· ©­»µ ·¨±¥«,
159
£¥®¬¥²°¨·¥±ª ¿ ¯°®£°¥±±¨¿,
44

 

£¥®¬¥²°¨·¥±ª®¥ ° ±¯°¥¤¥«¥­¨¥, 117
£¨¯¥°£° ´, 90
£¨¯¥°°¥¡°®, 90
£«³¡¨­  ¢¥°¸¨­», 94
£®«®¢  ®·¥°¥¤¨, 203
£®«®¢  ±¯¨±ª , 205
£° ­¨¶  ¬­®£®³£®«¼­¨ª , 321
£° ´/¤¢³¤®«¼­»©, 90
£° ´/¨§®¬®°´­»©, 88
£° ´/¨­²¥°¢ «¼­»©, 334
£° ´/­¥®°¨¥­²¨°®¢ ­­»©, 86
£° ´/®°¨¥­²¨°®¢ ­­»©, 86
£° ´/¯®«­»©, 90
£° ´/¯°®±²®© ®°¨¥­²¨°®¢ ­­»©, 88
£° ´/±¢¿§­»©, 88
£° ´/±¨«¼­® ±¢¿§­»©, 88
£° ´®¢»© ¬ ²°®¨¤, 346
£°¨¤®¨¤, 356
¤ ­­»¥/¤®¯®«­¨²¥«¼­»¥, 137
¤¢®¨·­ ¿ ª³· , 140
¤¢®¨·­®¥ ¤¥°¥¢®, 95
¤¢®¨·­®¥ ¤¥°¥¢®/¯°¥¤±² ¢«¥­¨¥,
214
¤¢®¨·­»© ª®¤, 338
¤¢®¨·­»© ¯®¨±ª, 23
¤¢®©­®¥ µ¥¸¨°®¢ ­¨¥, 238
¤¢³¤®«¼­»© £° ´, 90
¤¢³±²®°®­­¥ ±¢¿§ ­­»© ±¯¨±®ª, 205
¤¥ ®°£ ­  § ª®­, 77
¤¥©±²¢¨²¥«¼­»µ ·¨±¥« ¬­®¦¥±²¢®, 75
¤¥ª, 204
¤¥ª °²®¢  ±²¥¯¥­¼, 79
¤¥ª °²®¢® ¯°®¨§¢¥¤¥­¨¥, 79
¤¥«¥­¨¥ ± ®±² ²ª®¬, 230
¤¥°¥¢®, 90
¤¥°¥¢® ¯°®¬¥¦³²ª®¢, 292
¤¥°¥¢® °¥ª³°±¨¨, 58
¤¥°¥¢®/k-¨·­®¥, 96
¤¥°¥¢®/¡¥§ ¢»¤¥«¥­­®£® ª®°­¿, 91
¤¥°¥¢®/¤¢®¨·­®¥, 95

885

¤¥°¥¢®/¤¢®¨·­®¥, ¯°¥¤±² ¢«¥­¨¥, 214
¤¥°¥¢®/ª®°­¥¢®¥, 93
¤¥°¥¢®/ª®°­¥¢®¥, ¯°¥¤±² ¢«¥­¨¥, 214
¤¥°¥¢®/ª° ±­®-·¥°­®¥, 266
¤¥°¥¢®/®±²®¢­®¥, 347
¤¥°¥¢®/¯®§¨¶¨®­­®¥, 96
¤¥°¥¢®/¯®¨±ª , 199, 246
¤¥°¥¢®/¯®¨±ª  ¤¢®¨·­®¥, ±«³· ©­®¥, 256
¤¥°¥¢®/¯®¨±ª , ¤¢®¨·­®¥, 247
¤¥°¥¢®/¯®ª°»¢ ¾¹¥¥, 347
¤¥°¥¢®/¯®«­®¥ k-¨·­®¥, 96
¤¥°¥¢®/¯®°¿¤ª®¢®¥, 284
¤¥°¥¢®/° ±¸¨°¿¾¹¥¥±¿, 283
¤¥°¥¢®/± ¯®°¿¤ª®¬ ­  ¤¥²¿µ,
95
¤¥°¥¢®/±¡ « ­±¨°®¢ ­­®¥,
199, 266
¤¥°¥¢¼¿/° §°¥¸ ¾¹¨¥, 170
¤¥°¥¢¼¿/¶¨´°®¢»¥, 261
¤¥²±ª ¿ ±·¨² «ª , 298
¤¨ £®­ «¼ ¬­®£®³£®«¼­¨ª ,
322
¤¨­ ¬¨·¥±ª®¥ ¬­®¦¥±²¢®, 197
¤¨­ ¬¨·¥±ª®¥ ¯°®£° ¬¬¨°®¢ ­¨¥, 303
¤¨±ª°¥²­ ¿ ±«³· ©­ ¿ ¢¥«¨·¨­ , 112
¤¨±ª°¥²­®¥ ° ±¯°¥¤¥«¥­¨¥ ¢¥°®¿²­®±²¥©, 107
¤¨±¯¥°±¨¿, 115
¤¨±²°¨¡³²¨¢­®±²¼, 77
¤«¨­  ¯³²¨, 87
¤­¿ °®¦¤¥­¨¿ ¯ ° ¤®ª±, 127
¤®¡ ¢«¥­¨¥, 198
¤®¡ ¢«¥­¨¥ ½«¥¬¥­² , 246
¤®¯®«­¥­¨¥, 77
¤®¯®«­¨²¥«¼­ ¿ ¨­´®°¬ ¶¨¿,
197
¤®¯®«­¨²¥«¼­»¥ ¤ ­­»¥, 137
¤®±²¨¦¨¬ ¿ ¢¥°¸¨­ , 87
¤®±²®¢¥°­®¥ ±®¡»²¨¥, 106
¥¢ª«¨¤®¢  § ¤ ·  ª®¬¬¨¢®-

886

 

¿¦¥° , 326
¦ ¤­»©  «£®°¨²¬, 331
¦ ¤­»© ¢»¡®°, 335
§ ¤ ·  ® °¾ª§ ª¥/¤¨±ª°¥²­ ¿,
336
§ ¤ ·  ® °¾ª§ ª¥/­¥¯°¥°»¢­ ¿,
336
§ ¤ ·  ¯®¨±ª /«¨­¥©­»© ¯®¨±ª, 15
§ ¤ · /¢»¡®°  ½«¥¬¥­²  ±
¤ ­­»¬ ­®¬¥°®¬, 184
§ ¤ · /¢»·¨±«¨²¥«¼­ ¿, 11
§ ¤ · /ª®¬¬¨¢®¿¦¥° , 326
§ ¤ · /® ¢»¡®°¥ § ¿¢®ª, 331
§ ¤ · /® ¢»¡®°¥ ¬¥±²  ¤«¿
¯®·²», 193
§ ¤ · /® ­ ¨¡®«¼¸¥© ®¡¹¥©
¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¨, 316
§ ¤ · /® ­ ¨¬¥­¼¸¥¬ ¯®ª°»¢ ¾¹¥¬ ¤¥°¥¢¥, 348
§ ¤ · /® ° ±ª° ±ª¥ ¨­²¥°¢ «¼­®£® £° ´ , 334
§ ¤ · /® ° ±¯¨± ­¨¨, 351
§ ¤ · /® ±¤ ·¥, 354
§ ¤ · /®¡ ®¯²¨¬ «¼­®© ²°¨ ­£³«¿¶¨¨, 322
§ ¤ · /®¯²¨¬¨§ ¶¨¨, 303
§ ¤ · /¯®¨±ª , 15
§ ¤ · /±®°²¨°®¢ª¨, 11, 137
§ ¤ · /³¬­®¦¥­¨¿ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¬ ²°¨¶,
305
§ ª §, 351
§ ¬¥­» ±¢®©±²¢®, 346
§ ¯¨±¼, 137
§ ¯®¬¨­ ­¨¥ ®²¢¥²®¢ ¢ °¥ª³°±¨¢­®¬  «£®°¨²¬¥,
315
§ ¯°®±, 198
§ ¿¢ª , 331
§­ ·¥­¨¥ ´³­ª¶¨¨, 83
§®«®²®¥ ±¥·¥­¨¥, 39
¨¤¥¬¯®²¥­²­®±²¼, 76

¨§®¬®°´­»¥ £° ´», 88
¨­¢¥°±¨© ·¨±«®, 25
¨­²¥°¢ «, 292
¨­²¥°¢ «¼­»© £° ´, ° ±ª° ±ª , 334
¨­¶¨¤¥­²­®¥ ¢¥°¸¨­¥ °¥¡°®,
87
¨­¶¨¤¥­²­®±²¨ ¬ ²°¨¶ , 354,
355
¨­º¥ª¶¨¿, 84
¨±¯»² ­¨¿ ¯® ±µ¥¬¥ ¥°­³««¨, 117
¨±µ®¤­»¥ ¤ ­­»¥, 11
¨±µ®¤¿¹ ¿ ±²¥¯¥­¼, 87
¨²¥° ¶¨© ¬¥²®¤, 53
¨²¥°¨°®¢ ­­»© «®£ °¨´¬, 38
ª ­®­¨·¥±ª¨© ¢¨¤, 352
 ² « ­  ·¨±« , 306
 ² « ­  ·¨±«®, 263
ª¢ ¤° ²¨·­ ¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼ ¯°®¡, 238
ª¢ ¤° ²¨·­ ¿ ´³­ª¶¨¿, 17
ª¢ ­²¨«¨, 191
ª« ±± ½ª¢¨¢ «¥­²­®±²¨, 81
ª« ±²¥°, 237, 238
ª«¾·, 137, 148, 197
ª®¤  ´´¬¥­ , 341
ª®¤/¤¢®¨·­»©, 338
ª®¤/­¥° ¢­®¬¥°­»©, 338
ª®¤/¯°¥´¨ª±­»©, 339
ª®¤/° ¢­®¬¥°­»©, 338
ª®¤®¢®¥ ±«®¢®, 338
ª®««¨§¨¿, 224
ª®«¼¶¥¢®© ±¯¨±®ª, 205
ª®¬¡¨­ ²®°¨ª , 100
ª®¬¬¨¢®¿¦¥°  § ¤ · , 326
ª®¬¬¨¢®¿¦¥° 
§ ¤ · /¥¢ª«¨¤®¢ , 326
ª®¬¬³² ²¨¢­®±²¼, 76
ª®¬¯®­¥­² /±¢¿§­ ¿, 88
ª®­¥¶ ¯³²¨, 87
ª®­¥·­ ¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼,
83
ª®­¥·­®¥ ¬­®¦¥±²¢®, 78
ª®°¥­¼ ¤¥°¥¢ , 93

 

ª®°¥­¼ ¯®¤¤¥°¥¢ , 94
ª®°¥­¼/¤¢®¨·­®£® ¤¥°¥¢ , 95
ª®°­¥¢®¥ ¤¥°¥¢®, 93
ª®°­¥¢®¥ ¤¥°¥¢®/¯°¥¤±² ¢«¥­¨¥,
214
ª®½´´¨¶¨¥­² ¬­®£®·«¥­ , 35
ª®½´´¨¶¨¥­²»/¡¨­®¬¨ «¼­»¥,
103
ª° ±­®-·¥°­®¥ ¤¥°¥¢®, 266
ª° ²­®±²¼, 297
° ´²  ­¥° ¢¥­±²¢®, 97
ª³· /d-¨·­ ¿, 151
ª³· /¤¢®¨·­ ¿, 140
ª³· /±«¨¢ ¥¬ ¿, 218
«¥¢®¥ ¯®¤¤¥°¥¢®, 95
«¥¢»© ª®­¥¶, 292
«¥¢»© °¥¡¥­®ª, 95
«¥¢»© °¥¡¥­®ª, ¯° ¢»© ±®±¥¤,
215
«¥ª±¨ª®£° ´¨·¥±ª¨© ¯®°¿¤®ª,
261
«¥¬¬ /® °³ª®¯®¦ ²¨¿µ, 90
«¥±, 90, 91
«¨­¥©­ ¿ ¯®±«¥¤®¢ ²¥«¼­®±²¼
¯°®¡, 237
«¨­¥©­ ¿ ´³­ª¶¨¿, 17
«¨­¥©­®¥ ¯°®£° ¬¬¨°®¢ ­¨¥,
329
«¨­¥©­»© ¯®¨±ª, 15
«¨­¥©­»© ¯®°¿¤®ª, 82
«¨±², 94
«®£ °¨´¬, 37
«®£ °¨´¬/¨²¥°¨°®¢ ­­»©, 38
¬ £ §¨­, 201
¬ ª±¨¬ «¼­®¥ ­¥§ ¢¨±¨¬®¥
¯®¤¬­®¦¥±²¢®, 347
¬ ª±¨¬ «¼­®© ª° ²­®±²¨ ²®·ª , 297
¬ ª±¨¬ «¼­»© ½«¥¬¥­², 82
¬ ª±¨¬³¬, 184, 198, 246
 °ª®¢  ­¥° ¢¥­±²¢®, 116
¬ ²°¨¶ /¨­¶¨¤¥­²­®±²¨, 354,
355
¬ ²°¨·­»© ¬ ²°®¨¤, 346

887

¬ ²°®¨¤, 346
¬ ²°®¨¤/¢§¢¥¸¥­­»©, 347
¬ ²°®¨¤/£° ´®¢»©, 346
¬ ²°®¨¤/¬ ²°¨·­»©, 346
¬ ¸¨­  ± ¯°®¨§¢®«¼­»¬ ¤®±²³¯®¬, 15
¬¥¤¨ ­ , 184
¬¥¤¨ ­  ²°¥µ, 169
¬¥¤¨ ­ /¢§¢¥¸¥­­ ¿, 193
¬¥²®¤ ¨²¥° ¶¨©, 53
¬¥²®¤ ¬¥¤¨ ­» ²°¥µ, 169
¬¥²®¤ ¯®¤±² ­®¢ª¨, 53, 54
¬¨­¨¬³¬, 184, 198, 246
¬­®£®³£®«¼­¨ª, 321
¬­®£®³£®«¼­¨ª/¢»¯³ª«»©,
321
¬­®£®³£®«¼­¨ª/¯°®±²®©, 321
¬­®£®·«¥­, 35
¬­®¦¥±²¢ /­¥¯¥°¥±¥ª ¾¹¨¥±¿,
77
¬­®¦¥±²¢®, 75
¬­®¦¥±²¢® §­ ·¥­¨©, 84
¬­®¦¥±²¢®-±²¥¯¥­¼, 78
¬­®¦¥±²¢®/¡¥±ª®­¥·­®¥, 78
¬­®¦¥±²¢®/¢¥¹¥±²¢¥­­»µ ·¨±¥«, 75
¬­®¦¥±²¢®/¤¨­ ¬¨·¥±ª®¥,
197
¬­®¦¥±²¢®/ª®­¥·­®¥, 78
¬­®¦¥±²¢®/­ ²³° «¼­»µ ·¨±¥«, 75
¬­®¦¥±²¢®/­¥±·¥²­®¥, 78
¬­®¦¥±²¢®/¯³±²®¥, 75, 76
¬­®¦¥±²¢®/±·¥²­®¥, 78
¬­®¦¥±²¢®/¶¥«»µ ·¨±¥«, 75
¬­®¦¥±²¢®/· ±²¨·­® ³¯®°¿¤®·¥­­®¥, 81
¬®¤¥«¨°®¢ ­¨¥/³¯° ¢«¿¥¬®¥
±®¡»²¨¿¬¨, 149
¬®­¥² /±¨¬¬¥²°¨·­ ¿, 108
¬®­®²®­­ ¿ ´³­ª¶¨¿, 34
¬®¹­®±²¼ ¬­®¦¥±²¢ , 78
¬³«¼²¨£° ´, 90
¬³±®°/±¡®°ª , 211
­ ¨¡®«¼¸ ¿ ®¡¹ ¿ ¯®¤¯®±«¥-

888

 

¤®¢ ²¥«¼­®±²¼, 316
­ ¨¬¥­¼¸¥¥ ¯®ª°»¢ ¾¹¥¥ ¤¥°¥¢®, 348
­ «®¦¥­¨¥, 84
­ ±«¥¤±²¢¥­­®¥ ±¥¬¥©±²¢®,
346
­ ²³° «¼­»µ ·¨±¥« ¬­®¦¥±²¢®, 75
­ · «® ¯³²¨, 87
­¥¢®§¬®¦­®¥ ±®¡»²¨¥, 106
­¥§ ¢¨±¨¬®¥ ¯®¤¬­®¦¥±²¢®,
346, 352
­¥§ ¢¨±¨¬»¥ ¢ ±®¢®ª³¯­®±²¨
±®¡»²¨¿, 109
­¥§ ¢¨±¨¬»¥ ±«³· ©­»¥ ¢¥«¨·¨­», 113
­¥§ ¢¨±¨¬»¥ ±®¡»²¨¿, 109
­¥§ ¢¨±¨¬»© ½«¥¬¥­², 347
­¥®°¨¥­²¨°®¢ ­­»© ¢ °¨ ­²
(®°¨¥­²¨°®¢ ­­®£®
£° ´ ), 89
­¥®°¨¥­²¨°®¢ ­­»© £° ´, 86
­¥¯¥°¥±¥ª ¾¹¨¥±¿ ¬­®¦¥±²¢ , 77
­¥¯°¥°»¢­®¥ ° ¢­®¬¥°­®¥
° ±¯°¥¤¥«¥­¨¥ ¢¥°®¿²­®±²¥©, 108
­¥° ¢¥­±²¢® ³«¿, 111
­¥° ¢¥­±²¢® ° ´² , 97
­¥° ¢¥­±²¢®/ °ª®¢ , 116
­¥° ¢¥­±²¢®/¥¡»¸¥¢ , 116
­¥° ¢­®¬¥°­»© ª®¤, 338
­¥±®¢¬¥±²­»¥ ±®¡»²¨¿, 106
­¥±·¥²­®¥ ¬­®¦¥±²¢®, 78
­¥³¤ · , 117
­¥³¯®°¿¤®·¥­­ ¿ ¯ ° , 86
­®¬¥°/¯®°¿¤ª®¢»©, 286
 (­ ¨¡®«¼¸ ¿ ®¡¹ ¿ ¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¼),
316
¼¾²®­  ¡¨­®¬, 103
®¡« ±²¼ ®¯°¥¤¥«¥­¨¿ ´³­ª¶¨¨, 83
®¡° §, 84
®¡° ²­ ¿ ´³­ª¶¨¿, 85

®¡¹ ¿

¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¼, 316
®¡¹ ¿
¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¼/­ ¨¡®«¼¸ ¿,
316
®¡º¥¤¨­¥­¨¥, 76
®¡º¥¤¨­¥­¨¥/ª° ±­®-·¥°­»µ
¤¥°¥¢¼¥¢, 282
®¡º¥ª², 14
®£° ­¨·¥­¨¥ £° ´ , 89
®¤­®±²®°®­­¥ ±¢¿§ ­­»© ±¯¨±®ª, 205
®¯¥° ¶¨¨/²¥®°¥²¨ª®¬­®¦¥±²¢¥­­»¥, 76
®¯¥° ¶¨¿/¬¥­¿¾¹ ¿ ¬­®¦¥±²¢®, 198
®¯²¨¬ «¼­®¥ ¯®¤¬­®¦¥±²¢®,
348
®¯²¨¬ «¼­®±²¼ ¤«¿ ¯®¤§ ¤ ·,
311, 335
®¯²¨¬¨§ ¶¨¨ § ¤ ·¨, 303
®°£° ´, 86
®°¨¥­²¨°®¢ ­­»© ¢ °¨ ­²
(­¥®°¨¥­²¨°®¢ ­­®£®
£° ´ ), 89
®°¨¥­²¨°®¢ ­­»© £° ´, 86
®±­®¢­ ¿ ²¥®°¥¬  ® °¥ª³°°¥­²­»µ ±®®²­®¸¥­¨¿µ, 53, 61
®±²®¢­®¥ ¤¥°¥¢®, 347
®²¥¶, 94
®²ª°»² ¿  ¤°¥± ¶¨¿, 235
®²­®¸¥­¨¥/n-¬¥±²­®¥, 80
®²­®¸¥­¨¥/ ­²¨±¨¬¬¥²°¨·­®¥,
81
®²­®¸¥­¨¥/¡¨­ °­®¥, 80
®²­®¸¥­¨¥/· ±²¨·­®£® ¯®°¿¤ª , 81
®²­®¸¥­¨¥/½ª¢¨¢ «¥­²­®±²¨,
81
®²®¡° ¦¥­¨¥ À­ Á, 84
®²°¥§®ª, 292
®¶¥­ª / ±¨¬¯²®²¨·¥±ª¨ ²®·­ ¿, 31
®·¥°¥¤¼, 201, 203
®·¥°¥¤¼/± ¯°¨®°¨²¥² ¬¨, 148,

 

889

¯®«­»© £° ´, 90
¯®«³¨­²¥°¢ «, 292
¯ ° /­¥³¯®°¿¤®·¥­­ ¿, 86
¯®¯ °­® ­¥§ ¢¨±¨¬»¥ ±®¡»¯ ° /³¯®°¿¤®·¥­­ ¿, 78
²¨¿, 109
¯ ° ¤®ª± ¤­¿ °®¦¤¥­¨¿, 127
¯®°¿¤ª®¢ ¿ ±² ²¨±²¨ª , 184
¯ ° ¬¥²°/¯¥°¥¤ ·  ¯® §­ ·¥¯®°¿¤ª®¢®¥ ¤¥°¥¢®, 284
­¨¾, 14
¯®°¿¤ª®¢»¥ ±² ²¨±²¨ª¨, 139
 ±ª «¿ ²°¥³£®«¼­¨ª, 105
¯®°¿¤ª®¢»¥ ±² ²¨±²¨ª¨, ¤¨¯¥°¥¤ ·  ¯ ° ¬¥²°  ¯® §­ ·¥­ ¬¨·¥±ª¨¥, 284
­¨¾, 14
¯®°¿¤ª®¢»© ­®¬¥°, 286
¯¥°¥ª°»¢ ¾¹¨¥±¿ ¯®¤§ ¤ ·¨,
¯®°¿¤®ª °®±² , 18
312
¯®°¿¤®ª/«¥ª±¨ª®£° ´¨·¥±ª¨©,
¯¥°¥ª°»²¨¥ ®²°¥§ª®¢, 292
261
¯¥°¥¯®«­¥­¨¥, 202
¯®°¿¤®ª/«¨­¥©­»©, 82
¯¥°¥±¥·¥­¨¥, 76
¯®±«¥¤®¢ ²¥«¼­®±²¼/¡¥±ª®­¥·­ ¿,
¯¥°¥±² ­®¢ª , 85, 101
83
¯¥°¥±² ­®¢ª¨, 25
¯®±«¥¤®¢ ²¥«¼­®±²¼/¨±¯°®¡®¢ ­­»µ
¯®£«®¹¥­¨¿ § ª®­, 77
¬¥±², 235
¯®¤£° ´, 89
¯®±«¥¤®¢ ²¥«¼­®±²¼/ª®­¥·­ ¿,
¯®¤¤¥°¥¢®/± ª®°­¥¬ ¢ x, 94
83
¯®¤¬­®¦¥±²¢®, 76
¯®±²®¿­­ ¿ ©«¥° , 242
¯®¤¬­®¦¥±²¢®/±®¡±²¢¥­­®¥,
¯®²®¬®ª, 93
76
¯®²®¬®ª ±®¡±²¢¥­­»©, 93
¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¼, 316
¯®²®¬®ª/±®¡±²¢¥­­»©, 93
¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¼/­ ¨¡®«¼¸ ¿ ¯° ¢¨«®/¯°®¨§¢¥¤¥­¨¿, 101
®¡¹ ¿, 316
¯° ¢¨«®/±³¬¬», 100
¯®¤¯®±«¥¤®¢ ²¥«¼­®±²¼/®¡¹ ¿,
¯° ¢¨«¼­®±²¼  «£®°¨²¬ , 12
316
¯° ¢®¥ ¯®¤¤¥°¥¢®, 95
¯®¤¯³²¼, 87
¯° ¢»© ª®­¥¶, 292
¯®¤±² ­®¢ª¨ ¬¥²®¤, 53, 54
¯° ¢»© °¥¡¥­®ª, 95
¯®¤±²°®ª , 101
¯°¥¤®ª, 93
¯®¤±·¥² ª®«¨·¥±²¢, 100
¯°¥¤®ª/±®¡±²¢¥­­»©, 93
¯®§¨¶¨®­­®¥ ¤¥°¥¢®, 96
¯°¥¤»¤³¹¨©, 198
¯®§¨¶¨¿, 221
¯°¥¤»¤³¹¨© ½«¥¬¥­², 246
¯®¨±ª, 15, 198, 246
¯°¥´¨ª±, 317
¯®¨±ª/¢ ¤¢®¨·­®¬ ¤¥°¥¢¥, 249
¯°¥´¨ª±­»© ª®¤, 339
¯®¨±ª/¤¢®¨·­»©, 23
¯°¨­¶¨¯ ¦ ¤­®£® ¢»¡®° , 335
¯®¨±ª /¤¥°¥¢®, 246
¯°¨®°¨²¥²­ ¿ ®·¥°¥¤¼, 148
¯®ª § ²¥«¼­ ¿ ´³­ª¶¨¿, 36
¯°®£°¥±±¨¿/ °¨´¬¥²¨·¥±ª ¿,
¯®ª°»¢ ¾¹¥¥ ¤¥°¥¢®, 347
44
¯®«¥ ®¡º¥ª² , 14
¯°®£°¥±±¨¿/£¥®¬¥²°¨·¥±ª ¿,
¯®«¨«®£ °¨´¬, 37
44
¯®«¨­®¬, 35
¯°®¨§¢¥¤¥­¨¥, 46
¯®«¨­®¬¨ «¼­® ®£° ­¨·¥­­ ¿
¯°®¨§¢¥¤¥­¨¿ ¯° ¢¨«®, 101
´³­ª¶¨¿, 36
¯°®¨§¢®¤¿¹ ¿ ´³­ª¶¨¿, 71
¯®«­®¥ k-¨·­®¥ ¤¥°¥¢®, 96
¯°®±°®·¥­­»© § ª §, 351
246

890

 

¯°®±²®© ¬­®£®³£®«¼­¨ª, 321
¯°®±²®© ®°¨¥­²¨°®¢ ­­»©
£° ´, 88
¯°®±²®© ¯³²¼, 87
¯°®±²®© ¶¨ª«, 88
¯°®±²° ­±²¢®/¢¥°®¿²­®±²­®¥,
106
¯°¿¬ ¿  ¤°¥± ¶¨¿, 221
¯±¥¢¤®ª®¤, 12, 14
¯±¥¢¤®±«³· ©­»µ ·¨±¥« £¥­¥° ²®°, 159
¯³±²®¥ ¤¢®¨·­®¥ ¤¥°¥¢®, 95
¯³±²®¥ ¬­®¦¥±²¢®, 75, 76
¯³²¼ ¢ £° ´¥, 87
¯³²¼/¯°®±²®©, 87
° ¢¥­±²¢® ´³­ª¶¨©, 83
° ¢­®¬¥°­®£® µ¥¸¨°®¢ ­¨¿
£¨¯®²¥§ , 226
° ¢­®¬¥°­®¥ ° ±¯°¥¤¥«¥­¨¥
¢¥°®¿²­®±²¥©, 108
° ¢­®¬¥°­®¥ µ¥¸¨°®¢ ­¨¥,
236
° ¢­®¬¥°­»© ª®¤, 338
° ¢­»¥ ¬­®¦¥±²¢ , 75
° §¡¨¥­¨¥, 77
° §¤¥«¿© ¨ ¢« ±²¢³© (¬¥²®¤),
19
° §¬¥° ¢µ®¤ , 16
° §¬¥¹¥­¨¿ ¡¥§ ¯®¢²®°¥­¨©,
102
° §­®±²¼, 76
° §°¥¸ ¾¹¨¥ ¤¥°¥¢¼¿, 170
° §°¥¸¥­¨¥ ª®««¨§¨©, 224
° ­£, 162
° ±ª° ±ª , 97
° ±ª° ±ª  ¨­²¥°¢ «¼­®£® £° ´ , 334
° ±¯¨± ­¨¥, 351
° ±¯°¥¤¥«¥­¨¥, 180
° ±¯°¥¤¥«¥­¨¥ ¢¥°®¿²­®±²¥©,
106
° ±¯°¥¤¥«¥­¨¥
¢¥°®¿²­®±²¥©/¤¨±ª°¥²­®¥, 107
° ±¯°¥¤¥«¥­¨¥
¢¥°®¿²­®±²¥©/° ¢­®¬¥°­®¥,

108
° ±¯°¥¤¥«¥­¨¥/¡¨­®¬¨ «¼­®¥,
118
° ±¯°¥¤¥«¥­¨¥/£¥®¬¥²°¨·¥±ª®¥,
117
° ±¯°¥¤¥«¥­¨¿ ¢¥°®¿²­®±²¥©
´³­ª¶¨¿, 112
° ±±² ­®¢ª¨ ² ¡«¨¶ , 221
° ±µ®¤¿¹¨©±¿ °¿¤, 44
° ±¸¨°¿¾¹¥¥±¿ ¤¥°¥¢®, 283
°¥¡¥­®ª, 94
°¥¡°® £° ´ , 86
°¥¡°®-¶¨ª«, 86
°¥¡°®/¢µ®¤¿¹¥¥ ¢ ¢¥°¸¨­³,
87
°¥¡°®/¢»µ®¤¿¹¥¥ ¨§ ¢¥°¸¨­», 87
°¥¡°®/¨­¶¨¤¥­²­®¥ ¢¥°¸¨­¥,
87
°¥§³«¼² ², 11
°¥ª³°°¥­²­®¥ ±®®²­®¸¥­¨¥,
21, 53
°¥ª³°°¥­²­®¥
±®®²­®¸¥­¨¥/®±­®¢­ ¿
²¥®°¥¬ , 61
°¥ª³°±¨¢­»©  «£®°¨²¬, 20
°¥´«¥ª±¨¢­®¥ ®²­®¸¥­¨¥, 80
°¥´«¥ª±¨¢­®±²¼, 33
°¥¸¥­¨¥/¢»·¨±«¨²¥«¼­®© § ¤ ·¨, 12
°®¤¨²¥«¼, 94, 140
°¿¤, 43
°¿¤/ ¡±®«¾²­® ±µ®¤¿¹¨©±¿,
44
°¿¤/£ °¬®­¨·¥±ª¨©, 45
°¿¤/° ±µ®¤¿¹¨©±¿, 44
°¿¤/±µ®¤¿¹¨©±¿, 44
°¿¤/¥©«®° , 263
°¿¤/´®°¬ «¼­»© ±²¥¯¥­­®©,
71
±¡ « ­±¨°®¢ ­­®¥ ¤¥°¥¢®, 266
±¡®°¹¨ª ¬³±®° , 211
±¢®¡®¤­»¥ ¯®§¨¶¨¨, 212
±¢®©±²¢® § ¬¥­», 346
±¢®©±²¢® ª³·¨, 141

 

±¢®©±²¢®/³¯®°¿¤®·¥­­®±²¨,
247
±¢¿§ ­­»© ±¯¨±®ª, 205
±¢¿§­ ¿ ª®¬¯®­¥­² , 88
±¢¿§­»© £° ´, 88
±¥¬¥©±²¢®/³­¨¢¥°± «¼­®¥, 232
±¨«¼­® ±¢¿§­»© £° ´, 88
±¨¬¬¥²°¨·­ ¿ ¬®­¥² , 108
±¨¬¬¥²°¨·­®¥ ®²­®¸¥­¨¥, 80
±¨¬¬¥²°¨·­®±²¼, 33
±¨­£«¥²®­, 78
±«¥¤³¾¹¨©, 198
±«¥¤³¾¹¨© ½«¥¬¥­², 246
±«¨¢ ¥¬»¥ ª³·¨, 218
±«¨¿­¨¥ ³¯®°¿¤®·¥­­»µ ¬ ±±¨¢®¢, 20
±«®¢ °¼, 197, 246
±«®¢®, 101
±«®¢®/ª®¤®¢®¥, 338
±«³· ©­ ¿ ¢¥«¨·¨­ , ¬ ²¥¬ ²¨·¥±ª®¥ ®¦¨¤ ­¨¥,
113
±«³· ©­ ¿ ¢¥«¨·¨­ /¤¨±ª°¥²­ ¿,
112
±«³· ©­®¥ ¤¢®¨·­®¥ ¤¥°¥¢®
¯®¨±ª , 256
±«³· ©­»¥ ¢¥«¨·¨­»/­¥§ ¢¨±¨¬»¥,
113
±«³· ©­»µ ·¨±¥« £¥­¥° ²®°,
159
±¬¥¦­ ¿ ¢¥°¸¨­ , 87
±®¡±²¢¥­­®¥ ¯®¤¬­®¦¥±²¢®,
76
±®¡±²¢¥­­»© ¯°¥¤®ª, 93
±®¡»²¨¥, 106
±®¡»²¨¥/¢¥°®¿²­®±²¼, 107
±®¡»²¨¥/¤®±²®¢¥°­®¥, 106
±®¡»²¨¥/­¥¢®§¬®¦­®¥, 106
±®¡»²¨¥/½«¥¬¥­² °­®¥, 106
±®¡»²¨¿/­¥§ ¢¨±¨¬»¥, 109
±®¡»²¨¿/­¥§ ¢¨±¨¬»¥ ¢ ±®¢®ª³¯­®±²¨, 109
±®¡»²¨¿/­¥±®¢¬¥±²­»¥, 106
±®¡»²¨¿/¯®¯ °­® ­¥§ ¢¨±¨¬»¥, 109

891

±®¡»²¨¿/³±«®¢­® ­¥§ ¢¨±¨¬»¥, 111
±®¢¬¥±²­®£® ° ±¯°¥¤¥«¥­¨¿
¢¥°®¿²­®±²¥© ´³­ª¶¨¿, 113
±®¢¬¥±²­»¥ § ¿¢ª¨, 331
±®®²­®¸¥­¨¥ °¥ª³°°¥­²­®¥,
53
±®°²¨°®¢ª , 11, 137
±° ¢­¥­¨¥¬, 170
±®°²¨°®¢ª /¡¥§ ¤®¯®«­¨²¥«¼­®© ¯ ¬¿²¨, 12, 138
±®°²¨°®¢ª /¡»±²° ¿, 138, 152
±®°²¨°®¢ª /¢±² ¢ª ¬¨, 12
±®°²¨°®¢ª /¢»¡®°®¬, 19
±®°²¨°®¢ª /¢»·¥°¯»¢ ­¨¥¬,
138, 178
±®°²¨°®¢ª /¯®¤±·¥²®¬, 138,
173
±®°²¨°®¢ª /± ¯®¬®¹¼¾ ª³·¨,
138, 140, 147
±®°²¨°®¢ª /±«¨¿­¨¥¬, 20, 138
±®°²¨°®¢ª /³±²®©·¨¢ ¿, 174
±®°²¨°®¢ª /¶¨´°®¢ ¿, 138,
175
±®±¥¤­¿¿ ¢¥°¸¨­ , 89
±®·¥² ­¨¿, 102
±¯¨±®ª/¤¢³±²®°®­­¥ ±¢¿§ ­­»©, 205
±¯¨±®ª/ª®«¼¶¥¢®©, 205
±¯¨±®ª/®¤­®±²®°®­­¥ ±¢¿§ ­­»©, 205
±¯¨±®ª/±¢®¡®¤­»µ ¯®§¨¶¨©,
212
±¯¨±®ª/±¢¿§ ­­»©, 205
±¯¨±®ª/³¯®°¿¤®·¥­­»©, 205
±°¥¤­¥¥ ¢°¥¬¿ ° ¡®²», 18
±°¥¤­¥¥ ±«³· ©­®¥ ¢¥«¨·¨­»,
113
±°®ª, 351
±² ­¤ °²­®¥ ®²ª«®­¥­¨¥, 116
±² °¸¨© ª®½´´¨¶¨¥­² ¬­®£®·«¥­ , 35
±² ²¨±²¨ª /¯®°¿¤ª®¢ ¿, 184
±² ²¨±²¨ª¨/¯®°¿¤ª®¢»¥, 139
±²¥ª, 201

892

 

±²¥ª/¯³±²®©, 202
±²¥ª/° §¬¥°, 168
±²¥¯¥­¼ ¢¥°¸¨­», 87, 94
±²¥¯¥­¼ ¢¥°¸¨­»/¢µ®¤¿¹ ¿,
87
±²¥¯¥­¼ ¢¥°¸¨­»/¨±µ®¤¿¹ ¿,
87
±²¥¯¥­¼ ¬­®£®·«¥­ , 35
²¨°«¨­£  ´®°¬³« , 38
±²®¨¬®±²¼, 340
±²®¨¬®±²¼ °¥¤ ª²¨°®¢ ­¨¿,
328
±²®«ª­®¢¥­¨¥, 224
±²®°®­  ¬­®£®³£®«¼­¨ª , 321
±²°®£® ¢®§° ±² ¾¹ ¿ (³¡»¢ ¾¹ ¿) ´³­ª¶¨¿, 34
±²°®ª , 101
±²¿£¨¢ ­¨¥, 349
±³¬¬¨°®¢ ­¨¥, 43
±³¬¬» ¯° ¢¨«®, 100
±µ®¤¿¹¨©±¿ °¿¤, 44
±¶¥¯«¥­¨¥ ½«¥¬¥­²®¢, 225
±·¥²­®¥ ¬­®¦¥±²¢®, 78
±·¥²·¨ª/¢¥°®¿²­®±²­»©, 133
±»­, 94
±¾°º¥ª¶¨¿, 84
² ¡«¨¶  ° ±±² ­®¢ª¨, 221
¥©«®°  °¿¤, 263
²¥®°¥¬ /®±­®¢­ ¿ ® °¥ª³°°¥­²­»µ ±®®²­®¸¥­¨¿µ, 53, 61
²¥®°¥²¨ª®-¬­®¦¥±²¢¥­­»¥
®¯¥° ¶¨¨, 76
²®·ª /¬ ª±¨¬ «¼­®© ª° ²­®±²¨, 297
²° ­§¨²¨¢­®¥ ®²­®¸¥­¨¥, 80
²° ­§¨²¨¢­®±²¼, 33
²°¥³£®«¼­¨ª  ±ª «¿, 105
²°¨ ­£³«¿¶¨¿ ¬­®£®³£®«¼­¨ª , 322
³¤ «¥­¨¥, 198
³¤ «¥­¨¥ ½«¥¬¥­² , 246
³¬­®¦¥­¨¥, 231
³¬­®¦¥­¨¥ ¯®±«¥¤®¢ ²¥«¼­®±²¨ ¬ ²°¨¶, 305

³­¨¢¥°± «¼­®¥ ±¥¬¥©±²¢®, 232
³­¨¢¥°± «¼­®¥ µ¥¸¨°®¢ ­¨¥,
232
³­¨¢¥°±³¬, 77
³¯®°¿¤®·¥­­ ¿ ¯ ° , 78
³¯®°¿¤®·¥­­®±²¨ ±¢®©±²¢®,
247
³¯®°¿¤®·¥­­»© ±¯¨±®ª, 205
³¯° ¢«¿¥¬®¥ ±®¡»²¨¿¬¨ ¬®¤¥«¨°®¢ ­¨¥, 149
³°­», 129
³±«®¢­ ¿ ¢¥°®¿²­®±²¼, 109
³±«®¢­® ­¥§ ¢¨±¨¬»¥ ±®¡»²¨¿, 111
³±¯¥µ, 117
³±²®©·¨¢»©  «£®°¨²¬ ±®°²¨°®¢ª¨, 174
´ ª²®°¨ «, 38
¨¡®­ ··¨ ¯®±«¥¤®¢ ²¥«¼­®±²¼, 71
¨¡®­ ··¨ ·¨±« , 39
´¨ª²¨¢­»© ½«¥¬¥­², 207, 275
´®°¬ «¼­»© ±²¥¯¥­­®© °¿¤,
71
´®°¬³«  ¢ª«¾·¥­¨© ¨ ¨±ª«¾·¥­¨©, 80
´®°¬³« / ©¥± , 110
´®°¬³« /²¨°«¨­£ , 38
´³­ª¶¨¿, 83
´³­ª¶¨¿/ ±¨¬¯²®²¨·¥±ª¨ ¯®«®¦¨²¥«¼­ ¿, 36
´³­ª¶¨¿/¡³«¥¢ , 104
´³­ª¶¨¿/ª¢ ¤° ²¨·­ ¿, 17
´³­ª¶¨¿/«¨­¥©­ ¿, 17
´³­ª¶¨¿/¬®­®²®­­® ¢®§° ±² ¾¹ ¿ (³¡»¢ ¾¹ ¿), 34
´³­ª¶¨¿/®¡« ±²¼ ®¯°¥¤¥«¥­¨¿, 83
´³­ª¶¨¿/®¡° ²­ ¿, 85
´³­ª¶¨¿/®£° ­¨·¥­­ ¿ ¯®«¨«®£ °¨´¬®¬, 37
´³­ª¶¨¿/¯®ª § ²¥«¼­ ¿, 36
´³­ª¶¨¿/¯®«¨­®¬¨ «¼­®
®£° ­¨·¥­­ ¿, 36

 

´³­ª¶¨¿/¯°®¨§¢®¤¿¹ ¿, 71
´³­ª¶¨¿/° ±¯°¥¤¥«¥­¨¿, 180
´³­ª¶¨¿/° ±¯°¥¤¥«¥­¨¿ ¢¥°®¿²­®±²¥©, 112
´³­ª¶¨¿/° ±±² ­®¢ª¨, 221
´³­ª¶¨¿/±®¢¬¥±²­®£® ° ±¯°¥¤¥«¥­¨¿ ¢¥°®¿²­®±²¥©, 113
´³­ª¶¨¿/±²°®£® ¢®§° ±² ¾¹ ¿ (³¡»¢ ¾¹ ¿),
34
 ´´¬¥­  ª®¤, 341
µ¢®±² ±¯¨±ª , 205
µ¢®±²» ¡¨­®¬¨ «¼­®£® ° ±¯°¥¤¥«¥­¨¿, 123
µ¥¸-§­ ·¥­¨¥, 224
µ¥¸-² ¡«¨¶ , 224
µ¥¸-´³­ª¶¨¿, 221, 224
µ¥¸¨°®¢ ­¨¥, 221
µ¥¸¨°®¢ ­¨¥-° ¢­®¬¥°­®¥,
236
µ¥¸¨°®¢ ­¨¥/k-³­¨¢¥°± «¼­®¥,
244
µ¥¸¨°®¢ ­¨¥/¤¢®©­®¥, 238
µ¥¸¨°®¢ ­¨¥/° ¢­®¬¥°­®¥,
226
µ¥¸¨°®¢ ­¨¥/±
®²ª°»²®©
 ¤°¥± ¶¨¥©, 235
µ¥¸¨°®¢ ­¨¥/³­¨¢¥°± «¼­®¥,
232
¶¥« ¿ · ±²¼, 35
¶¥«®¥ ¯°¨¡«¨¦¥­¨¥ ±¢¥°µ³
(±­¨§³), 35
¶¥«»µ ·¨±¥« ¬­®¦¥±²¢®, 75
¶¥¯®·ª¨, 224
¶¨ª«, 87
¶¨ª«/¢ ­¥®°¨¥­²¨°®¢ ­­®¬
£° ´¥, 88
¶¨ª«/¯°®±²®©, 88
¶¨´°®¢ ¿ ±®°²¨°®¢ª , 138,
175
¶¨´°®¢»¥ ¤¥°¥¢¼¿, 261
· ±²¨·­® ³¯®°¿¤®·¥­­®¥ ¬­®¦¥±²¢®, 81

893

· ±²¨·­»© ¯®°¿¤®ª, 81
¥¡»¸¥¢  ­¥° ¢¥­±²¢®, 116
·¥°¯ ª, 178
·¥°­ ¿ ¢»±®² , 267
·¨±«  ¨¡®­ ··¨, 39, 71
·¨±« / ² « ­ , 306
·¨±«®  ² « ­ , 263
¸ °», 129
¸¥­­®­®¢±ª ¿ ½­²°®¯¨¿, 104
¸²° ´, 351
½ª¢¨¢ «¥­²­®±²¨/ª« ±±, 81
½ª¢¨¢ «¥­²­®±²¨/®²­®¸¥­¨¥,
81
½ª±¯®­¥­² , 36
½«¥¬¥­², 75
½«¥¬¥­²/¬ ª±¨¬ «¼­»©, 82
½«¥¬¥­² °­®¥ ±®¡»²¨¥, 106
½­²°®¯¨¿/¸¥­­®­®¢±ª ¿ ¤¢®¨·­ ¿, 104
¿·¥©ª , 221

